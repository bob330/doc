<!doctype html><html class=theme-light lang=el><head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content><meta name=keywords content><meta name=copyright content="1995-2024 The FreeBSD Foundation"><link rel=canonical href=http://172.16.201.134:1313/el/books/handbook/disks/><title>Κεφάλαιο 19. Αποθηκευτικά Μέσα | FreeBSD Documentation Portal</title>
<meta name=theme-color content="#790000"><meta name=color-scheme content="system light dark high-contrast"><link rel="shortcut icon" href=http://172.16.201.134:1313/favicon.ico><link rel=stylesheet href=http://172.16.201.134:1313/styles/main.min.css><link rel=stylesheet href=http://172.16.201.134:1313/css/font-awesome-min.css><script defer src=/js/theme-chooser.min.js></script><script defer src=/js/copy-clipboard.min.js></script><script defer src=/js/search.min.js></script><meta name=twitter:card content="summary"><meta name=twitter:domain content="docs.FreeBSD.org"><meta name=twitter:site content="@freebsd"><meta name=twitter:url content="https://twitter.com/freebsd"><meta property="og:title" content="Κεφάλαιο 19. Αποθηκευτικά Μέσα"><meta property="og:description" content><meta property="og:type" content="website"><meta property="og:image" content="http://172.16.201.134:1313/favicon.ico"><meta property="og:image:alt" content="FreeBSD Logo"><meta property="og:locale" content="el"><meta property="og:url" content="http://172.16.201.134:1313/el/books/handbook/disks/"><meta property="og:site_name" content="FreeBSD Documentation Portal"><script type=application/ld+json>{"@context":"http://schema.org","@type":"Article","url":"http:\/\/172.16.201.134:1313\/el\/books\/handbook\/disks\/","name":"FreeBSD Documentation Portal","headline":"FreeBSD Documentation Portal","description":"FreeBSD Documentation Portal"}</script></head><body><header><div class=header-container><div class=logo-menu-bars-container><a href=https://www.FreeBSD.org class=logo><img src=http://172.16.201.134:1313/images/FreeBSD-monochromatic.svg width=160 height=50 alt="FreeBSD logo">
</a><label class=menu-bars for=menu-bars><i class="fa fa-bars" aria-hidden=true></i></label></div><input id=menu-bars type=checkbox><nav><ul class=menu><li class=menu-item><input id=about type=checkbox>
<a href=# aria-label="Navigate to About section"><label class=menu-item-description for=about>About
<i class="fa fa-angle-down fa-lg" aria-hidden=true></i></label></a><ul class=sub-menu><li class=title><a href=https://www.freebsd.org/about/ target=_blank>About</a></li><li><a href=https://www.freebsd.org/about/ target=_blank>FreeBSD</a></li><li><a href=https://freebsdfoundation.org/about-us/about-the-foundation/ target=_blank>FreeBSD Foundation</a></li><li><a href=https://www.freebsd.org/internal/code-of-conduct/ target=_blank>Code of Conduct</a></li></ul></li><li class=menu-item><input id=download type=checkbox>
<a href=# aria-label="Navigate to get FreeBSD section"><label class=menu-item-description for=download>Get FreeBSD
<i class="fa fa-angle-down fa-lg" aria-hidden=true></i></label></a><ul class=sub-menu><li class=title><a href=https://www.freebsd.org/where/ target=_blank>Get FreeBSD</a></li><li><a href=https://www.freebsd.org/releases/ target=_blank>Release Information</a></li><li><a href=https://www.freebsd.org/releng/ target=_blank>Release Engineering</a></li><li><a href=https://www.freebsd.org/security/ target=_blank>Security Advisories</a></li></ul></li><li class=menu-item><input id=documentation type=checkbox>
<a href=# aria-label="Navigate to get Documentation section"><label class=menu-item-description for=documentation>Documentation
<i class="fa fa-angle-down fa-lg" aria-hidden=true></i></label></a><ul class=sub-menu><li class=title><a href=/el>Documentation portal</a></li><li><a href=http://172.16.201.134:1313/el/books/handbook>FreeBSD Handbook</a></li><li><a href=http://172.16.201.134:1313/el/books/porters-handbook>Porter's Handbook</a></li><li><a href=https://docs.FreeBSD.org/en/books/fdp-primer>Documentation Project Handbook</a></li><li><a href=https://man.FreeBSD.org target=_blank>Manual pages</a></li><li><a href=https://papers.FreeBSD.org target=_blank>Presentations and papers</a></li><li><a href=https://wiki.FreeBSD.org target=_blank>Wiki</a></li><li><a href=http://172.16.201.134:1313/el/books>Books</a></li><li><a href=http://172.16.201.134:1313/el/articles>Articles</a></li></ul></li><li class=menu-item><input id=community type=checkbox>
<a href=# aria-label="Navigate to get Community section"><label class=menu-item-description for=community>Community
<i class="fa fa-angle-down fa-lg" aria-hidden=true></i></label></a><ul class=sub-menu><li class=title><a href=https://www.freebsd.org/community/>Community</a></li><li><a href=http://172.16.201.134:1313/el/articles/contributing>Get involved</a></li><li><a href=https://forums.freebsd.org/ target=_blank>Forum</a></li><li><a href=https://lists.freebsd.org/ target=_blank>Mailing lists</a></li><li><a href=https://wiki.freebsd.org/IRC/Channels target=_blank>IRC Channels</a></li><li><a href=https://bugs.freebsd.org/bugzilla/ target=_blank>Bug Tracker</a></li><li><a href=https://www.freebsd.org/support/ target=_blank>Support</a></li></ul></li></ul></nav><div class=search-donate-container><form class=search method=get id=search-header-form action=https://docs.freebsd.org/search name=search-header-form><input type=hidden name=DB value=el>
<input id=words name=P type=text size=20 maxlength=255>
<button>
<i class="fa fa-search" aria-hidden=true></i></button></form><div class=donate><a href=https://freebsdfoundation.org/donate/ target=_blank><span class=heart>♥</span>
Donate</a></div></div></div></header><input type=checkbox class="hidden toggle" id=menu-control><main class=main-wrapper-book><a id=top></a><aside class=book-menu><div class=book-menu-content><input id=search-book type=text placeholder=Αναζήτηση aria-label=Αναζήτηση maxlength=128><nav id=MenuContents><ul><li><input type=checkbox id=chapter-eb2a98ce203d8afd517726e6d8776be3 class=toggle>
<label class="icon cursor" for=chapter-eb2a98ce203d8afd517726e6d8776be3><a role=button></a></label><a href=http://172.16.201.134:1313/el/books/handbook/preface/>Πρόλογος</a><ul><li><a href=http://172.16.201.134:1313/el/books/handbook/preface/#preface-audience>Σε Ποιους Απευθύνεται Αυτό το Βιβλίο</a></li><li><a href=http://172.16.201.134:1313/el/books/handbook/preface/#preface-changes-from3>Αλλαγές από την Τρίτη Έκδοση</a></li><li><a href=http://172.16.201.134:1313/el/books/handbook/preface/#preface-changes-from2>Αλλαγές από τη Δεύτερη Έκδοση (2004)</a></li><li><a href=http://172.16.201.134:1313/el/books/handbook/preface/#preface-changes>Αλλαγές από την Πρώτη Έκδοση (2001)</a></li><li><a href=http://172.16.201.134:1313/el/books/handbook/preface/#preface-overview>Οργάνωση Αυτού του Βιβλίου</a></li><li><a href=http://172.16.201.134:1313/el/books/handbook/preface/#preface-conv>Συμβάσεις που χρησιμοποιούνται σε αυτό το βιβλίο</a></li><li><a href=http://172.16.201.134:1313/el/books/handbook/preface/#preface-acknowledgements>Ευχαριστίες</a></li></ul></li><li><input type=checkbox id=chapter-14a525fce014b90b8a458a894818255a class=toggle>
<label for=chapter-14a525fce014b90b8a458a894818255a><a role=button></a></label><a href=http://172.16.201.134:1313/el/books/handbook/parti/>Μέρος I. Ξεκινώντας με το FreeBSD</a></li><li><input type=checkbox id=chapter-f9c9f3451644df30d224350da97d5da6 class=toggle>
<label class="icon cursor" for=chapter-f9c9f3451644df30d224350da97d5da6><a role=button></a></label><a href=http://172.16.201.134:1313/el/books/handbook/introduction/>Κεφάλαιο 1. Εισαγωγή</a><ul><li><a href=http://172.16.201.134:1313/el/books/handbook/introduction/#introduction-synopsis>1.1. Σύνοψη</a></li><li><a href=http://172.16.201.134:1313/el/books/handbook/introduction/#nutshell>1.2. Καλώς ήλθατε στο FreeBSD!</a></li><li><a href=http://172.16.201.134:1313/el/books/handbook/introduction/#history>1.3. Πληροφορίες για το FreeBSD Project</a></li></ul></li><li><input type=checkbox id=chapter-f693a3fa687a72d63ec8129ee302d664 class=toggle>
<label class="icon cursor" for=chapter-f693a3fa687a72d63ec8129ee302d664><a role=button></a></label><a href=http://172.16.201.134:1313/el/books/handbook/bsdinstall/>Κεφάλαιο 2. Εγκατάσταση του FreeBSD 9.x και Μεταγενέστερων Εκδόσεων</a><ul><li><a href=http://172.16.201.134:1313/el/books/handbook/bsdinstall/#bsdinstall-synopsis>2.1. Σύνοψη</a></li><li><a href=http://172.16.201.134:1313/el/books/handbook/bsdinstall/#bsdinstall-hardware>2.2. Απαιτήσεις Υλικού</a></li><li><a href=http://172.16.201.134:1313/el/books/handbook/bsdinstall/#bsdinstall-pre>2.3. Εργασίες πριν την Εγκατάσταση</a></li><li><a href=http://172.16.201.134:1313/el/books/handbook/bsdinstall/#bsdinstall-start>2.4. Ξεκινώντας την Εγκατάσταση</a></li><li><a href=http://172.16.201.134:1313/el/books/handbook/bsdinstall/#using-bsdinstall>2.5. Εισαγωγή στο bsdinstall</a></li><li><a href=http://172.16.201.134:1313/el/books/handbook/bsdinstall/#bsdinstall-netinstall>2.6. Εγκατάσταση από το Δίκτυο</a></li><li><a href=http://172.16.201.134:1313/el/books/handbook/bsdinstall/#bsdinstall-partitioning>2.7. Εκχώρηση Χώρου στο Δίσκο</a></li><li><a href=http://172.16.201.134:1313/el/books/handbook/bsdinstall/#bsdinstall-final-warning>2.8. Επιβεβαίωση της Εγκατάστασης</a></li><li><a href=http://172.16.201.134:1313/el/books/handbook/bsdinstall/#bsdinstall-post>2.9. Μετά την Εγκατάσταση</a></li><li><a href=http://172.16.201.134:1313/el/books/handbook/bsdinstall/#bsdinstall-install-trouble>2.10. Αντιμετώπιση Προβλημάτων</a></li><li><a href=http://172.16.201.134:1313/el/books/handbook/bsdinstall/#using-live-cd>2.11. Χρησιμοποιώντας τη Λειτουργία Live CD</a></li></ul></li><li><input type=checkbox id=chapter-6aaec170775233b7c45f6cdcfb70d466 class=toggle>
<label class="icon cursor" for=chapter-6aaec170775233b7c45f6cdcfb70d466><a role=button></a></label><a href=http://172.16.201.134:1313/el/books/handbook/install/>Κεφάλαιο 3. Εγκατάσταση του FreeBSD 8.x και Προγενέστερων Εκδόσεων</a><ul><li><a href=http://172.16.201.134:1313/el/books/handbook/install/#install-synopsis>3.1. Σύνοψη</a></li><li><a href=http://172.16.201.134:1313/el/books/handbook/install/#install-hardware>3.2. Απαιτήσεις Υλικού</a></li><li><a href=http://172.16.201.134:1313/el/books/handbook/install/#install-pre>3.3. Εργασίες πριν την Εγκατάσταση</a></li><li><a href=http://172.16.201.134:1313/el/books/handbook/install/#install-start>3.4. Ξεκινώντας την Εγκατάσταση</a></li><li><a href=http://172.16.201.134:1313/el/books/handbook/install/#using-sysinstall>3.5. Εισαγωγή στο Sysinstall</a></li><li><a href=http://172.16.201.134:1313/el/books/handbook/install/#install-steps>3.6. Εκχώρηση Χώρου στο Δίσκο</a></li><li><a href=http://172.16.201.134:1313/el/books/handbook/install/#install-choosing>3.7. Επιλέγοντας τι θα Εγκαταστήσετε</a></li><li><a href=http://172.16.201.134:1313/el/books/handbook/install/#install-media>3.8. Επιλέγοντας το Μέσο Εγκατάστασης</a></li><li><a href=http://172.16.201.134:1313/el/books/handbook/install/#install-final-warning>3.9. Επιβεβαίωση της Εγκατάστασης</a></li><li><a href=http://172.16.201.134:1313/el/books/handbook/install/#install-post>3.10. Μετά την Εγκατάσταση</a></li><li><a href=http://172.16.201.134:1313/el/books/handbook/install/#install-trouble>3.11. Αντιμετώπιση Προβλημάτων</a></li><li><a href=http://172.16.201.134:1313/el/books/handbook/install/#install-advanced>3.12. Οδηγός Εγκατάστασης για Προχωρημένους</a></li><li><a href=http://172.16.201.134:1313/el/books/handbook/install/#install-diff-media>3.13. Προετοιμάζοντας τα Δικά σας Μέσα Εγκατάστασης</a></li></ul></li><li><input type=checkbox id=chapter-9f6db261075f578742036fcc6000eecd class=toggle>
<label class="icon cursor" for=chapter-9f6db261075f578742036fcc6000eecd><a role=button></a></label><a href=http://172.16.201.134:1313/el/books/handbook/basics/>Κεφάλαιο 4. Βασικές Έννοιες στο UNIX®</a><ul><li><a href=http://172.16.201.134:1313/el/books/handbook/basics/#basics-synopsis>4.1. Σύνοψη</a></li><li><a href=http://172.16.201.134:1313/el/books/handbook/basics/#consoles>4.2. Εικονικές Κονσόλες και Τερματικά</a></li><li><a href=http://172.16.201.134:1313/el/books/handbook/basics/#permissions>4.3. Άδειες (Permissions)</a></li><li><a href=http://172.16.201.134:1313/el/books/handbook/basics/#dirstructure>4.4. Δομή Καταλόγου</a></li><li><a href=http://172.16.201.134:1313/el/books/handbook/basics/#disk-organization>4.5. Οργάνωση Δίσκου</a></li><li><a href=http://172.16.201.134:1313/el/books/handbook/basics/#mount-unmount>4.6. Προσάρτηση και Αποπροσάρτηση Συστημάτων Αρχείων</a></li><li><a href=http://172.16.201.134:1313/el/books/handbook/basics/#basics-processes>4.7. Διεργασίες</a></li><li><a href=http://172.16.201.134:1313/el/books/handbook/basics/#basics-daemons>4.8. Δαίμονες, Σήματα, και Τερματισμός Διεργασιών</a></li><li><a href=http://172.16.201.134:1313/el/books/handbook/basics/#shells>4.9. Κελύφη</a></li><li><a href=http://172.16.201.134:1313/el/books/handbook/basics/#editors>4.10. Κειμενογράφοι</a></li><li><a href=http://172.16.201.134:1313/el/books/handbook/basics/#basics-devices>4.11. Συσκευές και Αρχεία συσκευών</a></li><li><a href=http://172.16.201.134:1313/el/books/handbook/basics/#binary-formats>4.12. Τύποι Εκτελέσιμων</a></li><li><a href=http://172.16.201.134:1313/el/books/handbook/basics/#basics-more-information>4.13. Για Περισσότερες Πληροφορίες</a></li></ul></li><li><input type=checkbox id=chapter-01c5707e95d14c0ff84bf62600c958d1 class=toggle>
<label class="icon cursor" for=chapter-01c5707e95d14c0ff84bf62600c958d1><a role=button></a></label><a href=http://172.16.201.134:1313/el/books/handbook/ports/>Κεφάλαιο 5. Εγκατάσταση Εφαρμογών: Πακέτα και Ports</a><ul><li><a href=http://172.16.201.134:1313/el/books/handbook/ports/#ports-synopsis>5.1. Σύνοψη</a></li><li><a href=http://172.16.201.134:1313/el/books/handbook/ports/#ports-overview>5.2. Επισκόπησή της εγκατάστασης λογισμικού</a></li><li><a href=http://172.16.201.134:1313/el/books/handbook/ports/#ports-finding-applications>5.3. Βρίσκοντας την Εφαρμογή σας</a></li><li><a href=http://172.16.201.134:1313/el/books/handbook/ports/#packages-using>5.4. Χρησιμοποιώντας το Σύστημα των Πακέτων</a></li><li><a href=http://172.16.201.134:1313/el/books/handbook/ports/#ports-using>5.5. Χρησιμοποιώντας την Συλλογή των Ports</a></li><li><a href=http://172.16.201.134:1313/el/books/handbook/ports/#ports-nextsteps>5.6. Ενέργειες μετά την Εγκατάσταση</a></li><li><a href=http://172.16.201.134:1313/el/books/handbook/ports/#ports-broken>5.7. Αντιμετωπίζοντας Χαλασμένα Ports</a></li></ul></li><li><input type=checkbox id=chapter-3405c00581365a8b5d16af70fe4d1b72 class=toggle>
<label class="icon cursor" for=chapter-3405c00581365a8b5d16af70fe4d1b72><a role=button></a></label><a href=http://172.16.201.134:1313/el/books/handbook/x11/>Κεφάλαιο 6. Το Σύστημα X Window</a><ul><li><a href=http://172.16.201.134:1313/el/books/handbook/x11/#x11-synopsis>6.1. Σύνοψη</a></li><li><a href=http://172.16.201.134:1313/el/books/handbook/x11/#x-understanding>6.2. Κατανόηση του περιβάλλοντος X11</a></li><li><a href=http://172.16.201.134:1313/el/books/handbook/x11/#x-install>6.3. Εγκατάσταση του X11</a></li><li><a href=http://172.16.201.134:1313/el/books/handbook/x11/#x-config>6.4. Ρύθμιση του X11</a></li><li><a href=http://172.16.201.134:1313/el/books/handbook/x11/#x-fonts>6.5. Χρήση Γραμματοσειρών στο X11</a></li><li><a href=http://172.16.201.134:1313/el/books/handbook/x11/#x-xdm>6.6. Ο X Display Manager</a></li><li><a href=http://172.16.201.134:1313/el/books/handbook/x11/#x11-wm>6.7. Γραφικά Περιβάλλοντα</a></li></ul></li><li><input type=checkbox id=chapter-0eab3565e8f59f5a8a896dfba7eb3680 class=toggle>
<label for=chapter-0eab3565e8f59f5a8a896dfba7eb3680><a role=button></a></label><a href=http://172.16.201.134:1313/el/books/handbook/partii/>Μέρος II. Βασικές Εργασίες</a></li><li><input type=checkbox id=chapter-b33cf28993f3f7bf5baf036e79da0f39 class=toggle>
<label class="icon cursor" for=chapter-b33cf28993f3f7bf5baf036e79da0f39><a role=button></a></label><a href=http://172.16.201.134:1313/el/books/handbook/desktop/>Κεφάλαιο 7. Desktop Εφαρμογές</a><ul><li><a href=http://172.16.201.134:1313/el/books/handbook/desktop/#desktop-synopsis>7.1. Σύνοψη</a></li><li><a href=http://172.16.201.134:1313/el/books/handbook/desktop/#desktop-browsers>7.2. Φυλλομετρητές (Browsers)</a></li><li><a href=http://172.16.201.134:1313/el/books/handbook/desktop/#desktop-productivity>7.3. Εφαρμογές Γραφείου</a></li><li><a href=http://172.16.201.134:1313/el/books/handbook/desktop/#desktop-viewers>7.4. Προγράμματα Προβολής Εγγράφων</a></li><li><a href=http://172.16.201.134:1313/el/books/handbook/desktop/#desktop-finance>7.5. Χρηματοοικονομικές Εφαρμογές</a></li><li><a href=http://172.16.201.134:1313/el/books/handbook/desktop/#desktop-summary>7.6. Περίληψη</a></li></ul></li><li><input type=checkbox id=chapter-152f694a19312ad72ec7bb4e1c3c33b2 class=toggle>
<label class="icon cursor" for=chapter-152f694a19312ad72ec7bb4e1c3c33b2><a role=button></a></label><a href=http://172.16.201.134:1313/el/books/handbook/multimedia/>Κεφάλαιο 8. Πολυμέσα</a><ul><li><a href=http://172.16.201.134:1313/el/books/handbook/multimedia/#multimedia-synopsis>8.1. Σύνοψη</a></li><li><a href=http://172.16.201.134:1313/el/books/handbook/multimedia/#sound-setup>8.2. Ρύθμιση της Κάρτας Ήχου</a></li><li><a href=http://172.16.201.134:1313/el/books/handbook/multimedia/#sound-mp3>8.3. Ήχος MP3</a></li><li><a href=http://172.16.201.134:1313/el/books/handbook/multimedia/#video-playback>8.4. Αναπαραγωγή Video</a></li><li><a href=http://172.16.201.134:1313/el/books/handbook/multimedia/#tvcard>8.5. Ρύθμιση Κάρτας Τηλεόρασης</a></li><li><a href=http://172.16.201.134:1313/el/books/handbook/multimedia/#mythtv>8.6. MythTV</a></li><li><a href=http://172.16.201.134:1313/el/books/handbook/multimedia/#scanners>8.7. Σαρωτές Εικόνας</a></li></ul></li><li><input type=checkbox id=chapter-80888b4ee02e3e409e5f71cf97a36450 class=toggle>
<label class="icon cursor" for=chapter-80888b4ee02e3e409e5f71cf97a36450><a role=button></a></label><a href=http://172.16.201.134:1313/el/books/handbook/kernelconfig/>Κεφάλαιο 9. Ρυθμίζοντας τον Πυρήνα του FreeBSD</a><ul><li><a href=http://172.16.201.134:1313/el/books/handbook/kernelconfig/#kernelconfig-synopsis>9.1. Σύνοψη</a></li><li><a href=http://172.16.201.134:1313/el/books/handbook/kernelconfig/#kernelconfig-custom-kernel>9.2. Γιατί να Φτιάξετε Προσαρμοσμένο Πυρήνα;</a></li><li><a href=http://172.16.201.134:1313/el/books/handbook/kernelconfig/#kernelconfig-devices>9.3. Ανακαλύπτοντας τις Συσκευές του Συστήματος σας</a></li><li><a href=http://172.16.201.134:1313/el/books/handbook/kernelconfig/#kernelconfig-modules>9.4. Προγράμματα Οδήγησης, Υποσυστήματα και Αρθρώματα (modules)</a></li><li><a href=http://172.16.201.134:1313/el/books/handbook/kernelconfig/#kernelconfig-building>9.5. Δημιουργία και Εγκατάσταση Προσαρμοσμένου Πυρήνα</a></li><li><a href=http://172.16.201.134:1313/el/books/handbook/kernelconfig/#kernelconfig-config>9.6. Το Αρχείο Ρυθμίσεων</a></li><li><a href=http://172.16.201.134:1313/el/books/handbook/kernelconfig/#kernelconfig-trouble>9.7. Αν Κάτι Πάει Λάθος</a></li></ul></li><li><input type=checkbox id=chapter-cb174c55879b17ab955f2f16989a79e0 class=toggle>
<label class="icon cursor" for=chapter-cb174c55879b17ab955f2f16989a79e0><a role=button></a></label><a href=http://172.16.201.134:1313/el/books/handbook/printing/>Κεφάλαιο 10. Εκτυπώσεις</a><ul><li><a href=http://172.16.201.134:1313/el/books/handbook/printing/#printing-synopsis>10.1. Σύνοψη</a></li><li><a href=http://172.16.201.134:1313/el/books/handbook/printing/#printing-intro-spooler>10.2. Εισαγωγή</a></li><li><a href=http://172.16.201.134:1313/el/books/handbook/printing/#printing-intro-setup>10.3. Βασική Εγκατάσταση</a></li><li><a href=http://172.16.201.134:1313/el/books/handbook/printing/#printing-advanced>10.4. Ρυθμίσεις Εκτυπωτών για Προχωρημένους</a></li><li><a href=http://172.16.201.134:1313/el/books/handbook/printing/#printing-using>10.5. Χρήση Εκτυπωτών</a></li><li><a href=http://172.16.201.134:1313/el/books/handbook/printing/#printing-lpd-alternatives>10.6. Εναλλακτικές Λύσεις για τον Στάνταρ Spooler</a></li><li><a href=http://172.16.201.134:1313/el/books/handbook/printing/#printing-troubleshooting>10.7. Εντοπισμός Βλαβών</a></li></ul></li><li><input type=checkbox id=chapter-c12b8c3f2a8fcefce87087241f695c83 class=toggle>
<label class="icon cursor" for=chapter-c12b8c3f2a8fcefce87087241f695c83><a role=button></a></label><a href=http://172.16.201.134:1313/el/books/handbook/linuxemu/>Κεφάλαιο 11. Συμβατότητα με Εκτελέσιμα του Linux</a><ul><li><a href=http://172.16.201.134:1313/el/books/handbook/linuxemu/#linuxemu-synopsis>11.1. Σύνοψη</a></li><li><a href=http://172.16.201.134:1313/el/books/handbook/linuxemu/#linuxemu-lbc-install>11.2. Εγκατάσταση</a></li><li><a href=http://172.16.201.134:1313/el/books/handbook/linuxemu/#linuxemu-mathematica>11.3. Εγκαθιστώντας το Mathematica®</a></li><li><a href=http://172.16.201.134:1313/el/books/handbook/linuxemu/#linuxemu-maple>11.4. Εγκαθιστώντας το Maple™</a></li><li><a href=http://172.16.201.134:1313/el/books/handbook/linuxemu/#linuxemu-matlab>11.5. Εγκαθιστώντας το MATLAB®</a></li><li><a href=http://172.16.201.134:1313/el/books/handbook/linuxemu/#linuxemu-oracle>11.6. Εγκατάσταση της Oracle®</a></li><li><a href=http://172.16.201.134:1313/el/books/handbook/linuxemu/#linuxemu-advanced>11.7. Προχωρημένα Θέματα</a></li></ul></li><li><input type=checkbox id=chapter-03b11ba627b9a0c85b247f5641bde272 class=toggle>
<label for=chapter-03b11ba627b9a0c85b247f5641bde272><a role=button></a></label><a href=http://172.16.201.134:1313/el/books/handbook/partiii/>Μέρος III. Διαχείριση Συστήματος</a></li><li><input type=checkbox id=chapter-6c31587f8d736319f099cd4dc1961301 class=toggle>
<label class="icon cursor" for=chapter-6c31587f8d736319f099cd4dc1961301><a role=button></a></label><a href=http://172.16.201.134:1313/el/books/handbook/config/>Κεφάλαιο 12. Ρύθμιση και Βελτιστοποίηση</a><ul><li><a href=http://172.16.201.134:1313/el/books/handbook/config/#config-synopsis>12.1. Σύνοψη</a></li><li><a href=http://172.16.201.134:1313/el/books/handbook/config/#configtuning-initial>12.2. Αρχική Ρύθμιση</a></li><li><a href=http://172.16.201.134:1313/el/books/handbook/config/#configtuning-core-configuration>12.3. Κύρια Ρύθμιση</a></li><li><a href=http://172.16.201.134:1313/el/books/handbook/config/#configtuning-appconfig>12.4. Ρύθμιση Εφαρμογών</a></li><li><a href=http://172.16.201.134:1313/el/books/handbook/config/#configtuning-starting-services>12.5. Eκκινώντας Υπηρεσίες</a></li><li><a href=http://172.16.201.134:1313/el/books/handbook/config/#configtuning-cron>12.6. Ρυθμίζοντας Το Πρόγραμμα <code>cron</code></a></li><li><a href=http://172.16.201.134:1313/el/books/handbook/config/#configtuning-rcd>12.7. Χρησιμοποιώντας Το Σύστημα rc Στο FreeBSD</a></li><li><a href=http://172.16.201.134:1313/el/books/handbook/config/#config-network-setup>12.8. Ρυθμίζοντας Τις Κάρτες Δικτύου</a></li><li><a href=http://172.16.201.134:1313/el/books/handbook/config/#configtuning-virtual-hosts>12.9. Εικονικά Hosts</a></li><li><a href=http://172.16.201.134:1313/el/books/handbook/config/#configtuning-configfiles>12.10. Αρχεία Ρυθμίσεων</a></li><li><a href=http://172.16.201.134:1313/el/books/handbook/config/#configtuning-sysctl>12.11. Tuning with sysctl</a></li><li><a href=http://172.16.201.134:1313/el/books/handbook/config/#configtuning-disk>12.12. Tuning Disks</a></li><li><a href=http://172.16.201.134:1313/el/books/handbook/config/#configtuning-kernel-limits>12.13. Tuning Kernel Limits</a></li><li><a href=http://172.16.201.134:1313/el/books/handbook/config/#adding-swap-space>12.14. Adding Swap Space</a></li><li><a href=http://172.16.201.134:1313/el/books/handbook/config/#acpi-overview>12.15. Power and Resource Management</a></li><li><a href=http://172.16.201.134:1313/el/books/handbook/config/#ACPI-debug>12.16. Using and Debugging FreeBSD ACPI</a></li></ul></li><li><input type=checkbox id=chapter-459f0012b3b4f0b6b123010f029da5e4 class=toggle>
<label class="icon cursor" for=chapter-459f0012b3b4f0b6b123010f029da5e4><a role=button></a></label><a href=http://172.16.201.134:1313/el/books/handbook/boot/>Κεφάλαιο 13. Η Διαδικασία Εκκίνησης του FreeBSD</a><ul><li><a href=http://172.16.201.134:1313/el/books/handbook/boot/#boot-synopsis>13.1. Σύνοψη</a></li><li><a href=http://172.16.201.134:1313/el/books/handbook/boot/#boot-introduction>13.2. Το Πρόβλημα της Εκκίνησης</a></li><li><a href=http://172.16.201.134:1313/el/books/handbook/boot/#boot-blocks>13.3. Ο Διαχειριστής Εκκίνησης και τα Στάδια Εκκίνησης</a></li><li><a href=http://172.16.201.134:1313/el/books/handbook/boot/#boot-kernel>13.4. Αλληλεπίδραση με τον Πυρήνα κατά την Εκκίνηση</a></li><li><a href=http://172.16.201.134:1313/el/books/handbook/boot/#device-hints>13.5. Device Hints</a></li><li><a href=http://172.16.201.134:1313/el/books/handbook/boot/#boot-init>13.6. Init: Αρχικοποίηση Ελέγχου Διαδικασιών</a></li><li><a href=http://172.16.201.134:1313/el/books/handbook/boot/#boot-shutdown>13.7. Ακολουθία Τερματισμού</a></li></ul></li><li><input type=checkbox id=chapter-d251c21b963b5ab783e5aec225e02b5a class=toggle>
<label class="icon cursor" for=chapter-d251c21b963b5ab783e5aec225e02b5a><a role=button></a></label><a href=http://172.16.201.134:1313/el/books/handbook/users/>Κεφάλαιο 14. Χρήστες και Βασική Διαχείριση Λογαριασμών</a><ul><li><a href=http://172.16.201.134:1313/el/books/handbook/users/#users-synopsis>14.1. Σύνοψη</a></li><li><a href=http://172.16.201.134:1313/el/books/handbook/users/#users-introduction>14.2. Εισαγωγή</a></li><li><a href=http://172.16.201.134:1313/el/books/handbook/users/#users-superuser>14.3. Ο Λογαριασμός Υπερχρήστη</a></li><li><a href=http://172.16.201.134:1313/el/books/handbook/users/#users-system>14.4. Λογαριασμοί Συστήματος</a></li><li><a href=http://172.16.201.134:1313/el/books/handbook/users/#users-user>14.5. Λογαριασμοί Χρηστών</a></li><li><a href=http://172.16.201.134:1313/el/books/handbook/users/#users-modifying>14.6. Τροποποιώντας Λογαριασμούς</a></li><li><a href=http://172.16.201.134:1313/el/books/handbook/users/#users-limiting>14.7. Περιορίζοντας Χρήστες</a></li><li><a href=http://172.16.201.134:1313/el/books/handbook/users/#users-groups>14.8. Ομάδες</a></li></ul></li><li><input type=checkbox id=chapter-917c75fcffbb14d48ed6d0a48e7028f2 class=toggle>
<label class="icon cursor" for=chapter-917c75fcffbb14d48ed6d0a48e7028f2><a role=button></a></label><a href=http://172.16.201.134:1313/el/books/handbook/security/>Κεφάλαιο 15. Ασφάλεια</a><ul><li><a href=http://172.16.201.134:1313/el/books/handbook/security/#security-synopsis>15.1. Σύνοψη</a></li><li><a href=http://172.16.201.134:1313/el/books/handbook/security/#security-intro>15.2. Introduction</a></li><li><a href=http://172.16.201.134:1313/el/books/handbook/security/#securing-freebsd>15.3. Securing FreeBSD</a></li><li><a href=http://172.16.201.134:1313/el/books/handbook/security/#crypt>15.4. DES, MD5, and Crypt</a></li><li><a href=http://172.16.201.134:1313/el/books/handbook/security/#one-time-passwords>15.5. One-time Passwords</a></li><li><a href=http://172.16.201.134:1313/el/books/handbook/security/#tcpwrappers>15.6. TCP Wrappers</a></li><li><a href=http://172.16.201.134:1313/el/books/handbook/security/#kerberosIV>15.7. KerberosIV</a></li><li><a href=http://172.16.201.134:1313/el/books/handbook/security/#kerberos5>15.8. Kerberos5</a></li><li><a href=http://172.16.201.134:1313/el/books/handbook/security/#openssl>15.9. OpenSSL</a></li><li><a href=http://172.16.201.134:1313/el/books/handbook/security/#ipsec>15.10. VPN over IPsec</a></li><li><a href=http://172.16.201.134:1313/el/books/handbook/security/#openssh>15.11. OpenSSH</a></li><li><a href=http://172.16.201.134:1313/el/books/handbook/security/#fs-acl>15.12. File System Access Control Lists</a></li><li><a href=http://172.16.201.134:1313/el/books/handbook/security/#security-portaudit>15.13. Monitoring Third Party Security Issues</a></li><li><a href=http://172.16.201.134:1313/el/books/handbook/security/#security-advisories>15.14. FreeBSD Security Advisories</a></li><li><a href=http://172.16.201.134:1313/el/books/handbook/security/#security-accounting>15.15. Process Accounting</a></li></ul></li><li><input type=checkbox id=chapter-1a2a8e719703649c2c66d99aa7a25fd4 class=toggle>
<label class="icon cursor" for=chapter-1a2a8e719703649c2c66d99aa7a25fd4><a role=button></a></label><a href=http://172.16.201.134:1313/el/books/handbook/jails/>Κεφάλαιο 16. Jails</a><ul><li><a href=http://172.16.201.134:1313/el/books/handbook/jails/#jails-synopsis>16.1. Σύνοψη</a></li><li><a href=http://172.16.201.134:1313/el/books/handbook/jails/#jails-terms>16.2. Όροι των Jails</a></li><li><a href=http://172.16.201.134:1313/el/books/handbook/jails/#jails-intro>16.3. Εισαγωγή</a></li><li><a href=http://172.16.201.134:1313/el/books/handbook/jails/#jails-build>16.4. Δημιουργώντας και Ελέγχοντας Jails</a></li><li><a href=http://172.16.201.134:1313/el/books/handbook/jails/#jails-tuning>16.5. Λεπτομερής Ρύθμιση και Διαχείριση</a></li><li><a href=http://172.16.201.134:1313/el/books/handbook/jails/#jails-application>16.6. Εφαρμογή των Jails</a></li></ul></li><li><input type=checkbox id=chapter-8f4620c77e572cbb58917911a33c73cf class=toggle>
<label class="icon cursor" for=chapter-8f4620c77e572cbb58917911a33c73cf><a role=button></a></label><a href=http://172.16.201.134:1313/el/books/handbook/mac/>Κεφάλαιο 17. Υποχρεωτικός Έλεγχος Πρόσβασης</a><ul><li><a href=http://172.16.201.134:1313/el/books/handbook/mac/#mac-synopsis>17.1. Σύνοψη</a></li><li><a href=http://172.16.201.134:1313/el/books/handbook/mac/#mac-inline-glossary>17.2. Key Terms in this Chapter</a></li><li><a href=http://172.16.201.134:1313/el/books/handbook/mac/#mac-initial>17.3. Explanation of MAC</a></li><li><a href=http://172.16.201.134:1313/el/books/handbook/mac/#mac-understandlabel>17.4. Understanding MAC Labels</a></li><li><a href=http://172.16.201.134:1313/el/books/handbook/mac/#mac-planning>17.5. Planning the Security Configuration</a></li><li><a href=http://172.16.201.134:1313/el/books/handbook/mac/#mac-modules>17.6. Module Configuration</a></li><li><a href=http://172.16.201.134:1313/el/books/handbook/mac/#mac-bsdextended>17.7. The MAC bsdextended Module</a></li><li><a href=http://172.16.201.134:1313/el/books/handbook/mac/#mac-ifoff>17.8. The MAC ifoff Module</a></li><li><a href=http://172.16.201.134:1313/el/books/handbook/mac/#mac-portacl>17.9. The MAC portacl Module</a></li><li><a href=http://172.16.201.134:1313/el/books/handbook/mac/#mac-partition>17.10. The MAC partition Module</a></li><li><a href=http://172.16.201.134:1313/el/books/handbook/mac/#mac-mls>17.11. The MAC Multi-Level Security Module</a></li><li><a href=http://172.16.201.134:1313/el/books/handbook/mac/#mac-biba>17.12. The MAC Biba Module</a></li><li><a href=http://172.16.201.134:1313/el/books/handbook/mac/#mac-lomac>17.13. The MAC LOMAC Module</a></li><li><a href=http://172.16.201.134:1313/el/books/handbook/mac/#mac-implementing>17.14. Nagios in a MAC Jail</a></li><li><a href=http://172.16.201.134:1313/el/books/handbook/mac/#mac-userlocked>17.15. User Lock Down</a></li><li><a href=http://172.16.201.134:1313/el/books/handbook/mac/#mac-troubleshoot>17.16. Troubleshooting the MAC Framework</a></li></ul></li><li><input type=checkbox id=chapter-9598d66a76cb3182057b6bcd775149a0 class=toggle>
<label class="icon cursor" for=chapter-9598d66a76cb3182057b6bcd775149a0><a role=button></a></label><a href=http://172.16.201.134:1313/el/books/handbook/audit/>Κεφάλαιο 18. Έλεγχος Συμβάντων Ασφαλείας</a><ul><li><a href=http://172.16.201.134:1313/el/books/handbook/audit/#audit-synopsis>31.1. Σύνοψη</a></li><li><a href=http://172.16.201.134:1313/el/books/handbook/audit/#audit-inline-glossary>31.2. Key Terms in this Chapter</a></li><li><a href=http://172.16.201.134:1313/el/books/handbook/audit/#audit-install>31.3. Installing Audit Support</a></li><li><a href=http://172.16.201.134:1313/el/books/handbook/audit/#audit-config>31.4. Audit Configuration</a></li><li><a href=http://172.16.201.134:1313/el/books/handbook/audit/#audit-administration>31.5. Administering the Audit Subsystem</a></li></ul></li><li><input type=checkbox id=chapter-e1edcad13d9db6e8e4cb645d378ecfaf class=toggle checked>
<label class="icon cursor" for=chapter-e1edcad13d9db6e8e4cb645d378ecfaf><a role=button></a></label><a href=http://172.16.201.134:1313/el/books/handbook/disks/>Κεφάλαιο 19. Αποθηκευτικά Μέσα</a><ul><li><a href=http://172.16.201.134:1313/el/books/handbook/disks/#disks-synopsis>19.1. Σύνοψη</a></li><li><a href=http://172.16.201.134:1313/el/books/handbook/disks/#disks-naming>19.2. Device Names</a></li><li><a href=http://172.16.201.134:1313/el/books/handbook/disks/#disks-adding>19.3. Adding Disks</a></li><li><a href=http://172.16.201.134:1313/el/books/handbook/disks/#usb-disks>19.4. USB Storage Devices</a></li><li><a href=http://172.16.201.134:1313/el/books/handbook/disks/#creating-cds>19.5. Creating and Using CD Media</a></li><li><a href=http://172.16.201.134:1313/el/books/handbook/disks/#creating-dvds>19.6. Creating and Using DVD Media</a></li><li><a href=http://172.16.201.134:1313/el/books/handbook/disks/#floppies>19.7. Creating and Using Floppy Disks</a></li><li><a href=http://172.16.201.134:1313/el/books/handbook/disks/#backups-tapebackups>19.8. Creating and Using Data Tapes</a></li><li><a href=http://172.16.201.134:1313/el/books/handbook/disks/#backup-strategies>19.9. Backup Strategies</a></li><li><a href=http://172.16.201.134:1313/el/books/handbook/disks/#backup-basics>19.10. Backup Basics</a></li><li><a href=http://172.16.201.134:1313/el/books/handbook/disks/#disks-virtual>19.11. Network, Memory, and File-Backed File Systems</a></li><li><a href=http://172.16.201.134:1313/el/books/handbook/disks/#snapshots>19.12. File System Snapshots</a></li><li><a href=http://172.16.201.134:1313/el/books/handbook/disks/#quotas>19.13. File System Quotas</a></li><li><a href=http://172.16.201.134:1313/el/books/handbook/disks/#disks-encrypting>19.14. Encrypting Disk Partitions</a></li><li><a href=http://172.16.201.134:1313/el/books/handbook/disks/#swap-encrypting>19.15. Encrypting Swap Space</a></li><li><a href=http://172.16.201.134:1313/el/books/handbook/disks/#disks-hast>19.16. Highly Available Storage (HAST)</a></li></ul></li><li><input type=checkbox id=chapter-dde37901a0e0ea32745b67607854900f class=toggle>
<label class="icon cursor" for=chapter-dde37901a0e0ea32745b67607854900f><a role=button></a></label><a href=http://172.16.201.134:1313/el/books/handbook/geom/>Κεφάλαιο 20. GEOM: Διαχείριση Συστοιχιών Δίσκων</a><ul><li><a href=http://172.16.201.134:1313/el/books/handbook/geom/#GEOM-synopsis>20.1. Σύνοψη</a></li><li><a href=http://172.16.201.134:1313/el/books/handbook/geom/#GEOM-intro>20.2. Εισαγωγή στο GEOM</a></li><li><a href=http://172.16.201.134:1313/el/books/handbook/geom/#GEOM-striping>20.3. RAID0 - Striping</a></li><li><a href=http://172.16.201.134:1313/el/books/handbook/geom/#GEOM-mirror>20.4. RAID1 - Mirroring</a></li><li><a href=http://172.16.201.134:1313/el/books/handbook/geom/#GEOM-raid3>20.5. RAID3 - Striping σε Επίπεδο Byte με Αφοσιωμένο Parity</a></li><li><a href=http://172.16.201.134:1313/el/books/handbook/geom/#geom-ggate>20.6. Δικτυακές Συσκευές μέσω GEOM Gate</a></li><li><a href=http://172.16.201.134:1313/el/books/handbook/geom/#geom-glabel>20.7. Δημιουργώντας Ετικέτες (Labels) στις Συσκευές Δίσκων</a></li><li><a href=http://172.16.201.134:1313/el/books/handbook/geom/#geom-gjournal>20.8. UFS Journaling Μέσω GEOM</a></li></ul></li><li><input type=checkbox id=chapter-7af71270807eb7b70cd3eedc6577b254 class=toggle>
<label class="icon cursor" for=chapter-7af71270807eb7b70cd3eedc6577b254><a role=button></a></label><a href=http://172.16.201.134:1313/el/books/handbook/filesystems/>Κεφάλαιο 21. Υποστήριξη Συστημάτων Αρχείων</a><ul><li><a href=http://172.16.201.134:1313/el/books/handbook/filesystems/#filesystems-synopsis>21.1. Σύνοψη</a></li><li><a href=http://172.16.201.134:1313/el/books/handbook/filesystems/#filesystems-zfs>21.2. Το Σύστημα Αρχείων Z (ZFS)</a></li><li><a href=http://172.16.201.134:1313/el/books/handbook/filesystems/#filesystems-linux>21.3. Συστήματα Αρχείων Linux®</a></li></ul></li><li><input type=checkbox id=chapter-375257268d95faaf87faf4f7a2e6aa67 class=toggle>
<label class="icon cursor" for=chapter-375257268d95faaf87faf4f7a2e6aa67><a role=button></a></label><a href=http://172.16.201.134:1313/el/books/handbook/virtualization/>Κεφάλαιο 22. Εικονικοποίηση</a><ul><li><a href=http://172.16.201.134:1313/el/books/handbook/virtualization/#virtualization-synopsis>22.1. Σύνοψη</a></li><li><a href=http://172.16.201.134:1313/el/books/handbook/virtualization/#virtualization-guest>22.2. Το FreeBSD ως φιλοξενούμενο λειτουργικό</a></li><li><a href=http://172.16.201.134:1313/el/books/handbook/virtualization/#virtualization-host>22.3. Το FreeBSD ως Ξενιστής (Host)</a></li></ul></li><li><input type=checkbox id=chapter-49f1e96591c090304ea532012257f4ef class=toggle>
<label class="icon cursor" for=chapter-49f1e96591c090304ea532012257f4ef><a role=button></a></label><a href=http://172.16.201.134:1313/el/books/handbook/l10n/>Κεφάλαιο 23. Τοπικές Ρυθμίσεις - Χρήση και ρύθμιση I18N/L10N</a><ul><li><a href=http://172.16.201.134:1313/el/books/handbook/l10n/#l10n-synopsis>23.1. Σύνοψη</a></li><li><a href=http://172.16.201.134:1313/el/books/handbook/l10n/#l10n-basics>23.2. Βασικές Γνώσεις</a></li><li><a href=http://172.16.201.134:1313/el/books/handbook/l10n/#using-localization>23.3. Χρήση των Τοπικών Ρυθμίσεων</a></li><li><a href=http://172.16.201.134:1313/el/books/handbook/l10n/#l10n-compiling>23.4. Μεταγλώττιση Προγραμμάτων I18N</a></li><li><a href=http://172.16.201.134:1313/el/books/handbook/l10n/#lang-setup>23.5. Τοπικές Ρυθμίσεις για Συγκεκριμένες Γλώσσες</a></li></ul></li><li><input type=checkbox id=chapter-dead2b4c5ea325dd390a9b0dccd8f763 class=toggle>
<label class="icon cursor" for=chapter-dead2b4c5ea325dd390a9b0dccd8f763><a role=button></a></label><a href=http://172.16.201.134:1313/el/books/handbook/cutting-edge/>Κεφάλαιο 24. Ενημέρωση και Αναβάθμιση του FreeBSD</a><ul><li><a href=http://172.16.201.134:1313/el/books/handbook/cutting-edge/#updating-upgrading-synopsis>24.1. Σύνοψη</a></li><li><a href=http://172.16.201.134:1313/el/books/handbook/cutting-edge/#updating-upgrading-freebsdupdate>24.2. Ενημερώνοντας το FreeBSD</a></li><li><a href=http://172.16.201.134:1313/el/books/handbook/cutting-edge/#updating-upgrading-portsnap>24.3. Portsnap: Ένα Εργαλείο Ενημέρωσης της Συλλογής των Ports</a></li><li><a href=http://172.16.201.134:1313/el/books/handbook/cutting-edge/#updating-upgrading-documentation>24.4. Ενημερώνοντας την Τεκμηρίωση</a></li><li><a href=http://172.16.201.134:1313/el/books/handbook/cutting-edge/#current-stable>24.5. Παρακολούθηση Ενός Κλάδου Ανάπτυξης</a></li><li><a href=http://172.16.201.134:1313/el/books/handbook/cutting-edge/#synching>24.6. Συγχρονίζοντας τον Πηγαίο σας Κώδικα</a></li><li><a href=http://172.16.201.134:1313/el/books/handbook/cutting-edge/#makeworld>24.7. Μεταγλωττίζοντας το Βασικό Σύστημα ("world")</a></li><li><a href=http://172.16.201.134:1313/el/books/handbook/cutting-edge/#make-delete-old>24.8. Διαγραφή Παρωχημένων Αρχείων, Καταλόγων και Βιβλιοθηκών</a></li><li><a href=http://172.16.201.134:1313/el/books/handbook/cutting-edge/#small-lan>24.9. Διαδικασία για Πολλαπλά Μηχανήματα</a></li></ul></li><li><input type=checkbox id=chapter-29c1eeb0e9dedc487a98399e2737ee8a class=toggle>
<label class="icon cursor" for=chapter-29c1eeb0e9dedc487a98399e2737ee8a><a role=button></a></label><a href=http://172.16.201.134:1313/el/books/handbook/dtrace/>Κεφάλαιο 25. DTrace</a><ul><li><a href=http://172.16.201.134:1313/el/books/handbook/dtrace/#dtrace-synopsis>25.1. Σύνοψη</a></li><li><a href=http://172.16.201.134:1313/el/books/handbook/dtrace/#dtrace-implementation>25.2. Διαφορές στην Υλοποίηση</a></li><li><a href=http://172.16.201.134:1313/el/books/handbook/dtrace/#dtrace-enable>25.3. Ενεργοποίηση της Υποστήριξης DTrace</a></li><li><a href=http://172.16.201.134:1313/el/books/handbook/dtrace/#dtrace-using>25.4. Χρησιμοποιώντας το DTrace</a></li><li><a href=http://172.16.201.134:1313/el/books/handbook/dtrace/#dtrace-language>25.5. Η Γλώσσα D</a></li></ul></li><li><input type=checkbox id=chapter-bbd25f9a194f9c39ca2d658c75767db5 class=toggle>
<label for=chapter-bbd25f9a194f9c39ca2d658c75767db5><a role=button></a></label><a href=http://172.16.201.134:1313/el/books/handbook/partiv/>Μέρος IV. Δικτυακές Επικοινωνίες</a></li><li><input type=checkbox id=chapter-499dab596afd7ddac77e80295314e0dd class=toggle>
<label class="icon cursor" for=chapter-499dab596afd7ddac77e80295314e0dd><a role=button></a></label><a href=http://172.16.201.134:1313/el/books/handbook/serialcomms/>Κεφάλαιο 26. Σειριακές Επικοινωνίες</a><ul><li><a href=http://172.16.201.134:1313/el/books/handbook/serialcomms/#serial-synopsis>26.1. Σύνοψη</a></li><li><a href=http://172.16.201.134:1313/el/books/handbook/serialcomms/#serial>26.2. Εισαγωγή</a></li><li><a href=http://172.16.201.134:1313/el/books/handbook/serialcomms/#term>26.3. Τερματικά</a></li><li><a href=http://172.16.201.134:1313/el/books/handbook/serialcomms/#dialup>26.4. Υπηρεσία Εισόδου μέσω Επιλογικής Σύνδεσης (dial-in)</a></li><li><a href=http://172.16.201.134:1313/el/books/handbook/serialcomms/#dialout>26.5. Υπηρεσία Επιλογικής Σύνδεσης</a></li><li><a href=http://172.16.201.134:1313/el/books/handbook/serialcomms/#serialconsole-setup>26.6. Ρύθμιση της Σειριακής Κονσόλας</a></li></ul></li><li><input type=checkbox id=chapter-95e4571c48bee1cced5e84a538d302e3 class=toggle>
<label class="icon cursor" for=chapter-95e4571c48bee1cced5e84a538d302e3><a role=button></a></label><a href=http://172.16.201.134:1313/el/books/handbook/ppp-and-slip/>Κεφάλαιο 27. PPP και SLIP</a><ul><li><a href=http://172.16.201.134:1313/el/books/handbook/ppp-and-slip/#ppp-and-slip-synopsis>27.1. Σύνοψη</a></li><li><a href=http://172.16.201.134:1313/el/books/handbook/ppp-and-slip/#userppp>27.2. Χρησιμοποιώντας το PPP Χρήστη</a></li><li><a href=http://172.16.201.134:1313/el/books/handbook/ppp-and-slip/#ppp>27.3. Χρησιμοποιώντας το PPP του Πυρήνα</a></li><li><a href=http://172.16.201.134:1313/el/books/handbook/ppp-and-slip/#ppp-troubleshoot>27.4. Αντιμετώπιση Προβλημάτων σε Συνδέσεις PPP</a></li><li><a href=http://172.16.201.134:1313/el/books/handbook/ppp-and-slip/#pppoe>27.5. Χρησιμοποιώντας PPP μέσω Ethernet (PPPoE)</a></li><li><a href=http://172.16.201.134:1313/el/books/handbook/ppp-and-slip/#pppoa>27.6. Χρησιμοποιώντας PPP μέσω ATM (PPPoA)</a></li><li><a href=http://172.16.201.134:1313/el/books/handbook/ppp-and-slip/#slip>27.7. Χρησιμοποιώντας το SLIP</a></li></ul></li><li><input type=checkbox id=chapter-f089ac726c401c9b4bd5c34a295e11bb class=toggle>
<label class="icon cursor" for=chapter-f089ac726c401c9b4bd5c34a295e11bb><a role=button></a></label><a href=http://172.16.201.134:1313/el/books/handbook/mail/>Κεφάλαιο 28. Ηλεκτρονικό Ταχυδρομείο</a><ul><li><a href=http://172.16.201.134:1313/el/books/handbook/mail/#mail-synopsis>28.1. Σύνοψη</a></li><li><a href=http://172.16.201.134:1313/el/books/handbook/mail/#mail-using>28.2. Χρησιμοποιώντας το Ηλεκτρονικό Ταχυδρομείο</a></li><li><a href=http://172.16.201.134:1313/el/books/handbook/mail/#sendmail>28.3. Ρύθμιση του sendmail</a></li><li><a href=http://172.16.201.134:1313/el/books/handbook/mail/#mail-changingmta>28.4. Αλλάζοντας τον Αντιπρόσωπο Μεταφοράς Ταχυδρομείου (MTA)</a></li><li><a href=http://172.16.201.134:1313/el/books/handbook/mail/#mail-trouble>28.5. Αντιμετώπιση Προβλημάτων</a></li><li><a href=http://172.16.201.134:1313/el/books/handbook/mail/#mail-advanced>28.6. Προχωρημένα Θέματα</a></li><li><a href=http://172.16.201.134:1313/el/books/handbook/mail/#SMTP-UUCP>28.7. SMTP με UUCP</a></li><li><a href=http://172.16.201.134:1313/el/books/handbook/mail/#outgoing-only>28.8. Ρύθμιση Εξυπηρετητή Μόνο για Αποστολή</a></li><li><a href=http://172.16.201.134:1313/el/books/handbook/mail/#SMTP-dialup>28.9. Χρησιμοποιώντας το Mail Μέσω Επιλογικής (Dialup) Σύνδεσης</a></li><li><a href=http://172.16.201.134:1313/el/books/handbook/mail/#SMTP-Auth>28.10. Πιστοποίηση Αυθεντικότητας στο SMTP</a></li><li><a href=http://172.16.201.134:1313/el/books/handbook/mail/#mail-agents>28.11. Προγράμματα Ταχυδρομείου για τον Χρήστη</a></li><li><a href=http://172.16.201.134:1313/el/books/handbook/mail/#mail-fetchmail>28.12. Χρησιμοποιώντας το fetchmail</a></li><li><a href=http://172.16.201.134:1313/el/books/handbook/mail/#mail-procmail>28.13. Χρησιμοποιώντας το procmail</a></li></ul></li><li><input type=checkbox id=chapter-6de4de3fe925639d4175ce4b6f8c1829 class=toggle>
<label class="icon cursor" for=chapter-6de4de3fe925639d4175ce4b6f8c1829><a role=button></a></label><a href=http://172.16.201.134:1313/el/books/handbook/network-servers/>Κεφάλαιο 29. Εξυπηρετητές Δικτύου</a><ul><li><a href=http://172.16.201.134:1313/el/books/handbook/network-servers/#network-servers-synopsis>29.1. Σύνοψη</a></li><li><a href=http://172.16.201.134:1313/el/books/handbook/network-servers/#network-inetd>29.2. The inetd"Super-Server"</a></li><li><a href=http://172.16.201.134:1313/el/books/handbook/network-servers/#network-nfs>29.3. Network File System (NFS)</a></li><li><a href=http://172.16.201.134:1313/el/books/handbook/network-servers/#network-nis>29.4. Network Information System (NIS/YP)</a></li><li><a href=http://172.16.201.134:1313/el/books/handbook/network-servers/#network-dhcp>29.5. Automatic Network Configuration (DHCP)</a></li><li><a href=http://172.16.201.134:1313/el/books/handbook/network-servers/#network-dns>29.6. Domain Name System (DNS)</a></li><li><a href=http://172.16.201.134:1313/el/books/handbook/network-servers/#network-apache>29.7. Ο εξυπηρετητής HTTP Apache</a></li><li><a href=http://172.16.201.134:1313/el/books/handbook/network-servers/#network-ftp>29.8. Πρωτόκολο Μεταφοράς Αρχείων (FTP)</a></li><li><a href=http://172.16.201.134:1313/el/books/handbook/network-servers/#network-samba>29.9. File and Print Services for Microsoft® Windows® clients (Samba)</a></li><li><a href=http://172.16.201.134:1313/el/books/handbook/network-servers/#network-ntp>29.10. Συγχρονισμός Ρολογιού Συστήματος με NTP</a></li></ul></li><li><input type=checkbox id=chapter-776d855c7b75e048f90b5c2c9b35ffe0 class=toggle>
<label class="icon cursor" for=chapter-776d855c7b75e048f90b5c2c9b35ffe0><a role=button></a></label><a href=http://172.16.201.134:1313/el/books/handbook/firewalls/>Κεφάλαιο 30. Firewalls</a><ul><li><a href=http://172.16.201.134:1313/el/books/handbook/firewalls/#firewalls-intro>30.1. Σύνοψη</a></li><li><a href=http://172.16.201.134:1313/el/books/handbook/firewalls/#firewalls-concepts>30.2. Βασικές Έννοιες των Firewalls</a></li><li><a href=http://172.16.201.134:1313/el/books/handbook/firewalls/#firewalls-apps>30.3. Προγράμματα Firewall</a></li><li><a href=http://172.16.201.134:1313/el/books/handbook/firewalls/#firewalls-pf>30.4. Το Packet Filter (PF) και το ALTQ του OpenBSD</a></li><li><a href=http://172.16.201.134:1313/el/books/handbook/firewalls/#firewalls-ipf>30.5. Το IPFILTER (IPF) Firewall</a></li><li><a href=http://172.16.201.134:1313/el/books/handbook/firewalls/#firewalls-ipfw>30.6. IPFW</a></li></ul></li><li><input type=checkbox id=chapter-5b07f776a0e6155c1c89aa0d15610380 class=toggle>
<label class="icon cursor" for=chapter-5b07f776a0e6155c1c89aa0d15610380><a role=button></a></label><a href=http://172.16.201.134:1313/el/books/handbook/advanced-networking/>Κεφάλαιο 31. Προχωρημένα Θέματα Δικτύωσης</a><ul><li><a href=http://172.16.201.134:1313/el/books/handbook/advanced-networking/#advanced-networking-synopsis>31.1. Σύνοψη</a></li><li><a href=http://172.16.201.134:1313/el/books/handbook/advanced-networking/#network-routing>31.2. Gateways and Routes</a></li><li><a href=http://172.16.201.134:1313/el/books/handbook/advanced-networking/#network-wireless>31.3. Wireless Networking</a></li><li><a href=http://172.16.201.134:1313/el/books/handbook/advanced-networking/#network-bluetooth>31.4. Bluetooth</a></li><li><a href=http://172.16.201.134:1313/el/books/handbook/advanced-networking/#network-bridging>31.5. Bridging</a></li><li><a href=http://172.16.201.134:1313/el/books/handbook/advanced-networking/#network-diskless>31.6. Diskless Operation</a></li><li><a href=http://172.16.201.134:1313/el/books/handbook/advanced-networking/#network-isdn>31.7. ISDN</a></li><li><a href=http://172.16.201.134:1313/el/books/handbook/advanced-networking/#network-natd>31.8. Network Address Translation</a></li><li><a href=http://172.16.201.134:1313/el/books/handbook/advanced-networking/#network-plip>31.9. Parallel Line IP (PLIP)</a></li><li><a href=http://172.16.201.134:1313/el/books/handbook/advanced-networking/#network-ipv6>31.10. IPv6</a></li><li><a href=http://172.16.201.134:1313/el/books/handbook/advanced-networking/#network-atm>31.11. Asynchronous Transfer Mode (ATM)</a></li><li><a href=http://172.16.201.134:1313/el/books/handbook/advanced-networking/#carp>31.12. Common Access Redundancy Protocol (CARP)</a></li></ul></li><li><input type=checkbox id=chapter-171a77aa9d067a1024f849470e1f33e8 class=toggle>
<label for=chapter-171a77aa9d067a1024f849470e1f33e8><a role=button></a></label><a href=http://172.16.201.134:1313/el/books/handbook/partv/>Μέρος V. Παραρτήματα</a></li><li><input type=checkbox id=chapter-8050f436a0a7986a4aaded93d8e49469 class=toggle>
<label class="icon cursor" for=chapter-8050f436a0a7986a4aaded93d8e49469><a role=button></a></label><a href=http://172.16.201.134:1313/el/books/handbook/mirrors/>Παράρτημα A. Που θα Βρείτε το FreeBSD</a><ul><li><a href=http://172.16.201.134:1313/el/books/handbook/mirrors/#mirrors-cdrom>A.1. Εκδόσεις σε CDROM και DVD</a></li><li><a href=http://172.16.201.134:1313/el/books/handbook/mirrors/#mirrors-ftp>A.2. Εξυπηρετητές FTP</a></li><li><a href=http://172.16.201.134:1313/el/books/handbook/mirrors/#anoncvs>A.3. Ανώνυμο CVS</a></li><li><a href=http://172.16.201.134:1313/el/books/handbook/mirrors/#ctm>A.4. Χρησιμοποιώντας το CTM</a></li><li><a href=http://172.16.201.134:1313/el/books/handbook/mirrors/#cvsup>A.5. Χρησιμοποιώντας το CVSup</a></li><li><a href=http://172.16.201.134:1313/el/books/handbook/mirrors/#cvs-tags>A.6. Ετικέτες (Tags) για το CVS</a></li><li><a href=http://172.16.201.134:1313/el/books/handbook/mirrors/#mirrors-afs>A.7. Τοποθεσίες AFS</a></li><li><a href=http://172.16.201.134:1313/el/books/handbook/mirrors/#mirrors-rsync>A.8. Τοποθεσίες rsync</a></li></ul></li><li><input type=checkbox id=chapter-128b630a8f88f158e7027fe6c2184d21 class=toggle>
<label class="icon cursor" for=chapter-128b630a8f88f158e7027fe6c2184d21><a role=button></a></label><a href=http://172.16.201.134:1313/el/books/handbook/bibliography/>Παράρτημα B. Βιβλιογραφία</a><ul><li><a href=http://172.16.201.134:1313/el/books/handbook/bibliography/#bibliography-freebsd>B.1. Βιβλία & Περιοδικά σχετικά με το FreeBSD</a></li><li><a href=http://172.16.201.134:1313/el/books/handbook/bibliography/#bibliography-userguides>B.2. Οδηγοί χρήστη</a></li><li><a href=http://172.16.201.134:1313/el/books/handbook/bibliography/#bibliography-adminguides>B.3. Οδηγοί διαχειριστή</a></li><li><a href=http://172.16.201.134:1313/el/books/handbook/bibliography/#bibliography-programmers>B.4. Οδηγοί προγραμματιστών</a></li><li><a href=http://172.16.201.134:1313/el/books/handbook/bibliography/#bibliography-osinternals>B.5. Το εσωτερικό του λειτουργικού συστήματος</a></li><li><a href=http://172.16.201.134:1313/el/books/handbook/bibliography/#bibliography-security>B.6. Αναφορές ασφαλείας</a></li><li><a href=http://172.16.201.134:1313/el/books/handbook/bibliography/#bibliography-hardware>B.7. Αναφορές υλικού</a></li><li><a href=http://172.16.201.134:1313/el/books/handbook/bibliography/#bibliography-history>B.8. Ιστορία του UNIX®</a></li><li><a href=http://172.16.201.134:1313/el/books/handbook/bibliography/#bibliography-journals>B.9. Περιοδικά και εφημερίδες</a></li></ul></li><li><input type=checkbox id=chapter-8bbb8867c46dac315e2253945d8c18a8 class=toggle>
<label class="icon cursor" for=chapter-8bbb8867c46dac315e2253945d8c18a8><a role=button></a></label><a href=http://172.16.201.134:1313/el/books/handbook/eresources/>Παράρτημα C. Πηγές Πληροφόρησης στο Διαδίκτυο</a><ul><li><a href=http://172.16.201.134:1313/el/books/handbook/eresources/#eresources-mail>C.1. Λίστες Ηλεκτρονικού Ταχυδρομείου</a></li><li><a href=http://172.16.201.134:1313/el/books/handbook/eresources/#eresources-news>C.2. Usenet Newsgroups</a></li><li><a href=http://172.16.201.134:1313/el/books/handbook/eresources/#eresources-web>C.3. Διακομιστές Ιστοσελίδων</a></li><li><a href=http://172.16.201.134:1313/el/books/handbook/eresources/#eresources-email>C.4. Διευθύνσεις Ηλεκτρονικού Ταχυδρομείου</a></li></ul></li><li><input type=checkbox id=chapter-a80ea4f5a4480b8725422710f954ef36 class=toggle>
<label class="icon cursor" for=chapter-a80ea4f5a4480b8725422710f954ef36><a role=button></a></label><a href=http://172.16.201.134:1313/el/books/handbook/pgpkeys/>Παράρτημα D. Κλειδιά PGP</a><ul><li><a href=http://172.16.201.134:1313/el/books/handbook/pgpkeys/#pgpkeys-officers>D.1. Officers</a></li></ul></li><li></li></ul></nav></div></aside><div class=book><div class=book-menu-mobile><label for=menu-control><span class=menu-control-button><i class="fa fa-list" aria-hidden=true title="Book menu"></i>
Book menu</span></label></div><h1 class=title>Κεφάλαιο 19. Αποθηκευτικά Μέσα</h1><div class="admonitionblock note"><p><i class="fa fa-exclamation-circle" aria-hidden=true></i>
This translation may be out of date. To help with the translations please access the <a href=https://translate-dev.freebsd.org/ target=_blank>FreeBSD translations instance</a>.</p></div><div class=toc-mobile><h3>Πίνακας περιεχομένων</h3><nav id=TableOfContents><ul><li><a href=#disks-synopsis>19.1. Σύνοψη</a></li><li><a href=#disks-naming>19.2. Device Names</a></li><li><a href=#disks-adding>19.3. Adding Disks</a></li><li><a href=#usb-disks>19.4. USB Storage Devices</a></li><li><a href=#creating-cds>19.5. Creating and Using CD Media</a></li><li><a href=#creating-dvds>19.6. Creating and Using DVD Media</a></li><li><a href=#floppies>19.7. Creating and Using Floppy Disks</a></li><li><a href=#backups-tapebackups>19.8. Creating and Using Data Tapes</a></li><li><a href=#backup-strategies>19.9. Backup Strategies</a></li><li><a href=#backup-basics>19.10. Backup Basics</a></li><li><a href=#disks-virtual>19.11. Network, Memory, and File-Backed File Systems</a></li><li><a href=#snapshots>19.12. File System Snapshots</a></li><li><a href=#quotas>19.13. File System Quotas</a></li><li><a href=#disks-encrypting>19.14. Encrypting Disk Partitions</a></li><li><a href=#swap-encrypting>19.15. Encrypting Swap Space</a></li><li><a href=#disks-hast>19.16. Highly Available Storage (HAST)</a></li></ul></nav></div><div class=book-content><div id=preamble><div class=sectionbody></div></div><div class=sect1><h2 id=disks-synopsis>19.1. Σύνοψη<a class=anchor href=#disks-synopsis></a></h2><div class=sectionbody><div class=paragraph><p>Το κεφάλαιο αυτό καλύπτει την χρήση των δίσκων στο FreeBSD. Περιλαμβάνει δίσκους που υποστηρίζονται από μνήμη, δίσκους συνδεδεμένους απευθείας στο δίκτυο, τις τυπικές συσκευές αποθήκευσης SCSI/IDE, καθώς και συσκευές που χρησιμοποιούν διεπαφή USB.</p></div><div class=paragraph><p>Αφού διαβάσετε αυτό το κεφάλαιο, θα ξέρετε:</p></div><div class=ulist><ul><li><p>Την ορολογία που χρησιμοποιεί το FreeBSD για να περιγράψει την οργάνωση των δεδομένων στο φυσικό μέσο του δίσκου (partitions - κατατμήσεις - και slices).</p></li><li><p>Πως να προσθέσετε νέους σκληρούς δίσκους στο σύστημα σας.</p></li><li><p>Πως να ρυθμίσετε το FreeBSD να χρησιμοποιεί συσκευές αποθήκευσης USB.</p></li><li><p>Πως να ρυθμίσετε εικονικά συστήματα αρχείων, όπως δίσκους που αποθηκεύονται σε μνήμη RAM.</p></li><li><p>Πως να χρησιμοποιήσετε quotas για να περιορίσετε τη χρήση χώρου στο δίσκο.</p></li><li><p>Πως να κρυπτογραφήσετε δίσκους για να τους ασφαλίσετε από επιθέσεις.</p></li><li><p>Πως να δημιουργήσετε και να γράψετε CD και DVD στο FreeBSD.</p></li><li><p>Πως να χρησιμοποιήσετε προγράμματα λήψης αντιγράφων ασφαλείας στο FreeBSD.</p></li><li><p>Τι είναι οι εικόνες (snapshots) σε ένα σύστημα αρχείων και πως να τις χρησιμοποιήσετε αποδοτικά.</p></li></ul></div><div class=paragraph><p>Πριν διαβάσετε αυτό το κεφάλαιο, θα πρέπει:</p></div><div class=ulist><ul><li><p>Να ξέρετε πως να <a href=../kernelconfig/#kernelconfig>ρυθμίσετε και να εγκαταστήσετε ένα νέο πυρήνα του FreeBSD</a>.</p></li></ul></div></div></div><div class=sect1><h2 id=disks-naming>19.2. Device Names<a class=anchor href=#disks-naming></a></h2><div class=sectionbody><div class=paragraph><p>The following is a list of physical storage devices supported in FreeBSD and their associated device names.</p></div><table id=disk-naming-physical-table class="tableblock frame-none grid-all stretch"><caption class=title>Πίνακας 1. Physical Disk Naming Conventions</caption><col style=width:50%><col style=width:50%><thead><tr><th class="tableblock halign-left valign-top">Drive type</th><th class="tableblock halign-left valign-top">Drive device name</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class=tableblock>IDE hard drives</p></td><td class="tableblock halign-left valign-top"><p class=tableblock><code>ad</code> or <code>ada</code></p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>IDE CD-ROM drives</p></td><td class="tableblock halign-left valign-top"><p class=tableblock><code>acd</code> or <code>cd</code></p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>SATA hard drives</p></td><td class="tableblock halign-left valign-top"><p class=tableblock><code>ad</code> or <code>ada</code></p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>SATA CD-ROM drives</p></td><td class="tableblock halign-left valign-top"><p class=tableblock><code>acd</code> or <code>cd</code></p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>SCSI hard drives and USB Mass storage devices</p></td><td class="tableblock halign-left valign-top"><p class=tableblock><code>da</code></p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>SCSI CD-ROM drives</p></td><td class="tableblock halign-left valign-top"><p class=tableblock><code>cd</code></p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>Assorted non-standard CD-ROM drives</p></td><td class="tableblock halign-left valign-top"><p class=tableblock><code>mcd</code> for Mitsumi CD-ROM and <code>scd</code> for Sony CD-ROM devices</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>Floppy drives</p></td><td class="tableblock halign-left valign-top"><p class=tableblock><code>fd</code></p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>SCSI tape drives</p></td><td class="tableblock halign-left valign-top"><p class=tableblock><code>sa</code></p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>IDE tape drives</p></td><td class="tableblock halign-left valign-top"><p class=tableblock><code>ast</code></p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>Flash drives</p></td><td class="tableblock halign-left valign-top"><p class=tableblock><code>fla</code> for DiskOnChip® Flash device</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>RAID drives</p></td><td class="tableblock halign-left valign-top"><p class=tableblock><code>aacd</code> for Adaptec® AdvancedRAID, <code>mlxd</code> and <code>mlyd</code> for Mylex®, <code>amrd</code> for AMI MegaRAID®, <code>idad</code> for Compaq Smart RAID, <code>twed</code> for 3ware® RAID.</p></td></tr></tbody></table></div></div><div class=sect1><h2 id=disks-adding>19.3. Adding Disks<a class=anchor href=#disks-adding></a></h2><div class=sectionbody><div class=paragraph><p>This section describes how to add a new SATA disk to a machine that currently only has a single drive. First, turn off the computer and install the drive in the computer following the instructions of the computer, controller, and drive manufacturers. Reboot the system and become <code>root</code>.</p></div><div class=paragraph><p>Inspect <span class=filename>/var/run/dmesg.boot</span> to ensure the new disk was found. In this example, the newly added SATA drive will appear as <span class=filename>ada1</span>.</p></div><div class=paragraph><p>For this example, a single large partition will be created on the new disk. The <a href=http://en.wikipedia.org/wiki/GUID_Partition_Table>GPT</a> partitioning scheme will be used in preference to the older and less versatile MBR scheme.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>If the disk to be added is not blank, old partition information can be removed with <code>gpart delete</code>. See <a href="https://man.freebsd.org/cgi/man.cgi?query=gpart&amp;sektion=8&amp;format=html">gpart(8)</a> for details.</p></div></td></tr></tbody></table></div><div class=paragraph><p>The partition scheme is created, and then a single partition is added:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># gpart create -s GPT ada1</span>
<span class=c># gpart add -t freebsd-ufs ada1</span></code></pre></div></div><div class=paragraph><p>Depending on use, several smaller partitions may be desired. See <a href="https://man.freebsd.org/cgi/man.cgi?query=gpart&amp;sektion=8&amp;format=html">gpart(8)</a> for options to create partitions smaller than a whole disk.</p></div><div class=paragraph><p>A file system is created on the new blank disk:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># newfs -U /dev/ada1p1</span></code></pre></div></div><div class=paragraph><p>An empty directory is created as a <em>mountpoint</em>, a location for mounting the new disk in the original disk’s file system:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># mkdir /newdisk</span></code></pre></div></div><div class=paragraph><p>Finally, an entry is added to <span class=filename>/etc/fstab</span> so the new disk will be mounted automatically at startup:</p></div><div class="literalblock programlisting"><div class=content><pre>/dev/ada1p1	/newdisk	ufs	rw	2	2</pre></div></div><div class=paragraph><p>The new disk can be mounted manually, without restarting the system:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># mount /newdisk</span></code></pre></div></div></div></div><div class=sect1><h2 id=usb-disks>19.4. USB Storage Devices<a class=anchor href=#usb-disks></a></h2><div class=sectionbody><div class=paragraph><p>Many external storage solutions, such as hard drives, USB thumbdrives, and CD/DVD burners, use the Universal Serial Bus (USB). FreeBSD provides support for these devices.</p></div><div class=sect2><h3 id=_configuration>19.4.1. Configuration<a class=anchor href=#_configuration></a></h3><div class=paragraph><p>The USB mass storage devices driver, <a href="https://man.freebsd.org/cgi/man.cgi?query=umass&amp;sektion=4&amp;format=html">umass(4)</a>, is built into the <span class=filename>GENERIC</span> kernel and provides support for USB storage devices. For a custom kernel, be sure that the following lines are present in the kernel configuration file:</p></div><div class="literalblock programlisting"><div class=content><pre>device scbus
device da
device pass
device uhci
device ohci
device ehci
device usb
device umass</pre></div></div><div class=paragraph><p>Since the <a href="https://man.freebsd.org/cgi/man.cgi?query=umass&amp;sektion=4&amp;format=html">umass(4)</a> driver uses the SCSI subsystem to access the USB storage devices, any USB device will be seen as a SCSI device by the system. Depending on the USB chipset on the motherboard, <code>device uhci</code> or <code>device ohci</code> is used to provide USB 1.X support. Support for USB 2.0 controllers is provided by <code>device ehci</code>.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>If the USB device is a CD or DVD burner, <a href="https://man.freebsd.org/cgi/man.cgi?query=cd&amp;sektion=4&amp;format=html">cd(4)</a>, must be added to the kernel via the line:</p></div><div class="literalblock programlisting"><div class=content><pre>device cd</pre></div></div><div class=paragraph><p>Since the burner is seen as a SCSI drive, the driver <a href="https://man.freebsd.org/cgi/man.cgi?query=atapicam&amp;sektion=4&amp;format=html">atapicam(4)</a> should not be used in the kernel configuration.</p></div></td></tr></tbody></table></div></div><div class=sect2><h3 id=_testing_the_configuration>19.4.2. Testing the Configuration<a class=anchor href=#_testing_the_configuration></a></h3><div class=paragraph><p>To test the USB configuration, plug in the USB device. In the system message buffer, <a href="https://man.freebsd.org/cgi/man.cgi?query=dmesg&amp;sektion=8&amp;format=html">dmesg(8)</a>, the drive should appear as something like:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>umass0: USB Solid state disk, rev 1.10/1.00, addr 2
GEOM: create disk da0 <span class=nv>dp</span><span class=o>=</span>0xc2d74850
da0 at umass-sim0 bus 0 target 0 lun 0
da0: &lt;Generic Traveling Disk 1.11&gt; Removable Direct Access SCSI-2 device
da0: 1.000MB/s transfers
da0: 126MB <span class=o>(</span>258048 512 byte sectors: 64H 32S/T 126C<span class=o>)</span></code></pre></div></div><div class=paragraph><p>The brand, device node (<span class=filename>da0</span>), and other details will differ according to the device.</p></div><div class=paragraph><p>Since the USB device is seen as a SCSI one, <code>camcontrol</code> can be used to list the USB storage devices attached to the system:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># camcontrol devlist</span>
&lt;Generic Traveling Disk 1.11&gt;      at scbus0 target 0 lun 0 <span class=o>(</span>da0,pass0<span class=o>)</span></code></pre></div></div><div class=paragraph><p>If the drive comes with a file system, it can be mounted. Refer to <a href=#disks-adding>Adding Disks</a> for instructions on how to format and create partitions on the USB drive.</p></div><div class="admonitionblock warning"><table><tbody><tr><td class=icon><i class="fa icon-warning" title=Warning></i></td><td class=content><div class=paragraph><p>Allowing untrusted users to mount arbitrary media, by enabling <code>vfs.usermount</code> as described below, should not be considered safe from a security point of view. Most file systems in FreeBSD were not built to safeguard against malicious devices.</p></div></td></tr></tbody></table></div><div class=paragraph><p>To make the device mountable as a normal user, one solution is to make all users of the device a member of the <code>operator</code> group using <a href="https://man.freebsd.org/cgi/man.cgi?query=pw&amp;sektion=8&amp;format=html">pw(8)</a>. Next, ensure that the <code>operator</code> group is able to read and write the device by adding these lines to <span class=filename>/etc/devfs.rules</span>:</p></div><div class="literalblock programlisting"><div class=content><pre>[localrules=5]
add path &#39;da*&#39; mode 0660 group operator</pre></div></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>If SCSI disks are installed in the system, change the second line as follows:</p></div><div class="literalblock programlisting"><div class=content><pre>add path &#39;da[3-9]*&#39; mode 0660 group operator</pre></div></div><div class=paragraph><p>This will exclude the first three SCSI disks (<span class=filename>da0</span> to <span class=filename>da2</span>)from belonging to the <code>operator</code> group.</p></div></td></tr></tbody></table></div><div class=paragraph><p>Next, enable the <a href="https://man.freebsd.org/cgi/man.cgi?query=devfs.rules&amp;sektion=5&amp;format=html">devfs.rules(5)</a> ruleset in <span class=filename>/etc/rc.conf</span>:</p></div><div class="literalblock programlisting"><div class=content><pre>devfs_system_ruleset=&#34;localrules&#34;</pre></div></div><div class=paragraph><p>Next, instruct the running kernel to allow regular users to mount file systems. The easiest way is to add the following line to <span class=filename>/etc/sysctl.conf</span>:</p></div><div class="literalblock programlisting"><div class=content><pre>vfs.usermount=1</pre></div></div><div class=paragraph><p>Since this only takes effect after the next reboot use <a href="https://man.freebsd.org/cgi/man.cgi?query=sysctl&amp;sektion=8&amp;format=html">sysctl(8)</a> to set this variable now.</p></div><div class=paragraph><p>The final step is to create a directory where the file system is to be mounted. This directory needs to be owned by the user that is to mount the file system. One way to do that is for <code>root</code> to create a subdirectory owned by that user as <span class=filename>/mnt/username</span>. In the following example, replace <em>username</em> with the login name of the user and <em>usergroup</em> with the user’s primary group:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># mkdir /mnt/username</span>
<span class=c># chown username:usergroup /mnt/username</span></code></pre></div></div><div class=paragraph><p>Suppose a USB thumbdrive is plugged in, and a device <span class=filename>/dev/da0s1</span> appears. If the device is preformatted with a FAT file system, it can be mounted using:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>% mount <span class=nt>-t</span> msdosfs <span class=nt>-o</span> <span class=nt>-m</span><span class=o>=</span>644,-M<span class=o>=</span>755 /dev/da0s1 /mnt/username</code></pre></div></div><div class=paragraph><p>Before the device can be unplugged, it <em>must</em> be unmounted first. After device removal, the system message buffer will show messages similar to the following:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>umass0: at uhub0 port 1 <span class=o>(</span>addr 2<span class=o>)</span> disconnected
<span class=o>(</span>da0:umass-sim0:0:0:0<span class=o>)</span>: lost device
<span class=o>(</span>da0:umass-sim0:0:0:0<span class=o>)</span>: removing device entry
GEOM: destroy disk da0 <span class=nv>dp</span><span class=o>=</span>0xc2d74850
umass0: detached</code></pre></div></div></div><div class=sect2><h3 id=_further_reading>19.4.3. Further Reading<a class=anchor href=#_further_reading></a></h3><div class=paragraph><p>Beside the <a href=#disks-adding>Adding Disks</a> and <a href=../basics/#mount-unmount>Mounting and Unmounting File Systems</a> sections, reading various manual pages may also be useful: <a href="https://man.freebsd.org/cgi/man.cgi?query=umass&amp;sektion=4&amp;format=html">umass(4)</a>, <a href="https://man.freebsd.org/cgi/man.cgi?query=camcontrol&amp;sektion=8&amp;format=html">camcontrol(8)</a>, and <a href="https://man.freebsd.org/cgi/man.cgi?query=usbconfig&amp;sektion=8&amp;format=html">usbconfig(8)</a> under FreeBSD 8.X or <a href="https://man.freebsd.org/cgi/man.cgi?query=usbdevs&amp;sektion=8&amp;format=html">usbdevs(8)</a> under earlier versions of FreeBSD.</p></div></div></div></div><div class=sect1><h2 id=creating-cds>19.5. Creating and Using CD Media<a class=anchor href=#creating-cds></a></h2><div class=sectionbody><div class=sect2><h3 id=_introduction>19.5.1. Introduction<a class=anchor href=#_introduction></a></h3><div class=paragraph><p>CD media provide a number of features that differentiate them from conventional disks. Initially, they were not writable by the user. They are designed so that they can be read continuously without delays to move the head between tracks. They are also much easier to transport between systems.</p></div><div class=paragraph><p>CD media do have tracks, but this refers to a section of data to be read continuously and not a physical property of the disk. For example, to produce a CD on FreeBSD, prepare the data files that are going to make up the tracks on the CD, then write the tracks to the CD.</p></div><div class=paragraph><p>The ISO 9660 file system was designed to deal with these differences. To overcome the original file system limits, it provides an extension mechanism that allows properly written CDs to exceed those limits while still working with systems that do not support those extensions.</p></div><div class=paragraph><p>The <a class=package href=https://cgit.freebsd.org/ports/tree/sysutils/cdrtools/>sysutils/cdrtools</a> port includes <a href="https://man.freebsd.org/cgi/man.cgi?query=mkisofs&amp;sektion=8&amp;format=html">mkisofs(8)</a>, a program that can be used to produce a data file containing an ISO 9660 file system. It has options that support various extensions, and is described below.</p></div><div class=paragraph><p>Which tool to use to burn the CD depends on whether the CD burner is ATAPI or something else. ATAPI CD burners use <code>burncd</code> which is part of the base system. SCSI and USB CD burners should use <code>cdrecord</code> from the <a class=package href=https://cgit.freebsd.org/ports/tree/sysutils/cdrtools/>sysutils/cdrtools</a> port. It is also possible to use <code>cdrecord</code> and other tools for SCSI drives on ATAPI hardware with the <a href=#atapicam>ATAPI/CAM module</a>.</p></div><div class=paragraph><p>For CD burning software with a graphical user interface, consider X-CD-Roast or K3b. These tools are available as packages or from the <a class=package href=https://cgit.freebsd.org/ports/tree/sysutils/xcdroast/>sysutils/xcdroast</a> and <a class=package href=https://cgit.freebsd.org/ports/tree/sysutils/k3b/>sysutils/k3b</a> ports. X-CD-Roast and K3b require the <a href=#atapicam>ATAPI/CAM module</a> with ATAPI hardware.</p></div></div><div class=sect2><h3 id=mkisofs>19.5.2. mkisofs<a class=anchor href=#mkisofs></a></h3><div class=paragraph><p>The <a class=package href=https://cgit.freebsd.org/ports/tree/sysutils/cdrtools/>sysutils/cdrtools</a> port also installs <a href="https://man.freebsd.org/cgi/man.cgi?query=mkisofs&amp;sektion=8&amp;format=html">mkisofs(8)</a>, which produces an ISO 9660 file system that is an image of a directory tree in the UNIX® file system name space. The simplest usage is:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># mkisofs -o imagefile.iso /path/to/tree</span></code></pre></div></div><div class=paragraph><p>This command creates an <em>imagefile.iso</em> containing an ISO 9660 file system that is a copy of the tree at <em>/path/to/tree</em>. In the process, it maps the file names to names that fit the limitations of the standard ISO 9660 file system, and will exclude files that have names uncharacteristic of ISO file systems.</p></div><div class=paragraph><p>A number of options are available to overcome these restrictions. In particular, <code>-R</code> enables the Rock Ridge extensions common to UNIX® systems, <code>-J</code> enables Joliet extensions used by Microsoft systems, and <code>-hfs</code> can be used to create HFS file systems used by Mac OS®.</p></div><div class=paragraph><p>For CDs that are going to be used only on FreeBSD systems, <code>-U</code> can be used to disable all filename restrictions. When used with <code>-R</code>, it produces a file system image that is identical to the specified FreeBSD tree, though it may violate the ISO 9660 standard in a number of ways.</p></div><div class=paragraph><p>The last option of general use is <code>-b</code>. This is used to specify the location of the boot image for use in producing an "El Torito" bootable CD. This option takes an argument which is the path to a boot image from the top of the tree being written to the CD. By default, <a href="https://man.freebsd.org/cgi/man.cgi?query=mkisofs&amp;sektion=8&amp;format=html">mkisofs(8)</a> creates an ISO image in "floppy disk emulation" mode, and thus expects the boot image to be exactly 1200, 1440 or 2880 KB in size. Some boot loaders, like the one used by the FreeBSD distribution disks, do not use emulation mode. In this case, <code>-no-emul-boot</code> should be used. So, if <span class=filename>/tmp/myboot</span> holds a bootable FreeBSD system with the boot image in <span class=filename>/tmp/myboot/boot/cdboot</span>, this command would produce the image of an ISO 9660 file system as <span class=filename>/tmp/bootable.iso</span>:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># mkisofs -R -no-emul-boot -b boot/cdboot -o /tmp/bootable.iso /tmp/myboot</span></code></pre></div></div><div class=paragraph><p>If <span class=filename>md</span> is configured in the kernel, the file system can be mounted as a memory disk with:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># mdconfig -a -t vnode -f /tmp/bootable.iso -u 0</span>
<span class=c># mount -t cd9660 /dev/md0 /mnt</span></code></pre></div></div><div class=paragraph><p>One can then verify that <span class=filename>/mnt</span> and <span class=filename>/tmp/myboot</span> are identical.</p></div><div class=paragraph><p>There are many other options available for <a href="https://man.freebsd.org/cgi/man.cgi?query=mkisofs&amp;sektion=8&amp;format=html">mkisofs(8)</a> to fine-tune its behavior. Refer to <a href="https://man.freebsd.org/cgi/man.cgi?query=mkisofs&amp;sektion=8&amp;format=html">mkisofs(8)</a> for details.</p></div></div><div class=sect2><h3 id=burncd>19.5.3. burncd<a class=anchor href=#burncd></a></h3><div class=paragraph><p>For an ATAPI CD burner, <code>burncd</code> can be used to burn an ISO image onto a CD. <code>burncd</code> is part of the base system, installed as <span class=filename>/usr/sbin/burncd</span>. Usage is very simple, as it has few options:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># burncd -f cddevice data imagefile.iso fixate</span></code></pre></div></div><div class=paragraph><p>This command will burn a copy of <em>imagefile.iso</em> on <em>cddevice</em>. The default device is <span class=filename>/dev/acd0</span>. See <a href="https://man.freebsd.org/cgi/man.cgi?query=burncd&amp;sektion=8&amp;format=html">burncd(8)</a> for options to set the write speed, eject the CD after burning, and write audio data.</p></div></div><div class=sect2><h3 id=cdrecord>19.5.4. cdrecord<a class=anchor href=#cdrecord></a></h3><div class=paragraph><p>For systems without an ATAPI CD burner, <code>cdrecord</code> can be used to burn CDs. <code>cdrecord</code> is not part of the base system and must be installed from either the <a class=package href=https://cgit.freebsd.org/ports/tree/sysutils/cdrtools/>sysutils/cdrtools</a> package or port. Changes to the base system can cause binary versions of this program to fail, possibly resulting in a "coaster". It is recommended to either upgrade the port when the system is upgraded, or for users <a href=../cutting-edge/#stable>tracking -STABLE</a>, to upgrade the port when a new version becomes available.</p></div><div class=paragraph><p>While <code>cdrecord</code> has many options, basic usage is simple. Burning an ISO 9660 image is done with:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># cdrecord dev=device imagefile.iso</span></code></pre></div></div><div class=paragraph><p>The tricky part of using <code>cdrecord</code> is finding the <code>dev</code> to use. To find the proper setting, use <code>-scanbus</code> which might produce results like this:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># cdrecord -scanbus</span>
Cdrecord-Clone 2.01 <span class=o>(</span>i386-unknown-freebsd7.0<span class=o>)</span> Copyright <span class=o>(</span>C<span class=o>)</span> 1995-2004 J<span class=s2>&#34;org Schilling
Using libscg version &#39;schily-0.1&#39;
scsibus0:
        0,0,0     0) &#39;SEAGATE &#39; &#39;ST39236LW       &#39; &#39;0004&#39; Disk
        0,1,0     1) &#39;SEAGATE &#39; &#39;ST39173W        &#39; &#39;5958&#39; Disk
        0,2,0     2) *
        0,3,0     3) &#39;iomega  &#39; &#39;jaz 1GB         &#39; &#39;J.86&#39; Removable Disk
        0,4,0     4) &#39;NEC     &#39; &#39;CD-ROM DRIVE:466&#39; &#39;1.26&#39; Removable CD-ROM
        0,5,0     5) *
        0,6,0     6) *
        0,7,0     7) *
scsibus1:
        1,0,0   100) *
        1,1,0   101) *
        1,2,0   102) *
        1,3,0   103) *
        1,4,0   104) *
        1,5,0   105) &#39;YAMAHA  &#39; &#39;CRW4260         &#39; &#39;1.0q&#39; Removable CD-ROM
        1,6,0   106) &#39;ARTEC   &#39; &#39;AM12S           &#39; &#39;1.06&#39; Scanner
        1,7,0   107) *</span></code></pre></div></div><div class=paragraph><p>This lists the appropriate <code>dev</code> value for the devices on the list. Locate the CD burner, and use the three numbers separated by commas as the value for <code>dev</code>. In this case, the CRW device is 1,5,0, so the appropriate input is <code>dev=1,5,0</code>. Refer to <a href="https://man.freebsd.org/cgi/man.cgi?query=cdrecord&amp;sektion=1&amp;format=html">cdrecord(1)</a> for easier ways to specify this value and for information on writing audio tracks and controlling the write speed.</p></div></div><div class=sect2><h3 id=duplicating-audiocds>19.5.5. Duplicating Audio CDs<a class=anchor href=#duplicating-audiocds></a></h3><div class=paragraph><p>To duplicate an audio CD, extract the audio data from the CD to a series of files, then write these files to a blank CD. The process is slightly different for ATAPI and SCSI drives.</p></div><div class="olist arabic procedure"><div class=title>Procedure: SCSI Drives</div><ol class=arabic><li><p>Use <code>cdda2wav</code> to extract the audio:</p><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>% cdda2wav <span class=nt>-vall</span> <span class=nt>-D2</span>,0 <span class=nt>-B</span> <span class=nt>-Owav</span></code></pre></div></div></li><li><p>Use <code>cdrecord</code> to write the <span class=filename>.wav</span> files:</p><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>% cdrecord <span class=nt>-v</span> <span class=nv>dev</span><span class=o>=</span>2,0 <span class=nt>-dao</span> <span class=nt>-useinfo</span>  <span class=k>*</span>.wav</code></pre></div></div><div class=paragraph><p>Make sure that <em>2,0</em> is set appropriately, as described in <a href=#cdrecord>cdrecord</a>.</p></div></li></ol></div><div class="exampleblock procedure"><div class=content><div class=paragraph><p><strong>Procedure: ATAPI Drives</strong></p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>With the help of the <a href=#atapicam>ATAPI/CAM module</a>, <code>cdda2wav</code> can also be used on ATAPI drives. This tool is usually a better choice for most of users, as it supports jitter correction and endianness, than the method proposed below.</p></div></td></tr></tbody></table></div><div class="olist arabic"><ol class=arabic><li><p>The ATAPI CD driver makes each track available as <span class=filename>/dev/acddtnn</span>, where <em>d</em> is the drive number, and <em>nn</em> is the track number written with two decimal digits, prefixed with zero as needed. So the first track on the first disk is <span class=filename>/dev/acd0t01</span>, the second is <span class=filename>/dev/acd0t02</span>, the third is <span class=filename>/dev/acd0t03</span>, and so on.</p><div class=paragraph><p>Make sure the appropriate files exist in <span class=filename>/dev</span>. If the entries are missing, force the system to retaste the media:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># dd if=/dev/acd0 of=/dev/null count=1</span></code></pre></div></div></li><li><p>Extract each track using <a href="https://man.freebsd.org/cgi/man.cgi?query=dd&amp;sektion=1&amp;format=html">dd(1)</a>, making sure to specify a block size when extracting the files:</p><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># dd if=/dev/acd0t01 of=track1.cdr bs=2352</span>
<span class=c># dd if=/dev/acd0t02 of=track2.cdr bs=2352</span>
...</code></pre></div></div></li><li><p>Burn the extracted files to disk using <code>burncd</code>. Specify that these are audio files, and that <code>burncd</code> should fixate the disk when finished:</p><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># burncd -f /dev/acd0 audio track1.cdr track2.cdr ... fixate</span></code></pre></div></div></li></ol></div></div></div></div><div class=sect2><h3 id=imaging-cd>19.5.6. Duplicating Data CDs<a class=anchor href=#imaging-cd></a></h3><div class=paragraph><p>It is possible to copy a data CD to an image file that is functionally equivalent to the image file created with <a href="https://man.freebsd.org/cgi/man.cgi?query=mkisofs&amp;sektion=8&amp;format=html">mkisofs(8)</a>, and then use it to duplicate any data CD. The example given here assumes that the CD-ROM device is <span class=filename>acd0</span>. Substitute the correct CD-ROM device.</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># dd if=/dev/acd0 of=file.iso bs=2048</span></code></pre></div></div><div class=paragraph><p>Now that there is an image, it can be burned to CD as described above.</p></div></div><div class=sect2><h3 id=mounting-cd>19.5.7. Using Data CDs<a class=anchor href=#mounting-cd></a></h3><div class=paragraph><p>It is possible to mount and read the data on a standard data CD. By default, <a href="https://man.freebsd.org/cgi/man.cgi?query=mount&amp;sektion=8&amp;format=html">mount(8)</a> assumes that a file system is of type <code>ufs</code>. Running this command:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># mount /dev/cd0 /mnt</span></code></pre></div></div><div class=paragraph><p>will generate an error about <code>Incorrect super block</code>, and will fail to mount the CD. The CD does not use the <code>UFS</code> file system, so attempts to mount it as such will fail. Instead, tell <a href="https://man.freebsd.org/cgi/man.cgi?query=mount&amp;sektion=8&amp;format=html">mount(8)</a> that the file system is of type <code>ISO9660</code> by specifying <code>-t cd9660</code> to <a href="https://man.freebsd.org/cgi/man.cgi?query=mount&amp;sektion=8&amp;format=html">mount(8)</a>. For example, to mount the CD-ROM device, <span class=filename>/dev/cd0</span>, under <span class=filename>/mnt</span>, use:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># mount -t cd9660 /dev/cd0 /mnt</span></code></pre></div></div><div class=paragraph><p>Replace <span class=filename>/dev/cd0</span> with the device name for the CD device. Also, <code>-t cd9660</code> executes <a href="https://man.freebsd.org/cgi/man.cgi?query=mount_cd9660&amp;sektion=8&amp;format=html">mount_cd9660(8)</a>, meaning the above command is equivalent to:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># mount_cd9660 /dev/cd0 /mnt</span></code></pre></div></div><div class=paragraph><p>While data CD-ROMs from any vendor can be mounted this way, disks with certain ISO 9660 extensions might behave oddly. For example, Joliet disks store all filenames in two-byte Unicode characters. The FreeBSD kernel does not speak Unicode, but the FreeBSD CD9660 driver is able to convert Unicode characters on the fly. If some non-English characters show up as question marks, specify the local charset with <code>-C</code>. For more information, refer to <a href="https://man.freebsd.org/cgi/man.cgi?query=mount_cd9660&amp;sektion=8&amp;format=html">mount_cd9660(8)</a>.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>In order to do this character conversion with the help of <code>-C</code>, the kernel requires the <span class=filename>cd9660_iconv.ko</span> module to be loaded. This can be done either by adding this line to <span class=filename>loader.conf</span>:</p></div><div class="literalblock programlisting"><div class=content><pre>cd9660_iconv_load=&#34;YES&#34;</pre></div></div><div class=paragraph><p>and then rebooting the machine, or by directly loading the module with <a href="https://man.freebsd.org/cgi/man.cgi?query=kldload&amp;sektion=8&amp;format=html">kldload(8)</a>.</p></div></td></tr></tbody></table></div><div class=paragraph><p>Occasionally, <code>Device not configured</code> will be displayed when trying to mount a CD-ROM. This usually means that the CD-ROM drive thinks that there is no disk in the tray, or that the drive is not visible on the bus. It can take a couple of seconds for a CD-ROM drive to realize that a media is present, so be patient.</p></div><div class=paragraph><p>Sometimes, a SCSI CD-ROM may be missed because it did not have enough time to answer the bus reset. To resolve this, add the following option to the kernel configuration and <a href=../kernelconfig/#kernelconfig-building>rebuild the kernel</a>.</p></div><div class="literalblock programlisting"><div class=content><pre>options SCSI_DELAY=15000</pre></div></div><div class=paragraph><p>This tells the SCSI bus to pause 15 seconds during boot, to give the CD-ROM drive every possible chance to answer the bus reset.</p></div></div><div class=sect2><h3 id=rawdata-cd>19.5.8. Burning Raw Data CDs<a class=anchor href=#rawdata-cd></a></h3><div class=paragraph><p>It is possible to burn a file directly to CD, without creating an ISO 9660 file system. Some people do this for backup purposes. This command runs more quickly than burning a standard CD:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># burncd -f /dev/acd1 -s 12 data archive.tar.gz fixate</span></code></pre></div></div><div class=paragraph><p>In order to retrieve the data burned to such a CD, the data must be read from the raw device node:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># tar xzvf /dev/acd1</span></code></pre></div></div><div class=paragraph><p>This type of disk can not be mounted as a normal CD-ROM and the data cannot be read under any operating system except FreeBSD. In order to mount the CD, or to share the data with another operating system, <a href="https://man.freebsd.org/cgi/man.cgi?query=mkisofs&amp;sektion=8&amp;format=html">mkisofs(8)</a> must be used as described above.</p></div></div><div class=sect2><h3 id=atapicam>19.5.9. Using the ATAPI/CAM Driver<a class=anchor href=#atapicam></a></h3><div class=paragraph><p>This driver allows ATAPI devices, such as CD/DVD drives, to be accessed through the SCSI subsystem, and so allows the use of applications like <a class=package href=https://cgit.freebsd.org/ports/tree/sysutils/cdrdao/>sysutils/cdrdao</a> or <a href="https://man.freebsd.org/cgi/man.cgi?query=cdrecord&amp;sektion=1&amp;format=html">cdrecord(1)</a>.</p></div><div class=paragraph><p>To use this driver, add the following line to <span class=filename>/boot/loader.conf</span>:</p></div><div class="literalblock programlisting"><div class=content><pre>atapicam_load=&#34;YES&#34;</pre></div></div><div class=paragraph><p>then, reboot the system.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Users who prefer to statically compile <a href="https://man.freebsd.org/cgi/man.cgi?query=atapicam&amp;sektion=4&amp;format=html">atapicam(4)</a> support into the kernel, should add this line to the kernel configuration file:</p></div><div class="literalblock programlisting"><div class=content><pre>device atapicam</pre></div></div><div class=paragraph><p>Ensure the following lines are still in the kernel configuration file:</p></div><div class="literalblock programlisting"><div class=content><pre>device ata
device scbus
device cd
device pass</pre></div></div><div class=paragraph><p>Then rebuild, install the new kernel, and reboot the machine.</p></div></td></tr></tbody></table></div><div class=paragraph><p>During the boot process, the burner should show up, like so:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>acd0: CD-RW &lt;MATSHITA CD-RW/DVD-ROM UJDA740&gt; at ata1-master PIO4
cd0 at ata1 bus 0 target 0 lun 0
cd0: &lt;MATSHITA CDRW/DVD UJDA740 1.00&gt; Removable CD-ROM SCSI-0 device
cd0: 16.000MB/s transfers
cd0: Attempt to query device size failed: NOT READY, Medium not present - tray closed</code></pre></div></div><div class=paragraph><p>The drive can now be accessed via the <span class=filename>/dev/cd0</span> device name. For example, to mount a CD-ROM on <span class=filename>/mnt</span>, type the following:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># mount -t cd9660 /dev/cd0 /mnt</span></code></pre></div></div><div class=paragraph><p>As <code>root</code>, run the following command to get the SCSI address of the burner:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># camcontrol devlist</span>
&lt;MATSHITA CDRW/DVD UJDA740 1.00&gt;   at scbus1 target 0 lun 0 <span class=o>(</span>pass0,cd0<span class=o>)</span></code></pre></div></div><div class=paragraph><p>In this example, <code>1,0,0</code> is the SCSI address to use with <a href="https://man.freebsd.org/cgi/man.cgi?query=cdrecord&amp;sektion=1&amp;format=html">cdrecord(1)</a> and other SCSI applications.</p></div><div class=paragraph><p>For more information about ATAPI/CAM and SCSI system, refer to <a href="https://man.freebsd.org/cgi/man.cgi?query=atapicam&amp;sektion=4&amp;format=html">atapicam(4)</a> and <a href="https://man.freebsd.org/cgi/man.cgi?query=cam&amp;sektion=4&amp;format=html">cam(4)</a>.</p></div></div></div></div><div class=sect1><h2 id=creating-dvds>19.6. Creating and Using DVD Media<a class=anchor href=#creating-dvds></a></h2><div class=sectionbody><div class=sect2><h3 id=_introduction_2>19.6.1. Introduction<a class=anchor href=#_introduction_2></a></h3><div class=paragraph><p>Compared to the CD, the DVD is the next generation of optical media storage technology. The DVD can hold more data than any CD and is the standard for video publishing.</p></div><div class=paragraph><p>Five physical recordable formats can be defined for a recordable DVD:</p></div><div class=ulist><ul><li><p>DVD-R: This was the first DVD recordable format available. The DVD-R standard is defined by the <a href=http://www.dvdforum.com/forum.shtml>DVD Forum</a>. This format is write once.</p></li><li><p>DVD-RW: This is the rewritable version of the DVD-R standard. A DVD-RW can be rewritten about 1000 times.</p></li><li><p>DVD-RAM: This is a rewritable format which can be seen as a removable hard drive. However, this media is not compatible with most DVD-ROM drives and DVD-Video players as only a few DVD writers support the DVD-RAM format. Refer to <a href=#creating-dvd-ram>Using a DVD-RAM</a> for more information on DVD-RAM use.</p></li><li><p>DVD+RW: This is a rewritable format defined by the <a href=http://www.dvdrw.com/>DVD+RW Alliance</a>. A DVD+RW can be rewritten about 1000 times.</p></li><li><p>DVD+R: This format is the write once variation of the DVD+RW format.</p></li></ul></div><div class=paragraph><p>A single layer recordable DVD can hold up to 4,700,000,000 bytes which is actually 4.38 GB or 4485 MB as 1 kilobyte is 1024 bytes.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>A distinction must be made between the physical media and the application. For example, a DVD-Video is a specific file layout that can be written on any recordable DVD physical media such as DVD-R, DVD+R, or DVD-RW. Before choosing the type of media, ensure that both the burner and the DVD-Video player are compatible with the media under consideration.</p></div></td></tr></tbody></table></div></div><div class=sect2><h3 id=_configuration_2>19.6.2. Configuration<a class=anchor href=#_configuration_2></a></h3><div class=paragraph><p>To perform DVD recording, use <a href="https://man.freebsd.org/cgi/man.cgi?query=growisofs&amp;sektion=1&amp;format=html">growisofs(1)</a>. This command is part of the <a class=package href=https://cgit.freebsd.org/ports/tree/sysutils/dvd+rw-tools/>sysutils/dvd+rw-tools</a> utilities which support all DVD media types.</p></div><div class=paragraph><p>These tools use the SCSI subsystem to access the devices, therefore <a href=#atapicam>ATAPI/CAM support</a> must be loaded or statically compiled into the kernel. This support is not needed if the burner uses the USB interface. Refer to <a href=#usb-disks>USB Storage Devices</a> for more details on USB device configuration.</p></div><div class=paragraph><p>DMA access must also be enabled for ATAPI devices, by adding the following line to <span class=filename>/boot/loader.conf</span>:</p></div><div class="literalblock programlisting"><div class=content><pre>hw.ata.atapi_dma=&#34;1&#34;</pre></div></div><div class=paragraph><p>Before attempting to use dvd+rw-tools, consult the <a href=http://fy.chalmers.se/~appro/linux/DVD+RW/hcn.html>Hardware Compatibility Notes</a>.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>For a graphical user interface, consider using <a class=package href=https://cgit.freebsd.org/ports/tree/sysutils/k3b/>sysutils/k3b</a> which provides a user friendly interface to <a href="https://man.freebsd.org/cgi/man.cgi?query=growisofs&amp;sektion=1&amp;format=html">growisofs(1)</a> and many other burning tools.</p></div></td></tr></tbody></table></div></div><div class=sect2><h3 id=_burning_data_dvds>19.6.3. Burning Data DVDs<a class=anchor href=#_burning_data_dvds></a></h3><div class=paragraph><p>Since <a href="https://man.freebsd.org/cgi/man.cgi?query=growisofs&amp;sektion=1&amp;format=html">growisofs(1)</a> is a front-end to <a href=#mkisofs>mkisofs</a>, it will invoke <a href="https://man.freebsd.org/cgi/man.cgi?query=mkisofs&amp;sektion=8&amp;format=html">mkisofs(8)</a> to create the file system layout and perform the write on the DVD. This means that an image of the data does not need to be created before the burning process.</p></div><div class=paragraph><p>To burn to a DVD+R or a DVD-R the data in <span class=filename>/path/to/data</span>, use the following command:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># growisofs -dvd-compat -Z /dev/cd0 -J -R /path/to/data</span></code></pre></div></div><div class=paragraph><p>In this example, <code>-J -R</code> is passed to <a href="https://man.freebsd.org/cgi/man.cgi?query=mkisofs&amp;sektion=8&amp;format=html">mkisofs(8)</a> to create an ISO 9660 file system with Joliet and Rock Ridge extensions. Refer to <a href="https://man.freebsd.org/cgi/man.cgi?query=mkisofs&amp;sektion=8&amp;format=html">mkisofs(8)</a> for more details.</p></div><div class=paragraph><p>For the initial session recording, <code>-Z</code> is used for both single and multiple sessions. Replace <em>/dev/cd0</em>, with the name of the DVD device. Using <code>-dvd-compat</code> indicates that the disk will be closed and that the recording will be unappendable. This should also provide better media compatibility with DVD-ROM drives.</p></div><div class=paragraph><p>To burn a pre-mastered image, such as <em>imagefile.iso</em>, use:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># growisofs -dvd-compat -Z /dev/cd0=imagefile.iso</span></code></pre></div></div><div class=paragraph><p>The write speed should be detected and automatically set according to the media and the drive being used. To force the write speed, use <code>-speed=</code>. Refer to <a href="https://man.freebsd.org/cgi/man.cgi?query=growisofs&amp;sektion=1&amp;format=html">growisofs(1)</a> for example usage.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>In order to support working files larger than 4.38GB, an UDF/ISO-9660 hybrid filesystem must be created by passing <code>-udf -iso-level 3</code> to <a href="https://man.freebsd.org/cgi/man.cgi?query=mkisofs&amp;sektion=8&amp;format=html">mkisofs(8)</a> and all related programs, such as <a href="https://man.freebsd.org/cgi/man.cgi?query=growisofs&amp;sektion=1&amp;format=html">growisofs(1)</a>. This is required only when creating an ISO image file or when writing files directly to a disk. Since a disk created this way must be mounted as an UDF filesystem with <a href="https://man.freebsd.org/cgi/man.cgi?query=mount_udf&amp;sektion=8&amp;format=html">mount_udf(8)</a>, it will be usable only on an UDF aware operating system. Otherwise it will look as if it contains corrupted files.</p></div><div class=paragraph><p>To create this type of ISO file:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>% mkisofs <span class=nt>-R</span> <span class=nt>-J</span> <span class=nt>-udf</span> <span class=nt>-iso-level</span> 3 <span class=nt>-o</span> imagefile.iso /path/to/data</code></pre></div></div><div class=paragraph><p>To burn files directly to a disk:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># growisofs -dvd-compat -udf -iso-level 3 -Z /dev/cd0 -J -R /path/to/data</span></code></pre></div></div><div class=paragraph><p>When an ISO image already contains large files, no additional options are required for <a href="https://man.freebsd.org/cgi/man.cgi?query=growisofs&amp;sektion=1&amp;format=html">growisofs(1)</a> to burn that image on a disk.</p></div><div class=paragraph><p>Be sure to use an up-to-date version of <a class=package href=https://cgit.freebsd.org/ports/tree/sysutils/cdrtools/>sysutils/cdrtools</a>, which contains <a href="https://man.freebsd.org/cgi/man.cgi?query=mkisofs&amp;sektion=8&amp;format=html">mkisofs(8)</a>, as an older version may not contain large files support. If the latest version does not work, install <a class=package href=https://cgit.freebsd.org/ports/tree/sysutils/cdrtools-devel/>sysutils/cdrtools-devel</a> and read its <a href="https://man.freebsd.org/cgi/man.cgi?query=mkisofs&amp;sektion=8&amp;format=html">mkisofs(8)</a>.</p></div></td></tr></tbody></table></div></div><div class=sect2><h3 id=_burning_a_dvd_video>19.6.4. Burning a DVD-Video<a class=anchor href=#_burning_a_dvd_video></a></h3><div class=paragraph><p>A DVD-Video is a specific file layout based on the ISO 9660 and micro-UDF (M-UDF) specifications. Since DVD-Video presents a specific data structure hierarchy, a particular program such as <a class=package href=https://cgit.freebsd.org/ports/tree/multimedia/dvdauthor/>multimedia/dvdauthor</a> is needed to author the DVD.</p></div><div class=paragraph><p>If an image of the DVD-Video file system already exists, it can be burned in the same way as any other image. If <code>dvdauthor</code> was used to make the DVD and the result is in <span class=filename>/path/to/video</span>, the following command should be used to burn the DVD-Video:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># growisofs -Z /dev/cd0 -dvd-video /path/to/video</span></code></pre></div></div><div class=paragraph><p><code>-dvd-video</code> is passed to <a href="https://man.freebsd.org/cgi/man.cgi?query=mkisofs&amp;sektion=8&amp;format=html">mkisofs(8)</a> to instruct it to create a DVD-Video file system layout. This option implies the <code>-dvd-compat</code> <a href="https://man.freebsd.org/cgi/man.cgi?query=growisofs&amp;sektion=1&amp;format=html">growisofs(1)</a> option.</p></div></div><div class=sect2><h3 id=_using_a_dvdrw>19.6.5. Using a DVD+RW<a class=anchor href=#_using_a_dvdrw></a></h3><div class=paragraph><p>Unlike CD-RW, a virgin DVD+RW needs to be formatted before first use. It is <em>recommended</em> to let <a href="https://man.freebsd.org/cgi/man.cgi?query=growisofs&amp;sektion=1&amp;format=html">growisofs(1)</a> take care of this automatically whenever appropriate. However, it is possible to use <code>dvd+rw-format</code> to format the DVD+RW:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># dvd+rw-format /dev/cd0</span></code></pre></div></div><div class=paragraph><p>Only perform this operation once and keep in mind that only virgin DVD+RW medias need to be formatted. Once formatted, the DVD+RW can be burned as usual.</p></div><div class=paragraph><p>To burn a totally new file system and not just append some data onto a DVD+RW, the media does not need to be blanked first. Instead, write over the previous recording like this:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># growisofs -Z /dev/cd0 -J -R /path/to/newdata</span></code></pre></div></div><div class=paragraph><p>The DVD+RW format supports appending data to a previous recording. This operation consists of merging a new session to the existing one as it is not considered to be multi-session writing. <a href="https://man.freebsd.org/cgi/man.cgi?query=growisofs&amp;sektion=1&amp;format=html">growisofs(1)</a> will <em>grow</em> the ISO 9660 file system present on the media.</p></div><div class=paragraph><p>For example, to append data to a DVD+RW, use the following:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># growisofs -M /dev/cd0 -J -R /path/to/nextdata</span></code></pre></div></div><div class=paragraph><p>The same <a href="https://man.freebsd.org/cgi/man.cgi?query=mkisofs&amp;sektion=8&amp;format=html">mkisofs(8)</a> options used to burn the initial session should be used during next writes.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Use <code>-dvd-compat</code> for better media compatibility with DVD-ROM drives. When using DVD+RW, this option will not prevent the addition of data.</p></div></td></tr></tbody></table></div><div class=paragraph><p>To blank the media, use:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># growisofs -Z /dev/cd0=/dev/zero</span></code></pre></div></div></div><div class=sect2><h3 id=_using_a_dvd_rw>19.6.6. Using a DVD-RW<a class=anchor href=#_using_a_dvd_rw></a></h3><div class=paragraph><p>A DVD-RW accepts two disc formats: incremental sequential and restricted overwrite. By default, DVD-RW discs are in sequential format.</p></div><div class=paragraph><p>A virgin DVD-RW can be directly written without being formatted. However, a non-virgin DVD-RW in sequential format needs to be blanked before writing a new initial session.</p></div><div class=paragraph><p>To blank a DVD-RW in sequential mode:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># dvd+rw-format -blank=full /dev/cd0</span></code></pre></div></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>A full blanking using <code>-blank=full</code> will take about one hour on a 1x media. A fast blanking can be performed using <code>-blank</code>, if the DVD-RW will be recorded in Disk-At-Once (DAO) mode. To burn the DVD-RW in DAO mode, use the command:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># growisofs -use-the-force-luke=dao -Z /dev/cd0=imagefile.iso</span></code></pre></div></div><div class=paragraph><p>Since <a href="https://man.freebsd.org/cgi/man.cgi?query=growisofs&amp;sektion=1&amp;format=html">growisofs(1)</a> automatically attempts to detect fast blanked media and engage DAO write, <code>-use-the-force-luke=dao</code> should not be required.</p></div><div class=paragraph><p>One should instead use restricted overwrite mode with any DVD-RW as this format is more flexible than the default of incremental sequential.</p></div></td></tr></tbody></table></div><div class=paragraph><p>To write data on a sequential DVD-RW, use the same instructions as for the other DVD formats:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># growisofs -Z /dev/cd0 -J -R /path/to/data</span></code></pre></div></div><div class=paragraph><p>To append some data to a previous recording, use <code>-M</code> with <a href="https://man.freebsd.org/cgi/man.cgi?query=growisofs&amp;sektion=1&amp;format=html">growisofs(1)</a>. However, if data is appended on a DVD-RW in incremental sequential mode, a new session will be created on the disc and the result will be a multi-session disc.</p></div><div class=paragraph><p>A DVD-RW in restricted overwrite format does not need to be blanked before a new initial session. Instead, overwrite the disc with <code>-Z</code>. It is also possible to grow an existing ISO 9660 file system written on the disc with <code>-M</code>. The result will be a one-session DVD.</p></div><div class=paragraph><p>To put a DVD-RW in restricted overwrite format, the following command must be used:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># dvd+rw-format /dev/cd0</span></code></pre></div></div><div class=paragraph><p>To change back to sequential format, use:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># dvd+rw-format -blank=full /dev/cd0</span></code></pre></div></div></div><div class=sect2><h3 id=_multi_session>19.6.7. Multi-Session<a class=anchor href=#_multi_session></a></h3><div class=paragraph><p>Few DVD-ROM drives support multi-session DVDs and most of the time only read the first session. DVD+R, DVD-R and DVD-RW in sequential format can accept multiple sessions. The notion of multiple sessions does not exist for the DVD+RW and the DVD-RW restricted overwrite formats.</p></div><div class=paragraph><p>Using the following command after an initial non-closed session on a DVD+R, DVD-R, or DVD-RW in sequential format, will add a new session to the disc:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># growisofs -M /dev/cd0 -J -R /path/to/nextdata</span></code></pre></div></div><div class=paragraph><p>Using this command with a DVD+RW or a DVD-RW in restricted overwrite mode will append data while merging the new session to the existing one. The result will be a single-session disc. Use this method to add data after an initial write on these types of media.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Since some space on the media is used between each session to mark the end and start of sessions, one should add sessions with a large amount of data to optimize media space. The number of sessions is limited to 154 for a DVD+R, about 2000 for a DVD-R, and 127 for a DVD+R Double Layer.</p></div></td></tr></tbody></table></div></div><div class=sect2><h3 id=_for_more_information>19.6.8. For More Information<a class=anchor href=#_for_more_information></a></h3><div class=paragraph><p>To obtain more information about a DVD, use <code>dvd+rw-mediainfo /dev/cd0</code> while the disc in the specified drive.</p></div><div class=paragraph><p>More information about dvd+rw-tools can be found in <a href="https://man.freebsd.org/cgi/man.cgi?query=growisofs&amp;sektion=1&amp;format=html">growisofs(1)</a>, on the <a href=http://fy.chalmers.se/~appro/linux/DVD+RW/>dvd+rw-tools web site</a>, and in the <a href=http://lists.debian.org/cdwrite/>cdwrite mailing list</a> archives.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>When creating a problem report related to the use of dvd+rw-tools, always include the output of <code>dvd+rw-mediainfo</code>.</p></div></td></tr></tbody></table></div></div><div class=sect2><h3 id=creating-dvd-ram>19.6.9. Using a DVD-RAM<a class=anchor href=#creating-dvd-ram></a></h3><div class=sect3><h4 id=_configuration_3>19.6.9.1. Configuration<a class=anchor href=#_configuration_3></a></h4><div class=paragraph><p>DVD-RAM writers can use either a SCSI or ATAPI interface. For ATAPI devices, DMA access has to be enabled by adding the following line to <span class=filename>/boot/loader.conf</span>:</p></div><div class="literalblock programlisting"><div class=content><pre>hw.ata.atapi_dma=&#34;1&#34;</pre></div></div></div><div class=sect3><h4 id=_preparing_the_media>19.6.9.2. Preparing the Media<a class=anchor href=#_preparing_the_media></a></h4><div class=paragraph><p>A DVD-RAM can be seen as a removable hard drive. Like any other hard drive, the DVD-RAM must be formatted before it can be used. In this example, the whole disk space will be formatted with a standard UFS2 file system:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># dd if=/dev/zero of=/dev/acd0 bs=2k count=1</span>
<span class=c># bsdlabel -Bw acd0</span>
<span class=c># newfs /dev/acd0</span></code></pre></div></div><div class=paragraph><p>The DVD device, <span class=filename>acd0</span>, must be changed according to the configuration.</p></div></div><div class=sect3><h4 id=_using_the_media>19.6.9.3. Using the Media<a class=anchor href=#_using_the_media></a></h4><div class=paragraph><p>Once the DVD-RAM has been formatted, it can be mounted as a normal hard drive:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># mount /dev/acd0 /mnt</span></code></pre></div></div><div class=paragraph><p>Once mounted, the DVD-RAM will be both readable and writeable.</p></div></div></div></div></div><div class=sect1><h2 id=floppies>19.7. Creating and Using Floppy Disks<a class=anchor href=#floppies></a></h2><div class=sectionbody><div class=paragraph><p>Storing data on floppy disks is sometimes useful, for example when one does not have any other removable storage media or when one needs to transfer small amounts of data to another computer.</p></div><div class=paragraph><p>This section explains how to use floppy disks in FreeBSD. It covers formatting and usage of 3.5inch DOS floppies, but the concepts are similar for other floppy disk formats.</p></div><div class=sect2><h3 id=_formatting_floppies>19.7.1. Formatting Floppies<a class=anchor href=#_formatting_floppies></a></h3><div class=sect3><h4 id=_the_device>19.7.1.1. The Device<a class=anchor href=#_the_device></a></h4><div class=paragraph><p>Floppy disks are accessed through entries in <span class=filename>/dev</span>, just like other devices. To access the raw floppy disk, simply use <span class=filename>/dev/fdN</span>.</p></div></div><div class=sect3><h4 id=_formatting>19.7.1.2. Formatting<a class=anchor href=#_formatting></a></h4><div class=paragraph><p>A floppy disk needs to be low-level formatted before it can be used. This is usually done by the vendor, but formatting is a good way to check media integrity. Although it is possible to force other disk sizes, 1440kB is what most floppy disks are designed for.</p></div><div class=paragraph><p>To low-level format the floppy disk, use <a href="https://man.freebsd.org/cgi/man.cgi?query=fdformat&amp;sektion=1&amp;format=html">fdformat(1)</a>. This utility expects the device name as an argument.</p></div><div class=paragraph><p>Make note of any error messages, as these can help determine if the disk is good or bad.</p></div><div class=sect4><h5 id=_formatting_floppy_disks>19.7.1.2.1. Formatting Floppy Disks<a class=anchor href=#_formatting_floppy_disks></a></h5><div class=paragraph><p>To format the floppy, insert a new 3.5inch floppy disk into the first floppy drive and issue:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># /usr/sbin/fdformat -f 1440 /dev/fd0</span></code></pre></div></div></div></div></div><div class=sect2><h3 id=_the_disk_label>19.7.2. The Disk Label<a class=anchor href=#_the_disk_label></a></h3><div class=paragraph><p>After low-level formatting the disk, a disk label needs to placed on it. This disk label will be destroyed later, but it is needed by the system to determine the size of the disk and its geometry.</p></div><div class=paragraph><p>The new disk label will take over the whole disk and will contain all the proper information about the geometry of the floppy. The geometry values for the disk label are listed in <span class=filename>/etc/disktab</span>.</p></div><div class=paragraph><p>To write the disk label, use <a href="https://man.freebsd.org/cgi/man.cgi?query=bsdlabel&amp;sektion=8&amp;format=html">bsdlabel(8)</a>:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># /sbin/bsdlabel -B -w /dev/fd0 fd1440</span></code></pre></div></div></div><div class=sect2><h3 id=_the_file_system>19.7.3. The File System<a class=anchor href=#_the_file_system></a></h3><div class=paragraph><p>The floppy is now ready to be high-level formatted. This will place a new file system on it so that FreeBSD can read and write to the disk. Since creating the new file system destroys the disk label, the disk label needs to be recreated whenever the disk is reformatted.</p></div><div class=paragraph><p>The floppy’s file system can be either UFS or FAT. FAT is generally a better choice for floppies.</p></div><div class=paragraph><p>To put a new file system on the floppy, issue:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># /sbin/newfs_msdos /dev/fd0</span></code></pre></div></div><div class=paragraph><p>The disk is now ready for use.</p></div></div><div class=sect2><h3 id=_using_the_floppy>19.7.4. Using the Floppy<a class=anchor href=#_using_the_floppy></a></h3><div class=paragraph><p>To use the floppy, mount it with <a href="https://man.freebsd.org/cgi/man.cgi?query=mount_msdosfs&amp;sektion=8&amp;format=html">mount_msdosfs(8)</a>. One can also use <a class=package href=https://cgit.freebsd.org/ports/tree/emulators/mtools/>emulators/mtools</a> from the Ports Collection.</p></div></div></div></div><div class=sect1><h2 id=backups-tapebackups>19.8. Creating and Using Data Tapes<a class=anchor href=#backups-tapebackups></a></h2><div class=sectionbody><div class=paragraph><p>Tape technology has continued to evolve but is less likely to be used in a modern system. Modern backup systems tend to use off site combined with local removable disk drive technologies. Still, FreeBSD will support any tape drive that uses SCSI, such as LTO and older devices such as DAT. There is limited support for SATA and USB tape drives.</p></div><div class=sect2><h3 id=tapes-sa0>19.8.1. Serial Access with <a href="https://man.freebsd.org/cgi/man.cgi?query=sa&amp;sektion=4&amp;format=html">sa(4)</a><a class=anchor href=#tapes-sa0></a></h3><div class=paragraph><p>FreeBSD uses the <a href="https://man.freebsd.org/cgi/man.cgi?query=sa&amp;sektion=4&amp;format=html">sa(4)</a> driver, providing <span class=filename>/dev/sa0</span>, <span class=filename>/dev/nsa0</span>, and <span class=filename>/dev/esa0</span>. In normal use, only <span class=filename>/dev/sa0</span> is needed. <span class=filename>/dev/nsa0</span> is the same physical drive as <span class=filename>/dev/sa0</span> but does not rewind the tape after writing a file. This allows writing more than one file to a tape. Using <span class=filename>/dev/esa0</span> ejects the tape after the device is closed, if applicable.</p></div></div><div class=sect2><h3 id=_controlling_the_tape_drive_with_mt1>19.8.2. Controlling the Tape Drive with <a href="https://man.freebsd.org/cgi/man.cgi?query=mt&amp;sektion=1&amp;format=html">mt(1)</a><a class=anchor href=#_controlling_the_tape_drive_with_mt1></a></h3><div class=paragraph><p><a href="https://man.freebsd.org/cgi/man.cgi?query=mt&amp;sektion=1&amp;format=html">mt(1)</a> is the FreeBSD utility for controlling other operations of the tape drive, such as seeking through files on a tape or writing tape control marks to the tape.</p></div><div class=paragraph><p>For example, the first three files on a tape can be preserved by skipping past them before writing a new file:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># mt -f /dev/nsa0 fsf 3</span></code></pre></div></div></div><div class=sect2><h3 id=_using_tar1_to_read_and_write_tape_backups>19.8.3. Using <a href="https://man.freebsd.org/cgi/man.cgi?query=tar&amp;sektion=1&amp;format=html">tar(1)</a> to Read and Write Tape Backups<a class=anchor href=#_using_tar1_to_read_and_write_tape_backups></a></h3><div class=paragraph><p>An example of writing a single file to tape using <a href="https://man.freebsd.org/cgi/man.cgi?query=tar&amp;sektion=1&amp;format=html">tar(1)</a>:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># tar cvf /dev/sa0 file</span></code></pre></div></div><div class=paragraph><p>Recovering files from a <a href="https://man.freebsd.org/cgi/man.cgi?query=tar&amp;sektion=1&amp;format=html">tar(1)</a> archive on tape into the current directory:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># tar xvf /dev/sa0</span></code></pre></div></div></div><div class=sect2><h3 id=_using_dump8_and_restore8_to_create_and_restore_backups>19.8.4. Using <a href="https://man.freebsd.org/cgi/man.cgi?query=dump&amp;sektion=8&amp;format=html">dump(8)</a> and <a href="https://man.freebsd.org/cgi/man.cgi?query=restore&amp;sektion=8&amp;format=html">restore(8)</a> to Create and Restore Backups<a class=anchor href=#_using_dump8_and_restore8_to_create_and_restore_backups></a></h3><div class=paragraph><p>A simple backup of <span class=filename>/usr</span> with <a href="https://man.freebsd.org/cgi/man.cgi?query=dump&amp;sektion=8&amp;format=html">dump(8)</a>:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># dump -0aL -b64 -f /dev/nsa0 /usr</span></code></pre></div></div><div class=paragraph><p>Interactively restoring files from a <a href="https://man.freebsd.org/cgi/man.cgi?query=dump&amp;sektion=8&amp;format=html">dump(8)</a> file on tape into the current directory:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># restore -i -f /dev/nsa0</span></code></pre></div></div></div><div class=sect2><h3 id=_other_tape_software>19.8.5. Other Tape Software<a class=anchor href=#_other_tape_software></a></h3><div class=paragraph><p>Higher-level programs are available to simplify tape backup. The most popular are Amanda and Bacula. These programs aim to make backups easier and more convenient, or to automate complex backups of multiple machines. The Ports Collection contains both these and other tape utility applications.</p></div></div></div></div><div class=sect1><h2 id=backup-strategies>19.9. Backup Strategies<a class=anchor href=#backup-strategies></a></h2><div class=sectionbody><div class=paragraph><p>The first requirement in devising a backup plan is to make sure that all of the following problems are covered:</p></div><div class=ulist><ul><li><p>Disk failure.</p></li><li><p>Accidental file deletion.</p></li><li><p>Random file corruption.</p></li><li><p>Complete machine destruction, say by fire, including destruction of any on-site backups.</p></li></ul></div><div class=paragraph><p>Some systems will be best served by having each of these problems covered by a completely different technique. Except for strictly personal systems with low-value data, it is unlikely that one technique will cover all of them.</p></div><div class=paragraph><p>Some possible techniques include:</p></div><div class=ulist><ul><li><p>Archives of the whole system, backed up onto permanent, off-site media. This provides protection against all of the problems listed above, but is slow and inconvenient to restore from. Copies of the backups can be stored on site or online, but there will still be inconveniences in restoring files, especially for non-privileged users.</p></li><li><p>Filesystem snapshots, which are really only helpful in the accidental file deletion scenario, but can be <em>very</em> helpful in that case, as well as quick and easy to deal with.</p></li><li><p>Copies of whole file systems or disks which can be created with a periodic <a class=package href=https://cgit.freebsd.org/ports/tree/net/rsync/>net/rsync</a> of the whole machine. This is generally most useful in networks with unique requirements. For general protection against disk failure, this is usually inferior to RAID. For restoring accidentally deleted files, it can be comparable to UFS snapshots.</p></li><li><p>RAID, which minimizes or avoids downtime when a disk fails at the expense of having to deal with disk failures more often, because there are more disks, albeit at a much lower urgency.</p></li><li><p>Checking fingerprints of files using <a href="https://man.freebsd.org/cgi/man.cgi?query=mtree&amp;sektion=8&amp;format=html">mtree(8)</a>. Although this is not a backup, this technique indicates when one needs to resort to backups. This is particularly important for offline backups, and should be checked periodically.</p></li></ul></div><div class=paragraph><p>It is quite easy to come up with more techniques, many of them variations on the ones listed above. Specialized requirements usually lead to specialized techniques. For example, backing up a live database usually requires a method particular to the database software as an intermediate step. The important thing is to know which dangers should be protected against, and how each will be handled.</p></div></div></div><div class=sect1><h2 id=backup-basics>19.10. Backup Basics<a class=anchor href=#backup-basics></a></h2><div class=sectionbody><div class=paragraph><p>The major backup programs built into FreeBSD are <a href="https://man.freebsd.org/cgi/man.cgi?query=dump&amp;sektion=8&amp;format=html">dump(8)</a>, <a href="https://man.freebsd.org/cgi/man.cgi?query=tar&amp;sektion=1&amp;format=html">tar(1)</a>, <a href="https://man.freebsd.org/cgi/man.cgi?query=cpio&amp;sektion=1&amp;format=html">cpio(1)</a>, and <a href="https://man.freebsd.org/cgi/man.cgi?query=pax&amp;sektion=1&amp;format=html">pax(1)</a>.</p></div><div class=sect2><h3 id=_dump_and_restore>19.10.1. Dump and Restore<a class=anchor href=#_dump_and_restore></a></h3><div class=paragraph><p>The traditional UNIX® backup programs are <code>dump</code> and <code>restore</code>. They operate on the drive as a collection of disk blocks, below the abstractions of files, links and directories that are created by the file systems. Unlike other backup software, <code>dump</code> backs up an entire file system on a device. It is unable to backup only part of a file system or a directory tree that spans more than one file system. <code>dump</code> does not write files and directories, but rather writes the raw data blocks that comprise files and directories. When used to extract data, <code>restore</code> stores temporary files in <span class=filename>/tmp/</span> by default. When using a recovery disk with a small <span class=filename>/tmp</span>, set <code>TMPDIR</code> to a directory with more free space in order for the restore to succeed.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>If <code>dump</code> is used on the root directory, it will not back up <span class=filename>/home</span>, <span class=filename>/usr</span> or many other directories since these are typically mount points for other file systems or symbolic links into those file systems.</p></div></td></tr></tbody></table></div><div class=paragraph><p><code>dump</code> has quirks that remain from its early days in Version 6 of AT&amp;T UNIX®,circa 1975. The default parameters are suitable for 9-track tapes (6250 bpi), not the high-density media available today (up to 62,182 ftpi). These defaults must be overridden on the command line to utilize the capacity of current tape drives.</p></div><div class=paragraph><p>It is also possible to backup data across the network to a tape drive attached to another computer with <code>rdump</code> and <code>rrestore</code>. Both programs rely upon <a href="https://man.freebsd.org/cgi/man.cgi?query=rcmd&amp;sektion=3&amp;format=html">rcmd(3)</a> and <a href="https://man.freebsd.org/cgi/man.cgi?query=ruserok&amp;sektion=3&amp;format=html">ruserok(3)</a> to access the remote tape drive. Therefore, the user performing the backup must be listed in <span class=filename>.rhosts</span> on the remote computer. The arguments to <code>rdump</code> and <code>rrestore</code> must be suitable to use on the remote computer. For example, to <code>rdump</code> from a FreeBSD computer to an Exabyte tape drive connected to a host called <code>komodo</code>, use:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># /sbin/rdump 0dsbfu 54000 13000 126 komodo:/dev/nsa8 /dev/da0a 2&gt;&amp;1</span></code></pre></div></div><div class=paragraph><p>There are security implications to allowing <span class=filename>.rhosts</span> authentication, so use with caution.</p></div><div class=paragraph><p>It is also possible to use <code>dump</code> and <code>restore</code> in a more secure fashion over <code>ssh</code>.</p></div><div class=exampleblock><div class=title>Παράδειγμα 1. Using <code>dump</code> over ssh</div><div class=content><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># /sbin/dump -0uan -f - /usr | gzip -2 | ssh -c blowfish \</span>
          targetuser@targetmachine.example.com <span class=nb>dd </span><span class=nv>of</span><span class=o>=</span>/mybigfiles/dump-usr-l0.gz</code></pre></div></div></div></div><div class=paragraph><p>Or, use the built-in <code>RSH</code>:</p></div><div class=exampleblock><div class=title>Παράδειγμα 2. Using <code>dump</code> over ssh with <code>RSH</code> Set</div><div class=content><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># env RSH=/usr/bin/ssh /sbin/dump -0uan -f targetuser@targetmachine.example.com:/dev/sa0 /usr</span></code></pre></div></div></div></div></div><div class=sect2><h3 id=_tar>19.10.2. <code>tar</code><a class=anchor href=#_tar></a></h3><div class=paragraph><p><a href="https://man.freebsd.org/cgi/man.cgi?query=tar&amp;sektion=1&amp;format=html">tar(1)</a> also dates back to Version 6 of AT&amp;T UNIX®, circa 1975. <code>tar</code> operates in cooperation with the file system and writes files and directories to tape. <code>tar</code> does not support the full range of options that are available from <a href="https://man.freebsd.org/cgi/man.cgi?query=cpio&amp;sektion=1&amp;format=html">cpio(1)</a>, but it does not require the unusual command pipeline that <code>cpio</code> uses.</p></div><div class=paragraph><p>To <code>tar</code> to an Exabyte tape drive connected to a host called <code>komodo</code>:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># tar cf - . | rsh komodo dd of=tape-device obs=20b</span></code></pre></div></div><div class=paragraph><p>When backing up over an insecure network, instead use <code>ssh</code>.</p></div></div><div class=sect2><h3 id=_cpio>19.10.3. <code>cpio</code><a class=anchor href=#_cpio></a></h3><div class=paragraph><p><a href="https://man.freebsd.org/cgi/man.cgi?query=cpio&amp;sektion=1&amp;format=html">cpio(1)</a> is the original UNIX® file interchange tape program for magnetic media. <code>cpio</code> includes options to perform byte-swapping, write a number of different archive formats, and pipe the data to other programs. This last feature makes <code>cpio</code> an excellent choice for installation media. <code>cpio</code> does not know how to walk the directory tree and a list of files must be provided through <span class=filename>stdin</span>.</p></div><div class=paragraph><p>Since <code>cpio</code> does not support backups across the network, use a pipeline and <code>ssh</code> to send the data to a remote tape drive.</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># for f in directory_list; do</span>

<span class=c># find $f &gt;&gt; backup.list</span>

<span class=c># done</span>
<span class=c># cpio -v -o --format=newc &lt; backup.list | ssh user@host &#34;cat &gt; backup_device&#34;</span></code></pre></div></div><div class=paragraph><p>Where <em>directory_list</em> is the list of directories to back up, <em>user</em>@<em>host</em> is the user/hostname combination that will be performing the backups, and <em>backup_device</em> is where the backups should be written to, such as <span class=filename>/dev/nsa0</span>).</p></div></div><div class=sect2><h3 id=_pax>19.10.4. <code>pax</code><a class=anchor href=#_pax></a></h3><div class=paragraph><p><a href="https://man.freebsd.org/cgi/man.cgi?query=pax&amp;sektion=1&amp;format=html">pax(1)</a> is the IEEE/POSIX® answer to <code>tar</code> and <code>cpio</code>. Over the years the various versions of <code>tar</code> and <code>cpio</code> have become slightly incompatible. So rather than fight it out to fully standardize them, POSIX® created a new archive utility. <code>pax</code> attempts to read and write many of the various <code>cpio</code> and <code>tar</code> formats, plus new formats of its own. Its command set more resembles <code>cpio</code> than <code>tar</code>.</p></div></div><div class=sect2><h3 id=backups-programs-amanda>19.10.5. Amanda<a class=anchor href=#backups-programs-amanda></a></h3><div class=paragraph><p>Amanda (Advanced Maryland Network Disk Archiver) is a client/server backup system, rather than a single program. An Amanda server will backup to a single tape drive any number of computers that have Amanda clients and a network connection to the Amanda server. A common problem at sites with a number of large disks is that the length of time required to backup to data directly to tape exceeds the amount of time available for the task. Amanda solves this problem by using a "holding disk" to backup several file systems at the same time. Amanda creates "archive sets": a group of tapes used over a period of time to create full backups of all the file systems listed in Amanda’s configuration file. The "archive set" also contains nightly incremental, or differential, backups of all the file systems. Restoring a damaged file system requires the most recent full backup and the incremental backups.</p></div><div class=paragraph><p>The configuration file provides fine grained control of backups and the network traffic that Amanda generates. Amanda will use any of the above backup programs to write the data to tape. Amanda is not installed by but is available as either a port or package.</p></div></div><div class=sect2><h3 id=_do_nothing>19.10.6. Do Nothing<a class=anchor href=#_do_nothing></a></h3><div class=paragraph><p>"Do nothing" is not a computer program, but it is the most widely used backup strategy. There are no initial costs. There is no backup schedule to follow. Just say no. If something happens to your data, grin and bear it!</p></div><div class=paragraph><p>If your time and data is worth little to nothing, then "Do nothing" is the most suitable backup program for the computer. But beware, FreeBSD is a useful tool and over time it can be used to create a valuable collection of files.</p></div><div class=paragraph><p>"Do nothing" is the correct backup method for <span class=filename>/usr/obj</span> and other directory trees that can be exactly recreated by the computer. An example is the files that comprise the HTML or PostScript® version of this Handbook. These document formats have been created from XML input files. Creating backups of the HTML or PostScript® files is not necessary if the XML files are backed up regularly.</p></div></div><div class=sect2><h3 id=_which_backup_program_is_best>19.10.7. Which Backup Program Is Best?<a class=anchor href=#_which_backup_program_is_best></a></h3><div class=paragraph><p><a href="https://man.freebsd.org/cgi/man.cgi?query=dump&amp;sektion=8&amp;format=html">dump(8)</a> <em>Period.</em> Elizabeth D. Zwicky torture tested all the backup programs discussed here. The clear choice for preserving all your data and all the peculiarities of UNIX® file systems is <code>dump</code>. Elizabeth created file systems containing a large variety of unusual conditions (and some not so unusual ones) and tested each program by doing a backup and restore of those file systems. The peculiarities included: files with holes, files with holes and a block of nulls, files with funny characters in their names, unreadable and unwritable files, devices, files that change size during the backup, files that are created/deleted during the backup and more. She presented the results at LISA V in Oct. 1991. See <a href=http://www.coredumps.de/doc/dump/zwicky/testdump.doc.html>torture-testing Backup and Archive Programs</a>.</p></div></div><div class=sect2><h3 id=_emergency_restore_procedure>19.10.8. Emergency Restore Procedure<a class=anchor href=#_emergency_restore_procedure></a></h3><div class=sect3><h4 id=_before_the_disaster>19.10.8.1. Before the Disaster<a class=anchor href=#_before_the_disaster></a></h4><div class=paragraph><p>There are four steps which should be performed in preparation for any disaster that may occur.</p></div><div class=paragraph><p>First, print the bsdlabel of each disk using a command such as <code>bsdlabel da0 | lpr</code>. Also print a copy of <span class=filename>/etc/fstab</span> and all boot messages.</p></div><div class=paragraph><p>Second, burn a "livefs" CD. This CD contains support for booting into a FreeBSD "livefs" rescue mode, allowing the user to perform many tasks like running <a href="https://man.freebsd.org/cgi/man.cgi?query=dump&amp;sektion=8&amp;format=html">dump(8)</a>, <a href="https://man.freebsd.org/cgi/man.cgi?query=restore&amp;sektion=8&amp;format=html">restore(8)</a>, <a href="https://man.freebsd.org/cgi/man.cgi?query=fdisk&amp;sektion=8&amp;format=html">fdisk(8)</a>, <a href="https://man.freebsd.org/cgi/man.cgi?query=bsdlabel&amp;sektion=8&amp;format=html">bsdlabel(8)</a>, <a href="https://man.freebsd.org/cgi/man.cgi?query=newfs&amp;sektion=8&amp;format=html">newfs(8)</a>, <a href="https://man.freebsd.org/cgi/man.cgi?query=mount&amp;sektion=8&amp;format=html">mount(8)</a>, and more. The livefs CD image for FreeBSD/i386 11.2-RELEASE is available from <a href=ftp://ftp.FreeBSD.org/pub/FreeBSD/releases/i386/ISO-IMAGES/11.2/FreeBSD-11.2-RELEASE-i386-livefs.iso>ftp://ftp.FreeBSD.org/pub/FreeBSD/releases/i386/ISO-IMAGES/11.2/FreeBSD-11.2-RELEASE-i386-livefs.iso</a>.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Livefs CD images are not available for FreeBSD 12.0-RELEASE and later. In addition to the CD-ROM installation images, flash drive installation images may be used to recover a system. The "memstick" image for FreeBSD/i386 12.0-RELEASE is available from <a href=ftp://ftp.FreeBSD.org/pub/FreeBSD/releases/i386/i386/ISO-IMAGES/12.0/FreeBSD-12.0-RELEASE-i386-memstick.img>ftp://ftp.FreeBSD.org/pub/FreeBSD/releases/i386/i386/ISO-IMAGES/12.0/FreeBSD-12.0-RELEASE-i386-memstick.img</a>.</p></div></td></tr></tbody></table></div><div class=paragraph><p>Third, create backup tapes regularly. Any changes that made after the last backup may be irretrievably lost. Write-protect the backup media.</p></div><div class=paragraph><p>Fourth, test the "livefs" CD and the backups. Make notes of the procedure. Store these notes with the CD, the printouts, and the backups. These notes may prevent the inadvertent destruction of the backups while under the stress of performing an emergency recovery.</p></div><div class=paragraph><p>For an added measure of security, store an extra "livefs" CD and the latest backup at a remote location, where a remote location is <em>not</em> the basement of the same building. A remote location should be physically separated from the computers and disk drives by a significant distance.</p></div></div><div class=sect3><h4 id=_after_the_disaster>19.10.8.2. After the Disaster<a class=anchor href=#_after_the_disaster></a></h4><div class=paragraph><p>First, determine if the hardware survived. Thanks to regular, off-site backups, there is no need to worry about the software.</p></div><div class=paragraph><p>If the hardware has been damaged, the parts should be replaced before attempting to use the computer.</p></div><div class=paragraph><p>If the hardware is okay, insert the "livefs" CD and boot the computer. The original install menu will be displayed on the screen. Select the correct country, then choose <span class=guimenuitem>Fixit — Repair mode with CD-ROM/DVD/floppy or start a shell.</span> then select <span class=guimenuitem>CD-ROM/DVD — Use the live filesystem CD-ROM/DVD</span>. <code>restore</code> and the other needed programs are located in <span class=filename>/mnt2/rescue</span>.</p></div><div class=paragraph><p>Recover each file system separately.</p></div><div class=paragraph><p>Try to <code>mount</code> the root partition of the first disk using <code>mount /dev/da0a /mnt</code>. If the bsdlabel was damaged, use <code>bsdlabel</code> to re-partition and label the disk to match the label that was printed and saved. Use <code>newfs</code> to re-create the file systems. Re-mount the root partition of the disk read-write using <code>mount -u -o rw /mnt</code>. Use the backups to recover the data for this file system. Unmount the file system with <code>umount /mnt</code>. Repeat for each file system that was damaged.</p></div><div class=paragraph><p>Once the system is running, backup the data onto new media as whatever caused the crash or data loss may strike again. Another hour spent now may save further distress later.</p></div></div></div></div></div><div class=sect1><h2 id=disks-virtual>19.11. Network, Memory, and File-Backed File Systems<a class=anchor href=#disks-virtual></a></h2><div class=sectionbody><div class=paragraph><p>In addition to physical disks such as floppies, CDs, and hard drives, FreeBSD also supports <em>virtual disks</em>.</p></div><div class=paragraph><p>These include network file systems such as the <a href=../network-servers/#network-nfs>Network File System</a> and Coda, memory-based file systems, and file-backed file systems.</p></div><div class=paragraph><p>According to the FreeBSD version, the tools used for the creation and use of file-backed and memory-based file systems differ.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Use <a href="https://man.freebsd.org/cgi/man.cgi?query=devfs&amp;sektion=5&amp;format=html">devfs(5)</a> to allocate device nodes transparently for the user.</p></div></td></tr></tbody></table></div><div class=sect2><h3 id=disks-mdconfig>19.11.1. File-Backed File System<a class=anchor href=#disks-mdconfig></a></h3><div class=paragraph><p><a href="https://man.freebsd.org/cgi/man.cgi?query=mdconfig&amp;sektion=8&amp;format=html">mdconfig(8)</a> is used to configure and enable memory disks, <a href="https://man.freebsd.org/cgi/man.cgi?query=md&amp;sektion=4&amp;format=html">md(4)</a>, under FreeBSD. To use <a href="https://man.freebsd.org/cgi/man.cgi?query=mdconfig&amp;sektion=8&amp;format=html">mdconfig(8)</a>, <a href="https://man.freebsd.org/cgi/man.cgi?query=md&amp;sektion=4&amp;format=html">md(4)</a> must be first loaded. When using a custom kernel configuration file, ensure it includes this line:</p></div><div class="literalblock programlisting"><div class=content><pre>device md</pre></div></div><div class=paragraph><p><a href="https://man.freebsd.org/cgi/man.cgi?query=mdconfig&amp;sektion=8&amp;format=html">mdconfig(8)</a> supports several types of memory backed virtual disks: memory disks allocated with <a href="https://man.freebsd.org/cgi/man.cgi?query=malloc&amp;sektion=9&amp;format=html">malloc(9)</a> and memory disks using a file or swap space as backing. One possible use is the mounting of CD images.</p></div><div class=paragraph><p>To mount an existing file system image:</p></div><div class=exampleblock><div class=title>Παράδειγμα 3. Using <code>mdconfig</code> to Mount an Existing File System Image</div><div class=content><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># mdconfig -a -t vnode -f diskimage -u 0</span>
<span class=c># mount /dev/md0 /mnt</span></code></pre></div></div></div></div><div class=paragraph><p>To create a new file system image with <a href="https://man.freebsd.org/cgi/man.cgi?query=mdconfig&amp;sektion=8&amp;format=html">mdconfig(8)</a>:</p></div><div class=exampleblock><div class=title>Παράδειγμα 4. Creating a New File-Backed Disk with <code>mdconfig</code></div><div class=content><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># dd if=/dev/zero of=newimage bs=1k count=5k</span>
5120+0 records <span class=k>in
</span>5120+0 records out
<span class=c># mdconfig -a -t vnode -f newimage -u 0</span>
<span class=c># bsdlabel -w md0 auto</span>
<span class=c># newfs md0a</span>
/dev/md0a: 5.0MB <span class=o>(</span>10224 sectors<span class=o>)</span> block size 16384, fragment size 2048
        using 4 cylinder <span class=nb>groups </span>of 1.25MB, 80 blks, 192 inodes.
super-block backups <span class=o>(</span><span class=k>for </span>fsck <span class=nt>-b</span> <span class=c>#) at:</span>
 160, 2720, 5280, 7840
<span class=c># mount /dev/md0a /mnt</span>
<span class=c># df /mnt</span>
Filesystem 1K-blocks Used Avail Capacity  Mounted on
/dev/md0a       4710    4  4330     0%    /mnt</code></pre></div></div></div></div><div class=paragraph><p>If unit number is not specified with <code>-u</code>, <a href="https://man.freebsd.org/cgi/man.cgi?query=mdconfig&amp;sektion=8&amp;format=html">mdconfig(8)</a> uses the <a href="https://man.freebsd.org/cgi/man.cgi?query=md&amp;sektion=4&amp;format=html">md(4)</a> automatic allocation to select an unused device. The name of the allocated unit will be output to stdout, such as <span class=filename>md4</span>. Refer to <a href="https://man.freebsd.org/cgi/man.cgi?query=mdconfig&amp;sektion=8&amp;format=html">mdconfig(8)</a> for more details about.</p></div><div class=paragraph><p>While <a href="https://man.freebsd.org/cgi/man.cgi?query=mdconfig&amp;sektion=8&amp;format=html">mdconfig(8)</a> is useful, it takes several command lines to create a file-backed file system. FreeBSD also comes with <a href="https://man.freebsd.org/cgi/man.cgi?query=mdmfs&amp;sektion=8&amp;format=html">mdmfs(8)</a> which automatically configures a <a href="https://man.freebsd.org/cgi/man.cgi?query=md&amp;sektion=4&amp;format=html">md(4)</a> disk using <a href="https://man.freebsd.org/cgi/man.cgi?query=mdconfig&amp;sektion=8&amp;format=html">mdconfig(8)</a>, puts a UFS file system on it using <a href="https://man.freebsd.org/cgi/man.cgi?query=newfs&amp;sektion=8&amp;format=html">newfs(8)</a>, and mounts it using <a href="https://man.freebsd.org/cgi/man.cgi?query=mount&amp;sektion=8&amp;format=html">mount(8)</a>. For example, to create and mount the same file system image as above, type the following:</p></div><div class=exampleblock><div class=title>Παράδειγμα 5. Configure and Mount a File-Backed Disk with <code>mdmfs</code></div><div class=content><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># dd if=/dev/zero of=newimage bs=1k count=5k</span>
5120+0 records <span class=k>in
</span>5120+0 records out
<span class=c># mdmfs -F newimage -s 5m md0 /mnt</span>
<span class=c># df /mnt</span>
Filesystem 1K-blocks Used Avail Capacity  Mounted on
/dev/md0        4718    4  4338     0%    /mnt</code></pre></div></div></div></div><div class=paragraph><p>When <code>md</code> is used without a unit number, <a href="https://man.freebsd.org/cgi/man.cgi?query=mdmfs&amp;sektion=8&amp;format=html">mdmfs(8)</a> uses the <a href="https://man.freebsd.org/cgi/man.cgi?query=md&amp;sektion=4&amp;format=html">md(4)</a> auto-unit feature to automatically select an unused device. For more details about <a href="https://man.freebsd.org/cgi/man.cgi?query=mdmfs&amp;sektion=8&amp;format=html">mdmfs(8)</a>, refer to its manual page.</p></div></div><div class=sect2><h3 id=disks-md-freebsd5>19.11.2. Memory-Based File System<a class=anchor href=#disks-md-freebsd5></a></h3><div class=paragraph><p>For a memory-based file system, "swap backing" should normally be used. This does not mean that the memory disk will be swapped out to disk by default, but rather that the memory disk will be allocated from a memory pool which can be swapped out to disk if needed. It is also possible to create memory-based disks which are <a href="https://man.freebsd.org/cgi/man.cgi?query=malloc&amp;sektion=9&amp;format=html">malloc(9)</a> backed, but using large malloc backed memory disks can result in a system panic if the kernel runs out of memory.</p></div><div class=exampleblock><div class=title>Παράδειγμα 6. Creating a New Memory-Based Disk with <code>mdconfig</code></div><div class=content><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># mdconfig -a -t swap -s 5m -u 1</span>
<span class=c># newfs -U md1</span>
/dev/md1: 5.0MB <span class=o>(</span>10240 sectors<span class=o>)</span> block size 16384, fragment size 2048
        using 4 cylinder <span class=nb>groups </span>of 1.27MB, 81 blks, 192 inodes.
        with soft updates
super-block backups <span class=o>(</span><span class=k>for </span>fsck <span class=nt>-b</span> <span class=c>#) at:</span>
 160, 2752, 5344, 7936
<span class=c># mount /dev/md1 /mnt</span>
<span class=c># df /mnt</span>
Filesystem 1K-blocks Used Avail Capacity  Mounted on
/dev/md1        4718    4  4338     0%    /mnt</code></pre></div></div></div></div><div class=exampleblock><div class=title>Παράδειγμα 7. Creating a New Memory-Based Disk with <code>mdmfs</code></div><div class=content><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># mdmfs -s 5m md2 /mnt</span>
<span class=c># df /mnt</span>
Filesystem 1K-blocks Used Avail Capacity  Mounted on
/dev/md2        4846    2  4458     0%    /mnt</code></pre></div></div></div></div></div><div class=sect2><h3 id=_detaching_a_memory_disk_from_the_system>19.11.3. Detaching a Memory Disk from the System<a class=anchor href=#_detaching_a_memory_disk_from_the_system></a></h3><div class=paragraph><p>When a memory-based or file-based file system is no longer in use, its resources should be released back to the system. First, unmount the file system, then use <a href="https://man.freebsd.org/cgi/man.cgi?query=mdconfig&amp;sektion=8&amp;format=html">mdconfig(8)</a> to detach the disk from the system and release the resources.</p></div><div class=paragraph><p>For example, to detach and free all resources used by <span class=filename>/dev/md4</span>:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># mdconfig -d -u 4</span></code></pre></div></div><div class=paragraph><p>It is possible to list information about configured <a href="https://man.freebsd.org/cgi/man.cgi?query=md&amp;sektion=4&amp;format=html">md(4)</a> devices by running <code>mdconfig -l</code>.</p></div></div></div></div><div class=sect1><h2 id=snapshots>19.12. File System Snapshots<a class=anchor href=#snapshots></a></h2><div class=sectionbody><div class=paragraph><p>FreeBSD offers a feature in conjunction with <a href=../cutting-edge/#soft-updates>Soft Updates</a>: file system snapshots.</p></div><div class=paragraph><p>UFS snapshots allow a user to create images of specified file systems, and treat them as a file. Snapshot files must be created in the file system that the action is performed on, and a user may create no more than 20 snapshots per file system. Active snapshots are recorded in the superblock so they are persistent across unmount and remount operations along with system reboots. When a snapshot is no longer required, it can be removed using <a href="https://man.freebsd.org/cgi/man.cgi?query=rm&amp;sektion=1&amp;format=html">rm(1)</a>. While snapshots may be removed in any order, all the used space may not be acquired because another snapshot will possibly claim some of the released blocks.</p></div><div class=paragraph><p>The un-alterable <code>snapshot</code> file flag is set by <a href="https://man.freebsd.org/cgi/man.cgi?query=mksnap_ffs&amp;sektion=8&amp;format=html">mksnap_ffs(8)</a> after initial creation of a snapshot file. <a href="https://man.freebsd.org/cgi/man.cgi?query=unlink&amp;sektion=1&amp;format=html">unlink(1)</a> makes an exception for snapshot files since it allows them to be removed.</p></div><div class=paragraph><p>Snapshots are created using <a href="https://man.freebsd.org/cgi/man.cgi?query=mount&amp;sektion=8&amp;format=html">mount(8)</a>. To place a snapshot of <span class=filename>/var</span> in the file <span class=filename>/var/snapshot/snap</span>, use the following command:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># mount -u -o snapshot /var/snapshot/snap /var</span></code></pre></div></div><div class=paragraph><p>Alternatively, use <a href="https://man.freebsd.org/cgi/man.cgi?query=mksnap_ffs&amp;sektion=8&amp;format=html">mksnap_ffs(8)</a> to create the snapshot:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># mksnap_ffs /var /var/snapshot/snap</span></code></pre></div></div><div class=paragraph><p>One can find snapshot files on a file system, such as <span class=filename>/var</span>, using <a href="https://man.freebsd.org/cgi/man.cgi?query=find&amp;sektion=1&amp;format=html">find(1)</a>:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># find /var -flags snapshot</span></code></pre></div></div><div class=paragraph><p>Once a snapshot has been created, it has several uses:</p></div><div class=ulist><ul><li><p>Some administrators will use a snapshot file for backup purposes, because the snapshot can be transferred to CDs or tape.</p></li><li><p>The file system integrity checker, <a href="https://man.freebsd.org/cgi/man.cgi?query=fsck&amp;sektion=8&amp;format=html">fsck(8)</a>, may be run on the snapshot. Assuming that the file system was clean when it was mounted, this should always provide a clean and unchanging result.</p></li><li><p>Running <a href="https://man.freebsd.org/cgi/man.cgi?query=dump&amp;sektion=8&amp;format=html">dump(8)</a> on the snapshot will produce a dump file that is consistent with the file system and the timestamp of the snapshot. <a href="https://man.freebsd.org/cgi/man.cgi?query=dump&amp;sektion=8&amp;format=html">dump(8)</a> can also take a snapshot, create a dump image, and then remove the snapshot in one command by using <code>-L</code>.</p></li><li><p>The snapshot can be mounted as a frozen image of the file system. To <a href="https://man.freebsd.org/cgi/man.cgi?query=mount&amp;sektion=8&amp;format=html">mount(8)</a> the snapshot <span class=filename>/var/snapshot/snap</span> run:</p><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># mdconfig -a -t vnode -f /var/snapshot/snap -u 4</span>
<span class=c># mount -r /dev/md4 /mnt</span></code></pre></div></div></li></ul></div><div class=paragraph><p>The frozen <span class=filename>/var</span> is now available through <span class=filename>/mnt</span>. Everything will initially be in the same state it was during the snapshot creation time. The only exception is that any earlier snapshots will appear as zero length files. To unmount the snapshot, use:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># umount /mnt</span>
<span class=c># mdconfig -d -u 4</span></code></pre></div></div><div class=paragraph><p>For more information about <code>softupdates</code> and file system snapshots, including technical papers, visit Marshall Kirk McKusick’s website at <a href=http://www.mckusick.com/>http://www.mckusick.com/</a>.</p></div></div></div><div class=sect1><h2 id=quotas>19.13. File System Quotas<a class=anchor href=#quotas></a></h2><div class=sectionbody><div class=paragraph><p>Quotas are an optional feature of the operating system that can be used to limit the amount of disk space or the number of files a user or members of a group may allocate on a per-file system basis. This is used most often on timesharing systems where it is desirable to limit the amount of resources any one user or group of users may allocate. This prevents one user or group of users from consuming all of the available disk space.</p></div><div class=sect2><h3 id=_configuring_the_system_to_enable_disk_quotas>19.13.1. Configuring the System to Enable Disk Quotas<a class=anchor href=#_configuring_the_system_to_enable_disk_quotas></a></h3><div class=paragraph><p>Before using disk quotas, quota support must be added to the kernel by adding the following line to the kernel configuration file:</p></div><div class="literalblock programlisting"><div class=content><pre>options QUOTA</pre></div></div><div class=paragraph><p>Before FreeBSD 9.2, the <span class=filename>GENERIC</span> kernel usually did not include this option. <code>sysctl kern.features.ufs_quota</code> can be used to test whether the current kernel supports quotas. If the option is not present, a custom kernel must be compiled. Refer to <a href=../kernelconfig/#kernelconfig>Configuring the FreeBSD Kernel</a> for more information on kernel configuration.</p></div><div class=paragraph><p>Next, enable disk quotas in <span class=filename>/etc/rc.conf</span>:</p></div><div class="literalblock programlisting"><div class=content><pre>quota_enable=&#34;YES&#34;</pre></div></div><div class=paragraph><p>For finer control over quota startup, an additional configuration variable is available. Normally on bootup, the quota integrity of each file system is checked by <a href="https://man.freebsd.org/cgi/man.cgi?query=quotacheck&amp;sektion=8&amp;format=html">quotacheck(8)</a>. This program insures that the data in the quota database properly reflects the data on the file system. This is a time consuming process that will significantly affect the time the system takes to boot. To skip this step, add this variable to <span class=filename>/etc/rc.conf</span>:</p></div><div class="literalblock programlisting"><div class=content><pre>check_quotas=&#34;NO&#34;</pre></div></div><div class=paragraph><p>Finally, edit <span class=filename>/etc/fstab</span> to enable disk quotas on a per-file system basis. This is when user or group quotas can be enabled on the file systems.</p></div><div class=paragraph><p>To enable per-user quotas on a file system, add <code>userquota</code> to the options field in the <span class=filename>/etc/fstab</span> entry for the file system to enable quotas on. For example:</p></div><div class="literalblock programlisting"><div class=content><pre>/dev/da1s2g   /home    ufs rw,userquota 1 2</pre></div></div><div class=paragraph><p>To enable group quotas, instead use <code>groupquota</code>. To enable both user and group quotas, change the entry as follows:</p></div><div class="literalblock programlisting"><div class=content><pre>/dev/da1s2g    /home    ufs rw,userquota,groupquota 1 2</pre></div></div><div class=paragraph><p>By default, the quota files are stored in the root directory of the file system as <span class=filename>quota.user</span> and <span class=filename>quota.group</span>. Refer to <a href="https://man.freebsd.org/cgi/man.cgi?query=fstab&amp;sektion=5&amp;format=html">fstab(5)</a> for more information. Even though an alternate location for the quota files can be specified, this is not recommended because the various quota utilities do not seem to handle this properly.</p></div><div class=paragraph><p>Once the configuration is complete, reboot the system with the new kernel. <span class=filename>/etc/rc</span> will automatically run the appropriate commands to create the initial quota files for all of the quotas enabled in <span class=filename>/etc/fstab</span>. There is no need to manually create any zero length quota files.</p></div><div class=paragraph><p>In the normal course of operations, there should be no need to manually run <a href="https://man.freebsd.org/cgi/man.cgi?query=quotacheck&amp;sektion=8&amp;format=html">quotacheck(8)</a>, <a href="https://man.freebsd.org/cgi/man.cgi?query=quotaon&amp;sektion=8&amp;format=html">quotaon(8)</a>, or <a href="https://man.freebsd.org/cgi/man.cgi?query=quotaoff&amp;sektion=8&amp;format=html">quotaoff(8)</a>. However, one should read their manual pages to be familiar with their operation.</p></div></div><div class=sect2><h3 id=_setting_quota_limits>19.13.2. Setting Quota Limits<a class=anchor href=#_setting_quota_limits></a></h3><div class=paragraph><p>Once the system has been configured to enable quotas, verify they really are enabled by running:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># quota -v</span></code></pre></div></div><div class=paragraph><p>There should be a one line summary of disk usage and current quota limits for each file system that quotas are enabled on.</p></div><div class=paragraph><p>The system is now ready to be assigned quota limits with <a href="https://man.freebsd.org/cgi/man.cgi?query=edquota&amp;sektion=8&amp;format=html">edquota(8)</a>.</p></div><div class=paragraph><p>Several options are available to enforce limits on the amount of disk space a user or group may allocate, and how many files they may create. Allocations can be limited based on disk space (block quotas), number of files (inode quotas), or a combination of both. Each limits is further broken down into two categories: hard and soft limits.</p></div><div class=paragraph><p>A hard limit may not be exceeded. Once a user reaches a hard limit, no further allocations can be made on that file system by that user. For example, if the user has a hard limit of 500 kbytes on a file system and is currently using 490 kbytes, the user can only allocate an additional 10 kbytes. Attempting to allocate an additional 11 kbytes will fail.</p></div><div class=paragraph><p>Soft limits can be exceeded for a limited amount of time, known as the grace period, which is one week by default. If a user stays over their limit longer than the grace period, the soft limit turns into a hard limit and no further allocations are allowed. When the user drops back below the soft limit, the grace period is reset.</p></div><div class=paragraph><p>The following is an example output from <a href="https://man.freebsd.org/cgi/man.cgi?query=edquota&amp;sektion=8&amp;format=html">edquota(8)</a>. When <a href="https://man.freebsd.org/cgi/man.cgi?query=edquota&amp;sektion=8&amp;format=html">edquota(8)</a> is invoked, the editor specified by <code>EDITOR</code> is opened in order to edit the quota limits. The default editor is set to vi.</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># edquota -u test</span></code></pre></div></div><div class="literalblock programlisting"><div class=content><pre>Quotas for user test:
/usr: kbytes in use: 65, limits (soft = 50, hard = 75)
        inodes in use: 7, limits (soft = 50, hard = 60)
/usr/var: kbytes in use: 0, limits (soft = 50, hard = 75)
        inodes in use: 0, limits (soft = 50, hard = 60)</pre></div></div><div class=paragraph><p>There are normally two lines for each file system that has quotas enabled. One line represents the block limits and the other represents the inode limits. Change the value to modify the quota limit. For example, to raise this user’s block limit from a soft limit of 50 and a hard limit of 75 to a soft limit of 500 and a hard limit of 600, change:</p></div><div class="literalblock programlisting"><div class=content><pre>/usr: kbytes in use: 65, limits (soft = 50, hard = 75)</pre></div></div><div class=paragraph><p>to:</p></div><div class="literalblock programlisting"><div class=content><pre>/usr: kbytes in use: 65, limits (soft = 500, hard = 600)</pre></div></div><div class=paragraph><p>The new quota limits take affect upon exiting the editor.</p></div><div class=paragraph><p>Sometimes it is desirable to set quota limits on a range of UIDs. This can be done by passing <code>-p</code> to <a href="https://man.freebsd.org/cgi/man.cgi?query=edquota&amp;sektion=8&amp;format=html">edquota(8)</a>. First, assign the desired quota limit to a user, then run <code>edquota -p protouser startuid-enduid</code>. For example, if <code>test</code> has the desired quota limits, the following command will duplicate those quota limits for UIDs 10,000 through 19,999:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># edquota -p test 10000-19999</span></code></pre></div></div><div class=paragraph><p>For more information, refer to <a href="https://man.freebsd.org/cgi/man.cgi?query=edquota&amp;sektion=8&amp;format=html">edquota(8)</a>.</p></div></div><div class=sect2><h3 id=_checking_quota_limits_and_disk_usage>19.13.3. Checking Quota Limits and Disk Usage<a class=anchor href=#_checking_quota_limits_and_disk_usage></a></h3><div class=paragraph><p>Either <a href="https://man.freebsd.org/cgi/man.cgi?query=quota&amp;sektion=1&amp;format=html">quota(1)</a> or <a href="https://man.freebsd.org/cgi/man.cgi?query=repquota&amp;sektion=8&amp;format=html">repquota(8)</a> can be used to check quota limits and disk usage. To check individual user or group quotas and disk usage, use <a href="https://man.freebsd.org/cgi/man.cgi?query=quota&amp;sektion=1&amp;format=html">quota(1)</a>. A user may only examine their own quota and the quota of a group they are a member of. Only the superuser may view all user and group quotas. To get a summary of all quotas and disk usage for file systems with quotas enabled, use <a href="https://man.freebsd.org/cgi/man.cgi?query=repquota&amp;sektion=8&amp;format=html">repquota(8)</a>.</p></div><div class=paragraph><p>The following is sample output from <code>quota -v</code> for a user that has quota limits on two file systems.</p></div><div class="literalblock programlisting"><div class=content><pre>Disk quotas for user test (uid 1002):
     Filesystem  usage    quota   limit   grace   files   quota   limit   grace
           /usr      65*     50      75   5days       7      50      60
       /usr/var       0      50      75               0      50      60</pre></div></div><div class=paragraph><p>In this example, the user is currently 15 kbytes over the soft limit of 50 kbytes on <span class=filename>/usr</span> and has 5 days of grace period left. The asterisk <code>*</code> indicates that the user is currently over the quota limit.</p></div><div class=paragraph><p>Normally, file systems that the user is not using any disk space on will not show in the output of <a href="https://man.freebsd.org/cgi/man.cgi?query=quota&amp;sektion=1&amp;format=html">quota(1)</a>, even if the user has a quota limit assigned for that file system. Use <code>-v</code> to display those file systems, such as <span class=filename>/usr/var</span> in the above example.</p></div></div><div class=sect2><h3 id=_quotas_over_nfs>19.13.4. Quotas over NFS<a class=anchor href=#_quotas_over_nfs></a></h3><div class=paragraph><p>Quotas are enforced by the quota subsystem on the NFS server. The <a href="https://man.freebsd.org/cgi/man.cgi?query=rpc.rquotad&amp;sektion=8&amp;format=html">rpc.rquotad(8)</a> daemon makes quota information available to <a href="https://man.freebsd.org/cgi/man.cgi?query=quota&amp;sektion=1&amp;format=html">quota(1)</a> on NFS clients, allowing users on those machines to see their quota statistics.</p></div><div class=paragraph><p>Enable <code>rpc.rquotad</code> in <span class=filename>/etc/inetd.conf</span> like so:</p></div><div class="literalblock programlisting"><div class=content><pre>rquotad/1      dgram rpc/udp wait root /usr/libexec/rpc.rquotad rpc.rquotad</pre></div></div><div class=paragraph><p>Now restart <code>inetd</code>:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># service inetd restart</span></code></pre></div></div></div></div></div><div class=sect1><h2 id=disks-encrypting>19.14. Encrypting Disk Partitions<a class=anchor href=#disks-encrypting></a></h2><div class=sectionbody><div class=paragraph><p>FreeBSD offers excellent online protections against unauthorized data access. File permissions and <a href=../mac/#mac>Mandatory Access Control</a> (MAC) help prevent unauthorized users from accessing data while the operating system is active and the computer is powered up. However, the permissions enforced by the operating system are irrelevant if an attacker has physical access to a computer and can move the computer’s hard drive to another system to copy and analyze the data.</p></div><div class=paragraph><p>Regardless of how an attacker may have come into possession of a hard drive or powered-down computer, both the GEOM Based Disk Encryption (<code>gbde</code>) and <code>geli</code> cryptographic subsystems in FreeBSD are able to protect the data on the computer’s file systems against even highly-motivated attackers with significant resources. Unlike cumbersome encryption methods that encrypt only individual files, <code>gbde</code> and <code>geli</code> transparently encrypt entire file systems. No cleartext ever touches the hard drive’s platter.</p></div><div class=sect2><h3 id=_disk_encryption_with_gbde>19.14.1. Disk Encryption with gbde<a class=anchor href=#_disk_encryption_with_gbde></a></h3><div class="olist arabic procedure"><ol class=arabic><li><p>Configuring gbde requires superuser privileges.</p><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>% su -
Password:</code></pre></div></div></li><li><p>If using a custom kernel configuration file, ensure it contains this line:</p><div class=paragraph><p><code>options GEOM_BDE</code></p></div><div class=paragraph><p>If the kernel already contains this support, use <code>kldload</code> to load <a href="https://man.freebsd.org/cgi/man.cgi?query=gbde&amp;sektion=4&amp;format=html">gbde(4)</a>:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># kldload geom_bde</span></code></pre></div></div></li></ol></div><div class=sect3><h4 id=_preparing_the_encrypted_hard_drive>19.14.1.1. Preparing the Encrypted Hard Drive<a class=anchor href=#_preparing_the_encrypted_hard_drive></a></h4><div class=paragraph><p>The following example demonstrates adding a new hard drive to a system that will hold a single encrypted partition. This partition will be mounted as <span class=filename>/private</span>. gbde can also be used to encrypt <span class=filename>/home</span> and <span class=filename>/var/mail</span>, but this requires more complex instructions which exceed the scope of this introduction.</p></div><div class="olist arabic procedure"><ol class=arabic><li><p>Add the New Hard Drive</p><div class=paragraph><p>Install the new drive to the system as explained in <a href=#disks-adding>Adding Disks</a>. For the purposes of this example, a new hard drive partition has been added as <span class=filename>/dev/ad4s1c</span> and <span class=filename>/dev/ad0s1*</span> represents the existing standard FreeBSD partitions.</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># ls /dev/ad*</span>
/dev/ad0        /dev/ad0s1b     /dev/ad0s1e     /dev/ad4s1
/dev/ad0s1      /dev/ad0s1c     /dev/ad0s1f     /dev/ad4s1c
/dev/ad0s1a     /dev/ad0s1d     /dev/ad4</code></pre></div></div></li><li><p>Create a Directory to Hold <code>gbde</code> Lock Files</p><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># mkdir /etc/gbde</span></code></pre></div></div><div class=paragraph><p>The gbde lock file contains information that gbde requires to access encrypted partitions. Without access to the lock file, gbde will not be able to decrypt the data contained in the encrypted partition without significant manual intervention which is not supported by the software. Each encrypted partition uses a separate lock file.</p></div></li><li><p>Initialize the <code>gbde</code> Partition</p><div class=paragraph><p>A gbde partition must be initialized before it can be used. This initialization needs to be performed only once:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># gbde init /dev/ad4s1c -i -L /etc/gbde/ad4s1c.lock</span></code></pre></div></div><div class=paragraph><p><a href="https://man.freebsd.org/cgi/man.cgi?query=gbde&amp;sektion=8&amp;format=html">gbde(8)</a> will open the default editor, in order to set various configuration options in a template. For use with UFS1 or UFS2, set the sector_size to 2048:</p></div><div class="literalblock programlisting"><div class=content><pre># $FreeBSD: src/sbin/gbde/template.txt,v 1.1.36.1 2009/08/03 08:13:06 kensmith Exp $
#
# Sector size is the smallest unit of data which can be read or written.
# Making it too small decreases performance and decreases available space.
# Making it too large may prevent filesystems from working.  512 is the
# minimum and always safe.  For UFS, use the fragment size
#
sector_size	=	2048
[...]</pre></div></div><div class=paragraph><p><a href="https://man.freebsd.org/cgi/man.cgi?query=gbde&amp;sektion=8&amp;format=html">gbde(8)</a> will ask the user twice to type the passphrase used to secure the data. The passphrase must be the same both times. The ability of gbde to protect data depends entirely on the quality of the passphrase. For tips on how to select a secure passphrase that is easy to remember, see the <a href=http://world.std.com/~reinhold/diceware.html>Diceware Passphrase</a> website.</p></div><div class=paragraph><p><code>gbde init</code> creates a lock file for the gbde partition. In this example, it is stored as <span class=filename>/etc/gbde/ad4s1c.lock</span>. gbde lock files must end in ".lock" in order to be correctly detected by the <span class=filename>/etc/rc.d/gbde</span> start up script.</p></div><div class="admonitionblock caution"><table><tbody><tr><td class=icon><i class="fa icon-caution" title=Caution></i></td><td class=content><div class=paragraph><p>gbde lock files <em>must</em> be backed up together with the contents of any encrypted partitions. While deleting a lock file alone cannot prevent a determined attacker from decrypting a gbde partition, without the lock file, the legitimate owner will be unable to access the data on the encrypted partition without a significant amount of work that is totally unsupported by <a href="https://man.freebsd.org/cgi/man.cgi?query=gbde&amp;sektion=8&amp;format=html">gbde(8)</a>.</p></div></td></tr></tbody></table></div></li><li><p>Attach the Encrypted Partition to the Kernel</p><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># gbde attach /dev/ad4s1c -l /etc/gbde/ad4s1c.lock</span></code></pre></div></div><div class=paragraph><p>This command will prompt to input the passphrase that was selected during the initialization of the encrypted partition. The new encrypted device will appear in <span class=filename>/dev</span> as <span class=filename>/dev/device_name.bde</span>:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># ls /dev/ad*</span>
/dev/ad0        /dev/ad0s1b     /dev/ad0s1e     /dev/ad4s1
/dev/ad0s1      /dev/ad0s1c     /dev/ad0s1f     /dev/ad4s1c
/dev/ad0s1a     /dev/ad0s1d     /dev/ad4        /dev/ad4s1c.bde</code></pre></div></div></li><li><p>Create a File System on the Encrypted Device</p><div class=paragraph><p>Once the encrypted device has been attached to the kernel, a file system can be created on the device using <a href="https://man.freebsd.org/cgi/man.cgi?query=newfs&amp;sektion=8&amp;format=html">newfs(8)</a>. This example creates a UFS2 file system with soft updates enabled.</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># newfs -U /dev/ad4s1c.bde</span></code></pre></div></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p><a href="https://man.freebsd.org/cgi/man.cgi?query=newfs&amp;sektion=8&amp;format=html">newfs(8)</a> must be performed on an attached gbde partition which is identified by a <span class=filename>*.bde</span> extension to the device name.</p></div></td></tr></tbody></table></div></li><li><p>Mount the Encrypted Partition</p><div class=paragraph><p>Create a mount point for the encrypted file system:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># mkdir /private</span></code></pre></div></div><div class=paragraph><p>Mount the encrypted file system:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># mount /dev/ad4s1c.bde /private</span></code></pre></div></div></li><li><p>Verify That the Encrypted File System is Available</p><div class=paragraph><p>The encrypted file system should now be visible to <a href="https://man.freebsd.org/cgi/man.cgi?query=df&amp;sektion=1&amp;format=html">df(1)</a> and be available for use.</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>% <span class=nb>df</span> <span class=nt>-H</span>
Filesystem        Size   Used  Avail Capacity  Mounted on
/dev/ad0s1a      1037M    72M   883M     8%    /
/devfs            1.0K   1.0K     0B   100%    /dev
/dev/ad0s1f       8.1G    55K   7.5G     0%    /home
/dev/ad0s1e      1037M   1.1M   953M     0%    /tmp
/dev/ad0s1d       6.1G   1.9G   3.7G    35%    /usr
/dev/ad4s1c.bde   150G   4.1K   138G     0%    /private</code></pre></div></div></li></ol></div></div><div class=sect3><h4 id=_mounting_existing_encrypted_file_systems>19.14.1.2. Mounting Existing Encrypted File Systems<a class=anchor href=#_mounting_existing_encrypted_file_systems></a></h4><div class=paragraph><p>After each boot, any encrypted file systems must be re-attached to the kernel, checked for errors, and mounted, before the file systems can be used. The required commands must be executed as <code>root</code>.</p></div><div class="olist arabic procedure"><ol class=arabic><li><p>Attach the <code>gbde</code> Partition to the Kernel</p><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># gbde attach /dev/ad4s1c -l /etc/gbde/ad4s1c.lock</span></code></pre></div></div><div class=paragraph><p>This command will prompt for the passphrase that was selected during initialization of the encrypted gbde partition.</p></div></li><li><p>Check the File System for Errors</p><div class=paragraph><p>Since encrypted file systems cannot yet be listed in <span class=filename>/etc/fstab</span> for automatic mounting, the file systems must be checked for errors by running <a href="https://man.freebsd.org/cgi/man.cgi?query=fsck&amp;sektion=8&amp;format=html">fsck(8)</a> manually before mounting:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># fsck -p -t ffs /dev/ad4s1c.bde</span></code></pre></div></div></li><li><p>Mount the Encrypted File System</p><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># mount /dev/ad4s1c.bde /private</span></code></pre></div></div><div class=paragraph><p>The encrypted file system is now available for use.</p></div></li></ol></div><div class=sect4><h5 id=_automatically_mounting_encrypted_partitions>19.14.1.2.1. Automatically Mounting Encrypted Partitions<a class=anchor href=#_automatically_mounting_encrypted_partitions></a></h5><div class=paragraph><p>It is possible to create a script to automatically attach, check, and mount an encrypted partition, but for security reasons the script should not contain the <a href="https://man.freebsd.org/cgi/man.cgi?query=gbde&amp;sektion=8&amp;format=html">gbde(8)</a> password. Instead, it is recommended that such scripts be run manually while providing the password via the console or <a href="https://man.freebsd.org/cgi/man.cgi?query=ssh&amp;sektion=1&amp;format=html">ssh(1)</a>.</p></div><div class=paragraph><p>As an alternative, an <span class=filename>rc.d</span> script is provided. Arguments for this script can be passed via <a href="https://man.freebsd.org/cgi/man.cgi?query=rc.conf&amp;sektion=5&amp;format=html">rc.conf(5)</a>:</p></div><div class="literalblock programlisting"><div class=content><pre>gbde_autoattach_all=&#34;YES&#34;
gbde_devices=&#34;ad4s1c&#34;
gbde_lockdir=&#34;/etc/gbde&#34;</pre></div></div><div class=paragraph><p>This requires that the gbde passphrase be entered at boot time. After typing the correct passphrase, the gbde encrypted partition will be mounted automatically. This can be useful when using gbde on laptops.</p></div></div></div><div class=sect3><h4 id=_cryptographic_protections_employed_by_gbde>19.14.1.3. Cryptographic Protections Employed by <code>gbde</code><a class=anchor href=#_cryptographic_protections_employed_by_gbde></a></h4><div class=paragraph><p><a href="https://man.freebsd.org/cgi/man.cgi?query=gbde&amp;sektion=8&amp;format=html">gbde(8)</a> encrypts the sector payload using 128-bit AES in CBC mode. Each sector on the disk is encrypted with a different AES key. For more information on the cryptographic design, including how the sector keys are derived from the user-supplied passphrase, refer to <a href="https://man.freebsd.org/cgi/man.cgi?query=gbde&amp;sektion=4&amp;format=html">gbde(4)</a>.</p></div></div><div class=sect3><h4 id=_compatibility_issues>19.14.1.4. Compatibility Issues<a class=anchor href=#_compatibility_issues></a></h4><div class=paragraph><p><a href="https://man.freebsd.org/cgi/man.cgi?query=sysinstall&amp;sektion=8&amp;format=html">sysinstall(8)</a> is incompatible with gbde-encrypted devices. All <span class=filename>*.bde</span> devices must be detached from the kernel before starting <a href="https://man.freebsd.org/cgi/man.cgi?query=sysinstall&amp;sektion=8&amp;format=html">sysinstall(8)</a> or it will crash during its initial probing for devices. To detach the encrypted device used in the example, use the following command:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># gbde detach /dev/ad4s1c</span></code></pre></div></div></div></div><div class=sect2><h3 id=_disk_encryption_with_geli>19.14.2. Disk Encryption with <code>geli</code><a class=anchor href=#_disk_encryption_with_geli></a></h3><div class=paragraph><p>An alternative cryptographic GEOM class is available through <a href="https://man.freebsd.org/cgi/man.cgi?query=geli&amp;sektion=8&amp;format=html">geli(8)</a>. <code>geli</code> differs from <code>gbde</code>; offers different features, and uses a different scheme for doing cryptographic work.</p></div><div class=paragraph><p><a href="https://man.freebsd.org/cgi/man.cgi?query=geli&amp;sektion=8&amp;format=html">geli(8)</a> provides the following features:</p></div><div class=ulist><ul><li><p>Utilizes the <a href="https://man.freebsd.org/cgi/man.cgi?query=crypto&amp;sektion=9&amp;format=html">crypto(9)</a> framework and, when cryptographic hardware is available, <code>geli</code> uses it automatically.</p></li><li><p>Supports multiple cryptographic algorithms such as AES, Blowfish, and 3DES.</p></li><li><p>Allows the root partition to be encrypted. The passphrase used to access the encrypted root partition will be requested during system boot.</p></li><li><p>Allows the use of two independent keys such as a "key" and a "company key".</p></li><li><p><code>geli</code> is fast as it performs simple sector-to-sector encryption.</p></li><li><p>Allows backup and restore of master keys. If a user destroys their keys, it is still possible to get access to the data by restoring keys from the backup.</p></li><li><p>Allows a disk to attach with a random, one-time key which is useful for swap partitions and temporary file systems.</p></li></ul></div><div class=paragraph><p>More <code>geli</code> features can be found in <a href="https://man.freebsd.org/cgi/man.cgi?query=geli&amp;sektion=8&amp;format=html">geli(8)</a>.</p></div><div class=paragraph><p>This section describes how to enable support for <code>geli</code> in the FreeBSD kernel and explains how to create and use a <code>geli</code> encryption provider.</p></div><div class=paragraph><p>Superuser privileges are required since modifications to the kernel are necessary.</p></div><div class="olist arabic procedure"><ol class=arabic><li><p>Adding <code>geli</code> Support to the Kernel</p><div class=paragraph><p>For a custom kernel, ensure the kernel configuration file contains these lines:</p></div><div class="literalblock programlisting"><div class=content><pre>options GEOM_ELI
device crypto</pre></div></div><div class=paragraph><p>Alternatively, the <code>geli</code> module can be loaded at boot time by adding the following line to <span class=filename>/boot/loader.conf</span>:</p></div><div class="literalblock programlisting"><div class=content><pre>geom_eli_load=&#34;YES&#34;</pre></div></div><div class=paragraph><p><a href="https://man.freebsd.org/cgi/man.cgi?query=geli&amp;sektion=8&amp;format=html">geli(8)</a> should now be supported by the kernel.</p></div></li><li><p>Generating the Master Key</p><div class=paragraph><p>The following example describes how to generate a key file which will be used as part of the master key for the encrypted provider mounted under <span class=filename>/private</span>. The key file will provide some random data used to encrypt the master key. The master key will also be protected by a passphrase. The provider’s sector size will be 4kB. The example will describe how to attach to the <code>geli</code> provider, create a file system on it, mount it, work with it, and finally, how to detach it.</p></div><div class=paragraph><p>It is recommended to use a bigger sector size, such as 4kB, for better performance.</p></div><div class=paragraph><p>The master key will be protected with a passphrase and the data source for the key file will be <span class=filename>/dev/random</span>. The sector size of the provider <span class=filename>/dev/da2.eli</span> will be 4kB.</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># dd if=/dev/random of=/root/da2.key bs=64 count=1</span>
<span class=c># geli init -s 4096 -K /root/da2.key /dev/da2</span>
Enter new passphrase:
Reenter new passphrase:</code></pre></div></div><div class=paragraph><p>It is not mandatory to use both a passphrase and a key file as either method of securing the master key can be used in isolation.</p></div><div class=paragraph><p>If the key file is given as "-", standard input will be used. This example shows how more than one key file can be used:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># cat keyfile1 keyfile2 keyfile3 | geli init -K - /dev/da2</span></code></pre></div></div></li><li><p>Attaching the Provider with the Generated Key</p><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># geli attach -k /root/da2.key /dev/da2</span>
Enter passphrase:</code></pre></div></div><div class=paragraph><p>The new plaintext device will be named <span class=filename>/dev/da2.eli</span>.</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># ls /dev/da2*</span>
/dev/da2  /dev/da2.eli</code></pre></div></div></li><li><p>Creating the New File System</p><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># dd if=/dev/random of=/dev/da2.eli bs=1m</span>
<span class=c># newfs /dev/da2.eli</span>
<span class=c># mount /dev/da2.eli /private</span></code></pre></div></div><div class=paragraph><p>The encrypted file system should now be visible to <a href="https://man.freebsd.org/cgi/man.cgi?query=df&amp;sektion=1&amp;format=html">df(1)</a> and be available for use:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># df -H</span>
Filesystem     Size   Used  Avail Capacity  Mounted on
/dev/ad0s1a    248M    89M   139M    38%    /
/devfs         1.0K   1.0K     0B   100%    /dev
/dev/ad0s1f    7.7G   2.3G   4.9G    32%    /usr
/dev/ad0s1d    989M   1.5M   909M     0%    /tmp
/dev/ad0s1e    3.9G   1.3G   2.3G    35%    /var
/dev/da2.eli   150G   4.1K   138G     0%    /private</code></pre></div></div></li><li><p>Unmounting and Detaching the Provider</p><div class=paragraph><p>Once the work on the encrypted partition is done, and the <span class=filename>/private</span> partition is no longer needed, it is prudent to consider unmounting and detaching the <code>geli</code> encrypted partition from the kernel:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># umount /private</span>
<span class=c># geli detach da2.eli</span></code></pre></div></div></li></ol></div><div class=paragraph><p>More information about the use of <a href="https://man.freebsd.org/cgi/man.cgi?query=geli&amp;sektion=8&amp;format=html">geli(8)</a> can be found in its manual page.</p></div><div class=sect3><h4 id=_using_the_geli_rc_d_script>19.14.2.1. Using the <span class=filename>geli</span> <span class=filename>rc.d</span> Script<a class=anchor href=#_using_the_geli_rc_d_script></a></h4><div class=paragraph><p><code>geli</code> comes with a <span class=filename>rc.d</span> script which can be used to simplify the usage of <code>geli</code>. An example of configuring <code>geli</code> through <a href="https://man.freebsd.org/cgi/man.cgi?query=rc.conf&amp;sektion=5&amp;format=html">rc.conf(5)</a> follows:</p></div><div class="literalblock programlisting"><div class=content><pre>geli_devices=&#34;da2&#34;
geli_da2_flags=&#34;-p -k /root/da2.key&#34;</pre></div></div><div class=paragraph><p>This configures <span class=filename>/dev/da2</span> as a <code>geli</code> provider of which the master key file is located in <span class=filename>/root/da2.key</span>. <code>geli</code> will not use a passphrase when attaching to the provider if <code>-P</code> was given during the <code>geli init</code> phase. The system will detach the <code>geli</code> provider from the kernel before the system shuts down.</p></div><div class=paragraph><p>More information about configuring <span class=filename>rc.d</span> is provided in the <a href=../config/#configtuning-rcd>rc.d</a> section of the Handbook.</p></div></div></div></div></div><div class=sect1><h2 id=swap-encrypting>19.15. Encrypting Swap Space<a class=anchor href=#swap-encrypting></a></h2><div class=sectionbody><div class=paragraph><p>Like the encryption of disk partitions, encryption of swap space is used to protect sensitive information. Consider an application that deals with passwords. As long as these passwords stay in physical memory, these passwords will not be written to disk and be cleared after a reboot. If FreeBSD starts swapping out memory pages to free space for other applications, the passwords may be written to the disk platters unencrypted. Encrypting swap space can be a solution for this scenario.</p></div><div class=paragraph><p>The <a href="https://man.freebsd.org/cgi/man.cgi?query=gbde&amp;sektion=8&amp;format=html">gbde(8)</a> or <a href="https://man.freebsd.org/cgi/man.cgi?query=geli&amp;sektion=8&amp;format=html">geli(8)</a> encryption systems may be used for swap encryption. Both systems use the <span class=filename>encswap</span> <a href=../config/#configtuning-rcd>rc.d</a> script.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>For the remainder of this section, <span class=filename>ad0s1b</span> will be the swap partition.</p></div></td></tr></tbody></table></div><div class=paragraph><p>Swap partitions are not encrypted by default and should be cleared of any sensitive data before continuing. To overwrite the current swap parition with random garbage, execute the following command:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># dd if=/dev/random of=/dev/ad0s1b bs=1m</span></code></pre></div></div><div class=sect2><h3 id=_swap_encryption_with_gbde8>19.15.1. Swap Encryption with <a href="https://man.freebsd.org/cgi/man.cgi?query=gbde&amp;sektion=8&amp;format=html">gbde(8)</a><a class=anchor href=#_swap_encryption_with_gbde8></a></h3><div class=paragraph><p>The <code>.bde</code> suffix should be added to the device in the respective <span class=filename>/etc/fstab</span> swap line:</p></div><div class="literalblock programlisting"><div class=content><pre># Device		Mountpoint	FStype	Options		Dump	Pass#
/dev/ad0s1b.bde		none		swap	sw		0	0</pre></div></div></div><div class=sect2><h3 id=_swap_encryption_with_geli8>19.15.2. Swap Encryption with <a href="https://man.freebsd.org/cgi/man.cgi?query=geli&amp;sektion=8&amp;format=html">geli(8)</a><a class=anchor href=#_swap_encryption_with_geli8></a></h3><div class=paragraph><p>The procedure for instead using <a href="https://man.freebsd.org/cgi/man.cgi?query=geli&amp;sektion=8&amp;format=html">geli(8)</a> for swap encryption is similar to that of using <a href="https://man.freebsd.org/cgi/man.cgi?query=gbde&amp;sektion=8&amp;format=html">gbde(8)</a>. The <code>.eli</code> suffix should be added to the device in the respective <span class=filename>/etc/fstab</span> swap line:</p></div><div class="literalblock programlisting"><div class=content><pre># Device		Mountpoint	FStype	Options		Dump	Pass#
/dev/ad0s1b.eli		none		swap	sw		0	0</pre></div></div><div class=paragraph><p><a href="https://man.freebsd.org/cgi/man.cgi?query=geli&amp;sektion=8&amp;format=html">geli(8)</a> uses the AES algorithm with a key length of 128 bit by default. These defaults can be altered by using <code>geli_swap_flags</code> in <span class=filename>/etc/rc.conf</span>. The following line tells the <span class=filename>encswap</span> rc.d script to create <a href="https://man.freebsd.org/cgi/man.cgi?query=geli&amp;sektion=8&amp;format=html">geli(8)</a> swap partitions using the Blowfish algorithm with a key length of 128 bits and a sectorsize of 4 kilobytes, and sets "detach on last close":</p></div><div class="literalblock programlisting"><div class=content><pre>geli_swap_flags=&#34;-e blowfish -l 128 -s 4096 -d&#34;</pre></div></div><div class=paragraph><p>Refer to the description of <code>onetime</code> in <a href="https://man.freebsd.org/cgi/man.cgi?query=geli&amp;sektion=8&amp;format=html">geli(8)</a> for a list of possible options.</p></div></div><div class=sect2><h3 id=_encrypted_swap_verification>19.15.3. Encrypted Swap Verification<a class=anchor href=#_encrypted_swap_verification></a></h3><div class=paragraph><p>Once the system has rebooted, proper operation of the encrypted swap can be verified using <code>swapinfo</code>.</p></div><div class=paragraph><p>If <a href="https://man.freebsd.org/cgi/man.cgi?query=gbde&amp;sektion=8&amp;format=html">gbde(8)</a> is being used:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>% swapinfo
Device          1K-blocks     Used    Avail Capacity
/dev/ad0s1b.bde    542720        0   542720     0%</code></pre></div></div><div class=paragraph><p>If <a href="https://man.freebsd.org/cgi/man.cgi?query=geli&amp;sektion=8&amp;format=html">geli(8)</a> is being used:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>% swapinfo
Device          1K-blocks     Used    Avail Capacity
/dev/ad0s1b.eli    542720        0   542720     0%</code></pre></div></div></div></div></div><div class=sect1><h2 id=disks-hast>19.16. Highly Available Storage (HAST)<a class=anchor href=#disks-hast></a></h2><div class=sectionbody><div class=sect2><h3 id=_synopsis>19.16.1. Synopsis<a class=anchor href=#_synopsis></a></h3><div class=paragraph><p>High availability is one of the main requirements in serious business applications and highly-available storage is a key component in such environments. Highly Available STorage, or HAST, was developed by Paweł Jakub Dawidek &lt;<a href=mailto:pjd@FreeBSD.org>pjd@FreeBSD.org</a>> as a framework which allows transparent storage of the same data across several physically separated machines connected by a TCP/IP network. HAST can be understood as a network-based RAID1 (mirror), and is similar to the DRBD® storage system known from the GNU/Linux® platform. In combination with other high-availability features of FreeBSD like CARP, HAST makes it possible to build a highly-available storage cluster that is resistant to hardware failures.</p></div><div class=paragraph><p>After reading this section, you will know:</p></div><div class=ulist><ul><li><p>What HAST is, how it works and which features it provides.</p></li><li><p>How to set up and use HAST on FreeBSD.</p></li><li><p>How to integrate CARP and <a href="https://man.freebsd.org/cgi/man.cgi?query=devd&amp;sektion=8&amp;format=html">devd(8)</a> to build a robust storage system.</p></li></ul></div><div class=paragraph><p>Before reading this section, you should:</p></div><div class=ulist><ul><li><p>Understand UNIX® and <a href=../basics/#basics>FreeBSD Basics</a>.</p></li><li><p>Know how to <a href=../config/#config-tuning>configure</a> network interfaces and other core FreeBSD subsystems.</p></li><li><p>Have a good understanding of <a href=../partiv/#network-communication>FreeBSD networking</a>.</p></li></ul></div><div class=paragraph><p>The HAST project was sponsored by The FreeBSD Foundation with support from <a href=http://www.omc.net/>OMCnet Internet Service GmbH</a> and <a href=http://www.transip.nl/>TransIP BV</a>.</p></div></div><div class=sect2><h3 id=_hast_features>19.16.2. HAST Features<a class=anchor href=#_hast_features></a></h3><div class=paragraph><p>The main features of the HAST system are:</p></div><div class=ulist><ul><li><p>Can be used to mask I/O errors on local hard drives.</p></li><li><p>File system agnostic as it works with any file system supported by FreeBSD.</p></li><li><p>Efficient and quick resynchronization, synchronizing only blocks that were modified during the downtime of a node.</p></li><li><p>Can be used in an already deployed environment to add additional redundancy.</p></li><li><p>Together with CARP, Heartbeat, or other tools, it can be used to build a robust and durable storage system.</p></li></ul></div></div><div class=sect2><h3 id=_hast_operation>19.16.3. HAST Operation<a class=anchor href=#_hast_operation></a></h3><div class=paragraph><p>As HAST provides a synchronous block-level replication of any storage media to several machines, it requires at least two physical machines: the <code>primary</code>, also known as the <code>master</code> node, and the <code>secondary</code> or <code>slave</code> node. These two machines together are referred to as a cluster.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>HAST is currently limited to two cluster nodes in total.</p></div></td></tr></tbody></table></div><div class=paragraph><p>Since HAST works in a primary-secondary configuration, it allows only one of the cluster nodes to be active at any given time. The <code>primary</code> node, also called <code>active</code>, is the one which will handle all the I/O requests to HAST-managed devices. The <code>secondary</code> node is automatically synchronized from the <code>primary</code> node.</p></div><div class=paragraph><p>The physical components of the HAST system are:</p></div><div class=ulist><ul><li><p>local disk on primary node, and</p></li><li><p>disk on remote, secondary node.</p></li></ul></div><div class=paragraph><p>HAST operates synchronously on a block level, making it transparent to file systems and applications. HAST provides regular GEOM providers in <span class=filename>/dev/hast/</span> for use by other tools or applications, thus there is no difference between using HAST-provided devices and raw disks or partitions.</p></div><div class=paragraph><p>Each write, delete, or flush operation is sent to the local disk and to the remote disk over TCP/IP. Each read operation is served from the local disk, unless the local disk is not up-to-date or an I/O error occurs. In such case, the read operation is sent to the secondary node.</p></div><div class=sect3><h4 id=_synchronization_and_replication_modes>19.16.3.1. Synchronization and Replication Modes<a class=anchor href=#_synchronization_and_replication_modes></a></h4><div class=paragraph><p>HAST tries to provide fast failure recovery. For this reason, it is very important to reduce synchronization time after a node’s outage. To provide fast synchronization, HAST manages an on-disk bitmap of dirty extents and only synchronizes those during a regular synchronization, with an exception of the initial sync.</p></div><div class=paragraph><p>There are many ways to handle synchronization. HAST implements several replication modes to handle different synchronization methods:</p></div><div class=ulist><ul><li><p><em>memsync</em>: report write operation as completed when the local write operation is finished and when the remote node acknowledges data arrival, but before actually storing the data. The data on the remote node will be stored directly after sending the acknowledgement. This mode is intended to reduce latency, but still provides very good reliability.</p></li><li><p><em>fullsync</em>: report write operation as completed when local write completes and when remote write completes. This is the safest and the slowest replication mode. This mode is the default.</p></li><li><p><em>async</em>: report write operation as completed when local write completes. This is the fastest and the most dangerous replication mode. It should be used when replicating to a distant node where latency is too high for other modes.</p></li></ul></div></div></div><div class=sect2><h3 id=_hast_configuration>19.16.4. HAST Configuration<a class=anchor href=#_hast_configuration></a></h3><div class=paragraph><p>HAST requires <code>GEOM_GATE</code> support which is not present in the default <code>GENERIC</code> kernel. However, the <code>geom_gate.ko</code> loadable module is available in the default FreeBSD installation. Alternatively, to build <code>GEOM_GATE</code> support into the kernel statically, add this line to the custom kernel configuration file:</p></div><div class="literalblock programlisting"><div class=content><pre>options	GEOM_GATE</pre></div></div><div class=paragraph><p>The HAST framework consists of several parts from the operating system’s point of view:</p></div><div class=ulist><ul><li><p>the <a href="https://man.freebsd.org/cgi/man.cgi?query=hastd&amp;sektion=8&amp;format=html">hastd(8)</a> daemon responsible for data synchronization,</p></li><li><p>the <a href="https://man.freebsd.org/cgi/man.cgi?query=hastctl&amp;sektion=8&amp;format=html">hastctl(8)</a> userland management utility,</p></li><li><p>and the <a href="https://man.freebsd.org/cgi/man.cgi?query=hast.conf&amp;sektion=5&amp;format=html">hast.conf(5)</a> configuration file.</p></li></ul></div><div class=paragraph><p>The following example describes how to configure two nodes in <code>master</code>-<code>slave</code> / <code>primary</code>-<code>secondary</code> operation using HAST to replicate the data between the two. The nodes will be called <code>hasta</code> with an IP address of <em>172.16.0.1</em> and <code>hastb</code> with an IP of address <em>172.16.0.2</em>. Both nodes will have a dedicated hard drive <span class=filename>/dev/ad6</span> of the same size for HAST operation. The HAST pool, sometimes also referred to as a resource or the GEOM provider in <span class=filename>/dev/hast/</span>, will be called <span class=filename>test</span>.</p></div><div class=paragraph><p>Configuration of HAST is done using <span class=filename>/etc/hast.conf</span>. This file should be the same on both nodes. The simplest configuration possible is:</p></div><div class="literalblock programlisting"><div class=content><pre>resource test {
	on hasta {
		local /dev/ad6
		remote 172.16.0.2
	}
	on hastb {
		local /dev/ad6
		remote 172.16.0.1
	}
}</pre></div></div><div class=paragraph><p>For more advanced configuration, refer to <a href="https://man.freebsd.org/cgi/man.cgi?query=hast.conf&amp;sektion=5&amp;format=html">hast.conf(5)</a>.</p></div><div class="admonitionblock tip"><table><tbody><tr><td class=icon><i class="fa icon-tip" title=Tip></i></td><td class=content><div class=paragraph><p>It is also possible to use host names in the <code>remote</code> statements. In such a case, make sure that these hosts are resolvable and are defined in <span class=filename>/etc/hosts</span> or in the local DNS.</p></div></td></tr></tbody></table></div><div class=paragraph><p>Now that the configuration exists on both nodes, the HAST pool can be created. Run these commands on both nodes to place the initial metadata onto the local disk and to start <a href="https://man.freebsd.org/cgi/man.cgi?query=hastd&amp;sektion=8&amp;format=html">hastd(8)</a>:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># hastctl create test</span>
<span class=c># service hastd onestart</span></code></pre></div></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>It is <em>not</em> possible to use GEOM providers with an existing file system or to convert an existing storage to a HAST-managed pool. This procedure needs to store some metadata on the provider and there will not be enough required space available on an existing provider.</p></div></td></tr></tbody></table></div><div class=paragraph><p>A HAST node’s <code>primary</code> or <code>secondary</code> role is selected by an administrator, or software like Heartbeat, using <a href="https://man.freebsd.org/cgi/man.cgi?query=hastctl&amp;sektion=8&amp;format=html">hastctl(8)</a>. On the primary node, <code>hasta</code>, issue this command:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># hastctl role primary test</span></code></pre></div></div><div class=paragraph><p>Similarly, run this command on the secondary node, <code>hastb</code>:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># hastctl role secondary test</span></code></pre></div></div><div class="admonitionblock caution"><table><tbody><tr><td class=icon><i class="fa icon-caution" title=Caution></i></td><td class=content><div class=paragraph><p>When the nodes are unable to communicate with each other, and both are configured as primary nodes, the condition is called <code>split-brain</code>. To troubleshoot this situation, follow the steps described in <a href=#disks-hast-sb>Recovering from the Split-brain Condition</a>.</p></div></td></tr></tbody></table></div><div class=paragraph><p>Verify the result by running <a href="https://man.freebsd.org/cgi/man.cgi?query=hastctl&amp;sektion=8&amp;format=html">hastctl(8)</a> on each node:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># hastctl status test</span></code></pre></div></div><div class=paragraph><p>The important text is the <code>status</code> line, which should say <code>complete</code> on each of the nodes. If it says <code>degraded</code>, something went wrong. At this point, the synchronization between the nodes has already started. The synchronization completes when <code>hastctl status</code> reports 0 bytes of <code>dirty</code> extents.</p></div><div class=paragraph><p>The next step is to create a filesystem on the <span class=filename>/dev/hast/test</span> GEOM provider and mount it. This must be done on the <code>primary</code> node, as <span class=filename>/dev/hast/test</span> appears only on the <code>primary</code> node. Creating the filesystem can take a few minutes, depending on the size of the hard drive:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># newfs -U /dev/hast/test</span>
<span class=c># mkdir /hast/test</span>
<span class=c># mount /dev/hast/test /hast/test</span></code></pre></div></div><div class=paragraph><p>Once the HAST framework is configured properly, the final step is to make sure that HAST is started automatically during system boot. Add this line to <span class=filename>/etc/rc.conf</span>:</p></div><div class="literalblock programlisting"><div class=content><pre>hastd_enable=&#34;YES&#34;</pre></div></div><div class=sect3><h4 id=_failover_configuration>19.16.4.1. Failover Configuration<a class=anchor href=#_failover_configuration></a></h4><div class=paragraph><p>The goal of this example is to build a robust storage system which is resistant to the failure of any given node. The scenario is that a <code>primary</code> node of the cluster fails. If this happens, the <code>secondary</code> node is there to take over seamlessly, check and mount the file system, and continue to work without missing a single bit of data.</p></div><div class=paragraph><p>To accomplish this task, another FreeBSD feature, CARP, provides for automatic failover on the IP layer. CARP (Common Address Redundancy Protocol) allows multiple hosts on the same network segment to share an IP address. Set up CARP on both nodes of the cluster according to the documentation available in <a href=../advanced-networking/#carp>Common Access Redundancy Protocol (CARP)</a>. After setup, each node will have its own <span class=filename>carp0</span> interface with a shared IP address of <em>172.16.0.254</em>. The primary HAST node of the cluster must be the master CARP node.</p></div><div class=paragraph><p>The HAST pool created in the previous section is now ready to be exported to the other hosts on the network. This can be accomplished by exporting it through NFS or Samba, using the shared IP address <em>172.16.0.254</em>. The only problem which remains unresolved is an automatic failover should the primary node fail.</p></div><div class=paragraph><p>In the event of CARP interfaces going up or down, the FreeBSD operating system generates a <a href="https://man.freebsd.org/cgi/man.cgi?query=devd&amp;sektion=8&amp;format=html">devd(8)</a> event, making it possible to watch for state changes on the CARP interfaces. A state change on the CARP interface is an indication that one of the nodes failed or came back online. These state change events make it possible to run a script which will automatically handle the HAST failover.</p></div><div class=paragraph><p>To be able to catch state changes on the CARP interfaces, add this configuration to <span class=filename>/etc/devd.conf</span> on each node:</p></div><div class="literalblock programlisting"><div class=content><pre>notify 30 {
	match &#34;system&#34; &#34;IFNET&#34;;
	match &#34;subsystem&#34; &#34;carp0&#34;;
	match &#34;type&#34; &#34;LINK_UP&#34;;
	action &#34;/usr/local/sbin/carp-hast-switch master&#34;;
};

notify 30 {
	match &#34;system&#34; &#34;IFNET&#34;;
	match &#34;subsystem&#34; &#34;carp0&#34;;
	match &#34;type&#34; &#34;LINK_DOWN&#34;;
	action &#34;/usr/local/sbin/carp-hast-switch slave&#34;;
};</pre></div></div><div class=paragraph><p>Restart <a href="https://man.freebsd.org/cgi/man.cgi?query=devd&amp;sektion=8&amp;format=html">devd(8)</a> on both nodes to put the new configuration into effect:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># service devd restart</span></code></pre></div></div><div class=paragraph><p>When the <span class=filename>carp0</span> interface state changes by going up or down , the system generates a notification, allowing the <a href="https://man.freebsd.org/cgi/man.cgi?query=devd&amp;sektion=8&amp;format=html">devd(8)</a> subsystem to run an arbitrary script, in this case <span class=filename>/usr/local/sbin/carp-hast-switch</span>. This script handles the automatic failover. For further clarification about the above <a href="https://man.freebsd.org/cgi/man.cgi?query=devd&amp;sektion=8&amp;format=html">devd(8)</a> configuration, refer to <a href="https://man.freebsd.org/cgi/man.cgi?query=devd.conf&amp;sektion=5&amp;format=html">devd.conf(5)</a>.</p></div><div class=paragraph><p>An example of such a script could be:</p></div><div class="literalblock programlisting"><div class=content><pre>#!/bin/sh

# Original script by Freddie Cash &lt;fjwcash@gmail.com&gt;
# Modified by Michael W. Lucas &lt;mwlucas@BlackHelicopters.org&gt;
# and Viktor Petersson &lt;vpetersson@wireload.net&gt;

# The names of the HAST resources, as listed in /etc/hast.conf
resources=&#34;test&#34;

# delay in mounting HAST resource after becoming master
# make your best guess
delay=3

# logging
log=&#34;local0.debug&#34;
name=&#34;carp-hast&#34;

# end of user configurable stuff

case &#34;$1&#34; in
	master)
		logger -p $log -t $name &#34;Switching to primary provider for ${resources}.&#34;
		sleep ${delay}

		# Wait for any &#34;hastd secondary&#34; processes to stop
		for disk in ${resources}; do
			while $( pgrep -lf &#34;hastd: ${disk} \(secondary\)&#34; &gt; /dev/null 2&gt;&amp;1 ); do
				sleep 1
			done

			# Switch role for each disk
			hastctl role primary ${disk}
			if [ $? -ne 0 ]; then
				logger -p $log -t $name &#34;Unable to change role to primary for resource ${disk}.&#34;
				exit 1
			fi
		done

		# Wait for the /dev/hast/* devices to appear
		for disk in ${resources}; do
			for I in $( jot 60 ); do
				[ -c &#34;/dev/hast/${disk}&#34; ] &amp;&amp; break
				sleep 0.5
			done

			if [ ! -c &#34;/dev/hast/${disk}&#34; ]; then
				logger -p $log -t $name &#34;GEOM provider /dev/hast/${disk} did not appear.&#34;
				exit 1
			fi
		done

		logger -p $log -t $name &#34;Role for HAST resources ${resources} switched to primary.&#34;

		logger -p $log -t $name &#34;Mounting disks.&#34;
		for disk in ${resources}; do
			mkdir -p /hast/${disk}
			fsck -p -y -t ufs /dev/hast/${disk}
			mount /dev/hast/${disk} /hast/${disk}
		done

	;;

	slave)
		logger -p $log -t $name &#34;Switching to secondary provider for ${resources}.&#34;

		# Switch roles for the HAST resources
		for disk in ${resources}; do
			if ! mount | grep -q &#34;^/dev/hast/${disk} on &#34;
			then
			else
				umount -f /hast/${disk}
			fi
			sleep $delay
			hastctl role secondary ${disk} 2&gt;&amp;1
			if [ $? -ne 0 ]; then
				logger -p $log -t $name &#34;Unable to switch role to secondary for resource ${disk}.&#34;
				exit 1
			fi
			logger -p $log -t $name &#34;Role switched to secondary for resource ${disk}.&#34;
		done
	;;
esac</pre></div></div><div class=paragraph><p>In a nutshell, the script takes these actions when a node becomes <code>master</code> / <code>primary</code>:</p></div><div class=ulist><ul><li><p>Promotes the HAST pools to primary on a given node.</p></li><li><p>Checks the file system under the HAST pool.</p></li><li><p>Mounts the pools at an appropriate place.</p></li></ul></div><div class=paragraph><p>When a node becomes <code>backup</code> / <code>secondary</code>:</p></div><div class=ulist><ul><li><p>Unmounts the HAST pools.</p></li><li><p>Degrades the HAST pools to secondary.</p></li></ul></div><div class="admonitionblock caution"><table><tbody><tr><td class=icon><i class="fa icon-caution" title=Caution></i></td><td class=content><div class=paragraph><p>Keep in mind that this is just an example script which serves as a proof of concept. It does not handle all the possible scenarios and can be extended or altered in any way, for example, to start/stop required services.</p></div></td></tr></tbody></table></div><div class="admonitionblock tip"><table><tbody><tr><td class=icon><i class="fa icon-tip" title=Tip></i></td><td class=content><div class=paragraph><p>For this example, a standard UFS file system was used. To reduce the time needed for recovery, a journal-enabled UFS or ZFS file system can be used instead.</p></div></td></tr></tbody></table></div><div class=paragraph><p>More detailed information with additional examples can be found in the <a href=http://wiki.FreeBSD.org/HAST>HAST Wiki</a> page.</p></div></div></div><div class=sect2><h3 id=_troubleshooting>19.16.5. Troubleshooting<a class=anchor href=#_troubleshooting></a></h3><div class=sect3><h4 id=_general_troubleshooting_tips>19.16.5.1. General Troubleshooting Tips<a class=anchor href=#_general_troubleshooting_tips></a></h4><div class=paragraph><p>HAST should generally work without issues. However, as with any other software product, there may be times when it does not work as supposed. The sources of the problems may be different, but the rule of thumb is to ensure that the time is synchronized between all nodes of the cluster.</p></div><div class=paragraph><p>When troubleshooting HAST problems, the debugging level of <a href="https://man.freebsd.org/cgi/man.cgi?query=hastd&amp;sektion=8&amp;format=html">hastd(8)</a> should be increased by starting <a href="https://man.freebsd.org/cgi/man.cgi?query=hastd&amp;sektion=8&amp;format=html">hastd(8)</a> with <code>-d</code>. This argument may be specified multiple times to further increase the debugging level. A lot of useful information may be obtained this way. Consider also using <code>-F</code>, which starts <a href="https://man.freebsd.org/cgi/man.cgi?query=hastd&amp;sektion=8&amp;format=html">hastd(8)</a> in the foreground.</p></div></div><div class=sect3><h4 id=disks-hast-sb>19.16.5.2. Recovering from the Split-brain Condition<a class=anchor href=#disks-hast-sb></a></h4><div class=paragraph><p><code>Split-brain</code> is when the nodes of the cluster are unable to communicate with each other, and both are configured as primary. This is a dangerous condition because it allows both nodes to make incompatible changes to the data. This problem must be corrected manually by the system administrator.</p></div><div class=paragraph><p>The administrator must decide which node has more important changes (or merge them manually) and let HAST perform full synchronization of the node which has the broken data. To do this, issue these commands on the node which needs to be resynchronized:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># hastctl role init &lt;resource&gt;</span>
<span class=c># hastctl create &lt;resource&gt;</span>
<span class=c># hastctl role secondary &lt;resource&gt;</span></code></pre></div></div></div></div></div></div></div><hr><div class=last-modified><p><strong>Τελευταία τροποποίηση</strong>: 9 Μαρτίου 2024 από <a href="https://cgit.freebsd.org/doc/commit/?id=6199af92e7" target=_blank>Danilo G. Baio</a></p></div><div class=buttons><div class=prev><i class="fa fa-angle-left" aria-hidden=true title=Προηγούμενη></i><div class=container><a href=http://172.16.201.134:1313/el/books/handbook/audit class=direction>Προηγούμενη</a></div></div><div class=home><i class="fa fa-home" aria-hidden=true title=Αρχική></i><div class=container><a href=../ class=direction>Αρχική</a></div></div><div class=next><div class=container><a href=http://172.16.201.134:1313/el/books/handbook/geom class=direction>Επόμενη</a></div><i class="fa fa-angle-right" aria-hidden=true title=Επόμενη></i></div></div><label class="hidden book-menu-overlay" for=menu-control></label></div><aside class=toc><div class=toc-content><h3>Πίνακας περιεχομένων</h3><nav id=TableOfContents><ul><li><a href=#disks-synopsis>19.1. Σύνοψη</a></li><li><a href=#disks-naming>19.2. Device Names</a></li><li><a href=#disks-adding>19.3. Adding Disks</a></li><li><a href=#usb-disks>19.4. USB Storage Devices</a></li><li><a href=#creating-cds>19.5. Creating and Using CD Media</a></li><li><a href=#creating-dvds>19.6. Creating and Using DVD Media</a></li><li><a href=#floppies>19.7. Creating and Using Floppy Disks</a></li><li><a href=#backups-tapebackups>19.8. Creating and Using Data Tapes</a></li><li><a href=#backup-strategies>19.9. Backup Strategies</a></li><li><a href=#backup-basics>19.10. Backup Basics</a></li><li><a href=#disks-virtual>19.11. Network, Memory, and File-Backed File Systems</a></li><li><a href=#snapshots>19.12. File System Snapshots</a></li><li><a href=#quotas>19.13. File System Quotas</a></li><li><a href=#disks-encrypting>19.14. Encrypting Disk Partitions</a></li><li><a href=#swap-encrypting>19.15. Encrypting Swap Space</a></li><li><a href=#disks-hast>19.16. Highly Available Storage (HAST)</a></li></ul></nav><hr><div class=resources><h3>Πηγές</h3><ul class=contents><li><i class="fa fa-file-pdf-o" aria-hidden=true title="Λήψη PDF"></i><a href=https://download.freebsd.org/doc/el/books/handbook/handbook_el.pdf>Λήψη PDF</a></li><li><i class="fa fa-pencil-square-o" aria-hidden=true title="Τροποποίηση αυτής της σελίδας"></i><a href=https://github.com/freebsd/freebsd-doc/blob/main/documentation/content/el/_index target=_blank>Τροποποίηση αυτής της σελίδας</a></li></ul></div></div></aside><a class=to-top href=#top><i class="fa fa-arrow-circle-up" aria-hidden=true></i></a></main><footer><div class=footer-container><section class=logo-column><img src=http://172.16.201.134:1313/images/FreeBSD-colors.svg width=160 height=50 alt="FreeBSD logo"><div class=options-container><div class=language-container><a id=languages href=http://172.16.201.134:1313/el/languages><img src=http://172.16.201.134:1313/images/language.png class=language-image alt="Επιλογή γλώσσας">
<span>Greek</span></a></div><div class=theme-container><select id=theme-chooser><option value=theme-system>Σύστημα</option><option value=theme-light>Light</option><option value=theme-dark>Dark</option><option value=theme-high-contrast>Υψηλή αντίθεση</option></select></div></div></section><section class=about-column><h3 class=column-title>About</h3><ul class=column-elements-container><li><a href=https://www.freebsd.org/about/ target=_blank class=column-element>FreeBSD</a></li><li><a href=https://freebsdfoundation.org/ target=_blank class=column-element>FreeBSD Foundation</a></li><li><a href=https://www.freebsd.org/where/ target=_blank class=column-element>Get FreeBSD</a></li><li><a href=https://www.freebsd.org/internal/code-of-conduct target=_blank class=column-element>Code of Conduct</a></li><li><a href=https://www.freebsd.org/security/ target=_blank class=column-element>Security Advisories</a></li></ul></section><section class=documentation-column><h3 class=column-title>Documentation</h3><ul class=column-elements-container><li><a href=/el class=column-element>Documentation portal</a></li><li><a href=https://man.FreeBSD.org target=_blank class=column-element>Manual pages</a></li><li><a href=https://papers.FreeBSD.org target=_blank class=column-element>Presentations and papers</a></li><li><a href=https://docs-archive.freebsd.org/doc/ target=_blank class=column-element>Previous versions</a></li><li><a href=https://docs-archive.freebsd.org/44doc/ target=_blank class=column-element>4.4BSD Documents</a></li><li><a href=https://wiki.freebsd.org/ target=_blank class=column-element>Wiki</a></li></ul></section><section class=community-column><h3 class=column-title>Community</h3><ul class=column-elements-container><li><a href=http://172.16.201.134:1313/el/articles/contributing class=column-element>Get involved</a></li><li><a href=https://forums.freebsd.org/ target=_blank class=column-element>Community forum</a></li><li><a href=https://lists.freebsd.org/ target=_blank class=column-element>Mailing lists</a></li><li><a href=https://wiki.freebsd.org/IRC/Channels target=_blank class=column-element>IRC Channels</a></li><li><a href=https://bugs.freebsd.org/bugzilla/ target=_blank class=column-element>Bug Tracker</a></li></ul></section><section class=legal-column><h3 class=column-title>Legal</h3><ul class=column-elements-container><li><a href=https://freebsdfoundation.org/donate/ target=_blank class=column-element>Donations</a></li><li><a href=https://www.freebsd.org/copyright/freebsd-license/ target=_blank class=column-element>Licensing</a></li><li><a href=https://www.freebsd.org/privacy/ target=_blank class=column-element>Privacy Policy</a></li><li><a href=https://www.freebsd.org/copyright/ target=_blank class=column-element>Legal notices</a></li></ul></section><section class=copyright-column><p>&copy; 1994-2024 The FreeBSD Project. All rights reserved</p><span>Made with <span class=heart>♥</span> by the FreeBSD Community</span></section></div></footer></body></html>