<!doctype html><html class=theme-light lang=de><head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content><meta name=keywords content><meta name=copyright content="1995-2024 The FreeBSD Foundation"><link rel=canonical href=http://172.16.201.134:1313/de/articles/solid-state/><title>FreeBSD und Solid State-Geräte | FreeBSD Documentation Portal</title>
<meta name=theme-color content="#790000"><meta name=color-scheme content="system light dark high-contrast"><link rel="shortcut icon" href=http://172.16.201.134:1313/favicon.ico><link rel=stylesheet href=http://172.16.201.134:1313/styles/main.min.css><link rel=stylesheet href=http://172.16.201.134:1313/css/font-awesome-min.css><script defer src=/js/theme-chooser.min.js></script><script defer src=/js/copy-clipboard.min.js></script><script defer src=/js/search.min.js></script><meta name=twitter:card content="summary"><meta name=twitter:domain content="docs.FreeBSD.org"><meta name=twitter:site content="@freebsd"><meta name=twitter:url content="https://twitter.com/freebsd"><meta property="og:title" content="FreeBSD und Solid State-Geräte"><meta property="og:description" content><meta property="og:type" content="website"><meta property="og:image" content="http://172.16.201.134:1313/favicon.ico"><meta property="og:image:alt" content="FreeBSD Logo"><meta property="og:locale" content="de"><meta property="og:url" content="http://172.16.201.134:1313/de/articles/solid-state/"><meta property="og:site_name" content="FreeBSD Documentation Portal"><script type=application/ld+json>{"@context":"http://schema.org","@type":"Article","url":"http:\/\/172.16.201.134:1313\/de\/articles\/solid-state\/","name":"FreeBSD Documentation Portal","headline":"FreeBSD Documentation Portal","description":"FreeBSD Documentation Portal"}</script></head><body><header><div class=header-container><div class=logo-menu-bars-container><a href=https://www.FreeBSD.org class=logo><img src=http://172.16.201.134:1313/images/FreeBSD-monochromatic.svg width=160 height=50 alt="FreeBSD logo">
</a><label class=menu-bars for=menu-bars><i class="fa fa-bars" aria-hidden=true></i></label></div><input id=menu-bars type=checkbox><nav><ul class=menu><li class=menu-item><input id=about type=checkbox>
<a href=# aria-label="Navigate to About section"><label class=menu-item-description for=about>About
<i class="fa fa-angle-down fa-lg" aria-hidden=true></i></label></a><ul class=sub-menu><li class=title><a href=https://www.freebsd.org/about/ target=_blank>About</a></li><li><a href=https://www.freebsd.org/about/ target=_blank>FreeBSD</a></li><li><a href=https://freebsdfoundation.org/about-us/about-the-foundation/ target=_blank>FreeBSD Foundation</a></li><li><a href=https://www.freebsd.org/internal/code-of-conduct/ target=_blank>Code of Conduct</a></li></ul></li><li class=menu-item><input id=download type=checkbox>
<a href=# aria-label="Navigate to get FreeBSD section"><label class=menu-item-description for=download>Get FreeBSD
<i class="fa fa-angle-down fa-lg" aria-hidden=true></i></label></a><ul class=sub-menu><li class=title><a href=https://www.freebsd.org/where/ target=_blank>Get FreeBSD</a></li><li><a href=https://www.freebsd.org/releases/ target=_blank>Release Information</a></li><li><a href=https://www.freebsd.org/releng/ target=_blank>Release Engineering</a></li><li><a href=https://www.freebsd.org/security/ target=_blank>Security Advisories</a></li></ul></li><li class=menu-item><input id=documentation type=checkbox>
<a href=# aria-label="Navigate to get Documentation section"><label class=menu-item-description for=documentation>Documentation
<i class="fa fa-angle-down fa-lg" aria-hidden=true></i></label></a><ul class=sub-menu><li class=title><a href=/de>Documentation portal</a></li><li><a href=http://172.16.201.134:1313/de/books/handbook>FreeBSD Handbook</a></li><li><a href=http://172.16.201.134:1313/de/books/porters-handbook>Porter's Handbook</a></li><li><a href=https://docs.FreeBSD.org/en/books/fdp-primer>Documentation Project Handbook</a></li><li><a href=https://man.FreeBSD.org target=_blank>Manual pages</a></li><li><a href=https://papers.FreeBSD.org target=_blank>Presentations and papers</a></li><li><a href=https://wiki.FreeBSD.org target=_blank>Wiki</a></li><li><a href=http://172.16.201.134:1313/de/books>Books</a></li><li><a href=http://172.16.201.134:1313/de/articles>Articles</a></li></ul></li><li class=menu-item><input id=community type=checkbox>
<a href=# aria-label="Navigate to get Community section"><label class=menu-item-description for=community>Community
<i class="fa fa-angle-down fa-lg" aria-hidden=true></i></label></a><ul class=sub-menu><li class=title><a href=https://www.freebsd.org/community/>Community</a></li><li><a href=http://172.16.201.134:1313/de/articles/contributing>Get involved</a></li><li><a href=https://forums.freebsd.org/ target=_blank>Forum</a></li><li><a href=https://lists.freebsd.org/ target=_blank>Mailing lists</a></li><li><a href=https://wiki.freebsd.org/IRC/Channels target=_blank>IRC Channels</a></li><li><a href=https://bugs.freebsd.org/bugzilla/ target=_blank>Bug Tracker</a></li><li><a href=https://www.freebsd.org/support/ target=_blank>Support</a></li></ul></li></ul></nav><div class=search-donate-container><form class=search method=get id=search-header-form action=https://docs.freebsd.org/search name=search-header-form><input type=hidden name=DB value=de>
<input id=words name=P type=text size=20 maxlength=255>
<button>
<i class="fa fa-search" aria-hidden=true></i></button></form><div class=donate><a href=https://freebsdfoundation.org/donate/ target=_blank><span class=heart>♥</span>
Donate</a></div></div></div></header><main class=main-wrapper-article><div class=article><h1 class=title>FreeBSD und Solid State-Geräte</h1><div class="admonitionblock note"><p><i class="fa fa-exclamation-circle" aria-hidden=true></i>
This translation may be out of date. To help with the translations please access the <a href=https://translate-dev.freebsd.org/ target=_blank>FreeBSD translations instance</a>.</p></div><div class=copyright>Copyright © 2001, 2009 The FreeBSD Documentation Project</div><div class=legalnotice><a id=trademarks></a><details><summary>trademarks</summary><p>FreeBSD ist ein eingetragenes Warenzeichen der FreeBSD Foundation.</p><p>Viele Produktbezeichnungen von Herstellern und Verkäufern sind Warenzeichen. Soweit dem FreeBSD Project das Warenzeichen bekannt ist, werden die in diesem Dokument vorkommenden Bezeichnungen mit dem Symbol “™” oder dem Symbol “®” gekennzeichnet.</p></details></div><div class=toc-mobile><h3>Table of Contents</h3><nav id=TableOfContents><ul><li><a href=#intro>1. Solid State Festplattengeräte</a></li><li><a href=#kernel>2. Kerneloptionen</a></li><li><a href=#ro-fs>3. Die <code>rc</code>-Subsysteme und nur-Lese Dateisysteme</a></li><li><a href=#_ein_dateisystem_von_grund_auf_neu_erstellen>4. Ein Dateisystem von Grund auf neu erstellen</a></li><li><a href=#strategies>5. Systemstrategien für kleine und Nur-Lese-Umgebungen</a></li></ul></nav></div><div id=preamble><div class=sectionbody><div class="paragraph abstract-title"><p>Zusammenfassung</p></div><div class=paragraph><p>Dieser Artikel behandelt die Verwendung von Solid State Festplatten in FreeBSD, um eingebettete Systeme zu erstellen.</p></div><div class=paragraph><p>Eingebettete Systeme haben den Vorteil, dass sie eine höhere Stabilität aufgrund des fehlens von beweglichen Bauteilen (Festplatten) besitzen. Es muss jedoch beachtet werden, dass generell weniger Speicherplatz zur Verfügung steht und die Lebensdauer des Speichermediums geringer ist.</p></div><div class=paragraph><p>Spezielle Themen die behandelt werden beinhalten die Typen und Attribute von Solid State Datenträgern, die in FreeBSD verwendet werden, Kernel-Optionen die in solch einer Umgebung von Interesse sind, der <span class=filename>rc.initdiskless</span>-Mechanismus, welcher die Initalisierung solcher Systeme automatisiert, sowie die Notwendigkeit von Nur-Lese-Dateisystemen und das Erstellen von Dateisystemen von Grund auf. Der Artikel schliesst mit ein paar generellen Strategien für kleine und Nur-Lese-FreeBSD Umgebungen.</p></div><div class=paragraph><p><em>Übersetzt von Benedict Reuschling</em>.</p></div><hr></div></div><div class=sect1><h2 id=intro>1. Solid State Festplattengeräte<a class=anchor href=#intro></a></h2><div class=sectionbody><div class=paragraph><p>Der Umfang des Artikels ist auf Solid State Geräte beschränkt, die auf Flash-Speicher basieren. Flash-Speicher ist ein Solid State Speicher (keine beweglichen Teile), der nicht flüchtig ist (der Speicher behält die Daten sogar nachdem alle Energiequellen ausgeschaltet wurden). Flash-Speicher kann grossen physischen Schock aushalten und ist vergleichsweise schnell (die Flash-Speicher Lösungen, die in diesem Artikel behandelt werden, sind nur wenig langsamer als eine EIDE-Festplatte in der Schreibgeschwindigkeit und viel schneller bei Lese-Operationen). Ein sehr wichtiger Aspekt von Flash-Speichern, dessen Auswirkungen später in diesem Artikel diskutiert werden, ist, dass jeder Sektor eine begrenzte Kapazität zur Wiederbeschreibung besitzt. Man kann nur eine bestimmte Anzahl von Schreib-, Lösch- und Wiederbeschreibungsvorgängen durchführen, bevor der Sektor permanent unbrauchbar wird. Obwohl viele Flash-Speicher Produkte automatisch schlechte Blöcke markieren und manche Geräte Schreiboperationen gleichmässig verteilen, bleibt weiterhin die Anzahl der durchführbaren Schreibvorgänge begrenzt. Verschiedene Geräteeinheiten besitzen zwischen 1,000,000 und 10,000,000 Schreibzyklen pro Sektor in ihren Spezifikationen. Diese Zahlen variieren aufgrund der Umgebungstemperatur.</p></div><div class=paragraph><p>Im Speziellen werden wir ATA-kompatible Compact-Flash-Karten betrachten, welche als Speichermedien für Digitalkameras ziemlich populär sind. Von besonderem Interesse ist der Umstand, dass diese direkt an den IDE-Bus angeschlossen werden und kompatibel zu den ATA-Befehlen sind. Aus diesem Grund können diese Geräte mit einem einfachen und billigen Adapter direkt an den IDE-Bus eines Computers angeschlossen werden. Auf diese Weise sehen Betriebssysteme wie FreeBSD diese Geräte dann als normale (wenn auch sehr kleine) Festplatten an.</p></div><div class=paragraph><p>Andere Solid State Plattenlösungen existieren, jedoch platzieren deren Kosten, Obskurität und ihre Unhandlichkeit sie aussserhalb des Umfangs dieses Artikels.</p></div></div></div><div class=sect1><h2 id=kernel>2. Kerneloptionen<a class=anchor href=#kernel></a></h2><div class=sectionbody><div class=paragraph><p>Ein paar Kerneloptionen sind von besonderem Interesse für diejenigen, welche diese eingebetteten FreeBSD-Systeme erstellen möchten.</p></div><div class=paragraph><p>Alle eingebetteten FreeBSD-Systeme, die Flash-Speicher als Systemplatte verwenden, sind interessant für Dateisysteme im Hauptspeicher und RAM-Disks. Wegen der begrenzten Anzahl von Schreibzyklen, die auf Flash-Speicher durchgeführt werden können, werden die Platte und die Dateisysteme darauf mit grosser Wahrscheinlichkeit nur lesend eingehängt werden. In dieser Umgebung werden Dateisysteme wie <span class=filename>/tmp</span> und <span class=filename>/var</span> als RAM-Disks eingebunden, um dem System zu erlauben, Logdateien anzulegen und Zähler sowie temporäre Dateien zu aktualisieren. RAM-Disks sind eine kritische Komponente für eine erfolgreiche Solid State Umsetzung in FreeBSD.</p></div><div class=paragraph><p>Sie sollten dafür sorgen, dass die folgenden Zeilen in Ihrer Kernelkonfigurationsdatei vorhanden sind:</p></div><div class="literalblock programlisting"><div class=content><pre>options         MFS             # Memory Filesystem
options         MD_ROOT         # md device usable as a potential root device
pseudo-device   md              # memory disk</pre></div></div></div></div><div class=sect1><h2 id=ro-fs>3. Die <code>rc</code>-Subsysteme und nur-Lese Dateisysteme<a class=anchor href=#ro-fs></a></h2><div class=sectionbody><div class=paragraph><p>Die Initialisierung nach dem Bootvorgang eines eingebetteten FreeBSD-Systems wird von <span class=filename>/etc/rc.initdiskless</span> kontrolliert.</p></div><div class=paragraph><p><span class=filename>/etc/rc.d/var</span> hängt <span class=filename>/var</span> als RAM-Disk ein, erstellt eine konfigurierbare Liste von Verzeichnissen in <span class=filename>/var</span> mittels des <a href="https://man.freebsd.org/cgi/man.cgi?query=mkdir&amp;sektion=1&amp;format=html">mkdir(1)</a>-Kommandos und ändert die Attribute von ein paar dieser Verzeichnisse. Bei der Ausführung von <span class=filename>/etc/rc.d/var</span> kommt eine andere <span class=filename>rc.conf</span>-Variable ins Spiel: <code>varsize</code>. Die Datei <span class=filename>/etc/rc.d/var</span> erstellt eine <span class=filename>/var</span>-Partition basierend auf dem Wert dieser Variable in <span class=filename>rc.conf</span>:</p></div><div class="literalblock programlisting"><div class=content><pre>varsize=8192</pre></div></div><div class=paragraph><p>Standardmässig wird dieser Wert in Sektoren angegeben.</p></div><div class=paragraph><p>Der Fakt, dass es sich bei <span class=filename>/var</span> um ein nur-Lese Dateisystem handelt, ist eine wichtige Unterscheidung, da die <span class=filename>/</span>-Partition (und jede andere Partition, die Sie auf Ihrem Flash-Medium haben) nur lesend eingehängt wird. Erinnern Sie sich, dass in <a href=#intro>Solid State Festplattengeräte</a> die Beschränkungen von Flash-Speichern erläutert wurden, speziell deren begrenzte Kapazität zum Schreiben. Die Notwendigkeit, Dateisysteme auf Flash-Speichern nur lesend einzubinden und keine Swap-Dateien zu verwenden, kann nicht oft genug erwähnt werden. Eine Swap-Datei auf einem ausgelasteten System kann in weniger als einem Jahr den gesamten Flash-Speicher aufbrauchen. Häufige Protokollierung oder das Erstellen und Löschen von temporären Dateien kann das gleiche verursachen. Aus diesem Grund sollten Sie zusätzlich zum entfernen des <code>swap</code>-Eintrags aus ihrer <span class=filename>/etc/fstab</span>-Datei auch noch die Optionsfelder für jedes Dateisystem auf <code>ro</code> wie folgt stellen:</p></div><div class="literalblock programlisting"><div class=content><pre># Device                Mountpoint      FStype  Options         Dump    Pass#
/dev/ad0s1a             /               ufs     ro              1       1</pre></div></div><div class=paragraph><p>Ein paar Anwendungen im normalen System werden sofort nach dieser Änderung ausfallen. Beispielsweise wird Cron nicht richtig funktionieren, aufgrund von fehlenden Cron-Tabellen in <span class=filename>/var</span> die von <span class=filename>/etc/rc.d/var</span> erstellt wurden. Syslog und DHCP werden ebenfalls Probleme durch das nur-Lese Dateisystem und fehlende Elemente im Verzeichnis <span class=filename>/var</span> verursachen, die <span class=filename>/etc/rc.d/var</span> erstellt hat. Diese Probleme sind jedoch nur vorübergehend und werden zusammen mit Lösungen zur Ausführung von anderen gebräuchlichen Softwarepaketen in <a href=#strategies>Systemstrategien für kleine und Nur-Lese-Umgebungen</a> angesprochen.</p></div><div class=paragraph><p>Eine wichtige Sache, an die man sich erinnern sollte, ist, dass ein Dateisystem, welches als nur lesend in <span class=filename>/etc/fstab</span> eingebunden wurde, jederzeit als schreibend durch das folgende Kommando eingehängt werden kann:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># /sbin/mount -uw partition</span></code></pre></div></div><div class=paragraph><p>und auch wieder zurück auf nur lesend durch den Befehl:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># /sbin/mount -ur partition</span></code></pre></div></div></div></div><div class=sect1><h2 id=_ein_dateisystem_von_grund_auf_neu_erstellen>4. Ein Dateisystem von Grund auf neu erstellen<a class=anchor href=#_ein_dateisystem_von_grund_auf_neu_erstellen></a></h2><div class=sectionbody><div class=paragraph><p>Wenn ATA-kompatible Compact-Flash-Karten von FreeBSD als normale IDE-Festplatten erkannt werden, könnten Sie theoretisch FreeBSD aus dem Netzwerk mittels der Kern- und mfsroot-Floppies oder einer CD installieren.</p></div><div class=paragraph><p>Jedoch kann selbst eine kleine Installation von FreeBSD durch die normale Installationsprozedur ein System erzeugen, dass grösser als 200 MB ist. Da die meisten Leute kleinere Flash-Speichermedien einsetzen (128 MB wird hier als gross angesehen - 32 oder sogar 16 MB sind gebräuchlich) ist eine gewöhnliche Installation mit normalen Methoden nicht möglich, da es einfach nicht genug freien Plattenplatz gibt, selbst für die kleinste Installationsart.</p></div><div class=paragraph><p>Der einfachste Weg, diese Speicherlimitierung zu umgehen, ist, FreeBSD auf konventionelle Weise auf eine normale Festplatte zu installieren. Nachdem die Installation abgeschlossen wurde, kürzen Sie das Betriebssystem auf das nötigste, bis Sie eine Grösse erreicht hat, die auf das Flash-Medium passt und benutzen Sie dann tar auf dem gesamten Dateisystem. Die folgenden Schritte werden Sie durch den Prozess der Vorbereitung eines Flash-Mediums für ihr getartes Dateisystem führen. Beachten Sie, dass Operationen wie Partitionierung, Benennung, Erstellung von Dateisystemen, etc. von Hand durchgeführt werden müssen, da eine normale Installation nicht möglich ist. Zusätzlich zu den Kern- und mfsroot-Disketten benötigen Sie auch die fixit-Floppy.</p></div><div class="exampleblock procedure"><div class=content><div class="olist arabic"><ol class=arabic><li><p>Partitionierung Ihrer Flash-Medien</p><div class=paragraph><p>Wählen Sie nach dem Starten der Kern- und mfsroot-Disketten, <code>custom</code> aus dem Installationsmenü. In diesem Menü wählen Sie dann <code>partition</code> aus. Dort sollten Sie alle bestehenden Partitionen mit Hilfe der Taste <kbd>d</kbd> löschen. Nachdem alle bestehenden Partitionen gelöscht wurden, erstellen Sie mittels der Taste <kbd>c</kbd> eine Partition und akzeptieren Sie den Standardwert für die Grösse der Partition. Wenn Sie nach dem Typ der Partition gefragt werden, stellen Sie sicher, dass der Wert auf <code>165</code> eingestellt ist. Schreiben Sie jetzt diese Partitionstabelle auf die Platte durch betätigen der Taste <kbd>w</kbd> (dies ist die versteckte Option auf diesem Bildschirm). Wenn Sie eine ATA-kompatible Compact Flash-Karte verwenden, sollten Sie den FreeBSD Bootmanager auswählen. Drücken Sie nun die Taste <kbd>q</kbd>, um das Partitionsmenü zu verlassen. Sie werden das Menü des Bootmanagers noch ein weiteres Mal gezeigt bekommt. In diesem Fall wiederholen Sie die Auswahl von vorher.</p></div></li><li><p>Anlegen von Dateisystemen auf Ihrem Flashspeicher-Gerät</p><div class=paragraph><p>Verlassen Sie das Installationsmenü und wählen Sie aus dem Hauptinstallationsmenü die Option <code>fixit</code>. In der fixit-Umgebung angelangt, geben Sie den folgenden Befehl ein:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># disklabel -e /dev/ad0c</span></code></pre></div></div><div class=paragraph><p>Zu diesem Zeitpunkt sollten Sie sich im vi-Editor unter der Herrschaft des disklabel-Kommandos befinden. Als nächstes müssen Sie die eine <code>a:</code>-Zeile an das Ende der Datei hinzufügen. Diese <code>a:</code>-Zeile sollte wie folgt aussehen:</p></div><div class="literalblock programlisting"><div class=content><pre>a:      123456  0       4.2BSD  0       0</pre></div></div><div class=paragraph><p>Wobei <em>123456</em> eine Zahl darstellt, die exakt der gleichen Zahl in der bestehenden Zeile mit dem <code>c:</code>-Eintrag entspricht. Sie kopieren quasi die bestehende Zeile <code>c:</code> als eine neue Zeile <code>a:</code> und stellen sicher, dass fstype <code>4.2BSD</code> entspricht. Speichern Sie die Datei und verlassen Sie den Editor.</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># disklabel -B -r /dev/ad0c</span>
<span class=c># newfs /dev/ad0a</span></code></pre></div></div></li><li><p>Schreiben des Dateisystems auf Ihr Flash-Medium</p><div class=paragraph><p>Hängen Sie das neu erstellte Flash-Medium ein:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># mount /dev/ad0a /flash</span></code></pre></div></div><div class=paragraph><p>Verbinden Sie diese Maschine mit dem Netzwerk, um die tar-Datei zu übertragen und extrahieren Sie es auf das Dateisystem des Flash-Mediums. Ein Beispiel dazu wäre folgendes:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># ifconfig xl0 192.168.0.10 netmask 255.255.255.0</span>
<span class=c># route add default 192.168.0.1</span></code></pre></div></div><div class=paragraph><p>Jetzt da die Maschine ans Netzwerk angeschlossen ist, kopieren Sie die tar-Datei. An diesem Punkt werden Sie möglicherweise mit einem Dilemma konfrontiert - sollte Ihr Flash-Speicher beispielsweise 128 MB gross sein und Ihre tar-Datei grösser als 64 MB, können Sie ihre tar-Datei auf dem Flash-Speicher nicht entpacken - Ihnen wird vorher der Speicherplatz ausgehen. Eine Lösung für dieses Problem, sofern Sie FTP verwenden, ist, dass Sie die Datei entpacken können, während es von FTP übertragen wird. Wenn Sie die Übertragung auf diese Weise durchführen, haben Sie niemals die tar-Datei und deren Inhalt zur gleichen Zeit auf Ihrem Medium:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>ftp&gt; get tarfile.tar <span class=s2>&#34;| tar xvf -&#34;</span></code></pre></div></div><div class=paragraph><p>Sollte Ihre tar-Datei gezippt sein, können Sie dies ebenso bewerkstelligen:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>ftp&gt; get tarfile.tar <span class=s2>&#34;| zcat | tar xvf -&#34;</span></code></pre></div></div><div class=paragraph><p>Nachdem der Inhalt Ihrer tar-Datei auf dem Dateisystem des Flash-Mediums abgelegt wurden, können Sie den Flash-Speicher aushängen und neu starten:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># cd /</span>
<span class=c># umount /flash</span>
<span class=c># exit</span></code></pre></div></div><div class=paragraph><p>In der Annahme, dass Sie Ihr Dateisystem richtig konfiguriert haben, als es noch auf der gewöhnlichen Festplatte gebaut wurde (mit Ihren Nur-Lese-Dateisystemen und den nötigen Optionen im Kernel), sollten Sie nun erfolgreich von Ihrem FreeBSD Embedded-System starten können.</p></div></li></ol></div></div></div></div></div><div class=sect1><h2 id=strategies>5. Systemstrategien für kleine und Nur-Lese-Umgebungen<a class=anchor href=#strategies></a></h2><div class=sectionbody><div class=paragraph><p>In <a href=#ro-fs>Die <code>rc</code>-Subsysteme und nur-Lese Dateisysteme</a> wurde darauf hingewiesen, dass das <span class=filename>/var</span>-Dateisystem von <span class=filename>/etc/rc.d/var</span> konstruiert wurde und die Präsenz eines Nur-Lese-Wurzeldateisystems Probleme mit vielen in FreeBSD gebrächlichen Softwarepaketen verursacht. In diesem Artikel werden Vorschläge für das erfolgreiche Betreiben von cron, syslog, Installationen von Ports und dem Apache-Webserver unterbreitet.</p></div><div class=sect2><h3 id=_cron>5.1. cron<a class=anchor href=#_cron></a></h3><div class=paragraph><p>Während des Bootvorgangs wird <span class=filename>/var</span> von <span class=filename>/etc/rc.d/var</span> anhand der Liste aus <span class=filename>/etc/mtree/BSD.var.dist</span> gefüllt, damit <span class=filename>cron</span>, <span class=filename>cron/tabs</span>, <span class=filename>at</span> und ein paar weitere Standardverzeichnisse erstellt werden.</p></div><div class=paragraph><p>Jedoch löst das noch nicht das Problem, Crontabs über Neustarts des Systems hinaus zu erhalten. Wenn das System neu gestartet wird, verschwindet das <span class=filename>/var</span>-Dateiystem, welches sich im Hauptspeicher befunden hat und jegliche Crontabs, die Sie hatten werden ebenfalls verschwinden. Aus diesem Grund besteht eine Lösung darin, Crontabs für diejenigen Benutzer zu erstellen, die diese auch benötigen. Dazu sollte das <span class=filename>/</span>-Dateisystem lesend und schreibend eingehängt und diese Crontabs an einen sicheren Ort kopiert werden, wie beispielsweise <span class=filename>/etc/tabs</span>. Fügen Sie dann eine Zeile an das Ende der Datei <span class=filename>/etc/rc.initdiskless</span> hinzu, die diese Crontabs in <span class=filename>/var/cron/tabs</span> kopiert, nachdem dieses Verzeichnis während der Systeminitialisierung erstellt wurde. Sie werden auch eine Zeile hinzufügen mössen, welche die Besitzer und Berechtigungen auf diesen Verzeichnissen, die Sie erstellen und den dazugehörigen Dateien, die Sie mittels <span class=filename>/etc/rc.initdiskless</span> kopieren, setzen.</p></div></div><div class=sect2><h3 id=_syslog>5.2. syslog<a class=anchor href=#_syslog></a></h3><div class=paragraph><p>Die Datei <span class=filename>syslog.conf</span> spezifiziert den Ort von bestimmten Logdateien, welche in <span class=filename>/var/log</span> existieren. Diese Dateien werden nicht von <span class=filename>/etc/rc.d/var</span> während der Systeminitialisierung erstellt. Aus diesem Grund müssen Sie irgendwo in <span class=filename>/etc/rc.d/var</span> nach dem Abschnitt, der die Verzeichnisse in <span class=filename>/var</span> erstellt, eine Zeile ähnlich der folgenden hinzufügen:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># touch /var/log/security /var/log/maillog /var/log/cron /var/log/messages</span>
<span class=c># chmod 0644 /var/log/*</span></code></pre></div></div></div><div class=sect2><h3 id=_installation_von_ports>5.3. Installation von Ports<a class=anchor href=#_installation_von_ports></a></h3><div class=paragraph><p>Bevor die notwendigen Änderungen erkärt werden, einen Ports-Baum zu verwenden, ist es notwendig, Sie an die Nur-Lese-Besonderheit Ihres Dateisystems auf dem Flash-Medium zu erinnern. Da dieses nur lesend verfügbar ist, müssen Sie es vorübergehend mit Schreibrechten ausstatten, indem Sie die mount-Syntax, wie in <a href=#ro-fs>Die <code>rc</code>-Subsysteme und nur-Lese Dateisysteme</a> dargestellt wird, verwenden. Sie sollten immer diese Dateisysteme erneut mit nur-Lese-Rechten einhängen wenn Sie damit fertig sind - unnötige Schreibvorgänge auf dem Flash-Medium kann dessen Lebenszeit erheblich verkürzen.</p></div><div class=paragraph><p>Um es zu ermöglichen, in das Ports-Verzeichnis zu wechseln und erfolgreich make <code>install</code> auszuführen, müssen wir ein Paketverzeichnis auf einem Nicht-Hauptspeicherdateisystem erstellen, welches die Pakete über Neustarts hinweg im Auge behält. Weil es sowieso nötig ist, Ihre Dateisysteme mit Lese-Schreibrechten für die Installation eines Pakets einzuhängen, ist es sinnvoll anzunehmen, dass ein Bereich Ihres Flash-Mediums ebenfalls für Paketinformationen, die darauf abgespeichert werden, verwendet wird.</p></div><div class=paragraph><p>Erstellen Sie zuerst ein Verzeichnis für die Paketdatenbank. Normalerweise ist dies <span class=filename>/var/db/pkg</span>, jedoch können wir es dort nicht unterbringen, da es jedesmal verschwinden wird, wenn das System neu gestartet wird.</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># mkdir /etc/pkg</span></code></pre></div></div><div class=paragraph><p>Fügen Sie nun eine Zeile in <span class=filename>/etc/rc.d/var</span> hinzu, welche das <span class=filename>/etc/pkg</span>-Verzeichnis mit <span class=filename>/var/db/pkg</span> verknüpft. Ein Beispiel:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># ln -s /etc/pkg /var/db/pkg</span></code></pre></div></div><div class=paragraph><p>Nun wird jedes Mal, wenn Sie Ihre Dateisysteme mit Lese-Schreibrechten einbinden und ein Paket installieren, der Befehl make <code>install</code> funktionieren und Paketinformationen werden erfolgreich nach <span class=filename>/etc/pkg</span> geschrieben (da zu diesem Zeitpunkt das Dateisystem mit Lese-Schreibrechten eingebunden ist), welche dann stets dem Betriebssystem als <span class=filename>/var/db/pkg</span> zur Verfügung stehen.</p></div></div><div class=sect2><h3 id=_apache_webserver>5.4. Apache Webserver<a class=anchor href=#_apache_webserver></a></h3><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Die Anweisungen in diesem Abschnitt sind nur notwendig, wenn Apache so eingerichtet ist, dass dieser seine PID oder Protokollierungsinformationen ausserhalb von <span class=filename>/var</span> ablegt. Standardmässig bewahrt Apache seine PID-Datei in <span class=filename>/var/run/httpd.pid</span> und seine Protokolldateien in <span class=filename>/var/log</span> auf.</p></div></td></tr></tbody></table></div><div class=paragraph><p>Es wird nun davon ausgegangen, dass Apache seine Protokolldateien in einem Verzeichnis namens <span class=filename>apache_log_dir</span> ausserhalb von <span class=filename>/var</span> speichert. Wenn dieses Verzeichnis auf einem nur-Lese-Dateisystem existiert, wird Apache nicht in der Lage sein, Protokolldateien zu speichern und wird vermutlich nicht richtig funktionieren. Wenn dies der Fall ist, muss ein neues Verzeichnis zu der Liste der Verzeichnisse in <span class=filename>/etc/rc.d/var</span> hinzugefügt werden, um dieses in <span class=filename>/var</span> zu erstellen und um <span class=filename>apache_log_dir</span> nach <span class=filename>/var/log/apache</span> zu verknüpfen. Es ist auch nötig, Berechtigungen und Besitzer auf diesem neuen Verzeichnis zu setzen.</p></div><div class=paragraph><p>Fügen Sie zuerst das Verzeichnis <code>log/apache</code> zu der Liste von Verzeichnissen hinzu, die in <span class=filename>/etc/rc.d/var</span> angelegt werden sollen.</p></div><div class=paragraph><p>Danach tragen Sie die folgenden Befehle in <span class=filename>/etc/rc.d/var</span> nach dem Abschnitt zum Erstellen der Verzeichnisse ein:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># chmod 0774 /var/log/apache</span>
<span class=c># chown nobody:nobody /var/log/apache</span></code></pre></div></div><div class=paragraph><p>Schliesslich löschen Sie das bestehende <span class=filename>apache_log_dir</span> Verzeichnis und ersetzen es mit einer Verknüpfung:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># rm -rf apache_log_dir</span>
<span class=c># ln -s /var/log/apache apache_log_dir</span></code></pre></div></div></div></div></div><hr><div class=last-modified><p><strong>Last modified on</strong>: 3. November 2021 by <a href="https://cgit.freebsd.org/doc/commit/?id=64acd169b8" target=_blank>Sergio Carlavilla Delgado</a></p></div></div><aside class=toc><div class=toc-content><h3>Table of Contents</h3><nav id=TableOfContents><ul><li><a href=#intro>1. Solid State Festplattengeräte</a></li><li><a href=#kernel>2. Kerneloptionen</a></li><li><a href=#ro-fs>3. Die <code>rc</code>-Subsysteme und nur-Lese Dateisysteme</a></li><li><a href=#_ein_dateisystem_von_grund_auf_neu_erstellen>4. Ein Dateisystem von Grund auf neu erstellen</a></li><li><a href=#strategies>5. Systemstrategien für kleine und Nur-Lese-Umgebungen</a></li></ul></nav><hr><div class=resources><h3>Resources</h3><ul class=contents><li><i class="fa fa-file-pdf-o" aria-hidden=true title="Download PDF"></i><a href=https://download.freebsd.org/doc/de/articles/solid-state/solid-state_de.pdf>Download PDF</a></li><li><i class="fa fa-pencil-square-o" aria-hidden=true title="Edit this page"></i><a href=https://github.com/freebsd/freebsd-doc/blob/main/documentation/content/de/_index target=_blank>Edit this page</a></li></ul></div></div></aside></main><footer><div class=footer-container><section class=logo-column><img src=http://172.16.201.134:1313/images/FreeBSD-colors.svg width=160 height=50 alt="FreeBSD logo"><div class=options-container><div class=language-container><a id=languages href=http://172.16.201.134:1313/de/languages><img src=http://172.16.201.134:1313/images/language.png class=language-image alt="Choose language">
<span>German</span></a></div><div class=theme-container><select id=theme-chooser><option value=theme-system>System</option><option value=theme-light>Light</option><option value=theme-dark>Dark</option><option value=theme-high-contrast>High contrast</option></select></div></div></section><section class=about-column><h3 class=column-title>About</h3><ul class=column-elements-container><li><a href=https://www.freebsd.org/about/ target=_blank class=column-element>FreeBSD</a></li><li><a href=https://freebsdfoundation.org/ target=_blank class=column-element>FreeBSD Foundation</a></li><li><a href=https://www.freebsd.org/where/ target=_blank class=column-element>Get FreeBSD</a></li><li><a href=https://www.freebsd.org/internal/code-of-conduct target=_blank class=column-element>Code of Conduct</a></li><li><a href=https://www.freebsd.org/security/ target=_blank class=column-element>Security Advisories</a></li></ul></section><section class=documentation-column><h3 class=column-title>Documentation</h3><ul class=column-elements-container><li><a href=/de class=column-element>Documentation portal</a></li><li><a href=https://man.FreeBSD.org target=_blank class=column-element>Manual pages</a></li><li><a href=https://papers.FreeBSD.org target=_blank class=column-element>Presentations and papers</a></li><li><a href=https://docs-archive.freebsd.org/doc/ target=_blank class=column-element>Previous versions</a></li><li><a href=https://docs-archive.freebsd.org/44doc/ target=_blank class=column-element>4.4BSD Documents</a></li><li><a href=https://wiki.freebsd.org/ target=_blank class=column-element>Wiki</a></li></ul></section><section class=community-column><h3 class=column-title>Community</h3><ul class=column-elements-container><li><a href=http://172.16.201.134:1313/de/articles/contributing class=column-element>Get involved</a></li><li><a href=https://forums.freebsd.org/ target=_blank class=column-element>Community forum</a></li><li><a href=https://lists.freebsd.org/ target=_blank class=column-element>Mailing lists</a></li><li><a href=https://wiki.freebsd.org/IRC/Channels target=_blank class=column-element>IRC Channels</a></li><li><a href=https://bugs.freebsd.org/bugzilla/ target=_blank class=column-element>Bug Tracker</a></li></ul></section><section class=legal-column><h3 class=column-title>Legal</h3><ul class=column-elements-container><li><a href=https://freebsdfoundation.org/donate/ target=_blank class=column-element>Donations</a></li><li><a href=https://www.freebsd.org/copyright/freebsd-license/ target=_blank class=column-element>Licensing</a></li><li><a href=https://www.freebsd.org/privacy/ target=_blank class=column-element>Privacy Policy</a></li><li><a href=https://www.freebsd.org/copyright/ target=_blank class=column-element>Legal notices</a></li></ul></section><section class=copyright-column><p>&copy; 1994-2024 The FreeBSD Project. All rights reserved</p><span>Made with <span class=heart>♥</span> by the FreeBSD Community</span></section></div></footer></body></html>