<!doctype html><html class=theme-light lang=en><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="This paper describes the approach previously used by the FreeBSD release engineering team to make production quality releases of the FreeBSD Operating System"><meta name=keywords content="Release,Engineering,Historical,FreeBSD"><meta name=copyright content="1995-2024 The FreeBSD Foundation"><link rel=canonical href=https://docs.freebsd.org/en/articles/releng/><title>Legacy FreeBSD Release Engineering | FreeBSD Documentation Portal</title>
<meta name=theme-color content="#790000"><meta name=color-scheme content="system light dark high-contrast"><link rel="shortcut icon" href=https://docs.freebsd.org/favicon.ico><link rel=stylesheet href=https://docs.freebsd.org/styles/main.min.css><link rel=stylesheet href=https://docs.freebsd.org/css/font-awesome-min.css><script defer src=/js/theme-chooser.min.js></script><script defer src=/js/copy-clipboard.min.js></script><script defer src=/js/search.min.js></script><meta name=twitter:card content="summary"><meta name=twitter:domain content="docs.FreeBSD.org"><meta name=twitter:site content="@freebsd"><meta name=twitter:url content="https://twitter.com/freebsd"><meta property="og:title" content="Legacy FreeBSD Release Engineering"><meta property="og:description" content="This paper describes the approach previously used by the FreeBSD release engineering team to make production quality releases of the FreeBSD Operating System"><meta property="og:type" content="website"><meta property="og:image" content="https://docs.freebsd.org/favicon.ico"><meta property="og:image:alt" content="FreeBSD Logo"><meta property="og:locale" content="en"><meta property="og:url" content="https://docs.freebsd.org/en/articles/releng/"><meta property="og:site_name" content="FreeBSD Documentation Portal"><script type=application/ld+json>{"@context":"http://schema.org","@type":"Article","url":"https:\/\/docs.freebsd.org\/en\/articles\/releng\/","name":"FreeBSD Documentation Portal","headline":"FreeBSD Documentation Portal","description":"FreeBSD Documentation Portal"}</script></head><body><header><div class=header-container><div class=logo-menu-bars-container><a href=https://www.FreeBSD.org class=logo><img src=https://docs.freebsd.org/images/FreeBSD-monochromatic.svg width=160 height=50 alt="FreeBSD logo">
</a><label class=menu-bars for=menu-bars><i class="fa fa-bars" aria-hidden=true></i></label></div><input id=menu-bars type=checkbox><nav><ul class=menu><li class=menu-item><input id=about type=checkbox>
<a href=# aria-label="Navigate to About section"><label class=menu-item-description for=about>About
<i class="fa fa-angle-down fa-lg" aria-hidden=true></i></label></a><ul class=sub-menu><li class=title><a href=https://www.freebsd.org/about/ target=_blank>About</a></li><li><a href=https://www.freebsd.org/about/ target=_blank>FreeBSD</a></li><li><a href=https://freebsdfoundation.org/about-us/about-the-foundation/ target=_blank>FreeBSD Foundation</a></li><li><a href=https://www.freebsd.org/internal/code-of-conduct/ target=_blank>Code of Conduct</a></li></ul></li><li class=menu-item><input id=download type=checkbox>
<a href=# aria-label="Navigate to get FreeBSD section"><label class=menu-item-description for=download>Get FreeBSD
<i class="fa fa-angle-down fa-lg" aria-hidden=true></i></label></a><ul class=sub-menu><li class=title><a href=https://www.freebsd.org/where/ target=_blank>Get FreeBSD</a></li><li><a href=https://www.freebsd.org/releases/ target=_blank>Release Information</a></li><li><a href=https://www.freebsd.org/releng/ target=_blank>Release Engineering</a></li><li><a href=https://www.freebsd.org/security/ target=_blank>Security Advisories</a></li></ul></li><li class=menu-item><input id=documentation type=checkbox>
<a href=# aria-label="Navigate to get Documentation section"><label class=menu-item-description for=documentation>Documentation
<i class="fa fa-angle-down fa-lg" aria-hidden=true></i></label></a><ul class=sub-menu><li class=title><a href=/en>Documentation portal</a></li><li><a href=https://docs.freebsd.org/en/books/handbook>FreeBSD Handbook</a></li><li><a href=https://docs.freebsd.org/en/books/porters-handbook>Porter's Handbook</a></li><li><a href=https://docs.FreeBSD.org/en/books/fdp-primer>Documentation Project Handbook</a></li><li><a href=https://man.FreeBSD.org target=_blank>Manual pages</a></li><li><a href=https://papers.FreeBSD.org target=_blank>Presentations and papers</a></li><li><a href=https://wiki.FreeBSD.org target=_blank>Wiki</a></li><li><a href=https://docs.freebsd.org/en/books>Books</a></li><li><a href=https://docs.freebsd.org/en/articles>Articles</a></li></ul></li><li class=menu-item><input id=community type=checkbox>
<a href=# aria-label="Navigate to get Community section"><label class=menu-item-description for=community>Community
<i class="fa fa-angle-down fa-lg" aria-hidden=true></i></label></a><ul class=sub-menu><li class=title><a href=https://www.freebsd.org/community/>Community</a></li><li><a href=https://docs.freebsd.org/en/articles/contributing>Get involved</a></li><li><a href=https://forums.freebsd.org/ target=_blank>Forum</a></li><li><a href=https://lists.freebsd.org/ target=_blank>Mailing lists</a></li><li><a href=https://wiki.freebsd.org/IRC/Channels target=_blank>IRC Channels</a></li><li><a href=https://bugs.freebsd.org/bugzilla/ target=_blank>Bug Tracker</a></li><li><a href=https://www.freebsd.org/support/ target=_blank>Support</a></li></ul></li></ul></nav><div class=search-donate-container><form class=search method=get id=search-header-form action=https://docs.freebsd.org/search name=search-header-form><input type=hidden name=DB value=en>
<input id=words name=P type=text size=20 maxlength=255>
<button>
<i class="fa fa-search" aria-hidden=true></i></button></form><div class=donate><a href=https://freebsdfoundation.org/donate/ target=_blank><span class=heart>♥</span>
Donate</a></div></div></div></header><main class=main-wrapper-article><div class=article><h1 class=title>Legacy FreeBSD Release Engineering</h1><div class=legalnotice><a id=trademarks></a><details><summary>trademarks</summary><p>FreeBSD is a registered trademark of the FreeBSD Foundation.</p><p>Intel, Celeron, Centrino, Core, EtherExpress, i386, i486, Itanium, Pentium, and Xeon are trademarks or registered trademarks of Intel Corporation or its subsidiaries in the United States and other countries.</p><p>Many of the designations used by manufacturers and sellers to distinguish their products are claimed as trademarks. Where those designations appear in this document, and the FreeBSD Project was aware of the trademark claim, the designations have been followed by the “™” or the “®” symbol.</p></details></div><div class=toc-mobile><h3>Table of Contents</h3><nav id=TableOfContents><ul><li><a href=#introduction>1. Introduction</a></li><li><a href=#release-proc>2. Release Process</a></li><li><a href=#release-build>3. Release Building</a></li><li><a href=#distribution>4. Distribution</a></li><li><a href=#extensibility>5. Extensibility</a></li><li><a href=#lessons-learned>6. Lessons Learned from FreeBSD 4.4</a></li><li><a href=#future>7. Future Directions</a></li><li><a href=#ackno>8. Acknowledgements</a></li></ul></nav></div><div id=preamble><div class=sectionbody><div class="paragraph abstract-title"><p>Abstract</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>This document is outdated and does not accurately describe the current release procedures of the FreeBSD Release Engineering team.
It is retained for historical purposes.
The current procedures used by the FreeBSD Release Engineering team are available in the <a href=https://docs.freebsd.org/en/articles/freebsd-releng/>FreeBSD Release Engineering</a> article.</p></div></td></tr></tbody></table></div><div class=paragraph><p>This paper describes the approach used by the FreeBSD release engineering team to make production quality releases of the FreeBSD Operating System.
It details the methodology used for the official FreeBSD releases and describes the tools available for those interested in producing customized FreeBSD releases for corporate rollouts or commercial productization.</p></div><hr></div></div><div class=sect1><h2 id=introduction>1. Introduction<a class=anchor href=#introduction></a></h2><div class=sectionbody><div class=paragraph><p>The development of FreeBSD is a very open process.
FreeBSD is comprised of contributions from thousands of people around the world.
The FreeBSD Project provides Subversion <sup class=footnote>[<a id=_footnoteref_1 class=footnote href=#_footnotedef_1 title="View footnote.">1</a>]</sup> access to the general public so that others can have access to log messages, diffs (patches) between development branches, and other productivity enhancements that formal source code management provides.
This has been a huge help in attracting more talented developers to FreeBSD.
However, I think everyone would agree that chaos would soon manifest if write access to the main repository was opened up to everyone on the Internet.
Therefore only a "select" group of nearly 300 people are given write access to the Subversion repository.
These <a href=https://docs.freebsd.org/en/articles/contributors/#staff-committers>FreeBSD committers</a><sup class=footnote>[<a id=_footnoteref_2 class=footnote href=#_footnotedef_2 title="View footnote.">2</a>]</sup> are usually the people who do the bulk of FreeBSD development.
An elected <a href=https://www.FreeBSD.org/administration/#t-core>Core Team</a><sup class=footnote>[<a id=_footnoteref_3 class=footnote href=#_footnotedef_3 title="View footnote.">3</a>]</sup> of developers provide some level of direction over the project.</p></div><div class=paragraph><p>The rapid pace of <code>FreeBSD</code> development makes the main development branch unsuitable for the everyday use by the general public.
In particular, stabilizing efforts are required for polishing the development system into a production quality release.
To solve this conflict, development continues on several parallel tracks.
The main development branch is the <em>HEAD</em> or <em>trunk</em> of our Subversion tree, known as "FreeBSD-CURRENT" or "-CURRENT" for short.</p></div><div class=paragraph><p>A set of more stable branches are maintained, known as "FreeBSD-STABLE" or "-STABLE" for short.
All branches live in a master Subversion repository maintained by the FreeBSD Project.
FreeBSD-CURRENT is the "bleeding-edge" of FreeBSD development where all new changes first enter the system.
FreeBSD-STABLE is the development branch from which major releases are made.
Changes go into this branch at a different pace, and with the general assumption that they have first gone into FreeBSD-CURRENT and have been thoroughly tested by our user community.</p></div><div class=paragraph><p>The term <em>stable</em> in the name of the branch refers to the presumed Application Binary Interface stability, which is promised by the project.
This means that a user application compiled on an older version of the system from the same branch works on a newer system from the same branch.
The ABI stability has improved greatly from the compared to previous releases.
In most cases, binaries from the older <em>STABLE</em> systems run unmodified on newer systems, including <em>HEAD</em>, assuming that the system management interfaces are not used.</p></div><div class=paragraph><p>In the interim period between releases, weekly snapshots are built automatically by the FreeBSD Project build machines and made available for download from <code>https:/download.FreeBSD.org/snapshots/</code>.
The widespread availability of binary release snapshots, and the tendency of our user community to keep up with -STABLE development with Subversion and “make buildworld” <sup class=footnote>[<a id=_footnoteref_4 class=footnote href=#_footnotedef_4 title="View footnote.">4</a>]</sup> helps to keep FreeBSD-STABLE in a very reliable condition even before the quality assurance activities ramp up pending a major release.</p></div><div class=paragraph><p>In addition to installation ISO snapshots, weekly virtual machine images are also provided for use with VirtualBox, qemu, or other popular emulation software.
The virtual machine images can be downloaded from <code><a href=https://download.FreeBSD.org/snapshots/VM-IMAGES/ class=bare>https://download.FreeBSD.org/snapshots/VM-IMAGES/</a></code>.</p></div><div class=paragraph><p>The virtual machine images are approximately 150MB <a href="https://man.freebsd.org/cgi/man.cgi?query=xz&amp;sektion=1&amp;format=html">xz(1)</a> compressed, and contain a 10GB sparse filesystem when attached to a virtual machine.</p></div><div class=paragraph><p>Bug reports and feature requests are continuously submitted by users throughout the release cycle.
Problems reports are entered into our Bugzilla database through the web interface provided at <a href=https://www.freebsd.org/support/bugreports/>https://www.freebsd.org/support/bugreports/</a>.</p></div><div class=paragraph><p>To service our most conservative users, individual release branches were introduced with FreeBSD 4.3.
These release branches are created shortly before a final release is made.
After the release goes out, only the most critical security fixes and additions are merged onto the release branch.
In addition to source updates via Subversion, binary patchkits are available to keep systems on the <em>releng/X.Y</em> branches updated.</p></div><div class=sect2><h3 id=_what_this_article_describes>1.1. What This Article Describes<a class=anchor href=#_what_this_article_describes></a></h3><div class=paragraph><p>The following sections of this article describe:</p></div><div class=dlist><dl><dt class=hdlist1><a href=../releng/#release-proc>Release Process</a></dt><dd><p>The different phases of the release engineering process leading up to the actual system build.</p></dd><dt class=hdlist1><a href=../releng/#release-build>Release Building</a></dt><dd><p>The actual build process.</p></dd><dt class=hdlist1><a href=../releng/#extensibility>Extensibility</a></dt><dd><p>How the base release may be extended by third parties.</p></dd><dt class=hdlist1><a href=../releng/#lessons-learned>Lessons Learned from FreeBSD 4.4</a></dt><dd><p>Some of the lessons learned through the release of FreeBSD 4.4.</p></dd><dt class=hdlist1><a href=../releng/#future>Future Directions</a></dt><dd><p>Future directions of development.</p></dd></dl></div></div></div></div><div class=sect1><h2 id=release-proc>2. Release Process<a class=anchor href=#release-proc></a></h2><div class=sectionbody><div class=paragraph><p>New releases of FreeBSD are released from the -STABLE branch at approximately four month intervals.
The FreeBSD release process begins to ramp up 70-80 days before the anticipated release date when the release engineer sends an email to the development mailing lists to remind developers that they only have 15 days to integrate new changes before the code freeze.
During this time, many developers perform what have become known as "MFC sweeps".</p></div><div class=paragraph><p>MFC stands for "Merge From CURRENT" and it describes the process of merging a tested change from our -CURRENT development branch to our -STABLE branch.
Project policy requires any change to be first applied to trunk, and merged to the -STABLE branches after sufficient external testing was done by -CURRENT users (developers are expected to extensively test the change before committing to -CURRENT, but it is impossible for a person to exercise all usages of the general-purpose operating system).
Minimal MFC period is 3 days, which is typically used only for trivial or critical bugfixes.</p></div><div class=sect2><h3 id=_code_review>2.1. Code Review<a class=anchor href=#_code_review></a></h3><div class=paragraph><p>Sixty days before the anticipated release, the source repository enters a "code freeze".
During this time, all commits to the -STABLE branch must be approved by <code>Release Engineering Team &lt;<a href=mailto:re@FreeBSD.org>re@FreeBSD.org</a>></code>.
The approval process is technically enforced by a pre-commit hook.
The kinds of changes that are allowed during this period include:</p></div><div class=ulist><ul><li><p>Bug fixes.</p></li><li><p>Documentation updates.</p></li><li><p>Security-related fixes of any kind.</p></li><li><p>Minor changes to device drivers, such as adding new Device IDs.</p></li><li><p>Driver updates from the vendors.</p></li><li><p>Any additional change that the release engineering team feels is justified, given the potential risk.</p></li></ul></div><div class=paragraph><p>Shortly after the code freeze is started, a <em>BETA1</em> image is built and released for widespread testing.
During the code freeze, at least one beta image or release candidate is released every two weeks until the final release is ready.
During the days preceding the final release, the release engineering team is in constant communication with the security-officer team, the documentation maintainers, and the port maintainers to ensure that all of the different components required for a successful release are available.</p></div><div class=paragraph><p>After the quality of the BETA images is satisfying enough, and no large and potentially risky changes are planned, the release branch is created and <em>Release Candidate</em> (RC) images are built from the release branch, instead of the BETA images from the STABLE branch.
Also, the freeze on the STABLE branch is lifted and release branch enters a "hard code freeze" where it becomes much harder to justify new changes to the system unless a serious bug-fix or security issue is involved.</p></div></div><div class=sect2><h3 id=_final_release_checklist>2.2. Final Release Checklist<a class=anchor href=#_final_release_checklist></a></h3><div class=paragraph><p>When several BETA images have been made available for widespread testing and all major issues have been resolved, the final release "polishing" can begin.</p></div><div class=sect3><h4 id=rel-branch>2.2.1. Creating the Release Branch<a class=anchor href=#rel-branch></a></h4><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>In all examples below, <code>$FSVN</code> refers to the location of the FreeBSD Subversion repository, <code>svn+ssh://svn.FreeBSD.org/base/</code>.</p></div></td></tr></tbody></table></div><div class=paragraph><p>The layout of FreeBSD branches in Subversion is described in the <a href=https://docs.freebsd.org/en/articles/committers-guide/#subversion-primer-base-layout>Committer’s Guide</a>.
The first step in creating a branch is to identify the revision of the <code>stable/<em>X</em></code> sources that you want to branch <em>from</em>.</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># svn log -v $FSVN/stable/9</span></code></pre></div></div><div class=paragraph><p>The next step is to create the <em>release branch</em></p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># svn cp $FSVN/stable/9@REVISION $FSVN/releng/9.2</span></code></pre></div></div><div class=paragraph><p>This branch can be checked out:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># svn co $FSVN/releng/9.2 src</span></code></pre></div></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Creating the <code>releng</code> branch and <code>release</code> tags is done by the <a href=https://www.FreeBSD.org/administration/#t-re>Release Engineering Team</a>.</p></div></td></tr></tbody></table></div><div class=imageblock><div class=content><img src=../../../images/articles/releng/branches-head.png alt="FreeBSD Development Branch"></div></div><div class=imageblock><div class=content><img src=../../../images/articles/releng/branches-releng3.png alt="FreeBSD 3.x STABLE Branch"></div></div><div class=imageblock><div class=content><img src=../../../images/articles/releng/branches-releng4.png alt="FreeBSD 4.x STABLE Branch"></div></div><div class=imageblock><div class=content><img src=../../../images/articles/releng/branches-releng5.png alt="FreeBSD 5.x STABLE Branch"></div></div><div class=imageblock><div class=content><img src=../../../images/articles/releng/branches-releng6.png alt="FreeBSD 6.x STABLE Branch"></div></div><div class=imageblock><div class=content><img src=../../../images/articles/releng/branches-releng7.png alt="FreeBSD 7.x STABLE Branch"></div></div><div class=imageblock><div class=content><img src=../../../images/articles/releng/branches-releng8.png alt="FreeBSD 8.x STABLE Branch"></div></div><div class=imageblock><div class=content><img src=../../../images/articles/releng/branches-releng9.png alt="FreeBSD 9.x STABLE Branch"></div></div></div><div class=sect3><h4 id=versionbump>2.2.2. Bumping up the Version Number<a class=anchor href=#versionbump></a></h4><div class=paragraph><p>Before the final release can be tagged, built, and released, the following files need to be modified to reflect the correct version of FreeBSD:</p></div><div class=ulist><ul><li><p><span class=filename>doc/en_US.ISO8859-1/books/handbook/mirrors/chapter.xml</span></p></li><li><p><span class=filename>doc/en_US.ISO8859-1/books/porters-handbook/book.xml</span></p></li><li><p><span class=filename>doc/en_US.ISO8859-1/htdocs/cgi/ports.cgi</span></p></li><li><p><span class=filename>ports/Tools/scripts/release/config</span></p></li><li><p><span class=filename>doc/shared/xml/freebsd.ent</span></p></li><li><p><span class=filename>src/Makefile.inc1</span></p></li><li><p><span class=filename>src/UPDATING</span></p></li><li><p><span class=filename>src/gnu/usr.bin/groff/tmac/mdoc.local</span></p></li><li><p><span class=filename>src/release/Makefile</span></p></li><li><p><span class=filename>src/release/doc/en_US.ISO8859-1/shared/xml/release.dsl</span></p></li><li><p><span class=filename>src/release/doc/shared/examples/Makefile.relnotesng</span></p></li><li><p><span class=filename>src/release/doc/shared/xml/release.ent</span></p></li><li><p><span class=filename>src/sys/conf/newvers.sh</span></p></li><li><p><span class=filename>src/sys/sys/param.h</span></p></li><li><p><span class=filename>src/usr.sbin/pkg_install/add/main.c</span></p></li><li><p><span class=filename>doc/en_US.ISO8859-1/htdocs/search/opensearch/man.xml</span></p></li></ul></div><div class=paragraph><p>The release notes and errata files also need to be adjusted for the new release (on the release branch) and truncated appropriately (on the stable/current branch):</p></div><div class=ulist><ul><li><p><span class=filename>src/release/doc/en_US.ISO8859-1/relnotes/common/new.xml</span></p></li><li><p><span class=filename>src/release/doc/en_US.ISO8859-1/errata/article.xml</span></p></li></ul></div><div class=paragraph><p>Sysinstall should be updated to note the number of available ports and the amount of disk space required for the Ports Collection.
<sup class=footnote>[<a id=_footnoteref_5 class=footnote href=#_footnotedef_5 title="View footnote.">5</a>]</sup>
This information is currently kept in <span class=filename>src/usr.sbin/bsdinstall/dist.c</span>.</p></div><div class=paragraph><p>After the release has been built, a number of files should be updated to announce the release to the world.
These files are relative to <code>head/</code> within the <code>doc/</code> subversion tree.</p></div><div class=ulist><ul><li><p><span class=filename>share/images/articles/releng/branches-relengX.pic</span></p></li><li><p><span class=filename>head/shared/xml/release.ent</span></p></li><li><p><span class=filename>en_US.ISO8859-1/htdocs/releases/*</span></p></li><li><p><span class=filename>en_US.ISO8859-1/htdocs/releng/index.xml</span></p></li><li><p><span class=filename>share/xml/news.xml</span></p></li></ul></div><div class=paragraph><p>Additionally, update the "BSD Family Tree" file:</p></div><div class=ulist><ul><li><p><span class=filename>src/shared/misc/bsd-family-tree</span></p></li></ul></div></div><div class=sect3><h4 id=_creating_the_release_tag>2.2.3. Creating the Release Tag<a class=anchor href=#_creating_the_release_tag></a></h4><div class=paragraph><p>When the final release is ready, the following command will create the <code>release/9.2.0</code> tag.</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># svn cp $FSVN/releng/9.2 $FSVN/release/9.2.0</span></code></pre></div></div><div class=paragraph><p>The Documentation and Ports managers are responsible for tagging their respective trees with the <code>tags/RELEASE_9_2_0</code> tag.</p></div><div class=paragraph><p>When the Subversion <code>svn cp</code> command is used to create a <em>release tag</em>, this identifies the source at a specific point in time.
By creating tags, we ensure that future release builders will always be able to use the same source we used to create the official FreeBSD Project releases.</p></div></div></div></div></div><div class=sect1><h2 id=release-build>3. Release Building<a class=anchor href=#release-build></a></h2><div class=sectionbody><div class=paragraph><p>FreeBSD "releases" can be built by anyone with a fast machine and access to a source repository.
(That should be everyone, since we offer Subversion access! See the <a href=https://docs.freebsd.org/en/books/handbook/#svn>Subversion section in the Handbook</a> for details.)
The <em>only</em> special requirement is that the <a href="https://man.freebsd.org/cgi/man.cgi?query=md&amp;sektion=4&amp;format=html">md(4)</a> device must be available.
If the device is not loaded into your kernel, then the kernel module should be automatically loaded when <a href="https://man.freebsd.org/cgi/man.cgi?query=mdconfig&amp;sektion=8&amp;format=html">mdconfig(8)</a> is executed during the boot media creation phase.
All of the tools necessary to build a release are available from the Subversion repository in <span class=filename>src/release</span>.
These tools aim to provide a consistent way to build FreeBSD releases.
A complete release can actually be built with only a single command, including the creation of ISO images suitable for burning to CDROM or DVD, and an FTP install directory.
<a href="https://man.freebsd.org/cgi/man.cgi?query=release&amp;sektion=7&amp;format=html">release(7)</a> fully documents the <code>src/release/generate-release.sh</code> script which is used to build a release.
<code>generate-release.sh</code> is a wrapper around the Makefile target: <code>make release</code>.</p></div><div class=sect2><h3 id=_building_a_release>3.1. Building a Release<a class=anchor href=#_building_a_release></a></h3><div class=paragraph><p><a href="https://man.freebsd.org/cgi/man.cgi?query=release&amp;sektion=7&amp;format=html">release(7)</a> documents the exact commands required to build a FreeBSD release.
The following sequences of commands can build an 9.2.0 release:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># cd /usr/src/release</span>
<span class=c># sh generate-release.sh release/9.2.0 /local3/release</span></code></pre></div></div><div class=paragraph><p>After running these commands, all prepared release files are available in <span class=filename>/local3/release/R</span> directory.</p></div><div class=paragraph><p>The release <span class=filename>Makefile</span> can be broken down into several distinct steps.</p></div><div class=ulist><ul><li><p>Creation of a sanitized system environment in a separate directory hierarchy with “make installworld”.</p></li><li><p>Checkout from Subversion of a clean version of the system source, documentation, and ports into the release build hierarchy.</p></li><li><p>Population of <span class=filename>/etc</span> and <span class=filename>/dev</span> in the chrooted environment.</p></li><li><p>chroot into the release build hierarchy, to make it harder for the outside environment to taint this build.</p></li><li><p><code>make world</code> in the chrooted environment.</p></li><li><p>Build of Kerberos-related binaries.</p></li><li><p>Build <span class=filename>GENERIC</span> kernel.</p></li><li><p>Creation of a staging directory tree where the binary distributions will be built and packaged.</p></li><li><p>Build and installation of the documentation toolchain needed to convert the documentation source (SGML) into HTML and text documents that will accompany the release.</p></li><li><p>Build and installation of the actual documentation (user manuals, tutorials, release notes, hardware compatibility lists, and so on.)</p></li><li><p>Package up distribution tarballs of the binaries and sources.</p></li><li><p>Create FTP installation hierarchy.</p></li><li><p><em>(optionally)</em> Create ISO images for CDROM/DVD media.</p></li></ul></div><div class=paragraph><p>For more information about the release build infrastructure, please see <a href="https://man.freebsd.org/cgi/man.cgi?query=release&amp;sektion=7&amp;format=html">release(7)</a>.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>It is important to remove any site-specific settings from <span class=filename>/etc/make.conf</span>.
For example, it would be unwise to distribute binaries that were built on a system with <code>CPUTYPE</code> set to a specific processor.</p></div></td></tr></tbody></table></div></div><div class=sect2><h3 id=_contributed_software_ports>3.2. Contributed Software ("ports")<a class=anchor href=#_contributed_software_ports></a></h3><div class=paragraph><p>The <a href=https://ports.FreeBSD.org>FreeBSD Ports collection</a> is a collection of over 36000 third-party software packages available for FreeBSD.
The <code>Ports Management Team &lt;<a href=mailto:portmgr@FreeBSD.org>portmgr@FreeBSD.org</a>></code> is responsible for maintaining a consistent ports tree that can be used to create the binary packages that accompany official FreeBSD releases.</p></div></div><div class=sect2><h3 id=_release_isos>3.3. Release ISOs<a class=anchor href=#_release_isos></a></h3><div class=paragraph><p>Starting with FreeBSD 4.4, the FreeBSD Project decided to release all four ISO images that were previously sold on the <em>BSDi/Wind River Systems/FreeBSD Mall</em> "official" CDROM distributions.
Each of the four discs must contain a <span class=filename>README.TXT</span> file that explains the contents of the disc, a <span class=filename>CDROM.INF</span> file that provides meta-data for the disc so that <a href="https://man.freebsd.org/cgi/man.cgi?query=bsdinstall&amp;sektion=8&amp;format=html">bsdinstall(8)</a> can validate and use the contents, and a <span class=filename>filename.txt</span> file that provides a manifest for the disc.
This <em>manifest</em> can be created with a simple command:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>/stage/cdrom# find <span class=nb>.</span> <span class=nt>-type</span> f | <span class=nb>sed</span> <span class=nt>-e</span> <span class=s1>&#39;s/^\.\///&#39;</span> | <span class=nb>sort</span> <span class=o>&gt;</span> filename.txt</code></pre></div></div><div class=paragraph><p>The specific requirements of each CD are outlined below.</p></div><div class=sect3><h4 id=_disc_1>3.3.1. Disc 1<a class=anchor href=#_disc_1></a></h4><div class=paragraph><p>The first disc is almost completely created by <code>make release</code>.
The only changes that should be made to the <span class=filename>disc1</span> directory are the addition of a <span class=filename>tools</span> directory, and as many popular third party software packages as will fit on the disc.
The <span class=filename>tools</span> directory contains software that allow users to create installation floppies from other operating systems.
This disc should be made bootable so that users of modern PCs do not need to create installation floppy disks.</p></div><div class=paragraph><p>If a custom kernel of FreeBSD is to be included, then <a href="https://man.freebsd.org/cgi/man.cgi?query=bsdinstall&amp;sektion=8&amp;format=html">bsdinstall(8)</a> and <a href="https://man.freebsd.org/cgi/man.cgi?query=release&amp;sektion=7&amp;format=html">release(7)</a> must be updated to include installation instructions.
The relevant code is contained in <span class=filename>src/release</span> and <span class=filename>src/usr.sbin/bsdinstall</span>.
Specifically, the file <span class=filename>src/release/Makefile</span>, and <span class=filename>dist.c</span>, <span class=filename>dist.h</span>, <span class=filename>menus.c</span>, <span class=filename>install.c</span>, and <span class=filename>Makefile</span> will need to be updated under <span class=filename>src/usr.sbin/bsdinstall</span>.
Optionally, you may choose to update <span class=filename>bsdinstall.8</span>.</p></div></div><div class=sect3><h4 id=_disc_2>3.3.2. Disc 2<a class=anchor href=#_disc_2></a></h4><div class=paragraph><p>The second disc is also largely created by <code>make release</code>.
This disc contains a "live filesystem" that can be used from <a href="https://man.freebsd.org/cgi/man.cgi?query=bsdinstall&amp;sektion=8&amp;format=html">bsdinstall(8)</a> to troubleshoot a FreeBSD installation.
This disc should be bootable and should also contain a compressed copy of the CVS repository in the <span class=filename>CVSROOT</span> directory and commercial software demos in the <span class=filename>commerce</span> directory.</p></div></div><div class=sect3><h4 id=_multi_volume_support>3.3.3. Multi-volume Support<a class=anchor href=#_multi_volume_support></a></h4><div class=paragraph><p>Sysinstall supports multiple volume package installations.
This requires that each disc have an <span class=filename>INDEX</span> file containing all of the packages on all volumes of a set, along with an extra field that indicates which volume that particular package is on.
Each volume in the set must also have the <code>CD_VOLUME</code> variable set in the <span class=filename>cdrom.inf</span> file so that bsdinstall can tell which volume is which.
When a user attempts to install a package that is not on the current disc, bsdinstall will prompt the user to insert the appropriate one.</p></div></div></div></div></div><div class=sect1><h2 id=distribution>4. Distribution<a class=anchor href=#distribution></a></h2><div class=sectionbody><div class=sect2><h3 id=dist-ftp>4.1. FTP Sites<a class=anchor href=#dist-ftp></a></h3><div class=paragraph><p>When the release has been thoroughly tested and packaged for distribution, the master FTP site must be updated.
The official FreeBSD public FTP sites are all mirrors of a master server that is open only to other FTP sites.
This site is known as <code>ftp-master</code>.
When the release is ready, the following files must be modified on <code>ftp-master</code>:</p></div><div class=dlist><dl><dt class=hdlist1><span class=filename>/pub/FreeBSD/releases/arch/X.Y-RELEASE/</span></dt><dd><p>The installable FTP directory as output from <code>make release</code>.</p></dd><dt class=hdlist1><span class=filename>/pub/FreeBSD/ports/arch/packages-X.Y-release/</span></dt><dd><p>The complete package build for this release.</p></dd><dt class=hdlist1><span class=filename>/pub/FreeBSD/releases/arch/X.Y-RELEASE/tools</span></dt><dd><p>A symlink to <span class=filename>../../../tools</span>.</p></dd><dt class=hdlist1><span class=filename>/pub/FreeBSD/releases/arch/X.Y-RELEASE/packages</span></dt><dd><p>A symlink to <span class=filename>../../../ports/arch/packages-X.Y-release</span>.</p></dd><dt class=hdlist1><span class=filename>/pub/FreeBSD/releases/arch/ISO-IMAGES/X.Y/X.Y-RELEASE-arch-*.iso</span></dt><dd><p>The ISO images. The "*" is <span class=filename>disc1</span>, <span class=filename>disc2</span>, etc.
Only if there is a <span class=filename>disc1</span> and there is an alternative first installation CD (for example a stripped-down install with no windowing system) there may be a <span class=filename>mini</span> as well.</p></dd></dl></div><div class=paragraph><p>For more information about the distribution mirror architecture of the FreeBSD FTP sites, please see the <a href=https://docs.freebsd.org/en/articles/hubs/>Mirroring FreeBSD</a> article.</p></div><div class=paragraph><p>It may take many hours to two days after updating <code>ftp-master</code> before a majority of the Tier-1 FTP sites have the new software depending on whether or not a package set got loaded at the same time.
It is imperative that the release engineers coordinate with the <a href=https://lists.FreeBSD.org/subscription/mirror-announce>FreeBSD mirror site administrators</a> before announcing the general availability of new software on the FTP sites.
Ideally the release package set should be loaded at least four days prior to release day.
The release bits should be loaded between 24 and 48 hours before the planned release time with "other" file permissions turned off.
This will allow the mirror sites to download it but the general public will not be able to download it from the mirror sites.
Mail should be sent to <a href=https://lists.FreeBSD.org/subscription/mirror-announce>FreeBSD mirror site administrators</a> at the time the release bits get posted saying the release has been staged and giving the time that the mirror sites should begin allowing access.
Be sure to include a time zone with the time, for example make it relative to GMT.</p></div></div><div class=sect2><h3 id=dist-cdrom>4.2. CD-ROM Replication<a class=anchor href=#dist-cdrom></a></h3><div class=paragraph><p>Coming soon: Tips for sending FreeBSD ISOs to a replicator and quality assurance measures to be taken.</p></div></div></div></div><div class=sect1><h2 id=extensibility>5. Extensibility<a class=anchor href=#extensibility></a></h2><div class=sectionbody><div class=paragraph><p>Although FreeBSD forms a complete operating system, there is nothing that forces you to use the system exactly as we have packaged it up for distribution.
We have tried to design the system to be as extensible as possible so that it can serve as a platform that other commercial products can be built on top of.
The only "rule" we have about this is that if you are going to distribute FreeBSD with non-trivial changes, we encourage you to document your enhancements!
The FreeBSD community can only help support users of the software we provide.
We certainly encourage innovation in the form of advanced installation and administration tools, for example, but we cannot be expected to answer questions about it.</p></div><div class=sect2><h3 id=_scripting_bsdinstall>5.1. Scripting <code>bsdinstall</code><a class=anchor href=#_scripting_bsdinstall></a></h3><div class=paragraph><p>The FreeBSD system installation and configuration tool, <a href="https://man.freebsd.org/cgi/man.cgi?query=bsdinstall&amp;sektion=8&amp;format=html">bsdinstall(8)</a>, can be scripted to provide automated installs for large sites.
This functionality can be used in conjunction with Intel® PXE <sup class=footnote>[<a id=_footnoteref_6 class=footnote href=#_footnotedef_6 title="View footnote.">6</a>]</sup> to bootstrap systems from the network.</p></div></div></div></div><div class=sect1><h2 id=lessons-learned>6. Lessons Learned from FreeBSD 4.4<a class=anchor href=#lessons-learned></a></h2><div class=sectionbody><div class=paragraph><p>The release engineering process for 4.4 formally began on August 1st, 2001.
After that date all commits to the <code>RELENG_4</code> branch of FreeBSD had to be explicitly approved by the <code>Release Engineering Team &lt;<a href=mailto:re@FreeBSD.org>re@FreeBSD.org</a>></code>.
The first release candidate for the x86 architecture was released on August 16, followed by 4 more release candidates leading up to the final release on September 18th.
The security officer was very involved in the last week of the process as several security issues were found in the earlier release candidates.
A total of over <em>500</em> emails were sent to the <code>Release Engineering Team &lt;<a href=mailto:re@FreeBSD.org>re@FreeBSD.org</a>></code> in little over a month.</p></div><div class=paragraph><p>Our user community has made it very clear that the security and stability of a FreeBSD release should not be sacrificed for any self-imposed deadlines or target release dates.
The FreeBSD Project has grown tremendously over its lifetime and the need for standardized release engineering procedures has never been more apparent.
This will become even more important as FreeBSD is ported to new platforms.</p></div></div></div><div class=sect1><h2 id=future>7. Future Directions<a class=anchor href=#future></a></h2><div class=sectionbody><div class=paragraph><p>It is imperative for our release engineering activities to scale with our growing userbase.
Along these lines we are working very hard to document the procedures involved in producing FreeBSD releases.</p></div><div class=ulist><ul><li><p><em>Parallelism</em> - Certain portions of the release build are actually "embarrassingly parallel". Most of the tasks are very I/O intensive, so having multiple high-speed disk drives is actually more important than using multiple processors in speeding up the <code>make release</code> process. If multiple disks are used for different hierarchies in the <a href="https://man.freebsd.org/cgi/man.cgi?query=chroot&amp;sektion=2&amp;format=html">chroot(2)</a> environment, then the CVS checkout of the <span class=filename>ports</span> and <span class=filename>doc</span> trees can be happening simultaneously as the <code>make world</code> on another disk. Using a RAID solution (hardware or software) can significantly decrease the overall build time.</p></li><li><p><em>Cross-building releases</em> - Building IA-64 or Alpha release on x86 hardware? <code>make TARGET=ia64 release</code>.</p></li><li><p><em>Regression Testing</em> - We need better automated correctness testing for FreeBSD.</p></li><li><p><em>Installation Tools</em> - Our installation program has long since outlived its intended life span. Several projects are under development to provide a more advanced installation mechanism. The libh project was one such project that aimed to provide an intelligent new package framework and GUI installation program.</p></li></ul></div></div></div><div class=sect1><h2 id=ackno>8. Acknowledgements<a class=anchor href=#ackno></a></h2><div class=sectionbody><div class=paragraph><p>I would like to thank Jordan Hubbard for giving me the opportunity to take on some of the release engineering responsibilities for FreeBSD 4.4 and also for all of his work throughout the years making FreeBSD what it is today.
Of course the release would not have been possible without all of the release-related work done by <code>Satoshi Asami &lt;<a href=mailto:asami@FreeBSD.org>asami@FreeBSD.org</a>></code>, <code>Steve Price &lt;<a href=mailto:steve@FreeBSD.org>steve@FreeBSD.org</a>></code>, <code>Bruce A. Mah &lt;<a href=mailto:bmah@FreeBSD.org>bmah@FreeBSD.org</a>></code>, <code>Nik Clayton &lt;<a href=mailto:nik@FreeBSD.org>nik@FreeBSD.org</a>></code>, <code>David O’Brien &lt;<a href=mailto:obrien@FreeBSD.org>obrien@FreeBSD.org</a>></code>, <code>Kris Kennaway &lt;<a href=mailto:kris@FreeBSD.org>kris@FreeBSD.org</a>></code>, <code>John Baldwin &lt;<a href=mailto:jhb@FreeBSD.org>jhb@FreeBSD.org</a>></code> and the rest of the FreeBSD development community.
I would also like to thank <code>Rodney W. Grimes &lt;<a href=mailto:rgrimes@FreeBSD.org>rgrimes@FreeBSD.org</a>></code>, <code>Poul-Henning Kamp &lt;<a href=mailto:phk@FreeBSD.org>phk@FreeBSD.org</a>></code>, and others who worked on the release engineering tools in the very early days of FreeBSD.
This article was influenced by release engineering documents from the CSRG <sup class=footnote>[<a id=_footnoteref_7 class=footnote href=#_footnotedef_7 title="View footnote.">7</a>]</sup> , the NetBSD Project, <sup class=footnote>[<a id=_footnoteref_8 class=footnote href=#_footnotedef_8 title="View footnote.">8</a>]</sup> , and John Baldwin’s proposed release engineering process notes. <sup class=footnote>[<a id=_footnoteref_9 class=footnote href=#_footnotedef_9 title="View footnote.">9</a>]</sup></p></div></div></div><div id=footnotes><hr><div class=footnote id=_footnotedef_1><a href=#_footnoteref_1>1</a>. Subversion, <a href=http://subversion.apache.org class=bare>http://subversion.apache.org</a></div><div class=footnote id=_footnotedef_2><a href=#_footnoteref_2>2</a>. <a href=https://docs.freebsd.org/en/articles/contributors/#staff-committers>FreeBSD committers</a></div><div class=footnote id=_footnotedef_3><a href=#_footnoteref_3>3</a>. <a href=https://www.FreeBSD.org/administration/#t-core>FreeBSD Core Team</a></div><div class=footnote id=_footnotedef_4><a href=#_footnoteref_4>4</a>. <a href=https://docs.freebsd.org/en/books/handbook/#makeworld>Rebuilding world</a></div><div class=footnote id=_footnotedef_5><a href=#_footnoteref_5>5</a>. FreeBSD Ports Collection <a href=https://ports.FreeBSD.org class=bare>https://ports.FreeBSD.org</a></div><div class=footnote id=_footnotedef_6><a href=#_footnoteref_6>6</a>. <a href=https://docs.freebsd.org/en/books/handbook/#network-diskless>Diskless Operation with PXE</a></div><div class=footnote id=_footnotedef_7><a href=#_footnoteref_7>7</a>. Marshall Kirk McKusick, Michael J. Karels, and Keith Bostic: <a href=http://docs.FreeBSD.org/44doc/papers/releng.html>The Release Engineering of 4.3BSD</a></div><div class=footnote id=_footnotedef_8><a href=#_footnoteref_8>8</a>. NetBSD Developer Documentation: Release Engineering <a href=http://www.NetBSD.org/developers/releng/index.html class=bare>http://www.NetBSD.org/developers/releng/index.html</a></div><div class=footnote id=_footnotedef_9><a href=#_footnoteref_9>9</a>. John Baldwin’s FreeBSD Release Engineering Proposal <a href=https://people.FreeBSD.org/~jhb/docs/releng.txt class=bare>https://people.FreeBSD.org/~jhb/docs/releng.txt</a></div></div><hr><div class=last-modified><p><strong>Last modified on</strong>: September 20, 2024 by <a href="https://cgit.freebsd.org/doc/commit/?id=2d2f5d38cc" target=_blank>Fernando Apesteguía</a></p></div></div><aside class=toc><div class=toc-content><h3>Table of Contents</h3><nav id=TableOfContents><ul><li><a href=#introduction>1. Introduction</a></li><li><a href=#release-proc>2. Release Process</a></li><li><a href=#release-build>3. Release Building</a></li><li><a href=#distribution>4. Distribution</a></li><li><a href=#extensibility>5. Extensibility</a></li><li><a href=#lessons-learned>6. Lessons Learned from FreeBSD 4.4</a></li><li><a href=#future>7. Future Directions</a></li><li><a href=#ackno>8. Acknowledgements</a></li></ul></nav><hr><div class=resources><h3>Resources</h3><ul class=contents><li><i class="fa fa-file-pdf-o" aria-hidden=true title="Download PDF"></i><a href=https://download.freebsd.org/doc/en/articles/releng/releng_en.pdf>Download PDF</a></li><li><i class="fa fa-pencil-square-o" aria-hidden=true title="Edit this page"></i><a href=https://github.com/freebsd/freebsd-doc/blob/main/documentation/content/en/_index target=_blank>Edit this page</a></li></ul></div></div></aside></main><footer><div class=footer-container><section class=logo-column><img src=https://docs.freebsd.org/images/FreeBSD-colors.svg width=160 height=50 alt="FreeBSD logo"><div class=options-container><div class=language-container><a id=languages href=https://docs.freebsd.org/en/languages><img src=https://docs.freebsd.org/images/language.png class=language-image alt="Choose language">
<span>English</span></a></div><div class=theme-container><select id=theme-chooser><option value=theme-system>System</option><option value=theme-light>Light</option><option value=theme-dark>Dark</option><option value=theme-high-contrast>High contrast</option></select></div></div></section><section class=about-column><h3 class=column-title>About</h3><ul class=column-elements-container><li><a href=https://www.freebsd.org/about/ target=_blank class=column-element>FreeBSD</a></li><li><a href=https://freebsdfoundation.org/ target=_blank class=column-element>FreeBSD Foundation</a></li><li><a href=https://www.freebsd.org/where/ target=_blank class=column-element>Get FreeBSD</a></li><li><a href=https://www.freebsd.org/internal/code-of-conduct target=_blank class=column-element>Code of Conduct</a></li><li><a href=https://www.freebsd.org/security/ target=_blank class=column-element>Security Advisories</a></li></ul></section><section class=documentation-column><h3 class=column-title>Documentation</h3><ul class=column-elements-container><li><a href=/en class=column-element>Documentation portal</a></li><li><a href=https://man.FreeBSD.org target=_blank class=column-element>Manual pages</a></li><li><a href=https://papers.FreeBSD.org target=_blank class=column-element>Presentations and papers</a></li><li><a href=https://docs-archive.freebsd.org/doc/ target=_blank class=column-element>Previous versions</a></li><li><a href=https://docs-archive.freebsd.org/44doc/ target=_blank class=column-element>4.4BSD Documents</a></li><li><a href=https://wiki.freebsd.org/ target=_blank class=column-element>Wiki</a></li></ul></section><section class=community-column><h3 class=column-title>Community</h3><ul class=column-elements-container><li><a href=https://docs.freebsd.org/en/articles/contributing class=column-element>Get involved</a></li><li><a href=https://forums.freebsd.org/ target=_blank class=column-element>Community forum</a></li><li><a href=https://lists.freebsd.org/ target=_blank class=column-element>Mailing lists</a></li><li><a href=https://wiki.freebsd.org/IRC/Channels target=_blank class=column-element>IRC Channels</a></li><li><a href=https://bugs.freebsd.org/bugzilla/ target=_blank class=column-element>Bug Tracker</a></li></ul></section><section class=legal-column><h3 class=column-title>Legal</h3><ul class=column-elements-container><li><a href=https://freebsdfoundation.org/donate/ target=_blank class=column-element>Donations</a></li><li><a href=https://www.freebsd.org/copyright/freebsd-license/ target=_blank class=column-element>Licensing</a></li><li><a href=https://www.freebsd.org/privacy/ target=_blank class=column-element>Privacy Policy</a></li><li><a href=https://www.freebsd.org/copyright/ target=_blank class=column-element>Legal notices</a></li></ul></section><section class=copyright-column><p>&copy; 1994-2024 The FreeBSD Project. All rights reserved</p><span>Made with <span class=heart>♥</span> by the FreeBSD Community</span></section></div></footer></body></html>