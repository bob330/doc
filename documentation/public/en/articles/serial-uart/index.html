<!doctype html><html class=theme-light lang=en><head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="Detailed information about the use of serial ports and UART with FreeBSD"><meta name=keywords content="Serial,hardware,UART,Tutorial,FreeBSD"><meta name=copyright content="1995-2024 The FreeBSD Foundation"><link rel=canonical href=http://172.16.201.134:1313/en/articles/serial-uart/><title>Serial and UART Tutorial | FreeBSD Documentation Portal</title>
<meta name=theme-color content="#790000"><meta name=color-scheme content="system light dark high-contrast"><link rel="shortcut icon" href=http://172.16.201.134:1313/favicon.ico><link rel=stylesheet href=http://172.16.201.134:1313/styles/main.min.css><link rel=stylesheet href=http://172.16.201.134:1313/css/font-awesome-min.css><script defer src=/js/theme-chooser.min.js></script><script defer src=/js/copy-clipboard.min.js></script><script defer src=/js/search.min.js></script><meta name=twitter:card content="summary"><meta name=twitter:domain content="docs.FreeBSD.org"><meta name=twitter:site content="@freebsd"><meta name=twitter:url content="https://twitter.com/freebsd"><meta property="og:title" content="Serial and UART Tutorial"><meta property="og:description" content="Detailed information about the use of serial ports and UART with FreeBSD"><meta property="og:type" content="website"><meta property="og:image" content="http://172.16.201.134:1313/favicon.ico"><meta property="og:image:alt" content="FreeBSD Logo"><meta property="og:locale" content="en"><meta property="og:url" content="http://172.16.201.134:1313/en/articles/serial-uart/"><meta property="og:site_name" content="FreeBSD Documentation Portal"><script type=application/ld+json>{"@context":"http://schema.org","@type":"Article","url":"http:\/\/172.16.201.134:1313\/en\/articles\/serial-uart\/","name":"FreeBSD Documentation Portal","headline":"FreeBSD Documentation Portal","description":"FreeBSD Documentation Portal"}</script></head><body><header><div class=header-container><div class=logo-menu-bars-container><a href=https://www.FreeBSD.org class=logo><img src=http://172.16.201.134:1313/images/FreeBSD-monochromatic.svg width=160 height=50 alt="FreeBSD logo">
</a><label class=menu-bars for=menu-bars><i class="fa fa-bars" aria-hidden=true></i></label></div><input id=menu-bars type=checkbox><nav><ul class=menu><li class=menu-item><input id=about type=checkbox>
<a href=# aria-label="Navigate to About section"><label class=menu-item-description for=about>About
<i class="fa fa-angle-down fa-lg" aria-hidden=true></i></label></a><ul class=sub-menu><li class=title><a href=https://www.freebsd.org/about/ target=_blank>About</a></li><li><a href=https://www.freebsd.org/about/ target=_blank>FreeBSD</a></li><li><a href=https://freebsdfoundation.org/about-us/about-the-foundation/ target=_blank>FreeBSD Foundation</a></li><li><a href=https://www.freebsd.org/internal/code-of-conduct/ target=_blank>Code of Conduct</a></li></ul></li><li class=menu-item><input id=download type=checkbox>
<a href=# aria-label="Navigate to get FreeBSD section"><label class=menu-item-description for=download>Get FreeBSD
<i class="fa fa-angle-down fa-lg" aria-hidden=true></i></label></a><ul class=sub-menu><li class=title><a href=https://www.freebsd.org/where/ target=_blank>Get FreeBSD</a></li><li><a href=https://www.freebsd.org/releases/ target=_blank>Release Information</a></li><li><a href=https://www.freebsd.org/releng/ target=_blank>Release Engineering</a></li><li><a href=https://www.freebsd.org/security/ target=_blank>Security Advisories</a></li></ul></li><li class=menu-item><input id=documentation type=checkbox>
<a href=# aria-label="Navigate to get Documentation section"><label class=menu-item-description for=documentation>Documentation
<i class="fa fa-angle-down fa-lg" aria-hidden=true></i></label></a><ul class=sub-menu><li class=title><a href=/en>Documentation portal</a></li><li><a href=http://172.16.201.134:1313/en/books/handbook>FreeBSD Handbook</a></li><li><a href=http://172.16.201.134:1313/en/books/porters-handbook>Porter's Handbook</a></li><li><a href=https://docs.FreeBSD.org/en/books/fdp-primer>Documentation Project Handbook</a></li><li><a href=https://man.FreeBSD.org target=_blank>Manual pages</a></li><li><a href=https://papers.FreeBSD.org target=_blank>Presentations and papers</a></li><li><a href=https://wiki.FreeBSD.org target=_blank>Wiki</a></li><li><a href=http://172.16.201.134:1313/en/books>Books</a></li><li><a href=http://172.16.201.134:1313/en/articles>Articles</a></li></ul></li><li class=menu-item><input id=community type=checkbox>
<a href=# aria-label="Navigate to get Community section"><label class=menu-item-description for=community>Community
<i class="fa fa-angle-down fa-lg" aria-hidden=true></i></label></a><ul class=sub-menu><li class=title><a href=https://www.freebsd.org/community/>Community</a></li><li><a href=http://172.16.201.134:1313/en/articles/contributing>Get involved</a></li><li><a href=https://forums.freebsd.org/ target=_blank>Forum</a></li><li><a href=https://lists.freebsd.org/ target=_blank>Mailing lists</a></li><li><a href=https://wiki.freebsd.org/IRC/Channels target=_blank>IRC Channels</a></li><li><a href=https://bugs.freebsd.org/bugzilla/ target=_blank>Bug Tracker</a></li><li><a href=https://www.freebsd.org/support/ target=_blank>Support</a></li></ul></li></ul></nav><div class=search-donate-container><form class=search method=get id=search-header-form action=https://docs.freebsd.org/search name=search-header-form><input type=hidden name=DB value=en>
<input id=words name=P type=text size=20 maxlength=255>
<button>
<i class="fa fa-search" aria-hidden=true></i></button></form><div class=donate><a href=https://freebsdfoundation.org/donate/ target=_blank><span class=heart>♥</span>
Donate</a></div></div></div></header><main class=main-wrapper-article><div class=article><h1 class=title>Serial and UART Tutorial</h1><div class=legalnotice><a id=trademarks></a><details><summary>trademarks</summary><p>FreeBSD is a registered trademark of the FreeBSD Foundation.</p><p>Microsoft, IntelliMouse, MS-DOS, Outlook, Windows, Windows Media and Windows NT are either registered trademarks or trademarks of Microsoft Corporation in the United States and/or other countries.</p><p>Many of the designations used by manufacturers and sellers to distinguish their products are claimed as trademarks. Where those designations appear in this document, and the FreeBSD Project was aware of the trademark claim, the designations have been followed by the “™” or the “®” symbol.</p></details></div><div class=toc-mobile><h3>Table of Contents</h3><nav id=TableOfContents><ul><li><a href=#uart>1. The UART: What it is and how it works</a></li><li><a href=#sio>2. Configuring the <span class=filename>sio</span> driver</a></li><li><a href=#cy>3. Configuring the <span class=filename>cy</span> driver</a></li><li><a href=#_configuring_the_si_driver>4. Configuring the <span class=filename>si</span> driver</a></li></ul></nav></div><div id=preamble><div class=sectionbody><div class="paragraph abstract-title"><p>Abstract</p></div><div class=paragraph><p>This article talks about using serial hardware with FreeBSD.</p></div><hr></div></div><div class=sect1><h2 id=uart>1. The UART: What it is and how it works<a class=anchor href=#uart></a></h2><div class=sectionbody><div class=paragraph><p><em>Copyright ® 1996 <code>Frank Durda IV &lt;<a href=mailto:uhclem@FreeBSD.org>uhclem@FreeBSD.org</a>></code>, All Rights Reserved. 13 January 1996.</em></p></div><div class=paragraph><p>The Universal Asynchronous Receiver/Transmitter (UART) controller is the key component of the serial communications subsystem of a computer.
The UART takes bytes of data and transmits the individual bits in a sequential fashion.
At the destination, a second UART re-assembles the bits into complete bytes.</p></div><div class=paragraph><p>Serial transmission is commonly used with modems and for non-networked communication between computers, terminals and other devices.</p></div><div class=paragraph><p>There are two primary forms of serial transmission: Synchronous and Asynchronous.
Depending on the modes that are supported by the hardware, the name of the communication sub-system will usually include a <code>A</code> if it supports Asynchronous communications, and a <code>S</code> if it supports Synchronous communications.
Both forms are described below.</p></div><div class=paragraph><p>Some common acronyms are:</p></div><div class="paragraph blockquote"><p>UART Universal Asynchronous Receiver/Transmitter</p></div><div class="paragraph blockquote"><p>USART Universal Synchronous-Asynchronous Receiver/Transmitter</p></div><div class=sect2><h3 id=_synchronous_serial_transmission>1.1. Synchronous Serial Transmission<a class=anchor href=#_synchronous_serial_transmission></a></h3><div class=paragraph><p>Synchronous serial transmission requires that the sender and receiver share a clock with one another, or that the sender provide a strobe or other timing signal so that the receiver knows when to "read" the next bit of the data.
In most forms of serial Synchronous communication, if there is no data available at a given instant to transmit, a fill character must be sent instead so that data is always being transmitted.
Synchronous communication is usually more efficient because only data bits are transmitted between sender and receiver, and synchronous communication can be more costly if extra wiring and circuits are required to share a clock signal between the sender and receiver.</p></div><div class=paragraph><p>A form of Synchronous transmission is used with printers and fixed disk devices in that the data is sent on one set of wires while a clock or strobe is sent on a different wire.
Printers and fixed disk devices are not normally serial devices because most fixed disk interface standards send an entire word of data for each clock or strobe signal by using a separate wire for each bit of the word.
In the PC industry, these are known as Parallel devices.</p></div><div class=paragraph><p>The standard serial communications hardware in the PC does not support Synchronous operations.
This mode is described here for comparison purposes only.</p></div></div><div class=sect2><h3 id=_asynchronous_serial_transmission>1.2. Asynchronous Serial Transmission<a class=anchor href=#_asynchronous_serial_transmission></a></h3><div class=paragraph><p>Asynchronous transmission allows data to be transmitted without the sender having to send a clock signal to the receiver.
Instead, the sender and receiver must agree on timing parameters in advance and special bits are added to each word which are used to synchronize the sending and receiving units.</p></div><div class=paragraph><p>When a word is given to the UART for Asynchronous transmissions, a bit called the "Start Bit" is added to the beginning of each word that is to be transmitted.
The Start Bit is used to alert the receiver that a word of data is about to be sent, and to force the clock in the receiver into synchronization with the clock in the transmitter.
These two clocks must be accurate enough to not have the frequency drift by more than 10% during the transmission of the remaining bits in the word.
(This requirement was set in the days of mechanical teleprinters and is easily met by modern electronic equipment.)</p></div><div class=paragraph><p>After the Start Bit, the individual bits of the word of data are sent, with the Least Significant Bit (LSB) being sent first.
Each bit in the transmission is transmitted for exactly the same amount of time as all of the other bits, and the receiver "looks" at the wire at approximately halfway through the period assigned to each bit to determine if the bit is a <code>1</code> or a <code>0</code>.
For example, if it takes two seconds to send each bit, the receiver will examine the signal to determine if it is a <code>1</code> or a <code>0</code> after one second has passed, then it will wait two seconds and then examine the value of the next bit, and so on.</p></div><div class=paragraph><p>The sender does not know when the receiver has "looked" at the value of the bit.
The sender only knows when the clock says to begin transmitting the next bit of the word.</p></div><div class=paragraph><p>When the entire data word has been sent, the transmitter may add a Parity Bit that the transmitter generates.
The Parity Bit may be used by the receiver to perform simple error checking.
Then at least one Stop Bit is sent by the transmitter.</p></div><div class=paragraph><p>When the receiver has received all of the bits in the data word, it may check for the Parity Bits (both sender and receiver must agree on whether a Parity Bit is to be used), and then the receiver looks for a Stop Bit.
If the Stop Bit does not appear when it is supposed to, the UART considers the entire word to be garbled and will report a Framing Error to the host processor when the data word is read.
The usual cause of a Framing Error is that the sender and receiver clocks were not running at the same speed, or that the signal was interrupted.</p></div><div class=paragraph><p>Regardless of whether the data was received correctly or not, the UART automatically discards the Start, Parity and Stop bits.
If the sender and receiver are configured identically, these bits are not passed to the host.</p></div><div class=paragraph><p>If another word is ready for transmission, the Start Bit for the new word can be sent as soon as the Stop Bit for the previous word has been sent.</p></div><div class=paragraph><p>As asynchronous data is "self synchronizing", if there is no data to transmit, the transmission line can be idle.</p></div></div><div class=sect2><h3 id=_other_uart_functions>1.3. Other UART Functions<a class=anchor href=#_other_uart_functions></a></h3><div class=paragraph><p>In addition to the basic job of converting data from parallel to serial for transmission and from serial to parallel on reception, a UART will usually provide additional circuits for signals that can be used to indicate the state of the transmission media, and to regulate the flow of data in the event that the remote device is not prepared to accept more data.
For example, when the device connected to the UART is a modem, the modem may report the presence of a carrier on the phone line while the computer may be able to instruct the modem to reset itself or to not take calls by raising or lowering one more of these extra signals.
The function of each of these additional signals is defined in the EIA RS232-C standard.</p></div></div><div class=sect2><h3 id=_the_rs232_c_and_v_24_standards>1.4. The RS232-C and V.24 Standards<a class=anchor href=#_the_rs232_c_and_v_24_standards></a></h3><div class=paragraph><p>In most computer systems, the UART is connected to circuitry that generates signals that comply with the EIA RS232-C specification.
There is also a CCITT standard named V.24 that mirrors the specifications included in RS232-C.</p></div><div class=sect3><h4 id=_rs232_c_bit_assignments_marks_and_spaces>1.4.1. RS232-C Bit Assignments (Marks and Spaces)<a class=anchor href=#_rs232_c_bit_assignments_marks_and_spaces></a></h4><div class=paragraph><p>In RS232-C, a value of <code>1</code> is called a <code>Mark</code> and a value of <code>0</code> is called a <code>Space</code>.
When a communication line is idle, the line is said to be "Marking", or transmitting continuous <code>1</code> values.</p></div><div class=paragraph><p>The Start bit always has a value of <code>0</code> (a Space).
The Stop Bit always has a value of <code>1</code> (a Mark).
This means that there will always be a Mark (1) to Space (0) transition on the line at the start of every word, even when multiple word are transmitted back to back.
This guarantees that sender and receiver can resynchronize their clocks regardless of the content of the data bits that are being transmitted.</p></div><div class=paragraph><p>The idle time between Stop and Start bits does not have to be an exact multiple (including zero) of the bit rate of the communication link, but most UARTs are designed this way for simplicity.</p></div><div class=paragraph><p>In RS232-C, the "Marking" signal (a <code>1</code>) is represented by a voltage between -2 VDC and -12 VDC, and a "Spacing" signal (a <code>0</code>) is represented by a voltage between 0 and +12 VDC.
The transmitter is supposed to send +12 VDC or -12 VDC, and the receiver is supposed to allow for some voltage loss in long cables.
Some transmitters in low power devices (like portable computers) sometimes use only +5 VDC and -5 VDC, but these values are still acceptable to a RS232-C receiver, provided that the cable lengths are short.</p></div></div><div class=sect3><h4 id=_rs232_c_break_signal>1.4.2. RS232-C Break Signal<a class=anchor href=#_rs232_c_break_signal></a></h4><div class=paragraph><p>RS232-C also specifies a signal called a <code>Break</code>, which is caused by sending continuous Spacing values (no Start or Stop bits).
When there is no electricity present on the data circuit, the line is considered to be sending <code>Break</code>.</p></div><div class=paragraph><p>The <code>Break</code> signal must be of a duration longer than the time it takes to send a complete byte plus Start, Stop and Parity bits.
Most UARTs can distinguish between a Framing Error and a Break, but if the UART cannot do this, the Framing Error detection can be used to identify Breaks.</p></div><div class=paragraph><p>In the days of teleprinters, when numerous printers around the country were wired in series (such as news services), any unit could cause a <code>Break</code> by temporarily opening the entire circuit so that no current flowed.
This was used to allow a location with urgent news to interrupt some other location that was currently sending information.</p></div><div class=paragraph><p>In modern systems there are two types of Break signals.
If the Break is longer than 1.6 seconds, it is considered a "Modem Break", and some modems can be programmed to terminate the conversation and go on-hook or enter the modems' command mode when the modem detects this signal.
If the Break is smaller than 1.6 seconds, it signifies a Data Break and it is up to the remote computer to respond to this signal.
Sometimes this form of Break is used as an Attention or Interrupt signal and sometimes is accepted as a substitute for the ASCII CONTROL-C character.</p></div><div class=paragraph><p>Marks and Spaces are also equivalent to "Holes" and "No Holes" in paper tape systems.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Breaks cannot be generated from paper tape or from any other byte value, since bytes are always sent with Start and Stop bit.
The UART is usually capable of generating the continuous Spacing signal in response to a special command from the host processor.</p></div></td></tr></tbody></table></div></div><div class=sect3><h4 id=_rs232_c_dte_and_dce_devices>1.4.3. RS232-C DTE and DCE Devices<a class=anchor href=#_rs232_c_dte_and_dce_devices></a></h4><div class=paragraph><p>The RS232-C specification defines two types of equipment: the Data Terminal Equipment (DTE) and the Data Carrier Equipment (DCE).
Usually, the DTE device is the terminal (or computer), and the DCE is a modem.
Across the phone line at the other end of a conversation, the receiving modem is also a DCE device and the computer that is connected to that modem is a DTE device.
The DCE device receives signals on the pins that the DTE device transmits on, and vice versa.</p></div><div class=paragraph><p>When two devices that are both DTE or both DCE must be connected together without a modem or a similar media translator between them, a NULL modem must be used.
The NULL modem electrically re-arranges the cabling so that the transmitter output is connected to the receiver input on the other device, and vice versa.
Similar translations are performed on all of the control signals so that each device will see what it thinks are DCE (or DTE) signals from the other device.</p></div><div class=paragraph><p>The number of signals generated by the DTE and DCE devices are not symmetrical.
The DTE device generates fewer signals for the DCE device than the DTE device receives from the DCE.</p></div></div><div class=sect3><h4 id=_rs232_c_pin_assignments>1.4.4. RS232-C Pin Assignments<a class=anchor href=#_rs232_c_pin_assignments></a></h4><div class=paragraph><p>The EIA RS232-C specification (and the ITU equivalent, V.24) calls for a twenty-five pin connector (usually a DB25) and defines the purpose of most of the pins in that connector.</p></div><div class=paragraph><p>In the IBM Personal Computer and similar systems, a subset of RS232-C signals are provided via nine pin connectors (DB9).
The signals that are not included on the PC connector deal mainly with synchronous operation, and this transmission mode is not supported by the UART that IBM selected for use in the IBM PC.</p></div><div class=paragraph><p>Depending on the computer manufacturer, a DB25, a DB9, or both types of connector may be used for RS232-C communications.
(The IBM PC also uses a DB25 connector for the parallel printer interface which causes some confusion.)</p></div><div class=paragraph><p>Below is a table of the RS232-C signal assignments in the DB25 and DB9 connectors.</p></div><table class="tableblock frame-none grid-all stretch informaltable"><col style=width:14.2857%><col style=width:14.2857%><col style=width:14.2857%><col style=width:14.2857%><col style=width:14.2857%><col style=width:14.2857%><col style=width:14.2858%><thead><tr><th class="tableblock halign-left valign-top">DB25 RS232-C Pin</th><th class="tableblock halign-left valign-top">DB9 IBM PC Pin</th><th class="tableblock halign-left valign-top">EIA Circuit Symbol</th><th class="tableblock halign-left valign-top">CCITT Circuit Symbol</th><th class="tableblock halign-left valign-top">Common Name</th><th class="tableblock halign-left valign-top">Signal Source</th><th class="tableblock halign-left valign-top">Description</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class=tableblock>1</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>-</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>AA</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>101</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>PG/FG</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>-</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Frame/Protective Ground</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>2</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>3</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>BA</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>103</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>TD</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>DTE</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Transmit Data</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>3</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>2</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>BB</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>104</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>RD</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>DCE</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Receive Data</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>4</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>7</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>CA</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>105</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>RTS</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>DTE</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Request to Send</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>5</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>8</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>CB</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>106</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>CTS</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>DCE</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Clear to Send</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>6</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>6</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>CC</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>107</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>DSR</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>DCE</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Data Set Ready</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>7</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>5</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>AV</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>102</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>SG/GND</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>-</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Signal Ground</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>8</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>1</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>CF</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>109</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>DCD/CD</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>DCE</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Data Carrier Detect</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>9</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>-</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>-</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>-</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>-</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>-</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Reserved for Test</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>10</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>-</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>-</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>-</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>-</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>-</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Reserved for Test</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>11</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>-</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>-</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>-</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>-</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>-</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Reserved for Test</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>12</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>-</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>CI</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>122</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>SRLSD</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>DCE</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Sec. Recv. Line Signal Detector</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>13</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>-</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>SCB</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>121</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>SCTS</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>DCE</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Secondary Clear to Send</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>14</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>-</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>SBA</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>118</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>STD</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>DTE</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Secondary Transmit Data</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>15</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>-</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>DB</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>114</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>TSET</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>DCE</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Trans. Sig. Element Timing</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>16</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>-</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>SBB</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>119</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>SRD</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>DCE</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Secondary Received Data</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>17</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>-</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>DD</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>115</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>RSET</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>DCE</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Receiver Signal Element Timing</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>18</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>-</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>-</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>141</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>LOOP</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>DTE</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Local Loopback</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>19</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>-</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>SCA</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>120</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>SRS</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>DTE</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Secondary Request to Send</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>20</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>4</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>CD</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>108.2</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>DTR</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>DTE</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Data Terminal Ready</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>21</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>-</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>-</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>-</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>RDL</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>DTE</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Remote Digital Loopback</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>22</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>9</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>CE</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>125</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>RI</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>DCE</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Ring Indicator</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>23</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>-</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>CH</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>111</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>DSRS</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>DTE</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Data Signal Rate Selector</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>24</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>-</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>DA</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>113</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>TSET</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>DTE</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Trans. Sig. Element Timing</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>25</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>-</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>-</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>142</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>-</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>DCE</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Test Mode</p></td></tr></tbody></table></div></div><div class=sect2><h3 id=_bits_baud_and_symbols>1.5. Bits, Baud and Symbols<a class=anchor href=#_bits_baud_and_symbols></a></h3><div class=paragraph><p>Baud is a measurement of transmission speed in asynchronous communication.
Due to advances in modem communication technology, this term is frequently misused when describing the data rates in newer devices.</p></div><div class=paragraph><p>Traditionally, a Baud Rate represents the number of bits that are actually being sent over the media, not the amount of data that is actually moved from one DTE device to the other.
The Baud count includes the overhead bits Start, Stop and Parity that are generated by the sending UART and removed by the receiving UART.
This means that seven-bit words of data actually take 10 bits to be completely transmitted.
Therefore, a modem capable of moving 300 bits per second from one place to another can normally only move 30 7-bit words if Parity is used and one Start and Stop bit are present.</p></div><div class=paragraph><p>If 8-bit data words are used and Parity bits are also used, the data rate falls to 27.27 words per second, because it now takes 11 bits to send the eight-bit words, and the modem still only sends 300 bits per second.</p></div><div class=paragraph><p>The formula for converting bytes per second into a baud rate and vice versa was simple until error-correcting modems came along.
These modems receive the serial stream of bits from the UART in the host computer (even when internal modems are used the data is still frequently serialized) and converts the bits back into bytes.
These bytes are then combined into packets and sent over the phone line using a Synchronous transmission method.
This means that the Stop, Start, and Parity bits added by the UART in the DTE (the computer) were removed by the modem before transmission by the sending modem.
When these bytes are received by the remote modem, the remote modem adds Start, Stop and Parity bits to the words, converts them to a serial format and then sends them to the receiving UART in the remote computer, who then strips the Start, Stop and Parity bits.</p></div><div class=paragraph><p>The reason all these extra conversions are done is so that the two modems can perform error correction, which means that the receiving modem is able to ask the sending modem to resend a block of data that was not received with the correct checksum.
This checking is handled by the modems, and the DTE devices are usually unaware that the process is occurring.</p></div><div class=paragraph><p>By striping the Start, Stop and Parity bits, the additional bits of data that the two modems must share between themselves to perform error-correction are mostly concealed from the effective transmission rate seen by the sending and receiving DTE equipment.
For example, if a modem sends ten 7-bit words to another modem without including the Start, Stop and Parity bits, the sending modem will be able to add 30 bits of its own information that the receiving modem can use to do error-correction without impacting the transmission speed of the real data.</p></div><div class=paragraph><p>The use of the term Baud is further confused by modems that perform compression.
A single 8-bit word passed over the telephone line might represent a dozen words that were transmitted to the sending modem.
The receiving modem will expand the data back to its original content and pass that data to the receiving DTE.</p></div><div class=paragraph><p>Modern modems also include buffers that allow the rate that bits move across the phone line (DCE to DCE) to be a different speed than the speed that the bits move between the DTE and DCE on both ends of the conversation.
Normally the speed between the DTE and DCE is higher than the DCE to DCE speed because of the use of compression by the modems.</p></div><div class=paragraph><p>As the number of bits needed to describe a byte varied during the trip between the two machines plus the differing bits-per-seconds speeds that are used present on the DTE-DCE and DCE-DCE links, the usage of the term Baud to describe the overall communication speed causes problems and can misrepresent the true transmission speed.
So Bits Per Second (bps) is the correct term to use to describe the transmission rate seen at the DCE to DCE interface and Baud or Bits Per Second are acceptable terms to use when a connection is made between two systems with a wired connection, or if a modem is in use that is not performing error-correction or compression.</p></div><div class=paragraph><p>Modern high speed modems (2400, 9600, 14,400, and 19,200bps) in reality still operate at or below 2400 baud, or more accurately, 2400 Symbols per second.
High speed modem are able to encode more bits of data into each Symbol using a technique called Constellation Stuffing, which is why the effective bits per second rate of the modem is higher, but the modem continues to operate within the limited audio bandwidth that the telephone system provides.
Modems operating at 28,800 and higher speeds have variable Symbol rates, but the technique is the same.</p></div></div><div class=sect2><h3 id=_the_ibm_personal_computer_uart>1.6. The IBM Personal Computer UART<a class=anchor href=#_the_ibm_personal_computer_uart></a></h3><div class=paragraph><p>Starting with the original IBM Personal Computer, IBM selected the National Semiconductor INS8250 UART for use in the IBM PC Parallel/Serial Adapter.
Subsequent generations of compatible computers from IBM and other vendors continued to use the INS8250 or improved versions of the National Semiconductor UART family.</p></div><div class=sect3><h4 id=_national_semiconductor_uart_family_tree>1.6.1. National Semiconductor UART Family Tree<a class=anchor href=#_national_semiconductor_uart_family_tree></a></h4><div class=paragraph><p>There have been several versions and subsequent generations of the INS8250 UART. Each major version is described below.</p></div><div class="literalblock programlisting"><div class=content><pre>INS8250  -&gt; INS8250B
  \
   \
    \-&gt; INS8250A -&gt; INS82C50A
             \
              \
               \-&gt; NS16450 -&gt; NS16C450
                        \
                         \
                          \-&gt; NS16550 -&gt; NS16550A -&gt; PC16550D</pre></div></div><div class=dlist><dl><dt class=hdlist1>INS8250</dt><dd><p>This part was used in the original IBM PC and IBM PC/XT.
The original name for this part was the INS8250 ACE (Asynchronous Communications Element) and it is made from NMOS technology.</p><div class=paragraph><p>The 8250 uses eight I/O ports and has a one-byte send and a one-byte receive buffer.
This original UART has several race conditions and other flaws.
The original IBM BIOS includes code to work around these flaws, but this made the BIOS dependent on the flaws being present, so subsequent parts like the 8250A, 16450 or 16550 could not be used in the original IBM PC or IBM PC/XT.</p></div></dd><dt class=hdlist1>INS8250-B</dt><dd><p>This is the slower speed of the INS8250 made from NMOS technology.
It contains the same problems as the original INS8250.</p></dd><dt class=hdlist1>INS8250A</dt><dd><p>An improved version of the INS8250 using XMOS technology with various functional flaws corrected.
The INS8250A was used initially in PC clone computers by vendors who used "clean" BIOS designs.
Due to the corrections in the chip, this part could not be used with a BIOS compatible with the INS8250 or INS8250B.</p></dd><dt class=hdlist1>INS82C50A</dt><dd><p>This is a CMOS version (low power consumption) of the INS8250A and has similar functional characteristics.</p></dd><dt class=hdlist1>NS16450</dt><dd><p>Same as NS8250A with improvements so it can be used with faster CPU bus designs.
IBM used this part in the IBM AT and updated the IBM BIOS to no longer rely on the bugs in the INS8250.</p></dd><dt class=hdlist1>NS16C450</dt><dd><p>This is a CMOS version (low power consumption) of the NS16450.</p></dd><dt class=hdlist1>NS16550</dt><dd><p>Same as NS16450 with a 16-byte send and receive buffer but the buffer design was flawed and could not be reliably be used.</p></dd><dt class=hdlist1>NS16550A</dt><dd><p>Same as NS16550 with the buffer flaws corrected.
The 16550A and its successors have become the most popular UART design in the PC industry, mainly due to its ability to reliably handle higher data rates on operating systems with sluggish interrupt response times.</p></dd><dt class=hdlist1>NS16C552</dt><dd><p>This component consists of two NS16C550A CMOS UARTs in a single package.</p></dd><dt class=hdlist1>PC16550D</dt><dd><p>Same as NS16550A with subtle flaws corrected.
This is revision D of the 16550 family and is the latest design available from National Semiconductor.</p></dd></dl></div></div><div class=sect3><h4 id=_the_ns16550af_and_the_pc16550d_are_the_same_thing>1.6.2. The NS16550AF and the PC16550D are the same thing<a class=anchor href=#_the_ns16550af_and_the_pc16550d_are_the_same_thing></a></h4><div class=paragraph><p>National reorganized their part numbering system a few years ago, and the NS16550AFN no longer exists by that name.
(If you have a NS16550AFN, look at the date code on the part, which is a four digit number that usually starts with a nine.
The first two digits of the number are the year, and the last two digits are the week in that year when the part was packaged.
If you have a NS16550AFN, it is probably a few years old.)</p></div><div class=paragraph><p>The new numbers are like PC16550DV, with minor differences in the suffix letters depending on the package material and its shape.
(A description of the numbering system can be found below.)</p></div><div class=paragraph><p>It is important to understand that in some stores, you may pay $15(US) for a NS16550AFN made in 1990 and in the next bin are the new PC16550DN parts with minor fixes that National has made since the AFN part was in production, the PC16550DN was probably made in the past six months and it costs half (as low as $5(US) in volume) as much as the NS16550AFN because they are readily available.</p></div><div class=paragraph><p>As the supply of NS16550AFN chips continues to shrink, the price will probably continue to increase until more people discover and accept that the PC16550DN really has the same function as the old part number.</p></div></div><div class=sect3><h4 id=_national_semiconductor_part_numbering_system>1.6.3. National Semiconductor Part Numbering System<a class=anchor href=#_national_semiconductor_part_numbering_system></a></h4><div class=paragraph><p>The older NS<code><em>nnnnnrqp</em></code> part numbers are now of the format PC<code><em>nnnnnrgp</em></code>.</p></div><div class=paragraph><p>The <code><em>r</em></code> is the revision field. The current revision of the 16550 from National Semiconductor is <code>D</code>.</p></div><div class=paragraph><p>The <code><em>p</em></code> is the package-type field. The types are:</p></div><table class="tableblock frame-none grid-all stretch informaltable"><col style=width:33.3333%><col style=width:33.3333%><col style=width:33.3334%><tbody><tr><td class="tableblock halign-left valign-top"><p class=tableblock>"F"</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>QFP</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>(quad flat pack) L lead type</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>"N"</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>DIP</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>(dual inline package) through hole straight lead type</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>"V"</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>LPCC</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>(lead plastic chip carrier) J lead type</p></td></tr></tbody></table><div class=paragraph><p>The <em>g</em> is the product grade field.
If an <code>I</code> precedes the package-type letter, it indicates an "industrial" grade part, which has higher specs than a standard part but not as high as Military Specification (Milspec) component.
This is an optional field.</p></div><div class=paragraph><p>So what we used to call a NS16550AFN (DIP Package) is now called a PC16550DN or PC16550DIN.</p></div></div></div><div class=sect2><h3 id=_other_vendors_and_similar_uarts>1.7. Other Vendors and Similar UARTs<a class=anchor href=#_other_vendors_and_similar_uarts></a></h3><div class=paragraph><p>Over the years, the 8250, 8250A, 16450 and 16550 have been licensed or copied by other chip vendors.
In the case of the 8250, 8250A and 16450, the exact circuit (the "megacell") was licensed to many vendors, including Western Digital and Intel.
Other vendors reverse-engineered the part or produced emulations that had similar behavior.</p></div><div class=paragraph><p>In internal modems, the modem designer will frequently emulate the 8250A/16450 with the modem microprocessor, and the emulated UART will frequently have a hidden buffer consisting of several hundred bytes.
Due to the size of the buffer, these emulations can be as reliable as a 16550A in their ability to handle high speed data.
However, most operating systems will still report that the UART is only a 8250A or 16450, and may not make effective use of the extra buffering present in the emulated UART unless special drivers are used.</p></div><div class=paragraph><p>Some modem makers are driven by market forces to abandon a design that has hundreds of bytes of buffer and instead use a 16550A UART so that the product will compare favorably in market comparisons even though the effective performance may be lowered by this action.</p></div><div class=paragraph><p>A common misconception is that all parts with "16550A" written on them are identical in performance.
There are differences, and in some cases, outright flaws in most of these 16550A clones.</p></div><div class=paragraph><p>When the NS16550 was developed, the National Semiconductor obtained several patents on the design and they also limited licensing, making it harder for other vendors to provide a chip with similar features.
As a result of the patents, reverse-engineered designs and emulations had to avoid infringing the claims covered by the patents.
Subsequently, these copies almost never perform exactly the same as the NS16550A or PC16550D, which are the parts most computer and modem makers want to buy but are sometimes unwilling to pay the price required to get the genuine part.</p></div><div class=paragraph><p>Some of the differences in the clone 16550A parts are unimportant, while others can prevent the device from being used at all with a given operating system or driver.
These differences may show up when using other drivers, or when particular combinations of events occur that were not well tested or considered in the Windows® driver.
This is because most modem vendors and 16550-clone makers use the Microsoft drivers from Windows® for Workgroups 3.11 and the Microsoft® MS-DOS® utility as the primary tests for compatibility with the NS16550A.
This over-simplistic criteria means that if a different operating system is used, problems could appear due to subtle differences between the clones and genuine components.</p></div><div class=paragraph><p>National Semiconductor has made available a program named COMTEST that performs compatibility tests independent of any OS drivers.
It should be remembered that the purpose of this type of program is to demonstrate the flaws in the products of the competition, so the program will report major as well as extremely subtle differences in behavior in the part being tested.</p></div><div class=paragraph><p>In a series of tests performed by the author of this document in 1994, components made by National Semiconductor, TI, StarTech, and CMD as well as megacells and emulations embedded in internal modems were tested with COMTEST. A difference count for some of these components is listed below.
Since these tests were performed in 1994, they may not reflect the current performance of the given product from a vendor.</p></div><div class=paragraph><p>It should be noted that COMTEST normally aborts when an excessive number or certain types of problems have been detected.
As part of this testing, COMTEST was modified so that it would not abort no matter how many differences were encountered.</p></div><table class="tableblock frame-none grid-all stretch informaltable"><col style=width:33.3333%><col style=width:33.3333%><col style=width:33.3334%><thead><tr><th class="tableblock halign-left valign-top">Vendor</th><th class="tableblock halign-left valign-top">Part Number</th><th class="tableblock halign-left valign-top">Errors (aka "differences" reported)</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class=tableblock>National</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>(PC16550DV)</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>0</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>National</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>(NS16550AFN)</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>0</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>National</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>(NS16C552V)</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>0</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>TI</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>(TL16550AFN)</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>3</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>CMD</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>(16C550PE)</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>19</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>StarTech</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>(ST16C550J)</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>23</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>Rockwell</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Reference modem with internal 16550 or an emulation (RC144DPi/C3000-25)</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>117</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>Sierra</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Modem with an internal 16550 (SC11951/SC11351)</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>91</p></td></tr></tbody></table><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>To date, the author of this document has not found any non-National parts that report zero differences using the COMTEST program.
It should also be noted that National has had five versions of the 16550 over the years and the newest parts behave a bit differently than the classic NS16550AFN that is considered the benchmark for functionality.
COMTEST appears to turn a blind eye to the differences within the National product line and reports no errors on the National parts (except for the original 16550) even when there are official erratas that describe bugs in the A, B and C revisions of the parts, so this bias in COMTEST must be taken into account.</p></div></td></tr></tbody></table></div><div class=paragraph><p>It is important to understand that a simple count of differences from COMTEST does not reveal a lot about what differences are important and which are not.
For example, about half of the differences reported in the two modems listed above that have internal UARTs were caused by the clone UARTs not supporting five- and six-bit character modes.
The real 16550, 16450, and 8250 UARTs all support these modes and COMTEST checks the functionality of these modes so over fifty differences are reported.
However, almost no modern modem supports five- or six-bit characters, particularly those with error-correction and compression capabilities.
This means that the differences related to five- and six-bit character modes can be discounted.</p></div><div class=paragraph><p>Many of the differences COMTEST reports have to do with timing.
In many of the clone designs, when the host reads from one port, the status bits in some other port may not update in the same amount of time (some faster, some slower) as a <em>real</em> NS16550AFN and COMTEST looks for these differences.
This means that the number of differences can be misleading in that one device may only have one or two differences but they are extremely serious, and some other device that updates the status registers faster or slower than the reference part (that would probably never affect the operation of a properly written driver) could have dozens of differences reported.</p></div><div class=paragraph><p>COMTEST can be used as a screening tool to alert the administrator to the presence of potentially incompatible components that might cause problems or have to be handled as a special case.</p></div><div class=paragraph><p>If you run COMTEST on a 16550 that is in a modem or a modem is attached to the serial port, you need to first issue a ATE0&amp;W command to the modem so that the modem will not echo any of the test characters.
If you forget to do this, COMTEST will report at least this one difference:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>Error <span class=o>(</span>6<span class=o>)</span>...Timeout interrupt failed: IIR <span class=o>=</span> c1  LSR <span class=o>=</span> 61</code></pre></div></div></div><div class=sect2><h3 id=_82501645016550_registers>1.8. 8250/16450/16550 Registers<a class=anchor href=#_82501645016550_registers></a></h3><div class=paragraph><p>The 8250/16450/16550 UART occupies eight contiguous I/O port addresses.
In the IBM PC, there are two defined locations for these eight ports and they are known collectively as <span class=filename>COM1</span> and <span class=filename>COM2</span>.
The makers of PC-clones and add-on cards have created two additional areas known as <span class=filename>COM3</span> and <span class=filename>COM4</span>, but these extra COM ports conflict with other hardware on some systems.
The most common conflict is with video adapters that provide IBM 8514 emulation.</p></div><div class=paragraph><p><span class=filename>COM1</span> is located from 0x3f8 to 0x3ff and normally uses IRQ 4.
<span class=filename>COM2</span> is located from 0x2f8 to 0x2ff and normally uses IRQ 3.
<span class=filename>COM3</span> is located from 0x3e8 to 0x3ef and has no standardized IRQ.
<span class=filename>COM4</span> is located from 0x2e8 to 0x2ef and has no standardized IRQ.</p></div><div class=paragraph><p>A description of the I/O ports of the 8250/16450/16550 UART is provided below.</p></div><table class="tableblock frame-none grid-all stretch informaltable"><col style=width:10%><col style=width:10%><col style=width:80%><thead><tr><th class="tableblock halign-left valign-top">I/O Port</th><th class="tableblock halign-left valign-top">Access Allowed</th><th class="tableblock halign-left valign-top">Description</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class=tableblock>+0x00</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>write (DLAB==0)</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Transmit Holding Register (THR).</p><p class=tableblock>Information written to this port are treated as data words and will be transmitted by the UART.</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>+0x00</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>read (DLAB==0)</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Receive Buffer Register (RBR).</p><p class=tableblock>Any data words received by the UART form the serial link are accessed by the host by reading this port.</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>+0x00</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>write/read (DLAB==1)</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Divisor Latch LSB (DLL)</p><p class=tableblock>This value will be divided from the master input clock (in the IBM PC, the master clock is 1.8432MHz) and the resulting clock will determine the baud rate of the UART. This register holds bits 0 thru 7 of the divisor.</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>+0x01</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>write/read (DLAB==1)</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Divisor Latch MSB (DLH)</p><p class=tableblock>This value will be divided from the master input clock (in the IBM PC, the master clock is 1.8432MHz) and the resulting clock will determine the baud rate of the UART. This register holds bits 8 thru 15 of the divisor.</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>+0x01</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>write/read (DLAB==0)</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Interrupt Enable Register (IER)<br></p><p class=tableblock>The 8250/16450/16550 UART classifies events into one of four categories. Each category can be configured to generate an interrupt when any of the events occurs. The 8250/16450/16550 UART generates a single external interrupt signal regardless of how many events in the enabled categories have occurred. It is up to the host processor to respond to the interrupt and then poll the enabled interrupt categories (usually all categories have interrupts enabled) to determine the true cause(s) of the interrupt.<br>Bit 7 → Reserved, always 0.<br>Bit 6 → Reserved, always 0.<br>Bit 5 → Reserved, always 0.<br>Bit 4 → Reserved, always 0.<br>Bit 3 → Enable Modem Status Interrupt (EDSSI). Setting this bit to "1" allows the UART to generate an interrupt when a change occurs on one or more of the status lines.<br>Bit 2 → Enable Receiver Line Status Interrupt (ELSI) Setting this bit to "1" causes the UART to generate an interrupt when the an error (or a BREAK signal) has been detected in the incoming data.<br>Bit 1 → Enable Transmitter Holding Register Empty Interrupt (ETBEI) Setting this bit to "1" causes the UART to generate an interrupt when the UART has room for one or more additional characters that are to be transmitted.<br>Bit 0 → Enable Received Data Available Interrupt (ERBFI) Setting this bit to "1" causes the UART to generate an interrupt when the UART has received enough characters to exceed the trigger level of the FIFO, or the FIFO timer has expired (stale data), or a single character has been received when the FIFO is disabled.</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>+0x02</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>write</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>FIFO Control Register (FCR) (This port does not exist on the 8250 and 16450 UART.)<br>Bit 7 → Receiver Trigger Bit #1<br>Bit 6 → Receiver Trigger Bit #0<br></p><p class=tableblock>These two bits control at what point the receiver is to generate an interrupt when the FIFO is active.<br>7 6 How many words are received before an interrupt is generated<br>0 0 1<br>0 1 4<br>1 0 8<br>1 1 14<br>Bit 5 → Reserved, always 0.<br>Bit 4 → Reserved, always 0.<br>Bit 3 → DMA Mode Select. If Bit 0 is set to "1" (FIFOs enabled), setting this bit changes the operation of the -RXRDY and -TXRDY signals from Mode 0 to Mode 1.<br>Bit 2 → Transmit FIFO Reset. When a "1" is written to this bit, the contents of the FIFO are discarded. Any word currently being transmitted will be sent intact. This function is useful in aborting transfers.<br>Bit 1 → Receiver FIFO Reset. When a "1" is written to this bit, the contents of the FIFO are discarded. Any word currently being assembled in the shift register will be received intact.<br>Bit 0 → 16550 FIFO Enable. When set, both the transmit and receive FIFOs are enabled. Any contents in the holding register, shift registers or FIFOs are lost when FIFOs are enabled or disabled.<br></p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>+0x02</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>read</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Interrupt Identification Register<br>Bit 7 → FIFOs enabled. On the 8250/16450 UART, this bit is zero.<br>Bit 6 → FIFOs enabled. On the 8250/16450 UART, this bit is zero.<br>Bit 5 → Reserved, always 0.<br>Bit 4 → Reserved, always 0.<br>Bit 3 → Interrupt ID Bit #2. On the 8250/16450 UART, this bit is zero.<br>Bit 2 → Interrupt ID Bit #1<br>Bit 1 → Interrupt ID Bit #0.These three bits combine to report the category of event that caused the interrupt that is in progress. These categories have priorities, so if multiple categories of events occur at the same time, the UART will report the more important events first and the host must resolve the events in the order they are reported. All events that caused the current interrupt must be resolved before any new interrupts will be generated. (This is a limitation of the PC architecture.)<br>2 1 0 Priority Description<br>0 1 1 First Received Error (OE, PE, BI, or FE)<br>0 1 0 Second Received Data Available<br>1 1 0 Second Trigger level identification (Stale data in receive buffer)<br>0 0 1 Third Transmitter has room for more words (THRE)<br>0 0 0 Fourth Modem Status Change (-CTS, -DSR, -RI, or -DCD)<br>Bit 0 → Interrupt Pending Bit. If this bit is set to "0", then at least one interrupt is pending.</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>+0x03</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>write/read</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Line Control Register (LCR)<br>Bit 7 → Divisor Latch Access Bit (DLAB). When set, access to the data transmit/receive register (THR/RBR) and the Interrupt Enable Register (IER) is disabled. Any access to these ports is now redirected to the Divisor Latch Registers. Setting this bit, loading the Divisor Registers, and clearing DLAB should be done with interrupts disabled.<br>Bit 6 → Set Break. When set to "1", the transmitter begins to transmit continuous Spacing until this bit is set to "0". This overrides any bits of characters that are being transmitted.<br>Bit 5 → Stick Parity. When parity is enabled, setting this bit causes parity to always be "1" or "0", based on the value of Bit 4.
Bit 4 → Even Parity Select (EPS). When parity is enabled and Bit 5 is "0", setting this bit causes even parity to be transmitted and expected. Otherwise, odd parity is used.<br>Bit 3 → Parity Enable (PEN). When set to "1", a parity bit is inserted between the last bit of the data and the Stop Bit. The UART will also expect parity to be present in the received data.<br>Bit 2 → Number of Stop Bits (STB). If set to "1" and using 5-bit data words, 1.5 Stop Bits are transmitted and expected in each data word. For 6, 7 and 8-bit data words, 2 Stop Bits are transmitted and expected. When this bit is set to "0", one Stop Bit is used on each data word.<br>Bit 1 → Word Length Select Bit #1 (WLSB1)<br>Bit 0 → Word Length Select Bit #0 (WLSB0)<br>Together these bits specify the number of bits in each data word.<br>1 0 Word Length<br>0 0 5 Data Bits<br>0 1 6 Data Bits<br>1 0 7 Data Bits<br>1 1 8 Data Bits<br></p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>+0x04</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>write/read</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Modem Control Register (MCR)<br>Bit 7 → Reserved, always 0.<br>Bit 6 → Reserved, always 0.<br>Bit 5 → Reserved, always 0.<br>Bit 4 → Loop-Back Enable. When set to "1", the UART transmitter and receiver are internally connected together to allow diagnostic operations. In addition, the UART modem control outputs are connected to the UART modem control inputs. CTS is connected to RTS, DTR is connected to DSR, OUT1 is connected to RI, and OUT 2 is connected to DCD.<br>Bit 3 → OUT 2. An auxiliary output that the host processor may set high or low. In the IBM PC serial adapter (and most clones), OUT 2 is used to tri-state (disable) the interrupt signal from the 8250/16450/16550 UART.<br>Bit 2 → OUT 1. An auxiliary output that the host processor may set high or low. This output is not used on the IBM PC serial adapter.<br>Bit 1 → Request to Send (RTS). When set to "1", the output of the UART -RTS line is Low (Active).<br>Bit 0 → Data Terminal Ready (DTR). When set to "1", the output of the UART -DTR line is Low (Active).<br></p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>+0x05</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>write/read</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Line Status Register (LSR)<br>Bit 7 → Error in Receiver FIFO. On the 8250/16450 UART, this bit is zero. This bit is set to "1" when any of the bytes in the FIFO have one or more of the following error conditions: PE, FE, or BI.<br>Bit 6 → Transmitter Empty (TEMT). When set to "1", there are no words remaining in the transmit FIFO or the transmit shift register. The transmitter is completely idle.<br>Bit 5 → Transmitter Holding Register Empty (THRE). When set to "1", the FIFO (or holding register) now has room for at least one additional word to transmit. The transmitter may still be transmitting when this bit is set to "1".<br>Bit 4 → Break Interrupt (BI). The receiver has detected a Break signal.<br>Bit 3 → Framing Error (FE). A Start Bit was detected but the Stop Bit did not appear at the expected time. The received word is probably garbled.<br>Bit 2 → Parity Error (PE). The parity bit was incorrect for the word received.<br>Bit 1 → Overrun Error (OE). A new word was received and there was no room in the receive buffer. The newly-arrived word in the shift register is discarded. On 8250/16450 UARTs, the word in the holding register is discarded and the newly- arrived word is put in the holding register.<br>Bit 0 → Data Ready (DR) One or more words are in the receive FIFO that the host may read. A word must be completely received and moved from the shift register into the FIFO (or holding register for 8250/16450 designs) before this bit is set.</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>+0x06</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>write/read</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Modem Status Register (MSR)<br>Bit 7 → Data Carrier Detect (DCD). Reflects the state of the DCD line on the UART.<br>Bit 6 → Ring Indicator (RI). Reflects the state of the RI line on the UART.<br>Bit 5 → Data Set Ready (DSR). Reflects the state of the DSR line on the UART.<br>Bit 4 → Clear To Send (CTS). Reflects the state of the CTS line on the UART.<br>Bit 3 → Delta Data Carrier Detect (DDCD). Set to "1" if the -DCD line has changed state one more time since the last time the MSR was read by the host.<br>Bit 2 → Trailing Edge Ring Indicator (TERI). Set to "1" if the -RI line has had a low to high transition since the last time the MSR was read by the host.<br>Bit 1 → Delta Data Set Ready (DDSR). Set to "1" if the -DSR line has changed state one more time since the last time the MSR was read by the host.<br>Bit 0 → Delta Clear To Send (DCTS). Set to "1" if the -CTS line has changed state one more time since the last time the MSR was read by the host.<br></p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>+0x07</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>write/read</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Scratch Register (SCR). This register performs no function in the UART. Any value can be written by the host to this location and read by the host later on.</p></td></tr></tbody></table></div><div class=sect2><h3 id=_beyond_the_16550a_uart>1.9. Beyond the 16550A UART<a class=anchor href=#_beyond_the_16550a_uart></a></h3><div class=paragraph><p>Although National Semiconductor has not offered any components compatible with the 16550 that provide additional features, various other vendors have.
Some of these components are described below.
It should be understood that to effectively utilize these improvements, drivers may have to be provided by the chip vendor since most of the popular operating systems do not support features beyond those provided by the 16550.</p></div><div class=dlist><dl><dt class=hdlist1>ST16650</dt><dd><p>By default this part is similar to the NS16550A, but an extended 32-byte send and receive buffer can be optionally enabled.
Made by StarTech.</p></dd><dt class=hdlist1>TIL16660</dt><dd><p>By default this part behaves similar to the NS16550A, but an extended 64-byte send and receive buffer can be optionally enabled.
Made by Texas Instruments.</p></dd><dt class=hdlist1>Hayes ESP</dt><dd><p>This proprietary plug-in card contains a 2048-byte send and receive buffer, and supports data rates to 230.4Kbit/sec.
Made by Hayes.</p></dd></dl></div><div class=paragraph><p>In addition to these "dumb" UARTs, many vendors produce intelligent serial communication boards.
This type of design usually provides a microprocessor that interfaces with several UARTs, processes and buffers the data, and then alerts the main PC processor when necessary.
As the UARTs are not directly accessed by the PC processor in this type of communication system, it is not necessary for the vendor to use UARTs that are compatible with the 8250, 16450, or the 16550 UART.
This leaves the designer free to components that may have better performance characteristics.</p></div></div></div></div><div class=sect1><h2 id=sio>2. Configuring the <span class=filename>sio</span> driver<a class=anchor href=#sio></a></h2><div class=sectionbody><div class=paragraph><p>The <span class=filename>sio</span> driver provides support for NS8250-, NS16450-, NS16550 and NS16550A-based EIA RS-232C (CCITT V.24) communications interfaces.
Several multiport cards are supported as well.
See the <a href="https://man.freebsd.org/cgi/man.cgi?query=sio&amp;sektion=4&amp;format=html">sio(4)</a> manual page for detailed technical documentation.</p></div><div class=sect2><h3 id=_digi_international_digiboard_pc8>2.1. Digi International (DigiBoard) PC/8<a class=anchor href=#_digi_international_digiboard_pc8></a></h3><div class=paragraph><p><em>Contributed by <code>Andrew Webster &lt;<a href=mailto:awebster@pubnix.net>awebster@pubnix.net</a>></code>. 26 August 1995.</em></p></div><div class=paragraph><p>Here is a config snippet from a machine with a Digi International PC/8 with 16550.
It has 8 modems connected to these 8 lines, and they work just great.
Do not forget to add <code>options COM_MULTIPORT</code> or it will not work very well!</p></div><div class="literalblock programlisting"><div class=content><pre>device          sio4    at isa? port 0x100 flags 0xb05
device          sio5    at isa? port 0x108 flags 0xb05
device          sio6    at isa? port 0x110 flags 0xb05
device          sio7    at isa? port 0x118 flags 0xb05
device          sio8    at isa? port 0x120 flags 0xb05
device          sio9    at isa? port 0x128 flags 0xb05
device          sio10   at isa? port 0x130 flags 0xb05
device          sio11   at isa? port 0x138 flags 0xb05 irq 9</pre></div></div><div class=paragraph><p>The trick in setting this up is that the MSB of the flags represent the last SIO port, in this case 11 so flags are 0xb05.</p></div></div><div class=sect2><h3 id=_boca_16>2.2. Boca 16<a class=anchor href=#_boca_16></a></h3><div class=paragraph><p><em>Contributed by <code>Don Whiteside &lt;<a href=mailto:whiteside@acm.org>whiteside@acm.org</a>></code>. 26 August 1995.</em></p></div><div class=paragraph><p>The procedures to make a Boca 16 port board with FreeBSD are pretty straightforward, but you will need a couple things to make it work:</p></div><div class="olist arabic"><ol class=arabic><li><p>You either need the kernel sources installed so you can recompile the necessary options or you will need someone else to compile it for you. The 2.0.5 default kernel does <em>not</em> come with multiport support enabled and you will need to add a device entry for each port anyways.</p></li><li><p>Two, you will need to know the interrupt and IO setting for your Boca Board so you can set these options properly in the kernel.</p></li></ol></div><div class=paragraph><p>One important note - the actual UART chips for the Boca 16 are in the connector box, not on the internal board itself.
So if you have it unplugged, probes of those ports will fail.
I have never tested booting with the box unplugged and plugging it back in, and I suggest you do not either.</p></div><div class=paragraph><p>If you do not already have a custom kernel configuration file set up, refer to <a href=https://docs.freebsd.org/en/books/handbook/#kernelconfig>Kernel Configuration</a> chapter of the FreeBSD Handbook for general procedures.
The following are the specifics for the Boca 16 board and assume you are using the kernel name MYKERNEL and editing with vi.</p></div><div class="exampleblock procedure"><div class=content><div class="olist arabic"><ol class=arabic><li><p>Add the line</p><div class="literalblock programlisting"><div class=content><pre>options COM_MULTIPORT</pre></div></div><div class=paragraph><p>to the config file.</p></div></li><li><p>Where the current <code>device sio<em>n</em></code> lines are, you will need to add 16 more devices. The following example is for a Boca Board with an interrupt of 3, and a base IO address 100h. The IO address for Each port is +8 hexadecimal from the previous port, thus the 100h, 108h, 110h…​ addresses.</p><div class="literalblock programlisting"><div class=content><pre>device sio1 at isa? port 0x100 flags 0x1005
device sio2 at isa? port 0x108 flags 0x1005
device sio3 at isa? port 0x110 flags 0x1005
device sio4 at isa? port 0x118 flags 0x1005
...
device sio15 at isa? port 0x170 flags 0x1005
device sio16 at isa? port 0x178 flags 0x1005 irq 3</pre></div></div><div class=paragraph><p>The flags entry <em>must</em> be changed from this example unless you are using the exact same sio assignments.
Flags are set according to 0x<code><em>MYY</em></code> where <em>M</em> indicates the minor number of the master port (the last port on a Boca 16) and <em>YY</em> indicates if FIFO is enabled or disabled(enabled), IRQ sharing is used(yes) and if there is an AST/4 compatible IRQ control register(no).
In this example,</p></div><div class="literalblock programlisting"><div class=content><pre> flags
	      0x1005</pre></div></div><div class=paragraph><p>indicates that the master port is sio16.
If I added another board and assigned sio17 through sio28, the flags for all 16 ports on <em>that</em> board would be 0x1C05, where 1C indicates the minor number of the master port.
Do not change the 05 setting.</p></div></li><li><p>Save and complete the kernel configuration, recompile, install and reboot. Presuming you have successfully installed the recompiled kernel and have it set to the correct address and IRQ, your boot message should indicate the successful probe of the Boca ports as follows: (obviously the sio numbers, IO and IRQ could be different)</p><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>sio1 at 0x100-0x107 flags 0x1005 on isa
sio1: <span class=nb>type </span>16550A <span class=o>(</span>multiport<span class=o>)</span>
sio2 at 0x108-0x10f flags 0x1005 on isa
sio2: <span class=nb>type </span>16550A <span class=o>(</span>multiport<span class=o>)</span>
sio3 at 0x110-0x117 flags 0x1005 on isa
sio3: <span class=nb>type </span>16550A <span class=o>(</span>multiport<span class=o>)</span>
sio4 at 0x118-0x11f flags 0x1005 on isa
sio4: <span class=nb>type </span>16550A <span class=o>(</span>multiport<span class=o>)</span>
sio5 at 0x120-0x127 flags 0x1005 on isa
sio5: <span class=nb>type </span>16550A <span class=o>(</span>multiport<span class=o>)</span>
sio6 at 0x128-0x12f flags 0x1005 on isa
sio6: <span class=nb>type </span>16550A <span class=o>(</span>multiport<span class=o>)</span>
sio7 at 0x130-0x137 flags 0x1005 on isa
sio7: <span class=nb>type </span>16550A <span class=o>(</span>multiport<span class=o>)</span>
sio8 at 0x138-0x13f flags 0x1005 on isa
sio8: <span class=nb>type </span>16550A <span class=o>(</span>multiport<span class=o>)</span>
sio9 at 0x140-0x147 flags 0x1005 on isa
sio9: <span class=nb>type </span>16550A <span class=o>(</span>multiport<span class=o>)</span>
sio10 at 0x148-0x14f flags 0x1005 on isa
sio10: <span class=nb>type </span>16550A <span class=o>(</span>multiport<span class=o>)</span>
sio11 at 0x150-0x157 flags 0x1005 on isa
sio11: <span class=nb>type </span>16550A <span class=o>(</span>multiport<span class=o>)</span>
sio12 at 0x158-0x15f flags 0x1005 on isa
sio12: <span class=nb>type </span>16550A <span class=o>(</span>multiport<span class=o>)</span>
sio13 at 0x160-0x167 flags 0x1005 on isa
sio13: <span class=nb>type </span>16550A <span class=o>(</span>multiport<span class=o>)</span>
sio14 at 0x168-0x16f flags 0x1005 on isa
sio14: <span class=nb>type </span>16550A <span class=o>(</span>multiport<span class=o>)</span>
sio15 at 0x170-0x177 flags 0x1005 on isa
sio15: <span class=nb>type </span>16550A <span class=o>(</span>multiport<span class=o>)</span>
sio16 at 0x178-0x17f irq 3 flags 0x1005 on isa
sio16: <span class=nb>type </span>16550A <span class=o>(</span>multiport master<span class=o>)</span></code></pre></div></div><div class=paragraph><p>If the messages go by too fast to see,</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># dmesg | more</span></code></pre></div></div><div class=paragraph><p>will show you the boot messages.</p></div></li><li><p>Next, appropriate entries in <span class=filename>/dev</span> for the devices must be made using the <span class=filename>/dev/MAKEDEV</span> script. This step can be omitted if you are running FreeBSD 5.X with a kernel that has <a href="https://man.freebsd.org/cgi/man.cgi?query=devfs&amp;sektion=5&amp;format=html">devfs(5)</a> support compiled in.</p><div class=paragraph><p>If you do need to create the <span class=filename>/dev</span> entries, run the following as <code>root</code>:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># cd /dev</span>
<span class=c># ./MAKEDEV tty1</span>
<span class=c># ./MAKEDEV cua1</span>

<span class=o>(</span>everything <span class=k>in </span>between<span class=o>)</span>
<span class=c># ./MAKEDEV ttyg</span>
<span class=c># ./MAKEDEV cuag</span></code></pre></div></div><div class=paragraph><p>If you do not want or need call-out devices for some reason, you can dispense with making the <span class=filename>cua*</span> devices.</p></div></li><li><p>If you want a quick and sloppy way to make sure the devices are working, you can simply plug a modem into each port and (as root)</p><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># echo at &gt; ttyd*</span></code></pre></div></div><div class=paragraph><p>for each device you have made. You <em>should</em> see the RX lights flash for each working port.</p></div></li></ol></div></div></div></div><div class=sect2><h3 id=_support_for_cheap_multi_uart_cards>2.3. Support for Cheap Multi-UART Cards<a class=anchor href=#_support_for_cheap_multi_uart_cards></a></h3><div class=paragraph><p><em>Contributed by Helge Oldach</em> <a href=mailto:hmo@sep.hamburg.com>hmo@sep.hamburg.com</a>, September 1999</p></div><div class=paragraph><p>Ever wondered about FreeBSD support for your 20$ multi-I/O card with two (or more) COM ports, sharing IRQs? Here is how:</p></div><div class=paragraph><p>Usually the only option to support these kind of boards is to use a distinct IRQ for each port.
For example, if your CPU board has an on-board <span class=filename>COM1</span> port (aka <span class=filename>sio0</span>-I/O address 0x3F8 and IRQ 4) and you have an extension board with two UARTs, you will commonly need to configure them as <span class=filename>COM2</span> (aka <span class=filename>sio1</span>-I/O address 0x2F8 and IRQ 3), and the third port (aka <span class=filename>sio2</span>) as I/O 0x3E8 and IRQ 5.
Obviously this is a waste of IRQ resources, as it should be basically possible to run both extension board ports using a single IRQ with the <code>COM_MULTIPORT</code> configuration described in the previous sections.</p></div><div class=paragraph><p>Such cheap I/O boards commonly have a 4 by 3 jumper matrix for the COM ports, similar to the following:</p></div><div class="literalblock programlisting"><div class=content><pre>            o  o  o  *
Port A               |
            o  *  o  *
Port B         |
            o  *  o  o
IRQ         2  3  4  5</pre></div></div><div class=paragraph><p>Shown here is port A wired for IRQ 5 and port B wired for IRQ 3.
The IRQ columns on your specific board may vary-other boards may supply jumpers for IRQs 3, 4, 5, and 7 instead.</p></div><div class=paragraph><p>One could conclude that wiring both ports for IRQ 3 using a handcrafted wire-made jumper covering all three connection points in the IRQ 3 column would solve the issue, but no.
You cannot duplicate IRQ 3 because the output drivers of each UART are wired in a "totem pole" fashion, so if one of the UARTs drives IRQ 3, the output signal will not be what you would expect.
Depending on the implementation of the extension board or your motherboard, the IRQ 3 line will continuously stay up, or always stay low.</p></div><div class=paragraph><p>You need to decouple the IRQ drivers for the two UARTs, so that the IRQ line of the board only goes up if (and only if) one of the UARTs asserts a IRQ, and stays low otherwise.
The solution was proposed by Joerg Wunsch <a href=mailto:j@ida.interface-business.de>j@ida.interface-business.de</a>: To solder up a wired-or consisting of two diodes (Germanium or Schottky-types strongly preferred) and a 1 kOhm resistor.
Here is the schematic, starting from the 4 by 3 jumper field above:</p></div><div class="literalblock programlisting"><div class=content><pre>                          Diode
                +----------&gt;|-------+
               /                    |
            o  *  o  o              |     1 kOhm
Port A                              +----|######|-------+
            o  *  o  o              |                   |
Port B          `-------------------+                 ==+==
            o  *  o  o              |                 Ground
                \                   |
                 +---------&gt;|-------+
IRQ         2  3  4  5    Diode</pre></div></div><div class=paragraph><p>The cathodes of the diodes are connected to a common point, together with a 1 kOhm pull-down resistor.
It is essential to connect the resistor to ground to avoid floating of the IRQ line on the bus.</p></div><div class=paragraph><p>Now we are ready to configure a kernel.
Staying with this example, we would configure:</p></div><div class="literalblock programlisting"><div class=content><pre># standard on-board COM1 port
device          sio0    at isa? port &#34;IO_COM1&#34; flags 0x10
# patched-up multi-I/O extension board
options         COM_MULTIPORT
device          sio1    at isa? port &#34;IO_COM2&#34; flags 0x205
device          sio2    at isa? port &#34;IO_COM3&#34; flags 0x205 irq 3</pre></div></div><div class=paragraph><p>Note that the <code>flags</code> setting for <span class=filename>sio1</span> and <span class=filename>sio2</span> is truly essential; refer to <a href="https://man.freebsd.org/cgi/man.cgi?query=sio&amp;sektion=4&amp;format=html">sio(4)</a> for details.
(Generally, the <code>2</code> in the "flags" attribute refers to <span class=filename>sio</span><code>2</code> which holds the IRQ, and you surely want a <code>5</code> low nibble.)
With kernel verbose mode turned on this should yield something similar to this:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>sio0: irq maps: 0x1 0x11 0x1 0x1
sio0 at 0x3f8-0x3ff irq 4 flags 0x10 on isa
sio0: <span class=nb>type </span>16550A
sio1: irq maps: 0x1 0x9 0x1 0x1
sio1 at 0x2f8-0x2ff flags 0x205 on isa
sio1: <span class=nb>type </span>16550A <span class=o>(</span>multiport<span class=o>)</span>
sio2: irq maps: 0x1 0x9 0x1 0x1
sio2 at 0x3e8-0x3ef irq 3 flags 0x205 on isa
sio2: <span class=nb>type </span>16550A <span class=o>(</span>multiport master<span class=o>)</span></code></pre></div></div><div class=paragraph><p>Though <span class=filename>/sys/i386/isa/sio.c</span> is somewhat cryptic with its use of the "irq maps" array above, the basic idea is that you observe <code>0x1</code> in the first, third, and fourth place.
This means that the corresponding IRQ was set upon output and cleared after, which is just what we would expect.
If your kernel does not display this behavior, most likely there is something wrong with your wiring.</p></div></div></div></div><div class=sect1><h2 id=cy>3. Configuring the <span class=filename>cy</span> driver<a class=anchor href=#cy></a></h2><div class=sectionbody><div class=paragraph><p><em>Contributed by Alex Nash. 6 June 1996.</em></p></div><div class=paragraph><p>The Cyclades multiport cards are based on the <span class=filename>cy</span> driver instead of the usual <span class=filename>sio</span> driver used by other multiport cards.
Configuration is a simple matter of:</p></div><div class="exampleblock procedure"><div class=content><div class="olist arabic"><ol class=arabic><li><p>Add the <span class=filename>cy</span> device to your kernel configuration (note that your irq and iomem settings may differ).</p><div class="literalblock programlisting"><div class=content><pre>device cy0 at isa? irq 10 iomem 0xd4000 iosiz 0x2000</pre></div></div></li><li><p>Rebuild and install the new kernel.</p></li><li><p>Make the device nodes by typing (the following example assumes an 8-port board):</p><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># cd /dev</span>
<span class=c># for i in 0 1 2 3 4 5 6 7;do ./MAKEDEV cuac$i ttyc$i;done</span></code></pre></div></div></li><li><p>If appropriate, add dialup entries to <span class=filename>/etc/ttys</span> by duplicating serial device (<code>ttyd</code>) entries and using <code>ttyc</code> in place of <code>ttyd</code>. For example:</p><div class="literalblock programlisting"><div class=content><pre>ttyc0   &#34;/usr/libexec/getty std.38400&#34;  unknown on insecure
ttyc1   &#34;/usr/libexec/getty std.38400&#34;  unknown on insecure
ttyc2   &#34;/usr/libexec/getty std.38400&#34;  unknown on insecure
...
ttyc7   &#34;/usr/libexec/getty std.38400&#34;  unknown on insecure</pre></div></div></li><li><p>Reboot with the new kernel.</p></li></ol></div></div></div></div></div><div class=sect1><h2 id=_configuring_the_si_driver>4. Configuring the <span class=filename>si</span> driver<a class=anchor href=#_configuring_the_si_driver></a></h2><div class=sectionbody><div class=paragraph><p><em>Contributed by <code>Nick Sayer &lt;<a href=mailto:nsayer@FreeBSD.org>nsayer@FreeBSD.org</a>></code>. 25 March 1998.</em></p></div><div class=paragraph><p>The Specialix SI/XIO and SX multiport cards use the <span class=filename>si</span> driver.
A single machine can have up to 4 host cards.
The following host cards are supported:</p></div><div class=ulist><ul><li><p>ISA SI/XIO host card (2 versions)</p></li><li><p>EISA SI/XIO host card</p></li><li><p>PCI SI/XIO host card</p></li><li><p>ISA SX host card</p></li><li><p>PCI SX host card</p></li></ul></div><div class=paragraph><p>Although the SX and SI/XIO host cards look markedly different, their functionality are basically the same.
The host cards do not use I/O locations, but instead require a 32K chunk of memory.
The factory configuration for ISA cards places this at <code>0xd0000-0xd7fff</code>.
They also require an IRQ.
PCI cards will, of course, auto-configure themselves.</p></div><div class=paragraph><p>You can attach up to 4 external modules to each host card.
The external modules contain either 4 or 8 serial ports.
They come in the following varieties:</p></div><div class=ulist><ul><li><p>SI 4 or 8 port modules. Up to 57600 bps on each port supported.</p></li><li><p>XIO 8 port modules. Up to 115200 bps on each port supported. One type of XIO module has 7 serial and 1 parallel port.</p></li><li><p>SXDC 8 port modules. Up to 921600 bps on each port supported. Like XIO, a module is available with one parallel port as well.</p></li></ul></div><div class=paragraph><p>To configure an ISA host card, add the following line to your kernel configuration file, changing the numbers as appropriate:</p></div><div class="literalblock programlisting"><div class=content><pre>device si0 at isa? iomem 0xd0000 irq 11</pre></div></div><div class=paragraph><p>Valid IRQ numbers are 9, 10, 11, 12 and 15 for SX ISA host cards and 11, 12 and 15 for SI/XIO ISA host cards.</p></div><div class=paragraph><p>To configure an EISA or PCI host card, use this line:</p></div><div class="literalblock programlisting"><div class=content><pre>device si0</pre></div></div><div class=paragraph><p>After adding the configuration entry, rebuild and install your new kernel.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>The following step, is not necessary if you are using <a href="https://man.freebsd.org/cgi/man.cgi?query=devfs&amp;sektion=5&amp;format=html">devfs(5)</a> in FreeBSD 5.<em>X</em>.</p></div></td></tr></tbody></table></div><div class=paragraph><p>After rebooting with the new kernel, you need to make the device nodes in <span class=filename>/dev</span>.
The <span class=filename>MAKEDEV</span> script will take care of this for you.
Count how many total ports you have and type:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># cd /dev</span>
<span class=c># ./MAKEDEV ttyAnn cuaAnn</span></code></pre></div></div><div class=paragraph><p>(where <em>nn</em> is the number of ports)</p></div><div class=paragraph><p>If you want login prompts to appear on these ports, you will need to add lines like this to <span class=filename>/etc/ttys</span>:</p></div><div class="literalblock programlisting"><div class=content><pre>ttyA01  &#34;/usr/libexec/getty std.9600&#34;   vt100   on insecure</pre></div></div><div class=paragraph><p>Change the terminal type as appropriate.
For modems, <code>dialup</code> or <code>unknown</code> is fine.</p></div></div></div><hr><div class=last-modified><p><strong>Last modified on</strong>: November 3, 2021 by <a href="https://cgit.freebsd.org/doc/commit/?id=64acd169b8" target=_blank>Sergio Carlavilla Delgado</a></p></div></div><aside class=toc><div class=toc-content><h3>Table of Contents</h3><nav id=TableOfContents><ul><li><a href=#uart>1. The UART: What it is and how it works</a></li><li><a href=#sio>2. Configuring the <span class=filename>sio</span> driver</a></li><li><a href=#cy>3. Configuring the <span class=filename>cy</span> driver</a></li><li><a href=#_configuring_the_si_driver>4. Configuring the <span class=filename>si</span> driver</a></li></ul></nav><hr><div class=resources><h3>Resources</h3><ul class=contents><li><i class="fa fa-file-pdf-o" aria-hidden=true title="Download PDF"></i><a href=https://download.freebsd.org/doc/en/articles/serial-uart/serial-uart_en.pdf>Download PDF</a></li><li><i class="fa fa-pencil-square-o" aria-hidden=true title="Edit this page"></i><a href=https://github.com/freebsd/freebsd-doc/blob/main/documentation/content/en/_index target=_blank>Edit this page</a></li></ul></div></div></aside></main><footer><div class=footer-container><section class=logo-column><img src=http://172.16.201.134:1313/images/FreeBSD-colors.svg width=160 height=50 alt="FreeBSD logo"><div class=options-container><div class=language-container><a id=languages href=http://172.16.201.134:1313/en/languages><img src=http://172.16.201.134:1313/images/language.png class=language-image alt="Choose language">
<span>English</span></a></div><div class=theme-container><select id=theme-chooser><option value=theme-system>System</option><option value=theme-light>Light</option><option value=theme-dark>Dark</option><option value=theme-high-contrast>High contrast</option></select></div></div></section><section class=about-column><h3 class=column-title>About</h3><ul class=column-elements-container><li><a href=https://www.freebsd.org/about/ target=_blank class=column-element>FreeBSD</a></li><li><a href=https://freebsdfoundation.org/ target=_blank class=column-element>FreeBSD Foundation</a></li><li><a href=https://www.freebsd.org/where/ target=_blank class=column-element>Get FreeBSD</a></li><li><a href=https://www.freebsd.org/internal/code-of-conduct target=_blank class=column-element>Code of Conduct</a></li><li><a href=https://www.freebsd.org/security/ target=_blank class=column-element>Security Advisories</a></li></ul></section><section class=documentation-column><h3 class=column-title>Documentation</h3><ul class=column-elements-container><li><a href=/en class=column-element>Documentation portal</a></li><li><a href=https://man.FreeBSD.org target=_blank class=column-element>Manual pages</a></li><li><a href=https://papers.FreeBSD.org target=_blank class=column-element>Presentations and papers</a></li><li><a href=https://docs-archive.freebsd.org/doc/ target=_blank class=column-element>Previous versions</a></li><li><a href=https://docs-archive.freebsd.org/44doc/ target=_blank class=column-element>4.4BSD Documents</a></li><li><a href=https://wiki.freebsd.org/ target=_blank class=column-element>Wiki</a></li></ul></section><section class=community-column><h3 class=column-title>Community</h3><ul class=column-elements-container><li><a href=http://172.16.201.134:1313/en/articles/contributing class=column-element>Get involved</a></li><li><a href=https://forums.freebsd.org/ target=_blank class=column-element>Community forum</a></li><li><a href=https://lists.freebsd.org/ target=_blank class=column-element>Mailing lists</a></li><li><a href=https://wiki.freebsd.org/IRC/Channels target=_blank class=column-element>IRC Channels</a></li><li><a href=https://bugs.freebsd.org/bugzilla/ target=_blank class=column-element>Bug Tracker</a></li></ul></section><section class=legal-column><h3 class=column-title>Legal</h3><ul class=column-elements-container><li><a href=https://freebsdfoundation.org/donate/ target=_blank class=column-element>Donations</a></li><li><a href=https://www.freebsd.org/copyright/freebsd-license/ target=_blank class=column-element>Licensing</a></li><li><a href=https://www.freebsd.org/privacy/ target=_blank class=column-element>Privacy Policy</a></li><li><a href=https://www.freebsd.org/copyright/ target=_blank class=column-element>Legal notices</a></li></ul></section><section class=copyright-column><p>&copy; 1994-2024 The FreeBSD Project. All rights reserved</p><span>Made with <span class=heart>♥</span> by the FreeBSD Community</span></section></div></footer></body></html>