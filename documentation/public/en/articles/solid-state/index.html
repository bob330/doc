<!doctype html><html class=theme-light lang=en><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="The use of solid state disk devices in FreeBSD"><meta name=keywords content="Solid State,embedded,FreeBSD"><meta name=copyright content="1995-2024 The FreeBSD Foundation"><link rel=canonical href=https://docs.freebsd.org/en/articles/solid-state/><title>FreeBSD and Solid State Devices | FreeBSD Documentation Portal</title>
<meta name=theme-color content="#790000"><meta name=color-scheme content="system light dark high-contrast"><link rel="shortcut icon" href=https://docs.freebsd.org/favicon.ico><link rel=stylesheet href=https://docs.freebsd.org/styles/main.min.css><link rel=stylesheet href=https://docs.freebsd.org/css/font-awesome-min.css><script defer src=/js/theme-chooser.min.js></script><script defer src=/js/copy-clipboard.min.js></script><script defer src=/js/search.min.js></script><meta name=twitter:card content="summary"><meta name=twitter:domain content="docs.FreeBSD.org"><meta name=twitter:site content="@freebsd"><meta name=twitter:url content="https://twitter.com/freebsd"><meta property="og:title" content="FreeBSD and Solid State Devices"><meta property="og:description" content="The use of solid state disk devices in FreeBSD"><meta property="og:type" content="website"><meta property="og:image" content="https://docs.freebsd.org/favicon.ico"><meta property="og:image:alt" content="FreeBSD Logo"><meta property="og:locale" content="en"><meta property="og:url" content="https://docs.freebsd.org/en/articles/solid-state/"><meta property="og:site_name" content="FreeBSD Documentation Portal"><script type=application/ld+json>{"@context":"http://schema.org","@type":"Article","url":"https:\/\/docs.freebsd.org\/en\/articles\/solid-state\/","name":"FreeBSD Documentation Portal","headline":"FreeBSD Documentation Portal","description":"FreeBSD Documentation Portal"}</script></head><body><header><div class=header-container><div class=logo-menu-bars-container><a href=https://www.FreeBSD.org class=logo><img src=https://docs.freebsd.org/images/FreeBSD-monochromatic.svg width=160 height=50 alt="FreeBSD logo">
</a><label class=menu-bars for=menu-bars><i class="fa fa-bars" aria-hidden=true></i></label></div><input id=menu-bars type=checkbox><nav><ul class=menu><li class=menu-item><input id=about type=checkbox>
<a href=# aria-label="Navigate to About section"><label class=menu-item-description for=about>About
<i class="fa fa-angle-down fa-lg" aria-hidden=true></i></label></a><ul class=sub-menu><li class=title><a href=https://www.freebsd.org/about/ target=_blank>About</a></li><li><a href=https://www.freebsd.org/about/ target=_blank>FreeBSD</a></li><li><a href=https://freebsdfoundation.org/about-us/about-the-foundation/ target=_blank>FreeBSD Foundation</a></li><li><a href=https://www.freebsd.org/internal/code-of-conduct/ target=_blank>Code of Conduct</a></li></ul></li><li class=menu-item><input id=download type=checkbox>
<a href=# aria-label="Navigate to get FreeBSD section"><label class=menu-item-description for=download>Get FreeBSD
<i class="fa fa-angle-down fa-lg" aria-hidden=true></i></label></a><ul class=sub-menu><li class=title><a href=https://www.freebsd.org/where/ target=_blank>Get FreeBSD</a></li><li><a href=https://www.freebsd.org/releases/ target=_blank>Release Information</a></li><li><a href=https://www.freebsd.org/releng/ target=_blank>Release Engineering</a></li><li><a href=https://www.freebsd.org/security/ target=_blank>Security Advisories</a></li></ul></li><li class=menu-item><input id=documentation type=checkbox>
<a href=# aria-label="Navigate to get Documentation section"><label class=menu-item-description for=documentation>Documentation
<i class="fa fa-angle-down fa-lg" aria-hidden=true></i></label></a><ul class=sub-menu><li class=title><a href=/en>Documentation portal</a></li><li><a href=https://docs.freebsd.org/en/books/handbook>FreeBSD Handbook</a></li><li><a href=https://docs.freebsd.org/en/books/porters-handbook>Porter's Handbook</a></li><li><a href=https://docs.FreeBSD.org/en/books/fdp-primer>Documentation Project Handbook</a></li><li><a href=https://man.FreeBSD.org target=_blank>Manual pages</a></li><li><a href=https://papers.FreeBSD.org target=_blank>Presentations and papers</a></li><li><a href=https://wiki.FreeBSD.org target=_blank>Wiki</a></li><li><a href=https://docs.freebsd.org/en/books>Books</a></li><li><a href=https://docs.freebsd.org/en/articles>Articles</a></li></ul></li><li class=menu-item><input id=community type=checkbox>
<a href=# aria-label="Navigate to get Community section"><label class=menu-item-description for=community>Community
<i class="fa fa-angle-down fa-lg" aria-hidden=true></i></label></a><ul class=sub-menu><li class=title><a href=https://www.freebsd.org/community/>Community</a></li><li><a href=https://docs.freebsd.org/en/articles/contributing>Get involved</a></li><li><a href=https://forums.freebsd.org/ target=_blank>Forum</a></li><li><a href=https://lists.freebsd.org/ target=_blank>Mailing lists</a></li><li><a href=https://wiki.freebsd.org/IRC/Channels target=_blank>IRC Channels</a></li><li><a href=https://bugs.freebsd.org/bugzilla/ target=_blank>Bug Tracker</a></li><li><a href=https://www.freebsd.org/support/ target=_blank>Support</a></li></ul></li></ul></nav><div class=search-donate-container><form class=search method=get id=search-header-form action=https://docs.freebsd.org/search name=search-header-form><input type=hidden name=DB value=en>
<input id=words name=P type=text size=20 maxlength=255>
<button>
<i class="fa fa-search" aria-hidden=true></i></button></form><div class=donate><a href=https://freebsdfoundation.org/donate/ target=_blank><span class=heart>♥</span>
Donate</a></div></div></div></header><main class=main-wrapper-article><div class=article><h1 class=title>FreeBSD and Solid State Devices</h1><div class=copyright>Copyright © 2001 - 2021 The FreeBSD Documentation Project</div><div class=legalnotice><a id=trademarks></a><details><summary>trademarks</summary><p>FreeBSD is a registered trademark of the FreeBSD Foundation.</p><p>Many of the designations used by manufacturers and sellers to distinguish their products are claimed as trademarks. Where those designations appear in this document, and the FreeBSD Project was aware of the trademark claim, the designations have been followed by the “™” or the “®” symbol.</p></details></div><div class=toc-mobile><h3>Table of Contents</h3><nav id=TableOfContents><ul><li><a href=#intro>1. Solid State Disk Devices</a></li><li><a href=#kernel>2. Kernel Options</a></li><li><a href=#ro-fs>3. The <code>rc</code> Subsystem and Read-Only Filesystems</a></li><li><a href=#_building_a_file_system_from_scratch>4. Building a File System from Scratch</a></li><li><a href=#strategies>5. System Strategies for Small and Read Only Environments</a></li></ul></nav></div><div id=preamble><div class=sectionbody><div class="paragraph abstract-title"><p>Abstract</p></div><div class=paragraph><p>This article covers the use of solid state disk devices in FreeBSD to create embedded systems.</p></div><div class=paragraph><p>Embedded systems have the advantage of increased stability due to the lack of integral moving parts (hard drives).
Account must be taken, however, for the generally low disk space available in the system and the durability of the storage medium.</p></div><div class=paragraph><p>Specific topics to be covered include the types and attributes of solid state media suitable for disk use in FreeBSD, kernel options that are of interest in such an environment, the <span class=filename>rc.initdiskless</span> mechanisms that automate the initialization of such systems and the need for read-only filesystems, and building filesystems from scratch.
The article will conclude with some general strategies for small and read-only FreeBSD environments.</p></div><hr></div></div><div class=sect1><h2 id=intro>1. Solid State Disk Devices<a class=anchor href=#intro></a></h2><div class=sectionbody><div class=paragraph><p>The scope of this article will be limited to solid state disk devices made from flash memory.
Flash memory is a solid state memory (no moving parts) that is non-volatile (the memory maintains data even after all power sources have been disconnected).
Flash memory can withstand tremendous physical shock and is reasonably fast (the flash memory solutions covered in this article are slightly slower than a EIDE hard disk for write operations, and much faster for read operations).
One very important aspect of flash memory, the ramifications of which will be discussed later in this article, is that each sector has a limited rewrite capacity.
You can only write, erase, and write again to a sector of flash memory a certain number of times before the sector becomes permanently unusable.
Although many flash memory products automatically map bad blocks, and although some even distribute write operations evenly throughout the unit, the fact remains that there exists a limit to the amount of writing that can be done to the device.
Competitive units have between 1,000,000 and 10,000,000 writes per sector in their specification.
This figure varies due to the temperature of the environment.</p></div><div class=paragraph><p>Specifically, we will be discussing ATA compatible compact-flash units, which are quite popular as storage media for digital cameras.
Of particular interest is the fact that they pin out directly to the IDE bus and are compatible with the ATA command set.
Therefore, with a very simple and low-cost adaptor, these devices can be attached directly to an IDE bus in a computer.
Once implemented in this manner, operating systems such as FreeBSD see the device as a normal hard disk (albeit small).</p></div><div class=paragraph><p>Other solid state disk solutions do exist, but their expense, obscurity, and relative unease of use places them beyond the scope of this article.</p></div></div></div><div class=sect1><h2 id=kernel>2. Kernel Options<a class=anchor href=#kernel></a></h2><div class=sectionbody><div class=paragraph><p>A few kernel options are of specific interest to those creating an embedded FreeBSD system.</p></div><div class=paragraph><p>All embedded FreeBSD systems that use flash memory as system disk will be interested in memory disks and memory filesystems.
As a result of the limited number of writes that can be done to flash memory, the disk and the filesystems on the disk will most likely be mounted read-only.
In this environment, filesystems such as <span class=filename>/tmp</span> and <span class=filename>/var</span> are mounted as memory filesystems to allow the system to create logs and update counters and temporary files.
Memory filesystems are a critical component to a successful solid state FreeBSD implementation.</p></div><div class=paragraph><p>You should make sure the following lines exist in your kernel configuration file:</p></div><div class="literalblock programlisting"><div class=content><pre>options         MD_ROOT         # md device usable as a potential root device</pre></div></div></div></div><div class=sect1><h2 id=ro-fs>3. The <code>rc</code> Subsystem and Read-Only Filesystems<a class=anchor href=#ro-fs></a></h2><div class=sectionbody><div class=paragraph><p>The post-boot initialization of an embedded FreeBSD system is controlled by <span class=filename>/etc/rc.initdiskless</span>.</p></div><div class=paragraph><p><span class=filename>/etc/rc.d/var</span> mounts <span class=filename>/var</span> as a memory filesystem, makes a configurable list of directories in <span class=filename>/var</span> with the <a href="https://man.freebsd.org/cgi/man.cgi?query=mkdir&amp;sektion=1&amp;format=html">mkdir(1)</a> command, and changes modes on some of those directories.
In the execution of <span class=filename>/etc/rc.d/var</span>, one other <span class=filename>rc.conf</span> variable comes into play - <code>varsize</code>.
A <span class=filename>/var</span> partition is created by <span class=filename>/etc/rc.d/var</span> based on the value of this variable in <span class=filename>rc.conf</span>:</p></div><div class="literalblock programlisting"><div class=content><pre>varsize=8192</pre></div></div><div class=paragraph><p>Remember that this value is in sectors by default.</p></div><div class=paragraph><p>The fact that <span class=filename>/var</span> is a read-write filesystem is an important distinction, as the <span class=filename>/</span> partition (and any other partitions you may have on your flash media) should be mounted read-only.
Remember that in <a href=../solid-state/#intro>Solid State Disk Devices</a> we detailed the limitations of flash memory - specifically the limited write capability.
The importance of not mounting filesystems on flash media read-write, and the importance of not using a swap file, cannot be overstated.
A swap file on a busy system can burn through a piece of flash media in less than one year.
Heavy logging or temporary file creation and destruction can do the same.
Therefore, in addition to removing the <code>swap</code> entry from your <span class=filename>/etc/fstab</span>, you should also change the Options field for each filesystem to <code>ro</code> as follows:</p></div><div class="literalblock programlisting"><div class=content><pre># Device                Mountpoint      FStype  Options         Dump    Pass#
/dev/ad0s1a             /               ufs     ro              1       1</pre></div></div><div class=paragraph><p>A few applications in the average system will immediately begin to fail as a result of this change.
For instance, cron will not run properly as a result of missing cron tabs in the <span class=filename>/var</span> created by <span class=filename>/etc/rc.d/var</span>, and syslog and dhcp will encounter problems as well as a result of the read-only filesystem and missing items in the <span class=filename>/var</span> that <span class=filename>/etc/rc.d/var</span> has created.
These are only temporary problems though, and are addressed, along with
solutions to the execution of other common software packages in
<a href=../solid-state/#strategies>System Strategies for Small and Read Only Environments</a>.</p></div><div class=paragraph><p>An important thing to remember is that a filesystem that was mounted read-only with <span class=filename>/etc/fstab</span> can be made read-write at any time by issuing the command:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># /sbin/mount -uw partition</span></code></pre></div></div><div class=paragraph><p>and can be toggled back to read-only with the command:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># /sbin/mount -ur partition</span></code></pre></div></div></div></div><div class=sect1><h2 id=_building_a_file_system_from_scratch>4. Building a File System from Scratch<a class=anchor href=#_building_a_file_system_from_scratch></a></h2><div class=sectionbody><div class=paragraph><p>Since ATA compatible compact-flash cards are seen by FreeBSD as normal IDE hard drives, you could theoretically install FreeBSD from the network using the kern and mfsroot floppies or from a CD.</p></div><div class=paragraph><p>However, even a small installation of FreeBSD using normal installation procedures can produce a system in size of greater than 200 megabytes.
Most people will be using smaller flash memory devices (128 megabytes is considered fairly large - 32 or even 16 megabytes is common), so an installation using normal mechanisms is not possible-there is simply not enough disk space for even the smallest of conventional installations.</p></div><div class=paragraph><p>The easiest way to overcome this space limitation is to install FreeBSD using conventional means to a normal hard disk.
After the installation is complete, pare down the operating system to a size that will fit onto your flash media, then tar the entire filesystem.
The following steps will guide you through the process of preparing a piece of flash memory for your tarred filesystem.
Remember, because a normal installation is not being performed, operations such as partitioning, labeling, file-system creation, etc. need to be performed by hand.
In addition to the kern and mfsroot floppy disks, you will also need to use the fixit floppy.</p></div><div class="exampleblock procedure"><div class=content><div class="olist arabic"><ol class=arabic><li><p>Partitioning Your Flash Media Device</p><div class=paragraph><p>After booting with the kern and mfsroot floppies, choose <code>custom</code> from the installation menu.
In the custom installation menu, choose <code>partition</code>.
In the partition menu, you should delete all existing partitions using <kbd>d</kbd>.
After deleting all existing partitions, create a partition using <kbd>c</kbd> and accept the default value for the size of the partition.
When asked for the type of the partition, make sure the value is set to <code>165</code>.
Now write this partition table to the disk by pressing <kbd>w</kbd> (this is a hidden option on this screen).
If you are using an ATA compatible compact flash card, you should choose the FreeBSD Boot Manager.
Now press <kbd>q</kbd> to quit the partition menu.
You will be shown the boot manager menu once more - repeat the choice you made earlier.</p></div></li><li><p>Creating Filesystems on Your Flash Memory Device</p><div class=paragraph><p>Exit the custom installation menu, and from the main installation menu choose the <code>fixit</code> option.
After entering the fixit environment, enter the following command:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># disklabel -e /dev/ad0c</span></code></pre></div></div><div class=paragraph><p>At this point you will have entered the vi editor under the auspices of the disklabel command.
Next, you need to add an <code>a:</code> line at the end of the file. This <code>a:</code> line should look like:</p></div><div class="literalblock programlisting"><div class=content><pre>a:      123456  0       4.2BSD  0       0</pre></div></div><div class=paragraph><p>Where <em>123456</em> is a number that is exactly the same as the number in the existing <code>c:</code> entry for size.
Basically you are duplicating the existing <code>c:</code> line as an <code>a:</code> line, making sure that fstype is <code>4.2BSD</code>.
Save the file and exit.</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># disklabel -B -r /dev/ad0c</span>
<span class=c># newfs /dev/ad0a</span></code></pre></div></div></li><li><p>Placing Your Filesystem on the Flash Media</p><div class=paragraph><p>Mount the newly prepared flash media:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># mount /dev/ad0a /flash</span></code></pre></div></div><div class=paragraph><p>Bring this machine up on the network so we may transfer our tar file and explode it onto our flash media filesystem.
One example of how to do this is:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># ifconfig xl0 192.168.0.10 netmask 255.255.255.0</span>
<span class=c># route add default 192.168.0.1</span></code></pre></div></div><div class=paragraph><p>Now that the machine is on the network, transfer your tar file.
You may be faced with a bit of a dilemma at this point - if your flash memory part is 128 megabytes, for instance, and your tar file is larger than 64 megabytes, you cannot have your tar file on the flash media at the same time as you explode it - you will run out of space.
One solution to this problem, if you are using FTP, is to untar the file while it is transferred over FTP.
If you perform your transfer in this manner, you will never have the tar file and the tar contents on your disk at the same time:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>ftp&gt; get tarfile.tar <span class=s2>&#34;| tar xvf -&#34;</span></code></pre></div></div><div class=paragraph><p>If your tarfile is gzipped, you can accomplish this as well:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>ftp&gt; get tarfile.tar <span class=s2>&#34;| zcat | tar xvf -&#34;</span></code></pre></div></div><div class=paragraph><p>After the contents of your tarred filesystem are on your flash memory filesystem, you can unmount the flash memory and reboot:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># cd /</span>
<span class=c># umount /flash</span>
<span class=c># exit</span></code></pre></div></div><div class=paragraph><p>Assuming that you configured your filesystem correctly when it was built on the normal hard disk (with your filesystems mounted read-only, and with the necessary options compiled into the kernel) you should now be successfully booting your FreeBSD embedded system.</p></div></li></ol></div></div></div></div></div><div class=sect1><h2 id=strategies>5. System Strategies for Small and Read Only Environments<a class=anchor href=#strategies></a></h2><div class=sectionbody><div class=paragraph><p>In <a href=../solid-state/#ro-fs>The <code>rc</code> Subsystem and Read-Only Filesystems</a>, it was pointed out that the <span class=filename>/var</span> filesystem constructed by <span class=filename>/etc/rc.d/var</span> and the presence of a read-only root filesystem causes problems with many common software packages used with FreeBSD.
In this article, suggestions for successfully running cron, syslog, ports installations, and the Apache web server will be provided.</p></div><div class=sect2><h3 id=_cron>5.1. Cron<a class=anchor href=#_cron></a></h3><div class=paragraph><p>Upon boot, <span class=filename>/var</span> gets populated by <span class=filename>/etc/rc.d/var</span> using the list from <span class=filename>/etc/mtree/BSD.var.dist</span>, so the <span class=filename>cron</span>, <span class=filename>cron/tabs</span>, <span class=filename>at</span>, and a few other standard directories get created.</p></div><div class=paragraph><p>However, this does not solve the problem of maintaining cron tabs across reboots.
When the system reboots, the <span class=filename>/var</span> filesystem that is in memory will disappear and any cron tabs you may have had in it will also disappear.
Therefore, one solution would be to create cron tabs for the users that need them, mount your <span class=filename>/</span> filesystem as read-write and copy those cron tabs to somewhere safe, like <span class=filename>/etc/tabs</span>, then add a line to the end of <span class=filename>/etc/rc.initdiskless</span> that copies those crontabs into <span class=filename>/var/cron/tabs</span> after that directory has been created during system initialization.
You may also need to add a line that changes modes and permissions on the directories you create and the files you copy with <span class=filename>/etc/rc.initdiskless</span>.</p></div></div><div class=sect2><h3 id=_syslog>5.2. Syslog<a class=anchor href=#_syslog></a></h3><div class=paragraph><p><span class=filename>syslog.conf</span> specifies the locations of certain log files that exist in <span class=filename>/var/log</span>.
These files are not created by <span class=filename>/etc/rc.d/var</span> upon system initialization.
Therefore, somewhere in <span class=filename>/etc/rc.d/var</span>, after the section that creates the directories in <span class=filename>/var</span>, you will need to add something like this:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># touch /var/log/security /var/log/maillog /var/log/cron /var/log/messages</span>
<span class=c># chmod 0644 /var/log/*</span></code></pre></div></div></div><div class=sect2><h3 id=_ports_installation>5.3. Ports Installation<a class=anchor href=#_ports_installation></a></h3><div class=paragraph><p>Before discussing the changes necessary to successfully use the ports tree, a reminder is necessary regarding the read-only nature of your filesystems on the flash media.
Since they are read-only, you will need to temporarily mount them read-write
using the mount syntax shown in <a href=../solid-state/#ro-fs>The <code>rc</code> Subsystem and Read-Only Filesystems</a>.
You should always remount those filesystems read-only when you are done with any maintenance - unnecessary writes to the flash media could considerably shorten its lifespan.</p></div><div class=paragraph><p>To make it possible to enter a ports directory and successfully run <code>make install</code>, we must create a packages directory on a non-memory filesystem that will keep track of our packages across reboots.
As it is necessary to mount your filesystems as read-write for the installation of a package anyway, it is sensible to assume that an area on the flash media can also be used for package information to be written to.</p></div><div class=paragraph><p>First, create a package database directory.
This is normally in <span class=filename>/var/db/pkg</span>, but we cannot place it there as it will disappear every time the system is booted.</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># mkdir /etc/pkg</span></code></pre></div></div><div class=paragraph><p>Now, add a line to <span class=filename>/etc/rc.d/var</span> that links the <span class=filename>/etc/pkg</span> directory to <span class=filename>/var/db/pkg</span>. An example:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># ln -s /etc/pkg /var/db/pkg</span></code></pre></div></div><div class=paragraph><p>Now, any time that you mount your filesystems as read-write and install a package, the <code>make install</code> will work, and package information will be written successfully to <span class=filename>/etc/pkg</span> (because the filesystem will, at that time, be mounted read-write) which will always be available to the operating system as <span class=filename>/var/db/pkg</span>.</p></div></div><div class=sect2><h3 id=_apache_web_server>5.4. Apache Web Server<a class=anchor href=#_apache_web_server></a></h3><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>The steps in this section are only necessary if Apache is set up to write its pid or log information outside of <span class=filename>/var</span>.
By default, Apache keeps its pid file in <span class=filename>/var/run/httpd.pid</span> and its log files in <span class=filename>/var/log</span>.</p></div></td></tr></tbody></table></div><div class=paragraph><p>It is now assumed that Apache keeps its log files in a directory <span class=filename>apache_log_dir</span> outside of <span class=filename>/var</span>.
When this directory lives on a read-only filesystem, Apache will not be able to save any log files, and may have problems working.
If so, it is necessary to add a new directory to the list of directories in <span class=filename>/etc/rc.d/var</span> to create in <span class=filename>/var</span>, and to link <span class=filename>apache_log_dir</span> to <span class=filename>/var/log/apache</span>.
It is also necessary to set permissions and ownership on this new directory.</p></div><div class=paragraph><p>First, add the directory <code>log/apache</code> to the list of directories to be created in <span class=filename>/etc/rc.d/var</span>.</p></div><div class=paragraph><p>Second, add these commands to <span class=filename>/etc/rc.d/var</span> after the directory creation section:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># chmod 0774 /var/log/apache</span>
<span class=c># chown nobody:nobody /var/log/apache</span></code></pre></div></div><div class=paragraph><p>Finally, remove the existing <span class=filename>apache_log_dir</span> directory, and replace it with a link:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># rm -rf apache_log_dir</span>
<span class=c># ln -s /var/log/apache apache_log_dir</span></code></pre></div></div></div></div></div><hr><div class=last-modified><p><strong>Last modified on</strong>: September 20, 2024 by <a href="https://cgit.freebsd.org/doc/commit/?id=2d2f5d38cc" target=_blank>Fernando Apesteguía</a></p></div></div><aside class=toc><div class=toc-content><h3>Table of Contents</h3><nav id=TableOfContents><ul><li><a href=#intro>1. Solid State Disk Devices</a></li><li><a href=#kernel>2. Kernel Options</a></li><li><a href=#ro-fs>3. The <code>rc</code> Subsystem and Read-Only Filesystems</a></li><li><a href=#_building_a_file_system_from_scratch>4. Building a File System from Scratch</a></li><li><a href=#strategies>5. System Strategies for Small and Read Only Environments</a></li></ul></nav><hr><div class=resources><h3>Resources</h3><ul class=contents><li><i class="fa fa-file-pdf-o" aria-hidden=true title="Download PDF"></i><a href=https://download.freebsd.org/doc/en/articles/solid-state/solid-state_en.pdf>Download PDF</a></li><li><i class="fa fa-pencil-square-o" aria-hidden=true title="Edit this page"></i><a href=https://github.com/freebsd/freebsd-doc/blob/main/documentation/content/en/_index target=_blank>Edit this page</a></li></ul></div></div></aside></main><footer><div class=footer-container><section class=logo-column><img src=https://docs.freebsd.org/images/FreeBSD-colors.svg width=160 height=50 alt="FreeBSD logo"><div class=options-container><div class=language-container><a id=languages href=https://docs.freebsd.org/en/languages><img src=https://docs.freebsd.org/images/language.png class=language-image alt="Choose language">
<span>English</span></a></div><div class=theme-container><select id=theme-chooser><option value=theme-system>System</option><option value=theme-light>Light</option><option value=theme-dark>Dark</option><option value=theme-high-contrast>High contrast</option></select></div></div></section><section class=about-column><h3 class=column-title>About</h3><ul class=column-elements-container><li><a href=https://www.freebsd.org/about/ target=_blank class=column-element>FreeBSD</a></li><li><a href=https://freebsdfoundation.org/ target=_blank class=column-element>FreeBSD Foundation</a></li><li><a href=https://www.freebsd.org/where/ target=_blank class=column-element>Get FreeBSD</a></li><li><a href=https://www.freebsd.org/internal/code-of-conduct target=_blank class=column-element>Code of Conduct</a></li><li><a href=https://www.freebsd.org/security/ target=_blank class=column-element>Security Advisories</a></li></ul></section><section class=documentation-column><h3 class=column-title>Documentation</h3><ul class=column-elements-container><li><a href=/en class=column-element>Documentation portal</a></li><li><a href=https://man.FreeBSD.org target=_blank class=column-element>Manual pages</a></li><li><a href=https://papers.FreeBSD.org target=_blank class=column-element>Presentations and papers</a></li><li><a href=https://docs-archive.freebsd.org/doc/ target=_blank class=column-element>Previous versions</a></li><li><a href=https://docs-archive.freebsd.org/44doc/ target=_blank class=column-element>4.4BSD Documents</a></li><li><a href=https://wiki.freebsd.org/ target=_blank class=column-element>Wiki</a></li></ul></section><section class=community-column><h3 class=column-title>Community</h3><ul class=column-elements-container><li><a href=https://docs.freebsd.org/en/articles/contributing class=column-element>Get involved</a></li><li><a href=https://forums.freebsd.org/ target=_blank class=column-element>Community forum</a></li><li><a href=https://lists.freebsd.org/ target=_blank class=column-element>Mailing lists</a></li><li><a href=https://wiki.freebsd.org/IRC/Channels target=_blank class=column-element>IRC Channels</a></li><li><a href=https://bugs.freebsd.org/bugzilla/ target=_blank class=column-element>Bug Tracker</a></li></ul></section><section class=legal-column><h3 class=column-title>Legal</h3><ul class=column-elements-container><li><a href=https://freebsdfoundation.org/donate/ target=_blank class=column-element>Donations</a></li><li><a href=https://www.freebsd.org/copyright/freebsd-license/ target=_blank class=column-element>Licensing</a></li><li><a href=https://www.freebsd.org/privacy/ target=_blank class=column-element>Privacy Policy</a></li><li><a href=https://www.freebsd.org/copyright/ target=_blank class=column-element>Legal notices</a></li></ul></section><section class=copyright-column><p>&copy; 1994-2024 The FreeBSD Project. All rights reserved</p><span>Made with <span class=heart>♥</span> by the FreeBSD Community</span></section></div></footer></body></html>