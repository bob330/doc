<!doctype html><html class=theme-light lang=en><head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="Describes the remote installation of the FreeBSD operating system when the console of the remote system is unavailable"><meta name=keywords content="Remote,Installation,FreeBSD"><meta name=copyright content="1995-2024 The FreeBSD Foundation"><link rel=canonical href=http://172.16.201.134:1313/en/articles/remote-install/><title>Remote Installation of the FreeBSD Operating System Without a Remote Console | FreeBSD Documentation Portal</title>
<meta name=theme-color content="#790000"><meta name=color-scheme content="system light dark high-contrast"><link rel="shortcut icon" href=http://172.16.201.134:1313/favicon.ico><link rel=stylesheet href=http://172.16.201.134:1313/styles/main.min.css><link rel=stylesheet href=http://172.16.201.134:1313/css/font-awesome-min.css><script defer src=/js/theme-chooser.min.js></script><script defer src=/js/copy-clipboard.min.js></script><script defer src=/js/search.min.js></script><meta name=twitter:card content="summary"><meta name=twitter:domain content="docs.FreeBSD.org"><meta name=twitter:site content="@freebsd"><meta name=twitter:url content="https://twitter.com/freebsd"><meta property="og:title" content="Remote Installation of the FreeBSD Operating System Without a Remote Console"><meta property="og:description" content="Describes the remote installation of the FreeBSD operating system when the console of the remote system is unavailable"><meta property="og:type" content="website"><meta property="og:image" content="http://172.16.201.134:1313/favicon.ico"><meta property="og:image:alt" content="FreeBSD Logo"><meta property="og:locale" content="en"><meta property="og:url" content="http://172.16.201.134:1313/en/articles/remote-install/"><meta property="og:site_name" content="FreeBSD Documentation Portal"><script type=application/ld+json>{"@context":"http://schema.org","@type":"Article","url":"http:\/\/172.16.201.134:1313\/en\/articles\/remote-install\/","name":"FreeBSD Documentation Portal","headline":"FreeBSD Documentation Portal","description":"FreeBSD Documentation Portal"}</script></head><body><header><div class=header-container><div class=logo-menu-bars-container><a href=https://www.FreeBSD.org class=logo><img src=http://172.16.201.134:1313/images/FreeBSD-monochromatic.svg width=160 height=50 alt="FreeBSD logo">
</a><label class=menu-bars for=menu-bars><i class="fa fa-bars" aria-hidden=true></i></label></div><input id=menu-bars type=checkbox><nav><ul class=menu><li class=menu-item><input id=about type=checkbox>
<a href=# aria-label="Navigate to About section"><label class=menu-item-description for=about>About
<i class="fa fa-angle-down fa-lg" aria-hidden=true></i></label></a><ul class=sub-menu><li class=title><a href=https://www.freebsd.org/about/ target=_blank>About</a></li><li><a href=https://www.freebsd.org/about/ target=_blank>FreeBSD</a></li><li><a href=https://freebsdfoundation.org/about-us/about-the-foundation/ target=_blank>FreeBSD Foundation</a></li><li><a href=https://www.freebsd.org/internal/code-of-conduct/ target=_blank>Code of Conduct</a></li></ul></li><li class=menu-item><input id=download type=checkbox>
<a href=# aria-label="Navigate to get FreeBSD section"><label class=menu-item-description for=download>Get FreeBSD
<i class="fa fa-angle-down fa-lg" aria-hidden=true></i></label></a><ul class=sub-menu><li class=title><a href=https://www.freebsd.org/where/ target=_blank>Get FreeBSD</a></li><li><a href=https://www.freebsd.org/releases/ target=_blank>Release Information</a></li><li><a href=https://www.freebsd.org/releng/ target=_blank>Release Engineering</a></li><li><a href=https://www.freebsd.org/security/ target=_blank>Security Advisories</a></li></ul></li><li class=menu-item><input id=documentation type=checkbox>
<a href=# aria-label="Navigate to get Documentation section"><label class=menu-item-description for=documentation>Documentation
<i class="fa fa-angle-down fa-lg" aria-hidden=true></i></label></a><ul class=sub-menu><li class=title><a href=/en>Documentation portal</a></li><li><a href=http://172.16.201.134:1313/en/books/handbook>FreeBSD Handbook</a></li><li><a href=http://172.16.201.134:1313/en/books/porters-handbook>Porter's Handbook</a></li><li><a href=https://docs.FreeBSD.org/en/books/fdp-primer>Documentation Project Handbook</a></li><li><a href=https://man.FreeBSD.org target=_blank>Manual pages</a></li><li><a href=https://papers.FreeBSD.org target=_blank>Presentations and papers</a></li><li><a href=https://wiki.FreeBSD.org target=_blank>Wiki</a></li><li><a href=http://172.16.201.134:1313/en/books>Books</a></li><li><a href=http://172.16.201.134:1313/en/articles>Articles</a></li></ul></li><li class=menu-item><input id=community type=checkbox>
<a href=# aria-label="Navigate to get Community section"><label class=menu-item-description for=community>Community
<i class="fa fa-angle-down fa-lg" aria-hidden=true></i></label></a><ul class=sub-menu><li class=title><a href=https://www.freebsd.org/community/>Community</a></li><li><a href=http://172.16.201.134:1313/en/articles/contributing>Get involved</a></li><li><a href=https://forums.freebsd.org/ target=_blank>Forum</a></li><li><a href=https://lists.freebsd.org/ target=_blank>Mailing lists</a></li><li><a href=https://wiki.freebsd.org/IRC/Channels target=_blank>IRC Channels</a></li><li><a href=https://bugs.freebsd.org/bugzilla/ target=_blank>Bug Tracker</a></li><li><a href=https://www.freebsd.org/support/ target=_blank>Support</a></li></ul></li></ul></nav><div class=search-donate-container><form class=search method=get id=search-header-form action=https://docs.freebsd.org/search name=search-header-form><input type=hidden name=DB value=en>
<input id=words name=P type=text size=20 maxlength=255>
<button>
<i class="fa fa-search" aria-hidden=true></i></button></form><div class=donate><a href=https://freebsdfoundation.org/donate/ target=_blank><span class=heart>♥</span>
Donate</a></div></div></div></header><main class=main-wrapper-article><div class=article><h1 class=title>Remote Installation of the FreeBSD Operating System Without a Remote Console</h1><div class=copyright>Copyright © 2008-2021 The FreeBSD Documentation Project</div><div class=legalnotice><a id=trademarks></a><details><summary>trademarks</summary><p>FreeBSD is a registered trademark of the FreeBSD Foundation.</p><p>Many of the designations used by manufacturers and sellers to distinguish their products are claimed as trademarks. Where those designations appear in this document, and the FreeBSD Project was aware of the trademark claim, the designations have been followed by the “™” or the “®” symbol.</p></details></div><div class=toc-mobile><h3>Table of Contents</h3><nav id=TableOfContents><ul><li><a href=#background>1. Background</a></li><li><a href=#intro>2. Introduction</a></li><li><a href=#preparation>3. Preparation - mfsBSD</a></li><li><a href=#installation>4. Installation of the FreeBSD Operating System</a></li><li><a href=#zfs>5. ZFS</a></li></ul></nav></div><div id=preamble><div class=sectionbody><div class="paragraph abstract-title"><p>Abstract</p></div><div class=paragraph><p>This article documents the remote installation of the FreeBSD operating system when the console of the remote system is unavailable.
The main idea behind this article is the result of a collaboration with <code>Martin Matuska &lt;<a href=mailto:mm@FreeBSD.org>mm@FreeBSD.org</a>></code> with valuable input provided by <code>Paweł Jakub Dawidek &lt;<a href=mailto:pjd@FreeBSD.org>pjd@FreeBSD.org</a>></code>.</p></div><hr></div></div><div class=sect1><h2 id=background>1. Background<a class=anchor href=#background></a></h2><div class=sectionbody><div class=paragraph><p>There are many server hosting providers in the world, but very few of them are officially supporting FreeBSD.
They usually provide support for a Linux® distribution to be installed on the servers they offer.</p></div><div class=paragraph><p>In some cases, these companies will install your preferred Linux® distribution if you request it.
Using this option, we will attempt to install FreeBSD. In other cases, they may offer a rescue system which would be used in an emergency.
It is possible to use this for our purposes as well.</p></div><div class=paragraph><p>This article covers the basic installation and configuration steps required to bootstrap a remote installation of FreeBSD with RAID-1 and ZFS capabilities.</p></div></div></div><div class=sect1><h2 id=intro>2. Introduction<a class=anchor href=#intro></a></h2><div class=sectionbody><div class=paragraph><p>This section will summarize the purpose of this article and better explain what is covered herein.
The instructions included in this article will benefit those using services provided by colocation facilities not supporting FreeBSD.</p></div><div class="exampleblock procedure"><div class=content><div class="olist arabic"><ol class=arabic><li><p>As we have mentioned in the <a href=../remote-install/#background>Background</a> section, many of the reputable server hosting companies provide some kind of rescue system, which is booted from their LAN and accessible over SSH. They usually provide this support to help their customers fix broken operating systems. As this article will explain, it is possible to install FreeBSD with the help of these rescue systems.</p></li><li><p>The next section of this article will describe how to configure, and build minimalistic FreeBSD on the local machine. That version will eventually be running on the remote machine from a ramdisk, which will allow us to install a complete FreeBSD operating system from an FTP mirror using the sysinstall utility.</p></li><li><p>The rest of this article will describe the installation procedure itself, as well as the configuration of the ZFS file system.</p></li></ol></div></div></div><div class=sect2><h3 id=requirements>2.1. Requirements<a class=anchor href=#requirements></a></h3><div class=paragraph><p>To continue successfully, you must:</p></div><div class=ulist><ul><li><p>Have a network accessible operating system with SSH access</p></li><li><p>Understand the FreeBSD installation process</p></li><li><p>Be familiar with the <a href="https://man.freebsd.org/cgi/man.cgi?query=sysinstall&amp;sektion=8&amp;format=html">sysinstall(8)</a> utility</p></li><li><p>Have the FreeBSD installation SO image or CD handy</p></li></ul></div></div></div></div><div class=sect1><h2 id=preparation>3. Preparation - mfsBSD<a class=anchor href=#preparation></a></h2><div class=sectionbody><div class=paragraph><p>Before FreeBSD may be installed on the target system, it is necessary to build the minimal FreeBSD operating system image which will boot from the hard drive.
This way the new system can be accessed from the network, and the rest of the installation can be done without remote access to the system console.</p></div><div class=paragraph><p>The mfsBSD tool-set can be used to build a tiny FreeBSD image.
As the name of mfsBSD suggests ("mfs" means "memory file system"), the resulting image runs entirely from a ramdisk.
Thanks to this feature, the manipulation of hard drives will not be limited, therefore it will be possible to install a complete FreeBSD operating system.
The mfsBSD <a href=http://mfsbsd.vx.sk/>home page</a> includes pointers to the latest release of the toolset.</p></div><div class=paragraph><p>Please note that the internals of mfsBSD and how it all fits together is beyond the scope of this article.
The interested reader should consult the original documentation of mfsBSD for more details.</p></div><div class=paragraph><p>Download and extract the latest mfsBSD release and change your working directory to the directory where the mfsBSD scripts will reside:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># fetch http://mfsbsd.vx.sk/release/mfsbsd-2.1.tar.gz</span>
<span class=c># tar xvzf mfsbsd-2.1.tar.gz</span>
<span class=c># cd mfsbsd-2.1/</span></code></pre></div></div><div class=sect2><h3 id=mfsbsd-config>3.1. Configuration of mfsBSD<a class=anchor href=#mfsbsd-config></a></h3><div class=paragraph><p>Before booting mfsBSD, a few important configuration options have to be set.
The most important that we have to get right is, naturally, the network setup.
The most suitable method to configure networking options depends on whether we know beforehand the type of the network interface we will use, and the network interface driver to be loaded for our hardware.
We will see how mfsBSD can be configured in either case.</p></div><div class=paragraph><p>Another important thing to set is the <code>root</code> password.
This can be done by editing <span class=filename>conf/loader.conf</span>.
Please see the included comments.</p></div><div class=sect3><h4 id=_the_confinterfaces_conf_method>3.1.1. The <span class=filename>conf/interfaces.conf</span> method<a class=anchor href=#_the_confinterfaces_conf_method></a></h4><div class=paragraph><p>When the installed network interface card is unknown, it is possible to use the auto-detection features of mfsBSD.
The startup scripts of mfsBSD can detect the correct driver to use, based on the MAC address of the interface, if we set the following options in <span class=filename>conf/interfaces.conf</span>:</p></div><div class="literalblock programlisting"><div class=content><pre>mac_interfaces=&#34;ext1&#34;
ifconfig_ext1_mac=&#34;00:00:00:00:00:00&#34;
ifconfig_ext1=&#34;inet 192.168.0.2/24&#34;</pre></div></div><div class=paragraph><p>Do not forget to add the <code>defaultrouter</code> information to <span class=filename>conf/rc.conf</span>:</p></div><div class="literalblock programlisting"><div class=content><pre>defaultrouter=&#34;192.168.0.1&#34;</pre></div></div></div><div class=sect3><h4 id=_the_confrc_conf_method>3.1.2. The <span class=filename>conf/rc.conf</span> Method<a class=anchor href=#_the_confrc_conf_method></a></h4><div class=paragraph><p>When the network interface driver is known, it is more convenient to use <span class=filename>conf/rc.conf</span> for networking options.
The syntax of this file is the same as the one used in the standard <a href="https://man.freebsd.org/cgi/man.cgi?query=rc.conf&amp;sektion=5&amp;format=html">rc.conf(5)</a> file of FreeBSD.</p></div><div class=paragraph><p>For example, if you know that a <a href="https://man.freebsd.org/cgi/man.cgi?query=re&amp;sektion=4&amp;format=html">re(4)</a> network interface is going to be available, you can set the following options in <span class=filename>conf/rc.conf</span>:</p></div><div class="literalblock programlisting"><div class=content><pre>defaultrouter=&#34;192.168.0.1&#34;
ifconfig_re0=&#34;inet 192.168.0.2/24&#34;</pre></div></div></div></div><div class=sect2><h3 id=mfsbsd-build>3.2. Building an mfsBSD Image<a class=anchor href=#mfsbsd-build></a></h3><div class=paragraph><p>The process of building an mfsBSD image is pretty straightforward.</p></div><div class=paragraph><p>The first step is to mount the FreeBSD installation CD, or the installation ISO image to <span class=filename>/cdrom</span>.
For the sake of example, in this article we will assume that you have downloaded the FreeBSD 10.1-RELEASE ISO.
Mounting this ISO image to the <span class=filename>/cdrom</span> directory is easy with the <a href="https://man.freebsd.org/cgi/man.cgi?query=mdconfig&amp;sektion=8&amp;format=html">mdconfig(8)</a> utility:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># mdconfig -a -t vnode -u 10 -f FreeBSD-10.1-RELEASE-amd64-disc1.iso</span>
<span class=c># mount_cd9660 /dev/md10 /cdrom</span></code></pre></div></div><div class=paragraph><p>Since the recent FreeBSD releases do not contain regular distribution sets, it is required to extract the FreeBSD distribution files from the distribution archives located on the ISO image:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># mkdir DIST</span>
<span class=c># tar -xvf /cdrom/usr/freebsd-dist/base.txz -C DIST</span>
<span class=c># tar -xvf /cdrom/usr/freebsd-dist/kernel.txz -C DIST</span></code></pre></div></div><div class=paragraph><p>Next, build the bootable mfsBSD image:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># make BASE=DIST</span></code></pre></div></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>The above <code>make</code> has to be run from the top level of the mfsBSD directory tree, for example <span class=filename>~/mfsbsd-2.1/</span>.</p></div></td></tr></tbody></table></div></div><div class=sect2><h3 id=_booting_mfsbsd>3.3. Booting mfsBSD<a class=anchor href=#_booting_mfsbsd></a></h3><div class=paragraph><p>Now that the mfsBSD image is ready, it must be uploaded to the remote system running a live rescue system or pre-installed Linux® distribution.
The most suitable tool for this task is scp:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># scp disk.img root@192.168.0.2:.</span></code></pre></div></div><div class=paragraph><p>To boot mfsBSD image properly, it must be placed on the first (bootable) device of the given machine.
This may be accomplished using this example providing that <span class=filename>sda</span> is the first bootable disk device:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># dd if=/root/disk.img of=/dev/sda bs=1m</span></code></pre></div></div><div class=paragraph><p>If all went well, the image should now be in the MBR of the first device and the machine can be rebooted.
Watch for the machine to boot up properly with the <a href="https://man.freebsd.org/cgi/man.cgi?query=ping&amp;sektion=8&amp;format=html">ping(8)</a> tool.
Once it has came back on-line, it should be possible to access it over <a href="https://man.freebsd.org/cgi/man.cgi?query=ssh&amp;sektion=1&amp;format=html">ssh(1)</a> as user <code>root</code> with the configured password.</p></div></div></div></div><div class=sect1><h2 id=installation>4. Installation of the FreeBSD Operating System<a class=anchor href=#installation></a></h2><div class=sectionbody><div class=paragraph><p>The mfsBSD has been successfully booted and it should be possible to log in through <a href="https://man.freebsd.org/cgi/man.cgi?query=ssh&amp;sektion=1&amp;format=html">ssh(1)</a>.
This section will describe how to create and label slices, set up <code>gmirror</code> for RAID-1, and how to use <code>sysinstall</code> to install a minimal distribution of the FreeBSD operating system.</p></div><div class=sect2><h3 id=_preparation_of_hard_drives>4.1. Preparation of Hard Drives<a class=anchor href=#_preparation_of_hard_drives></a></h3><div class=paragraph><p>The first task is to allocate disk space for FreeBSD, i.e.: to create slices and partitions.
Obviously, the currently running system is fully loaded in system memory and therefore there will be no problems with manipulating hard drives.
To complete this task, it is possible to use either <code>sysinstall</code> or <a href="https://man.freebsd.org/cgi/man.cgi?query=fdisk&amp;sektion=8&amp;format=html">fdisk(8)</a> in conjunction to <a href="https://man.freebsd.org/cgi/man.cgi?query=bsdlabel&amp;sektion=8&amp;format=html">bsdlabel(8)</a>.</p></div><div class=paragraph><p>At the start, mark all system disks as empty.
Repeat the following command for each hard drive:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># dd if=/dev/zero of=/dev/ad0 count=2</span></code></pre></div></div><div class=paragraph><p>Next, create slices and label them with your preferred tool.
While it is considered easier to use <code>sysinstall</code>, a powerful and also probably less buggy method will be to use standard text-based UNIX® tools, such as <a href="https://man.freebsd.org/cgi/man.cgi?query=fdisk&amp;sektion=8&amp;format=html">fdisk(8)</a> and <a href="https://man.freebsd.org/cgi/man.cgi?query=bsdlabel&amp;sektion=8&amp;format=html">bsdlabel(8)</a>, which will also be covered in this section.
The former option is well documented in the <a href=https://docs.freebsd.org/en/books/handbook/#install-steps>Installing FreeBSD</a> chapter of the FreeBSD Handbook.
As it was mentioned in the introduction, this article will present how to set up a system with RAID-1 and ZFS capabilities.
Our set up will consist of a small <a href="https://man.freebsd.org/cgi/man.cgi?query=gmirror&amp;sektion=8&amp;format=html">gmirror(8)</a> mirrored <span class=filename>/</span> (root), <span class=filename>/usr</span> and <span class=filename>/var</span> dataset, and the rest of the disk space will be allocated for a <a href="https://man.freebsd.org/cgi/man.cgi?query=zpool&amp;sektion=8&amp;format=html">zpool(8)</a> mirrored ZFS file system.
Please note, that the ZFS file system will be configured after the FreeBSD operating system is successfully installed and booted.</p></div><div class=paragraph><p>The following example will describe how to create slices and labels, initialize <a href="https://man.freebsd.org/cgi/man.cgi?query=gmirror&amp;sektion=8&amp;format=html">gmirror(8)</a> on each partition and how to create a UFS2 file system in each mirrored partition:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># fdisk -BI /dev/ad0 </span><i class=conum data-value=1></i><b>(1)</b>
<span class=c># fdisk -BI /dev/ad1</span>
<span class=c># bsdlabel -wB /dev/ad0s1 </span><i class=conum data-value=2></i><b>(2)</b>
<span class=c># bsdlabel -wB /dev/ad1s1</span>
<span class=c># bsdlabel -e /dev/ad0s1 </span><i class=conum data-value=3></i><b>(3)</b>
<span class=c># bsdlabel /dev/ad0s1 &gt; /tmp/bsdlabel.txt &amp;&amp; bsdlabel -R /dev/ad1s1 /tmp/bsdlabel.txt </span><i class=conum data-value=4></i><b>(4)</b>
<span class=c># gmirror label root /dev/ad[01]s1a </span><i class=conum data-value=5></i><b>(5)</b>
<span class=c># gmirror label var /dev/ad[01]s1d</span>
<span class=c># gmirror label usr /dev/ad[01]s1e</span>
<span class=c># gmirror label -F swap /dev/ad[01]s1b </span><i class=conum data-value=6></i><b>(6)</b>
<span class=c># newfs /dev/mirror/root </span><i class=conum data-value=7></i><b>(7)</b>
<span class=c># newfs /dev/mirror/var</span>
<span class=c># newfs /dev/mirror/usr</span></code></pre></div></div><div class="colist arabic"><table><tbody><tr><td><i class=conum data-value=1></i><b>1</b></td><td>Create a slice covering the entire disk and initialize the boot code contained in sector 0 of the given disk. Repeat this command for all hard drives in the system.</td></tr><tr><td><i class=conum data-value=2></i><b>2</b></td><td>Write a standard label for each disk including the bootstrap code.</td></tr><tr><td><i class=conum data-value=3></i><b>3</b></td><td>Now, manually edit the label of the given disk. Refer to the <a href="https://man.freebsd.org/cgi/man.cgi?query=bsdlabel&amp;sektion=8&amp;format=html">bsdlabel(8)</a> manual page to find out how to create partitions. Create partitions <code>a</code> for <span class=filename>/</span> (root) file system, <code>b</code> for swap, <code>d</code> for <span class=filename>/var</span>, <code>e</code> for <span class=filename>/usr</span> and finally <code>f</code> which will later be used for ZFS.</td></tr><tr><td><i class=conum data-value=4></i><b>4</b></td><td>Import the recently created label for the second hard drive, so both hard drives will be labeled in the same way.</td></tr><tr><td><i class=conum data-value=5></i><b>5</b></td><td>Initialize <a href="https://man.freebsd.org/cgi/man.cgi?query=gmirror&amp;sektion=8&amp;format=html">gmirror(8)</a> on each partition.</td></tr><tr><td><i class=conum data-value=6></i><b>6</b></td><td>Note that <code>-F</code> is used for the swap partition. This instructs <a href="https://man.freebsd.org/cgi/man.cgi?query=gmirror&amp;sektion=8&amp;format=html">gmirror(8)</a> to assume that the device is in the consistent state after the power/system failure.</td></tr><tr><td><i class=conum data-value=7></i><b>7</b></td><td>Create a UFS2 file system on each mirrored partition.</td></tr></tbody></table></div></div><div class=sect2><h3 id=_system_installation>4.2. System Installation<a class=anchor href=#_system_installation></a></h3><div class=paragraph><p>This is the most important part.
This section will describe how to actually install the minimal distribution of FreeBSD on the hard drives that we have prepared in the previous section.
To accomplish this goal, all file systems need to be mounted so <code>sysinstall</code> may write the contents of FreeBSD to the hard drives:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># mount /dev/mirror/root /mnt</span>
<span class=c># mkdir /mnt/var /mnt/usr</span>
<span class=c># mount /dev/mirror/var /mnt/var</span>
<span class=c># mount /dev/mirror/usr /mnt/usr</span></code></pre></div></div><div class=paragraph><p>When you are done, start <a href="https://man.freebsd.org/cgi/man.cgi?query=sysinstall&amp;sektion=8&amp;format=html">sysinstall(8)</a>.
Select the <span class=guimenuitem>Custom</span> installation from the main menu.
Select <span class=guimenuitem>Options</span> and press <kbd>Enter</kbd>.
With the help of arrow keys, move the cursor on the <code>Install Root</code> item, press <kbd>Space</kbd> and change it to <span class=filename>/mnt</span>.
Press <kbd>Enter</kbd> to submit your changes and exit the <span class=guimenuitem>Options</span> menu by pressing <kbd>q</kbd>.</p></div><div class="admonitionblock warning"><table><tbody><tr><td class=icon><i class="fa icon-warning" title=Warning></i></td><td class=content><div class=paragraph><p>Note that this step is very important and if skipped, <code>sysinstall</code> will be unable to install FreeBSD.</p></div></td></tr></tbody></table></div><div class=paragraph><p>Go to the <span class=guimenuitem>Distributions</span> menu, move the cursor with the arrow keys to <code>Minimal</code>, and check it by pressing <kbd>Space</kbd>.
This article uses the Minimal distribution to save network traffic, because the system itself will be installed over ftp.
Exit this menu by choosing <code>Exit</code>.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>The <span class=guimenuitem>Partition</span> and <span class=guimenuitem>Label</span> menus will be skipped, as these are useless now.</p></div></td></tr></tbody></table></div><div class=paragraph><p>In the <span class=guimenuitem>Media</span> menu, select <code>FTP</code>.
Select the nearest mirror and let <code>sysinstall</code> assume that the network is already configured.
You will be returned back to the <span class=guimenuitem>Custom</span> menu.</p></div><div class=paragraph><p>Finally, perform the system installation by selecting the last option, <span class=guimenuitem>Commit</span>.
Exit <code>sysinstall</code> when it finishes the installation.</p></div></div><div class=sect2><h3 id=_post_installation_steps>4.3. Post Installation Steps<a class=anchor href=#_post_installation_steps></a></h3><div class=paragraph><p>The FreeBSD operating system should be installed now; however, the process is not finished yet.
It is necessary to perform some post installation steps to allow FreeBSD to boot in the future and to be able to log in to the system.</p></div><div class=paragraph><p>You must now <a href="https://man.freebsd.org/cgi/man.cgi?query=chroot&amp;sektion=8&amp;format=html">chroot(8)</a> into the freshly installed system to finish the installation.
Use the following command:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># chroot /mnt</span></code></pre></div></div><div class=paragraph><p>To complete our goal, perform these steps:</p></div><div class=ulist><ul><li><p>Copy the <code>GENERIC</code> kernel to the <span class=filename>/boot/kernel</span> directory:</p><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># cp -Rp /boot/GENERIC/* /boot/kernel</span></code></pre></div></div></li><li><p>Create the <span class=filename>/etc/rc.conf</span>, <span class=filename>/etc/resolv.conf</span> and <span class=filename>/etc/fstab</span> files. Do not forget to properly set the network information and to enable sshd in <span class=filename>/etc/rc.conf</span>. The contents of <span class=filename>/etc/fstab</span> will be similar to the following:</p><div class="literalblock programlisting"><div class=content><pre># Device                Mountpoint      FStype  Options         Dump    Pass#
/dev/mirror/swap        none            swap    sw              0       0
/dev/mirror/root        /               ufs     rw              1       1
/dev/mirror/usr         /usr            ufs     rw              2       2
/dev/mirror/var         /var            ufs     rw              2       2
/dev/cd0                /cdrom          cd9660  ro,noauto       0       0</pre></div></div></li><li><p>Create <span class=filename>/boot/loader.conf</span> with the following contents:</p><div class="literalblock programlisting"><div class=content><pre>geom_mirror_load=&#34;YES&#34;
zfs_load=&#34;YES&#34;</pre></div></div></li><li><p>Perform the following command, which will make ZFS available on the next boot:</p><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># sysrc zfs_enable=&#34;YES&#34;</span></code></pre></div></div></li><li><p>Add additional users to the system using the <a href="https://man.freebsd.org/cgi/man.cgi?query=adduser&amp;sektion=8&amp;format=html">adduser(8)</a> tool. Do not forget to add a user to the <code>wheel</code> group so you may obtain root access after the reboot.</p></li><li><p>Double-check all your settings.</p></li></ul></div><div class=paragraph><p>The system should now be ready for the next boot.
Use the <a href="https://man.freebsd.org/cgi/man.cgi?query=reboot&amp;sektion=8&amp;format=html">reboot(8)</a> command to reboot your system.</p></div></div></div></div><div class=sect1><h2 id=zfs>5. ZFS<a class=anchor href=#zfs></a></h2><div class=sectionbody><div class=paragraph><p>If your system survived the reboot, it should now be possible to log in.
Welcome to the fresh FreeBSD installation, performed remotely without the use of a remote console!</p></div><div class=paragraph><p>The only remaining step is to configure <a href="https://man.freebsd.org/cgi/man.cgi?query=zpool&amp;sektion=8&amp;format=html">zpool(8)</a> and create some <a href="https://man.freebsd.org/cgi/man.cgi?query=zfs&amp;sektion=8&amp;format=html">zfs(8)</a> file systems.
Creating and administering ZFS is very straightforward. First, create a mirrored pool:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># zpool create tank mirror /dev/ad[01]s1f</span></code></pre></div></div><div class=paragraph><p>Next, create some file systems:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># zfs create tank/ports</span>
<span class=c># zfs create tank/src</span>
<span class=c># zfs set compression=gzip tank/ports</span>
<span class=c># zfs set compression=on tank/src</span>
<span class=c># zfs set mountpoint=/usr/ports tank/ports</span>
<span class=c># zfs set mountpoint=/usr/src tank/src</span></code></pre></div></div><div class=paragraph><p>That is all.
If you are interested in more details about ZFS on FreeBSD, please refer to the <a href=https://wiki.freebsd.org/ZFS>ZFS</a> section of the FreeBSD Wiki.</p></div></div></div><hr><div class=last-modified><p><strong>Last modified on</strong>: September 20, 2024 by <a href="https://cgit.freebsd.org/doc/commit/?id=2d2f5d38cc" target=_blank>Fernando Apesteguía</a></p></div></div><aside class=toc><div class=toc-content><h3>Table of Contents</h3><nav id=TableOfContents><ul><li><a href=#background>1. Background</a></li><li><a href=#intro>2. Introduction</a></li><li><a href=#preparation>3. Preparation - mfsBSD</a></li><li><a href=#installation>4. Installation of the FreeBSD Operating System</a></li><li><a href=#zfs>5. ZFS</a></li></ul></nav><hr><div class=resources><h3>Resources</h3><ul class=contents><li><i class="fa fa-file-pdf-o" aria-hidden=true title="Download PDF"></i><a href=https://download.freebsd.org/doc/en/articles/remote-install/remote-install_en.pdf>Download PDF</a></li><li><i class="fa fa-pencil-square-o" aria-hidden=true title="Edit this page"></i><a href=https://github.com/freebsd/freebsd-doc/blob/main/documentation/content/en/_index target=_blank>Edit this page</a></li></ul></div></div></aside></main><footer><div class=footer-container><section class=logo-column><img src=http://172.16.201.134:1313/images/FreeBSD-colors.svg width=160 height=50 alt="FreeBSD logo"><div class=options-container><div class=language-container><a id=languages href=http://172.16.201.134:1313/en/languages><img src=http://172.16.201.134:1313/images/language.png class=language-image alt="Choose language">
<span>English</span></a></div><div class=theme-container><select id=theme-chooser><option value=theme-system>System</option><option value=theme-light>Light</option><option value=theme-dark>Dark</option><option value=theme-high-contrast>High contrast</option></select></div></div></section><section class=about-column><h3 class=column-title>About</h3><ul class=column-elements-container><li><a href=https://www.freebsd.org/about/ target=_blank class=column-element>FreeBSD</a></li><li><a href=https://freebsdfoundation.org/ target=_blank class=column-element>FreeBSD Foundation</a></li><li><a href=https://www.freebsd.org/where/ target=_blank class=column-element>Get FreeBSD</a></li><li><a href=https://www.freebsd.org/internal/code-of-conduct target=_blank class=column-element>Code of Conduct</a></li><li><a href=https://www.freebsd.org/security/ target=_blank class=column-element>Security Advisories</a></li></ul></section><section class=documentation-column><h3 class=column-title>Documentation</h3><ul class=column-elements-container><li><a href=/en class=column-element>Documentation portal</a></li><li><a href=https://man.FreeBSD.org target=_blank class=column-element>Manual pages</a></li><li><a href=https://papers.FreeBSD.org target=_blank class=column-element>Presentations and papers</a></li><li><a href=https://docs-archive.freebsd.org/doc/ target=_blank class=column-element>Previous versions</a></li><li><a href=https://docs-archive.freebsd.org/44doc/ target=_blank class=column-element>4.4BSD Documents</a></li><li><a href=https://wiki.freebsd.org/ target=_blank class=column-element>Wiki</a></li></ul></section><section class=community-column><h3 class=column-title>Community</h3><ul class=column-elements-container><li><a href=http://172.16.201.134:1313/en/articles/contributing class=column-element>Get involved</a></li><li><a href=https://forums.freebsd.org/ target=_blank class=column-element>Community forum</a></li><li><a href=https://lists.freebsd.org/ target=_blank class=column-element>Mailing lists</a></li><li><a href=https://wiki.freebsd.org/IRC/Channels target=_blank class=column-element>IRC Channels</a></li><li><a href=https://bugs.freebsd.org/bugzilla/ target=_blank class=column-element>Bug Tracker</a></li></ul></section><section class=legal-column><h3 class=column-title>Legal</h3><ul class=column-elements-container><li><a href=https://freebsdfoundation.org/donate/ target=_blank class=column-element>Donations</a></li><li><a href=https://www.freebsd.org/copyright/freebsd-license/ target=_blank class=column-element>Licensing</a></li><li><a href=https://www.freebsd.org/privacy/ target=_blank class=column-element>Privacy Policy</a></li><li><a href=https://www.freebsd.org/copyright/ target=_blank class=column-element>Legal notices</a></li></ul></section><section class=copyright-column><p>&copy; 1994-2024 The FreeBSD Project. All rights reserved</p><span>Made with <span class=heart>♥</span> by the FreeBSD Community</span></section></div></footer></body></html>