<!doctype html><html class=theme-light lang=en><head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="The TrustedBSD MAC Framework"><meta name=keywords content="TrustedBSD,MAC"><meta name=copyright content="1995-2024 The FreeBSD Foundation"><link rel=canonical href=http://172.16.201.134:1313/en/books/arch-handbook/mac/><title>Chapter 6. The TrustedBSD MAC Framework | FreeBSD Documentation Portal</title>
<meta name=theme-color content="#790000"><meta name=color-scheme content="system light dark high-contrast"><link rel="shortcut icon" href=http://172.16.201.134:1313/favicon.ico><link rel=stylesheet href=http://172.16.201.134:1313/styles/main.min.css><link rel=stylesheet href=http://172.16.201.134:1313/css/font-awesome-min.css><script defer src=/js/theme-chooser.min.js></script><script defer src=/js/copy-clipboard.min.js></script><script defer src=/js/search.min.js></script><meta name=twitter:card content="summary"><meta name=twitter:domain content="docs.FreeBSD.org"><meta name=twitter:site content="@freebsd"><meta name=twitter:url content="https://twitter.com/freebsd"><meta property="og:title" content="Chapter 6. The TrustedBSD MAC Framework"><meta property="og:description" content="The TrustedBSD MAC Framework"><meta property="og:type" content="website"><meta property="og:image" content="http://172.16.201.134:1313/favicon.ico"><meta property="og:image:alt" content="FreeBSD Logo"><meta property="og:locale" content="en"><meta property="og:url" content="http://172.16.201.134:1313/en/books/arch-handbook/mac/"><meta property="og:site_name" content="FreeBSD Documentation Portal"><script type=application/ld+json>{"@context":"http://schema.org","@type":"Article","url":"http:\/\/172.16.201.134:1313\/en\/books\/arch-handbook\/mac\/","name":"FreeBSD Documentation Portal","headline":"FreeBSD Documentation Portal","description":"FreeBSD Documentation Portal"}</script></head><body><header><div class=header-container><div class=logo-menu-bars-container><a href=https://www.FreeBSD.org class=logo><img src=http://172.16.201.134:1313/images/FreeBSD-monochromatic.svg width=160 height=50 alt="FreeBSD logo">
</a><label class=menu-bars for=menu-bars><i class="fa fa-bars" aria-hidden=true></i></label></div><input id=menu-bars type=checkbox><nav><ul class=menu><li class=menu-item><input id=about type=checkbox>
<a href=# aria-label="Navigate to About section"><label class=menu-item-description for=about>About
<i class="fa fa-angle-down fa-lg" aria-hidden=true></i></label></a><ul class=sub-menu><li class=title><a href=https://www.freebsd.org/about/ target=_blank>About</a></li><li><a href=https://www.freebsd.org/about/ target=_blank>FreeBSD</a></li><li><a href=https://freebsdfoundation.org/about-us/about-the-foundation/ target=_blank>FreeBSD Foundation</a></li><li><a href=https://www.freebsd.org/internal/code-of-conduct/ target=_blank>Code of Conduct</a></li></ul></li><li class=menu-item><input id=download type=checkbox>
<a href=# aria-label="Navigate to get FreeBSD section"><label class=menu-item-description for=download>Get FreeBSD
<i class="fa fa-angle-down fa-lg" aria-hidden=true></i></label></a><ul class=sub-menu><li class=title><a href=https://www.freebsd.org/where/ target=_blank>Get FreeBSD</a></li><li><a href=https://www.freebsd.org/releases/ target=_blank>Release Information</a></li><li><a href=https://www.freebsd.org/releng/ target=_blank>Release Engineering</a></li><li><a href=https://www.freebsd.org/security/ target=_blank>Security Advisories</a></li></ul></li><li class=menu-item><input id=documentation type=checkbox>
<a href=# aria-label="Navigate to get Documentation section"><label class=menu-item-description for=documentation>Documentation
<i class="fa fa-angle-down fa-lg" aria-hidden=true></i></label></a><ul class=sub-menu><li class=title><a href=/en>Documentation portal</a></li><li><a href=http://172.16.201.134:1313/en/books/handbook>FreeBSD Handbook</a></li><li><a href=http://172.16.201.134:1313/en/books/porters-handbook>Porter's Handbook</a></li><li><a href=https://docs.FreeBSD.org/en/books/fdp-primer>Documentation Project Handbook</a></li><li><a href=https://man.FreeBSD.org target=_blank>Manual pages</a></li><li><a href=https://papers.FreeBSD.org target=_blank>Presentations and papers</a></li><li><a href=https://wiki.FreeBSD.org target=_blank>Wiki</a></li><li><a href=http://172.16.201.134:1313/en/books>Books</a></li><li><a href=http://172.16.201.134:1313/en/articles>Articles</a></li></ul></li><li class=menu-item><input id=community type=checkbox>
<a href=# aria-label="Navigate to get Community section"><label class=menu-item-description for=community>Community
<i class="fa fa-angle-down fa-lg" aria-hidden=true></i></label></a><ul class=sub-menu><li class=title><a href=https://www.freebsd.org/community/>Community</a></li><li><a href=http://172.16.201.134:1313/en/articles/contributing>Get involved</a></li><li><a href=https://forums.freebsd.org/ target=_blank>Forum</a></li><li><a href=https://lists.freebsd.org/ target=_blank>Mailing lists</a></li><li><a href=https://wiki.freebsd.org/IRC/Channels target=_blank>IRC Channels</a></li><li><a href=https://bugs.freebsd.org/bugzilla/ target=_blank>Bug Tracker</a></li><li><a href=https://www.freebsd.org/support/ target=_blank>Support</a></li></ul></li></ul></nav><div class=search-donate-container><form class=search method=get id=search-header-form action=https://docs.freebsd.org/search name=search-header-form><input type=hidden name=DB value=en>
<input id=words name=P type=text size=20 maxlength=255>
<button>
<i class="fa fa-search" aria-hidden=true></i></button></form><div class=donate><a href=https://freebsdfoundation.org/donate/ target=_blank><span class=heart>♥</span>
Donate</a></div></div></div></header><input type=checkbox class="hidden toggle" id=menu-control><main class=main-wrapper-book><a id=top></a><aside class=book-menu><div class=book-menu-content><input id=search-book type=text placeholder=Search aria-label=Search maxlength=128><nav id=MenuContents><ul><li><input type=checkbox id=chapter-6dcd22d99f78db2a9aacae23be13866e class=toggle>
<label for=chapter-6dcd22d99f78db2a9aacae23be13866e><a role=button></a></label><a href=http://172.16.201.134:1313/en/books/arch-handbook/parti/>Part I. Kernel</a></li><li><input type=checkbox id=chapter-9cc61bc35df69063dc03a5911e1ad9c9 class=toggle>
<label class="icon cursor" for=chapter-9cc61bc35df69063dc03a5911e1ad9c9><a role=button></a></label><a href=http://172.16.201.134:1313/en/books/arch-handbook/boot/>Chapter 1. Bootstrapping and Kernel Initialization</a><ul><li><a href=http://172.16.201.134:1313/en/books/arch-handbook/boot/#boot-synopsis>1.1. Synopsis</a></li><li><a href=http://172.16.201.134:1313/en/books/arch-handbook/boot/#boot-overview>1.2. Overview</a></li><li><a href=http://172.16.201.134:1313/en/books/arch-handbook/boot/#boot-bios>1.3. The BIOS</a></li><li><a href=http://172.16.201.134:1313/en/books/arch-handbook/boot/#boot-boot0>1.4. The Master Boot Record (<code>boot0</code>)</a></li><li><a href=http://172.16.201.134:1313/en/books/arch-handbook/boot/#boot-boot1>1.5. <code>boot1</code> Stage</a></li><li><a href=http://172.16.201.134:1313/en/books/arch-handbook/boot/#btx-server>1.6. The BTX Server</a></li><li><a href=http://172.16.201.134:1313/en/books/arch-handbook/boot/#boot2>1.7. boot2 Stage</a></li><li><a href=http://172.16.201.134:1313/en/books/arch-handbook/boot/#boot-loader>1.8. loader Stage</a></li><li><a href=http://172.16.201.134:1313/en/books/arch-handbook/boot/#boot-kernel>1.9. Kernel Initialization</a></li></ul></li><li><input type=checkbox id=chapter-3a651b0a4b9f6238336624d3c0fa5187 class=toggle>
<label class="icon cursor" for=chapter-3a651b0a4b9f6238336624d3c0fa5187><a role=button></a></label><a href=http://172.16.201.134:1313/en/books/arch-handbook/locking/>Chapter 2. Locking Notes</a><ul><li><a href=http://172.16.201.134:1313/en/books/arch-handbook/locking/#locking-mutexes>2.1. Mutexes</a></li><li><a href=http://172.16.201.134:1313/en/books/arch-handbook/locking/#locking-sx>2.2. Shared Exclusive Locks</a></li><li><a href=http://172.16.201.134:1313/en/books/arch-handbook/locking/#locking-atomic>2.3. Atomically Protected Variables</a></li></ul></li><li><input type=checkbox id=chapter-bf0b823c107a80f3035dfd6fae09d023 class=toggle>
<label class="icon cursor" for=chapter-bf0b823c107a80f3035dfd6fae09d023><a role=button></a></label><a href=http://172.16.201.134:1313/en/books/arch-handbook/kobj/>Chapter 3. Kernel Objects</a><ul><li><a href=http://172.16.201.134:1313/en/books/arch-handbook/kobj/#kernel-objects-term>3.1. Terminology</a></li><li><a href=http://172.16.201.134:1313/en/books/arch-handbook/kobj/#kernel-objects-operation>3.2. Kobj Operation</a></li><li><a href=http://172.16.201.134:1313/en/books/arch-handbook/kobj/#kernel-objects-using>3.3. Using Kobj</a></li></ul></li><li><input type=checkbox id=chapter-41dab1afed6cf3ffa54628db4227e196 class=toggle>
<label class="icon cursor" for=chapter-41dab1afed6cf3ffa54628db4227e196><a role=button></a></label><a href=http://172.16.201.134:1313/en/books/arch-handbook/jail/>Chapter 4. The Jail Subsystem</a><ul><li><a href=http://172.16.201.134:1313/en/books/arch-handbook/jail/#jail-arch>4.1. Architecture</a></li><li><a href=http://172.16.201.134:1313/en/books/arch-handbook/jail/#jail-restrictions>4.2. Restrictions</a></li></ul></li><li><input type=checkbox id=chapter-e7d9ebcb448b0045179ebe22f8e2e9d8 class=toggle>
<label class="icon cursor" for=chapter-e7d9ebcb448b0045179ebe22f8e2e9d8><a role=button></a></label><a href=http://172.16.201.134:1313/en/books/arch-handbook/sysinit/>Chapter 5. The SYSINIT Framework</a><ul><li><a href=http://172.16.201.134:1313/en/books/arch-handbook/sysinit/#sysinit-term>5.1. Terminology</a></li><li><a href=http://172.16.201.134:1313/en/books/arch-handbook/sysinit/#sysinit-operation>5.2. SYSINIT Operation</a></li><li><a href=http://172.16.201.134:1313/en/books/arch-handbook/sysinit/#sysinit-using>5.3. Using SYSINIT</a></li></ul></li><li><input type=checkbox id=chapter-8b57b16ba53538421a8fb2152b25976f class=toggle checked>
<label class="icon cursor" for=chapter-8b57b16ba53538421a8fb2152b25976f><a role=button></a></label><a href=http://172.16.201.134:1313/en/books/arch-handbook/mac/>Chapter 6. The TrustedBSD MAC Framework</a><ul><li><a href=http://172.16.201.134:1313/en/books/arch-handbook/mac/#mac-copyright>6.1. MAC Documentation Copyright</a></li><li><a href=http://172.16.201.134:1313/en/books/arch-handbook/mac/#mac-synopsis>6.2. Synopsis</a></li><li><a href=http://172.16.201.134:1313/en/books/arch-handbook/mac/#mac-introduction>6.3. Introduction</a></li><li><a href=http://172.16.201.134:1313/en/books/arch-handbook/mac/#mac-background>6.4. Policy Background</a></li><li><a href=http://172.16.201.134:1313/en/books/arch-handbook/mac/#mac-framework-kernel-arch>6.5. MAC Framework Kernel Architecture</a></li><li><a href=http://172.16.201.134:1313/en/books/arch-handbook/mac/#mac-policy-architecture>6.6. MAC Policy Architecture</a></li><li><a href=http://172.16.201.134:1313/en/books/arch-handbook/mac/#mac-entry-point-reference>6.7. MAC Policy Entry Point Reference</a></li><li><a href=http://172.16.201.134:1313/en/books/arch-handbook/mac/#mac-userland-arch>6.8. Userland Architecture</a></li><li><a href=http://172.16.201.134:1313/en/books/arch-handbook/mac/#mac-conclusion>6.9. Conclusion</a></li></ul></li><li><input type=checkbox id=chapter-28609916419208e3a19d240cf7593906 class=toggle>
<label class="icon cursor" for=chapter-28609916419208e3a19d240cf7593906><a role=button></a></label><a href=http://172.16.201.134:1313/en/books/arch-handbook/vm/>Chapter 7. Virtual Memory System</a><ul><li><a href=http://172.16.201.134:1313/en/books/arch-handbook/vm/#vm-physmem>7.1. Management of Physical Memory <code>vm_page_t</code></a></li><li><a href=http://172.16.201.134:1313/en/books/arch-handbook/vm/#vm-cache>7.2. The Unified Buffer Cache <code>vm_object_t</code></a></li><li><a href=http://172.16.201.134:1313/en/books/arch-handbook/vm/#vm-fileio>7.3. Filesystem I/O <code>struct buf</code></a></li><li><a href=http://172.16.201.134:1313/en/books/arch-handbook/vm/#vm-pagetables>7.4. Mapping Page Tables <code>vm_map_t, vm_entry_t</code></a></li><li><a href=http://172.16.201.134:1313/en/books/arch-handbook/vm/#vm-kvm>7.5. KVM Memory Mapping</a></li><li><a href=http://172.16.201.134:1313/en/books/arch-handbook/vm/#vm-tuning>7.6. Tuning the FreeBSD VM System</a></li></ul></li><li><input type=checkbox id=chapter-716edd44e8ad22ea57cdf273d2578872 class=toggle>
<label class="icon cursor" for=chapter-716edd44e8ad22ea57cdf273d2578872><a role=button></a></label><a href=http://172.16.201.134:1313/en/books/arch-handbook/smp/>Chapter 8. SMPng Design Document</a><ul><li><a href=http://172.16.201.134:1313/en/books/arch-handbook/smp/#smp-intro>8.1. Introduction</a></li><li><a href=http://172.16.201.134:1313/en/books/arch-handbook/smp/#smp-lock-fundamentals>8.2. Basic Tools and Locking Fundamentals</a></li><li><a href=http://172.16.201.134:1313/en/books/arch-handbook/smp/#smp-design>8.3. General Architecture and Design</a></li><li><a href=http://172.16.201.134:1313/en/books/arch-handbook/smp/#smp-lock-strategies>8.4. Specific Locking Strategies</a></li><li><a href=http://172.16.201.134:1313/en/books/arch-handbook/smp/#smp-implementation-notes>8.5. Implementation Notes</a></li><li><a href=http://172.16.201.134:1313/en/books/arch-handbook/smp/#smp-misc>8.6. Miscellaneous Topics</a></li><li><a href=http://172.16.201.134:1313/en/books/arch-handbook/smp/#smp-glossary>Glossary</a></li></ul></li><li><input type=checkbox id=chapter-448f803e40f97b1ff8336db9ba637745 class=toggle>
<label for=chapter-448f803e40f97b1ff8336db9ba637745><a role=button></a></label><a href=http://172.16.201.134:1313/en/books/arch-handbook/partii/>Part II. Device Drivers</a></li><li><input type=checkbox id=chapter-6971d35b0bbe2a0bdb005a02546cd580 class=toggle>
<label class="icon cursor" for=chapter-6971d35b0bbe2a0bdb005a02546cd580><a role=button></a></label><a href=http://172.16.201.134:1313/en/books/arch-handbook/driverbasics/>Chapter 9. Writing FreeBSD Device Drivers</a><ul><li><a href=http://172.16.201.134:1313/en/books/arch-handbook/driverbasics/#driverbasics-intro>9.1. Introduction</a></li><li><a href=http://172.16.201.134:1313/en/books/arch-handbook/driverbasics/#driverbasics-kld>9.2. Dynamic Kernel Linker Facility - KLD</a></li><li><a href=http://172.16.201.134:1313/en/books/arch-handbook/driverbasics/#driverbasics-char>9.3. Character Devices</a></li><li><a href=http://172.16.201.134:1313/en/books/arch-handbook/driverbasics/#driverbasics-block>9.4. Block Devices (Are Gone)</a></li><li><a href=http://172.16.201.134:1313/en/books/arch-handbook/driverbasics/#driverbasics-net>9.5. Network Drivers</a></li></ul></li><li><input type=checkbox id=chapter-9cc7968be065b256e57086439d93e9a4 class=toggle>
<label class="icon cursor" for=chapter-9cc7968be065b256e57086439d93e9a4><a role=button></a></label><a href=http://172.16.201.134:1313/en/books/arch-handbook/isa/>Chapter 10. ISA Device Drivers</a><ul><li><a href=http://172.16.201.134:1313/en/books/arch-handbook/isa/#isa-driver-synopsis>10.1. Synopsis</a></li><li><a href=http://172.16.201.134:1313/en/books/arch-handbook/isa/#isa-driver-basics>10.2. Basic Information</a></li><li><a href=http://172.16.201.134:1313/en/books/arch-handbook/isa/#isa-driver-device-t>10.3. <code>device_t</code> Pointer</a></li><li><a href=http://172.16.201.134:1313/en/books/arch-handbook/isa/#isa-driver-config>10.4. Configuration File and the Order of Identifying and Probing During Auto-Configuration</a></li><li><a href=http://172.16.201.134:1313/en/books/arch-handbook/isa/#isa-driver-resources>10.5. Resources</a></li><li><a href=http://172.16.201.134:1313/en/books/arch-handbook/isa/#isa-driver-busmem>10.6. Bus Memory Mapping</a></li><li><a href=http://172.16.201.134:1313/en/books/arch-handbook/isa/#isa-driver-dma>10.7. DMA</a></li><li><a href=http://172.16.201.134:1313/en/books/arch-handbook/isa/#isa-driver-probe>10.8. xxx_isa_probe</a></li><li><a href=http://172.16.201.134:1313/en/books/arch-handbook/isa/#isa-driver-attach>10.9. xxx_isa_attach</a></li><li><a href=http://172.16.201.134:1313/en/books/arch-handbook/isa/#isa-driver-detach>10.10. xxx_isa_detach</a></li><li><a href=http://172.16.201.134:1313/en/books/arch-handbook/isa/#isa-driver-shutdown>10.11. xxx_isa_shutdown</a></li><li><a href=http://172.16.201.134:1313/en/books/arch-handbook/isa/#isa-driver-intr>10.12. xxx_intr</a></li></ul></li><li><input type=checkbox id=chapter-0b427d421e89aa3107f62d5b70f6a0f2 class=toggle>
<label class="icon cursor" for=chapter-0b427d421e89aa3107f62d5b70f6a0f2><a role=button></a></label><a href=http://172.16.201.134:1313/en/books/arch-handbook/pci/>Chapter 11. PCI Devices</a><ul><li><a href=http://172.16.201.134:1313/en/books/arch-handbook/pci/#pci-probe>11.1. Probe and Attach</a></li><li><a href=http://172.16.201.134:1313/en/books/arch-handbook/pci/#pci-bus>11.2. Bus Resources</a></li></ul></li><li><input type=checkbox id=chapter-0b7eb8d45a0ea6bc9c2882e903b93959 class=toggle>
<label class="icon cursor" for=chapter-0b7eb8d45a0ea6bc9c2882e903b93959><a role=button></a></label><a href=http://172.16.201.134:1313/en/books/arch-handbook/scsi/>Chapter 12. Common Access Method SCSI Controllers</a><ul><li><a href=http://172.16.201.134:1313/en/books/arch-handbook/scsi/#scsi-synopsis>12.1. Synopsis</a></li><li><a href=http://172.16.201.134:1313/en/books/arch-handbook/scsi/#scsi-general>12.2. General Architecture</a></li><li><a href=http://172.16.201.134:1313/en/books/arch-handbook/scsi/#_globals_and_boilerplate>12.3. Globals and Boilerplate</a></li><li><a href=http://172.16.201.134:1313/en/books/arch-handbook/scsi/#_device_configuration_xxx_attach>12.4. Device configuration: xxx_attach</a></li><li><a href=http://172.16.201.134:1313/en/books/arch-handbook/scsi/#_processing_cam_messages_xxx_action>12.5. Processing CAM messages: xxx_action</a></li><li><a href=http://172.16.201.134:1313/en/books/arch-handbook/scsi/#scsi-polling>12.6. Polling xxx_poll</a></li><li><a href=http://172.16.201.134:1313/en/books/arch-handbook/scsi/#scsi-async>12.7. Asynchronous Events</a></li><li><a href=http://172.16.201.134:1313/en/books/arch-handbook/scsi/#scsi-interrupts>12.8. Interrupts</a></li><li><a href=http://172.16.201.134:1313/en/books/arch-handbook/scsi/#scsi-errors>12.9. Errors Summary</a></li><li><a href=http://172.16.201.134:1313/en/books/arch-handbook/scsi/#scsi-timeout>12.10. Timeout Handling</a></li></ul></li><li><input type=checkbox id=chapter-bdaa4909dfbdcec8d7be976fd87cb00e class=toggle>
<label class="icon cursor" for=chapter-bdaa4909dfbdcec8d7be976fd87cb00e><a role=button></a></label><a href=http://172.16.201.134:1313/en/books/arch-handbook/usb/>Chapter 13. USB Devices</a><ul><li><a href=http://172.16.201.134:1313/en/books/arch-handbook/usb/#usb-intro>13.1. Introduction</a></li><li><a href=http://172.16.201.134:1313/en/books/arch-handbook/usb/#usb-hc>13.2. Host Controllers</a></li><li><a href=http://172.16.201.134:1313/en/books/arch-handbook/usb/#usb-dev>13.3. USB Device Information</a></li><li><a href=http://172.16.201.134:1313/en/books/arch-handbook/usb/#usb-devprobe>13.4. Device Probe and Attach</a></li><li><a href=http://172.16.201.134:1313/en/books/arch-handbook/usb/#usb-protocol>13.5. USB Drivers Protocol Information</a></li></ul></li><li><input type=checkbox id=chapter-5fc5c179f5014d968a5c8feec7e10e59 class=toggle>
<label class="icon cursor" for=chapter-5fc5c179f5014d968a5c8feec7e10e59><a role=button></a></label><a href=http://172.16.201.134:1313/en/books/arch-handbook/newbus/>Chapter 14. Newbus</a><ul><li><a href=http://172.16.201.134:1313/en/books/arch-handbook/newbus/#newbus-devdrivers>14.1. Device Drivers</a></li><li><a href=http://172.16.201.134:1313/en/books/arch-handbook/newbus/#newbus-overview>14.2. Overview of Newbus</a></li><li><a href=http://172.16.201.134:1313/en/books/arch-handbook/newbus/#newbus-api>14.3. Newbus API</a></li></ul></li><li><input type=checkbox id=chapter-7d3796cced00105c77e7f87e84edd73b class=toggle>
<label class="icon cursor" for=chapter-7d3796cced00105c77e7f87e84edd73b><a role=button></a></label><a href=http://172.16.201.134:1313/en/books/arch-handbook/sound/>Chapter 15. Sound Subsystem</a><ul><li><a href=http://172.16.201.134:1313/en/books/arch-handbook/sound/#oss-intro>15.1. Introduction</a></li><li><a href=http://172.16.201.134:1313/en/books/arch-handbook/sound/#oss-files>15.2. Files</a></li><li><a href=http://172.16.201.134:1313/en/books/arch-handbook/sound/#pcm-probe-and-attach>15.3. Probing, Attaching, etc.</a></li><li><a href=http://172.16.201.134:1313/en/books/arch-handbook/sound/#oss-interfaces>15.4. Interfaces</a></li></ul></li><li><input type=checkbox id=chapter-41c74c3e72fcf5116f6d999c36ef185b class=toggle>
<label class="icon cursor" for=chapter-41c74c3e72fcf5116f6d999c36ef185b><a role=button></a></label><a href=http://172.16.201.134:1313/en/books/arch-handbook/pccard/>Chapter 16. PC Card</a><ul><li><a href=http://172.16.201.134:1313/en/books/arch-handbook/pccard/#pccard-adddev>16.1. Adding a Device</a></li></ul></li><li><input type=checkbox id=chapter-2a7cf37011599a8e3d62d1e3008c3c5d class=toggle>
<label for=chapter-2a7cf37011599a8e3d62d1e3008c3c5d><a role=button></a></label><a href=http://172.16.201.134:1313/en/books/arch-handbook/partiii/>Part III. Appendices</a></li><li><input type=checkbox id=chapter-d4c82056f0235da9fde0d29203d44f9a class=toggle>
<label for=chapter-d4c82056f0235da9fde0d29203d44f9a><a role=button></a></label><a href=http://172.16.201.134:1313/en/books/arch-handbook/bibliography/>Bibliography</a></li><li></li></ul></nav></div></aside><div class=book><div class=book-menu-mobile><label for=menu-control><span class=menu-control-button><i class="fa fa-list" aria-hidden=true title="Book menu"></i>
Book menu</span></label></div><h1 class=title>Chapter 6. The TrustedBSD MAC Framework</h1><div class=toc-mobile><h3>Table of Contents</h3><nav id=TableOfContents><ul><li><a href=#mac-copyright>6.1. MAC Documentation Copyright</a></li><li><a href=#mac-synopsis>6.2. Synopsis</a></li><li><a href=#mac-introduction>6.3. Introduction</a></li><li><a href=#mac-background>6.4. Policy Background</a></li><li><a href=#mac-framework-kernel-arch>6.5. MAC Framework Kernel Architecture</a></li><li><a href=#mac-policy-architecture>6.6. MAC Policy Architecture</a></li><li><a href=#mac-entry-point-reference>6.7. MAC Policy Entry Point Reference</a></li><li><a href=#mac-userland-arch>6.8. Userland Architecture</a></li><li><a href=#mac-conclusion>6.9. Conclusion</a></li></ul></nav></div><div class=book-content><div id=preamble><div class=sectionbody></div></div><div class=sect1><h2 id=mac-copyright>6.1. MAC Documentation Copyright<a class=anchor href=#mac-copyright></a></h2><div class=sectionbody><div class=paragraph><p>This documentation was developed for the FreeBSD Project by Chris Costello at Safeport Network Services and Network Associates Laboratories, the Security Research Division of Network Associates, Inc. under DARPA/SPAWAR contract N66001-01-C-8035 ("CBOSS"), as part of the DARPA CHATS research program.</p></div><div class=paragraph><p>Redistribution and use in source (SGML DocBook) and 'compiled' forms (SGML, HTML, PDF, PostScript, RTF and so forth) with or without modification, are permitted provided that the following conditions are met:</p></div><div class="olist arabic"><ol class=arabic><li><p>Redistributions of source code (SGML DocBook) must retain the above copyright notice, this list of conditions and the following disclaimer as the first lines of this file unmodified.</p></li><li><p>Redistributions in compiled form (transformed to other DTDs, converted to PDF, PostScript, RTF and other formats) must reproduce the above copyright notice, this list of conditions and the following disclaimer in the documentation and/or other materials provided with the distribution.</p></li></ol></div><div class="admonitionblock important"><table><tbody><tr><td class=icon><i class="fa icon-important" title=Important></i></td><td class=content><div class=paragraph><p>THIS DOCUMENTATION IS PROVIDED BY THE NETWORKS ASSOCIATES TECHNOLOGY, INC "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.
IN NO EVENT SHALL NETWORKS ASSOCIATES TECHNOLOGY, INC BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS DOCUMENTATION, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.</p></div></td></tr></tbody></table></div></div></div><div class=sect1><h2 id=mac-synopsis>6.2. Synopsis<a class=anchor href=#mac-synopsis></a></h2><div class=sectionbody><div class=paragraph><p>FreeBSD includes experimental support for several mandatory access control policies, as well as a framework for kernel security extensibility, the TrustedBSD MAC Framework.
The MAC Framework is a pluggable access control framework, permitting new security policies to be easily linked into the kernel, loaded at boot, or loaded dynamically at run-time.
The framework provides a variety of features to make it easier to implement new security policies, including the ability to easily tag security labels (such as confidentiality information) onto system objects.</p></div><div class=paragraph><p>This chapter introduces the MAC policy framework and provides documentation for a sample MAC policy module.</p></div></div></div><div class=sect1><h2 id=mac-introduction>6.3. Introduction<a class=anchor href=#mac-introduction></a></h2><div class=sectionbody><div class=paragraph><p>The TrustedBSD MAC framework provides a mechanism to allow the compile-time or run-time extension of the kernel access control model.
New system policies may be implemented as kernel modules and linked to the kernel; if multiple policy modules are present, their results will be composed.
The MAC Framework provides a variety of access control infrastructure services to assist policy writers, including support for transient and persistent policy-agnostic object security labels.
This support is currently considered experimental.</p></div><div class=paragraph><p>This chapter provides information appropriate for developers of policy modules, as well as potential consumers of MAC-enabled environments, to learn about how the MAC Framework supports access control extension of the kernel.</p></div></div></div><div class=sect1><h2 id=mac-background>6.4. Policy Background<a class=anchor href=#mac-background></a></h2><div class=sectionbody><div class=paragraph><p>Mandatory Access Control (MAC), refers to a set of access control policies that are mandatorily enforced on users by the operating system.
MAC policies may be contrasted with Discretionary Access Control (DAC) protections, by which non-administrative users may (at their discretion) protect objects.
In traditional UNIX systems, DAC protections include file permissions and access control lists; MAC protections include process controls preventing inter-user debugging and firewalls.
A variety of MAC policies have been formulated by operating system designers and security researches, including the Multi-Level Security (MLS) confidentiality policy, the Biba integrity policy, Role-Based Access Control (RBAC), Domain and Type Enforcement (DTE), and Type Enforcement (TE).
Each model bases decisions on a variety of factors, including user identity, role, and security clearance, as well as security labels on objects representing concepts such as data sensitivity and integrity.</p></div><div class=paragraph><p>The TrustedBSD MAC Framework is capable of supporting policy modules that implement all of these policies, as well as a broad class of system hardening policies, which may use existing security attributes, such as user and group IDs, as well as extended attributes on files, and other system properties.
In addition, despite the name, the MAC Framework can also be used to implement purely discretionary policies, as policy modules are given substantial flexibility in how they authorize protections.</p></div></div></div><div class=sect1><h2 id=mac-framework-kernel-arch>6.5. MAC Framework Kernel Architecture<a class=anchor href=#mac-framework-kernel-arch></a></h2><div class=sectionbody><div class=paragraph><p>The TrustedBSD MAC Framework permits kernel modules to extend the operating system security policy, as well as providing infrastructure functionality required by many access control modules.
If multiple policies are simultaneously loaded, the MAC Framework will usefully (for some definition of useful) compose the results of the policies.</p></div><div class=sect2><h3 id=mac-framework-kernel-arch-elements>6.5.1. Kernel Elements<a class=anchor href=#mac-framework-kernel-arch-elements></a></h3><div class=paragraph><p>The MAC Framework contains a number of kernel elements:</p></div><div class=ulist><ul><li><p>Framework management interfaces</p></li><li><p>Concurrency and synchronization primitives.</p></li><li><p>Policy registration</p></li><li><p>Extensible security label for kernel objects</p></li><li><p>Policy entry point composition operators</p></li><li><p>Label management primitives</p></li><li><p>Entry point API invoked by kernel services</p></li><li><p>Entry point API to policy modules</p></li><li><p>Entry points implementations (policy life cycle, object life cycle/label management, access control checks).</p></li><li><p>Policy-agnostic label-management system calls</p></li><li><p><code>mac_syscall()</code> multiplex system call</p></li><li><p>Various security policies implemented as MAC policy modules</p></li></ul></div></div><div class=sect2><h3 id=mac-framework-kernel-arch-management>6.5.2. Framework Management Interfaces<a class=anchor href=#mac-framework-kernel-arch-management></a></h3><div class=paragraph><p>The TrustedBSD MAC Framework may be directly managed using sysctl’s, loader tunables, and system calls.</p></div><div class=paragraph><p>In most cases, sysctl’s and loader tunables of the same name modify the same parameters, and control behavior such as enforcement of protections relating to various kernel subsystems.
In addition, if MAC debugging support is compiled into the kernel, several counters will be maintained tracking label allocation.
It is generally advisable that per-subsystem enforcement controls not be used to control policy behavior in production environments, as they broadly impact the operation of all active policies.
Instead, per-policy controls should be preferred, as they provide greater granularity and greater operational consistency for policy modules.</p></div><div class=paragraph><p>Loading and unloading of policy modules is performed using the system module management system calls and other system interfaces, including boot loader variables; policy modules will have the opportunity to influence load and unload events, including preventing undesired unloading of the policy.</p></div></div><div class=sect2><h3 id=mac-framework-kernel-arch-synchronization>6.5.3. Policy List Concurrency and Synchronization<a class=anchor href=#mac-framework-kernel-arch-synchronization></a></h3><div class=paragraph><p>As the set of active policies may change at run-time, and the invocation of entry points is non-atomic, synchronization is required to prevent loading or unloading of policies while an entry point invocation is in progress, freezing the set of active policies for the duration.
This is accomplished by means of a framework busy count: whenever an entry point is entered, the busy count is incremented; whenever it is exited, the busy count is decremented.
While the busy count is elevated, policy list changes are not permitted, and threads attempting to modify the policy list will sleep until the list is not busy.
The busy count is protected by a mutex, and a condition variable is used to wake up sleepers waiting on policy list modifications.
One side effect of this synchronization model is that recursion into the MAC Framework from within a policy module is permitted, although not generally used.</p></div><div class=paragraph><p>Various optimizations are used to reduce the overhead of the busy count, including avoiding the full cost of incrementing and decrementing if the list is empty or contains only static entries (policies that are loaded before the system starts, and cannot be unloaded).
A compile-time option is also provided which prevents any change in the set of loaded policies at run-time, which eliminates the mutex locking costs associated with supporting dynamically loaded and unloaded policies as synchronization is no longer required.</p></div><div class=paragraph><p>As the MAC Framework is not permitted to block in some entry points, a normal sleep lock cannot be used; as a result, it is possible for the load or unload attempt to block for a substantial period of time waiting for the framework to become idle.</p></div></div><div class=sect2><h3 id=mac-framework-kernel-arch-label-synchronization>6.5.4. Label Synchronization<a class=anchor href=#mac-framework-kernel-arch-label-synchronization></a></h3><div class=paragraph><p>As kernel objects of interest may generally be accessed from more than one thread at a time, and simultaneous entry of more than one thread into the MAC Framework is permitted, security attribute storage maintained by the MAC Framework is carefully synchronized.
In general, existing kernel synchronization on kernel object data is used to protect MAC Framework security labels on the object: for example, MAC labels on sockets are protected using the existing socket mutex.
Likewise, semantics for concurrent access are generally identical to those of the container objects: for credentials, copy-on-write semantics are maintained for label contents as with the remainder of the credential structure.
The MAC Framework asserts necessary locks on objects when invoked with an object reference.
Policy authors must be aware of these synchronization semantics, as they will sometimes limit the types of accesses permitted on labels: for example, when a read-only reference to a credential is passed to a policy via an entry point, only read operations are permitted on the label state attached to the credential.</p></div></div><div class=sect2><h3 id=mac-framework-kernel-arch-policy-synchronization>6.5.5. Policy Synchronization and Concurrency<a class=anchor href=#mac-framework-kernel-arch-policy-synchronization></a></h3><div class=paragraph><p>Policy modules must be written to assume that many kernel threads may simultaneously enter one more policy entry points due to the parallel and preemptive nature of the FreeBSD kernel.
If the policy module makes use of mutable state, this may require the use of synchronization primitives within the policy to prevent inconsistent views on that state resulting in incorrect operation of the policy.
Policies will generally be able to make use of existing FreeBSD synchronization primitives for this purpose, including mutexes, sleep locks, condition variables, and counting semaphores.
However, policies should be written to employ these primitives carefully, respecting existing kernel lock orders, and recognizing that some entry points are not permitted to sleep, limiting the use of primitives in those entry points to mutexes and wakeup operations.</p></div><div class=paragraph><p>When policy modules call out to other kernel subsystems, they will generally need to release any in-policy locks in order to avoid violating the kernel lock order or risking lock recursion.
This will maintain policy locks as leaf locks in the global lock order, helping to avoid deadlock.</p></div></div><div class=sect2><h3 id=mac-framework-kernel-arch-registration>6.5.6. Policy Registration<a class=anchor href=#mac-framework-kernel-arch-registration></a></h3><div class=paragraph><p>The MAC Framework maintains two lists of active policies: a static list, and a dynamic list.
The lists differ only with regards to their locking semantics: an elevated reference count is not required to make use of the static list.
When kernel modules containing MAC Framework policies are loaded, the policy module will use <code>SYSINIT</code> to invoke a registration function; when a policy module is unloaded, <code>SYSINIT</code> will likewise invoke a de-registration function.
Registration may fail if a policy module is loaded more than once, if insufficient resources are available for the registration (for example, the policy might require labeling and insufficient labeling state might be available), or other policy prerequisites might not be met (some policies may only be loaded prior to boot).
Likewise, de-registration may fail if a policy is flagged as not unloadable.</p></div></div><div class=sect2><h3 id=mac-framework-kernel-arch-entrypoints>6.5.7. Entry Points<a class=anchor href=#mac-framework-kernel-arch-entrypoints></a></h3><div class=paragraph><p>Kernel services interact with the MAC Framework in two ways: they invoke a series of APIs to notify the framework of relevant events, and they provide a policy-agnostic label structure pointer in security-relevant objects.
The label pointer is maintained by the MAC Framework via label management entry points, and permits the Framework to offer a labeling service to policy modules through relatively non-invasive changes to the kernel subsystem maintaining the object.
For example, label pointers have been added to processes, process credentials, sockets, pipes, vnodes, Mbufs, network interfaces, IP reassembly queues, and a variety of other security-relevant structures.
Kernel services also invoke the MAC Framework when they perform important security decisions, permitting policy modules to augment those decisions based on their own criteria (possibly including data stored in security labels).
Most of these security critical decisions will be explicit access control checks; however, some affect more general decision functions such as packet matching for sockets and label transition at program execution.</p></div></div><div class=sect2><h3 id=mac-framework-kernel-arch-composition>6.5.8. Policy Composition<a class=anchor href=#mac-framework-kernel-arch-composition></a></h3><div class=paragraph><p>When more than one policy module is loaded into the kernel at a time, the results of the policy modules will be composed by the framework using a composition operator.
This operator is currently hard-coded, and requires that all active policies must approve a request for it to return success.
As policies may return a variety of error conditions (success, access denied, object does not exist, …​), a precedence operator selects the resulting error from the set of errors returned by policies.
In general, errors indicating that an object does not exist will be preferred to errors indicating that access to an object is denied.
While it is not guaranteed that the resulting composition will be useful or secure, we have found that it is for many useful selections of policies.
For example, traditional trusted systems often ship with two or more policies using a similar composition.</p></div></div><div class=sect2><h3 id=mac-framework-kernel-arch-labels>6.5.9. Labeling Support<a class=anchor href=#mac-framework-kernel-arch-labels></a></h3><div class=paragraph><p>As many interesting access control extensions rely on security labels on objects, the MAC Framework provides a set of policy-agnostic label management system calls covering a variety of user-exposed objects.
Common label types include partition identifiers, sensitivity labels, integrity labels, compartments, domains, roles, and types.
By policy agnostic, we mean that policy modules are able to completely define the semantics of meta-data associated with an object.
Policy modules participate in the internalization and externalization of string-based labels provides by user applications, and can expose multiple label elements to applications if desired.</p></div><div class=paragraph><p>In-memory labels are stored in slab-allocated <code>struct label</code>, which consists of a fixed-length array of unions, each holding a <code>void *</code> pointer and a <code>long</code>.
Policies registering for label storage will be assigned a "slot" identifier, which may be used to dereference the label storage.
The semantics of the storage are left entirely up to the policy module: modules are provided with a variety of entry points associated with the kernel object life cycle, including initialization, association/creation, and destruction.
Using these interfaces, it is possible to implement reference counting and other storage models.
Direct access to the object structure is generally not required by policy modules to retrieve a label, as the MAC Framework generally passes both a pointer to the object and a direct pointer to the object’s label into entry points.
The primary exception to this rule is the process credential, which must be manually dereferenced to access the credential label.
This may change in future revisions of the MAC Framework.</p></div><div class=paragraph><p>Initialization entry points frequently include a sleeping disposition flag indicating whether or not an initialization is permitted to sleep; if sleeping is not permitted, a failure may be returned to cancel allocation of the label (and hence object).
This may occur, for example, in the network stack during interrupt handling, where sleeping is not permitted, or while the caller holds a mutex.
Due to the performance cost of maintaining labels on in-flight network packets (Mbufs), policies must specifically declare a requirement that Mbuf labels be allocated.
Dynamically loaded policies making use of labels must be able to handle the case where their init function has not been called on an object, as objects may already exist when the policy is loaded.
The MAC Framework guarantees that uninitialized label slots will hold a 0 or NULL value, which policies may use to detect uninitialized values.
However, as allocation of Mbuf labels is conditional, policies must also be able to handle a NULL label pointer for Mbufs if they have been loaded dynamically.</p></div><div class=paragraph><p>In the case of file system labels, special support is provided for the persistent storage of security labels in extended attributes.
Where available, extended attribute transactions are used to permit consistent compound updates of security labels on vnodes—​currently this support is present only in the UFS2 file system.
Policy authors may choose to implement multilabel file system object labels using one (or more) extended attributes.
For efficiency reasons, the vnode label (<code>v_label</code>) is a cache of any on-disk label; policies are able to load values into the cache when the vnode is instantiated, and update the cache as needed.
As a result, the extended attribute need not be directly accessed with every access control check.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Currently, if a labeled policy permits dynamic unloading, its state slot cannot be reclaimed, which places a strict (and relatively low) bound on the number of unload-reload operations for labeled policies.</p></div></td></tr></tbody></table></div></div><div class=sect2><h3 id=mac-framework-kernel-arch-syscalls>6.5.10. System Calls<a class=anchor href=#mac-framework-kernel-arch-syscalls></a></h3><div class=paragraph><p>The MAC Framework implements a number of system calls: most of these calls support the policy-agnostic label retrieval and manipulation APIs exposed to user applications.</p></div><div class=paragraph><p>The label management calls accept a label description structure, <code>struct mac</code>, which contains a series of MAC label elements.
Each element contains a character string name, and character string value.
Each policy will be given the chance to claim a particular element name, permitting policies to expose multiple independent elements if desired.
Policy modules perform the internalization and externalization between kernel labels and user-provided labels via entry points, permitting a variety of semantics.
Label management system calls are generally wrapped by user library functions to perform memory allocation and error handling, simplifying user applications that must manage labels.</p></div><div class=paragraph><p>The following MAC-related system calls are present in the FreeBSD kernel:</p></div><div class=ulist><ul><li><p><code>mac_get_proc()</code> may be used to retrieve the label of the current process.</p></li><li><p><code>mac_set_proc()</code> may be used to request a change in the label of the current process.</p></li><li><p><code>mac_get_fd()</code> may be used to retrieve the label of an object (file, socket, pipe, …​) referenced by a file descriptor.</p></li><li><p><code>mac_get_file()</code> may be used to retrieve the label of an object referenced by a file system path.</p></li><li><p><code>mac_set_fd()</code> may be used to request a change in the label of an object (file, socket, pipe, …​) referenced by a file descriptor.</p></li><li><p><code>mac_set_file()</code> may be used to request a change in the label of an object referenced by a file system path.</p></li><li><p><code>mac_syscall()</code> permits policy modules to create new system calls without modifying the system call table; it accepts a target policy name, operation number, and opaque argument for use by the policy.</p></li><li><p><code>mac_get_pid()</code> may be used to request the label of another process by process id.</p></li><li><p><code>mac_get_link()</code> is identical to <code>mac_get_file()</code>, only it will not follow a symbolic link if it is the final entry in the path, so may be used to retrieve the label on a symlink.</p></li><li><p><code>mac_set_link()</code> is identical to <code>mac_set_file()</code>, only it will not follow a symbolic link if it is the final entry in a path, so may be used to manipulate the label on a symlink.</p></li><li><p><code>mac_execve()</code> is identical to the <code>execve()</code> system call, only it also accepts a requested label to set the process label to when beginning execution of a new program.
This change in label on execution is referred to as a "transition".</p></li><li><p><code>mac_get_peer()</code>, actually implemented via a socket option, retrieves the label of a remote peer on a socket, if available.</p></li></ul></div><div class=paragraph><p>In addition to these system calls, the <code>SIOCSIGMAC</code> and <code>SIOCSIFMAC</code> network interface ioctls permit the labels on network interfaces to be retrieved and set.</p></div></div></div></div><div class=sect1><h2 id=mac-policy-architecture>6.6. MAC Policy Architecture<a class=anchor href=#mac-policy-architecture></a></h2><div class=sectionbody><div class=paragraph><p>Security policies are either linked directly into the kernel, or compiled into loadable kernel modules that may be loaded at boot, or dynamically using the module loading system calls at runtime.
Policy modules interact with the system through a set of declared entry points, providing access to a stream of system events and permitting the policy to influence access control decisions.
Each policy contains a number of elements:</p></div><div class=ulist><ul><li><p>Optional configuration parameters for policy.</p></li><li><p>Centralized implementation of the policy logic and parameters.</p></li><li><p>Optional implementation of policy life cycle events, such as initialization and destruction.</p></li><li><p>Optional support for initializing, maintaining, and destroying labels on selected kernel objects.</p></li><li><p>Optional support for user process inspection and modification of labels on selected objects.</p></li><li><p>Implementation of selected access control entry points that are of interest to the policy.</p></li><li><p>Declaration of policy identity, module entry points, and policy properties.</p></li></ul></div><div class=sect2><h3 id=mac-policy-declaration>6.6.1. Policy Declaration<a class=anchor href=#mac-policy-declaration></a></h3><div class=paragraph><p>Modules may be declared using the <code>MAC_POLICY_SET()</code> macro, which names the policy, provides a reference to the MAC entry point vector, provides load-time flags determining how the policy framework should handle the policy, and optionally requests the allocation of label state by the framework.</p></div><div class="literalblock programlisting"><div class=content><pre>static struct mac_policy_ops mac_policy_ops =
{
        .mpo_destroy = mac_policy_destroy,
        .mpo_init = mac_policy_init,
        .mpo_init_bpfdesc_label = mac_policy_init_bpfdesc_label,
        .mpo_init_cred_label = mac_policy_init_label,
/* ... */
        .mpo_check_vnode_setutimes = mac_policy_check_vnode_setutimes,
        .mpo_check_vnode_stat = mac_policy_check_vnode_stat,
        .mpo_check_vnode_write = mac_policy_check_vnode_write,
};</pre></div></div><div class=paragraph><p>The MAC policy entry point vector, <code>mac<em>policy</em>ops</code> in this example, associates functions defined in the module with specific entry points.
A complete listing of available entry points and their prototypes may be found in the MAC entry point reference section.
Of specific interest during module registration are the .mpo_destroy and .mpo_init entry points.
.mpo_init will be invoked once a policy is successfully registered with the module framework but prior to any other entry points becoming active.
This permits the policy to perform any policy-specific allocation and initialization, such as initialization of any data or locks.
.mpo_destroy will be invoked when a policy module is unloaded to permit releasing of any allocated memory and destruction of locks.
Currently, these two entry points are invoked with the MAC policy list mutex held to prevent any other entry points from being invoked: this will be changed, but in the mean time, policies should be careful about what kernel primitives they invoke so as to avoid lock ordering or sleeping problems.</p></div><div class=paragraph><p>The policy declaration’s module name field exists so that the module may be uniquely identified for the purposes of module dependencies.
An appropriate string should be selected.
The full string name of the policy is displayed to the user via the kernel log during load and unload events, and also exported when providing status information to userland processes.</p></div></div><div class=sect2><h3 id=mac-policy-flags>6.6.2. Policy Flags<a class=anchor href=#mac-policy-flags></a></h3><div class=paragraph><p>The policy declaration flags field permits the module to provide the framework with information about its capabilities at the time the module is loaded.
Currently, three flags are defined:</p></div><div class=dlist><dl><dt class=hdlist1>MPC_LOADTIME_FLAG_UNLOADOK</dt><dd><p>This flag indicates that the policy module may be unloaded.
If this flag is not provided, then the policy framework will reject requests to unload the module.
This flag might be used by modules that allocate label state and are unable to free that state at runtime.</p></dd><dt class=hdlist1>MPC_LOADTIME_FLAG_NOTLATE</dt><dd><p>This flag indicates that the policy module must be loaded and initialized early in the boot process.
If the flag is specified, attempts to register the module following boot will be rejected.
The flag may be used by policies that require pervasive labeling of all system objects, and cannot handle objects that have not been properly initialized by the policy.</p></dd><dt class=hdlist1>MPC_LOADTIME_FLAG_LABELMBUFS</dt><dd><p>This flag indicates that the policy module requires labeling of Mbufs, and that memory should always be allocated for the storage of Mbuf labels.
By default, the MAC Framework will not allocate label storage for Mbufs unless at least one loaded policy has this flag set.
This measurably improves network performance when policies do not require Mbuf labeling.
A kernel option, <code>MAC_ALWAYS_LABEL_MBUF</code>, exists to force the MAC Framework to allocate Mbuf label storage regardless of the setting of this flag, and may be useful in some environments.</p></dd></dl></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Policies using the <code>MPC_LOADTIME_FLAG_LABELMBUFS</code> without the <code>MPC_LOADTIME_FLAG_NOTLATE</code> flag set must be able to correctly handle <code>NULL</code> Mbuf label pointers passed into entry points.
This is necessary as in-flight Mbufs without label storage may persist after a policy enabling Mbuf labeling has been loaded.
If a policy is loaded before the network subsystem is active (i.e., the policy is not being loaded late), then all Mbufs are guaranteed to have label storage.</p></div></td></tr></tbody></table></div></div><div class=sect2><h3 id=mac-policy-entry-points>6.6.3. Policy Entry Points<a class=anchor href=#mac-policy-entry-points></a></h3><div class=paragraph><p>Four classes of entry points are offered to policies registered with the framework: entry points associated with the registration and management of policies, entry points denoting initialization, creation, destruction, and other life cycle events for kernel objects, events associated with access control decisions that the policy module may influence, and calls associated with the management of labels on objects.
In addition, a <code>mac_syscall()</code> entry point is provided so that policies may extend the kernel interface without registering new system calls.</p></div><div class=paragraph><p>Policy module writers should be aware of the kernel locking strategy, as well as what object locks are available during which entry points.
Writers should attempt to avoid deadlock scenarios by avoiding grabbing non-leaf locks inside of entry points, and also follow the locking protocol for object access and modification.
In particular, writers should be aware that while necessary locks to access objects and their labels are generally held, sufficient locks to modify an object or its label may not be present for all entry points.
Locking information for arguments is documented in the MAC framework entry point document.</p></div><div class=paragraph><p>Policy entry points will pass a reference to the object label along with the object itself.
This permits labeled policies to be unaware of the internals of the object yet still make decisions based on the label.
The exception to this is the process credential, which is assumed to be understood by policies as a first class security object in the kernel.</p></div></div></div></div><div class=sect1><h2 id=mac-entry-point-reference>6.7. MAC Policy Entry Point Reference<a class=anchor href=#mac-entry-point-reference></a></h2><div class=sectionbody><div class=sect2><h3 id=mac-mpo-general>6.7.1. General-Purpose Module Entry Points<a class=anchor href=#mac-mpo-general></a></h3><div class=sect3><h4 id=mac-mpo-init>6.7.1.1. <code>mpo_init</code><a class=anchor href=#mac-mpo-init></a></h4><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=c><span class=kt>void</span> <span class=nf>mpo_init</span><span class=p>(</span><span class=k>struct</span> <span class=n>mac_policy_conf</span> <span class=o>*</span><span class=n>conf</span><span class=p>);</span></code></pre></div></div><table class="tableblock frame-none grid-all stretch informaltable"><col style=width:33.3333%><col style=width:33.3333%><col style=width:33.3334%><thead><tr><th class="tableblock halign-left valign-top">Parameter</th><th class="tableblock halign-left valign-top">Description</th><th class="tableblock halign-left valign-top">Locking</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>conf</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>MAC policy definition</p></td><td class="tableblock halign-left valign-top"></td></tr></tbody></table><div class=paragraph><p>Policy load event.
The policy list mutex is held, so sleep operations cannot be performed, and calls out to other kernel subsystems must be made with caution.
If potentially sleeping memory allocations are required during policy initialization, they should be made using a separate module SYSINIT().</p></div></div><div class=sect3><h4 id=mpo-destroy>6.7.1.2. <code>mpo_destroy</code><a class=anchor href=#mpo-destroy></a></h4><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=c><span class=kt>void</span> <span class=nf>mpo_destroy</span><span class=p>(</span><span class=k>struct</span> <span class=n>mac_policy_conf</span> <span class=o>*</span><span class=n>conf</span><span class=p>);</span></code></pre></div></div><table class="tableblock frame-none grid-all stretch informaltable"><col style=width:33.3333%><col style=width:33.3333%><col style=width:33.3334%><thead><tr><th class="tableblock halign-left valign-top">Parameter</th><th class="tableblock halign-left valign-top">Description</th><th class="tableblock halign-left valign-top">Locking</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>conf</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>MAC policy definition</p></td><td class="tableblock halign-left valign-top"></td></tr></tbody></table><div class=paragraph><p>Policy load event.
The policy list mutex is held, so caution should be applied.</p></div></div><div class=sect3><h4 id=mac-mpo-syscall>6.7.1.3. <code>mpo_syscall</code><a class=anchor href=#mac-mpo-syscall></a></h4><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=c><span class=kt>int</span> <span class=nf>mpo_syscall</span><span class=p>(</span><span class=k>struct</span> <span class=kr>thread</span> <span class=o>*</span><span class=n>td</span><span class=p>,</span> <span class=kt>int</span> <span class=n>call</span><span class=p>,</span> <span class=kt>void</span> <span class=o>*</span><span class=n>arg</span><span class=p>);</span></code></pre></div></div><table class="tableblock frame-none grid-all stretch informaltable"><col style=width:33.3333%><col style=width:33.3333%><col style=width:33.3334%><thead><tr><th class="tableblock halign-left valign-top">Parameter</th><th class="tableblock halign-left valign-top">Description</th><th class="tableblock halign-left valign-top">Locking</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>td</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Calling thread</p></td><td class="tableblock halign-left valign-top"></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>call</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Policy-specific syscall number</p></td><td class="tableblock halign-left valign-top"></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>arg</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Pointer to syscall arguments</p></td><td class="tableblock halign-left valign-top"></td></tr></tbody></table><div class=paragraph><p>This entry point provides a policy-multiplexed system call so that policies may provide additional services to user processes without registering specific system calls.
The policy name provided during registration is used to demultiplexer calls from userland, and the arguments will be forwarded to this entry point.
When implementing new services, security modules should be sure to invoke appropriate access control checks from the MAC framework as needed.
For example, if a policy implements an augmented signal functionality, it should call the necessary signal access control checks to invoke the MAC framework and other registered policies.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Modules must currently perform the <code>copyin()</code> of the syscall data on their own.</p></div></td></tr></tbody></table></div></div><div class=sect3><h4 id=mac-mpo-thread-userret>6.7.1.4. <code>mpo_thread_userret</code><a class=anchor href=#mac-mpo-thread-userret></a></h4><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=c><span class=kt>void</span> <span class=nf>mpo_thread_userret</span><span class=p>(</span><span class=k>struct</span> <span class=kr>thread</span> <span class=o>*</span><span class=n>td</span><span class=p>);</span></code></pre></div></div><table class="tableblock frame-none grid-all stretch informaltable"><col style=width:33.3333%><col style=width:33.3333%><col style=width:33.3334%><thead><tr><th class="tableblock halign-left valign-top">Parameter</th><th class="tableblock halign-left valign-top">Description</th><th class="tableblock halign-left valign-top">Locking</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>td</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Returning thread</p></td><td class="tableblock halign-left valign-top"></td></tr></tbody></table><div class=paragraph><p>This entry point permits policy modules to perform MAC-related events when a thread returns to user space, via a system call return, trap return, or otherwise.
This is required for policies that have floating process labels, as it is not always possible to acquire the process lock at arbitrary points in the stack during system call processing; process labels might represent traditional authentication data, process history information, or other data.
To employ this mechanism, intended changes to the process credential label may be stored in the <code>p_label</code> protected by a per-policy spin lock, and then set the per-thread <code>TDF_ASTPENDING</code> flag and per-process <code>PS_MACPENDM</code> flag to schedule a call to the <code>userret</code> entry point.
From this entry point, the policy may create a replacement credential with less concern about the locking context.
Policy writers are cautioned that event ordering relating to scheduling an AST and the AST being performed may be complex and interlaced in multithreaded applications.</p></div></div></div><div class=sect2><h3 id=mac-label-ops>6.7.2. Label Operations<a class=anchor href=#mac-label-ops></a></h3><div class=sect3><h4 id=mac-mpo-init-bpfdesc>6.7.2.1. <code>mpo_init_bpfdesc_label</code><a class=anchor href=#mac-mpo-init-bpfdesc></a></h4><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=c><span class=kt>void</span> <span class=nf>mpo_init_bpfdesc_label</span><span class=p>(</span><span class=k>struct</span> <span class=n>label</span> <span class=o>*</span><span class=n>label</span><span class=p>);</span></code></pre></div></div><table class="tableblock frame-none grid-all stretch informaltable"><col style=width:33.3333%><col style=width:33.3333%><col style=width:33.3334%><thead><tr><th class="tableblock halign-left valign-top">Parameter</th><th class="tableblock halign-left valign-top">Description</th><th class="tableblock halign-left valign-top">Locking</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>label</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>New label to apply</p></td><td class="tableblock halign-left valign-top"></td></tr></tbody></table><div class=paragraph><p>Initialize the label on a newly instantiated bpfdesc (BPF descriptor).
Sleeping is permitted.</p></div></div><div class=sect3><h4 id=mac-mpo-init-cred-label>6.7.2.2. <code>mpo_init_cred_label</code><a class=anchor href=#mac-mpo-init-cred-label></a></h4><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=c><span class=kt>void</span> <span class=nf>mpo_init_cred_label</span><span class=p>(</span><span class=k>struct</span> <span class=n>label</span> <span class=o>*</span><span class=n>label</span><span class=p>);</span></code></pre></div></div><table class="tableblock frame-none grid-all stretch informaltable"><col style=width:33.3333%><col style=width:33.3333%><col style=width:33.3334%><thead><tr><th class="tableblock halign-left valign-top">Parameter</th><th class="tableblock halign-left valign-top">Description</th><th class="tableblock halign-left valign-top">Locking</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>label</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>New label to initialize</p></td><td class="tableblock halign-left valign-top"></td></tr></tbody></table><div class=paragraph><p>Initialize the label for a newly instantiated user credential.
Sleeping is permitted.</p></div></div><div class=sect3><h4 id=mac-mpo-init-devfsdirent>6.7.2.3. <code>mpo_init_devfsdirent_label</code><a class=anchor href=#mac-mpo-init-devfsdirent></a></h4><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=c><span class=kt>void</span> <span class=nf>mpo_init_devfsdirent_label</span><span class=p>(</span><span class=k>struct</span> <span class=n>label</span> <span class=o>*</span><span class=n>label</span><span class=p>);</span></code></pre></div></div><table class="tableblock frame-none grid-all stretch informaltable"><col style=width:33.3333%><col style=width:33.3333%><col style=width:33.3334%><thead><tr><th class="tableblock halign-left valign-top">Parameter</th><th class="tableblock halign-left valign-top">Description</th><th class="tableblock halign-left valign-top">Locking</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>label</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>New label to apply</p></td><td class="tableblock halign-left valign-top"></td></tr></tbody></table><div class=paragraph><p>Initialize the label on a newly instantiated devfs entry.
Sleeping is permitted.</p></div></div><div class=sect3><h4 id=mac-mpo-init-ifnet>6.7.2.4. <code>mpo_init_ifnet_label</code><a class=anchor href=#mac-mpo-init-ifnet></a></h4><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=c><span class=kt>void</span> <span class=nf>mpo_init_ifnet_label</span><span class=p>(</span><span class=k>struct</span> <span class=n>label</span> <span class=o>*</span><span class=n>label</span><span class=p>);</span></code></pre></div></div><table class="tableblock frame-none grid-all stretch informaltable"><col style=width:33.3333%><col style=width:33.3333%><col style=width:33.3334%><thead><tr><th class="tableblock halign-left valign-top">Parameter</th><th class="tableblock halign-left valign-top">Description</th><th class="tableblock halign-left valign-top">Locking</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>label</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>New label to apply</p></td><td class="tableblock halign-left valign-top"></td></tr></tbody></table><div class=paragraph><p>Initialize the label on a newly instantiated network interface.
Sleeping is permitted.</p></div></div><div class=sect3><h4 id=mac-mpo-init-ipq>6.7.2.5. <code>mpo_init_ipq_label</code><a class=anchor href=#mac-mpo-init-ipq></a></h4><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=c><span class=kt>void</span> <span class=nf>mpo_init_ipq_label</span><span class=p>(</span><span class=k>struct</span> <span class=n>label</span> <span class=o>*</span><span class=n>label</span><span class=p>,</span> <span class=kt>int</span> <span class=n>flag</span><span class=p>);</span></code></pre></div></div><table class="tableblock frame-none grid-all stretch informaltable"><col style=width:33.3333%><col style=width:33.3333%><col style=width:33.3334%><thead><tr><th class="tableblock halign-left valign-top">Parameter</th><th class="tableblock halign-left valign-top">Description</th><th class="tableblock halign-left valign-top">Locking</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>label</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>New label to apply</p></td><td class="tableblock halign-left valign-top"></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>flag</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Sleeping/non-sleeping <a href="https://man.freebsd.org/cgi/man.cgi?query=malloc&amp;sektion=9&amp;format=html">malloc(9)</a>; see below</p></td><td class="tableblock halign-left valign-top"></td></tr></tbody></table><div class=paragraph><p>Initialize the label on a newly instantiated IP fragment reassembly queue.
The <code>flag</code> field may be one of M_WAITOK and M_NOWAIT, and should be employed to avoid performing a sleeping <a href="https://man.freebsd.org/cgi/man.cgi?query=malloc&amp;sektion=9&amp;format=html">malloc(9)</a> during this initialization call.
IP fragment reassembly queue allocation frequently occurs in performance sensitive environments, and the implementation should be careful to avoid sleeping or long-lived operations.
This entry point is permitted to fail resulting in the failure to allocate the IP fragment reassembly queue.</p></div></div><div class=sect3><h4 id=mac-mpo-init-mbuf>6.7.2.6. <code>mpo_init_mbuf_label</code><a class=anchor href=#mac-mpo-init-mbuf></a></h4><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=c><span class=kt>void</span> <span class=nf>mpo_init_mbuf_label</span><span class=p>(</span><span class=kt>int</span> <span class=n>flag</span><span class=p>,</span> <span class=k>struct</span> <span class=n>label</span> <span class=o>*</span><span class=n>label</span><span class=p>);</span></code></pre></div></div><table class="tableblock frame-none grid-all stretch informaltable"><col style=width:33.3333%><col style=width:33.3333%><col style=width:33.3334%><thead><tr><th class="tableblock halign-left valign-top">Parameter</th><th class="tableblock halign-left valign-top">Description</th><th class="tableblock halign-left valign-top">Locking</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>flag</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Sleeping/non-sleeping <a href="https://man.freebsd.org/cgi/man.cgi?query=malloc&amp;sektion=9&amp;format=html">malloc(9)</a>; see below</p></td><td class="tableblock halign-left valign-top"></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>label</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Policy label to initialize</p></td><td class="tableblock halign-left valign-top"></td></tr></tbody></table><div class=paragraph><p>Initialize the label on a newly instantiated mbuf packet header (<code>mbuf</code>).
The <code>flag</code> field may be one of M_WAITOK and M_NOWAIT, and should be employed to avoid performing a sleeping <a href="https://man.freebsd.org/cgi/man.cgi?query=malloc&amp;sektion=9&amp;format=html">malloc(9)</a> during this initialization call.
Mbuf allocation frequently occurs in performance sensitive environments, and the implementation should be careful to avoid sleeping or long-lived operations.
This entry point is permitted to fail resulting in the failure to allocate the mbuf header.</p></div></div><div class=sect3><h4 id=mac-mpo-init-mount>6.7.2.7. <code>mpo_init_mount_label</code><a class=anchor href=#mac-mpo-init-mount></a></h4><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=c><span class=kt>void</span> <span class=nf>mpo_init_mount_label</span><span class=p>(</span><span class=k>struct</span> <span class=n>label</span> <span class=o>*</span><span class=n>mntlabel</span><span class=p>,</span> <span class=k>struct</span> <span class=n>label</span> <span class=o>*</span><span class=n>fslabel</span><span class=p>);</span></code></pre></div></div><table class="tableblock frame-none grid-all stretch informaltable"><col style=width:33.3333%><col style=width:33.3333%><col style=width:33.3334%><thead><tr><th class="tableblock halign-left valign-top">Parameter</th><th class="tableblock halign-left valign-top">Description</th><th class="tableblock halign-left valign-top">Locking</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>mntlabel</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Policy label to be initialized for the mount itself</p></td><td class="tableblock halign-left valign-top"></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>fslabel</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Policy label to be initialized for the file system</p></td><td class="tableblock halign-left valign-top"></td></tr></tbody></table><div class=paragraph><p>Initialize the labels on a newly instantiated mount point.
Sleeping is permitted.</p></div></div><div class=sect3><h4 id=mac-mpo-init-mount-fs-label>6.7.2.8. <code>mpo_init_mount_fs_label</code><a class=anchor href=#mac-mpo-init-mount-fs-label></a></h4><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=c><span class=kt>void</span> <span class=nf>mpo_init_mount_fs_label</span><span class=p>(</span><span class=k>struct</span> <span class=n>label</span> <span class=o>*</span><span class=n>label</span><span class=p>);</span></code></pre></div></div><table class="tableblock frame-none grid-all stretch informaltable"><col style=width:33.3333%><col style=width:33.3333%><col style=width:33.3334%><thead><tr><th class="tableblock halign-left valign-top">Parameter</th><th class="tableblock halign-left valign-top">Description</th><th class="tableblock halign-left valign-top">Locking</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>label</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Label to be initialized</p></td><td class="tableblock halign-left valign-top"></td></tr></tbody></table><div class=paragraph><p>Initialize the label on a newly mounted file system.
Sleeping is permitted</p></div></div><div class=sect3><h4 id=mac-mpo-init-pipe-label>6.7.2.9. <code>mpo_init_pipe_label</code><a class=anchor href=#mac-mpo-init-pipe-label></a></h4><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=c><span class=kt>void</span> <span class=nf>mpo_init_pipe_label</span><span class=p>(</span><span class=k>struct</span> <span class=n>label</span> <span class=o>*</span><span class=n>label</span><span class=p>);</span></code></pre></div></div><table class="tableblock frame-none grid-all stretch informaltable"><col style=width:33.3333%><col style=width:33.3333%><col style=width:33.3334%><thead><tr><th class="tableblock halign-left valign-top">Parameter</th><th class="tableblock halign-left valign-top">Description</th><th class="tableblock halign-left valign-top">Locking</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>label</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Label to be filled in</p></td><td class="tableblock halign-left valign-top"></td></tr></tbody></table><div class=paragraph><p>Initialize a label for a newly instantiated pipe.
Sleeping is permitted.</p></div></div><div class=sect3><h4 id=mac-mpo-init-socket>6.7.2.10. <code>mpo_init_socket_label</code><a class=anchor href=#mac-mpo-init-socket></a></h4><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=c><span class=kt>void</span> <span class=nf>mpo_init_socket_label</span><span class=p>(</span><span class=k>struct</span> <span class=n>label</span> <span class=o>*</span><span class=n>label</span><span class=p>,</span> <span class=kt>int</span> <span class=n>flag</span><span class=p>);</span></code></pre></div></div><table class="tableblock frame-none grid-all stretch informaltable"><col style=width:33.3333%><col style=width:33.3333%><col style=width:33.3334%><thead><tr><th class="tableblock halign-left valign-top">Parameter</th><th class="tableblock halign-left valign-top">Description</th><th class="tableblock halign-left valign-top">Locking</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>label</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>New label to initialize</p></td><td class="tableblock halign-left valign-top"></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>flag</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock><a href="https://man.freebsd.org/cgi/man.cgi?query=malloc&amp;sektion=9&amp;format=html">malloc(9)</a> flags</p></td><td class="tableblock halign-left valign-top"></td></tr></tbody></table><div class=paragraph><p>Initialize a label for a newly instantiated socket.
The <code>flag</code> field may be one of M_WAITOK and M_NOWAIT, and should be employed to avoid performing a sleeping <a href="https://man.freebsd.org/cgi/man.cgi?query=malloc&amp;sektion=9&amp;format=html">malloc(9)</a> during this initialization call.</p></div></div><div class=sect3><h4 id=mac-mpo-init-socket-peer-label>6.7.2.11. <code>mpo_init_socket_peer_label</code><a class=anchor href=#mac-mpo-init-socket-peer-label></a></h4><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=c><span class=kt>void</span> <span class=nf>mpo_init_socket_peer_label</span><span class=p>(</span><span class=k>struct</span> <span class=n>label</span> <span class=o>*</span><span class=n>label</span><span class=p>,</span> <span class=kt>int</span> <span class=n>flag</span><span class=p>);</span></code></pre></div></div><table class="tableblock frame-none grid-all stretch informaltable"><col style=width:33.3333%><col style=width:33.3333%><col style=width:33.3334%><thead><tr><th class="tableblock halign-left valign-top">Parameter</th><th class="tableblock halign-left valign-top">Description</th><th class="tableblock halign-left valign-top">Locking</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>label</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>New label to initialize</p></td><td class="tableblock halign-left valign-top"></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>flag</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock><a href="https://man.freebsd.org/cgi/man.cgi?query=malloc&amp;sektion=9&amp;format=html">malloc(9)</a> flags</p></td><td class="tableblock halign-left valign-top"></td></tr></tbody></table><div class=paragraph><p>Initialize the peer label for a newly instantiated socket.
The <code>flag</code> field may be one of M_WAITOK and M_NOWAIT, and should be employed to avoid performing a sleeping <a href="https://man.freebsd.org/cgi/man.cgi?query=malloc&amp;sektion=9&amp;format=html">malloc(9)</a> during this initialization call.</p></div></div><div class=sect3><h4 id=mac-mpo-init-proc-label>6.7.2.12. <code>mpo_init_proc_label</code><a class=anchor href=#mac-mpo-init-proc-label></a></h4><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=c><span class=kt>void</span> <span class=nf>mpo_init_proc_label</span><span class=p>(</span><span class=k>struct</span> <span class=n>label</span> <span class=o>*</span><span class=n>label</span><span class=p>);</span></code></pre></div></div><table class="tableblock frame-none grid-all stretch informaltable"><col style=width:33.3333%><col style=width:33.3333%><col style=width:33.3334%><thead><tr><th class="tableblock halign-left valign-top">Parameter</th><th class="tableblock halign-left valign-top">Description</th><th class="tableblock halign-left valign-top">Locking</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>label</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>New label to initialize</p></td><td class="tableblock halign-left valign-top"></td></tr></tbody></table><div class=paragraph><p>Initialize the label for a newly instantiated process.
Sleeping is permitted.</p></div></div><div class=sect3><h4 id=mac-mpo-init-vnode>6.7.2.13. <code>mpo_init_vnode_label</code><a class=anchor href=#mac-mpo-init-vnode></a></h4><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=c><span class=kt>void</span> <span class=nf>mpo_init_vnode_label</span><span class=p>(</span><span class=k>struct</span> <span class=n>label</span> <span class=o>*</span><span class=n>label</span><span class=p>);</span></code></pre></div></div><table class="tableblock frame-none grid-all stretch informaltable"><col style=width:33.3333%><col style=width:33.3333%><col style=width:33.3334%><thead><tr><th class="tableblock halign-left valign-top">Parameter</th><th class="tableblock halign-left valign-top">Description</th><th class="tableblock halign-left valign-top">Locking</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>label</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>New label to initialize</p></td><td class="tableblock halign-left valign-top"></td></tr></tbody></table><div class=paragraph><p>Initialize the label on a newly instantiated vnode.
Sleeping is permitted.</p></div></div><div class=sect3><h4 id=mac-mpo-destroy-bpfdesc>6.7.2.14. <code>mpo_destroy_bpfdesc_label</code><a class=anchor href=#mac-mpo-destroy-bpfdesc></a></h4><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=c><span class=kt>void</span> <span class=nf>mpo_destroy_bpfdesc_label</span><span class=p>(</span><span class=k>struct</span> <span class=n>label</span> <span class=o>*</span><span class=n>label</span><span class=p>);</span></code></pre></div></div><table class="tableblock frame-none grid-all stretch informaltable"><col style=width:33.3333%><col style=width:33.3333%><col style=width:33.3334%><thead><tr><th class="tableblock halign-left valign-top">Parameter</th><th class="tableblock halign-left valign-top">Description</th><th class="tableblock halign-left valign-top">Locking</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>label</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>bpfdesc label</p></td><td class="tableblock halign-left valign-top"></td></tr></tbody></table><div class=paragraph><p>Destroy the label on a BPF descriptor.
In this entry point a policy should free any internal storage associated with <code>label</code> so that it may be destroyed.</p></div></div><div class=sect3><h4 id=mac-mpo-destroy-cred>6.7.2.15. <code>mpo_destroy_cred_label</code><a class=anchor href=#mac-mpo-destroy-cred></a></h4><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=c><span class=kt>void</span> <span class=nf>mpo_destroy_cred_label</span><span class=p>(</span><span class=k>struct</span> <span class=n>label</span> <span class=o>*</span><span class=n>label</span><span class=p>);</span></code></pre></div></div><table class="tableblock frame-none grid-all stretch informaltable"><col style=width:33.3333%><col style=width:33.3333%><col style=width:33.3334%><thead><tr><th class="tableblock halign-left valign-top">Parameter</th><th class="tableblock halign-left valign-top">Description</th><th class="tableblock halign-left valign-top">Locking</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>label</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Label being destroyed</p></td><td class="tableblock halign-left valign-top"></td></tr></tbody></table><div class=paragraph><p>Destroy the label on a credential.
In this entry point, a policy module should free any internal storage associated with <code>label</code> so that it may be destroyed.</p></div></div><div class=sect3><h4 id=mac-mpo-destroy-devfsdirent>6.7.2.16. <code>mpo_destroy_devfsdirent_label</code><a class=anchor href=#mac-mpo-destroy-devfsdirent></a></h4><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=c><span class=kt>void</span> <span class=nf>mpo_destroy_devfsdirent_label</span><span class=p>(</span><span class=k>struct</span> <span class=n>label</span> <span class=o>*</span><span class=n>label</span><span class=p>);</span></code></pre></div></div><table class="tableblock frame-none grid-all stretch informaltable"><col style=width:33.3333%><col style=width:33.3333%><col style=width:33.3334%><thead><tr><th class="tableblock halign-left valign-top">Parameter</th><th class="tableblock halign-left valign-top">Description</th><th class="tableblock halign-left valign-top">Locking</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>label</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Label being destroyed</p></td><td class="tableblock halign-left valign-top"></td></tr></tbody></table><div class=paragraph><p>Destroy the label on a devfs entry.
In this entry point, a policy module should free any internal storage associated with <code>label</code> so that it may be destroyed.</p></div></div><div class=sect3><h4 id=mac-mpo-destroy-ifnet-label>6.7.2.17. <code>mpo_destroy_ifnet_label</code><a class=anchor href=#mac-mpo-destroy-ifnet-label></a></h4><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=c><span class=kt>void</span> <span class=nf>mpo_destroy_ifnet_label</span><span class=p>(</span><span class=k>struct</span> <span class=n>label</span> <span class=o>*</span><span class=n>label</span><span class=p>);</span></code></pre></div></div><table class="tableblock frame-none grid-all stretch informaltable"><col style=width:33.3333%><col style=width:33.3333%><col style=width:33.3334%><thead><tr><th class="tableblock halign-left valign-top">Parameter</th><th class="tableblock halign-left valign-top">Description</th><th class="tableblock halign-left valign-top">Locking</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>label</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Label being destroyed</p></td><td class="tableblock halign-left valign-top"></td></tr></tbody></table><div class=paragraph><p>Destroy the label on a removed interface.
In this entry point, a policy module should free any internal storage associated with <code>label</code> so that it may be destroyed.</p></div></div><div class=sect3><h4 id=mac-mpo-destroy-ipq-label>6.7.2.18. <code>mpo_destroy_ipq_label</code><a class=anchor href=#mac-mpo-destroy-ipq-label></a></h4><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=c><span class=kt>void</span> <span class=nf>mpo_destroy_ipq_label</span><span class=p>(</span><span class=k>struct</span> <span class=n>label</span> <span class=o>*</span><span class=n>label</span><span class=p>);</span></code></pre></div></div><table class="tableblock frame-none grid-all stretch informaltable"><col style=width:33.3333%><col style=width:33.3333%><col style=width:33.3334%><thead><tr><th class="tableblock halign-left valign-top">Parameter</th><th class="tableblock halign-left valign-top">Description</th><th class="tableblock halign-left valign-top">Locking</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>label</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Label being destroyed</p></td><td class="tableblock halign-left valign-top"></td></tr></tbody></table><div class=paragraph><p>Destroy the label on an IP fragment queue.
In this entry point, a policy module should free any internal storage associated with <code>label</code> so that it may be destroyed.</p></div></div><div class=sect3><h4 id=mac-mpo-destroy-mbuf-label>6.7.2.19. <code>mpo_destroy_mbuf_label</code><a class=anchor href=#mac-mpo-destroy-mbuf-label></a></h4><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=c><span class=kt>void</span> <span class=nf>mpo_destroy_mbuf_label</span><span class=p>(</span><span class=k>struct</span> <span class=n>label</span> <span class=o>*</span><span class=n>label</span><span class=p>);</span></code></pre></div></div><table class="tableblock frame-none grid-all stretch informaltable"><col style=width:33.3333%><col style=width:33.3333%><col style=width:33.3334%><thead><tr><th class="tableblock halign-left valign-top">Parameter</th><th class="tableblock halign-left valign-top">Description</th><th class="tableblock halign-left valign-top">Locking</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>label</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Label being destroyed</p></td><td class="tableblock halign-left valign-top"></td></tr></tbody></table><div class=paragraph><p>Destroy the label on an mbuf header.
In this entry point, a policy module should free any internal storage associated with <code>label</code> so that it may be destroyed.</p></div></div><div class=sect3><h4 id=mac-mpo-destroy-mount-label>6.7.2.20. <code>mpo_destroy_mount_label</code><a class=anchor href=#mac-mpo-destroy-mount-label></a></h4><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=c><span class=kt>void</span> <span class=nf>mpo_destroy_mount_label</span><span class=p>(</span><span class=k>struct</span> <span class=n>label</span> <span class=o>*</span><span class=n>label</span><span class=p>);</span></code></pre></div></div><table class="tableblock frame-none grid-all stretch informaltable"><col style=width:33.3333%><col style=width:33.3333%><col style=width:33.3334%><thead><tr><th class="tableblock halign-left valign-top">Parameter</th><th class="tableblock halign-left valign-top">Description</th><th class="tableblock halign-left valign-top">Locking</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>label</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Mount point label being destroyed</p></td><td class="tableblock halign-left valign-top"></td></tr></tbody></table><div class=paragraph><p>Destroy the labels on a mount point.
In this entry point, a policy module should free the internal storage associated with <code>mntlabel</code> so that they may be destroyed.</p></div></div><div class=sect3><h4 id=mac-mpo-destroy-mount>6.7.2.21. <code>mpo_destroy_mount_label</code><a class=anchor href=#mac-mpo-destroy-mount></a></h4><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=c><span class=kt>void</span> <span class=nf>mpo_destroy_mount_label</span><span class=p>(</span><span class=k>struct</span> <span class=n>label</span> <span class=o>*</span><span class=n>mntlabel</span><span class=p>,</span> <span class=k>struct</span> <span class=n>label</span> <span class=o>*</span><span class=n>fslabel</span><span class=p>);</span></code></pre></div></div><table class="tableblock frame-none grid-all stretch informaltable"><col style=width:33.3333%><col style=width:33.3333%><col style=width:33.3334%><thead><tr><th class="tableblock halign-left valign-top">Parameter</th><th class="tableblock halign-left valign-top">Description</th><th class="tableblock halign-left valign-top">Locking</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>mntlabel</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Mount point label being destroyed</p></td><td class="tableblock halign-left valign-top"></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>fslabel</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>File system label being destroyed></p></td><td class="tableblock halign-left valign-top"></td></tr></tbody></table><div class=paragraph><p>Destroy the labels on a mount point.
In this entry point, a policy module should free the internal storage associated with <code>mntlabel</code> and <code>fslabel</code> so that they may be destroyed.</p></div></div><div class=sect3><h4 id=mac-mpo-destroy-socket>6.7.2.22. <code>mpo_destroy_socket_label</code><a class=anchor href=#mac-mpo-destroy-socket></a></h4><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=c><span class=kt>void</span> <span class=nf>mpo_destroy_socket_label</span><span class=p>(</span><span class=k>struct</span> <span class=n>label</span> <span class=o>*</span><span class=n>label</span><span class=p>);</span></code></pre></div></div><table class="tableblock frame-none grid-all stretch informaltable"><col style=width:33.3333%><col style=width:33.3333%><col style=width:33.3334%><thead><tr><th class="tableblock halign-left valign-top">Parameter</th><th class="tableblock halign-left valign-top">Description</th><th class="tableblock halign-left valign-top">Locking</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>label</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Socket label being destroyed</p></td><td class="tableblock halign-left valign-top"></td></tr></tbody></table><div class=paragraph><p>Destroy the label on a socket.
In this entry point, a policy module should free any internal storage associated with <code>label</code> so that it may be destroyed.</p></div></div><div class=sect3><h4 id=mac-mpo-destroy-socket-peer-label>6.7.2.23. <code>mpo_destroy_socket_peer_label</code><a class=anchor href=#mac-mpo-destroy-socket-peer-label></a></h4><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=c><span class=kt>void</span> <span class=nf>mpo_destroy_socket_peer_label</span><span class=p>(</span><span class=k>struct</span> <span class=n>label</span> <span class=o>*</span><span class=n>peerlabel</span><span class=p>);</span></code></pre></div></div><table class="tableblock frame-none grid-all stretch informaltable"><col style=width:33.3333%><col style=width:33.3333%><col style=width:33.3334%><thead><tr><th class="tableblock halign-left valign-top">Parameter</th><th class="tableblock halign-left valign-top">Description</th><th class="tableblock halign-left valign-top">Locking</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>peerlabel</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Socket peer label being destroyed</p></td><td class="tableblock halign-left valign-top"></td></tr></tbody></table><div class=paragraph><p>Destroy the peer label on a socket.
In this entry point, a policy module should free any internal storage associated with <code>label</code> so that it may be destroyed.</p></div></div><div class=sect3><h4 id=mac-mpo-destroy-pipe-label>6.7.2.24. <code>mpo_destroy_pipe_label</code><a class=anchor href=#mac-mpo-destroy-pipe-label></a></h4><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=c><span class=kt>void</span> <span class=nf>mpo_destroy_pipe_label</span><span class=p>(</span><span class=k>struct</span> <span class=n>label</span> <span class=o>*</span><span class=n>label</span><span class=p>);</span></code></pre></div></div><table class="tableblock frame-none grid-all stretch informaltable"><col style=width:33.3333%><col style=width:33.3333%><col style=width:33.3334%><thead><tr><th class="tableblock halign-left valign-top">Parameter</th><th class="tableblock halign-left valign-top">Description</th><th class="tableblock halign-left valign-top">Locking</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>label</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Pipe label</p></td><td class="tableblock halign-left valign-top"></td></tr></tbody></table><div class=paragraph><p>Destroy the label on a pipe.
In this entry point, a policy module should free any internal storage associated with <code>label</code> so that it may be destroyed.</p></div></div><div class=sect3><h4 id=mac-mpo-destroy-proc-label>6.7.2.25. <code>mpo_destroy_proc_label</code><a class=anchor href=#mac-mpo-destroy-proc-label></a></h4><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=c><span class=kt>void</span> <span class=nf>mpo_destroy_proc_label</span><span class=p>(</span><span class=k>struct</span> <span class=n>label</span> <span class=o>*</span><span class=n>label</span><span class=p>);</span></code></pre></div></div><table class="tableblock frame-none grid-all stretch informaltable"><col style=width:33.3333%><col style=width:33.3333%><col style=width:33.3334%><thead><tr><th class="tableblock halign-left valign-top">Parameter</th><th class="tableblock halign-left valign-top">Description</th><th class="tableblock halign-left valign-top">Locking</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>label</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Process label</p></td><td class="tableblock halign-left valign-top"></td></tr></tbody></table><div class=paragraph><p>Destroy the label on a process.
In this entry point, a policy module should free any internal storage associated with <code>label</code> so that it may be destroyed.</p></div></div><div class=sect3><h4 id=mac-mpo-destroy-vnode-label>6.7.2.26. <code>mpo_destroy_vnode_label</code><a class=anchor href=#mac-mpo-destroy-vnode-label></a></h4><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=c><span class=kt>void</span> <span class=nf>mpo_destroy_vnode_label</span><span class=p>(</span><span class=k>struct</span> <span class=n>label</span> <span class=o>*</span><span class=n>label</span><span class=p>);</span></code></pre></div></div><table class="tableblock frame-none grid-all stretch informaltable"><col style=width:33.3333%><col style=width:33.3333%><col style=width:33.3334%><thead><tr><th class="tableblock halign-left valign-top">Parameter</th><th class="tableblock halign-left valign-top">Description</th><th class="tableblock halign-left valign-top">Locking</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>label</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Process label</p></td><td class="tableblock halign-left valign-top"></td></tr></tbody></table><div class=paragraph><p>Destroy the label on a vnode.
In this entry point, a policy module should free any internal storage associated with <code>label</code> so that it may be destroyed.</p></div></div><div class=sect3><h4 id=mac-mpo-copy-mbuf-label>6.7.2.27. <code>mpo_copy_mbuf_label</code><a class=anchor href=#mac-mpo-copy-mbuf-label></a></h4><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=c><span class=kt>void</span> <span class=nf>mpo_copy_mbuf_label</span><span class=p>(</span><span class=k>struct</span> <span class=n>label</span> <span class=o>*</span><span class=n>src</span><span class=p>,</span> <span class=k>struct</span> <span class=n>label</span> <span class=o>*</span><span class=n>dest</span><span class=p>);</span></code></pre></div></div><table class="tableblock frame-none grid-all stretch informaltable"><col style=width:33.3333%><col style=width:33.3333%><col style=width:33.3334%><thead><tr><th class="tableblock halign-left valign-top">Parameter</th><th class="tableblock halign-left valign-top">Description</th><th class="tableblock halign-left valign-top">Locking</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>src</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Source label</p></td><td class="tableblock halign-left valign-top"></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>dest</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Destination label</p></td><td class="tableblock halign-left valign-top"></td></tr></tbody></table><div class=paragraph><p>Copy the label information in <code>src</code> into <code>dest</code>.</p></div></div><div class=sect3><h4 id=mac-mpo-copy-pipe-label>6.7.2.28. <code>mpo_copy_pipe_label</code><a class=anchor href=#mac-mpo-copy-pipe-label></a></h4><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=c><span class=kt>void</span> <span class=nf>mpo_copy_pipe_label</span><span class=p>(</span><span class=k>struct</span> <span class=n>label</span> <span class=o>*</span><span class=n>src</span><span class=p>,</span> <span class=k>struct</span> <span class=n>label</span> <span class=o>*</span><span class=n>dest</span><span class=p>);</span></code></pre></div></div><table class="tableblock frame-none grid-all stretch informaltable"><col style=width:33.3333%><col style=width:33.3333%><col style=width:33.3334%><thead><tr><th class="tableblock halign-left valign-top">Parameter</th><th class="tableblock halign-left valign-top">Description</th><th class="tableblock halign-left valign-top">Locking</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>src</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Source label</p></td><td class="tableblock halign-left valign-top"></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>dest</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Destination label</p></td><td class="tableblock halign-left valign-top"></td></tr></tbody></table><div class=paragraph><p>Copy the label information in <code>src</code> into <code>dest</code>.</p></div></div><div class=sect3><h4 id=mac-mpo-copy-vnode-label>6.7.2.29. <code>mpo_copy_vnode_label</code><a class=anchor href=#mac-mpo-copy-vnode-label></a></h4><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=c><span class=kt>void</span> <span class=nf>mpo_copy_vnode_label</span><span class=p>(</span><span class=k>struct</span> <span class=n>label</span> <span class=o>*</span><span class=n>src</span><span class=p>,</span> <span class=k>struct</span> <span class=n>label</span> <span class=o>*</span><span class=n>dest</span><span class=p>);</span></code></pre></div></div><table class="tableblock frame-none grid-all stretch informaltable"><col style=width:33.3333%><col style=width:33.3333%><col style=width:33.3334%><thead><tr><th class="tableblock halign-left valign-top">Parameter</th><th class="tableblock halign-left valign-top">Description</th><th class="tableblock halign-left valign-top">Locking</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>src</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Source label</p></td><td class="tableblock halign-left valign-top"></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>dest</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Destination label</p></td><td class="tableblock halign-left valign-top"></td></tr></tbody></table><div class=paragraph><p>Copy the label information in <code>src</code> into <code>dest</code>.</p></div></div><div class=sect3><h4 id=mac-mpo-externalize-cred-label>6.7.2.30. <code>mpo_externalize_cred_label</code><a class=anchor href=#mac-mpo-externalize-cred-label></a></h4><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=c><span class=kt>int</span> <span class=nf>mpo_externalize_cred_label</span><span class=p>(</span><span class=k>struct</span> <span class=n>label</span> <span class=o>*</span><span class=n>label</span><span class=p>,</span> <span class=kt>char</span> <span class=o>*</span><span class=n>element_name</span><span class=p>,</span>
    <span class=k>struct</span> <span class=n>sbuf</span> <span class=o>*</span><span class=n>sb</span><span class=p>,</span> <span class=kt>int</span> <span class=o>*</span><span class=n>claimed</span><span class=p>);</span></code></pre></div></div><table class="tableblock frame-none grid-all stretch informaltable"><col style=width:33.3333%><col style=width:33.3333%><col style=width:33.3334%><thead><tr><th class="tableblock halign-left valign-top">Parameter</th><th class="tableblock halign-left valign-top">Description</th><th class="tableblock halign-left valign-top">Locking</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>label</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Label to be externalized</p></td><td class="tableblock halign-left valign-top"></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>element_name</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Name of the policy whose label should be externalized</p></td><td class="tableblock halign-left valign-top"></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>sb</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>String buffer to be filled with a text representation of label</p></td><td class="tableblock halign-left valign-top"></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>claimed</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Should be incremented when <code>element_data</code> can be filled in.</p></td><td class="tableblock halign-left valign-top"></td></tr></tbody></table><div class=paragraph><p>Produce an externalized label based on the label structure passed.
An externalized label consists of a text representation of the label contents that can be used with userland applications and read by the user.
Currently, all policies' <code>externalize</code> entry points will be called, so the implementation should check the contents of <code>element_name</code> before attempting to fill in <code>sb</code>.
If <code>element_name</code> does not match the name of your policy, simply return 0.
Only return nonzero if an error occurs while externalizing the label data.
Once the policy fills in <code>element_data</code>, <code>*claimed</code> should be incremented.</p></div></div><div class=sect3><h4 id=mac-mpo-externalize-ifnet-label>6.7.2.31. <code>mpo_externalize_ifnet_label</code><a class=anchor href=#mac-mpo-externalize-ifnet-label></a></h4><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=c><span class=kt>int</span> <span class=nf>mpo_externalize_ifnet_label</span><span class=p>(</span><span class=k>struct</span> <span class=n>label</span> <span class=o>*</span><span class=n>label</span><span class=p>,</span> <span class=kt>char</span> <span class=o>*</span><span class=n>element_name</span><span class=p>,</span>
    <span class=k>struct</span> <span class=n>sbuf</span> <span class=o>*</span><span class=n>sb</span><span class=p>,</span> <span class=kt>int</span> <span class=o>*</span><span class=n>claimed</span><span class=p>);</span></code></pre></div></div><table class="tableblock frame-none grid-all stretch informaltable"><col style=width:33.3333%><col style=width:33.3333%><col style=width:33.3334%><thead><tr><th class="tableblock halign-left valign-top">Parameter</th><th class="tableblock halign-left valign-top">Description</th><th class="tableblock halign-left valign-top">Locking</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>label</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Label to be externalized</p></td><td class="tableblock halign-left valign-top"></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>element_name</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Name of the policy whose label should be externalized</p></td><td class="tableblock halign-left valign-top"></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>sb</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>String buffer to be filled with a text representation of label</p></td><td class="tableblock halign-left valign-top"></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>claimed</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Should be incremented when <code>element_data</code> can be filled in.</p></td><td class="tableblock halign-left valign-top"></td></tr></tbody></table><div class=paragraph><p>Produce an externalized label based on the label structure passed.
An externalized label consists of a text representation of the label contents that can be used with userland applications and read by the user.
Currently, all policies' <code>externalize</code> entry points will be called, so the implementation should check the contents of <code>element_name</code> before attempting to fill in <code>sb</code>.
If <code>element_name</code> does not match the name of your policy, simply return 0.
Only return nonzero if an error occurs while externalizing the label data.
Once the policy fills in <code>element_data</code>, <code>*claimed</code> should be incremented.</p></div></div><div class=sect3><h4 id=mac-mpo-externalize-pipe-label>6.7.2.32. <code>mpo_externalize_pipe_label</code><a class=anchor href=#mac-mpo-externalize-pipe-label></a></h4><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=c><span class=kt>int</span> <span class=nf>mpo_externalize_pipe_label</span><span class=p>(</span><span class=k>struct</span> <span class=n>label</span> <span class=o>*</span><span class=n>label</span><span class=p>,</span> <span class=kt>char</span> <span class=o>*</span><span class=n>element_name</span><span class=p>,</span>
    <span class=k>struct</span> <span class=n>sbuf</span> <span class=o>*</span><span class=n>sb</span><span class=p>,</span> <span class=kt>int</span> <span class=o>*</span><span class=n>claimed</span><span class=p>);</span></code></pre></div></div><table class="tableblock frame-none grid-all stretch informaltable"><col style=width:33.3333%><col style=width:33.3333%><col style=width:33.3334%><thead><tr><th class="tableblock halign-left valign-top">Parameter</th><th class="tableblock halign-left valign-top">Description</th><th class="tableblock halign-left valign-top">Locking</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>label</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Label to be externalized</p></td><td class="tableblock halign-left valign-top"></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>element_name</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Name of the policy whose label should be externalized</p></td><td class="tableblock halign-left valign-top"></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>sb</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>String buffer to be filled with a text representation of label</p></td><td class="tableblock halign-left valign-top"></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>claimed</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Should be incremented when <code>element_data</code> can be filled in.</p></td><td class="tableblock halign-left valign-top"></td></tr></tbody></table><div class=paragraph><p>Produce an externalized label based on the label structure passed.
An externalized label consists of a text representation of the label contents that can be used with userland applications and read by the user.
Currently, all policies' <code>externalize</code> entry points will be called, so the implementation should check the contents of <code>element_name</code> before attempting to fill in <code>sb</code>.
If <code>element_name</code> does not match the name of your policy, simply return 0.
Only return nonzero if an error occurs while externalizing the label data.
Once the policy fills in <code>element_data</code>, <code>*claimed</code> should be incremented.</p></div></div><div class=sect3><h4 id=mac-mpo-externalize-socket-label>6.7.2.33. <code>mpo_externalize_socket_label</code><a class=anchor href=#mac-mpo-externalize-socket-label></a></h4><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=c><span class=kt>int</span> <span class=nf>mpo_externalize_socket_label</span><span class=p>(</span><span class=k>struct</span> <span class=n>label</span> <span class=o>*</span><span class=n>label</span><span class=p>,</span> <span class=kt>char</span> <span class=o>*</span><span class=n>element_name</span><span class=p>,</span>
    <span class=k>struct</span> <span class=n>sbuf</span> <span class=o>*</span><span class=n>sb</span><span class=p>,</span> <span class=kt>int</span> <span class=o>*</span><span class=n>claimed</span><span class=p>);</span></code></pre></div></div><table class="tableblock frame-none grid-all stretch informaltable"><col style=width:33.3333%><col style=width:33.3333%><col style=width:33.3334%><thead><tr><th class="tableblock halign-left valign-top">Parameter</th><th class="tableblock halign-left valign-top">Description</th><th class="tableblock halign-left valign-top">Locking</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>label</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Label to be externalized</p></td><td class="tableblock halign-left valign-top"></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>element_name</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Name of the policy whose label should be externalized</p></td><td class="tableblock halign-left valign-top"></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>sb</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>String buffer to be filled with a text representation of label</p></td><td class="tableblock halign-left valign-top"></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>claimed</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Should be incremented when <code>element_data</code> can be filled in.</p></td><td class="tableblock halign-left valign-top"></td></tr></tbody></table><div class=paragraph><p>Produce an externalized label based on the label structure passed.
An externalized label consists of a text representation of the label contents that can be used with userland applications and read by the user.
Currently, all policies' <code>externalize</code> entry points will be called, so the implementation should check the contents of <code>element_name</code> before attempting to fill in <code>sb</code>.
If <code>element_name</code> does not match the name of your policy, simply return 0.
Only return nonzero if an error occurs while externalizing the label data.
Once the policy fills in <code>element_data</code>, <code>*claimed</code> should be incremented.</p></div></div><div class=sect3><h4 id=mac-mpo-externalize-socket-peer-label>6.7.2.34. <code>mpo_externalize_socket_peer_label</code><a class=anchor href=#mac-mpo-externalize-socket-peer-label></a></h4><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=c><span class=kt>int</span> <span class=nf>mpo_externalize_socket_peer_label</span><span class=p>(</span><span class=k>struct</span> <span class=n>label</span> <span class=o>*</span><span class=n>label</span><span class=p>,</span> <span class=kt>char</span> <span class=o>*</span><span class=n>element_name</span><span class=p>,</span>
    <span class=k>struct</span> <span class=n>sbuf</span> <span class=o>*</span><span class=n>sb</span><span class=p>,</span> <span class=kt>int</span> <span class=o>*</span><span class=n>claimed</span><span class=p>);</span></code></pre></div></div><table class="tableblock frame-none grid-all stretch informaltable"><col style=width:33.3333%><col style=width:33.3333%><col style=width:33.3334%><thead><tr><th class="tableblock halign-left valign-top">Parameter</th><th class="tableblock halign-left valign-top">Description</th><th class="tableblock halign-left valign-top">Locking</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>label</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Label to be externalized</p></td><td class="tableblock halign-left valign-top"></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>element_name</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Name of the policy whose label should be externalized</p></td><td class="tableblock halign-left valign-top"></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>sb</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>String buffer to be filled with a text representation of label</p></td><td class="tableblock halign-left valign-top"></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>claimed</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Should be incremented when <code>element_data</code> can be filled in.</p></td><td class="tableblock halign-left valign-top"></td></tr></tbody></table><div class=paragraph><p>Produce an externalized label based on the label structure passed.
An externalized label consists of a text representation of the label contents that can be used with userland applications and read by the user.
Currently, all policies' <code>externalize</code> entry points will be called, so the implementation should check the contents of <code>element_name</code> before attempting to fill in <code>sb</code>.
If <code>element_name</code> does not match the name of your policy, simply return 0.
Only return nonzero if an error occurs while externalizing the label data.
Once the policy fills in <code>element_data</code>, <code>*claimed</code> should be incremented.</p></div></div><div class=sect3><h4 id=mac-mpo-externalize-vnode-label>6.7.2.35. <code>mpo_externalize_vnode_label</code><a class=anchor href=#mac-mpo-externalize-vnode-label></a></h4><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=c><span class=kt>int</span> <span class=nf>mpo_externalize_vnode_label</span><span class=p>(</span><span class=k>struct</span> <span class=n>label</span> <span class=o>*</span><span class=n>label</span><span class=p>,</span> <span class=kt>char</span> <span class=o>*</span><span class=n>element_name</span><span class=p>,</span>
    <span class=k>struct</span> <span class=n>sbuf</span> <span class=o>*</span><span class=n>sb</span><span class=p>,</span> <span class=kt>int</span> <span class=o>*</span><span class=n>claimed</span><span class=p>);</span></code></pre></div></div><table class="tableblock frame-none grid-all stretch informaltable"><col style=width:33.3333%><col style=width:33.3333%><col style=width:33.3334%><thead><tr><th class="tableblock halign-left valign-top">Parameter</th><th class="tableblock halign-left valign-top">Description</th><th class="tableblock halign-left valign-top">Locking</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>label</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Label to be externalized</p></td><td class="tableblock halign-left valign-top"></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>element_name</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Name of the policy whose label should be externalized</p></td><td class="tableblock halign-left valign-top"></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>sb</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>String buffer to be filled with a text representation of label</p></td><td class="tableblock halign-left valign-top"></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>claimed</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Should be incremented when <code>element_data</code> can be filled in.</p></td><td class="tableblock halign-left valign-top"></td></tr></tbody></table><div class=paragraph><p>Produce an externalized label based on the label structure passed.
An externalized label consists of a text representation of the label contents that can be used with userland applications and read by the user.
Currently, all policies' <code>externalize</code> entry points will be called, so the implementation should check the contents of <code>element_name</code> before attempting to fill in <code>sb</code>.
If <code>element_name</code> does not match the name of your policy, simply return 0.
Only return nonzero if an error occurs while externalizing the label data.
Once the policy fills in <code>element_data</code>, <code>*claimed</code> should be incremented.</p></div></div><div class=sect3><h4 id=mac-mpo-internalize-cred-label>6.7.2.36. <code>mpo_internalize_cred_label</code><a class=anchor href=#mac-mpo-internalize-cred-label></a></h4><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=c><span class=kt>int</span> <span class=nf>mpo_internalize_cred_label</span><span class=p>(</span><span class=k>struct</span> <span class=n>label</span> <span class=o>*</span><span class=n>label</span><span class=p>,</span> <span class=kt>char</span> <span class=o>*</span><span class=n>element_name</span><span class=p>,</span>
    <span class=kt>char</span> <span class=o>*</span><span class=n>element_data</span><span class=p>,</span> <span class=kt>int</span> <span class=o>*</span><span class=n>claimed</span><span class=p>);</span></code></pre></div></div><table class="tableblock frame-none grid-all stretch informaltable"><col style=width:33.3333%><col style=width:33.3333%><col style=width:33.3334%><thead><tr><th class="tableblock halign-left valign-top">Parameter</th><th class="tableblock halign-left valign-top">Description</th><th class="tableblock halign-left valign-top">Locking</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>label</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Label to be filled in</p></td><td class="tableblock halign-left valign-top"></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>element_name</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Name of the policy whose label should be internalized</p></td><td class="tableblock halign-left valign-top"></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>element_data</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Text data to be internalized</p></td><td class="tableblock halign-left valign-top"></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>claimed</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Should be incremented when data can be successfully internalized.</p></td><td class="tableblock halign-left valign-top"></td></tr></tbody></table><div class=paragraph><p>Produce an internal label structure based on externalized label data in text format.
Currently, all policies' <code>internalize</code> entry points are called when internalization is requested, so the implementation should compare the contents of <code>element_name</code> to its own name in order to be sure it should be internalizing the data in <code>element_data</code>.
Just as in the <code>externalize</code> entry points, the entry point should return 0 if <code>element_name</code> does not match its own name, or when data can successfully be internalized, in which case <code>*claimed</code> should be incremented.</p></div></div><div class=sect3><h4 id=mac-mpo-internalize-ifnet-label>6.7.2.37. <code>mpo_internalize_ifnet_label</code><a class=anchor href=#mac-mpo-internalize-ifnet-label></a></h4><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=c><span class=kt>int</span> <span class=nf>mpo_internalize_ifnet_label</span><span class=p>(</span><span class=k>struct</span> <span class=n>label</span> <span class=o>*</span><span class=n>label</span><span class=p>,</span> <span class=kt>char</span> <span class=o>*</span><span class=n>element_name</span><span class=p>,</span>
    <span class=kt>char</span> <span class=o>*</span><span class=n>element_data</span><span class=p>,</span> <span class=kt>int</span> <span class=o>*</span><span class=n>claimed</span><span class=p>);</span></code></pre></div></div><table class="tableblock frame-none grid-all stretch informaltable"><col style=width:33.3333%><col style=width:33.3333%><col style=width:33.3334%><thead><tr><th class="tableblock halign-left valign-top">Parameter</th><th class="tableblock halign-left valign-top">Description</th><th class="tableblock halign-left valign-top">Locking</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>label</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Label to be filled in</p></td><td class="tableblock halign-left valign-top"></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>element_name</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Name of the policy whose label should be internalized</p></td><td class="tableblock halign-left valign-top"></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>element_data</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Text data to be internalized</p></td><td class="tableblock halign-left valign-top"></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>claimed</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Should be incremented when data can be successfully internalized.</p></td><td class="tableblock halign-left valign-top"></td></tr></tbody></table><div class=paragraph><p>Produce an internal label structure based on externalized label data in text format.
Currently, all policies' <code>internalize</code> entry points are called when internalization is requested, so the implementation should compare the contents of <code>element_name</code> to its own name in order to be sure it should be internalizing the data in <code>element_data</code>.
Just as in the <code>externalize</code> entry points, the entry point should return 0 if <code>element_name</code> does not match its own name, or when data can successfully be internalized, in which case <code>*claimed</code> should be incremented.</p></div></div><div class=sect3><h4 id=mac-mpo-internalize-pipe-label>6.7.2.38. <code>mpo_internalize_pipe_label</code><a class=anchor href=#mac-mpo-internalize-pipe-label></a></h4><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=c><span class=kt>int</span> <span class=nf>mpo_internalize_pipe_label</span><span class=p>(</span><span class=k>struct</span> <span class=n>label</span> <span class=o>*</span><span class=n>label</span><span class=p>,</span> <span class=kt>char</span> <span class=o>*</span><span class=n>element_name</span><span class=p>,</span>
    <span class=kt>char</span> <span class=o>*</span><span class=n>element_data</span><span class=p>,</span> <span class=kt>int</span> <span class=o>*</span><span class=n>claimed</span><span class=p>);</span></code></pre></div></div><table class="tableblock frame-none grid-all stretch informaltable"><col style=width:33.3333%><col style=width:33.3333%><col style=width:33.3334%><thead><tr><th class="tableblock halign-left valign-top">Parameter</th><th class="tableblock halign-left valign-top">Description</th><th class="tableblock halign-left valign-top">Locking</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>label</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Label to be filled in</p></td><td class="tableblock halign-left valign-top"></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>element_name</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Name of the policy whose label should be internalized</p></td><td class="tableblock halign-left valign-top"></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>element_data</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Text data to be internalized</p></td><td class="tableblock halign-left valign-top"></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>claimed</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Should be incremented when data can be successfully internalized.</p></td><td class="tableblock halign-left valign-top"></td></tr></tbody></table><div class=paragraph><p>Produce an internal label structure based on externalized label data in text format.
Currently, all policies' <code>internalize</code> entry points are called when internalization is requested, so the implementation should compare the contents of <code>element_name</code> to its own name in order to be sure it should be internalizing the data in <code>element_data</code>.
Just as in the <code>externalize</code> entry points, the entry point should return 0 if <code>element_name</code> does not match its own name, or when data can successfully be internalized, in which case <code>*claimed</code> should be incremented.</p></div></div><div class=sect3><h4 id=mac-mpo-internalize-socket-label>6.7.2.39. <code>mpo_internalize_socket_label</code><a class=anchor href=#mac-mpo-internalize-socket-label></a></h4><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=c><span class=kt>int</span> <span class=nf>mpo_internalize_socket_label</span><span class=p>(</span><span class=k>struct</span> <span class=n>label</span> <span class=o>*</span><span class=n>label</span><span class=p>,</span> <span class=kt>char</span> <span class=o>*</span><span class=n>element_name</span><span class=p>,</span>
    <span class=kt>char</span> <span class=o>*</span><span class=n>element_data</span><span class=p>,</span> <span class=kt>int</span> <span class=o>*</span><span class=n>claimed</span><span class=p>);</span></code></pre></div></div><table class="tableblock frame-none grid-all stretch informaltable"><col style=width:33.3333%><col style=width:33.3333%><col style=width:33.3334%><thead><tr><th class="tableblock halign-left valign-top">Parameter</th><th class="tableblock halign-left valign-top">Description</th><th class="tableblock halign-left valign-top">Locking</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>label</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Label to be filled in</p></td><td class="tableblock halign-left valign-top"></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>element_name</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Name of the policy whose label should be internalized</p></td><td class="tableblock halign-left valign-top"></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>element_data</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Text data to be internalized</p></td><td class="tableblock halign-left valign-top"></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>claimed</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Should be incremented when data can be successfully internalized.</p></td><td class="tableblock halign-left valign-top"></td></tr></tbody></table><div class=paragraph><p>Produce an internal label structure based on externalized label data in text format.
Currently, all policies' <code>internalize</code> entry points are called when internalization is requested, so the implementation should compare the contents of <code>element_name</code> to its own name in order to be sure it should be internalizing the data in <code>element_data</code>.
Just as in the <code>externalize</code> entry points, the entry point should return 0 if <code>element_name</code> does not match its own name, or when data can successfully be internalized, in which case <code>*claimed</code> should be incremented.</p></div></div><div class=sect3><h4 id=mac-mpo-internalize-vnode-label>6.7.2.40. <code>mpo_internalize_vnode_label</code><a class=anchor href=#mac-mpo-internalize-vnode-label></a></h4><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=c><span class=kt>int</span> <span class=nf>mpo_internalize_vnode_label</span><span class=p>(</span><span class=k>struct</span> <span class=n>label</span> <span class=o>*</span><span class=n>label</span><span class=p>,</span> <span class=kt>char</span> <span class=o>*</span><span class=n>element_name</span><span class=p>,</span>
    <span class=kt>char</span> <span class=o>*</span><span class=n>element_data</span><span class=p>,</span> <span class=kt>int</span> <span class=o>*</span><span class=n>claimed</span><span class=p>);</span></code></pre></div></div><table class="tableblock frame-none grid-all stretch informaltable"><col style=width:33.3333%><col style=width:33.3333%><col style=width:33.3334%><thead><tr><th class="tableblock halign-left valign-top">Parameter</th><th class="tableblock halign-left valign-top">Description</th><th class="tableblock halign-left valign-top">Locking</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>label</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Label to be filled in</p></td><td class="tableblock halign-left valign-top"></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>element_name</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Name of the policy whose label should be internalized</p></td><td class="tableblock halign-left valign-top"></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>element_data</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Text data to be internalized</p></td><td class="tableblock halign-left valign-top"></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>claimed</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Should be incremented when data can be successfully internalized.</p></td><td class="tableblock halign-left valign-top"></td></tr></tbody></table><div class=paragraph><p>Produce an internal label structure based on externalized label data in text format.
Currently, all policies' <code>internalize</code> entry points are called when internalization is requested, so the implementation should compare the contents of <code>element_name</code> to its own name in order to be sure it should be internalizing the data in <code>element_data</code>.
Just as in the <code>externalize</code> entry points, the entry point should return 0 if <code>element_name</code> does not match its own name, or when data can successfully be internalized, in which case <code>*claimed</code> should be incremented.</p></div></div></div><div class=sect2><h3 id=mac-label-events>6.7.3. Label Events<a class=anchor href=#mac-label-events></a></h3><div class=paragraph><p>This class of entry points is used by the MAC framework to permit policies to maintain label information on kernel objects.
For each labeled kernel object of interest to a MAC policy, entry points may be registered for relevant life cycle events.
All objects implement initialization, creation, and destruction hooks.
Some objects will also implement relabeling, allowing user processes to change the labels on objects.
Some objects will also implement object-specific events, such as label events associated with IP reassembly.
A typical labeled object will have the following life cycle of entry points:</p></div><div class="literalblock programlisting"><div class=content><pre>Label initialization          o
(object-specific wait)         \
Label creation                  o
                                 \
Relabel events,                   o--&lt;--.
Various object-specific,          |     |
Access control events             ~--&gt;--o
                                         \
Label destruction                         o</pre></div></div><div class=paragraph><p>Label initialization permits policies to allocate memory and set initial values for labels without context for the use of the object.
The label slot allocated to a policy will be zeroed by default, so some policies may not need to perform initialization.</p></div><div class=paragraph><p>Label creation occurs when the kernel structure is associated with an actual kernel object.
For example, Mbufs may be allocated and remain unused in a pool until they are required.
mbuf allocation causes label initialization on the mbuf to take place, but mbuf creation occurs when the mbuf is associated with a datagram.
Typically, context will be provided for a creation event, including the circumstances of the creation, and labels of other relevant objects in the creation process.
For example, when an mbuf is created from a socket, the socket and its label will be presented to registered policies in addition to the new mbuf and its label.
Memory allocation in creation events is discouraged, as it may occur in performance sensitive ports of the kernel; in addition, creation calls are not permitted to fail so a failure to allocate memory cannot be reported.</p></div><div class=paragraph><p>Object specific events do not generally fall into the other broad classes of label events, but will generally provide an opportunity to modify or update the label on an object based on additional context.
For example, the label on an IP fragment reassembly queue may be updated during the MAC_UPDATE_IPQ entry point as a result of the acceptance of an additional mbuf to that queue.</p></div><div class=paragraph><p>Access control events are discussed in detail in the following section.</p></div><div class=paragraph><p>Label destruction permits policies to release storage or state associated with a label during its association with an object so that the kernel data structures supporting the object may be reused or released.</p></div><div class=paragraph><p>In addition to labels associated with specific kernel objects, an additional class of labels exists: temporary labels.
These labels are used to store update information submitted by user processes.
These labels are initialized and destroyed as with other label types, but the creation event is MAC_INTERNALIZE, which accepts a user label to be converted to an in-kernel representation.</p></div><div class=sect3><h4 id=mac-fs-label-event-ops>6.7.3.1. File System Object Labeling Event Operations<a class=anchor href=#mac-fs-label-event-ops></a></h4><div class=sect4><h5 id=mac-mpo-associate-vnode-devfs>6.7.3.1.1. <code>mpo_associate_vnode_devfs</code><a class=anchor href=#mac-mpo-associate-vnode-devfs></a></h5><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=c><span class=kt>void</span> <span class=nf>mpo_associate_vnode_devfs</span><span class=p>(</span><span class=k>struct</span> <span class=n>mount</span> <span class=o>*</span><span class=n>mp</span><span class=p>,</span> <span class=k>struct</span> <span class=n>label</span> <span class=o>*</span><span class=n>fslabel</span><span class=p>,</span>
    <span class=k>struct</span> <span class=n>devfs_dirent</span> <span class=o>*</span><span class=n>de</span><span class=p>,</span> <span class=k>struct</span> <span class=n>label</span> <span class=o>*</span><span class=n>delabel</span><span class=p>,</span> <span class=k>struct</span> <span class=n>vnode</span> <span class=o>*</span><span class=n>vp</span><span class=p>,</span>
    <span class=k>struct</span> <span class=n>label</span> <span class=o>*</span><span class=n>vlabel</span><span class=p>);</span></code></pre></div></div><table class="tableblock frame-none grid-all stretch informaltable"><col style=width:33.3333%><col style=width:33.3333%><col style=width:33.3334%><thead><tr><th class="tableblock halign-left valign-top">Parameter</th><th class="tableblock halign-left valign-top">Description</th><th class="tableblock halign-left valign-top">Locking</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>mp</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Devfs mount point</p></td><td class="tableblock halign-left valign-top"></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>fslabel</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Devfs file system label (<code>mp→mnt_fslabel</code>)</p></td><td class="tableblock halign-left valign-top"></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>de</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Devfs directory entry</p></td><td class="tableblock halign-left valign-top"></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>delabel</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Policy label associated with <code>de</code></p></td><td class="tableblock halign-left valign-top"></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>vp</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>vnode associated with <code>de</code></p></td><td class="tableblock halign-left valign-top"></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>vlabel</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Policy label associated with <code>vp</code></p></td><td class="tableblock halign-left valign-top"></td></tr></tbody></table><div class=paragraph><p>Fill in the label (<code>vlabel</code>) for a newly created devfs vnode based on the devfs directory entry passed in <code>de</code> and its label.</p></div></div><div class=sect4><h5 id=mac-mpo-associate-vnode-extattr>6.7.3.1.2. <code>mpo_associate_vnode_extattr</code><a class=anchor href=#mac-mpo-associate-vnode-extattr></a></h5><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=c><span class=kt>int</span> <span class=nf>mpo_associate_vnode_extattr</span><span class=p>(</span><span class=k>struct</span> <span class=n>mount</span> <span class=o>*</span><span class=n>mp</span><span class=p>,</span> <span class=k>struct</span> <span class=n>label</span> <span class=o>*</span><span class=n>fslabel</span><span class=p>,</span>
    <span class=k>struct</span> <span class=n>vnode</span> <span class=o>*</span><span class=n>vp</span><span class=p>,</span> <span class=k>struct</span> <span class=n>label</span> <span class=o>*</span><span class=n>vlabel</span><span class=p>);</span></code></pre></div></div><table class="tableblock frame-none grid-all stretch informaltable"><col style=width:33.3333%><col style=width:33.3333%><col style=width:33.3334%><thead><tr><th class="tableblock halign-left valign-top">Parameter</th><th class="tableblock halign-left valign-top">Description</th><th class="tableblock halign-left valign-top">Locking</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>mp</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>File system mount point</p></td><td class="tableblock halign-left valign-top"></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>fslabel</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>File system label</p></td><td class="tableblock halign-left valign-top"></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>vp</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Vnode to label</p></td><td class="tableblock halign-left valign-top"></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>vlabel</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Policy label associated with <code>vp</code></p></td><td class="tableblock halign-left valign-top"></td></tr></tbody></table><div class=paragraph><p>Attempt to retrieve the label for <code>vp</code> from the file system extended attributes.
Upon success, the value <code>0</code> is returned.
Should extended attribute retrieval not be supported, an accepted fallback is to copy <code>fslabel</code> into <code>vlabel</code>.
In the event of an error, an appropriate value for <code>errno</code> should be returned.</p></div></div><div class=sect4><h5 id=mac-mpo-associate-vnode-singlelabel>6.7.3.1.3. <code>mpo_associate_vnode_singlelabel</code><a class=anchor href=#mac-mpo-associate-vnode-singlelabel></a></h5><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=c><span class=kt>void</span> <span class=nf>mpo_associate_vnode_singlelabel</span><span class=p>(</span><span class=k>struct</span> <span class=n>mount</span> <span class=o>*</span><span class=n>mp</span><span class=p>,</span> <span class=k>struct</span> <span class=n>label</span> <span class=o>*</span><span class=n>fslabel</span><span class=p>,</span>
    <span class=k>struct</span> <span class=n>vnode</span> <span class=o>*</span><span class=n>vp</span><span class=p>,</span> <span class=k>struct</span> <span class=n>label</span> <span class=o>*</span><span class=n>vlabel</span><span class=p>);</span></code></pre></div></div><table class="tableblock frame-none grid-all stretch informaltable"><col style=width:33.3333%><col style=width:33.3333%><col style=width:33.3334%><thead><tr><th class="tableblock halign-left valign-top">Parameter</th><th class="tableblock halign-left valign-top">Description</th><th class="tableblock halign-left valign-top">Locking</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>mp</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>File system mount point</p></td><td class="tableblock halign-left valign-top"></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>fslabel</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>File system label</p></td><td class="tableblock halign-left valign-top"></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>vp</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Vnode to label</p></td><td class="tableblock halign-left valign-top"></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>vlabel</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Policy label associated with <code>vp</code></p></td><td class="tableblock halign-left valign-top"></td></tr></tbody></table><div class=paragraph><p>On non-multilabel file systems, this entry point is called to set the policy label for <code>vp</code> based on the file system label, <code>fslabel</code>.</p></div></div><div class=sect4><h5 id=mac-mpo-create-devfs-device>6.7.3.1.4. <code>mpo_create_devfs_device</code><a class=anchor href=#mac-mpo-create-devfs-device></a></h5><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=c><span class=kt>void</span> <span class=nf>mpo_create_devfs_device</span><span class=p>(</span><span class=n>dev_t</span> <span class=n>dev</span><span class=p>,</span> <span class=k>struct</span> <span class=n>devfs_dirent</span> <span class=o>*</span><span class=n>devfs_dirent</span><span class=p>,</span>
    <span class=k>struct</span> <span class=n>label</span> <span class=o>*</span><span class=n>label</span><span class=p>);</span></code></pre></div></div><table class="tableblock frame-none grid-all stretch informaltable"><col style=width:33.3333%><col style=width:33.3333%><col style=width:33.3334%><thead><tr><th class="tableblock halign-left valign-top">Parameter</th><th class="tableblock halign-left valign-top">Description</th><th class="tableblock halign-left valign-top">Locking</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>dev</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Device corresponding with <code>devfs_dirent</code></p></td><td class="tableblock halign-left valign-top"></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>devfs_dirent</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Devfs directory entry to be labeled.</p></td><td class="tableblock halign-left valign-top"></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>label</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Label for <code>devfs_dirent</code> to be filled in.</p></td><td class="tableblock halign-left valign-top"></td></tr></tbody></table><div class=paragraph><p>Fill out the label on a devfs_dirent being created for the passed device.
This call will be made when the device file system is mounted, regenerated, or a new device is made available.</p></div></div><div class=sect4><h5 id=mac-mpo-create-devfs-directory>6.7.3.1.5. <code>mpo_create_devfs_directory</code><a class=anchor href=#mac-mpo-create-devfs-directory></a></h5><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=c><span class=kt>void</span> <span class=nf>mpo_create_devfs_directory</span><span class=p>(</span><span class=kt>char</span> <span class=o>*</span><span class=n>dirname</span><span class=p>,</span> <span class=kt>int</span> <span class=n>dirnamelen</span><span class=p>,</span>
    <span class=k>struct</span> <span class=n>devfs_dirent</span> <span class=o>*</span><span class=n>devfs_dirent</span><span class=p>,</span> <span class=k>struct</span> <span class=n>label</span> <span class=o>*</span><span class=n>label</span><span class=p>);</span></code></pre></div></div><table class="tableblock frame-none grid-all stretch informaltable"><col style=width:33.3333%><col style=width:33.3333%><col style=width:33.3334%><thead><tr><th class="tableblock halign-left valign-top">Parameter</th><th class="tableblock halign-left valign-top">Description</th><th class="tableblock halign-left valign-top">Locking</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>dirname</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Name of directory being created</p></td><td class="tableblock halign-left valign-top"></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>namelen</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Length of string <code>dirname</code></p></td><td class="tableblock halign-left valign-top"></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>devfs_dirent</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Devfs directory entry for directory being created.</p></td><td class="tableblock halign-left valign-top"></td></tr></tbody></table><div class=paragraph><p>Fill out the label on a devfs_dirent being created for the passed directory.
This call will be made when the device file system is mounted, regenerated, or a new device requiring a specific directory hierarchy is made available.</p></div></div><div class=sect4><h5 id=mac-mpo-create-devfs-symlink>6.7.3.1.6. <code>mpo_create_devfs_symlink</code><a class=anchor href=#mac-mpo-create-devfs-symlink></a></h5><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=c><span class=kt>void</span> <span class=nf>mpo_create_devfs_symlink</span><span class=p>(</span><span class=k>struct</span> <span class=n>ucred</span> <span class=o>*</span><span class=n>cred</span><span class=p>,</span> <span class=k>struct</span> <span class=n>mount</span> <span class=o>*</span><span class=n>mp</span><span class=p>,</span>
    <span class=k>struct</span> <span class=n>devfs_dirent</span> <span class=o>*</span><span class=n>dd</span><span class=p>,</span> <span class=k>struct</span> <span class=n>label</span> <span class=o>*</span><span class=n>ddlabel</span><span class=p>,</span> <span class=k>struct</span> <span class=n>devfs_dirent</span> <span class=o>*</span><span class=n>de</span><span class=p>,</span>
    <span class=k>struct</span> <span class=n>label</span> <span class=o>*</span><span class=n>delabel</span><span class=p>);</span></code></pre></div></div><table class="tableblock frame-none grid-all stretch informaltable"><col style=width:33.3333%><col style=width:33.3333%><col style=width:33.3334%><thead><tr><th class="tableblock halign-left valign-top">Parameter</th><th class="tableblock halign-left valign-top">Description</th><th class="tableblock halign-left valign-top">Locking</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>cred</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Subject credential</p></td><td class="tableblock halign-left valign-top"></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>mp</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Devfs mount point</p></td><td class="tableblock halign-left valign-top"></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>dd</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Link destination</p></td><td class="tableblock halign-left valign-top"></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>ddlabel</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Label associated with <code>dd</code></p></td><td class="tableblock halign-left valign-top"></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>de</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Symlink entry</p></td><td class="tableblock halign-left valign-top"></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>delabel</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Label associated with <code>de</code></p></td><td class="tableblock halign-left valign-top"></td></tr></tbody></table><div class=paragraph><p>Fill in the label (<code>delabel</code>) for a newly created <a href="https://man.freebsd.org/cgi/man.cgi?query=devfs&amp;sektion=5&amp;format=html">devfs(5)</a> symbolic link entry.</p></div></div><div class=sect4><h5 id=mac-mpo-create-vnode-extattr>6.7.3.1.7. <code>mpo_create_vnode_extattr</code><a class=anchor href=#mac-mpo-create-vnode-extattr></a></h5><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=c><span class=kt>int</span> <span class=nf>mpo_create_vnode_extattr</span><span class=p>(</span><span class=k>struct</span> <span class=n>ucred</span> <span class=o>*</span><span class=n>cred</span><span class=p>,</span> <span class=k>struct</span> <span class=n>mount</span> <span class=o>*</span><span class=n>mp</span><span class=p>,</span>
    <span class=k>struct</span> <span class=n>label</span> <span class=o>*</span><span class=n>fslabel</span><span class=p>,</span> <span class=k>struct</span> <span class=n>vnode</span> <span class=o>*</span><span class=n>dvp</span><span class=p>,</span> <span class=k>struct</span> <span class=n>label</span> <span class=o>*</span><span class=n>dlabel</span><span class=p>,</span>
    <span class=k>struct</span> <span class=n>vnode</span> <span class=o>*</span><span class=n>vp</span><span class=p>,</span> <span class=k>struct</span> <span class=n>label</span> <span class=o>*</span><span class=n>vlabel</span><span class=p>,</span> <span class=k>struct</span> <span class=n>componentname</span> <span class=o>*</span><span class=n>cnp</span><span class=p>);</span></code></pre></div></div><table class="tableblock frame-none grid-all stretch informaltable"><col style=width:33.3333%><col style=width:33.3333%><col style=width:33.3334%><thead><tr><th class="tableblock halign-left valign-top">Parameter</th><th class="tableblock halign-left valign-top">Description</th><th class="tableblock halign-left valign-top">Locking</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>cred</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Subject credential</p></td><td class="tableblock halign-left valign-top"></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>mount</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>File system mount point</p></td><td class="tableblock halign-left valign-top"></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>label</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>File system label</p></td><td class="tableblock halign-left valign-top"></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>dvp</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Parent directory vnode</p></td><td class="tableblock halign-left valign-top"></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>dlabel</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Label associated with <code>dvp</code></p></td><td class="tableblock halign-left valign-top"></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>vp</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Newly created vnode</p></td><td class="tableblock halign-left valign-top"></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>vlabel</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Policy label associated with <code>vp</code></p></td><td class="tableblock halign-left valign-top"></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>cnp</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Component name for <code>vp</code></p></td><td class="tableblock halign-left valign-top"></td></tr></tbody></table><div class=paragraph><p>Write out the label for <code>vp</code> to the appropriate extended attribute.
If the write succeeds, fill in <code>vlabel</code> with the label, and return 0.
Otherwise, return an appropriate error.</p></div></div><div class=sect4><h5 id=mac-mpo-create-mount>6.7.3.1.8. <code>mpo_create_mount</code><a class=anchor href=#mac-mpo-create-mount></a></h5><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=c><span class=kt>void</span> <span class=nf>mpo_create_mount</span><span class=p>(</span><span class=k>struct</span> <span class=n>ucred</span> <span class=o>*</span><span class=n>cred</span><span class=p>,</span> <span class=k>struct</span> <span class=n>mount</span> <span class=o>*</span><span class=n>mp</span><span class=p>,</span> <span class=k>struct</span> <span class=n>label</span> <span class=o>*</span><span class=n>mnt</span><span class=p>,</span>
    <span class=k>struct</span> <span class=n>label</span> <span class=o>*</span><span class=n>fslabel</span><span class=p>);</span></code></pre></div></div><table class="tableblock frame-none grid-all stretch informaltable"><col style=width:33.3333%><col style=width:33.3333%><col style=width:33.3334%><thead><tr><th class="tableblock halign-left valign-top">Parameter</th><th class="tableblock halign-left valign-top">Description</th><th class="tableblock halign-left valign-top">Locking</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>cred</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Subject credential</p></td><td class="tableblock halign-left valign-top"></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>mp</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Object; file system being mounted</p></td><td class="tableblock halign-left valign-top"></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>mntlabel</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Policy label to be filled in for <code>mp</code></p></td><td class="tableblock halign-left valign-top"></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>fslabel</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Policy label for the file system <code>mp</code> mounts.</p></td><td class="tableblock halign-left valign-top"></td></tr></tbody></table><div class=paragraph><p>Fill out the labels on the mount point being created by the passed subject credential.
This call will be made when a new file system is mounted.</p></div></div><div class=sect4><h5 id=mac-mpo-create-root-mount>6.7.3.1.9. <code>mpo_create_root_mount</code><a class=anchor href=#mac-mpo-create-root-mount></a></h5><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=c><span class=kt>void</span> <span class=nf>mpo_create_root_mount</span><span class=p>(</span><span class=k>struct</span> <span class=n>ucred</span> <span class=o>*</span><span class=n>cred</span><span class=p>,</span> <span class=k>struct</span> <span class=n>mount</span> <span class=o>*</span><span class=n>mp</span><span class=p>,</span>
    <span class=k>struct</span> <span class=n>label</span> <span class=o>*</span><span class=n>mntlabel</span><span class=p>,</span> <span class=k>struct</span> <span class=n>label</span> <span class=o>*</span><span class=n>fslabel</span><span class=p>);</span></code></pre></div></div><table class="tableblock frame-none grid-all stretch informaltable"><col style=width:33.3333%><col style=width:33.3333%><col style=width:33.3334%><thead><tr><th class="tableblock halign-left valign-top">Parameter</th><th class="tableblock halign-left valign-top">Description</th><th class="tableblock halign-left valign-top">Locking</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top" colspan=3><p class=tableblock>See <a href=../mac/#mac-mpo-create-mount><code>mpo_create_mount</code></a>.</p></td></tr></tbody></table><div class=paragraph><p>Fill out the labels on the mount point being created by the passed subject credential.
This call will be made when the root file system is mounted, after <code>mpo_create_mount;</code>.</p></div></div><div class=sect4><h5 id=mac-mpo-relabel-vnode>6.7.3.1.10. <code>mpo_relabel_vnode</code><a class=anchor href=#mac-mpo-relabel-vnode></a></h5><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=c><span class=kt>void</span> <span class=nf>mpo_relabel_vnode</span><span class=p>(</span><span class=k>struct</span> <span class=n>ucred</span> <span class=o>*</span><span class=n>cred</span><span class=p>,</span> <span class=k>struct</span> <span class=n>vnode</span> <span class=o>*</span><span class=n>vp</span><span class=p>,</span>
    <span class=k>struct</span> <span class=n>label</span> <span class=o>*</span><span class=n>vnodelabel</span><span class=p>,</span> <span class=k>struct</span> <span class=n>label</span> <span class=o>*</span><span class=n>newlabel</span><span class=p>);</span></code></pre></div></div><table class="tableblock frame-none grid-all stretch informaltable"><col style=width:33.3333%><col style=width:33.3333%><col style=width:33.3334%><thead><tr><th class="tableblock halign-left valign-top">Parameter</th><th class="tableblock halign-left valign-top">Description</th><th class="tableblock halign-left valign-top">Locking</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>cred</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Subject credential</p></td><td class="tableblock halign-left valign-top"></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>vp</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>vnode to relabel</p></td><td class="tableblock halign-left valign-top"></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>vnodelabel</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Existing policy label for <code>vp</code></p></td><td class="tableblock halign-left valign-top"></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>newlabel</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>New, possibly partial label to replace <code>vnodelabel</code></p></td><td class="tableblock halign-left valign-top"></td></tr></tbody></table><div class=paragraph><p>Update the label on the passed vnode given the passed update vnode label and the passed subject credential.</p></div></div><div class=sect4><h5 id=mac-mpo-setlabel-vnode-extattr>6.7.3.1.11. <code>mpo_setlabel_vnode_extattr</code><a class=anchor href=#mac-mpo-setlabel-vnode-extattr></a></h5><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=c><span class=kt>int</span> <span class=nf>mpo_setlabel_vnode_extattr</span><span class=p>(</span><span class=k>struct</span> <span class=n>ucred</span> <span class=o>*</span><span class=n>cred</span><span class=p>,</span> <span class=k>struct</span> <span class=n>vnode</span> <span class=o>*</span><span class=n>vp</span><span class=p>,</span>
    <span class=k>struct</span> <span class=n>label</span> <span class=o>*</span><span class=n>vlabel</span><span class=p>,</span> <span class=k>struct</span> <span class=n>label</span> <span class=o>*</span><span class=n>intlabel</span><span class=p>);</span></code></pre></div></div><table class="tableblock frame-none grid-all stretch informaltable"><col style=width:33.3333%><col style=width:33.3333%><col style=width:33.3334%><thead><tr><th class="tableblock halign-left valign-top">Parameter</th><th class="tableblock halign-left valign-top">Description</th><th class="tableblock halign-left valign-top">Locking</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>cred</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Subject credential</p></td><td class="tableblock halign-left valign-top"></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>vp</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Vnode for which the label is being written</p></td><td class="tableblock halign-left valign-top"></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>vlabel</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Policy label associated with <code>vp</code></p></td><td class="tableblock halign-left valign-top"></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>intlabel</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Label to write out</p></td><td class="tableblock halign-left valign-top"></td></tr></tbody></table><div class=paragraph><p>Write out the policy from <code>intlabel</code> to an extended attribute.
This is called from <code>vop_stdcreatevnode_ea</code>.</p></div></div><div class=sect4><h5 id=mac-mpo-update-devfsdirent>6.7.3.1.12. <code>mpo_update_devfsdirent</code><a class=anchor href=#mac-mpo-update-devfsdirent></a></h5><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=c><span class=kt>void</span> <span class=nf>mpo_update_devfsdirent</span><span class=p>(</span><span class=k>struct</span> <span class=n>devfs_dirent</span> <span class=o>*</span><span class=n>devfs_dirent</span><span class=p>,</span>
    <span class=k>struct</span> <span class=n>label</span> <span class=o>*</span><span class=n>direntlabel</span><span class=p>,</span> <span class=k>struct</span> <span class=n>vnode</span> <span class=o>*</span><span class=n>vp</span><span class=p>,</span> <span class=k>struct</span> <span class=n>label</span> <span class=o>*</span><span class=n>vnodelabel</span><span class=p>);</span></code></pre></div></div><table class="tableblock frame-none grid-all stretch informaltable"><col style=width:33.3333%><col style=width:33.3333%><col style=width:33.3334%><thead><tr><th class="tableblock halign-left valign-top">Parameter</th><th class="tableblock halign-left valign-top">Description</th><th class="tableblock halign-left valign-top">Locking</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>devfs_dirent</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Object; devfs directory entry</p></td><td class="tableblock halign-left valign-top"></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>direntlabel</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Policy label for <code>devfs_dirent</code> to be updated.</p></td><td class="tableblock halign-left valign-top"></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>vp</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Parent vnode</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Locked</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>vnodelabel</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Policy label for <code>vp</code></p></td><td class="tableblock halign-left valign-top"></td></tr></tbody></table><div class=paragraph><p>Update the <code>devfs_dirent</code> label from the passed devfs vnode label.
This call will be made when a devfs vnode has been successfully relabeled to commit the label change such that it lasts even if the vnode is recycled.
It will also be made when a symlink is created in devfs, following a call to <code>mac_vnode_create_from_vnode</code> to initialize the vnode label.</p></div></div></div><div class=sect3><h4 id=mac-ipc-label-ops>6.7.3.2. IPC Object Labeling Event Operations<a class=anchor href=#mac-ipc-label-ops></a></h4><div class=sect4><h5 id=mac-mpo-create-mbuf-from-socket>6.7.3.2.1. <code>mpo_create_mbuf_from_socket</code><a class=anchor href=#mac-mpo-create-mbuf-from-socket></a></h5><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=c><span class=kt>void</span> <span class=nf>mpo_create_mbuf_from_socket</span><span class=p>(</span><span class=k>struct</span> <span class=n>socket</span> <span class=o>*</span><span class=n>so</span><span class=p>,</span> <span class=k>struct</span> <span class=n>label</span> <span class=o>*</span><span class=n>socketlabel</span><span class=p>,</span>
    <span class=k>struct</span> <span class=n>mbuf</span> <span class=o>*</span><span class=n>m</span><span class=p>,</span> <span class=k>struct</span> <span class=n>label</span> <span class=o>*</span><span class=n>mbuflabel</span><span class=p>);</span></code></pre></div></div><table class="tableblock frame-none grid-all stretch informaltable"><col style=width:33.3333%><col style=width:33.3333%><col style=width:33.3334%><thead><tr><th class="tableblock halign-left valign-top">Parameter</th><th class="tableblock halign-left valign-top">Description</th><th class="tableblock halign-left valign-top">Locking</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>socket</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Socket</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Socket locking WIP</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>socketlabel</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Policy label for <code>socket</code></p></td><td class="tableblock halign-left valign-top"></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>m</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Object; mbuf</p></td><td class="tableblock halign-left valign-top"></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>mbuflabel</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Policy label to fill in for <code>m</code></p></td><td class="tableblock halign-left valign-top"></td></tr></tbody></table><div class=paragraph><p>Set the label on a newly created mbuf header from the passed socket label.
This call is made when a new datagram or message is generated by the socket and stored in the passed mbuf.</p></div></div><div class=sect4><h5 id=mac-mpo-create-pipe>6.7.3.2.2. <code>mpo_create_pipe</code><a class=anchor href=#mac-mpo-create-pipe></a></h5><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=c><span class=kt>void</span> <span class=nf>mpo_create_pipe</span><span class=p>(</span><span class=k>struct</span> <span class=n>ucred</span> <span class=o>*</span><span class=n>cred</span><span class=p>,</span> <span class=k>struct</span> <span class=n>pipe</span> <span class=o>*</span><span class=n>pipe</span><span class=p>,</span>
    <span class=k>struct</span> <span class=n>label</span> <span class=o>*</span><span class=n>pipelabel</span><span class=p>);</span></code></pre></div></div><table class="tableblock frame-none grid-all stretch informaltable"><col style=width:33.3333%><col style=width:33.3333%><col style=width:33.3334%><thead><tr><th class="tableblock halign-left valign-top">Parameter</th><th class="tableblock halign-left valign-top">Description</th><th class="tableblock halign-left valign-top">Locking</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>cred</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Subject credential</p></td><td class="tableblock halign-left valign-top"></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>pipe</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Pipe</p></td><td class="tableblock halign-left valign-top"></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>pipelabel</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Policy label associated with <code>pipe</code></p></td><td class="tableblock halign-left valign-top"></td></tr></tbody></table><div class=paragraph><p>Set the label on a newly created pipe from the passed subject credential.
This call is made when a new pipe is created.</p></div></div><div class=sect4><h5 id=mac-mpo-create-socket>6.7.3.2.3. <code>mpo_create_socket</code><a class=anchor href=#mac-mpo-create-socket></a></h5><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=c><span class=kt>void</span> <span class=nf>mpo_create_socket</span><span class=p>(</span><span class=k>struct</span> <span class=n>ucred</span> <span class=o>*</span><span class=n>cred</span><span class=p>,</span> <span class=k>struct</span> <span class=n>socket</span> <span class=o>*</span><span class=n>so</span><span class=p>,</span>
    <span class=k>struct</span> <span class=n>label</span> <span class=o>*</span><span class=n>socketlabel</span><span class=p>);</span></code></pre></div></div><table class="tableblock frame-none grid-all stretch informaltable"><col style=width:33.3333%><col style=width:33.3333%><col style=width:33.3334%><thead><tr><th class="tableblock halign-left valign-top">Parameter</th><th class="tableblock halign-left valign-top">Description</th><th class="tableblock halign-left valign-top">Locking</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>cred</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Subject credential</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Immutable</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>so</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Object; socket to label</p></td><td class="tableblock halign-left valign-top"></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>socketlabel</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Label to fill in for <code>so</code></p></td><td class="tableblock halign-left valign-top"></td></tr></tbody></table><div class=paragraph><p>Set the label on a newly created socket from the passed subject credential.
This call is made when a socket is created.</p></div></div><div class=sect4><h5 id=mac-mpo-create-socket-from-socket>6.7.3.2.4. <code>mpo_create_socket_from_socket</code><a class=anchor href=#mac-mpo-create-socket-from-socket></a></h5><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=c><span class=kt>void</span> <span class=nf>mpo_create_socket_from_socket</span><span class=p>(</span><span class=k>struct</span> <span class=n>socket</span> <span class=o>*</span><span class=n>oldsocket</span><span class=p>,</span>
    <span class=k>struct</span> <span class=n>label</span> <span class=o>*</span><span class=n>oldsocketlabel</span><span class=p>,</span> <span class=k>struct</span> <span class=n>socket</span> <span class=o>*</span><span class=n>newsocket</span><span class=p>,</span>
    <span class=k>struct</span> <span class=n>label</span> <span class=o>*</span><span class=n>newsocketlabel</span><span class=p>);</span></code></pre></div></div><table class="tableblock frame-none grid-all stretch informaltable"><col style=width:33.3333%><col style=width:33.3333%><col style=width:33.3334%><thead><tr><th class="tableblock halign-left valign-top">Parameter</th><th class="tableblock halign-left valign-top">Description</th><th class="tableblock halign-left valign-top">Locking</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>oldsocket</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Listening socket</p></td><td class="tableblock halign-left valign-top"></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>oldsocketlabel</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Policy label associated with <code>oldsocket</code></p></td><td class="tableblock halign-left valign-top"></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>newsocket</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>New socket</p></td><td class="tableblock halign-left valign-top"></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>newsocketlabel</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Policy label associated with <code>newsocketlabel</code></p></td><td class="tableblock halign-left valign-top"></td></tr></tbody></table><div class=paragraph><p>Label a socket, <code>newsocket</code>, newly <a href="https://man.freebsd.org/cgi/man.cgi?query=accept&amp;sektion=2&amp;format=html">accept(2)</a>ed, based on the <a href="https://man.freebsd.org/cgi/man.cgi?query=listen&amp;sektion=2&amp;format=html">listen(2)</a> socket, <code>oldsocket</code>.</p></div></div><div class=sect4><h5 id=mac-mpo-relabel-pipe>6.7.3.2.5. <code>mpo_relabel_pipe</code><a class=anchor href=#mac-mpo-relabel-pipe></a></h5><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=c><span class=kt>void</span> <span class=nf>mpo_relabel_pipe</span><span class=p>(</span><span class=k>struct</span> <span class=n>ucred</span> <span class=o>*</span><span class=n>cred</span><span class=p>,</span> <span class=k>struct</span> <span class=n>pipe</span> <span class=o>*</span><span class=n>pipe</span><span class=p>,</span>
    <span class=k>struct</span> <span class=n>label</span> <span class=o>*</span><span class=n>oldlabel</span><span class=p>,</span> <span class=k>struct</span> <span class=n>label</span> <span class=o>*</span><span class=n>newlabel</span><span class=p>);</span></code></pre></div></div><table class="tableblock frame-none grid-all stretch informaltable"><col style=width:33.3333%><col style=width:33.3333%><col style=width:33.3334%><thead><tr><th class="tableblock halign-left valign-top">Parameter</th><th class="tableblock halign-left valign-top">Description</th><th class="tableblock halign-left valign-top">Locking</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>cred</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Subject credential</p></td><td class="tableblock halign-left valign-top"></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>pipe</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Pipe</p></td><td class="tableblock halign-left valign-top"></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>oldlabel</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Current policy label associated with <code>pipe</code></p></td><td class="tableblock halign-left valign-top"></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>newlabel</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Policy label update to apply to <code>pipe</code></p></td><td class="tableblock halign-left valign-top"></td></tr></tbody></table><div class=paragraph><p>Apply a new label, <code>newlabel</code>, to <code>pipe</code>.</p></div></div><div class=sect4><h5 id=mac-mpo-relabel-socket>6.7.3.2.6. <code>mpo_relabel_socket</code><a class=anchor href=#mac-mpo-relabel-socket></a></h5><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=c><span class=kt>void</span> <span class=nf>mpo_relabel_socket</span><span class=p>(</span><span class=k>struct</span> <span class=n>ucred</span> <span class=o>*</span><span class=n>cred</span><span class=p>,</span> <span class=k>struct</span> <span class=n>socket</span> <span class=o>*</span><span class=n>so</span><span class=p>,</span>
    <span class=k>struct</span> <span class=n>label</span> <span class=o>*</span><span class=n>oldlabel</span><span class=p>,</span> <span class=k>struct</span> <span class=n>label</span> <span class=o>*</span><span class=n>newlabel</span><span class=p>);</span></code></pre></div></div><table class="tableblock frame-none grid-all stretch informaltable"><col style=width:33.3333%><col style=width:33.3333%><col style=width:33.3334%><thead><tr><th class="tableblock halign-left valign-top">Parameter</th><th class="tableblock halign-left valign-top">Description</th><th class="tableblock halign-left valign-top">Locking</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>cred</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Subject credential</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Immutable</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>so</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Object; socket</p></td><td class="tableblock halign-left valign-top"></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>oldlabel</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Current label for <code>so</code></p></td><td class="tableblock halign-left valign-top"></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>newlabel</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Label update for <code>so</code></p></td><td class="tableblock halign-left valign-top"></td></tr></tbody></table><div class=paragraph><p>Update the label on a socket from the passed socket label update.</p></div></div><div class=sect4><h5 id=mpo-set-socket-peer-from-mbuf>6.7.3.2.7. <code>mpo_set_socket_peer_from_mbuf</code><a class=anchor href=#mpo-set-socket-peer-from-mbuf></a></h5><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=c><span class=kt>void</span> <span class=nf>mpo_set_socket_peer_from_mbuf</span><span class=p>(</span><span class=k>struct</span> <span class=n>mbuf</span> <span class=o>*</span><span class=n>mbuf</span><span class=p>,</span> <span class=k>struct</span> <span class=n>label</span> <span class=o>*</span><span class=n>mbuflabel</span><span class=p>,</span>
    <span class=k>struct</span> <span class=n>label</span> <span class=o>*</span><span class=n>oldlabel</span><span class=p>,</span> <span class=k>struct</span> <span class=n>label</span> <span class=o>*</span><span class=n>newlabel</span><span class=p>);</span></code></pre></div></div><table class="tableblock frame-none grid-all stretch informaltable"><col style=width:33.3333%><col style=width:33.3333%><col style=width:33.3334%><thead><tr><th class="tableblock halign-left valign-top">Parameter</th><th class="tableblock halign-left valign-top">Description</th><th class="tableblock halign-left valign-top">Locking</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>mbuf</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>First datagram received over socket</p></td><td class="tableblock halign-left valign-top"></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>mbuflabel</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Label for <code>mbuf</code></p></td><td class="tableblock halign-left valign-top"></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>oldlabel</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Current label for the socket</p></td><td class="tableblock halign-left valign-top"></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>newlabel</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Policy label to be filled out for the socket</p></td><td class="tableblock halign-left valign-top"></td></tr></tbody></table><div class=paragraph><p>Set the peer label on a stream socket from the passed mbuf label.
This call will be made when the first datagram is received by the stream socket, with the exception of Unix domain sockets.</p></div></div><div class=sect4><h5 id=mac-mpo-set-socket-peer-from-socket>6.7.3.2.8. <code>mpo_set_socket_peer_from_socket</code><a class=anchor href=#mac-mpo-set-socket-peer-from-socket></a></h5><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=c><span class=kt>void</span> <span class=nf>mpo_set_socket_peer_from_socket</span><span class=p>(</span><span class=k>struct</span> <span class=n>socket</span> <span class=o>*</span><span class=n>oldsocket</span><span class=p>,</span>
    <span class=k>struct</span> <span class=n>label</span> <span class=o>*</span><span class=n>oldsocketlabel</span><span class=p>,</span> <span class=k>struct</span> <span class=n>socket</span> <span class=o>*</span><span class=n>newsocket</span><span class=p>,</span>
    <span class=k>struct</span> <span class=n>label</span> <span class=o>*</span><span class=n>newsocketpeerlabel</span><span class=p>);</span></code></pre></div></div><table class="tableblock frame-none grid-all stretch informaltable"><col style=width:33.3333%><col style=width:33.3333%><col style=width:33.3334%><thead><tr><th class="tableblock halign-left valign-top">Parameter</th><th class="tableblock halign-left valign-top">Description</th><th class="tableblock halign-left valign-top">Locking</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>oldsocket</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Local socket</p></td><td class="tableblock halign-left valign-top"></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>oldsocketlabel</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Policy label for <code>oldsocket</code></p></td><td class="tableblock halign-left valign-top"></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>newsocket</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Peer socket</p></td><td class="tableblock halign-left valign-top"></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>newsocketpeerlabel</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Policy label to fill in for <code>newsocket</code></p></td><td class="tableblock halign-left valign-top"></td></tr></tbody></table><div class=paragraph><p>Set the peer label on a stream UNIX domain socket from the passed remote socket endpoint.
This call will be made when the socket pair is connected, and will be made for both endpoints.</p></div></div></div><div class=sect3><h4 id=mac-net-labeling-event-ops>6.7.3.3. Network Object Labeling Event Operations<a class=anchor href=#mac-net-labeling-event-ops></a></h4><div class=sect4><h5 id=mac-mpo-create-bpfdesc>6.7.3.3.1. <code>mpo_create_bpfdesc</code><a class=anchor href=#mac-mpo-create-bpfdesc></a></h5><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=c><span class=kt>void</span> <span class=nf>mpo_create_bpfdesc</span><span class=p>(</span><span class=k>struct</span> <span class=n>ucred</span> <span class=o>*</span><span class=n>cred</span><span class=p>,</span> <span class=k>struct</span> <span class=n>bpf_d</span> <span class=o>*</span><span class=n>bpf_d</span><span class=p>,</span>
    <span class=k>struct</span> <span class=n>label</span> <span class=o>*</span><span class=n>bpflabel</span><span class=p>);</span></code></pre></div></div><table class="tableblock frame-none grid-all stretch informaltable"><col style=width:33.3333%><col style=width:33.3333%><col style=width:33.3334%><thead><tr><th class="tableblock halign-left valign-top">Parameter</th><th class="tableblock halign-left valign-top">Description</th><th class="tableblock halign-left valign-top">Locking</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>cred</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Subject credential</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Immutable</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>bpf_d</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Object; bpf descriptor</p></td><td class="tableblock halign-left valign-top"></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>bpf</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Policy label to be filled in for <code>bpf_d</code></p></td><td class="tableblock halign-left valign-top"></td></tr></tbody></table><div class=paragraph><p>Set the label on a newly created BPF descriptor from the passed subject credential.
This call will be made when a BPF device node is opened by a process with the passed subject credential.</p></div></div><div class=sect4><h5 id=mac-mpo-create-ifnet>6.7.3.3.2. <code>mpo_create_ifnet</code><a class=anchor href=#mac-mpo-create-ifnet></a></h5><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=c><span class=kt>void</span> <span class=nf>mpo_create_ifnet</span><span class=p>(</span><span class=k>struct</span> <span class=n>ifnet</span> <span class=o>*</span><span class=n>ifnet</span><span class=p>,</span> <span class=k>struct</span> <span class=n>label</span> <span class=o>*</span><span class=n>ifnetlabel</span><span class=p>);</span></code></pre></div></div><table class="tableblock frame-none grid-all stretch informaltable"><col style=width:33.3333%><col style=width:33.3333%><col style=width:33.3334%><thead><tr><th class="tableblock halign-left valign-top">Parameter</th><th class="tableblock halign-left valign-top">Description</th><th class="tableblock halign-left valign-top">Locking</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>ifnet</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Network interface</p></td><td class="tableblock halign-left valign-top"></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>ifnetlabel</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Policy label to fill in for <code>ifnet</code></p></td><td class="tableblock halign-left valign-top"></td></tr></tbody></table><div class=paragraph><p>Set the label on a newly created interface.
This call may be made when a new physical interface becomes available to the system, or when a pseudo-interface is instantiated during the boot or as a result of a user action.</p></div></div><div class=sect4><h5 id=mac-mpo-create-ipq>6.7.3.3.3. <code>mpo_create_ipq</code><a class=anchor href=#mac-mpo-create-ipq></a></h5><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=c><span class=kt>void</span> <span class=nf>mpo_create_ipq</span><span class=p>(</span><span class=k>struct</span> <span class=n>mbuf</span> <span class=o>*</span><span class=n>fragment</span><span class=p>,</span> <span class=k>struct</span> <span class=n>label</span> <span class=o>*</span><span class=n>fragmentlabel</span><span class=p>,</span>
    <span class=k>struct</span> <span class=n>ipq</span> <span class=o>*</span><span class=n>ipq</span><span class=p>,</span> <span class=k>struct</span> <span class=n>label</span> <span class=o>*</span><span class=n>ipqlabel</span><span class=p>);</span></code></pre></div></div><table class="tableblock frame-none grid-all stretch informaltable"><col style=width:33.3333%><col style=width:33.3333%><col style=width:33.3334%><thead><tr><th class="tableblock halign-left valign-top">Parameter</th><th class="tableblock halign-left valign-top">Description</th><th class="tableblock halign-left valign-top">Locking</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>fragment</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>First received IP fragment</p></td><td class="tableblock halign-left valign-top"></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>fragmentlabel</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Policy label for <code>fragment</code></p></td><td class="tableblock halign-left valign-top"></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>ipq</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>IP reassembly queue to be labeled</p></td><td class="tableblock halign-left valign-top"></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>ipqlabel</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Policy label to be filled in for <code>ipq</code></p></td><td class="tableblock halign-left valign-top"></td></tr></tbody></table><div class=paragraph><p>Set the label on a newly created IP fragment reassembly queue from the mbuf header of the first received fragment.</p></div></div><div class=sect4><h5 id=mac-mpo-create-datagram-from-ipq>6.7.3.3.4. <code>mpo_create_datagram_from_ipq</code><a class=anchor href=#mac-mpo-create-datagram-from-ipq></a></h5><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=c><span class=kt>void</span> <span class=nf>mpo_create_create_datagram_from_ipq</span><span class=p>(</span><span class=k>struct</span> <span class=n>ipq</span> <span class=o>*</span><span class=n>ipq</span><span class=p>,</span>
    <span class=k>struct</span> <span class=n>label</span> <span class=o>*</span><span class=n>ipqlabel</span><span class=p>,</span> <span class=k>struct</span> <span class=n>mbuf</span> <span class=o>*</span><span class=n>datagram</span><span class=p>,</span> <span class=k>struct</span> <span class=n>label</span> <span class=o>*</span><span class=n>datagramlabel</span><span class=p>);</span></code></pre></div></div><table class="tableblock frame-none grid-all stretch informaltable"><col style=width:33.3333%><col style=width:33.3333%><col style=width:33.3334%><thead><tr><th class="tableblock halign-left valign-top">Parameter</th><th class="tableblock halign-left valign-top">Description</th><th class="tableblock halign-left valign-top">Locking</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>ipq</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>IP reassembly queue</p></td><td class="tableblock halign-left valign-top"></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>ipqlabel</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Policy label for <code>ipq</code></p></td><td class="tableblock halign-left valign-top"></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>datagram</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Datagram to be labeled</p></td><td class="tableblock halign-left valign-top"></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>datagramlabel</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Policy label to be filled in for <code>datagramlabel</code></p></td><td class="tableblock halign-left valign-top"></td></tr></tbody></table><div class=paragraph><p>Set the label on a newly reassembled IP datagram from the IP fragment reassembly queue from which it was generated.</p></div></div><div class=sect4><h5 id=mac-mpo-create-fragment>6.7.3.3.5. <code>mpo_create_fragment</code><a class=anchor href=#mac-mpo-create-fragment></a></h5><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=c><span class=kt>void</span> <span class=nf>mpo_create_fragment</span><span class=p>(</span><span class=k>struct</span> <span class=n>mbuf</span> <span class=o>*</span><span class=n>datagram</span><span class=p>,</span> <span class=k>struct</span> <span class=n>label</span> <span class=o>*</span><span class=n>datagramlabel</span><span class=p>,</span>
    <span class=k>struct</span> <span class=n>mbuf</span> <span class=o>*</span><span class=n>fragment</span><span class=p>,</span> <span class=k>struct</span> <span class=n>label</span> <span class=o>*</span><span class=n>fragmentlabel</span><span class=p>);</span></code></pre></div></div><table class="tableblock frame-none grid-all stretch informaltable"><col style=width:33.3333%><col style=width:33.3333%><col style=width:33.3334%><thead><tr><th class="tableblock halign-left valign-top">Parameter</th><th class="tableblock halign-left valign-top">Description</th><th class="tableblock halign-left valign-top">Locking</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>datagram</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Datagram</p></td><td class="tableblock halign-left valign-top"></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>datagramlabel</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Policy label for <code>datagram</code></p></td><td class="tableblock halign-left valign-top"></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>fragment</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Fragment to be labeled</p></td><td class="tableblock halign-left valign-top"></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>fragmentlabel</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Policy label to be filled in for <code>datagram</code></p></td><td class="tableblock halign-left valign-top"></td></tr></tbody></table><div class=paragraph><p>Set the label on the mbuf header of a newly created IP fragment from the label on the mbuf header of the datagram it was generate from.</p></div></div><div class=sect4><h5 id=mac-mpo-create-mbuf-from-mbuf>6.7.3.3.6. <code>mpo_create_mbuf_from_mbuf</code><a class=anchor href=#mac-mpo-create-mbuf-from-mbuf></a></h5><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=c><span class=kt>void</span> <span class=nf>mpo_create_mbuf_from_mbuf</span><span class=p>(</span><span class=k>struct</span> <span class=n>mbuf</span> <span class=o>*</span><span class=n>oldmbuf</span><span class=p>,</span> <span class=k>struct</span> <span class=n>label</span> <span class=o>*</span><span class=n>oldmbuflabel</span><span class=p>,</span>
    <span class=k>struct</span> <span class=n>mbuf</span> <span class=o>*</span><span class=n>newmbuf</span><span class=p>,</span> <span class=k>struct</span> <span class=n>label</span> <span class=o>*</span><span class=n>newmbuflabel</span><span class=p>);</span></code></pre></div></div><table class="tableblock frame-none grid-all stretch informaltable"><col style=width:33.3333%><col style=width:33.3333%><col style=width:33.3334%><thead><tr><th class="tableblock halign-left valign-top">Parameter</th><th class="tableblock halign-left valign-top">Description</th><th class="tableblock halign-left valign-top">Locking</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>oldmbuf</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Existing (source) mbuf</p></td><td class="tableblock halign-left valign-top"></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>oldmbuflabel</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Policy label for <code>oldmbuf</code></p></td><td class="tableblock halign-left valign-top"></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>newmbuf</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>New mbuf to be labeled</p></td><td class="tableblock halign-left valign-top"></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>newmbuflabel</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Policy label to be filled in for <code>newmbuf</code></p></td><td class="tableblock halign-left valign-top"></td></tr></tbody></table><div class=paragraph><p>Set the label on the mbuf header of a newly created datagram from the mbuf header of an existing datagram.
This call may be made in a number of situations, including when an mbuf is re-allocated for alignment purposes.</p></div></div><div class=sect4><h5 id=mac-mpo-create-mbuf-linklayer>6.7.3.3.7. <code>mpo_create_mbuf_linklayer</code><a class=anchor href=#mac-mpo-create-mbuf-linklayer></a></h5><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=c><span class=kt>void</span> <span class=nf>mpo_create_mbuf_linklayer</span><span class=p>(</span><span class=k>struct</span> <span class=n>ifnet</span> <span class=o>*</span><span class=n>ifnet</span><span class=p>,</span> <span class=k>struct</span> <span class=n>label</span> <span class=o>*</span><span class=n>ifnetlabel</span><span class=p>,</span>
    <span class=k>struct</span> <span class=n>mbuf</span> <span class=o>*</span><span class=n>mbuf</span><span class=p>,</span> <span class=k>struct</span> <span class=n>label</span> <span class=o>*</span><span class=n>mbuflabel</span><span class=p>);</span></code></pre></div></div><table class="tableblock frame-none grid-all stretch informaltable"><col style=width:33.3333%><col style=width:33.3333%><col style=width:33.3334%><thead><tr><th class="tableblock halign-left valign-top">Parameter</th><th class="tableblock halign-left valign-top">Description</th><th class="tableblock halign-left valign-top">Locking</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>ifnet</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Network interface</p></td><td class="tableblock halign-left valign-top"></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>ifnetlabel</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Policy label for <code>ifnet</code></p></td><td class="tableblock halign-left valign-top"></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>mbuf</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>mbuf header for new datagram</p></td><td class="tableblock halign-left valign-top"></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>mbuflabel</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Policy label to be filled in for <code>mbuf</code></p></td><td class="tableblock halign-left valign-top"></td></tr></tbody></table><div class=paragraph><p>Set the label on the mbuf header of a newly created datagram generated for the purposes of a link layer response for the passed interface.
This call may be made in a number of situations, including for ARP or ND6 responses in the IPv4 and IPv6 stacks.</p></div></div><div class=sect4><h5 id=mac-mpo-create-mbuf-from-bpfdesc>6.7.3.3.8. <code>mpo_create_mbuf_from_bpfdesc</code><a class=anchor href=#mac-mpo-create-mbuf-from-bpfdesc></a></h5><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=c><span class=kt>void</span> <span class=nf>mpo_create_mbuf_from_bpfdesc</span><span class=p>(</span><span class=k>struct</span> <span class=n>bpf_d</span> <span class=o>*</span><span class=n>bpf_d</span><span class=p>,</span> <span class=k>struct</span> <span class=n>label</span> <span class=o>*</span><span class=n>bpflabel</span><span class=p>,</span>
    <span class=k>struct</span> <span class=n>mbuf</span> <span class=o>*</span><span class=n>mbuf</span><span class=p>,</span> <span class=k>struct</span> <span class=n>label</span> <span class=o>*</span><span class=n>mbuflabel</span><span class=p>);</span></code></pre></div></div><table class="tableblock frame-none grid-all stretch informaltable"><col style=width:33.3333%><col style=width:33.3333%><col style=width:33.3334%><thead><tr><th class="tableblock halign-left valign-top">Parameter</th><th class="tableblock halign-left valign-top">Description</th><th class="tableblock halign-left valign-top">Locking</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>bpf_d</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>BPF descriptor</p></td><td class="tableblock halign-left valign-top"></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>bpflabel</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Policy label for <code>bpflabel</code></p></td><td class="tableblock halign-left valign-top"></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>mbuf</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>New mbuf to be labeled</p></td><td class="tableblock halign-left valign-top"></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>mbuflabel</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Policy label to fill in for <code>mbuf</code></p></td><td class="tableblock halign-left valign-top"></td></tr></tbody></table><div class=paragraph><p>Set the label on the mbuf header of a newly created datagram generated using the passed BPF descriptor.
This call is made when a write is performed to the BPF device associated with the passed BPF descriptor.</p></div></div><div class=sect4><h5 id=mac-mpo-create-mbuf-from-ifnet>6.7.3.3.9. <code>mpo_create_mbuf_from_ifnet</code><a class=anchor href=#mac-mpo-create-mbuf-from-ifnet></a></h5><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=c><span class=kt>void</span> <span class=nf>mpo_create_mbuf_from_ifnet</span><span class=p>(</span><span class=k>struct</span> <span class=n>ifnet</span> <span class=o>*</span><span class=n>ifnet</span><span class=p>,</span> <span class=k>struct</span> <span class=n>label</span> <span class=o>*</span><span class=n>ifnetlabel</span><span class=p>,</span>
    <span class=k>struct</span> <span class=n>mbuf</span> <span class=o>*</span><span class=n>mbuf</span><span class=p>,</span> <span class=k>struct</span> <span class=n>label</span> <span class=o>*</span><span class=n>mbuflabel</span><span class=p>);</span></code></pre></div></div><table class="tableblock frame-none grid-all stretch informaltable"><col style=width:33.3333%><col style=width:33.3333%><col style=width:33.3334%><thead><tr><th class="tableblock halign-left valign-top">Parameter</th><th class="tableblock halign-left valign-top">Description</th><th class="tableblock halign-left valign-top">Locking</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>ifnet</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Network interface</p></td><td class="tableblock halign-left valign-top"></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>ifnetlabel</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Policy label for <code>ifnetlabel</code></p></td><td class="tableblock halign-left valign-top"></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>mbuf</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>mbuf header for new datagram</p></td><td class="tableblock halign-left valign-top"></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>mbuflabel</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Policy label to be filled in for <code>mbuf</code></p></td><td class="tableblock halign-left valign-top"></td></tr></tbody></table><div class=paragraph><p>Set the label on the mbuf header of a newly created datagram generated from the passed network interface.</p></div></div><div class=sect4><h5 id=mac-mpo-create-mbuf-multicast-encap>6.7.3.3.10. <code>mpo_create_mbuf_multicast_encap</code><a class=anchor href=#mac-mpo-create-mbuf-multicast-encap></a></h5><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=c><span class=kt>void</span> <span class=nf>mpo_create_mbuf_multicast_encap</span><span class=p>(</span><span class=k>struct</span> <span class=n>mbuf</span> <span class=o>*</span><span class=n>oldmbuf</span><span class=p>,</span>
    <span class=k>struct</span> <span class=n>label</span> <span class=o>*</span><span class=n>oldmbuflabel</span><span class=p>,</span> <span class=k>struct</span> <span class=n>ifnet</span> <span class=o>*</span><span class=n>ifnet</span><span class=p>,</span> <span class=k>struct</span> <span class=n>label</span> <span class=o>*</span><span class=n>ifnetlabel</span><span class=p>,</span>
    <span class=k>struct</span> <span class=n>mbuf</span> <span class=o>*</span><span class=n>newmbuf</span><span class=p>,</span> <span class=k>struct</span> <span class=n>label</span> <span class=o>*</span><span class=n>newmbuflabel</span><span class=p>);</span></code></pre></div></div><table class="tableblock frame-none grid-all stretch informaltable"><col style=width:33.3333%><col style=width:33.3333%><col style=width:33.3334%><thead><tr><th class="tableblock halign-left valign-top">Parameter</th><th class="tableblock halign-left valign-top">Description</th><th class="tableblock halign-left valign-top">Locking</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>oldmbuf</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>mbuf header for existing datagram</p></td><td class="tableblock halign-left valign-top"></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>oldmbuflabel</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Policy label for <code>oldmbuf</code></p></td><td class="tableblock halign-left valign-top"></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>ifnet</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Network interface</p></td><td class="tableblock halign-left valign-top"></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>ifnetlabel</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Policy label for <code>ifnet</code></p></td><td class="tableblock halign-left valign-top"></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>newmbuf</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>mbuf header to be labeled for new datagram</p></td><td class="tableblock halign-left valign-top"></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>newmbuflabel</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Policy label to be filled in for <code>newmbuf</code></p></td><td class="tableblock halign-left valign-top"></td></tr></tbody></table><div class=paragraph><p>Set the label on the mbuf header of a newly created datagram generated from the existing passed datagram when it is processed by the passed multicast encapsulation interface.
This call is made when an mbuf is to be delivered using the virtual interface.</p></div></div><div class=sect4><h5 id=mac-mpo-create-mbuf-netlayer>6.7.3.3.11. <code>mpo_create_mbuf_netlayer</code><a class=anchor href=#mac-mpo-create-mbuf-netlayer></a></h5><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=c><span class=kt>void</span> <span class=nf>mpo_create_mbuf_netlayer</span><span class=p>(</span><span class=k>struct</span> <span class=n>mbuf</span> <span class=o>*</span><span class=n>oldmbuf</span><span class=p>,</span> <span class=k>struct</span> <span class=n>label</span> <span class=o>*</span><span class=n>oldmbuflabel</span><span class=p>,</span>
    <span class=k>struct</span> <span class=n>mbuf</span> <span class=o>*</span><span class=n>newmbuf</span><span class=p>,</span> <span class=k>struct</span> <span class=n>label</span> <span class=o>*</span><span class=n>newmbuflabel</span><span class=p>);</span></code></pre></div></div><table class="tableblock frame-none grid-all stretch informaltable"><col style=width:33.3333%><col style=width:33.3333%><col style=width:33.3334%><thead><tr><th class="tableblock halign-left valign-top">Parameter</th><th class="tableblock halign-left valign-top">Description</th><th class="tableblock halign-left valign-top">Locking</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>oldmbuf</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Received datagram</p></td><td class="tableblock halign-left valign-top"></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>oldmbuflabel</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Policy label for <code>oldmbuf</code></p></td><td class="tableblock halign-left valign-top"></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>newmbuf</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Newly created datagram</p></td><td class="tableblock halign-left valign-top"></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>newmbuflabel</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Policy label for <code>newmbuf</code></p></td><td class="tableblock halign-left valign-top"></td></tr></tbody></table><div class=paragraph><p>Set the label on the mbuf header of a newly created datagram generated by the IP stack in response to an existing received datagram (<code>oldmbuf</code>).
This call may be made in a number of situations, including when responding to ICMP request datagrams.</p></div></div><div class=sect4><h5 id=mac-mpo-fragment-match>6.7.3.3.12. <code>mpo_fragment_match</code><a class=anchor href=#mac-mpo-fragment-match></a></h5><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=c><span class=kt>int</span> <span class=nf>mpo_fragment_match</span><span class=p>(</span><span class=k>struct</span> <span class=n>mbuf</span> <span class=o>*</span><span class=n>fragment</span><span class=p>,</span> <span class=k>struct</span> <span class=n>label</span> <span class=o>*</span><span class=n>fragmentlabel</span><span class=p>,</span>
    <span class=k>struct</span> <span class=n>ipq</span> <span class=o>*</span><span class=n>ipq</span><span class=p>,</span> <span class=k>struct</span> <span class=n>label</span> <span class=o>*</span><span class=n>ipqlabel</span><span class=p>);</span></code></pre></div></div><table class="tableblock frame-none grid-all stretch informaltable"><col style=width:33.3333%><col style=width:33.3333%><col style=width:33.3334%><thead><tr><th class="tableblock halign-left valign-top">Parameter</th><th class="tableblock halign-left valign-top">Description</th><th class="tableblock halign-left valign-top">Locking</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>fragment</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>IP datagram fragment</p></td><td class="tableblock halign-left valign-top"></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>fragmentlabel</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Policy label for <code>fragment</code></p></td><td class="tableblock halign-left valign-top"></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>ipq</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>IP fragment reassembly queue</p></td><td class="tableblock halign-left valign-top"></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>ipqlabel</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Policy label for <code>ipq</code></p></td><td class="tableblock halign-left valign-top"></td></tr></tbody></table><div class=paragraph><p>Determine whether an mbuf header containing an IP datagram (<code>fragment</code>) fragment matches the label of the passed IP fragment reassembly queue (<code>ipq</code>).
Return (1) for a successful match, or (0) for no match.
This call is made when the IP stack attempts to find an existing fragment reassembly queue for a newly received fragment; if this fails, a new fragment reassembly queue may be instantiated for the fragment.
Policies may use this entry point to prevent the reassembly of otherwise matching IP fragments if policy does not permit them to be reassembled based on the label or other information.</p></div></div><div class=sect4><h5 id=mac-mpo-ifnet-relabel>6.7.3.3.13. <code>mpo_relabel_ifnet</code><a class=anchor href=#mac-mpo-ifnet-relabel></a></h5><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=c><span class=kt>void</span> <span class=nf>mpo_relabel_ifnet</span><span class=p>(</span><span class=k>struct</span> <span class=n>ucred</span> <span class=o>*</span><span class=n>cred</span><span class=p>,</span> <span class=k>struct</span> <span class=n>ifnet</span> <span class=o>*</span><span class=n>ifnet</span><span class=p>,</span>
    <span class=k>struct</span> <span class=n>label</span> <span class=o>*</span><span class=n>ifnetlabel</span><span class=p>,</span> <span class=k>struct</span> <span class=n>label</span> <span class=o>*</span><span class=n>newlabel</span><span class=p>);</span></code></pre></div></div><table class="tableblock frame-none grid-all stretch informaltable"><col style=width:33.3333%><col style=width:33.3333%><col style=width:33.3334%><thead><tr><th class="tableblock halign-left valign-top">Parameter</th><th class="tableblock halign-left valign-top">Description</th><th class="tableblock halign-left valign-top">Locking</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>cred</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Subject credential</p></td><td class="tableblock halign-left valign-top"></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>ifnet</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Object; Network interface</p></td><td class="tableblock halign-left valign-top"></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>ifnetlabel</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Policy label for <code>ifnet</code></p></td><td class="tableblock halign-left valign-top"></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>newlabel</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Label update to apply to <code>ifnet</code></p></td><td class="tableblock halign-left valign-top"></td></tr></tbody></table><div class=paragraph><p>Update the label of network interface, <code>ifnet</code>, based on the passed update label, <code>newlabel</code>, and the passed subject credential, <code>cred</code>.</p></div></div><div class=sect4><h5 id=mac-mpo-update-ipq>6.7.3.3.14. <code>mpo_update_ipq</code><a class=anchor href=#mac-mpo-update-ipq></a></h5><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=c><span class=kt>void</span> <span class=nf>mpo_update_ipq</span><span class=p>(</span><span class=k>struct</span> <span class=n>mbuf</span> <span class=o>*</span><span class=n>fragment</span><span class=p>,</span> <span class=k>struct</span> <span class=n>label</span> <span class=o>*</span><span class=n>fragmentlabel</span><span class=p>,</span>
    <span class=k>struct</span> <span class=n>ipq</span> <span class=o>*</span><span class=n>ipq</span><span class=p>,</span> <span class=k>struct</span> <span class=n>label</span> <span class=o>*</span><span class=n>ipqlabel</span><span class=p>);</span></code></pre></div></div><table class="tableblock frame-none grid-all stretch informaltable"><col style=width:33.3333%><col style=width:33.3333%><col style=width:33.3334%><thead><tr><th class="tableblock halign-left valign-top">Parameter</th><th class="tableblock halign-left valign-top">Description</th><th class="tableblock halign-left valign-top">Locking</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>mbuf</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>IP fragment</p></td><td class="tableblock halign-left valign-top"></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>mbuflabel</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Policy label for <code>mbuf</code></p></td><td class="tableblock halign-left valign-top"></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>ipq</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>IP fragment reassembly queue</p></td><td class="tableblock halign-left valign-top"></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>ipqlabel</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Policy label to be updated for <code>ipq</code></p></td><td class="tableblock halign-left valign-top"></td></tr></tbody></table><div class=paragraph><p>Update the label on an IP fragment reassembly queue (<code>ipq</code>) based on the acceptance of the passed IP fragment mbuf header (<code>mbuf</code>).</p></div></div></div><div class=sect3><h4 id=mac-proc-labeling-event-ops>6.7.3.4. Process Labeling Event Operations<a class=anchor href=#mac-proc-labeling-event-ops></a></h4><div class=sect4><h5 id=mac-mpo-create-cred>6.7.3.4.1. <code>mpo_create_cred</code><a class=anchor href=#mac-mpo-create-cred></a></h5><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=c><span class=kt>void</span> <span class=nf>mpo_create_cred</span><span class=p>(</span><span class=k>struct</span> <span class=n>ucred</span> <span class=o>*</span><span class=n>parent_cred</span><span class=p>,</span> <span class=k>struct</span> <span class=n>ucred</span> <span class=o>*</span><span class=n>child_cred</span><span class=p>);</span></code></pre></div></div><table class="tableblock frame-none grid-all stretch informaltable"><col style=width:33.3333%><col style=width:33.3333%><col style=width:33.3334%><thead><tr><th class="tableblock halign-left valign-top">Parameter</th><th class="tableblock halign-left valign-top">Description</th><th class="tableblock halign-left valign-top">Locking</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>parent_cred</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Parent subject credential</p></td><td class="tableblock halign-left valign-top"></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>child_cred</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Child subject credential</p></td><td class="tableblock halign-left valign-top"></td></tr></tbody></table><div class=paragraph><p>Set the label of a newly created subject credential from the passed subject credential.
This call will be made when <a href="https://man.freebsd.org/cgi/man.cgi?query=crcopy&amp;sektion=9&amp;format=html">crcopy(9)</a> is invoked on a newly created <code>struct ucred</code>.
This call should not be confused with a process forking or creation event.</p></div></div><div class=sect4><h5 id=mac-mpo-execve-transition>6.7.3.4.2. <code>mpo_execve_transition</code><a class=anchor href=#mac-mpo-execve-transition></a></h5><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=c><span class=kt>void</span> <span class=nf>mpo_execve_transition</span><span class=p>(</span><span class=k>struct</span> <span class=n>ucred</span> <span class=o>*</span><span class=n>old</span><span class=p>,</span> <span class=k>struct</span> <span class=n>ucred</span> <span class=o>*</span><span class=n>new</span><span class=p>,</span>
    <span class=k>struct</span> <span class=n>vnode</span> <span class=o>*</span><span class=n>vp</span><span class=p>,</span> <span class=k>struct</span> <span class=n>label</span> <span class=o>*</span><span class=n>vnodelabel</span><span class=p>);</span></code></pre></div></div><table class="tableblock frame-none grid-all stretch informaltable"><col style=width:33.3333%><col style=width:33.3333%><col style=width:33.3334%><thead><tr><th class="tableblock halign-left valign-top">Parameter</th><th class="tableblock halign-left valign-top">Description</th><th class="tableblock halign-left valign-top">Locking</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>old</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Existing subject credential</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Immutable</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>new</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>New subject credential to be labeled</p></td><td class="tableblock halign-left valign-top"></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>vp</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>File to execute</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Locked</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>vnodelabel</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Policy label for <code>vp</code></p></td><td class="tableblock halign-left valign-top"></td></tr></tbody></table><div class=paragraph><p>Update the label of a newly created subject credential (<code>new</code>) from the passed existing subject credential (<code>old</code>) based on a label transition caused by executing the passed vnode (<code>vp</code>).
This call occurs when a process executes the passed vnode and one of the policies returns a success from the <code>mpo_execve_will_transition</code> entry point.
Policies may choose to implement this call simply by invoking <code>mpo_create_cred</code> and passing the two subject credentials so as not to implement a transitioning event.
Policies should not leave this entry point unimplemented if they implement <code>mpo_create_cred</code>, even if they do not implement <code>mpo_execve_will_transition</code>.</p></div></div><div class=sect4><h5 id=mac-mpo-execve-will-transition>6.7.3.4.3. <code>mpo_execve_will_transition</code><a class=anchor href=#mac-mpo-execve-will-transition></a></h5><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=c><span class=kt>int</span> <span class=nf>mpo_execve_will_transition</span><span class=p>(</span><span class=k>struct</span> <span class=n>ucred</span> <span class=o>*</span><span class=n>old</span><span class=p>,</span> <span class=k>struct</span> <span class=n>vnode</span> <span class=o>*</span><span class=n>vp</span><span class=p>,</span>
    <span class=k>struct</span> <span class=n>label</span> <span class=o>*</span><span class=n>vnodelabel</span><span class=p>);</span></code></pre></div></div><table class="tableblock frame-none grid-all stretch informaltable"><col style=width:33.3333%><col style=width:33.3333%><col style=width:33.3334%><thead><tr><th class="tableblock halign-left valign-top">Parameter</th><th class="tableblock halign-left valign-top">Description</th><th class="tableblock halign-left valign-top">Locking</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>old</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Subject credential prior to <a href="https://man.freebsd.org/cgi/man.cgi?query=execve&amp;sektion=2&amp;format=html">execve(2)</a></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Immutable</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>vp</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>File to execute</p></td><td class="tableblock halign-left valign-top"></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>vnodelabel</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Policy label for <code>vp</code></p></td><td class="tableblock halign-left valign-top"></td></tr></tbody></table><div class=paragraph><p>Determine whether the policy will want to perform a transition event as a result of the execution of the passed vnode by the passed subject credential.
Return 1 if a transition is required, 0 if not.
Even if a policy returns 0, it should behave correctly in the presence of an unexpected invocation of <code>mpo_execve_transition</code>, as that call may happen as a result of another policy requesting a transition.</p></div></div><div class=sect4><h5 id=mac-mpo-create-proc0>6.7.3.4.4. <code>mpo_create_proc0</code><a class=anchor href=#mac-mpo-create-proc0></a></h5><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=c><span class=kt>void</span> <span class=nf>mpo_create_proc0</span><span class=p>(</span><span class=k>struct</span> <span class=n>ucred</span> <span class=o>*</span><span class=n>cred</span><span class=p>);</span></code></pre></div></div><table class="tableblock frame-none grid-all stretch informaltable"><col style=width:33.3333%><col style=width:33.3333%><col style=width:33.3334%><thead><tr><th class="tableblock halign-left valign-top">Parameter</th><th class="tableblock halign-left valign-top">Description</th><th class="tableblock halign-left valign-top">Locking</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>cred</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Subject credential to be filled in</p></td><td class="tableblock halign-left valign-top"></td></tr></tbody></table><div class=paragraph><p>Create the subject credential of process 0, the parent of all kernel processes.</p></div></div><div class=sect4><h5 id=mac-mpo-create-proc1>6.7.3.4.5. <code>mpo_create_proc1</code><a class=anchor href=#mac-mpo-create-proc1></a></h5><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=c><span class=kt>void</span> <span class=nf>mpo_create_proc1</span><span class=p>(</span><span class=k>struct</span> <span class=n>ucred</span> <span class=o>*</span><span class=n>cred</span><span class=p>);</span></code></pre></div></div><table class="tableblock frame-none grid-all stretch informaltable"><col style=width:33.3333%><col style=width:33.3333%><col style=width:33.3334%><thead><tr><th class="tableblock halign-left valign-top">Parameter</th><th class="tableblock halign-left valign-top">Description</th><th class="tableblock halign-left valign-top">Locking</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>cred</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Subject credential to be filled in</p></td><td class="tableblock halign-left valign-top"></td></tr></tbody></table><div class=paragraph><p>Create the subject credential of process 1, the parent of all user processes.</p></div></div><div class=sect4><h5 id=mac-mpo-relabel-cred>6.7.3.4.6. <code>mpo_relabel_cred</code><a class=anchor href=#mac-mpo-relabel-cred></a></h5><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=c><span class=kt>void</span> <span class=nf>mpo_relabel_cred</span><span class=p>(</span><span class=k>struct</span> <span class=n>ucred</span> <span class=o>*</span><span class=n>cred</span><span class=p>,</span> <span class=k>struct</span> <span class=n>label</span> <span class=o>*</span><span class=n>newlabel</span><span class=p>);</span></code></pre></div></div><table class="tableblock frame-none grid-all stretch informaltable"><col style=width:33.3333%><col style=width:33.3333%><col style=width:33.3334%><thead><tr><th class="tableblock halign-left valign-top">Parameter</th><th class="tableblock halign-left valign-top">Description</th><th class="tableblock halign-left valign-top">Locking</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>cred</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Subject credential</p></td><td class="tableblock halign-left valign-top"></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>newlabel</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Label update to apply to <code>cred</code></p></td><td class="tableblock halign-left valign-top"></td></tr></tbody></table><div class=paragraph><p>Update the label on a subject credential from the passed update label.</p></div></div></div></div><div class=sect2><h3 id=mac-access-control-checks>6.7.4. Access Control Checks<a class=anchor href=#mac-access-control-checks></a></h3><div class=paragraph><p>Access control entry points permit policy modules to influence access control decisions made by the kernel.
Generally, although not always, arguments to an access control entry point will include one or more authorizing credentials, information (possibly including a label) for any other objects involved in the operation.
An access control entry point may return 0 to permit the operation, or an <a href="https://man.freebsd.org/cgi/man.cgi?query=errno&amp;sektion=2&amp;format=html">errno(2)</a> error value.
The results of invoking the entry point across various registered policy modules will be composed as follows: if all modules permit the operation to succeed, success will be returned.
If one or modules returns a failure, a failure will be returned.
If more than one module returns a failure, the errno value to return to the user will be selected using the following precedence, implemented by the <code>error_select()</code> function in <span class=filename>kern_mac.c</span>:</p></div><table class="tableblock frame-none grid-all stretch informaltable"><col style=width:50%><col style=width:50%><tbody><tr><td class="tableblock halign-left valign-top"><p class=tableblock>Most precedence</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>EDEADLK</p></td></tr><tr><td class="tableblock halign-left valign-top"></td><td class="tableblock halign-left valign-top"><p class=tableblock>EINVAL</p></td></tr><tr><td class="tableblock halign-left valign-top"></td><td class="tableblock halign-left valign-top"><p class=tableblock>ESRCH</p></td></tr><tr><td class="tableblock halign-left valign-top"></td><td class="tableblock halign-left valign-top"><p class=tableblock>EACCES</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>Least precedence</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>EPERM</p></td></tr></tbody></table><div class=paragraph><p>If none of the error values returned by all modules are listed in the precedence chart then an arbitrarily selected value from the set will be returned.
In general, the rules provide precedence to errors in the following order: kernel failures, invalid arguments, object not present, access not permitted, other.</p></div><div class=sect3><h4 id=mac-mpo-bpfdesc-check-receive-from-ifnet>6.7.4.1. <code>mpo_check_bpfdesc_receive</code><a class=anchor href=#mac-mpo-bpfdesc-check-receive-from-ifnet></a></h4><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=c><span class=kt>int</span> <span class=nf>mpo_check_bpfdesc_receive</span><span class=p>(</span><span class=k>struct</span> <span class=n>bpf_d</span> <span class=o>*</span><span class=n>bpf_d</span><span class=p>,</span> <span class=k>struct</span> <span class=n>label</span> <span class=o>*</span><span class=n>bpflabel</span><span class=p>,</span>
    <span class=k>struct</span> <span class=n>ifnet</span> <span class=o>*</span><span class=n>ifnet</span><span class=p>,</span> <span class=k>struct</span> <span class=n>label</span> <span class=o>*</span><span class=n>ifnetlabel</span><span class=p>);</span></code></pre></div></div><table class="tableblock frame-none grid-all stretch informaltable"><col style=width:33.3333%><col style=width:33.3333%><col style=width:33.3334%><thead><tr><th class="tableblock halign-left valign-top">Parameter</th><th class="tableblock halign-left valign-top">Description</th><th class="tableblock halign-left valign-top">Locking</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>bpf_d</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Subject; BPF descriptor</p></td><td class="tableblock halign-left valign-top"></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>bpflabel</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Policy label for <code>bpf_d</code></p></td><td class="tableblock halign-left valign-top"></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>ifnet</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Object; network interface</p></td><td class="tableblock halign-left valign-top"></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>ifnetlabel</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Policy label for <code>ifnet</code></p></td><td class="tableblock halign-left valign-top"></td></tr></tbody></table><div class=paragraph><p>Determine whether the MAC framework should permit datagrams from the passed interface to be delivered to the buffers of the passed BPF descriptor.
Return (0) for success, or an <code>errno</code> value for failure Suggested failure: EACCES for label mismatches, EPERM for lack of privilege.</p></div></div><div class=sect3><h4 id=mac-mpo-check-kenv-dump>6.7.4.2. <code>mpo_check_kenv_dump</code><a class=anchor href=#mac-mpo-check-kenv-dump></a></h4><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=c><span class=kt>int</span> <span class=nf>mpo_check_kenv_dump</span><span class=p>(</span><span class=k>struct</span> <span class=n>ucred</span> <span class=o>*</span><span class=n>cred</span><span class=p>);</span></code></pre></div></div><table class="tableblock frame-none grid-all stretch informaltable"><col style=width:33.3333%><col style=width:33.3333%><col style=width:33.3334%><thead><tr><th class="tableblock halign-left valign-top">Parameter</th><th class="tableblock halign-left valign-top">Description</th><th class="tableblock halign-left valign-top">Locking</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>cred</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Subject credential</p></td><td class="tableblock halign-left valign-top"></td></tr></tbody></table><div class=paragraph><p>Determine whether the subject should be allowed to retrieve the kernel environment (see <a href="https://man.freebsd.org/cgi/man.cgi?query=kenv&amp;sektion=2&amp;format=html">kenv(2)</a>).</p></div></div><div class=sect3><h4 id=mac-mpo-check-kenv-get>6.7.4.3. <code>mpo_check_kenv_get</code><a class=anchor href=#mac-mpo-check-kenv-get></a></h4><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=c><span class=kt>int</span> <span class=nf>mpo_check_kenv_get</span><span class=p>(</span><span class=k>struct</span> <span class=n>ucred</span> <span class=o>*</span><span class=n>cred</span><span class=p>,</span> <span class=kt>char</span> <span class=o>*</span><span class=n>name</span><span class=p>);</span></code></pre></div></div><table class="tableblock frame-none grid-all stretch informaltable"><col style=width:33.3333%><col style=width:33.3333%><col style=width:33.3334%><thead><tr><th class="tableblock halign-left valign-top">Parameter</th><th class="tableblock halign-left valign-top">Description</th><th class="tableblock halign-left valign-top">Locking</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>cred</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Subject credential</p></td><td class="tableblock halign-left valign-top"></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>name</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Kernel environment variable name</p></td><td class="tableblock halign-left valign-top"></td></tr></tbody></table><div class=paragraph><p>Determine whether the subject should be allowed to retrieve the value of the specified kernel environment variable.</p></div></div><div class=sect3><h4 id=mac-mpo-check-kenv-set>6.7.4.4. <code>mpo_check_kenv_set</code><a class=anchor href=#mac-mpo-check-kenv-set></a></h4><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=c><span class=kt>int</span> <span class=nf>mpo_check_kenv_set</span><span class=p>(</span><span class=k>struct</span> <span class=n>ucred</span> <span class=o>*</span><span class=n>cred</span><span class=p>,</span> <span class=kt>char</span> <span class=o>*</span><span class=n>name</span><span class=p>);</span></code></pre></div></div><table class="tableblock frame-none grid-all stretch informaltable"><col style=width:33.3333%><col style=width:33.3333%><col style=width:33.3334%><thead><tr><th class="tableblock halign-left valign-top">Parameter</th><th class="tableblock halign-left valign-top">Description</th><th class="tableblock halign-left valign-top">Locking</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>cred</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Subject credential</p></td><td class="tableblock halign-left valign-top"></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>name</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Kernel environment variable name</p></td><td class="tableblock halign-left valign-top"></td></tr></tbody></table><div class=paragraph><p>Determine whether the subject should be allowed to set the specified kernel environment variable.</p></div></div><div class=sect3><h4 id=mac-mpo-check-kenv-unset>6.7.4.5. <code>mpo_check_kenv_unset</code><a class=anchor href=#mac-mpo-check-kenv-unset></a></h4><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=c><span class=kt>int</span> <span class=nf>mpo_check_kenv_unset</span><span class=p>(</span><span class=k>struct</span> <span class=n>ucred</span> <span class=o>*</span><span class=n>cred</span><span class=p>,</span> <span class=kt>char</span> <span class=o>*</span><span class=n>name</span><span class=p>);</span></code></pre></div></div><table class="tableblock frame-none grid-all stretch informaltable"><col style=width:33.3333%><col style=width:33.3333%><col style=width:33.3334%><thead><tr><th class="tableblock halign-left valign-top">Parameter</th><th class="tableblock halign-left valign-top">Description</th><th class="tableblock halign-left valign-top">Locking</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>cred</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Subject credential</p></td><td class="tableblock halign-left valign-top"></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>name</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Kernel environment variable name</p></td><td class="tableblock halign-left valign-top"></td></tr></tbody></table><div class=paragraph><p>Determine whether the subject should be allowed to unset the specified kernel environment variable.</p></div></div><div class=sect3><h4 id=mac-mpo-check-kld-load>6.7.4.6. <code>mpo_check_kld_load</code><a class=anchor href=#mac-mpo-check-kld-load></a></h4><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=c><span class=kt>int</span> <span class=nf>mpo_check_kld_load</span><span class=p>(</span><span class=k>struct</span> <span class=n>ucred</span> <span class=o>*</span><span class=n>cred</span><span class=p>,</span> <span class=k>struct</span> <span class=n>vnode</span> <span class=o>*</span><span class=n>vp</span><span class=p>,</span>
    <span class=k>struct</span> <span class=n>label</span> <span class=o>*</span><span class=n>vlabel</span><span class=p>);</span></code></pre></div></div><table class="tableblock frame-none grid-all stretch informaltable"><col style=width:33.3333%><col style=width:33.3333%><col style=width:33.3334%><thead><tr><th class="tableblock halign-left valign-top">Parameter</th><th class="tableblock halign-left valign-top">Description</th><th class="tableblock halign-left valign-top">Locking</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>cred</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Subject credential</p></td><td class="tableblock halign-left valign-top"></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>vp</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Kernel module vnode</p></td><td class="tableblock halign-left valign-top"></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>vlabel</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Label associated with <code>vp</code></p></td><td class="tableblock halign-left valign-top"></td></tr></tbody></table><div class=paragraph><p>Determine whether the subject should be allowed to load the specified module file.</p></div></div><div class=sect3><h4 id=mac-mpo-check-kld-stat>6.7.4.7. <code>mpo_check_kld_stat</code><a class=anchor href=#mac-mpo-check-kld-stat></a></h4><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=c><span class=kt>int</span> <span class=nf>mpo_check_kld_stat</span><span class=p>(</span><span class=k>struct</span> <span class=n>ucred</span> <span class=o>*</span><span class=n>cred</span><span class=p>);</span></code></pre></div></div><table class="tableblock frame-none grid-all stretch informaltable"><col style=width:33.3333%><col style=width:33.3333%><col style=width:33.3334%><thead><tr><th class="tableblock halign-left valign-top">Parameter</th><th class="tableblock halign-left valign-top">Description</th><th class="tableblock halign-left valign-top">Locking</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>cred</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Subject credential</p></td><td class="tableblock halign-left valign-top"></td></tr></tbody></table><div class=paragraph><p>Determine whether the subject should be allowed to retrieve a list of loaded kernel module files and associated statistics.</p></div></div><div class=sect3><h4 id=mac-mpo-check-kld-unload>6.7.4.8. <code>mpo_check_kld_unload</code><a class=anchor href=#mac-mpo-check-kld-unload></a></h4><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=c><span class=kt>int</span> <span class=nf>mpo_check_kld_unload</span><span class=p>(</span><span class=k>struct</span> <span class=n>ucred</span> <span class=o>*</span><span class=n>cred</span><span class=p>);</span></code></pre></div></div><table class="tableblock frame-none grid-all stretch informaltable"><col style=width:33.3333%><col style=width:33.3333%><col style=width:33.3334%><thead><tr><th class="tableblock halign-left valign-top">Parameter</th><th class="tableblock halign-left valign-top">Description</th><th class="tableblock halign-left valign-top">Locking</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>cred</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Subject credential</p></td><td class="tableblock halign-left valign-top"></td></tr></tbody></table><div class=paragraph><p>Determine whether the subject should be allowed to unload a kernel module.</p></div></div><div class=sect3><h4 id=mac-mpo-check-pipe-ioctl>6.7.4.9. <code>mpo_check_pipe_ioctl</code><a class=anchor href=#mac-mpo-check-pipe-ioctl></a></h4><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=c><span class=kt>int</span> <span class=nf>mpo_check_pipe_ioctl</span><span class=p>(</span><span class=k>struct</span> <span class=n>ucred</span> <span class=o>*</span><span class=n>cred</span><span class=p>,</span> <span class=k>struct</span> <span class=n>pipe</span> <span class=o>*</span><span class=n>pipe</span><span class=p>,</span>
    <span class=k>struct</span> <span class=n>label</span> <span class=o>*</span><span class=n>pipelabel</span><span class=p>,</span> <span class=kt>unsigned</span> <span class=kt>long</span> <span class=n>cmd</span><span class=p>,</span> <span class=kt>void</span> <span class=o>*</span><span class=n>data</span><span class=p>);</span></code></pre></div></div><table class="tableblock frame-none grid-all stretch informaltable"><col style=width:33.3333%><col style=width:33.3333%><col style=width:33.3334%><thead><tr><th class="tableblock halign-left valign-top">Parameter</th><th class="tableblock halign-left valign-top">Description</th><th class="tableblock halign-left valign-top">Locking</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>cred</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Subject credential</p></td><td class="tableblock halign-left valign-top"></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>pipe</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Pipe</p></td><td class="tableblock halign-left valign-top"></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>pipelabel</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Policy label associated with <code>pipe</code></p></td><td class="tableblock halign-left valign-top"></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>cmd</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock><a href="https://man.freebsd.org/cgi/man.cgi?query=ioctl&amp;sektion=2&amp;format=html">ioctl(2)</a> command</p></td><td class="tableblock halign-left valign-top"></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>data</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock><a href="https://man.freebsd.org/cgi/man.cgi?query=ioctl&amp;sektion=2&amp;format=html">ioctl(2)</a> data</p></td><td class="tableblock halign-left valign-top"></td></tr></tbody></table><div class=paragraph><p>Determine whether the subject should be allowed to make the specified <a href="https://man.freebsd.org/cgi/man.cgi?query=ioctl&amp;sektion=2&amp;format=html">ioctl(2)</a> call.</p></div></div><div class=sect3><h4 id=mac-mpo-check-pipe-poll>6.7.4.10. <code>mpo_check_pipe_poll</code><a class=anchor href=#mac-mpo-check-pipe-poll></a></h4><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=c><span class=kt>int</span> <span class=nf>mpo_check_pipe_poll</span><span class=p>(</span><span class=k>struct</span> <span class=n>ucred</span> <span class=o>*</span><span class=n>cred</span><span class=p>,</span> <span class=k>struct</span> <span class=n>pipe</span> <span class=o>*</span><span class=n>pipe</span><span class=p>,</span>
    <span class=k>struct</span> <span class=n>label</span> <span class=o>*</span><span class=n>pipelabel</span><span class=p>);</span></code></pre></div></div><table class="tableblock frame-none grid-all stretch informaltable"><col style=width:33.3333%><col style=width:33.3333%><col style=width:33.3334%><thead><tr><th class="tableblock halign-left valign-top">Parameter</th><th class="tableblock halign-left valign-top">Description</th><th class="tableblock halign-left valign-top">Locking</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>cred</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Subject credential</p></td><td class="tableblock halign-left valign-top"></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>pipe</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Pipe</p></td><td class="tableblock halign-left valign-top"></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>pipelabel</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Policy label associated with <code>pipe</code></p></td><td class="tableblock halign-left valign-top"></td></tr></tbody></table><div class=paragraph><p>Determine whether the subject should be allowed to poll <code>pipe</code>.</p></div></div><div class=sect3><h4 id=mac-mpo-check-pipe-read>6.7.4.11. <code>mpo_check_pipe_read</code><a class=anchor href=#mac-mpo-check-pipe-read></a></h4><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=c><span class=kt>int</span> <span class=nf>mpo_check_pipe_read</span><span class=p>(</span><span class=k>struct</span> <span class=n>ucred</span> <span class=o>*</span><span class=n>cred</span><span class=p>,</span> <span class=k>struct</span> <span class=n>pipe</span> <span class=o>*</span><span class=n>pipe</span><span class=p>,</span>
    <span class=k>struct</span> <span class=n>label</span> <span class=o>*</span><span class=n>pipelabel</span><span class=p>);</span></code></pre></div></div><table class="tableblock frame-none grid-all stretch informaltable"><col style=width:33.3333%><col style=width:33.3333%><col style=width:33.3334%><thead><tr><th class="tableblock halign-left valign-top">Parameter</th><th class="tableblock halign-left valign-top">Description</th><th class="tableblock halign-left valign-top">Locking</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>cred</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Subject credential</p></td><td class="tableblock halign-left valign-top"></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>pipe</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Pipe</p></td><td class="tableblock halign-left valign-top"></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>pipelabel</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Policy label associated with <code>pipe</code></p></td><td class="tableblock halign-left valign-top"></td></tr></tbody></table><div class=paragraph><p>Determine whether the subject should be allowed read access to <code>pipe</code>.</p></div></div><div class=sect3><h4 id=mac-mpo-check-pipe-relabel>6.7.4.12. <code>mpo_check_pipe_relabel</code><a class=anchor href=#mac-mpo-check-pipe-relabel></a></h4><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=c><span class=kt>int</span> <span class=nf>mpo_check_pipe_relabel</span><span class=p>(</span><span class=k>struct</span> <span class=n>ucred</span> <span class=o>*</span><span class=n>cred</span><span class=p>,</span> <span class=k>struct</span> <span class=n>pipe</span> <span class=o>*</span><span class=n>pipe</span><span class=p>,</span>
    <span class=k>struct</span> <span class=n>label</span> <span class=o>*</span><span class=n>pipelabel</span><span class=p>,</span> <span class=k>struct</span> <span class=n>label</span> <span class=o>*</span><span class=n>newlabel</span><span class=p>);</span></code></pre></div></div><table class="tableblock frame-none grid-all stretch informaltable"><col style=width:33.3333%><col style=width:33.3333%><col style=width:33.3334%><thead><tr><th class="tableblock halign-left valign-top">Parameter</th><th class="tableblock halign-left valign-top">Description</th><th class="tableblock halign-left valign-top">Locking</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>cred</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Subject credential</p></td><td class="tableblock halign-left valign-top"></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>pipe</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Pipe</p></td><td class="tableblock halign-left valign-top"></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>pipelabel</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Current policy label associated with <code>pipe</code></p></td><td class="tableblock halign-left valign-top"></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>newlabel</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Label update to <code>pipelabel</code></p></td><td class="tableblock halign-left valign-top"></td></tr></tbody></table><div class=paragraph><p>Determine whether the subject should be allowed to relabel <code>pipe</code>.</p></div></div><div class=sect3><h4 id=mac-mpo-check-pipe-stat>6.7.4.13. <code>mpo_check_pipe_stat</code><a class=anchor href=#mac-mpo-check-pipe-stat></a></h4><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=c><span class=kt>int</span> <span class=nf>mpo_check_pipe_stat</span><span class=p>(</span><span class=k>struct</span> <span class=n>ucred</span> <span class=o>*</span><span class=n>cred</span><span class=p>,</span> <span class=k>struct</span> <span class=n>pipe</span> <span class=o>*</span><span class=n>pipe</span><span class=p>,</span>
    <span class=k>struct</span> <span class=n>label</span> <span class=o>*</span><span class=n>pipelabel</span><span class=p>);</span></code></pre></div></div><table class="tableblock frame-none grid-all stretch informaltable"><col style=width:33.3333%><col style=width:33.3333%><col style=width:33.3334%><thead><tr><th class="tableblock halign-left valign-top">Parameter</th><th class="tableblock halign-left valign-top">Description</th><th class="tableblock halign-left valign-top">Locking</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>cred</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Subject credential</p></td><td class="tableblock halign-left valign-top"></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>pipe</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Pipe</p></td><td class="tableblock halign-left valign-top"></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>pipelabel</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Policy label associated with <code>pipe</code></p></td><td class="tableblock halign-left valign-top"></td></tr></tbody></table><div class=paragraph><p>Determine whether the subject should be allowed to retrieve statistics related to <code>pipe</code>.</p></div></div><div class=sect3><h4 id=mac-mpo-check-pipe-write>6.7.4.14. <code>mpo_check_pipe_write</code><a class=anchor href=#mac-mpo-check-pipe-write></a></h4><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=c><span class=kt>int</span> <span class=nf>mpo_check_pipe_write</span><span class=p>(</span><span class=k>struct</span> <span class=n>ucred</span> <span class=o>*</span><span class=n>cred</span><span class=p>,</span> <span class=k>struct</span> <span class=n>pipe</span> <span class=o>*</span><span class=n>pipe</span><span class=p>,</span>
    <span class=k>struct</span> <span class=n>label</span> <span class=o>*</span><span class=n>pipelabel</span><span class=p>);</span></code></pre></div></div><table class="tableblock frame-none grid-all stretch informaltable"><col style=width:33.3333%><col style=width:33.3333%><col style=width:33.3334%><thead><tr><th class="tableblock halign-left valign-top">Parameter</th><th class="tableblock halign-left valign-top">Description</th><th class="tableblock halign-left valign-top">Locking</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>cred</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Subject credential</p></td><td class="tableblock halign-left valign-top"></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>pipe</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Pipe</p></td><td class="tableblock halign-left valign-top"></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>pipelabel</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Policy label associated with <code>pipe</code></p></td><td class="tableblock halign-left valign-top"></td></tr></tbody></table><div class=paragraph><p>Determine whether the subject should be allowed to write to <code>pipe</code>.</p></div></div><div class=sect3><h4 id=mac-mpo-cred-check-socket-bind>6.7.4.15. <code>mpo_check_socket_bind</code><a class=anchor href=#mac-mpo-cred-check-socket-bind></a></h4><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=c><span class=kt>int</span> <span class=nf>mpo_check_socket_bind</span><span class=p>(</span><span class=k>struct</span> <span class=n>ucred</span> <span class=o>*</span><span class=n>cred</span><span class=p>,</span> <span class=k>struct</span> <span class=n>socket</span> <span class=o>*</span><span class=n>socket</span><span class=p>,</span>
    <span class=k>struct</span> <span class=n>label</span> <span class=o>*</span><span class=n>socketlabel</span><span class=p>,</span> <span class=k>struct</span> <span class=n>sockaddr</span> <span class=o>*</span><span class=n>sockaddr</span><span class=p>);</span></code></pre></div></div><table class="tableblock frame-none grid-all stretch informaltable"><col style=width:33.3333%><col style=width:33.3333%><col style=width:33.3334%><thead><tr><th class="tableblock halign-left valign-top">Parameter</th><th class="tableblock halign-left valign-top">Description</th><th class="tableblock halign-left valign-top">Locking</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>cred</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Subject credential</p></td><td class="tableblock halign-left valign-top"></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>socket</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Socket to be bound</p></td><td class="tableblock halign-left valign-top"></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>socketlabel</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Policy label for <code>socket</code></p></td><td class="tableblock halign-left valign-top"></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>sockaddr</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Address of <code>socket</code></p></td><td class="tableblock halign-left valign-top"></td></tr></tbody></table></div><div class=sect3><h4 id=mac-mpo-cred-check-socket-connect>6.7.4.16. <code>mpo_check_socket_connect</code><a class=anchor href=#mac-mpo-cred-check-socket-connect></a></h4><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=c><span class=kt>int</span> <span class=nf>mpo_check_socket_connect</span><span class=p>(</span><span class=k>struct</span> <span class=n>ucred</span> <span class=o>*</span><span class=n>cred</span><span class=p>,</span> <span class=k>struct</span> <span class=n>socket</span> <span class=o>*</span><span class=n>socket</span><span class=p>,</span>
    <span class=k>struct</span> <span class=n>label</span> <span class=o>*</span><span class=n>socketlabel</span><span class=p>,</span> <span class=k>struct</span> <span class=n>sockaddr</span> <span class=o>*</span><span class=n>sockaddr</span><span class=p>);</span></code></pre></div></div><table class="tableblock frame-none grid-all stretch informaltable"><col style=width:33.3333%><col style=width:33.3333%><col style=width:33.3334%><thead><tr><th class="tableblock halign-left valign-top">Parameter</th><th class="tableblock halign-left valign-top">Description</th><th class="tableblock halign-left valign-top">Locking</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>cred</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Subject credential</p></td><td class="tableblock halign-left valign-top"></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>socket</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Socket to be connected</p></td><td class="tableblock halign-left valign-top"></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>socketlabel</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Policy label for <code>socket</code></p></td><td class="tableblock halign-left valign-top"></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>sockaddr</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Address of <code>socket</code></p></td><td class="tableblock halign-left valign-top"></td></tr></tbody></table><div class=paragraph><p>Determine whether the subject credential (<code>cred</code>) can connect the passed socket (<code>socket</code>) to the passed socket address (<code>sockaddr</code>).
Return 0 for success, or an <code>errno</code> value for failure.
Suggested failure: EACCES for label mismatches, EPERM for lack of privilege.</p></div></div><div class=sect3><h4 id=mac-mpo-check-socket-receive>6.7.4.17. <code>mpo_check_socket_receive</code><a class=anchor href=#mac-mpo-check-socket-receive></a></h4><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=c><span class=kt>int</span> <span class=nf>mpo_check_socket_receive</span><span class=p>(</span><span class=k>struct</span> <span class=n>ucred</span> <span class=o>*</span><span class=n>cred</span><span class=p>,</span> <span class=k>struct</span> <span class=n>socket</span> <span class=o>*</span><span class=n>so</span><span class=p>,</span>
    <span class=k>struct</span> <span class=n>label</span> <span class=o>*</span><span class=n>socketlabel</span><span class=p>);</span></code></pre></div></div><table class="tableblock frame-none grid-all stretch informaltable"><col style=width:33.3333%><col style=width:33.3333%><col style=width:33.3334%><thead><tr><th class="tableblock halign-left valign-top">Parameter</th><th class="tableblock halign-left valign-top">Description</th><th class="tableblock halign-left valign-top">Locking</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>cred</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Subject credential</p></td><td class="tableblock halign-left valign-top"></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>so</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Socket</p></td><td class="tableblock halign-left valign-top"></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>socketlabel</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Policy label associated with <code>so</code></p></td><td class="tableblock halign-left valign-top"></td></tr></tbody></table><div class=paragraph><p>Determine whether the subject should be allowed to receive information from the socket <code>so</code>.</p></div></div><div class=sect3><h4 id=mac-mpo-check-socket-send>6.7.4.18. <code>mpo_check_socket_send</code><a class=anchor href=#mac-mpo-check-socket-send></a></h4><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=c><span class=kt>int</span> <span class=nf>mpo_check_socket_send</span><span class=p>(</span><span class=k>struct</span> <span class=n>ucred</span> <span class=o>*</span><span class=n>cred</span><span class=p>,</span> <span class=k>struct</span> <span class=n>socket</span> <span class=o>*</span><span class=n>so</span><span class=p>,</span>
    <span class=k>struct</span> <span class=n>label</span> <span class=o>*</span><span class=n>socketlabel</span><span class=p>);</span></code></pre></div></div><table class="tableblock frame-none grid-all stretch informaltable"><col style=width:33.3333%><col style=width:33.3333%><col style=width:33.3334%><thead><tr><th class="tableblock halign-left valign-top">Parameter</th><th class="tableblock halign-left valign-top">Description</th><th class="tableblock halign-left valign-top">Locking</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>cred</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Subject credential</p></td><td class="tableblock halign-left valign-top"></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>so</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Socket</p></td><td class="tableblock halign-left valign-top"></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>socketlabel</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Policy label associated with <code>so</code></p></td><td class="tableblock halign-left valign-top"></td></tr></tbody></table><div class=paragraph><p>Determine whether the subject should be allowed to send information across the socket <code>so</code>.</p></div></div><div class=sect3><h4 id=mac-mpo-check-cred-visible>6.7.4.19. <code>mpo_check_cred_visible</code><a class=anchor href=#mac-mpo-check-cred-visible></a></h4><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=c><span class=kt>int</span> <span class=nf>mpo_check_cred_visible</span><span class=p>(</span><span class=k>struct</span> <span class=n>ucred</span> <span class=o>*</span><span class=n>u1</span><span class=p>,</span> <span class=k>struct</span> <span class=n>ucred</span> <span class=o>*</span><span class=n>u2</span><span class=p>);</span></code></pre></div></div><table class="tableblock frame-none grid-all stretch informaltable"><col style=width:33.3333%><col style=width:33.3333%><col style=width:33.3334%><thead><tr><th class="tableblock halign-left valign-top">Parameter</th><th class="tableblock halign-left valign-top">Description</th><th class="tableblock halign-left valign-top">Locking</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>u1</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Subject credential</p></td><td class="tableblock halign-left valign-top"></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>u2</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Object credential</p></td><td class="tableblock halign-left valign-top"></td></tr></tbody></table><div class=paragraph><p>Determine whether the subject credential <code>u1</code> can "see" other subjects with the passed subject credential <code>u2</code>.
Return 0 for success, or an <code>errno</code> value for failure.
Suggested failure: EACCES for label mismatches, EPERM for lack of privilege, or ESRCH to hide visibility.
This call may be made in a number of situations, including inter-process status sysctl’s used by <code>ps</code>, and in procfs lookups.</p></div></div><div class=sect3><h4 id=mac-mpo-cred-check-socket-visible>6.7.4.20. <code>mpo_check_socket_visible</code><a class=anchor href=#mac-mpo-cred-check-socket-visible></a></h4><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=c><span class=kt>int</span> <span class=nf>mpo_check_socket_visible</span><span class=p>(</span><span class=k>struct</span> <span class=n>ucred</span> <span class=o>*</span><span class=n>cred</span><span class=p>,</span> <span class=k>struct</span> <span class=n>socket</span> <span class=o>*</span><span class=n>socket</span><span class=p>,</span>
    <span class=k>struct</span> <span class=n>label</span> <span class=o>*</span><span class=n>socketlabel</span><span class=p>);</span></code></pre></div></div><table class="tableblock frame-none grid-all stretch informaltable"><col style=width:33.3333%><col style=width:33.3333%><col style=width:33.3334%><thead><tr><th class="tableblock halign-left valign-top">Parameter</th><th class="tableblock halign-left valign-top">Description</th><th class="tableblock halign-left valign-top">Locking</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>cred</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Subject credential</p></td><td class="tableblock halign-left valign-top"></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>socket</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Object; socket</p></td><td class="tableblock halign-left valign-top"></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>socketlabel</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Policy label for <code>socket</code></p></td><td class="tableblock halign-left valign-top"></td></tr></tbody></table></div><div class=sect3><h4 id=mac-mpo-cred-check-ifnet-relabel>6.7.4.21. <code>mpo_check_ifnet_relabel</code><a class=anchor href=#mac-mpo-cred-check-ifnet-relabel></a></h4><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=c><span class=kt>int</span> <span class=nf>mpo_check_ifnet_relabel</span><span class=p>(</span><span class=k>struct</span> <span class=n>ucred</span> <span class=o>*</span><span class=n>cred</span><span class=p>,</span> <span class=k>struct</span> <span class=n>ifnet</span> <span class=o>*</span><span class=n>ifnet</span><span class=p>,</span>
    <span class=k>struct</span> <span class=n>label</span> <span class=o>*</span><span class=n>ifnetlabel</span><span class=p>,</span> <span class=k>struct</span> <span class=n>label</span> <span class=o>*</span><span class=n>newlabel</span><span class=p>);</span></code></pre></div></div><table class="tableblock frame-none grid-all stretch informaltable"><col style=width:33.3333%><col style=width:33.3333%><col style=width:33.3334%><thead><tr><th class="tableblock halign-left valign-top">Parameter</th><th class="tableblock halign-left valign-top">Description</th><th class="tableblock halign-left valign-top">Locking</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>cred</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Subject credential</p></td><td class="tableblock halign-left valign-top"></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>ifnet</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Object; network interface</p></td><td class="tableblock halign-left valign-top"></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>ifnetlabel</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Existing policy label for <code>ifnet</code></p></td><td class="tableblock halign-left valign-top"></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>newlabel</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Policy label update to later be applied to <code>ifnet</code></p></td><td class="tableblock halign-left valign-top"></td></tr></tbody></table><div class=paragraph><p>Determine whether the subject credential can relabel the passed network interface to the passed label update.</p></div></div><div class=sect3><h4 id=mac-mpo-cred-check-socket-relabel>6.7.4.22. <code>mpo_check_socket_relabel</code><a class=anchor href=#mac-mpo-cred-check-socket-relabel></a></h4><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=c><span class=kt>int</span> <span class=nf>mpo_check_socket_relabel</span><span class=p>(</span><span class=k>struct</span> <span class=n>ucred</span> <span class=o>*</span><span class=n>cred</span><span class=p>,</span> <span class=k>struct</span> <span class=n>socket</span> <span class=o>*</span><span class=n>socket</span><span class=p>,</span>
    <span class=k>struct</span> <span class=n>label</span> <span class=o>*</span><span class=n>socketlabel</span><span class=p>,</span> <span class=k>struct</span> <span class=n>label</span> <span class=o>*</span><span class=n>newlabel</span><span class=p>);</span></code></pre></div></div><table class="tableblock frame-none grid-all stretch informaltable"><col style=width:33.3333%><col style=width:33.3333%><col style=width:33.3334%><thead><tr><th class="tableblock halign-left valign-top">Parameter</th><th class="tableblock halign-left valign-top">Description</th><th class="tableblock halign-left valign-top">Locking</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>cred</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Subject credential</p></td><td class="tableblock halign-left valign-top"></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>socket</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Object; socket</p></td><td class="tableblock halign-left valign-top"></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>socketlabel</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Existing policy label for <code>socket</code></p></td><td class="tableblock halign-left valign-top"></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>newlabel</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Label update to later be applied to <code>socketlabel</code></p></td><td class="tableblock halign-left valign-top"></td></tr></tbody></table><div class=paragraph><p>Determine whether the subject credential can relabel the passed socket to the passed label update.</p></div></div><div class=sect3><h4 id=mac-mpo-cred-check-cred-relabel>6.7.4.23. <code>mpo_check_cred_relabel</code><a class=anchor href=#mac-mpo-cred-check-cred-relabel></a></h4><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=c><span class=kt>int</span> <span class=nf>mpo_check_cred_relabel</span><span class=p>(</span><span class=k>struct</span> <span class=n>ucred</span> <span class=o>*</span><span class=n>cred</span><span class=p>,</span> <span class=k>struct</span> <span class=n>label</span> <span class=o>*</span><span class=n>newlabel</span><span class=p>);</span></code></pre></div></div><table class="tableblock frame-none grid-all stretch informaltable"><col style=width:33.3333%><col style=width:33.3333%><col style=width:33.3334%><thead><tr><th class="tableblock halign-left valign-top">Parameter</th><th class="tableblock halign-left valign-top">Description</th><th class="tableblock halign-left valign-top">Locking</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>cred</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Subject credential</p></td><td class="tableblock halign-left valign-top"></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>newlabel</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Label update to later be applied to <code>cred</code></p></td><td class="tableblock halign-left valign-top"></td></tr></tbody></table><div class=paragraph><p>Determine whether the subject credential can relabel itself to the passed label update.</p></div></div><div class=sect3><h4 id=mac-mpo-cred-check-vnode-relabel>6.7.4.24. <code>mpo_check_vnode_relabel</code><a class=anchor href=#mac-mpo-cred-check-vnode-relabel></a></h4><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=c><span class=kt>int</span> <span class=nf>mpo_check_vnode_relabel</span><span class=p>(</span><span class=k>struct</span> <span class=n>ucred</span> <span class=o>*</span><span class=n>cred</span><span class=p>,</span> <span class=k>struct</span> <span class=n>vnode</span> <span class=o>*</span><span class=n>vp</span><span class=p>,</span>
    <span class=k>struct</span> <span class=n>label</span> <span class=o>*</span><span class=n>vnodelabel</span><span class=p>,</span> <span class=k>struct</span> <span class=n>label</span> <span class=o>*</span><span class=n>newlabel</span><span class=p>);</span></code></pre></div></div><table class="tableblock frame-none grid-all stretch informaltable"><col style=width:33.3333%><col style=width:33.3333%><col style=width:33.3334%><thead><tr><th class="tableblock halign-left valign-top">Parameter</th><th class="tableblock halign-left valign-top">Description</th><th class="tableblock halign-left valign-top">Locking</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>cred</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Subject credential</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Immutable</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>vp</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Object; vnode</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Locked</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>vnodelabel</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Existing policy label for <code>vp</code></p></td><td class="tableblock halign-left valign-top"></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>newlabel</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Policy label update to later be applied to <code>vp</code></p></td><td class="tableblock halign-left valign-top"></td></tr></tbody></table><div class=paragraph><p>Determine whether the subject credential can relabel the passed vnode to the passed label update.</p></div></div><div class=sect3><h4 id=mpo-cred-check-mount-stat>6.7.4.25. <code>mpo_check_mount_stat</code><a class=anchor href=#mpo-cred-check-mount-stat></a></h4><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=c><span class=kt>int</span> <span class=nf>mpo_check_mount_stat</span><span class=p>(</span><span class=k>struct</span> <span class=n>ucred</span> <span class=o>*</span><span class=n>cred</span><span class=p>,</span> <span class=k>struct</span> <span class=n>mount</span> <span class=o>*</span><span class=n>mp</span><span class=p>,</span>
    <span class=k>struct</span> <span class=n>label</span> <span class=o>*</span><span class=n>mountlabel</span><span class=p>);</span></code></pre></div></div><table class="tableblock frame-none grid-all stretch informaltable"><col style=width:33.3333%><col style=width:33.3333%><col style=width:33.3334%><thead><tr><th class="tableblock halign-left valign-top">Parameter</th><th class="tableblock halign-left valign-top">Description</th><th class="tableblock halign-left valign-top">Locking</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>cred</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Subject credential</p></td><td class="tableblock halign-left valign-top"></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>mp</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Object; file system mount</p></td><td class="tableblock halign-left valign-top"></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>mountlabel</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Policy label for <code>mp</code></p></td><td class="tableblock halign-left valign-top"></td></tr></tbody></table><div class=paragraph><p>Determine whether the subject credential can see the results of a statfs performed on the file system.
Return 0 for success, or an <code>errno</code> value for failure.
Suggested failure: EACCES for label mismatches or EPERM for lack of privilege.
This call may be made in a number of situations, including during invocations of <a href="https://man.freebsd.org/cgi/man.cgi?query=statfs&amp;sektion=2&amp;format=html">statfs(2)</a> and related calls, as well as to determine what file systems to exclude from listings of file systems, such as when <a href="https://man.freebsd.org/cgi/man.cgi?query=getfsstat&amp;sektion=2&amp;format=html">getfsstat(2)</a> is invoked.</p></div></div><div class=sect3><h4 id=mac-mpo-cred-check-proc-debug>6.7.4.26. <code>mpo_check_proc_debug</code><a class=anchor href=#mac-mpo-cred-check-proc-debug></a></h4><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=c><span class=kt>int</span> <span class=nf>mpo_check_proc_debug</span><span class=p>(</span><span class=k>struct</span> <span class=n>ucred</span> <span class=o>*</span><span class=n>cred</span><span class=p>,</span> <span class=k>struct</span> <span class=n>proc</span> <span class=o>*</span><span class=n>proc</span><span class=p>);</span></code></pre></div></div><table class="tableblock frame-none grid-all stretch informaltable"><col style=width:33.3333%><col style=width:33.3333%><col style=width:33.3334%><thead><tr><th class="tableblock halign-left valign-top">Parameter</th><th class="tableblock halign-left valign-top">Description</th><th class="tableblock halign-left valign-top">Locking</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>cred</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Subject credential</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Immutable</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>proc</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Object; process</p></td><td class="tableblock halign-left valign-top"></td></tr></tbody></table><div class=paragraph><p>Determine whether the subject credential can debug the passed process.
Return 0 for success, or an <code>errno</code> value for failure.
Suggested failure: EACCES for label mismatch, EPERM for lack of privilege, or ESRCH to hide visibility of the target.
This call may be made in a number of situations, including use of the <a href="https://man.freebsd.org/cgi/man.cgi?query=ptrace&amp;sektion=2&amp;format=html">ptrace(2)</a> and <a href="https://man.freebsd.org/cgi/man.cgi?query=ktrace&amp;sektion=2&amp;format=html">ktrace(2)</a> APIs, as well as for some types of procfs operations.</p></div></div><div class=sect3><h4 id=mac-mpo-cred-check-vnode-access>6.7.4.27. <code>mpo_check_vnode_access</code><a class=anchor href=#mac-mpo-cred-check-vnode-access></a></h4><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=c><span class=kt>int</span> <span class=nf>mpo_check_vnode_access</span><span class=p>(</span><span class=k>struct</span> <span class=n>ucred</span> <span class=o>*</span><span class=n>cred</span><span class=p>,</span> <span class=k>struct</span> <span class=n>vnode</span> <span class=o>*</span><span class=n>vp</span><span class=p>,</span>
    <span class=k>struct</span> <span class=n>label</span> <span class=o>*</span><span class=n>label</span><span class=p>,</span> <span class=kt>int</span> <span class=n>flags</span><span class=p>);</span></code></pre></div></div><table class="tableblock frame-none grid-all stretch informaltable"><col style=width:33.3333%><col style=width:33.3333%><col style=width:33.3334%><thead><tr><th class="tableblock halign-left valign-top">Parameter</th><th class="tableblock halign-left valign-top">Description</th><th class="tableblock halign-left valign-top">Locking</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>cred</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Subject credential</p></td><td class="tableblock halign-left valign-top"></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>vp</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Object; vnode</p></td><td class="tableblock halign-left valign-top"></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>label</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Policy label for <code>vp</code></p></td><td class="tableblock halign-left valign-top"></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>flags</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock><a href="https://man.freebsd.org/cgi/man.cgi?query=access&amp;sektion=2&amp;format=html">access(2)</a> flags</p></td><td class="tableblock halign-left valign-top"></td></tr></tbody></table><div class=paragraph><p>Determine how invocations of <a href="https://man.freebsd.org/cgi/man.cgi?query=access&amp;sektion=2&amp;format=html">access(2)</a> and related calls by the subject credential should return when performed on the passed vnode using the passed access flags.
This should generally be implemented using the same semantics used in <code>mpo_check_vnode_open</code>.
Return 0 for success, or an <code>errno</code> value for failure.
Suggested failure: EACCES for label mismatches or EPERM for lack of privilege.</p></div></div><div class=sect3><h4 id=mac-mpo-cred-check-vnode-chdir>6.7.4.28. <code>mpo_check_vnode_chdir</code><a class=anchor href=#mac-mpo-cred-check-vnode-chdir></a></h4><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=c><span class=kt>int</span> <span class=nf>mpo_check_vnode_chdir</span><span class=p>(</span><span class=k>struct</span> <span class=n>ucred</span> <span class=o>*</span><span class=n>cred</span><span class=p>,</span> <span class=k>struct</span> <span class=n>vnode</span> <span class=o>*</span><span class=n>dvp</span><span class=p>,</span>
    <span class=k>struct</span> <span class=n>label</span> <span class=o>*</span><span class=n>dlabel</span><span class=p>);</span></code></pre></div></div><table class="tableblock frame-none grid-all stretch informaltable"><col style=width:33.3333%><col style=width:33.3333%><col style=width:33.3334%><thead><tr><th class="tableblock halign-left valign-top">Parameter</th><th class="tableblock halign-left valign-top">Description</th><th class="tableblock halign-left valign-top">Locking</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>cred</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Subject credential</p></td><td class="tableblock halign-left valign-top"></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>dvp</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Object; vnode to <a href="https://man.freebsd.org/cgi/man.cgi?query=chdir&amp;sektion=2&amp;format=html">chdir(2)</a> into</p></td><td class="tableblock halign-left valign-top"></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>dlabel</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Policy label for <code>dvp</code></p></td><td class="tableblock halign-left valign-top"></td></tr></tbody></table><div class=paragraph><p>Determine whether the subject credential can change the process working directory to the passed vnode.
Return 0 for success, or an <code>errno</code> value for failure.
Suggested failure: EACCES for label mismatch, or EPERM for lack of privilege.</p></div></div><div class=sect3><h4 id=mac-mpo-check-vnode-chroot>6.7.4.29. <code>mpo_check_vnode_chroot</code><a class=anchor href=#mac-mpo-check-vnode-chroot></a></h4><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=c><span class=kt>int</span> <span class=nf>mpo_check_vnode_chroot</span><span class=p>(</span><span class=k>struct</span> <span class=n>ucred</span> <span class=o>*</span><span class=n>cred</span><span class=p>,</span> <span class=k>struct</span> <span class=n>vnode</span> <span class=o>*</span><span class=n>dvp</span><span class=p>,</span>
    <span class=k>struct</span> <span class=n>label</span> <span class=o>*</span><span class=n>dlabel</span><span class=p>);</span></code></pre></div></div><table class="tableblock frame-none grid-all stretch informaltable"><col style=width:33.3333%><col style=width:33.3333%><col style=width:33.3334%><thead><tr><th class="tableblock halign-left valign-top">Parameter</th><th class="tableblock halign-left valign-top">Description</th><th class="tableblock halign-left valign-top">Locking</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>cred</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Subject credential</p></td><td class="tableblock halign-left valign-top"></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>dvp</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Directory vnode</p></td><td class="tableblock halign-left valign-top"></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>dlabel</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Policy label associated with <code>dvp</code></p></td><td class="tableblock halign-left valign-top"></td></tr></tbody></table><div class=paragraph><p>Determine whether the subject should be allowed to <a href="https://man.freebsd.org/cgi/man.cgi?query=chroot&amp;sektion=2&amp;format=html">chroot(2)</a> into the specified directory (<code>dvp</code>).</p></div></div><div class=sect3><h4 id=mac-mpo-cred-check-vnode-create>6.7.4.30. <code>mpo_check_vnode_create</code><a class=anchor href=#mac-mpo-cred-check-vnode-create></a></h4><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=c><span class=kt>int</span> <span class=nf>mpo_check_vnode_create</span><span class=p>(</span><span class=k>struct</span> <span class=n>ucred</span> <span class=o>*</span><span class=n>cred</span><span class=p>,</span> <span class=k>struct</span> <span class=n>vnode</span> <span class=o>*</span><span class=n>dvp</span><span class=p>,</span>
    <span class=k>struct</span> <span class=n>label</span> <span class=o>*</span><span class=n>dlabel</span><span class=p>,</span> <span class=k>struct</span> <span class=n>componentname</span> <span class=o>*</span><span class=n>cnp</span><span class=p>,</span> <span class=k>struct</span> <span class=n>vattr</span> <span class=o>*</span><span class=n>vap</span><span class=p>);</span></code></pre></div></div><table class="tableblock frame-none grid-all stretch informaltable"><col style=width:33.3333%><col style=width:33.3333%><col style=width:33.3334%><thead><tr><th class="tableblock halign-left valign-top">Parameter</th><th class="tableblock halign-left valign-top">Description</th><th class="tableblock halign-left valign-top">Locking</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>cred</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Subject credential</p></td><td class="tableblock halign-left valign-top"></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>dvp</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Object; vnode</p></td><td class="tableblock halign-left valign-top"></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>dlabel</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Policy label for <code>dvp</code></p></td><td class="tableblock halign-left valign-top"></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>cnp</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Component name for <code>dvp</code></p></td><td class="tableblock halign-left valign-top"></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>vap</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>vnode attributes for <code>vap</code></p></td><td class="tableblock halign-left valign-top"></td></tr></tbody></table><div class=paragraph><p>Determine whether the subject credential can create a vnode with the passed parent directory, passed name information, and passed attribute information.
Return 0 for success, or an <code>errno</code> value for failure.
Suggested failure: EACCES for label mismatch, or EPERM for lack of privilege.
This call may be made in a number of situations, including as a result of calls to <a href="https://man.freebsd.org/cgi/man.cgi?query=open&amp;sektion=2&amp;format=html">open(2)</a> with O_CREAT, <a href="https://man.freebsd.org/cgi/man.cgi?query=mkfifo&amp;sektion=2&amp;format=html">mkfifo(2)</a>, and others.</p></div></div><div class=sect3><h4 id=mac-mpo-cred-check-vnode-delete>6.7.4.31. <code>mpo_check_vnode_delete</code><a class=anchor href=#mac-mpo-cred-check-vnode-delete></a></h4><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=c><span class=kt>int</span> <span class=nf>mpo_check_vnode_delete</span><span class=p>(</span><span class=k>struct</span> <span class=n>ucred</span> <span class=o>*</span><span class=n>cred</span><span class=p>,</span> <span class=k>struct</span> <span class=n>vnode</span> <span class=o>*</span><span class=n>dvp</span><span class=p>,</span>
    <span class=k>struct</span> <span class=n>label</span> <span class=o>*</span><span class=n>dlabel</span><span class=p>,</span> <span class=k>struct</span> <span class=n>vnode</span> <span class=o>*</span><span class=n>vp</span><span class=p>,</span> <span class=kt>void</span> <span class=o>*</span><span class=n>label</span><span class=p>,</span>
    <span class=k>struct</span> <span class=n>componentname</span> <span class=o>*</span><span class=n>cnp</span><span class=p>);</span></code></pre></div></div><table class="tableblock frame-none grid-all stretch informaltable"><col style=width:33.3333%><col style=width:33.3333%><col style=width:33.3334%><thead><tr><th class="tableblock halign-left valign-top">Parameter</th><th class="tableblock halign-left valign-top">Description</th><th class="tableblock halign-left valign-top">Locking</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>cred</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Subject credential</p></td><td class="tableblock halign-left valign-top"></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>dvp</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Parent directory vnode</p></td><td class="tableblock halign-left valign-top"></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>dlabel</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Policy label for <code>dvp</code></p></td><td class="tableblock halign-left valign-top"></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>vp</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Object; vnode to delete</p></td><td class="tableblock halign-left valign-top"></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>label</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Policy label for <code>vp</code></p></td><td class="tableblock halign-left valign-top"></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>cnp</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Component name for <code>vp</code></p></td><td class="tableblock halign-left valign-top"></td></tr></tbody></table><div class=paragraph><p>Determine whether the subject credential can delete a vnode from the passed parent directory and passed name information.
Return 0 for success, or an <code>errno</code> value for failure.
Suggested failure: EACCES for label mismatch, or EPERM for lack of privilege.
This call may be made in a number of situations, including as a result of calls to <a href="https://man.freebsd.org/cgi/man.cgi?query=unlink&amp;sektion=2&amp;format=html">unlink(2)</a> and <a href="https://man.freebsd.org/cgi/man.cgi?query=rmdir&amp;sektion=2&amp;format=html">rmdir(2)</a>.
Policies implementing this entry point should also implement <code>mpo_check_rename_to</code> to authorize deletion of objects as a result of being the target of a rename.</p></div></div><div class=sect3><h4 id=mac-mpo-cred-check-vnode-deleteacl>6.7.4.32. <code>mpo_check_vnode_deleteacl</code><a class=anchor href=#mac-mpo-cred-check-vnode-deleteacl></a></h4><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=c><span class=kt>int</span> <span class=nf>mpo_check_vnode_deleteacl</span><span class=p>(</span><span class=k>struct</span> <span class=n>ucred</span> <span class=o>*</span><span class=n>cred</span><span class=p>,</span> <span class=k>struct</span> <span class=n>vnode</span> <span class=o>*</span><span class=n>vp</span><span class=p>,</span>
    <span class=k>struct</span> <span class=n>label</span> <span class=o>*</span><span class=n>label</span><span class=p>,</span> <span class=n>acl_type_t</span> <span class=n>type</span><span class=p>);</span></code></pre></div></div><table class="tableblock frame-none grid-all stretch informaltable"><col style=width:33.3333%><col style=width:33.3333%><col style=width:33.3334%><thead><tr><th class="tableblock halign-left valign-top">Parameter</th><th class="tableblock halign-left valign-top">Description</th><th class="tableblock halign-left valign-top">Locking</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>cred</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Subject credential</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Immutable</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>vp</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Object; vnode</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Locked</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>label</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Policy label for <code>vp</code></p></td><td class="tableblock halign-left valign-top"></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>type</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>ACL type</p></td><td class="tableblock halign-left valign-top"></td></tr></tbody></table><div class=paragraph><p>Determine whether the subject credential can delete the ACL of passed type from the passed vnode.
Return 0 for success, or an <code>errno</code> value for failure.
Suggested failure: EACCES for label mismatch, or EPERM for lack of privilege.</p></div></div><div class=sect3><h4 id=mac-mpo-cred-check-vnode-exec>6.7.4.33. <code>mpo_check_vnode_exec</code><a class=anchor href=#mac-mpo-cred-check-vnode-exec></a></h4><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=c><span class=kt>int</span> <span class=nf>mpo_check_vnode_exec</span><span class=p>(</span><span class=k>struct</span> <span class=n>ucred</span> <span class=o>*</span><span class=n>cred</span><span class=p>,</span> <span class=k>struct</span> <span class=n>vnode</span> <span class=o>*</span><span class=n>vp</span><span class=p>,</span>
    <span class=k>struct</span> <span class=n>label</span> <span class=o>*</span><span class=n>label</span><span class=p>);</span></code></pre></div></div><table class="tableblock frame-none grid-all stretch informaltable"><col style=width:33.3333%><col style=width:33.3333%><col style=width:33.3334%><thead><tr><th class="tableblock halign-left valign-top">Parameter</th><th class="tableblock halign-left valign-top">Description</th><th class="tableblock halign-left valign-top">Locking</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>cred</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Subject credential</p></td><td class="tableblock halign-left valign-top"></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>vp</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Object; vnode to execute</p></td><td class="tableblock halign-left valign-top"></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>label</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Policy label for <code>vp</code></p></td><td class="tableblock halign-left valign-top"></td></tr></tbody></table><div class=paragraph><p>Determine whether the subject credential can execute the passed vnode.
Determination of execute privilege is made separately from decisions about any transitioning event.
Return 0 for success, or an <code>errno</code> value for failure.
Suggested failure: EACCES for label mismatch, or EPERM for lack of privilege.</p></div></div><div class=sect3><h4 id=mpo-cred-check-vnode-getacl>6.7.4.34. <code>mpo_check_vnode_getacl</code><a class=anchor href=#mpo-cred-check-vnode-getacl></a></h4><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=c><span class=kt>int</span> <span class=nf>mpo_check_vnode_getacl</span><span class=p>(</span><span class=k>struct</span> <span class=n>ucred</span> <span class=o>*</span><span class=n>cred</span><span class=p>,</span> <span class=k>struct</span> <span class=n>vnode</span> <span class=o>*</span><span class=n>vp</span><span class=p>,</span>
    <span class=k>struct</span> <span class=n>label</span> <span class=o>*</span><span class=n>label</span><span class=p>,</span> <span class=n>acl_type_t</span> <span class=n>type</span><span class=p>);</span></code></pre></div></div><table class="tableblock frame-none grid-all stretch informaltable"><col style=width:33.3333%><col style=width:33.3333%><col style=width:33.3334%><thead><tr><th class="tableblock halign-left valign-top">Parameter</th><th class="tableblock halign-left valign-top">Description</th><th class="tableblock halign-left valign-top">Locking</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>cred</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Subject credential</p></td><td class="tableblock halign-left valign-top"></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>vp</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Object; vnode</p></td><td class="tableblock halign-left valign-top"></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>label</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Policy label for <code>vp</code></p></td><td class="tableblock halign-left valign-top"></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>type</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>ACL type</p></td><td class="tableblock halign-left valign-top"></td></tr></tbody></table><div class=paragraph><p>Determine whether the subject credential can retrieve the ACL of passed type from the passed vnode.
Return 0 for success, or an <code>errno</code> value for failure.
Suggested failure: EACCES for label mismatch, or EPERM for lack of privilege.</p></div></div><div class=sect3><h4 id=mac-mpo-cred-check-vnode-getextattr>6.7.4.35. <code>mpo_check_vnode_getextattr</code><a class=anchor href=#mac-mpo-cred-check-vnode-getextattr></a></h4><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=c><span class=kt>int</span> <span class=nf>mpo_check_vnode_getextattr</span><span class=p>(</span><span class=k>struct</span> <span class=n>ucred</span> <span class=o>*</span><span class=n>cred</span><span class=p>,</span> <span class=k>struct</span> <span class=n>vnode</span> <span class=o>*</span><span class=n>vp</span><span class=p>,</span>
    <span class=k>struct</span> <span class=n>label</span> <span class=o>*</span><span class=n>label</span><span class=p>,</span> <span class=kt>int</span> <span class=n>attrnamespace</span><span class=p>,</span> <span class=k>const</span> <span class=kt>char</span> <span class=o>*</span><span class=n>name</span><span class=p>,</span> <span class=k>struct</span> <span class=n>uio</span> <span class=o>*</span><span class=n>uio</span><span class=p>);</span></code></pre></div></div><table class="tableblock frame-none grid-all stretch informaltable"><col style=width:33.3333%><col style=width:33.3333%><col style=width:33.3334%><thead><tr><th class="tableblock halign-left valign-top">Parameter</th><th class="tableblock halign-left valign-top">Description</th><th class="tableblock halign-left valign-top">Locking</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>cred</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Subject credential</p></td><td class="tableblock halign-left valign-top"></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>vp</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Object; vnode</p></td><td class="tableblock halign-left valign-top"></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>label</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Policy label for <code>vp</code></p></td><td class="tableblock halign-left valign-top"></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>attrnamespace</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Extended attribute namespace</p></td><td class="tableblock halign-left valign-top"></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>name</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Extended attribute name</p></td><td class="tableblock halign-left valign-top"></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>uio</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>I/O structure pointer; see <a href="https://man.freebsd.org/cgi/man.cgi?query=uio&amp;sektion=9&amp;format=html">uio(9)</a></p></td><td class="tableblock halign-left valign-top"></td></tr></tbody></table><div class=paragraph><p>Determine whether the subject credential can retrieve the extended attribute with the passed namespace and name from the passed vnode.
Policies implementing labeling using extended attributes may be interested in special handling of operations on those extended attributes.
Return 0 for success, or an <code>errno</code> value for failure.
Suggested failure: EACCES for label mismatch, or EPERM for lack of privilege.</p></div></div><div class=sect3><h4 id=mac-mpo-check-vnode-link>6.7.4.36. <code>mpo_check_vnode_link</code><a class=anchor href=#mac-mpo-check-vnode-link></a></h4><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=c><span class=kt>int</span> <span class=nf>mpo_check_vnode_link</span><span class=p>(</span><span class=k>struct</span> <span class=n>ucred</span> <span class=o>*</span><span class=n>cred</span><span class=p>,</span> <span class=k>struct</span> <span class=n>vnode</span> <span class=o>*</span><span class=n>dvp</span><span class=p>,</span>
    <span class=k>struct</span> <span class=n>label</span> <span class=o>*</span><span class=n>dlabel</span><span class=p>,</span> <span class=k>struct</span> <span class=n>vnode</span> <span class=o>*</span><span class=n>vp</span><span class=p>,</span> <span class=k>struct</span> <span class=n>label</span> <span class=o>*</span><span class=n>label</span><span class=p>,</span>
    <span class=k>struct</span> <span class=n>componentname</span> <span class=o>*</span><span class=n>cnp</span><span class=p>);</span></code></pre></div></div><table class="tableblock frame-none grid-all stretch informaltable"><col style=width:33.3333%><col style=width:33.3333%><col style=width:33.3334%><thead><tr><th class="tableblock halign-left valign-top">Parameter</th><th class="tableblock halign-left valign-top">Description</th><th class="tableblock halign-left valign-top">Locking</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>cred</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Subject credential</p></td><td class="tableblock halign-left valign-top"></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>dvp</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Directory vnode</p></td><td class="tableblock halign-left valign-top"></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>dlabel</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Policy label associated with <code>dvp</code></p></td><td class="tableblock halign-left valign-top"></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>vp</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Link destination vnode</p></td><td class="tableblock halign-left valign-top"></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>label</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Policy label associated with <code>vp</code></p></td><td class="tableblock halign-left valign-top"></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>cnp</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Component name for the link being created</p></td><td class="tableblock halign-left valign-top"></td></tr></tbody></table><div class=paragraph><p>Determine whether the subject should be allowed to create a link to the vnode <code>vp</code> with the name specified by <code>cnp</code>.</p></div></div><div class=sect3><h4 id=mac-mpo-check-vnode-mmap>6.7.4.37. <code>mpo_check_vnode_mmap</code><a class=anchor href=#mac-mpo-check-vnode-mmap></a></h4><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=c><span class=kt>int</span> <span class=nf>mpo_check_vnode_mmap</span><span class=p>(</span><span class=k>struct</span> <span class=n>ucred</span> <span class=o>*</span><span class=n>cred</span><span class=p>,</span> <span class=k>struct</span> <span class=n>vnode</span> <span class=o>*</span><span class=n>vp</span><span class=p>,</span>
    <span class=k>struct</span> <span class=n>label</span> <span class=o>*</span><span class=n>label</span><span class=p>,</span> <span class=kt>int</span> <span class=n>prot</span><span class=p>);</span></code></pre></div></div><table class="tableblock frame-none grid-all stretch informaltable"><col style=width:33.3333%><col style=width:33.3333%><col style=width:33.3334%><thead><tr><th class="tableblock halign-left valign-top">Parameter</th><th class="tableblock halign-left valign-top">Description</th><th class="tableblock halign-left valign-top">Locking</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>cred</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Subject credential</p></td><td class="tableblock halign-left valign-top"></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>vp</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Vnode to map</p></td><td class="tableblock halign-left valign-top"></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>label</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Policy label associated with <code>vp</code></p></td><td class="tableblock halign-left valign-top"></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>prot</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Mmap protections (see <a href="https://man.freebsd.org/cgi/man.cgi?query=mmap&amp;sektion=2&amp;format=html">mmap(2)</a>)</p></td><td class="tableblock halign-left valign-top"></td></tr></tbody></table><div class=paragraph><p>Determine whether the subject should be allowed to map the vnode <code>vp</code> with the protections specified in <code>prot</code>.</p></div></div><div class=sect3><h4 id=mac-mpo-check-vnode-mmap-downgrade>6.7.4.38. <code>mpo_check_vnode_mmap_downgrade</code><a class=anchor href=#mac-mpo-check-vnode-mmap-downgrade></a></h4><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=c><span class=kt>void</span> <span class=nf>mpo_check_vnode_mmap_downgrade</span><span class=p>(</span><span class=k>struct</span> <span class=n>ucred</span> <span class=o>*</span><span class=n>cred</span><span class=p>,</span> <span class=k>struct</span> <span class=n>vnode</span> <span class=o>*</span><span class=n>vp</span><span class=p>,</span>
    <span class=k>struct</span> <span class=n>label</span> <span class=o>*</span><span class=n>label</span><span class=p>,</span> <span class=kt>int</span> <span class=o>*</span><span class=n>prot</span><span class=p>);</span></code></pre></div></div><table class="tableblock frame-none grid-all stretch informaltable"><col style=width:33.3333%><col style=width:33.3333%><col style=width:33.3334%><thead><tr><th class="tableblock halign-left valign-top">Parameter</th><th class="tableblock halign-left valign-top">Description</th><th class="tableblock halign-left valign-top">Locking</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>cred</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>See <a href=../mac/#mac-mpo-check-vnode-mmap><code>mpo_check_vnode_mmap</code></a>.</p></td><td class="tableblock halign-left valign-top"></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>vp</code></p></td><td class="tableblock halign-left valign-top"></td><td class="tableblock halign-left valign-top"></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>label</code></p></td><td class="tableblock halign-left valign-top"></td><td class="tableblock halign-left valign-top"></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>prot</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Mmap protections to be downgraded</p></td><td class="tableblock halign-left valign-top"></td></tr></tbody></table><div class=paragraph><p>Downgrade the mmap protections based on the subject and object labels.</p></div></div><div class=sect3><h4 id=mac-mpo-check-vnode-mprotect>6.7.4.39. <code>mpo_check_vnode_mprotect</code><a class=anchor href=#mac-mpo-check-vnode-mprotect></a></h4><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=c><span class=kt>int</span> <span class=nf>mpo_check_vnode_mprotect</span><span class=p>(</span><span class=k>struct</span> <span class=n>ucred</span> <span class=o>*</span><span class=n>cred</span><span class=p>,</span> <span class=k>struct</span> <span class=n>vnode</span> <span class=o>*</span><span class=n>vp</span><span class=p>,</span>
    <span class=k>struct</span> <span class=n>label</span> <span class=o>*</span><span class=n>label</span><span class=p>,</span> <span class=kt>int</span> <span class=n>prot</span><span class=p>);</span></code></pre></div></div><table class="tableblock frame-none grid-all stretch informaltable"><col style=width:33.3333%><col style=width:33.3333%><col style=width:33.3334%><thead><tr><th class="tableblock halign-left valign-top">Parameter</th><th class="tableblock halign-left valign-top">Description</th><th class="tableblock halign-left valign-top">Locking</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>cred</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Subject credential</p></td><td class="tableblock halign-left valign-top"></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>vp</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Mapped vnode</p></td><td class="tableblock halign-left valign-top"></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>prot</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Memory protections</p></td><td class="tableblock halign-left valign-top"></td></tr></tbody></table><div class=paragraph><p>Determine whether the subject should be allowed to set the specified memory protections on memory mapped from the vnode <code>vp</code>.</p></div></div><div class=sect3><h4 id=mac-mpo-check-vnode-poll>6.7.4.40. <code>mpo_check_vnode_poll</code><a class=anchor href=#mac-mpo-check-vnode-poll></a></h4><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=c><span class=kt>int</span> <span class=nf>mpo_check_vnode_poll</span><span class=p>(</span><span class=k>struct</span> <span class=n>ucred</span> <span class=o>*</span><span class=n>active_cred</span><span class=p>,</span> <span class=k>struct</span> <span class=n>ucred</span> <span class=o>*</span><span class=n>file_cred</span><span class=p>,</span>
    <span class=k>struct</span> <span class=n>vnode</span> <span class=o>*</span><span class=n>vp</span><span class=p>,</span> <span class=k>struct</span> <span class=n>label</span> <span class=o>*</span><span class=n>label</span><span class=p>);</span></code></pre></div></div><table class="tableblock frame-none grid-all stretch informaltable"><col style=width:33.3333%><col style=width:33.3333%><col style=width:33.3334%><thead><tr><th class="tableblock halign-left valign-top">Parameter</th><th class="tableblock halign-left valign-top">Description</th><th class="tableblock halign-left valign-top">Locking</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>active_cred</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Subject credential</p></td><td class="tableblock halign-left valign-top"></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>file_cred</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Credential associated with the struct file</p></td><td class="tableblock halign-left valign-top"></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>vp</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Polled vnode</p></td><td class="tableblock halign-left valign-top"></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>label</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Policy label associated with <code>vp</code></p></td><td class="tableblock halign-left valign-top"></td></tr></tbody></table><div class=paragraph><p>Determine whether the subject should be allowed to poll the vnode <code>vp</code>.</p></div></div><div class=sect3><h4 id=mac-mpo-check-vnode-rename-from>6.7.4.41. <code>mpo_check_vnode_rename_from</code><a class=anchor href=#mac-mpo-check-vnode-rename-from></a></h4><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=c><span class=kt>int</span> <span class=nf>mpo_vnode_rename_from</span><span class=p>(</span><span class=k>struct</span> <span class=n>ucred</span> <span class=o>*</span><span class=n>cred</span><span class=p>,</span> <span class=k>struct</span> <span class=n>vnode</span> <span class=o>*</span><span class=n>dvp</span><span class=p>,</span>
    <span class=k>struct</span> <span class=n>label</span> <span class=o>*</span><span class=n>dlabel</span><span class=p>,</span> <span class=k>struct</span> <span class=n>vnode</span> <span class=o>*</span><span class=n>vp</span><span class=p>,</span> <span class=k>struct</span> <span class=n>label</span> <span class=o>*</span><span class=n>label</span><span class=p>,</span>
    <span class=k>struct</span> <span class=n>componentname</span> <span class=o>*</span><span class=n>cnp</span><span class=p>);</span></code></pre></div></div><table class="tableblock frame-none grid-all stretch informaltable"><col style=width:33.3333%><col style=width:33.3333%><col style=width:33.3334%><thead><tr><th class="tableblock halign-left valign-top">Parameter</th><th class="tableblock halign-left valign-top">Description</th><th class="tableblock halign-left valign-top">Locking</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>cred</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Subject credential</p></td><td class="tableblock halign-left valign-top"></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>dvp</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Directory vnode</p></td><td class="tableblock halign-left valign-top"></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>dlabel</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Policy label associated with <code>dvp</code></p></td><td class="tableblock halign-left valign-top"></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>vp</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Vnode to be renamed</p></td><td class="tableblock halign-left valign-top"></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>label</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Policy label associated with <code>vp</code></p></td><td class="tableblock halign-left valign-top"></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>cnp</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Component name for <code>vp</code></p></td><td class="tableblock halign-left valign-top"></td></tr></tbody></table><div class=paragraph><p>Determine whether the subject should be allowed to rename the vnode <code>vp</code> to something else.</p></div></div><div class=sect3><h4 id=mac-mpo-check-vnode-rename-to>6.7.4.42. <code>mpo_check_vnode_rename_to</code><a class=anchor href=#mac-mpo-check-vnode-rename-to></a></h4><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=c><span class=kt>int</span> <span class=nf>mpo_check_vnode_rename_to</span><span class=p>(</span><span class=k>struct</span> <span class=n>ucred</span> <span class=o>*</span><span class=n>cred</span><span class=p>,</span> <span class=k>struct</span> <span class=n>vnode</span> <span class=o>*</span><span class=n>dvp</span><span class=p>,</span>
    <span class=k>struct</span> <span class=n>label</span> <span class=o>*</span><span class=n>dlabel</span><span class=p>,</span> <span class=k>struct</span> <span class=n>vnode</span> <span class=o>*</span><span class=n>vp</span><span class=p>,</span> <span class=k>struct</span> <span class=n>label</span> <span class=o>*</span><span class=n>label</span><span class=p>,</span> <span class=kt>int</span> <span class=n>samedir</span><span class=p>,</span>
    <span class=k>struct</span> <span class=n>componentname</span> <span class=o>*</span><span class=n>cnp</span><span class=p>);</span></code></pre></div></div><table class="tableblock frame-none grid-all stretch informaltable"><col style=width:33.3333%><col style=width:33.3333%><col style=width:33.3334%><thead><tr><th class="tableblock halign-left valign-top">Parameter</th><th class="tableblock halign-left valign-top">Description</th><th class="tableblock halign-left valign-top">Locking</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>cred</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Subject credential</p></td><td class="tableblock halign-left valign-top"></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>dvp</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Directory vnode</p></td><td class="tableblock halign-left valign-top"></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>dlabel</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Policy label associated with <code>dvp</code></p></td><td class="tableblock halign-left valign-top"></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>vp</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Overwritten vnode</p></td><td class="tableblock halign-left valign-top"></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>label</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Policy label associated with <code>vp</code></p></td><td class="tableblock halign-left valign-top"></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>samedir</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Boolean; <code>1</code> if the source and destination directories are the same</p></td><td class="tableblock halign-left valign-top"></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>cnp</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Destination component name</p></td><td class="tableblock halign-left valign-top"></td></tr></tbody></table><div class=paragraph><p>Determine whether the subject should be allowed to rename to the vnode <code>vp</code>, into the directory <code>dvp</code>, or to the name represented by <code>cnp</code>.
If there is no existing file to overwrite, <code>vp</code> and <code>label</code> will be NULL.</p></div></div><div class=sect3><h4 id=mac-mpo-cred-check-socket-listen>6.7.4.43. <code>mpo_check_socket_listen</code><a class=anchor href=#mac-mpo-cred-check-socket-listen></a></h4><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=c><span class=kt>int</span> <span class=nf>mpo_check_socket_listen</span><span class=p>(</span><span class=k>struct</span> <span class=n>ucred</span> <span class=o>*</span><span class=n>cred</span><span class=p>,</span> <span class=k>struct</span> <span class=n>socket</span> <span class=o>*</span><span class=n>socket</span><span class=p>,</span>
    <span class=k>struct</span> <span class=n>label</span> <span class=o>*</span><span class=n>socketlabel</span><span class=p>);</span></code></pre></div></div><table class="tableblock frame-none grid-all stretch informaltable"><col style=width:33.3333%><col style=width:33.3333%><col style=width:33.3334%><thead><tr><th class="tableblock halign-left valign-top">Parameter</th><th class="tableblock halign-left valign-top">Description</th><th class="tableblock halign-left valign-top">Locking</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>cred</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Subject credential</p></td><td class="tableblock halign-left valign-top"></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>socket</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Object; socket</p></td><td class="tableblock halign-left valign-top"></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>socketlabel</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Policy label for <code>socket</code></p></td><td class="tableblock halign-left valign-top"></td></tr></tbody></table><div class=paragraph><p>Determine whether the subject credential can listen on the passed socket.
Return 0 for success, or an <code>errno</code> value for failure.
Suggested failure: EACCES for label mismatch, or EPERM for lack of privilege.</p></div></div><div class=sect3><h4 id=mac-mpo-cred-check-vnode-lookup>6.7.4.44. <code>mpo_check_vnode_lookup</code><a class=anchor href=#mac-mpo-cred-check-vnode-lookup></a></h4><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=c><span class=kt>int</span> <span class=nf>mpo_check_vnode_lookup</span><span class=p>(</span><span class=k>struct</span> <span class=n>ucred</span> <span class=o>*</span><span class=n>cred</span><span class=p>,</span> <span class=k>struct</span> <span class=n>vnode</span> <span class=o>*</span><span class=n>dvp</span><span class=p>,</span>
    <span class=k>struct</span> <span class=n>label</span> <span class=o>*</span><span class=n>dlabel</span><span class=p>,</span> <span class=k>struct</span> <span class=n>componentname</span> <span class=o>*</span><span class=n>cnp</span><span class=p>);</span></code></pre></div></div><table class="tableblock frame-none grid-all stretch informaltable"><col style=width:33.3333%><col style=width:33.3333%><col style=width:33.3334%><thead><tr><th class="tableblock halign-left valign-top">Parameter</th><th class="tableblock halign-left valign-top">Description</th><th class="tableblock halign-left valign-top">Locking</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>cred</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Subject credential</p></td><td class="tableblock halign-left valign-top"></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>dvp</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Object; vnode</p></td><td class="tableblock halign-left valign-top"></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>dlabel</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Policy label for <code>dvp</code></p></td><td class="tableblock halign-left valign-top"></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>cnp</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Component name being looked up</p></td><td class="tableblock halign-left valign-top"></td></tr></tbody></table><div class=paragraph><p>Determine whether the subject credential can perform a lookup in the passed directory vnode for the passed name.
Return 0 for success, or an <code>errno</code> value for failure.
Suggested failure: EACCES for label mismatch, or EPERM for lack of privilege.</p></div></div><div class=sect3><h4 id=mac-mpo-cred-check-vnode-open>6.7.4.45. <code>mpo_check_vnode_open</code><a class=anchor href=#mac-mpo-cred-check-vnode-open></a></h4><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=c><span class=kt>int</span> <span class=nf>mpo_check_vnode_open</span><span class=p>(</span><span class=k>struct</span> <span class=n>ucred</span> <span class=o>*</span><span class=n>cred</span><span class=p>,</span> <span class=k>struct</span> <span class=n>vnode</span> <span class=o>*</span><span class=n>vp</span><span class=p>,</span>
    <span class=k>struct</span> <span class=n>label</span> <span class=o>*</span><span class=n>label</span><span class=p>,</span> <span class=kt>int</span> <span class=n>acc_mode</span><span class=p>);</span></code></pre></div></div><table class="tableblock frame-none grid-all stretch informaltable"><col style=width:33.3333%><col style=width:33.3333%><col style=width:33.3334%><thead><tr><th class="tableblock halign-left valign-top">Parameter</th><th class="tableblock halign-left valign-top">Description</th><th class="tableblock halign-left valign-top">Locking</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>cred</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Subject credential</p></td><td class="tableblock halign-left valign-top"></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>vp</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Object; vnode</p></td><td class="tableblock halign-left valign-top"></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>label</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Policy label for <code>vp</code></p></td><td class="tableblock halign-left valign-top"></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>acc_mode</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock><a href="https://man.freebsd.org/cgi/man.cgi?query=open&amp;sektion=2&amp;format=html">open(2)</a> access mode</p></td><td class="tableblock halign-left valign-top"></td></tr></tbody></table><div class=paragraph><p>Determine whether the subject credential can perform an open operation on the passed vnode with the passed access mode.
Return 0 for success, or an errno value for failure.
Suggested failure: EACCES for label mismatch, or EPERM for lack of privilege.</p></div></div><div class=sect3><h4 id=mac-mpo-cred-check-vnode-readdir>6.7.4.46. <code>mpo_check_vnode_readdir</code><a class=anchor href=#mac-mpo-cred-check-vnode-readdir></a></h4><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=c><span class=kt>int</span> <span class=nf>mpo_check_vnode_readdir</span><span class=p>(</span><span class=k>struct</span> <span class=n>ucred</span> <span class=o>*</span><span class=n>cred</span><span class=p>,</span> <span class=k>struct</span> <span class=n>vnode</span> <span class=o>*</span><span class=n>dvp</span><span class=p>,</span>
    <span class=k>struct</span> <span class=n>label</span> <span class=o>*</span><span class=n>dlabel</span><span class=p>);</span></code></pre></div></div><table class="tableblock frame-none grid-all stretch informaltable"><col style=width:33.3333%><col style=width:33.3333%><col style=width:33.3334%><thead><tr><th class="tableblock halign-left valign-top">Parameter</th><th class="tableblock halign-left valign-top">Description</th><th class="tableblock halign-left valign-top">Locking</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>cred</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Subject credential</p></td><td class="tableblock halign-left valign-top"></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>dvp</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Object; directory vnode</p></td><td class="tableblock halign-left valign-top"></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>dlabel</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Policy label for <code>dvp</code></p></td><td class="tableblock halign-left valign-top"></td></tr></tbody></table><div class=paragraph><p>Determine whether the subject credential can perform a <code>readdir</code> operation on the passed directory vnode.
Return 0 for success, or an <code>errno</code> value for failure.
Suggested failure: EACCES for label mismatch, or EPERM for lack of privilege.</p></div></div><div class=sect3><h4 id=mac-mpo-cred-check-vnode-readlink>6.7.4.47. <code>mpo_check_vnode_readlink</code><a class=anchor href=#mac-mpo-cred-check-vnode-readlink></a></h4><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=c><span class=kt>int</span> <span class=nf>mpo_check_vnode_readlink</span><span class=p>(</span><span class=k>struct</span> <span class=n>ucred</span> <span class=o>*</span><span class=n>cred</span><span class=p>,</span> <span class=k>struct</span> <span class=n>vnode</span> <span class=o>*</span><span class=n>vp</span><span class=p>,</span>
    <span class=k>struct</span> <span class=n>label</span> <span class=o>*</span><span class=n>label</span><span class=p>);</span></code></pre></div></div><table class="tableblock frame-none grid-all stretch informaltable"><col style=width:33.3333%><col style=width:33.3333%><col style=width:33.3334%><thead><tr><th class="tableblock halign-left valign-top">Parameter</th><th class="tableblock halign-left valign-top">Description</th><th class="tableblock halign-left valign-top">Locking</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>cred</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Subject credential</p></td><td class="tableblock halign-left valign-top"></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>vp</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Object; vnode</p></td><td class="tableblock halign-left valign-top"></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>label</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Policy label for <code>vp</code></p></td><td class="tableblock halign-left valign-top"></td></tr></tbody></table><div class=paragraph><p>Determine whether the subject credential can perform a <code>readlink</code> operation on the passed symlink vnode.
Return 0 for success, or an <code>errno</code> value for failure.
Suggested failure: EACCES for label mismatch, or EPERM for lack of privilege.
This call may be made in a number of situations, including an explicit <code>readlink</code> call by the user process, or as a result of an implicit <code>readlink</code> during a name lookup by the process.</p></div></div><div class=sect3><h4 id=mac-mpo-cred-check-vnode-revoke>6.7.4.48. <code>mpo_check_vnode_revoke</code><a class=anchor href=#mac-mpo-cred-check-vnode-revoke></a></h4><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=c><span class=kt>int</span> <span class=nf>mpo_check_vnode_revoke</span><span class=p>(</span><span class=k>struct</span> <span class=n>ucred</span> <span class=o>*</span><span class=n>cred</span><span class=p>,</span> <span class=k>struct</span> <span class=n>vnode</span> <span class=o>*</span><span class=n>vp</span><span class=p>,</span>
    <span class=k>struct</span> <span class=n>label</span> <span class=o>*</span><span class=n>label</span><span class=p>);</span></code></pre></div></div><table class="tableblock frame-none grid-all stretch informaltable"><col style=width:33.3333%><col style=width:33.3333%><col style=width:33.3334%><thead><tr><th class="tableblock halign-left valign-top">Parameter</th><th class="tableblock halign-left valign-top">Description</th><th class="tableblock halign-left valign-top">Locking</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>cred</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Subject credential</p></td><td class="tableblock halign-left valign-top"></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>vp</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Object; vnode</p></td><td class="tableblock halign-left valign-top"></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>label</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Policy label for <code>vp</code></p></td><td class="tableblock halign-left valign-top"></td></tr></tbody></table><div class=paragraph><p>Determine whether the subject credential can revoke access to the passed vnode.
Return 0 for success, or an <code>errno</code> value for failure.
Suggested failure: EACCES for label mismatch, or EPERM for lack of privilege.</p></div></div><div class=sect3><h4 id=mac-mpo-cred-check-vnode-setacl>6.7.4.49. <code>mpo_check_vnode_setacl</code><a class=anchor href=#mac-mpo-cred-check-vnode-setacl></a></h4><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=c><span class=kt>int</span> <span class=nf>mpo_check_vnode_setacl</span><span class=p>(</span><span class=k>struct</span> <span class=n>ucred</span> <span class=o>*</span><span class=n>cred</span><span class=p>,</span> <span class=k>struct</span> <span class=n>vnode</span> <span class=o>*</span><span class=n>vp</span><span class=p>,</span>
    <span class=k>struct</span> <span class=n>label</span> <span class=o>*</span><span class=n>label</span><span class=p>,</span> <span class=n>acl_type_t</span> <span class=n>type</span><span class=p>,</span> <span class=k>struct</span> <span class=n>acl</span> <span class=o>*</span><span class=n>acl</span><span class=p>);</span></code></pre></div></div><table class="tableblock frame-none grid-all stretch informaltable"><col style=width:33.3333%><col style=width:33.3333%><col style=width:33.3334%><thead><tr><th class="tableblock halign-left valign-top">Parameter</th><th class="tableblock halign-left valign-top">Description</th><th class="tableblock halign-left valign-top">Locking</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>cred</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Subject credential</p></td><td class="tableblock halign-left valign-top"></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>vp</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Object; vnode</p></td><td class="tableblock halign-left valign-top"></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>label</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Policy label for <code>vp</code></p></td><td class="tableblock halign-left valign-top"></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>type</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>ACL type</p></td><td class="tableblock halign-left valign-top"></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>acl</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>ACL</p></td><td class="tableblock halign-left valign-top"></td></tr></tbody></table><div class=paragraph><p>Determine whether the subject credential can set the passed ACL of passed type on the passed vnode.
Return 0 for success, or an <code>errno</code> value for failure.
Suggested failure: EACCES for label mismatch, or EPERM for lack of privilege.</p></div></div><div class=sect3><h4 id=mac-mpo-cred-check-vnode-setextattr>6.7.4.50. <code>mpo_check_vnode_setextattr</code><a class=anchor href=#mac-mpo-cred-check-vnode-setextattr></a></h4><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=c><span class=kt>int</span> <span class=nf>mpo_check_vnode_setextattr</span><span class=p>(</span><span class=k>struct</span> <span class=n>ucred</span> <span class=o>*</span><span class=n>cred</span><span class=p>,</span> <span class=k>struct</span> <span class=n>vnode</span> <span class=o>*</span><span class=n>vp</span><span class=p>,</span>
    <span class=k>struct</span> <span class=n>label</span> <span class=o>*</span><span class=n>label</span><span class=p>,</span> <span class=kt>int</span> <span class=n>attrnamespace</span><span class=p>,</span> <span class=k>const</span> <span class=kt>char</span> <span class=o>*</span><span class=n>name</span><span class=p>,</span> <span class=k>struct</span> <span class=n>uio</span> <span class=o>*</span><span class=n>uio</span><span class=p>);</span></code></pre></div></div><table class="tableblock frame-none grid-all stretch informaltable"><col style=width:33.3333%><col style=width:33.3333%><col style=width:33.3334%><thead><tr><th class="tableblock halign-left valign-top">Parameter</th><th class="tableblock halign-left valign-top">Description</th><th class="tableblock halign-left valign-top">Locking</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>cred</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Subject credential</p></td><td class="tableblock halign-left valign-top"></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>vp</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Object; vnode</p></td><td class="tableblock halign-left valign-top"></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>label</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Policy label for <code>vp</code></p></td><td class="tableblock halign-left valign-top"></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>attrnamespace</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Extended attribute namespace</p></td><td class="tableblock halign-left valign-top"></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>name</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Extended attribute name</p></td><td class="tableblock halign-left valign-top"></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>uio</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>I/O structure pointer; see <a href="https://man.freebsd.org/cgi/man.cgi?query=uio&amp;sektion=9&amp;format=html">uio(9)</a></p></td><td class="tableblock halign-left valign-top"></td></tr></tbody></table><div class=paragraph><p>Determine whether the subject credential can set the extended attribute of passed name and passed namespace on the passed vnode.
Policies implementing security labels backed into extended attributes may want to provide additional protections for those attributes.
Additionally, policies should avoid making decisions based on the data referenced from <code>uio</code>, as there is a potential race condition between this check and the actual operation.
The <code>uio</code> may also be <code>NULL</code> if a delete operation is being performed.
Return 0 for success, or an <code>errno</code> value for failure.
Suggested failure: EACCES for label mismatch, or EPERM for lack of privilege.</p></div></div><div class=sect3><h4 id=mac-mpo-cred-check-vnode-setflags>6.7.4.51. <code>mpo_check_vnode_setflags</code><a class=anchor href=#mac-mpo-cred-check-vnode-setflags></a></h4><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=c><span class=kt>int</span> <span class=nf>mpo_check_vnode_setflags</span><span class=p>(</span><span class=k>struct</span> <span class=n>ucred</span> <span class=o>*</span><span class=n>cred</span><span class=p>,</span> <span class=k>struct</span> <span class=n>vnode</span> <span class=o>*</span><span class=n>vp</span><span class=p>,</span>
    <span class=k>struct</span> <span class=n>label</span> <span class=o>*</span><span class=n>label</span><span class=p>,</span> <span class=n>u_long</span> <span class=n>flags</span><span class=p>);</span></code></pre></div></div><table class="tableblock frame-none grid-all stretch informaltable"><col style=width:33.3333%><col style=width:33.3333%><col style=width:33.3334%><thead><tr><th class="tableblock halign-left valign-top">Parameter</th><th class="tableblock halign-left valign-top">Description</th><th class="tableblock halign-left valign-top">Locking</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>cred</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Subject credential</p></td><td class="tableblock halign-left valign-top"></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>vp</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Object; vnode</p></td><td class="tableblock halign-left valign-top"></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>label</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Policy label for <code>vp</code></p></td><td class="tableblock halign-left valign-top"></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>flags</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>File flags; see <a href="https://man.freebsd.org/cgi/man.cgi?query=chflags&amp;sektion=2&amp;format=html">chflags(2)</a></p></td><td class="tableblock halign-left valign-top"></td></tr></tbody></table><div class=paragraph><p>Determine whether the subject credential can set the passed flags on the passed vnode.
Return 0 for success, or an <code>errno</code> value for failure.
Suggested failure: EACCES for label mismatch, or EPERM for lack of privilege.</p></div></div><div class=sect3><h4 id=mac-mpo-cred-check-vnode-setmode>6.7.4.52. <code>mpo_check_vnode_setmode</code><a class=anchor href=#mac-mpo-cred-check-vnode-setmode></a></h4><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=c><span class=kt>int</span> <span class=nf>mpo_check_vnode_setmode</span><span class=p>(</span><span class=k>struct</span> <span class=n>ucred</span> <span class=o>*</span><span class=n>cred</span><span class=p>,</span> <span class=k>struct</span> <span class=n>vnode</span> <span class=o>*</span><span class=n>vp</span><span class=p>,</span>
    <span class=k>struct</span> <span class=n>label</span> <span class=o>*</span><span class=n>label</span><span class=p>,</span> <span class=n>mode_t</span> <span class=n>mode</span><span class=p>);</span></code></pre></div></div><table class="tableblock frame-none grid-all stretch informaltable"><col style=width:33.3333%><col style=width:33.3333%><col style=width:33.3334%><thead><tr><th class="tableblock halign-left valign-top">Parameter</th><th class="tableblock halign-left valign-top">Description</th><th class="tableblock halign-left valign-top">Locking</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>cred</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Subject credential</p></td><td class="tableblock halign-left valign-top"></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>vp</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Object; vnode</p></td><td class="tableblock halign-left valign-top"></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>label</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Policy label for <code>vp</code></p></td><td class="tableblock halign-left valign-top"></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>mode</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>File mode; see <a href="https://man.freebsd.org/cgi/man.cgi?query=chmod&amp;sektion=2&amp;format=html">chmod(2)</a></p></td><td class="tableblock halign-left valign-top"></td></tr></tbody></table><div class=paragraph><p>Determine whether the subject credential can set the passed mode on the passed vnode.
Return 0 for success, or an <code>errno</code> value for failure.
Suggested failure: EACCES for label mismatch, or EPERM for lack of privilege.</p></div></div><div class=sect3><h4 id=mac-mpo-cred-check-vnode-setowner>6.7.4.53. <code>mpo_check_vnode_setowner</code><a class=anchor href=#mac-mpo-cred-check-vnode-setowner></a></h4><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=c><span class=kt>int</span> <span class=nf>mpo_check_vnode_setowner</span><span class=p>(</span><span class=k>struct</span> <span class=n>ucred</span> <span class=o>*</span><span class=n>cred</span><span class=p>,</span> <span class=k>struct</span> <span class=n>vnode</span> <span class=o>*</span><span class=n>vp</span><span class=p>,</span>
    <span class=k>struct</span> <span class=n>label</span> <span class=o>*</span><span class=n>label</span><span class=p>,</span> <span class=n>uid_t</span> <span class=n>uid</span><span class=p>,</span> <span class=n>gid_t</span> <span class=n>gid</span><span class=p>);</span></code></pre></div></div><table class="tableblock frame-none grid-all stretch informaltable"><col style=width:33.3333%><col style=width:33.3333%><col style=width:33.3334%><thead><tr><th class="tableblock halign-left valign-top">Parameter</th><th class="tableblock halign-left valign-top">Description</th><th class="tableblock halign-left valign-top">Locking</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>cred</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Subject credential</p></td><td class="tableblock halign-left valign-top"></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>vp</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Object; vnode</p></td><td class="tableblock halign-left valign-top"></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>label</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Policy label for <code>vp</code></p></td><td class="tableblock halign-left valign-top"></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>uid</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>User ID</p></td><td class="tableblock halign-left valign-top"></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>gid</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Group ID</p></td><td class="tableblock halign-left valign-top"></td></tr></tbody></table><div class=paragraph><p>Determine whether the subject credential can set the passed uid and passed gid as file uid and file gid on the passed vnode.
The IDs may be set to (<code>-1</code>) to request no update.
Return 0 for success, or an <code>errno</code> value for failure.
Suggested failure: EACCES for label mismatch, or EPERM for lack of privilege.</p></div></div><div class=sect3><h4 id=mac-mpo-cred-check-vnode-setutimes>6.7.4.54. <code>mpo_check_vnode_setutimes</code><a class=anchor href=#mac-mpo-cred-check-vnode-setutimes></a></h4><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=c><span class=kt>int</span> <span class=nf>mpo_check_vnode_setutimes</span><span class=p>(</span><span class=k>struct</span> <span class=n>ucred</span> <span class=o>*</span><span class=n>cred</span><span class=p>,</span> <span class=k>struct</span> <span class=n>vnode</span> <span class=o>*</span><span class=n>vp</span><span class=p>,</span>
    <span class=k>struct</span> <span class=n>label</span> <span class=o>*</span><span class=n>label</span><span class=p>,</span> <span class=k>struct</span> <span class=n>timespec</span> <span class=n>atime</span><span class=p>,</span> <span class=k>struct</span> <span class=n>timespec</span> <span class=n>mtime</span><span class=p>);</span></code></pre></div></div><table class="tableblock frame-none grid-all stretch informaltable"><col style=width:33.3333%><col style=width:33.3333%><col style=width:33.3334%><thead><tr><th class="tableblock halign-left valign-top">Parameter</th><th class="tableblock halign-left valign-top">Description</th><th class="tableblock halign-left valign-top">Locking</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>cred</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Subject credential</p></td><td class="tableblock halign-left valign-top"></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>vp</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Object; vp</p></td><td class="tableblock halign-left valign-top"></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>label</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Policy label for <code>vp</code></p></td><td class="tableblock halign-left valign-top"></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>atime</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Access time; see <a href="https://man.freebsd.org/cgi/man.cgi?query=utimes&amp;sektion=2&amp;format=html">utimes(2)</a></p></td><td class="tableblock halign-left valign-top"></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>mtime</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Modification time; see <a href="https://man.freebsd.org/cgi/man.cgi?query=utimes&amp;sektion=2&amp;format=html">utimes(2)</a></p></td><td class="tableblock halign-left valign-top"></td></tr></tbody></table><div class=paragraph><p>Determine whether the subject credential can set the passed access timestamps on the passed vnode.
Return 0 for success, or an <code>errno</code> value for failure.
Suggested failure: EACCES for label mismatch, or EPERM for lack of privilege.</p></div></div><div class=sect3><h4 id=mac-mpo-cred-check-proc-sched>6.7.4.55. <code>mpo_check_proc_sched</code><a class=anchor href=#mac-mpo-cred-check-proc-sched></a></h4><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=c><span class=kt>int</span> <span class=nf>mpo_check_proc_sched</span><span class=p>(</span><span class=k>struct</span> <span class=n>ucred</span> <span class=o>*</span><span class=n>ucred</span><span class=p>,</span> <span class=k>struct</span> <span class=n>proc</span> <span class=o>*</span><span class=n>proc</span><span class=p>);</span></code></pre></div></div><table class="tableblock frame-none grid-all stretch informaltable"><col style=width:33.3333%><col style=width:33.3333%><col style=width:33.3334%><thead><tr><th class="tableblock halign-left valign-top">Parameter</th><th class="tableblock halign-left valign-top">Description</th><th class="tableblock halign-left valign-top">Locking</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>cred</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Subject credential</p></td><td class="tableblock halign-left valign-top"></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>proc</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Object; process</p></td><td class="tableblock halign-left valign-top"></td></tr></tbody></table><div class=paragraph><p>Determine whether the subject credential can change the scheduling parameters of the passed process.
Return 0 for success, or an <code>errno</code> value for failure.
Suggested failure: EACCES for label mismatch, EPERM for lack of privilege, or ESRCH to limit visibility.</p></div><div class=paragraph><p>See <a href="https://man.freebsd.org/cgi/man.cgi?query=setpriority&amp;sektion=2&amp;format=html">setpriority(2)</a> for more information.</p></div></div><div class=sect3><h4 id=mac-mpo-cred-check-proc-signal>6.7.4.56. <code>mpo_check_proc_signal</code><a class=anchor href=#mac-mpo-cred-check-proc-signal></a></h4><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=c><span class=kt>int</span> <span class=nf>mpo_check_proc_signal</span><span class=p>(</span><span class=k>struct</span> <span class=n>ucred</span> <span class=o>*</span><span class=n>cred</span><span class=p>,</span> <span class=k>struct</span> <span class=n>proc</span> <span class=o>*</span><span class=n>proc</span><span class=p>,</span> <span class=kt>int</span> <span class=n>signal</span><span class=p>);</span></code></pre></div></div><table class="tableblock frame-none grid-all stretch informaltable"><col style=width:33.3333%><col style=width:33.3333%><col style=width:33.3334%><thead><tr><th class="tableblock halign-left valign-top">Parameter</th><th class="tableblock halign-left valign-top">Description</th><th class="tableblock halign-left valign-top">Locking</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>cred</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Subject credential</p></td><td class="tableblock halign-left valign-top"></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>proc</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Object; process</p></td><td class="tableblock halign-left valign-top"></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>signal</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Signal; see <a href="https://man.freebsd.org/cgi/man.cgi?query=kill&amp;sektion=2&amp;format=html">kill(2)</a></p></td><td class="tableblock halign-left valign-top"></td></tr></tbody></table><div class=paragraph><p>Determine whether the subject credential can deliver the passed signal to the passed process.
Return 0 for success, or an <code>errno</code> value for failure.
Suggested failure: EACCES for label mismatch, EPERM for lack of privilege, or ESRCH to limit visibility.</p></div></div><div class=sect3><h4 id=mac-mpo-cred-check-vnode-stat>6.7.4.57. <code>mpo_check_vnode_stat</code><a class=anchor href=#mac-mpo-cred-check-vnode-stat></a></h4><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=c><span class=kt>int</span> <span class=nf>mpo_check_vnode_stat</span><span class=p>(</span><span class=k>struct</span> <span class=n>ucred</span> <span class=o>*</span><span class=n>cred</span><span class=p>,</span> <span class=k>struct</span> <span class=n>vnode</span> <span class=o>*</span><span class=n>vp</span><span class=p>,</span>
    <span class=k>struct</span> <span class=n>label</span> <span class=o>*</span><span class=n>label</span><span class=p>);</span></code></pre></div></div><table class="tableblock frame-none grid-all stretch informaltable"><col style=width:33.3333%><col style=width:33.3333%><col style=width:33.3334%><thead><tr><th class="tableblock halign-left valign-top">Parameter</th><th class="tableblock halign-left valign-top">Description</th><th class="tableblock halign-left valign-top">Locking</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>cred</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Subject credential</p></td><td class="tableblock halign-left valign-top"></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>vp</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Object; vnode</p></td><td class="tableblock halign-left valign-top"></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>label</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Policy label for <code>vp</code></p></td><td class="tableblock halign-left valign-top"></td></tr></tbody></table><div class=paragraph><p>Determine whether the subject credential can <code>stat</code> the passed vnode.
Return 0 for success, or an <code>errno</code> value for failure.
Suggested failure: EACCES for label mismatch, or EPERM for lack of privilege.</p></div><div class=paragraph><p>See <a href="https://man.freebsd.org/cgi/man.cgi?query=stat&amp;sektion=2&amp;format=html">stat(2)</a> for more information.</p></div></div><div class=sect3><h4 id=mac-mpo-cred-check-ifnet-transmit>6.7.4.58. <code>mpo_check_ifnet_transmit</code><a class=anchor href=#mac-mpo-cred-check-ifnet-transmit></a></h4><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=c><span class=kt>int</span> <span class=nf>mpo_check_ifnet_transmit</span><span class=p>(</span><span class=k>struct</span> <span class=n>ucred</span> <span class=o>*</span><span class=n>cred</span><span class=p>,</span> <span class=k>struct</span> <span class=n>ifnet</span> <span class=o>*</span><span class=n>ifnet</span><span class=p>,</span>
    <span class=k>struct</span> <span class=n>label</span> <span class=o>*</span><span class=n>ifnetlabel</span><span class=p>,</span> <span class=k>struct</span> <span class=n>mbuf</span> <span class=o>*</span><span class=n>mbuf</span><span class=p>,</span> <span class=k>struct</span> <span class=n>label</span> <span class=o>*</span><span class=n>mbuflabel</span><span class=p>);</span></code></pre></div></div><table class="tableblock frame-none grid-all stretch informaltable"><col style=width:33.3333%><col style=width:33.3333%><col style=width:33.3334%><thead><tr><th class="tableblock halign-left valign-top">Parameter</th><th class="tableblock halign-left valign-top">Description</th><th class="tableblock halign-left valign-top">Locking</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>cred</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Subject credential</p></td><td class="tableblock halign-left valign-top"></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>ifnet</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Network interface</p></td><td class="tableblock halign-left valign-top"></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>ifnetlabel</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Policy label for <code>ifnet</code></p></td><td class="tableblock halign-left valign-top"></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>mbuf</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Object; mbuf to be sent</p></td><td class="tableblock halign-left valign-top"></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>mbuflabel</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Policy label for <code>mbuf</code></p></td><td class="tableblock halign-left valign-top"></td></tr></tbody></table><div class=paragraph><p>Determine whether the network interface can transmit the passed mbuf.
Return 0 for success, or an <code>errno</code> value for failure.
Suggested failure: EACCES for label mismatch, or EPERM for lack of privilege.</p></div></div><div class=sect3><h4 id=mac-mpo-cred-check-socket-deliver>6.7.4.59. <code>mpo_check_socket_deliver</code><a class=anchor href=#mac-mpo-cred-check-socket-deliver></a></h4><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=c><span class=kt>int</span> <span class=nf>mpo_check_socket_deliver</span><span class=p>(</span><span class=k>struct</span> <span class=n>ucred</span> <span class=o>*</span><span class=n>cred</span><span class=p>,</span> <span class=k>struct</span> <span class=n>ifnet</span> <span class=o>*</span><span class=n>ifnet</span><span class=p>,</span>
    <span class=k>struct</span> <span class=n>label</span> <span class=o>*</span><span class=n>ifnetlabel</span><span class=p>,</span> <span class=k>struct</span> <span class=n>mbuf</span> <span class=o>*</span><span class=n>mbuf</span><span class=p>,</span> <span class=k>struct</span> <span class=n>label</span> <span class=o>*</span><span class=n>mbuflabel</span><span class=p>);</span></code></pre></div></div><table class="tableblock frame-none grid-all stretch informaltable"><col style=width:33.3333%><col style=width:33.3333%><col style=width:33.3334%><thead><tr><th class="tableblock halign-left valign-top">Parameter</th><th class="tableblock halign-left valign-top">Description</th><th class="tableblock halign-left valign-top">Locking</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>cred</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Subject credential</p></td><td class="tableblock halign-left valign-top"></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>ifnet</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Network interface</p></td><td class="tableblock halign-left valign-top"></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>ifnetlabel</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Policy label for <code>ifnet</code></p></td><td class="tableblock halign-left valign-top"></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>mbuf</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Object; mbuf to be delivered</p></td><td class="tableblock halign-left valign-top"></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>mbuflabel</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Policy label for <code>mbuf</code></p></td><td class="tableblock halign-left valign-top"></td></tr></tbody></table><div class=paragraph><p>Determine whether the socket may receive the datagram stored in the passed mbuf header.
Return 0 for success, or an <code>errno</code> value for failure.
Suggested failures: EACCES for label mismatch, or EPERM for lack of privilege.</p></div></div><div class=sect3><h4 id=mac-mpo-check-socket-visible>6.7.4.60. <code>mpo_check_socket_visible</code><a class=anchor href=#mac-mpo-check-socket-visible></a></h4><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=c><span class=kt>int</span> <span class=nf>mpo_check_socket_visible</span><span class=p>(</span><span class=k>struct</span> <span class=n>ucred</span> <span class=o>*</span><span class=n>cred</span><span class=p>,</span> <span class=k>struct</span> <span class=n>socket</span> <span class=o>*</span><span class=n>so</span><span class=p>,</span>
    <span class=k>struct</span> <span class=n>label</span> <span class=o>*</span><span class=n>socketlabel</span><span class=p>);</span></code></pre></div></div><table class="tableblock frame-none grid-all stretch informaltable"><col style=width:33.3333%><col style=width:33.3333%><col style=width:33.3334%><thead><tr><th class="tableblock halign-left valign-top">Parameter</th><th class="tableblock halign-left valign-top">Description</th><th class="tableblock halign-left valign-top">Locking</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>cred</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Subject credential</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Immutable</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>so</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Object; socket</p></td><td class="tableblock halign-left valign-top"></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>socketlabel</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Policy label for <code>so</code></p></td><td class="tableblock halign-left valign-top"></td></tr></tbody></table><div class=paragraph><p>Determine whether the subject credential cred can "see" the passed socket (<code>socket</code>) using system monitoring functions, such as those employed by <a href="https://man.freebsd.org/cgi/man.cgi?query=netstat&amp;sektion=8&amp;format=html">netstat(8)</a> and <a href="https://man.freebsd.org/cgi/man.cgi?query=sockstat&amp;sektion=1&amp;format=html">sockstat(1)</a>.
Return 0 for success, or an <code>errno</code> value for failure.
Suggested failure: EACCES for label mismatches, EPERM for lack of privilege, or ESRCH to hide visibility.</p></div></div><div class=sect3><h4 id=mac-mpo-check-system-acct>6.7.4.61. <code>mpo_check_system_acct</code><a class=anchor href=#mac-mpo-check-system-acct></a></h4><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=c><span class=kt>int</span> <span class=nf>mpo_check_system_acct</span><span class=p>(</span><span class=k>struct</span> <span class=n>ucred</span> <span class=o>*</span><span class=n>ucred</span><span class=p>,</span> <span class=k>struct</span> <span class=n>vnode</span> <span class=o>*</span><span class=n>vp</span><span class=p>,</span>
    <span class=k>struct</span> <span class=n>label</span> <span class=o>*</span><span class=n>vlabel</span><span class=p>);</span></code></pre></div></div><table class="tableblock frame-none grid-all stretch informaltable"><col style=width:33.3333%><col style=width:33.3333%><col style=width:33.3334%><thead><tr><th class="tableblock halign-left valign-top">Parameter</th><th class="tableblock halign-left valign-top">Description</th><th class="tableblock halign-left valign-top">Locking</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>ucred</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Subject credential</p></td><td class="tableblock halign-left valign-top"></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>vp</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Accounting file; <a href="https://man.freebsd.org/cgi/man.cgi?query=acct&amp;sektion=5&amp;format=html">acct(5)</a></p></td><td class="tableblock halign-left valign-top"></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>vlabel</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Label associated with <code>vp</code></p></td><td class="tableblock halign-left valign-top"></td></tr></tbody></table><div class=paragraph><p>Determine whether the subject should be allowed to enable accounting, based on its label and the label of the accounting log file.</p></div></div><div class=sect3><h4 id=mac-mpo-check-system-nfsd>6.7.4.62. <code>mpo_check_system_nfsd</code><a class=anchor href=#mac-mpo-check-system-nfsd></a></h4><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=c><span class=kt>int</span> <span class=nf>mpo_check_system_nfsd</span><span class=p>(</span><span class=k>struct</span> <span class=n>ucred</span> <span class=o>*</span><span class=n>cred</span><span class=p>);</span></code></pre></div></div><table class="tableblock frame-none grid-all stretch informaltable"><col style=width:33.3333%><col style=width:33.3333%><col style=width:33.3334%><thead><tr><th class="tableblock halign-left valign-top">Parameter</th><th class="tableblock halign-left valign-top">Description</th><th class="tableblock halign-left valign-top">Locking</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>cred</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Subject credential</p></td><td class="tableblock halign-left valign-top"></td></tr></tbody></table><div class=paragraph><p>Determine whether the subject should be allowed to call <a href="https://man.freebsd.org/cgi/man.cgi?query=nfssvc&amp;sektion=2&amp;format=html">nfssvc(2)</a>.</p></div></div><div class=sect3><h4 id=mac-mpo-check-system-reboot>6.7.4.63. <code>mpo_check_system_reboot</code><a class=anchor href=#mac-mpo-check-system-reboot></a></h4><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=c><span class=kt>int</span> <span class=nf>mpo_check_system_reboot</span><span class=p>(</span><span class=k>struct</span> <span class=n>ucred</span> <span class=o>*</span><span class=n>cred</span><span class=p>,</span> <span class=kt>int</span> <span class=n>howto</span><span class=p>);</span></code></pre></div></div><table class="tableblock frame-none grid-all stretch informaltable"><col style=width:33.3333%><col style=width:33.3333%><col style=width:33.3334%><thead><tr><th class="tableblock halign-left valign-top">Parameter</th><th class="tableblock halign-left valign-top">Description</th><th class="tableblock halign-left valign-top">Locking</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>cred</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Subject credential</p></td><td class="tableblock halign-left valign-top"></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>howto</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock><code>howto</code> parameter from <a href="https://man.freebsd.org/cgi/man.cgi?query=reboot&amp;sektion=2&amp;format=html">reboot(2)</a></p></td><td class="tableblock halign-left valign-top"></td></tr></tbody></table><div class=paragraph><p>Determine whether the subject should be allowed to reboot the system in the specified manner.</p></div></div><div class=sect3><h4 id=mac-mpo-check-system-settime>6.7.4.64. <code>mpo_check_system_settime</code><a class=anchor href=#mac-mpo-check-system-settime></a></h4><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=c><span class=kt>int</span> <span class=nf>mpo_check_system_settime</span><span class=p>(</span><span class=k>struct</span> <span class=n>ucred</span> <span class=o>*</span><span class=n>cred</span><span class=p>);</span></code></pre></div></div><table class="tableblock frame-none grid-all stretch informaltable"><col style=width:33.3333%><col style=width:33.3333%><col style=width:33.3334%><thead><tr><th class="tableblock halign-left valign-top">Parameter</th><th class="tableblock halign-left valign-top">Description</th><th class="tableblock halign-left valign-top">Locking</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>cred</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Subject credential</p></td><td class="tableblock halign-left valign-top"></td></tr></tbody></table><div class=paragraph><p>Determine whether the user should be allowed to set the system clock.</p></div></div><div class=sect3><h4 id=mac-mpo-check-system-swapon>6.7.4.65. <code>mpo_check_system_swapon</code><a class=anchor href=#mac-mpo-check-system-swapon></a></h4><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=c><span class=kt>int</span> <span class=nf>mpo_check_system_swapon</span><span class=p>(</span><span class=k>struct</span> <span class=n>ucred</span> <span class=o>*</span><span class=n>cred</span><span class=p>,</span> <span class=k>struct</span> <span class=n>vnode</span> <span class=o>*</span><span class=n>vp</span><span class=p>,</span>
    <span class=k>struct</span> <span class=n>label</span> <span class=o>*</span><span class=n>vlabel</span><span class=p>);</span></code></pre></div></div><table class="tableblock frame-none grid-all stretch informaltable"><col style=width:33.3333%><col style=width:33.3333%><col style=width:33.3334%><thead><tr><th class="tableblock halign-left valign-top">Parameter</th><th class="tableblock halign-left valign-top">Description</th><th class="tableblock halign-left valign-top">Locking</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>cred</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Subject credential</p></td><td class="tableblock halign-left valign-top"></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>vp</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Swap device</p></td><td class="tableblock halign-left valign-top"></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>vlabel</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Label associated with <code>vp</code></p></td><td class="tableblock halign-left valign-top"></td></tr></tbody></table><div class=paragraph><p>Determine whether the subject should be allowed to add <code>vp</code> as a swap device.</p></div></div><div class=sect3><h4 id=mac-mpo-check-system-sysctl>6.7.4.66. <code>mpo_check_system_sysctl</code><a class=anchor href=#mac-mpo-check-system-sysctl></a></h4><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=c><span class=kt>int</span> <span class=nf>mpo_check_system_sysctl</span><span class=p>(</span><span class=k>struct</span> <span class=n>ucred</span> <span class=o>*</span><span class=n>cred</span><span class=p>,</span> <span class=kt>int</span> <span class=o>*</span><span class=n>name</span><span class=p>,</span> <span class=n>u_int</span> <span class=o>*</span><span class=n>namelen</span><span class=p>,</span>
    <span class=kt>void</span> <span class=o>*</span><span class=n>old</span><span class=p>,</span> <span class=kt>size_t</span> <span class=o>*</span><span class=n>oldlenp</span><span class=p>,</span> <span class=kt>int</span> <span class=n>inkernel</span><span class=p>,</span> <span class=kt>void</span> <span class=o>*</span><span class=n>new</span><span class=p>,</span> <span class=kt>size_t</span> <span class=n>newlen</span><span class=p>);</span></code></pre></div></div><table class="tableblock frame-none grid-all stretch informaltable"><col style=width:33.3333%><col style=width:33.3333%><col style=width:33.3334%><thead><tr><th class="tableblock halign-left valign-top">Parameter</th><th class="tableblock halign-left valign-top">Description</th><th class="tableblock halign-left valign-top">Locking</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>cred</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Subject credential</p></td><td class="tableblock halign-left valign-top"></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>name</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>See <a href="https://man.freebsd.org/cgi/man.cgi?query=sysctl&amp;sektion=3&amp;format=html">sysctl(3)</a></p></td><td class="tableblock halign-left valign-top"></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>namelen</code></p></td><td class="tableblock halign-left valign-top"></td><td class="tableblock halign-left valign-top"></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>old</code></p></td><td class="tableblock halign-left valign-top"></td><td class="tableblock halign-left valign-top"></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>oldlenp</code></p></td><td class="tableblock halign-left valign-top"></td><td class="tableblock halign-left valign-top"></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>inkernel</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Boolean; <code>1</code> if called from kernel</p></td><td class="tableblock halign-left valign-top"></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>new</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>See <a href="https://man.freebsd.org/cgi/man.cgi?query=sysctl&amp;sektion=3&amp;format=html">sysctl(3)</a></p></td><td class="tableblock halign-left valign-top"></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>newlen</code></p></td><td class="tableblock halign-left valign-top"></td><td class="tableblock halign-left valign-top"></td></tr></tbody></table><div class=paragraph><p>Determine whether the subject should be allowed to make the specified <a href="https://man.freebsd.org/cgi/man.cgi?query=sysctl&amp;sektion=3&amp;format=html">sysctl(3)</a> transaction.</p></div></div></div><div class=sect2><h3 id=mac-label-management>6.7.5. Label Management Calls<a class=anchor href=#mac-label-management></a></h3><div class=paragraph><p>Relabel events occur when a user process has requested that the label on an object be modified.
A two-phase update occurs: first, an access control check will be performed to determine if the update is both valid and permitted, and then the update itself is performed via a separate entry point.
Relabel entry points typically accept the object, object label reference, and an update label submitted by the process.
Memory allocation during relabel is discouraged, as relabel calls are not permitted to fail (failure should be reported earlier in the relabel check).</p></div></div></div></div><div class=sect1><h2 id=mac-userland-arch>6.8. Userland Architecture<a class=anchor href=#mac-userland-arch></a></h2><div class=sectionbody><div class=paragraph><p>The TrustedBSD MAC Framework includes a number of policy-agnostic elements, including MAC library interfaces for abstractly managing labels, modifications to the system credential management and login libraries to support the assignment of MAC labels to users, and a set of tools to monitor and modify labels on processes, files, and network interfaces.
More details on the user architecture will be added to this section in the near future.</p></div><div class=sect2><h3 id=mac-userland-labels>6.8.1. APIs for Policy-Agnostic Label Management<a class=anchor href=#mac-userland-labels></a></h3><div class=paragraph><p>The TrustedBSD MAC Framework provides a number of library and system calls permitting applications to manage MAC labels on objects using a policy-agnostic interface.
This permits applications to manipulate labels for a variety of policies without being written to support specific policies.
These interfaces are used by general-purpose tools such as <a href="https://man.freebsd.org/cgi/man.cgi?query=ifconfig&amp;sektion=8&amp;format=html">ifconfig(8)</a>, <a href="https://man.freebsd.org/cgi/man.cgi?query=ls&amp;sektion=1&amp;format=html">ls(1)</a> and <a href="https://man.freebsd.org/cgi/man.cgi?query=ps&amp;sektion=1&amp;format=html">ps(1)</a> to view labels on network interfaces, files, and processes.
The APIs also support MAC management tools including <a href="https://man.freebsd.org/cgi/man.cgi?query=getfmac&amp;sektion=8&amp;format=html">getfmac(8)</a>, <a href="https://man.freebsd.org/cgi/man.cgi?query=getpmac&amp;sektion=8&amp;format=html">getpmac(8)</a>, <a href="https://man.freebsd.org/cgi/man.cgi?query=setfmac&amp;sektion=8&amp;format=html">setfmac(8)</a>, <a href="https://man.freebsd.org/cgi/man.cgi?query=setfsmac&amp;sektion=8&amp;format=html">setfsmac(8)</a>, and <a href="https://man.freebsd.org/cgi/man.cgi?query=setpmac&amp;sektion=8&amp;format=html">setpmac(8)</a>.
The MAC APIs are documented in <a href="https://man.freebsd.org/cgi/man.cgi?query=mac&amp;sektion=3&amp;format=html">mac(3)</a>.</p></div><div class=paragraph><p>Applications handle MAC labels in two forms: an internalized form used to return and set labels on processes and objects (<code>mac_t</code>), and externalized form based on C strings appropriate for storage in configuration files, display to the user, or input from the user.
Each MAC label contains a number of elements, each consisting of a name and value pair.
Policy modules in the kernel bind to specific names and interpret the values in policy-specific ways.
In the externalized string form, labels are represented by a comma-delimited list of name and value pairs separated by the <code>/</code> character.
Labels may be directly converted to and from text using provided APIs; when retrieving labels from the kernel, internalized label storage must first be prepared for the desired label element set.
Typically, this is done in one of two ways: using <a href="https://man.freebsd.org/cgi/man.cgi?query=mac_prepare&amp;sektion=3&amp;format=html">mac_prepare(3)</a> and an arbitrary list of desired label elements, or one of the variants of the call that loads a default element set from the <a href="https://man.freebsd.org/cgi/man.cgi?query=mac.conf&amp;sektion=5&amp;format=html">mac.conf(5)</a> configuration file.
Per-object defaults permit application writers to usefully display labels associated with objects without being aware of the policies present in the system.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Currently, direct manipulation of label elements other than by conversion to a text string, string editing, and conversion back to an internalized label is not supported by the MAC library.
Such interfaces may be added in the future if they prove necessary for application writers.</p></div></td></tr></tbody></table></div></div><div class=sect2><h3 id=mac-userland-credentials>6.8.2. Binding of Labels to Users<a class=anchor href=#mac-userland-credentials></a></h3><div class=paragraph><p>The standard user context management interface, <a href="https://man.freebsd.org/cgi/man.cgi?query=setusercontext&amp;sektion=3&amp;format=html">setusercontext(3)</a>, has been modified to retrieve MAC labels associated with a user’s class from <a href="https://man.freebsd.org/cgi/man.cgi?query=login.conf&amp;sektion=5&amp;format=html">login.conf(5)</a>.
These labels are then set along with other user context when either <code>LOGIN_SETALL</code> is specified, or when <code>LOGIN_SETMAC</code> is explicitly specified.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>It is expected that, in a future version of FreeBSD, the MAC label database will be separated from the <span class=filename>login.conf</span> user class abstraction, and be maintained in a separate database.
However, the <a href="https://man.freebsd.org/cgi/man.cgi?query=setusercontext&amp;sektion=3&amp;format=html">setusercontext(3)</a> API should remain the same following such a change.</p></div></td></tr></tbody></table></div></div></div></div><div class=sect1><h2 id=mac-conclusion>6.9. Conclusion<a class=anchor href=#mac-conclusion></a></h2><div class=sectionbody><div class=paragraph><p>The TrustedBSD MAC framework permits kernel modules to augment the system security policy in a highly integrated manner.
They may do this based on existing object properties, or based on label data that is maintained with the assistance of the MAC framework.
The framework is sufficiently flexible to implement a variety of policy types, including information flow security policies such as MLS and Biba, as well as policies based on existing BSD credentials or file protections.
Policy authors may wish to consult this documentation as well as existing security modules when implementing a new security service.</p></div></div></div></div><hr><div class=last-modified><p><strong>Last modified on</strong>: September 20, 2024 by <a href="https://cgit.freebsd.org/doc/commit/?id=2d2f5d38cc" target=_blank>Fernando Apesteguía</a></p></div><div class=buttons><div class=prev><i class="fa fa-angle-left" aria-hidden=true title=Prev></i><div class=container><a href=http://172.16.201.134:1313/en/books/arch-handbook/sysinit class=direction>Prev</a></div></div><div class=home><i class="fa fa-home" aria-hidden=true title=Home></i><div class=container><a href=../ class=direction>Home</a></div></div><div class=next><div class=container><a href=http://172.16.201.134:1313/en/books/arch-handbook/vm class=direction>Next</a></div><i class="fa fa-angle-right" aria-hidden=true title=Next></i></div></div><label class="hidden book-menu-overlay" for=menu-control></label></div><aside class=toc><div class=toc-content><h3>Table of Contents</h3><nav id=TableOfContents><ul><li><a href=#mac-copyright>6.1. MAC Documentation Copyright</a></li><li><a href=#mac-synopsis>6.2. Synopsis</a></li><li><a href=#mac-introduction>6.3. Introduction</a></li><li><a href=#mac-background>6.4. Policy Background</a></li><li><a href=#mac-framework-kernel-arch>6.5. MAC Framework Kernel Architecture</a></li><li><a href=#mac-policy-architecture>6.6. MAC Policy Architecture</a></li><li><a href=#mac-entry-point-reference>6.7. MAC Policy Entry Point Reference</a></li><li><a href=#mac-userland-arch>6.8. Userland Architecture</a></li><li><a href=#mac-conclusion>6.9. Conclusion</a></li></ul></nav><hr><div class=resources><h3>Resources</h3><ul class=contents><li><i class="fa fa-file-pdf-o" aria-hidden=true title="Download PDF"></i><a href=https://download.freebsd.org/doc/en/books/arch-handbook/arch-handbook_en.pdf>Download PDF</a></li><li><i class="fa fa-pencil-square-o" aria-hidden=true title="Edit this page"></i><a href=https://github.com/freebsd/freebsd-doc/blob/main/documentation/content/en/_index target=_blank>Edit this page</a></li></ul></div></div></aside><a class=to-top href=#top><i class="fa fa-arrow-circle-up" aria-hidden=true></i></a></main><footer><div class=footer-container><section class=logo-column><img src=http://172.16.201.134:1313/images/FreeBSD-colors.svg width=160 height=50 alt="FreeBSD logo"><div class=options-container><div class=language-container><a id=languages href=http://172.16.201.134:1313/en/languages><img src=http://172.16.201.134:1313/images/language.png class=language-image alt="Choose language">
<span>English</span></a></div><div class=theme-container><select id=theme-chooser><option value=theme-system>System</option><option value=theme-light>Light</option><option value=theme-dark>Dark</option><option value=theme-high-contrast>High contrast</option></select></div></div></section><section class=about-column><h3 class=column-title>About</h3><ul class=column-elements-container><li><a href=https://www.freebsd.org/about/ target=_blank class=column-element>FreeBSD</a></li><li><a href=https://freebsdfoundation.org/ target=_blank class=column-element>FreeBSD Foundation</a></li><li><a href=https://www.freebsd.org/where/ target=_blank class=column-element>Get FreeBSD</a></li><li><a href=https://www.freebsd.org/internal/code-of-conduct target=_blank class=column-element>Code of Conduct</a></li><li><a href=https://www.freebsd.org/security/ target=_blank class=column-element>Security Advisories</a></li></ul></section><section class=documentation-column><h3 class=column-title>Documentation</h3><ul class=column-elements-container><li><a href=/en class=column-element>Documentation portal</a></li><li><a href=https://man.FreeBSD.org target=_blank class=column-element>Manual pages</a></li><li><a href=https://papers.FreeBSD.org target=_blank class=column-element>Presentations and papers</a></li><li><a href=https://docs-archive.freebsd.org/doc/ target=_blank class=column-element>Previous versions</a></li><li><a href=https://docs-archive.freebsd.org/44doc/ target=_blank class=column-element>4.4BSD Documents</a></li><li><a href=https://wiki.freebsd.org/ target=_blank class=column-element>Wiki</a></li></ul></section><section class=community-column><h3 class=column-title>Community</h3><ul class=column-elements-container><li><a href=http://172.16.201.134:1313/en/articles/contributing class=column-element>Get involved</a></li><li><a href=https://forums.freebsd.org/ target=_blank class=column-element>Community forum</a></li><li><a href=https://lists.freebsd.org/ target=_blank class=column-element>Mailing lists</a></li><li><a href=https://wiki.freebsd.org/IRC/Channels target=_blank class=column-element>IRC Channels</a></li><li><a href=https://bugs.freebsd.org/bugzilla/ target=_blank class=column-element>Bug Tracker</a></li></ul></section><section class=legal-column><h3 class=column-title>Legal</h3><ul class=column-elements-container><li><a href=https://freebsdfoundation.org/donate/ target=_blank class=column-element>Donations</a></li><li><a href=https://www.freebsd.org/copyright/freebsd-license/ target=_blank class=column-element>Licensing</a></li><li><a href=https://www.freebsd.org/privacy/ target=_blank class=column-element>Privacy Policy</a></li><li><a href=https://www.freebsd.org/copyright/ target=_blank class=column-element>Legal notices</a></li></ul></section><section class=copyright-column><p>&copy; 1994-2024 The FreeBSD Project. All rights reserved</p><span>Made with <span class=heart>♥</span> by the FreeBSD Community</span></section></div></footer></body></html>