<!doctype html><html class=theme-light lang=en><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="Regression and Performance Testing"><meta name=keywords content="Regression,Performance Testing,Testing,Tinderbox"><meta name=copyright content="1995-2024 The FreeBSD Foundation"><link rel=canonical href=https://docs.freebsd.org/en/books/developers-handbook/testing/><title>Chapter 6. Regression and Performance Testing | FreeBSD Documentation Portal</title>
<meta name=theme-color content="#790000"><meta name=color-scheme content="system light dark high-contrast"><link rel="shortcut icon" href=https://docs.freebsd.org/favicon.ico><link rel=stylesheet href=https://docs.freebsd.org/styles/main.min.css><link rel=stylesheet href=https://docs.freebsd.org/css/font-awesome-min.css><script defer src=/js/theme-chooser.min.js></script><script defer src=/js/copy-clipboard.min.js></script><script defer src=/js/search.min.js></script><meta name=twitter:card content="summary"><meta name=twitter:domain content="docs.FreeBSD.org"><meta name=twitter:site content="@freebsd"><meta name=twitter:url content="https://twitter.com/freebsd"><meta property="og:title" content="Chapter 6. Regression and Performance Testing"><meta property="og:description" content="Regression and Performance Testing"><meta property="og:type" content="website"><meta property="og:image" content="https://docs.freebsd.org/favicon.ico"><meta property="og:image:alt" content="FreeBSD Logo"><meta property="og:locale" content="en"><meta property="og:url" content="https://docs.freebsd.org/en/books/developers-handbook/testing/"><meta property="og:site_name" content="FreeBSD Documentation Portal"><script type=application/ld+json>{"@context":"http://schema.org","@type":"Article","url":"https:\/\/docs.freebsd.org\/en\/books\/developers-handbook\/testing\/","name":"FreeBSD Documentation Portal","headline":"FreeBSD Documentation Portal","description":"FreeBSD Documentation Portal"}</script></head><body><header><div class=header-container><div class=logo-menu-bars-container><a href=https://www.FreeBSD.org class=logo><img src=https://docs.freebsd.org/images/FreeBSD-monochromatic.svg width=160 height=50 alt="FreeBSD logo">
</a><label class=menu-bars for=menu-bars><i class="fa fa-bars" aria-hidden=true></i></label></div><input id=menu-bars type=checkbox><nav><ul class=menu><li class=menu-item><input id=about type=checkbox>
<a href=# aria-label="Navigate to About section"><label class=menu-item-description for=about>About
<i class="fa fa-angle-down fa-lg" aria-hidden=true></i></label></a><ul class=sub-menu><li class=title><a href=https://www.freebsd.org/about/ target=_blank>About</a></li><li><a href=https://www.freebsd.org/about/ target=_blank>FreeBSD</a></li><li><a href=https://freebsdfoundation.org/about-us/about-the-foundation/ target=_blank>FreeBSD Foundation</a></li><li><a href=https://www.freebsd.org/internal/code-of-conduct/ target=_blank>Code of Conduct</a></li></ul></li><li class=menu-item><input id=download type=checkbox>
<a href=# aria-label="Navigate to get FreeBSD section"><label class=menu-item-description for=download>Get FreeBSD
<i class="fa fa-angle-down fa-lg" aria-hidden=true></i></label></a><ul class=sub-menu><li class=title><a href=https://www.freebsd.org/where/ target=_blank>Get FreeBSD</a></li><li><a href=https://www.freebsd.org/releases/ target=_blank>Release Information</a></li><li><a href=https://www.freebsd.org/releng/ target=_blank>Release Engineering</a></li><li><a href=https://www.freebsd.org/security/ target=_blank>Security Advisories</a></li></ul></li><li class=menu-item><input id=documentation type=checkbox>
<a href=# aria-label="Navigate to get Documentation section"><label class=menu-item-description for=documentation>Documentation
<i class="fa fa-angle-down fa-lg" aria-hidden=true></i></label></a><ul class=sub-menu><li class=title><a href=/en>Documentation portal</a></li><li><a href=https://docs.freebsd.org/en/books/handbook>FreeBSD Handbook</a></li><li><a href=https://docs.freebsd.org/en/books/porters-handbook>Porter's Handbook</a></li><li><a href=https://docs.FreeBSD.org/en/books/fdp-primer>Documentation Project Handbook</a></li><li><a href=https://man.FreeBSD.org target=_blank>Manual pages</a></li><li><a href=https://papers.FreeBSD.org target=_blank>Presentations and papers</a></li><li><a href=https://wiki.FreeBSD.org target=_blank>Wiki</a></li><li><a href=https://docs.freebsd.org/en/books>Books</a></li><li><a href=https://docs.freebsd.org/en/articles>Articles</a></li></ul></li><li class=menu-item><input id=community type=checkbox>
<a href=# aria-label="Navigate to get Community section"><label class=menu-item-description for=community>Community
<i class="fa fa-angle-down fa-lg" aria-hidden=true></i></label></a><ul class=sub-menu><li class=title><a href=https://www.freebsd.org/community/>Community</a></li><li><a href=https://docs.freebsd.org/en/articles/contributing>Get involved</a></li><li><a href=https://forums.freebsd.org/ target=_blank>Forum</a></li><li><a href=https://lists.freebsd.org/ target=_blank>Mailing lists</a></li><li><a href=https://wiki.freebsd.org/IRC/Channels target=_blank>IRC Channels</a></li><li><a href=https://bugs.freebsd.org/bugzilla/ target=_blank>Bug Tracker</a></li><li><a href=https://www.freebsd.org/support/ target=_blank>Support</a></li></ul></li></ul></nav><div class=search-donate-container><form class=search method=get id=search-header-form action=https://docs.freebsd.org/search name=search-header-form><input type=hidden name=DB value=en>
<input id=words name=P type=text size=20 maxlength=255>
<button>
<i class="fa fa-search" aria-hidden=true></i></button></form><div class=donate><a href=https://freebsdfoundation.org/donate/ target=_blank><span class=heart>♥</span>
Donate</a></div></div></div></header><input type=checkbox class="hidden toggle" id=menu-control><main class=main-wrapper-book><a id=top></a><aside class=book-menu><div class=book-menu-content><input id=search-book type=text placeholder=Search aria-label=Search maxlength=128><nav id=MenuContents><ul><li><input type=checkbox id=chapter-b1b18a35567534d1699b4dd27b58b2ff class=toggle>
<label for=chapter-b1b18a35567534d1699b4dd27b58b2ff><a role=button></a></label><a href=https://docs.freebsd.org/en/books/developers-handbook/parti/>Part I. Basics</a></li><li><input type=checkbox id=chapter-3af9d0cd3607fbe44d37e3a13957c40f class=toggle>
<label class="icon cursor" for=chapter-3af9d0cd3607fbe44d37e3a13957c40f><a role=button></a></label><a href=https://docs.freebsd.org/en/books/developers-handbook/introduction/>Chapter 1. Introduction</a><ul><li><a href=https://docs.freebsd.org/en/books/developers-handbook/introduction/#introduction-devel>1.1. Developing on FreeBSD</a></li><li><a href=https://docs.freebsd.org/en/books/developers-handbook/introduction/#introduction-bsdvision>1.2. The BSD Vision</a></li><li><a href=https://docs.freebsd.org/en/books/developers-handbook/introduction/#introduction-archguide>1.3. Architectural Guidelines</a></li><li><a href=https://docs.freebsd.org/en/books/developers-handbook/introduction/#introduction-layout>1.4. The Layout of /usr/src</a></li></ul></li><li><input type=checkbox id=chapter-15219234c513f9a79d9cb2d3bcf73d13 class=toggle>
<label class="icon cursor" for=chapter-15219234c513f9a79d9cb2d3bcf73d13><a role=button></a></label><a href=https://docs.freebsd.org/en/books/developers-handbook/tools/>Chapter 2. Programming Tools</a><ul><li><a href=https://docs.freebsd.org/en/books/developers-handbook/tools/#tools-synopsis>2.1. Synopsis</a></li><li><a href=https://docs.freebsd.org/en/books/developers-handbook/tools/#tools-intro>2.2. Introduction</a></li><li><a href=https://docs.freebsd.org/en/books/developers-handbook/tools/#tools-programming>2.3. Introduction to Programming</a></li><li><a href=https://docs.freebsd.org/en/books/developers-handbook/tools/#tools-compiling>2.4. Compiling with <code>cc</code></a></li><li><a href=https://docs.freebsd.org/en/books/developers-handbook/tools/#tools-make>2.5. Make</a></li><li><a href=https://docs.freebsd.org/en/books/developers-handbook/tools/#debugging>2.6. Debugging</a></li><li><a href=https://docs.freebsd.org/en/books/developers-handbook/tools/#emacs>2.7. Using Emacs as a Development Environment</a></li><li><a href=https://docs.freebsd.org/en/books/developers-handbook/tools/#tools-reading>2.8. Further Reading</a></li></ul></li><li><input type=checkbox id=chapter-7319f5d899d5be33daaf1f2d5f180558 class=toggle>
<label class="icon cursor" for=chapter-7319f5d899d5be33daaf1f2d5f180558><a role=button></a></label><a href=https://docs.freebsd.org/en/books/developers-handbook/secure/>Chapter 3. Secure Programming</a><ul><li><a href=https://docs.freebsd.org/en/books/developers-handbook/secure/#secure-synopsis>3.1. Synopsis</a></li><li><a href=https://docs.freebsd.org/en/books/developers-handbook/secure/#secure-philosophy>3.2. Secure Design Methodology</a></li><li><a href=https://docs.freebsd.org/en/books/developers-handbook/secure/#secure-bufferov>3.3. Buffer Overflows</a></li><li><a href=https://docs.freebsd.org/en/books/developers-handbook/secure/#secure-setuid>3.4. SetUID issues</a></li><li><a href=https://docs.freebsd.org/en/books/developers-handbook/secure/#secure-chroot>3.5. Limiting your program’s environment</a></li><li><a href=https://docs.freebsd.org/en/books/developers-handbook/secure/#secure-trust>3.6. Trust</a></li><li><a href=https://docs.freebsd.org/en/books/developers-handbook/secure/#secure-race-conditions>3.7. Race Conditions</a></li></ul></li><li><input type=checkbox id=chapter-0240ccaf7010beed911378cfab7bd8fc class=toggle>
<label class="icon cursor" for=chapter-0240ccaf7010beed911378cfab7bd8fc><a role=button></a></label><a href=https://docs.freebsd.org/en/books/developers-handbook/l10n/>Chapter 4. Localization and Internationalization - L10N and I18N</a><ul><li><a href=https://docs.freebsd.org/en/books/developers-handbook/l10n/#l10n-programming>4.1. Programming I18N Compliant Applications</a></li><li><a href=https://docs.freebsd.org/en/books/developers-handbook/l10n/#posix-nls>4.2. Localized Messages with POSIX.1 Native Language Support (NLS)</a></li></ul></li><li><input type=checkbox id=chapter-c3107aaf64e60e1ee09bc33fc9fd641a class=toggle>
<label class="icon cursor" for=chapter-c3107aaf64e60e1ee09bc33fc9fd641a><a role=button></a></label><a href=https://docs.freebsd.org/en/books/developers-handbook/policies/>Chapter 5. Source Tree Guidelines and Policies</a><ul><li><a href=https://docs.freebsd.org/en/books/developers-handbook/policies/#policies-style>5.1. Style Guidelines</a></li><li><a href=https://docs.freebsd.org/en/books/developers-handbook/policies/#policies-maintainer>5.2. <code>MAINTAINER</code> on Makefiles</a></li><li><a href=https://docs.freebsd.org/en/books/developers-handbook/policies/#policies-contributed>5.3. Contributed Software</a></li><li><a href=https://docs.freebsd.org/en/books/developers-handbook/policies/#policies-encumbered>5.4. Encumbered Files</a></li><li><a href=https://docs.freebsd.org/en/books/developers-handbook/policies/#policies-shlib>5.5. Shared Libraries</a></li></ul></li><li><input type=checkbox id=chapter-c7b4fd5a7f8f049234fe3bc225acef44 class=toggle checked>
<label class="icon cursor" for=chapter-c7b4fd5a7f8f049234fe3bc225acef44><a role=button></a></label><a href=https://docs.freebsd.org/en/books/developers-handbook/testing/>Chapter 6. Regression and Performance Testing</a><ul><li><a href=https://docs.freebsd.org/en/books/developers-handbook/testing/#testing-micro-benchmark>6.1. Micro Benchmark Checklist</a></li><li><a href=https://docs.freebsd.org/en/books/developers-handbook/testing/#testing-tinderbox>6.2. The FreeBSD Source Tinderbox</a></li><li><a href=https://docs.freebsd.org/en/books/developers-handbook/testing/#_the_index_cgi_script>6.3. The index.cgi Script</a></li><li><a href=https://docs.freebsd.org/en/books/developers-handbook/testing/#_official_build_servers>6.4. Official Build Servers</a></li><li><a href=https://docs.freebsd.org/en/books/developers-handbook/testing/#_official_summary_site>6.5. Official Summary Site</a></li></ul></li><li><input type=checkbox id=chapter-1f9b02a65f2bc5d4015a050d706fa837 class=toggle>
<label for=chapter-1f9b02a65f2bc5d4015a050d706fa837><a role=button></a></label><a href=https://docs.freebsd.org/en/books/developers-handbook/partii/>Part II. Interprocess Communication</a></li><li><input type=checkbox id=chapter-5e03777f678dd5731a581d7956d19c13 class=toggle>
<label class="icon cursor" for=chapter-5e03777f678dd5731a581d7956d19c13><a role=button></a></label><a href=https://docs.freebsd.org/en/books/developers-handbook/sockets/>Chapter 7. Sockets</a><ul><li><a href=https://docs.freebsd.org/en/books/developers-handbook/sockets/#sockets-synopsis>7.1. Synopsis</a></li><li><a href=https://docs.freebsd.org/en/books/developers-handbook/sockets/#sockets-diversity>7.2. Networking and Diversity</a></li><li><a href=https://docs.freebsd.org/en/books/developers-handbook/sockets/#sockets-protocols>7.3. Protocols</a></li><li><a href=https://docs.freebsd.org/en/books/developers-handbook/sockets/#sockets-model>7.4. The Sockets Model</a></li><li><a href=https://docs.freebsd.org/en/books/developers-handbook/sockets/#sockets-essential-functions>7.5. Essential Socket Functions</a></li><li><a href=https://docs.freebsd.org/en/books/developers-handbook/sockets/#sockets-helper-functions>7.6. Helper Functions</a></li><li><a href=https://docs.freebsd.org/en/books/developers-handbook/sockets/#sockets-concurrent-servers>7.7. Concurrent Servers</a></li></ul></li><li><input type=checkbox id=chapter-5cbeeaa29a95a5f152e5ccc3901d0fd3 class=toggle>
<label class="icon cursor" for=chapter-5cbeeaa29a95a5f152e5ccc3901d0fd3><a role=button></a></label><a href=https://docs.freebsd.org/en/books/developers-handbook/ipv6/>Chapter 8. IPv6 Internals</a><ul><li><a href=https://docs.freebsd.org/en/books/developers-handbook/ipv6/#ipv6-implementation>8.1. IPv6/IPsec Implementation</a></li></ul></li><li><input type=checkbox id=chapter-c9a07b517dc2e43d169c8e013e23cfc1 class=toggle>
<label for=chapter-c9a07b517dc2e43d169c8e013e23cfc1><a role=button></a></label><a href=https://docs.freebsd.org/en/books/developers-handbook/partiii/>Part III. Kernel</a></li><li><input type=checkbox id=chapter-db22f8e5e5e9496dbc711815e2e05f36 class=toggle>
<label class="icon cursor" for=chapter-db22f8e5e5e9496dbc711815e2e05f36><a role=button></a></label><a href=https://docs.freebsd.org/en/books/developers-handbook/kernelbuild/>Chapter 9. Building and Installing a FreeBSD Kernel</a><ul><li><a href=https://docs.freebsd.org/en/books/developers-handbook/kernelbuild/#kernelbuild-traditional>9.1. Building the Faster but Brittle Way</a></li></ul></li><li><input type=checkbox id=chapter-3036877c53948cfb76174f2776bbdf64 class=toggle>
<label class="icon cursor" for=chapter-3036877c53948cfb76174f2776bbdf64><a role=button></a></label><a href=https://docs.freebsd.org/en/books/developers-handbook/kerneldebug/>Chapter 10. Kernel Debugging</a><ul><li><a href=https://docs.freebsd.org/en/books/developers-handbook/kerneldebug/#kerneldebug-obtain>10.1. Obtaining a Kernel Crash Dump</a></li><li><a href=https://docs.freebsd.org/en/books/developers-handbook/kerneldebug/#kerneldebug-gdb>10.2. Debugging a Kernel Crash Dump with <code>kgdb</code></a></li><li><a href=https://docs.freebsd.org/en/books/developers-handbook/kerneldebug/#kerneldebug-online-ddb>10.3. On-Line Kernel Debugging Using DDB</a></li><li><a href=https://docs.freebsd.org/en/books/developers-handbook/kerneldebug/#kerneldebug-online-gdb>10.4. On-Line Kernel Debugging Using Remote GDB</a></li><li><a href=https://docs.freebsd.org/en/books/developers-handbook/kerneldebug/#kerneldebug-console>10.5. Debugging a Console Driver</a></li><li><a href=https://docs.freebsd.org/en/books/developers-handbook/kerneldebug/#kerneldebug-deadlocks>10.6. Debugging Deadlocks</a></li><li><a href=https://docs.freebsd.org/en/books/developers-handbook/kerneldebug/#kerneldebug-dcons>10.7. Kernel debugging with Dcons</a></li><li><a href=https://docs.freebsd.org/en/books/developers-handbook/kerneldebug/#kerneldebug-options>10.8. Glossary of Kernel Options for Debugging</a></li></ul></li><li><input type=checkbox id=chapter-86707094ce48d6e89e5f45569c084cea class=toggle>
<label for=chapter-86707094ce48d6e89e5f45569c084cea><a role=button></a></label><a href=https://docs.freebsd.org/en/books/developers-handbook/partiv/>Part IV. Architectures</a></li><li><input type=checkbox id=chapter-43b1e1e6d2a94eb8b161876bc22ce644 class=toggle>
<label class="icon cursor" for=chapter-43b1e1e6d2a94eb8b161876bc22ce644><a role=button></a></label><a href=https://docs.freebsd.org/en/books/developers-handbook/x86/>Chapter 11. x86 Assembly Language Programming</a><ul><li><a href=https://docs.freebsd.org/en/books/developers-handbook/x86/#x86-intro>A.1. Synopsis</a></li><li><a href=https://docs.freebsd.org/en/books/developers-handbook/x86/#x86-the-tools>A.2. The Tools</a></li><li><a href=https://docs.freebsd.org/en/books/developers-handbook/x86/#x86-system-calls>A.3. System Calls</a></li><li><a href=https://docs.freebsd.org/en/books/developers-handbook/x86/#x86-return-values>A.4. Return Values</a></li><li><a href=https://docs.freebsd.org/en/books/developers-handbook/x86/#x86-portable-code>A.5. Creating Portable Code</a></li><li><a href=https://docs.freebsd.org/en/books/developers-handbook/x86/#x86-first-program>A.6. Our First Program</a></li><li><a href=https://docs.freebsd.org/en/books/developers-handbook/x86/#x86-unix-filters>A.7. Writing UNIX® Filters</a></li><li><a href=https://docs.freebsd.org/en/books/developers-handbook/x86/#x86-buffered-io>A.8. Buffered Input and Output</a></li><li><a href=https://docs.freebsd.org/en/books/developers-handbook/x86/#x86-command-line>A.9. Command Line Arguments</a></li><li><a href=https://docs.freebsd.org/en/books/developers-handbook/x86/#x86-environment>A.10. UNIX® Environment</a></li><li><a href=https://docs.freebsd.org/en/books/developers-handbook/x86/#x86-files>A.11. Working with Files</a></li><li><a href=https://docs.freebsd.org/en/books/developers-handbook/x86/#x86-one-pointed-mind>A.12. One-Pointed Mind</a></li><li><a href=https://docs.freebsd.org/en/books/developers-handbook/x86/#x86-fpu>A.13. Using the FPU</a></li><li><a href=https://docs.freebsd.org/en/books/developers-handbook/x86/#x86-caveats>A.14. Caveats</a></li><li><a href=https://docs.freebsd.org/en/books/developers-handbook/x86/#x86-acknowledgements>A.15. Acknowledgements</a></li></ul></li><li><input type=checkbox id=chapter-c49dfe630861d471fb2f58f5b554ed84 class=toggle>
<label for=chapter-c49dfe630861d471fb2f58f5b554ed84><a role=button></a></label><a href=https://docs.freebsd.org/en/books/developers-handbook/partv/>Part V. Appendices</a></li><li><input type=checkbox id=chapter-ac9541a3f38001d13964c1b0b324bb83 class=toggle>
<label for=chapter-ac9541a3f38001d13964c1b0b324bb83><a role=button></a></label><a href=https://docs.freebsd.org/en/books/developers-handbook/bibliography/>Bibliography</a></li><li></li></ul></nav></div></aside><div class=book><div class=book-menu-mobile><label for=menu-control><span class=menu-control-button><i class="fa fa-list" aria-hidden=true title="Book menu"></i>
Book menu</span></label></div><h1 class=title>Chapter 6. Regression and Performance Testing</h1><div class=toc-mobile><h3>Table of Contents</h3><nav id=TableOfContents><ul><li><a href=#testing-micro-benchmark>6.1. Micro Benchmark Checklist</a></li><li><a href=#testing-tinderbox>6.2. The FreeBSD Source Tinderbox</a></li><li><a href=#_the_index_cgi_script>6.3. The index.cgi Script</a></li><li><a href=#_official_build_servers>6.4. Official Build Servers</a></li><li><a href=#_official_summary_site>6.5. Official Summary Site</a></li></ul></nav></div><div class=book-content><div id=preamble><div class=sectionbody><div class=paragraph><p>Regression tests are used to exercise a particular bit of the system to check that it works as expected, and to make sure that old bugs are not reintroduced.</p></div><div class=paragraph><p>The FreeBSD regression testing tools can be found in the FreeBSD source tree in the directory <span class=filename>src/tools/regression</span>.</p></div></div></div><div class=sect1><h2 id=testing-micro-benchmark>6.1. Micro Benchmark Checklist<a class=anchor href=#testing-micro-benchmark></a></h2><div class=sectionbody><div class=paragraph><p>This section contains hints for doing proper micro-benchmarking on FreeBSD or of FreeBSD itself.</p></div><div class=paragraph><p>It is not possible to use all of the suggestions below every single time, but the more used, the better the benchmark’s ability to test small differences will be.</p></div><div class=ulist><ul><li><p>Disable APM and any other kind of clock fiddling (ACPI ?).</p></li><li><p>Run in single user mode. E.g., <a href="https://man.freebsd.org/cgi/man.cgi?query=cron&amp;sektion=8&amp;format=html">cron(8)</a>, and other daemons only add noise. The <a href="https://man.freebsd.org/cgi/man.cgi?query=sshd&amp;sektion=8&amp;format=html">sshd(8)</a> daemon can also cause problems. If ssh access is required during testing either disable the SSHv1 key regeneration, or kill the parent <code>sshd</code> daemon during the tests.</p></li><li><p>Do not run <a href="https://man.freebsd.org/cgi/man.cgi?query=ntpd&amp;sektion=8&amp;format=html">ntpd(8)</a>.</p></li><li><p>If <a href="https://man.freebsd.org/cgi/man.cgi?query=syslog&amp;sektion=3&amp;format=html">syslog(3)</a> events are generated, run <a href="https://man.freebsd.org/cgi/man.cgi?query=syslogd&amp;sektion=8&amp;format=html">syslogd(8)</a> with an empty <span class=filename>/etc/syslogd.conf</span>, otherwise, do not run it.</p></li><li><p>Minimize disk-I/O, avoid it entirely if possible.</p></li><li><p>Do not mount file systems that are not needed.</p></li><li><p>Mount <span class=filename>/</span>, <span class=filename>/usr</span>, and any other file system as read-only if possible. This removes atime updates to disk (etc.) from the I/O picture.</p></li><li><p>Reinitialize the read/write test file system with <a href="https://man.freebsd.org/cgi/man.cgi?query=newfs&amp;sektion=8&amp;format=html">newfs(8)</a> and populate it from a <a href="https://man.freebsd.org/cgi/man.cgi?query=tar&amp;sektion=1&amp;format=html">tar(1)</a> or <a href="https://man.freebsd.org/cgi/man.cgi?query=dump&amp;sektion=8&amp;format=html">dump(8)</a> file before every run. Unmount and mount it before starting the test. This results in a consistent file system layout. For a worldstone test this would apply to <span class=filename>/usr/obj</span> (just reinitialize with <code>newfs</code> and mount). To get 100% reproducibility, populate the file system from a <a href="https://man.freebsd.org/cgi/man.cgi?query=dd&amp;sektion=1&amp;format=html">dd(1)</a> file (i.e.: <code>dd if=myimage of=/dev/ad0s1h bs=1m</code>)</p></li><li><p>Use malloc backed or preloaded <a href="https://man.freebsd.org/cgi/man.cgi?query=md&amp;sektion=4&amp;format=html">md(4)</a> partitions.</p></li><li><p>Reboot between individual iterations of the test, this gives a more consistent state.</p></li><li><p>Remove all non-essential device drivers from the kernel. For instance if USB is not needed for the test, do not put USB in the kernel. Drivers which attach often have timeouts ticking away.</p></li><li><p>Unconfigure hardware that are not in use. Detach disks with <a href="https://man.freebsd.org/cgi/man.cgi?query=atacontrol&amp;sektion=8&amp;format=html">atacontrol(8)</a> and <a href="https://man.freebsd.org/cgi/man.cgi?query=camcontrol&amp;sektion=8&amp;format=html">camcontrol(8)</a> if the disks are not used for the test.</p></li><li><p>Do not configure the network unless it is being tested, or wait until after the test has been performed to ship the results off to another computer.</p></li><li><p>Disable "Turbo-modes" because they make the clock frequency explicitly depend on the environment. This means that benchmark runs on 100% identical
code, may depend on time of day, coffee vs. soda or even how many other people are in the office.</p></li></ul></div><div class=paragraph><p>If the system must be connected to a public network, watch out for spikes of broadcast traffic. Even though it is hardly noticeable, it will take up CPU cycles. Multicast has similar caveats.
* Put each file system on its own disk. This minimizes jitter from head-seek optimizations.
* Minimize output to serial or VGA consoles. Running output into files gives less jitter. (Serial consoles easily become a bottleneck.) Do not touch keyboard while the test is running, even <kbd>space</kbd> or <kbd>back-space</kbd> shows up in the numbers.
* Make sure the test is long enough, but not too long. If the test is too short, timestamping is a problem. If it is too long temperature changes and drift will affect the frequency of the quartz crystals in the computer. Rule of thumb: more than a minute, less than an hour.
* Try to keep the temperature as stable as possible around the machine. This affects both quartz crystals and disk drive algorithms. To get real stable clock, consider stabilized clock injection. E.g., get a OCXO + PLL, inject output into clock circuits instead of motherboard xtal. Contact Poul-Henning Kamp &lt;<a href=mailto:phk@FreeBSD.org>phk@FreeBSD.org</a>> for more information about this.
* Run the test at least 3 times but it is better to run more than 20 times both for "before" and "after" code. Try to interleave if possible (i.e.: do not run 20 times before then 20 times after), this makes it possible to spot environmental effects. Do not interleave 1:1, but 3:3, this makes it possible to spot interaction effects.</p></div><div class=paragraph><p>+
A good pattern is: <code>bababa{bbbaaa}*</code>.
This gives hint after the first 1+1 runs (so it is possible to stop the test if it goes entirely the wrong way), a standard deviation after the first 3+3 (gives a good indication if it is going to be worth a long run) and trending and interaction numbers later on.
* Use <a href="https://man.freebsd.org/cgi/man.cgi?query=ministat&amp;sektion=1&amp;format=html">ministat(1)</a> to see if the numbers are significant. Consider buying "Cartoon guide to statistics" ISBN: 0062731025, highly recommended, if you have forgotten or never learned about standard deviation and Student’s T.
* Do not use background <a href="https://man.freebsd.org/cgi/man.cgi?query=fsck&amp;sektion=8&amp;format=html">fsck(8)</a> unless the test is a benchmark of background <code>fsck</code>. Also, disable <code>background_fsck</code> in <span class=filename>/etc/rc.conf</span> unless the benchmark is not started at least 60+"<code>fsck</code> runtime" seconds after the boot, as <a href="https://man.freebsd.org/cgi/man.cgi?query=rc&amp;sektion=8&amp;format=html">rc(8)</a> wakes up and checks if <code>fsck</code> needs to run on any file systems when background <code>fsck</code> is enabled. Likewise, make sure there are no snapshots lying around unless the benchmark is a test with snapshots.
* If the benchmark show unexpected bad performance, check for things like high interrupt volume from an unexpected source. Some versions of ACPI have been reported to "misbehave" and generate excess interrupts. To help diagnose odd test results, take a few snapshots of <code>vmstat -i</code> and look for anything unusual.
* Make sure to be careful about optimization parameters for kernel and userspace, likewise debugging. It is easy to let something slip through and realize later the test was not comparing the same thing.
* Do not ever benchmark with the <code>WITNESS</code> and <code>INVARIANTS</code> kernel options enabled unless the test is interested to benchmarking those features. <code>WITNESS</code> can cause 400%+ drops in performance. Likewise, userspace <a href="https://man.freebsd.org/cgi/man.cgi?query=malloc&amp;sektion=3&amp;format=html">malloc(3)</a> parameters default differently in -CURRENT from the way they ship in production releases.</p></div></div></div><div class=sect1><h2 id=testing-tinderbox>6.2. The FreeBSD Source Tinderbox<a class=anchor href=#testing-tinderbox></a></h2><div class=sectionbody><div class=paragraph><p>The source Tinderbox consists of:</p></div><div class=ulist><ul><li><p>A build script, <span class=filename>tinderbox</span>, that automates checking out a specific version of the FreeBSD source tree and building it.</p></li><li><p>A supervisor script, <span class=filename>tbmaster</span>, that monitors individual Tinderbox instances, logs their output, and emails failure notices.</p></li><li><p>A CGI script named <span class=filename>index.cgi</span> that reads a set of tbmaster logs and presents an easy-to-read HTML summary of them.</p></li><li><p>A set of build servers that continually test the tip of the most important FreeBSD code branches.</p></li><li><p>A webserver that keeps a complete set of Tinderbox logs and displays an up-to-date summary.</p></li></ul></div><div class=paragraph><p>The scripts are maintained and were developed by Dag-Erling Smørgrav &lt;<a href=mailto:des@FreeBSD.org>des@FreeBSD.org</a>>, and are now written in Perl, a move on from their original incarnation as shell scripts.
All scripts and configuration files are kept in <a href=https://www.freebsd.org/cgi/cvsweb.cgi/projects/tinderbox/>/projects/tinderbox/</a>.</p></div><div class=paragraph><p>For more information about the tinderbox and tbmaster scripts at this stage, see their respective man pages: tinderbox(1) and tbmaster(1).</p></div></div></div><div class=sect1><h2 id=_the_index_cgi_script>6.3. The index.cgi Script<a class=anchor href=#_the_index_cgi_script></a></h2><div class=sectionbody><div class=paragraph><p>The <span class=filename>index.cgi</span> script generates the HTML summary of tinderbox and tbmaster logs.
Although originally intended to be used as a CGI script, as indicated by its name,
this script can also be run from the command line or from a <a href="https://man.freebsd.org/cgi/man.cgi?query=cron&amp;sektion=8&amp;format=html">cron(8)</a> job, in which case it will look for logs in the directory where the script is located.
It will automatically detect context, generating HTTP headers when it is run as a CGI script.
It conforms to XHTML standards and is styled using CSS.</p></div><div class=paragraph><p>The script starts in the <code>main()</code> block by attempting to verify that it is running on the official Tinderbox website.
If it is not, a page indicating it is not an official website is produced, and a URL to the official site is provided.</p></div><div class=paragraph><p>Next, it scans the log directory to get an inventory of configurations, branches and architectures for which log files exist, to avoid hard-coding a list into the script and potentially ending up with blank rows or columns.
This information is derived from the names of the log files matching the following pattern:</p></div><div class="literalblock programlisting"><div class=content><pre>tinderbox-$config-$branch-$arch-$machine.{brief,full}</pre></div></div><div class=paragraph><p>The configurations used on the official Tinderbox build servers are named for the branches they build.
For example, the <code>releng_8</code> configuration is used to build <code>RELENG_8</code> as well as all still-supported release branches.</p></div><div class=paragraph><p>Once all of this startup procedure has been successfully completed, <code>do_config()</code> is called for each configuration.</p></div><div class=paragraph><p>The <code>do_config()</code> function generates HTML for a single Tinderbox configuration.</p></div><div class=paragraph><p>It works by first generating a header row, then iterating over each branch build with the specified configuration,
producing a single row of results for each in the following manner:</p></div><div class=ulist><ul><li><p>For each item:</p><div class=ulist><ul><li><p>For each machine within that architecture:</p><div class=ulist><ul><li><p>If a brief log file exists, then:</p><div class=ulist><ul><li><p>Call <code>success()</code> to determine the outcome of the build.</p></li><li><p>Output the modification size.</p></li><li><p>Output the size of the brief log file with a link to the log file itself.</p></li><li><p>If a full log file also exists, then:</p><div class=ulist><ul><li><p>Output the size of the full log file with a link to the log file itself.</p></li></ul></div></li></ul></div></li><li><p>Otherwise:</p><div class=ulist><ul><li><p>No output.</p></li></ul></div></li></ul></div></li></ul></div></li></ul></div><div class=paragraph><p>The <code>success()</code> function mentioned above scans a brief log file for the string "tinderbox run completed" in order to determine whether the build was successful.</p></div><div class=paragraph><p>Configurations and branches are sorted according to their branch rank.
This is computed as follows:</p></div><div class=ulist><ul><li><p><code>HEAD</code> and <code>CURRENT</code> have rank 9999.</p></li><li><p><code>RELENG_x</code> has rank <em><code>xx</code></em>99.</p></li><li><p><code>RELENG_x_y</code> has rank <em>xxyy</em>.</p></li></ul></div><div class=paragraph><p>This means that <code>HEAD</code> always ranks highest, and <code>RELENG</code> branches are ranked in numerical order, with each <code>STABLE</code> branch ranking higher than the release branches forked off of it.
For instance, for FreeBSD 8, the order from highest to lowest would be:</p></div><div class=ulist><ul><li><p><code>RELENG_8</code> (branch rank 899).</p></li><li><p><code>RELENG_8_3</code> (branch rank 803).</p></li><li><p><code>RELENG_8_2</code> (branch rank 802).</p></li><li><p><code>RELENG_8_1</code> (branch rank 801).</p></li><li><p><code>RELENG_8_0</code> (branch rank 800).</p></li></ul></div><div class=paragraph><p>The colors that Tinderbox uses for each cell in the table are defined by CSS.
Successful builds are displayed with green text; unsuccessful builds are displayed with red text.
The color fades as time passes since the corresponding build, with every half an hour bringing the color closer to grey.</p></div></div></div><div class=sect1><h2 id=_official_build_servers>6.4. Official Build Servers<a class=anchor href=#_official_build_servers></a></h2><div class=sectionbody><div class=paragraph><p>The official Tinderbox build servers are hosted by <a href=http://www.sentex.ca>Sentex Data Communications</a>, who also host the FreeBSD Netperf Cluster.</p></div><div class=paragraph><p>Three build servers currently exist:</p></div><div class=paragraph><p><em>freebsd-current.sentex.ca</em> builds:</p></div><div class=ulist><ul><li><p><code>HEAD</code> for amd64, arm, i386, i386/pc98, ia64, mips, powerpc, powerpc64, and sparc64.</p></li><li><p><code>RELENG_9</code> and supported 9.<em>X</em> branches for amd64, arm, i386, i386/pc98, ia64, mips, powerpc, powerpc64, and sparc64.</p></li></ul></div><div class=paragraph><p><em>freebsd-stable.sentex.ca</em> builds:</p></div><div class=ulist><ul><li><p><code>RELENG_8</code> and supported 8.<em>X</em> branches for amd64, i386, i386/pc98, ia64, mips, powerpc and sparc64.</p></li></ul></div><div class=paragraph><p><em>freebsd-legacy.sentex.ca</em> builds:</p></div><div class=ulist><ul><li><p><code>RELENG_7</code> and supported 7.<em>X</em> branches for amd64, i386, i386/pc98, ia64, powerpc, and sparc64.</p></li></ul></div></div></div><div class=sect1><h2 id=_official_summary_site>6.5. Official Summary Site<a class=anchor href=#_official_summary_site></a></h2><div class=sectionbody><div class=paragraph><p>Summaries and logs from the official build servers are available online at <a href=http://tinderbox.FreeBSD.org>http://tinderbox.FreeBSD.org</a>, hosted by Dag-Erling Smørgrav &lt;<a href=mailto:des@FreeBSD.org>des@FreeBSD.org</a>> and set up as follows:</p></div><div class=ulist><ul><li><p>A <a href="https://man.freebsd.org/cgi/man.cgi?query=cron&amp;sektion=8&amp;format=html">cron(8)</a> job checks the build servers at regular intervals and downloads any new log files using <a href="https://man.freebsd.org/cgi/man.cgi?query=rsync&amp;sektion=1&amp;format=html">rsync(1)</a>.</p></li><li><p>Apache is set up to use <span class=filename>index.cgi</span> as <code>DirectoryIndex</code>.</p></li></ul></div></div></div></div><hr><div class=last-modified><p><strong>Last modified on</strong>: May 29, 2024 by <a href="https://cgit.freebsd.org/doc/commit/?id=fd25efa62a" target=_blank>Benedict Reuschling</a></p></div><div class=buttons><div class=prev><i class="fa fa-angle-left" aria-hidden=true title=Prev></i><div class=container><a href=https://docs.freebsd.org/en/books/developers-handbook/policies class=direction>Prev</a></div></div><div class=home><i class="fa fa-home" aria-hidden=true title=Home></i><div class=container><a href=../ class=direction>Home</a></div></div><div class=next><div class=container><a href=https://docs.freebsd.org/en/books/developers-handbook/partii class=direction>Next</a></div><i class="fa fa-angle-right" aria-hidden=true title=Next></i></div></div><label class="hidden book-menu-overlay" for=menu-control></label></div><aside class=toc><div class=toc-content><h3>Table of Contents</h3><nav id=TableOfContents><ul><li><a href=#testing-micro-benchmark>6.1. Micro Benchmark Checklist</a></li><li><a href=#testing-tinderbox>6.2. The FreeBSD Source Tinderbox</a></li><li><a href=#_the_index_cgi_script>6.3. The index.cgi Script</a></li><li><a href=#_official_build_servers>6.4. Official Build Servers</a></li><li><a href=#_official_summary_site>6.5. Official Summary Site</a></li></ul></nav><hr><div class=resources><h3>Resources</h3><ul class=contents><li><i class="fa fa-file-pdf-o" aria-hidden=true title="Download PDF"></i><a href=https://download.freebsd.org/doc/en/books/developers-handbook/developers-handbook_en.pdf>Download PDF</a></li><li><i class="fa fa-pencil-square-o" aria-hidden=true title="Edit this page"></i><a href=https://github.com/freebsd/freebsd-doc/blob/main/documentation/content/en/_index target=_blank>Edit this page</a></li></ul></div></div></aside><a class=to-top href=#top><i class="fa fa-arrow-circle-up" aria-hidden=true></i></a></main><footer><div class=footer-container><section class=logo-column><img src=https://docs.freebsd.org/images/FreeBSD-colors.svg width=160 height=50 alt="FreeBSD logo"><div class=options-container><div class=language-container><a id=languages href=https://docs.freebsd.org/en/languages><img src=https://docs.freebsd.org/images/language.png class=language-image alt="Choose language">
<span>English</span></a></div><div class=theme-container><select id=theme-chooser><option value=theme-system>System</option><option value=theme-light>Light</option><option value=theme-dark>Dark</option><option value=theme-high-contrast>High contrast</option></select></div></div></section><section class=about-column><h3 class=column-title>About</h3><ul class=column-elements-container><li><a href=https://www.freebsd.org/about/ target=_blank class=column-element>FreeBSD</a></li><li><a href=https://freebsdfoundation.org/ target=_blank class=column-element>FreeBSD Foundation</a></li><li><a href=https://www.freebsd.org/where/ target=_blank class=column-element>Get FreeBSD</a></li><li><a href=https://www.freebsd.org/internal/code-of-conduct target=_blank class=column-element>Code of Conduct</a></li><li><a href=https://www.freebsd.org/security/ target=_blank class=column-element>Security Advisories</a></li></ul></section><section class=documentation-column><h3 class=column-title>Documentation</h3><ul class=column-elements-container><li><a href=/en class=column-element>Documentation portal</a></li><li><a href=https://man.FreeBSD.org target=_blank class=column-element>Manual pages</a></li><li><a href=https://papers.FreeBSD.org target=_blank class=column-element>Presentations and papers</a></li><li><a href=https://docs-archive.freebsd.org/doc/ target=_blank class=column-element>Previous versions</a></li><li><a href=https://docs-archive.freebsd.org/44doc/ target=_blank class=column-element>4.4BSD Documents</a></li><li><a href=https://wiki.freebsd.org/ target=_blank class=column-element>Wiki</a></li></ul></section><section class=community-column><h3 class=column-title>Community</h3><ul class=column-elements-container><li><a href=https://docs.freebsd.org/en/articles/contributing class=column-element>Get involved</a></li><li><a href=https://forums.freebsd.org/ target=_blank class=column-element>Community forum</a></li><li><a href=https://lists.freebsd.org/ target=_blank class=column-element>Mailing lists</a></li><li><a href=https://wiki.freebsd.org/IRC/Channels target=_blank class=column-element>IRC Channels</a></li><li><a href=https://bugs.freebsd.org/bugzilla/ target=_blank class=column-element>Bug Tracker</a></li></ul></section><section class=legal-column><h3 class=column-title>Legal</h3><ul class=column-elements-container><li><a href=https://freebsdfoundation.org/donate/ target=_blank class=column-element>Donations</a></li><li><a href=https://www.freebsd.org/copyright/freebsd-license/ target=_blank class=column-element>Licensing</a></li><li><a href=https://www.freebsd.org/privacy/ target=_blank class=column-element>Privacy Policy</a></li><li><a href=https://www.freebsd.org/copyright/ target=_blank class=column-element>Legal notices</a></li></ul></section><section class=copyright-column><p>&copy; 1994-2024 The FreeBSD Project. All rights reserved</p><span>Made with <span class=heart>♥</span> by the FreeBSD Community</span></section></div></footer></body></html>