<!doctype html><html class=theme-light lang=pt-br><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content><meta name=keywords content><meta name=copyright content="1995-2024 The FreeBSD Foundation"><link rel=canonical href=https://docs.freebsd.org/pt-br/books/handbook/security/><title>Capítulo 13. Segurança | FreeBSD Documentation Portal</title>
<meta name=theme-color content="#790000"><meta name=color-scheme content="system light dark high-contrast"><link rel="shortcut icon" href=https://docs.freebsd.org/favicon.ico><link rel=stylesheet href=https://docs.freebsd.org/styles/main.min.css><link rel=stylesheet href=https://docs.freebsd.org/css/font-awesome-min.css><script defer src=/js/theme-chooser.min.js></script><script defer src=/js/copy-clipboard.min.js></script><script defer src=/js/search.min.js></script><meta name=twitter:card content="summary"><meta name=twitter:domain content="docs.FreeBSD.org"><meta name=twitter:site content="@freebsd"><meta name=twitter:url content="https://twitter.com/freebsd"><meta property="og:title" content="Capítulo 13. Segurança"><meta property="og:description" content><meta property="og:type" content="website"><meta property="og:image" content="https://docs.freebsd.org/favicon.ico"><meta property="og:image:alt" content="FreeBSD Logo"><meta property="og:locale" content="pt-br"><meta property="og:url" content="https://docs.freebsd.org/pt-br/books/handbook/security/"><meta property="og:site_name" content="FreeBSD Documentation Portal"><script type=application/ld+json>{"@context":"http://schema.org","@type":"Article","url":"https:\/\/docs.freebsd.org\/pt-br\/books\/handbook\/security\/","name":"FreeBSD Documentation Portal","headline":"FreeBSD Documentation Portal","description":"FreeBSD Documentation Portal"}</script></head><body><header><div class=header-container><div class=logo-menu-bars-container><a href=https://www.FreeBSD.org class=logo><img src=https://docs.freebsd.org/images/FreeBSD-monochromatic.svg width=160 height=50 alt="FreeBSD logo">
</a><label class=menu-bars for=menu-bars><i class="fa fa-bars" aria-hidden=true></i></label></div><input id=menu-bars type=checkbox><nav><ul class=menu><li class=menu-item><input id=about type=checkbox>
<a href=# aria-label="Navigate to About section"><label class=menu-item-description for=about>About
<i class="fa fa-angle-down fa-lg" aria-hidden=true></i></label></a><ul class=sub-menu><li class=title><a href=https://www.freebsd.org/about/ target=_blank>About</a></li><li><a href=https://www.freebsd.org/about/ target=_blank>FreeBSD</a></li><li><a href=https://freebsdfoundation.org/about-us/about-the-foundation/ target=_blank>FreeBSD Foundation</a></li><li><a href=https://www.freebsd.org/internal/code-of-conduct/ target=_blank>Code of Conduct</a></li></ul></li><li class=menu-item><input id=download type=checkbox>
<a href=# aria-label="Navigate to get FreeBSD section"><label class=menu-item-description for=download>Get FreeBSD
<i class="fa fa-angle-down fa-lg" aria-hidden=true></i></label></a><ul class=sub-menu><li class=title><a href=https://www.freebsd.org/where/ target=_blank>Get FreeBSD</a></li><li><a href=https://www.freebsd.org/releases/ target=_blank>Release Information</a></li><li><a href=https://www.freebsd.org/releng/ target=_blank>Release Engineering</a></li><li><a href=https://www.freebsd.org/security/ target=_blank>Security Advisories</a></li></ul></li><li class=menu-item><input id=documentation type=checkbox>
<a href=# aria-label="Navigate to get Documentation section"><label class=menu-item-description for=documentation>Documentation
<i class="fa fa-angle-down fa-lg" aria-hidden=true></i></label></a><ul class=sub-menu><li class=title><a href=/pt-br>Documentation portal</a></li><li><a href=https://docs.freebsd.org/pt-br/books/handbook>FreeBSD Handbook</a></li><li><a href=https://docs.freebsd.org/pt-br/books/porters-handbook>Porter's Handbook</a></li><li><a href=https://docs.FreeBSD.org/en/books/fdp-primer>Documentation Project Handbook</a></li><li><a href=https://man.FreeBSD.org target=_blank>Manual pages</a></li><li><a href=https://papers.FreeBSD.org target=_blank>Presentations and papers</a></li><li><a href=https://wiki.FreeBSD.org target=_blank>Wiki</a></li><li><a href=https://docs.freebsd.org/pt-br/books>Books</a></li><li><a href=https://docs.freebsd.org/pt-br/articles>Articles</a></li></ul></li><li class=menu-item><input id=community type=checkbox>
<a href=# aria-label="Navigate to get Community section"><label class=menu-item-description for=community>Community
<i class="fa fa-angle-down fa-lg" aria-hidden=true></i></label></a><ul class=sub-menu><li class=title><a href=https://www.freebsd.org/community/>Community</a></li><li><a href=https://docs.freebsd.org/pt-br/articles/contributing>Get involved</a></li><li><a href=https://forums.freebsd.org/ target=_blank>Forum</a></li><li><a href=https://lists.freebsd.org/ target=_blank>Mailing lists</a></li><li><a href=https://wiki.freebsd.org/IRC/Channels target=_blank>IRC Channels</a></li><li><a href=https://bugs.freebsd.org/bugzilla/ target=_blank>Bug Tracker</a></li><li><a href=https://www.freebsd.org/support/ target=_blank>Support</a></li></ul></li></ul></nav><div class=search-donate-container><form class=search method=get id=search-header-form action=https://docs.freebsd.org/search name=search-header-form><input type=hidden name=DB value=pt-br>
<input id=words name=P type=text size=20 maxlength=255>
<button>
<i class="fa fa-search" aria-hidden=true></i></button></form><div class=donate><a href=https://freebsdfoundation.org/donate/ target=_blank><span class=heart>♥</span>
Donate</a></div></div></div></header><input type=checkbox class="hidden toggle" id=menu-control><main class=main-wrapper-book><a id=top></a><aside class=book-menu><div class=book-menu-content><input id=search-book type=text placeholder=Pesquisar aria-label=Pesquisar maxlength=128><nav id=MenuContents><ul><li><input type=checkbox id=chapter-eb2a98ce203d8afd517726e6d8776be3 class=toggle>
<label class="icon cursor" for=chapter-eb2a98ce203d8afd517726e6d8776be3><a role=button></a></label><a href=https://docs.freebsd.org/pt-br/books/handbook/preface/>Prefácio</a><ul><li><a href=https://docs.freebsd.org/pt-br/books/handbook/preface/#preface-audience>Audiência Pretendida</a></li><li><a href=https://docs.freebsd.org/pt-br/books/handbook/preface/#preface-changes-from3>Mudanças desde a Terceira Edição</a></li><li><a href=https://docs.freebsd.org/pt-br/books/handbook/preface/#preface-changes-from2>Mudanças desde a Segunda Edição (2004)</a></li><li><a href=https://docs.freebsd.org/pt-br/books/handbook/preface/#preface-changes>Mudanças desde a Primeira Edição (2001)</a></li><li><a href=https://docs.freebsd.org/pt-br/books/handbook/preface/#preface-overview>Organização deste Livro</a></li><li><a href=https://docs.freebsd.org/pt-br/books/handbook/preface/#preface-conv>Convenções utilizadas neste livro</a></li><li><a href=https://docs.freebsd.org/pt-br/books/handbook/preface/#preface-acknowledgements>Agradecimentos</a></li></ul></li><li><input type=checkbox id=chapter-14a525fce014b90b8a458a894818255a class=toggle>
<label for=chapter-14a525fce014b90b8a458a894818255a><a role=button></a></label><a href=https://docs.freebsd.org/pt-br/books/handbook/parti/>Parte I. Primeiros Passos</a></li><li><input type=checkbox id=chapter-f9c9f3451644df30d224350da97d5da6 class=toggle>
<label class="icon cursor" for=chapter-f9c9f3451644df30d224350da97d5da6><a role=button></a></label><a href=https://docs.freebsd.org/pt-br/books/handbook/introduction/>Capítulo 1. Introdução</a><ul><li><a href=https://docs.freebsd.org/pt-br/books/handbook/introduction/#introduction-synopsis>1.1. Sinopse</a></li><li><a href=https://docs.freebsd.org/pt-br/books/handbook/introduction/#nutshell>1.2. Bem vindo ao FreeBSD!</a></li><li><a href=https://docs.freebsd.org/pt-br/books/handbook/introduction/#history>1.3. Sobre o Projeto FreeBSD</a></li></ul></li><li><input type=checkbox id=chapter-f693a3fa687a72d63ec8129ee302d664 class=toggle>
<label class="icon cursor" for=chapter-f693a3fa687a72d63ec8129ee302d664><a role=button></a></label><a href=https://docs.freebsd.org/pt-br/books/handbook/bsdinstall/>Capítulo 2. Instalando o FreeBSD</a><ul><li><a href=https://docs.freebsd.org/pt-br/books/handbook/bsdinstall/#bsdinstall-synopsis>2.1. Sinopse</a></li><li><a href=https://docs.freebsd.org/pt-br/books/handbook/bsdinstall/#bsdinstall-hardware>2.2. Requisitos mínimos de hardware</a></li><li><a href=https://docs.freebsd.org/pt-br/books/handbook/bsdinstall/#bsdinstall-pre>2.3. Tarefas de Pré-instalação</a></li><li><a href=https://docs.freebsd.org/pt-br/books/handbook/bsdinstall/#bsdinstall-start>2.4. Iniciando a instalação</a></li><li><a href=https://docs.freebsd.org/pt-br/books/handbook/bsdinstall/#using-bsdinstall>2.5. Usando o bsdinstall</a></li><li><a href=https://docs.freebsd.org/pt-br/books/handbook/bsdinstall/#bsdinstall-partitioning>2.6. Alocando o espaço em disco</a></li><li><a href=https://docs.freebsd.org/pt-br/books/handbook/bsdinstall/#bsdinstall-fetching-distribution>2.7. Fazendo o download dos arquivos de distribuição</a></li><li><a href=https://docs.freebsd.org/pt-br/books/handbook/bsdinstall/#bsdinstall-post>2.8. Contas, Time Zone, Serviços e Hardening</a></li><li><a href=https://docs.freebsd.org/pt-br/books/handbook/bsdinstall/#bsdinstall-network>2.9. Interfaces de Rede</a></li><li><a href=https://docs.freebsd.org/pt-br/books/handbook/bsdinstall/#bsdinstall-install-trouble>2.10. Solução de problemas</a></li><li><a href=https://docs.freebsd.org/pt-br/books/handbook/bsdinstall/#using-live-cd>2.11. Usando o Live CD</a></li></ul></li><li><input type=checkbox id=chapter-9f6db261075f578742036fcc6000eecd class=toggle>
<label class="icon cursor" for=chapter-9f6db261075f578742036fcc6000eecd><a role=button></a></label><a href=https://docs.freebsd.org/pt-br/books/handbook/basics/>Capítulo 3. Fundamentos do FreeBSD</a><ul><li><a href=https://docs.freebsd.org/pt-br/books/handbook/basics/#basics-synopsis>3.1. Sinopse</a></li><li><a href=https://docs.freebsd.org/pt-br/books/handbook/basics/#consoles>3.2. Consoles e Terminais Virtuais</a></li><li><a href=https://docs.freebsd.org/pt-br/books/handbook/basics/#users-synopsis>3.3. Usuários e Gerenciamento Básico de Contas</a></li><li><a href=https://docs.freebsd.org/pt-br/books/handbook/basics/#permissions>3.4. Permissões</a></li><li><a href=https://docs.freebsd.org/pt-br/books/handbook/basics/#dirstructure>3.5. Estrutura de Diretórios</a></li><li><a href=https://docs.freebsd.org/pt-br/books/handbook/basics/#disk-organization>3.6. Organização dos Discos</a></li><li><a href=https://docs.freebsd.org/pt-br/books/handbook/basics/#mount-unmount>3.7. Montando e Desmontando Sistemas de Arquivos</a></li><li><a href=https://docs.freebsd.org/pt-br/books/handbook/basics/#basics-processes>3.8. Processos e Daemons</a></li><li><a href=https://docs.freebsd.org/pt-br/books/handbook/basics/#shells>3.9. Shells</a></li><li><a href=https://docs.freebsd.org/pt-br/books/handbook/basics/#editors>3.10. Editores de Texto</a></li><li><a href=https://docs.freebsd.org/pt-br/books/handbook/basics/#basics-devices>3.11. Dispositivos e nós de dispositivos</a></li><li><a href=https://docs.freebsd.org/pt-br/books/handbook/basics/#basics-more-information>3.12. Páginas de Manual</a></li></ul></li><li><input type=checkbox id=chapter-01c5707e95d14c0ff84bf62600c958d1 class=toggle>
<label class="icon cursor" for=chapter-01c5707e95d14c0ff84bf62600c958d1><a role=button></a></label><a href=https://docs.freebsd.org/pt-br/books/handbook/ports/>Capítulo 4. Instalando Aplicativos: Pacotes e Ports</a><ul><li><a href=https://docs.freebsd.org/pt-br/books/handbook/ports/#ports-synopsis>4.1. Sinopse</a></li><li><a href=https://docs.freebsd.org/pt-br/books/handbook/ports/#ports-overview>4.2. Visão geral sobre a Instalação de Software</a></li><li><a href=https://docs.freebsd.org/pt-br/books/handbook/ports/#ports-finding-applications>4.3. Encontrando Software</a></li><li><a href=https://docs.freebsd.org/pt-br/books/handbook/ports/#pkgng-intro>4.4. Usando o pkg para o gerenciamento de pacotes binários</a></li><li><a href=https://docs.freebsd.org/pt-br/books/handbook/ports/#ports-using>4.5. Usando a Coleção de Ports</a></li><li><a href=https://docs.freebsd.org/pt-br/books/handbook/ports/#ports-poudriere>4.6. Compilando Pacotes com o Poudriere</a></li><li><a href=https://docs.freebsd.org/pt-br/books/handbook/ports/#ports-nextsteps>4.7. Considerações pós-instalação</a></li><li><a href=https://docs.freebsd.org/pt-br/books/handbook/ports/#ports-broken>4.8. Lidando com ports quebrados</a></li></ul></li><li><input type=checkbox id=chapter-3405c00581365a8b5d16af70fe4d1b72 class=toggle>
<label class="icon cursor" for=chapter-3405c00581365a8b5d16af70fe4d1b72><a role=button></a></label><a href=https://docs.freebsd.org/pt-br/books/handbook/x11/>Capítulo 5. O sistema X Window</a><ul><li><a href=https://docs.freebsd.org/pt-br/books/handbook/x11/#x11-synopsis>5.1. Sinopse</a></li><li><a href=https://docs.freebsd.org/pt-br/books/handbook/x11/#x-understanding>5.2. Terminologia</a></li><li><a href=https://docs.freebsd.org/pt-br/books/handbook/x11/#x-install>5.3. Instalando o Xorg</a></li><li><a href=https://docs.freebsd.org/pt-br/books/handbook/x11/#x-config>5.4. Configuração do Xorg</a></li><li><a href=https://docs.freebsd.org/pt-br/books/handbook/x11/#x-fonts>5.5. Usando fontes no Xorg</a></li><li><a href=https://docs.freebsd.org/pt-br/books/handbook/x11/#x-xdm>5.6. O Gerenciador de Display X</a></li><li><a href=https://docs.freebsd.org/pt-br/books/handbook/x11/#x11-wm>5.7. Ambientes de desktop</a></li><li><a href=https://docs.freebsd.org/pt-br/books/handbook/x11/#x-compiz-fusion>5.8. Instalando o Compiz Fusion</a></li><li><a href=https://docs.freebsd.org/pt-br/books/handbook/x11/#x11-troubleshooting>5.9. Solução de problemas</a></li></ul></li><li><input type=checkbox id=chapter-0eab3565e8f59f5a8a896dfba7eb3680 class=toggle>
<label for=chapter-0eab3565e8f59f5a8a896dfba7eb3680><a role=button></a></label><a href=https://docs.freebsd.org/pt-br/books/handbook/partii/>Parte II. Tarefas comuns</a></li><li><input type=checkbox id=chapter-b33cf28993f3f7bf5baf036e79da0f39 class=toggle>
<label class="icon cursor" for=chapter-b33cf28993f3f7bf5baf036e79da0f39><a role=button></a></label><a href=https://docs.freebsd.org/pt-br/books/handbook/desktop/>Capítulo 6. Aplicações de Desktop</a><ul><li><a href=https://docs.freebsd.org/pt-br/books/handbook/desktop/#desktop-synopsis>6.1. Sinopse</a></li><li><a href=https://docs.freebsd.org/pt-br/books/handbook/desktop/#desktop-browsers>6.2. Navegadores</a></li><li><a href=https://docs.freebsd.org/pt-br/books/handbook/desktop/#desktop-productivity>6.3. Produtividade</a></li><li><a href=https://docs.freebsd.org/pt-br/books/handbook/desktop/#desktop-viewers>6.4. Visualizadores de Documentos</a></li><li><a href=https://docs.freebsd.org/pt-br/books/handbook/desktop/#desktop-finance>6.5. Finanças</a></li></ul></li><li><input type=checkbox id=chapter-152f694a19312ad72ec7bb4e1c3c33b2 class=toggle>
<label class="icon cursor" for=chapter-152f694a19312ad72ec7bb4e1c3c33b2><a role=button></a></label><a href=https://docs.freebsd.org/pt-br/books/handbook/multimedia/>Capítulo 7. Multimídia</a><ul><li><a href=https://docs.freebsd.org/pt-br/books/handbook/multimedia/#multimedia-synopsis>7.1. Sinopse</a></li><li><a href=https://docs.freebsd.org/pt-br/books/handbook/multimedia/#sound-setup>7.2. Configurando a Placa de Som</a></li><li><a href=https://docs.freebsd.org/pt-br/books/handbook/multimedia/#sound-mp3>7.3. Áudio MP3</a></li><li><a href=https://docs.freebsd.org/pt-br/books/handbook/multimedia/#video-playback>7.4. Reprodução de Vídeo</a></li><li><a href=https://docs.freebsd.org/pt-br/books/handbook/multimedia/#tvcard>7.5. Placas de TV</a></li><li><a href=https://docs.freebsd.org/pt-br/books/handbook/multimedia/#mythtv>7.6. MythTV</a></li><li><a href=https://docs.freebsd.org/pt-br/books/handbook/multimedia/#scanners>7.7. Scanners de Imagem</a></li></ul></li><li><input type=checkbox id=chapter-80888b4ee02e3e409e5f71cf97a36450 class=toggle>
<label class="icon cursor" for=chapter-80888b4ee02e3e409e5f71cf97a36450><a role=button></a></label><a href=https://docs.freebsd.org/pt-br/books/handbook/kernelconfig/>Capítulo 8. Configurando o kernel do FreeBSD</a><ul><li><a href=https://docs.freebsd.org/pt-br/books/handbook/kernelconfig/#kernelconfig-synopsis>8.1. Sinopse</a></li><li><a href=https://docs.freebsd.org/pt-br/books/handbook/kernelconfig/#kernelconfig-custom-kernel>8.2. Por que compilar um kernel personalizado?</a></li><li><a href=https://docs.freebsd.org/pt-br/books/handbook/kernelconfig/#kernelconfig-devices>8.3. Encontrando o hardware do sistema</a></li><li><a href=https://docs.freebsd.org/pt-br/books/handbook/kernelconfig/#kernelconfig-config>8.4. O Arquivo de Configuração</a></li><li><a href=https://docs.freebsd.org/pt-br/books/handbook/kernelconfig/#kernelconfig-building>8.5. Criando e Instalando um Kernel Customizado</a></li><li><a href=https://docs.freebsd.org/pt-br/books/handbook/kernelconfig/#kernelconfig-trouble>8.6. Se algo der errado</a></li></ul></li><li><input type=checkbox id=chapter-cb174c55879b17ab955f2f16989a79e0 class=toggle>
<label class="icon cursor" for=chapter-cb174c55879b17ab955f2f16989a79e0><a role=button></a></label><a href=https://docs.freebsd.org/pt-br/books/handbook/printing/>Capítulo 9. Impressão</a><ul><li><a href=https://docs.freebsd.org/pt-br/books/handbook/printing/#printing-quick-start>9.1. Inicio Rápido</a></li><li><a href=https://docs.freebsd.org/pt-br/books/handbook/printing/#printing-connections>9.2. Conexões de Impressora</a></li><li><a href=https://docs.freebsd.org/pt-br/books/handbook/printing/#printing-pdls>9.3. Linguagens de Descrição de Página Comuns</a></li><li><a href=https://docs.freebsd.org/pt-br/books/handbook/printing/#printing-direct>9.4. Impressão Direta</a></li><li><a href=https://docs.freebsd.org/pt-br/books/handbook/printing/#printing-lpd>9.5. LPD (Daemon de impressora de linha)</a></li><li><a href=https://docs.freebsd.org/pt-br/books/handbook/printing/#printing-other>9.6. Outros sistemas de impressão</a></li></ul></li><li><input type=checkbox id=chapter-c12b8c3f2a8fcefce87087241f695c83 class=toggle>
<label class="icon cursor" for=chapter-c12b8c3f2a8fcefce87087241f695c83><a role=button></a></label><a href=https://docs.freebsd.org/pt-br/books/handbook/linuxemu/>Capítulo 10. Compatibilidade binária com o Linux®</a><ul><li><a href=https://docs.freebsd.org/pt-br/books/handbook/linuxemu/#linuxemu-synopsis>10.1. Sinopse</a></li><li><a href=https://docs.freebsd.org/pt-br/books/handbook/linuxemu/#linuxemu-lbc-install>10.2. Configurando a compatibilidade binária com o Linux™</a></li><li><a href=https://docs.freebsd.org/pt-br/books/handbook/linuxemu/#linuxemu-advanced>10.3. Tópicos Avançados</a></li></ul></li><li><input type=checkbox id=chapter-03b11ba627b9a0c85b247f5641bde272 class=toggle>
<label for=chapter-03b11ba627b9a0c85b247f5641bde272><a role=button></a></label><a href=https://docs.freebsd.org/pt-br/books/handbook/partiii/>Parte III. Administração do Sistema</a></li><li><input type=checkbox id=chapter-6c31587f8d736319f099cd4dc1961301 class=toggle>
<label class="icon cursor" for=chapter-6c31587f8d736319f099cd4dc1961301><a role=button></a></label><a href=https://docs.freebsd.org/pt-br/books/handbook/config/>Capítulo 11. Configuração e Ajuste</a><ul><li><a href=https://docs.freebsd.org/pt-br/books/handbook/config/#config-synopsis>11.1. Sinopse</a></li><li><a href=https://docs.freebsd.org/pt-br/books/handbook/config/#configtuning-starting-services>11.2. Inicialização de Serviços</a></li><li><a href=https://docs.freebsd.org/pt-br/books/handbook/config/#configtuning-cron>11.3. Configurando o cron(8)</a></li><li><a href=https://docs.freebsd.org/pt-br/books/handbook/config/#configtuning-rcd>11.4. Gerenciando Serviços no FreeBSD</a></li><li><a href=https://docs.freebsd.org/pt-br/books/handbook/config/#config-network-setup>11.5. Configurando Placas de Interface de Rede</a></li><li><a href=https://docs.freebsd.org/pt-br/books/handbook/config/#configtuning-virtual-hosts>11.6. Hosts Virtuais</a></li><li><a href=https://docs.freebsd.org/pt-br/books/handbook/config/#configtuning-syslog>11.7. Configurando o log do sistema</a></li><li><a href=https://docs.freebsd.org/pt-br/books/handbook/config/#configtuning-configfiles>11.8. Arquivos de Configuração</a></li><li><a href=https://docs.freebsd.org/pt-br/books/handbook/config/#configtuning-sysctl>11.9. Efetuando ajustes com o sysctl(8)</a></li><li><a href=https://docs.freebsd.org/pt-br/books/handbook/config/#configtuning-disk>11.10. Otimização de Discos</a></li><li><a href=https://docs.freebsd.org/pt-br/books/handbook/config/#configtuning-kernel-limits>11.11. Ajustando os Limites do Kernel</a></li><li><a href=https://docs.freebsd.org/pt-br/books/handbook/config/#adding-swap-space>11.12. Adicionando Espaço de Swap</a></li><li><a href=https://docs.freebsd.org/pt-br/books/handbook/config/#acpi-overview>11.13. Gerenciamento de energia e recursos</a></li></ul></li><li><input type=checkbox id=chapter-459f0012b3b4f0b6b123010f029da5e4 class=toggle>
<label class="icon cursor" for=chapter-459f0012b3b4f0b6b123010f029da5e4><a role=button></a></label><a href=https://docs.freebsd.org/pt-br/books/handbook/boot/>Capítulo 12. O processo de inicialização do FreeBSD</a><ul><li><a href=https://docs.freebsd.org/pt-br/books/handbook/boot/#boot-synopsis>12.1. Sinopse</a></li><li><a href=https://docs.freebsd.org/pt-br/books/handbook/boot/#boot-introduction>12.2. Processo de Inicialização do FreeBSD</a></li><li><a href=https://docs.freebsd.org/pt-br/books/handbook/boot/#boot-splash>12.3. Configurando telas iniciais de inicialização</a></li><li><a href=https://docs.freebsd.org/pt-br/books/handbook/boot/#device-hints>12.4. Sugestões de dispositivos</a></li><li><a href=https://docs.freebsd.org/pt-br/books/handbook/boot/#boot-shutdown>12.5. Sequência de Desligamento</a></li></ul></li><li><input type=checkbox id=chapter-917c75fcffbb14d48ed6d0a48e7028f2 class=toggle checked>
<label class="icon cursor" for=chapter-917c75fcffbb14d48ed6d0a48e7028f2><a role=button></a></label><a href=https://docs.freebsd.org/pt-br/books/handbook/security/>Capítulo 13. Segurança</a><ul><li><a href=https://docs.freebsd.org/pt-br/books/handbook/security/#security-synopsis>13.1. Sinopse</a></li><li><a href=https://docs.freebsd.org/pt-br/books/handbook/security/#security-intro>13.2. Introdução</a></li><li><a href=https://docs.freebsd.org/pt-br/books/handbook/security/#one-time-passwords>13.3. Senhas de Uso Unico</a></li><li><a href=https://docs.freebsd.org/pt-br/books/handbook/security/#tcpwrappers>13.4. TCP Wrapper</a></li><li><a href=https://docs.freebsd.org/pt-br/books/handbook/security/#kerberos5>13.5. Kerberos</a></li><li><a href=https://docs.freebsd.org/pt-br/books/handbook/security/#openssl>13.6. OpenSSL</a></li><li><a href=https://docs.freebsd.org/pt-br/books/handbook/security/#ipsec>13.7. VPN Sobre IPsec</a></li><li><a href=https://docs.freebsd.org/pt-br/books/handbook/security/#openssh>13.8. OpenSSH</a></li><li><a href=https://docs.freebsd.org/pt-br/books/handbook/security/#fs-acl>13.9. Listas de Controle de Acesso</a></li><li><a href=https://docs.freebsd.org/pt-br/books/handbook/security/#security-pkg>13.10. Monitorando Problemas de Segurança de Terceiros</a></li><li><a href=https://docs.freebsd.org/pt-br/books/handbook/security/#security-advisories>13.11. Avisos de Segurança do FreeBSD</a></li><li><a href=https://docs.freebsd.org/pt-br/books/handbook/security/#security-accounting>13.12. Auditoria de Processo</a></li><li><a href=https://docs.freebsd.org/pt-br/books/handbook/security/#security-resourcelimits>13.13. Limites de Recursos</a></li><li><a href=https://docs.freebsd.org/pt-br/books/handbook/security/#security-sudo>13.14. Administração Compartilhada com Sudo</a></li></ul></li><li><input type=checkbox id=chapter-1a2a8e719703649c2c66d99aa7a25fd4 class=toggle>
<label class="icon cursor" for=chapter-1a2a8e719703649c2c66d99aa7a25fd4><a role=button></a></label><a href=https://docs.freebsd.org/pt-br/books/handbook/jails/>Capítulo 14. Jails</a><ul><li><a href=https://docs.freebsd.org/pt-br/books/handbook/jails/#jails-synopsis>14.1. Sinopse</a></li><li><a href=https://docs.freebsd.org/pt-br/books/handbook/jails/#jails-terms>14.2. Termos Relacionados à Jails</a></li><li><a href=https://docs.freebsd.org/pt-br/books/handbook/jails/#jails-build>14.3. Criando e Controlando Jails</a></li><li><a href=https://docs.freebsd.org/pt-br/books/handbook/jails/#jails-tuning>14.4. Tuning e Administração</a></li><li><a href=https://docs.freebsd.org/pt-br/books/handbook/jails/#jails-application>14.5. Atualizando Múltiplas Jails</a></li><li><a href=https://docs.freebsd.org/pt-br/books/handbook/jails/#jails-ezjail>14.6. Gerenciando Jails com o ezjail</a></li></ul></li><li><input type=checkbox id=chapter-8f4620c77e572cbb58917911a33c73cf class=toggle>
<label class="icon cursor" for=chapter-8f4620c77e572cbb58917911a33c73cf><a role=button></a></label><a href=https://docs.freebsd.org/pt-br/books/handbook/mac/>Capítulo 15. Controle de acesso obrigatório</a><ul><li><a href=https://docs.freebsd.org/pt-br/books/handbook/mac/#mac-synopsis>15.1. Sinopse</a></li><li><a href=https://docs.freebsd.org/pt-br/books/handbook/mac/#mac-inline-glossary>15.2. Termos chave</a></li><li><a href=https://docs.freebsd.org/pt-br/books/handbook/mac/#mac-understandlabel>15.3. Entendendo os rótulos MAC</a></li><li><a href=https://docs.freebsd.org/pt-br/books/handbook/mac/#mac-planning>15.4. Planejando a configuração de segurança</a></li><li><a href=https://docs.freebsd.org/pt-br/books/handbook/mac/#mac-policies>15.5. Políticas MAC Disponíveis</a></li><li><a href=https://docs.freebsd.org/pt-br/books/handbook/mac/#mac-userlocked>15.6. Bloqueio do Usuário</a></li><li><a href=https://docs.freebsd.org/pt-br/books/handbook/mac/#mac-implementing>15.7. Nagios em Jail MAC</a></li><li><a href=https://docs.freebsd.org/pt-br/books/handbook/mac/#mac-troubleshoot>15.8. Solução de problemas do framework MAC</a></li></ul></li><li><input type=checkbox id=chapter-9598d66a76cb3182057b6bcd775149a0 class=toggle>
<label class="icon cursor" for=chapter-9598d66a76cb3182057b6bcd775149a0><a role=button></a></label><a href=https://docs.freebsd.org/pt-br/books/handbook/audit/>Capítulo 16. Auditoria de Evento de Segurança</a><ul><li><a href=https://docs.freebsd.org/pt-br/books/handbook/audit/#audit-synopsis>16.1. Sinopse</a></li><li><a href=https://docs.freebsd.org/pt-br/books/handbook/audit/#audit-inline-glossary>16.2. Termos chave</a></li><li><a href=https://docs.freebsd.org/pt-br/books/handbook/audit/#audit-config>16.3. Configuração de Auditoria</a></li><li><a href=https://docs.freebsd.org/pt-br/books/handbook/audit/#audit-administration>16.4. Trabalhando com Trilhas de Auditoria</a></li></ul></li><li><input type=checkbox id=chapter-e1edcad13d9db6e8e4cb645d378ecfaf class=toggle>
<label class="icon cursor" for=chapter-e1edcad13d9db6e8e4cb645d378ecfaf><a role=button></a></label><a href=https://docs.freebsd.org/pt-br/books/handbook/disks/>Capítulo 17. Armazenamento</a><ul><li><a href=https://docs.freebsd.org/pt-br/books/handbook/disks/#disks-synopsis>17.1. Sinopse</a></li><li><a href=https://docs.freebsd.org/pt-br/books/handbook/disks/#disks-adding>17.2. Adicionando Discos</a></li><li><a href=https://docs.freebsd.org/pt-br/books/handbook/disks/#disks-growing>17.3. Redimensionando e Ampliando Discos</a></li><li><a href=https://docs.freebsd.org/pt-br/books/handbook/disks/#usb-disks>17.4. Dispositivos de Armazenamento USB</a></li><li><a href=https://docs.freebsd.org/pt-br/books/handbook/disks/#creating-cds>17.5. Criando e Usando Mídia em CD</a></li><li><a href=https://docs.freebsd.org/pt-br/books/handbook/disks/#creating-dvds>17.6. Criando e Usando Mídia de DVD</a></li><li><a href=https://docs.freebsd.org/pt-br/books/handbook/disks/#floppies>17.7. Criando e Usando Disquetes</a></li><li><a href=https://docs.freebsd.org/pt-br/books/handbook/disks/#backup-basics>17.8. Noções Básicas de Backup</a></li><li><a href=https://docs.freebsd.org/pt-br/books/handbook/disks/#disks-virtual>17.9. Discos de Memória</a></li><li><a href=https://docs.freebsd.org/pt-br/books/handbook/disks/#snapshots>17.10. Snapshots de Sistemas de Arquivos</a></li><li><a href=https://docs.freebsd.org/pt-br/books/handbook/disks/#quotas>17.11. Cotas de Disco</a></li><li><a href=https://docs.freebsd.org/pt-br/books/handbook/disks/#disks-encrypting>17.12. Criptografando Partições de Disco</a></li><li><a href=https://docs.freebsd.org/pt-br/books/handbook/disks/#swap-encrypting>17.13. Criptografando Swap</a></li><li><a href=https://docs.freebsd.org/pt-br/books/handbook/disks/#disks-hast>17.14. Alta Disponibilidade de Armazenamento (HAST)</a></li></ul></li><li><input type=checkbox id=chapter-dde37901a0e0ea32745b67607854900f class=toggle>
<label class="icon cursor" for=chapter-dde37901a0e0ea32745b67607854900f><a role=button></a></label><a href=https://docs.freebsd.org/pt-br/books/handbook/geom/>Capítulo 18. GEOM: Framework de Transformação de Disco Modular</a><ul><li><a href=https://docs.freebsd.org/pt-br/books/handbook/geom/#geom-synopsis>18.1. Sinopse</a></li><li><a href=https://docs.freebsd.org/pt-br/books/handbook/geom/#geom-striping>18.2. RAID0 - Striping</a></li><li><a href=https://docs.freebsd.org/pt-br/books/handbook/geom/#geom-mirror>18.3. RAID1 - Espelhamento</a></li><li><a href=https://docs.freebsd.org/pt-br/books/handbook/geom/#geom-raid3>18.4. RAID3 - Distribuição em Nível de Byte com Paridade Dedicada</a></li><li><a href=https://docs.freebsd.org/pt-br/books/handbook/geom/#geom-graid>18.5. Dispositivos RAID por Software</a></li><li><a href=https://docs.freebsd.org/pt-br/books/handbook/geom/#geom-ggate>18.6. GEOM Network Gate</a></li><li><a href=https://docs.freebsd.org/pt-br/books/handbook/geom/#geom-glabel>18.7. Rotulando Dispositivos de Disco</a></li><li><a href=https://docs.freebsd.org/pt-br/books/handbook/geom/#geom-gjournal>18.8. Journaling UFS através do GEOM</a></li></ul></li><li><input type=checkbox id=chapter-73e82560fcb7145b7c0e2ec47af8fc04 class=toggle>
<label class="icon cursor" for=chapter-73e82560fcb7145b7c0e2ec47af8fc04><a role=button></a></label><a href=https://docs.freebsd.org/pt-br/books/handbook/zfs/>Capítulo 19. O sistema de arquivos Z (ZFS)</a><ul><li><a href=https://docs.freebsd.org/pt-br/books/handbook/zfs/#zfs-differences>19.1. O que torna o ZFS diferente</a></li><li><a href=https://docs.freebsd.org/pt-br/books/handbook/zfs/#zfs-quickstart>19.2. Guia de Início Rápido</a></li><li><a href=https://docs.freebsd.org/pt-br/books/handbook/zfs/#zfs-zpool>19.3. Administração <code>zpool</code></a></li><li><a href=https://docs.freebsd.org/pt-br/books/handbook/zfs/#zfs-zfs>19.4. Administração do <code>zfs</code></a></li><li><a href=https://docs.freebsd.org/pt-br/books/handbook/zfs/#zfs-zfs-allow>19.5. Administração Delegada</a></li><li><a href=https://docs.freebsd.org/pt-br/books/handbook/zfs/#zfs-advanced>19.6. Tópicos Avançados</a></li><li><a href=https://docs.freebsd.org/pt-br/books/handbook/zfs/#zfs-links>19.7. Recursos adicionais</a></li><li><a href=https://docs.freebsd.org/pt-br/books/handbook/zfs/#zfs-term>19.8. Recursos e terminologia do ZFS</a></li></ul></li><li><input type=checkbox id=chapter-7af71270807eb7b70cd3eedc6577b254 class=toggle>
<label class="icon cursor" for=chapter-7af71270807eb7b70cd3eedc6577b254><a role=button></a></label><a href=https://docs.freebsd.org/pt-br/books/handbook/filesystems/>Capítulo 20. Outros Sistemas de Arquivos</a><ul><li><a href=https://docs.freebsd.org/pt-br/books/handbook/filesystems/#filesystems-synopsis>20.1. Sinopse</a></li><li><a href=https://docs.freebsd.org/pt-br/books/handbook/filesystems/#filesystems-linux>20.2. Sistemas de arquivos do Linux™</a></li></ul></li><li><input type=checkbox id=chapter-375257268d95faaf87faf4f7a2e6aa67 class=toggle>
<label class="icon cursor" for=chapter-375257268d95faaf87faf4f7a2e6aa67><a role=button></a></label><a href=https://docs.freebsd.org/pt-br/books/handbook/virtualization/>Capítulo 21. Virtualização</a><ul><li><a href=https://docs.freebsd.org/pt-br/books/handbook/virtualization/#virtualization-synopsis>21.1. Sinopse</a></li><li><a href=https://docs.freebsd.org/pt-br/books/handbook/virtualization/#virtualization-guest-parallels>21.2. FreeBSD como Sistema Operacional Convidado no Parallels para Mac OS™ X</a></li><li><a href=https://docs.freebsd.org/pt-br/books/handbook/virtualization/#virtualization-guest-virtualpc>21.3. FreeBSD como sistema convidado no Virtual PC para Windows™</a></li><li><a href=https://docs.freebsd.org/pt-br/books/handbook/virtualization/#virtualization-guest-vmware>21.4. FreeBSD como Sistema Operacional Convidado no VMware Fusion para Mac OS™</a></li><li><a href=https://docs.freebsd.org/pt-br/books/handbook/virtualization/#virtualization-guest-virtualbox>21.5. FreeBSD como Sistema Operacional Convidado no VirtualBox™</a></li><li><a href=https://docs.freebsd.org/pt-br/books/handbook/virtualization/#virtualization-host-virtualbox>21.6. FreeBSD como Host com VirtualBox™</a></li><li><a href=https://docs.freebsd.org/pt-br/books/handbook/virtualization/#virtualization-host-bhyve>21.7. FreeBSD como um Host bhyve</a></li><li><a href=https://docs.freebsd.org/pt-br/books/handbook/virtualization/#virtualization-host-xen>21.8. FreeBSD como Host Xen™</a></li></ul></li><li><input type=checkbox id=chapter-49f1e96591c090304ea532012257f4ef class=toggle>
<label class="icon cursor" for=chapter-49f1e96591c090304ea532012257f4ef><a role=button></a></label><a href=https://docs.freebsd.org/pt-br/books/handbook/l10n/>Capítulo 22. Localização - Uso e Configuração do i18n/L10n</a><ul><li><a href=https://docs.freebsd.org/pt-br/books/handbook/l10n/#l10n-synopsis>22.1. Sinopse</a></li><li><a href=https://docs.freebsd.org/pt-br/books/handbook/l10n/#using-localization>22.2. Usando Localização</a></li><li><a href=https://docs.freebsd.org/pt-br/books/handbook/l10n/#l10n-compiling>22.3. Encontrando Aplicações i18n</a></li><li><a href=https://docs.freebsd.org/pt-br/books/handbook/l10n/#lang-setup>22.4. Configuração de Localização para Idiomas Específicos</a></li></ul></li><li><input type=checkbox id=chapter-dead2b4c5ea325dd390a9b0dccd8f763 class=toggle>
<label class="icon cursor" for=chapter-dead2b4c5ea325dd390a9b0dccd8f763><a role=button></a></label><a href=https://docs.freebsd.org/pt-br/books/handbook/cutting-edge/>Capítulo 23. Atualização e Upgrade do FreeBSD</a><ul><li><a href=https://docs.freebsd.org/pt-br/books/handbook/cutting-edge/#updating-upgrading-synopsis>23.1. Sinopse</a></li><li><a href=https://docs.freebsd.org/pt-br/books/handbook/cutting-edge/#updating-upgrading-freebsdupdate>23.2. Atualização do FreeBSD</a></li><li><a href=https://docs.freebsd.org/pt-br/books/handbook/cutting-edge/#updating-upgrading-documentation>23.3. Atualizando o Conjunto de Documentação</a></li><li><a href=https://docs.freebsd.org/pt-br/books/handbook/cutting-edge/#current-stable>23.4. Acompanhando um ramo de desenvolvimento</a></li><li><a href=https://docs.freebsd.org/pt-br/books/handbook/cutting-edge/#makeworld>23.5. Atualizando o FreeBSD a partir do código fonte</a></li><li><a href=https://docs.freebsd.org/pt-br/books/handbook/cutting-edge/#small-lan>23.6. Atualização de várias máquinas</a></li></ul></li><li><input type=checkbox id=chapter-29c1eeb0e9dedc487a98399e2737ee8a class=toggle>
<label class="icon cursor" for=chapter-29c1eeb0e9dedc487a98399e2737ee8a><a role=button></a></label><a href=https://docs.freebsd.org/pt-br/books/handbook/dtrace/>Chapter 24. DTrace</a><ul><li><a href=https://docs.freebsd.org/pt-br/books/handbook/dtrace/#dtrace-synopsis>24.1. Sinopse</a></li><li><a href=https://docs.freebsd.org/pt-br/books/handbook/dtrace/#dtrace-implementation>24.2. Diferenças de Implementação</a></li><li><a href=https://docs.freebsd.org/pt-br/books/handbook/dtrace/#dtrace-enable>24.3. Ativando o Suporte do DTrace</a></li><li><a href=https://docs.freebsd.org/pt-br/books/handbook/dtrace/#dtrace-using>24.4. Usando o DTrace</a></li></ul></li><li><input type=checkbox id=chapter-913e72bfb3d6947b2869d3e9447a6eaa class=toggle>
<label class="icon cursor" for=chapter-913e72bfb3d6947b2869d3e9447a6eaa><a role=button></a></label><a href=https://docs.freebsd.org/pt-br/books/handbook/usb-device-mode/>Capítulo 25. Modo de dispositivo USB/USB OTG</a><ul><li><a href=https://docs.freebsd.org/pt-br/books/handbook/usb-device-mode/#usb-device-mode-synopsis>25.1. Sinopse</a></li><li><a href=https://docs.freebsd.org/pt-br/books/handbook/usb-device-mode/#usb-device-mode-terminals>25.2. Portas Seriais Virtuais USB</a></li><li><a href=https://docs.freebsd.org/pt-br/books/handbook/usb-device-mode/#usb-device-mode-network>25.3. Interfaces de rede do modo de dispositivo USB</a></li><li><a href=https://docs.freebsd.org/pt-br/books/handbook/usb-device-mode/#usb-device-mode-storage>25.4. Dispositivo de armazenamento virtual USB</a></li></ul></li><li><input type=checkbox id=chapter-bbd25f9a194f9c39ca2d658c75767db5 class=toggle>
<label for=chapter-bbd25f9a194f9c39ca2d658c75767db5><a role=button></a></label><a href=https://docs.freebsd.org/pt-br/books/handbook/partiv/>Parte IV. Comunicação de rede</a></li><li><input type=checkbox id=chapter-499dab596afd7ddac77e80295314e0dd class=toggle>
<label class="icon cursor" for=chapter-499dab596afd7ddac77e80295314e0dd><a role=button></a></label><a href=https://docs.freebsd.org/pt-br/books/handbook/serialcomms/>Capítulo 26. Comunicações Seriais</a><ul><li><a href=https://docs.freebsd.org/pt-br/books/handbook/serialcomms/#serial-synopsis>26.1. Sinopse</a></li><li><a href=https://docs.freebsd.org/pt-br/books/handbook/serialcomms/#serial>26.2. Terminologia serial e hardware</a></li><li><a href=https://docs.freebsd.org/pt-br/books/handbook/serialcomms/#term>26.3. Terminais</a></li><li><a href=https://docs.freebsd.org/pt-br/books/handbook/serialcomms/#dialup>26.4. Serviço Dial-in</a></li><li><a href=https://docs.freebsd.org/pt-br/books/handbook/serialcomms/#dialout>26.5. Serviço de Dial-in</a></li><li><a href=https://docs.freebsd.org/pt-br/books/handbook/serialcomms/#serialconsole-setup>26.6. Configurando o Console Serial</a></li></ul></li><li><input type=checkbox id=chapter-95e4571c48bee1cced5e84a538d302e3 class=toggle>
<label class="icon cursor" for=chapter-95e4571c48bee1cced5e84a538d302e3><a role=button></a></label><a href=https://docs.freebsd.org/pt-br/books/handbook/ppp-and-slip/>Capítulo 27. PPP</a><ul><li><a href=https://docs.freebsd.org/pt-br/books/handbook/ppp-and-slip/#ppp-and-slip-synopsis>27.1. Sinopse</a></li><li><a href=https://docs.freebsd.org/pt-br/books/handbook/ppp-and-slip/#userppp>27.2. Configurando o PPP</a></li><li><a href=https://docs.freebsd.org/pt-br/books/handbook/ppp-and-slip/#ppp-troubleshoot>27.3. Solução de problemas de conexões PPP</a></li><li><a href=https://docs.freebsd.org/pt-br/books/handbook/ppp-and-slip/#pppoe>27.4. Usando o PPP sobre Ethernet (PPPoE)</a></li><li><a href=https://docs.freebsd.org/pt-br/books/handbook/ppp-and-slip/#pppoa>27.5. Usando PPP sobre ATM (PPPoA)</a></li></ul></li><li><input type=checkbox id=chapter-f089ac726c401c9b4bd5c34a295e11bb class=toggle>
<label class="icon cursor" for=chapter-f089ac726c401c9b4bd5c34a295e11bb><a role=button></a></label><a href=https://docs.freebsd.org/pt-br/books/handbook/mail/>Capítulo 28. Correio Eletrônico</a><ul><li><a href=https://docs.freebsd.org/pt-br/books/handbook/mail/#mail-synopsis>28.1. Sinopse</a></li><li><a href=https://docs.freebsd.org/pt-br/books/handbook/mail/#mail-using>28.2. Componentes de Email</a></li><li><a href=https://docs.freebsd.org/pt-br/books/handbook/mail/#sendmail>28.3. Arquivos de Configuração do Sendmail</a></li><li><a href=https://docs.freebsd.org/pt-br/books/handbook/mail/#mail-changingmta>28.4. Alterando o Mail Transfer Agent</a></li><li><a href=https://docs.freebsd.org/pt-br/books/handbook/mail/#mail-trouble>28.5. Solução de problemas</a></li><li><a href=https://docs.freebsd.org/pt-br/books/handbook/mail/#mail-advanced>28.6. Tópicos Avançados</a></li><li><a href=https://docs.freebsd.org/pt-br/books/handbook/mail/#outgoing-only>28.7. Configurando Apenas Envio</a></li><li><a href=https://docs.freebsd.org/pt-br/books/handbook/mail/#SMTP-dialup>28.8. Usando Email com uma Conexão Dialup</a></li><li><a href=https://docs.freebsd.org/pt-br/books/handbook/mail/#SMTP-Auth>28.9. Autenticação SMTP</a></li><li><a href=https://docs.freebsd.org/pt-br/books/handbook/mail/#mail-agents>28.10. Mail User Agents</a></li><li><a href=https://docs.freebsd.org/pt-br/books/handbook/mail/#mail-fetchmail>28.11. Usando o fetchmail</a></li><li><a href=https://docs.freebsd.org/pt-br/books/handbook/mail/#mail-procmail>28.12. Usando o procmail</a></li></ul></li><li><input type=checkbox id=chapter-6de4de3fe925639d4175ce4b6f8c1829 class=toggle>
<label class="icon cursor" for=chapter-6de4de3fe925639d4175ce4b6f8c1829><a role=button></a></label><a href=https://docs.freebsd.org/pt-br/books/handbook/network-servers/>Capítulo 29. Servidores de Rede</a><ul><li><a href=https://docs.freebsd.org/pt-br/books/handbook/network-servers/#network-servers-synopsis>29.1. Sinopse</a></li><li><a href=https://docs.freebsd.org/pt-br/books/handbook/network-servers/#network-inetd>29.2. O super-servidor inetd</a></li><li><a href=https://docs.freebsd.org/pt-br/books/handbook/network-servers/#network-nfs>29.3. Network File System (NFS)</a></li><li><a href=https://docs.freebsd.org/pt-br/books/handbook/network-servers/#network-nis>29.4. Sistema de Informação de Rede (NIS)</a></li><li><a href=https://docs.freebsd.org/pt-br/books/handbook/network-servers/#network-ldap>29.5. Protocolo leve de acesso de diretório ( LDAP )</a></li><li><a href=https://docs.freebsd.org/pt-br/books/handbook/network-servers/#network-dhcp>29.6. Protocolo de configuração dinâmica de hosts (DHCP)</a></li><li><a href=https://docs.freebsd.org/pt-br/books/handbook/network-servers/#network-dns>29.7. Sistema de Nomes de Domínio (DNS)</a></li><li><a href=https://docs.freebsd.org/pt-br/books/handbook/network-servers/#network-apache>29.8. Servidor HTTP Apache</a></li><li><a href=https://docs.freebsd.org/pt-br/books/handbook/network-servers/#network-ftp>29.9. Protocolo de Transferência de Arquivos (FTP)</a></li><li><a href=https://docs.freebsd.org/pt-br/books/handbook/network-servers/#network-samba>29.10. Serviços de arquivos e impressão para clientes Microsoft™Windows™ Clients (Samba)</a></li><li><a href=https://docs.freebsd.org/pt-br/books/handbook/network-servers/#network-ntp>29.11. Sincronização de Relógio com NTP</a></li><li><a href=https://docs.freebsd.org/pt-br/books/handbook/network-servers/#network-iscsi>29.12. Inicializador iSCSI e Configuração Alvo</a></li></ul></li><li><input type=checkbox id=chapter-776d855c7b75e048f90b5c2c9b35ffe0 class=toggle>
<label class="icon cursor" for=chapter-776d855c7b75e048f90b5c2c9b35ffe0><a role=button></a></label><a href=https://docs.freebsd.org/pt-br/books/handbook/firewalls/>Capítulo 30. Firewalls</a><ul><li><a href=https://docs.freebsd.org/pt-br/books/handbook/firewalls/#firewalls-intro>30.1. Sinopse</a></li><li><a href=https://docs.freebsd.org/pt-br/books/handbook/firewalls/#firewalls-concepts>30.2. Conceitos de Firewall</a></li><li><a href=https://docs.freebsd.org/pt-br/books/handbook/firewalls/#firewalls-pf>30.3. PF</a></li><li><a href=https://docs.freebsd.org/pt-br/books/handbook/firewalls/#firewalls-ipfw>30.4. IPFW</a></li><li><a href=https://docs.freebsd.org/pt-br/books/handbook/firewalls/#firewalls-ipf>30.5. IPFILTER (IPF)</a></li><li><a href=https://docs.freebsd.org/pt-br/books/handbook/firewalls/#firewalls-blacklistd>30.6. Blacklistd</a></li></ul></li><li><input type=checkbox id=chapter-5b07f776a0e6155c1c89aa0d15610380 class=toggle>
<label class="icon cursor" for=chapter-5b07f776a0e6155c1c89aa0d15610380><a role=button></a></label><a href=https://docs.freebsd.org/pt-br/books/handbook/advanced-networking/>Capítulo 31. Rede Avançada</a><ul><li><a href=https://docs.freebsd.org/pt-br/books/handbook/advanced-networking/#advanced-networking-synopsis>31.1. Sinopse</a></li><li><a href=https://docs.freebsd.org/pt-br/books/handbook/advanced-networking/#network-routing>31.2. Gateways e Rotas</a></li><li><a href=https://docs.freebsd.org/pt-br/books/handbook/advanced-networking/#network-wireless>31.3. Rede sem fio</a></li><li><a href=https://docs.freebsd.org/pt-br/books/handbook/advanced-networking/#network-usb-tethering>31.4. USB Tethering</a></li><li><a href=https://docs.freebsd.org/pt-br/books/handbook/advanced-networking/#network-bluetooth>31.5. Bluetooth</a></li><li><a href=https://docs.freebsd.org/pt-br/books/handbook/advanced-networking/#network-bridging>31.6. Bridging</a></li><li><a href=https://docs.freebsd.org/pt-br/books/handbook/advanced-networking/#network-aggregation>31.7. Agregação de links e failover</a></li><li><a href=https://docs.freebsd.org/pt-br/books/handbook/advanced-networking/#network-diskless>31.8. Operação Diskless com PXE</a></li><li><a href=https://docs.freebsd.org/pt-br/books/handbook/advanced-networking/#network-ipv6>31.9. IPv6</a></li><li><a href=https://docs.freebsd.org/pt-br/books/handbook/advanced-networking/#carp>31.10. Protocolo Comum de Redundância de Endereços (CARP)</a></li><li><a href=https://docs.freebsd.org/pt-br/books/handbook/advanced-networking/#network-vlan>31.11. VLANs</a></li></ul></li><li><input type=checkbox id=chapter-171a77aa9d067a1024f849470e1f33e8 class=toggle>
<label for=chapter-171a77aa9d067a1024f849470e1f33e8><a role=button></a></label><a href=https://docs.freebsd.org/pt-br/books/handbook/partv/>Parte V. Apêndices</a></li><li><input type=checkbox id=chapter-8050f436a0a7986a4aaded93d8e49469 class=toggle>
<label class="icon cursor" for=chapter-8050f436a0a7986a4aaded93d8e49469><a role=button></a></label><a href=https://docs.freebsd.org/pt-br/books/handbook/mirrors/>Apêndice A. Obtendo o FreeBSD</a><ul><li><a href=https://docs.freebsd.org/pt-br/books/handbook/mirrors/#mirrors-cdrom>A.1. CD and DVD Sets</a></li><li><a href=https://docs.freebsd.org/pt-br/books/handbook/mirrors/#mirrors-ftp>A.2. Sites de FTP</a></li><li><a href=https://docs.freebsd.org/pt-br/books/handbook/mirrors/#svn>A.3. Usando o Subversion</a></li><li><a href=https://docs.freebsd.org/pt-br/books/handbook/mirrors/#mirrors-rsync>A.4. Usando o rsync</a></li></ul></li><li><input type=checkbox id=chapter-128b630a8f88f158e7027fe6c2184d21 class=toggle>
<label class="icon cursor" for=chapter-128b630a8f88f158e7027fe6c2184d21><a role=button></a></label><a href=https://docs.freebsd.org/pt-br/books/handbook/bibliography/>Apêndice B. Bibliografia</a><ul><li><a href=https://docs.freebsd.org/pt-br/books/handbook/bibliography/#bibliography-freebsd>B.1. Livros específicos para o FreeBSD</a></li><li><a href=https://docs.freebsd.org/pt-br/books/handbook/bibliography/#bibliography-userguides>B.2. Guias de usuários</a></li><li><a href=https://docs.freebsd.org/pt-br/books/handbook/bibliography/#bibliography-adminguides>B.3. Guias de Administradores</a></li><li><a href=https://docs.freebsd.org/pt-br/books/handbook/bibliography/#bibliography-programmers>B.4. Guias de programadores</a></li><li><a href=https://docs.freebsd.org/pt-br/books/handbook/bibliography/#bibliography-osinternals>B.5. Internals do sistema operacional</a></li><li><a href=https://docs.freebsd.org/pt-br/books/handbook/bibliography/#bibliography-security>B.6. Referências de segurança</a></li><li><a href=https://docs.freebsd.org/pt-br/books/handbook/bibliography/#bibliography-hardware>B.7. Referências de Hardware</a></li><li><a href=https://docs.freebsd.org/pt-br/books/handbook/bibliography/#bibliography-history>B.8. História do UNIX™</a></li><li><a href=https://docs.freebsd.org/pt-br/books/handbook/bibliography/#bibliography-journals>B.9. Periódicos, Jornais e Revistas</a></li></ul></li><li><input type=checkbox id=chapter-8bbb8867c46dac315e2253945d8c18a8 class=toggle>
<label class="icon cursor" for=chapter-8bbb8867c46dac315e2253945d8c18a8><a role=button></a></label><a href=https://docs.freebsd.org/pt-br/books/handbook/eresources/>Apêndice C. Recursos na Internet</a><ul><li><a href=https://docs.freebsd.org/pt-br/books/handbook/eresources/#eresources-www>C.1. Websites</a></li><li><a href=https://docs.freebsd.org/pt-br/books/handbook/eresources/#eresources-mail>C.2. Listas de Discussão</a></li><li><a href=https://docs.freebsd.org/pt-br/books/handbook/eresources/#eresources-news>C.3. Grupos de Notícias Usenet</a></li><li><a href=https://docs.freebsd.org/pt-br/books/handbook/eresources/#eresources-web>C.4. Espelhos Oficiais</a></li></ul></li><li><input type=checkbox id=chapter-a80ea4f5a4480b8725422710f954ef36 class=toggle>
<label class="icon cursor" for=chapter-a80ea4f5a4480b8725422710f954ef36><a role=button></a></label><a href=https://docs.freebsd.org/pt-br/books/handbook/pgpkeys/>Apêndice D. Chaves OpenPGP</a><ul><li><a href=https://docs.freebsd.org/pt-br/books/handbook/pgpkeys/#pgpkeys-officers>D.1. Administradores</a></li></ul></li><li></li></ul></nav></div></aside><div class=book><div class=book-menu-mobile><label for=menu-control><span class=menu-control-button><i class="fa fa-list" aria-hidden=true title=Menu></i>
Menu</span></label></div><h1 class=title>Capítulo 13. Segurança</h1><div class="admonitionblock note"><p><i class="fa fa-exclamation-circle" aria-hidden=true></i>
Esta tradução pode estar desatualizada. Para ajudar com as traduções, acesse a <a href=https://translate-dev.freebsd.org/ target=_blank>ferramenta de traduções do FreeBSD</a>.</p></div><div class=toc-mobile><h3>Índice</h3><nav id=TableOfContents><ul><li><a href=#security-synopsis>13.1. Sinopse</a></li><li><a href=#security-intro>13.2. Introdução</a></li><li><a href=#one-time-passwords>13.3. Senhas de Uso Unico</a></li><li><a href=#tcpwrappers>13.4. TCP Wrapper</a></li><li><a href=#kerberos5>13.5. Kerberos</a></li><li><a href=#openssl>13.6. OpenSSL</a></li><li><a href=#ipsec>13.7. VPN Sobre IPsec</a></li><li><a href=#openssh>13.8. OpenSSH</a></li><li><a href=#fs-acl>13.9. Listas de Controle de Acesso</a></li><li><a href=#security-pkg>13.10. Monitorando Problemas de Segurança de Terceiros</a></li><li><a href=#security-advisories>13.11. Avisos de Segurança do FreeBSD</a></li><li><a href=#security-accounting>13.12. Auditoria de Processo</a></li><li><a href=#security-resourcelimits>13.13. Limites de Recursos</a></li><li><a href=#security-sudo>13.14. Administração Compartilhada com Sudo</a></li></ul></nav></div><div class=book-content><div id=preamble><div class=sectionbody></div></div><div class=sect1><h2 id=security-synopsis>13.1. Sinopse<a class=anchor href=#security-synopsis></a></h2><div class=sectionbody><div class=paragraph><p>A segurança, seja física ou virtual, é um tópico tão amplo que todo um setor evoluiu em torno dele. Centenas de práticas padrão foram criadas sobre como proteger sistemas e redes e, como usuário do FreeBSD, é essencial entender como se proteger contra ataques e intrusos.</p></div><div class=paragraph><p>Neste capítulo, vários fundamentos e técnicas serão discutidos. O sistema FreeBSD vem com múltiplas camadas de segurança, e muitos outros utilitários de terceiros podem ser adicionados para aumentar a segurança.</p></div><div class=paragraph><p>Depois de ler este capítulo, você saberá:</p></div><div class=ulist><ul><li><p>Conceitos básicos de segurança do sistema FreeBSD.</p></li><li><p>Os vários mecanismos de criptografia disponíveis no FreeBSD.</p></li><li><p>Como configurar a autenticação de senha única.</p></li><li><p>Como configurar o TCP Wrapper para uso com o <a href="https://man.freebsd.org/cgi/man.cgi?query=inetd&amp;sektion=8&amp;format=html">inetd(8)</a>.</p></li><li><p>Como configurar o Kerberos no FreeBSD.</p></li><li><p>Como configurar o IPsec e criar uma VPN.</p></li><li><p>Como configurar e usar o OpenSSH no FreeBSD.</p></li><li><p>Como usar ACLs para o sistema de arquivos .</p></li><li><p>Como usar o pkg para auditar pacotes de software de terceiros instalados a partir da Coleção de Ports.</p></li><li><p>Como utilizar os alertas de segurança do FreeBSD.</p></li><li><p>O que é Auditoria de Processos e como ativá-la no FreeBSD.</p></li><li><p>Como controlar os recursos do usuário usando classes de login ou o banco de dados de limites de recursos.</p></li></ul></div><div class=paragraph><p>Antes de ler este capítulo, você deve:</p></div><div class=ulist><ul><li><p>Entender os conceitos básicos do FreeBSD e de Internet.</p></li></ul></div><div class=paragraph><p>Tópicos de segurança adicionais são abordados em outras partes deste Manual. Por exemplo, o Controle de Acesso Obrigatório é discutido em <a href=../mac/#mac>Controle de acesso obrigatório</a> e os firewalls da Internet são discutidos em <a href=../firewalls/#firewalls>Firewalls</a>.</p></div></div></div><div class=sect1><h2 id=security-intro>13.2. Introdução<a class=anchor href=#security-intro></a></h2><div class=sectionbody><div class=paragraph><p>Segurança é responsabilidade de todos. Um ponto de entrada fraco em qualquer sistema pode permitir que intrusos obtenham acesso a informações críticas e causem estragos em toda a rede. Um dos princípios centrais da segurança da informação é a tríade CIA, que significa Confidencialidade, Integridade e Disponibilidade dos sistemas de informação.</p></div><div class=paragraph><p>A tríade CIA é um conceito básico de segurança de computadores, pois os clientes e usuários esperam que seus dados sejam protegidos. Por exemplo, um cliente espera que as informações do cartão de crédito sejam armazenadas com segurança (confidencialidade), que os pedidos não sejam alterados nos bastidores (integridade) e que tenham acesso às informações do pedido em todos os momentos (disponibilidade).</p></div><div class=paragraph><p>Para fornecer CIA, os profissionais de segurança aplicam uma estratégia de defesa em profundidade. A ideia de defesa em profundidade é adicionar várias camadas de segurança para evitar que uma falha em uma única camada e faça com que todo o sistema de segurança entre em colapso. Por exemplo, um administrador do sistema não pode simplesmente ativar um firewall e considerar a rede ou o sistema seguro. É preciso também auditar contas, verificar a integridade dos binários e garantir que ferramentas maliciosas não estejam instaladas. Para implementar uma estratégia de segurança eficaz, é preciso entender as ameaças e como se defender delas.</p></div><div class=paragraph><p>O que é uma ameaça no que se refere à segurança do computador? As ameaças não se limitam a invasores remotos que tentam acessar um sistema sem permissão de um local remoto. As ameaças também incluem funcionários, softwares mal-intencionados, dispositivos de rede não autorizados, desastres naturais, vulnerabilidades de segurança e até corporações concorrentes.</p></div><div class=paragraph><p>Sistemas e redes podem ser acessados sem permissão, às vezes por acidente, ou por atacantes remotos e, em alguns casos, por meio de espionagem corporativa ou ex-funcionários. Como usuário, é importante se preparar e admitir quando um erro levou a uma violação de segurança e relatar possíveis problemas à equipe de segurança. Como administrador, é importante conhecer as ameaças e estar preparado para mitigá-las.</p></div><div class=paragraph><p>Ao aplicar a segurança aos sistemas, recomenda-se começar protegendo as contas básicas e a configuração do sistema e, em seguida, proteger a camada de rede de modo a aderir à política do sistema e aos procedimentos de segurança da organização. Muitas organizações já possuem uma política de segurança que abrange a configuração de dispositivos de tecnologia. A política deve incluir a configuração de segurança de estações de trabalho, desktops, dispositivos móveis, telefones, servidores de produção e servidores de desenvolvimento. Em muitos casos, procedimentos operacionais padrão (SOPs) já existem. Em caso de dúvida, pergunte à equipe de segurança.</p></div><div class=paragraph><p>O restante desta introdução descreve como algumas dessas configurações básicas de segurança são executadas em um sistema FreeBSD. O restante deste capítulo descreve algumas ferramentas específicas que podem ser usadas ao implementar uma política de segurança em um sistema FreeBSD.</p></div><div class=sect2><h3 id=security-accounts>13.2.1. Prevenindo Logins<a class=anchor href=#security-accounts></a></h3><div class=paragraph><p>Ao garantir a segurança de um sistema, um bom ponto de partida é uma auditoria de contas. Assegure-se de que o <code>root</code> tenha uma senha forte e que essa senha não seja compartilhada. Desabilite todas as contas que não precisam de acesso de para logar.</p></div><div class=paragraph><p>Para negar acesso de login a contas, existem dois métodos. O primeiro é bloquear a conta. Este exemplo bloqueia a conta <code>toor</code>:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># pw lock toor</span></code></pre></div></div><div class=paragraph><p>O segundo método é impedir o acesso ao login alterando o shell para <span class=filename>/usr/sbin/nologin</span>. Apenas o superusuário pode alterar o shell para outros usuários:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># chsh -s /usr/sbin/nologin toor</span></code></pre></div></div><div class=paragraph><p>O shell <span class=filename>/usr/sbin/nologin</span> impede que o sistema atribua um shell ao usuário quando ele tenta efetuar login.</p></div></div><div class=sect2><h3 id=security-accountmgmt>13.2.2. Escalonamento de Contas Permitido<a class=anchor href=#security-accountmgmt></a></h3><div class=paragraph><p>Em alguns casos, a administração do sistema precisa ser compartilhada com outros usuários. O FreeBSD tem dois métodos para lidar com isso. O primeiro, que não é recomendado, é uma senha de root compartilhada usada por membros do grupo <code>wheel</code>. Com esse método, um usuário digita <code>su</code> e insere a senha para <code>wheel</code> sempre que o acesso do superusuário for necessário. O usuário deve então digitar <code>exit</code> para deixar o acesso privilegiado após terminar os comandos que requereram acesso administrativo. Para adicionar um usuário a este grupo, edite <span class=filename>/etc/group</span> e adicione o usuário ao final da entrada <code>wheel</code>. O usuário deve ser separado por um caractere vírgula sem espaço.</p></div><div class=paragraph><p>O segundo e recomendado método para permitir o escalonamento de privilégios é instalar o pacote ou port <a class=package href=https://cgit.freebsd.org/ports/tree/security/sudo/>security/sudo</a>. Este software fornece auditoria adicional, controle de usuário mais refinado e pode ser configurado para bloquear os usuários para que executem apenas os comandos privilegiados especificados.</p></div><div class=paragraph><p>Após a instalação, use o <code>visudo</code> para editar o <span class=filename>/usr/local/etc/sudoers</span>. Este exemplo cria um novo grupo <code>webadmin</code>, adiciona a conta <code>trhodes</code> a esse grupo e configura esse acesso de grupo para reiniciar o <a class=package href=https://cgit.freebsd.org/ports/tree/apache24/>apache24</a>:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># pw groupadd webadmin -M trhodes -g 6000</span>
<span class=c># visudo</span>
%webadmin <span class=nv>ALL</span><span class=o>=(</span>ALL<span class=o>)</span> /usr/sbin/service apache24 <span class=k>*</span></code></pre></div></div></div><div class=sect2><h3 id=security-passwords>13.2.3. Hashes de Senhas<a class=anchor href=#security-passwords></a></h3><div class=paragraph><p>As senhas são um mal necessário da tecnologia. Quando elas devem ser usadas, elas devem ser complexas e um poderoso mecanismo de hash deve ser usado para criptografar a versão armazenada no banco de dados de senhas. O FreeBSD suporta os algoritmos de DES, MD5, SHA256, SHA512 e Blowfish na sua biblioteca <code>crypt()</code>. O padrão de SHA512 não deve ser alterado para um algoritmo hash menos seguro, mas pode ser alterado para o algoritmo Blowfish mais seguro.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>O Blowfish não faz parte do AES e não é considerado compatível com nenhum Federal Information Processing Standard (FIPS). Seu uso pode não ser permitido em alguns ambientes.</p></div></td></tr></tbody></table></div><div class=paragraph><p>Para determinar qual algoritmo de hash é usado para criptografar a senha de um usuário, o superusuário pode visualizar o hash do usuário no banco de dados de senhas do FreeBSD. Cada hash começa com um símbolo que indica o tipo de mecanismo de hash usado para criptografar a senha. Se DES for usado, não haverá símbolo de início. Para MD5, o símbolo é <code>$</code>. Para SHA256 e SHA512, o símbolo é <code>$6$</code>. Para o Blowfish, o símbolo é <code>$2a$</code>. Neste exemplo, a senha para <code>dru</code> é criptografada usando o algoritmo SHA512 padrão quando o hash começa com <code>$6$</code>. Observe que o hash criptografado, não a senha em si, é armazenado no banco de dados de senhas:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># grep dru /etc/master.passwd</span>
dru:<span class=nv>$6$pzIjSvCAn</span>.PBYQBA<span class=nv>$PXpSeWPx3g5kscj3IMiM7tUEUSPmGexxta</span>.8Lt9TGSi2lNQqYGKszsBPuGME0:1001:1001::0:0:dru:/usr/home/dru:/bin/csh</code></pre></div></div><div class=paragraph><p>O mecanismo de hash é definido na classe de login do usuário. Para este exemplo, o usuário está na classe de login <code>default</code> e o algoritmo de hash é definido com esta linha em <span class=filename>/etc/login.conf</span>:</p></div><div class="literalblock programlisting"><div class=content><pre>        :passwd_format=sha512:\</pre></div></div><div class=paragraph><p>Para alterar o algoritmo para Blowfish, modifique a linha para ficar assim:</p></div><div class="literalblock programlisting"><div class=content><pre>        :passwd_format=blf:\</pre></div></div><div class=paragraph><p>Em seguida, execute <code>cap_mkdb /etc/login.conf</code> conforme descrito em <a href=#users-limiting>Configurando Classes de Login</a>. Observe que essa alteração não afetará os hashes de senha existentes. Isso significa que todas as senhas devem ser refeitas pedindo aos usuários que executem <code>passwd</code> para alterar sua senha.</p></div><div class=paragraph><p>Para logins remotos, a autenticação de dois fatores deve ser usada. Um exemplo de autenticação de dois fatores é "algo que você tem", como uma chave, e "algo que você conhece", como a senha para essa chave. Como o OpenSSH é parte do sistema básico do FreeBSD, todos os logins de rede devem ser sobre uma conexão criptografada e usar autenticação baseada em chave em vez de senhas. Para mais informações, consulte <a href=#openssh>OpenSSH</a>. Os usuários do Kerberos podem precisar fazer alterações adicionais para implementar o OpenSSH em sua rede. Essas alterações são descritas em <a href=#kerberos5>Kerberos</a>.</p></div></div><div class=sect2><h3 id=security-pwpolicy>13.2.4. Aplicação de Política de Senha<a class=anchor href=#security-pwpolicy></a></h3><div class=paragraph><p>Aplicar uma política de senha forte para contas locais é um aspecto fundamental da segurança do sistema. No FreeBSD, o tamanho da senha, a força da senha e a complexidade da senha podem ser implementados usando os Módulos de Autenticação Conectáveis (PAM).</p></div><div class=paragraph><p>Esta seção demonstra como configurar o tamanho mínimo e máximo da senha e a imposição de caracteres mistos usando o módulo <span class=filename>pam_passwdqc.so</span>. Este módulo é aplicado quando um usuário altera sua senha.</p></div><div class=paragraph><p>Para configurar este módulo, torne-se o superusuário e remova o comentário da linha contendo <code>pam_passwdqc.so</code> em <span class=filename>/etc/pam.d/passwd</span>. Em seguida, edite essa linha para corresponder à política de senha:</p></div><div class="literalblock programlisting"><div class=content><pre>password        requisite       pam_passwdqc.so         min=disabled,disabled,disabled,12,10 similar=deny retry=3 enforce=users</pre></div></div><div class=paragraph><p>Este exemplo define vários requisitos para novas senhas. A configuração <code>min</code> controla o tamanho mínimo da senha. Ele tem cinco valores porque este módulo define cinco tipos diferentes de senhas com base em sua complexidade. Complexidade é definida pelo tipo de caracteres que devem existir em uma senha, como letras, números, símbolos e maiúsculas e minúsculas. Os tipos de senhas são descritos em <a href="https://man.freebsd.org/cgi/man.cgi?query=pam_passwdqc&amp;sektion=8&amp;format=html">pam_passwdqc(8)</a>. Neste exemplo, os três primeiros tipos de senha são desativados, o que significa que as senhas que atendem a esses requisitos de complexidade não serão aceitas, independentemente da sua duração. O <code>12</code> define uma política de senha mínima de pelo menos doze caracteres, se a senha também contiver caracteres com três tipos de complexidade. O <code>10</code> define a política de senha para também permitir senhas de pelo menos dez caracteres, se a senha contiver caracteres com quatro tipos de complexidade.</p></div><div class=paragraph><p>A configuração <code>similar</code> nega senhas semelhantes à senha anterior do usuário. A configuração <code>retry</code> fornece ao usuário três oportunidades para inserir uma nova senha.</p></div><div class=paragraph><p>Depois que este arquivo for salvo, um usuário que alterar sua senha verá uma mensagem semelhante a seguinte:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>% passwd
Changing <span class=nb>local </span>password <span class=k>for </span>trhodes
Old Password:

You can now choose the new password.
A valid password should be a mix of upper and lower <span class=k>case</span> letters,
digits and other characters.  You can use a 12 character long
password with characters from at least 3 of these 4 classes, or
a 10 character long password containing characters from all the
classes.  Characters that form a common pattern are discarded by
the check.
Alternatively, <span class=k>if </span>no one <span class=k>else </span>can see your terminal now, you can
pick this as your password: <span class=s2>&#34;trait-useful&amp;knob&#34;</span><span class=nb>.</span>
Enter new password:</code></pre></div></div><div class=paragraph><p>Se uma senha que não corresponde à política for inserida, ela será rejeitada com um aviso e o usuário terá a oportunidade de tentar novamente, até o número configurado de novas tentativas.</p></div><div class=paragraph><p>A maioria das políticas de senha exige que as senhas expirem depois de tantos dias. Para definir um tempo de expiração da senha no FreeBSD, defina <code>passwordtime</code> para a classe de login do usuário em <span class=filename>/etc/login.conf</span>. A classe de login <code>default</code> contém um exemplo:</p></div><div class="literalblock programlisting"><div class=content><pre>#       :passwordtime=90d:\</pre></div></div><div class=paragraph><p>Portanto, para definir uma expiração de 90 dias para esta classe de login, remova o símbolo de comentário (<code>#</code>), salve a edição e execute o <code>cap_mkdb /etc/login.conf</code>.</p></div><div class=paragraph><p>Para definir a expiração em usuários individuais, passe uma data de expiração ou o número de dias para expirar e um nome de usuário para o comando <code>pw</code>:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># pw usermod -p 30-apr-2015 -n trhodes</span></code></pre></div></div><div class=paragraph><p>Como visto aqui, uma data de expiração é definida na forma de dia, mês e ano. Para obter maiores informações, consulte <a href="https://man.freebsd.org/cgi/man.cgi?query=pw&amp;sektion=8&amp;format=html">pw(8)</a>.</p></div></div><div class=sect2><h3 id=security-rkhunter>13.2.5. Detectando Rootkits<a class=anchor href=#security-rkhunter></a></h3><div class=paragraph><p>Um <em>rootkit</em> é qualquer software não autorizado que tente obter acesso como <code>root</code> a um sistema. Uma vez instalado, esse software mal-intencionado normalmente abrirá outro caminho de entrada para um invasor. Realisticamente, uma vez que um sistema foi comprometido por um rootkit e uma investigação foi realizada, o sistema deve ser reinstalado do zero. Existe um tremendo risco de que mesmo o engenheiro de sistemas ou segurança mais prudente perca algo que um invasor deixou para trás.</p></div><div class=paragraph><p>Um rootkit faz uma coisa útil para administradores: uma vez detectado, é um sinal de que um comprometimento aconteceu em algum momento. Mas, esses tipos de aplicativos tendem a ser muito bem ocultos. Esta seção demonstra uma ferramenta que pode ser usada para detectar rootkits, <a class=package href=https://cgit.freebsd.org/ports/tree/security/rkhunter/>security/rkhunter</a>.</p></div><div class=paragraph><p>Após a instalação deste pacote ou port, o sistema pode ser verificado usando o seguinte comando. Ele produzirá muitas informações e exigirá uma entrada manual da tecla <kbd>ENTER</kbd>:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># rkhunter -c</span></code></pre></div></div><div class=paragraph><p>Depois que o processo for concluído, uma mensagem de status será impressa na tela. Esta mensagem incluirá a quantidade de arquivos verificados, arquivos suspeitos, possíveis rootkits e mais. Durante a verificação, alguns avisos de segurança genéricos podem ser produzidos sobre arquivos ocultos, a seleção do protocolo OpenSSH e versões vulneráveis conhecidas do software instalado. Estes podem ser tratados agora ou após uma análise mais detalhada ter sido realizada.</p></div><div class=paragraph><p>Todo administrador deve saber o que está sendo executado nos sistemas pelos quais é responsável. Ferramentas de terceiros como o rkhunter e o <a class=package href=https://cgit.freebsd.org/ports/tree/sysutils/lsof/>sysutils/lsof</a> e comandos nativos como o <code>netstat</code> e o <code>ps</code>, podem mostrar uma grande quantidade de informações sobre o sistema. Faça anotações sobre o que é normal, faça perguntas quando algo parecer fora do lugar e seja paranoico. Embora evitar um comprometimento seja ideal, detectar um comprometimento é imprescindível.</p></div></div><div class=sect2><h3 id=security-ids>13.2.6. Verificação Binária<a class=anchor href=#security-ids></a></h3><div class=paragraph><p>A verificação de arquivos e binários do sistema é importante porque fornece às equipes de administração e segurança do sistema informações sobre alterações no sistema. Uma aplicação de software que monitora o sistema para alterações é chamado de Sistema de Detecção de Intrusão (IDS).</p></div><div class=paragraph><p>O FreeBSD fornece suporte nativo para um sistema de IDS básico. Embora os emails de segurança noturnos notifiquem o administrador sobre alterações, as informações são armazenadas localmente e há uma chance de que um usuário mal-intencionado modifique essas informações para ocultar suas alterações no sistema. Como tal, recomenda-se criar um conjunto separado de assinaturas binárias e armazená-las em um diretório de read-only, propriedade do root ou, de preferência, em um disco USB removível ou servidor rsync remoto.</p></div><div class=paragraph><p>O utilitário <code>mtree</code> embutido pode ser usado para gerar uma especificação do conteúdo de um diretório. Um seed, ou uma constante numérica, é usada para gerar a especificação e é necessária para verificar se a especificação não foi alterada. Isso possibilita determinar se um arquivo ou binário foi modificado. Como o valor inicial do seed é desconhecido por um invasor, disfarçar ou impossibilitar a verificação dos valores de checksum dos arquivos será difícil ou impossível. O exemplo a seguir gera um conjunto de hashes SHA256, um para cada sistema binário no diretório <span class=filename>/bin</span> e salva esses valores em um arquivo oculto no diretório inicial do <code>root</code>, <span class=filename>/root/.bin_chksum_mtree</span>:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># mtree -s 3483151339707503 -c -K cksum,sha256digest -p /bin &gt; /root/.bin_chksum_mtree</span>
<span class=c># mtree: /bin checksum: 3427012225</span></code></pre></div></div><div class=paragraph><p>O <em>3483151339707503</em> representa o seed. Este valor deve ser lembrado, mas não compartilhado.</p></div><div class=paragraph><p>Visualizar o arquivo <span class=filename>/root/.bin_cksum_mtree</span> deve produzir uma saída semelhante à seguinte:</p></div><div class="literalblock programlisting"><div class=content><pre>#          user: root
#       machine: dreadnaught
#          tree: /bin
#          date: Mon Feb  3 10:19:53 2014

# .
/set type=file uid=0 gid=0 mode=0555 nlink=1 flags=none
.               type=dir mode=0755 nlink=2 size=1024 \
                time=1380277977.000000000
    \133        nlink=2 size=11704 time=1380277977.000000000 \
                cksum=484492447 \
                sha256digest=6207490fbdb5ed1904441fbfa941279055c3e24d3a4049aeb45094596400662a
    cat         size=12096 time=1380277975.000000000 cksum=3909216944 \
                sha256digest=65ea347b9418760b247ab10244f47a7ca2a569c9836d77f074e7a306900c1e69
    chflags     size=8168 time=1380277975.000000000 cksum=3949425175 \
                sha256digest=c99eb6fc1c92cac335c08be004a0a5b4c24a0c0ef3712017b12c89a978b2dac3
    chio        size=18520 time=1380277975.000000000 cksum=2208263309 \
                sha256digest=ddf7c8cb92a58750a675328345560d8cc7fe14fb3ccd3690c34954cbe69fc964
    chmod       size=8640 time=1380277975.000000000 cksum=2214429708 \
                sha256digest=a435972263bf814ad8df082c0752aa2a7bdd8b74ff01431ccbd52ed1e490bbe7</pre></div></div><div class=paragraph><p>O nome do host da máquina, a data e a hora em que a especificação foi criada e o nome do usuário que criou a especificação são incluídos neste relatório. Há um checksum, tamanho, hora e um digest SHA256 para cada binário no diretório.</p></div><div class=paragraph><p>Para verificar se as assinaturas binárias não foram alteradas, compare o conteúdo atual do diretório com a especificação gerada anteriormente e salve os resultados em um arquivo. Este comando requer o seed que foi usado para gerar a especificação original:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># mtree -s 3483151339707503 -p /bin &lt; /root/.bin_chksum_mtree &gt;&gt; /root/.bin_chksum_output</span>
<span class=c># mtree: /bin checksum: 3427012225</span></code></pre></div></div><div class=paragraph><p>Isso deve produzir o mesmo checksum para <span class=filename>/bin</span> que foi produzido quando a especificação foi criada. Se nenhuma alteração tiver ocorrido nos binários nesse diretório, o arquivo de saída <span class=filename>/root/.bin_chksum_output</span> estará vazio. Para simular uma alteração, altere a data no arquivo <span class=filename>/bin/cat</span> usando o <code>touch</code> e execute o comando de verificação novamente:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># touch /bin/cat</span>
<span class=c># mtree -s 3483151339707503 -p /bin &lt; /root/.bin_chksum_mtree &gt;&gt; /root/.bin_chksum_output</span>
<span class=c># more /root/.bin_chksum_output</span>
<span class=nb>cat </span>changed
	modification <span class=nb>time </span>expected Fri Sep 27 06:32:55 2013 found Mon Feb  3 10:28:43 2014</code></pre></div></div><div class=paragraph><p>Recomenda-se criar especificações para os diretórios que contêm binários e arquivos de configuração, bem como quaisquer diretórios que contenham dados sensíveis. Normalmente, as especificações são criadas para <span class=filename>/bin</span>, <span class=filename>/sbin</span>, <span class=filename>/usr/bin</span>, <span class=filename>/usr/sbin</span>, <span class=filename>/usr/local/bin</span>, <span class=filename>/etc</span> e <span class=filename>/usr/local/etc</span>.</p></div><div class=paragraph><p>Existem sistemas de IDS mais avançados, como o <a class=package href=https://cgit.freebsd.org/ports/tree/security/aide/>security/aide</a>. Na maioria dos casos, o <code>mtree</code> fornece a funcionalidade que os administradores precisam. É importante manter o valor inicial e a saída do checksum oculta de usuários mal-intencionados. Maiores informações sobre o <code>mtree</code> podem ser encontradas em <a href="https://man.freebsd.org/cgi/man.cgi?query=mtree&amp;sektion=8&amp;format=html">mtree(8)</a>.</p></div></div><div class=sect2><h3 id=security-tuning>13.2.7. Otimizando o Sistema para Segurança<a class=anchor href=#security-tuning></a></h3><div class=paragraph><p>No FreeBSD, muitos recursos do sistema podem ser ajustados usando o <code>sysctl</code>. Alguns dos recursos de segurança que podem ser ajustados para impedir ataques de negação de serviço (DoS) serão abordados nesta seção. Mais informações sobre o uso do <code>sysctl</code>, incluindo como alterar temporariamente os valores e como tornar as alterações permanentes após o teste, podem ser encontradas em <a href=../config/#configtuning-sysctl>Efetuando ajustes com o sysctl(8)</a>.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Sempre que uma configuração é alterada com o <code>sysctl</code>, a chance de causar danos indesejados é aumentada, afetando a disponibilidade do sistema. Todas as alterações devem ser monitoradas e, se possível, testadas em um sistema de teste antes de serem usadas em um sistema de produção.</p></div></td></tr></tbody></table></div><div class=paragraph><p>Por padrão, o kernel do FreeBSD é inicializado com um nível de segurança <code>-1</code>. Isso é chamado de "modo inseguro" porque as flags de arquivos imutáveis podem ser desativadas e todos os dispositivos podem ser lidos ou gravados. O nível de segurança permanecerá em <code>-1</code>, a menos que seja alterado através do <code>sysctl</code> ou por uma configuração nos scripts de inicialização. O nível de segurança pode ser aumentado durante a inicialização do sistema, definindo <code>kern_securelevel_enable</code> para <code>YES</code> no arquivo <span class=filename>/etc/rc.conf</span>, e o valor de <code>kern_securelevel</code> para o nível de segurança desejado. Veja <a href="https://man.freebsd.org/cgi/man.cgi?query=security&amp;sektion=7&amp;format=html">security(7)</a> e <a href="https://man.freebsd.org/cgi/man.cgi?query=init&amp;sektion=8&amp;format=html">init(8)</a> para maiores informações sobre essas configurações e os níveis de segurança disponíveis.</p></div><div class="admonitionblock warning"><table><tbody><tr><td class=icon><i class="fa icon-warning" title=Warning></i></td><td class=content><div class=paragraph><p>Aumentar o valor da variável <code>securelevel</code> pode quebrar o Xorg e causar outros problemas. Esteja preparado para fazer alguma depuração.</p></div></td></tr></tbody></table></div><div class=paragraph><p>As configurações da variável <code>net.inet.tcp.blackhole</code> e <code>net.inet.udp.blackhole</code> podem ser usadas para descartar pacotes SYN de entrada em portas fechadas sem enviar uma resposta RST. O comportamento padrão é retornar um RST para mostrar que uma porta está fechada. A alteração do padrão fornece algum nível de proteção contra varreduras de portas, que são usadas para determinar quais aplicativos estão sendo executados em um sistema. Defina <code>net.inet.tcp.blackhole</code> para <code>2</code> e <code>net.inet.udp.blackhole</code> para <code>1</code>. Consulte <a href="https://man.freebsd.org/cgi/man.cgi?query=blackhole&amp;sektion=4&amp;format=html">blackhole(4)</a> para obter maiores informações sobre essas configurações.</p></div><div class=paragraph><p>As configurações das variáveis <code>net.inet.icmp.drop_redirect</code> e <code>net.inet.ip.redirect</code> ajudam a evitar <em>ataques de redirecionamento</em>. Um ataque de redirecionamento é um tipo de DoS que envia um grande número de pacotes ICMP tipo 5. Como esses pacotes não são necessários, configure <code>net.inet.icmp.drop_redirect</code> para <code>1</code> e configure <code>net.inet.ip.redirect</code> para <code>0</code>.</p></div><div class=paragraph><p>O roteamento de origem é um método para detectar e acessar endereços não roteáveis na rede interna. Isso deve ser desativado, pois endereços não roteáveis normalmente não são roteáveis de propósito. Para desativar este recurso, defina <code>net.inet.ip.sourceroute</code> e <code>net.inet.ip.accept_sourceroute</code> como <code>0</code>.</p></div><div class=paragraph><p>Quando uma máquina na rede precisa enviar mensagens para todos os hosts em uma sub-rede, uma mensagem de solicitação echo do ICMP é enviada para o endereço de broadcast. No entanto, não há motivo para um host externo executar essa ação. Para rejeitar todas as solicitações externas de transmissão, defina <code>net.inet.icmp.bmcastecho</code> como <code>0</code>.</p></div><div class=paragraph><p>Algumas configurações adicionais estão documentadas em <a href="https://man.freebsd.org/cgi/man.cgi?query=security&amp;sektion=7&amp;format=html">security(7)</a>.</p></div></div></div></div><div class=sect1><h2 id=one-time-passwords>13.3. Senhas de Uso Unico<a class=anchor href=#one-time-passwords></a></h2><div class=sectionbody><div class=paragraph><p>Por padrão, o FreeBSD inclui suporte para senhas de uso único em tudo (OPIE). O OPIE é projetado para evitar ataques repetidos, nos quais um atacante descobre a senha de um usuário e a usa para acessar um sistema. Como uma senha é usada apenas uma vez em OPIE, uma senha descoberta é de pouca utilidade para um invasor. O OPIE usa um hash seguro e um sistema de desafio/resposta para gerenciar senhas. A implementação do FreeBSD usa o hash MD5 por padrão.</p></div><div class=paragraph><p>O OPIE usa três tipos diferentes de senhas. A primeira é a senha usual UNIX™ ou Kerberos. A segunda é a senha única que é gerada pelo <code>opiekey</code>. O terceiro tipo de senha é a "senha secreta" que é usada para gerar senhas de uso único. A senha secreta não tem nada a fazer com ela e deve ser diferente da senha UNIX™.</p></div><div class=paragraph><p>Existem duas outras partes de dados importantes para o OPIE. Uma é o "seed" ou "chave", composta por duas letras e cinco dígitos. A outra é a "contagem de iteração", um número entre 1 e 100. O OPIE cria a senha única concatenando o seed e a senha secreta, aplicando o hash MD5 quantas vezes forem especificadas pela contagem de iterações e transformando o resultado em seis palavras inglesas curtas que representam a senha de uso único. O sistema de autenticação controla a última senha descartável usada e o usuário é autenticado se o hash da senha fornecida pelo usuário for igual à senha anterior. Como um hash unidirecional é usado, é impossível gerar futuras senhas de uso único se uma senha usada com êxito for capturada. A contagem de iteração é diminuída após cada login bem-sucedido para manter o usuário e o programa de login em sincronia. Quando a contagem de iterações descer para <code>1</code>, o OPIE deve ser reinicializado.</p></div><div class=paragraph><p>Existem alguns programas envolvidos neste processo. Uma senha de uso único, ou uma lista consecutiva de senhas de uso único, é gerada passando uma contagem de iteração, um seed e uma senha secreta para o <a href="https://man.freebsd.org/cgi/man.cgi?query=opiekey&amp;sektion=1&amp;format=html">opiekey(1)</a>. Além de inicializar o OPIE, o <a href="https://man.freebsd.org/cgi/man.cgi?query=opiepasswd&amp;sektion=1&amp;format=html">opiepasswd(1)</a> é usado para alterar senhas, contagens de iteração ou seeds. Os arquivos de credenciais relevantes em <span class=filename>/etc/opiekeys</span> são examinados pelo <a href="https://man.freebsd.org/cgi/man.cgi?query=opieinfo&amp;sektion=1&amp;format=html">opieinfo(1)</a> o qual imprime a iteração atual e o seed do usuário solicitante atual.</p></div><div class=paragraph><p>Esta seção descreve quatro tipos diferentes de operações. A primeira é como configurar senhas de uso único pela primeira vez em uma conexão segura. A segunda é como usar o <code>opiepasswd</code> em uma conexão insegura. A terceira é como efetuar login em uma conexão insegura. A quarta é como gerar um número de chaves que podem ser escritas ou impressas para uso em locais inseguros.</p></div><div class=sect2><h3 id=_inicializando_o_opie>13.3.1. Inicializando o OPIE<a class=anchor href=#_inicializando_o_opie></a></h3><div class=paragraph><p>Para inicializar o OPIE pela primeira vez, execute este comando a partir de um local seguro:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>% opiepasswd <span class=nt>-c</span>
Adding unfurl:
Only use this method from the console<span class=p>;</span> NEVER from remote. If you are using
telnet, xterm, or a dial-in, <span class=nb>type</span> ^C now or <span class=nb>exit </span>with no password.
Then run opiepasswd without the <span class=nt>-c</span> parameter.
Using MD5 to compute responses.
Enter new secret pass phrase:
Again new secret pass phrase:

ID unfurl OTP key is 499 to4268
MOS MALL GOAT ARM AVID COED</code></pre></div></div><div class=paragraph><p>A opção <code>-c</code> define o modo de console que assume que o comando está sendo executado de um local seguro, como um computador sob o controle do usuário ou uma sessão SSH para um computador sob o controle do usuário.</p></div><div class=paragraph><p>Quando solicitado, insira a senha secreta que será usada para gerar as chaves de login de uso único. Essa senha deve ser difícil de adivinhar e deve ser diferente da senha associada à conta de login do usuário. Deve ter entre 10 e 127 caracteres. Lembre-se desta senha.</p></div><div class=paragraph><p>A linha <code>ID</code> lista o nome de login (<code>unfurl</code>), a contagem de iterações padrão (<code>499</code>) e o seed padrão (<code>to4268</code>). Ao efetuar o login, o sistema lembrará esses parâmetros e os exibirá, o que significa que eles não precisam ser memorizados. A última linha lista a senha única gerada que corresponde a esses parâmetros e a senha secreta. No próximo login, use essa senha única.</p></div></div><div class=sect2><h3 id=_inicialização_de_uma_conexão_insegura>13.3.2. Inicialização de uma Conexão Insegura<a class=anchor href=#_inicialização_de_uma_conexão_insegura></a></h3><div class=paragraph><p>Para inicializar ou alterar a senha secreta em um sistema inseguro, é necessária uma conexão segura em algum lugar onde o <code>opiekey</code> possa ser executado. Isso pode ser um prompt de shell em uma máquina confiável. Uma contagem de iteração é necessária, em que 100 é provavelmente um bom valor, e o seed pode ser especificado ou a gerado aleatoriamente. Na conexão insegura, a máquina sendo inicializada, use <a href="https://man.freebsd.org/cgi/man.cgi?query=opiepasswd&amp;sektion=1&amp;format=html">opiepasswd(1)</a>:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>% opiepasswd

Updating unfurl:
You need the response from an OTP generator.
Old secret pass phrase:
	otp-md5 498 to4268 ext
	Response: GAME GAG WELT OUT DOWN CHAT
New secret pass phrase:
	otp-md5 499 to4269
	Response: LINE PAP MILK NELL BUOY TROY

ID mark OTP key is 499 gr4269
LINE PAP MILK NELL BUOY TROY</code></pre></div></div><div class=paragraph><p>Para aceitar o seed padrão, pressione <kbd>Return</kbd>. Antes de inserir uma senha de acesso, passe para a conexão segura e forneça os mesmos parâmetros:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>% opiekey 498 to4268
Using the MD5 algorithm to compute response.
Reminder: Do not use opiekey from telnet or dial-in sessions.
Enter secret pass phrase:
GAME GAG WELT OUT DOWN CHAT</code></pre></div></div><div class=paragraph><p>Volte para a conexão insegura e copie a senha única gerada para o programa relevante.</p></div></div><div class=sect2><h3 id=_gerando_uma_senha_de_uso_único>13.3.3. Gerando uma Senha de Uso Único<a class=anchor href=#_gerando_uma_senha_de_uso_único></a></h3><div class=paragraph><p>Depois de inicializar o OPIE e efetuar login, um prompt como este será exibido:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>% telnet example.com
Trying 10.0.0.1...
Connected to example.com
Escape character is <span class=s1>&#39;^]&#39;</span><span class=nb>.</span>

FreeBSD/i386 <span class=o>(</span>example.com<span class=o>)</span> <span class=o>(</span>ttypa<span class=o>)</span>

login: &lt;username&gt;
otp-md5 498 gr4269 ext
Password:</code></pre></div></div><div class=paragraph><p>Os prompts do OPIE fornecem um recurso útil. Se o <kbd>Enter</kbd> for pressionado no prompt de senha, o prompt ativará o echo e exibirá o que foi digitado. Isso pode ser útil ao tentar digitar uma senha manualmente a partir de uma impressão.</p></div><div class=paragraph><p>Neste ponto, gere a senha de uso único para responder a este aviso de login. Isso deve ser feito em um sistema confiável em que seja seguro executar o <a href="https://man.freebsd.org/cgi/man.cgi?query=opiekey&amp;sektion=1&amp;format=html">opiekey(1)</a>. Existem versões deste comando para Windows™, Mac OS™ e FreeBSD. Esse comando precisa da contagem de iteração e do seed como opções da linha de comandos. Use recortar e colar no prompt de login da máquina que está sendo conectada.</p></div><div class=paragraph><p>No sistema confiável:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>% opiekey 498 to4268
Using the MD5 algorithm to compute response.
Reminder: Do not use opiekey from telnet or dial-in sessions.
Enter secret pass phrase:
GAME GAG WELT OUT DOWN CHAT</code></pre></div></div><div class=paragraph><p>Depois que a senha descartável for gerada, continue a logar.</p></div></div><div class=sect2><h3 id=_gerando_múltiplas_senhas_de_uso_único>13.3.4. Gerando Múltiplas Senhas de Uso Único<a class=anchor href=#_gerando_múltiplas_senhas_de_uso_único></a></h3><div class=paragraph><p>Às vezes, não há acesso a uma máquina confiável ou conexão segura. Neste caso, é possível usar o <a href="https://man.freebsd.org/cgi/man.cgi?query=opiekey&amp;sektion=1&amp;format=html">opiekey(1)</a> para gerar algumas de senhas de uso único antecipadamente. Por exemplo:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>% opiekey <span class=nt>-n</span> 5 30 zz99999
Using the MD5 algorithm to compute response.
Reminder: Do not use opiekey from telnet or dial-in sessions.
Enter secret pass phrase: &lt;secret password&gt;
26: JOAN BORE FOSS DES NAY QUIT
27: LATE BIAS SLAY FOLK MUCH TRIG
28: SALT TIN ANTI LOON NEAL USE
29: RIO ODIN GO BYE FURY TIC
30: GREW JIVE SAN GIRD BOIL PHI</code></pre></div></div><div class=paragraph><p>A opção <code>-n 5</code> solicita cinco chaves em seqüência e <code>30</code> especifica qual deve ser o último número de iteração. Note que estes são impressos na ordem <em>reversa</em> de uso. O usuário realmente paranóico pode querer escrever os resultados manualmente; caso contrário, imprima a lista. Cada linha mostra a contagem de iteração e a senha de uso único. Risque as senhas conforme elas forem usadas.</p></div></div><div class=sect2><h3 id=_restringindo_o_uso_de_senhas_unix>13.3.5. Restringindo o Uso de Senhas UNIX™<a class=anchor href=#_restringindo_o_uso_de_senhas_unix></a></h3><div class=paragraph><p>O OPIE pode restringir o uso de senhas UNIX™ com base no endereço IP de uma sessão de login. O arquivo relevante é o <span class=filename>/etc/opieaccess</span>, que está presente por padrão. Consulte <a href="https://man.freebsd.org/cgi/man.cgi?query=opieaccess&amp;sektion=5&amp;format=html">opieaccess(5)</a> para obter maiores informações sobre esse arquivo e sobre quais considerações de segurança você deve estar ciente ao usá-lo.</p></div><div class=paragraph><p>Aqui está um exemplo do arquivo <span class=filename>opieaccess</span>:</p></div><div class="literalblock programlisting"><div class=content><pre>permit 192.168.0.0 255.255.0.0</pre></div></div><div class=paragraph><p>Esta linha permite que os usuários cujo endereço de origem IP (que é vulnerável a spoofing) corresponda ao valor e à máscara especificados, para usar as senhas UNIX™ a qualquer momento.</p></div><div class=paragraph><p>Se nenhuma regra do arquivo <span class=filename>opieaccess</span> for correspondida, o padrão é negar logins que não sejam OPIE.</p></div></div></div></div><div class=sect1><h2 id=tcpwrappers>13.4. TCP Wrapper<a class=anchor href=#tcpwrappers></a></h2><div class=sectionbody><div class=paragraph><p>O TCP Wrapper é um sistema de controle de acesso baseado em host que estende as habilidades do <a href=../network-servers/#network-inetd>O super-servidor inetd</a>. Ele pode ser configurado para fornecer suporte de registro, mensagens de retorno e restrições de conexão para os daemons do servidor sob o controle do inetd. Consulte <a href="https://man.freebsd.org/cgi/man.cgi?query=tcpd&amp;sektion=8&amp;format=html">tcpd(8)</a> para obter maiores informações sobre o TCP Wrapper e seus recursos.</p></div><div class=paragraph><p>O TCP Wrapper não deve ser considerado um substituto para um firewall configurado adequadamente. Em vez disso, TCP Wrapper deve ser usado em conjunto com um firewall e outros aprimoramentos de segurança para fornecer outra camada de proteção na implementação de uma política de segurança.</p></div><div class=sect2><h3 id=_configuração_inicial>13.4.1. Configuração Inicial<a class=anchor href=#_configuração_inicial></a></h3><div class=paragraph><p>Para ativar o TCP Wrapper no FreeBSD, adicione as seguintes linhas ao arquivo <span class=filename>/etc/rc.conf</span>:</p></div><div class="literalblock programlisting"><div class=content><pre>inetd_enable=&#34;YES&#34;
inetd_flags=&#34;-Ww&#34;</pre></div></div><div class=paragraph><p>Então, configure corretamente o arquivo <span class=filename>/etc/hosts.allow</span>.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Ao contrário de outras implementações do TCP Wrapper, o uso do arquivo <span class=filename>hosts.deny</span> foi preterido no FreeBSD. Todas as opções de configuração devem ser colocadas no arquivo <span class=filename>/etc/hosts.allow</span>.</p></div></td></tr></tbody></table></div><div class=paragraph><p>Na configuração mais simples, as políticas de conexão do daemon são configuradas para permitir ou bloquear, dependendo das opções no arquivo <span class=filename>/etc/hosts.allow</span>. A configuração padrão no FreeBSD é permitir todas as conexões para os daemons iniciados com o inetd.</p></div><div class=paragraph><p>A configuração básica geralmente assume a forma de <code>daemon : address : action</code>, onde <code>daemon</code> é o daemon que o inetd iniciou, <code>address</code> é um nome de host válido ou um endereço IP ou um endereço IPv6 entre colchetes ([]) e <code>action</code> é <code>allow</code> ou <code>deny</code>. O TCP Wrapper usa uma semântica de correspondência de primeira regra, o que significa que o arquivo de configuração é varrido desde o início para uma regra correspondente. Quando uma correspondência é encontrada, a regra é aplicada e o processo de pesquisa é interrompido.</p></div><div class=paragraph><p>Por exemplo, para permitir conexões POP3 através do daemon <a class=package href=https://cgit.freebsd.org/ports/tree/mail/qpopper/>mail/qpopper</a>, as seguintes linhas devem ser anexadas ao arquivo <span class=filename>hosts.allow</span>:</p></div><div class="literalblock programlisting"><div class=content><pre># This line is required for POP3 connections:
qpopper : ALL : allow</pre></div></div><div class=paragraph><p>Sempre que este arquivo for editado, reinicie o inetd:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># service inetd restart</span></code></pre></div></div></div><div class=sect2><h3 id=_configuração_avançada>13.4.2. Configuração Avançada<a class=anchor href=#_configuração_avançada></a></h3><div class=paragraph><p>O TCP Wrapper fornece opções avançadas para permitir mais controle sobre o modo como as conexões são tratadas. Em alguns casos, pode ser apropriado retornar um comentário para determinados hosts ou conexões de daemon. Em outros casos, uma entrada de log deve ser registrada ou um email enviado ao administrador. Outras situações podem exigir o uso de um serviço apenas para conexões locais. Isso tudo é possível através do uso de opções de configuração conhecidas como wildcards, caracteres de expansão e execução de comandos externos.</p></div><div class=paragraph><p>Suponha que uma situação ocorra onde uma conexão deva ser negada, mas uma razão deve ser enviada ao host que tentou estabelecer essa conexão. Essa ação é possível com a opção <code>twist</code>. Quando uma tentativa de conexão é feita, o <code>twist</code> executa um comando ou script shell. Existe um exemplo no arquivo <span class=filename>hosts.allow</span>:</p></div><div class="literalblock programlisting"><div class=content><pre># The rest of the daemons are protected.
ALL : ALL \
	: severity auth.info \
	: twist /bin/echo &#34;You are not welcome to use %d from %h.&#34;</pre></div></div><div class=paragraph><p>Neste exemplo, a mensagem "You are not allowed to use <em>daemon name</em> from <em>hostname</em>." será retornada para qualquer daemon não configurado no <span class=filename>hosts.allow</span>. Isso é útil para enviar uma resposta de volta ao inicializador de conexão logo após a conexão estabelecida ser descartada. Qualquer mensagem a ser retornada <em>deve</em> ser delimitada por caracteres de aspas duplas (<code>"</code>).</p></div><div class="admonitionblock warning"><table><tbody><tr><td class=icon><i class="fa icon-warning" title=Warning></i></td><td class=content><div class=paragraph><p>Pode ser possível iniciar um ataque de negação de serviço no servidor se um invasor inunda esses daemons com solicitações de conexão.</p></div></td></tr></tbody></table></div><div class=paragraph><p>Outra possibilidade é usar a opção <code>spawn</code>. Como a opção <code>twist</code>, a opção <code>spawn</code> implicitamente nega a conexão e pode ser usado para executar comandos ou scripts externos do shell. Ao contrário da <code>twist</code>, a <code>spawn</code> não enviará uma resposta ao host que estabeleceu a conexão. Por exemplo, considere a seguinte configuração:</p></div><div class="literalblock programlisting"><div class=content><pre># We do not allow connections from example.com:
ALL : .example.com \
	: spawn (/bin/echo %a from %h attempted to access %d &gt;&gt; \
	  /var/log/connections.log) \
	: deny</pre></div></div><div class=paragraph><p>Isso negará todas as tentativas de conexão de <code>*.example.com</code> e registrará o nome do host, endereço IP e o daemon ao qual o acesso foi tentado no arquivo <span class=filename>/var/log/connections.log</span>. Este exemplo usa os caracteres de substituição <code>%a</code> e <code>%h</code>. Consulte <a href="https://man.freebsd.org/cgi/man.cgi?query=hosts_access&amp;sektion=5&amp;format=html">hosts_access(5)</a> para a lista completa.</p></div><div class=paragraph><p>Para corresponder a cada instância de um daemon, domínio ou endereço IP, use <code>ALL</code>. Outro wildcard é o <code>PARANOID</code>, que pode ser usado para corresponder a qualquer host que forneça um endereço IP que possa ser forjado, porque o endereço IP difere do nome resolvido para o host. Neste exemplo, todas as solicitações de conexão para o Sendmail que possuem um endereço IP que varia de seu nome de host serão negadas:</p></div><div class="literalblock programlisting"><div class=content><pre># Block possibly spoofed requests to sendmail:
sendmail : PARANOID : deny</pre></div></div><div class="admonitionblock caution"><table><tbody><tr><td class=icon><i class="fa icon-caution" title=Caution></i></td><td class=content><div class=paragraph><p>Usar o wildcard <code>PARANOID</code> resultará em conexões negadas se o cliente ou servidor tiver uma configuração de DNS incorreta.</p></div></td></tr></tbody></table></div><div class=paragraph><p>Para saber mais sobre wildcards e sua funcionalidade associada, consulte <a href="https://man.freebsd.org/cgi/man.cgi?query=hosts_access&amp;sektion=5&amp;format=html">hosts_access(5)</a>.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Ao adicionar novas linhas de configuração, certifique-se de que quaisquer entradas desnecessárias para esse daemon sejam comentadas no arquivo <span class=filename>hosts.allow</span>.</p></div></td></tr></tbody></table></div></div></div></div><div class=sect1><h2 id=kerberos5>13.5. Kerberos<a class=anchor href=#kerberos5></a></h2><div class=sectionbody><div class=paragraph><p>O Kerberos é um protocolo de autenticação de rede que foi originalmente criado pelo Instituto de Tecnologia de Massachusetts (MIT) como uma maneira segura de fornecer autenticação em uma rede potencialmente hostil. O protocolo Kerberos usa criptografia robusta para que tanto um cliente quanto um servidor possam provar sua identidade sem enviar nenhum segredo não criptografado pela rede. O Kerberos pode ser descrito como um sistema proxy de verificação de identidade e como um sistema confiável de autenticação de terceiros. Depois que um usuário autentica com Kerberos, suas comunicações podem ser criptografadas para garantir privacidade e integridade dos dados.</p></div><div class=paragraph><p>A única função do Kerberos é fornecer a autenticação segura de usuários e servidores na rede. Ele não fornece funções de autorização ou auditoria. Recomenda-se que o Kerberos seja usado com outros métodos de segurança que forneçam serviços de autorização e auditoria.</p></div><div class=paragraph><p>A versão atual do protocolo é a versão 5, descrita na RFC 4120. Várias implementações gratuitas deste protocolo estão disponíveis, abrangendo uma ampla gama de sistemas operacionais. O MIT continua desenvolvendo o pacote Kerberos. É comumente usado no US como um produto de criptografia e, historicamente, está sujeito aos regulamentos de exportação dos US. No FreeBSD, o MITKerberos está disponível como o pacote ou port <a class=package href=https://cgit.freebsd.org/ports/tree/security/krb5/>security/krb5</a>. A implementação do Kerberos do Heimdal foi explicitamente desenvolvida fora do US para evitar regulamentações de exportação. A distribuição Kerberos do Heimdal está incluída na instalação base do FreeBSD, e outra distribuição com opções mais configuráveis está disponível como <a class=package href=https://cgit.freebsd.org/ports/tree/security/heimdal/>security/heimdal</a> na Coleção de Ports.</p></div><div class=paragraph><p>No Kerberos, os usuários e serviços são identificados como "principals", que estão contidos em um agrupamento administrativo chamado de "realm". Um usuário principal típico teria o formato <code><em>user</em>@<em>REALM</em></code> (os realms são tradicionalmente em caracteres maiúsculos).</p></div><div class=paragraph><p>Esta seção fornece um guia sobre como configurar o Kerberos usando a distribuição Heimdal incluída no FreeBSD.</p></div><div class=paragraph><p>Para fins de demonstração de uma instalação do Kerberos , os namespaces serão os seguintes:</p></div><div class=ulist><ul><li><p>O domínio (zona) de domínio DNS será <code>example.org</code>.</p></li><li><p>O realm Kerberos será <code>EXAMPLE.ORG</code>.</p></li></ul></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Use nomes de domínio reais ao configurar o Kerberos, mesmo que ele seja executado internamente. Isso evita problemas de DNS e garante a interoperabilidade com outros realms do Kerberos.</p></div></td></tr></tbody></table></div><div class=sect2><h3 id=_configurando_um_kdc_do_heimdal>13.5.1. Configurando um KDC do Heimdal<a class=anchor href=#_configurando_um_kdc_do_heimdal></a></h3><div class=paragraph><p>O Centro de Distribuição de Chaves (KDC) é o serviço de autenticação centralizada que o Kerberos fornece, a "a parte de terceiros confiáveis" do sistema. É o computador que emite os tíquetes Kerberos, que são usados para autenticação dos clientes nos servidores. Como o KDC é considerado confiável por todos os outros computadores no realm do Kerberos, isso aumenta as preocupações com a segurança. O acesso direto ao KDC deve ser limitado.</p></div><div class=paragraph><p>Embora a execução de um KDC exija poucos recursos de computação, uma máquina dedicada que atua apenas como um KDC é recomendada por motivos de segurança.</p></div><div class=paragraph><p>Para começar, instale o pacote <a class=package href=https://cgit.freebsd.org/ports/tree/security/heimdal/>security/heimdal</a> assim:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># pkg install heimdal</span></code></pre></div></div><div class=paragraph><p>Em seguida, edite o <span class=filename>/etc/rc.conf</span> como a seguir:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># sysrc kdc_enable=yes</span>
<span class=c># sysrc kadmind_enable=yes</span></code></pre></div></div><div class=paragraph><p>Em seguida, edite o arquivo <span class=filename>/etc/krb5.conf</span> como a seguir:</p></div><div class="literalblock programlisting"><div class=content><pre>[libdefaults]
    default_realm = EXAMPLE.ORG
[realms]
    EXAMPLE.ORG = {
	kdc = kerberos.example.org
	admin_server = kerberos.example.org
    }
[domain_realm]
    .example.org = EXAMPLE.ORG</pre></div></div><div class=paragraph><p>Neste exemplo, o KDC usará o nome completo do host <code>kerberos.example.org</code>. O nome do host do KDC precisa ser resolvido no DNS.</p></div><div class=paragraph><p>O Kerberos também pode usar o DNS para localizar os KDCs, em vez de uma seção <code>[realms]</code> no arquivo <span class=filename>/etc/krb5.conf</span>. Para grandes organizações que possuem seus próprios servidores DNS, o exemplo acima pode ser reduzido para:</p></div><div class="literalblock programlisting"><div class=content><pre>[libdefaults]
      default_realm = EXAMPLE.ORG
[domain_realm]
    .example.org = EXAMPLE.ORG</pre></div></div><div class=paragraph><p>Com as seguintes linhas sendo incluídas no arquivo de zona do domínio <code>example.org</code>:</p></div><div class="literalblock programlisting"><div class=content><pre>_kerberos._udp      IN  SRV     01 00 88 kerberos.example.org.
_kerberos._tcp      IN  SRV     01 00 88 kerberos.example.org.
_kpasswd._udp       IN  SRV     01 00 464 kerberos.example.org.
_kerberos-adm._tcp  IN  SRV     01 00 749 kerberos.example.org.
_kerberos           IN  TXT     EXAMPLE.ORG</pre></div></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Para que os clientes possam encontrar os serviços Kerberos, eles <em>devem</em> ter um <span class=filename>/etc/krb5.conf</span> totalmente configurado ou um <span class=filename>/etc/krb5.conf</span> minimamente configurado <em>e</em> um servidor DNS corretamente configurado.</p></div></td></tr></tbody></table></div><div class=paragraph><p>Em seguida, crie o banco de dados do Kerberos que contém as chaves de todos os principals (usuários e hosts) criptografados com uma senha master. Não é necessário lembrar essa senha, pois ela será armazenada no arquivo <span class=filename>/var/heimdal/m-key</span>; Seria razoável usar uma senha aleatória de 45 caracteres para essa finalidade. Para criar a chave master, execute <code>kstash</code> e digite uma senha:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># kstash</span>
Master key: xxxxxxxxxxxxxxxxxxxxxxx
Verifying password - Master key: xxxxxxxxxxxxxxxxxxxxxxx</code></pre></div></div><div class=paragraph><p>Depois que a chave master é criada, o banco de dados deve ser inicializado. A ferramenta administrativa do Kerberos<a href="https://man.freebsd.org/cgi/man.cgi?query=kadmin&amp;sektion=8&amp;format=html">kadmin(8)</a> pode ser usada no KDC em um modo que opera diretamente no banco de dados, sem usar o serviço de rede <a href="https://man.freebsd.org/cgi/man.cgi?query=kadmind&amp;sektion=8&amp;format=html">kadmind(8)</a>, como <code>kadmin -l</code>. Isso resolve o problema do ovo e da galinha de tentar se conectar ao banco de dados antes de criá-lo. No prompt do <code>kadmin</code>, use o <code>init</code> para criar o banco de dados inicial do realm:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># kadmin -l</span>
kadmin&gt; init EXAMPLE.ORG
Realm max ticket life <span class=o>[</span>unlimited]:</code></pre></div></div><div class=paragraph><p>Por fim, enquanto ainda estiver no <code>kadmin</code>, crie o primeiro principal usando <code>add</code>. Atenha-se às opções padrão para o principal por enquanto, pois elas podem ser alteradas posteriormente com <code>modify</code>. Digite <code>?</code> no prompt para ver as opções disponíveis.</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>kadmin&gt; add tillman
Max ticket life <span class=o>[</span>unlimited]:
Max renewable life <span class=o>[</span>unlimited]:
Principal expiration <span class=nb>time</span> <span class=o>[</span>never]:
Password expiration <span class=nb>time</span> <span class=o>[</span>never]:
Attributes <span class=o>[]</span>:
Password: xxxxxxxx
Verifying password - Password: xxxxxxxx</code></pre></div></div><div class=paragraph><p>Em seguida, inicie o serviço KDC executando:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># service kdc start</span>
<span class=c># service kadmind start</span></code></pre></div></div><div class=paragraph><p>Embora não tenha nenhum daemon do kerberos em execução neste ponto, é possível confirmar que o KDC está funcionando obtendo um ticket para o principal que acabou de ser criado:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>% kinit tillman
tillman@EXAMPLE.ORG<span class=s1>&#39;s Password:</span></code></pre></div></div><div class=paragraph><p>Confirme se um ticket foi obtido com sucesso usando <code>klist</code>:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>% klist
Credentials cache: FILE:/tmp/krb5cc_1001
	Principal: tillman@EXAMPLE.ORG

  Issued                Expires               Principal
Aug 27 15:37:58 2013  Aug 28 01:37:58 2013  krbtgt/EXAMPLE.ORG@EXAMPLE.ORG</code></pre></div></div><div class=paragraph><p>O ticket temporário pode ser destruído quando o teste terminar:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>% kdestroy</code></pre></div></div></div><div class=sect2><h3 id=_configurando_um_servidor_para_usar_o_kerberos>13.5.2. Configurando um Servidor para Usar o Kerberos<a class=anchor href=#_configurando_um_servidor_para_usar_o_kerberos></a></h3><div class=paragraph><p>A primeira etapa na configuração de um servidor para usar a autenticação Kerberos é garantir que ele tenha a configuração correta no arquivo <span class=filename>/etc/krb5.conf</span>. A versão do KDC pode ser usada como está, ou pode ser regenerada no novo sistema.</p></div><div class=paragraph><p>Em seguida, crie o arquivo <span class=filename>/etc/krb5.keytab</span> no servidor. Esta é a parte principal de "Kerberizar" um serviço - ele corresponde a gerar uma chave secreta compartilhada entre o serviço e o KDC. O segredo é uma chave criptográfica, armazenada em um "keytab". O keytab contém a chave do host do servidor, que permite que ele e o KDC verifiquem a identidade um do outro. Ele deve ser transmitido para o servidor de maneira segura, pois a segurança do servidor pode ser quebrada se a chave for tornada pública. Normalmente, o <span class=filename>keytab</span> é gerado na máquina confiável de um administrador usando o <code>kadmin</code>, e então transferido com segurança para o servidor, por exemplo, com <a href="https://man.freebsd.org/cgi/man.cgi?query=scp&amp;sektion=1&amp;format=html">scp(1)</a>; Ele também pode ser criado diretamente no servidor, se isso for consistente com a política de segurança desejada. É muito importante que o keytab seja transmitido para o servidor de forma segura: se a chave for conhecida por outra parte, essa parte pode representar qualquer usuário para o servidor! Usar o <code>kadmin</code> diretamente no servidor é conveniente, porque a entrada para o principal do host no banco de dados do KDC também é criada usando o <code>kadmin</code>.</p></div><div class=paragraph><p>Naturalmente, o <code>kadmin</code> é um serviço kerberizado; um tíquete Kerberos é necessário para autenticar-se no serviço de rede, mas para garantir que o usuário que está executando o <code>kadmin</code> esteja presente (e sua sessão não tenha sido invadida), o <code>kadmin</code> solicitará a senha para obter um novo ticket. O principal autenticando no serviço kadmin deve ter permissão para usar a interface <code>kadmin</code>, conforme especificado no arquivo <span class=filename>/var/heimdal/kadmind.acl</span>. Veja a seção intitulada "Administração Remota" em <code>info heimdal</code> para detalhes sobre a criação de listas de controle de acesso. Em vez de ativar o acesso remoto ao <code>kadmin</code>, o administrador pode conectar-se com segurança ao KDC através do console local ou por <a href="https://man.freebsd.org/cgi/man.cgi?query=ssh&amp;sektion=&amp;format=html">ssh()</a> e executar a administração localmente usando o <code>kadmin -l</code>.</p></div><div class=paragraph><p>Depois de instalar o arquivo <span class=filename>/etc/krb5.conf</span>, use o <code>add --random-key</code> no <code>kadmin</code>. Isso adiciona o principal do host do servidor ao banco de dados, mas não extrai uma cópia da chave principal do host para um keytab. Para gerar o keytab, use <code>ext</code> para extrair a chave principal do host do servidor para seu próprio keytab:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># kadmin</span>
kadmin&gt; add <span class=nt>--random-key</span> host/myserver.example.org
Max ticket life <span class=o>[</span>unlimited]:
Max renewable life <span class=o>[</span>unlimited]:
Principal expiration <span class=nb>time</span> <span class=o>[</span>never]:
Password expiration <span class=nb>time</span> <span class=o>[</span>never]:
Attributes <span class=o>[]</span>:
kadmin&gt; ext_keytab host/myserver.example.org
kadmin&gt; <span class=nb>exit</span></code></pre></div></div><div class=paragraph><p>Note que o <code>ext_keytab</code> por padrão armazena a chave extraída no arquivo <span class=filename>/etc/krb5.keytab</span>. Isso é bom quando executado no servidor que está sendo kerberizado, mas o argumento <code>--keytab <em>path/to/file</em></code> deve ser usado quando o keytab estiver sendo extraído em outro lugar:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># kadmin</span>
kadmin&gt; ext_keytab <span class=nt>--keytab</span><span class=o>=</span>/tmp/example.keytab host/myserver.example.org
kadmin&gt; <span class=nb>exit</span></code></pre></div></div><div class=paragraph><p>O keytab pode então ser copiado com segurança para o servidor usando o <a href="https://man.freebsd.org/cgi/man.cgi?query=scp&amp;sektion=1&amp;format=html">scp(1)</a> ou uma mídia removível. Certifique-se de especificar um nome de keytab não padrão para evitar a inserção de chaves desnecessárias na keytab do sistema.</p></div><div class=paragraph><p>Neste ponto, o servidor pode ler mensagens criptografadas do KDC usando sua chave compartilhada, armazenada no arquivo <span class=filename>krb5.keytab</span>. Agora ele está pronto para ativar os serviços de uso do Kerberos. Um dos serviços mais comuns é o <a href="https://man.freebsd.org/cgi/man.cgi?query=sshd&amp;sektion=8&amp;format=html">sshd(8)</a>, que suporta o Kerberos através do GSS-API. No arquivo <span class=filename>/etc/ssh/sshd_config</span>, adicione a linha:</p></div><div class="literalblock programlisting"><div class=content><pre>GSSAPIAuthentication yes</pre></div></div><div class=paragraph><p>Depois de fazer essa alteração, o <a href="https://man.freebsd.org/cgi/man.cgi?query=sshd&amp;sektion=8&amp;format=html">sshd(8)</a> deve ser reiniciado para que a nova configuração tenha efeito: <code>service sshd restart</code>.</p></div></div><div class=sect2><h3 id=_configurando_um_cliente_para_usar_o_kerberos>13.5.3. Configurando um cliente para usar o Kerberos<a class=anchor href=#_configurando_um_cliente_para_usar_o_kerberos></a></h3><div class=paragraph><p>Assim como foi no servidor, o cliente requer configuração no arquivo <span class=filename>/etc/krb5.conf</span>. Copie o arquivo no local (com segurança) ou insira-o novamente conforme necessário.</p></div><div class=paragraph><p>Teste o cliente usando o <code>kinit</code>, <code>klist</code> e <code>kdestroy</code> a partir do cliente para obter, mostrar e excluir um ticket para um principal existente. Os aplicativos Kerberos também devem poder se conectar a servidores habilitados pelo Kerberos. Se isso não funcionar, mas a obtenção de um ticket ocorrer, provavelmente o problema está no servidor e não no cliente ou no KDC. No caso do <a href="https://man.freebsd.org/cgi/man.cgi?query=ssh&amp;sektion=1&amp;format=html">ssh(1)</a> kerberizado, o GSS-API está desabilitado por padrão, portanto teste usando <code>ssh -o GSSAPIAuthentication=yes <em>hostname</em></code>.</p></div><div class=paragraph><p>Ao testar um aplicativo Kerberizado, tente usar um sniffer de pacote, como o <code>tcpdump</code>, para confirmar que nenhuma informação confidencial é enviada sem proteção.</p></div><div class=paragraph><p>Várias aplicações Kerberos cliente estão disponíveis. Com o advento de uma ponte para que aplicações usando SASL para autenticação possam usar mecanismos GSS-API, grandes classes de aplicativos clientes podem usar o Kerberos para autenticação, de clientes Jabber a clientes IMAP.</p></div><div class=paragraph><p>Os usuários em um realm geralmente têm seu principal Kerberos mapeado para uma conta de usuário local. Ocasionalmente, é necessário conceder acesso a uma conta de usuário local a alguém que não tenha um principal Kerberos correspondente. Por exemplo, <code>tillman@EXAMPLE.ORG</code> pode precisar de acesso à conta de usuário local <code>webdevelopers</code>. Outros diretores também podem precisar de acesso a essa conta local.</p></div><div class=paragraph><p>Os arquivos <span class=filename>.k5login</span> e <span class=filename>.k5users</span>, colocados no diretório home de um usuário, podem ser usados para resolver este problema. Por exemplo, se o seguinte <span class=filename>.k5login</span> for colocado no diretório inicial de <code>webdevelopers</code>, os dois principals listados terão acesso a essa conta sem exigir uma senha compartilhada:</p></div><div class="literalblock programlisting"><div class=content><pre>tillman@example.org
jdoe@example.org</pre></div></div><div class=paragraph><p>Consulte <a href="https://man.freebsd.org/cgi/man.cgi?query=ksu&amp;sektion=1&amp;format=html">ksu(1)</a> para obter maiores informações sobre o <span class=filename>.k5users</span>.</p></div></div><div class=sect2><h3 id=_diferenças_com_a_implementação_do_mit>13.5.4. Diferenças com a implementação do MIT<a class=anchor href=#_diferenças_com_a_implementação_do_mit></a></h3><div class=paragraph><p>A principal diferença entre as implementações do MIT e a Heimdal é que o <code>kadmin</code> tem um conjunto de comandos diferente, mas equivalente, e usa um protocolo diferente. Se o KDC for MIT, a versão Heimdal do <code>kadmin</code> não poderá ser usada para administrar o KDC remotamente, e vice versa.</p></div><div class=paragraph><p>Aplicações cliente também podem usar opções de linha de comando ligeiramente diferentes para realizar as mesmas tarefas. Seguir as instruções em <a href=http://web.mit.edu/Kerberos/www/>http://web.mit.edu/Kerberos/www/</a> é recomendado. Cuidado com os problemas de caminho: o port MIT é instalado em <span class=filename>/usr/local/</span> por padrão, e os aplicativos do sistema FreeBSD serão executados em vez das versões do MIT se o <code>PATH</code> listar os diretórios do sistema primeiro.</p></div><div class=paragraph><p>Ao usar o MIT Kerberos como um KDC no FreeBSD, as seguintes edições também devem ser feitas no <span class=filename>rc.conf</span>:</p></div><div class="literalblock programlisting"><div class=content><pre>kdc_program=&#34;/usr/local/sbin/kdc&#34;
kadmind_program=&#34;/usr/local/sbin/kadmind&#34;
kdc_flags=&#34;&#34;
kdc_enable=&#34;YES&#34;
kadmind_enable=&#34;YES&#34;</pre></div></div></div><div class=sect2><h3 id=_dicas_truques_e_solução_de_problemas_do_kerberos>13.5.5. Dicas, Truques e Solução de Problemas do Kerberos<a class=anchor href=#_dicas_truques_e_solução_de_problemas_do_kerberos></a></h3><div class=paragraph><p>Ao configurar e solucionar problemas do Kerberos, tenha em mente os seguintes pontos:</p></div><div class=ulist><ul><li><p>Ao usar o Heimdal ou MITKerberos do ports, certifique-se de que o <code>PATH</code> liste as versões do port dos aplicativos clientes antes das versões do sistema.</p></li><li><p>Se todos os computadores no realm não tiverem configurações de horário sincronizadas, a autenticação poderá falhar. <a href=../network-servers/#network-ntp>Sincronização de Relógio com NTP</a> descreve como sincronizar os relógios usando o NTP.</p></li><li><p>Se o nome do host for alterado, o <code>host/</code> principal deve ser alterado e o keytab atualizado. Isso também se aplica a entradas de keytab especiais como o <code>HTTP/</code> principal usado para o <a class=package href=https://cgit.freebsd.org/ports/tree/www/mod_auth_kerb/>www/mod_auth_kerb</a> do Apache.</p></li><li><p>Todos os hosts no realm devem ser resolvidos tanto de forma direta quanto reversa no DNS ou, no mínimo, no arquivo <span class=filename>/etc/hosts</span>. Os CNAMEs funcionarão, mas os registros A e PTR devem estar corretos e no lugar. A mensagem de erro para hosts não resolvidos não é intuitiva: <code>Kerberos5 refuses authentication because Read req failed: Key table entry not found</code>.</p></li><li><p>Alguns sistemas operacionais que agem como clientes para o KDC não definem as permissões para o <code>ksu</code> para serem setuid <code>root</code>. Isso significa que o <code>ksu</code> não funciona. Este é um problema de permissões, não um erro do KDC.</p></li><li><p>Com o MITKerberos, para permitir que um principal tenha uma duração de ticket maior que a duração padrão de dez horas, use <code>modify_principal</code> no <a href="https://man.freebsd.org/cgi/man.cgi?query=kadmin&amp;sektion=8&amp;format=html">kadmin(8)</a> para alterar o <code>maxlife</code> do principal em questão e do <code>krbtgt</code> principal. O principal pode então usar o <code>kinit -l</code> para solicitar um ticket com uma vida útil mais longa.</p></li><li><p>Ao executar um sniffer de pacotes no KDC para auxiliar na solução de problemas enquanto executa <code>kinit</code> de uma estação de trabalho, o Ticket de Concessão de Tickets (TGT) é enviado imediatamente, mesmo antes da digitação da senha. Isso ocorre porque o servidor Kerberos transmite livremente um TGT para qualquer solicitação não autorizada. No entanto, cada TGT é criptografado em uma chave derivada da senha do usuário. Quando um usuário digita sua senha, ela não é enviada para o KDC, ela é usada para descriptografar o TGT que o <code>kinit</code> já obteve. Se o processo de descriptografia resultar em um tíquete válido com um registro de data e hora válido, o usuário terá credenciais do Kerberos válidas. Essas credenciais incluem uma chave de sessão para estabelecer comunicações seguras com o servidor Kerberos no futuro, bem como o TGT, que é criptografado com a chave do próprio servidor Kerberos. Essa segunda camada de criptografia permite que o servidor Kerberos verifique a autenticidade de cada TGT.</p></li><li><p>Os principals do host podem ter uma vida útil maior do ticket. Se o usuário do principal tiver uma vida útil de uma semana, mas o host ao qual está conectado tiver uma vida útil de nove horas, o cache do usuário terá um host principal expirado e o cache do ticket não funcionará como esperado.</p></li><li><p>Ao configurar o arquivo <span class=filename>krb5.dict</span> para evitar que senhas incorretas específicas sejam usadas, conforme descrito em <a href="https://man.freebsd.org/cgi/man.cgi?query=kadmind&amp;sektion=8&amp;format=html">kadmind(8)</a>, lembre-que só se aplica a entidades que tenham uma política de senha atribuída a elas. O formato usado em <span class=filename>krb5.dict</span> é uma string por linha. Criar um link simbólico para <span class=filename>/usr/shared/dict/words</span> pode ser útil.</p></li></ul></div></div><div class=sect2><h3 id=_atenuando_as_limitações_do_kerberos>13.5.6. Atenuando as Limitações do Kerberos<a class=anchor href=#_atenuando_as_limitações_do_kerberos></a></h3><div class=paragraph><p>Uma vez que com o Kerberos a abordagem é tudo ou nada, cada serviço habilitado na rede deve ser modificado para funcionar com o Kerberos ou ser protegido contra ataques de rede. Isso impede que as credenciais do usuário sejam roubadas e reutilizadas. Um exemplo é quando o Kerberos está habilitado em todos os shells remotos, mas o servidor de email POP3 não-Kerberizado envia senhas em texto simples.</p></div><div class=paragraph><p>O KDC é um ponto único de falha. Por design, o KDC deve ser tão seguro quanto seu banco de dados de senhas master. O KDC não deve ter absolutamente nenhum outro serviço sendo executado e deve estar fisicamente seguro. O perigo é alto porque o Kerberos armazena todas as senhas criptografadas com a mesma chave mestra que é armazenada como um arquivo no KDC.</p></div><div class=paragraph><p>Uma chave mestra comprometida não é tão ruim quanto se pode temer. A chave mestra é usada apenas para criptografar o banco de dados do Kerberos e como um seed para o gerador de números aleatórios. Desde que o acesso ao KDC seja seguro, um invasor não poderá fazer muito com a chave mestra.</p></div><div class=paragraph><p>Se o KDC não estiver disponível, os serviços de rede não poderão ser utilizados, pois a autenticação não poderá ser executada. Isso pode ser mitigado com um único KDC master e um ou mais slaves, e com a implementação cuidadosa da autenticação secundária ou de fallback usando PAM.</p></div><div class=paragraph><p>O Kerberos permite que usuários, hosts e serviços se autentiquem entre si. Ele não possui um mecanismo para autenticar o KDC para os usuários, hosts ou serviços. Isso significa que um <code>kinit</code> infectado por um trojan pode registrar todos os nomes de usuário e senhas. As ferramentas de verificação de integridade do sistema de arquivos, como <a class=package href=https://cgit.freebsd.org/ports/tree/security/tripwire/>security/tripwire</a>, podem mitigar isso.</p></div></div><div class=sect2><h3 id=_recursos_e_outras_informações>13.5.7. Recursos e Outras Informações<a class=anchor href=#_recursos_e_outras_informações></a></h3><div class=ulist><ul><li><p><a href=http://www.faqs.org/faqs/Kerberos-faq/general/preamble.html>A FAQ do Kerberos</a></p></li><li><p><a href=http://web.mit.edu/Kerberos/www/dialogue.html>Criando um Sistema de Autenticação: um Diálogo em Quatro Cenas</a></p></li><li><p><a href=https://www.ietf.org/rfc/rfc4120.txt>RFC 4120, O Serviço de Autenticação em Rede (V5) do Kerberos</a></p></li><li><p><a href=http://web.mit.edu/Kerberos/www/>Página Web do Kerberos MIT</a></p></li><li><p><a href=https://github.com/heimdal/heimdal/wiki>Página web do Heimdal Kerberos</a></p></li></ul></div></div></div></div><div class=sect1><h2 id=openssl>13.6. OpenSSL<a class=anchor href=#openssl></a></h2><div class=sectionbody><div class=paragraph><p>O OpenSSL é uma implementação de software livre dos protocolos SSL e TLS. Ele fornece uma camada de transporte de criptografia sobre a camada de comunicação normal, permitindo que ela seja entrelaçada com muitos aplicativos e serviços de rede.</p></div><div class=paragraph><p>A versão do OpenSSL incluída no FreeBSD suporta os protocolos de segurança de redes Secure Sockets Layer 3.0 (SSLv3) e Transport Layer Security 1.0/1.1/1.2 (TLSv1/TLSv1.1/TLSv1.2) e pode ser usado como uma biblioteca de criptografia geral. No FreeBSD 12.0-RELEASE e posterior, OpenSSL também suporta Transport Layer Security 1.3 (TLSv1.3).</p></div><div class=paragraph><p>O OpenSSL é muitas vezes usado para encriptar a autenticação de clientes de email e proteger transações baseadas na web como pagamentos com cartões de crédito. Alguns ports, como o <a class=package href=https://cgit.freebsd.org/ports/tree/www/apache24/>www/apache24</a> e <a class=package href=https://cgit.freebsd.org/ports/tree/databases/postgresql11-server/>databases/postgresql11-server</a>, incluem uma opção de compilação para inserir o OpenSSL. Se selecionado, o port vai adicionar suporte ao OpenSSL da base do sistema. Para ter o port compilado com o suporte do OpenSSL do port <a class=package href=https://cgit.freebsd.org/ports/tree/security/openssl/>security/openssl</a>, adicione o seguinte ao arquivo <span class=filename>/etc/make.conf</span>:</p></div><div class="literalblock programlisting"><div class=content><pre>DEFAULT_VERSIONS+= ssl=openssl</pre></div></div><div class=paragraph><p>Outro uso comum do OpenSSL é fornecer certificados para uso com aplicaçõe de software. Os certificados podem ser usados para verificar as credenciais de uma empresa ou indivíduo. Se um certificado não tiver sido assinado por uma <em>Autoridade de Certificação</em> externa ( CA ), como <a href=http://www.verisign.com>http://www.verisign.com</a>, o aplicativo que usa o certificado produzirá um aviso. Há um custo associado à obtenção de um certificado assinado e o uso de um certificado assinado não é obrigatório, pois os certificados podem ser auto-assinados. No entanto, o uso de uma autoridade externa evitará avisos e poderá deixar os usuários mais à vontade.</p></div><div class=paragraph><p>Esta seção demonstra como criar e usar certificados em um sistema FreeBSD. Consulte <a href=../network-servers/#ldap-config>Configurando um servidor LDAP</a> para um exemplo de como criar uma CA para assinar seus próprios certificados.</p></div><div class=paragraph><p>Para obter maiores informações sobre o SSL, leia o <a href=https://www.feistyduck.com/books/openssl-cookbook/>OpenSSL Cookbook </a>gratuito.</p></div><div class=sect2><h3 id=_gerando_certificados>13.6.1. Gerando Certificados<a class=anchor href=#_gerando_certificados></a></h3><div class=paragraph><p>Para gerar um certificado que será assinado por uma CA externa, emita o seguinte comando e insira as informações solicitadas nos prompts. Esta informação de entrada será gravada no certificado. No prompt <code>Common Name</code>, insira o nome completo para o sistema que usará o certificado. Se esse nome não corresponder ao servidor, a aplicação que estiver verificando o certificado emitirá um aviso para o usuário, tornando a verificação provida pelo certificado inútil.</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># openssl req -new -nodes -out req.pem -keyout cert.key -sha256 -newkey rsa:2048</span>
Generating a 2048 bit RSA private key
..................+++
.............................................................+++
writing new private key to <span class=s1>&#39;cert.key&#39;</span>
<span class=nt>-----</span>
You are about to be asked to enter information that will be incorporated
into your certificate request.
What you are about to enter is what is called a Distinguished Name or a DN.
There are quite a few fields but you can leave some blank
For some fields there will be a default value,
If you enter <span class=s1>&#39;.&#39;</span>, the field will be left blank.
<span class=nt>-----</span>
Country Name <span class=o>(</span>2 letter code<span class=o>)</span> <span class=o>[</span>AU]:US
State or Province Name <span class=o>(</span>full name<span class=o>)</span> <span class=o>[</span>Some-State]:PA
Locality Name <span class=o>(</span>eg, city<span class=o>)</span> <span class=o>[]</span>:Pittsburgh
Organization Name <span class=o>(</span>eg, company<span class=o>)</span> <span class=o>[</span>Internet Widgits Pty Ltd]:My Company
Organizational Unit Name <span class=o>(</span>eg, section<span class=o>)</span> <span class=o>[]</span>:Systems Administrator
Common Name <span class=o>(</span>eg, YOUR name<span class=o>)</span> <span class=o>[]</span>:localhost.example.org
Email Address <span class=o>[]</span>:trhodes@FreeBSD.org

Please enter the following <span class=s1>&#39;extra&#39;</span> attributes
to be sent with your certificate request
A challenge password <span class=o>[]</span>:
An optional company name <span class=o>[]</span>:Another Name</code></pre></div></div><div class=paragraph><p>Outras opções, como o tempo de expiração e algoritmos de criptografia alternativos, estão disponíveis ao criar um certificado. Uma lista completa de opções é descrita em <a href="https://man.freebsd.org/cgi/man.cgi?query=openssl&amp;sektion=1&amp;format=html">openssl(1)</a>.</p></div><div class=paragraph><p>Este comando irá criar dois arquivos no diretório atual. A solicitação de certificado, <span class=filename>req.pem</span>, pode ser enviada para uma CA que validará as credenciais inseridas, assinará a solicitação e retornará o certificado assinado. O segundo arquivo, <span class=filename>cert.key</span>, é a chave privada do certificado e deve ser armazenado em um local seguro. Se ele cair nas mãos de outros, ele pode ser usado para representar o usuário ou o servidor.</p></div><div class=paragraph><p>Como alternativa, se uma assinatura de uma CA não for necessária, um certificado auto-assinado poderá ser criado. Primeiro, gere a chave RSA:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># openssl genrsa -rand -genkey -out cert.key 2048</span>
0 semi-random bytes loaded
Generating RSA private key, 2048 bit long modulus
.............................................+++
.................................................................................................................+++
e is 65537 <span class=o>(</span>0x10001<span class=o>)</span></code></pre></div></div><div class=paragraph><p>Use essa chave para criar um certificado auto-assinado. Siga os prompts usuais para criar um certificado:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># openssl req -new -x509 -days 365 -key cert.key -out cert.crt -sha256</span>
You are about to be asked to enter information that will be incorporated
into your certificate request.
What you are about to enter is what is called a Distinguished Name or a DN.
There are quite a few fields but you can leave some blank
For some fields there will be a default value,
If you enter <span class=s1>&#39;.&#39;</span>, the field will be left blank.
<span class=nt>-----</span>
Country Name <span class=o>(</span>2 letter code<span class=o>)</span> <span class=o>[</span>AU]:US
State or Province Name <span class=o>(</span>full name<span class=o>)</span> <span class=o>[</span>Some-State]:PA
Locality Name <span class=o>(</span>eg, city<span class=o>)</span> <span class=o>[]</span>:Pittsburgh
Organization Name <span class=o>(</span>eg, company<span class=o>)</span> <span class=o>[</span>Internet Widgits Pty Ltd]:My Company
Organizational Unit Name <span class=o>(</span>eg, section<span class=o>)</span> <span class=o>[]</span>:Systems Administrator
Common Name <span class=o>(</span>e.g. server FQDN or YOUR name<span class=o>)</span> <span class=o>[]</span>:localhost.example.org
Email Address <span class=o>[]</span>:trhodes@FreeBSD.org</code></pre></div></div><div class=paragraph><p>Isso criará dois novos arquivos no diretório atual: um arquivo de chave privada <span class=filename>cert.key</span> e o próprio certificado, <span class=filename>cert.crt</span>. Estes devem ser colocados em um diretório, preferencialmente sob <span class=filename>/etc/ssl/</span>, que é legível somente pelo <code>root</code>. As permissões de <code>0700</code> são apropriadas para esses arquivos e podem ser definidas usando o <code>chmod</code>.</p></div></div><div class=sect2><h3 id=_usando_certificados>13.6.2. Usando Certificados<a class=anchor href=#_usando_certificados></a></h3><div class=paragraph><p>Um uso para um certificado é criptografar conexões do servidor de email Sendmail para evitar o trafego de informações de autenticação em texto não criptografado.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Alguns clientes de email exibirão um erro se o usuário não tiver instalado uma cópia local do certificado. Consulte a documentação incluída com o software para obter maiores informações sobre a instalação do certificado.</p></div></td></tr></tbody></table></div><div class=paragraph><p>No FreeBSD 10.0-RELEASE e posterior, é possível criar um certificado auto-assinado para o Sendmail automaticamente. Para habilitar isso, adicione as seguintes linhas ao arquivo <span class=filename>/etc/rc.conf</span>:</p></div><div class="literalblock programlisting"><div class=content><pre>sendmail_enable=&#34;YES&#34;
sendmail_cert_create=&#34;YES&#34;
sendmail_cert_cn=&#34;localhost.example.org&#34;</pre></div></div><div class=paragraph><p>Isso criará automaticamente um certificado auto-assinado, <span class=filename>/etc/mail/certs/host.cert</span>, uma chave de assinatura, <span class=filename>/etc/mail/certs/host.key</span>, e um certificado CA, <span class=filename>/etc/mail/certs/cacert.pem</span>. O certificado usará o <code>Common Name</code> especificado em <code>sendmail_cert_cn</code>. Depois de salvar as edições, reinicie o Sendmail:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># service sendmail restart</span></code></pre></div></div><div class=paragraph><p>Se tudo correr bem, não haverá mensagens de erro no arquivo <span class=filename>/var/log/maillog</span>. Para um teste simples, conecte-se à porta de escuta do servidor de correio usando o <code>telnet</code>:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># telnet example.com 25</span>
Trying 192.0.34.166...
Connected to example.com.
Escape character is <span class=s1>&#39;^]&#39;</span><span class=nb>.</span>
220 example.com ESMTP Sendmail 8.14.7/8.14.7<span class=p>;</span> Fri, 18 Apr 2014 11:50:32 <span class=nt>-0400</span> <span class=o>(</span>EDT<span class=o>)</span>
ehlo example.com
250-example.com Hello example.com <span class=o>[</span>192.0.34.166], pleased to meet you
250-ENHANCEDSTATUSCODES
250-PIPELINING
250-8BITMIME
250-SIZE
250-DSN
250-ETRN
250-AUTH LOGIN PLAIN
250-STARTTLS
250-DELIVERBY
250 HELP
quit
221 2.0.0 example.com closing connection
Connection closed by foreign host.</code></pre></div></div><div class=paragraph><p>Se a linha <code>STARTTLS</code> aparecer na saída, tudo está funcionando corretamente.</p></div></div></div></div><div class=sect1><h2 id=ipsec>13.7. VPN Sobre IPsec<a class=anchor href=#ipsec></a></h2><div class=sectionbody><div class=paragraph><p>O Protocolo de Segurança da Internet (IPsec) é um conjunto de protocolos que se situam no topo da camada do Protocolo da Internet (IP). Ele permite que dois ou mais hosts se comuniquem de maneira segura, autenticando e criptografando cada pacote IP de uma sessão de comunicação. A pilha de rede IPsec do FreeBSD é baseada na implementação do <a href=http://www.kame.net/>http://www.kame.net/</a> e suporta as sessões IPv4 e IPv6.</p></div><div class=paragraph><p>O IPsec é composto pelos seguintes sub-protocolos:</p></div><div class=ulist><ul><li><p><em>Encapsulated Securtity Payload (ESP)</em>: este protocolo protege os dados do pacote IP da interferência de terceiros, criptografando o conteúdo usando algoritmos de criptografia simétricos, como Blowfish e 3DES.</p></li><li><p>_Authentication Header (AH) _: este protocolo protege o cabeçalho do pacote IP da interferência e spoofing de terceiros calculando um checksum criptográfico e gerando o hash dos campos de cabeçalho do pacote IP com uma função de hash segura. Isso é seguido por um cabeçalho adicional que contém o hash, para permitir que as informações no pacote sejam autenticadas.</p></li><li><p><em>IP Payload Compression Protocol (IPComp):</em> este protocolo tenta aumentar o desempenho da comunicação comprimindo o payload IP para reduzir a quantidade de dados enviados .</p></li></ul></div><div class=paragraph><p>Esses protocolos podem ser usados juntos ou separadamente, dependendo do ambiente.</p></div><div class=paragraph><p>O IPsec suporta dois modos de operação. O primeiro modo, <em>Modo de Transporte</em>, protege as comunicações entre dois hosts. O segundo modo, <em>Modo de túnel</em>, é usado para construir túneis virtuais, comumente conhecidos como redes privadas virtuais (VPNs). Consulte <a href="https://man.freebsd.org/cgi/man.cgi?query=ipsec&amp;sektion=4&amp;format=html">ipsec(4)</a> para obter informações detalhadas sobre o subsistema IPsec no FreeBSD.</p></div><div class=paragraph><p>O suporte a IPsec é ativado por padrão no FreeBSD 11 e posteriores. Para versões anteriores do FreeBSD, adicione estas opções a um arquivo de configuração de kernel personalizado e recompile o kernel usando as instruções em <a href=../kernelconfig/#kernelconfig>Configurando o kernel do FreeBSD</a>:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>options   IPSEC        IP security
device    crypto</code></pre></div></div><div class=paragraph><p>Se o suporte a depuração do IPsec for desejado, a seguinte opção de kernel também deve ser adicionada:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>options   IPSEC_DEBUG  debug <span class=k>for </span>IP security</code></pre></div></div><div class=paragraph><p>Este restante deste capítulo demonstra o processo de configuração de uma VPNIPsec entre uma rede doméstica e uma rede corporativa. No cenário de exemplo:</p></div><div class=ulist><ul><li><p>Ambos os sites estão conectados à Internet através de um gateway que está executando o FreeBSD.</p></li><li><p>O gateway em cada rede tem pelo menos um endereço IP externo. Neste exemplo, o endereço IP externo da LAN corporativa é <code>172.16.5.4</code> e o IP externo da LAN doméstica é <code>192.168.1.12</code>.</p></li><li><p>Os endereços internos das duas redes podem ser endereços IP públicos ou privados. No entanto, o espaço de endereço não deve colidir. Por exemplo, ambas as redes não podem usar <code>192.168.1.x</code>. Neste exemplo, o endereço IP interno da LAN corporativa é <code>10.246.38.1</code> e o endereço do IP interno da LAN doméstica é <code>10.0.0.5</code>.</p></li></ul></div><div class=sect2><h3 id=_configurando_uma_vpn_no_freebsd>13.7.1. Configurando uma VPN no FreeBSD<a class=anchor href=#_configurando_uma_vpn_no_freebsd></a></h3><div class=paragraph><p>Para começar, o <a class=package href=https://cgit.freebsd.org/ports/tree/security/ipsec-tools/>security/ipsec-tools</a> deve ser instalado a partir da Coleção de Ports. Este software fornece várias aplicações que suportam a configuração.</p></div><div class=paragraph><p>O próximo requisito é criar dois pseudo-dispositivos <a href="https://man.freebsd.org/cgi/man.cgi?query=gif&amp;sektion=4&amp;format=html">gif(4)</a> que serão usados para encapsular pacotes e permitir que ambas as redes se comuniquem adequadamente. Como <code>root</code>, execute os seguintes comandos, substituindo <em>internal</em> e <em>external</em> pelos endereços IP reais das interfaces internas e externas dos dois gateways:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># ifconfig gif0 create</span>
<span class=c># ifconfig gif0 internal1 internal2</span>
<span class=c># ifconfig gif0 tunnel external1 external2</span></code></pre></div></div><div class=paragraph><p>Verifique a configuração em cada gateway, usando o <code>ifconfig</code>. Aqui está a saída do Gateway 1:</p></div><div class="literalblock programlisting"><div class=content><pre>gif0: flags=8051 mtu 1280
tunnel inet 172.16.5.4 --&gt; 192.168.1.12
inet6 fe80::2e0:81ff:fe02:5881%gif0 prefixlen 64 scopeid 0x6
inet 10.246.38.1 --&gt; 10.0.0.5 netmask 0xffffff00</pre></div></div><div class=paragraph><p>Aqui está a saída do Gateway 2:</p></div><div class="literalblock programlisting"><div class=content><pre>gif0: flags=8051 mtu 1280
tunnel inet 192.168.1.12 --&gt; 172.16.5.4
inet 10.0.0.5 --&gt; 10.246.38.1 netmask 0xffffff00
inet6 fe80::250:bfff:fe3a:c1f%gif0 prefixlen 64 scopeid 0x4</pre></div></div><div class=paragraph><p>Depois de concluídos, os dois endereços de IP internos devem ser acessados usando <a href="https://man.freebsd.org/cgi/man.cgi?query=ping&amp;sektion=8&amp;format=html">ping(8)</a>:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>priv-net# ping 10.0.0.5
PING 10.0.0.5 <span class=o>(</span>10.0.0.5<span class=o>)</span>: 56 data bytes
64 bytes from 10.0.0.5: <span class=nv>icmp_seq</span><span class=o>=</span>0 <span class=nv>ttl</span><span class=o>=</span>64 <span class=nb>time</span><span class=o>=</span>42.786 ms
64 bytes from 10.0.0.5: <span class=nv>icmp_seq</span><span class=o>=</span>1 <span class=nv>ttl</span><span class=o>=</span>64 <span class=nb>time</span><span class=o>=</span>19.255 ms
64 bytes from 10.0.0.5: <span class=nv>icmp_seq</span><span class=o>=</span>2 <span class=nv>ttl</span><span class=o>=</span>64 <span class=nb>time</span><span class=o>=</span>20.440 ms
64 bytes from 10.0.0.5: <span class=nv>icmp_seq</span><span class=o>=</span>3 <span class=nv>ttl</span><span class=o>=</span>64 <span class=nb>time</span><span class=o>=</span>21.036 ms
<span class=nt>---</span> 10.0.0.5 ping statistics <span class=nt>---</span>
4 packets transmitted, 4 packets received, 0% packet loss
round-trip min/avg/max/stddev <span class=o>=</span> 19.255/25.879/42.786/9.782 ms</code></pre></div></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>corp-net# ping 10.246.38.1
PING 10.246.38.1 <span class=o>(</span>10.246.38.1<span class=o>)</span>: 56 data bytes
64 bytes from 10.246.38.1: <span class=nv>icmp_seq</span><span class=o>=</span>0 <span class=nv>ttl</span><span class=o>=</span>64 <span class=nb>time</span><span class=o>=</span>28.106 ms
64 bytes from 10.246.38.1: <span class=nv>icmp_seq</span><span class=o>=</span>1 <span class=nv>ttl</span><span class=o>=</span>64 <span class=nb>time</span><span class=o>=</span>42.917 ms
64 bytes from 10.246.38.1: <span class=nv>icmp_seq</span><span class=o>=</span>2 <span class=nv>ttl</span><span class=o>=</span>64 <span class=nb>time</span><span class=o>=</span>127.525 ms
64 bytes from 10.246.38.1: <span class=nv>icmp_seq</span><span class=o>=</span>3 <span class=nv>ttl</span><span class=o>=</span>64 <span class=nb>time</span><span class=o>=</span>119.896 ms
64 bytes from 10.246.38.1: <span class=nv>icmp_seq</span><span class=o>=</span>4 <span class=nv>ttl</span><span class=o>=</span>64 <span class=nb>time</span><span class=o>=</span>154.524 ms
<span class=nt>---</span> 10.246.38.1 ping statistics <span class=nt>---</span>
5 packets transmitted, 5 packets received, 0% packet loss
round-trip min/avg/max/stddev <span class=o>=</span> 28.106/94.594/154.524/49.814 ms</code></pre></div></div><div class=paragraph><p>Como esperado, ambos os lados têm a capacidade de enviar e receber pacotes ICMP dos endereços configurados de forma privada. Em seguida, os dois gateways devem ser informados sobre como rotear pacotes para enviar corretamente o tráfego de qualquer rede. Os seguintes comandos atingirão esse objetivo:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>corp-net# route add 10.0.0.0 10.0.0.5 255.255.255.0
corp-net# route add net 10.0.0.0: gateway 10.0.0.5
priv-net# route add 10.246.38.0 10.246.38.1 255.255.255.0
priv-net# route add host 10.246.38.0: gateway 10.246.38.1</code></pre></div></div><div class=paragraph><p>Neste ponto, as máquinas internas devem ser alcançadas de cada gateway, bem como das máquinas atrás dos gateways. Novamente, use o <a href="https://man.freebsd.org/cgi/man.cgi?query=ping&amp;sektion=8&amp;format=html">ping(8)</a> para confirmar:</p></div><div class="literalblock programlisting"><div class=content><pre>corp-net# ping 10.0.0.8
PING 10.0.0.8 (10.0.0.8): 56 data bytes
64 bytes from 10.0.0.8: icmp_seq=0 ttl=63 time=92.391 ms
64 bytes from 10.0.0.8: icmp_seq=1 ttl=63 time=21.870 ms
64 bytes from 10.0.0.8: icmp_seq=2 ttl=63 time=198.022 ms
64 bytes from 10.0.0.8: icmp_seq=3 ttl=63 time=22.241 ms
64 bytes from 10.0.0.8: icmp_seq=4 ttl=63 time=174.705 ms
--- 10.0.0.8 ping statistics ---
5 packets transmitted, 5 packets received, 0% packet loss
round-trip min/avg/max/stddev = 21.870/101.846/198.022/74.001 ms

priv-net# ping 10.246.38.107
PING 10.246.38.1 (10.246.38.107): 56 data bytes
64 bytes from 10.246.38.107: icmp_seq=0 ttl=64 time=53.491 ms
64 bytes from 10.246.38.107: icmp_seq=1 ttl=64 time=23.395 ms
64 bytes from 10.246.38.107: icmp_seq=2 ttl=64 time=23.865 ms
64 bytes from 10.246.38.107: icmp_seq=3 ttl=64 time=21.145 ms
64 bytes from 10.246.38.107: icmp_seq=4 ttl=64 time=36.708 ms
--- 10.246.38.107 ping statistics ---
5 packets transmitted, 5 packets received, 0% packet loss
round-trip min/avg/max/stddev = 21.145/31.721/53.491/12.179 ms</pre></div></div><div class=paragraph><p>Configurar os túneis é a parte fácil. Configurar um link seguro é um processo mais aprofundado. A seguinte configuração usa chaves RSA pré-compartilhadas (PSK). Além dos endereços IP, o arquivo <span class=filename>/usr/local/etc/racoon/racoon.conf</span> em ambos os gateways será idêntico e será semelhante a:</p></div><div class="literalblock programlisting"><div class=content><pre>path    pre_shared_key  &#34;/usr/local/etc/racoon/psk.txt&#34;; #location of pre-shared key file
log     debug;	#log verbosity setting: set to &#39;notify&#39; when testing and debugging is complete

padding	# options are not to be changed
{
        maximum_length  20;
        randomize       off;
        strict_check    off;
        exclusive_tail  off;
}

timer	# timing options. change as needed
{
        counter         5;
        interval        20 sec;
        persend         1;
#       natt_keepalive  15 sec;
        phase1          30 sec;
        phase2          15 sec;
}

listen	# address [port] that racoon will listen on
{
        isakmp          172.16.5.4 [500];
        isakmp_natt     172.16.5.4 [4500];
}

remote  192.168.1.12 [500]
{
        exchange_mode   main,aggressive;
        doi             ipsec_doi;
        situation       identity_only;
        my_identifier   address 172.16.5.4;
        peers_identifier        address 192.168.1.12;
        lifetime        time 8 hour;
        passive         off;
        proposal_check  obey;
#       nat_traversal   off;
        generate_policy off;

                        proposal {
                                encryption_algorithm    blowfish;
                                hash_algorithm          md5;
                                authentication_method   pre_shared_key;
                                lifetime time           30 sec;
                                dh_group                1;
                        }
}

sainfo  (address 10.246.38.0/24 any address 10.0.0.0/24 any)	# address $network/$netmask $type address $network/$netmask $type ( $type being any or esp)
{								# $network must be the two internal networks you are joining.
        pfs_group       1;
        lifetime        time    36000 sec;
        encryption_algorithm    blowfish,3des;
        authentication_algorithm        hmac_md5,hmac_sha1;
        compression_algorithm   deflate;
}</pre></div></div><div class=paragraph><p>Para descrições de cada opção disponível, consulte a página de manual do <span class=filename>racoon.conf</span>.</p></div><div class=paragraph><p>O Banco de Dados da Política de Segurança (SPD) precisa ser configurado para que o FreeBSD e o racoon consigam criptografar e descriptografar o tráfego de rede entre os hosts.</p></div><div class=paragraph><p>Isso pode ser obtido com um shell script, semelhante ao seguinte, no gateway corporativo. Este arquivo será usado durante a inicialização do sistema e deve ser salvo como <span class=filename>/usr/local/etc/racoon/setkey.conf</span>.</p></div><div class="literalblock programlisting"><div class=content><pre>flush;
spdflush;
# To the home network
spdadd 10.246.38.0/24 10.0.0.0/24 any -P out ipsec esp/tunnel/172.16.5.4-192.168.1.12/use;
spdadd 10.0.0.0/24 10.246.38.0/24 any -P in ipsec esp/tunnel/192.168.1.12-172.16.5.4/use;</pre></div></div><div class=paragraph><p>Uma vez que o arquivo estiver no seu lugar, o racoon pode ser iniciado em ambos os gateways usando o seguinte comando:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># /usr/local/sbin/racoon -F -f /usr/local/etc/racoon/racoon.conf -l /var/log/racoon.log</span></code></pre></div></div><div class=paragraph><p>A saída deve ser semelhante à seguinte:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>corp-net# /usr/local/sbin/racoon <span class=nt>-F</span> <span class=nt>-f</span> /usr/local/etc/racoon/racoon.conf
Foreground mode.
2006-01-30 01:35:47: INFO: begin Identity Protection mode.
2006-01-30 01:35:48: INFO: received Vendor ID: KAME/racoon
2006-01-30 01:35:55: INFO: received Vendor ID: KAME/racoon
2006-01-30 01:36:04: INFO: ISAKMP-SA established 172.16.5.4[500]-192.168.1.12[500] spi:623b9b3bd2492452:7deab82d54ff704a
2006-01-30 01:36:05: INFO: initiate new phase 2 negotiation: 172.16.5.4[0]192.168.1.12[0]
2006-01-30 01:36:09: INFO: IPsec-SA established: ESP/Tunnel 192.168.1.12[0]-&gt;172.16.5.4[0] <span class=nv>spi</span><span class=o>=</span>28496098<span class=o>(</span>0x1b2d0e2<span class=o>)</span>
2006-01-30 01:36:09: INFO: IPsec-SA established: ESP/Tunnel 172.16.5.4[0]-&gt;192.168.1.12[0] <span class=nv>spi</span><span class=o>=</span>47784998<span class=o>(</span>0x2d92426<span class=o>)</span>
2006-01-30 01:36:13: INFO: respond new phase 2 negotiation: 172.16.5.4[0]192.168.1.12[0]
2006-01-30 01:36:18: INFO: IPsec-SA established: ESP/Tunnel 192.168.1.12[0]-&gt;172.16.5.4[0] <span class=nv>spi</span><span class=o>=</span>124397467<span class=o>(</span>0x76a279b<span class=o>)</span>
2006-01-30 01:36:18: INFO: IPsec-SA established: ESP/Tunnel 172.16.5.4[0]-&gt;192.168.1.12[0] <span class=nv>spi</span><span class=o>=</span>175852902<span class=o>(</span>0xa7b4d66<span class=o>)</span></code></pre></div></div><div class=paragraph><p>Para garantir que o túnel esteja funcionando corretamente, mude para outro console e use o <a href="https://man.freebsd.org/cgi/man.cgi?query=tcpdump&amp;sektion=1&amp;format=html">tcpdump(1)</a> para exibir o tráfego de rede usando o comando a seguir. Substitua <code>em0</code> pela placa de interface de rede conforme necessário:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># tcpdump -i em0 host 172.16.5.4 and dst 192.168.1.12</span></code></pre></div></div><div class=paragraph><p>Dados semelhantes aos seguintes devem aparecer no console. Caso contrário, há um problema e a depuração dos dados retornados será necessária.</p></div><div class="literalblock programlisting"><div class=content><pre>01:47:32.021683 IP corporatenetwork.com &gt; 192.168.1.12.privatenetwork.com: ESP(spi=0x02acbf9f,seq=0xa)
01:47:33.022442 IP corporatenetwork.com &gt; 192.168.1.12.privatenetwork.com: ESP(spi=0x02acbf9f,seq=0xb)
01:47:34.024218 IP corporatenetwork.com &gt; 192.168.1.12.privatenetwork.com: ESP(spi=0x02acbf9f,seq=0xc)</pre></div></div><div class=paragraph><p>Neste ponto, as duas redes devem estar disponíveis e parecem fazer parte da mesma rede. Muito provavelmente ambas as redes estão protegidas por um firewall. Para permitir que o tráfego flua entre elas, regras precisam ser adicionadas para liberar a passagem dos pacotes. Para o firewall <a href="https://man.freebsd.org/cgi/man.cgi?query=ipfw&amp;sektion=8&amp;format=html">ipfw(8)</a>, adicione as seguintes linhas ao arquivo de configuração do firewall:</p></div><div class="literalblock programlisting"><div class=content><pre>ipfw add 00201 allow log esp from any to any
ipfw add 00202 allow log ah from any to any
ipfw add 00203 allow log ipencap from any to any
ipfw add 00204 allow log udp from any 500 to any</pre></div></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Os números das regras podem precisar ser alterados dependendo da configuração atual do host.</p></div></td></tr></tbody></table></div><div class=paragraph><p>Para usuários do <a href="https://man.freebsd.org/cgi/man.cgi?query=pf&amp;sektion=4&amp;format=html">pf(4)</a> ou do <a href="https://man.freebsd.org/cgi/man.cgi?query=ipf&amp;sektion=8&amp;format=html">ipf(8)</a> , as seguintes regras devem fazer o truque:</p></div><div class="literalblock programlisting"><div class=content><pre>pass in quick proto esp from any to any
pass in quick proto ah from any to any
pass in quick proto ipencap from any to any
pass in quick proto udp from any port = 500 to any port = 500
pass in quick on gif0 from any to any
pass out quick proto esp from any to any
pass out quick proto ah from any to any
pass out quick proto ipencap from any to any
pass out quick proto udp from any port = 500 to any port = 500
pass out quick on gif0 from any to any</pre></div></div><div class=paragraph><p>Finalmente, para permitir que a máquina inicie o suporte para a VPN durante a inicialização do sistema, adicione as seguintes linhas ao arquivo <span class=filename>/etc/rc.conf</span>:</p></div><div class="literalblock programlisting"><div class=content><pre>ipsec_enable=&#34;YES&#34;
ipsec_program=&#34;/usr/local/sbin/setkey&#34;
ipsec_file=&#34;/usr/local/etc/racoon/setkey.conf&#34; # allows setting up spd policies on boot
racoon_enable=&#34;yes&#34;</pre></div></div></div></div></div><div class=sect1><h2 id=openssh>13.8. OpenSSH<a class=anchor href=#openssh></a></h2><div class=sectionbody><div class=paragraph><p>O OpenSSH é um conjunto de ferramentas de conectividade de rede usadas para fornecer acesso seguro a máquinas remotas. Além disso, as conexões TCP/IP podem ser encapsuladas ou encaminhadas com segurança através de conexões SSH. O OpenSSH criptografa todo o tráfego para eliminar efetivamente a interceptação, o sequestro de conexão e outros ataques no nível da rede.</p></div><div class=paragraph><p>O OpenSSH é mantido pelo projeto OpenBSD e é instalado por padrão no FreeBSD. É compatível com os protocolos de versão 1 e 2 do SSH.</p></div><div class=paragraph><p>Quando os dados são enviados pela rede em um formato não criptografado, sniffers de rede posicionados em qualquer lugar entre o cliente e o servidor podem roubar as informações do usuário/senha ou os dados transferidos durante a sessão. O OpenSSH oferece uma variedade de métodos de autenticação e criptografia para evitar que isso aconteça. Mais informações sobre o OpenSSH estão disponíveis em <a href=http://www.openssh.com/>http://www.openssh.com/</a>.</p></div><div class=paragraph><p>Esta seção fornece uma visão geral dos utilitários embutidos de cliente para acessar com segurança outros sistemas e transferir arquivos com segurança de um sistema FreeBSD. Em seguida, descreve como configurar um servidor SSH em um sistema FreeBSD. Maiores informações estão disponíveis nas páginas man mencionadas neste capítulo.</p></div><div class=sect2><h3 id=_usando_os_utilitários_de_cliente_ssh>13.8.1. Usando os Utilitários de Cliente SSH<a class=anchor href=#_usando_os_utilitários_de_cliente_ssh></a></h3><div class=paragraph><p>Para logar em um servidor SSH, use <code>ssh</code> e especifique um nome de usuário que exista naquele servidor e o endereço IP ou nome de host do servidor. Se esta for a primeira vez que uma conexão foi feita ao servidor especificado, o usuário será solicitado a primeiro verificar a impressão digital do servidor:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># ssh user@example.com</span>
The authenticity of host <span class=s1>&#39;example.com (10.0.0.1)&#39;</span> can<span class=s1>&#39;t be established.
ECDSA key fingerprint is 25:cc:73:b5:b3:96:75:3d:56:19:49:d2:5c:1f:91:3b.
Are you sure you want to continue connecting (yes/no)? yes
Permanently added &#39;</span>example.com<span class=s1>&#39; (ECDSA) to the list of known hosts.
Password for user@example.com: user_password</span></code></pre></div></div><div class=paragraph><p>O SSH utiliza um sistema de impressão digital de chaves para verificar a autenticidade do servidor quando o cliente se conecta. Quando o usuário aceita a impressão digital da chave digitando <code>yes</code> ao conectar-se pela primeira vez, uma cópia da chave é salva em <span class=filename>.ssh/known_hosts</span> no diretório pessoal do usuário. Futuras tentativas de login são verificadas em relação à chave salva e o <code>ssh</code> exibirá um alerta se a chave do servidor não corresponder à chave salva. Se isso ocorrer, o usuário deve primeiro verificar por que a chave foi alterada antes de continuar com a conexão.</p></div><div class=paragraph><p>Por padrão, versões recentes do OpenSSH aceitam apenas conexões SSH v2. Por padrão, o cliente usará a versão 2 se possível e voltará para a versão 1 se o servidor não suportar a versão 2. Para forçar o <code>ssh</code> a usar somente o protocolo especificado, inclua <code>-1</code> ou <code>-2</code>. Opções adicionais são descritas em <a href="https://man.freebsd.org/cgi/man.cgi?query=ssh&amp;sektion=1&amp;format=html">ssh(1)</a>.</p></div><div class=paragraph><p>Use o <a href="https://man.freebsd.org/cgi/man.cgi?query=scp&amp;sektion=1&amp;format=html">scp(1)</a> para copiar com segurança um arquivo para ou de uma máquina remota. Este exemplo copia o arquivo <span class=filename>COPYRIGHT</span> do sistema remoto para um arquivo com o mesmo nome no diretório atual do sistema local:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># scp user@example.com:/COPYRIGHT COPYRIGHT</span>
Password <span class=k>for </span>user@example.com: <span class=k>*******</span>
COPYRIGHT            100% |<span class=k>*****************************</span>|  4735
00:00
<span class=c>#</span></code></pre></div></div><div class=paragraph><p>Como a impressão digital já foi verificada para esse host, a chave do servidor é verificada automaticamente antes de solicitar a senha do usuário.</p></div><div class=paragraph><p>Os argumentos passados para o <code>scp</code> são semelhantes ao comando <code>cp</code>. O arquivo ou arquivos para copiar é o primeiro argumento e o destino para copiar é o segundo. Como o arquivo é buscado pela rede, um ou mais dos argumentos do arquivo assumem o formato <code>user@host:&lt;path_to_remote_file></code>. Esteja ciente ao copiar recursivamente diretórios que o <code>scp</code> usa a opção <code>-r</code>, enquanto <code>cp</code> usa a <code>-R</code>.</p></div><div class=paragraph><p>Para abrir uma sessão interativa para copiar arquivos, use o <code>sftp</code>. Consulte <a href="https://man.freebsd.org/cgi/man.cgi?query=sftp&amp;sektion=1&amp;format=html">sftp(1)</a> para obter uma lista de comandos disponíveis enquanto estiver em uma sessão <code>sftp</code>.</p></div><div class=sect3><h4 id=security-ssh-keygen>13.8.1.1. Autenticação Baseada em Chave<a class=anchor href=#security-ssh-keygen></a></h4><div class=paragraph><p>Em vez de usar senhas, um cliente pode ser configurado para se conectar à máquina remota usando chaves. Para gerar chaves de autenticação RSA, use o <code>ssh-keygen</code>. Para gerar um par de chaves pública e privada, especifique o tipo de chave e siga os prompts. Recomenda-se proteger as chaves com uma senha memorável, mas difícil de se adivinhar.</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>% ssh-keygen <span class=nt>-t</span> rsa
Generating public/private rsa key pair.
Enter file <span class=k>in </span>which to save the key <span class=o>(</span>/home/user/.ssh/id_rsa<span class=o>)</span>:
Enter passphrase <span class=o>(</span>empty <span class=k>for </span>no passphrase<span class=o>)</span>:  <i class=conum data-value=1></i><b>(1)</b>
Enter same passphrase again:                 <i class=conum data-value=2></i><b>(2)</b>
Your identification has been saved <span class=k>in</span> /home/user/.ssh/id_rsa.
Your public key has been saved <span class=k>in</span> /home/user/.ssh/id_rsa.pub.
The key fingerprint is:
SHA256:54Xm9Uvtv6H4NOo6yjP/YCfODryvUU7yWHzMqeXwhq8 user@host.example.com
The key<span class=s1>&#39;s randomart image is:
+---[RSA 2048]----+
|                 |
|                 |
|                 |
|        . o..    |
|       .S*+*o    |
|      . O=Oo . . |
|       = Oo= oo..|
|      .oB.* +.oo.|
|       =OE**.o..=|
+----[SHA256]-----+</span></code></pre></div></div><div class="colist arabic"><table><tbody><tr><td><i class=conum data-value=1></i><b>1</b></td><td>Digite uma senha aqui. Pode conter espaços e símbolos.</td></tr><tr><td><i class=conum data-value=2></i><b>2</b></td><td>Digite novamente a senha para verificá-la.</td></tr></tbody></table></div><div class=paragraph><p>A chave privada é armazenada no arquivo <span class=filename>~/.ssh/id_rsa</span> e a chave pública é armazenada no arquivo <span class=filename>~/.ssh/id_rsa.pub</span>. A chave <em>publica</em> deve ser copiada para <span class=filename>~/.ssh/ authorized_keys</span> na máquina remota para que a autenticação baseada em chave funcione.</p></div><div class="admonitionblock warning"><table><tbody><tr><td class=icon><i class="fa icon-warning" title=Warning></i></td><td class=content><div class=paragraph><p>Muitos usuários acreditam que as chaves são seguras por design e usarão uma chave sem uma senha. Este é um comportamento <em>perigoso</em>. Um administrador pode verificar se um par de chaves está protegido por uma senha, visualizando a chave privada manualmente. Se o arquivo de chave privada contiver a palavra <code>ENCRYPTED</code>, o dono da chave está usando uma senha. Além disso, para proteger melhor os usuários finais, o termo <code>from</code> pode ser colocado no arquivo de chave pública. Por exemplo, adicionar <code>from "192.168.10.5"</code> na frente do prefixo <code>ssh-rsa</code> só permitirá que esse usuário específico efetue login a partir desse endereço IP.</p></div></td></tr></tbody></table></div><div class=paragraph><p>As opções e arquivos variam de acordo com as diferentes versões do OpenSSH. Para evitar problemas, consulte <a href="https://man.freebsd.org/cgi/man.cgi?query=ssh-keygen&amp;sektion=1&amp;format=html">ssh-keygen(1)</a>.</p></div><div class=paragraph><p>Se uma senha for usada, o usuário será solicitado a inserir a senha toda vez que uma conexão for feita ao servidor. Para carregar as chaves de SSH na memória e remover a necessidade de digitar a senha toda vez, use o <a href="https://man.freebsd.org/cgi/man.cgi?query=ssh-agent&amp;sektion=1&amp;format=html">ssh-agent(1)</a> e o <a href="https://man.freebsd.org/cgi/man.cgi?query=ssh-add&amp;sektion=1&amp;format=html">ssh-add(1)</a>.</p></div><div class=paragraph><p>A autenticação é feita pelo <code>ssh-agent</code>, usando as chaves privadas que estão carregadas nele. O <code>ssh-agent</code> pode ser usado para iniciar outro aplicativo como um shell ou um gerenciador de janelas.</p></div><div class=paragraph><p>Para usar o <code>ssh-agent</code> em um shell, inicie-o com um shell como um argumento. Adicione a identidade executando <code>ssh-add</code> e inserindo a senha para a chave privada. O usuário então poderá executar o <code>ssh</code> para se conectar em qualquer host que tenha a chave pública correspondente instalada. Por exemplo:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>% ssh-agent csh
% ssh-add
Enter passphrase <span class=k>for </span>key <span class=s1>&#39;/usr/home/user/.ssh/id_rsa&#39;</span>:  <i class=conum data-value=1></i><b>(1)</b>
Identity added: /usr/home/user/.ssh/id_rsa <span class=o>(</span>/usr/home/user/.ssh/id_rsa<span class=o>)</span>
%</code></pre></div></div><div class="colist arabic"><table><tbody><tr><td><i class=conum data-value=1></i><b>1</b></td><td>Digite a senha para a chave.</td></tr></tbody></table></div><div class=paragraph><p>Para usar o <code>ssh-agent</code> no Xorg, adicione uma entrada para ele em <span class=filename>~/.xinitrc</span>. Isso fornece os serviços do <code>ssh-agent</code> para todos os programas iniciados no Xorg. Um exemplo do arquivo <span class=filename>~/.xinitrc</span> pode ter esta aparência:</p></div><div class="literalblock programlisting"><div class=content><pre>exec ssh-agent startxfce4</pre></div></div><div class=paragraph><p>Isso inicia o <code>ssh-agent</code>, que, por sua vez, ativa o XFCE, sempre que o Xorg é iniciado. Uma vez que o Xorg tenha sido reiniciado para que as mudanças entrem em vigor, execute <code>ssh-add</code> para carregar todas as chaves SSH.</p></div></div><div class=sect3><h4 id=security-ssh-tunneling>13.8.1.2. Tunelamento SSH<a class=anchor href=#security-ssh-tunneling></a></h4><div class=paragraph><p>O OpenSSH tem a capacidade de criar um tunel para encapsular outro protocolo em uma sessão criptografada.</p></div><div class=paragraph><p>O comando a seguir informa ao <code>ssh</code> para criar um túnel para o telnet:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>% ssh <span class=nt>-2</span> <span class=nt>-N</span> <span class=nt>-f</span> <span class=nt>-L</span> 5023:localhost:23 user@foo.example.com
%</code></pre></div></div><div class=paragraph><p>Este exemplo usa as seguintes opções:</p></div><div class=dlist><dl><dt class=hdlist1><code>-2</code></dt><dd><p>Força o comando <code>ssh</code> a usar a versão 2 para conectar-se ao servidor.</p></dd><dt class=hdlist1><code>-N</code></dt><dd><p>Indica nenhum comando ou apenas túnel. Se omitido, o <code>ssh</code> inicia uma sessão normal.</p></dd><dt class=hdlist1><code>-f</code></dt><dd><p>Força o comando <code>ssh</code> a ser executado em segundo plano.</p></dd><dt class=hdlist1><code>-L</code></dt><dd><p>Indica um túnel local no formato <em>localport:remotehost:remoteport</em>.</p></dd><dt class=hdlist1><code>user@foo.example.com</code></dt><dd><p>O nome de login para usar no servidor SSH remoto especificado.</p></dd></dl></div><div class=paragraph><p>Um túnel SSH funciona criando um socket de escuta em <code>localhost</code> na <code>localport</code> especificada. Em seguida, ele encaminha quaisquer conexões recebidas em <code>localport</code> por meio da conexão SSH com o <code>remotehost:remoteport</code> especificado. No exemplo, a porta <code>5023</code> no cliente é encaminhada para a porta <code>23</code> na máquina remota. Como a porta 23 é usada pelo telnet, isso cria uma sessão telnet criptografada através de um túnel SSH.</p></div><div class=paragraph><p>Esse método pode ser usado para agrupar qualquer número de protocolos TCP inseguros, como SMTP, POP3 e FTP, como visto nos exemplos a seguir.</p></div><div class=exampleblock><div class=title>Exemplo 1. Criar um Túnel Seguro para SMTP</div><div class=content><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>% ssh <span class=nt>-2</span> <span class=nt>-N</span> <span class=nt>-f</span> <span class=nt>-L</span> 5025:localhost:25 user@mailserver.example.com
user@mailserver.example.com<span class=s1>&#39;s password: *****
% telnet localhost 5025
Trying 127.0.0.1...
Connected to localhost.
Escape character is &#39;</span>^]<span class=s1>&#39;.
220 mailserver.example.com ESMTP</span></code></pre></div></div><div class=paragraph><p>Isso pode ser usado em conjunto com <code>ssh-keygen</code> e contas de usuário adicionais para criar um ambiente de encapsulamento SSH mais uniforme. As chaves podem ser usadas no lugar de digitar uma senha e os túneis podem ser executados como um usuário separado.</p></div></div></div><div class=exampleblock><div class=title>Exemplo 2. Acesso Seguro de um Servidor POP3</div><div class=content><div class=paragraph><p>Neste exemplo, há um servidor SSH que aceita conexões de fora. Na mesma rede, existe um servidor de email que executa um servidor POP3. Para verificar o e-mail de maneira segura, crie uma conexão SSH com o servidor SSH e encaminhe para o servidor de e-mail:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>% ssh <span class=nt>-2</span> <span class=nt>-N</span> <span class=nt>-f</span> <span class=nt>-L</span> 2110:mail.example.com:110 user@ssh-server.example.com
user@ssh-server.example.com<span class=s1>&#39;s password: ******</span></code></pre></div></div><div class=paragraph><p>Quando o túnel estiver ativo e em execução, aponte o cliente de e-mail para enviar solicitações POP3 para <code>localhost</code> na porta 2110. Essa conexão será encaminhada com segurança pelo encapsulamento para <code>mail.example.com</code>.</p></div></div></div><div class=exampleblock><div class=title>Exemplo 3. Ignorando um Firewall</div><div class=content><div class=paragraph><p>Alguns firewalls filtram as conexões de entrada e saída. Por exemplo, um firewall pode limitar o acesso de máquinas remotas às portas 22 e 80 para permitir apenas o SSH e navegação na web. Isso impede o acesso a qualquer outro serviço que use uma porta diferente de 22 ou 80.</p></div><div class=paragraph><p>A solução é criar uma conexão SSH com uma máquina fora do firewall da rede e usá-la para encapsular o serviço desejado:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>% ssh <span class=nt>-2</span> <span class=nt>-N</span> <span class=nt>-f</span> <span class=nt>-L</span> 8888:music.example.com:8000 user@unfirewalled-system.example.org
user@unfirewalled-system.example.org<span class=s1>&#39;s password: *******</span></code></pre></div></div><div class=paragraph><p>Neste exemplo, um cliente Ogg Vorbis de streaming pode agora ser apontado para <code>localhost</code> na porta 8888, que será encaminhado para <code>music.example.com</code> na porta 8000, ignorando com êxito o firewall.</p></div></div></div></div></div><div class=sect2><h3 id=_ativando_o_servidor_ssh>13.8.2. Ativando o Servidor SSH<a class=anchor href=#_ativando_o_servidor_ssh></a></h3><div class=paragraph><p>Além de fornecer utilitários de cliente SSH embutidos, um sistema FreeBSD pode ser configurado como um servidor SSH, aceitando conexões de outros clientes SSH.</p></div><div class=paragraph><p>Para ver se o sshd está operando, use o comando <a href="https://man.freebsd.org/cgi/man.cgi?query=service&amp;sektion=8&amp;format=html">service(8)</a>:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># service sshd status</span></code></pre></div></div><div class=paragraph><p>Se o serviço não estiver em execução, adicione a seguinte linha ao arquivo <span class=filename>/etc/rc.conf</span>.</p></div><div class="literalblock programlisting"><div class=content><pre>sshd_enable=&#34;YES&#34;</pre></div></div><div class=paragraph><p>Isso iniciará o sshd, o programa daemon para o OpenSSH, na próxima vez que o sistema for inicializado. Para iniciá-lo agora:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># service sshd start</span></code></pre></div></div><div class=paragraph><p>A primeira vez que o sshd inicia em um sistema FreeBSD, as chaves de host do sistema serão criadas automaticamente e a impressão digital será exibida no console. Forneça aos usuários a impressão digital para que eles possam verificá-la na primeira vez que se conectarem ao servidor.</p></div><div class=paragraph><p>Consulte o <a href="https://man.freebsd.org/cgi/man.cgi?query=sshd&amp;sektion=8&amp;format=html">sshd(8)</a> para obter a lista de opções disponíveis ao iniciar o sshd e uma discussão mais completa sobre autenticação, processo de login e os vários arquivos de configuração.</p></div><div class=paragraph><p>Neste ponto, o sshd deve estar disponível para todos os usuários com um nome de usuário e senha no sistema.</p></div></div><div class=sect2><h3 id=_segurança_do_servidor_ssh>13.8.3. Segurança do Servidor SSH<a class=anchor href=#_segurança_do_servidor_ssh></a></h3><div class=paragraph><p>Enquanto o sshd é o recurso de administração remota mais usado para o FreeBSD, a força bruta e o drive por ataques são comuns a qualquer sistema exposto a redes públicas. Vários parâmetros adicionais estão disponíveis para evitar o sucesso desses ataques e serão descritos nesta seção.</p></div><div class=paragraph><p>É uma boa ideia limitar quais usuários podem efetuar login no servidor SSH e de onde usar a palavra-chave <code>AllowUsers</code> no arquivo de configuração do servidor OpenSSH. Por exemplo, para permitir que somente o <code>root</code> efetue login de <code>192.168.1.32</code>, inclua esta linha no arquivo <span class=filename>/etc/ssh/sshd_config</span>:</p></div><div class="literalblock programlisting"><div class=content><pre>AllowUsers root@192.168.1.32</pre></div></div><div class=paragraph><p>Para permitir que o usuário <code>admin</code> efetue login de qualquer lugar, liste esse usuário sem especificar um endereço IP:</p></div><div class="literalblock programlisting"><div class=content><pre>AllowUsers admin</pre></div></div><div class=paragraph><p>Multiplos usuários devem ser listados na mesma linha, assim:</p></div><div class="literalblock programlisting"><div class=content><pre>AllowUsers root@192.168.1.32 admin</pre></div></div><div class=paragraph><p>Depois de fazer alterações no arquivo <span class=filename>/etc/ssh/sshd_config</span>, informe o sshd para recarregar seu arquivo de configuração executando:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># service sshd reload</span></code></pre></div></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Quando essa palavra-chave é usada, é importante listar cada usuário que precisa efetuar login nesta máquina. Qualquer usuário que não esteja especificado nessa linha será bloqueado. Além disso, as palavras-chave usadas no arquivo de configuração do servidor OpenSSH fazem distinção entre maiúsculas e minúsculas. Se a palavra-chave não estiver escrita corretamente, incluindo esse detalhe, ela será ignorada. Sempre teste as alterações neste arquivo para garantir que as edições estejam funcionando conforme o esperado. Consulte o <a href="https://man.freebsd.org/cgi/man.cgi?query=sshd_config&amp;sektion=5&amp;format=html">sshd_config(5)</a> para verificar a ortografia e o uso das palavras-chave disponíveis.</p></div></td></tr></tbody></table></div><div class=paragraph><p>Além disso, os usuários podem ser forçados a usar a autenticação de dois fatores por meio do uso de uma chave pública e privada. Quando necessário, o usuário pode gerar um par de chaves usando o <a href="https://man.freebsd.org/cgi/man.cgi?query=ssh-keygen&amp;sektion=1&amp;format=html">ssh-keygen(1)</a> e enviar ao administrador a chave pública. Este arquivo de chave será colocado no arquivo <span class=filename>authorized_keys</span> como descrito acima na seção cliente. Para forçar os usuários a usar apenas as chaves, a seguinte opção pode ser configurada:</p></div><div class="literalblock programlisting"><div class=content><pre>AuthenticationMethods publickey</pre></div></div><div class="admonitionblock tip"><table><tbody><tr><td class=icon><i class="fa icon-tip" title=Tip></i></td><td class=content><div class=paragraph><p>Não confunda o arquivo <span class=filename>/etc/ssh/sshd_config</span> com <span class=filename>/etc/ssh/ssh_config</span> (observe o <code>d</code> extra no primeiro nome do arquivo). O primeiro arquivo configura o servidor e o segundo arquivo configura o cliente. Consulte o <a href="https://man.freebsd.org/cgi/man.cgi?query=ssh_config&amp;sektion=5&amp;format=html">ssh_config(5)</a> para obter uma listagem das configurações do cliente disponíveis.</p></div></td></tr></tbody></table></div></div></div></div><div class=sect1><h2 id=fs-acl>13.9. Listas de Controle de Acesso<a class=anchor href=#fs-acl></a></h2><div class=sectionbody><div class=paragraph><p>As Listas de Controle de Acesso (ACLs) estendem o modelo de permissão padrão do UNIX™ em um compatível com o modo POSIX™.1e. Isso permite que um administrador aproveite um modelo de permissões mais refinado.</p></div><div class=paragraph><p>O kernel FreeBSD <span class=filename>GENERIC</span> fornece suporte a ACL para sistemas de arquivos UFS. Usuários que preferem compilar um kernel personalizado devem incluir a seguinte opção em seu arquivo de configuração do kernel personalizado:</p></div><div class="literalblock programlisting"><div class=content><pre>options UFS_ACL</pre></div></div><div class=paragraph><p>Se esta opção não for ativada na compilação, uma mensagem de aviso será exibida ao tentar montar um sistema de arquivos com o suporte a ACL. As ACLs dependem de atributos estendidos que são suportados nativamente pelo UFS2.</p></div><div class=paragraph><p>Este capítulo descreve como ativar o suporte a ACL e fornece alguns exemplos de uso.</p></div><div class=sect2><h3 id=_ativando_o_suporte_a_acl>13.9.1. Ativando o Suporte a ACL<a class=anchor href=#_ativando_o_suporte_a_acl></a></h3><div class=paragraph><p>As ACLs são habilitadas pela flag administrativa de tempo de montagem, <code>acls</code>, que podem ser adicionadas ao arquivo <span class=filename>/etc/fstab</span>. As flags de tempo de montagem também podem ser configuradas automaticamente de forma persistente usando-se o <a href="https://man.freebsd.org/cgi/man.cgi?query=tunefs&amp;sektion=8&amp;format=html">tunefs(8)</a> para modificar um superbloco de flags ACLs no cabeçalho do sistema de arquivos. Em geral, é preferível usar flags de superbloco por vários motivos:</p></div><div class=ulist><ul><li><p>A flag de superbloco não pode ser alterada por um remount usando <code>mount -u</code>, pois requer um <code>umount</code> completo e um <code>mount</code> completo. Isso significa que as ACLs não podem ser ativadas no sistema de arquivos raiz após a inicialização. Isso também significa que o suporte a ACL em um sistema de arquivos não pode ser alterado enquanto o sistema estiver em uso.</p></li><li><p>Definir a flag de superbloco faz com que o sistema de arquivos seja sempre montado com a ACL ativada, mesmo que não haja uma entrada no <span class=filename>fstab</span> ou se os dispositivos forem reordenados. Isso evita a montagem acidental do sistema de arquivos sem o suporte a ACL.</p></li></ul></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>É desejável desencorajar a montagem acidental sem que a ACL esteja habilitada porque coisas desagradáveis podem acontecer se ACLs estiverem habilitadas, e então desabilitadas e então reativadas sem limpar os atributos estendidos. Em geral, uma vez que as ACLs forem habilitadas em um sistema de arquivos, elas não devem ser desabilitadas, pois as proteções de arquivos resultantes podem não ser compatíveis com aquelas pretendidas pelos usuários do sistema e ACLs reativadas podem reconectar as ACLs anteriores aos arquivos que tiveram suas permissões alteradas, resultando em um comportamento imprevisível.</p></div></td></tr></tbody></table></div><div class=paragraph><p>Os sistemas de arquivos com a ACL ativada exibirão um sinal de mais (<code>+</code>) nas configurações de permissão:</p></div><div class="literalblock programlisting"><div class=content><pre>drwx------  2 robert  robert  512 Dec 27 11:54 private
drwxrwx---+ 2 robert  robert  512 Dec 23 10:57 directory1
drwxrwx---+ 2 robert  robert  512 Dec 22 10:20 directory2
drwxrwx---+ 2 robert  robert  512 Dec 27 11:57 directory3
drwxr-xr-x  2 robert  robert  512 Nov 10 11:54 public_html</pre></div></div><div class=paragraph><p>Neste exemplo, o <span class=filename>directory1</span>, <span class=filename>directory2</span> e <span class=filename>directory3</span> estão todos fazendo uso de ACLs, enquanto <span class=filename>public_html</span> não está.</p></div></div><div class=sect2><h3 id=_usando_acls>13.9.2. Usando ACLs<a class=anchor href=#_usando_acls></a></h3><div class=paragraph><p>As ACLs de um sistema de arquivos podem ser visualizadas usando <code>getfacl</code>. Por exemplo, para visualizar as configurações de ACL no arquivo <span class=filename>test</span>:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>% getfacl <span class=nb>test</span>
	<span class=c>#file:test</span>
	<span class=c>#owner:1001</span>
	<span class=c>#group:1001</span>
	user::rw-
	group::r--
	other::r--</code></pre></div></div><div class=paragraph><p>Para alterar as configurações de ACL neste arquivo, use <code>setfacl</code>. Para remover todos os ACLs atualmente definidos de um arquivo ou sistema de arquivos, inclua <code>-k</code>. No entanto, o método preferido é usar <code>-b</code>, pois ela deixa os campos básicos necessários para que as ACLs funcionem.</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>% setfacl <span class=nt>-k</span> <span class=nb>test</span></code></pre></div></div><div class=paragraph><p>Para modificar as entradas padrões das ACLs, use <code>-m</code>:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>% setfacl <span class=nt>-m</span> u:trhodes:rwx,group:web:r--,o::--- <span class=nb>test</span></code></pre></div></div><div class=paragraph><p>Neste exemplo, não havia entradas predefinidas, pois elas foram removidas pelo comando anterior. Este comando restaura as opções padrões e atribui as opções listadas. Se um usuário ou grupo for adicionado e não existir no sistema, um erro de <code>Invalid argument</code> será exibido.</p></div><div class=paragraph><p>Consulte <a href="https://man.freebsd.org/cgi/man.cgi?query=getfacl&amp;sektion=1&amp;format=html">getfacl(1)</a> e <a href="https://man.freebsd.org/cgi/man.cgi?query=setfacl&amp;sektion=1&amp;format=html">setfacl(1)</a> para maiores informações sobre as opções disponíveis para esses comandos.</p></div></div></div></div><div class=sect1><h2 id=security-pkg>13.10. Monitorando Problemas de Segurança de Terceiros<a class=anchor href=#security-pkg></a></h2><div class=sectionbody><div class=paragraph><p>Nos últimos anos, o mundo da segurança fez muitas melhorias em como a avaliação de vulnerabilidades é tratada. A ameaça de invasão do sistema aumenta à medida que utilitários de terceiros são instalados e configurados para praticamente qualquer sistema operacional disponível atualmente.</p></div><div class=paragraph><p>A avaliação de vulnerabilidade é um fator importante na segurança. Enquanto o FreeBSD libera avisos para o sistema base, fazê-lo para cada utilitário de terceiros está além da capacidade do Projeto FreeBSD. Existe uma maneira de mitigar vulnerabilidades de terceiros e avisar os administradores sobre problemas de segurança conhecidos. Um utilitário do FreeBSD conhecido como pkg inclui opções explicitamente para este propósito.</p></div><div class=paragraph><p>O pkg pesquisa um banco de dados em busca de problemas de segurança. O banco de dados é atualizado e mantido pela equipe de segurança do FreeBSD e pelos desenvolvedores de ports.</p></div><div class=paragraph><p>Por favor, consulte as <a href=../ports/#pkgng-intro>instruções</a> para instalar o pkg.</p></div><div class=paragraph><p>A instalação fornece arquivos de configuração do <a href="https://man.freebsd.org/cgi/man.cgi?query=periodic&amp;sektion=8&amp;format=html">periodic(8)</a> para manter o banco de dados de auditoria do pkg e fornece um método programático para mantê-lo atualizado . Esta funcionalidade é ativada se <code>daily_status_security_pkgaudit_enable</code> estiver definido como <code>YES</code> em <a href="https://man.freebsd.org/cgi/man.cgi?query=periodic.conf&amp;sektion=5&amp;format=html">periodic.conf(5)</a> . Certifique-se de que os e-mails de execução de segurança diários, que são enviados para a conta de e-mail do <code>root</code>, estejam sendo lidos.</p></div><div class=paragraph><p>Após a instalação e para auditar utilitários de terceiros como parte da Coleção de Ports a qualquer momento, um administrador pode optar por atualizar o banco de dados e visualizar as vulnerabilidades conhecidas dos pacotes instalados, invocando:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># pkg audit -F</span></code></pre></div></div><div class=paragraph><p>O pkg exibe as vulnerabilidades publicadas dos pacotes instalados:</p></div><div class="literalblock programlisting"><div class=content><pre>Affected package: cups-base-1.1.22.0_1
Type of problem: cups-base -- HPGL buffer overflow vulnerability.
Reference: &lt;https://www.FreeBSD.org/ports/portaudit/40a3bca2-6809-11d9-a9e7-0001020eed82.html&gt;

1 problem(s) in your installed packages found.

You are advised to update or deinstall the affected package(s) immediately.</pre></div></div><div class=paragraph><p>Ao apontar um navegador da web para a URL exibida, um administrador pode obter mais informações sobre a vulnerabilidade. Isto incluirá as versões afetadas, pela versão do port do FreeBSD, juntamente com outros sites que podem conter avisos de segurança.</p></div><div class=paragraph><p>O pkg é um poderoso utilitário e é extremamente útil quando acoplado com o <a class=package href=https://cgit.freebsd.org/ports/tree/ports-mgmt/portmaster/>ports-mgmt/portmaster</a>.</p></div></div></div><div class=sect1><h2 id=security-advisories>13.11. Avisos de Segurança do FreeBSD<a class=anchor href=#security-advisories></a></h2><div class=sectionbody><div class=paragraph><p>Como muitos produtores de sistemas operacionais de qualidade, o Projeto FreeBSD tem uma equipe de segurança responsável por determinar a data de fim de vida (EoL) para cada versão do FreeBSD e para fornecer atualizações de segurança para versões suportadas que ainda não atingiram sua EoL. Mais informações sobre a equipe de segurança do FreeBSD e as versões suportadas estão disponíveis na <a href=https://www.FreeBSD.org/security>página de segurança do FreeBSD</a>.</p></div><div class=paragraph><p>Uma tarefa da equipe de segurança é responder às vulnerabilidades de segurança reportadas no sistema operacional FreeBSD. Quando uma vulnerabilidade é confirmada, a equipe de segurança verifica as etapas necessárias para corrigir a vulnerabilidade e atualiza o código-fonte com a correção. Em seguida, publica os detalhes como um "Aviso de Segurança". Os avisos de segurança são publicados no <a href=https://www.FreeBSD.org/security/advisories/>site do FreeBSD</a> e enviados para as listas de discussão <a href=http://lists.FreeBSD.org/mailman/listinfo/freebsd-security-notifications>freebsd-security-notifications</a>, <a href=http://lists.FreeBSD.org/mailman/listinfo/freebsd-security>freebsd-security</a>, e <a href=http://lists.FreeBSD.org/mailman/listinfo/freebsd-announce>freebsd-announce</a>.</p></div><div class=paragraph><p>Esta seção descreve o formato de um alerta de segurança do FreeBSD.</p></div><div class=sect2><h3 id=_formato_de_um_comunicado_de_segurança>13.11.1. Formato de um Comunicado de Segurança<a class=anchor href=#_formato_de_um_comunicado_de_segurança></a></h3><div class=paragraph><p>Aqui está um exemplo de um aviso de segurança do FreeBSD:</p></div><div class="literalblock programlisting"><div class=content><pre>=============================================================================
-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA512

=============================================================================
FreeBSD-SA-14:04.bind                                       Security Advisory
                                                          The FreeBSD Project

Topic:          BIND remote denial of service vulnerability

Category:       contrib
Module:         bind
Announced:      2014-01-14
Credits:        ISC
Affects:        FreeBSD 8.x and FreeBSD 9.x
Corrected:      2014-01-14 19:38:37 UTC (stable/9, 9.2-STABLE)
                2014-01-14 19:42:28 UTC (releng/9.2, 9.2-RELEASE-p3)
                2014-01-14 19:42:28 UTC (releng/9.1, 9.1-RELEASE-p10)
                2014-01-14 19:38:37 UTC (stable/8, 8.4-STABLE)
                2014-01-14 19:42:28 UTC (releng/8.4, 8.4-RELEASE-p7)
                2014-01-14 19:42:28 UTC (releng/8.3, 8.3-RELEASE-p14)
CVE Name:       CVE-2014-0591

For general information regarding FreeBSD Security Advisories,
including descriptions of the fields above, security branches, and the
following sections, please visit &lt;URL:http://security.FreeBSD.org/&gt;.

I.   Background

BIND 9 is an implementation of the Domain Name System (DNS) protocols.
The named(8) daemon is an Internet Domain Name Server.

II.  Problem Description

Because of a defect in handling queries for NSEC3-signed zones, BIND can
crash with an &#34;INSIST&#34; failure in name.c when processing queries possessing
certain properties.  This issue only affects authoritative nameservers with
at least one NSEC3-signed zone.  Recursive-only servers are not at risk.

III. Impact

An attacker who can send a specially crafted query could cause named(8)
to crash, resulting in a denial of service.

IV.  Workaround

No workaround is available, but systems not running authoritative DNS service
with at least one NSEC3-signed zone using named(8) are not vulnerable.

V.   Solution

Perform one of the following:

1) Upgrade your vulnerable system to a supported FreeBSD stable or
release / security branch (releng) dated after the correction date.

2) To update your vulnerable system via a source code patch:

The following patches have been verified to apply to the applicable
FreeBSD release branches.

a) Download the relevant patch from the location below, and verify the
detached PGP signature using your PGP utility.

[FreeBSD 8.3, 8.4, 9.1, 9.2-RELEASE and 8.4-STABLE]
# fetch http://security.FreeBSD.org/patches/SA-14:04/bind-release.patch
# fetch http://security.FreeBSD.org/patches/SA-14:04/bind-release.patch.asc
# gpg --verify bind-release.patch.asc

[FreeBSD 9.2-STABLE]
# fetch http://security.FreeBSD.org/patches/SA-14:04/bind-stable-9.patch
# fetch http://security.FreeBSD.org/patches/SA-14:04/bind-stable-9.patch.asc
# gpg --verify bind-stable-9.patch.asc

b) Execute the following commands as root:

# cd /usr/src
# patch &lt; /path/to/patch

Recompile the operating system using buildworld and installworld as
described in &lt;URL:https://www.FreeBSD.org/handbook/makeworld.html&gt;.

Restart the applicable daemons, or reboot the system.

3) To update your vulnerable system via a binary patch:

Systems running a RELEASE version of FreeBSD on the i386 or amd64
platforms can be updated via the freebsd-update(8) utility:

# freebsd-update fetch
# freebsd-update install

VI.  Correction details

The following list contains the correction revision numbers for each
affected branch.

Branch/path                                                      Revision
- -------------------------------------------------------------------------
stable/8/                                                         r260646
releng/8.3/                                                       r260647
releng/8.4/                                                       r260647
stable/9/                                                         r260646
releng/9.1/                                                       r260647
releng/9.2/                                                       r260647
- -------------------------------------------------------------------------

To see which files were modified by a particular revision, run the
following command, replacing NNNNNN with the revision number, on a
machine with Subversion installed:

# svn diff -cNNNNNN --summarize svn://svn.freebsd.org/base

Or visit the following URL, replacing NNNNNN with the revision number:

&lt;URL:https://svnweb.freebsd.org/base?view=revision&amp;revision=NNNNNN&gt;

VII. References

&lt;URL:https://kb.isc.org/article/AA-01078&gt;

&lt;URL:http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2014-0591&gt;

The latest revision of this advisory is available at
&lt;URL:http://security.FreeBSD.org/advisories/FreeBSD-SA-14:04.bind.asc&gt;
-----BEGIN PGP SIGNATURE-----

iQIcBAEBCgAGBQJS1ZTYAAoJEO1n7NZdz2rnOvQP/2/68/s9Cu35PmqNtSZVVxVG
ZSQP5EGWx/lramNf9566iKxOrLRMq/h3XWcC4goVd+gZFrvITJSVOWSa7ntDQ7TO
XcinfRZ/iyiJbs/Rg2wLHc/t5oVSyeouyccqODYFbOwOlk35JjOTMUG1YcX+Zasg
ax8RV+7Zt1QSBkMlOz/myBLXUjlTZ3Xg2FXVsfFQW5/g2CjuHpRSFx1bVNX6ysoG
9DT58EQcYxIS8WfkHRbbXKh9I1nSfZ7/Hky/kTafRdRMrjAgbqFgHkYTYsBZeav5
fYWKGQRJulYfeZQ90yMTvlpF42DjCC3uJYamJnwDIu8OhS1WRBI8fQfr9DRzmRua
OK3BK9hUiScDZOJB6OqeVzUTfe7MAA4/UwrDtTYQ+PqAenv1PK8DZqwXyxA9ThHb
zKO3OwuKOVHJnKvpOcr+eNwo7jbnHlis0oBksj/mrq2P9m2ueF9gzCiq5Ri5Syag
Wssb1HUoMGwqU0roS8+pRpNC8YgsWpsttvUWSZ8u6Vj/FLeHpiV3mYXPVMaKRhVm
067BA2uj4Th1JKtGleox+Em0R7OFbCc/9aWC67wiqI6KRyit9pYiF3npph+7D5Eq
7zPsUdDd+qc+UTiLp3liCRp5w6484wWdhZO6wRtmUgxGjNkxFoNnX8CitzF8AaqO
UWWemqWuz3lAZuORQ9KX
=OQzQ
-----END PGP SIGNATURE-----</pre></div></div><div class=paragraph><p>Todo comunicado de segurança usa o seguinte formato:</p></div><div class=ulist><ul><li><p>Cada aviso de segurança é assinado pela chave PGP do Oficial de Segurança. A chave pública para o Oficial de Segurança pode ser verificada em <a href=../pgpkeys/#pgpkeys>Chaves OpenPGP</a>.</p></li><li><p>O nome do alerta de segurança sempre começa com <code>FreeBSD-SA-</code> (para o FreeBSD Security Advisory), seguido pelo ano em formato de dois dígitos (<code>14:</code>), seguido pelo número de aviso para aquele ano (<code>04.</code>), seguido pelo nome do aplicativo ou subsistema afetado (<code>bind</code>). O comunicado mostrado aqui é o quarto comunicado de 2014 e afeta o BIND.</p></li><li><p>O campo <code>Topic</code> resume a vulnerabilidade.</p></li><li><p>O campo <code>Category</code> refere-se à parte afetada do sistema, que pode ser uma de <code>core</code>, <code>contrib</code>, ou <code>ports</code>. A categoria <code>core</code> significa que a vulnerabilidade afeta um componente principal do sistema operacional FreeBSD. A categoria <code>contrib</code> significa que a vulnerabilidade afeta um software incluído no FreeBSD, como o BIND. A categoria <code>ports</code> indica que a vulnerabilidade afeta um software disponível através da coleção de ports.</p></li><li><p>O campo <code>Module</code> refere-se ao local do componente. Neste exemplo, o módulo <code>bind</code> é afetado; Portanto, essa vulnerabilidade afeta um aplicativo instalado com o sistema operacional.</p></li><li><p>O campo <code>Announced</code> reflete a data em que o comunicado de segurança foi publicado. Isto significa que a equipe de segurança verificou que o problema existe e que um patch foi disponibilizado no repositório do código fonte do FreeBSD.</p></li><li><p>O campo <code>Credits</code> dá crédito ao indivíduo ou organização que encontrou a vulnerabilidade e a relatou.</p></li><li><p>O campo <code>Affects</code> explica quais versões do FreeBSD são afetadas por esta vulnerabilidade.</p></li><li><p>O campo <code>Corrected</code> indica a data, a hora, o deslocamento do horário e as releases que foram corrigidas. A seção entre parênteses mostra cada branch para a qual a correção foi mesclada e o número de versão da liberação correspondente dessa branch. O próprio identificador de release inclui o número da versão e, se apropriado, o nível do patch. O nível de correção é a letra <code>p</code> seguida de um número, indicando o número de seqüência do patch, permitindo que os usuários controlem quais patches já foram aplicados ao sistema.</p></li><li><p>O campo <code>CVE Name</code> lista o número de aviso, se existir, no banco de dados público <a href=http://cve.mitre.org>cve.mitre.org</a> de vulnerabilidades de segurança.</p></li><li><p>O campo <code>Background</code> fornece uma descrição do módulo afetado.</p></li><li><p>O campo <code>Problem Description</code> explica a vulnerabilidade. Isso pode incluir informações sobre o código defeituoso e como o utilitário pode ser usado de maneira mal-intencionada.</p></li><li><p>O campo <code>Impact</code> descreve o tipo de impacto que o problema pode ter em um sistema.</p></li><li><p>O campo <code>Workaround</code> indica se uma solução alternativa está disponível para os administradores do sistema que não podem corrigir imediatamente o sistema.</p></li><li><p>O campo <code>Solution</code> fornece as instruções para corrigir o sistema afetado. Este é um método testado e verificado passo a passo para obter um sistema corrigido e funcionando com segurança.</p></li><li><p>O campo <code>Correction Details</code> exibe cada branch do Subversion afetada com o número de revisão que contém o código corrigido.</p></li><li><p>O campo <code>References</code> oferece fontes de informações adicionais sobre a vulnerabilidade.</p></li></ul></div></div></div></div><div class=sect1><h2 id=security-accounting>13.12. Auditoria de Processo<a class=anchor href=#security-accounting></a></h2><div class=sectionbody><div class=paragraph><p>A auditoria de processos é um método de segurança no qual um administrador pode controlar os recursos do sistema utilizados e sua alocação entre os usuários, fornecer monitoramento do sistema e controlar minimamente os comandos de um usuário.</p></div><div class=paragraph><p>A auditoria de processos tem pontos positivos e negativos. Um dos pontos positivos é que uma intrusão pode ser rastreada ao ponto de entrada. Um valor negativo é a quantidade de logs gerados pela contabilidade do processo e o espaço em disco necessário. Esta seção conduz um administrador pelos fundamentos da contabilidade de processo.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Se uma auditoria mais detalhada for necessária, consulte <a href=../audit/#audit>Auditoria de Evento de Segurança</a>.</p></div></td></tr></tbody></table></div><div class=sect2><h3 id=_ativando_e_utilizando_a_auditoria_de_processos>13.12.1. Ativando e Utilizando a Auditoria de Processos<a class=anchor href=#_ativando_e_utilizando_a_auditoria_de_processos></a></h3><div class=paragraph><p>Antes de usar a auditoria de processos, ela deve ser ativada usando os seguintes comandos:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># sysrc accounting_enable=yes</span>
<span class=c># service accounting start</span></code></pre></div></div><div class=paragraph><p>As informações de auditoria são armazenadas em arquivos localizados em <span class=filename>/var/account</span>, que são criados automaticamente, se necessário, na primeira vez em que o serviço de auditoria é iniciado. Esses arquivos contêm informações confidenciais, incluindo todos os comandos executados por todos os usuários. O acesso de escrita aos arquivos é limitado ao <code>root</code> e o acesso de leitura é limitado ao <code>root</code> e aos membros do grupo <code>wheel</code>. Para também impedir que membros do grupo <code>wheel</code> leiam os arquivos, altere a permissão do diretório <span class=filename>/var/account</span> para permitir acesso apenas de <code>root</code>.</p></div><div class=paragraph><p>Uma vez ativada, a auditoria começará a rastrear informações, como estatísticas de CPU e comandos executados. Todos os logs auditados estão em um formato não legível que pode ser visualizado usando <code>sa</code>. Se executado sem nenhuma opção, o <code>sa</code> imprime informações relacionadas ao número de chamadas por usuário, o tempo total decorrido em minutos, o total de CPU e o tempo do usuário em minutos, e o número médio de operações de I/O. Consulte <a href="https://man.freebsd.org/cgi/man.cgi?query=sa&amp;sektion=8&amp;format=html">sa(8)</a> para obter a lista de opções disponíveis que controlam a saída.</p></div><div class=paragraph><p>Para exibir os comandos emitidos pelos usuários, use o <code>lastcomm</code>. Por exemplo, este comando imprime todo o uso do comando <code>ls</code> pelo usuário <code>trhodes</code> no terminal <code>ttyp1</code>:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># lastcomm ls trhodes ttyp1</span></code></pre></div></div><div class=paragraph><p>Muitas outras opções úteis existem e são explicadas em <a href="https://man.freebsd.org/cgi/man.cgi?query=lastcomm&amp;sektion=1&amp;format=html">lastcomm(1)</a>, <a href="https://man.freebsd.org/cgi/man.cgi?query=acct&amp;sektion=5&amp;format=html">acct(5)</a> e <a href="https://man.freebsd.org/cgi/man.cgi?query=sa&amp;sektion=8&amp;format=html">sa(8)</a>.</p></div></div></div></div><div class=sect1><h2 id=security-resourcelimits>13.13. Limites de Recursos<a class=anchor href=#security-resourcelimits></a></h2><div class=sectionbody><div class=paragraph><p>O FreeBSD fornece vários métodos para um administrador limitar a quantidade de recursos do sistema que um indivíduo pode usar. As cotas de disco limitam a quantidade de espaço em disco disponível para os usuários. As cotas são discutidas em <a href=../disks/#quotas>Cotas de Disco</a>.</p></div><div class=paragraph><p>Limites para outros recursos, como CPU e memória, podem ser definidos usando um arquivo simples ou um comando para configurar um banco de dados de limites de recursos. O método tradicional define classes de login editando o arquivo <span class=filename>/etc/login.conf</span>. Embora esse método ainda seja suportado, qualquer alteração requer um processo de várias etapas para editar esse arquivo, reconstruir o banco de dados de recursos, fazer as alterações necessárias no arquivo <span class=filename>/etc/master.passwd</span> e reconstruir o banco de dados de senhas. Isso pode se tornar demorado, dependendo do número de usuários a serem configurados.</p></div><div class=paragraph><p>O comando <code>rctl</code> pode ser usado para fornecer um método mais refinado para controlar limites de recursos. Esse comando suporta mais que limites de usuário, já que também pode ser usado para definir restrições de recursos em processos e jails.</p></div><div class=paragraph><p>Esta seção demonstra os dois métodos para controlar recursos, começando com o método tradicional.</p></div><div class=sect2><h3 id=users-limiting>13.13.1. Configurando Classes de Login<a class=anchor href=#users-limiting></a></h3><div class=paragraph><p>No método tradicional, as classes de login e os limites de recursos a serem aplicados a uma classe de login são definidos no arquivo <span class=filename>/etc/login.conf</span>. Cada conta de usuário pode ser atribuída a uma classe de login, onde <code>default</code> é a classe de login padrão. Cada classe de login possui um conjunto de recursos de login associados a ele. Um recurso de login é um par <code><em>name</em>=<em>value</em></code>, em que <em>name</em> é um identificador conhecido e <em>value</em> é uma string arbitrária que é processada de acordo, dependendo do <em>name</em>.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Sempre que o arquivo <span class=filename>/etc/login.conf</span> for editado, o <span class=filename>/etc/login.conf.db</span> deve ser atualizado executando o seguinte comando:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># cap_mkdb /etc/login.conf</span></code></pre></div></div></td></tr></tbody></table></div><div class=paragraph><p>Os limites de recursos diferem dos recursos de login padrão de duas maneiras. Primeiro, para cada limite, existe um limite <em>soft</em> e um <em>hard</em>. Um limite soft pode ser ajustado pelo usuário ou aplicativo, mas não pode ser definido como superior ao limite hard. O limite hard pode ser baixado pelo usuário, mas só pode ser aumentado pelo root. Segundo, a maioria dos limites de recursos se aplica por processo a um usuário específico.</p></div><div class=paragraph><p><a href=#resource-limits>Limites de Recursos de Classe de Login</a> lista os limites de recursos mais usados. Todos os limites de recursos disponíveis e capabilities são descritos em detalhes em <a href="https://man.freebsd.org/cgi/man.cgi?query=login.conf&amp;sektion=5&amp;format=html">login.conf(5)</a>.</p></div><table id=resource-limits class="tableblock frame-none grid-all stretch"><caption class=title>Tabela 1. Limites de Recursos de Classe de Login</caption><col style=width:50%><col style=width:50%><thead><tr><th class="tableblock halign-left valign-top">Limite de Recurso</th><th class="tableblock halign-left valign-top">Descrição</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class=tableblock>coredumpsize</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>O limite do tamanho de um arquivo core gerado por um programa é subordinado a outros limites de uso do disco, como <code>filesize</code> ou cotas de disco. Esse limite é frequentemente usado como um método menos severo de controle do consumo de espaço em disco. Como os usuários não geram arquivos core e geralmente não os excluem, essa configuração pode evitar que eles fiquem sem espaço em disco caso ocorra um grande travamento de programa.</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>cputime</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>A quantidade máxima de tempo de CPU que o processo de um usuário pode consumir. Os processos ofensivos serão eliminados pelo kernel. Este é um limite no <em>tempo</em> de CPU consumido, não a porcentagem do CPU como exibido em alguns dos campos gerados pelo <code>top</code> e <code>ps</code>.</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>filesize</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>O tamanho máximo de um arquivo que o usuário pode possuir. Ao contrário das cotas de disco (<a href=../disks/#quotas>Cotas de Disco</a>), esse limite é imposto em arquivos individuais, não no conjunto de todos os arquivos que um usuário possui.</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>maxproc</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>O número máximo de processos de primeiro plano e de plano de fundo que um usuário pode executar. Esse limite pode não ser maior que o limite do sistema especificado pela variável <code>kern.maxproc</code>. Definir um limite muito pequeno pode prejudicar a produtividade de um usuário, pois algumas tarefas, como compilar um programa grande, iniciam muitos processos.</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>memorylocked</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>A quantidade máxima de memória que um processo pode solicitar para ser bloqueado na memória principal usando o <a href="https://man.freebsd.org/cgi/man.cgi?query=mlock&amp;sektion=2&amp;format=html">mlock(2)</a>. Alguns programas críticos do sistema, como <a href="https://man.freebsd.org/cgi/man.cgi?query=amd&amp;sektion=8&amp;format=html">amd(8)</a>, se bloqueiam na memória principal para que, se o sistema começar a fazer swap, eles não contribuam para surrar o disco.</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>memoryuse</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>A quantidade máxima de memória que um processo pode consumir a qualquer momento. Inclui tanto a memória principal quanto o uso de swap. Este não é um limite geral para restringir o consumo de memória, mas é um bom começo.</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>openfiles</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>O número máximo de arquivos que um processo pode ter aberto. No FreeBSD, os arquivos são usados para representar sockets e canais IPC, então tome cuidado para não definir isso muito baixo. O limite de todo o sistema para isso é definido por pela variável <code>kern.maxfiles</code>.</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>sbsize</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>O limite na quantidade de memória de rede que um usuário pode consumir. Isso geralmente pode ser usado para limitar as comunicações da rede.</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>stacksize</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>O tamanho máximo de uma pilha de processos. Isso por si só não é suficiente para limitar a quantidade de memória que um programa pode usar, por isso deve ser usado em conjunto com outros limites.</p></td></tr></tbody></table><div class=paragraph><p>Existem algumas outras coisas para se lembrar ao definir limites de recursos:</p></div><div class=ulist><ul><li><p>Os processos iniciados na inicialização do sistema pelo <span class=filename>/etc/rc</span> são atribuídos à classe <code>daemon</code> de login.</p></li><li><p>Embora o arquivo <span class=filename>/etc/login.conf</span> padrão seja uma boa fonte de valores razoáveis para a maioria dos limites, eles podem não ser apropriados para todos os sistemas. Definir um limite muito alto pode abrir o sistema para uso abusivo, enquanto que defini-lo como muito baixo pode prejudicar a produtividade.</p></li><li><p>O Xorg utiliza muitos recursos e incentiva os usuários a executarem mais programas simultaneamente.</p></li><li><p>Muitos limites se aplicam a processos individuais, não ao usuário como um todo. Por exemplo, definir a variável <code>openfiles</code> como <code>50</code> significa que cada processo que o usuário executa pode abrir até <code>50</code> arquivos. A quantidade total de arquivos que um usuário pode abrir é o valor de <code>openfiles</code> multiplicado pelo valor de <code>maxproc</code>. Isso também se aplica ao consumo de memória.</p></li></ul></div><div class=paragraph><p>Para mais informações sobre limites de recursos e classes de login e capacidades em geral, consulte <a href="https://man.freebsd.org/cgi/man.cgi?query=cap_mkdb&amp;sektion=1&amp;format=html">cap_mkdb(1)</a>, <a href="https://man.freebsd.org/cgi/man.cgi?query=getrlimit&amp;sektion=2&amp;format=html">getrlimit(2)</a> e <a href="https://man.freebsd.org/cgi/man.cgi?query=login.conf&amp;sektion=5&amp;format=html">login.conf(5)</a>.</p></div></div><div class=sect2><h3 id=_ativando_e_configurando_limites_de_recursos>13.13.2. Ativando e Configurando Limites de Recursos<a class=anchor href=#_ativando_e_configurando_limites_de_recursos></a></h3><div class=paragraph><p>A variável configurável <code>kern.racct.enable</code> deve ser configurada para um valor diferente de zero. Kernels personalizados requerem configuração específica:</p></div><div class="literalblock programlisting"><div class=content><pre>options         RACCT
options         RCTL</pre></div></div><div class=paragraph><p>Depois que o sistema for reinicializado no novo kernel, o <code>rctl</code> poderá ser usado para definir regras para o sistema.</p></div><div class=paragraph><p>A sintaxe da regra é controlada por meio do uso de um subject, subject-id, resource e action, conforme visto nesta regra de exemplo:</p></div><div class="literalblock programlisting"><div class=content><pre>user:trhodes:maxproc:deny=10/user</pre></div></div><div class=paragraph><p>Nesta regra, o subject é <code>user</code>, o subject-id é <code>trhodes</code>, o resource, <code>maxproc</code>, é o número máximo de processos, e a action é <code>deny</code>, que bloqueia a criação de novos processos. Isso significa que o usuário, <code>trhodes</code>, será restrito a execução de no máximo <code>10</code> processos. Outras ações possíveis incluem o registro no console, passando uma notificação para o <a href="https://man.freebsd.org/cgi/man.cgi?query=devd&amp;sektion=8&amp;format=html">devd(8)</a> ou enviando um sigterm para o processo.</p></div><div class=paragraph><p>Algum cuidado deve ser tomado ao adicionar regras. Como esse usuário está restrito a <code>10</code> processos, este exemplo impedirá que o usuário execute outras tarefas depois de efetuar login e executar uma sessão <code>screen</code>. Quando um limite de recurso for atingido, um erro será impresso, como neste exemplo:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>% man <span class=nb>test</span>
    /usr/bin/man: Cannot fork: Resource temporarily unavailable
<span class=nb>eval</span>: Cannot fork: Resource temporarily unavailable</code></pre></div></div><div class=paragraph><p>Como outro exemplo, uma jail pode ser impedida de exceder um limite de memória. Esta regra pode ser escrita como:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># rctl -a jail:httpd:memoryuse:deny=2G/jail</span></code></pre></div></div><div class=paragraph><p>As regras persistirão durante as reinicializações se tiverem sido adicionadas ao arquivo <span class=filename>/etc/rctl.conf</span>. O formato é uma regra, sem o comando anterior. Por exemplo, a regra anterior pode ser adicionada como:</p></div><div class="literalblock programlisting"><div class=content><pre># Block jail from using more than 2G memory:
jail:httpd:memoryuse:deny=2G/jail</pre></div></div><div class=paragraph><p>Para remover uma regra, use o <code>rctl</code> para removê-la da lista:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># rctl -r user:trhodes:maxproc:deny=10/user</span></code></pre></div></div><div class=paragraph><p>Um método para remover todas as regras é documentado em <a href="https://man.freebsd.org/cgi/man.cgi?query=rctl&amp;sektion=8&amp;format=html">rctl(8)</a>. No entanto, se for necessário remover todas as regras para um único usuário, esse comando poderá ser emitido:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># rctl -r user:trhodes</span></code></pre></div></div><div class=paragraph><p>Existem muitos outros recursos que podem ser usados para exercer controle adicional sobre vários <code>subjects</code>. Veja <a href="https://man.freebsd.org/cgi/man.cgi?query=rctl&amp;sektion=8&amp;format=html">rctl(8)</a> para aprender sobre eles.</p></div></div></div></div><div class=sect1><h2 id=security-sudo>13.14. Administração Compartilhada com Sudo<a class=anchor href=#security-sudo></a></h2><div class=sectionbody><div class=paragraph><p>Os administradores do sistema geralmente precisam conceder permissões avançadas aos usuários para que eles possam executar tarefas privilegiadas. A ideia de que os membros da equipe tenham acesso a um sistema FreeBSD para executar suas tarefas específicas abre desafios únicos para cada administrador. Esses membros da equipe precisam apenas de um subconjunto de acesso além dos níveis normais de usuário final; no entanto, eles quase sempre dizem ao gerenciadores que eles são incapazes de executar suas tarefas sem acesso de superusuário. Felizmente, não há motivo para fornecer tal acesso aos usuários finais porque existem ferramentas para gerenciar esse exato requisito.</p></div><div class=paragraph><p>Até este ponto, o capítulo de segurança cobriu o acesso a usuários autorizados e a tentativa de impedir o acesso não autorizado. Outro problema surge quando os usuários autorizados têm acesso aos recursos do sistema. Em muitos casos, alguns usuários podem precisar acessar os scripts de inicialização do aplicativo ou uma equipe de administradores precisa manter o sistema. Tradicionalmente, os usuários e grupos padrão, as permissões de arquivo e até mesmo o comando <a href="https://man.freebsd.org/cgi/man.cgi?query=su&amp;sektion=&amp;format=html">su()</a> gerenciariam esse acesso. E como os aplicativos exigiam mais acesso, à medida que mais usuários precisavam usar recursos do sistema, era necessária uma solução melhor. A aplicação mais usada atualmente é o Sudo.</p></div><div class=paragraph><p>O Sudo permite que os administradores configurem um acesso mais rígido aos comandos do sistema e forneçam alguns recursos avançados de log. Como uma ferramenta, ele está disponível na coleção de ports como <a class=package href=https://cgit.freebsd.org/ports/tree/security/sudo/>security/sudo</a> ou usando o utilitário <a href="https://man.freebsd.org/cgi/man.cgi?query=pkg&amp;sektion=8&amp;format=html">pkg(8)</a>. Para usar a ferramenta <a href="https://man.freebsd.org/cgi/man.cgi?query=pkg&amp;sektion=8&amp;format=html">pkg(8)</a>:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># pkg install sudo</span></code></pre></div></div><div class=paragraph><p>Após a conclusão da instalação, o <code>visudo</code> instalado abrirá o arquivo de configuração com um editor de texto. O uso do <code>visudo</code> é altamente recomendado, pois vem com um verificador de sintaxe incorporado para verificar se não há erros antes que o arquivo seja salvo.</p></div><div class=paragraph><p>O arquivo de configuração é composto de várias seções pequenas que permitem uma configuração extensiva. No exemplo a seguir, o mantenedor do aplicativo da web, user1, precisa iniciar, parar e reiniciar o aplicativo da web conhecido como <em>webservice</em>. Para conceder a este usuário permissão para executar estas tarefas, adicione esta linha ao final do arquivo <span class=filename>/usr/local/etc/sudoers</span>:</p></div><div class="literalblock programlisting"><div class=content><pre>user1   ALL=(ALL)       /usr/sbin/service webservice *</pre></div></div><div class=paragraph><p>O usuário pode agora iniciar o <em>webservice</em> usando este comando:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>% <span class=nb>sudo</span> /usr/sbin/service webservice start</code></pre></div></div><div class=paragraph><p>Embora essa configuração permita que um único usuário acesse o serviço webservice; No entanto, na maioria das organizações, existe uma equipe inteira da Web encarregada de gerenciar o serviço. Uma única linha também pode dar acesso a um grupo inteiro. Essas etapas criarão um grupo da Web, adicionarão um usuário a esse grupo e permitirão que todos os membros do grupo gerenciem o serviço:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># pw groupadd -g 6001 -n webteam</span></code></pre></div></div><div class=paragraph><p>Usando o mesmo comando <a href="https://man.freebsd.org/cgi/man.cgi?query=pw&amp;sektion=8&amp;format=html">pw(8)</a>, o usuário é adicionado ao grupo webteam:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># pw groupmod -m user1 -n webteam</span></code></pre></div></div><div class=paragraph><p>Finalmente, esta linha no arquivo <span class=filename>/usr/local/etc/sudoers</span> permite que qualquer membro do grupo webteam gerencie o <em>webservice</em>:</p></div><div class="literalblock programlisting"><div class=content><pre>%webteam   ALL=(ALL)       /usr/sbin/service webservice *</pre></div></div><div class=paragraph><p>Ao contrário do <a href="https://man.freebsd.org/cgi/man.cgi?query=su&amp;sektion=1&amp;format=html">su(1)</a>, o Sudo requer apenas a senha do usuário final. Isso adiciona uma vantagem em que os usuários não precisarão de senhas compartilhadas, uma descoberta na maioria das auditorias de segurança e o que por si só já ruins em todos os aspectos.</p></div><div class=paragraph><p>Os usuários autorizados a executar aplicativos com o Sudo só inserem suas próprias senhas. Isso é mais seguro e oferece melhor controle do que o <a href="https://man.freebsd.org/cgi/man.cgi?query=su&amp;sektion=1&amp;format=html">su(1)</a>, onde a senha de <code>root</code> é inserida e o usuário adquire todas as permissões de <code>root</code>.</p></div><div class="admonitionblock tip"><table><tbody><tr><td class=icon><i class="fa icon-tip" title=Tip></i></td><td class=content><div class=paragraph><p>A maioria das organizações está se movendo ou migrou para um modelo de autenticação de dois fatores. Nestes casos, o usuário pode não ter uma senha para entrar. O Sudo resolve estes casos com a variável <code>NOPASSWD</code>. Adicioná-lo à configuração acima permitirá que todos os membros do grupo <em>webteam</em> gerenciem o serviço sem o requisito de senha:</p></div><div class="literalblock programlisting"><div class=content><pre>%webteam   ALL=(ALL)       NOPASSWD: /usr/sbin/service webservice *</pre></div></div></td></tr></tbody></table></div><div class=sect2><h3 id=security-sudo-loggin>13.14.1. Logando a Saída<a class=anchor href=#security-sudo-loggin></a></h3><div class=paragraph><p>Uma vantagem para implementar o Sudo é a capacidade de ativar o log de sessão. Usando os mecanismos de log integrados e o comando sudoreplay incluído, todos os comandos iniciados por meio de Sudo são registrados para verificação posterior. Para ativar esse recurso, adicione uma entrada de diretório de log padrão, este exemplo usa uma variável de usuário. Existem várias outras convenções de nome de arquivo de log, consulte a página de manual do sudoreplay para obter informações adicionais.</p></div><div class="literalblock programlisting"><div class=content><pre>Defaults iolog_dir=/var/log/sudo-io/%{user}</pre></div></div><div class="admonitionblock tip"><table><tbody><tr><td class=icon><i class="fa icon-tip" title=Tip></i></td><td class=content><div class=paragraph><p>Este diretório será criado automaticamente após o logging ser configurado. É melhor deixar o sistema criar o diretório com permissões padrão apenas para estar seguro. Além disso, essa entrada também registra os administradores que usam o comando sudoreplay. Para alterar esse comportamento, leia e descomente as opções de log dentro do arquivo <span class=filename>sudoers</span>.</p></div></td></tr></tbody></table></div><div class=paragraph><p>Uma vez que esta diretiva tenha sido adicionada ao arquivo <span class=filename>sudoers</span>, qualquer configuração de usuário pode ser atualizada com a solicitação para acessar o log. No exemplo mostrado, a entrada <em>webteam</em> atualizada teria as seguintes alterações adicionais:</p></div><div class="literalblock programlisting"><div class=content><pre>%webteam ALL=(ALL) NOPASSWD: LOG_INPUT: LOG_OUTPUT: /usr/sbin/service webservice *</pre></div></div><div class=paragraph><p>Deste ponto em diante, todos os membros do grupo <em>webteam</em> que alteram o status do aplicativo <em>webservice</em> serão registrados. A lista de sessões anteriores e atuais pode ser exibida com:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># sudoreplay -l</span></code></pre></div></div><div class=paragraph><p>Na saída, para reproduzir uma sessão específica, procure a entrada <code>TSID=</code> e passe-a para o sudoreplay sem outras opções para reproduzir a sessão na velocidade normal. Por exemplo:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># sudoreplay user1/00/00/02</span></code></pre></div></div><div class="admonitionblock warning"><table><tbody><tr><td class=icon><i class="fa icon-warning" title=Warning></i></td><td class=content><div class=paragraph><p>Enquanto as sessões são registradas, qualquer administrador pode remover as sessões e deixar apenas uma questão de por que elas fizeram isso. Vale a pena adicionar uma verificação diária por meio de um sistema de detecção de intrusão (IDS) ou software semelhante para que outros administradores sejam alertados sobre alterações manuais.</p></div></td></tr></tbody></table></div><div class=paragraph><p>O <code>sudoreplay</code> é extremamente extensível. Consulte a documentação para mais informações.</p></div></div></div></div></div><hr><div class=last-modified><p><strong>Última alteração em</strong>: 9 de março de 2024 por <a href="https://cgit.freebsd.org/doc/commit/?id=6199af92e7" target=_blank>Danilo G. Baio</a></p></div><div class=buttons><div class=prev><i class="fa fa-angle-left" aria-hidden=true title=Anterior></i><div class=container><a href=https://docs.freebsd.org/pt-br/books/handbook/boot class=direction>Anterior</a></div></div><div class=home><i class="fa fa-home" aria-hidden=true title=Início></i><div class=container><a href=../ class=direction>Início</a></div></div><div class=next><div class=container><a href=https://docs.freebsd.org/pt-br/books/handbook/jails class=direction>Próximo</a></div><i class="fa fa-angle-right" aria-hidden=true title=Próximo></i></div></div><label class="hidden book-menu-overlay" for=menu-control></label></div><aside class=toc><div class=toc-content><h3>Índice</h3><nav id=TableOfContents><ul><li><a href=#security-synopsis>13.1. Sinopse</a></li><li><a href=#security-intro>13.2. Introdução</a></li><li><a href=#one-time-passwords>13.3. Senhas de Uso Unico</a></li><li><a href=#tcpwrappers>13.4. TCP Wrapper</a></li><li><a href=#kerberos5>13.5. Kerberos</a></li><li><a href=#openssl>13.6. OpenSSL</a></li><li><a href=#ipsec>13.7. VPN Sobre IPsec</a></li><li><a href=#openssh>13.8. OpenSSH</a></li><li><a href=#fs-acl>13.9. Listas de Controle de Acesso</a></li><li><a href=#security-pkg>13.10. Monitorando Problemas de Segurança de Terceiros</a></li><li><a href=#security-advisories>13.11. Avisos de Segurança do FreeBSD</a></li><li><a href=#security-accounting>13.12. Auditoria de Processo</a></li><li><a href=#security-resourcelimits>13.13. Limites de Recursos</a></li><li><a href=#security-sudo>13.14. Administração Compartilhada com Sudo</a></li></ul></nav><hr><div class=resources><h3>Recursos</h3><ul class=contents><li><i class="fa fa-file-pdf-o" aria-hidden=true title="Download PDF"></i><a href=https://download.freebsd.org/doc/pt-br/books/handbook/handbook_pt-br.pdf>Download PDF</a></li><li><i class="fa fa-pencil-square-o" aria-hidden=true title="Edite essa página"></i><a href=https://github.com/freebsd/freebsd-doc/blob/main/documentation/content/pt-br/_index target=_blank>Edite essa página</a></li></ul></div></div></aside><a class=to-top href=#top><i class="fa fa-arrow-circle-up" aria-hidden=true></i></a></main><footer><div class=footer-container><section class=logo-column><img src=https://docs.freebsd.org/images/FreeBSD-colors.svg width=160 height=50 alt="FreeBSD logo"><div class=options-container><div class=language-container><a id=languages href=https://docs.freebsd.org/pt-br/languages><img src=https://docs.freebsd.org/images/language.png class=language-image alt="Escolha o idioma">
<span>Brazilian Portuguese</span></a></div><div class=theme-container><select id=theme-chooser><option value=theme-system>System</option><option value=theme-light>Light</option><option value=theme-dark>Dark</option><option value=theme-high-contrast>Alto contraste</option></select></div></div></section><section class=about-column><h3 class=column-title>About</h3><ul class=column-elements-container><li><a href=https://www.freebsd.org/about/ target=_blank class=column-element>FreeBSD</a></li><li><a href=https://freebsdfoundation.org/ target=_blank class=column-element>FreeBSD Foundation</a></li><li><a href=https://www.freebsd.org/where/ target=_blank class=column-element>Get FreeBSD</a></li><li><a href=https://www.freebsd.org/internal/code-of-conduct target=_blank class=column-element>Code of Conduct</a></li><li><a href=https://www.freebsd.org/security/ target=_blank class=column-element>Security Advisories</a></li></ul></section><section class=documentation-column><h3 class=column-title>Documentation</h3><ul class=column-elements-container><li><a href=/pt-br class=column-element>Documentation portal</a></li><li><a href=https://man.FreeBSD.org target=_blank class=column-element>Manual pages</a></li><li><a href=https://papers.FreeBSD.org target=_blank class=column-element>Presentations and papers</a></li><li><a href=https://docs-archive.freebsd.org/doc/ target=_blank class=column-element>Previous versions</a></li><li><a href=https://docs-archive.freebsd.org/44doc/ target=_blank class=column-element>4.4BSD Documents</a></li><li><a href=https://wiki.freebsd.org/ target=_blank class=column-element>Wiki</a></li></ul></section><section class=community-column><h3 class=column-title>Community</h3><ul class=column-elements-container><li><a href=https://docs.freebsd.org/pt-br/articles/contributing class=column-element>Get involved</a></li><li><a href=https://forums.freebsd.org/ target=_blank class=column-element>Community forum</a></li><li><a href=https://lists.freebsd.org/ target=_blank class=column-element>Mailing lists</a></li><li><a href=https://wiki.freebsd.org/IRC/Channels target=_blank class=column-element>IRC Channels</a></li><li><a href=https://bugs.freebsd.org/bugzilla/ target=_blank class=column-element>Bug Tracker</a></li></ul></section><section class=legal-column><h3 class=column-title>Legal</h3><ul class=column-elements-container><li><a href=https://freebsdfoundation.org/donate/ target=_blank class=column-element>Donations</a></li><li><a href=https://www.freebsd.org/copyright/freebsd-license/ target=_blank class=column-element>Licensing</a></li><li><a href=https://www.freebsd.org/privacy/ target=_blank class=column-element>Privacy Policy</a></li><li><a href=https://www.freebsd.org/copyright/ target=_blank class=column-element>Legal notices</a></li></ul></section><section class=copyright-column><p>&copy; 1994-2024 The FreeBSD Project. All rights reserved</p><span>Made with <span class=heart>♥</span> by the FreeBSD Community</span></section></div></footer></body></html>