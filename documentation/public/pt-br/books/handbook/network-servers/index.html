<!doctype html><html class=theme-light lang=pt-br><head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content><meta name=keywords content><meta name=copyright content="1995-2024 The FreeBSD Foundation"><link rel=canonical href=http://172.16.201.134:1313/pt-br/books/handbook/network-servers/><title>Capítulo 29. Servidores de Rede | FreeBSD Documentation Portal</title>
<meta name=theme-color content="#790000"><meta name=color-scheme content="system light dark high-contrast"><link rel="shortcut icon" href=http://172.16.201.134:1313/favicon.ico><link rel=stylesheet href=http://172.16.201.134:1313/styles/main.min.css><link rel=stylesheet href=http://172.16.201.134:1313/css/font-awesome-min.css><script defer src=/js/theme-chooser.min.js></script><script defer src=/js/copy-clipboard.min.js></script><script defer src=/js/search.min.js></script><meta name=twitter:card content="summary"><meta name=twitter:domain content="docs.FreeBSD.org"><meta name=twitter:site content="@freebsd"><meta name=twitter:url content="https://twitter.com/freebsd"><meta property="og:title" content="Capítulo 29. Servidores de Rede"><meta property="og:description" content><meta property="og:type" content="website"><meta property="og:image" content="http://172.16.201.134:1313/favicon.ico"><meta property="og:image:alt" content="FreeBSD Logo"><meta property="og:locale" content="pt-br"><meta property="og:url" content="http://172.16.201.134:1313/pt-br/books/handbook/network-servers/"><meta property="og:site_name" content="FreeBSD Documentation Portal"><script type=application/ld+json>{"@context":"http://schema.org","@type":"Article","url":"http:\/\/172.16.201.134:1313\/pt-br\/books\/handbook\/network-servers\/","name":"FreeBSD Documentation Portal","headline":"FreeBSD Documentation Portal","description":"FreeBSD Documentation Portal"}</script></head><body><header><div class=header-container><div class=logo-menu-bars-container><a href=https://www.FreeBSD.org class=logo><img src=http://172.16.201.134:1313/images/FreeBSD-monochromatic.svg width=160 height=50 alt="FreeBSD logo">
</a><label class=menu-bars for=menu-bars><i class="fa fa-bars" aria-hidden=true></i></label></div><input id=menu-bars type=checkbox><nav><ul class=menu><li class=menu-item><input id=about type=checkbox>
<a href=# aria-label="Navigate to About section"><label class=menu-item-description for=about>About
<i class="fa fa-angle-down fa-lg" aria-hidden=true></i></label></a><ul class=sub-menu><li class=title><a href=https://www.freebsd.org/about/ target=_blank>About</a></li><li><a href=https://www.freebsd.org/about/ target=_blank>FreeBSD</a></li><li><a href=https://freebsdfoundation.org/about-us/about-the-foundation/ target=_blank>FreeBSD Foundation</a></li><li><a href=https://www.freebsd.org/internal/code-of-conduct/ target=_blank>Code of Conduct</a></li></ul></li><li class=menu-item><input id=download type=checkbox>
<a href=# aria-label="Navigate to get FreeBSD section"><label class=menu-item-description for=download>Get FreeBSD
<i class="fa fa-angle-down fa-lg" aria-hidden=true></i></label></a><ul class=sub-menu><li class=title><a href=https://www.freebsd.org/where/ target=_blank>Get FreeBSD</a></li><li><a href=https://www.freebsd.org/releases/ target=_blank>Release Information</a></li><li><a href=https://www.freebsd.org/releng/ target=_blank>Release Engineering</a></li><li><a href=https://www.freebsd.org/security/ target=_blank>Security Advisories</a></li></ul></li><li class=menu-item><input id=documentation type=checkbox>
<a href=# aria-label="Navigate to get Documentation section"><label class=menu-item-description for=documentation>Documentation
<i class="fa fa-angle-down fa-lg" aria-hidden=true></i></label></a><ul class=sub-menu><li class=title><a href=/pt-br>Documentation portal</a></li><li><a href=http://172.16.201.134:1313/pt-br/books/handbook>FreeBSD Handbook</a></li><li><a href=http://172.16.201.134:1313/pt-br/books/porters-handbook>Porter's Handbook</a></li><li><a href=https://docs.FreeBSD.org/en/books/fdp-primer>Documentation Project Handbook</a></li><li><a href=https://man.FreeBSD.org target=_blank>Manual pages</a></li><li><a href=https://papers.FreeBSD.org target=_blank>Presentations and papers</a></li><li><a href=https://wiki.FreeBSD.org target=_blank>Wiki</a></li><li><a href=http://172.16.201.134:1313/pt-br/books>Books</a></li><li><a href=http://172.16.201.134:1313/pt-br/articles>Articles</a></li></ul></li><li class=menu-item><input id=community type=checkbox>
<a href=# aria-label="Navigate to get Community section"><label class=menu-item-description for=community>Community
<i class="fa fa-angle-down fa-lg" aria-hidden=true></i></label></a><ul class=sub-menu><li class=title><a href=https://www.freebsd.org/community/>Community</a></li><li><a href=http://172.16.201.134:1313/pt-br/articles/contributing>Get involved</a></li><li><a href=https://forums.freebsd.org/ target=_blank>Forum</a></li><li><a href=https://lists.freebsd.org/ target=_blank>Mailing lists</a></li><li><a href=https://wiki.freebsd.org/IRC/Channels target=_blank>IRC Channels</a></li><li><a href=https://bugs.freebsd.org/bugzilla/ target=_blank>Bug Tracker</a></li><li><a href=https://www.freebsd.org/support/ target=_blank>Support</a></li></ul></li></ul></nav><div class=search-donate-container><form class=search method=get id=search-header-form action=https://docs.freebsd.org/search name=search-header-form><input type=hidden name=DB value=pt-br>
<input id=words name=P type=text size=20 maxlength=255>
<button>
<i class="fa fa-search" aria-hidden=true></i></button></form><div class=donate><a href=https://freebsdfoundation.org/donate/ target=_blank><span class=heart>♥</span>
Donate</a></div></div></div></header><input type=checkbox class="hidden toggle" id=menu-control><main class=main-wrapper-book><a id=top></a><aside class=book-menu><div class=book-menu-content><input id=search-book type=text placeholder=Pesquisar aria-label=Pesquisar maxlength=128><nav id=MenuContents><ul><li><input type=checkbox id=chapter-eb2a98ce203d8afd517726e6d8776be3 class=toggle>
<label class="icon cursor" for=chapter-eb2a98ce203d8afd517726e6d8776be3><a role=button></a></label><a href=http://172.16.201.134:1313/pt-br/books/handbook/preface/>Prefácio</a><ul><li><a href=http://172.16.201.134:1313/pt-br/books/handbook/preface/#preface-audience>Audiência Pretendida</a></li><li><a href=http://172.16.201.134:1313/pt-br/books/handbook/preface/#preface-changes-from3>Mudanças desde a Terceira Edição</a></li><li><a href=http://172.16.201.134:1313/pt-br/books/handbook/preface/#preface-changes-from2>Mudanças desde a Segunda Edição (2004)</a></li><li><a href=http://172.16.201.134:1313/pt-br/books/handbook/preface/#preface-changes>Mudanças desde a Primeira Edição (2001)</a></li><li><a href=http://172.16.201.134:1313/pt-br/books/handbook/preface/#preface-overview>Organização deste Livro</a></li><li><a href=http://172.16.201.134:1313/pt-br/books/handbook/preface/#preface-conv>Convenções utilizadas neste livro</a></li><li><a href=http://172.16.201.134:1313/pt-br/books/handbook/preface/#preface-acknowledgements>Agradecimentos</a></li></ul></li><li><input type=checkbox id=chapter-14a525fce014b90b8a458a894818255a class=toggle>
<label for=chapter-14a525fce014b90b8a458a894818255a><a role=button></a></label><a href=http://172.16.201.134:1313/pt-br/books/handbook/parti/>Parte I. Primeiros Passos</a></li><li><input type=checkbox id=chapter-f9c9f3451644df30d224350da97d5da6 class=toggle>
<label class="icon cursor" for=chapter-f9c9f3451644df30d224350da97d5da6><a role=button></a></label><a href=http://172.16.201.134:1313/pt-br/books/handbook/introduction/>Capítulo 1. Introdução</a><ul><li><a href=http://172.16.201.134:1313/pt-br/books/handbook/introduction/#introduction-synopsis>1.1. Sinopse</a></li><li><a href=http://172.16.201.134:1313/pt-br/books/handbook/introduction/#nutshell>1.2. Bem vindo ao FreeBSD!</a></li><li><a href=http://172.16.201.134:1313/pt-br/books/handbook/introduction/#history>1.3. Sobre o Projeto FreeBSD</a></li></ul></li><li><input type=checkbox id=chapter-f693a3fa687a72d63ec8129ee302d664 class=toggle>
<label class="icon cursor" for=chapter-f693a3fa687a72d63ec8129ee302d664><a role=button></a></label><a href=http://172.16.201.134:1313/pt-br/books/handbook/bsdinstall/>Capítulo 2. Instalando o FreeBSD</a><ul><li><a href=http://172.16.201.134:1313/pt-br/books/handbook/bsdinstall/#bsdinstall-synopsis>2.1. Sinopse</a></li><li><a href=http://172.16.201.134:1313/pt-br/books/handbook/bsdinstall/#bsdinstall-hardware>2.2. Requisitos mínimos de hardware</a></li><li><a href=http://172.16.201.134:1313/pt-br/books/handbook/bsdinstall/#bsdinstall-pre>2.3. Tarefas de Pré-instalação</a></li><li><a href=http://172.16.201.134:1313/pt-br/books/handbook/bsdinstall/#bsdinstall-start>2.4. Iniciando a instalação</a></li><li><a href=http://172.16.201.134:1313/pt-br/books/handbook/bsdinstall/#using-bsdinstall>2.5. Usando o bsdinstall</a></li><li><a href=http://172.16.201.134:1313/pt-br/books/handbook/bsdinstall/#bsdinstall-partitioning>2.6. Alocando o espaço em disco</a></li><li><a href=http://172.16.201.134:1313/pt-br/books/handbook/bsdinstall/#bsdinstall-fetching-distribution>2.7. Fazendo o download dos arquivos de distribuição</a></li><li><a href=http://172.16.201.134:1313/pt-br/books/handbook/bsdinstall/#bsdinstall-post>2.8. Contas, Time Zone, Serviços e Hardening</a></li><li><a href=http://172.16.201.134:1313/pt-br/books/handbook/bsdinstall/#bsdinstall-network>2.9. Interfaces de Rede</a></li><li><a href=http://172.16.201.134:1313/pt-br/books/handbook/bsdinstall/#bsdinstall-install-trouble>2.10. Solução de problemas</a></li><li><a href=http://172.16.201.134:1313/pt-br/books/handbook/bsdinstall/#using-live-cd>2.11. Usando o Live CD</a></li></ul></li><li><input type=checkbox id=chapter-9f6db261075f578742036fcc6000eecd class=toggle>
<label class="icon cursor" for=chapter-9f6db261075f578742036fcc6000eecd><a role=button></a></label><a href=http://172.16.201.134:1313/pt-br/books/handbook/basics/>Capítulo 3. Fundamentos do FreeBSD</a><ul><li><a href=http://172.16.201.134:1313/pt-br/books/handbook/basics/#basics-synopsis>3.1. Sinopse</a></li><li><a href=http://172.16.201.134:1313/pt-br/books/handbook/basics/#consoles>3.2. Consoles e Terminais Virtuais</a></li><li><a href=http://172.16.201.134:1313/pt-br/books/handbook/basics/#users-synopsis>3.3. Usuários e Gerenciamento Básico de Contas</a></li><li><a href=http://172.16.201.134:1313/pt-br/books/handbook/basics/#permissions>3.4. Permissões</a></li><li><a href=http://172.16.201.134:1313/pt-br/books/handbook/basics/#dirstructure>3.5. Estrutura de Diretórios</a></li><li><a href=http://172.16.201.134:1313/pt-br/books/handbook/basics/#disk-organization>3.6. Organização dos Discos</a></li><li><a href=http://172.16.201.134:1313/pt-br/books/handbook/basics/#mount-unmount>3.7. Montando e Desmontando Sistemas de Arquivos</a></li><li><a href=http://172.16.201.134:1313/pt-br/books/handbook/basics/#basics-processes>3.8. Processos e Daemons</a></li><li><a href=http://172.16.201.134:1313/pt-br/books/handbook/basics/#shells>3.9. Shells</a></li><li><a href=http://172.16.201.134:1313/pt-br/books/handbook/basics/#editors>3.10. Editores de Texto</a></li><li><a href=http://172.16.201.134:1313/pt-br/books/handbook/basics/#basics-devices>3.11. Dispositivos e nós de dispositivos</a></li><li><a href=http://172.16.201.134:1313/pt-br/books/handbook/basics/#basics-more-information>3.12. Páginas de Manual</a></li></ul></li><li><input type=checkbox id=chapter-01c5707e95d14c0ff84bf62600c958d1 class=toggle>
<label class="icon cursor" for=chapter-01c5707e95d14c0ff84bf62600c958d1><a role=button></a></label><a href=http://172.16.201.134:1313/pt-br/books/handbook/ports/>Capítulo 4. Instalando Aplicativos: Pacotes e Ports</a><ul><li><a href=http://172.16.201.134:1313/pt-br/books/handbook/ports/#ports-synopsis>4.1. Sinopse</a></li><li><a href=http://172.16.201.134:1313/pt-br/books/handbook/ports/#ports-overview>4.2. Visão geral sobre a Instalação de Software</a></li><li><a href=http://172.16.201.134:1313/pt-br/books/handbook/ports/#ports-finding-applications>4.3. Encontrando Software</a></li><li><a href=http://172.16.201.134:1313/pt-br/books/handbook/ports/#pkgng-intro>4.4. Usando o pkg para o gerenciamento de pacotes binários</a></li><li><a href=http://172.16.201.134:1313/pt-br/books/handbook/ports/#ports-using>4.5. Usando a Coleção de Ports</a></li><li><a href=http://172.16.201.134:1313/pt-br/books/handbook/ports/#ports-poudriere>4.6. Compilando Pacotes com o Poudriere</a></li><li><a href=http://172.16.201.134:1313/pt-br/books/handbook/ports/#ports-nextsteps>4.7. Considerações pós-instalação</a></li><li><a href=http://172.16.201.134:1313/pt-br/books/handbook/ports/#ports-broken>4.8. Lidando com ports quebrados</a></li></ul></li><li><input type=checkbox id=chapter-3405c00581365a8b5d16af70fe4d1b72 class=toggle>
<label class="icon cursor" for=chapter-3405c00581365a8b5d16af70fe4d1b72><a role=button></a></label><a href=http://172.16.201.134:1313/pt-br/books/handbook/x11/>Capítulo 5. O sistema X Window</a><ul><li><a href=http://172.16.201.134:1313/pt-br/books/handbook/x11/#x11-synopsis>5.1. Sinopse</a></li><li><a href=http://172.16.201.134:1313/pt-br/books/handbook/x11/#x-understanding>5.2. Terminologia</a></li><li><a href=http://172.16.201.134:1313/pt-br/books/handbook/x11/#x-install>5.3. Instalando o Xorg</a></li><li><a href=http://172.16.201.134:1313/pt-br/books/handbook/x11/#x-config>5.4. Configuração do Xorg</a></li><li><a href=http://172.16.201.134:1313/pt-br/books/handbook/x11/#x-fonts>5.5. Usando fontes no Xorg</a></li><li><a href=http://172.16.201.134:1313/pt-br/books/handbook/x11/#x-xdm>5.6. O Gerenciador de Display X</a></li><li><a href=http://172.16.201.134:1313/pt-br/books/handbook/x11/#x11-wm>5.7. Ambientes de desktop</a></li><li><a href=http://172.16.201.134:1313/pt-br/books/handbook/x11/#x-compiz-fusion>5.8. Instalando o Compiz Fusion</a></li><li><a href=http://172.16.201.134:1313/pt-br/books/handbook/x11/#x11-troubleshooting>5.9. Solução de problemas</a></li></ul></li><li><input type=checkbox id=chapter-0eab3565e8f59f5a8a896dfba7eb3680 class=toggle>
<label for=chapter-0eab3565e8f59f5a8a896dfba7eb3680><a role=button></a></label><a href=http://172.16.201.134:1313/pt-br/books/handbook/partii/>Parte II. Tarefas comuns</a></li><li><input type=checkbox id=chapter-b33cf28993f3f7bf5baf036e79da0f39 class=toggle>
<label class="icon cursor" for=chapter-b33cf28993f3f7bf5baf036e79da0f39><a role=button></a></label><a href=http://172.16.201.134:1313/pt-br/books/handbook/desktop/>Capítulo 6. Aplicações de Desktop</a><ul><li><a href=http://172.16.201.134:1313/pt-br/books/handbook/desktop/#desktop-synopsis>6.1. Sinopse</a></li><li><a href=http://172.16.201.134:1313/pt-br/books/handbook/desktop/#desktop-browsers>6.2. Navegadores</a></li><li><a href=http://172.16.201.134:1313/pt-br/books/handbook/desktop/#desktop-productivity>6.3. Produtividade</a></li><li><a href=http://172.16.201.134:1313/pt-br/books/handbook/desktop/#desktop-viewers>6.4. Visualizadores de Documentos</a></li><li><a href=http://172.16.201.134:1313/pt-br/books/handbook/desktop/#desktop-finance>6.5. Finanças</a></li></ul></li><li><input type=checkbox id=chapter-152f694a19312ad72ec7bb4e1c3c33b2 class=toggle>
<label class="icon cursor" for=chapter-152f694a19312ad72ec7bb4e1c3c33b2><a role=button></a></label><a href=http://172.16.201.134:1313/pt-br/books/handbook/multimedia/>Capítulo 7. Multimídia</a><ul><li><a href=http://172.16.201.134:1313/pt-br/books/handbook/multimedia/#multimedia-synopsis>7.1. Sinopse</a></li><li><a href=http://172.16.201.134:1313/pt-br/books/handbook/multimedia/#sound-setup>7.2. Configurando a Placa de Som</a></li><li><a href=http://172.16.201.134:1313/pt-br/books/handbook/multimedia/#sound-mp3>7.3. Áudio MP3</a></li><li><a href=http://172.16.201.134:1313/pt-br/books/handbook/multimedia/#video-playback>7.4. Reprodução de Vídeo</a></li><li><a href=http://172.16.201.134:1313/pt-br/books/handbook/multimedia/#tvcard>7.5. Placas de TV</a></li><li><a href=http://172.16.201.134:1313/pt-br/books/handbook/multimedia/#mythtv>7.6. MythTV</a></li><li><a href=http://172.16.201.134:1313/pt-br/books/handbook/multimedia/#scanners>7.7. Scanners de Imagem</a></li></ul></li><li><input type=checkbox id=chapter-80888b4ee02e3e409e5f71cf97a36450 class=toggle>
<label class="icon cursor" for=chapter-80888b4ee02e3e409e5f71cf97a36450><a role=button></a></label><a href=http://172.16.201.134:1313/pt-br/books/handbook/kernelconfig/>Capítulo 8. Configurando o kernel do FreeBSD</a><ul><li><a href=http://172.16.201.134:1313/pt-br/books/handbook/kernelconfig/#kernelconfig-synopsis>8.1. Sinopse</a></li><li><a href=http://172.16.201.134:1313/pt-br/books/handbook/kernelconfig/#kernelconfig-custom-kernel>8.2. Por que compilar um kernel personalizado?</a></li><li><a href=http://172.16.201.134:1313/pt-br/books/handbook/kernelconfig/#kernelconfig-devices>8.3. Encontrando o hardware do sistema</a></li><li><a href=http://172.16.201.134:1313/pt-br/books/handbook/kernelconfig/#kernelconfig-config>8.4. O Arquivo de Configuração</a></li><li><a href=http://172.16.201.134:1313/pt-br/books/handbook/kernelconfig/#kernelconfig-building>8.5. Criando e Instalando um Kernel Customizado</a></li><li><a href=http://172.16.201.134:1313/pt-br/books/handbook/kernelconfig/#kernelconfig-trouble>8.6. Se algo der errado</a></li></ul></li><li><input type=checkbox id=chapter-cb174c55879b17ab955f2f16989a79e0 class=toggle>
<label class="icon cursor" for=chapter-cb174c55879b17ab955f2f16989a79e0><a role=button></a></label><a href=http://172.16.201.134:1313/pt-br/books/handbook/printing/>Capítulo 9. Impressão</a><ul><li><a href=http://172.16.201.134:1313/pt-br/books/handbook/printing/#printing-quick-start>9.1. Inicio Rápido</a></li><li><a href=http://172.16.201.134:1313/pt-br/books/handbook/printing/#printing-connections>9.2. Conexões de Impressora</a></li><li><a href=http://172.16.201.134:1313/pt-br/books/handbook/printing/#printing-pdls>9.3. Linguagens de Descrição de Página Comuns</a></li><li><a href=http://172.16.201.134:1313/pt-br/books/handbook/printing/#printing-direct>9.4. Impressão Direta</a></li><li><a href=http://172.16.201.134:1313/pt-br/books/handbook/printing/#printing-lpd>9.5. LPD (Daemon de impressora de linha)</a></li><li><a href=http://172.16.201.134:1313/pt-br/books/handbook/printing/#printing-other>9.6. Outros sistemas de impressão</a></li></ul></li><li><input type=checkbox id=chapter-c12b8c3f2a8fcefce87087241f695c83 class=toggle>
<label class="icon cursor" for=chapter-c12b8c3f2a8fcefce87087241f695c83><a role=button></a></label><a href=http://172.16.201.134:1313/pt-br/books/handbook/linuxemu/>Capítulo 10. Compatibilidade binária com o Linux®</a><ul><li><a href=http://172.16.201.134:1313/pt-br/books/handbook/linuxemu/#linuxemu-synopsis>10.1. Sinopse</a></li><li><a href=http://172.16.201.134:1313/pt-br/books/handbook/linuxemu/#linuxemu-lbc-install>10.2. Configurando a compatibilidade binária com o Linux™</a></li><li><a href=http://172.16.201.134:1313/pt-br/books/handbook/linuxemu/#linuxemu-advanced>10.3. Tópicos Avançados</a></li></ul></li><li><input type=checkbox id=chapter-03b11ba627b9a0c85b247f5641bde272 class=toggle>
<label for=chapter-03b11ba627b9a0c85b247f5641bde272><a role=button></a></label><a href=http://172.16.201.134:1313/pt-br/books/handbook/partiii/>Parte III. Administração do Sistema</a></li><li><input type=checkbox id=chapter-6c31587f8d736319f099cd4dc1961301 class=toggle>
<label class="icon cursor" for=chapter-6c31587f8d736319f099cd4dc1961301><a role=button></a></label><a href=http://172.16.201.134:1313/pt-br/books/handbook/config/>Capítulo 11. Configuração e Ajuste</a><ul><li><a href=http://172.16.201.134:1313/pt-br/books/handbook/config/#config-synopsis>11.1. Sinopse</a></li><li><a href=http://172.16.201.134:1313/pt-br/books/handbook/config/#configtuning-starting-services>11.2. Inicialização de Serviços</a></li><li><a href=http://172.16.201.134:1313/pt-br/books/handbook/config/#configtuning-cron>11.3. Configurando o cron(8)</a></li><li><a href=http://172.16.201.134:1313/pt-br/books/handbook/config/#configtuning-rcd>11.4. Gerenciando Serviços no FreeBSD</a></li><li><a href=http://172.16.201.134:1313/pt-br/books/handbook/config/#config-network-setup>11.5. Configurando Placas de Interface de Rede</a></li><li><a href=http://172.16.201.134:1313/pt-br/books/handbook/config/#configtuning-virtual-hosts>11.6. Hosts Virtuais</a></li><li><a href=http://172.16.201.134:1313/pt-br/books/handbook/config/#configtuning-syslog>11.7. Configurando o log do sistema</a></li><li><a href=http://172.16.201.134:1313/pt-br/books/handbook/config/#configtuning-configfiles>11.8. Arquivos de Configuração</a></li><li><a href=http://172.16.201.134:1313/pt-br/books/handbook/config/#configtuning-sysctl>11.9. Efetuando ajustes com o sysctl(8)</a></li><li><a href=http://172.16.201.134:1313/pt-br/books/handbook/config/#configtuning-disk>11.10. Otimização de Discos</a></li><li><a href=http://172.16.201.134:1313/pt-br/books/handbook/config/#configtuning-kernel-limits>11.11. Ajustando os Limites do Kernel</a></li><li><a href=http://172.16.201.134:1313/pt-br/books/handbook/config/#adding-swap-space>11.12. Adicionando Espaço de Swap</a></li><li><a href=http://172.16.201.134:1313/pt-br/books/handbook/config/#acpi-overview>11.13. Gerenciamento de energia e recursos</a></li></ul></li><li><input type=checkbox id=chapter-459f0012b3b4f0b6b123010f029da5e4 class=toggle>
<label class="icon cursor" for=chapter-459f0012b3b4f0b6b123010f029da5e4><a role=button></a></label><a href=http://172.16.201.134:1313/pt-br/books/handbook/boot/>Capítulo 12. O processo de inicialização do FreeBSD</a><ul><li><a href=http://172.16.201.134:1313/pt-br/books/handbook/boot/#boot-synopsis>12.1. Sinopse</a></li><li><a href=http://172.16.201.134:1313/pt-br/books/handbook/boot/#boot-introduction>12.2. Processo de Inicialização do FreeBSD</a></li><li><a href=http://172.16.201.134:1313/pt-br/books/handbook/boot/#boot-splash>12.3. Configurando telas iniciais de inicialização</a></li><li><a href=http://172.16.201.134:1313/pt-br/books/handbook/boot/#device-hints>12.4. Sugestões de dispositivos</a></li><li><a href=http://172.16.201.134:1313/pt-br/books/handbook/boot/#boot-shutdown>12.5. Sequência de Desligamento</a></li></ul></li><li><input type=checkbox id=chapter-917c75fcffbb14d48ed6d0a48e7028f2 class=toggle>
<label class="icon cursor" for=chapter-917c75fcffbb14d48ed6d0a48e7028f2><a role=button></a></label><a href=http://172.16.201.134:1313/pt-br/books/handbook/security/>Capítulo 13. Segurança</a><ul><li><a href=http://172.16.201.134:1313/pt-br/books/handbook/security/#security-synopsis>13.1. Sinopse</a></li><li><a href=http://172.16.201.134:1313/pt-br/books/handbook/security/#security-intro>13.2. Introdução</a></li><li><a href=http://172.16.201.134:1313/pt-br/books/handbook/security/#one-time-passwords>13.3. Senhas de Uso Unico</a></li><li><a href=http://172.16.201.134:1313/pt-br/books/handbook/security/#tcpwrappers>13.4. TCP Wrapper</a></li><li><a href=http://172.16.201.134:1313/pt-br/books/handbook/security/#kerberos5>13.5. Kerberos</a></li><li><a href=http://172.16.201.134:1313/pt-br/books/handbook/security/#openssl>13.6. OpenSSL</a></li><li><a href=http://172.16.201.134:1313/pt-br/books/handbook/security/#ipsec>13.7. VPN Sobre IPsec</a></li><li><a href=http://172.16.201.134:1313/pt-br/books/handbook/security/#openssh>13.8. OpenSSH</a></li><li><a href=http://172.16.201.134:1313/pt-br/books/handbook/security/#fs-acl>13.9. Listas de Controle de Acesso</a></li><li><a href=http://172.16.201.134:1313/pt-br/books/handbook/security/#security-pkg>13.10. Monitorando Problemas de Segurança de Terceiros</a></li><li><a href=http://172.16.201.134:1313/pt-br/books/handbook/security/#security-advisories>13.11. Avisos de Segurança do FreeBSD</a></li><li><a href=http://172.16.201.134:1313/pt-br/books/handbook/security/#security-accounting>13.12. Auditoria de Processo</a></li><li><a href=http://172.16.201.134:1313/pt-br/books/handbook/security/#security-resourcelimits>13.13. Limites de Recursos</a></li><li><a href=http://172.16.201.134:1313/pt-br/books/handbook/security/#security-sudo>13.14. Administração Compartilhada com Sudo</a></li></ul></li><li><input type=checkbox id=chapter-1a2a8e719703649c2c66d99aa7a25fd4 class=toggle>
<label class="icon cursor" for=chapter-1a2a8e719703649c2c66d99aa7a25fd4><a role=button></a></label><a href=http://172.16.201.134:1313/pt-br/books/handbook/jails/>Capítulo 14. Jails</a><ul><li><a href=http://172.16.201.134:1313/pt-br/books/handbook/jails/#jails-synopsis>14.1. Sinopse</a></li><li><a href=http://172.16.201.134:1313/pt-br/books/handbook/jails/#jails-terms>14.2. Termos Relacionados à Jails</a></li><li><a href=http://172.16.201.134:1313/pt-br/books/handbook/jails/#jails-build>14.3. Criando e Controlando Jails</a></li><li><a href=http://172.16.201.134:1313/pt-br/books/handbook/jails/#jails-tuning>14.4. Tuning e Administração</a></li><li><a href=http://172.16.201.134:1313/pt-br/books/handbook/jails/#jails-application>14.5. Atualizando Múltiplas Jails</a></li><li><a href=http://172.16.201.134:1313/pt-br/books/handbook/jails/#jails-ezjail>14.6. Gerenciando Jails com o ezjail</a></li></ul></li><li><input type=checkbox id=chapter-8f4620c77e572cbb58917911a33c73cf class=toggle>
<label class="icon cursor" for=chapter-8f4620c77e572cbb58917911a33c73cf><a role=button></a></label><a href=http://172.16.201.134:1313/pt-br/books/handbook/mac/>Capítulo 15. Controle de acesso obrigatório</a><ul><li><a href=http://172.16.201.134:1313/pt-br/books/handbook/mac/#mac-synopsis>15.1. Sinopse</a></li><li><a href=http://172.16.201.134:1313/pt-br/books/handbook/mac/#mac-inline-glossary>15.2. Termos chave</a></li><li><a href=http://172.16.201.134:1313/pt-br/books/handbook/mac/#mac-understandlabel>15.3. Entendendo os rótulos MAC</a></li><li><a href=http://172.16.201.134:1313/pt-br/books/handbook/mac/#mac-planning>15.4. Planejando a configuração de segurança</a></li><li><a href=http://172.16.201.134:1313/pt-br/books/handbook/mac/#mac-policies>15.5. Políticas MAC Disponíveis</a></li><li><a href=http://172.16.201.134:1313/pt-br/books/handbook/mac/#mac-userlocked>15.6. Bloqueio do Usuário</a></li><li><a href=http://172.16.201.134:1313/pt-br/books/handbook/mac/#mac-implementing>15.7. Nagios em Jail MAC</a></li><li><a href=http://172.16.201.134:1313/pt-br/books/handbook/mac/#mac-troubleshoot>15.8. Solução de problemas do framework MAC</a></li></ul></li><li><input type=checkbox id=chapter-9598d66a76cb3182057b6bcd775149a0 class=toggle>
<label class="icon cursor" for=chapter-9598d66a76cb3182057b6bcd775149a0><a role=button></a></label><a href=http://172.16.201.134:1313/pt-br/books/handbook/audit/>Capítulo 16. Auditoria de Evento de Segurança</a><ul><li><a href=http://172.16.201.134:1313/pt-br/books/handbook/audit/#audit-synopsis>16.1. Sinopse</a></li><li><a href=http://172.16.201.134:1313/pt-br/books/handbook/audit/#audit-inline-glossary>16.2. Termos chave</a></li><li><a href=http://172.16.201.134:1313/pt-br/books/handbook/audit/#audit-config>16.3. Configuração de Auditoria</a></li><li><a href=http://172.16.201.134:1313/pt-br/books/handbook/audit/#audit-administration>16.4. Trabalhando com Trilhas de Auditoria</a></li></ul></li><li><input type=checkbox id=chapter-e1edcad13d9db6e8e4cb645d378ecfaf class=toggle>
<label class="icon cursor" for=chapter-e1edcad13d9db6e8e4cb645d378ecfaf><a role=button></a></label><a href=http://172.16.201.134:1313/pt-br/books/handbook/disks/>Capítulo 17. Armazenamento</a><ul><li><a href=http://172.16.201.134:1313/pt-br/books/handbook/disks/#disks-synopsis>17.1. Sinopse</a></li><li><a href=http://172.16.201.134:1313/pt-br/books/handbook/disks/#disks-adding>17.2. Adicionando Discos</a></li><li><a href=http://172.16.201.134:1313/pt-br/books/handbook/disks/#disks-growing>17.3. Redimensionando e Ampliando Discos</a></li><li><a href=http://172.16.201.134:1313/pt-br/books/handbook/disks/#usb-disks>17.4. Dispositivos de Armazenamento USB</a></li><li><a href=http://172.16.201.134:1313/pt-br/books/handbook/disks/#creating-cds>17.5. Criando e Usando Mídia em CD</a></li><li><a href=http://172.16.201.134:1313/pt-br/books/handbook/disks/#creating-dvds>17.6. Criando e Usando Mídia de DVD</a></li><li><a href=http://172.16.201.134:1313/pt-br/books/handbook/disks/#floppies>17.7. Criando e Usando Disquetes</a></li><li><a href=http://172.16.201.134:1313/pt-br/books/handbook/disks/#backup-basics>17.8. Noções Básicas de Backup</a></li><li><a href=http://172.16.201.134:1313/pt-br/books/handbook/disks/#disks-virtual>17.9. Discos de Memória</a></li><li><a href=http://172.16.201.134:1313/pt-br/books/handbook/disks/#snapshots>17.10. Snapshots de Sistemas de Arquivos</a></li><li><a href=http://172.16.201.134:1313/pt-br/books/handbook/disks/#quotas>17.11. Cotas de Disco</a></li><li><a href=http://172.16.201.134:1313/pt-br/books/handbook/disks/#disks-encrypting>17.12. Criptografando Partições de Disco</a></li><li><a href=http://172.16.201.134:1313/pt-br/books/handbook/disks/#swap-encrypting>17.13. Criptografando Swap</a></li><li><a href=http://172.16.201.134:1313/pt-br/books/handbook/disks/#disks-hast>17.14. Alta Disponibilidade de Armazenamento (HAST)</a></li></ul></li><li><input type=checkbox id=chapter-dde37901a0e0ea32745b67607854900f class=toggle>
<label class="icon cursor" for=chapter-dde37901a0e0ea32745b67607854900f><a role=button></a></label><a href=http://172.16.201.134:1313/pt-br/books/handbook/geom/>Capítulo 18. GEOM: Framework de Transformação de Disco Modular</a><ul><li><a href=http://172.16.201.134:1313/pt-br/books/handbook/geom/#geom-synopsis>18.1. Sinopse</a></li><li><a href=http://172.16.201.134:1313/pt-br/books/handbook/geom/#geom-striping>18.2. RAID0 - Striping</a></li><li><a href=http://172.16.201.134:1313/pt-br/books/handbook/geom/#geom-mirror>18.3. RAID1 - Espelhamento</a></li><li><a href=http://172.16.201.134:1313/pt-br/books/handbook/geom/#geom-raid3>18.4. RAID3 - Distribuição em Nível de Byte com Paridade Dedicada</a></li><li><a href=http://172.16.201.134:1313/pt-br/books/handbook/geom/#geom-graid>18.5. Dispositivos RAID por Software</a></li><li><a href=http://172.16.201.134:1313/pt-br/books/handbook/geom/#geom-ggate>18.6. GEOM Network Gate</a></li><li><a href=http://172.16.201.134:1313/pt-br/books/handbook/geom/#geom-glabel>18.7. Rotulando Dispositivos de Disco</a></li><li><a href=http://172.16.201.134:1313/pt-br/books/handbook/geom/#geom-gjournal>18.8. Journaling UFS através do GEOM</a></li></ul></li><li><input type=checkbox id=chapter-73e82560fcb7145b7c0e2ec47af8fc04 class=toggle>
<label class="icon cursor" for=chapter-73e82560fcb7145b7c0e2ec47af8fc04><a role=button></a></label><a href=http://172.16.201.134:1313/pt-br/books/handbook/zfs/>Capítulo 19. O sistema de arquivos Z (ZFS)</a><ul><li><a href=http://172.16.201.134:1313/pt-br/books/handbook/zfs/#zfs-differences>19.1. O que torna o ZFS diferente</a></li><li><a href=http://172.16.201.134:1313/pt-br/books/handbook/zfs/#zfs-quickstart>19.2. Guia de Início Rápido</a></li><li><a href=http://172.16.201.134:1313/pt-br/books/handbook/zfs/#zfs-zpool>19.3. Administração <code>zpool</code></a></li><li><a href=http://172.16.201.134:1313/pt-br/books/handbook/zfs/#zfs-zfs>19.4. Administração do <code>zfs</code></a></li><li><a href=http://172.16.201.134:1313/pt-br/books/handbook/zfs/#zfs-zfs-allow>19.5. Administração Delegada</a></li><li><a href=http://172.16.201.134:1313/pt-br/books/handbook/zfs/#zfs-advanced>19.6. Tópicos Avançados</a></li><li><a href=http://172.16.201.134:1313/pt-br/books/handbook/zfs/#zfs-links>19.7. Recursos adicionais</a></li><li><a href=http://172.16.201.134:1313/pt-br/books/handbook/zfs/#zfs-term>19.8. Recursos e terminologia do ZFS</a></li></ul></li><li><input type=checkbox id=chapter-7af71270807eb7b70cd3eedc6577b254 class=toggle>
<label class="icon cursor" for=chapter-7af71270807eb7b70cd3eedc6577b254><a role=button></a></label><a href=http://172.16.201.134:1313/pt-br/books/handbook/filesystems/>Capítulo 20. Outros Sistemas de Arquivos</a><ul><li><a href=http://172.16.201.134:1313/pt-br/books/handbook/filesystems/#filesystems-synopsis>20.1. Sinopse</a></li><li><a href=http://172.16.201.134:1313/pt-br/books/handbook/filesystems/#filesystems-linux>20.2. Sistemas de arquivos do Linux™</a></li></ul></li><li><input type=checkbox id=chapter-375257268d95faaf87faf4f7a2e6aa67 class=toggle>
<label class="icon cursor" for=chapter-375257268d95faaf87faf4f7a2e6aa67><a role=button></a></label><a href=http://172.16.201.134:1313/pt-br/books/handbook/virtualization/>Capítulo 21. Virtualização</a><ul><li><a href=http://172.16.201.134:1313/pt-br/books/handbook/virtualization/#virtualization-synopsis>21.1. Sinopse</a></li><li><a href=http://172.16.201.134:1313/pt-br/books/handbook/virtualization/#virtualization-guest-parallels>21.2. FreeBSD como Sistema Operacional Convidado no Parallels para Mac OS™ X</a></li><li><a href=http://172.16.201.134:1313/pt-br/books/handbook/virtualization/#virtualization-guest-virtualpc>21.3. FreeBSD como sistema convidado no Virtual PC para Windows™</a></li><li><a href=http://172.16.201.134:1313/pt-br/books/handbook/virtualization/#virtualization-guest-vmware>21.4. FreeBSD como Sistema Operacional Convidado no VMware Fusion para Mac OS™</a></li><li><a href=http://172.16.201.134:1313/pt-br/books/handbook/virtualization/#virtualization-guest-virtualbox>21.5. FreeBSD como Sistema Operacional Convidado no VirtualBox™</a></li><li><a href=http://172.16.201.134:1313/pt-br/books/handbook/virtualization/#virtualization-host-virtualbox>21.6. FreeBSD como Host com VirtualBox™</a></li><li><a href=http://172.16.201.134:1313/pt-br/books/handbook/virtualization/#virtualization-host-bhyve>21.7. FreeBSD como um Host bhyve</a></li><li><a href=http://172.16.201.134:1313/pt-br/books/handbook/virtualization/#virtualization-host-xen>21.8. FreeBSD como Host Xen™</a></li></ul></li><li><input type=checkbox id=chapter-49f1e96591c090304ea532012257f4ef class=toggle>
<label class="icon cursor" for=chapter-49f1e96591c090304ea532012257f4ef><a role=button></a></label><a href=http://172.16.201.134:1313/pt-br/books/handbook/l10n/>Capítulo 22. Localização - Uso e Configuração do i18n/L10n</a><ul><li><a href=http://172.16.201.134:1313/pt-br/books/handbook/l10n/#l10n-synopsis>22.1. Sinopse</a></li><li><a href=http://172.16.201.134:1313/pt-br/books/handbook/l10n/#using-localization>22.2. Usando Localização</a></li><li><a href=http://172.16.201.134:1313/pt-br/books/handbook/l10n/#l10n-compiling>22.3. Encontrando Aplicações i18n</a></li><li><a href=http://172.16.201.134:1313/pt-br/books/handbook/l10n/#lang-setup>22.4. Configuração de Localização para Idiomas Específicos</a></li></ul></li><li><input type=checkbox id=chapter-dead2b4c5ea325dd390a9b0dccd8f763 class=toggle>
<label class="icon cursor" for=chapter-dead2b4c5ea325dd390a9b0dccd8f763><a role=button></a></label><a href=http://172.16.201.134:1313/pt-br/books/handbook/cutting-edge/>Capítulo 23. Atualização e Upgrade do FreeBSD</a><ul><li><a href=http://172.16.201.134:1313/pt-br/books/handbook/cutting-edge/#updating-upgrading-synopsis>23.1. Sinopse</a></li><li><a href=http://172.16.201.134:1313/pt-br/books/handbook/cutting-edge/#updating-upgrading-freebsdupdate>23.2. Atualização do FreeBSD</a></li><li><a href=http://172.16.201.134:1313/pt-br/books/handbook/cutting-edge/#updating-upgrading-documentation>23.3. Atualizando o Conjunto de Documentação</a></li><li><a href=http://172.16.201.134:1313/pt-br/books/handbook/cutting-edge/#current-stable>23.4. Acompanhando um ramo de desenvolvimento</a></li><li><a href=http://172.16.201.134:1313/pt-br/books/handbook/cutting-edge/#makeworld>23.5. Atualizando o FreeBSD a partir do código fonte</a></li><li><a href=http://172.16.201.134:1313/pt-br/books/handbook/cutting-edge/#small-lan>23.6. Atualização de várias máquinas</a></li></ul></li><li><input type=checkbox id=chapter-29c1eeb0e9dedc487a98399e2737ee8a class=toggle>
<label class="icon cursor" for=chapter-29c1eeb0e9dedc487a98399e2737ee8a><a role=button></a></label><a href=http://172.16.201.134:1313/pt-br/books/handbook/dtrace/>Chapter 24. DTrace</a><ul><li><a href=http://172.16.201.134:1313/pt-br/books/handbook/dtrace/#dtrace-synopsis>24.1. Sinopse</a></li><li><a href=http://172.16.201.134:1313/pt-br/books/handbook/dtrace/#dtrace-implementation>24.2. Diferenças de Implementação</a></li><li><a href=http://172.16.201.134:1313/pt-br/books/handbook/dtrace/#dtrace-enable>24.3. Ativando o Suporte do DTrace</a></li><li><a href=http://172.16.201.134:1313/pt-br/books/handbook/dtrace/#dtrace-using>24.4. Usando o DTrace</a></li></ul></li><li><input type=checkbox id=chapter-913e72bfb3d6947b2869d3e9447a6eaa class=toggle>
<label class="icon cursor" for=chapter-913e72bfb3d6947b2869d3e9447a6eaa><a role=button></a></label><a href=http://172.16.201.134:1313/pt-br/books/handbook/usb-device-mode/>Capítulo 25. Modo de dispositivo USB/USB OTG</a><ul><li><a href=http://172.16.201.134:1313/pt-br/books/handbook/usb-device-mode/#usb-device-mode-synopsis>25.1. Sinopse</a></li><li><a href=http://172.16.201.134:1313/pt-br/books/handbook/usb-device-mode/#usb-device-mode-terminals>25.2. Portas Seriais Virtuais USB</a></li><li><a href=http://172.16.201.134:1313/pt-br/books/handbook/usb-device-mode/#usb-device-mode-network>25.3. Interfaces de rede do modo de dispositivo USB</a></li><li><a href=http://172.16.201.134:1313/pt-br/books/handbook/usb-device-mode/#usb-device-mode-storage>25.4. Dispositivo de armazenamento virtual USB</a></li></ul></li><li><input type=checkbox id=chapter-bbd25f9a194f9c39ca2d658c75767db5 class=toggle>
<label for=chapter-bbd25f9a194f9c39ca2d658c75767db5><a role=button></a></label><a href=http://172.16.201.134:1313/pt-br/books/handbook/partiv/>Parte IV. Comunicação de rede</a></li><li><input type=checkbox id=chapter-499dab596afd7ddac77e80295314e0dd class=toggle>
<label class="icon cursor" for=chapter-499dab596afd7ddac77e80295314e0dd><a role=button></a></label><a href=http://172.16.201.134:1313/pt-br/books/handbook/serialcomms/>Capítulo 26. Comunicações Seriais</a><ul><li><a href=http://172.16.201.134:1313/pt-br/books/handbook/serialcomms/#serial-synopsis>26.1. Sinopse</a></li><li><a href=http://172.16.201.134:1313/pt-br/books/handbook/serialcomms/#serial>26.2. Terminologia serial e hardware</a></li><li><a href=http://172.16.201.134:1313/pt-br/books/handbook/serialcomms/#term>26.3. Terminais</a></li><li><a href=http://172.16.201.134:1313/pt-br/books/handbook/serialcomms/#dialup>26.4. Serviço Dial-in</a></li><li><a href=http://172.16.201.134:1313/pt-br/books/handbook/serialcomms/#dialout>26.5. Serviço de Dial-in</a></li><li><a href=http://172.16.201.134:1313/pt-br/books/handbook/serialcomms/#serialconsole-setup>26.6. Configurando o Console Serial</a></li></ul></li><li><input type=checkbox id=chapter-95e4571c48bee1cced5e84a538d302e3 class=toggle>
<label class="icon cursor" for=chapter-95e4571c48bee1cced5e84a538d302e3><a role=button></a></label><a href=http://172.16.201.134:1313/pt-br/books/handbook/ppp-and-slip/>Capítulo 27. PPP</a><ul><li><a href=http://172.16.201.134:1313/pt-br/books/handbook/ppp-and-slip/#ppp-and-slip-synopsis>27.1. Sinopse</a></li><li><a href=http://172.16.201.134:1313/pt-br/books/handbook/ppp-and-slip/#userppp>27.2. Configurando o PPP</a></li><li><a href=http://172.16.201.134:1313/pt-br/books/handbook/ppp-and-slip/#ppp-troubleshoot>27.3. Solução de problemas de conexões PPP</a></li><li><a href=http://172.16.201.134:1313/pt-br/books/handbook/ppp-and-slip/#pppoe>27.4. Usando o PPP sobre Ethernet (PPPoE)</a></li><li><a href=http://172.16.201.134:1313/pt-br/books/handbook/ppp-and-slip/#pppoa>27.5. Usando PPP sobre ATM (PPPoA)</a></li></ul></li><li><input type=checkbox id=chapter-f089ac726c401c9b4bd5c34a295e11bb class=toggle>
<label class="icon cursor" for=chapter-f089ac726c401c9b4bd5c34a295e11bb><a role=button></a></label><a href=http://172.16.201.134:1313/pt-br/books/handbook/mail/>Capítulo 28. Correio Eletrônico</a><ul><li><a href=http://172.16.201.134:1313/pt-br/books/handbook/mail/#mail-synopsis>28.1. Sinopse</a></li><li><a href=http://172.16.201.134:1313/pt-br/books/handbook/mail/#mail-using>28.2. Componentes de Email</a></li><li><a href=http://172.16.201.134:1313/pt-br/books/handbook/mail/#sendmail>28.3. Arquivos de Configuração do Sendmail</a></li><li><a href=http://172.16.201.134:1313/pt-br/books/handbook/mail/#mail-changingmta>28.4. Alterando o Mail Transfer Agent</a></li><li><a href=http://172.16.201.134:1313/pt-br/books/handbook/mail/#mail-trouble>28.5. Solução de problemas</a></li><li><a href=http://172.16.201.134:1313/pt-br/books/handbook/mail/#mail-advanced>28.6. Tópicos Avançados</a></li><li><a href=http://172.16.201.134:1313/pt-br/books/handbook/mail/#outgoing-only>28.7. Configurando Apenas Envio</a></li><li><a href=http://172.16.201.134:1313/pt-br/books/handbook/mail/#SMTP-dialup>28.8. Usando Email com uma Conexão Dialup</a></li><li><a href=http://172.16.201.134:1313/pt-br/books/handbook/mail/#SMTP-Auth>28.9. Autenticação SMTP</a></li><li><a href=http://172.16.201.134:1313/pt-br/books/handbook/mail/#mail-agents>28.10. Mail User Agents</a></li><li><a href=http://172.16.201.134:1313/pt-br/books/handbook/mail/#mail-fetchmail>28.11. Usando o fetchmail</a></li><li><a href=http://172.16.201.134:1313/pt-br/books/handbook/mail/#mail-procmail>28.12. Usando o procmail</a></li></ul></li><li><input type=checkbox id=chapter-6de4de3fe925639d4175ce4b6f8c1829 class=toggle checked>
<label class="icon cursor" for=chapter-6de4de3fe925639d4175ce4b6f8c1829><a role=button></a></label><a href=http://172.16.201.134:1313/pt-br/books/handbook/network-servers/>Capítulo 29. Servidores de Rede</a><ul><li><a href=http://172.16.201.134:1313/pt-br/books/handbook/network-servers/#network-servers-synopsis>29.1. Sinopse</a></li><li><a href=http://172.16.201.134:1313/pt-br/books/handbook/network-servers/#network-inetd>29.2. O super-servidor inetd</a></li><li><a href=http://172.16.201.134:1313/pt-br/books/handbook/network-servers/#network-nfs>29.3. Network File System (NFS)</a></li><li><a href=http://172.16.201.134:1313/pt-br/books/handbook/network-servers/#network-nis>29.4. Sistema de Informação de Rede (NIS)</a></li><li><a href=http://172.16.201.134:1313/pt-br/books/handbook/network-servers/#network-ldap>29.5. Protocolo leve de acesso de diretório ( LDAP )</a></li><li><a href=http://172.16.201.134:1313/pt-br/books/handbook/network-servers/#network-dhcp>29.6. Protocolo de configuração dinâmica de hosts (DHCP)</a></li><li><a href=http://172.16.201.134:1313/pt-br/books/handbook/network-servers/#network-dns>29.7. Sistema de Nomes de Domínio (DNS)</a></li><li><a href=http://172.16.201.134:1313/pt-br/books/handbook/network-servers/#network-apache>29.8. Servidor HTTP Apache</a></li><li><a href=http://172.16.201.134:1313/pt-br/books/handbook/network-servers/#network-ftp>29.9. Protocolo de Transferência de Arquivos (FTP)</a></li><li><a href=http://172.16.201.134:1313/pt-br/books/handbook/network-servers/#network-samba>29.10. Serviços de arquivos e impressão para clientes Microsoft™Windows™ Clients (Samba)</a></li><li><a href=http://172.16.201.134:1313/pt-br/books/handbook/network-servers/#network-ntp>29.11. Sincronização de Relógio com NTP</a></li><li><a href=http://172.16.201.134:1313/pt-br/books/handbook/network-servers/#network-iscsi>29.12. Inicializador iSCSI e Configuração Alvo</a></li></ul></li><li><input type=checkbox id=chapter-776d855c7b75e048f90b5c2c9b35ffe0 class=toggle>
<label class="icon cursor" for=chapter-776d855c7b75e048f90b5c2c9b35ffe0><a role=button></a></label><a href=http://172.16.201.134:1313/pt-br/books/handbook/firewalls/>Capítulo 30. Firewalls</a><ul><li><a href=http://172.16.201.134:1313/pt-br/books/handbook/firewalls/#firewalls-intro>30.1. Sinopse</a></li><li><a href=http://172.16.201.134:1313/pt-br/books/handbook/firewalls/#firewalls-concepts>30.2. Conceitos de Firewall</a></li><li><a href=http://172.16.201.134:1313/pt-br/books/handbook/firewalls/#firewalls-pf>30.3. PF</a></li><li><a href=http://172.16.201.134:1313/pt-br/books/handbook/firewalls/#firewalls-ipfw>30.4. IPFW</a></li><li><a href=http://172.16.201.134:1313/pt-br/books/handbook/firewalls/#firewalls-ipf>30.5. IPFILTER (IPF)</a></li><li><a href=http://172.16.201.134:1313/pt-br/books/handbook/firewalls/#firewalls-blacklistd>30.6. Blacklistd</a></li></ul></li><li><input type=checkbox id=chapter-5b07f776a0e6155c1c89aa0d15610380 class=toggle>
<label class="icon cursor" for=chapter-5b07f776a0e6155c1c89aa0d15610380><a role=button></a></label><a href=http://172.16.201.134:1313/pt-br/books/handbook/advanced-networking/>Capítulo 31. Rede Avançada</a><ul><li><a href=http://172.16.201.134:1313/pt-br/books/handbook/advanced-networking/#advanced-networking-synopsis>31.1. Sinopse</a></li><li><a href=http://172.16.201.134:1313/pt-br/books/handbook/advanced-networking/#network-routing>31.2. Gateways e Rotas</a></li><li><a href=http://172.16.201.134:1313/pt-br/books/handbook/advanced-networking/#network-wireless>31.3. Rede sem fio</a></li><li><a href=http://172.16.201.134:1313/pt-br/books/handbook/advanced-networking/#network-usb-tethering>31.4. USB Tethering</a></li><li><a href=http://172.16.201.134:1313/pt-br/books/handbook/advanced-networking/#network-bluetooth>31.5. Bluetooth</a></li><li><a href=http://172.16.201.134:1313/pt-br/books/handbook/advanced-networking/#network-bridging>31.6. Bridging</a></li><li><a href=http://172.16.201.134:1313/pt-br/books/handbook/advanced-networking/#network-aggregation>31.7. Agregação de links e failover</a></li><li><a href=http://172.16.201.134:1313/pt-br/books/handbook/advanced-networking/#network-diskless>31.8. Operação Diskless com PXE</a></li><li><a href=http://172.16.201.134:1313/pt-br/books/handbook/advanced-networking/#network-ipv6>31.9. IPv6</a></li><li><a href=http://172.16.201.134:1313/pt-br/books/handbook/advanced-networking/#carp>31.10. Protocolo Comum de Redundância de Endereços (CARP)</a></li><li><a href=http://172.16.201.134:1313/pt-br/books/handbook/advanced-networking/#network-vlan>31.11. VLANs</a></li></ul></li><li><input type=checkbox id=chapter-171a77aa9d067a1024f849470e1f33e8 class=toggle>
<label for=chapter-171a77aa9d067a1024f849470e1f33e8><a role=button></a></label><a href=http://172.16.201.134:1313/pt-br/books/handbook/partv/>Parte V. Apêndices</a></li><li><input type=checkbox id=chapter-8050f436a0a7986a4aaded93d8e49469 class=toggle>
<label class="icon cursor" for=chapter-8050f436a0a7986a4aaded93d8e49469><a role=button></a></label><a href=http://172.16.201.134:1313/pt-br/books/handbook/mirrors/>Apêndice A. Obtendo o FreeBSD</a><ul><li><a href=http://172.16.201.134:1313/pt-br/books/handbook/mirrors/#mirrors-cdrom>A.1. CD and DVD Sets</a></li><li><a href=http://172.16.201.134:1313/pt-br/books/handbook/mirrors/#mirrors-ftp>A.2. Sites de FTP</a></li><li><a href=http://172.16.201.134:1313/pt-br/books/handbook/mirrors/#svn>A.3. Usando o Subversion</a></li><li><a href=http://172.16.201.134:1313/pt-br/books/handbook/mirrors/#mirrors-rsync>A.4. Usando o rsync</a></li></ul></li><li><input type=checkbox id=chapter-128b630a8f88f158e7027fe6c2184d21 class=toggle>
<label class="icon cursor" for=chapter-128b630a8f88f158e7027fe6c2184d21><a role=button></a></label><a href=http://172.16.201.134:1313/pt-br/books/handbook/bibliography/>Apêndice B. Bibliografia</a><ul><li><a href=http://172.16.201.134:1313/pt-br/books/handbook/bibliography/#bibliography-freebsd>B.1. Livros específicos para o FreeBSD</a></li><li><a href=http://172.16.201.134:1313/pt-br/books/handbook/bibliography/#bibliography-userguides>B.2. Guias de usuários</a></li><li><a href=http://172.16.201.134:1313/pt-br/books/handbook/bibliography/#bibliography-adminguides>B.3. Guias de Administradores</a></li><li><a href=http://172.16.201.134:1313/pt-br/books/handbook/bibliography/#bibliography-programmers>B.4. Guias de programadores</a></li><li><a href=http://172.16.201.134:1313/pt-br/books/handbook/bibliography/#bibliography-osinternals>B.5. Internals do sistema operacional</a></li><li><a href=http://172.16.201.134:1313/pt-br/books/handbook/bibliography/#bibliography-security>B.6. Referências de segurança</a></li><li><a href=http://172.16.201.134:1313/pt-br/books/handbook/bibliography/#bibliography-hardware>B.7. Referências de Hardware</a></li><li><a href=http://172.16.201.134:1313/pt-br/books/handbook/bibliography/#bibliography-history>B.8. História do UNIX™</a></li><li><a href=http://172.16.201.134:1313/pt-br/books/handbook/bibliography/#bibliography-journals>B.9. Periódicos, Jornais e Revistas</a></li></ul></li><li><input type=checkbox id=chapter-8bbb8867c46dac315e2253945d8c18a8 class=toggle>
<label class="icon cursor" for=chapter-8bbb8867c46dac315e2253945d8c18a8><a role=button></a></label><a href=http://172.16.201.134:1313/pt-br/books/handbook/eresources/>Apêndice C. Recursos na Internet</a><ul><li><a href=http://172.16.201.134:1313/pt-br/books/handbook/eresources/#eresources-www>C.1. Websites</a></li><li><a href=http://172.16.201.134:1313/pt-br/books/handbook/eresources/#eresources-mail>C.2. Listas de Discussão</a></li><li><a href=http://172.16.201.134:1313/pt-br/books/handbook/eresources/#eresources-news>C.3. Grupos de Notícias Usenet</a></li><li><a href=http://172.16.201.134:1313/pt-br/books/handbook/eresources/#eresources-web>C.4. Espelhos Oficiais</a></li></ul></li><li><input type=checkbox id=chapter-a80ea4f5a4480b8725422710f954ef36 class=toggle>
<label class="icon cursor" for=chapter-a80ea4f5a4480b8725422710f954ef36><a role=button></a></label><a href=http://172.16.201.134:1313/pt-br/books/handbook/pgpkeys/>Apêndice D. Chaves OpenPGP</a><ul><li><a href=http://172.16.201.134:1313/pt-br/books/handbook/pgpkeys/#pgpkeys-officers>D.1. Administradores</a></li></ul></li><li></li></ul></nav></div></aside><div class=book><div class=book-menu-mobile><label for=menu-control><span class=menu-control-button><i class="fa fa-list" aria-hidden=true title=Menu></i>
Menu</span></label></div><h1 class=title>Capítulo 29. Servidores de Rede</h1><div class="admonitionblock note"><p><i class="fa fa-exclamation-circle" aria-hidden=true></i>
Esta tradução pode estar desatualizada. Para ajudar com as traduções, acesse a <a href=https://translate-dev.freebsd.org/ target=_blank>ferramenta de traduções do FreeBSD</a>.</p></div><div class=toc-mobile><h3>Índice</h3><nav id=TableOfContents><ul><li><a href=#network-servers-synopsis>29.1. Sinopse</a></li><li><a href=#network-inetd>29.2. O super-servidor inetd</a></li><li><a href=#network-nfs>29.3. Network File System (NFS)</a></li><li><a href=#network-nis>29.4. Sistema de Informação de Rede (NIS)</a></li><li><a href=#network-ldap>29.5. Protocolo leve de acesso de diretório ( LDAP )</a></li><li><a href=#network-dhcp>29.6. Protocolo de configuração dinâmica de hosts (DHCP)</a></li><li><a href=#network-dns>29.7. Sistema de Nomes de Domínio (DNS)</a></li><li><a href=#network-apache>29.8. Servidor HTTP Apache</a></li><li><a href=#network-ftp>29.9. Protocolo de Transferência de Arquivos (FTP)</a></li><li><a href=#network-samba>29.10. Serviços de arquivos e impressão para clientes Microsoft™Windows™ Clients (Samba)</a></li><li><a href=#network-ntp>29.11. Sincronização de Relógio com NTP</a></li><li><a href=#network-iscsi>29.12. Inicializador iSCSI e Configuração Alvo</a></li></ul></nav></div><div class=book-content><div id=preamble><div class=sectionbody></div></div><div class=sect1><h2 id=network-servers-synopsis>29.1. Sinopse<a class=anchor href=#network-servers-synopsis></a></h2><div class=sectionbody><div class=paragraph><p>Este capítulo aborda alguns dos serviços de rede usados com mais frequência em sistemas UNIX™. Isso inclui instalar, configurar, testar e manter muitos tipos diferentes de serviços de rede. Exemplos de arquivos de configuração estão incluídos neste capítulo para referência.</p></div><div class=paragraph><p>No final deste capítulo, os leitores saberão:</p></div><div class=ulist><ul><li><p>Como gerenciar o daemon inetd.</p></li><li><p>Como configurar o Network File System (NFS).</p></li><li><p>Como configurar o Network Information Server (NIS) para centralizar e compartilhar contas de usuários.</p></li><li><p>Como configurar o FreeBSD para funcionar como um servidor ou cliente LDAP</p></li><li><p>Como configurar configurações de rede automáticas usando o DHCP.</p></li><li><p>Como configurar um Domain Name Server (DNS).</p></li><li><p>Como configurar o servidor ApacheHTTP.</p></li><li><p>Como Configurar um Servidor de File Transfer Protocol (FTP).</p></li><li><p>Como configurar um servidor de arquivo e de impressão para clientes Windows™ usando o Samba.</p></li><li><p>Como sincronizar a hora e a data e configurar um servidor de horário usando o Network Time Protocol (NTP).</p></li><li><p>Como configurar o iSCSI.</p></li></ul></div><div class=paragraph><p>Este capítulo pressupõe um conhecimento básico de:</p></div><div class=ulist><ul><li><p>scripts <span class=filename>/etc/rc</span>.</p></li><li><p>Terminologia de rede.</p></li><li><p>Instalação de software adicional de terceiros (<a href=../ports/#ports>Instalando Aplicativos. Pacotes e Ports</a>).</p></li></ul></div></div></div><div class=sect1><h2 id=network-inetd>29.2. O super-servidor inetd<a class=anchor href=#network-inetd></a></h2><div class=sectionbody><div class=paragraph><p>O daemon <a href="https://man.freebsd.org/cgi/man.cgi?query=inetd&amp;sektion=8&amp;format=html">inetd(8)</a> é algumas vezes chamado de Super-Servidor porque gerencia conexões para muitos serviços. Em vez de iniciar vários aplicativos, apenas o serviço inetd precisa ser iniciado. Quando uma conexão é recebida para um serviço gerenciado pelo inetd, ele determina para qual programa a conexão está destinada, gera um processo para esse programa e delega ao programa um socket. O uso de inetd para serviços que não são muito usados pode reduzir a carga do sistema, quando comparado à execução de cada daemon individualmente no modo independente.</p></div><div class=paragraph><p>Primeiramente, inetd é usado para gerar outros daemons, mas vários protocolos triviais são tratados internamente, como chargen, auth, time, echo, discard e daytime.</p></div><div class=paragraph><p>Esta seção aborda os conceitos básicos da configuração do inetd.</p></div><div class=sect2><h3 id=network-inetd-conf>29.2.1. Arquivo de Configuração<a class=anchor href=#network-inetd-conf></a></h3><div class=paragraph><p>A configuração do inetd é feita editando o <span class=filename>/etc/inetd.conf</span>. Cada linha deste arquivo de configuração representa um aplicativo que pode ser iniciado pelo inetd. Por padrão, cada linha começa com um comentário (<code><mark></mark></code>), o que significa que inetd não está atendendo a nenhum aplicativo. Para configurar o inetd para escutar as conexões de um aplicativo, remova o <code></code> no início da linha desse aplicativo.</p></div><div class=paragraph><p>Depois de salvar suas edições, configure o inetd para iniciar na inicialização do sistema editando o arquivo <span class=filename>/etc/rc.conf</span>:</p></div><div class="literalblock programlisting"><div class=content><pre>inetd_enable=&#34;YES&#34;</pre></div></div><div class=paragraph><p>Para iniciar o inetd agora, para que ele ouça o serviço que você configurou, digite:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># service inetd start</span></code></pre></div></div><div class=paragraph><p>Uma vez iniciado o inetd, ele precisa ser notificado sempre que uma modificação for feita no arquivo <span class=filename>/etc/inetd.conf</span>:</p></div><div id=network-inetd-reread class=exampleblock><div class=title>Exemplo 1. Recarregando o Arquivo de Configuração do inetd</div><div class=content><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># service inetd reload</span></code></pre></div></div></div></div><div class=paragraph><p>Normalmente, a entrada padrão de um aplicativo não precisa ser editada além da remoção do <code>#</code>. Em algumas situações, pode ser apropriado editar a entrada padrão.</p></div><div class=paragraph><p>Como exemplo, esta é a entrada padrão para <a href="https://man.freebsd.org/cgi/man.cgi?query=ftpd&amp;sektion=8&amp;format=html">ftpd(8)</a> sobre o IPv4:</p></div><div class="literalblock programlisting"><div class=content><pre>ftp     stream  tcp     nowait  root    /usr/libexec/ftpd       ftpd -l</pre></div></div><div class=paragraph><p>As sete colunas em uma entrada são as seguintes:</p></div><div class="literalblock programlisting"><div class=content><pre>service-name
socket-type
protocol
{wait|nowait}[/max-child[/max-connections-per-ip-per-minute[/max-child-per-ip]]]
user[:group][/login-class]
server-program
server-program-arguments</pre></div></div><div class=paragraph><p>Onde:</p></div><div class=dlist><dl><dt class=hdlist1>service-name</dt><dd><p>O nome do serviço do daemon para iniciar. Deve corresponder a um serviço listado no arquivo <span class=filename>/etc/services</span>. Isso determina qual porta inetd atende para conexões de entrada para esse serviço. Ao usar um serviço personalizado, ele deve primeiro ser adicionado ao arquivo <span class=filename>/etc/services</span>.</p></dd><dt class=hdlist1>socket-type</dt><dd><p>Ou <code>stream</code>, <code>dgram</code>, <code>raw</code>, ou <code>seqpacket</code>. Use <code>stream</code> para conexões TCP e <code>dgram</code> para serviços UDP.</p></dd><dt class=hdlist1>protocol</dt><dd><p>Use um dos seguintes nomes de protocolo:</p><table class="tableblock frame-none grid-all stretch informaltable"><col style=width:50%><col style=width:50%><thead><tr><th class="tableblock halign-left valign-top">Protocol Name</th><th class="tableblock halign-left valign-top">Explicação</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class=tableblock>tcp ou tcp4</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>TCP IPv4</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>udp ou udp4</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>UDP IPv4</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>tcp6</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>TCP IPv6</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>udp6</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>UDP IPv6</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>tcp46</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Ambos TCP IPv4 e IPv6</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>udp46</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Ambos UDP IPv4 e IPv6</p></td></tr></tbody></table></dd><dt class=hdlist1>{wait|nowait}[/max-child[/max-connections-per-ip-per-minute[/max-child-per-ip]]]</dt><dd><p>Neste campo, <code>wait</code> ou <code>nowait</code> deve ser especificado. <code>max-child</code>, <code>max-connections-per-ip-por-minute</code> e <code>max-child-per-ip</code> são opcionais.</p><div class=paragraph><p><code>wait|nowait</code> indica se o serviço pode ou não manipular seu próprio socket. Os tipos de socket <code>dgram</code> devem usar <code>wait</code> enquanto os daemons <code>stream</code>, que geralmente são multi-threaded, devem usar <code>nowait</code>. <code>wait</code> geralmente passa vários sockets para um único daemon, enquanto <code>nowait</code> gera um daemon filho para cada novo socket.</p></div><div class=paragraph><p>O número máximo de daemons inetd que podem aparecer é definido por <code>max-child</code>. Por exemplo, para limitar dez instâncias do daemon, coloque um <code>/10</code> após o <code>nowait</code>. Especificar <code>/0</code> permite um número ilimitado de filhos.</p></div><div class=paragraph><p><code>max-connections-per-ip-per-minute</code> limita o número de conexões de qualquer endereço específico de IP por minuto. Quando o limite for atingido, outras conexões desse endereço IP serão descartadas até o final do minuto. Por exemplo, um valor de <code>/10</code> limitaria qualquer endereço IP específico a dez tentativas de conexão por minuto. <code>max-child-per-ip</code> limita o número de processos-filhos que podem ser iniciados em nome de um único endereço IP a qualquer momento. Essas opções podem limitar o consumo excessivo de recursos e ajudar a impedir ataques de negação de serviço (DoS (Denial Of Service)).</p></div><div class=paragraph><p>Um exemplo pode ser visto nas configurações padrão para <a href="https://man.freebsd.org/cgi/man.cgi?query=fingerd&amp;sektion=8&amp;format=html">fingerd(8)</a>:</p></div><div class="literalblock programlisting"><div class=content><pre>finger stream  tcp     nowait/3/10 nobody /usr/libexec/fingerd fingerd -k -s</pre></div></div></dd><dt class=hdlist1>usuário</dt><dd><p>O nome de usuário que o daemon será executado como. Daemons geralmente são executados como <code>root</code>, <code>daemon</code>, ou <code>nobody</code>.</p></dd><dt class=hdlist1>programa servidor</dt><dd><p>O caminho completo para o daemon. Se o daemon for um serviço fornecido pelo inetd internamente, use <code>internal</code>.</p></dd><dt class=hdlist1>argumentos do programa servidor</dt><dd><p>Usado para especificar qualquer argumento de comando a ser transmitido ao daemon na chamada. Se o daemon for um serviço interno, use <code>internal</code>.</p></dd></dl></div></div><div class=sect2><h3 id=network-inetd-cmdline>29.2.2. Opções de linha de comando<a class=anchor href=#network-inetd-cmdline></a></h3><div class=paragraph><p>Como a maioria dos daemons de servidor, o inetd tem várias opções que podem ser usadas para modificar seu comportamento. Por padrão, inetd é iniciado com <code>-wW -C 60</code>. Essas opções ativam TCP wrappers para todos os serviços, incluindo serviços internos, e impedem que qualquer endereço de IP solicite qualquer serviço mais de 60 vezes por minuto.</p></div><div class=paragraph><p>Para alterar as opções padrão que são passadas para inetd, adicione uma entrada para <code>inetd_flags</code> no arquivo <span class=filename>/etc/rc.conf</span>. Se o inetd já estiver em execução, reinicie-o com <code>service inetd restart</code>.</p></div><div class=paragraph><p>As opções disponíveis de limitação de taxa são:</p></div><div class=dlist><dl><dt class=hdlist1>-c máximo</dt><dd><p>Especifique o número máximo padrão de chamadas simultâneas de cada serviço, em que o padrão é ilimitado. Pode ser sobrescrito com base no serviço usando <code>max-child</code> em <span class=filename>/etc/inetd.conf</span>.</p></dd><dt class=hdlist1>-C taxa</dt><dd><p>Especifique o número máximo padrão de vezes por minuto que um serviço pode ser chamado a partir de um único endereço de IP. Pode ser substituído com base no serviço usando <code>max-connections-per-ip-por-minute</code> em <span class=filename>/etc/inetd.conf</span>.</p></dd><dt class=hdlist1>-R taxa</dt><dd><p>Especifique o número máximo de vezes que um serviço pode ser chamado em um minuto, em que o padrão é <code>256</code>. Uma taxa de <code>0</code> permite um número ilimitado.</p></dd><dt class=hdlist1>-s máximo</dt><dd><p>Especifique o número máximo de vezes que um serviço pode ser chamado a partir de um único endereço IP a qualquer momento, em que o padrão é ilimitado. Pode ser sobrescrito com base no serviço usando <code>max-child-per-ip</code> no arquivo <span class=filename>/etc/inetd.conf</span>.</p></dd></dl></div><div class=paragraph><p>Opções adicionais estão disponíveis. Consulte <a href="https://man.freebsd.org/cgi/man.cgi?query=inetd&amp;sektion=8&amp;format=html">inetd(8)</a> para a lista completa de opções.</p></div></div><div class=sect2><h3 id=network-inetd-security>29.2.3. Considerações de segurança<a class=anchor href=#network-inetd-security></a></h3><div class=paragraph><p>Muitos dos daemons que podem ser gerenciados pelo inetd não são conscientes da segurança. Alguns daemons, como fingerd, podem fornecer informações que podem ser úteis para um invasor. Ative apenas os serviços necessários e monitore o sistema para tentativas excessivas de conexão. <code>max-connections-per-ip-por-minute</code>, <code>max-child</code> e <code>max-child-per-ip</code> podem ser usados para limitar tais ataques.</p></div><div class=paragraph><p>Por padrão, TCP wrappers estão ativados. Consulte <a href="https://man.freebsd.org/cgi/man.cgi?query=hosts_access&amp;sektion=5&amp;format=html">hosts_access(5)</a> para obter mais informações sobre como colocar restrições TCP em vários daemons chamados pelo inetd.</p></div></div></div></div><div class=sect1><h2 id=network-nfs>29.3. Network File System (NFS)<a class=anchor href=#network-nfs></a></h2><div class=sectionbody><div class=paragraph><p>O FreeBSD suporta o Network File System (NFS), que permite que um servidor compartilhe diretórios e arquivos com clientes através de uma rede. Com o NFS, os usuários e programas podem acessar arquivos em sistemas remotos como se estivessem armazenados localmente.</p></div><div class=paragraph><p>NFS tem muitos usos práticos. Alguns dos usos mais comuns incluem:</p></div><div class=ulist><ul><li><p>Os dados que seriam duplicados em cada cliente podem ser mantidos em um único local e acessados por clientes na rede.</p></li><li><p>Vários clientes podem precisar de acesso ao diretório <span class=filename>/usr/ports/distfiles</span>. Compartilhar esse diretório permite acesso rápido aos arquivos fonte sem precisar baixá-los para cada cliente.</p></li><li><p>Em grandes redes, geralmente é mais conveniente configurar um servidor central NFS no qual todos os diretórios home dos usuários são armazenados. Os usuários podem logar em um cliente em qualquer lugar da rede e ter acesso aos seus diretórios home.</p></li><li><p>A administração de exports do NFS é simplificada. Por exemplo, há apenas um sistema de arquivos no qual as políticas de segurança ou de backup devem ser definidas.</p></li><li><p>Dispositivos removíveis de armazenamento de mídia podem ser usados por outras máquinas na rede. Isso reduz o número de dispositivos em toda a rede e fornece um local centralizado para gerenciar sua segurança. Geralmente, é mais conveniente instalar software em várias máquinas a partir de uma mídia de instalação centralizada.</p></li></ul></div><div class=paragraph><p>O NFS consiste em um servidor e um ou mais clientes. O cliente acessa remotamente os dados armazenados na máquina do servidor. Para que isso funcione corretamente, alguns processos precisam ser configurados e executados.</p></div><div class=paragraph><p>Esses daemons devem estar em execução no servidor:</p></div><table class="tableblock frame-none grid-all stretch informaltable"><col style=width:50%><col style=width:50%><thead><tr><th class="tableblock halign-left valign-top">Daemon</th><th class="tableblock halign-left valign-top">Descrição</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class=tableblock>nfsd</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>O daemon NFS que atende a solicitações de clientes NFS.</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>mountd</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>O daemon de montagem do NFS que realiza solicitações recebidas do nfsd.</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>rpcbind</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Este daemon permite que clientes NF descubram qual porta o servidor NFS está usando.</p></td></tr></tbody></table><div class=paragraph><p>A execução de <a href="https://man.freebsd.org/cgi/man.cgi?query=nfsiod&amp;sektion=8&amp;format=html">nfsiod(8)</a> no cliente pode melhorar o desempenho, mas não é necessária.</p></div><div class=sect2><h3 id=network-configuring-nfs>29.3.1. Configurando o Servidor<a class=anchor href=#network-configuring-nfs></a></h3><div class=paragraph><p>Os sistemas de arquivos que o servidor NFS irá compartilhar são especificados no arquivo <span class=filename>/etc/exports</span>. Cada linha neste arquivo especifica um sistema de arquivos a ser exportado, quais clientes têm acesso a esse sistema de arquivos e quaisquer opções de acesso. Ao adicionar entradas a este arquivo, cada sistema de arquivos exportado, suas propriedades e hosts permitidos devem ocorrer em uma única linha. Se nenhum cliente estiver listado na entrada, qualquer cliente na rede poderá montar esse sistema de arquivos.</p></div><div class=paragraph><p>As seguintes entradas no arquivo <span class=filename>/etc/exports</span> demonstram como exportar sistemas de arquivos. Os exemplos podem ser modificados para corresponder aos sistemas de arquivos e nomes de clientes na rede do leitor. Existem muitas opções que podem ser usadas neste arquivo, mas apenas algumas serão mencionadas aqui. Veja <a href="https://man.freebsd.org/cgi/man.cgi?query=exports&amp;sektion=5&amp;format=html">exports(5)</a> para a lista completa de opções.</p></div><div class=paragraph><p>Este exemplo mostra como exportar <span class=filename>/cdrom</span> para três hosts chamados <em>alpha</em>, <em>bravo</em> e <em>charlie</em>:</p></div><div class="literalblock programlisting"><div class=content><pre>/cdrom -ro alpha bravo charlie</pre></div></div><div class=paragraph><p>A flag <code>-ro</code> torna o sistema de arquivos somente leitura, impedindo que os clientes façam alterações no sistema de arquivos exportado. Este exemplo assume que os nomes de host estão no DNS ou no arquivo <span class=filename>/etc/hosts</span>. Consulte <a href="https://man.freebsd.org/cgi/man.cgi?query=hosts&amp;sektion=5&amp;format=html">hosts(5)</a> se a rede não tiver um servidor de DNS.</p></div><div class=paragraph><p>O próximo exemplo exporta <span class=filename>/home</span> para três clientes pelo endereço IP. Isso pode ser útil para redes sem DNS ou <span class=filename>/etc/hosts</span>. A flag <code>-alldirs</code> permite que os subdiretórios sejam pontos de montagem. Em outras palavras, ele não montará automaticamente os subdiretórios, mas permitirá que o cliente monte os diretórios necessários conforme necessário.</p></div><div class="literalblock programlisting"><div class=content><pre>/usr/home  -alldirs  10.0.0.2 10.0.0.3 10.0.0.4</pre></div></div><div class=paragraph><p>Este próximo exemplo exporta <span class=filename>/a</span> para que dois clientes de domínios diferentes possam acessar esse sistema de arquivos. <code>-maproot=root</code> permite que o usuário <code>root</code> no sistema remoto grave os dados no sistema de arquivos exportado como <code>root</code>. Se <code>-maproot=root</code> não for especificado, o usuário <code>root</code> do cliente será mapeado para a conta <code>nobody</code> do servidor e estará sujeito às limitações de acesso definidas para <code>nobody</code>.</p></div><div class="literalblock programlisting"><div class=content><pre>/a  -maproot=root  host.example.com box.example.org</pre></div></div><div class=paragraph><p>Um cliente só pode ser especificado uma vez por sistema de arquivos. Por exemplo, se <span class=filename>/usr</span> for um único sistema de arquivos, essas entradas serão inválidas, já que ambas as entradas especificam o mesmo host:</p></div><div class="literalblock programlisting"><div class=content><pre># Invalid when /usr is one file system
/usr/src   client
/usr/ports client</pre></div></div><div class=paragraph><p>O formato correto para essa situação é usar uma entrada:</p></div><div class="literalblock programlisting"><div class=content><pre>/usr/src /usr/ports  client</pre></div></div><div class=paragraph><p>A seguir, um exemplo de uma lista de exportação válida, em que <span class=filename>/usr</span> e <span class=filename>/exports</span> são sistemas de arquivos locais:</p></div><div class="literalblock programlisting"><div class=content><pre># Export src and ports to client01 and client02, but only
# client01 has root privileges on it
/usr/src /usr/ports -maproot=root    client01
/usr/src /usr/ports               client02
# The client machines have root and can mount anywhere
# on /exports. Anyone in the world can mount /exports/obj read-only
/exports -alldirs -maproot=root      client01 client02
/exports/obj -ro</pre></div></div><div class=paragraph><p>Para habilitar os processos requeridos pelo servidor NFS no momento da inicialização, adicione estas opções ao arquivo <span class=filename>/etc/rc.conf</span>:</p></div><div class="literalblock programlisting"><div class=content><pre>rpcbind_enable=&#34;YES&#34;
nfs_server_enable=&#34;YES&#34;
mountd_enable=&#34;YES</pre></div></div><div class=paragraph><p>O servidor pode ser iniciado agora executando este comando:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># service nfsd start</span></code></pre></div></div><div class=paragraph><p>Sempre que o servidor NFS for iniciado, o mountd também é iniciado automaticamente. No entanto, mountd lê apenas <span class=filename>/etc/exports</span> quando é iniciado. Para fazer as edições subsequentes de <span class=filename>/etc/exports</span> entrarem em vigor imediatamente, force mountd para ler novamente:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># service mountd reload</span></code></pre></div></div></div><div class=sect2><h3 id=_configurando_o_cliente>29.3.2. Configurando o Cliente<a class=anchor href=#_configurando_o_cliente></a></h3><div class=paragraph><p>Para ativar clientes NFS, defina essa opção no arquivo <span class=filename>/etc/rc.conf</span> de cada cliente:</p></div><div class="literalblock programlisting"><div class=content><pre>nfs_client_enable=&#34;YES&#34;</pre></div></div><div class=paragraph><p>Em seguida, execute este comando em cada cliente NFS:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># service nfsclient start</span></code></pre></div></div><div class=paragraph><p>O cliente agora tem tudo de que precisa para montar um sistema de arquivos remoto. Nestes exemplos, o nome do servidor é <code>server</code> e o nome do cliente é <code>client</code>. Para montar <span class=filename>/home</span> no <code>server</code> para o ponto de montagem <span class=filename>/mnt</span> no <code>client</code>:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># mount server:/home /mnt</span></code></pre></div></div><div class=paragraph><p>Os arquivos e diretórios em <span class=filename>/home</span> agora estarão disponíveis no <code>client</code>, no diretório <span class=filename>/mnt</span>.</p></div><div class=paragraph><p>Para montar um sistema de arquivos remoto toda vez que o cliente for inicializado, adicione-o ao arquivo <span class=filename>/etc/fstab</span>:</p></div><div class="literalblock programlisting"><div class=content><pre>server:/home	/mnt	nfs	rw	0	0</pre></div></div><div class=paragraph><p>Consulte <a href="https://man.freebsd.org/cgi/man.cgi?query=fstab&amp;sektion=5&amp;format=html">fstab(5)</a> para obter uma descrição de todas as opções disponíveis.</p></div></div><div class=sect2><h3 id=_bloqueando>29.3.3. Bloqueando<a class=anchor href=#_bloqueando></a></h3><div class=paragraph><p>Alguns aplicativos exigem o bloqueio de arquivos para funcionar corretamente. Para ativar o bloqueio, adicione estas linhas ao arquivo <span class=filename>/etc/rc.conf</span> no cliente e no servidor:</p></div><div class="literalblock programlisting"><div class=content><pre>rpc_lockd_enable=&#34;YES&#34;
rpc_statd_enable=&#34;YES&#34;</pre></div></div><div class=paragraph><p>Então inicie as aplicações:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># service lockd start</span>
<span class=c># service statd start</span></code></pre></div></div><div class=paragraph><p>Se o bloqueio não for necessário no servidor, o cliente NFS pode ser configurado para bloquear localmente incluindo <code>-L</code> ao executar o mount. Consulte <a href="https://man.freebsd.org/cgi/man.cgi?query=mount_nfs&amp;sektion=8&amp;format=html">mount_nfs(8)</a> para mais detalhes.</p></div></div><div class=sect2><h3 id=network-autofs>29.3.4. Automatizando Montagens com <a href="https://man.freebsd.org/cgi/man.cgi?query=autofs&amp;sektion=5&amp;format=html">autofs(5)</a><a class=anchor href=#network-autofs></a></h3><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>O recurso de montagem automática <a href="https://man.freebsd.org/cgi/man.cgi?query=autofs&amp;sektion=5&amp;format=html">autofs(5)</a> é suportado a partir do FreeBSD 10.1-RELEASE. Para usar a funcionalidade automounter em versões mais antigas do FreeBSD, use <a href="https://man.freebsd.org/cgi/man.cgi?query=amd&amp;sektion=8&amp;format=html">amd(8)</a>. Este capítulo descreve apenas o montador automático <a href="https://man.freebsd.org/cgi/man.cgi?query=autofs&amp;sektion=5&amp;format=html">autofs(5)</a>.</p></div></td></tr></tbody></table></div><div class=paragraph><p>O recurso <a href="https://man.freebsd.org/cgi/man.cgi?query=autofs&amp;sektion=5&amp;format=html">autofs(5)</a> é um nome comum para vários componentes que, juntos, permitem a montagem automática de sistemas de arquivos locais e remotos sempre que um arquivo ou diretório dentro desse sistema de arquivos é acessado. Ele consiste no componente do kernel, <a href="https://man.freebsd.org/cgi/man.cgi?query=autofs&amp;sektion=5&amp;format=html">autofs(5)</a> e vários aplicativos no espaço do usuário: <a href="https://man.freebsd.org/cgi/man.cgi?query=automount&amp;sektion=8&amp;format=html">automount(8)</a>, <a href="https://man.freebsd.org/cgi/man.cgi?query=automountd&amp;sektion=8&amp;format=html">automountd(8)</a> e <a href="https://man.freebsd.org/cgi/man.cgi?query=autounmountd&amp;sektion=8&amp;format=html">autounmountd(8)</a>. Ele serve como uma alternativa para <a href="https://man.freebsd.org/cgi/man.cgi?query=amd&amp;sektion=8&amp;format=html">amd(8)</a> de versões anteriores do FreeBSD. Amd ainda é fornecido para fins de compatibilidade com versões anteriores, já que os dois usam formato de mapeamento diferentes; o usado pelo autofs é o mesmo que com outros automontadores do SVR4, como os do Solaris, MacOS X e Linux.</p></div><div class=paragraph><p>O sistema de arquivos virtual <a href="https://man.freebsd.org/cgi/man.cgi?query=autofs&amp;sektion=5&amp;format=html">autofs(5)</a> é montado em pontos de montagem especificados por <a href="https://man.freebsd.org/cgi/man.cgi?query=automount&amp;sektion=8&amp;format=html">automount(8)</a>, geralmente chamado durante a inicialização.</p></div><div class=paragraph><p>Sempre que um processo tentar acessar o arquivo dentro do ponto de montagem <a href="https://man.freebsd.org/cgi/man.cgi?query=autofs&amp;sektion=&amp;format=html">autofs()</a>, o kernel notificará o daemon <a href="https://man.freebsd.org/cgi/man.cgi?query=automountd&amp;sektion=8&amp;format=html">automountd(8)</a> e irá pausar o processo de disparo. O daemon <a href="https://man.freebsd.org/cgi/man.cgi?query=automountd&amp;sektion=8&amp;format=html">automountd(8)</a> processará as solicitações do kernel localizando o mapeamento apropriado e irá montar o sistema de arquivos de acordo com ele, então sinaliza ao kernel para liberar o processo bloqueado . O daemon <a href="https://man.freebsd.org/cgi/man.cgi?query=autounmountd&amp;sektion=8&amp;format=html">autounmountd(8)</a> desmonta automaticamente os sistemas de arquivos montados automaticamente após algum tempo, a menos que eles ainda estejam sendo usados.</p></div><div class=paragraph><p>O arquivo de configuração principal do autofs é o <span class=filename>/etc/auto_master</span>. Atribui mapeamentos individuais a montagens de nível superior. Para uma explicação do <span class=filename>auto_master</span> e da sintaxe do mapeamento, consulte <a href="https://man.freebsd.org/cgi/man.cgi?query=auto_master&amp;sektion=5&amp;format=html">auto_master(5)</a>.</p></div><div class=paragraph><p>Existe um mapeamento especial montado automaticamente em <span class=filename>/net</span>. Quando um arquivo é acessado dentro desse diretório, o <a href="https://man.freebsd.org/cgi/man.cgi?query=autofs&amp;sektion=5&amp;format=html">autofs(5)</a> procura a montagem remota correspondente e monta-a automaticamente. Por exemplo, uma tentativa de acessar um arquivo dentro de <span class=filename>/net/foobar/usr</span> informaria <a href="https://man.freebsd.org/cgi/man.cgi?query=automountd&amp;sektion=8&amp;format=html">automountd(8)</a> para montar a exportação <span class=filename>/usr</span> do host <code>foobar</code>.</p></div><div class=exampleblock><div class=title>Exemplo 2. Montando uma Exportação com <a href="https://man.freebsd.org/cgi/man.cgi?query=autofs&amp;sektion=5&amp;format=html">autofs(5)</a></div><div class=content><div class=paragraph><p>Neste exemplo, <code>showmount -e</code> mostra os sistemas de arquivos exportados que podem ser montados a partir do servidor NFS, <code>foobar</code>:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>% showmount <span class=nt>-e</span> foobar
Exports list on foobar:
/usr                               10.10.10.0
/a                                 10.10.10.0
% <span class=nb>cd</span> /net/foobar/usr</code></pre></div></div></div></div><div class=paragraph><p>A saída de <code>showmount</code> mostra <span class=filename>/usr</span> como uma exportação. Ao alterar os diretórios para <span class=filename>/host/foobar/usr</span>, o <a href="https://man.freebsd.org/cgi/man.cgi?query=automountd&amp;sektion=8&amp;format=html">automountd(8)</a> intercepta o pedido e tenta resolver o nome do host <code>foobar</code>. Se for bem-sucedido, <a href="https://man.freebsd.org/cgi/man.cgi?query=automountd&amp;sektion=8&amp;format=html">automountd(8)</a> montará automaticamente a exportação de origem.</p></div><div class=paragraph><p>Para habilitar <a href="https://man.freebsd.org/cgi/man.cgi?query=autofs&amp;sektion=5&amp;format=html">autofs(5)</a> no momento da inicialização, adicione esta linha ao arquivo <span class=filename>/etc/rc.conf</span>:</p></div><div class="literalblock programlisting"><div class=content><pre>autofs_enable=&#34;YES&#34;</pre></div></div><div class=paragraph><p>Em seguida, <a href="https://man.freebsd.org/cgi/man.cgi?query=autofs&amp;sektion=5&amp;format=html">autofs(5)</a> pode ser iniciado executando:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># service automount start</span>
<span class=c># service automountd start</span>
<span class=c># service autounmountd start</span></code></pre></div></div><div class=paragraph><p>O formato de mapeamento de <a href="https://man.freebsd.org/cgi/man.cgi?query=autofs&amp;sektion=5&amp;format=html">autofs(5)</a> é o mesmo que em outros sistemas operacionais. Informações sobre este formato de outras fontes podem ser úteis, como o <a href=http://web.archive.org/web/20160813071113/http://images.apple.com/business/docs/Autofs.pdf>documento do Mac OS X</a>.</p></div><div class=paragraph><p>Consulte as páginas de manuais <a href="https://man.freebsd.org/cgi/man.cgi?query=automount&amp;sektion=8&amp;format=html">automount(8)</a>, <a href="https://man.freebsd.org/cgi/man.cgi?query=automountd&amp;sektion=8&amp;format=html">automountd(8)</a>, <a href="https://man.freebsd.org/cgi/man.cgi?query=autounmountd&amp;sektion=8&amp;format=html">autounmountd(8)</a> e <a href="https://man.freebsd.org/cgi/man.cgi?query=auto_master&amp;sektion=5&amp;format=html">auto_master(5)</a> para maiores informações.</p></div></div></div></div><div class=sect1><h2 id=network-nis>29.4. Sistema de Informação de Rede (NIS)<a class=anchor href=#network-nis></a></h2><div class=sectionbody><div class=paragraph><p>O Network Information System (NIS) foi projetado para centralizar a administração de sistemas UNIX™ como Solaris™, HP-UX, AIX™, Linux, NetBSD, OpenBSD e FreeBSD. O NIS era originalmente conhecido como Yellow Pages, mas o nome foi alterado devido a problemas de marca registrada. Esta é a razão pela qual os comandos do NIS começam com <code>yp</code>.</p></div><div class=paragraph><p>O NIS é um sistema cliente/servidor baseado em Remote Procedure Call (RPC) que permite que um grupo de máquinas dentro de um domínio NIS compartilhe um conjunto de arquivos de configuração. Isso permite que um administrador do sistema configure sistemas clientes NIS com apenas dados mínimos de configuração e adicione, remova ou modifique dados de configuração de um único local.</p></div><div class=paragraph><p>O FreeBSD usa a versão 2 do protocolo NIS.</p></div><div class=sect2><h3 id=_termos_do_nis_e_processos>29.4.1. Termos do NIS e Processos<a class=anchor href=#_termos_do_nis_e_processos></a></h3><div class=paragraph><p>A Tabela 28.1 resume os termos e processos importantes usados pelo NIS:</p></div><table class="tableblock frame-none grid-all stretch"><caption class=title>Tabela 1. Terminologia do NIS</caption><col style=width:50%><col style=width:50%><thead><tr><th class="tableblock halign-left valign-top">Termo</th><th class="tableblock halign-left valign-top">Descrição</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class=tableblock>nome de domínio NIS</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Os servidores e clientes do NIS compartilham um nome de domínio NIS. Normalmente, esse nome não tem nada a ver com DNS.</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><a href="https://man.freebsd.org/cgi/man.cgi?query=rpcbind&amp;sektion=8&amp;format=html">rpcbind(8)</a></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Este serviço habilita o RPC e deve estar rodando para rodar um servidor NIS ou atuar como um cliente NIS.</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><a href="https://man.freebsd.org/cgi/man.cgi?query=ypbind&amp;sektion=8&amp;format=html">ypbind(8)</a></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Este serviço liga um cliente NIS ao seu servidor NIS. Ele levará o nome de domínio NIS e usará RPC para se conectar ao servidor. É o núcleo da comunicação cliente/servidor em um ambiente NIS. Se este serviço não estiver sendo executado em uma máquina cliente, ele não poderá acessar o servidor NIS.</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><a href="https://man.freebsd.org/cgi/man.cgi?query=ypserv&amp;sektion=8&amp;format=html">ypserv(8)</a></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Este é o processo para o servidor NIS. Se este serviço parar de funcionar, o servidor não poderá mais responder aos pedidos do NIS, portanto, esperamos que exista um servidor slave para assumir o controle. Alguns clientes não-FreeBSD não tentarão se reconectar usando um servidor slave e o processo ypbind pode precisar ser reiniciado nesses clientes.</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><a href="https://man.freebsd.org/cgi/man.cgi?query=rpc.yppasswdd&amp;sektion=8&amp;format=html">rpc.yppasswdd(8)</a></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Este processo só é executado em servidores principais de NIS. Este daemon permite que clientes NIS alterem suas senhas do NIS. Se este daemon não estiver rodando, os usuários terão que acessar o servidor principal do NIS e alterar suas senhas lá.</p></td></tr></tbody></table></div><div class=sect2><h3 id=_tipos_de_máquinas>29.4.2. Tipos de Máquinas<a class=anchor href=#_tipos_de_máquinas></a></h3><div class=paragraph><p>Existem três tipos de hosts em um ambiente NIS:</p></div><div class=ulist><ul><li><p>Servidor NIS master</p><div class=paragraph><p>Esse servidor atua como um repositório central para as informações de configuração do host e mantém a cópia autoritativa dos arquivos usados por todos os clientes do NIS. O <span class=filename>passwd</span>, o <span class=filename>group</span> e outros arquivos usados pelos clientes do NIS são armazenados no servidor master. Embora seja possível que uma máquina seja um servidor NIS master para mais de um domínio NIS, esse tipo de configuração não será abordado neste capítulo, pois pressupõe ambiente NIS de pequena escala.</p></div></li><li><p>Servidores NIS slave</p><div class=paragraph><p>Os servidores slaves do NIS mantêm cópias dos arquivos de dados do master do NIS para fornecer redundância. Os servidores slaves também ajudam a balancear a carga do servidor master, pois os clientes do NIS sempre se conectam ao servidor do NIS que responde primeiro.</p></div></li><li><p>Clientes NIS</p><div class=paragraph><p>Os clientes do NIS autenticam-se contra o servidor NIS durante o logon.</p></div></li></ul></div><div class=paragraph><p>Informações em muitos arquivos podem ser compartilhadas usando o NIS . Os arquivos <span class=filename>master.passwd</span>, <span class=filename>group</span> e <span class=filename>hosts</span> são comumente compartilhados via NIS. Sempre que um processo em um cliente precisa de informações que normalmente seriam encontradas nesses arquivos localmente, ele faz uma consulta ao servidor NIS ao qual está vinculado.</p></div></div><div class=sect2><h3 id=_considerações_de_planejamento>29.4.3. Considerações de Planejamento<a class=anchor href=#_considerações_de_planejamento></a></h3><div class=paragraph><p>Esta seção descreve um ambiente NIS de exemplo que consiste em 15 máquinas FreeBSD sem ponto de administração centralizado. Cada máquina tem seu próprio <span class=filename>/etc/passwd</span> e <span class=filename>/etc/master.passwd</span>. Esses arquivos são mantidos em sincronia entre si somente por meio de intervenção manual. Atualmente, quando um usuário é adicionado ao laboratório, o processo deve ser repetido em todas as 15 máquinas.</p></div><div class=paragraph><p>A configuração do laboratório será a seguinte:</p></div><table class="tableblock frame-none grid-all stretch informaltable"><col style=width:33.3333%><col style=width:33.3333%><col style=width:33.3334%><thead><tr><th class="tableblock halign-left valign-top">Nome da maquina</th><th class="tableblock halign-left valign-top">Endereço IP</th><th class="tableblock halign-left valign-top">Role da máquina</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>ellington</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock><code>10.0.0.2</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>NIS master</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>coltrane</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock><code>10.0.0.3</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>NIS slave</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>basie</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock><code>10.0.0.4</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Estação de Trabalho da Facultativa</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>bird</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock><code>10.0.0.5</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Máquina Cliente</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>cli[1-11]</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock><code>10.0.0.[6-17]</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Outras Máquinas Clientes</p></td></tr></tbody></table><div class=paragraph><p>Se esta é a primeira vez que um esquema de NIS está sendo desenvolvido, ele deve ser cuidadosamente planejado através do tempo. Independentemente do tamanho da rede, várias decisões precisam ser tomadas como parte do processo de planejamento.</p></div><div class=sect3><h4 id=_escolhendo_um_nome_de_domínio_nis>29.4.3.1. Escolhendo um Nome de Domínio NIS<a class=anchor href=#_escolhendo_um_nome_de_domínio_nis></a></h4><div class=paragraph><p>Quando um cliente transmite suas solicitações de informações, ele inclui o nome do domínio NIS do qual faz parte. É assim que vários servidores em uma rede podem informar qual servidor deve responder a qual solicitação. Pense no nome de domínio NIS como o nome de um grupo de hosts.</p></div><div class=paragraph><p>Algumas organizações optam por usar o nome de domínio da Internet para o nome de domínio NIS. Isso não é recomendado, pois pode causar confusão ao tentar depurar problemas de rede. O nome de domínio NIS deve ser único dentro da rede e é útil se ele descrever o grupo de máquinas que representa. Por exemplo, o departamento de Arte da Acme Inc. pode estar no domínio NIS"acme-art". Este exemplo usará o nome de domínio <code>test-domain</code>.</p></div><div class=paragraph><p>No entanto, alguns sistemas operacionais não-FreeBSD exigem que o nome de domínio NIS seja o mesmo que o nome de domínio da Internet. Se uma ou mais máquinas na rede tiverem essa restrição, o nome de domínio da Internet <em>deve</em> ser usado como o nome de domínio NIS.</p></div></div><div class=sect3><h4 id=_requisitos_físicos_do_servidor>29.4.3.2. Requisitos Físicos do Servidor<a class=anchor href=#_requisitos_físicos_do_servidor></a></h4><div class=paragraph><p>Há várias coisas que você deve ter em mente ao escolher uma máquina para usar como um servidor NIS. Como os clientes do NIS dependem da disponibilidade do servidor, escolha uma máquina que não seja reinicializada com freqüência. O servidor do NIS deve idealmente ser uma máquina autônoma cujo único propósito seja ser um servidor NIS. Se a rede não for muito usada, é aceitável colocar o servidor NIS em uma máquina que executa outros serviços. No entanto, se o servidor NIS ficar indisponível, isso afetará negativamente todos os clientes NIS.</p></div></div></div><div class=sect2><h3 id=_configurando_o_servidor_nis_master>29.4.4. Configurando o Servidor NIS Master<a class=anchor href=#_configurando_o_servidor_nis_master></a></h3><div class=paragraph><p>As cópias canônicas de todos os arquivos NIS são armazenadas no servidor master. Os bancos de dados usados para armazenar as informações são chamados de mapas de NIS. No FreeBSD, estes mapas são armazenados em <span class=filename>/var/yp/[nome_do_domínio]</span> onde <span class=filename>[nome_do_dominio]</span> é o nome do domínio NIS. Como vários domínios são suportados, é possível ter vários diretórios, um para cada domínio. Cada domínio terá seu próprio conjunto independente de mapas.</p></div><div class=paragraph><p>Os servidores master e slave do NIS lidam com todas as requisições NIS através do <a href="https://man.freebsd.org/cgi/man.cgi?query=ypserv&amp;sektion=8&amp;format=html">ypserv(8)</a>. Esse daemon é responsável por receber solicitações de entrada de clientes NIS, traduzindo o domínio e o nome do mapa solicitados para um caminho para o arquivo de banco de dados correspondente e transmitindo dados do banco de dados de volta ao cliente.</p></div><div class=paragraph><p>Configurar um servidor NIS master pode ser relativamente simples, dependendo das necessidades ambientais. Como o FreeBSD oferece suporte a NIS embutido, ele só precisa ser ativado adicionando as seguintes linhas ao arquivo <span class=filename>/etc/rc.conf</span>:</p></div><div class="literalblock programlisting"><div class=content><pre>nisdomainname=&#34;test-domain&#34;	<i class=conum data-value=1></i><b>(1)</b>
nis_server_enable=&#34;YES&#34;		<i class=conum data-value=2></i><b>(2)</b>
nis_yppasswdd_enable=&#34;YES&#34;	<i class=conum data-value=3></i><b>(3)</b></pre></div></div><div class="colist arabic"><table><tbody><tr><td><i class=conum data-value=1></i><b>1</b></td><td>Esta linha define o nome de domínio NIS para <code>test-domain</code>.</td></tr><tr><td><i class=conum data-value=2></i><b>2</b></td><td>Isto automatiza o início dos processos do servidor NIS quando o sistema é inicializado.</td></tr><tr><td><i class=conum data-value=3></i><b>3</b></td><td>Isso habilita o daemon <a href="https://man.freebsd.org/cgi/man.cgi?query=rpc.yppasswdd&amp;sektion=8&amp;format=html">rpc.yppasswdd(8)</a> para que os usuários possam alterar sua senha NIS de uma máquina cliente.</td></tr></tbody></table></div><div class=paragraph><p>É preciso ter cuidado em um domínio com vários servidores, no qual as máquinas do servidor também são clientes NIS. Geralmente, é uma boa ideia forçar os servidores a fazerem bind em si mesmos, em vez de permitir que eles transmitam solicitações de bind e, possivelmente, fiquem vinculados um ao outro. Modos de falha estranhos podem ocorrer se um servidor cair e outros dependerem dele. Eventualmente, todos os clientes terão tempo limite e tentarão fazer bind em outros servidores, mas o atraso envolvido poderá ser considerável e o modo de falha ainda estará presente, uma vez que os servidores podem ligar-se entre si novamente.</p></div><div class=paragraph><p>Um servidor que também é um cliente pode ser forçado fazer bind em um servidor em particular adicionando estas linhas adicionais ao arquivo <span class=filename>/etc/rc.conf</span>:</p></div><div class="literalblock programlisting"><div class=content><pre>nis_client_enable=&#34;YES&#34;				<i class=conum data-value=1></i><b>(1)</b>
nis_client_flags=&#34;-S test-domain,server&#34;	<i class=conum data-value=2></i><b>(2)</b></pre></div></div><div class="colist arabic"><table><tbody><tr><td><i class=conum data-value=1></i><b>1</b></td><td>Isso permite rodar coisas do cliente também.</td></tr><tr><td><i class=conum data-value=2></i><b>2</b></td><td>Esta linha define o nome de domínio NIS para test-domain e vincula para si mesmo.</td></tr></tbody></table></div><div class=paragraph><p>Depois de salvar as edições, digite <code>/etc/netstart</code> para reiniciar a rede e aplicar os valores definidos no arquivo <span class=filename>/etc/rc.conf</span>. Antes de inicializar os mapas de NIS, inicie <a href="https://man.freebsd.org/cgi/man.cgi?query=ypserv&amp;sektion=8&amp;format=html">ypserv(8)</a>:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># service ypserv start</span></code></pre></div></div><div class=sect3><h4 id=_inicializando_os_mapas_do_nis>29.4.4.1. Inicializando os mapas do NIS<a class=anchor href=#_inicializando_os_mapas_do_nis></a></h4><div class=paragraph><p>Os mapeamentos NIS são gerados a partir dos arquivos de configuração no diretório <span class=filename>/etc</span> no NIS master, com uma exceção: <span class=filename>/etc/master.passwd</span>. Isso evita a propagação de senhas para todos os servidores no domínio NIS. Portanto, antes de inicializar os mapas do NIS, configure os arquivos de senha primários:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># cp /etc/master.passwd /var/yp/master.passwd</span>
<span class=c># cd /var/yp</span>
<span class=c># vi master.passwd</span></code></pre></div></div><div class=paragraph><p>É aconselhável remover todas as entradas de contas do sistema, bem como quaisquer contas de usuário que não precisem ser propagadas para os clientes do NIS, como o <code>root</code> e quaisquer outras contas administrativas.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Assegure-se de que o arquivo <span class=filename>/var/yp/master.passwd</span> não seja de grupo nem de mundo legível, definindo suas permissões para <code>600</code>.</p></div></td></tr></tbody></table></div><div class=paragraph><p>Depois de concluir esta tarefa, inicialize os mapas do NIS. O FreeBSD inclui o script <a href="https://man.freebsd.org/cgi/man.cgi?query=ypinit&amp;sektion=8&amp;format=html">ypinit(8)</a> para fazer isso. Ao gerar mapas para o servidor master, inclua <code>-m</code> e especifique o nome de domínio NIS:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>ellington# ypinit <span class=nt>-m</span> test-domain
Server Type: MASTER Domain: test-domain
Creating an YP server will require that you answer a few questions.
Questions will all be asked at the beginning of the procedure.
Do you want this procedure to quit on non-fatal errors? <span class=o>[</span>y/n: n] n
Ok, please remember to go back and redo manually whatever fails.
If not, something might not work.
At this point, we have to construct a list of this domains YP servers.
rod.darktech.org is already known as master server.
Please <span class=k>continue </span>to add any slave servers, one per line. When you are
<span class=k>done </span>with the list, <span class=nb>type </span>a &lt;control D&gt;.
master server   :  ellington
next host to add:  coltrane
next host to add:  ^D
The current list of NIS servers looks like this:
ellington
coltrane
Is this correct?  <span class=o>[</span>y/n: y] y

<span class=o>[</span>..output from map generation..]

NIS Map update completed.
ellington has been setup as an YP master server without any errors.</code></pre></div></div><div class=paragraph><p>Isto irá criar <span class=filename>/var/yp/Makefile</span> a partir de <span class=filename>/var/yp/Makefile.dist</span>. Por padrão, este arquivo assume que o ambiente tem um único servidor NIS com apenas clientes FreeBSD. Como <code>test-domain</code> tem um servidor slave, edite esta linha no arquivo <span class=filename>/var/yp/Makefile</span> para que comece com um comentário (<code>#</code>) :</p></div><div class="literalblock programlisting"><div class=content><pre>NOPUSH = &#34;True&#34;</pre></div></div></div><div class=sect3><h4 id=_adicionando_novos_usuários>29.4.4.2. Adicionando novos usuários<a class=anchor href=#_adicionando_novos_usuários></a></h4><div class=paragraph><p>Toda vez que um novo usuário é criado, a conta de usuário deve ser adicionada ao servidor mestre NIS e aos mapeamentos do NIS reconstruídos. Até que isso ocorra, o novo usuário não poderá efetuar login em nenhum lugar, exceto no NIS master. Por exemplo, para adicionar o novo usuário <code>jsmith</code> ao domínio <code>test-domain</code>, execute estes comandos no servidor master:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># pw useradd jsmith</span>
<span class=c># cd /var/yp</span>
<span class=c># make test-domain</span></code></pre></div></div><div class=paragraph><p>O usuário também pode ser adicionado usando <code>adduser jsmith</code> em vez de <code>pw useradd smith</code>.</p></div></div></div><div class=sect2><h3 id=_configurando_um_servidor_nis_slave>29.4.5. Configurando um Servidor NIS Slave<a class=anchor href=#_configurando_um_servidor_nis_slave></a></h3><div class=paragraph><p>Para configurar um servidor NIS slave, faça o logon no servidor slave e edite o arquivo <span class=filename>/etc/rc.conf</span> assim como para o servidor master. Não gere nenhum mapa de NIS, pois estes já existem no servidor master. Ao executar <code>ypinit</code> no servidor slave, use <code>-s</code> (para slave) ao invés de <code>-m</code> (para master). Esta opção requer o nome do NIS master, além do nome do domínio, como visto neste exemplo:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>coltrane# ypinit <span class=nt>-s</span> ellington test-domain

Server Type: SLAVE Domain: test-domain Master: ellington

Creating an YP server will require that you answer a few questions.
Questions will all be asked at the beginning of the procedure.

Do you want this procedure to quit on non-fatal errors? <span class=o>[</span>y/n: n]  n

Ok, please remember to go back and redo manually whatever fails.
If not, something might not work.
There will be no further questions. The remainder of the procedure
should take a few minutes, to copy the databases from ellington.
Transferring netgroup...
ypxfr: Exiting: Map successfully transferred
Transferring netgroup.byuser...
ypxfr: Exiting: Map successfully transferred
Transferring netgroup.byhost...
ypxfr: Exiting: Map successfully transferred
Transferring master.passwd.byuid...
ypxfr: Exiting: Map successfully transferred
Transferring passwd.byuid...
ypxfr: Exiting: Map successfully transferred
Transferring passwd.byname...
ypxfr: Exiting: Map successfully transferred
Transferring group.bygid...
ypxfr: Exiting: Map successfully transferred
Transferring group.byname...
ypxfr: Exiting: Map successfully transferred
Transferring services.byname...
ypxfr: Exiting: Map successfully transferred
Transferring rpc.bynumber...
ypxfr: Exiting: Map successfully transferred
Transferring rpc.byname...
ypxfr: Exiting: Map successfully transferred
Transferring protocols.byname...
ypxfr: Exiting: Map successfully transferred
Transferring master.passwd.byname...
ypxfr: Exiting: Map successfully transferred
Transferring networks.byname...
ypxfr: Exiting: Map successfully transferred
Transferring networks.byaddr...
ypxfr: Exiting: Map successfully transferred
Transferring netid.byname...
ypxfr: Exiting: Map successfully transferred
Transferring hosts.byaddr...
ypxfr: Exiting: Map successfully transferred
Transferring protocols.bynumber...
ypxfr: Exiting: Map successfully transferred
Transferring ypservers...
ypxfr: Exiting: Map successfully transferred
Transferring hosts.byname...
ypxfr: Exiting: Map successfully transferred

coltrane has been setup as an YP slave server without any errors.
Remember to update map ypservers on ellington.</code></pre></div></div><div class=paragraph><p>Isto irá gerar um diretório no servidor slave chamado <span class=filename>/var/yp/test-domain</span> que contém cópias dos mapas do servidor principal do NIS. Adicionar estas entradas ao arquivo <span class=filename>/etc/crontab</span> em cada servidor slave forçará os slaves a sincronizar seus mapas com os mapas no servidor master:</p></div><div class="literalblock programlisting"><div class=content><pre>20      *       *       *       *       root   /usr/libexec/ypxfr passwd.byname
21      *       *       *       *       root   /usr/libexec/ypxfr passwd.byuid</pre></div></div><div class=paragraph><p>Essas entradas não são obrigatórias porque o servidor master tenta enviar automaticamente quaisquer alterações no mapa para seus escravos. No entanto, como os clientes podem depender do servidor escravo para fornecer informações corretas de senha, recomenda-se forçar atualizações frequentes de mapas de senha. Isso é especialmente importante em redes ocupadas nas quais as atualizações de mapas nem sempre são concluídas.</p></div><div class=paragraph><p>Para finalizar a configuração, execute <code>/etc/netstart</code> no servidor slave para iniciar os serviços do NIS.</p></div></div><div class=sect2><h3 id=_configurando_um_cliente_nis>29.4.6. Configurando um cliente NIS<a class=anchor href=#_configurando_um_cliente_nis></a></h3><div class=paragraph><p>Um cliente NIS é vinculado a um servidor NIS usando <a href="https://man.freebsd.org/cgi/man.cgi?query=ypbind&amp;sektion=8&amp;format=html">ypbind(8)</a>. Esse daemon transmite solicitações de RPC na rede local. Essas solicitações especificam o nome do domínio configurado no cliente. Se um servidor NIS no mesmo domínio receber uma das transmissões, ele responderá a ypbind, que registrará o endereço do servidor. Se houver vários servidores disponíveis, o cliente usará o endereço do primeiro servidor para responder e direcionará todas as suas solicitações de NIS para esse servidor. O cliente irá automaticamente pingar o servidor regularmente para garantir que ainda esteja disponível. Se ele não receber uma resposta dentro de um período de tempo razoável, o ypbind marcará o domínio como não acoplado e começará a transmitir novamente na esperança de localizar outro servidor.</p></div><div class=paragraph><p>Para configurar uma máquina FreeBSD para ser um cliente NIS:</p></div><div class="exampleblock procedure"><div class=content><div class="olist arabic"><ol class=arabic><li><p>Edite o <span class=filename>/etc/rc.conf</span> e adicione as seguintes linhas para definir o nome de domínio NIS e inicie <a href="https://man.freebsd.org/cgi/man.cgi?query=ypbind&amp;sektion=8&amp;format=html">ypbind(8)</a> durante a inicialização da rede:</p><div class="literalblock programlisting"><div class=content><pre>nisdomainname=&#34;test-domain&#34;
nis_client_enable=&#34;YES&#34;</pre></div></div></li><li><p>Para importar todas as possíveis entradas de senha do servidor NIS, use <code>vipw</code> para remover todas as contas de usuário, exceto uma do arquivo <span class=filename>/etc/master.passwd</span>. Ao remover as contas, lembre-se de que pelo menos uma conta local deve permanecer e essa conta deve ser membro do grupo <code>wheel</code>. Se houver um problema com o NIS, essa conta local poderá ser usada para efetuar login remotamente, tornar-se o superusuário e corrigir o problema. Antes de salvar as edições, adicione a seguinte linha ao final do arquivo:</p><div class="literalblock programlisting"><div class=content><pre>+:::::::::</pre></div></div><div class=paragraph><p>Esta linha configura o cliente para fornecer qualquer pessoa com uma conta válida na senha do servidor do NIS mapeia uma conta no cliente. Existem várias maneiras de configurar o cliente NIS modificando essa linha. Um método é descrito em <a href=#network-netgroups>Usando Netgroups</a>. Para uma leitura mais detalhada, consulte o livro <code>Managing NFS and NIS</code>, publicado pela O’Reilly Media.</p></div></li><li><p>Para importar todas as entradas de grupo possíveis do servidor NIS, adicione esta linha ao <span class=filename>/etc/group</span>:</p><div class="literalblock programlisting"><div class=content><pre>+:*::</pre></div></div></li></ol></div></div></div><div class=paragraph><p>Para iniciar imediatamente o cliente NIS, execute os seguintes comandos como superusuário:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># /etc/netstart</span>
<span class=c># service ypbind start</span></code></pre></div></div><div class=paragraph><p>Depois de concluir estas etapas, a execução do <code>ypcat passwd</code> no cliente deve mostrar o mapa <span class=filename>passwd</span> do servidor.</p></div></div><div class=sect2><h3 id=_segurança_nis>29.4.7. Segurança NIS<a class=anchor href=#_segurança_nis></a></h3><div class=paragraph><p>Como o RPC é um serviço baseado em broadcast, qualquer sistema executando o ypbind dentro do mesmo domínio pode recuperar o conteúdo dos mapas do NIS. Para evitar transações não autorizadas, <a href="https://man.freebsd.org/cgi/man.cgi?query=ypserv&amp;sektion=8&amp;format=html">ypserv(8)</a> suporta um recurso chamado "securenets" que pode ser usado para restringir o acesso a um dado conjunto de hosts. Por padrão, essas informações são armazenadas no arquivo <span class=filename>/var/yp/securenets</span>, a menos que <a href="https://man.freebsd.org/cgi/man.cgi?query=ypserv&amp;sektion=8&amp;format=html">ypserv(8)</a> seja iniciado com <code>-p</code> e um caminho alternativo. Este arquivo contém entradas que consistem em uma especificação de rede e uma máscara de rede separadas por espaço em branco. Linhas iniciando com <code>#</code> são consideradas comentários. Um exemplo de <span class=filename>securenets</span> pode ser assim:</p></div><div class="literalblock programlisting"><div class=content><pre># allow connections from local host -- mandatory
127.0.0.1     255.255.255.255
# allow connections from any host
# on the 192.168.128.0 network
192.168.128.0 255.255.255.0
# allow connections from any host
# between 10.0.0.0 to 10.0.15.255
# this includes the machines in the testlab
10.0.0.0      255.255.240.0</pre></div></div><div class=paragraph><p>Se <a href="https://man.freebsd.org/cgi/man.cgi?query=ypserv&amp;sektion=8&amp;format=html">ypserv(8)</a> receber uma solicitação de um endereço que corresponda a uma dessas regras, ela processará a solicitação normalmente. Se o endereço não corresponder a uma regra, a solicitação será ignorada e uma mensagem de aviso será registrada. Se o <span class=filename>securenets</span> não existir, o <code>ypserv</code> permitirá conexões de qualquer host.</p></div><div class=paragraph><p><a href=../security/#tcpwrappers>TCP Wrapper</a> é um mecanismo alternativo para fornecer controle de acesso em vez de <span class=filename>securenets</span>. Embora o mecanismo de controle de acesso acrescente alguma segurança, ambos são vulneráveis a ataques como "IP spoofing". Todo o tráfego relacionado a NIS deve ser bloqueado no firewall.</p></div><div class=paragraph><p>Servidores que usam <span class=filename>securenets</span> podem não servir clientes legítimos de NIS com implementações arcaicas de TCP/IP. Algumas dessas implementações definem todos os bits do host como zero ao fazer transmissões ou não observam a máscara de sub-rede ao calcular o endereço de transmissão. Embora alguns desses problemas possam ser corrigidos alterando a configuração do cliente, outros problemas podem forçar a desativação desses sistemas clientes ou o abandono do <span class=filename>securenets</span>.</p></div><div class=paragraph><p>O uso de TCP Wrapper aumenta a latência do servidor NIS. O atraso adicional pode ser longo o suficiente para causar timeouts em programas clientes, especialmente em redes ocupadas com servidores NIS lentos. Se um ou mais clientes sofrerem de latência, converta esses clientes em servidores de NIS slaves e force-os a se ligarem a eles mesmos.</p></div><div class=sect3><h4 id=_barrando_alguns_usuários>29.4.7.1. Barrando alguns usuários<a class=anchor href=#_barrando_alguns_usuários></a></h4><div class=paragraph><p>Neste exemplo, o sistema <code>basie</code> é uma estação de trabalho da dentro do domínio NIS facultativo. O mapa <span class=filename>passwd</span> no servidor NIS master contém contas para professores e alunos. Esta seção demonstra como permitir o login do corpo docente neste sistema e, ao mesmo tempo, recusar logins de alunos.</p></div><div class=paragraph><p>Para previnir usuários específicos de logar em um sistema, desde que eles estejam presentes no banco de dados do NIS, use <code>vipw</code> para adicionar <code>-<em>username</em></code> com o numero correto de virgulas em direção ao fim do arquivo <span class=filename>/etc/master.passwd</span> no cliente, onde <em>username</em> é o nome de usuário a impedir de logar. A linha com o usuário bloqueado deve estar antes da linha <code>+</code> que permite usuários do NIS. Neste exemplo, <code>bill</code> está impedido de logar no <code>basie</code>:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>basie# <span class=nb>cat</span> /etc/master.passwd
root:[password]:0:0::0:0:The super-user:/root:/bin/csh
toor:[password]:0:0::0:0:The other super-user:/root:/bin/sh
daemon:<span class=k>*</span>:1:1::0:0:Owner of many system processes:/root:/usr/sbin/nologin
operator:<span class=k>*</span>:2:5::0:0:System &amp;:/:/usr/sbin/nologin
bin:<span class=k>*</span>:3:7::0:0:Binaries Commands and Source,,,:/:/usr/sbin/nologin
<span class=nb>tty</span>:<span class=k>*</span>:4:65533::0:0:Tty Sandbox:/:/usr/sbin/nologin
kmem:<span class=k>*</span>:5:65533::0:0:KMem Sandbox:/:/usr/sbin/nologin
games:<span class=k>*</span>:7:13::0:0:Games pseudo-user:/usr/games:/usr/sbin/nologin
news:<span class=k>*</span>:8:8::0:0:News Subsystem:/:/usr/sbin/nologin
man:<span class=k>*</span>:9:9::0:0:Mister Man Pages:/usr/shared/man:/usr/sbin/nologin
<span class=nb>bind</span>:<span class=k>*</span>:53:53::0:0:Bind Sandbox:/:/usr/sbin/nologin
uucp:<span class=k>*</span>:66:66::0:0:UUCP pseudo-user:/var/spool/uucppublic:/usr/libexec/uucp/uucico
xten:<span class=k>*</span>:67:67::0:0:X-10 daemon:/usr/local/xten:/usr/sbin/nologin
pop:<span class=k>*</span>:68:6::0:0:Post Office Owner:/nonexistent:/usr/sbin/nologin
nobody:<span class=k>*</span>:65534:65534::0:0:Unprivileged user:/nonexistent:/usr/sbin/nologin
<span class=nt>-bill</span>:::::::::
+:::::::::

basie#</code></pre></div></div></div></div><div class=sect2><h3 id=network-netgroups>29.4.8. Usando Netgroups<a class=anchor href=#network-netgroups></a></h3><div class=paragraph><p>A exclusão de usuários especificados do logon em sistemas individuais torna-se imprestável em redes maiores e perde rapidamente o principal benefício do NIS: administração <em>centralizada</em>.</p></div><div class=paragraph><p>Os netgroups foram desenvolvidos para lidar com redes grandes e complexas com centenas de usuários e máquinas. Seu uso é comparável aos grupos UNIX™, onde a principal diferença é a falta de um ID numérico e a capacidade de definir um netgroup incluindo contas de usuário e outros netgroups.</p></div><div class=paragraph><p>Para expandir o exemplo usado neste capítulo, o domínio NIS será estendido para adicionar os usuários e sistemas mostrados nas Tabelas 28.2 e 28.3:</p></div><table class="tableblock frame-none grid-all stretch"><caption class=title>Tabela 2. Usuários Adicionais</caption><col style=width:50%><col style=width:50%><thead><tr><th class="tableblock halign-left valign-top">Nome(s) de usuário</th><th class="tableblock halign-left valign-top">Descrição</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>alpha</code>, <code>beta</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Funcionários do departamento de TI</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>charlie</code>, <code>delta</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Aprendizes do departamento de TI</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>echo</code>, <code>foxtrott</code>, <code>golf</code>, …​</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>funcionários</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>able</code>, <code>baker</code>, …​</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>estagiários</p></td></tr></tbody></table><table class="tableblock frame-none grid-all stretch"><caption class=title>Tabela 3. Sistemas Adicionais</caption><col style=width:50%><col style=width:50%><thead><tr><th class="tableblock halign-left valign-top">Nome(s) de máquina</th><th class="tableblock halign-left valign-top">Descrição</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>war</code>, <code>death</code>, <code>famine</code>, <code>pollution</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Somente funcionários de TI podem fazer logon nesses servidores.</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>pride</code>, <code>greed</code>, <code>envy</code>, <code>wrath</code>, <code>lust</code>, <code>sloth</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Todos os membros do departamento de TI podem fazer login nesses servidores.</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>one</code>, <code>two</code>, <code>three</code>, <code>four</code>, …​</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Estações de trabalho comuns usadas pelos funcionários.</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>trashcan</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Uma máquina muito antiga sem dados críticos. Até os estagiários podem usar este sistema.</p></td></tr></tbody></table><div class=paragraph><p>Ao usar netgroups para configurar esse cenário, cada usuário é atribuído a um ou mais netgroups e os logins são permitidos ou proibidos para todos os membros do netgroup. Ao adicionar uma nova máquina, as restrições de login devem ser definidas para todos os netgroups. Quando um novo usuário é adicionado, a conta deve ser adicionada a um ou mais netgroups. Se a configuração do NIS for planejada com cuidado, somente um arquivo de configuração central precisará ser modificado para conceder ou negar acesso a máquinas.</p></div><div class=paragraph><p>O primeiro passo é a inicialização do mapa do NIS <code>netgroup</code>. No FreeBSD, este mapa não é criado por padrão. No servidor NIS master, use um editor para criar um mapa chamado <span class=filename>/var/yp/netgroup</span>.</p></div><div class=paragraph><p>Este exemplo cria quatro grupos de rede para representar funcionários de TI, aprendizes de TI, funcionários e estagiários:</p></div><div class="literalblock programlisting"><div class=content><pre>IT_EMP  (,alpha,test-domain)    (,beta,test-domain)
IT_APP  (,charlie,test-domain)  (,delta,test-domain)
USERS   (,echo,test-domain)     (,foxtrott,test-domain) \
        (,golf,test-domain)
INTERNS (,able,test-domain)     (,baker,test-domain)</pre></div></div><div class=paragraph><p>Cada entrada configura um netgroup. A primeira coluna em uma entrada é o nome do netgroup. Cada conjunto de colchetes representa um grupo de um ou mais usuários ou o nome de outro grupo de rede. Ao especificar um usuário, os três campos delimitados por vírgula dentro de cada grupo representam:</p></div><div class="olist arabic"><ol class=arabic><li><p>O nome do(s) host(s) onde os outros campos que representam o usuário são válidos. Se um nome de host não for especificado, a entrada será válida em todos os hosts.</p></li><li><p>O nome da conta que pertence a este netgroup.</p></li><li><p>O domínio NIS da conta. As contas podem ser importadas de outros domínios do NIS para um netgroup.</p></li></ol></div><div class=paragraph><p>Se um grupo contiver vários usuários, separe cada usuário com espaço em branco. Além disso, cada campo pode conter curingas. Veja <a href="https://man.freebsd.org/cgi/man.cgi?query=netgroup&amp;sektion=5&amp;format=html">netgroup(5)</a> para detalhes.</p></div><div class=paragraph><p>Nomes de grupos maiores que 8 caracteres não devem ser usados. Os nomes diferenciam maiúsculas de minúsculas e usar letras maiúsculas para nomes de grupos de rede é uma maneira fácil de distinguir entre nomes de usuários, máquinas e grupos de rede.</p></div><div class=paragraph><p>Alguns clientes não-FreeBSD NIS não podem lidar com netgroups contendo mais de 15 entradas. Esse limite pode ser contornado criando vários grupos de sub-redes com 15 usuários ou menos e um grupo de rede real consistindo dos grupos de sub-redes, como visto neste exemplo:</p></div><div class="literalblock programlisting"><div class=content><pre>BIGGRP1  (,joe1,domain)  (,joe2,domain)  (,joe3,domain) [...]
BIGGRP2  (,joe16,domain)  (,joe17,domain) [...]
BIGGRP3  (,joe31,domain)  (,joe32,domain)
BIGGROUP  BIGGRP1 BIGGRP2 BIGGRP3</pre></div></div><div class=paragraph><p>Repita este processo se mais de 225 (15 vezes 15) usuários existirem dentro de um único netgroup.</p></div><div class=paragraph><p>Para ativar e distribuir o novo mapa do NIS:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>ellington# <span class=nb>cd</span> /var/yp
ellington# make</code></pre></div></div><div class=paragraph><p>Isso gerará os três mapas NIS, <span class=filename>netgroup</span>, <span class=filename>netgroup.byhost</span> e <span class=filename>netgroup.byuser</span>. Use a opção de chave de mapa <a href="https://man.freebsd.org/cgi/man.cgi?query=ypcat&amp;sektion=1&amp;format=html">ypcat(1)</a> para verificar se os novos mapas de NIS estão disponíveis:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>ellington% ypcat <span class=nt>-k</span> netgroup
ellington% ypcat <span class=nt>-k</span> netgroup.byhost
ellington% ypcat <span class=nt>-k</span> netgroup.byuser</code></pre></div></div><div class=paragraph><p>A saída do primeiro comando deve lembrar o conteúdo de <span class=filename>/var/yp/netgroup</span>. O segundo comando só produz saída se os netgroups específicos do host foram criados. O terceiro comando é usado para obter a lista de netgroups de um usuário.</p></div><div class=paragraph><p>Para configurar um cliente, use <a href="https://man.freebsd.org/cgi/man.cgi?query=vipw&amp;sektion=8&amp;format=html">vipw(8)</a> para especificar o nome do netgroup. Por exemplo, no servidor chamado <code>war</code>, substitua esta linha:</p></div><div class="literalblock programlisting"><div class=content><pre>+:::::::::</pre></div></div><div class=paragraph><p>com</p></div><div class="literalblock programlisting"><div class=content><pre>+@IT_EMP:::::::::</pre></div></div><div class=paragraph><p>Isso especifica que apenas os usuários definidos no netgroup <code>IT_EMP</code> serão importados para o banco de dados de senhas deste sistema e somente esses usuários terão permissão para efetuar login nesse sistema.</p></div><div class=paragraph><p>Essa configuração também se aplica à função <code>~</code> do shell e a todas as rotinas que convertem entre nomes de usuário e IDs de usuário numérico. Em outras palavras, <code>cd ~<em>user</em></code> não funcionará, <code>ls -l</code> mostrará o ID numérico em vez do nome de usuário e <code>find . -user joe -print</code> falhará com a mensagem <code>No such user</code>. Para corrigir isso, importe todas as entradas do usuário sem permitir que elas efetuem login nos servidores. Isto pode ser conseguido adicionando uma linha extra:</p></div><div class="literalblock programlisting"><div class=content><pre>+:::::::::/usr/sbin/nologin</pre></div></div><div class=paragraph><p>Esta linha configura o cliente para importar todas as entradas, mas para substituir o shell nessas entradas com <span class=filename>/usr/sbin/nologin</span>.</p></div><div class=paragraph><p>Certifique-se que a linha extra é colocada <em>após</em> <code>+@IT_EMP:::::::::</code>. Caso contrário, todas as contas de usuário importadas do NIS terão <span class=filename>/usr/sbin/nologin</span> como seu shell de login e ninguém poderá efetuar o login no sistema.</p></div><div class=paragraph><p>Para configurar os servidores menos importantes, substitua o antigo <code>+:::::::::</code> nos servidores com estas linhas:</p></div><div class="literalblock programlisting"><div class=content><pre>+@IT_EMP:::::::::
+@IT_APP:::::::::
+:::::::::/usr/sbin/nologin</pre></div></div><div class=paragraph><p>As linhas correspondentes para as estações de trabalho seriam:</p></div><div class="literalblock programlisting"><div class=content><pre>+@IT_EMP:::::::::
+@USERS:::::::::
+:::::::::/usr/sbin/nologin</pre></div></div><div class=paragraph><p>O NIS suporta a criação de grupos de rede de outros grupos de rede, o que pode ser útil se a política relacionada ao acesso do usuário for alterada. Uma possibilidade é a criação de netgroups baseados em funções. Por exemplo, pode-se criar um netgroup chamado <code>BIGSRV</code> para definir as restrições de login para os servidores importantes, outro grupo de rede chamado <code>SMALLSRV</code> para os servidores menos importantes e um terceiro netgroup chamado <code>USERBOX</code> para as estações de trabalho. Cada um desses netgroups contém os netgroups com permissão para efetuar login nessas máquinas. As novas entradas para o mapa do NIS <code>netgroup</code> seriam assim:</p></div><div class="literalblock programlisting"><div class=content><pre>BIGSRV    IT_EMP  IT_APP
SMALLSRV  IT_EMP  IT_APP  ITINTERN
USERBOX   IT_EMP  ITINTERN USERS</pre></div></div><div class=paragraph><p>Esse método de definir restrições de login funciona razoavelmente bem quando é possível definir grupos de máquinas com restrições idênticas. Infelizmente, esta é a exceção e não a regra. Na maioria das vezes, é necessária a capacidade de definir restrições de login por máquina.</p></div><div class=paragraph><p>As definições de netgroup específicas da máquina são outra possibilidade para lidar com as mudanças na política. Neste cenário, o <span class=filename>/etc/master.passwd</span> de cada sistema contém duas linhas que começam com "+". A primeira linha adiciona um netgroup com as contas permitidas para entrar nesta máquina e a segunda linha adiciona todas as outras contas com <span class=filename>/usr/sbin/nologin</span> como shell. Recomenda-se usar a versão "ALL-CAPS" do nome do host como o nome do netgroup:</p></div><div class="literalblock programlisting"><div class=content><pre>+@BOXNAME:::::::::
+:::::::::/usr/sbin/nologin</pre></div></div><div class=paragraph><p>Quando esta tarefa estiver completa em todas as máquinas, não haverá mais a necessidade de modificar as versões locais de <span class=filename>/etc/master.passwd</span> novamente. Todas as alterações posteriores podem ser manipuladas, modificando o mapa do NIS. Aqui está um exemplo de um possível mapa <code>netgroup</code> para este cenário:</p></div><div class="literalblock programlisting"><div class=content><pre># Define groups of users first
IT_EMP    (,alpha,test-domain)    (,beta,test-domain)
IT_APP    (,charlie,test-domain)  (,delta,test-domain)
DEPT1     (,echo,test-domain)     (,foxtrott,test-domain)
DEPT2     (,golf,test-domain)     (,hotel,test-domain)
DEPT3     (,india,test-domain)    (,juliet,test-domain)
ITINTERN  (,kilo,test-domain)     (,lima,test-domain)
D_INTERNS (,able,test-domain)     (,baker,test-domain)
#
# Now, define some groups based on roles
USERS     DEPT1   DEPT2     DEPT3
BIGSRV    IT_EMP  IT_APP
SMALLSRV  IT_EMP  IT_APP    ITINTERN
USERBOX   IT_EMP  ITINTERN  USERS
#
# And a groups for a special tasks
# Allow echo and golf to access our anti-virus-machine
SECURITY  IT_EMP  (,echo,test-domain)  (,golf,test-domain)
#
# machine-based netgroups
# Our main servers
WAR       BIGSRV
FAMINE    BIGSRV
# User india needs access to this server
POLLUTION  BIGSRV  (,india,test-domain)
#
# This one is really important and needs more access restrictions
DEATH     IT_EMP
#
# The anti-virus-machine mentioned above
ONE       SECURITY
#
# Restrict a machine to a single user
TWO       (,hotel,test-domain)
# [...more groups to follow]</pre></div></div><div class=paragraph><p>Pode não ser sempre aconselhável usar netgroups baseados em máquina. Ao implantar algumas dúzias ou centenas de sistemas, grupos de rede baseados em funções em vez de grupos de rede baseados em máquina podem ser usados para manter o tamanho do mapa do NIS dentro de limites razoáveis.</p></div></div><div class=sect2><h3 id=_formatos_de_senha>29.4.9. Formatos de Senha<a class=anchor href=#_formatos_de_senha></a></h3><div class=paragraph><p>O NIS requer que todos os hosts em um domínio NIS usem o mesmo formato para criptografar senhas. Se os usuários tiverem problemas para autenticar em um cliente NIS, pode ser devido a um formato de senha diferente. Em uma rede heterogênea, o formato deve ser suportado por todos os sistemas operacionais, onde DES é o padrão comum mais baixo.</p></div><div class=paragraph><p>Para verificar qual formato um servidor ou cliente está usando, veja esta seção do <span class=filename>/etc/login.conf</span>:</p></div><div class="literalblock programlisting"><div class=content><pre>default:\
	:passwd_format=des:\
	:copyright=/etc/COPYRIGHT:\
	[Further entries elided]</pre></div></div><div class=paragraph><p>Neste exemplo, o sistema está usando o formato DES. Outros valores possíveis são <code>blf</code> para Blowfish e <code>md5</code> para senhas criptografadas com MD5.</p></div><div class=paragraph><p>Se o formato em um host precisar ser editado para corresponder ao que está sendo usado no domínio NIS, o banco de dados de recursos de login deve ser reconstruído após salvar a alteração:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># cap_mkdb /etc/login.conf</span></code></pre></div></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>O formato das senhas das contas de usuários existentes não será atualizado até que cada usuário mude sua senha <em>após</em> o banco de dados de recursos de login ser reconstruído.</p></div></td></tr></tbody></table></div></div></div></div><div class=sect1><h2 id=network-ldap>29.5. Protocolo leve de acesso de diretório ( LDAP )<a class=anchor href=#network-ldap></a></h2><div class=sectionbody><div class=paragraph><p>O protocolo LDAP (LDAP) é um protocolo da camada de aplicação usado para acessar, modificar e autenticar objetos usando um serviço de informações de diretório distribuído. Pense nisso como um telefone ou livro de registro que armazena vários níveis de informações hierárquicas e homogêneas. Ele é usado nas redes do Active Directory e do OpenLDAP e permite que os usuários acessem vários níveis de informações internas utilizando uma única conta. Por exemplo, a autenticação de email, a obtenção de informações de contato dos funcionários e a autenticação interna de sites podem usar uma única conta de usuário na base de registros do servidor LDAP.</p></div><div class=paragraph><p>Esta seção fornece um guia de início rápido para configurar um servidor LDAP em um sistema FreeBSD. Ele pressupõe que o administrador já tenha um plano de design que inclua o tipo de informação a ser armazenada, para que essas informações sejam usadas, quais usuários devem ter acesso a essas informações e como proteger essas informações contra acesso não autorizado.</p></div><div class=sect2><h3 id=_terminologia_e_estrutura_do_ldap>29.5.1. Terminologia e Estrutura do LDAP<a class=anchor href=#_terminologia_e_estrutura_do_ldap></a></h3><div class=paragraph><p>O LDAP usa vários termos que devem ser entendidos antes de iniciar a configuração. Todas as entradas de diretório consistem em um grupo de <em>attributes</em>. Cada um desses conjuntos de atributos contém um identificador exclusivo conhecido como <em>Distinguished Name</em> (DN) que é normalmente criado a partir de vários outros atributos, como Common ou <em>Relative Distinguished Name</em> (RDN). Semelhante a como os diretórios têm caminhos absolutos e relativos, considere um DN como um caminho absoluto e o RDN como o caminho relativo.</p></div><div class=paragraph><p>Um exemplo de entrada LDAP é semelhante ao seguinte. Este exemplo procura a entrada para a conta de usuário especificada (<code>uid</code>), unidade organizacional (<code>ou</code>) e organização (<code>o</code>):</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>% ldapsearch <span class=nt>-xb</span> <span class=s2>&#34;uid=trhodes,ou=users,o=example.com&#34;</span>
<span class=c># extended LDIF</span>
<span class=c>#</span>
<span class=c># LDAPv3</span>
<span class=c># base &lt;uid=trhodes,ou=users,o=example.com&gt; with scope subtree</span>
<span class=c># filter: (objectclass=*)</span>
<span class=c># requesting: ALL</span>
<span class=c>#</span>

<span class=c># trhodes, users, example.com</span>
dn: <span class=nv>uid</span><span class=o>=</span>trhodes,ou<span class=o>=</span><span class=nb>users</span>,o<span class=o>=</span>example.com
mail: trhodes@example.com
cn: Tom Rhodes
uid: trhodes
telephoneNumber: <span class=o>(</span>123<span class=o>)</span> 456-7890

<span class=c># search result</span>
search: 2
result: 0 Success

<span class=c># numResponses: 2</span>
<span class=c># numEntries: 1</span></code></pre></div></div><div class=paragraph><p>Esta entrada de exemplo mostra os valores para os atributos <code>dn</code>, <code>mail</code>, <code>cn</code>, <code>uid</code> e <code>telephoneNumber</code>. O atributo do cn é o RDN.</p></div><div class=paragraph><p>Maiores informações sobre o LDAP e sua terminologia podem ser encontradas em <a href=http://www.openldap.org/doc/admin24/intro.html>http://www.openldap.org/doc/admin24/intro.html</a>.</p></div></div><div class=sect2><h3 id=ldap-config>29.5.2. Configurando um servidor LDAP<a class=anchor href=#ldap-config></a></h3><div class=paragraph><p>O FreeBSD não provê um servidor LDAP embutido. Comece a configuração instalando o pacote ou port <a class=package href=https://cgit.freebsd.org/ports/tree/net/openldap-server/>net/openldap-server</a>:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># pkg install openldap-server</span></code></pre></div></div><div class=paragraph><p>Aqui está um largo conjunto de opções habilitadas no <a href=https://docs.freebsd.org/pt-br/articles/linux-users/#software>pacote</a>. Reveja-os rodando o comando <code>pkg info openldap-server</code>. Se não for suficiente (por exemplo se o suporte a SQL for necessário), por favor considere recompilar o port usando o framework <a href=../ports/#ports-using>apropriado</a>.</p></div><div class=paragraph><p>A instalação cria o diretório <span class=filename>/var/db/openldap-data</span> para conter os dados. O diretório para armazenar os certificados deve ser criado:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># mkdir /usr/local/etc/openldap/private</span></code></pre></div></div><div class=paragraph><p>A próxima fase é configurar a autoridade de certificação. Os seguintes comandos devem ser executados em <span class=filename>/usr/local/etc/openldap/private</span>. Isso é importante, pois as permissões de arquivo precisam ser restritivas e os usuários não devem ter acesso a esses arquivos. Informações mais detalhadas sobre certificados e seus parâmetros podem ser encontradas em <a href=../security/#openssl>OpenSSL</a>. Para criar a Autoridade de Certificação, comece com este comando e siga os prompts:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># openssl req -days 365 -nodes -new -x509 -keyout ca.key -out ../ca.crt</span></code></pre></div></div><div class=paragraph><p>As entradas para os prompts podem ser genéricas <em>exceto</em> para o <code>Common Name</code>. Esta entrada deve ser <em>diferente</em> do nome do host do sistema. Se este será um certificado auto-assinado, prefixe o nome do host com <code>CA</code> para a Autoridade de Certificação.</p></div><div class=paragraph><p>A próxima tarefa é criar uma solicitação de assinatura de certificado e uma chave privada. Insira este comando e siga os prompts:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># openssl req -days 365 -nodes -new -keyout server.key -out server.csr</span></code></pre></div></div><div class=paragraph><p>Durante o processo de geração de certificados, certifique-se de configurar corretamente o atributo <code>Common Name</code>. A Solicitação de Assinatura de Certificado deve ser assinada com a Autoridade de Certificação para ser usada como um certificado válido:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># openssl x509 -req -days 365 -in server.csr -out ../server.crt -CA ../ca.crt -CAkey ca.key -CAcreateserial</span></code></pre></div></div><div class=paragraph><p>A parte final do processo de geração de certificados é gerar e assinar os certificados do cliente:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># openssl req -days 365 -nodes -new -keyout client.key -out client.csr</span>
<span class=c># openssl x509 -req -days 3650 -in client.csr -out ../client.crt -CA ../ca.crt -CAkey ca.key</span></code></pre></div></div><div class=paragraph><p>Lembre-se de usar o mesmo atributo <code>Common Name</code> quando solicitado. Quando terminar, assegure-se de que um total de oito (8) novos arquivos tenham sido gerado através dos comandos procedentes.</p></div><div class=paragraph><p>O daemon que executa o servidor OpenLDAP é o <span class=filename>slapd</span>. Sua configuração é executada através do <span class=filename>slapd.ldif</span>: o antigo <span class=filename>slapd.conf</span> foi descontinuado pelo OpenLDAP.</p></div><div class=paragraph><p><a href=http://www.openldap.org/doc/admin24/slapdconf2.html>Exemplos de configuração</a> para o <span class=filename>slapd.ldif</span> estão disponíveis e também podem ser encontrados em <span class=filename>/usr/local/etc/openldap/slapd.ldif.sample</span>. As opções estão documentadas em slapd-config(5). Cada seção do <span class=filename>slapd.ldif</span>, como todos os outros conjuntos de atributos LDAP, é identificada exclusivamente por meio de um DN. Certifique-se de que nenhuma linha em branco seja deixada entre a instrução <code>dn:</code> e o final desejado da seção. No exemplo a seguir, o TLS será usado para implementar um canal seguro. A primeira seção representa a configuração global:</p></div><div class="literalblock programlisting"><div class=content><pre>#
# See slapd-config(5) for details on configuration options.
# This file should NOT be world readable.
#
dn: cn=config
objectClass: olcGlobal
cn: config
#
#
# Define global ACLs to disable default read access.
#
olcArgsFile: /var/run/openldap/slapd.args
olcPidFile: /var/run/openldap/slapd.pid
olcTLSCertificateFile: /usr/local/etc/openldap/server.crt
olcTLSCertificateKeyFile: /usr/local/etc/openldap/private/server.key
olcTLSCACertificateFile: /usr/local/etc/openldap/ca.crt
#olcTLSCipherSuite: HIGH
olcTLSProtocolMin: 3.1
olcTLSVerifyClient: never</pre></div></div><div class=paragraph><p>A Autoridade de Certificação, o certificado do servidor e os arquivos de chave privada do servidor devem ser especificados aqui. Recomenda-se que os clientes escolham a opção de criptografia de segurança e omitam <code>olcTLSCipherSuite</code> (incompatível com clientes TLS diferentes de <span class=filename>openssl</span>). A opção <code>olcTLSProtocolMin</code> permite que o servidor exija um nível mínimo de segurança: é recomendado. Enquanto a verificação é obrigatória para o servidor, não é para o cliente: <code>olcTLSVerifyClient: never</code>.</p></div><div class=paragraph><p>A segunda seção é sobre os módulos de backend e pode ser configurada da seguinte maneira:</p></div><div class="literalblock programlisting"><div class=content><pre>#
# Load dynamic backend modules:
#
dn: cn=module,cn=config
objectClass: olcModuleList
cn: module
olcModulepath:	/usr/local/libexec/openldap
olcModuleload:	back_mdb.la
#olcModuleload:	back_bdb.la
#olcModuleload:	back_hdb.la
#olcModuleload:	back_ldap.la
#olcModuleload:	back_passwd.la
#olcModuleload:	back_shell.la</pre></div></div><div class=paragraph><p>A terceira seção é dedicada a carregar os esquemas <code>ldif</code> necessários para serem usados pelos bancos de dados: eles são essenciais.</p></div><div class="literalblock programlisting"><div class=content><pre>dn: cn=schema,cn=config
objectClass: olcSchemaConfig
cn: schema

include: file:///usr/local/etc/openldap/schema/core.ldif
include: file:///usr/local/etc/openldap/schema/cosine.ldif
include: file:///usr/local/etc/openldap/schema/inetorgperson.ldif
include: file:///usr/local/etc/openldap/schema/nis.ldif</pre></div></div><div class=paragraph><p>Em seguida, a seção de configuração do frontend:</p></div><div class="literalblock programlisting"><div class=content><pre># Frontend settings
#
dn: olcDatabase={-1}frontend,cn=config
objectClass: olcDatabaseConfig
objectClass: olcFrontendConfig
olcDatabase: {-1}frontend
olcAccess: to * by * read
#
# Sample global access control policy:
#	Root DSE: allow anyone to read it
#	Subschema (sub)entry DSE: allow anyone to read it
#	Other DSEs:
#		Allow self write access
#		Allow authenticated users read access
#		Allow anonymous users to authenticate
#
#olcAccess: to dn.base=&#34;&#34; by * read
#olcAccess: to dn.base=&#34;cn=Subschema&#34; by * read
#olcAccess: to *
#	by self write
#	by users read
#	by anonymous auth
#
# if no access controls are present, the default policy
# allows anyone and everyone to read anything but restricts
# updates to rootdn.  (e.g., &#34;access to * by * read&#34;)
#
# rootdn can always read and write EVERYTHING!
#
olcPasswordHash: {SSHA}
# {SSHA} is already the default for olcPasswordHash</pre></div></div><div class=paragraph><p>Outra seção é dedicada ao <em>backend de configuração</em>, a única maneira de acessar posteriormente a configuração do servidor OpenLDAP é como um superusuário global.</p></div><div class="literalblock programlisting"><div class=content><pre>dn: olcDatabase={0}config,cn=config
objectClass: olcDatabaseConfig
olcDatabase: {0}config
olcAccess: to * by * none
olcRootPW: {SSHA}iae+lrQZILpiUdf16Z9KmDmSwT77Dj4U</pre></div></div><div class=paragraph><p>O nome de usuário administrador padrão é <code>cn=config</code>. Digite <span class=filename>slappasswd</span> em um shell, escolha a senha e use sua hash <code>olcRootPW</code>. Se essa opção não for especificada agora, antes do arquivo <span class=filename>slapd.ldif</span> ser importado, ninguém poderá modificar a seção de <em>configuração global</em>.</p></div><div class=paragraph><p>A última seção é sobre o back-end do banco de dados:</p></div><div class="literalblock programlisting"><div class=content><pre>#######################################################################
# LMDB database definitions
#######################################################################
#
dn: olcDatabase=mdb,cn=config
objectClass: olcDatabaseConfig
objectClass: olcMdbConfig
olcDatabase: mdb
olcDbMaxSize: 1073741824
olcSuffix: dc=domain,dc=example
olcRootDN: cn=mdbadmin,dc=domain,dc=example
# Cleartext passwords, especially for the rootdn, should
# be avoided.  See slappasswd(8) and slapd-config(5) for details.
# Use of strong authentication encouraged.
olcRootPW: {SSHA}X2wHvIWDk6G76CQyCMS1vDCvtICWgn0+
# The database directory MUST exist prior to running slapd AND
# should only be accessible by the slapd and slap tools.
# Mode 700 recommended.
olcDbDirectory:	/var/db/openldap-data
# Indices to maintain
olcDbIndex: objectClass eq</pre></div></div><div class=paragraph><p>Esse banco de dados hospeda os <em>conteudos atuais</em> do diretório LDAP. Outros tipos diferentes de <code>mdb</code> estão disponiveis. Esse é super-usuário, não confundir com um global, é configurado aqui: um usuário (possivelmente customizado) em <code>olcRootDN</code> e a hash da senha em <code>olcRootPW</code>; <span class=filename>slappasswd</span> pode ser usado como antes.</p></div><div class=paragraph><p>Esse <a href="http://www.openldap.org/devel/gitweb.cgi?p=openldap.git;a=tree;f=tests/data/regressions/its8444;h=8a5e808e63b0de3d2bdaf2cf34fecca8577ca7fd;hb=HEAD">repositorio</a> contém quatro exemplos do arquivo <span class=filename>slapd.ldif</span>. Para converter um arquivo <span class=filename>slapd.conf</span> existente dentro de <span class=filename>slapd.ldif</span>, referencie a <a href=http://www.openldap.org/doc/admin24/slapdconf2.html>essa página</a> (por favor, note que isso pode introduzir algumas opções inuteis).</p></div><div class=paragraph><p>Quando a configuração estiver concluída, o <span class=filename>slapd.ldif</span> deve ser colocado em um diretório vazio. Recomenda-se criá-lo como:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># mkdir /usr/local/etc/openldap/slapd.d/</span></code></pre></div></div><div class=paragraph><p>Importe o banco de dados de configuração:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># /usr/local/sbin/slapadd -n0 -F /usr/local/etc/openldap/slapd.d/ -l /usr/local/etc/openldap/slapd.ldif</span></code></pre></div></div><div class=paragraph><p>Inicie o daemon <span class=filename>slapd</span>:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># /usr/local/libexec/slapd -F /usr/local/etc/openldap/slapd.d/</span></code></pre></div></div><div class=paragraph><p>A opção <code>-d</code> pode ser usada para depuração, conforme especificado em slapd(8). Para verificar se o servidor está em execução e funcionando:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># ldapsearch -x -b &#39;&#39; -s base &#39;(objectclass=*)&#39; namingContexts</span>
<span class=c># extended LDIF</span>
<span class=c>#</span>
<span class=c># LDAPv3</span>
<span class=c># base &lt;&gt; with scope baseObject</span>
<span class=c># filter: (objectclass=*)</span>
<span class=c># requesting: namingContexts</span>
<span class=c>#</span>

<span class=c>#</span>
dn:
namingContexts: <span class=nv>dc</span><span class=o>=</span>domain,dc<span class=o>=</span>example

<span class=c># search result</span>
search: 2
result: 0 Success

<span class=c># numResponses: 2</span>
<span class=c># numEntries: 1</span></code></pre></div></div><div class=paragraph><p>O servidor ainda deve ser confiável. Se isso nunca foi feito antes, siga estas instruções. Instale o pacote ou o port OpenSSL:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># pkg install openssl</span></code></pre></div></div><div class=paragraph><p>No diretório onde o <span class=filename>ca.crt</span> está armazenado (neste exemplo, <span class=filename>/usr/local/etc/openldap</span>), execute:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># c_rehash .</span></code></pre></div></div><div class=paragraph><p>Tanto a CA quanto o certificado do servidor agora são reconhecidos corretamente em suas respectivas funções. Para verificar isso, execute este comando no diretório <span class=filename>server.crt</span>:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># openssl verify -verbose -CApath . server.crt</span></code></pre></div></div><div class=paragraph><p>Se o <span class=filename>slapd</span> estiver em execução, reinicie-o. Como declarado em <span class=filename>/usr/local/etc/rc.d/slapd</span>, para executar corretamente o <span class=filename>slapd</span> na inicialização, as seguintes linhas devem ser adicionadas ao <span class=filename>/etc/rc.conf</span>:</p></div><div class="literalblock programlisting"><div class=content><pre>lapd_enable=&#34;YES&#34;
slapd_flags=&#39;-h &#34;ldapi://%2fvar%2frun%2fopenldap%2fldapi/
ldap://0.0.0.0/&#34;&#39;
slapd_sockets=&#34;/var/run/openldap/ldapi&#34;
slapd_cn_config=&#34;YES&#34;</pre></div></div><div class=paragraph><p>O <span class=filename>slapd</span> não fornece depuração na inicialização. Verifique o <span class=filename>/var/log/debug.log</span>, o <span class=filename>dmesg -a</span> e o <span class=filename>/var/log/messages</span> para este propósito.</p></div><div class=paragraph><p>O exemplo a seguir adiciona o grupo <code>team</code> e o usuário <code>john</code> ao banco de dados LDAP de <code>domain.example</code>, que ainda está vazio. Primeiro, crie o arquivo <span class=filename>domain.ldif</span>:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># cat domain.ldif</span>
dn: <span class=nv>dc</span><span class=o>=</span>domain,dc<span class=o>=</span>example
objectClass: dcObject
objectClass: organization
o: domain.example
dc: domain

dn: <span class=nv>ou</span><span class=o>=</span><span class=nb>groups</span>,dc<span class=o>=</span>domain,dc<span class=o>=</span>example
objectClass: top
objectClass: organizationalunit
ou: <span class=nb>groups

</span>dn: <span class=nv>ou</span><span class=o>=</span><span class=nb>users</span>,dc<span class=o>=</span>domain,dc<span class=o>=</span>example
objectClass: top
objectClass: organizationalunit
ou: <span class=nb>users

</span>dn: <span class=nv>cn</span><span class=o>=</span>team,ou<span class=o>=</span><span class=nb>groups</span>,dc<span class=o>=</span>domain,dc<span class=o>=</span>example
objectClass: top
objectClass: posixGroup
cn: team
gidNumber: 10001

dn: <span class=nv>uid</span><span class=o>=</span>john,ou<span class=o>=</span><span class=nb>users</span>,dc<span class=o>=</span>domain,dc<span class=o>=</span>example
objectClass: top
objectClass: account
objectClass: posixAccount
objectClass: shadowAccount
cn: John McUser
uid: john
uidNumber: 10001
gidNumber: 10001
homeDirectory: /home/john/
loginShell: /usr/bin/bash
userPassword: secret</code></pre></div></div><div class=paragraph><p>Veja a documentação do OpenLDAP para mais detalhes. Use <span class=filename>slappasswd</span> para substituir a senha <code>secret</code> em texto puro com um hash no <code>userPassword</code>. O caminho especificado como <code>loginShell</code> deve existir em todos sistemas onde <code>john</code> pode se logar. Finalmente, use o administrador <code>mdb</code> para modificar o banco de dados:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># ldapadd -W -D &#34;cn=mdbadmin,dc=domain,dc=example&#34; -f domain.ldif</span></code></pre></div></div><div class=paragraph><p>Modificações para a seção <em>configurações globais</em> podem ser feitas apenas pelo super-usuário global. Por exemplo, assume que a opção <code>olcTLSCipherSuite: HIGH:MEDIUM:SSLv3</code> foi inicialmente especificada e deve agora ser deletada. Primeiro, crie um arquivo que contenha o seguinte:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># cat global_mod</span>
dn: <span class=nv>cn</span><span class=o>=</span>config
changetype: modify
delete: olcTLSCipherSuite</code></pre></div></div><div class=paragraph><p>Em seguida, aplique as modificações:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># ldapmodify -f global_mod -x -D &#34;cn=config&#34; -W</span></code></pre></div></div><div class=paragraph><p>Quando solicitado, forneça a senha escolhida na seção <em>configuração backend</em>. O nome de usuário não é necessário: aqui, <code>cn=config</code> representa o DN da seção do banco de dados a ser modificada. Como alternativa, use <code>ldapmodify</code> para excluir uma única linha do banco de dados, <code>ldapdelete</code> para excluir uma entrada inteira.</p></div><div class=paragraph><p>Se algo der errado ou se o superusuário global não puder acessar o backend de configuração, é possível excluir e reescrever toda a configuração:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># rm -rf /usr/local/etc/openldap/slapd.d/</span></code></pre></div></div><div class=paragraph><p>O <span class=filename>slapd.ldif</span> pode então ser editado e importado novamente. Por favor, siga este procedimento somente quando nenhuma outra solução estiver disponível.</p></div><div class=paragraph><p>Esta é a configuração do servidor apenas. A mesma máquina também pode hospedar um cliente LDAP, com sua própria configuração separada.</p></div></div></div></div><div class=sect1><h2 id=network-dhcp>29.6. Protocolo de configuração dinâmica de hosts (DHCP)<a class=anchor href=#network-dhcp></a></h2><div class=sectionbody><div class=paragraph><p>O protocolo de configuração dinâmica de hosts (DHCP) permite que um sistema se conecte a uma rede para receber as informações de endereçamento necessárias para a comunicação nessa rede. O FreeBSD inclui a versão do <code>dhclient</code> do OpenBSD que é usada pelo cliente para obter as informações de endereçamento. O FreeBSD não instala um servidor DHCP, mas vários servidores estão disponíveis na coleção de Ports do FreeBSD. O protocolo DHCP é totalmente descrito em <a href=http://www.freesoft.org/CIE/RFC/2131/>RFC 2131</a>. Recursos informativos também estão disponíveis em <a href=http://www.isc.org/downloads/dhcp/>isc.org/downloads/dhcp/</a>.</p></div><div class=paragraph><p>Esta seção descreve como usar o cliente DHCP integrado. Em seguida, descreve como instalar e configurar um servidor DHCP.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>No FreeBSD, o dispositivo <a href="https://man.freebsd.org/cgi/man.cgi?query=bpf&amp;sektion=4&amp;format=html">bpf(4)</a> é necessário tanto pelo servidor DHCP como pelo DHCP > cliente. Este dispositivo está incluído no kernel <span class=filename>GENERIC</span> que é instalado com o FreeBSD. Usuários que preferem criar um kernel personalizado precisam manter este dispositivo se o DHCP for usado.</p></div><div class=paragraph><p>Deve-se notar que o <span class=filename>bpf</span> também permite que usuários privilegiados executem sniffers de pacotes de rede naquele sistema.</p></div></td></tr></tbody></table></div><div class=sect2><h3 id=_configurando_um_cliente_dhcp>29.6.1. Configurando um cliente DHCP<a class=anchor href=#_configurando_um_cliente_dhcp></a></h3><div class=paragraph><p>O suporte ao cliente DHCP está incluído no instalador do FreeBSD, facilitando a configuração de um sistema recém-instalado para receber automaticamente as informações de endereçamento de rede de um servidor DHCP existente. Consulte <a href=../bsdinstall/#bsdinstall-post>Pós-instalação</a> para exemplos de configuração de rede.</p></div><div class=paragraph><p>Quando o <code>dhclient</code> é executado na máquina cliente, ele inicia as solicitações de transmissão das informações de configuração. Por padrão, esses pedidos usam a porta UDP 68. O servidor responde na porta UDP 67 , fornecendo ao cliente um endereço IP e outras informações de rede relevantes como uma máscara de sub-rede, gateway padrão e endereços de servidor DNS. Esta informação está na forma de uma "concessão" de DHCP e é válida por um tempo configurável. Isso permite que endereços IP obsoletos para clientes que não estejam mais conectados à rede sejam reutilizados automaticamente. Clientes DHCP podem obter uma grande quantidade de informações do servidor. Uma lista exaustiva pode ser encontrada em <a href="https://man.freebsd.org/cgi/man.cgi?query=dhcp-options&amp;sektion=5&amp;format=html">dhcp-options(5)</a>.</p></div><div class=paragraph><p>Por padrão, quando um sistema FreeBSD inicializa, seu cliente DHCP é executado em segundo plano, ou <em>asynchronously</em>. Outros scripts de inicialização continuam sendo executados enquanto o processo DHCP é concluído, o que acelera a inicialização do sistema.</p></div><div class=paragraph><p>O DHCP em segundo plano funciona bem quando o servidor DHCP responde rapidamente às solicitações do cliente. No entanto, o DHCP pode levar muito tempo para ser concluído em alguns sistemas. Se os serviços de rede tentarem executar antes que o DHCP tenha atribuído as informações de endereçamento de rede, eles falharão. O uso do DHCP no modo <em>synchronous</em> impede esse problema, pois ele pausa a inicialização até que a configuração DHCP seja concluída.</p></div><div class=paragraph><p>Esta linha no <span class=filename>/etc/rc.conf</span> é usada para configurar o modo background ou assíncrono:</p></div><div class="literalblock programlisting"><div class=content><pre>ifconfig_fxp0=&#34;DHCP&#34;</pre></div></div><div class=paragraph><p>Esta linha pode já existir se o sistema foi configurado para usar o DHCP durante a instalação. Substitua o <em>fxp0</em> mostrado nesses exemplos pelo nome da interface a ser configurada dinamicamente, conforme descrito em <a href=../config/#config-network-setup>Configurando Placas de Interface de Rede</a>.</p></div><div class=paragraph><p>Para configurar o sistema para usar o modo síncrono e pausar durante a inicialização enquanto o DHCP é concluído, use “SYNCDHCP”:</p></div><div class="literalblock programlisting"><div class=content><pre>ifconfig_fxp0=&#34;SYNCDHCP&#34;</pre></div></div><div class=paragraph><p>Opções adicionais do cliente estão disponíveis. Procure por <code>dhclient</code> in <a href="https://man.freebsd.org/cgi/man.cgi?query=rc.conf&amp;sektion=5&amp;format=html">rc.conf(5)</a> para detalhes.</p></div><div class=paragraph><p>O cliente DHCP usa os seguintes arquivos:</p></div><div class=ulist><ul><li><p><span class=filename>/etc/dhclient.conf</span></p><div class=paragraph><p>O arquivo de configuração usado pelo <code>dhclient</code>. Normalmente, esse arquivo contém apenas comentários, pois os padrões são adequados para a maioria dos clientes. Este arquivo de configuração é descrito em <a href="https://man.freebsd.org/cgi/man.cgi?query=dhclient.conf&amp;sektion=5&amp;format=html">dhclient.conf(5)</a>.</p></div></li><li><p><span class=filename>/sbin/dhclient</span></p><div class=paragraph><p>Maiores informações sobre o comando em si podem ser encontradas em <a href="https://man.freebsd.org/cgi/man.cgi?query=dhclient&amp;sektion=8&amp;format=html">dhclient(8)</a>.</p></div></li><li><p><span class=filename>/sbin/dhclient-script</span></p><div class=paragraph><p>O script de configuração do cliente DHCP específico do FreeBSD. Ele é descrito em <a href="https://man.freebsd.org/cgi/man.cgi?query=dhclient-script&amp;sektion=8&amp;format=html">dhclient-script(8)</a>, mas não deve precisar de nenhuma modificação do usuário para funcionar corretamente.</p></div></li><li><p><span class=filename>/var/db/dhclient.leases.interface</span></p><div class=paragraph><p>O cliente DHCP mantém um banco de dados de concessões válidas neste arquivo, que é escrito como um log e é descrito em <a href="https://man.freebsd.org/cgi/man.cgi?query=dhclient.leases&amp;sektion=5&amp;format=html">dhclient.leases(5)</a>.</p></div></li></ul></div></div><div class=sect2><h3 id=network-dhcp-server>29.6.2. Instalando e configurando um servidor DHCP<a class=anchor href=#network-dhcp-server></a></h3><div class=paragraph><p>Esta seção demonstra como configurar um sistema FreeBSD para atuar como um servidor DHCP usando a implementação do servidor DHCP do Internet Systems Consortium (ISC). Esta implementação e a sua documentação podem ser instaladas usando o pacote ou port <a class=package href=https://cgit.freebsd.org/ports/tree/net/isc-dhcp44-server/>net/isc-dhcp44-server</a>.</p></div><div class=paragraph><p>A instalação do <a class=package href=https://cgit.freebsd.org/ports/tree/net/isc-dhcp44-server/>net/isc-dhcp44-server</a> instala um arquivo de configuração de exemplo. Copie o <span class=filename>/usr/local/etc/dhcpd.conf.example</span> para <span class=filename>/usr/local/etc/dhcpd.conf</span> e faça as alterações neste novo arquivo.</p></div><div class=paragraph><p>O arquivo de configuração é composto de declarações para sub-redes e hosts que definem as informações que são fornecidas aos clientes DHCP. Por exemplo, essas linhas configuram o seguinte:</p></div><div class="literalblock programlisting"><div class=content><pre>option domain-name &#34;example.org&#34;;<i class=conum data-value=1></i><b>(1)</b>
option domain-name-servers ns1.example.org;<i class=conum data-value=2></i><b>(2)</b>
option subnet-mask 255.255.255.0;<i class=conum data-value=3></i><b>(3)</b>

default-lease-time 600;<i class=conum data-value=4></i><b>(4)</b>
max-lease-time 72400;<i class=conum data-value=5></i><b>(5)</b>
ddns-update-style none;<i class=conum data-value=6></i><b>(6)</b>

subnet 10.254.239.0 netmask 255.255.255.224 {
  range 10.254.239.10 10.254.239.20;<i class=conum data-value=7></i><b>(7)</b>
  option routers rtr-239-0-1.example.org, rtr-239-0-2.example.org;<i class=conum data-value=8></i><b>(8)</b>
}

host fantasia {
  hardware ethernet 08:00:07:26:c0:a5;<i class=conum data-value=9></i><b>(9)</b>
  fixed-address fantasia.fugue.com;<i class=conum data-value=10></i><b>(10)</b>
}</pre></div></div><div class="colist arabic"><table><tbody><tr><td><i class=conum data-value=1></i><b>1</b></td><td>Esta opção especifica o domínio de pesquisa padrão que será fornecido aos clientes. Consulte <a href="https://man.freebsd.org/cgi/man.cgi?query=resolv.conf&amp;sektion=5&amp;format=html">resolv.conf(5)</a> para obter maiores informações.</td></tr><tr><td><i class=conum data-value=2></i><b>2</b></td><td>Esta opção especifica uma lista separada por vírgula de servidores DNS que o cliente deve usar. Eles podem ser listados por seus nomes de domínio totalmente qualificados (FQDN), como visto no exemplo, ou por seus endereços de IP.</td></tr><tr><td><i class=conum data-value=3></i><b>3</b></td><td>A máscara de sub-rede que será fornecida aos clientes.</td></tr><tr><td><i class=conum data-value=4></i><b>4</b></td><td>O tempo de expiração da concessão padrão em segundos. Um cliente pode ser configurado para substituir esse valor.</td></tr><tr><td><i class=conum data-value=5></i><b>5</b></td><td>O período máximo permitido de tempo, em segundos, para uma concessão. Se um cliente solicitar uma concessão mais longa, uma concessão ainda será emitida, mas será válida apenas para o tempo especificado em <code>max-lease-time</code>.</td></tr><tr><td><i class=conum data-value=6></i><b>6</b></td><td>O padrão <code>none</code> desabilita as atualizações de DNS dinâmicas. Alterar isso para <code>interim</code> configura o servidor DHCP para atualizar um servidor DNS sempre que for concedido um contrato para que o servidor de DNS saiba quais endereços de IP estão associados a quais computadores na rede. Não altere a configuração padrão, a menos que o servidor de DNS tenha sido configurado para suportar DNS dinâmico.</td></tr><tr><td><i class=conum data-value=7></i><b>7</b></td><td>Esta linha cria um conjunto de endereços IP disponíveis que são reservados para alocação a clientes DHCP. O intervalo de endereços deve ser válido para a rede ou sub-rede especificada na linha anterior.</td></tr><tr><td><i class=conum data-value=8></i><b>8</b></td><td>Declara o gateway padrão que é válido para a rede ou sub-rede especificada antes do colchete de abertura <code>{</code>.</td></tr><tr><td><i class=conum data-value=9></i><b>9</b></td><td>Especifica o endereço de hardware MAC de um cliente para que o servidor DHCP possa reconhecer o cliente quando ele fizer uma solicitação.</td></tr><tr><td><i class=conum data-value=10></i><b>10</b></td><td>Especifica que este host deve sempre receber o mesmo endereço IP. A utilização do nome do host está correta, pois o servidor DHCP resolverá o nome do host antes de retornar as informações de concessão.</td></tr></tbody></table></div><div class=paragraph><p>Este arquivo de configuração suporta muito mais opções. Consulte o <a href="https://man.freebsd.org/cgi/man.cgi?query=dhcpd.conf&amp;sektion=5&amp;format=html">dhcpd.conf(5)</a>, instalado com o servidor, para obter detalhes e exemplos.</p></div><div class=paragraph><p>Uma vez que a configuração do <span class=filename>dhcpd.conf</span> estiver completa, habilite o servidor DHCP em <span class=filename>/etc/rc.conf</span>:</p></div><div class="literalblock programlisting"><div class=content><pre>dhcpd_enable=&#34;YES&#34;
dhcpd_ifaces=&#34;dc0&#34;</pre></div></div><div class=paragraph><p>Substitua o <code>dc0</code> pela interface (ou interfaces, separadas por espaço em branco) que o servidor DHCP deverá escutar por solicitações de clientes DHCP.</p></div><div class=paragraph><p>Inicie o servidor executando o seguinte comando:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># service isc-dhcpd start</span></code></pre></div></div><div class=paragraph><p>Quaisquer mudanças futuras na configuração do servidor exigirão que o serviço dhcpd seja interrompido e, em seguida, iniciado usando <a href="https://man.freebsd.org/cgi/man.cgi?query=service&amp;sektion=8&amp;format=html">service(8)</a>.</p></div><div class=paragraph><p>O servidor DHCP usa os seguintes arquivos. Observe que as páginas de manual são instaladas com o software do servidor.</p></div><div class=ulist><ul><li><p><span class=filename>/usr/local/sbin/dhcpd</span></p><div class=paragraph><p>Maiores informações sobre o servidor dhcpd podem ser encontradas em <a href="https://man.freebsd.org/cgi/man.cgi?query=dhcpd&amp;sektion=8&amp;format=html">dhcpd(8)</a>.</p></div></li><li><p><span class=filename>/usr/local/etc/dhcpd.conf</span></p><div class=paragraph><p>O arquivo de configuração do servidor precisa conter todas as informações que devem ser fornecidas aos clientes, juntamente com informações sobre a operação do servidor. Este arquivo de configuração é descrito no <a href="https://man.freebsd.org/cgi/man.cgi?query=dhcpd.conf&amp;sektion=5&amp;format=html">dhcpd.conf(5)</a>.</p></div></li><li><p><span class=filename>/var/db/dhcpd.leases</span></p><div class=paragraph><p>O servidor DHCP mantém um banco de dados das concessões que ele emitiu neste arquivo, que é gravado como um log. Consulte <a href="https://man.freebsd.org/cgi/man.cgi?query=dhcpd.leases&amp;sektion=5&amp;format=html">dhcpd.leases(5)</a>, o qual fornece uma descrição um pouco mais longa.</p></div></li><li><p><span class=filename>/usr/local/sbin/dhcrelay</span></p><div class=paragraph><p>Esse daemon é usado em ambientes avançados, onde um servidor DHCP encaminha uma solicitação de um cliente para outro servidor DHCP em uma rede separada. Se esta funcionalidade for necessária, instale o pacote ou port <a class=package href=https://cgit.freebsd.org/ports/tree/net/isc-dhcp44-relay/>net/isc-dhcp44-relay</a>. A instalação inclui o <a href="https://man.freebsd.org/cgi/man.cgi?query=dhcrelay&amp;sektion=8&amp;format=html">dhcrelay(8)</a>, que fornece maiores detalhes.</p></div></li></ul></div></div></div></div><div class=sect1><h2 id=network-dns>29.7. Sistema de Nomes de Domínio (DNS)<a class=anchor href=#network-dns></a></h2><div class=sectionbody><div class=paragraph><p>O Sistema de Nomes de Domínio (DNS) é o protocolo através do qual os nomes de domínio são mapeados para endereços de IP e vice-versa. O DNS é coordenado pela Internet através de um sistema complexo de raiz de autoridade, Top Level Domain (TLD) e outros servidores de nomes de menor escala, que hospedam e armazenam em cache domínios individuais. Não é necessário executar um servidor de nomes para executar pesquisas de DNS em um sistema.</p></div><div class=paragraph><p>A tabela a seguir descreve alguns dos termos associados ao DNS:</p></div><table class="tableblock frame-none grid-all stretch"><caption class=title>Tabela 4. Terminologia DNS</caption><col style=width:50%><col style=width:50%><thead><tr><th class="tableblock halign-left valign-top">Termo</th><th class="tableblock halign-left valign-top">Definição</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class=tableblock>Encaminhamento de DNS</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Mapeamento de nomes de hosts para endereços de IP.</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>Origem</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Refere-se ao domínio coberto em um arquivo de zona específico.</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>Resolver</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Um processo do sistema através do qual uma máquina consulta um servidor de nomes para informações de zona.</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>DNS Reverso</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Mapeamento de endereços IP para hostnames.</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>Root zone</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>O início da hierarquia da zona da Internet. Todas as zonas se enquadram na zona de raiz, semelhante a como todos os arquivos em um sistema de arquivos se enquadram no diretório raiz.</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>Zona</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Um domínio individual, subdomínio ou parte do DNS administrado pela mesma autoridade.</p></td></tr></tbody></table><div class=paragraph><p>Exemplos de zonas:</p></div><div class=ulist><ul><li><p><code>.</code> é como a zona root é geralmente referida na documentação.</p></li><li><p><code>org.</code> é um domínio de nível superior (TLD) sob a zona raiz.</p></li><li><p><code>example.org.</code> é uma zona sob o TLD <code>org.</code>.</p></li><li><p><code>1.168.192.in-addr.arpa</code> é uma zona que faz referência a todos os endereços IP que se enquadram no espaço de endereçamento IP <code>192.168.1.*</code> .</p></li></ul></div><div class=paragraph><p>Como se pode ver, a parte mais específica de um nome de host aparece à esquerda. Por exemplo, <code>example.org.</code> é mais específico que <code>org.</code>, como <code>org.</code> é mais específico que a zona raiz . O layout de cada parte de um nome de host é muito parecido com um sistema de arquivos: o diretório <span class=filename>/dev</span> está dentro da raiz e assim por diante.</p></div><div class=sect2><h3 id=_razões_para_executar_um_servidor_de_nomes>29.7.1. Razões para executar um servidor de nomes<a class=anchor href=#_razões_para_executar_um_servidor_de_nomes></a></h3><div class=paragraph><p>Os servidores de nomes geralmente vêm em duas formas: servidores de nomes autoritativos e servidores de nomes de armazenamento em cache (também conhecidos como servidores de resolução).</p></div><div class=paragraph><p>Um servidor de nomes autoritativo é necessário quando:</p></div><div class=ulist><ul><li><p>Alguém quer servir ao mundo informações de DNS, respondendo autoritariamente a consultas.</p></li><li><p>Um domínio, como <code>example.org</code>, está registrado e os endereços IP precisam ser atribuídos a nomes de host sob ele.</p></li><li><p>Um bloco de endereços IP requer entradas reversas de DNS (IP para hostname).</p></li><li><p>Um servidor de nomes de backup ou secundário, chamado de escravo, responderá às consultas.</p></li></ul></div><div class=paragraph><p>Um servidor de nomes em cache é necessário quando:</p></div><div class=ulist><ul><li><p>Um servidor DNS local pode armazenar em cache e responder mais rapidamente do que consultar um servidor de nomes externo.</p></li></ul></div><div class=paragraph><p>Quando alguém pergunta por <code>www.FreeBSD.org</code>, o resolvedor geralmente consulta o servidor de nomes do ISP e recupera a resposta. Com um servidor local, de cache DNS, a consulta só precisa ser feita uma vez para o mundo externo pelo servidor de Cache DNS. Consultas adicionais não precisarão sair da rede local, pois as informações estão armazenadas em um cache local.</p></div></div><div class=sect2><h3 id=_configuração_do_servidor_de_dns>29.7.2. Configuração do servidor de DNS<a class=anchor href=#_configuração_do_servidor_de_dns></a></h3><div class=paragraph><p>O Unbound é fornecido no sistema básico do FreeBSD. Por padrão, ele fornecerá a resolução de DNS apenas para a máquina local. Embora o pacote básico do sistema possa ser configurado para fornecer serviços de resolução além da máquina local, é recomendável que esses requisitos sejam resolvidos instalando o Unbound da coleção de ports do FreeBSD.</p></div><div class=paragraph><p>Para ativar o Unbound, adicione o seguinte ao <span class=filename>/etc/rc.conf</span>:</p></div><div class="literalblock programlisting"><div class=content><pre>local_unbound_enable=&#34;YES&#34;</pre></div></div><div class=paragraph><p>Quaisquer servidores de nomes existentes em <span class=filename>/etc/resolv.conf</span> serão configurados como forwarders na nova configuração do Unbound.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Se algum dos servidores de nomes listados não suportar o DNSSEC, a resolução local DNS falhará. Certifique-se de testar cada servidor de nomes e remover qualquer um que falhe no teste. O seguinte comando mostrará a árvore de confiança ou uma falha para um servidor de nomes em execução em <code>192.168.1.1</code>:</p></div></td></tr></tbody></table></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>% drill <span class=nt>-S</span> FreeBSD.org @192.168.1.1</code></pre></div></div><div class=paragraph><p>Quando cada servidor de nomes for confirmado para suportar DNSSEC, inicie o Unbound:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># service local_unbound onestart</span></code></pre></div></div><div class=paragraph><p>Isso cuidará da atualização do arquivo <span class=filename>/etc/resolv.conf</span> para que as consultas para domínios seguros DNSSEC funcionem agora. Por exemplo, execute o seguinte DNSSEC para validar a árvore confiável do FreeBSD.org :</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>% drill <span class=nt>-S</span> FreeBSD.org
<span class=p>;;</span> Number of trusted keys: 1
<span class=p>;;</span> Chasing: freebsd.org. A

DNSSEC Trust tree:
freebsd.org. <span class=o>(</span>A<span class=o>)</span>
|---freebsd.org. <span class=o>(</span>DNSKEY keytag: 36786 alg: 8 flags: 256<span class=o>)</span>
    |---freebsd.org. <span class=o>(</span>DNSKEY keytag: 32659 alg: 8 flags: 257<span class=o>)</span>
    |---freebsd.org. <span class=o>(</span>DS keytag: 32659 digest <span class=nb>type</span>: 2<span class=o>)</span>
        |---org. <span class=o>(</span>DNSKEY keytag: 49587 alg: 7 flags: 256<span class=o>)</span>
            |---org. <span class=o>(</span>DNSKEY keytag: 9795 alg: 7 flags: 257<span class=o>)</span>
            |---org. <span class=o>(</span>DNSKEY keytag: 21366 alg: 7 flags: 257<span class=o>)</span>
            |---org. <span class=o>(</span>DS keytag: 21366 digest <span class=nb>type</span>: 1<span class=o>)</span>
            |   |---. <span class=o>(</span>DNSKEY keytag: 40926 alg: 8 flags: 256<span class=o>)</span>
            |       |---. <span class=o>(</span>DNSKEY keytag: 19036 alg: 8 flags: 257<span class=o>)</span>
            |---org. <span class=o>(</span>DS keytag: 21366 digest <span class=nb>type</span>: 2<span class=o>)</span>
                |---. <span class=o>(</span>DNSKEY keytag: 40926 alg: 8 flags: 256<span class=o>)</span>
                    |---. <span class=o>(</span>DNSKEY keytag: 19036 alg: 8 flags: 257<span class=o>)</span>
<span class=p>;;</span> Chase successful</code></pre></div></div></div></div></div><div class=sect1><h2 id=network-apache>29.8. Servidor HTTP Apache<a class=anchor href=#network-apache></a></h2><div class=sectionbody><div class=paragraph><p>O open source Apache HTTP Server é o servidor Web mais utilizado. O FreeBSD não instala este servidor web por padrão, mas ele pode ser instalado a partir do pacote ou Port <a class=package href=https://cgit.freebsd.org/ports/tree/www/apache24/>www/apache24</a>.</p></div><div class=paragraph><p>Esta seção resume como configurar e iniciar a versão 2.<em>x</em> do Servidor HTTP Apache no FreeBSD. Para informações mais detalhadas sobre o Apache2.X e suas diretivas de configuração, consulte <a href=http://httpd.apache.org/>httpd.apache.org</a>.</p></div><div class=sect2><h3 id=_configurando_e_iniciando_o_apache>29.8.1. Configurando e Iniciando o Apache<a class=anchor href=#_configurando_e_iniciando_o_apache></a></h3><div class=paragraph><p>No FreeBSD, o arquivo de configuração principal do Apache HTTP Server é instalado como <span class=filename>/usr/local/etc/apache2x/httpd.conf</span>, onde <em>x</em> representa o número da versão. Este arquivo ASCII de texto inicia as linhas de comentário com um <code>#</code>. As diretivas modificadas com mais freqüência são:</p></div><div class=dlist><dl><dt class=hdlist1><code>ServerRoot "/usr/local"</code></dt><dd><p>Especifica a hierarquia de diretório padrão para a instalação do Apache. Os binários são armazenados nos subdiretórios <span class=filename>bin</span> e <span class=filename>sbin</span> da raiz do servidor e os arquivos de configuração são armazenados no subdiretório <span class=filename>etc/apache2x</span>.</p></dd><dt class=hdlist1><code>ServerAdmin <a href=mailto:you@example.com>you@example.com</a></code></dt><dd><p>Altere isso para seu endereço de e-mail para receber problemas com o servidor. Esse endereço também aparece em algumas páginas geradas pelo servidor, como documentos de erro.</p></dd><dt class=hdlist1><code>ServerName www.example.com:80</code></dt><dd><p>Permite que um administrador defina um nome de host que é enviado de volta aos clientes pelo servidor. Por exemplo, <code>www</code> pode ser usado em vez do nome do host real. Se o sistema não tiver um nome registrado no DNS, insira seu endereço IP. Se o servidor irá escutar em um relatório alternativo, altere a porta <code>80</code> para o número de porta alternativa.</p></dd><dt class=hdlist1><code>DocumentRoot "/usr/local/www/apache2<em>x</em>/data"</code></dt><dd><p>O diretório no qual os documentos serão exibidos. Por padrão, todas as solicitações são obtidas desse diretório, mas os links e aliases simbólicos podem ser usados para apontar para outros locais.</p></dd></dl></div><div class=paragraph><p>É sempre uma boa ideia fazer uma cópia de backup do arquivo de configuração do Apache padrão antes de fazer alterações. Quando a configuração do Apache estiver concluída, salve o arquivo e verifique a configuração usando o <code>apachectl</code>. A execução do <code>apachectl configtest</code> deve retornar <code>Syntax OK</code>.</p></div><div class=paragraph><p>Para iniciar o Apache na inicialização do sistema, adicione a seguinte linha ao <span class=filename>/etc/rc.conf</span>:</p></div><div class="literalblock programlisting"><div class=content><pre>apache24_enable=&#34;YES&#34;</pre></div></div><div class=paragraph><p>Se o Apache deve ser iniciado com opções não-padrão, a seguinte linha pode ser adicionada ao <span class=filename>/etc/rc.conf</span> para especificar os flags necessários:</p></div><div class="literalblock programlisting"><div class=content><pre>apache24_flags=&#34;&#34;</pre></div></div><div class=paragraph><p>Se o apachectl não relatar erros de configuração, inicie o <code>httpd</code> agora:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># service apache24 start</span></code></pre></div></div><div class=paragraph><p>O serviço <code>httpd</code> pode ser testado inserindo <code>http://<em>localhost</em></code> em um navegador da Web, substituindo <em>localhost</em> pelo nome de domínio totalmente qualificado da máquina que está executando o <code>httpd</code>. A página padrão da Web exibida é <span class=filename>/usr/local/www/apache24/data/index.html</span>.</p></div><div class=paragraph><p>A configuração do Apache pode ser testada quanto a erros depois de fazer alterações subsequentes de configuração enquanto o <code>httpd</code> está em execução usando o seguinte comando:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># service apache24 configtest</span></code></pre></div></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>É importante notar que o <code>configtest</code> não é um padrão <a href="https://man.freebsd.org/cgi/man.cgi?query=rc&amp;sektion=8&amp;format=html">rc(8)</a> e não se espera que funcione para todos os scripts de inicialização.</p></div></td></tr></tbody></table></div></div><div class=sect2><h3 id=_hospedagem_virtual>29.8.2. Hospedagem Virtual<a class=anchor href=#_hospedagem_virtual></a></h3><div class=paragraph><p>A hospedagem virtual permite que vários sites sejam executados em um servidor Apache. Os hosts virtuais podem ser <em>baseados em IP</em> ou <em>baseados em nome</em>. A hospedagem virtual baseada em IP usa um endereço IP diferente para cada site. A hospedagem virtual baseada em nome usa os cabeçalhos HTTP/1.1 do cliente para descobrir o nome do host, o que permite que os sites compartilhem o mesmo endereço de IP.</p></div><div class=paragraph><p>Para configurar o Apache para usar hospedagem virtual baseada em nome, adicione um bloco <code>VirtualHost</code> para cada site. Por exemplo, para o servidor Web denominado <code>www.domain.tld</code> com um domínio virtual de <code>www.someotherdomain.tld</code>, adicione as seguintes entradas ao arquivo <span class=filename>httpd.conf</span>:</p></div><div class="literalblock programlisting"><div class=content><pre>&lt;VirtualHost *&gt;
    ServerName www.domain.tld
    DocumentRoot /www/domain.tld
&lt;/VirtualHost&gt;

&lt;VirtualHost *&gt;
    ServerName www.someotherdomain.tld
    DocumentRoot /www/someotherdomain.tld
&lt;/VirtualHost&gt;</pre></div></div><div class=paragraph><p>Para cada host virtual, substitua os valores de <code>ServerName</code> e <code>DocumentRoot</code> pelos valores a serem usados.</p></div><div class=paragraph><p>Para obter mais informações sobre como configurar hosts virtuais, consulte a documentação oficial do Apache em: <a href=http://httpd.apache.org/docs/vhosts/>http://httpd.apache.org/docs/vhosts/</a>.</p></div></div><div class=sect2><h3 id=_módulos_apache>29.8.3. Módulos Apache<a class=anchor href=#_módulos_apache></a></h3><div class=paragraph><p>O Apache usa módulos para aumentar a funcionalidade fornecida pelo servidor básico. Consulte o <a href=http://httpd.apache.org/docs/current/mod/>http://httpd.apache.org/docs/current/mod/</a> para uma lista completa e detalhes de configuração para os módulos disponíveis.</p></div><div class=paragraph><p>No FreeBSD, alguns módulos podem ser compilados com o port <a class=package href=https://cgit.freebsd.org/ports/tree/www/apache24/>www/apache24</a>. Digite <code>make config</code> dentro do diretório <span class=filename>/usr/ports/www/apache24</span> para ver quais módulos estão disponíveis e quais estão ativados por padrão. Se o módulo não é compilado com o port, a Coleção de Ports do FreeBSD fornece uma maneira fácil de instalar vários módulos. Esta seção descreve três dos módulos mais usados.</p></div><div class=sect3><h4 id=_suporte_ssl>29.8.3.1. Suporte SSL<a class=anchor href=#_suporte_ssl></a></h4><div class=paragraph><p>Em algum momento, o suporte para o SSL dentro do Apache requer um modulo secundário chamado <span class=filename>mod_ssl</span>. Esse não é mais o casoe a instalação padrão do Apache vem com SSL embutido no servidor web. Um exemplo de como habilitar o suporte para paginas com SSL está disponível no arquivo <span class=filename>http-ssl.conf</span> instalado dentro do diretório <span class=filename>/usr/local/etc/apache24/extra</span>. Dentro desse diretório também esta um exemplo do arquivo chamado <span class=filename>ssl.conf-sample</span>. É recomendado que ambos arquivos sejam avaliados para configurar apropriadamente páginas seguras no servidor web Apache.</p></div><div class=paragraph><p>Depois da configuração do SSL estiver completa, deve ser removido o comentário da linha seguinte no arquivo <span class=filename>http.conf</span> principal para ativar as mudanças no próximo restart ou reload do Apache:</p></div><div class="literalblock programlisting"><div class=content><pre>#Include etc/apache24/extra/httpd-ssl.conf</pre></div></div><div class="admonitionblock warning"><table><tbody><tr><td class=icon><i class="fa icon-warning" title=Warning></i></td><td class=content><div class=paragraph><p>Versão dois do SSL e a versão três tem problemas de vulnerabilidades conhecidas. É altamente recomendado a versão 1.2 do TLS e 1.3 deve ser habilitada no lugar das velhas opções do SSL. Isso pode ser realizado configurando as seguintes opções no arquivo <span class=filename>ssl.conf</span>:</p></div></td></tr></tbody></table></div><div class="literalblock programlisting"><div class=content><pre>SSLProtocol all -SSLv3 -SSLv2 +TLSv1.2 +TLSv1.3
SSLProxyProtocol all -SSLv2 -SSLv3 -TLSv1 -TLSv1.1</pre></div></div><div class=paragraph><p>Para completar a configuração do SSL no servidor web, remova os comentários da seguinte linha para garantir que a configuração irá ser enviada para dentro do Apache durante o restart ou reload:</p></div><div class="literalblock programlisting"><div class=content><pre># Secure (SSL/TLS) connections
Include etc/apache24/extra/httpd-ssl.conf</pre></div></div><div class=paragraph><p>As linhas a seguir também devem ser descomentadas no <span class=filename>httpd.conf</span> para suportar totalmente o SSL no Apache:</p></div><div class="literalblock programlisting"><div class=content><pre>LoadModule authn_socache_module libexec/apache24/mod_authn_socache.so
LoadModule socache_shmcb_module libexec/apache24/mod_socache_shmcb.so
LoadModule ssl_module libexec/apache24/mod_ssl.so</pre></div></div><div class=paragraph><p>O próximo passo é trabalhar com uma autoridade certificadora para ter certificados apropriados instalados no sistema. Isso vai configurar um cadeia de confiança para a pagina e prever alguns avisos de certificados auto assinados.</p></div></div><div class=sect3><h4 id=_mod_perl>29.8.3.2. <span class=filename>mod_perl</span><a class=anchor href=#_mod_perl></a></h4><div class=paragraph><p>O módulo <span class=filename>mod_perl</span> torna possível escrever módulos Apache em Perl. Além disso, o intérprete persistente embutido no servidor evita a sobrecarga de iniciar um intérprete externo e a penalidade do tempo de inicialização do Perl.</p></div><div class=paragraph><p>O <span class=filename>mod_perl</span> pode ser instalado usando o pacote ou port <a class=package href=https://cgit.freebsd.org/ports/tree/www/mod_perl2/>www/mod_perl2</a>. A documentação para usar este módulo pode ser encontrada em <a href=http://perl.apache.org/docs/2.0/index.html>http://perl.apache.org/docs/2.0/index .html</a>.</p></div></div><div class=sect3><h4 id=_mod_php>29.8.3.3. <span class=filename>mod_php</span><a class=anchor href=#_mod_php></a></h4><div class=paragraph><p><em>PHP: Pré-processador de hipertexto</em> ( PHP ) é uma linguagem de script de propósito geral que é especialmente adequada para desenvolvimento web. Capaz de ser incorporada em HTML, sua sintaxe se baseia em C, Java™ e Perl com a intenção de permitir desenvolvedores web para escrever rapidamente páginas da web geradas dinamicamente.</p></div><div class=paragraph><p>Suporte para PHP para o Apache e alguma outra parte escrita na linguagem, pode ser adicionada instalando o port apropriado.</p></div><div class=paragraph><p>Para todas versões suportadas, procure os dados do pacote usando o comando <code>pkg</code>:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># pkg search php</span></code></pre></div></div><div class=paragraph><p>Uma lista vai ser disponibilizada incluindo as versões e partes adicionais que elas proverem. Os componentes são completamente modulares, significando que as partes especificas são habilitadas instalando o port apropriado. Para instalar o PHP na versão 7.4 para o Apache, use o seguinte comando:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># pkg install mod_php74</span></code></pre></div></div><div class=paragraph><p>Se algum pacote dependente precisar ser instalado, ele irá ser instalado também.</p></div><div class=paragraph><p>Por padrão, o PHP não estará habilitado. As seguintes linhas precisam ser adicionadas no arquivo de configuração do Apache localizado em <span class=filename>/usr/local/etc/apache24</span> para ativa-lo:</p></div><div class="literalblock programlisting"><div class=content><pre>&lt;FilesMatch &#34;\.php$&#34;&gt;
    SetHandler application/x-httpd-php
&lt;/FilesMatch&gt;
&lt;FilesMatch &#34;\.phps$&#34;&gt;
    SetHandler application/x-httpd-php-source
&lt;/FilesMatch&gt;</pre></div></div><div class=paragraph><p>Em adição, a opção <code>DirectoryIndex</code> no arquivo de configuração irá precisar ser atualizada também e o Apache irá precisar ser reiniciado ou feito um relaoad também para as mudanças surtirem efeito.</p></div><div class=paragraph><p>Suporte para muitas partes do PHP podem ser instalado também usando o comando <code>pkg</code>. Por exemplo, para instalar suporte para o XML ou para SSL, instale os seguintes ports:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># pkg install php74-xml php74-openssl</span></code></pre></div></div><div class=paragraph><p>Como antes, a configuração do Apache irá precisar ser recarregada para as mudanças surtirem efeito, mesmo em casos onde foi feita apenas a instalação de um modulo.</p></div><div class=paragraph><p>Para realizar uma reinicialização normal para recarregar a configuração, digite o seguinte comando:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># apachectl graceful</span></code></pre></div></div><div class=paragraph><p>Uma vez que a instalação esteja completa, há dois métodos para obter o suporte para os modulos do PHP e a informação do ambiente dessa instalação. A primeira é instalar o binário completo do PHP e rodar o seguinte comando para obter a informação:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># pkg install php74</span></code></pre></div></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># php -i |less</span></code></pre></div></div><div class=paragraph><p>Isso é necessário para passar a saída paga um paginador, como o comando <code>more</code> ou <code>less</code> para visualizar melhor a saída.</p></div><div class=paragraph><p>Finalmente, para fazer alguma mudança na configuração global do PHP há um arquivo bem documentado instalado dentro de <span class=filename>/usr/local/etc/php.ini</span>. No momento da instalação, esse arquivo não irá existir porque há duas versões para escolher, uma é o arquivo <span class=filename>php.ini-development</span> e outra o <span class=filename>php.ini-production</span>. Esses são pontos iniciais para ajudar os administradores na implementação.</p></div></div><div class=sect3><h4 id=_suporte_a_http2>29.8.3.4. Suporte a HTTP2<a class=anchor href=#_suporte_a_http2></a></h4><div class=paragraph><p>Suporte do Apache para o protocolo HTTP está incluido por padrão quando instala o port com o comando <code>pkg</code>. A nova versão do HTTP inclui muitas melhorias em relação a versão anterior, incluindo utilizar uma conexão singular para uma página, reduzindo as idas e vindas de conexões TCP. Também, os dados no cabeçalho do pacote é comprimido e o HTTP2 requer encriptação por padrão.</p></div><div class=paragraph><p>Quando o Apache estiver configurado para usar HTTP2 apenas, os navegadores web irão requisitar conexões seguras, encriptadas com HTTPS. Quando o Apache estiver configurado para usar ambas versões, o HTTP1.1 irá ser considerado uma opção substituta se algum problema surgir durante a conexão.</p></div><div class=paragraph><p>Embora essa mudança exija que os administradores façam alterações, elas são positivas e equivalem a uma Internet mais segura para todos. As mudanças são requeridas apenas para paginas não implementada corretamente com SSL e TLS.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Essa configuração depende das seções anteriores, incluindo suporte a TLS. É recomendado que essas instruções seja seguidas antes de continuar com essa configuração.</p></div></td></tr></tbody></table></div><div class=paragraph><p>Comece o processo habilitando o modulo http2 removendo o comentário da linha no arquivo <span class=filename>/usr/local/etc/apache24/httpd.conf</span> e trocando o modulo mpm_prefork pelo mpm_event pois o anterior não suporta o http2.</p></div><div class="literalblock programlisting"><div class=content><pre>LoadModule http2_module libexec/apache24/mod_http2.so
LoadModule mpm_event_module libexec/apache24/mod_mpm_event.so</pre></div></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Aqui há um port <span class=filename>mod_http1</span> distinto que está disponível. Ele existe pra entregar segurança e correção de bugs mais rápido que o modulo instalado por padrão com o port <span class=filename>apache24</span>. Ele não é requisitado para o suporte do HTTP2 mas está disponível. Quando instalado, o <span class=filename>mod_h2.so</span> deve ser usado no lugar do <span class=filename>mod_http2.so</span> na configuração do Apache.</p></div></td></tr></tbody></table></div><div class=paragraph><p>Aqui há dois métodos para implementar o HTTP2 no Apache; um caminho é de forma global para todos os sites e cada VirtualHost rodando no sistema. Para habilitar o HTTP2 globalmente, adicione a seguinte linha abaixo da diretiva ServerName:</p></div><div class="literalblock programlisting"><div class=content><pre>Protocolos h2 http/1.1</pre></div></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Para habilitar HTTP2 sobre texto simples, use h2h2chttp/1.1 no arquivo <span class=filename>httpd.conf</span>.</p></div></td></tr></tbody></table></div><div class=paragraph><p>Tendo o h2c aqui irá permitir que o dado em texto simples do HTTP2 passar pelo sistema mas isso não é recomendado. Em adição a isso, usando o http/1.1 aqui irá permitir retornar para a versão do protocolo HTTP1.1 caso sejá necessário pelo sistema.</p></div><div class=paragraph><p>Para habilitar HTTP2 para VirtualHosts individuais, adicione a mesma linha com a diretiva VirtualHost no arquivo <span class=filename>httpd.conf</span> ou <span class=filename>httpd-ssl.conf</span>.</p></div><div class=paragraph><p>Recarregue a configuração usando o comando <code>apachectl</code> reload e teste a configuração seguindo um dos métodos após visitar uma das paginas hosteadas:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># grep &#34;HTTP/2.0&#34; /var/log/httpd-access.log</span></code></pre></div></div><div class=paragraph><p>A saída deve ser semelhante à seguinte:</p></div><div class="literalblock programlisting"><div class=content><pre>192.168.1.205 - - [18/Oct/2020:18:34:36 -0400] &#34;GET / HTTP/2.0&#34; 304 -
192.0.2.205 - - [18/Oct/2020:19:19:57 -0400] &#34;GET / HTTP/2.0&#34; 304 -
192.0.0.205 - - [18/Oct/2020:19:20:52 -0400] &#34;GET / HTTP/2.0&#34; 304 -
192.0.2.205 - - [18/Oct/2020:19:23:10 -0400] &#34;GET / HTTP/2.0&#34; 304 -</pre></div></div><div class=paragraph><p>O outro metodo é usar o navegador web padrão no debugger do site ou o comando <code>tcpdump</code>; contanto, o uso de qualquer método está além do escopo desse documento.</p></div><div class=paragraph><p>Suporte para conexões do proxy reverso HTTP2 usando o modulo <span class=filename>mod_proxy_http2.so</span>. Quando declarado na configuração o ProxyPass ou RewriteRules [P], eles devem usar h2:// para a conexão.</p></div></div></div><div class=sect2><h3 id=_websites_dinâmicos>29.8.4. Websites Dinâmicos<a class=anchor href=#_websites_dinâmicos></a></h3><div class=paragraph><p>Além do mod_perl e do mod_php, outras linguagens estão disponíveis para a criação de conteúdo dinâmico da web. Estes incluem o Django e o Ruby on Rails.</p></div><div class=sect3><h4 id=_django>29.8.4.1. Django<a class=anchor href=#_django></a></h4><div class=paragraph><p>O Django é um framework de licença BSD projetado para permitir que desenvolvedores escrevam aplicações web elegantes e de alto desempenho rapidamente. Ele fornece um mapeador relacional de objeto para que os tipos de dados sejam desenvolvidos como objetos Python. Uma API rica e dinâmica de acesso ao banco de dados é fornecida para os objetos sem que o desenvolvedor tenha que escrever SQL. Ele também fornece um sistema de template extensível para que a lógica do aplicativo seja separada da apresentação HTML.</p></div><div class=paragraph><p>Django depende de <span class=filename>mod_python</span>, e um mecanismo de banco de dados SQL. No FreeBSD, o port <a class=package href=https://cgit.freebsd.org/ports/tree/www/py-django/>www/py-django</a> instala automaticamente o <span class=filename>mod_python</span> e suporta os banco de dados PostgreSQL, MySQL, ou SQLite, com o padrão sendo o SQLite. Para trocar o mecanismo de banco de dados, digite <code>make config</code> dentro do diretório <span class=filename>/usr/ports/www/py-django</span>, então instale o port.</p></div><div class=paragraph><p>Uma vez instalado o Django, a aplicação precisará de um diretório de projeto junto com a configuração Apache para usar o interpretador Python incorporado. Este intérprete é usado para chamar o aplicativo para URLs específicas no site.</p></div><div class=paragraph><p>Para configurar o Apache para que passe a fazer solicitações para determinadas URLs para a aplicação Web, adicione o seguinte ao <span class=filename>httpd.conf</span>, especificando o caminho completo para o diretório do projeto:</p></div><div class="literalblock programlisting"><div class=content><pre>&lt;Location &#34;/&#34;&gt;
    SetHandler python-program
    PythonPath &#34;[&#39;/dir/to/the/django/packages/&#39;] + sys.path&#34;
    PythonHandler django.core.handlers.modpython
    SetEnv DJANGO_SETTINGS_MODULE mysite.settings
    PythonAutoReload On
    PythonDebug On
&lt;/Location&gt;</pre></div></div><div class=paragraph><p>Consulte <a href=https://docs.djangoproject.com>https://docs.djangoproject.com</a> para maiores informações sobre como usar o Django.</p></div></div><div class=sect3><h4 id=_ruby_on_rails>29.8.4.2. Ruby on Rails<a class=anchor href=#_ruby_on_rails></a></h4><div class=paragraph><p>O Ruby on Rails é outro framework de software livre da Web que fornece uma stack de desenvolvimento completa. Ele é otimizado para tornar os desenvolvedores da Web mais produtivos e capazes de criar rapidamente aplicativos poderosos. No FreeBSD, ele pode ser instalado usando o pacote ou port <a class=package href=https://cgit.freebsd.org/ports/tree/www/rubygem-rails/>www/rubygem-rails</a>.</p></div><div class=paragraph><p>Consulte <a href=http://guides.rubyonrails.org>http://guides.rubyonrails.org</a> para maiores informações sobre como usar o Ruby on Rails .</p></div></div></div></div></div><div class=sect1><h2 id=network-ftp>29.9. Protocolo de Transferência de Arquivos (FTP)<a class=anchor href=#network-ftp></a></h2><div class=sectionbody><div class=paragraph><p>O Protocolo de Transferência de Arquivos (FTP) fornece aos usuários uma maneira simples de transferir arquivos para um servidor FTP. O FreeBSD inclui o software do servidor FTP, ftpd, no sistema base.</p></div><div class=paragraph><p>O FreeBSD fornece vários arquivos de configuração para controlar o acesso ao servidor FTP. Esta seção resume esses arquivos. Consulte <a href="https://man.freebsd.org/cgi/man.cgi?query=ftpd&amp;sektion=8&amp;format=html">ftpd(8)</a> para obter mais detalhes sobre o servidor FTP incorporado.</p></div><div class=sect2><h3 id=_configuração>29.9.1. Configuração<a class=anchor href=#_configuração></a></h3><div class=paragraph><p>A etapa de configuração mais importante é decidir quais contas terão permissão para acessar o servidor FTP. Um sistema FreeBSD possui várias contas do sistema que não devem ter acesso ao FTP. A lista de usuários que não permitem acesso FTP pode ser encontrada em <span class=filename>/etc/ftpusers</span>. Por padrão, inclui contas do sistema. Usuários adicionais que não devem ter acesso a FTP podem ser adicionados.</p></div><div class=paragraph><p>Em alguns casos, pode ser desejável restringir o acesso de alguns usuários sem impedi-los completamente de usar o FTP. Isso pode ser feito criando <span class=filename>/etc/ftpchroot</span> como descrito em <a href="https://man.freebsd.org/cgi/man.cgi?query=ftpchroot&amp;sektion=5&amp;format=html">ftpchroot(5)</a>. Este arquivo lista usuários e grupos sujeitos a restrições de acesso a FTP.</p></div><div class=paragraph><p>Para permitir acesso anônimo ao servidor FTP, crie um usuário chamado <code>ftp</code> no sistema FreeBSD. Os usuários poderão então fazer logon no servidor FTP com um nome de usuário <code>ftp</code> ou <code>anonymous</code> . Quando for solicitada a senha, qualquer entrada será aceita, mas por convenção, um endereço de e-mail deverá ser usado como a senha. O servidor FTP chamará <a href="https://man.freebsd.org/cgi/man.cgi?query=chroot&amp;sektion=2&amp;format=html">chroot(2)</a> quando um usuário anônimo efetuar login para restringir o acesso somente ao diretório home do usuário <code>ftp</code>.</p></div><div class=paragraph><p>Existem dois arquivos de texto que podem ser criados para especificar mensagens de boas-vindas a serem exibidas para clientes FTP. O conteúdo de <span class=filename>/etc/ftpwelcome</span> será exibido aos usuários antes que eles atinjam o prompt de login. Após um login bem sucedido, o conteúdo de <span class=filename>/etc/ftpmotd</span> será exibido. Observe que o caminho para esse arquivo é relativo ao ambiente de login, portanto, o conteúdo de <span class=filename>~ftp/etc/ftpmotd</span> seria exibido para usuários anônimos.</p></div><div class=paragraph><p>Uma vez configurado o servidor FTP, defina a variável apropriada em <span class=filename>/etc/rc.conf</span> para iniciar o serviço durante a inicialização:</p></div><div class="literalblock programlisting"><div class=content><pre>ftpd_enable=&#34;YES&#34;</pre></div></div><div class=paragraph><p>Para iniciar o serviço agora:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># service ftpd start</span></code></pre></div></div><div class=paragraph><p>Teste a conexão com o servidor FTP digitando:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>% ftp localhost</code></pre></div></div><div class=paragraph><p>O daemon ftpd usa o <a href="https://man.freebsd.org/cgi/man.cgi?query=syslog&amp;sektion=3&amp;format=html">syslog(3)</a> para registrar mensagens. Por padrão, o daemon de log do sistema gravará mensagens relacionadas a FTP em <span class=filename>/var/log/xferlog</span>. A localização do log do FTP pode ser modificada alterando a seguinte linha no <span class=filename>/etc/syslog.conf</span>:</p></div><div class="literalblock programlisting"><div class=content><pre>ftp.info      /var/log/xferlog</pre></div></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Esteja ciente dos possíveis problemas envolvidos na execução de um servidor FTP anônimo. Em particular, pense duas vezes antes de permitir que usuários anônimos façam upload de arquivos. Pode acontecer que o site FTP se torne um fórum para o comércio de software comercial não licenciado ou pior. Se uploads anônimos de FTP forem necessários, verifique as permissões para que esses arquivos não possam ser lidos por outros usuários anônimos até que sejam revisados por um administrador.</p></div></td></tr></tbody></table></div></div></div></div><div class=sect1><h2 id=network-samba>29.10. Serviços de arquivos e impressão para clientes Microsoft™Windows™ Clients (Samba)<a class=anchor href=#network-samba></a></h2><div class=sectionbody><div class=paragraph><p>Samba é um popular pacote de software de código aberto que fornece serviços de arquivo e impressão usando o protocolo SMB/CIFS. Este protocolo está incorporado nos sistemas Microsoft™Windows™. Ele pode ser adicionado a sistemas não Microsoft™Windows™ instalando as bibliotecas-cliente Samba. O protocolo permite que os clientes acessem dados e impressoras compartilhadas. Esses compartilhamentos podem ser mapeados como uma unidade de disco local e as impressoras compartilhadas podem ser usadas como se fossem impressoras locais.</p></div><div class=paragraph><p>No FreeBSD, as bibliotecas cliente do Samba podem ser instaladas usando o port ou pacote <a class=package href=https://cgit.freebsd.org/ports/tree/net/samba410/>net/samba410</a>. O cliente fornece a capacidade de um sistema FreeBSD acessar compartilhamentos de SMB/CIFS em uma rede Microsoft™Windows™.</p></div><div class=paragraph><p>Um sistema FreeBSD também pode ser configurado para atuar como um servidor Samba instalando o port ou pacote <a class=package href=https://cgit.freebsd.org/ports/tree/net/samba410/>net/samba410</a>. Isso permite que o administrador crie compartilhamentos de SMB/CIFS no sistema FreeBSD que podem ser acessados por clientes executando Microsoft™Windows™ ou as bibliotecas do cliente Samba.</p></div><div class=sect2><h3 id=_configuração_do_servidor>29.10.1. Configuração do Servidor<a class=anchor href=#_configuração_do_servidor></a></h3><div class=paragraph><p>O Samba é configurado em <span class=filename>/usr/local/etc/smb4.conf</span>. Este arquivo deve ser criado antes que o Samba possa ser usado.</p></div><div class=paragraph><p>Um simples <span class=filename>smb4.conf</span> para compartilhar diretórios e impressoras com clientes Windows™ em um grupo de trabalho é mostrado aqui. Para configurações mais complexas envolvendo LDAP ou Active Directory, é mais fácil usar o <a href="https://man.freebsd.org/cgi/man.cgi?query=samba-tool&amp;sektion=8&amp;format=html">samba-tool(8)</a> para criar o <span class=filename>smb4.conf</span>.</p></div><div class="literalblock programlisting"><div class=content><pre>[global]
workgroup = WORKGROUP
server string = Samba Server Version %v
netbios name = ExampleMachine
wins support = Yes
security = user
passdb backend = tdbsam

# Example: share /usr/src accessible only to &#39;developer&#39; user
[src]
path = /usr/src
valid users = developer
writable  = yes
browsable = yes
read only = no
guest ok = no
public = no
create mask = 0666
directory mask = 0755</pre></div></div><div class=sect3><h4 id=_configurações_globais>29.10.1.1. Configurações Globais<a class=anchor href=#_configurações_globais></a></h4><div class=paragraph><p>As configurações que descrevem a rede são adicionadas em <span class=filename>/usr/local/etc/smb4.conf</span>:</p></div><div class=dlist><dl><dt class=hdlist1><code>workgroup</code></dt><dd><p>O nome do grupo de trabalho a ser servido.</p></dd><dt class=hdlist1><code>netbios name</code></dt><dd><p>O nome NetBIOS pelo qual um servidor Samba é conhecido. Por padrão, é o mesmo que o primeiro componente do nome do DNS do host.</p></dd><dt class=hdlist1><code>server string</code></dt><dd><p>A string que será exibida na saída de <code>net view</code> e algumas outras ferramentas de rede que buscam exibir texto descritivo sobre o servidor.</p></dd><dt class=hdlist1><code>wins support</code></dt><dd><p>Se o Samba funcionará como um servidor WINS. Não habilite o suporte para WINS em mais de um servidor na rede.</p></dd></dl></div></div><div class=sect3><h4 id=_configurações_de_segurança>29.10.1.2. Configurações de Segurança<a class=anchor href=#_configurações_de_segurança></a></h4><div class=paragraph><p>As configurações mais importantes em <span class=filename>/usr/local/etc/smb4.conf</span> são o modelo de segurança e o formato de senha de backend. Essas diretivas controlam as opções:</p></div><div class=dlist><dl><dt class=hdlist1><code>security</code></dt><dd><p>As configurações mais comuns são <code>security=share</code> e <code>security=user</code>. Se os clientes usarem nomes de usuários que sejam os mesmos nomes de usuários na máquina do FreeBSD, a segurança no nível do usuário deve ser usada. Essa é a política de segurança padrão e exige que os clientes façam logon pela primeira vez antes de poderem acessar recursos compartilhados.</p><div class=paragraph><p>Na segurança em nível de compartilhamento, os clientes não precisam efetuar logon no servidor com um nome de usuário e senha válidos antes de tentar se conectar a um recurso compartilhado. Este era o modelo de segurança padrão para versões mais antigas do Samba.</p></div></dd><dt class=hdlist1><code>passdb backend</code></dt><dd><p>O Samba possui vários modelos de autenticação de backend diferentes. Os clientes podem ser autenticados com LDAP, NIS+, um banco de dados SQL ou um arquivo de senha modificado. O método de autenticação recomendado, <code>tdbsam</code>, é ideal para redes simples e é abordado aqui. Para redes maiores ou mais complexas, o <code>ldapsam</code> é recomendado. <code>smbpasswd</code> foi o padrão anterior e agora está obsoleto.</p></dd></dl></div></div><div class=sect3><h4 id=_usuários_do_samba>29.10.1.3. Usuários do Samba<a class=anchor href=#_usuários_do_samba></a></h4><div class=paragraph><p>As contas de usuário do FreeBSD devem ser mapeadas para o banco de dados <code>SambaSAMAccount</code> para que os clientes Windows™ acessem o compartilhamento. Mapear contas de usuários existentes do FreeBSD usando <a href="https://man.freebsd.org/cgi/man.cgi?query=pdbedit&amp;sektion=8&amp;format=html">pdbedit(8)</a>:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># pdbedit -a username</span></code></pre></div></div><div class=paragraph><p>Esta seção mencionou apenas as configurações mais usadas. Consulte a <a href=https://wiki.samba.org>Wiki Oficial do Samba</a> para obter informações adicionais sobre as opções de configuração disponíveis.</p></div></div></div><div class=sect2><h3 id=_iniciando_o_samba>29.10.2. Iniciando o Samba<a class=anchor href=#_iniciando_o_samba></a></h3><div class=paragraph><p>Para habilitar o Samba no momento da inicialização, adicione a seguinte linha ao <span class=filename>/etc/rc.conf</span>:</p></div><div class="literalblock programlisting"><div class=content><pre>samba_server_enable=&#34;YES&#34;</pre></div></div><div class=paragraph><p>Para iniciar o Samba agora:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># service samba_server start</span>
Performing sanity check on Samba configuration: OK
Starting nmbd.
Starting smbd.</code></pre></div></div><div class=paragraph><p>O Samba consiste em três daemons separados. Os daemons nmbd e smbd são iniciados por <code>samba_enable</code>. Se resolução de nomes winbind também é necessária, defina:</p></div><div class="literalblock programlisting"><div class=content><pre>winbindd_enable=&#34;YES&#34;</pre></div></div><div class=paragraph><p>O Samba pode ser interrompido a qualquer momento digitando:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># service samba_server stop</span></code></pre></div></div><div class=paragraph><p>O Samba é um conjunto de software complexo com funcionalidade que permite ampla integração com as redes Microsoft™Windows™. Para mais informações sobre a funcionalidade além da configuração básica descrita aqui, consulte <a href=https://www.samba.org>https://www.samba.org</a>.</p></div></div></div></div><div class=sect1><h2 id=network-ntp>29.11. Sincronização de Relógio com NTP<a class=anchor href=#network-ntp></a></h2><div class=sectionbody><div class=paragraph><p>Com o tempo, o relógio de um computador está propenso a se desviar. Isso é problemático, pois muitos serviços de rede exigem que os computadores em uma rede compartilhem o mesmo tempo exato. Tempo preciso também é necessário para garantir que os registros de data e hora dos arquivos permaneçam consistentes. O protocolo de horário da rede (NTP) é uma maneira de fornecer precisão de relógio em uma rede.</p></div><div class=paragraph><p>O FreeBSD inclui o <a href="https://man.freebsd.org/cgi/man.cgi?query=ntpd&amp;sektion=8&amp;format=html">ntpd(8)</a> o qual pode ser configurado para consultar outros servidores NTP para sincronizar o relógio nessa máquina ou para fornecer serviços de horário para outros computadores na rede.</p></div><div class=paragraph><p>Esta seção descreve como configurar o ntpd no FreeBSD. Mais documentação pode ser encontrada em <span class=filename>/usr/shared/doc/ntp/</span> no formato HTML.</p></div><div class=sect2><h3 id=_configuração_de_ntp>29.11.1. Configuração de NTP<a class=anchor href=#_configuração_de_ntp></a></h3><div class=paragraph><p>No FreeBSD, o ntpd nativo pode ser usado para sincronizar o relógio do sistema. O Ntpd é configurado usando variáveis no <a href="https://man.freebsd.org/cgi/man.cgi?query=rc.conf&amp;sektion=5&amp;format=html">rc.conf(5)</a> e no <span class=filename>/etc/ntp.conf</span>, conforme detalhado nas seções a seguir.</p></div><div class=paragraph><p>O Ntpd se comunica com seus network peers usando pacotes UDP. Quaisquer firewalls entre sua máquina e seus NTP peers devem ser configurados para permitir a entrada e saída de pacotes UDP na porta 123.</p></div><div class=sect3><h4 id=_o_arquivo_etcntp_conf>29.11.1.1. O arquivo <span class=filename>/etc/ntp.conf</span><a class=anchor href=#_o_arquivo_etcntp_conf></a></h4><div class=paragraph><p>O Ntpd faz a leitura do <span class=filename>/etc/ntp.conf</span> para determinar quais servidores NTP que ele deve consultar. É recomendável escolher vários servidores NTP, caso um dos servidores se torne inacessível ou seu relógio torne-se não confiável. Como o ntpd recebe respostas, ele favorece servidores confiáveis em vez dos menos confiáveis. Os servidores consultados podem ser locais na rede, fornecidos por um ISP ou selecionados a partir de uma <a href=http://support.ntp.org/bin/view/Servers/WebHome>lista online de servidores NTP publicamente acessíveis</a>. Ao escolher um servidor NTP público, selecione um servidor geograficamente próximo e revise sua política de uso. A palavra-chave <code>pool</code> de configuração seleciona um ou mais servidores de um pool de servidores. Está disponível uma <a href=http://support.ntp.org/bin/view/Servers/NTPPoolServers>lista online de pools NTP publicamente acessíveis</a>, organizada por área geográfica. Além disso, o FreeBSD fornece um pool patrocinado pelo projeto, <code>0.freebsd.pool.ntp.org</code>.</p></div><div class=exampleblock><div class=title>Exemplo 3. Exemplo de <span class=filename>/etc/ntp.conf</span></div><div class=content><div class=paragraph><p>Este é um exemplo simples de um arquivo <span class=filename>ntp.conf</span>. Ele pode ser usado com segurança como está; ele contém as opções <code>restrict</code> recomendadas para operação em uma conexão de rede pública.</p></div><div class="literalblock programlisting"><div class=content><pre># Disallow ntpq control/query access.  Allow peers to be added only
# based on pool and server statements in this file.
restrict default limited kod nomodify notrap noquery nopeer
restrict source  limited kod nomodify notrap noquery

# Allow unrestricted access from localhost for queries and control.
restrict 127.0.0.1
restrict ::1

# Add a specific server.
server ntplocal.example.com iburst

# Add FreeBSD pool servers until 3-6 good servers are available.
tos minclock 3 maxclock 6
pool 0.freebsd.pool.ntp.org iburst

# Use a local leap-seconds file.
leapfile &#34;/var/db/ntpd.leap-seconds.list&#34;</pre></div></div></div></div><div class=paragraph><p>O formato deste arquivo é descrito em <a href="https://man.freebsd.org/cgi/man.cgi?query=ntp.conf&amp;sektion=5&amp;format=html">ntp.conf(5)</a>. As descrições abaixo fornecem uma visão geral rápida apenas das palavras-chave usadas no arquivo de exemplo acima.</p></div><div class=paragraph><p>Por padrão, um servidor NTP pode ser acessado de qualquer host da rede. A palavra-chave <code>restrict</code> controla quais sistemas podem acessar o servidor. Múltiplas entradas <code>restrict</code> são suportadas, cada uma refinando as restrições fornecidas nas instruções anteriores. Os valores mostrados no exemplo concedem ao sistema local o acesso completo à consulta e controle, enquanto permitem aos sistemas remotos apenas a capacidade de consultar o horário. Para obter mais detalhes, consulte a subseção <code>Access Control Support</code> de <a href="https://man.freebsd.org/cgi/man.cgi?query=ntp.conf&amp;sektion=5&amp;format=html">ntp.conf(5)</a>.</p></div><div class=paragraph><p>A palavra-chave <code>server</code> especifica um único servidor para consulta. O arquivo pode conter várias palavras-chave server, com um servidor listado em cada linha. A palavra-chave <code>pool</code> especifica um pool de servidores. O Ntpd adicionará um ou mais servidores desse pool, conforme necessário, para atingir o número de peers especificado usando o valor <code>tos minclock</code>. A palavra-chave <code>iburst</code> direciona o ntpd para executar um burst de oito trocas rápidas de pacotes com um servidor quando o contato é estabelecido pela primeira vez, para ajudar a sincronizar rapidamente a hora do sistema.</p></div><div class=paragraph><p>A palavra-chave <code>leapfile</code> especifica o local de um arquivo que contém informações sobre segundos bissextos. O arquivo é atualizado automaticamente pelo <a href="https://man.freebsd.org/cgi/man.cgi?query=periodic&amp;sektion=8&amp;format=html">periodic(8)</a>. O local do arquivo especificado por esta palavra-chave deve corresponder ao local definido na variável <code>ntp_db_leapfile</code> em <span class=filename>/etc/rc.conf</span>.</p></div></div><div class=sect3><h4 id=_entradas_ntp_no_etcrc_conf>29.11.1.2. Entradas NTP no <span class=filename>/etc/rc.conf</span><a class=anchor href=#_entradas_ntp_no_etcrc_conf></a></h4><div class=paragraph><p>Defina <code>ntpd_enable=YES</code> para iniciar o ntpd no momento do boot do sistema. Depois que o <code>ntpd_enable=YES</code> for adicionado ao <span class=filename>/etc/rc.conf</span>, o ntpd poderá ser iniciado imediatamente sem reiniciar o sistema, digitando:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># service ntpd start</span></code></pre></div></div><div class=paragraph><p>Somente <code>ntpd_enable</code> deve ser configurado para usar o ntpd. As variáveis <span class=filename>rc.conf</span> listadas abaixo também podem ser definidas conforme necessário.</p></div><div class=paragraph><p>Defina <code>ntpd_sync_on_start=YES</code> para permitir que o ntpd adiante o relógio, uma vez na inicialização. Normalmente, o ntpd registra uma mensagem de erro e se finaliza se o relógio estiver dessincronizado por mais de 1000 segundos. Essa opção é especialmente útil em sistemas sem um relógio em tempo real com bateria.</p></div><div class=paragraph><p>Defina <code>ntpd_oomprotect=YES</code> para proteger o serviço ntpd de ser finalizado pelo sistema quando ele tentar se recuperar de uma condição de Falta de Nemória (OOM).</p></div><div class=paragraph><p>Defina <code>ntpd_config=</code> para o local de um arquivo <span class=filename>ntp.conf</span> alternativo.</p></div><div class=paragraph><p>Defina <code>ntpd_flags=</code> para conter outras flags ntpd conforme necessário, mas evite usar as flags gerenciadas internamente pelo <span class=filename>/etc/rc.d/ntpd</span>:</p></div><div class=ulist><ul><li><p><code>-p</code> (local do arquivo pid)</p></li><li><p><code>-c</code> (configure <code>ntpd_config=</code> como alternativa)</p></li></ul></div></div><div class=sect3><h4 id=_o_ntpd_e_o_usuário_não_privilegiado_ntpd>29.11.1.3. O Ntpd e o usuário não privilegiado <code>ntpd</code><a class=anchor href=#_o_ntpd_e_o_usuário_não_privilegiado_ntpd></a></h4><div class=paragraph><p>O Ntpd no FreeBSD pode ser iniciado e executado como um usuário não privilegiado. Para isso, é necessário o módulo de política <a href="https://man.freebsd.org/cgi/man.cgi?query=mac_ntpd&amp;sektion=4&amp;format=html">mac_ntpd(4)</a>. O script de inicialização <span class=filename>/etc/rc.d/ntpd</span> examina primeiro a configuração do NTP. Se possível, ele carrega o módulo <code>mac_ntpd</code> e inicia o ntpd como um usuário não vinculado <code>ntpd</code> (user id 123). Para evitar problemas com o acesso a arquivos e diretórios, o script de inicialização não iniciará automaticamente o ntpd como <code>ntpd</code> quando a configuração contiver quaisquer opções relacionadas a arquivos.</p></div><div class=paragraph><p>A presença de qualquer um dos itens a seguir em <code>ntpd_flags</code> requer configuração manual, conforme descrito abaixo, para ser executada como o usuário <code>ntpd</code> user:</p></div><div class=ulist><ul><li><p>-f or --driftfile</p></li><li><p>-i or --jaildir</p></li><li><p>-k or --keyfile</p></li><li><p>-l or --logfile</p></li><li><p>-s or --statsdir</p></li></ul></div><div class=paragraph><p>A presença de qualquer uma das seguintes palavras-chave no <span class=filename>ntp.conf</span> requer configuração manual, conforme descrito abaixo, para ser executado como usuário <code>ntpd</code>:</p></div><div class=ulist><ul><li><p>crypto</p></li><li><p>driftfile</p></li><li><p>key</p></li><li><p>logdir</p></li><li><p>statsdir</p></li></ul></div><div class=paragraph><p>Para configurar manualmente o ntpd para ser executado como usuário <code>ntpd</code>, você deve:</p></div><div class=ulist><ul><li><p>Certifique-se de que o usuário <code>ntpd</code> tenha acesso a todos os arquivos e diretórios especificados na configuração.</p></li><li><p>Se certifique para que o módulo <code>mac_ntpd</code> seja carregado ou compilado no kernel. Consulte <a href="https://man.freebsd.org/cgi/man.cgi?query=mac_ntpd&amp;sektion=4&amp;format=html">mac_ntpd(4)</a> para obter detalhes.</p></li><li><p>Defina <code>ntpd_user="ntpd"</code> no <span class=filename>/etc/rc.conf</span></p></li></ul></div></div></div><div class=sect2><h3 id=_usando_ntp_com_uma_conexão_ppp>29.11.2. Usando NTP com uma Conexão PPP<a class=anchor href=#_usando_ntp_com_uma_conexão_ppp></a></h3><div class=paragraph><p>O ntpd não precisa de uma conexão permanente com a Internet para funcionar corretamente. No entanto, se uma conexão PPP estiver configurada para discar sob demanda, o tráfego de NTP deverá ser impedido de disparar uma discagem ou manter a conexão ativa. Isso pode ser configurado com as diretivas <code>filter</code> em <span class=filename>/etc/ppp/ppp.conf</span>. Por exemplo:</p></div><div class="literalblock programlisting"><div class=content><pre>set filter dial 0 deny udp src eq 123
# Prevent NTP traffic from initiating dial out
set filter dial 1 permit 0 0
set filter alive 0 deny udp src eq 123
# Prevent incoming NTP traffic from keeping the connection open
set filter alive 1 deny udp dst eq 123
# Prevent outgoing NTP traffic from keeping the connection open
set filter alive 2 permit 0/0 0/0</pre></div></div><div class=paragraph><p>Para mais detalhes, consulte a seção <code>PACKET FILTERING</code> em <a href="https://man.freebsd.org/cgi/man.cgi?query=ppp&amp;sektion=8&amp;format=html">ppp(8)</a> e os exemplos em <span class=filename>/usr/shared/examples/ppp/</span>.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Alguns provedores de acesso à Internet bloqueiam portas de números baixos, impedindo o funcionamento do NTP, pois as respostas nunca chegam à máquina.</p></div></td></tr></tbody></table></div></div></div></div><div class=sect1><h2 id=network-iscsi>29.12. Inicializador iSCSI e Configuração Alvo<a class=anchor href=#network-iscsi></a></h2><div class=sectionbody><div class=paragraph><p>iSCSI é uma maneira de compartilhar o armazenamento em uma rede. Ao contrário do NFS, que funciona no nível do sistema de arquivos, o iSCSI funciona no nível do dispositivo de bloco.</p></div><div class=paragraph><p>Na terminologia iSCSI, o sistema que compartilha o armazenamento é conhecido como <em>alvo</em>. O armazenamento pode ser um disco físico ou uma área representando vários discos ou uma parte de um disco físico. Por exemplo, se os discos estiverem formatados com ZFS, um zvol poderá ser criado para ser usado como armazenamento iSCSI.</p></div><div class=paragraph><p>Os clientes que acessam o armazenamento do iSCSI são chamados de <em>iniciadores</em>. Para os iniciadores, o armazenamento disponível por meio do iSCSI aparece como um disco bruto, não formatado, conhecido como LUN. Nós de dispositivo para o disco aparecem em <span class=filename>/dev/</span> e o dispositivo deve ser formatado e montado separadamente.</p></div><div class=paragraph><p>O FreeBSD fornece um alvo e iniciador nativo, baseado em kernel iSCSI. Esta seção descreve como configurar um sistema FreeBSD como um alvo ou um iniciador.</p></div><div class=sect2><h3 id=network-iscsi-target>29.12.1. Configurando um Alvo iSCSI<a class=anchor href=#network-iscsi-target></a></h3><div class=paragraph><p>Para configurar um alvo iSCSI, crie o arquivo de configuração <span class=filename>/etc/ctl.conf</span>, adicione uma linha ao arquivo <span class=filename>/etc/rc.conf</span> para certificar-se de que o daemon <a href="https://man.freebsd.org/cgi/man.cgi?query=ctld&amp;sektion=8&amp;format=html">ctld(8)</a> seja iniciado automaticamente na inicialização e, em seguida, inicie-o.</p></div><div class=paragraph><p>A seguir, um exemplo de um arquivo de configuração simples <span class=filename>/etc/ctl.conf</span>. Consulte <a href="https://man.freebsd.org/cgi/man.cgi?query=ctl.conf&amp;sektion=5&amp;format=html">ctl.conf(5)</a> para obter uma descrição mais completa das opções disponíveis deste arquivo.</p></div><div class="literalblock programlisting"><div class=content><pre>portal-group pg0 {
	discovery-auth-group no-authentication
	listen 0.0.0.0
	listen [::]
}

target iqn.2012-06.com.example:target0 {
	auth-group no-authentication
	portal-group pg0

	lun 0 {
		path /data/target0-0
		size 4G
	}
}</pre></div></div><div class=paragraph><p>A primeira entrada define o grupo de portais <code>pg0</code>. Grupos de portal definem quais endereços de rede o daemon <a href="https://man.freebsd.org/cgi/man.cgi?query=ctld&amp;sektion=8&amp;format=html">ctld(8)</a> irá escutar. A entrada <code>discovery-auth-group no-authentication</code> indica que qualquer iniciador tem permissão para executar descoberta de alvo iSCSI sem autenticação. As linhas três e quatro configuram <a href="https://man.freebsd.org/cgi/man.cgi?query=ctld&amp;sektion=8&amp;format=html">ctld(8)</a> para escutar em todos os endereços IPv4 (<code>listen 0.0.0.0</code>) e IPv6 (<code>listen [::]</code>) na porta padrão 3260.</p></div><div class=paragraph><p>Não é necessário definir um grupo de portais, pois há um grupo de portais interno chamado <code>default</code>. Nesse caso, a diferença entre <code>default</code> e <code>pg0</code> é que com <code>default</code>, a descoberta de alvo é sempre negada, enquanto com <code>pg0</code>, é sempre permitido.</p></div><div class=paragraph><p>A segunda entrada define um único alvo. O alvo tem dois significados possíveis: uma máquina que atende iSCSI ou um grupo nomeado de LUNs. Este exemplo usa o último significado, onde <code>iqn.2012-06.com.example:target0</code> é o nome do alvo. Este nome de alvo é adequado para fins de teste. Para uso real, altere <code>com.example</code> para o nome de domínio real, invertido. O <code>2012-06</code> representa o ano e o mês de aquisição do controle desse nome de domínio, e <code>target0</code> pode ser qualquer valor. Qualquer número de alvos pode ser definido neste arquivo de configuração.</p></div><div class=paragraph><p>A linha <code>auth-group no-authentication</code> permite que todos os iniciadores se conectem ao alvo especificado e <code>portal-group pg0</code> torna o alvo acessível através do grupo do portal <code>pg0</code>.</p></div><div class=paragraph><p>A próxima seção define o LUN. Para o iniciador, cada LUN será visível como um dispositivo de disco separado. Múltiplos LUNs podem ser definidos para cada destino. Cada LUN é identificado por um número, onde LUN 0 é obrigatório. A linha <code>path/data/target0-0</code> define o caminho completo para um arquivo ou zvol que suporta o LUN. Esse caminho deve existir antes de iniciar <a href="https://man.freebsd.org/cgi/man.cgi?query=ctld&amp;sektion=8&amp;format=html">ctld(8)</a>. A segunda linha é opcional e especifica o tamanho do LUN.</p></div><div class=paragraph><p>Em seguida, para ter certeza que o daemon <a href="https://man.freebsd.org/cgi/man.cgi?query=ctld&amp;sektion=8&amp;format=html">ctld(8)</a> foi iniciado no boot, adicione esta linha ao arquivo <span class=filename>/etc/rc.conf</span>:</p></div><div class="literalblock programlisting"><div class=content><pre>ctld_enable=&#34;YES&#34;</pre></div></div><div class=paragraph><p>Para iniciar o <a href="https://man.freebsd.org/cgi/man.cgi?query=ctld&amp;sektion=8&amp;format=html">ctld(8)</a> agora, execute este comando:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># service ctld start</span></code></pre></div></div><div class=paragraph><p>Quando o daemon <a href="https://man.freebsd.org/cgi/man.cgi?query=ctld&amp;sektion=8&amp;format=html">ctld(8)</a> é iniciado, ele lê o arquivo <span class=filename>/etc/ctl.conf</span>. Se este arquivo for editado depois que o daemon iniciar, use este comando para que as mudanças entrem em vigor imediatamente:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># service ctld reload</span></code></pre></div></div><div class=sect3><h4 id=_autenticação>29.12.1.1. Autenticação<a class=anchor href=#_autenticação></a></h4><div class=paragraph><p>O exemplo anterior é inerentemente inseguro, pois não usa autenticação, concedendo a qualquer um acesso total a todos os alvos. Para exigir um nome de usuário e senha para acessar os alvos, modifique a configuração da seguinte maneira:</p></div><div class="literalblock programlisting"><div class=content><pre>auth-group ag0 {
	chap username1 secretsecret
	chap username2 anothersecret
}

portal-group pg0 {
	discovery-auth-group no-authentication
	listen 0.0.0.0
	listen [::]
}

target iqn.2012-06.com.example:target0 {
	auth-group ag0
	portal-group pg0
	lun 0 {
		path /data/target0-0
		size 4G
	}
}</pre></div></div><div class=paragraph><p>A seção <code>auth-group</code> define os pares de nome de usuário e senha. Um inicializador tentando se conectar a <code>iqn.2012-06.com.example:target0</code> deve primeiro especificar um nome de usuário e senha definidos. No entanto, a descoberta do alvo ainda é permitida sem autenticação. Para exigir autenticação de descoberta de alvo, defina <code>discovery-auth-group</code> como um nome <code>auth-group</code> definido em vez de <code>no-authentication</code>.</p></div><div class=paragraph><p>É comum definir um único alvo exportado para cada inicializador. Como um atalho para a sintaxe acima, o nome de usuário e a senha podem ser especificados diretamente na entrada do alvo:</p></div><div class="literalblock programlisting"><div class=content><pre>target iqn.2012-06.com.example:target0 {
	portal-group pg0
	chap username1 secretsecret

	lun 0 {
		path /data/target0-0
		size 4G
	}
}</pre></div></div></div></div><div class=sect2><h3 id=network-iscsi-initiator>29.12.2. Configurando um Inicializador iSCSI<a class=anchor href=#network-iscsi-initiator></a></h3><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>O inicializador iSCSI descrito nesta seção é suportado a partir do FreeBSD 10.0-RELEASE. Para usar o inicializador iSCSI disponível em versões mais antigas, consulte <a href="https://man.freebsd.org/cgi/man.cgi?query=iscontrol&amp;sektion=8&amp;format=html">iscontrol(8)</a>.</p></div></td></tr></tbody></table></div><div class=paragraph><p>O inicializador iSCSI requer que o daemon <a href="https://man.freebsd.org/cgi/man.cgi?query=iscsid&amp;sektion=8&amp;format=html">iscsid(8)</a> esteja em execução. Este daemon não usa um arquivo de configuração. Para iniciá-lo automaticamente na inicialização, adicione esta linha ao arquivo <span class=filename>/etc/rc.conf</span>:</p></div><div class="literalblock programlisting"><div class=content><pre>iscsid_enable=&#34;YES&#34;</pre></div></div><div class=paragraph><p>Para iniciar <a href="https://man.freebsd.org/cgi/man.cgi?query=iscsid&amp;sektion=8&amp;format=html">iscsid(8)</a> agora, execute este comando:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># service iscsid start</span></code></pre></div></div><div class=paragraph><p>Conectar-se a um alvo pode ser feito com ou sem um arquivo <span class=filename>/etc/iscsi.conf</span> de configuração. Esta seção demonstra os dois tipos de conexões.</p></div><div class=sect3><h4 id=_conectando_se_a_um_alvo_sem_um_arquivo_de_configuração>29.12.2.1. Conectando-se a um Alvo sem um Arquivo de Configuração<a class=anchor href=#_conectando_se_a_um_alvo_sem_um_arquivo_de_configuração></a></h4><div class=paragraph><p>Para conectar um inicializador a um único alvo, especifique o endereço IP do portal e o nome do alvo:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># iscsictl -A -p 10.10.10.10 -t iqn.2012-06.com.example:target0</span></code></pre></div></div><div class=paragraph><p>Para verificar se a conexão foi bem sucedida, execute <code>iscsictl</code> sem nenhum argumento. A saída deve ser semelhante a esta:</p></div><div class="literalblock programlisting"><div class=content><pre>Target name                                     Target portal   State
iqn.2012-06.com.example:target0                 10.10.10.10     Connected: da0</pre></div></div><div class=paragraph><p>Neste exemplo, a sessão iSCSI foi estabelecida com sucesso, com <span class=filename>/dev/da0</span> representando o LUN anexado. Se o destino <code>iqn.2012-06.com.example:target0</code> exportar mais de um LUN, vários nós de dispositivos serão mostrados nessa seção da saída:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>Connected: da0 da1 da2.</code></pre></div></div><div class=paragraph><p>Quaisquer erros serão relatados na saída, assim como os logs do sistema. Por exemplo, esta mensagem normalmente significa que o daemon <a href="https://man.freebsd.org/cgi/man.cgi?query=iscsid&amp;sektion=8&amp;format=html">iscsid(8)</a> não está em execução:</p></div><div class="literalblock programlisting"><div class=content><pre>Target name                                     Target portal   State
iqn.2012-06.com.example:target0                 10.10.10.10     Waiting for iscsid(8)</pre></div></div><div class=paragraph><p>A mensagem a seguir sugere um problema de rede, como uma porta ou endereço IP incorreto:</p></div><div class="literalblock programlisting"><div class=content><pre>Target name                                     Target portal   State
iqn.2012-06.com.example:target0                 10.10.10.11     Connection refused</pre></div></div><div class=paragraph><p>Esta mensagem significa que o nome do alvo especificado está errado:</p></div><div class="literalblock programlisting"><div class=content><pre>Target name                                     Target portal   State
iqn.2012-06.com.example:target0                 10.10.10.10     Not found</pre></div></div><div class=paragraph><p>Esta mensagem significa que o alvo requer autenticação:</p></div><div class="literalblock programlisting"><div class=content><pre>Target name                                     Target portal   State
iqn.2012-06.com.example:target0                 10.10.10.10     Authentication failed</pre></div></div><div class=paragraph><p>Para especificar um nome de usuário e uma senha de CHAP, use esta sintaxe:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># iscsictl -A -p 10.10.10.10 -t iqn.2012-06.com.example:target0 -u user -s secretsecret</span></code></pre></div></div></div><div class=sect3><h4 id=_conectando_se_a_um_alvo_com_um_arquivo_de_configuração>29.12.2.2. Conectando-se a um Alvo com um Arquivo de Configuração<a class=anchor href=#_conectando_se_a_um_alvo_com_um_arquivo_de_configuração></a></h4><div class=paragraph><p>Para se conectar usando um arquivo de configuração, crie o <span class=filename>/etc/iscsi.conf</span> com o seguinte conteúdo:</p></div><div class="literalblock programlisting"><div class=content><pre>t0 {
	TargetAddress   = 10.10.10.10
	TargetName      = iqn.2012-06.com.example:target0
	AuthMethod      = CHAP
	chapIName       = user
	chapSecret      = secretsecret
}</pre></div></div><div class=paragraph><p>O <code>t0</code> especifica um nickname para a seção do arquivo de configuração. Ele será usado pelo iniciador para especificar qual configuração usar. As outras linhas especificam os parâmetros a serem usados durante a conexão. O <code>TargetAddress</code> e <code>TargetName</code> são obrigatórios, enquanto as outras opções são opcionais. Neste exemplo, o nome de usuário e a senha do CHAP são mostrados.</p></div><div class=paragraph><p>Para se conectar ao alvo definido, especifique o apelido:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># iscsictl -An t0</span></code></pre></div></div><div class=paragraph><p>Como alternativa, para conectar-se a todos os alvos definidos no arquivo de configuração, use:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># iscsictl -Aa</span></code></pre></div></div><div class=paragraph><p>Para fazer com que o inicializador se conecte automaticamente a todos os alvos no arquivo <span class=filename>/etc/iscsi.conf</span>, adicione o seguinte ao arquivo <span class=filename>/etc/rc.conf</span>:</p></div><div class="literalblock programlisting"><div class=content><pre>iscsictl_enable=&#34;YES&#34;
iscsictl_flags=&#34;-Aa&#34;</pre></div></div></div></div></div></div></div><hr><div class=last-modified><p><strong>Última alteração em</strong>: 9 de março de 2024 por <a href="https://cgit.freebsd.org/doc/commit/?id=6199af92e7" target=_blank>Danilo G. Baio</a></p></div><div class=buttons><div class=prev><i class="fa fa-angle-left" aria-hidden=true title=Anterior></i><div class=container><a href=http://172.16.201.134:1313/pt-br/books/handbook/mail class=direction>Anterior</a></div></div><div class=home><i class="fa fa-home" aria-hidden=true title=Início></i><div class=container><a href=../ class=direction>Início</a></div></div><div class=next><div class=container><a href=http://172.16.201.134:1313/pt-br/books/handbook/firewalls class=direction>Próximo</a></div><i class="fa fa-angle-right" aria-hidden=true title=Próximo></i></div></div><label class="hidden book-menu-overlay" for=menu-control></label></div><aside class=toc><div class=toc-content><h3>Índice</h3><nav id=TableOfContents><ul><li><a href=#network-servers-synopsis>29.1. Sinopse</a></li><li><a href=#network-inetd>29.2. O super-servidor inetd</a></li><li><a href=#network-nfs>29.3. Network File System (NFS)</a></li><li><a href=#network-nis>29.4. Sistema de Informação de Rede (NIS)</a></li><li><a href=#network-ldap>29.5. Protocolo leve de acesso de diretório ( LDAP )</a></li><li><a href=#network-dhcp>29.6. Protocolo de configuração dinâmica de hosts (DHCP)</a></li><li><a href=#network-dns>29.7. Sistema de Nomes de Domínio (DNS)</a></li><li><a href=#network-apache>29.8. Servidor HTTP Apache</a></li><li><a href=#network-ftp>29.9. Protocolo de Transferência de Arquivos (FTP)</a></li><li><a href=#network-samba>29.10. Serviços de arquivos e impressão para clientes Microsoft™Windows™ Clients (Samba)</a></li><li><a href=#network-ntp>29.11. Sincronização de Relógio com NTP</a></li><li><a href=#network-iscsi>29.12. Inicializador iSCSI e Configuração Alvo</a></li></ul></nav><hr><div class=resources><h3>Recursos</h3><ul class=contents><li><i class="fa fa-file-pdf-o" aria-hidden=true title="Download PDF"></i><a href=https://download.freebsd.org/doc/pt-br/books/handbook/handbook_pt-br.pdf>Download PDF</a></li><li><i class="fa fa-pencil-square-o" aria-hidden=true title="Edite essa página"></i><a href=https://github.com/freebsd/freebsd-doc/blob/main/documentation/content/pt-br/_index target=_blank>Edite essa página</a></li></ul></div></div></aside><a class=to-top href=#top><i class="fa fa-arrow-circle-up" aria-hidden=true></i></a></main><footer><div class=footer-container><section class=logo-column><img src=http://172.16.201.134:1313/images/FreeBSD-colors.svg width=160 height=50 alt="FreeBSD logo"><div class=options-container><div class=language-container><a id=languages href=http://172.16.201.134:1313/pt-br/languages><img src=http://172.16.201.134:1313/images/language.png class=language-image alt="Escolha o idioma">
<span>Brazilian Portuguese</span></a></div><div class=theme-container><select id=theme-chooser><option value=theme-system>System</option><option value=theme-light>Light</option><option value=theme-dark>Dark</option><option value=theme-high-contrast>Alto contraste</option></select></div></div></section><section class=about-column><h3 class=column-title>About</h3><ul class=column-elements-container><li><a href=https://www.freebsd.org/about/ target=_blank class=column-element>FreeBSD</a></li><li><a href=https://freebsdfoundation.org/ target=_blank class=column-element>FreeBSD Foundation</a></li><li><a href=https://www.freebsd.org/where/ target=_blank class=column-element>Get FreeBSD</a></li><li><a href=https://www.freebsd.org/internal/code-of-conduct target=_blank class=column-element>Code of Conduct</a></li><li><a href=https://www.freebsd.org/security/ target=_blank class=column-element>Security Advisories</a></li></ul></section><section class=documentation-column><h3 class=column-title>Documentation</h3><ul class=column-elements-container><li><a href=/pt-br class=column-element>Documentation portal</a></li><li><a href=https://man.FreeBSD.org target=_blank class=column-element>Manual pages</a></li><li><a href=https://papers.FreeBSD.org target=_blank class=column-element>Presentations and papers</a></li><li><a href=https://docs-archive.freebsd.org/doc/ target=_blank class=column-element>Previous versions</a></li><li><a href=https://docs-archive.freebsd.org/44doc/ target=_blank class=column-element>4.4BSD Documents</a></li><li><a href=https://wiki.freebsd.org/ target=_blank class=column-element>Wiki</a></li></ul></section><section class=community-column><h3 class=column-title>Community</h3><ul class=column-elements-container><li><a href=http://172.16.201.134:1313/pt-br/articles/contributing class=column-element>Get involved</a></li><li><a href=https://forums.freebsd.org/ target=_blank class=column-element>Community forum</a></li><li><a href=https://lists.freebsd.org/ target=_blank class=column-element>Mailing lists</a></li><li><a href=https://wiki.freebsd.org/IRC/Channels target=_blank class=column-element>IRC Channels</a></li><li><a href=https://bugs.freebsd.org/bugzilla/ target=_blank class=column-element>Bug Tracker</a></li></ul></section><section class=legal-column><h3 class=column-title>Legal</h3><ul class=column-elements-container><li><a href=https://freebsdfoundation.org/donate/ target=_blank class=column-element>Donations</a></li><li><a href=https://www.freebsd.org/copyright/freebsd-license/ target=_blank class=column-element>Licensing</a></li><li><a href=https://www.freebsd.org/privacy/ target=_blank class=column-element>Privacy Policy</a></li><li><a href=https://www.freebsd.org/copyright/ target=_blank class=column-element>Legal notices</a></li></ul></section><section class=copyright-column><p>&copy; 1994-2024 The FreeBSD Project. All rights reserved</p><span>Made with <span class=heart>♥</span> by the FreeBSD Community</span></section></div></footer></body></html>