<!doctype html><html class=theme-light lang=pt-br><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="Este documento descreve a instalação remota do sistema operacional FreeBSD quando o console do sistema remoto não está disponível"><meta name=keywords content="Remote,Installation,FreeBSD"><meta name=copyright content="1995-2024 The FreeBSD Foundation"><link rel=canonical href=https://docs.freebsd.org/pt-br/articles/remote-install/><title>Instalação Remota do Sistema Operacional FreeBSD sem um Console Remoto | FreeBSD Documentation Portal</title>
<meta name=theme-color content="#790000"><meta name=color-scheme content="system light dark high-contrast"><link rel="shortcut icon" href=https://docs.freebsd.org/favicon.ico><link rel=stylesheet href=https://docs.freebsd.org/styles/main.min.css><link rel=stylesheet href=https://docs.freebsd.org/css/font-awesome-min.css><script defer src=/js/theme-chooser.min.js></script><script defer src=/js/copy-clipboard.min.js></script><script defer src=/js/search.min.js></script><meta name=twitter:card content="summary"><meta name=twitter:domain content="docs.FreeBSD.org"><meta name=twitter:site content="@freebsd"><meta name=twitter:url content="https://twitter.com/freebsd"><meta property="og:title" content="Instalação Remota do Sistema Operacional FreeBSD sem um Console Remoto"><meta property="og:description" content="Este documento descreve a instalação remota do sistema operacional FreeBSD quando o console do sistema remoto não está disponível"><meta property="og:type" content="website"><meta property="og:image" content="https://docs.freebsd.org/favicon.ico"><meta property="og:image:alt" content="FreeBSD Logo"><meta property="og:locale" content="pt-br"><meta property="og:url" content="https://docs.freebsd.org/pt-br/articles/remote-install/"><meta property="og:site_name" content="FreeBSD Documentation Portal"><script type=application/ld+json>{"@context":"http://schema.org","@type":"Article","url":"https:\/\/docs.freebsd.org\/pt-br\/articles\/remote-install\/","name":"FreeBSD Documentation Portal","headline":"FreeBSD Documentation Portal","description":"FreeBSD Documentation Portal"}</script></head><body><header><div class=header-container><div class=logo-menu-bars-container><a href=https://www.FreeBSD.org class=logo><img src=https://docs.freebsd.org/images/FreeBSD-monochromatic.svg width=160 height=50 alt="FreeBSD logo">
</a><label class=menu-bars for=menu-bars><i class="fa fa-bars" aria-hidden=true></i></label></div><input id=menu-bars type=checkbox><nav><ul class=menu><li class=menu-item><input id=about type=checkbox>
<a href=# aria-label="Navigate to About section"><label class=menu-item-description for=about>About
<i class="fa fa-angle-down fa-lg" aria-hidden=true></i></label></a><ul class=sub-menu><li class=title><a href=https://www.freebsd.org/about/ target=_blank>About</a></li><li><a href=https://www.freebsd.org/about/ target=_blank>FreeBSD</a></li><li><a href=https://freebsdfoundation.org/about-us/about-the-foundation/ target=_blank>FreeBSD Foundation</a></li><li><a href=https://www.freebsd.org/internal/code-of-conduct/ target=_blank>Code of Conduct</a></li></ul></li><li class=menu-item><input id=download type=checkbox>
<a href=# aria-label="Navigate to get FreeBSD section"><label class=menu-item-description for=download>Get FreeBSD
<i class="fa fa-angle-down fa-lg" aria-hidden=true></i></label></a><ul class=sub-menu><li class=title><a href=https://www.freebsd.org/where/ target=_blank>Get FreeBSD</a></li><li><a href=https://www.freebsd.org/releases/ target=_blank>Release Information</a></li><li><a href=https://www.freebsd.org/releng/ target=_blank>Release Engineering</a></li><li><a href=https://www.freebsd.org/security/ target=_blank>Security Advisories</a></li></ul></li><li class=menu-item><input id=documentation type=checkbox>
<a href=# aria-label="Navigate to get Documentation section"><label class=menu-item-description for=documentation>Documentation
<i class="fa fa-angle-down fa-lg" aria-hidden=true></i></label></a><ul class=sub-menu><li class=title><a href=/pt-br>Documentation portal</a></li><li><a href=https://docs.freebsd.org/pt-br/books/handbook>FreeBSD Handbook</a></li><li><a href=https://docs.freebsd.org/pt-br/books/porters-handbook>Porter's Handbook</a></li><li><a href=https://docs.FreeBSD.org/en/books/fdp-primer>Documentation Project Handbook</a></li><li><a href=https://man.FreeBSD.org target=_blank>Manual pages</a></li><li><a href=https://papers.FreeBSD.org target=_blank>Presentations and papers</a></li><li><a href=https://wiki.FreeBSD.org target=_blank>Wiki</a></li><li><a href=https://docs.freebsd.org/pt-br/books>Books</a></li><li><a href=https://docs.freebsd.org/pt-br/articles>Articles</a></li></ul></li><li class=menu-item><input id=community type=checkbox>
<a href=# aria-label="Navigate to get Community section"><label class=menu-item-description for=community>Community
<i class="fa fa-angle-down fa-lg" aria-hidden=true></i></label></a><ul class=sub-menu><li class=title><a href=https://www.freebsd.org/community/>Community</a></li><li><a href=https://docs.freebsd.org/pt-br/articles/contributing>Get involved</a></li><li><a href=https://forums.freebsd.org/ target=_blank>Forum</a></li><li><a href=https://lists.freebsd.org/ target=_blank>Mailing lists</a></li><li><a href=https://wiki.freebsd.org/IRC/Channels target=_blank>IRC Channels</a></li><li><a href=https://bugs.freebsd.org/bugzilla/ target=_blank>Bug Tracker</a></li><li><a href=https://www.freebsd.org/support/ target=_blank>Support</a></li></ul></li></ul></nav><div class=search-donate-container><form class=search method=get id=search-header-form action=https://docs.freebsd.org/search name=search-header-form><input type=hidden name=DB value=pt-br>
<input id=words name=P type=text size=20 maxlength=255>
<button>
<i class="fa fa-search" aria-hidden=true></i></button></form><div class=donate><a href=https://freebsdfoundation.org/donate/ target=_blank><span class=heart>♥</span>
Donate</a></div></div></div></header><main class=main-wrapper-article><div class=article><h1 class=title>Instalação Remota do Sistema Operacional FreeBSD sem um Console Remoto</h1><div class="admonitionblock note"><p><i class="fa fa-exclamation-circle" aria-hidden=true></i>
Esta tradução pode estar desatualizada. Para ajudar com as traduções, acesse a <a href=https://translate-dev.freebsd.org/ target=_blank>ferramenta de traduções do FreeBSD</a>.</p></div><div class=copyright>Copyright © 2008-2021 The FreeBSD Documentation Project</div><div class=legalnotice><a id=trademarks></a><details><summary>trademarks</summary><p>FreeBSD is a registered trademark of the FreeBSD Foundation.</p><p>Many of the designations used by manufacturers and sellers to distinguish their products are claimed as trademarks. Where those designations appear in this document, and the FreeBSD Project was aware of the trademark claim, the designations have been followed by the “™” or the “®” symbol.</p></details></div><div class=toc-mobile><h3>Índice</h3><nav id=TableOfContents><ul><li><a href=#background>1. Background</a></li><li><a href=#intro>2. Introdução</a></li><li><a href=#preparation>3. Preparação - mfsBSD</a></li><li><a href=#installation>4. Instalação do Sistema Operacional FreeBSD</a></li><li><a href=#zfs>5. ZFS</a></li></ul></nav></div><div id=preamble><div class=sectionbody><div class="paragraph abstract-title"><p>Resumo</p></div><div class=paragraph><p>Este artigo documenta a instalação remota do sistema operacional FreeBSD quando o console do sistema remoto não está disponível. A ideia principal por trás deste artigo é o resultado de uma colaboração com <code>Martin Matuska &lt;<a href=mailto:mm@FreeBSD.org>mm@FreeBSD.org</a>></code>, com valiosa contribuição fornecida por <code>Paweł Jakub Dawidek &lt;<a href=mailto:pjd@FreeBSD.org>pjd@FreeBSD.org</a>></code>.</p></div><hr></div></div><div class=sect1><h2 id=background>1. Background<a class=anchor href=#background></a></h2><div class=sectionbody><div class=paragraph><p>Existem muitos provedores de hospedagem de servidores no mundo, mas muito poucos deles oferecem suporte oficial para o FreeBSD. Geralmente, eles fornecem suporte para uma distribuição Linux® a ser instalada nos servidores que oferecem.</p></div><div class=paragraph><p>Em alguns casos, essas empresas podem instalar a distribuição FreeBSD se você solicitar, mesmo que normalmente só ofereçam suporte para distribuições Linux®. Em outros casos, elas podem oferecer um sistema de resgate que seria usado em uma emergência. É possível usar isso para nossos fins também.</p></div><div class=paragraph><p>Este artigo cobre os passos básicos de instalação e configuração necessários para inicializar uma instalação remota do FreeBSD com capacidades RAID-1 e ZFS.</p></div></div></div><div class=sect1><h2 id=intro>2. Introdução<a class=anchor href=#intro></a></h2><div class=sectionbody><div class=paragraph><p>Esta seção resumirá o objetivo deste artigo e explicará melhor o que é abordado aqui. As instruções incluídas neste artigo beneficiarão aqueles que utilizam serviços fornecidos por provedores de colocation que não suportam o FreeBSD.</p></div><div class="exampleblock procedure"><div class=content><div class="olist arabic"><ol class=arabic><li><p>Como mencionamos na seção <a href=#background>Background</a>, muitas das empresas de hospedagem de servidores respeitáveis fornecem algum tipo de sistema de resgate, que é iniciado a partir de sua LAN e acessível por SSH. Geralmente, eles fornecem esse suporte para ajudar seus clientes a corrigir sistemas operacionais com problemas. Como este artigo explicará, é possível instalar o FreeBSD com a ajuda desses sistemas de resgate.</p></li><li><p>A próxima seção deste artigo descreverá como configurar e compilar um FreeBSD minimalista na máquina local. Essa versão será executada eventualmente na máquina remota a partir de um ramdisk, o que nos permitirá instalar um sistema operacional FreeBSD completo a partir de um espelho FTP usando a ferramenta sysinstall.</p></li><li><p>O restante deste artigo descreverá o procedimento de instalação em si, bem como a configuração do sistema de arquivos ZFS.</p></li></ol></div></div></div><div class=sect2><h3 id=requirements>2.1. Requisitos<a class=anchor href=#requirements></a></h3><div class=paragraph><p>Para continuar com sucesso, você deve:</p></div><div class=ulist><ul><li><p>Ter um sistema operacional acessível pela rede com acesso SSH</p></li><li><p>Entender o processo de instalação do FreeBSD</p></li><li><p>Esteja familiarizado com o utilitário <a href="https://man.freebsd.org/cgi/man.cgi?query=sysinstall&amp;sektion=8&amp;format=html">sysinstall(8)</a></p></li><li><p>Tenha a imagem do sistema operacional de instalação do FreeBSD ou o CD em mãos</p></li></ul></div></div></div></div><div class=sect1><h2 id=preparation>3. Preparação - mfsBSD<a class=anchor href=#preparation></a></h2><div class=sectionbody><div class=paragraph><p>Antes que o FreeBSD possa ser instalado no sistema de destino, é necessário construir a imagem mínima do sistema operacional FreeBSD que será inicializada a partir do disco rígido. Dessa forma, o novo sistema pode ser acessado a partir da rede e o restante da instalação pode ser feito sem acesso remoto ao console do sistema.</p></div><div class=paragraph><p>A ferramenta mfsBSD pode ser utilizada para construir uma imagem mínima do FreeBSD. Como sugere o nome "mfsBSD" ("mfs" significa "sistema de arquivos de memória"), a imagem resultante é executada totalmente de um ramdisk. Graças a essa característica, a manipulação de discos rígidos não será limitada, tornando possível a instalação de um sistema operacional FreeBSD completo. A <a href=http://mfsbsd.vx.sk/>página inicial</a> do mfsBSD inclui referências para a última versão do conjunto de ferramentas.</p></div><div class=paragraph><p>Por favor, note que os detalhes internos do mfsBSD e como tudo se encaixa estão além do escopo deste artigo. O leitor interessado deve consultar a documentação original do mfsBSD para mais detalhes.</p></div><div class=paragraph><p>Faça o download e extraia a última versão do mfsBSD e altere seu diretório de trabalho para o diretório onde os scripts do mfsBSD serão armazenados:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># fetch http://mfsbsd.vx.sk/release/mfsbsd-2.1.tar.gz</span>
<span class=c># tar xvzf mfsbsd-2.1.tar.gz</span>
<span class=c># cd mfsbsd-2.1/</span></code></pre></div></div><div class=sect2><h3 id=mfsbsd-config>3.1. Configuração do mfsBSD<a class=anchor href=#mfsbsd-config></a></h3><div class=paragraph><p>Antes de iniciar o mfsBSD, algumas opções de configuração importantes devem ser definidas. A mais importante que devemos acertar é, naturalmente, a configuração de rede. O método mais adequado para configurar as opções de rede depende se sabemos de antemão o tipo de interface de rede que usaremos e o driver de interface de rede a ser carregado para nosso hardware. Veremos como o mfsBSD pode ser configurado em ambos os casos.</p></div><div class=paragraph><p>Outro ponto importante a ser definido é a senha do <code>root</code>. Isso pode ser feito editando o arquivo <span class=filename>conf/loader.conf</span>. Por favor, consulte os comentários incluídos.</p></div><div class=sect3><h4 id=_o_método_confinterfaces_conf>3.1.1. O método <span class=filename>conf/interfaces.conf</span><a class=anchor href=#_o_método_confinterfaces_conf></a></h4><div class=paragraph><p>Quando a placa de rede instalada é desconhecida, é possível usar os recursos de detecção automática do mfsBSD. Os scripts de inicialização do mfsBSD podem detectar o driver correto a ser usado, com base no endereço MAC da interface, se definirmos as seguintes opções em <span class=filename>conf/interfaces.conf</span>:</p></div><div class="literalblock programlisting"><div class=content><pre>mac_interfaces=&#34;ext1&#34;
ifconfig_ext1_mac=&#34;00:00:00:00:00:00&#34;
ifconfig_ext1=&#34;inet 192.168.0.2/24&#34;</pre></div></div><div class=paragraph><p>Não se esqueça de adicionar as informações do <code>defaultrouter</code> no <span class=filename>conf/rc.conf</span>:</p></div><div class="literalblock programlisting"><div class=content><pre>defaultrouter=&#34;192.168.0.1&#34;</pre></div></div></div><div class=sect3><h4 id=_o_método_confrc_conf>3.1.2. O Método <span class=filename>conf/rc.conf</span><a class=anchor href=#_o_método_confrc_conf></a></h4><div class=paragraph><p>Quando o driver da interface de rede é conhecido, é mais conveniente usar o arquivo <span class=filename>conf/rc.conf</span> para as opções de rede. A sintaxe deste arquivo é a mesma usada no arquivo padrão <a href="https://man.freebsd.org/cgi/man.cgi?query=rc.conf&amp;sektion=5&amp;format=html">rc.conf(5)</a> do FreeBSD.</p></div><div class=paragraph><p>Por exemplo, se você sabe que uma interface de rede <a href="https://man.freebsd.org/cgi/man.cgi?query=re&amp;sektion=4&amp;format=html">re(4)</a> estará disponível, você pode definir as seguintes opções no <span class=filename>conf/rc.conf</span>:</p></div><div class="literalblock programlisting"><div class=content><pre>defaultrouter=&#34;192.168.0.1&#34;
ifconfig_re0=&#34;inet 192.168.0.2/24&#34;</pre></div></div></div></div><div class=sect2><h3 id=mfsbsd-build>3.2. Construindo uma imagem mfsBSD<a class=anchor href=#mfsbsd-build></a></h3><div class=paragraph><p>O processo de construir uma imagem mfsBSD é bastante simples.</p></div><div class=paragraph><p>O primeiro passo é montar o CD de instalação do FreeBSD, ou a imagem ISO de instalação, no diretório <span class=filename>/cdrom</span>. Para fins de exemplo, neste artigo vamos supor que você tenha baixado a imagem ISO do FreeBSD 10.1-RELEASE. Montar esta imagem ISO no diretório <span class=filename>/cdrom</span> é fácil com o utilitário <a href="https://man.freebsd.org/cgi/man.cgi?query=mdconfig&amp;sektion=8&amp;format=html">mdconfig(8)</a>:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># mdconfig -a -t vnode -u 10 -f FreeBSD-10.1-RELEASE-amd64-disc1.iso</span>
<span class=c># mount_cd9660 /dev/md10 /cdrom</span></code></pre></div></div><div class=paragraph><p>Como as versões recentes do FreeBSD não contêm conjuntos de distribuição regulares, é necessário extrair os arquivos de distribuição do FreeBSD dos arquivos de distribuição localizados na imagem ISO:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># mkdir DIST</span>
<span class=c># tar -xvf /cdrom/usr/freebsd-dist/base.txz -C DIST</span>
<span class=c># tar -xvf /cdrom/usr/freebsd-dist/kernel.txz -C DIST</span></code></pre></div></div><div class=paragraph><p>Em seguida, crie a imagem de inicialização do mfsBSD:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># make BASE=DIST</span></code></pre></div></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>A instrução <code>make</code> acima deve ser executada a partir do nível superior da árvore de diretórios do mfsBSD, por exemplo, <span class=filename>~/mfsbsd-2.1/</span>.</p></div></td></tr></tbody></table></div></div><div class=sect2><h3 id=_inicializando_o_mfsbsd>3.3. Inicializando o mfsBSD<a class=anchor href=#_inicializando_o_mfsbsd></a></h3><div class=paragraph><p>Agora que a imagem mfsBSD está pronta, ela deve ser enviada para o sistema remoto que está executando um sistema de resgate ou a distribuição Linux® pré-instalada. A ferramenta mais adequada para essa tarefa é o scp:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># scp disk.img root@192.168.0.2:.</span></code></pre></div></div><div class=paragraph><p>Para inicializar a imagem do mfsBSD corretamente, ela deve ser colocada no primeiro dispositivo (inicializável) da máquina em questão. Isso pode ser feito usando o seguinte exemplo, supondo que o <span class=filename>sda</span> seja o primeiro dispositivo de disco inicializável:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># dd if=/root/disk.img of=/dev/sda bs=1m</span></code></pre></div></div><div class=paragraph><p>Se tudo correu bem, a imagem agora deve estar no MBR do primeiro dispositivo e a máquina pode ser reiniciada. Verifique se a máquina está iniciando corretamente com a ferramenta <a href="https://man.freebsd.org/cgi/man.cgi?query=ping&amp;sektion=8&amp;format=html">ping(8)</a>. Depois que a máquina voltar on-line, deve ser possível acessá-la via <a href="https://man.freebsd.org/cgi/man.cgi?query=ssh&amp;sektion=1&amp;format=html">ssh(1)</a> como usuário <code>root</code> com a senha configurada.</p></div></div></div></div><div class=sect1><h2 id=installation>4. Instalação do Sistema Operacional FreeBSD<a class=anchor href=#installation></a></h2><div class=sectionbody><div class=paragraph><p>O mfsBSD foi iniciado com sucesso e deve ser possível fazer login por meio do <a href="https://man.freebsd.org/cgi/man.cgi?query=ssh&amp;sektion=1&amp;format=html">ssh(1)</a>. Esta seção descreverá como criar e rotular slices, configurar o <code>gmirror</code> para RAID-1 e como usar o <code>sysinstall</code> para instalar uma distribuição mínima do sistema operacional FreeBSD.</p></div><div class=sect2><h3 id=_preparação_dos_discos_rígidos>4.1. Preparação dos Discos Rígidos<a class=anchor href=#_preparação_dos_discos_rígidos></a></h3><div class=paragraph><p>A primeira tarefa é alocar espaço em disco para o FreeBSD, ou seja, criar slices e partições. Obviamente, o sistema atualmente em execução está totalmente carregado na memória do sistema e, portanto, não haverá problemas com a manipulação de discos rígidos. Para concluir esta tarefa, é possível usar o <code>sysinstall</code> ou o <a href="https://man.freebsd.org/cgi/man.cgi?query=fdisk&amp;sektion=8&amp;format=html">fdisk(8)</a> em conjunto com o <a href="https://man.freebsd.org/cgi/man.cgi?query=bsdlabel&amp;sektion=8&amp;format=html">bsdlabel(8)</a>.</p></div><div class=paragraph><p>No início, marque todos os discos do sistema como vazios. Repita o seguinte comando para cada disco rígido:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># dd if=/dev/zero of=/dev/ad0 count=2</span></code></pre></div></div><div class=paragraph><p>O próximo passo é criar slices e rotulá-las com a ferramenta de sua preferência. Embora seja considerado mais fácil usar o <code>sysinstall</code>, um método poderoso e provavelmente com menos bugs é usar as ferramentas UNIX® padrão baseadas em texto, como o <a href="https://man.freebsd.org/cgi/man.cgi?query=fdisk&amp;sektion=8&amp;format=html">fdisk(8)</a> e o <a href="https://man.freebsd.org/cgi/man.cgi?query=bsdlabel&amp;sektion=8&amp;format=html">bsdlabel(8)</a>, que também serão abordados nesta seção. A primeira opção está bem documentada no capítulo <a href=https://docs.freebsd.org/pt-br/books/handbook/book/#install-steps>Instalando o FreeBSD</a> do Handbook do FreeBSD. Como mencionado na introdução, este artigo apresentará como configurar um sistema com capacidades RAID-1 e ZFS. A nossa configuração consistirá em um pequeno <a href="https://man.freebsd.org/cgi/man.cgi?query=gmirror&amp;sektion=8&amp;format=html">gmirror(8)</a> para o <span class=filename>/</span> (root), <span class=filename>/usr</span> e <span class=filename>/var</span>, e o restante do espaço em disco será alocado para um sistema de arquivos ZFS espelhado por meio do <a href="https://man.freebsd.org/cgi/man.cgi?query=zpool&amp;sektion=8&amp;format=html">zpool(8)</a>. Por favor, note que o sistema de arquivos ZFS será configurado após a instalação e inicialização bem-sucedidas do sistema operacional FreeBSD.</p></div><div class=paragraph><p>O seguinte exemplo descreverá como criar slices e rótulos, inicializar o <a href="https://man.freebsd.org/cgi/man.cgi?query=gmirror&amp;sektion=8&amp;format=html">gmirror(8)</a> em cada partição e como criar um sistema de arquivos UFS2 em cada partição espelhada:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># fdisk -BI /dev/ad0 </span><i class=conum data-value=1></i><b>(1)</b>
<span class=c># fdisk -BI /dev/ad1</span>
<span class=c># bsdlabel -wB /dev/ad0s1 </span><i class=conum data-value=2></i><b>(2)</b>
<span class=c># bsdlabel -wB /dev/ad1s1</span>
<span class=c># bsdlabel -e /dev/ad0s1 </span><i class=conum data-value=3></i><b>(3)</b>
<span class=c># bsdlabel /dev/ad0s1 &gt; /tmp/bsdlabel.txt &amp;&amp; bsdlabel -R /dev/ad1s1 /tmp/bsdlabel.txt </span><i class=conum data-value=4></i><b>(4)</b>
<span class=c># gmirror label root /dev/ad[01]s1a </span><i class=conum data-value=5></i><b>(5)</b>
<span class=c># gmirror label var /dev/ad[01]s1d</span>
<span class=c># gmirror label usr /dev/ad[01]s1e</span>
<span class=c># gmirror label -F swap /dev/ad[01]s1b </span><i class=conum data-value=6></i><b>(6)</b>
<span class=c># newfs /dev/mirror/root </span><i class=conum data-value=7></i><b>(7)</b>
<span class=c># newfs /dev/mirror/var</span>
<span class=c># newfs /dev/mirror/usr</span></code></pre></div></div><div class="colist arabic"><table><tbody><tr><td><i class=conum data-value=1></i><b>1</b></td><td>Crie uma slice cobrindo todo o disco e inicialize o código de inicialização contido no setor 0 do disco fornecido. Repita este comando para todos os discos rígidos no sistema.</td></tr><tr><td><i class=conum data-value=2></i><b>2</b></td><td>Escreva um label padrão para cada disco, incluindo o código de bootstrap.</td></tr><tr><td><i class=conum data-value=3></i><b>3</b></td><td>Agora, edite manualmente o label do disco. Consulte a página do manual <a href="https://man.freebsd.org/cgi/man.cgi?query=bsdlabel&amp;sektion=8&amp;format=html">bsdlabel(8)</a> para descobrir como criar partições. Crie partições <code>a</code> para o sistema de arquivos <span class=filename>/</span> (raiz), <code>b</code> para swap, <code>d</code> para <span class=filename>/var</span>, <code>e</code> para <span class=filename>/usr</span> e, finalmente, <code>f</code> que será usado posteriormente para o ZFS.</td></tr><tr><td><i class=conum data-value=4></i><b>4</b></td><td>Importe o label recém-criado para o segundo disco rígido, para que ambos os discos sejam rotulados da mesma maneira.</td></tr><tr><td><i class=conum data-value=5></i><b>5</b></td><td>Inicialize o <a href="https://man.freebsd.org/cgi/man.cgi?query=gmirror&amp;sektion=8&amp;format=html">gmirror(8)</a> em cada partição.</td></tr><tr><td><i class=conum data-value=6></i><b>6</b></td><td>Note que <code>-F</code> é usado para a partição swap. Isso instrui o <a href="https://man.freebsd.org/cgi/man.cgi?query=gmirror&amp;sektion=8&amp;format=html">gmirror(8)</a> a assumir que o dispositivo está em um estado consistente após uma falha de energia/sistema.</td></tr><tr><td><i class=conum data-value=7></i><b>7</b></td><td>Crie um sistema de arquivos UFS2 em cada partição espelhada.</td></tr></tbody></table></div></div><div class=sect2><h3 id=_instalação_do_sistema>4.2. Instalação do sistema<a class=anchor href=#_instalação_do_sistema></a></h3><div class=paragraph><p>Esta é a parte mais importante. Esta seção irá descrever como instalar a distribuição mínima do FreeBSD nos discos rígidos que preparamos na seção anterior. Para atingir este objetivo, todos os sistemas de arquivos precisam ser montados para que o <code>sysinstall</code> possa gravar o conteúdo do FreeBSD nos discos rígidos:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># mount /dev/mirror/root /mnt</span>
<span class=c># mkdir /mnt/var /mnt/usr</span>
<span class=c># mount /dev/mirror/var /mnt/var</span>
<span class=c># mount /dev/mirror/usr /mnt/usr</span></code></pre></div></div><div class=paragraph><p>Quando terminar, inicie o <a href="https://man.freebsd.org/cgi/man.cgi?query=sysinstall&amp;sektion=8&amp;format=html">sysinstall(8)</a>. Selecione a instalação <span class=guimenuitem>Custom</span> no menu principal. Selecione <span class=guimenuitem>Opções</span> e pressione <kbd>Enter</kbd>. Com a ajuda das teclas de seta, mova o cursor no item <code>Install Root</code>, pressione <kbd>Espaço</kbd> e altere-o para <span class=filename>/mnt</span>. Pressione <kbd>Enter</kbd> para enviar suas alterações e sair do menu <span class=guimenuitem>Opções</span> pressionando <kbd>q</kbd>.</p></div><div class="admonitionblock warning"><table><tbody><tr><td class=icon><i class="fa icon-warning" title=Warning></i></td><td class=content><div class=paragraph><p>Observe que este passo é muito importante e, se ignorado, o <code>sysinstall</code> será incapaz de instalar o FreeBSD.</p></div></td></tr></tbody></table></div><div class=paragraph><p>Vá para o menu <span class=guimenuitem>Distributions</span>, mova o cursor com as teclas de seta para <code>Minimal</code> e marque-a pressionando <kbd>Espaço</kbd>. Este artigo utiliza a distribuição Minimal para economizar tráfego de rede, pois o próprio sistema será instalado via ftp. Saia deste menu escolhendo <code>Exit</code>.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Os menus <span class=guimenuitem>Partition</span> e <span class=guimenuitem>Label</span> serão ignorados, pois são inúteis neste momento.</p></div></td></tr></tbody></table></div><div class=paragraph><p>Na tela do menu <span class=guimenuitem>Media</span>[/guimenuitem], selecione a opção "FTP". Escolha o espelho mais próximo e deixe que o <code>sysinstall</code> assuma que a rede já está configurada. Você será levado de volta ao menu <span class=guimenuitem>Custom</span>.</p></div><div class=paragraph><p>Por fim, execute a instalação do sistema selecionando a última opção, <span class=guimenuitem>Commit</span>. Saia do <code>sysinstall</code> quando a instalação for concluída.</p></div></div><div class=sect2><h3 id=_etapas_pós_instalação>4.3. Etapas pós-instalação<a class=anchor href=#_etapas_pós_instalação></a></h3><div class=paragraph><p>O sistema operacional FreeBSD deve estar instalado agora; no entanto, o processo ainda não está concluído. É necessário realizar algumas etapas pós-instalação para permitir que o FreeBSD seja inicializado no futuro e para poder fazer login no sistema.</p></div><div class=paragraph><p>Agora você deve executar o comando <code><a href="https://man.freebsd.org/cgi/man.cgi?query=chroot&amp;sektion=8&amp;format=html">chroot(8)</a></code> no sistema recém-instalado para concluir a instalação. Use o seguinte comando:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># chroot /mnt</span></code></pre></div></div><div class=paragraph><p>Para completar nosso objetivo, execute estas etapas:</p></div><div class=ulist><ul><li><p>Copie o kernel <code>GENERIC</code> para o diretório <span class=filename>/boot/kernel</span>:</p><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># cp -Rp /boot/GENERIC/* /boot/kernel</span></code></pre></div></div></li><li><p>Crie os arquivos <span class=filename>/etc/rc.conf</span>, <span class=filename>/etc/resolv.conf</span> e <span class=filename>/etc/fstab</span>. Não esqueça de definir corretamente as informações de rede e habilitar o sshd em <span class=filename>/etc/rc.conf</span>. O conteúdo do <span class=filename>/etc/fstab</span> será semelhante ao seguinte:</p><div class="literalblock programlisting"><div class=content><pre># Device                Mountpoint      FStype  Options         Dump    Pass#
/dev/mirror/swap        none            swap    sw              0       0
/dev/mirror/root        /               ufs     rw              1       1
/dev/mirror/usr         /usr            ufs     rw              2       2
/dev/mirror/var         /var            ufs     rw              2       2
/dev/cd0                /cdrom          cd9660  ro,noauto       0       0</pre></div></div></li><li><p>Crie o arquivo <span class=filename>/boot/loader.conf</span> com o seguinte conteúdo:</p><div class="literalblock programlisting"><div class=content><pre>geom_mirror_load=&#34;YES&#34;
zfs_load=&#34;YES&#34;</pre></div></div></li><li><p>Execute o seguinte comando, que permitirá o ZFS ser utilizado no próximo boot:</p><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># sysrc zfs_enable=&#34;YES&#34;</span></code></pre></div></div></li><li><p>Adicione usuários adicionais ao sistema usando a ferramenta <a href="https://man.freebsd.org/cgi/man.cgi?query=adduser&amp;sektion=8&amp;format=html">adduser(8)</a>. Não se esqueça de adicionar um usuário ao grupo <code>wheel</code> para que possa obter acesso de root após a reinicialização.</p></li><li><p>Verifique todas as suas configurações.</p></li></ul></div><div class=paragraph><p>O sistema deve estar pronto para a próxima inicialização. Use o comando <a href="https://man.freebsd.org/cgi/man.cgi?query=reboot&amp;sektion=8&amp;format=html">reboot(8)</a> para reiniciar o sistema.</p></div></div></div></div><div class=sect1><h2 id=zfs>5. ZFS<a class=anchor href=#zfs></a></h2><div class=sectionbody><div class=paragraph><p>Se o seu sistema sobreviveu ao reboot, agora deve ser possível fazer login. Bem-vindo à nova instalação do FreeBSD, realizada remotamente sem o uso de um console remoto!</p></div><div class=paragraph><p>O único passo restante é configurar o <a href="https://man.freebsd.org/cgi/man.cgi?query=zpool&amp;sektion=8&amp;format=html">zpool(8)</a> e criar alguns sistemas de arquivos <a href="https://man.freebsd.org/cgi/man.cgi?query=zfs&amp;sektion=8&amp;format=html">zfs(8)</a>. Criar e administrar ZFS é muito simples. Primeiro, crie um pool espelhado:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># zpool create tank mirror /dev/ad[01]s1f</span></code></pre></div></div><div class=paragraph><p>Em seguida, crie alguns sistemas de arquivos:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># zfs create tank/ports</span>
<span class=c># zfs create tank/src</span>
<span class=c># zfs set compression=gzip tank/ports</span>
<span class=c># zfs set compression=on tank/src</span>
<span class=c># zfs set mountpoint=/usr/ports tank/ports</span>
<span class=c># zfs set mountpoint=/usr/src tank/src</span></code></pre></div></div><div class=paragraph><p>Isso é tudo. Se você estiver interessado em mais detalhes sobre o ZFS no FreeBSD, consulte a seção <a href=https://wiki.freebsd.org/ZFS>ZFS</a> do Wiki do FreeBSD.</p></div></div></div><hr><div class=last-modified><p><strong>Última alteração em</strong>: 29 de abril de 2023 por <a href="https://cgit.freebsd.org/doc/commit/?id=8cb38caf59" target=_blank>Edson Brandi</a></p></div></div><aside class=toc><div class=toc-content><h3>Índice</h3><nav id=TableOfContents><ul><li><a href=#background>1. Background</a></li><li><a href=#intro>2. Introdução</a></li><li><a href=#preparation>3. Preparação - mfsBSD</a></li><li><a href=#installation>4. Instalação do Sistema Operacional FreeBSD</a></li><li><a href=#zfs>5. ZFS</a></li></ul></nav><hr><div class=resources><h3>Recursos</h3><ul class=contents><li><i class="fa fa-file-pdf-o" aria-hidden=true title="Download PDF"></i><a href=https://download.freebsd.org/doc/pt-br/articles/remote-install/remote-install_pt-br.pdf>Download PDF</a></li><li><i class="fa fa-pencil-square-o" aria-hidden=true title="Edite essa página"></i><a href=https://github.com/freebsd/freebsd-doc/blob/main/documentation/content/pt-br/_index target=_blank>Edite essa página</a></li></ul></div></div></aside></main><footer><div class=footer-container><section class=logo-column><img src=https://docs.freebsd.org/images/FreeBSD-colors.svg width=160 height=50 alt="FreeBSD logo"><div class=options-container><div class=language-container><a id=languages href=https://docs.freebsd.org/pt-br/languages><img src=https://docs.freebsd.org/images/language.png class=language-image alt="Escolha o idioma">
<span>Brazilian Portuguese</span></a></div><div class=theme-container><select id=theme-chooser><option value=theme-system>System</option><option value=theme-light>Light</option><option value=theme-dark>Dark</option><option value=theme-high-contrast>Alto contraste</option></select></div></div></section><section class=about-column><h3 class=column-title>About</h3><ul class=column-elements-container><li><a href=https://www.freebsd.org/about/ target=_blank class=column-element>FreeBSD</a></li><li><a href=https://freebsdfoundation.org/ target=_blank class=column-element>FreeBSD Foundation</a></li><li><a href=https://www.freebsd.org/where/ target=_blank class=column-element>Get FreeBSD</a></li><li><a href=https://www.freebsd.org/internal/code-of-conduct target=_blank class=column-element>Code of Conduct</a></li><li><a href=https://www.freebsd.org/security/ target=_blank class=column-element>Security Advisories</a></li></ul></section><section class=documentation-column><h3 class=column-title>Documentation</h3><ul class=column-elements-container><li><a href=/pt-br class=column-element>Documentation portal</a></li><li><a href=https://man.FreeBSD.org target=_blank class=column-element>Manual pages</a></li><li><a href=https://papers.FreeBSD.org target=_blank class=column-element>Presentations and papers</a></li><li><a href=https://docs-archive.freebsd.org/doc/ target=_blank class=column-element>Previous versions</a></li><li><a href=https://docs-archive.freebsd.org/44doc/ target=_blank class=column-element>4.4BSD Documents</a></li><li><a href=https://wiki.freebsd.org/ target=_blank class=column-element>Wiki</a></li></ul></section><section class=community-column><h3 class=column-title>Community</h3><ul class=column-elements-container><li><a href=https://docs.freebsd.org/pt-br/articles/contributing class=column-element>Get involved</a></li><li><a href=https://forums.freebsd.org/ target=_blank class=column-element>Community forum</a></li><li><a href=https://lists.freebsd.org/ target=_blank class=column-element>Mailing lists</a></li><li><a href=https://wiki.freebsd.org/IRC/Channels target=_blank class=column-element>IRC Channels</a></li><li><a href=https://bugs.freebsd.org/bugzilla/ target=_blank class=column-element>Bug Tracker</a></li></ul></section><section class=legal-column><h3 class=column-title>Legal</h3><ul class=column-elements-container><li><a href=https://freebsdfoundation.org/donate/ target=_blank class=column-element>Donations</a></li><li><a href=https://www.freebsd.org/copyright/freebsd-license/ target=_blank class=column-element>Licensing</a></li><li><a href=https://www.freebsd.org/privacy/ target=_blank class=column-element>Privacy Policy</a></li><li><a href=https://www.freebsd.org/copyright/ target=_blank class=column-element>Legal notices</a></li></ul></section><section class=copyright-column><p>&copy; 1994-2024 The FreeBSD Project. All rights reserved</p><span>Made with <span class=heart>♥</span> by the FreeBSD Community</span></section></div></footer></body></html>