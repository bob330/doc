<!doctype html><html class=theme-light lang=hu><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content><meta name=keywords content><meta name=copyright content="1995-2024 The FreeBSD Foundation"><link rel=canonical href=https://docs.freebsd.org/hu/books/handbook/book/><title>FreeBSD kézikönyv | FreeBSD Documentation Portal</title>
<meta name=theme-color content="#790000"><meta name=color-scheme content="system light dark high-contrast"><link rel="shortcut icon" href=https://docs.freebsd.org/favicon.ico><link rel=stylesheet href=https://docs.freebsd.org/styles/main.min.css><link rel=stylesheet href=https://docs.freebsd.org/css/font-awesome-min.css><script defer src=/js/theme-chooser.min.js></script><script defer src=/js/copy-clipboard.min.js></script><script defer src=/js/search.min.js></script><meta name=twitter:card content="summary"><meta name=twitter:domain content="docs.FreeBSD.org"><meta name=twitter:site content="@freebsd"><meta name=twitter:url content="https://twitter.com/freebsd"><meta property="og:title" content="FreeBSD kézikönyv"><meta property="og:description" content><meta property="og:type" content="website"><meta property="og:image" content="https://docs.freebsd.org/favicon.ico"><meta property="og:image:alt" content="FreeBSD Logo"><meta property="og:locale" content="hu"><meta property="og:url" content="https://docs.freebsd.org/hu/books/handbook/book/"><meta property="og:site_name" content="FreeBSD Documentation Portal"><script type=application/ld+json>{"@context":"http://schema.org","@type":"Article","url":"https:\/\/docs.freebsd.org\/hu\/books\/handbook\/book\/","name":"FreeBSD Documentation Portal","headline":"FreeBSD Documentation Portal","description":"FreeBSD Documentation Portal"}</script></head><body><header><div class=header-container><div class=logo-menu-bars-container><a href=https://www.FreeBSD.org class=logo><img src=https://docs.freebsd.org/images/FreeBSD-monochromatic.svg width=160 height=50 alt="FreeBSD logo">
</a><label class=menu-bars for=menu-bars><i class="fa fa-bars" aria-hidden=true></i></label></div><input id=menu-bars type=checkbox><nav><ul class=menu><li class=menu-item><input id=about type=checkbox>
<a href=# aria-label="Navigate to About section"><label class=menu-item-description for=about>About
<i class="fa fa-angle-down fa-lg" aria-hidden=true></i></label></a><ul class=sub-menu><li class=title><a href=https://www.freebsd.org/about/ target=_blank>About</a></li><li><a href=https://www.freebsd.org/about/ target=_blank>FreeBSD</a></li><li><a href=https://freebsdfoundation.org/about-us/about-the-foundation/ target=_blank>FreeBSD Foundation</a></li><li><a href=https://www.freebsd.org/internal/code-of-conduct/ target=_blank>Code of Conduct</a></li></ul></li><li class=menu-item><input id=download type=checkbox>
<a href=# aria-label="Navigate to get FreeBSD section"><label class=menu-item-description for=download>Get FreeBSD
<i class="fa fa-angle-down fa-lg" aria-hidden=true></i></label></a><ul class=sub-menu><li class=title><a href=https://www.freebsd.org/where/ target=_blank>Get FreeBSD</a></li><li><a href=https://www.freebsd.org/releases/ target=_blank>Release Information</a></li><li><a href=https://www.freebsd.org/releng/ target=_blank>Release Engineering</a></li><li><a href=https://www.freebsd.org/security/ target=_blank>Security Advisories</a></li></ul></li><li class=menu-item><input id=documentation type=checkbox>
<a href=# aria-label="Navigate to get Documentation section"><label class=menu-item-description for=documentation>Documentation
<i class="fa fa-angle-down fa-lg" aria-hidden=true></i></label></a><ul class=sub-menu><li class=title><a href=/hu>Documentation portal</a></li><li><a href=https://docs.freebsd.org/hu/books/handbook>FreeBSD Handbook</a></li><li><a href=https://docs.freebsd.org/hu/books/porters-handbook>Porter's Handbook</a></li><li><a href=https://docs.FreeBSD.org/en/books/fdp-primer>Documentation Project Handbook</a></li><li><a href=https://man.FreeBSD.org target=_blank>Manual pages</a></li><li><a href=https://papers.FreeBSD.org target=_blank>Presentations and papers</a></li><li><a href=https://wiki.FreeBSD.org target=_blank>Wiki</a></li><li><a href=https://docs.freebsd.org/hu/books>Books</a></li><li><a href=https://docs.freebsd.org/hu/articles>Articles</a></li></ul></li><li class=menu-item><input id=community type=checkbox>
<a href=# aria-label="Navigate to get Community section"><label class=menu-item-description for=community>Community
<i class="fa fa-angle-down fa-lg" aria-hidden=true></i></label></a><ul class=sub-menu><li class=title><a href=https://www.freebsd.org/community/>Community</a></li><li><a href=https://docs.freebsd.org/hu/articles/contributing>Get involved</a></li><li><a href=https://forums.freebsd.org/ target=_blank>Forum</a></li><li><a href=https://lists.freebsd.org/ target=_blank>Mailing lists</a></li><li><a href=https://wiki.freebsd.org/IRC/Channels target=_blank>IRC Channels</a></li><li><a href=https://bugs.freebsd.org/bugzilla/ target=_blank>Bug Tracker</a></li><li><a href=https://www.freebsd.org/support/ target=_blank>Support</a></li></ul></li></ul></nav><div class=search-donate-container><form class=search method=get id=search-header-form action=https://docs.freebsd.org/search name=search-header-form><input type=hidden name=DB value=hu>
<input id=words name=P type=text size=20 maxlength=255>
<button>
<i class="fa fa-search" aria-hidden=true></i></button></form><div class=donate><a href=https://freebsdfoundation.org/donate/ target=_blank><span class=heart>♥</span>
Donate</a></div></div></div></header><input type=checkbox class="hidden toggle" id=menu-control><main class=main-wrapper-book><a id=top></a><div class=book><h1 class=title>FreeBSD kézikönyv</h1><div class="admonitionblock note"><p><i class="fa fa-exclamation-circle" aria-hidden=true></i>
This translation may be out of date. To help with the translations please access the <a href=https://translate-dev.freebsd.org/ target=_blank>FreeBSD translations instance</a>.</p></div><div class=copyright>Copyright © 1995-2020 The FreeBSD Documentation Project</div><div class=legalnotice><a id=trademarks></a><details><summary>trademarks</summary><p>A FreeBSD a FreeBSD Foundation bejegyzett védjegye.</p><p>Az IBM, AIX, OS/2, PowerPC, PS/2, S/390 és ThinkPad az International Business Machines Corporation védjegyei az Egyesült Államokban, más országokban, vagy mindkettõben.</p><p>Az IEEE, POSIX és 802 az Institute of Electrical and Electronics Engineers, Inc. bejegyzett védjegyei az Egyesült Államokban.</p><p>A Red Hat és RPM a Red Hat, Inc. védjegyei vagy bejegyzett védjegyei az Egyesült Államokban és más országokban.</p><p>A 3Com és HomeConnect a 3Com Corporation bejegyzett védjegyei.</p><p>Az Adobe, Acrobat, Acrobat Reader, és PostScript az Adobe Systems Incorporated bejegyzett védjegyei, vagy védjegyei az Egyesült Államokban és/vagy más országokban.</p><p>Az Apple, AirPort, FireWire, Mac, Macintosh, Mac OS, Quicktime, és TrueType az Apple Computer, Inc., bejegyzett védjegyei az Egyesült Államokban és más országokban.</p><p>Az Intel, Celeron, EtherExpress, i386, i486, Itanium, Pentium és Xeon az Intel Corporation vagy leányvállalatainak védjegyei vagy bejegyzett védjegyei az Egyesült Államokban és más országokban.</p><p>A Linux Linus Torvalds bejegyzett védjegye.</p><p>A Microsoft, IntelliMouse, MS-DOS, Outlook, Windows, Windows Media és Windows NT a Microsoft Corporation bejegyzett veacute;djegyei, vagy védjegyei az Egyesült Államokban és/vagy más országokban.</p><p>A Motif, OSF/1 és UNIX a The Open Group bejegyzett védjegyei, az IT DialTone és a The Open Group pedig védjegyei az Egyesült államokban és/vagy más országokban.</p><p>A Sun, Sun Microsystems, Java, Java Virtual Machine, JDK, JRE, JSP, JVM, Netra, OpenJDK, Solaris, StarOffice, SunOS és VirtualBox a Sun Microsystems, Inc. védjegyei vagy bejegyzett védjegyei az Egyesült Államokban és más országokban.</p><p>A RealNetworks, RealPlayer és RealAudio a RealNetworks, Inc. bejegyzett védjegyei.</p><p>Az Oracle az Oracle Corporation bejegyzett védjegye.</p><p>A 3ware a 3ware Inc. bejegyzett védjegyei.</p><p>Az ARM az ARM Limited bejegyzett védjegye.</p><p>A Adaptec az Adaptec, Inc. bejegyzett védjegye.</p><p>Android is a trademark of Google Inc.</p><p>A Heidelberg, Helvetica, Palatino, és Times Roman a Heidelberger Druckmaschinen AG bejegyzett védjegyei, vagy védjegyei az Egyesült Államokban és más országokban.</p><p>Az Intuit és Quicken az Intuit Inc., vagy valamely leányvállalatának bejegyzett védjegyei és/vagy bejegyzett szervizmárkái az Egyesült Államokban és más országokban.</p><p>Az LSI Logic, AcceleRAID, eXtremeRAID, MegaRAID és Mylex az LSI Logic Corp. védjegyei vagy bejegyzett védjegyei.</p><p>A MATLAB a The MathWorks, Inc. bejegyzett védjegye.</p><p>A SpeedTouch a Thomson védjegye.</p><p>A VMware a VMware, Inc. védjegye.</p><p>A Mathematica a Wolfram Research, Inc. védjegye.</p><p>Az Ogg Vorbis és Xiph.Org a Xiph.Org védjegyei.</p><p>Az XFree86 az XFree86 Project, Inc. védjegye.</p><p>A gyártók és terjesztõk által használt megnevezések közül sok védjegy jogot követel. Ahol ilyen megnevezés tûnik fel ebben a dokumentumban, és a FreeBSD Projektnek tudomása volt a védjegyrõl, a megnevezést a “™” vagy a “®” szimbólum követi.</p></details></div><div class=toc-mobile><h3>Table of Contents</h3><nav id=TableOfContents><ul><li><a href=#book-preface>Előszó</a><ul><li><a href=#preface-audience>Kiknek szánjuk ezt a könyvet</a></li><li><a href=#preface-changes-from3>Változtatások a harmadik kiadás óta</a></li><li><a href=#preface-changes-from2>Változtatások a második kiadás (2004) óta</a></li><li><a href=#preface-changes>Változtatások az elsõ kiadás (2001) óta</a></li><li><a href=#preface-overview>A könyv felépítése</a></li><li><a href=#preface-conv>A könyvben alkalmazott konvenciók</a></li><li><a href=#preface-acknowledgements>Köszönetnyilvánítás</a></li></ul></li><li><a href=#getting-started>Part I: Bevezetés</a><ul><li><a href=#introduction>Chapter 1. Bemutatkozás</a></li><li><a href=#install>Chapter 2. A FreeBSD telepítése</a></li><li><a href=#basics>Chapter 3. A UNIX alapjai</a></li><li><a href=#ports>Chapter 4. Alkalmazások telepítése: csomagok és portok</a></li><li><a href=#x11>Chapter 5. Az X Window System</a></li></ul></li><li><a href=#common-tasks>Part II: Gyakori feladatok</a><ul><li><a href=#desktop>Chapter 6. II. Rész Gyakori feladatok</a></li><li><a href=#multimedia>Chapter 7. Multimédia</a></li><li><a href=#kernelconfig>Chapter 8. A FreeBSD rendszermag testreszabása</a></li><li><a href=#printing>Chapter 9. Nyomtatás</a></li><li><a href=#linuxemu>Chapter 10. Bináris Linux kompatibilitás</a></li></ul></li><li><a href=#system-administration>Part III: Rendszeradminisztráció</a><ul><li><a href=#config-tuning>Chapter 11. Beállítás és finomhangolás</a></li><li><a href=#boot>Chapter 12. A FreeBSD rendszerindítási folyamata</a></li><li><a href=#users>Chapter 13. Felhasználók és hozzáférések alapvető kezelése</a></li><li><a href=#security>Chapter 14. Biztonság</a></li><li><a href=#jails>Chapter 15. A jail alrendszer</a></li><li><a href=#mac>Chapter 16. Kötelező hozzáférés-vezérlés (MAC)</a></li><li><a href=#audit>Chapter 17. Biztonsági események vizsgálata</a></li><li><a href=#disks>Chapter 18. Háttértárak</a></li><li><a href=#geom>Chapter 19. GEOM: A moduláris lemezszervező rendszer</a></li><li><a href=#filesystems>Chapter 20. Támogatott állományrendszerek</a></li><li><a href=#vinum-vinum>Chapter 21. A Vinum kötetkezelő</a></li><li><a href=#virtualization>Chapter 22. Virtualizáció</a></li><li><a href=#l10n>Chapter 23. Honosítás - Az I18N/L10N használata és beállítása</a></li><li><a href=#updating-upgrading>Chapter 24. A FreeBSD frissítése és frissen tartása</a></li><li><a href=#dtrace>Chapter 25. DTrace</a></li></ul></li><li><a href=#network-communication>Part IV: Hálózati kommunikáció</a><ul><li><a href=#serialcomms>Chapter 26. Soros vonali kommunikáció</a></li><li><a href=#ppp-and-slip>Chapter 27. A PPP és a SLIP</a></li><li><a href=#mail>Chapter 28. Elektronikus levelezés</a></li><li><a href=#network-servers>Chapter 29. Hálózati szerverek</a></li><li><a href=#firewalls>Chapter 30. Tűzfalak</a></li><li><a href=#advanced-networking>Chapter 31. Egyéb haladó hálózati témák</a></li></ul></li><li><a href=#appendices>Part V: Függelék</a><ul><li><a href=#mirrors>Függelék A: A FreeBSD beszerzése</a></li><li><a href=#bibliography>Függelék B: Irodalomjegyzék</a></li><li><a href=#eresources>Függelék C: Források az interneten</a></li><li><a href=#pgpkeys>Függelék D: PGP-kulcsok</a></li></ul></li></ul></nav></div><div class=book-content><div id=preamble><div class=sectionbody><div class="quoteblock abstract abstract-title"><blockquote>Kivonat</blockquote></div><div class=paragraph><p>Üdvözöljük a FreeBSD világában! Ez a kézikönyv ismerteti a <em>FreeBSD 11.2-RELEASE</em>, ill. a <em>FreeBSD 12.0-RELEASE</em> telepítését és használatát a mindennapokban. A kézikönyv tartalmán számos független fejlesztõ <em>folyamatosan dolgozik</em>. Emiatt elképzelhetõ, hogy bizonyos fejezetek már elavultak és aktualizálásra szorulnak. Amennyiben úgy érezzük, hogy segíteni tudnánk a projekt munkájában, értesítsük a fejlesztõket a <a href=https://lists.FreeBSD.org/subscription/freebsd-doc>FreeBSD Dokumentációs Projekt levelezési lista</a> címén! Ezen dokumentum legfrissebb változata mindig elérhetõ a <a href=http://www.FreeBSD.org/>FreeBSD honlapjáról</a> (a korábbi változatok pedig megtalálhatóak a <a href=http://docs.FreeBSD.org/doc/>http://docs.FreeBSD.org/doc/</a> címen). Ezenkívül még rengeteg más formátumban és tömörítve is letölthetõ a <a href=ftp://ftp.FreeBSD.org/pub/FreeBSD/doc/>FreeBSD FTP szerverérõl</a> vagy a <a href=#mirrors-ftp>tüköroldalak</a> egyikérõl. Amennyiben a kézikönyv nyomtatott változatára lenne szükségünk, megvásárolhatjuk a <a href=http://www.freebsdmall.com/>FreeBSD Mall</a>-ból. Ha pedig keresni szeretnénk benne, azt a funkciót <a href=https://www.FreeBSD.org/search/>itt</a> érhetjük el.</p></div><div class=paragraph><p><em>Fordította: Páli Gábor, utolsó ellenõrzés: 2010.11.28.</em></p></div><hr></div></div><div class=sect1><h2 id=book-preface>Előszó<a class=anchor href=#book-preface></a></h2><div class=sectionbody><div class=sect2><h3 id=preface-audience>Kiknek szánjuk ezt a könyvet<a class=anchor href=#preface-audience></a></h3><div class=paragraph><p>A FreeBSD-t még nem ismerõk felfedezhetik, hogy a könyv elsõ része a FreeBSD telepítésének folyamatán vezeti keresztül a felhasználót, valamint érintõlegesen bemutatja az ezt alátámasztó UNIX®-os alapfogalmakat és szabályokat. Ennek a résznek a végigjárása nem kíván többet, csupán egy kis felfedezõ kedvet, illetve a menet közben bemutatott új fogalmak befogadását.</p></div><div class=paragraph><p>Ha túljutottunk rajta, a kézikönyv második, jóval terjedelmesebb része a FreeBSD-t használó rendszergazdák számára nyújt mindenféle témában minden részletre kiterjedõ referenciát. Ezek közül egyes fejezetek elvárnak némi elõzetes felkészülést, amelyet minden fejezet áttekintésében említeni is fogunk.</p></div><div class=paragraph><p>További információkért olvassuk át a <a href=./#bibliography>Irodalomjegyzék</a>et.</p></div></div><div class=sect2><h3 id=preface-changes-from3>Változtatások a harmadik kiadás óta<a class=anchor href=#preface-changes-from3></a></h3><div class=paragraph><p>A kézikönyv jelenleg interneten elérhetõ változata számtalan önkéntes által az utóbbi 10 évben végzett együttes erõfeszítéseinek eredményeit tükrözi. A 2004-ben két kötetben megjelentetett harmadik kiadás óta a következõ fontosabb változások történtek:</p></div><div class=ulist><ul><li><p><a href=./#dtrace>DTrace</a>: készült egy új fejezet a DTrace nevû teljesítmény-elemzõ eszközrõl.</p></li><li><p><a href=./#filesystems>Támogatott állományrendszerek</a>: ebben a fejezetben a FreeBSD és a különbözõ más rendszerekhez fejlesztett állományrendszerek viszonyát mutatjuk be, többek a Sun™ ZFS megoldását.</p></li><li><p><a href=./#audit>Biztonsági események vizsgálata</a>: ez a fejezet FreeBSD új biztonsági fejlesztéseit foglalja össze és mutatja be a használatukat.</p></li><li><p><a href=./#virtualization>Virtualizáció</a>: ebben az új fejezetben a FreeBSD rendszerhez és rajta elérhetõ különbözõ virtualizációs technológiákról szólunk.</p></li></ul></div></div><div class=sect2><h3 id=preface-changes-from2>Változtatások a második kiadás (2004) óta<a class=anchor href=#preface-changes-from2></a></h3><div class=paragraph><p>A harmadik kiadás a FreeBSD Dokumentációs Projekt tagjainak két évi kemény munkájának gyümölcse. A nyomtatott változat már olyan nagyra nõtt, hogy két külön kötetben kellett kiadnunk. Az alábbi fontosabb változtatások jelentek meg ebben az új kiadásban:</p></div><div class=ulist><ul><li><p><a href=./#config-tuning>Beállítás és finomhangolás</a>: a beállításra és finomhangolásra vonatkozó részeket bõvítettük az ACPI energia- és erõforrás gazdálkodásról szóló részekkel, a <code>cron</code> rendszerprogrammal, illetve még több, a rendszermag finomhangolását elõsegítõ opció leírásával.</p></li><li><p><a href=./#security>Biztonság</a>: a biztonságról szóló részt bõvítettük a virtuális magánhálózatokról (VPN-ekrõl), állományrendszeri hozzáférés-vezérlési listákról (ACL-ek) szóló elemekkel, valamint biztonságtechnikai tanácsokkal.</p></li><li><p><a href=./#mac>Kötelező hozzáférés-vezérlés (MAC)</a>: a kötelezõ hozzáférés-vezérlésrõl (MAC-rõl) szóló fejezet teljesen új ebben a kiadásban. Bemutatja, mi is az a MAC és hogyan hasznosítható egy FreeBSD-s rendszer biztonságossá tételében.</p></li><li><p><a href=./#disks>Háttértárak</a>: a háttértárakat tartalmazó részt bõvítettük az USB-tárakról, állományrendszeri pillanatképeirõl, lemezkvótákról, állomány- és hálózat alapú állományrendszerekrõl, továbbá a titkosított partíciókról szóló részekkel.</p></li><li><p><a href=./#vinum-vinum>A Vinum kötetkezelő</a>: a Vinum egy új fejezet ebben a kiadásban. Bemutatja a Vinum logikaikötet-kezelõ használatát, aminek segítségével eszközfüggetlen módon hozhatunk létre logikai lemezeket, szoftveres RAID-0, RAID-1 és RAID-5 konfigurációkat.</p></li><li><p>Bekerült egy hibaelhárításról szóló rész a <a href=./#ppp-and-slip>A PPP és a SLIP</a> PPP és SLIP leírásához.</p></li><li><p><a href=./#mail>Elektronikus levelezés</a>: az elektronikus levelezést ismertetõ részt bõvítettük a különféle levéltovábbító rendszerekrõl, az SMTP hitelesítésrõl, UUCP protokollról, a fetchmail és procmail programokról szóló elemekkel, valamint egyéb, haladókat megcélzó témákkal.</p></li><li><p><a href=./#network-servers>Hálózati szerverek</a>: a hálózati szervereket ismertetõ rész egy teljesen új fejezet ebben a kiadásban. Benne megtalálható az Apache HTTP szerver, az ftpd szerver, illetve a Microsoft® Windows®-os kliensek számára megfelelõ Samba szerver beállítása. Az érthetõség kedvéért egyes részek átkerültek ide a <a href=./#advanced-networking>Egyéb haladó hálózati témák</a>, vagyis a haladó hálózati témákat tárgyaló fejezetbõl.</p></li><li><p><a href=./#advanced-networking>Egyéb haladó hálózati témák</a>: a haladó hálózati témákat tartalmazó részt kiegészítettük a FreeBSD és a Bluetooth® eszközök kapcsolatáról, a vezeték nélküli hálózatokról és az aszinkron adatátvitel módról (ATM-rõl) szóló ismeretekkel.</p></li><li><p>Létrehoztunk egy szójegyzéket abból a célból, hogy a könyvben használt definíciók és szakkifejezések egyetlen központi helyen össze legyenek foglalva.</p></li><li><p>Számos esztétikai javítást eszközöltünk a könyvben található ábrákon és táblázatokon.</p></li></ul></div></div><div class=sect2><h3 id=preface-changes>Változtatások az elsõ kiadás (2001) óta<a class=anchor href=#preface-changes></a></h3><div class=paragraph><p>A második kiadás a FreeBSD Dokumentációs Projekt tagjainak két évi komoly munkájának eredménye. Az alábbi fontosabb változtatások jelennek meg ebben a kiadásban:</p></div><div class=ulist><ul><li><p>Bekerült egy teljes tárgy- és névmutató.</p></li><li><p>Mindegyik ASCII-ábrát grafikusak váltották fel.</p></li><li><p>Mindegyik fejezet elejére odakerült egy általános áttekintés, ami egy rövid összefoglalást ad a fejezet tartalmáról, valamint közli az elolvasásához szükséges ismereteket.</p></li><li><p>A tartalmat felosztottuk logikailag három részre: "Bevezetés", "Rendszeradminisztráció" és "Függelék".</p></li><li><p>A <a href=./#install>A FreeBSD telepítése</a>et ("A FreeBSD telepítése") teljesen újraírtuk és sok-sok illusztráció is hozzáadásra került a könnyebb megértés érdekében.</p></li><li><p>A <a href=./#basics>A UNIX alapjai</a> ("A UNIX® alapjai") kiegészült a futó programokról, démonokról és jelzésekrõl szóló további hasznos információkkal.</p></li><li><p>A <a href=./#ports>Alkalmazások telepítése. csomagok és portok</a>et ("Alkalmazások telepítése") bõvítettük a bináris csomagkezelésrõl szóló további ismeretekkel.</p></li><li><p>A <a href=./#x11>Az X Window System</a> ("Az X Window System") teljes újraíráson ment át, aminek folyamán igyekeztünk nagyobb hangsúlyt helyezni a modern asztali technológiák, mint pl. a KDE és GNOME XFree86™ 4.X-en történõ használatának leírására.</p></li><li><p>A <a href=./#boot>A FreeBSD rendszerindítási folyamata</a> ("A FreeBSD rendszerindítási folyamata") kibõvült.</p></li><li><p>A <a href=./#disks>Háttértárak</a> ("Háttértárak") két, korábban külön levõ fejezet, a "Lemezek" és "Biztonsági mentések" összeolvasztásából jött létre. Úgy éreztük, a bennük helyet kapott témákat sokkal könnyebb úgy megérteni, ha egyetlen fejezetben tárgyaljuk ezeket. Egy (hardveres és szoftveres) RAID-rõl szóló rész is belekerült.</p></li><li><p>A <a href=./#serialcomms>Soros vonali kommunikáció</a> ("Soros vonali kommunikáció") teljes átszervezésre került, valamint a FreeBSD 4.X/5.X verziókhoz igazítottuk.</p></li><li><p>A <a href=./#ppp-and-slip>A PPP és a SLIP</a> ("A PPP és a SLIP") lényegesen sokat fejlõdött.</p></li><li><p>Számos új rész került a <a href=./#advanced-networking>Egyéb haladó hálózati témák</a>be ("Egyéb haladó hálózati témák").</p></li><li><p>A <a href=./#mail>Elektronikus levelezés</a> ("Elektronikus levelezés") kibõvült a sendmail beállításáról tartalmazó újabb információkkal.</p></li><li><p>A <a href=./#linuxemu>Bináris Linux kompatibilitás</a> ("Bináris Linux kompatibilitás") kiegészült az Oracle® és a SAP® R/3® telepítését bemutató részekkel.</p></li><li><p>Az alábbi új témák kerültek tárgyalásra a második kiadásban:</p><div class=ulist><ul><li><p>Beállítás és finomhangolás (<a href=./#config-tuning>Beállítás és finomhangolás</a>)</p></li><li><p>Multimédia (<a href=./#multimedia>Multimédia</a>)</p></li></ul></div></li></ul></div></div><div class=sect2><h3 id=preface-overview>A könyv felépítése<a class=anchor href=#preface-overview></a></h3><div class=paragraph><p>A könyvet négy logikailag elkülönülõ részre osztottuk fel. Az elsõ, <em>Bevezetés</em> címû részben bemutatjuk a FreeBSD telepítését és használatának alapjait. Elgondolásunk szerint az itt szereplõ fejezeteket sorban érdemes elolvasni, esetenként kihagyni azokat, amelyek már az olvasó számára ismert témákat dolgoznak fel. A második, <em>Gyakori feladatok</em> címû részben megismerhetjük a FreeBSD néhány gyakorta használt lehetõségét. Ez a rész, valamint az ezt követõ összes többi tetszõleges sorrendben olvasható. Mindegyik fejezet egy rövidke összefoglalással kezdõdik, amely ismerteti, az olvasótól milyen jellegû tapasztalatokat vár el a fejezet megértése. Célja, hogy segítsen az olvasónak megtalálni a számára érdekes témákat. A harmadik, <em>Rendszeradminisztráció</em> címû részben rendszergazdai feladatokat tárgyalunk. A negyedik, <em>Hálózati kommunikáció</em> címû részben hálózatok és szerverek üzemeltetésével kapcsolatos ismereteket foglaltunk össze. Végül, az ötödik rész tartalmazza a függeléket és az irodalomjegyzéket, hivatkozásokat.</p></div><div class=dlist><dl><dt class=hdlist1><em><a href=./#introduction>Bemutatkozás</a>: Bemutatkozás</em></dt><dd><p>A FreeBSD bemutatkozik az új felhasználóknak. Szó esik a FreeBSD Projekt történetérõl, célkitûzéseirõl és a fejlesztési modelljérõl.</p></dd><dt class=hdlist1><em><a href=./#install>A FreeBSD telepítése</a>: A FreeBSD telepítése</em></dt><dd><p>Végigvezetjük a felhasználót a telepítési folyamat egészén. Bizonyos rendhagyó kérdések, mint például a soros konzolon keresztül történõ telepítés is terítékre kerülnek.</p></dd><dt class=hdlist1><em><a href=./#basics>A UNIX alapjai</a>: A UNIX® alapjai</em></dt><dd><p>Sorra vesszük a FreeBSD operációs rendszer alapvetõ parancsait és lehetõségeit. Amennyiben már jártasak vagyunk valamilyen szinten a Linux® vagy más UNIX®-típusú rendszerek használatában, nyugodtan kihagyhatjuk ezt a fejezetet.</p></dd><dt class=hdlist1><em><a href=./#ports>Alkalmazások telepítése. csomagok és portok</a>: Alkalmazások telepítése, csomagok és portok</em></dt><dd><p>Megismerhetjük, miként tudunk külsõ cégek által fejlesztett alkalmazásokat telepíteni a FreeBSD "Portgyûjteményének" (FreeBSD Ports Collection) vagy a megszokott bináris csomagok használatán keresztül.</p></dd><dt class=hdlist1><em><a href=./#x11>Az X Window System</a>: Az X Window System</em></dt><dd><p>Általános bemutatásra kerül az X Window System, valamint az X11 használata a FreeBSD-n. Ezenkívül olvashatunk az elterjedtebb munkakörnyezetekrõl, mint pl. a KDE és a GNOME.</p></dd><dt class=hdlist1><em><a href=./#desktop>Asztali alkalmazások</a>: Asztali alkalmazások</em></dt><dd><p>Felsoroljuk az ismertebb asztali alkalmazásokat: webböngészõket és alkalmazói programcsomagokat, és bemutatjuk, hogyan telepítsük ezeket FreeBSD-re.</p></dd><dt class=hdlist1><em><a href=./#multimedia>Multimédia</a>: Multimédia</em></dt><dd><p>Megtudhatjuk, hogyan állítsuk be a zene- és videolejátszást rendszerünkön. Emellett olvashatunk néhány multimédiás alkalmazás használatáról is.</p></dd><dt class=hdlist1><em><a href=./#kernelconfig>A FreeBSD rendszermag testreszabása</a>: A FreeBSD rendszermag testreszabása</em></dt><dd><p>Kifejtjük, miért lehet szükségünk egy új rendszermag konfigurálására, és részletesen végigjárjuk egy rendszermag konfigurációjának, fordításának és telepítésének lépéseit.</p></dd><dt class=hdlist1><em><a href=./#printing>Nyomtatás</a>: Nyomtatás</em></dt><dd><p>Ismertetjük, hogyan lehet nyomtatókat használni FreeBSD alatt, beleértve a munkalapok készítésének mikéntjét, a nyomtatóhasználat nyilvántartását és a kezdeti beállításokat.</p></dd><dt class=hdlist1><em><a href=./#linuxemu>Bináris Linux kompatibilitás</a>: Bináris Linux kompatibilitás</em></dt><dd><p>Megismerhetjük a FreeBSD bináris Linux kompabilitásához kapcsolódó lehetõségeket. Ezenfelül részletekre is kitérõ telepítési útmutatót találhatunk különbözõ népszerû linuxos alkalmazásokhoz, mint például az Oracle®, SAP® R/3® és a Mathematica®.</p></dd><dt class=hdlist1><em><a href=./#config-tuning>Beállítás és finomhangolás</a>: Beállítás és finomhangolás</em></dt><dd><p>Megismerhetjük a FreeBSD azon paramétereit, amelyek megfelelõ állításával a rendszergazdák a lehetõ legtöbbet képesek kihozni FreeBSD rendszerükbõl. Ezenkívül bemutatásra kerül a FreeBSD-ben használt számos konfigurációs állomány, valamint hogy ezeket hol találhatjuk meg.</p></dd><dt class=hdlist1><em><a href=./#boot>A FreeBSD rendszerindítási folyamata</a>: A FreeBSD rendszerindítási folyamata</em></dt><dd><p>Tartalmazza a FreeBSD rendszerindítási folyamatának leírását, és elmagyarázza, miként lehet ezt vezérelni a konfigurációs beállítások segítségével.</p></dd><dt class=hdlist1><em><a href=./#users>Felhasználók és hozzáférések alapvető kezelése</a>: Felhasználók és hozzáférések alapvetõ kezelése</em></dt><dd><p>Bemutatja a felhasználói fiókok létrehozását és kezelését. Emellett megemlíti a felhasználókra érvényesíthetõ erõforrás-megszorításokat, illetve egyéb fiókkezelési feladatokat.</p></dd><dt class=hdlist1><em><a href=./#security>Biztonság</a>: Biztonság</em></dt><dd><p>Bemutatásra kerül a FreeBSD rendszerünk biztonságossá tételére alkalmas számos különféle eszköz, többek közt a Kerberos, IPsec és az OpenSSH.</p></dd><dt class=hdlist1><em><a href=./#jails>A jail alrendszer</a></em>: A jail alrendszer_</dt><dd><p>Megtudhatjuk, hogyan mûködik az alkalmazások elszigeteléséért felelõs jail alrendszer, valamint miben emelkedik ki a FreeBSD-ben is megtalálható hagyományos "chroot" megoldással szemben.</p></dd><dt class=hdlist1><em><a href=./#mac>Kötelező hozzáférés-vezérlés (MAC)</a>: Kötelezõ hozzáférés-vezérlés</em></dt><dd><p>Megismerhetjük a kötelezõ hozzáférés-vezérlést (MAC-et), valamint azt, hogyan is tudjuk felhasználni egy FreeBSD-s rendszer biztonsága érdekében.</p></dd><dt class=hdlist1><em><a href=./#audit>Biztonsági események vizsgálata</a>: Biztonsági események vizsgálata</em></dt><dd><p>Kiderül, mit jelent a FreeBSD-ben az események vizsgálata, illetve mindez hogyan telepíthetõ, konfigurálható és miként tudjuk a vizsgálatok adatait kielemezni vagy felügyelni.</p></dd><dt class=hdlist1><em><a href=./#disks>Háttértárak</a>: Háttértárak</em></dt><dd><p>Bemutatásra kerül, miként kezelhetjük a háttértárolókat és állományrendszereket a FreeBSD-ben. Ide tartoznak a fizikai lemezek, RAID-tömbök, optikai és szalagos egységek, memória alapú lemezek és a hálózati állományrendszerek.</p></dd><dt class=hdlist1><em><a href=./#geom>GEOM. a moduláris lemezszervező rendszer</a>: GEOM, a moduláris lemezszervezõ rendszer</em></dt><dd><p>Megismerhetjük a FreeBSD-ben jelenlevõ GEOM alrendszert és az általa támogatott különbözõ RAID-szintek beállítását.</p></dd><dt class=hdlist1><em><a href=./#filesystems>Támogatott állományrendszerek</a>: Támogatott állományrendszerek</em></dt><dd><p>A FreeBSD operációs rendszer számára nem natív állományrendszerekkel foglalkozik, például a Sun™ Z állományrendszerével.</p></dd><dt class=hdlist1><em><a href=./#vinum-vinum>A Vinum kötetkezelő</a>: A Vinum kötetkezelõ</em></dt><dd><p>Megtudhatjuk, hogyan használjuk a Vinumot, a logikaikötet-kezelõt, amely eszközfüggetlen logikai lemezeket, szoftveres RAID-0, RAID-1 és RAID-5 konfigurációkat biztosít.</p></dd><dt class=hdlist1><em><a href=./#virtualization>Virtualizáció</a>: Virtualizáció</em></dt><dd><p>Tartalmazza a virtualizációs rendszerek által felkínált lehetõségek bemutatását és használatát a FreeBSD-vel.</p></dd><dt class=hdlist1><em><a href=./#l10n>Honosítás. Az I18N/L10N használata és beállítása</a>: Honosítás, az I18N/L10N használata és beállítása</em></dt><dd><p>Bemutatja, hogyan használjuk a FreeBSD-t a rendszer és az alkalmazások szintjén az angoltól eltérõ nyelveken.</p></dd><dt class=hdlist1><em><a href=./#updating-upgrading>A FreeBSD frissítése és frissen tartása</a>: A FreeBSD frissítése és frissen tartása</em></dt><dd><p>Elmagyarázza, mik az alapvetõ különbségek a FreeBSD-STABLE, FreeBSD-CURRENT verziók, valamint a FreeBSD kiadások között. Bemutatja, mely felhasználók lehetnek azok, akik a legtöbbet tudnak profitálni egy fejlesztõi rendszer használatából, illetve körvonalazza ennek folyamatát. Továbbá röviden összefoglalja azokat az eszközöket, amelyekkel a felhasználók frissíthetik a rendszerüket a biztonsági és kritikus hibák javításakor.</p></dd><dt class=hdlist1><em><a href=./#dtrace>DTrace</a>: DTrace</em></dt><dd><p>A Sun™ DTrace eszközének beállítását és használatát mutatja be. A segítségével megvalósított dinamikus nyomkövetéssel lehetõségünk nyílik valós idejû elemzéseken keresztül felderíteni a különbözõ teljesítménybeli problémákat.</p></dd><dt class=hdlist1><em><a href=./#serialcomms>Soros vonali kommunikáció</a>: Soros vonali kommunikáció</em></dt><dd><p>Kifejti, hogyan csatlakoztassunk terminált vagy modemet a FreeBSD rendszerünkhöz, ha behívó vagy betárcsázós kapcsolatot szeretnénk létrehozni.</p></dd><dt class=hdlist1><em><a href=./#ppp-and-slip>A PPP és a SLIP</a>: A PPP és a SLIP</em></dt><dd><p>Bemutatja, miként tudjuk PPP-n, SLIP-en és Etherneten keresztüli PPP-vel (PPPoE) összekapcsolni a FreeBSD-t távoli rendszerekkel.</p></dd><dt class=hdlist1><em><a href=./#mail>Elektronikus levelezés</a>: Elektronikus levelezés</em></dt><dd><p>Megismerhetjük egy elektronikus levelezõ szerver különféle komponenseit, és elmélyedhetünk az egyik leghíresebb levelezõszerver-szoftver, a sendmail használatában és felületesebb konfigurálásában.</p></dd><dt class=hdlist1><em><a href=./#network-servers>Hálózati szerverek</a>: Hálózati szerverek</em></dt><dd><p>Részletekbe menõen és konfigurációs példákkal mutatja be, miként tudunk hálózati állományrendszer kiszolgálónak, névszervernek, hálózati információs rendszer kiszolgálónak vagy idõszinkronizációs szervernek beállítani egy FreeBSD-s számítógépet.</p></dd><dt class=hdlist1><em><a href=./#firewalls>Tűzfalak</a>: Tûzfalak</em></dt><dd><p>Kifejti a szoftveres tûzfalak mögött álló filozófiát, valamint részletesen tárgyalja a különbözõ, FreeBSD-n elérhetõ tûzfalak konfigurációját.</p></dd><dt class=hdlist1><em><a href=./#advanced-networking>Egyéb haladó hálózati témák</a>: Egyéb haladó hálózati témák</em></dt><dd><p>Feldolgoz számos hálózati témát, beleértve az internet kapcsolat helyi hálózaton (LAN-on) keresztül történõ megosztását több számítógép között, haladó forgalomirányítási kérdéseket, vezeték nélküli hálózatok beállítását, Bluetooth®, ATM, IPv6 és sok minden mással kapcsolatos információkat.</p></dd><dt class=hdlist1><em><a href=./#mirrors>A FreeBSD beszerzése</a>: A FreeBSD beszerzése</em></dt><dd><p>Felsorolja azokat a forrásokat, ahonnan a FreeBSD CD-n vagy DVD-n beszerezhetõ, valamint azokat a honlapokat, ahonnan letölthetõ vagy telepíthetõ a FreeBSD.</p></dd><dt class=hdlist1><em><a href=./#bibliography>Irodalomjegyzék</a>: Irodalomjegyzék</em></dt><dd><p>A könyv sok tekintetben olyan témákat is érint, amelyek felkelthetik az olvasó érdeklõdését és ezek kapcsán bõvebb magyarázatra vágyik. Az irodalomjegyzékben ezért összeírtunk számos remek könyvet, amelyekre hivatkozunk is a fejezetekben.</p></dd><dt class=hdlist1><em><a href=./#eresources>Források az interneten</a>: Erõforrások az interneten</em></dt><dd><p>Tartalmazza a FreeBSD felhasználók számára elérhetõ azon fórumokat, ahová beküldhetik kérdéseiket, illetve szakmai jellegû társalgásokat folytathatnak.</p></dd><dt class=hdlist1><em><a href=./#pgpkeys>PGP-kulcsok</a>: PGP-kulcsok</em></dt><dd><p>Az egyes FreeBSD fejlesztõk PGP-kulcsait sorolja fel.</p></dd></dl></div></div><div class=sect2><h3 id=preface-conv>A könyvben alkalmazott konvenciók<a class=anchor href=#preface-conv></a></h3><div class=paragraph><p>A könnyebb és egységesebb olvashatóság kedvéért az alábbi konvenciókat igyekeztünk követni a könyvben.</p></div><div class=sect3><h4 id=preface-conv-typographic>Tipográfiai konvenciók<a class=anchor href=#preface-conv-typographic></a></h4><div class=dlist><dl><dt class=hdlist1><em>Dõlt</em></dt><dd><p>A <em>dõlt</em> betûket állománynevek, URL-ek, kiemelt szövegek és a szakmai kifejezések elsõ elõfordulásakor használjuk.</p></dd><dt class=hdlist1><code>Írógépszerû</code></dt><dd><p>Az <code>írógépszerû</code> betûket hibaüzenetek, parancsok, környezeti változók, portok, számítógépek, felhasználók, csoportok, eszközök nevei, változók és kódrészletek esetén használjuk.</p></dd><dt class=hdlist1>Félkövér</dt><dd><p>A félkövér betûket alkalmazások, parancsok és billentyûk megnevezésénél használjuk.</p></dd></dl></div></div><div class=sect3><h4 id=preface-conv-commands>Felhasználói bevitel<a class=anchor href=#preface-conv-commands></a></h4><div class=paragraph><p>A billentyûket <strong>félkövérrel</strong> írjuk, hogy kiemelkedjenek a szöveg többi részébõl. Az egyszerre megnyomni kívánt billentyûk kombinációját a <code>+</code> jelöléssel adjuk meg, mint például:</p></div><div class=paragraph><p><span class=keyseq><kbd>Ctrl</kbd>+<kbd>Alt</kbd>+<kbd>Del</kbd></span></p></div><div class=paragraph><p>Ez azt jelenti, hogy a felhasználónak a <kbd>Ctrl</kbd>, <kbd>Alt</kbd> és <kbd>Del</kbd> billentyûket egyszerre kell lenyomnia.</p></div><div class=paragraph><p>Azokat a billentyûket, amelyeket egymás után kell lenyomni, vesszõvel választjuk el, például:</p></div><div class=paragraph><p><span class=keyseq><kbd>Ctrl</kbd>+<kbd>X</kbd></span>, <span class=keyseq><kbd>Ctrl</kbd>+<kbd>S</kbd></span></p></div><div class=paragraph><p>Ez tehát azt jelenti, hogy a felhasználónak elõször a <kbd>Ctrl</kbd> és <kbd>X</kbd> billentyûket, majd a <kbd>Ctrl</kbd> és <kbd>S</kbd> billentyûket kell egyszerre lenyomnia.</p></div></div><div class=sect3><h4 id=preface-conv-examples>Példák<a class=anchor href=#preface-conv-examples></a></h4><div class=paragraph><p>A <span class=filename>E:\></span> kijelzéssel kezdõdõ példák egy MS-DOS® parancsot jelölnek. Ha másképpen nem említjük, ezeket a parancsokat a modern Microsoft® Windows®-okban található "Parancssorból" kell kiadni.</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>E:<span class=se>\&gt;</span> tools<span class=se>\f</span>dimage floppies<span class=se>\k</span>ern.flp A:</code></pre></div></div><div class=paragraph><p>A # kijelzéssel kezdõdõ példák a FreeBSD-ben rendszeradminisztrátori jogokat igénylõ parancsok kiadását jelentik. Ehhez bejelentkezhetünk a <code>root</code> felhasználóval, vagy felvethetjük a rendszeradminisztrátori jogokat a saját felhasználói fiókunkból a <a href="https://man.freebsd.org/cgi/man.cgi?query=su&amp;sektion=1&amp;format=html">su(1)</a> használatával is.</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># dd if=kern.flp of=/dev/fd0</span></code></pre></div></div><div class=paragraph><p>A % kijelzéssel kezdõdõ példák olyan parancsra utalnak, amelyeket egy normál felhasználói fiókból érdemes kiadni. Hacsak másképpen nem jelezzük, a C-shell szintaxisát használjuk a környezeti változók és egyéb parancsok megadásakor.</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>% top</code></pre></div></div></div></div><div class=sect2><h3 id=preface-acknowledgements>Köszönetnyilvánítás<a class=anchor href=#preface-acknowledgements></a></h3><div class=paragraph><p>A könyv, amit itt most olvashatunk, több száz ember együttes munkájának eredménye a világ minden tájáról. Akár csak elgépeléseket javítottak, vagy komplett fejezeket adtak hozzá, minden hozzájárulás hasznosnak bizonyult.</p></div><div class=paragraph><p>Emellett sok cég anyagilag is támogatta a könyv fejlõdését, lehetõvé téve ezáltal, hogy a szerzõk teljes munkaidõben dolgozhassanak rajta, pénzt kapjanak az írásaikért stb. Leginkább a BSDi (amelyet késõbb felvásárolt a <a href=http://www.windriver.com>Wind River Systems</a>) adott teljes munkaidõs fizetést a FreeBSD Dokumentációs Projekt tagjainak a könyv gondozásához, amely végül az elsõ nyomtatott kiadás megjelentetéséhez vezetett 2000 márciusában (ISBN 1-57176-241-8). A Wind River Systems ezt követõen további szerzõket is finanszírozott a nyomtatási-szedési infrastruktúra továbbfejlesztéséhez és a könyv tartalmának bõvítéséhez. Ennek eredménye lett a második nyomtatott kiadás, amely 2001 novemberében jelent meg (ISBN 1-57176-303-1). 2003 - 2004 folyamán a <a href=http://www.freebsdmall.com>FreeBSD Mall, Inc.</a> támogatott anyagilag számos hozzájárulót a kézikönyvet illetõ munkájáért, a harmadik nyomtatott kiadásra történõ elõkészítésben.</p></div></div></div></div><h1 id=getting-started class=sect0>Part I: Bevezetés<a class=anchor href=#getting-started></a></h1><div class="openblock partintro"><div class=content><div class=paragraph><p>A FreeBSD kézikönyv ezen része azoknak a felhasználóknak és rendszergazdáknak szól, akik még nem ismerik a FreeBSD-t. A fejezetek:</p></div><div class=ulist><ul><li><p>Bemutatják a FreeBSD-t.</p></li><li><p>Végigvezetnek a telepítés folyamatán.</p></li><li><p>Ismertetik a UNIX® alapjait.</p></li><li><p>Megmutatják, hogyan telepítsük a FreeBSD-hez elérhetõ megannyi külsõ alkalmazást.</p></li><li><p>Megismerhetjük az X-et, a UNIX®-os ablakozórendszert, és részleteiben is láthatjuk, miként konfiguráljunk be egy munkakörnyezetet, amellyel kényelmesebbé válik a munka.</p></li></ul></div><div class=paragraph><p>A fejezetek megírása során arra törekedtünk, hogy minél kevesebb hivatkozást tegyünk a könyv késõbb következõ részeire, így ennek köszönhetõen a kézikönyv ezen része anélkül olvasható, hogy közben folyamatosan elõre-hátra kellene lapozgatnunk benne.</p></div></div></div><div class=sect1><h2 id=introduction>Chapter 1. Bemutatkozás<a class=anchor href=#introduction></a></h2><div class=sectionbody><div class=sect2><h3 id=introduction-synopsis>1.1. Áttekintés<a class=anchor href=#introduction-synopsis></a></h3><div class=paragraph><p>Köszönjük, hogy érdeklõdik a FreeBSD iránt! A fejezet a FreeBSD Projektet több különbözõ vonatkozásban mutatja be: a történetét, a céljait, a fejlesztési modelljét és így tovább.</p></div><div class=paragraph><p>A fejezet elolvasása során megismerjük:</p></div><div class=ulist><ul><li><p>hogyan viszonyul a FreeBSD más operációs rendszerekhez;</p></li><li><p>a FreeBSD Projekt történetét;</p></li><li><p>a FreeBSD Projekt célkitûzéseit;</p></li><li><p>a FreeBSD nyílt forráskódú fejlesztési modelljének alapjait;</p></li><li><p>és természetesen: hogyan is keletkezett a "FreeBSD" név.</p></li></ul></div></div><div class=sect2><h3 id=nutshell>1.2. Üdvözöljük a FreeBSD-ben!<a class=anchor href=#nutshell></a></h3><div class=paragraph><p>A FreeBSD egy 4.4BSD-Lite alapú operációs rendszer Intel® (x86 és Itanium®), AMD64, Alpha™, Sun UltraSPARC® számítógépekre. Jelenleg is portolás alatt áll további architektúrákra. Olvashatunk a <a href=#history>FreeBSD történetérõl</a> vagy éppen az <a href=#relnotes>aktuális kiadásáról</a>. Ha szeretnénk hozzájárulni a Projekt fejlõdéséhez (forráskód, hardver vagy pénz), olvassuk el a <a href=https://docs.freebsd.org/en/articles/contributing/>Hozzájárulás a FreeBSD-hez</a> címû cikket (angolul).</p></div><div class=sect3><h4 id=os-overview>1.2.1. Mire képes a FreeBSD?<a class=anchor href=#os-overview></a></h4><div class=paragraph><p>A FreeBSD számos figyelemre méltó tulajdonságot tudhat magáénak. Ezek közül néhány:</p></div><div class=ulist><ul><li><p>A <em>preemptív ütemezés</em> dinamikusan szabályozható prioritások segítségével biztosítja a számítógép felhasználók és alkalmazások közti finom és igazságos megosztását, akár a legnagyobb terhelés esetén is.</p></li><li><p><em>Többfelhasználós rendszerként</em> lehetõvé teszi, hogy sokan tudják a FreeBSD-t egyszerre többféle dologra is használni. Például, ez azt jelenti, hogy a rendszerhez csatlakoztatott különbözõ perifériák, mint például a nyomtatók és szalagos egységek, megfelelõen szétoszthatóak a felhasználók között vagy éppen a hálózaton, és az egyes erõforrásokhoz a felhasználók vagy azok egy csoportja csak korlátozott módon férhetnek hozzájuk, elkerülve ezzel a rendszer számára létfontosságú erõforrások túlterhelését.</p></li><li><p>A <em>TCP/IP hálózati protokoll</em> gyors és megbízható implementációja, illetve a legfontosabb ipari szabványok, mint az SCTP, DHCP, NFS, NIS, PPP, SLIP, IPsec és IPv6 támogatása. Ezáltal egy FreeBSD-s számítógép könnyedén képes együttmûködni más rendszerekkel vagy akár vállalati szerverként is üzemelni. Megbirkózik az NFS (Network File System, távoli állományelérés) és az elektronikus levelezés megszervezésével ugyanúgy, ahogy a vállalatunk internetes elvárásaival a WWW, FTP és forgalomirányítási protokollokon keresztül és tûzfal iránti (biztonsági) igényeivel is.</p></li><li><p>A <em>memóriavédelem</em> megvalósítása gondoskodik róla, hogy az alkalmazások (vagy a felhasználók) ne zavarják egymást. Az egyik alkalmazás összeomlása nincs kihatással a rendszerben futó összes többire.</p></li><li><p>A FreeBSD egy <em>32 bites</em> operációs rendszer (az Alpha, Itanium®, AMD64 és UltraSPARC® architektúrákon pedig <em>64 bites</em>), amelyet már a kezdetektõl fogva annak terveztek.</p></li><li><p>A <em>X Window System</em> ipari szabványa (X11R7) alapján szolgáltatja a grafikus felhasználói felületet (GUI) bármelyik VGA-kártyán és monitoron, illetve annak teljes forráskódja is elérhetõ.</p></li><li><p><em>Bináris szintû kompatibilitás</em> a Linuxra, SCO-ra, SVR4-re, BSDI-re és NetBSD-re készített programok nagy részével.</p></li><li><p><em>Futtatásra kész</em> alkalmazások ezrei érhetõek el a FreeBSD <em>port-</em> és _csomag_gyûjteményében. Miért bújnánk az internetet értük, ha mindent egy helyen is megtalálhatunk?</p></li><li><p>További <em>könnyen portolható</em> alkalmazások ezrei állnak rendelkezésre az interneten. A FreeBSD forráskódja kompatibilis a legtöbb elterjedt kereskedelmi UNIX® rendszerével, aminek köszönhetõen az alkalmazások nagy része csak kevés módosítást igényel a fordításhoz, már amennyiben erre egyáltalán szükség van.</p></li><li><p>Az igény szerinti lapozással mûködõ <em>virtuális memória</em> és "egyesített VM/puffer gyorsítótár" úgy lett kialakítva, hogy hatékonyan kiszolgálja a nagyobb étvágyú alkalmazásokat, miközben a többi felhasználó számára továbbra is reakcióképes marad.</p></li><li><p>Az <em>SMP</em> támogatása a több processzorral rendelkezõ számítógépek számára.</p></li><li><p><em>C</em>, <em>C++</em> és <em>Fortran</em> fejlesztõi eszközök széles tárháza használható. Kutatáshoz és fejlesztéshez más egyéb programozási nyelvek is elérhetõek a portok és csomagok segítségével.</p></li><li><p>Az egész rendszer _forráskód_jának megléte lehetõvé teszi, hogy a legnagyobb fokú irányítást élvezhessük a környezetünk felett. Miért is bíznánk magunkat egy zárt rendszert fejlesztõ cégre, mikor lehetne egy igazán nyílt rendszerünk?</p></li><li><p>Nagy mennyiségû <em>internetes dokumentáció</em>.</p></li><li><p><em>Még sok minden más!</em></p></li></ul></div><div class=paragraph><p>A FreeBSD Kaliforniai Egyetem (Berkeley) Számítógépes rendszerek kutatócsoportja által fejlesztett 4.4BSD-Lite kiadásán alapszik és ápolja a BSD-rendszerek fejlesztésének jellegzetes hagyományait. Túl a kutatócsoport kivételes munkáján, a FreeBSD Projekt több ezernyi órát szentelt arra, hogy a legtöbbet hozza ki a rendszerbõl mind a teljesítményt, mind pedig a valós életben felbukkanó terhelési helyezetekben történõ helytállást illetõen. Ahogy a legnagyobb piaci óriások igyekeznek egy hasonló képességû, teljesítményû és megbízhatóságó PC-s operációs rendszert kifejleszteni, úgy a FreeBSD már <em>most</em> felajánlja ezeket!</p></div><div class=paragraph><p>Kizárólag csak a képzeletünk szabhat gátat annak, hogy mire is tudjuk használni a FreeBSD-t. Szoftverfejlesztéstõl kezdve, a gyári automatizáláson és készletnyilvántartáson át a mûholdas antennák tájolásáig szinte mindenre: ha ezt eddig egy kereskedelmi UNIX®-szal is meg tudtuk tenni, akkor nagyon valószínû, hogy a FreeBSD-vel is képesek leszünk erre! A FreeBSD ezen felül nagyban profitál a világban található különbözõ kutatóközpontok és egyetemek által fejlesztett, kiváló minõségû alkalmazások ezreibõl, melyek gyakorta olcsón vagy ingyen elérhetõek. Kereskedelmi alkalmazások is egyre nagyobb számban képviseltetik magukat minden nap.</p></div><div class=paragraph><p>Mivel a FreeBSD forráskódja általánosan elérhetõ, a rendszer szinte tetszõleges mértékben testreszabható a különleges elvárásokat támasztó alkalmazások vagy projektek számára. Ez a nagyobb kereskedelmi fejlesztõk operációs rendszereivel majdnem teljesen elképzelhetetlen. Íme csupán néhány példája azon alkalmazásoknak, melyek jelenleg is FreeBSD-t használnak:</p></div><div class=ulist><ul><li><p><em>Internetes szolgáltatások:</em> A FreeBSD-be épített szilárd TCP/IP alapú hálózatkezelés különféle internetes szolgáltatások számára teszi ideális platformmá:</p><div class=ulist><ul><li><p>FTP szerverek</p></li><li><p>World Wide Web szerverek (hagyományos vagy biztonságos [SSL])</p></li><li><p>IPv4 és IPv6 forgalomirányítás</p></li><li><p>Tûzfalak és NAT ("IP maszkolás"), átjárók</p></li><li><p>Elektronikus levelezõ szerverek</p></li><li><p>USENET hírrendszer és üzenõfal</p></li><li><p>Sok minden más…​</p><div class=paragraph><p>A FreeBSD használatához kezdetben elegendõ egy olcsó 386-os PC, melyet a vállalkozásunk fejlõdésével szépen fel tudunk hozni egy RAID-del ellátott négyprocesszoros Xeon rendszerig.</p></div></li></ul></div></li><li><p><em>Oktatás:</em> Esetleg informatikával vagy mûszaki informatikával foglalkozik? Nem is lehetne jobban a FreeBSD által felkínált élményeken kívül máshogy megismerkedni elsõkézbõl az operációs rendszerek, számítógépes architektúrák és hálózatok mûködésével! Rengeteg szabadon használható mûszaki, matematikai és grafikai tervezõ programcsomag könnyíti meg azok munkáját is, akik számára a számítógép legfõképpen <em>más</em> feladatok elvégzésére hivatott!</p></li><li><p><em>Kutatás:</em> Miután a teljes FreeBSD rendszer forráskódja bárki számára elérhetõ, tökéletes kiindulási pontot ad az operációs rendszerek témakörében vagy a számítástudomány egyéb ágaiban végzendõ kutatásokhoz. A FreeBSD nyílt természete ezenkívül lehetõvé teszi egymástól távol levõ csoportok közös együttmûködését is anélkül, hogy a résztvevõknek aggódnia kellene a különleges licencszerzõdések vagy a nyílt fórumokon felmerülõ korlátozások miatt.</p></li><li><p><em>Hálózatépítés:</em> Szüksége van egy új útválasztóra? Esetleg egy névszerverre (DNS)? Egy tûzfalra, mely távoltartja a nemkívánatos egyéneket a belsõ hálózattól? A FreeBSD pillanatok alatt átváltoztatja a sarokban porosodó 386-os vagy 486-os PC-nket egy kifinomult csomagszûrési képességekkel bíró forgalomirányító eszközzé.</p></li><li><p><em>X Window munkaállomás:</em> A FreeBSD a szabadon használható X11 szerverrel együtt remek választás egy olcsó X terminál kiépítéséhez. Eltérõen egy szokványos X termináltól, a FreeBSD azonban igény szerint sok alkalmazás helyi futtatását is képes megoldani, ezzel megszabadítva minket a központi szerver használatának kényszerétõl. A FreeBSD viszont akár "lemez nélkül" is el tud indulni, aminek révén az egyes munkaállomások karbantartása még olcsóbbá és könnyebbé válik.</p></li><li><p><em>Szoftverfejlesztés:</em> Az alap FreeBSD rendszer fejlesztõeszközök tömkelegével, többek közt a híres GNU C/C++ fordítóval és nyomkövetõvel érkezik.</p></li></ul></div><div class=paragraph><p>A FreeBSD CD-n, DVD-n és FTP-n keresztül elérhetõ forráskód és bináris formátumban is. A FreeBSD beszerzésével kapcsolatos bõvebb információkért olvassuk el az <a href=./#mirrors>A FreeBSD beszerzése</a>et.</p></div></div><div class=sect3><h4 id=introduction-nutshell-users>1.2.2. Ki használja a FreeBSD-t?<a class=anchor href=#introduction-nutshell-users></a></h4><div class=paragraph><p>A FreeBSD egyaránt remek eszköz- és termékfejlesztõi platformként funkcionál a világ legnagyobb informatikai cégeinél, többek közt:</p></div><div class=ulist><ul><li><p><a href=http://www.apple.com>Apple</a></p></li><li><p><a href=http://www.cisco.com>Cisco</a></p></li><li><p><a href=http://www.juniper.net>Juniper</a></p></li><li><p><a href=http://www.netapp.com>NetApp</a></p></li></ul></div><div class=paragraph><p>A FreeBSD mindezek mellett több nagyobb internetes oldal alapját képzi, mint például:</p></div><div class=ulist><ul><li><p><a href=http://www.yahoo.com/>Yahoo!</a></p></li><li><p><a href=http://www.yandex.ru/>Yandex</a></p></li><li><p><a href=http://www.apache.org/>Apache</a></p></li><li><p><a href=http://www.rambler.ru/>Rambler</a></p></li><li><p><a href=http://www.sina.com/>Sina</a></p></li><li><p><a href=http://www.pair.com/>Pair Networks</a></p></li><li><p><a href=http://www.sony.co.jp/>Sony Japan</a></p></li><li><p><a href=http://www.netcraft.com/>Netcraft</a></p></li><li><p><a href=http://www.163.com/>NetEase</a></p></li><li><p><a href=http://www.wni.com/>Weathernews</a></p></li><li><p><a href=http://www.telehouse.com/>TELEHOUSE America</a></p></li><li><p><a href=http://www.experts-exchange.com/>Experts Exchange</a></p></li></ul></div><div class=paragraph><p>és még sokan mások.</p></div></div></div><div class=sect2><h3 id=history>1.3. A FreeBSD Projektrõl<a class=anchor href=#history></a></h3><div class=paragraph><p>A most következõ rész egy-két háttérinformációt tár fel a Projektrõl, többek között a történetét, céljait és a benne alkalmazott fejlesztési modellt.</p></div><div class=sect3><h4 id=intro-history>1.3.1. A FreeBSD rövid története<a class=anchor href=#intro-history></a></h4><div class=paragraph><p>A FreeBSD Projekt valamikor 1993 kezdetérõl eredeztethetõ, és részben a "Nem hivatalos 386BSD Patchkit"-bõl nõtt ki, a patchkit 3 legutolsó koordinátorának, Nate Williamsnek, Rod Grimesnak és nekem köszönhetõen.</p></div><div class=paragraph><p>Eredeti célunk a 386BSD köztes állapotainak rögzítése lett volna, amitõl olyan problémák megoldását reméltük, melyeket a patchkitek gyártása önmagában egyszerûen nem tudott megoldani. Néhányan még talán emlékeznek is a Projekt kezdeti munkaneveire: "386BSD 0.5" vagy "386BSD Interim", melyek pontosan erre a tényre hivatkoztak.</p></div><div class=paragraph><p>A 386BSD eredetileg Bill Jolitz operációs rendszere volt, amely ennél a pontnál már közel egy éve senki sem tartott karban. Mivel a hozzá tartozó patchkit pedig napról napra duzzadt, egyre kényelmetlenebbé vált a karbantartása. Ezért egyhangúan úgy döntöttünk, segítünk Billnek azzal, hogy idõnként létrehozunk egy "letisztított" változatot. Ez a próbálkozásunk csúnyán kudarcba fulladt, amikor Bill Jolitz hirtelen meggondolta magát és visszalépett a Projekt támogatásától. Semmilyen egyértelmû útmutatást nem adott arra, hogy mit csináljunk helyette.</p></div><div class=paragraph><p>Nem tartott sokáig eldöntenünk, hogy ez a cél továbbra is megéri a fáradtságot, még Bill segítsége nélkül is, ezért felvettük a "FreeBSD" nevet, melyet David Greenmannek köszönhetünk. Kezdeti feladatainkat a rendszer akkori felhasználóival tartott egyeztetések után állítottuk fel. Miután teljesen tisztán láthatóvá vált, hogy a Projekt a megvalósulás útján van, felvettem a kapcsolatot a Walnut Creek-kel, terjesztési mód után nézve azok számára, akik nem tudtak akkoriban könnyedén hozzáférni az internethez. A Walnut Creek nem csak támogatta a FreeBSD CD-n történõ terjesztését, hanem még egy számítógépet és egy gyors internetkapcsolatot is a Projekt rendelkezésére bocsátott. A Walnut Creek szinte példátlan mértékû, egy akkoriban teljesen ismeretlen projektbe vetett hite nélkül nagyon nehezen lenne elképzelhetõ, hogy a FreeBSD olyan messzire és olyan gyorsan jutott volna el, ahol ma tart.</p></div><div class=paragraph><p>Az elsõ CD-lemezen (és széles körben az interneten is megjelenõ) változat a FreeBSD 1.0 volt, amely 1993 decemberében jelent meg. A Berkeley-rõl származó 4.3BSD-Lite ("Net/2") szalagokon található források alapján készült, kiegészítve a 386BSD-bõl és a Szabad Szoftver Alapítványtól (Free Software Foundation, FSF) származó komponensekkel. Elsõ kiadásként igen méltányos sikert könyvelhetett el, melyet a még inkább sikeres FreeBSD 1.1-gyel folytattunk 1994 májusában.</p></div><div class=paragraph><p>Nagyjából ekkortájt néhány váratlan sötét felhõ bukkant fel az égbolton, ahogy a Novell és a Berkeley hosszantartó pereskedése lezárult a Berkeley Net/2 szalagjainak jogi formáját illetõen. Ennek eredményeképpen a Berkeley elfogadta, hogy a Net/2 nagy része "jelzáloggal terhelt" és a Novell tulajdona, aki pedig valamivel korábban az AT&amp;T-tõl szerezte. Ezért cserébe a Berkeley megkapta a Novell "áldását" a 4.4BSD-Lite kiadásra, és amikor az véglesen kijön, megszûnik a rajta levõ jelzálog. Emiatt az összes Net/2 felhasználónak erõsen javasolt volt váltani. Ez érintette magát a FreeBSD-t is, és így a Projekt 1994 júliusáig kapott határidõt, hogy leállítsa a Net/2 alapú termékeinek szállítását. A megegyezés értelmében a Projekt kiadhatott még egy utolsó kiadást a határidõ elõtt, amely végül a FreeBSD 1.1.5.1 lett.</p></div><div class=paragraph><p>A FreeBSD-nek ekkor szembesülnie kellett azzal a nehéz feladattal, hogy lényegében újra fel kellett találnia magát, a teljesen új és meglehetõsen hiányos 4.4BSD-Lite bitjeitõl elindulva. A "Lite" (egyszerûsített) kiadások abban az értelemben számítottak egyszerûbbnek, hogy a Berkeley kutatói (a különbözõ jogi követelések miatt) eltávolították a ténylegesen beindítható rendszerhez szükséges programrészek nagyobb részét, ill. a 4.4-es verzió Intel processzorokra készített portja nagyon is befejezetlen volt. A Projektnek egészen 1994 novemberéig tartott, hogy megtegye ezt a lépést, ugyanis ekkor jelent meg a FreeBSD 2.0 az interneten és (december vége felé) CD-n. Annak ellenére, hogy még némileg érdes maradt bizonyos helyeken, ez a kiadás jelentõs sikereket ért el. Ezt követte 1995 júniusában a sokkalta stabilabb és könnyebben telepíthetõ FreeBSD 2.0.5.</p></div><div class=paragraph><p>A FreeBSD 2.1.5-öt 1996 augusztusában adtuk ki, mely akkora népszerûségnek örvendett az internet-szolgáltatók és kereskedelmi közösségek körében, hogy a 2.1-STABLE elágazásból egy újabb kiadást készítettünk. Ez volt a FreeBSD 2.1.7.1, amely 1997 februárjában jelent meg és ezzel együtt a 2.1-STABLE fejlesztését is zárta. Most már csak karbantartást végzünk rajta, és csak a biztonsági és egyéb kritikus hibajavítások kerülnek bele (RELENG_2_1_0).</p></div><div class=paragraph><p>A FreeBSD 2.2 fejlesztése 1996 novemberében ágazott le az akkori fejlesztõi ("-CURRENT") ágból, mint a RELENG_2_2-es ág. Ebbõl az elsõ teljes kiadás (2.2.1) 1997 áprilisában jelent meg. A 2.2-es ág mentén további kiadások 1997 nyarán és õszén készültek, melyek közül az utolsó (2.2.8) 1998 novemberében jelent meg. Az elsõ hivatalos 3.0-ás kiadás 1998 októberében jött ki, ami egyúttal a 2.2-es ág befejezésének kezdetét jelentette.</p></div><div class=paragraph><p>A fejlesztési fa 1999. január 20-án került ismét elágaztatásra, melynek eredménye a 4.0-CURRENT és 3.X-STABLE ágak lettek. A 3.X-STABLE ágban a 3.1 1999. február 15-én, a 3.2 1999. május 15-én, a 3.3 1999. szeptember 16-án, a 3.4 1999. december 20-án és a 3.5 2000. június 24-én jelent meg, melyet pár nappal késõbb egy kisebb alverzió, a 3.5.1 követett, a Kerberosra vonatkozó friss biztonsági javításokkal. Ez lett egyben a 3.X ág utolsó kiadása.</p></div><div class=paragraph><p>Egy másik fontos elágaztatás 2000. március 13-án történt, mellyel életre kelt a 4.X-STABLE ág. Ebbõl aztán számos kiadás született: a 4.0-RELEASE 2000 márciusában mutatkozott be, az utolsó 4.11-RELEASE pedig 2005 januárjában látott napvilágot.</p></div><div class=paragraph><p>A várva várt 5.0-RELEASE 2003. január 19-én került bejelentésre. Közel háromévnyi munka eredményeképpen ez a kiadás indította meg a FreeBSD-t a többprocesszoros rendszerek és az alkalmazások szálkezelésének fejlettebb támogatásának útján, valamint az UltraSPARC® és <code>ia64</code> platformok támogatása is itt jelent meg elõször. Ezt a kiadást az 5.1 követte 2003 júniusában. A hozzá tartozó -CURRENT ágból az utolsó kiadás az 5.2.1-RELEASE volt, amely 2004 februárjában mutatkozott be.</p></div><div class=paragraph><p>A 2004 augusztusában, a RELENG_5 ág létrehozását a 5.3-RELEASE követte, és egyben a 5-STABLE ág kezdetét is jelezte. A legújabb 5.5-RELEASE 2006 májusában jött ki. A RELENG_5 ágból már nem fog készülni több kiadás.</p></div><div class=paragraph><p>A fejlesztési fa ezután 2005 júliusában ágazott el ismét, ezúttal a RELENG_6 ágnak adott életet. A 6.0-RELEASE az 6.X ág elsõ kiadásaként 2005 novemberében jelent meg. A legújabb 6.4-RELEASE 2008 november hónapjában jelentkezett. A RELENG_6 ágból már nem készülnek további kiadások.</p></div><div class=paragraph><p>A RELENG_7 ág 2007 októberében jött létre. Ebbõl az elsõ kiadás 2008 februárjában a 7.0-RELEASE volt. A legfrissebb 11.2-RELEASE kiadás June 28, 2018 hónapban készült el. A RELENG_7 ágból további kiadások is várhatóak.</p></div><div class=paragraph><p>A fejlesztési fából 2009 augusztusában ismét levált egy ág, amely ezúttal a RELENG_8 volt. A 8.0-RELEASE, a 8.X ág elsõ kiadása 2009 novemberében jelent meg. A legfrissebb 12.0-RELEASE December 11, 2018 hónapban jött ki. A RELENG_8 ágból várhatóak további kiadások.</p></div><div class=paragraph><p>Jelen pillanatban a hosszabb távú fejlesztések a 9.X-CURRENT (törzs) ágban kapnak helyet, és a 9.X-bõl készült idõközönkénti pillanatkiadások folyamatosan elérhetõek CD-n (és természetesen interneten keresztül is) <a href=ftp://current.FreeBSD.org/pub/FreeBSD/snapshots/>a pillanatkiadásokat tároló szerverrõl</a>.</p></div></div><div class=sect3><h4 id=goals>1.3.2. A FreeBSD Projekt céljai<a class=anchor href=#goals></a></h4><div class=paragraph><p>A FreeBSD Projekt célja, hogy olyan szoftvereket kínáljon, amelyek tetszõlegesen, bármilyen célra felhasználhatóak, mindenféle megkötések nélkül. Sokunk jelentõs energiát fektet a programokba (és a Projektbe) és minden bizonnyal egyikünk sem utasítana vissza semmilyen anyagi ellenszolgáltatást se most, se késõbb, de egyáltalán nem ragaszkodunk hozzá. Hisszük, hogy elsõdleges "küldetésünk" olyan programok és programrészletek készítése bárki számára és bármilyen célra, melyeket a lehetõ legszélesebb körben alkalmaznak és a lehetõ legtöbb hasznot hajtják. Ez, úgy érzem, az egyik legalapvetõbb célja a szabad szoftvereknek, és ez az, amit mi is lelkesen magunkénak vallunk.</p></div><div class=paragraph><p>A forrásfánkban található GNU General Public License (GPL) vagy a Library General Public License (LGPL) alá esõ kódok hozzáférhetõségére ezzel szemben némileg több megszorítás vonatkozik, legalább is inkább ami a hozzáférhetõséget illeti. Mivel a GPL-es szoftverek kereskedelmi használata további bonyodalmakat vethet fel, ha lehetõségünk adódik rá, inkább a sokkal enyhébb BSD licenccel rendelkezõ szoftvereket választjuk.</p></div></div><div class=sect3><h4 id=development>1.3.3. A FreeBSD fejlesztési modellje<a class=anchor href=#development></a></h4><div class=paragraph><p>A FreeBSD fejlesztése egy nagyon nyitott és rugalmas folyamat, szó szerint a világ minden tájáról érkezõ többszáznyi segítségbõl építkezik, ahogy az látható is a <a href=https://docs.freebsd.org/en/articles/contributors/>résztvevõink listáján</a>. A FreeBSD fejlesztési infrastruktúrája lehetõvé teszi, hogy ez a többszáznyi résztvevõ az interneten keresztül mûködjön együtt. Folyamatosan várjuk az új fejlesztõket és ötleteket, és mindazok, akik komolyabban érdeklõdnek a Projekt iránt, egyszerûen felvehetik velünk a kapcsolatot a <a href=https://lists.FreeBSD.org/subscription/freebsd-hackers>FreeBSD technical discussions levelezési lista</a> címén. Egy <a href=https://lists.FreeBSD.org/subscription/freebsd-announce>FreeBSD announcements levelezési lista</a> is elérhetõ azok számára, akik értesíteni kívánják a többi FreeBSD felhasználót munkájuk fõbb eredményeirõl.</p></div><div class=paragraph><p>A FreeBSD Projektrõl és annak fejlesztési modelljérõl hasznos tudni az alábbiakat, függetlenül attól, hogy egyedül vagy másokkal szoros együttmûködésben dolgozunk:</p></div><div class=dlist><dl><dt class=hdlist1>Az SVN és CVS repositoryk<a id=development-cvs-repository></a></dt><dd><p>Sok éven keresztül a FreeBSD központi forrásfáját <a href=http://ximbiot.com/cvs/wiki/>CVS</a>-en (Concurrent Versions System) keresztül tartották karban, amely egy, a FreeBSD-vel is érkezõ, szabadon elérhetõ verziókezelõ rendszer. 2008 júniusában a Projekt az <a href=http://subversion.tigris.org>SVN</a> (Subversion) használatára váltott. Ez a váltás szükségszerû volt, mivel a CVS által okozott technikai nehézségek gyorsan elõjöttek a forrásfa és a hozzá tartozó metainformációk szapora növekedésével. Noha a központi repository most már SVN-alapú, a kliensoldali CVSup és csup alkalmazások továbbra is a korábbi infrastruktúrával dolgoznak, ahogy eddig is - az SVN respositoryban végzett változtatások ehhez automatikusan átkerülnek CVS alá. Jelen pillanatban egyedül csak a központi forrásfa használja ezt a megoldást, a dokumentáció, a weboldalak és a Portgyûjtemény forrásai továbbra is CVS alól üzemelnek. Az elsõdleges <a href=http://www.FreeBSD.org/cgi/cvsweb.cgi>CVS repository</a> egy Santa Clara-i (California, USA) számítógépen található, ahonnan a világban található rengeteg tükörszerverre másolódik. Az SVN-fa, mely tartalmazza a <a href=./#current>-CURRENT</a> és <a href=./#stable>-STABLE</a> ágakat, könnyen lemásolható a saját számítógépünkre is. Ennek részleteirõl bõvebben a <a href=./#synching>A forrásfa szinkronizálása</a> c. szakaszban olvashatunk.</p></dd><dt class=hdlist1>A committerek listája<a id=development-committers></a></dt><dd><p>A hivatalos fejlesztõk (<em>committerek</em>) azok az emberek, akik a CVS-fához írási joggal rendelkeznek, tehát módosítást hajthatnak végre a FreeBSD forrásaiban (a "committer" kifejezés a <a href="https://man.freebsd.org/cgi/man.cgi?query=cvs&amp;sektion=1&amp;format=html">cvs(1)</a> <code>commit</code> parancsából származik, amelyet arra használunk, hogy felvigyük a módosításainkat a CVS repository-ba). Javaslatainkat legjobban a <a href="https://man.freebsd.org/cgi/man.cgi?query=send-pr&amp;sektion=1&amp;format=html">send-pr(1)</a> használatával tudjuk a committerek elé tárni. Ha valamiért ez mégsem mûködne, megpróbálhatjuk õket elérni közvetlenül a FreeBSD committer’s mailing list címére küldött e-maillel.</p></dd><dt class=hdlist1>A FreeBSD Core Team<a id=development-core></a></dt><dd><p>Ha a FreeBSD Projekt egy vállalat lenne, akkor a <em>FreeBSD Core Teamje</em> (irányító csoportja) foglalná magában a vezetõséget. Ennek a csoportnak elsõdleges feladata, hogy fenntartsa a Projekt egészének kondícióját és gondoskodjon róla, hogy a megfelelõ irányba haladjon. Az irányító csoportnak ugyanígy feladata a megbízható és odaadó committerek tömörítése és az új tagok beszervezése, ha a csoportból kilépne valaki. A jelenlegi Core Team tagjait 2008 júliusában választották meg. A választásokat kétévente tartják.</p><div class=paragraph><p>Ebben a csoportban egyes tagoknak ezenfelül még bizonyos területekre felügyelniük is kell. Ez azt jelenti, hogy felelõsek a rendszer valamelyik nagyobb részének az elõírásoknak megfelelõ mûködéséért. A FreeBSD fejlesztõk teljes felsorolása és a hozzájuk tartozó területek megtalálhatóak <a href=https://docs.freebsd.org/en/articles/contributors/>A résztvevõk listjában</a>.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>A Core Team legtöbb tagja pusztán önkéntesen vesz részt a FreeBSD fejlesztésében és nem származik a projektbõl semmilyen anyagi haszna. Emiatt a "részvétel" nem tévesztendõ össze a "garantált támogatással". A "vezetõségre" vonatkozó hasonlat nem teljesen pontos abban az értelemben, hogy ezek az emberek tulajdonképpen egy kívülálló szempontjából ésszerûtlen döntést hoztak azzal, hogy a FreeBSD támogatására áldozták az életüket!</p></div></td></tr></tbody></table></div></dd><dt class=hdlist1>Külsõ résztvevõk</dt><dd><p>Végül, de nem utoljára, következzen a fejlesztõk legnagyobb csoportja: õk maguk a felhasználók, akik rendszeres visszajelzéseket és hibajavításokat küldenek. A FreeBSD kevésbé központosított fejlesztésében elsõsorban a <a href=https://lists.FreeBSD.org/subscription/freebsd-hackers>FreeBSD technical discussions levelezési lista</a> segítségével lehet felvenni a fonalat, ahol ezeket a témákat tárgyalják meg. A FreeBSD-hez kapcsolódó különféle levelezési listákról többet a <a href=./#eresources>Források az interneten</a>ben olvashatunk.</p><div class=paragraph><p><a href=https://docs.freebsd.org/en/articles/contributors/>A FreeBSD résztvevõinek listája</a> hosszú és még most is növekszik; miért nem próbálunk mi is visszaadni valamit a FreeBSD-nek?</p></div><div class=paragraph><p>Nem csak programozással lehet segíteni a Projektet: a megoldandó feladatok listáját megtalálhatjuk a <a href=https://www.FreeBSD.org/>FreeBSD Projekt honlapján</a>.</p></div></dd></dl></div><div class=paragraph><p>Röviden összefoglalva, a fejlesztési modellünk egymáshoz lazán kapcsolódó koncentrikus körökként szervezõdik. Ez a központosított modell a FreeBSD-<em>felhasználók</em> kényelmét szolgálandó lett kialakítva, akik így könnyedén tudnak követni egyetlen központi kódbázist, azonban megvan a lehetõségük a részvételre is! Minden vágyunk egy olyan megbízható operációs rendszer kialakítása, amihez nagy mennyiségû könnyen telepíthetõ és használható <a href=./#ports>alkalmazás</a> tartozik - ez a modell ennek elérésére nagyon is megfelelõ.</p></div><div class=paragraph><p>A haladás ütemének fenntartása érdekében mindössze csak annyit kérünk a leendõ FreeBSD fejlesztõinktõl, hogy legyenek legalább annyira elszántak, mint a jelenlegi tagjaink!</p></div></div><div class=sect3><h4 id=relnotes>1.3.4. Az aktuális FreeBSD kiadások<a class=anchor href=#relnotes></a></h4><div class=paragraph><p>A FreeBSD egy szabadon elérhetõ, teljes forráskóddal érkezõ 4.4BSD-Lite alapú kiadás Intel i386™, i486™, Pentium®, Pentium® Pro, Celeron®, Pentium® II, Pentium® III, Pentium® 4 (vagy azzal kompatibilis), Xeon™, DEC Alpha™ és Sun UltraSPARC® alapú számítógépekre. Elsõsorban a Berkeley Számítógépes rendszerek kutatócsoportjának szoftverein alapszik, számos javítással a NetBSD, OpenBSD, 386BSD és a Szabad Szoftver Alapítvány munkásságának köszönhetõen.</p></div><div class=paragraph><p>A FreeBSD 2.0 1994 végi megjelenése óta a FreeBSD teljesítménye, megbízhatósága és tudása drasztikusan megnövekedett. A legnagyobb változtatás az újjáalakított, összevont VM/állomány puffer gyorsítótárral rendelkezõ virtuális memória alrendszer, amely nem csak a teljesítményt növeli, hanem csökkenti a FreeBSD memóriaigényét is, jobban elfogadhatóvá téve ezzel az 5 MB-os minimumot. A további fejlesztések között találjuk a teljes NIS szerver és kliens támogatást, az átviteli TCP támogatását, az igény szerint tárcsázó PPP-t, a beépített DHCP támogatást, a továbbfejlesztett SCSI alrendszert, az ISDN támogatást, az ATM, FDDI, Fast és Gigabit Ethernet (1000 Mbit) hálózati csatolók támogatását, a legfrissebb Adaptec gyártmányú vezérlõk fejlesztett támogatását és a többezernyi hibajavítást.</p></div><div class=paragraph><p>Az alapeszközök mellé a FreeBSD felkínálja többezernyi ismert és keresett program portjaiból álló gyûjteményét. Ebben a pillanatban is már több, mint 36000 port érhetõ el! A portok listája a HTTP (WWW) szerverektõl, a játékokon, nyelveken és sok mindenen keresztül a szövegszerkesztõkig terjed. Az egész Portgyûjtemény közelítõleg 3 GB tárhelyet kíván, minden portot az eredeti forráshoz viszonyított "különbségként" tárol. Ennek következtében a portok frissítése sokkal könnyebb és nagyban csökkenti a korábbi, 1.0-ás Portgyûjteménynél kialakult tárigényeket. Egy port lefordításához egyszerûen csak be kell lépnünk a telepíteni kívánt program könyvtárába és ki kell adnunk a <code>make install</code> parancsot, a többit a rendszer elvégzi. Minden egyes telepítendõ port teljes forrása dinamikusan vagy CD-rõl vagy pedig FTP-n keresztül töltõdik le, így csak a ténylegesen telepítendõk lefordításához elegendõ tárhelyre van szükség. Majdnem mindegyik port elérhetõ elõre lefordított "csomag" formájában azok számára, akik nem kívánják lefordítani a portokat, és melyeket egy egyszerû parancs (<code>pkg_add</code>) segítségével telepíteni is tudják. A csomagokról és portokról a <a href=./#ports>Alkalmazások telepítése: csomagok és portok</a>ben tudhatunk meg többet.</p></div><div class=paragraph><p>A FreeBSD telepítésérõl és használatáról most már számos további nagyon hasznos dokumentumot találhatunk bármelyik FreeBSD-s számítógép <span class=filename>/usr/shared/doc</span> könyvtárában. A helyileg telepített kézikönyveket bármilyen HTML-t megjeleníteni képes böngészõvel el tudjuk olvasni az alábbi URL-eken:</p></div><div class=dlist><dl><dt class=hdlist1>A FreeBSD kézikönyv</dt><dd><p><a href=file://localhost/usr/shared/doc/handbook/index.html>/usr/shared/doc/handbook/index.html</a></p></dd><dt class=hdlist1>A FreeBSD GYIK</dt><dd><p><a href=file://localhost/usr/shared/doc/faq/index.html>/usr/shared/doc/faq/index.html</a></p></dd></dl></div><div class=paragraph><p>Az aktuális (leginkább frissített) verziók megtekinthetõek a <a href=http://www.FreeBSD.org/>http://www.FreeBSD.org/</a> címen.</p></div></div></div></div></div><div class=sect1><h2 id=install>Chapter 2. A FreeBSD telepítése<a class=anchor href=#install></a></h2><div class=sectionbody><div class=sect2><h3 id=install-synopsis>2.1. Áttekintés<a class=anchor href=#install-synopsis></a></h3><div class=paragraph><p>A FreeBSD telepítéséhez egy könnyen használható szöveges telepítõprogram, a sysinstall használható. Ez a FreeBSD alapértelmezett telepítõprogramja, habár ezt a különféle gyártók kedvük szerint lecserélhetik. Ebben a fejezetben bemutatjuk a FreeBSD sysinstall segítségével történõ telepítését.</p></div><div class=paragraph><p>A fejezet elolvasása során megismerjük:</p></div><div class=ulist><ul><li><p>hogyan készítsünk telepítõlemezeket a FreeBSD-hez;</p></li><li><p>a FreeBSD miként hivatkozza és osztja fel a merevlemezeinket;</p></li><li><p>hogyan indítsuk el a sysinstall programot;</p></li><li><p>milyen kérdéseket tesz fel nekünk a sysinstall, mire gondol, hogyan is kell azokat megválaszolni.</p></li></ul></div><div class=paragraph><p>A fejezet elolvasásához ajánlott:</p></div><div class=ulist><ul><li><p>a telepítendõ FreeBSD verzióhoz tartozó támogatott hardvereket felsoroló lista átolvasása és benne a saját hardvereszközeink megkeresése.</p></li></ul></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Általánosan elmondható, hogy a most következõ telepítési utasítások az i386™ ("PC kompatibilis") architektúrájú számítógépekre vonatkoznak. Ahol erre szükség van, ott más platformokra vonatkozó utasítások is szerepelhetnek. Habár ezt a leírás igyekszünk a lehetõ legjobban naprakészen tartani, elképzelhetõ, hogy felfedezhetünk kisebb eltéréseket a telepítõben és az itt leírtak közt. Ezért ezt a fejezetet inkább egy általános útmutatónak javasoljuk, nem pedig egy szó szerint értelmezendõ kézikönyvként.</p></div></td></tr></tbody></table></div></div><div class=sect2><h3 id=install-hardware>2.2. Hardverkövetelmények<a class=anchor href=#install-hardware></a></h3><div class=sect3><h4 id=install-hardware-minimal>2.2.1. Minimális konfiguráció<a class=anchor href=#install-hardware-minimal></a></h4><div class=paragraph><p>A FreeBSD telepítéséhez szükséges minimális konfiguráció FreeBSD verziónként és architektúránként eltérõ.</p></div><div class=paragraph><p>A minimális konfigurációt a FreeBSD honlapján a <a href=http://www.FreeBSD.org/releases/>kiadásokról szóló oldalon</a>, az "Installation Notes" részben találhatjuk meg. Ezt a következõ szakaszokban foglaljuk össze. A FreeBSD telepítésének módszerétõl függõen szükségünk lehet egy hajlékonylemezes (floppy) vagy CD-ROM meghajtóra, esetleg egy hálózati kártyára. Ezt a <a href=#install-boot-media>Készítsünk egy rendszerindító lemezt</a>ban tárgyaljuk.</p></div><div class=sect4><h5 id=_freebsdi386_és_freebsdpc98>2.2.1.1. FreeBSD/i386 és FreeBSD/pc98<a class=anchor href=#_freebsdi386_és_freebsdpc98></a></h5><div class=paragraph><p>A FreeBSD/i386 és FreeBSD/pc98 egyaránt egy 486 vagy jobb processzort és legalább 24 MB memóriát igényel. A legkisebb telepítéshez legalább 150 MB szabad lemezterület szükséges.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Régebbi konfigurációk esetén nem egy gyorsabb processzor, hanem inkább több memória beszerzése, illetve több lemezterület felszabadítása a fontosabb.</p></div></td></tr></tbody></table></div></div><div class=sect4><h5 id=_freebsdalpha>2.2.1.2. FreeBSD/alpha<a class=anchor href=#_freebsdalpha></a></h5><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Az Alpha támogatás a FreeBSD 7.0 beindulásával eltávolításra került. A FreeBSD 6.<em>X</em> sorozat az utolsó, amely valamilyen támogatást ajánl ehhez az architektúrához. Ezzel kapcsolatban részletesebben a <a href=http://www.FreeBSD.org/releases/>kiadásokkal</a> kapcsolatos információkat tartalmazó oldalon olvashatunk a FreeBSD honlapján.</p></div></td></tr></tbody></table></div></div><div class=sect4><h5 id=_freebsdamd64>2.2.1.3. FreeBSD/amd64<a class=anchor href=#_freebsdamd64></a></h5><div class=paragraph><p>Két típusú processzor képes futtatni a FreeBSD/amd64 verzióját. Az elsõ ezek közül az AMD64 processzorok, beleértve az AMD Athlon™64, AMD Athlon™64-FX, AMD Opteron™ vagy újabb processzorokat.</p></div><div class=paragraph><p>A FreeBSD/amd64 verzióját kihasználni képes processzorok másik csoportja az Intel® EM64T architektúrájára épülõ processzorok. Ilyen processzor például az Intel® Core™ 2 Duo, Quad és Extreme processzorcsaládok, valamint az Intel® Xeon™ 3000, 5000 és 7000 sorozatszámú processzorai.</p></div><div class=paragraph><p>Ha nVidia nForce3 Pro-150 alapú géppel rendelkezünk, ki <em>kell</em> kapcsolnunk a BIOS-ban az IO APIC használatát. Ha nem találnánk ilyen beállítást, akkor helyette magát az ACPI-t kell kikapcsolnunk. A Pro-150 chipsetnek vannak bizonyos hibái, amelyekre eddig még nem sikerült megfelelõ megoldást találnunk.</p></div></div><div class=sect4><h5 id=_freebsdsparc64>2.2.1.4. FreeBSD/sparc64<a class=anchor href=#_freebsdsparc64></a></h5><div class=paragraph><p>A FreeBSD/sparc64 telepítéséhez egy támogatott platformra van szükségünk (lásd: <a href=#install-hardware-supported>Támogatott hardverek</a>).</p></div><div class=paragraph><p>A FreeBSD/sparc64 telepítéséhez egy egész lemezre lesz szükségünk, mivel a rendszer jelenleg nem képes megosztani azt más operációs rendszerekkel.</p></div></div></div><div class=sect3><h4 id=install-hardware-supported>2.2.2. Támogatott hardverek<a class=anchor href=#install-hardware-supported></a></h4><div class=paragraph><p>A FreeBSD minden kiadásához mellékelik a támogatott hardverek listáját "FreeBSD Hardware Notes" címmel. Ez a dokumentum többnyire a <span class=filename>HARDWARE.TXT</span> nevû állomány, amelyet a rendszer CD-n vagy FTP-n keresztül elérhetõ változatának gyökerében vagy a sysinstall dokumentációkat tartalmazó menüjében találhatunk meg.</p></div></div></div><div class=sect2><h3 id=install-pre>2.3. A telepítés elõtt elvégzendõ feladatok<a class=anchor href=#install-pre></a></h3><div class=sect3><h4 id=install-inventory>2.3.1. Készítsünk leltárt a számítógépünkrõl<a class=anchor href=#install-inventory></a></h4><div class=paragraph><p>A FreeBSD telepítése elõtt érdemes összeszedni, pontosan mi minden is található a számítógépünkben. A FreeBSD telepítõrutinjai mutatni fogják a különbözõ komponensek (merevlemezek, hálózati kártyák, CD-meghajtók és a többi) modelljét és gyártóját. A FreeBSD ezenkívü megpróbálja kideríteni a megjelenõ eszközök pontos konfigurációját is, beleértve a használt IRQ és IO portok kiosztását. A PC-s hardverek különféle szeszélyei miatt azonban ez az iménti folyamat nem minden esetben megbízható, ezért elõfordulhat, hogy helyesbíteni kell a FreeBSD által megállapított értékeket.</p></div><div class=paragraph><p>Ha már van a gépünkön egy másik operációs rendszer, például Windows® vagy Linux®, akkor mindenképpen hasznos lehet az általa felkínált eszközökkel lekérdezni a hardvereink beállításait. Ha nem lennénk biztosak benne, hogy az adott bõvítõkártyákat pontosan milyen beállításokkal is használjuk, nézzük meg ezeket magán a kártyán. A népszerû IRQ értékek általában a 3, 5 és 7, valamint az IO portok számát általában tizenhatos számrendszerben szerepeltetik, például 0x330.</p></div><div class=paragraph><p>Javasoljuk, hogy nyomtassuk ki vagy írjuk le ezeket a paramétereket a FreeBSD telepítése elõtt. Ehhez rendezzük ezeket egy táblázatban, valahogy így:</p></div><table class="tableblock frame-none grid-all stretch"><caption class=title>Táblázat 1. Példa egy eszközleltárra</caption><col style=width:25%><col style=width:25%><col style=width:25%><col style=width:25%><thead><tr><th class="tableblock halign-left valign-top">Eszköz neve</th><th class="tableblock halign-left valign-top">IRQ</th><th class="tableblock halign-left valign-top">IO portok</th><th class="tableblock halign-left valign-top">Megjegyzés</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class=tableblock>Elsõ merevlemez</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>-</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>-</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Mérete 40 GB, gyártmánya Seagate, elsõdleges IDE master</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>CD-ROM meghajtó</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>-</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>-</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Elsõdleges IDE slave</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>Második merevlemez</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>-</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>-</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Mérete 20 GB, gyártmánya IBM, másodlagos IDE master</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>Elsõ IDE vezérlõ</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>14</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>0x1f0</p></td><td class="tableblock halign-left valign-top"></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>Hálózati kártya</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>-</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>-</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Intel® 10/100</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>Modem</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>-</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>-</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>3Com® 56K-s faxmodem, COM1</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>…​</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>…​</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>…​</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>…​</p></td></tr></tbody></table><div class=paragraph><p>Ahogy elkészítettük a számítógépünk alkatrészeit tartalmazó listát, vessük ezeket össze a telepítendõ FreeBSD kiadás által megkövetelt eszközökkel.</p></div></div><div class=sect3><h4 id=_mentsük_le_az_adatainkat>2.3.2. Mentsük le az adatainkat<a class=anchor href=#_mentsük_le_az_adatainkat></a></h4><div class=paragraph><p>Amennyiben a FreeBSD telepítéséhez használt számítógép számunkra értékes adatokat tárol, igyekezzünk lementeni ezeket, és a FreeBSD tényleges telepítése elõtt gyõzõdjünk is meg róla, hogy a mentés sikeres volt. A FreeBSD telepítõrutinjai természetesen megerõsítést fognak kérni bármilyen adat lemezre írása elõtt, azonban ha egyszer már elindítottuk a folyamatot, már semmit sem tudunk visszafordítani.</p></div></div><div class=sect3><h4 id=install-where>2.3.3. Döntsük el a FreeBSD telepítésének helyét<a class=anchor href=#install-where></a></h4><div class=paragraph><p>Ha a FreeBSD telepítéséhez az egész merevlemezünket fel akarjuk használni, akkor még nincs miért izgatnunk magunkat - nyugodtan átléphetjük ezt a szakaszt.</p></div><div class=paragraph><p>Amikor viszont a FreeBSD-t más operációs rendszerek mellé szeretnénk telepíteni, ismernünk kell, miként is helyezkednek el az adatok a lemezeken, és hogy ez miként is érint bennünket.</p></div><div class=sect4><h5 id=install-where-i386>2.3.3.1. A lemezek kiosztása a FreeBSD/i386 esetén<a class=anchor href=#install-where-i386></a></h5><div class=paragraph><p>A PC-k által használt lemezek különálló darabokra tagolhatóak. Ezeket a darabokat <em>partíciók</em>nak nevezzük. Mivel azonban a FreeBSD maga is tárol partíciókat, ezért ez az elnevezés pillanatok alatt megtévesztõvé válhat, ezért ezeket a lemezdarabokat a FreeBSD lemezslice-oknak vagy egyszerûen csak slice-oknak hívja. Például a PC-s lemezpartíciókkal dolgozó, <code>fdisk</code> nevû FreeBSD-s segédprogram partíciók helyett is slice-okra hivatkozik. A PC lemezenként alapvetõen csak négy partíciót enged meg. Ezeket a partíciókat nevezik <em>elsõdleges partícióknak</em>. Ettõl a korlátozástól egy új típus, a <em>kiterjesztett partíció</em> létrehozásával szabadultak meg, amivel így négynél több partíció is készíthetõ. Lemezenként egyetlen ilyen kiterjesztett partíció található, de ezen belül speciális, ún. <em>logikai partíciók</em> hozhatóak létre.</p></div><div class=paragraph><p>Minden partíciónak van egy <em>partíció-azonosítója</em>, melyet a partíción található adatok típusának megállapítására használnak. A FreeBSD partícióinak azonosítója a <code>165</code>.</p></div><div class=paragraph><p>Általánosságban véve minden operációs rendszer így azonosítja a partíciókat. Például a DOS és annak leszármazottai, mint például a Windows®, minden elsõdleges és logikai partícióhoz egy <span class=filename>C:</span>-tõl induló <em>meghajtó-betûjelet</em> társít.</p></div><div class=paragraph><p>A FreeBSD-t egy elsõdleges partícióra kell telepíteni. A FreeBSD az összes adatát, beleértve minden általunk létrehozott állományt is, ezen az egyetlen partíción fogja elhelyezni. Ha viszont több lemezünk van, többen is, vagy akár mindegyiken létrehozhatunk FreeBSD-s partíciókat. A FreeBSD telepítésekor azonban legalább egy ilyen partíciónak használhatónak kell lennie. Ez lehet elõre megtisztított üres partíciói is, vagy akár egy olyan partíció, amelyen már nem használt adatok vannak.</p></div><div class=paragraph><p>Ha már mindegyik partíciónk betelt, akkor a többi operációs rendszer által felkínált eszközök (például MS-DOS®-ban vagy Windows®-ban az <code>fdisk</code>) valamelyikével elõször fel kell közülük szabadítanunk egyet a FreeBSD számára.</p></div><div class=paragraph><p>Amennyiben akadna egy használható partíció, akkor használjuk azt. Ekkor azonban elõfordulhat, hogy ehhez elõször a meglévõk közül össze kell majd zsugorítanunk valamelyiket.</p></div><div class=paragraph><p>A FreeBSD legkisebb telepíthetõ változata nagyjából 100 MB lemezterületet igényel. Azonban ez egy <em>nagyon</em> kicsi változat és szinte semmi helyet nem hagy a saját állományainknak. Sokkal valósághûbb, ha grafikus felület nélkül nagyjából 250 MB-ot mondunk, és legalább 350 MB-ot a grafikus felület használata esetén. Ha ezeken felül további szoftvereket is telepíteni kívánunk, még több helyre lesz szükségünk.</p></div><div class=paragraph><p>Amikor a FreeBSD számára akarunk helyet csinálni, vagy partíciókat akarunk átméretezni, használjuk például a PartitionMagic® nevû kereskedelmi szoftvert, vagy esetleg egy olyan szabad szoftvert, mint például a GParted. Ismereteink szerint a PartitionMagic® és a GParted is használható az NTFS partíciókkal. A GParted számos live linuxos disztribúción megtalálható, ilyen többek közt a <a href=http://www.sysresccd.org>SystemRescueCD</a>.</p></div><div class=paragraph><p>Gondok lehetnek azonban a Microsoft® Vista által használt partíciókkal. Ezért nem árt, ha az átméretezésekor a kezünk ügyében van a Vista telepítõ CD-je. Természetesen, mint minden lemezkarbantási mûvelet esetén, ilyenkor is határozottan ajánlott biztonsági mentéseket készíteni.</p></div><div class="admonitionblock warning"><table><tbody><tr><td class=icon><i class="fa icon-warning" title=Warning></i></td><td class=content><div class=paragraph><p>Az említett eszközök helytelen használata megsemmisítheti a lemezeinken tárolt adatokat, ezért a használatuk elõtt gondoskodjunk friss, mûködõképes biztonsági mentésekrõl.</p></div></td></tr></tbody></table></div><div class=exampleblock><div class=title>Példa 1. Meglevõ partíció használata a méret megváltoztatása nélkül</div><div class=content><div class=paragraph><p>Tegyük fel, hogy a számítógépünkben egyetlen 4 GB méretû lemez van, amelyen megtalálható a Windows® valamelyik verziója, és ezt a lemezt korábban két, egyaránt 2 GB méretû meghajtóra osztottuk, a <span class=filename>C:</span>-re és <span class=filename>D:</span>-re. 1 GB adatunk van a <span class=filename>C:</span> meghajtón és fél GB a <span class=filename>D:</span>-n.</p></div><div class=paragraph><p>Mindez tehát azt jelenti, hogy a lemezünkön két partíció található, betûjelenként egy. Ha átmásoljuk a <span class=filename>D:</span> meghajtón levõ adatainkat a <span class=filename>C:</span> meghajtóra, akkor ezzel felszabadíthatjuk a FreeBSD számára a második partíciót.</p></div></div></div><div class=exampleblock><div class=title>Példa 2. Meglevõ partíció zsugorítása</div><div class=content><div class=paragraph><p>Tegyük fel, hogy a számítógépünkben egyetlen 4 GB méretû lemez van, amelyet teljes egészében a Windows® valamelyik példánya foglal el. A Windows® telepítése során ezért minden bizonnyal egyetlen nagy partíciót hoztunk létre, amely a <span class=filename>C:</span> betûjelet kapta és a mérete 4 GB. Jelen pillanatban másfél GB helyet használunk a lemezen, és szeretnénk a FreeBSD számára 2 GB helyet felszabadítani.</p></div><div class=paragraph><p>A FreeBSD telepítéséhez a következõk valamelyikét kell tennünk:</p></div><div class="olist arabic"><ol class=arabic><li><p>Mentsük le a Windows®-os adatainkat, telepítsük újra a Windows®-t úgy, hogy egy 2 GB méretû partíciót választunk neki a telepítése során.</p></li><li><p>A partíció összezsugorítására használjuk az elõbb említett alkalmazásokat, például a PartitionMagic®-et.</p></li></ol></div></div></div></div></div><div class=sect3><h4 id=_szedjük_össze_a_hálózati_beállításainkat>2.3.4. Szedjük össze a hálózati beállításainkat<a class=anchor href=#_szedjük_össze_a_hálózati_beállításainkat></a></h4><div class=paragraph><p>Amennyiben a FreeBSD telepítésének részeként hálózatra is szándékozunk csatlakozni (például egy FTP vagy NFS szerverrõl akarunk telepíteni), ismernünk kell a hálózatra vonatkozó beállításainkat is. A telepítõ rá fog kérdezni ezekre az információkra, amelyek megadása után a FreeBSD a telepítés befejezéséhez csatlakozni tud majd a hálózatra.</p></div><div class=sect4><h5 id=_csatlakozás_ethernet_hálózaton_kábel_vagy_dsl_modemen_keresztül>2.3.4.1. Csatlakozás Ethernet-hálózaton, kábel- vagy DSL-modemen keresztül<a class=anchor href=#_csatlakozás_ethernet_hálózaton_kábel_vagy_dsl_modemen_keresztül></a></h5><div class=paragraph><p>Ha egy Ethernet-hálózathoz, vagy magához az internethez csatlakozunk egy DSL- vagy kábelmodemen keresztül, akkor az alábbi adatokra lesz szükségünk:</p></div><div class="olist arabic"><ol class=arabic><li><p>IP-cím</p></li><li><p>Az alapértelmezett átjáró IP-címe</p></li><li><p>A gépünk neve</p></li><li><p>DNS (névfeloldó) szerverek IP-címei</p></li><li><p>Hálózati maszk</p></li></ol></div><div class=paragraph><p>Ha nem ismerjük ezeket, érdeklõdjünk a rendszergazdától vagy a szolgáltatónktól. Elképzelhetõ az is, hogy mindezen információkat <em>DHCP</em> segítségével, automatikusan kapjuk meg. Ezt is mindenképpen jegyezzük fel.</p></div></div><div class=sect4><h5 id=_kapcsolódás_modemmel>2.3.4.2. Kapcsolódás modemmel<a class=anchor href=#_kapcsolódás_modemmel></a></h5><div class=paragraph><p>Ha az internet-szolgáltatónkhoz hagyományos modemen keresztül csatlakozunk, akkor is tudjuk telepíteni a FreeBSD-t interneten keresztül, azonban ez nagyon sokáig tarthat.</p></div><div class=paragraph><p>Ehhez tudnunk kell:</p></div><div class="olist arabic"><ol class=arabic><li><p>Az internet-szolgáltatónk behívószámát</p></li><li><p>A soros (COM) port számát, amelyen keresztül a modem kapcsolódik a gépünkhöz</p></li><li><p>Az internet-szolgáltatónktól kapott felhasználói nevet és jelszót</p></li></ol></div></div></div><div class=sect3><h4 id=_olvassuk_el_freebsd_hibajegyzékét>2.3.5. Olvassuk el FreeBSD hibajegyzékét<a class=anchor href=#_olvassuk_el_freebsd_hibajegyzékét></a></h4><div class=paragraph><p>Habár a FreeBSD Projekt igyekszik a FreeBSD minden egyes kiadását a lehetõ legmegbízhatóbban felkészíteni, hibák óhatatlanul is maradnak bennük. Nagyon ritka esetekben ezek a hibák magára a telepítés folyamatára is kihathatnak. Amint ezeket a problémákat sikerül felderíteni és javítani, rögvest megjelennek a FreeBSD honlapján található <a href=http://www.FreeBSD.org/releases/12.0R/errata/>hibajegyzékben</a> (angolul). A telepítés elõtt ezért mindig ajánlott átolvasni ezt a dokumentumot, így megbizonyosodunk róla, hogy semmilyen utólag felmerült probléma nem akadályozza munkánkat.</p></div><div class=paragraph><p>Az összes kiadáshoz tartozó információ, beleértve az egyes kiadások hibajegyzékeit is, a <a href=https://www.FreeBSD.org/>FreeBSD honlapjáról</a> a <a href=https://www.FreeBSD.org/releases/>kiadásokra vonatkozó információkat</a> tartalmazó részen érhetõ el (angolul).</p></div></div><div class=sect3><h4 id=_szerezzük_be_a_freebsd_telepítéséhez_szükséges_állományokat>2.3.6. Szerezzük be a FreeBSD telepítéséhez szükséges állományokat<a class=anchor href=#_szerezzük_be_a_freebsd_telepítéséhez_szükséges_állományokat></a></h4><div class=paragraph><p>A FreeBSD telepítése az alábbi helyek bármelyikén megtalálható állományok felhasználásával történik:</p></div><div class=ulist><div class=title>Lokálisan:</div><ul><li><p>CD vagy DVD</p></li><li><p>Ugyanazon a számítógépen levõ MS-DOS® partíció</p></li><li><p>Pendrive (USB-flash-tároló)</p></li><li><p>SCSI- vagy QIC-szalag</p></li><li><p>Floppylemezek</p></li></ul></div><div class=ulist><div class=title>Hálózaton keresztül:</div><ul><li><p>FTP oldalról, tûzfalon keresztül vagy szükség szerint HTTP proxy használatával</p></li><li><p>NFS szerverrõl</p></li><li><p>Párhuzamos vagy soros vonali kapcsolaton keresztül</p></li></ul></div><div class=paragraph><p>Ha megvásároltuk a FreeBSD telepítõ CD-jét vagy DVD-jét, akkor már mindennel rendelkezünk a telepítéshez. Lépjünk bátran tovább a következõ szakaszra (<a href=#install-boot-media>Készítsünk egy rendszerindító lemezt</a>)!</p></div><div class=paragraph><p>Ha eddig még nem szereztük volna be a FreeBSD telepítéséhez szükséges állományokat, ugorjunk a <a href=#install-diff-media>Saját telepítõeszköz elkészítése</a>hoz, ahol megtudhatjuk, hogyan készítsük elõ a FreeBSD telepítését az imént felsorolt helyzetekben. A szakasz elolvasása után pedig jöjjünk vissza ide, majd folytassuk az olvasást a <a href=#install-boot-media>Készítsünk egy rendszerindító lemezt</a>ban.</p></div></div><div class=sect3><h4 id=install-boot-media>2.3.7. Készítsünk egy rendszerindító lemezt<a class=anchor href=#install-boot-media></a></h4><div class=paragraph><p>A FreeBSD telepítése úgy kezdõdik, hogy a számítógépünkkel a FreeBSD telepítõjét indítjuk el - ez viszont nem egy olyan program, amit más operációs rendszerben el tudunk indítani. A számítógépünk általában a merevlemezünkre telepített operációs rendszert indítja el, azonban beállítható úgy is, hogy az indulásához egy ún. "rendszerindító" (bootolható) floppy lemezt használjon. Napjaink számítógépei azonban a CD-meghajtóban levõ CD-krõl vagy USB lemezrõl is el tudnak indulni.</p></div><div class="admonitionblock tip"><table><tbody><tr><td class=icon><i class="fa icon-tip" title=Tip></i></td><td class=content><div class=paragraph><p>Ha CD-n vagy DVD-n megvan a FreeBSD telepítõje (akár megvettük, akár éppen magunk készítettük) és a számítógépünk tud CD-rõl vagy DVD-rõl rendszert indítani (a BIOS-ban van egy "Boot Order" vagy hozzá hasonló nevû beállítás), akkor kihagyhatjuk ezt a szakaszt. A FreeBSD CD- és DVD image-ek kiírásával egy rendszerindításra alkalmas lemezt kapunk, amirõl minden további elõkészület nélkül telepíthetünk.</p></div></td></tr></tbody></table></div><div class=paragraph><p>Rendszerindításra alkalmas pendrive-ot az alábbi lépések mentén tudunk készíteni:</p></div><div class="exampleblock procedure"><div class=content><div class="olist arabic"><ol class=arabic><li><p>Az image állomány letöltése</p><div class=paragraph><p>A pendrive-okhoz készült image állományok a <span class=filename>ISO-IMAGES/</span> könyvtárból tölthetõek le, <code><a href=ftp://ftp.FreeBSD.org/pub/FreeBSD/releases/architektúra/ISO-IMAGES/verzió/FreeBSD-12.0-RELEASE-architektúra-memstick.img class=bare>ftp://ftp.FreeBSD.org/pub/FreeBSD/releases/architektúra/ISO-IMAGES/verzió/FreeBSD-12.0-RELEASE-architektúra-memstick.img</a></code> néven. Az <em>architektúra</em> és <em>verzió</em> helyére a telepítendõ architektúrát és verziószámot helyettesítsük be. Ennek megfelelõen tehát például a FreeBSD/i386 12.0-RELEASE változata a <a href=ftp://ftp.FreeBSD.org/pub/FreeBSD/releases/i386/ISO-IMAGES/12.0/FreeBSD-12.0-RELEASE-i386-memstick.img>ftp://ftp.FreeBSD.org/pub/FreeBSD/releases/i386/ISO-IMAGES/12.0/FreeBSD-12.0-RELEASE-i386-memstick.img</a> címrõl érhetõ el.</p></div><div class=paragraph><p>A pendrive image <span class=filename>.img</span> kiterjesztéssel rendelkezik. A <span class=filename>ISO-IMAGES/</span> könyvtár általában több különféle állományt tartalmaz, ezek közül kell választanunk a FreeBSD telepítendõ változatának, és sok esetben a telepítéshez rendelkezésre álló hardver típusának megfelelõen.</p></div><div class="admonitionblock important"><table><tbody><tr><td class=icon><i class="fa icon-important" title=Important></i></td><td class=content><div class=paragraph><p>A következõ lépés megkezdése elõtt <em>készítsünk biztonsági mentést</em> a pendrive tartalmáról, mivel minden rajta levõ adat <em>törlõdni</em> fog.</p></div></td></tr></tbody></table></div></li><li><p>A pendrive elõkészítése</p><div class="admonitionblock warning"><table><tbody><tr><td class=icon><i class="fa icon-warning" title=Warning></i></td><td class=content><div class=paragraph><p>Az itt található példában a rendszerindításhoz és így a mûvelet végrehajtásához a <span class=filename>/dev/da0</span> nevû eszközt fogjuk használni. Ezt ne felejtsük el helyettesíteni a rendszerünkön erre a célra használt eszköz nevével, máskülönben kárt tehetünk az adatainkban.</p></div></td></tr></tbody></table></div><div class=paragraph><p>A <code>kern.geom.debugflags</code> változó értékének megfelelõ beállításával engedélyezzük a céleszközön a Master Boot Record írását.</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c>#  sysctl kern.geom.debugflags=16</span></code></pre></div></div></li><li><p>Az image pendrive-ra írása</p><div class=paragraph><p>Az <span class=filename>.img</span> kiterjesztésû állományt <em>nem</em> egyszerûen a pendrive-ra kell másolni, ez a lemez teljes tartalmát magában foglalja. Ennek megfelelõen <em>nem</em> egyszerûen állományokat kell másolnunk az egyik lemezrõl a másikra. Helyette a <a href="https://man.freebsd.org/cgi/man.cgi?query=dd&amp;sektion=1&amp;format=html">dd(1)</a> parancs segítségével írjuk az image állomány tartalmát közvetlenül a lemezre.</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell># dd if=FreeBSD-12.0-RELEASE-i386-memstick.img of=/dev/da0 bs=64k</code></pre></div></div></li></ol></div></div></div><div class=paragraph><p>Rendszerindításra alkalmas floppy lemezt az alábbi lépések mentén tudunk készíteni:</p></div><div class="exampleblock procedure"><div class=content><div class="olist arabic"><ol class=arabic><li><p>A rendszerindító lemezek image-einek beszerzése</p><div class="admonitionblock important"><table><tbody><tr><td class=icon><i class="fa icon-important" title=Important></i></td><td class=content><div class=paragraph><p>A FreeBSD 8.0 kiadásától kezdõdõen megszûnik a floppy lemezek támogatása. Helyette telepítsünk pendrive-ról, amelyrõl fentebb olvashatunk, vagy egyszerûen használjunk CD-t vagy DVD-t.</p></div></td></tr></tbody></table></div><div class=paragraph><p>A rendszerindító lemezek a telepítõeszköz <span class=filename>floppies/</span> könyvtárában találhatóak, illetve letölthetõek az <code><a href=ftp://ftp.FreeBSD.org/pub/FreeBSD/releases/architektúra/változat-RELEASE/floppies/ class=bare>ftp://ftp.FreeBSD.org/pub/FreeBSD/releases/architektúra/változat-RELEASE/floppies/</a></code> helyrõl. Az <em>architektúra</em> és <em>változat</em> helyére természtesen írjuk be a telepíteni kívánt architektúrát és verziót. Így például a FreeBSD/i386 12.0-RELEASE rendszerindító lemezei az <a href=ftp://ftp.FreeBSD.org/pub/FreeBSD/releases/i386/12.0-RELEASE/floppies/>ftp://ftp.FreeBSD.org/pub/FreeBSD/releases/i386/12.0-RELEASE/floppies/</a> címrõl érhetõek el.</p></div><div class=paragraph><p>A floppyk image-ei <span class=filename>.flp</span> kiterjesztésûek. A <span class=filename>floppies/</span> könyvtár számos különféle image-et tartalmaz, ezek közül leginkább a telepítendõ FreeBSD változat, valamint emellett olykor konkrétan a hardver határozza meg a használandót. Az esetek túlnyomó részében négy floppyra lesz szükségünk: <span class=filename>boot.flp</span>, <span class=filename>kern1.flp</span>, <span class=filename>kern2.flp</span> és <span class=filename>kern3.flp</span>. A lemezek image-eit illetõ legfrissebb információkat ugyanazon a könyvtáron belül szereplõ <span class=filename>README.TXT</span> állományban olvashatjuk (angolul).</p></div><div class="admonitionblock important"><table><tbody><tr><td class=icon><i class="fa icon-important" title=Important></i></td><td class=content><div class=paragraph><p>Az FTP-hez használt programunkat az image-ek letöltése során ne felejtsük el <em>bináris (binary)</em> átviteli módban használni. Egyes böngészõk hajlamosak ugyanis <em>szöveges (text vagy ASCII)</em> átviteli módot használni, ami viszont csak abból vehetõ észre, hogy nem tudjuk a lemezekrõl elindítani a rendszert.</p></div></td></tr></tbody></table></div></li><li><p>A floppyk elõkészítése</p><div class=paragraph><p>Mindegyik letöltendõ image-hez elõ kell készíteni egy-egy hajlékonylemezt. Nagyon fontos, hogy ezek a lemezek teljesen hibátlanok legyenek. Errõl a legkönnyebben úgy gyõzõdhetünk meg, ha a lemezeket magunk formázzuk, és nem bízunk a különféle elõreformázott (preformatted) floppykban. A Windows®-ban található formázó segédprogram sem árul el nekünk semmit a lemezeken található hibás részekrõl, egyszerûen csak "rossznak" (bad) jelöli meg és figyelmen kívül hagyja ezeket. Határozottan ajánljuk, hogy amennyiben a telepítésnek ezt a módját választjuk, mindig használjunk teljesen új floppykat.</p></div><div class="admonitionblock important"><table><tbody><tr><td class=icon><i class="fa icon-important" title=Important></i></td><td class=content><div class=paragraph><p>Ha megpróbáljuk telepíteni a FreeBSD-t, és a telepítõprogram összeomlik, lefagy vagy bármilyen furcsaságot mûvel, elsõként mindenképpen a floppykra gyanakodhatunk. Ilyenkor írjuk ki az image-eket új lemezekre és próbálkozzunk újra a telepítéssel.</p></div></td></tr></tbody></table></div></li><li><p>Az image állományok írása a floppykra</p><div class=paragraph><p>Az <span class=filename>.flp</span> kiterjesztésû állományok <em>nem</em> a lemezre másolható hagyományos állományok, hanem a lemezek teljes tartalmának képei, ezért ezeket egyszerûen <em>nem</em> másolhatjuk egyik lemezrõl a másikra. Az image-ek közvetlen lemezreírásához ehelyett kifejezetten erre a célra alkalmas eszközöket kell használnunk.</p></div><div class=paragraph><p>Azok számára, akik a floppykat MS-DOS®/Windows® rendszerû számítógépeken kívánják elkészíteni, mellékeltünk egy <code>fdimage</code> nevû segédprogramot.</p></div><div class=paragraph><p>Ha a CD-meghajtónk betûjele például <span class=filename>E:</span> és a telepítõ CD-n található image-eket szeretnénk kiírni vele, akkor ezt a parancsot kell kiadnunk:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>E:<span class=se>\&gt;</span> tools<span class=se>\f</span>dimage floppies<span class=se>\b</span>oot.flp A:</code></pre></div></div><div class=paragraph><p>Ezután ismételten adjuk ki az iménti parancsot minden egyes használni kívánt <span class=filename>.flp</span> állományra, azonban elõtte mindig tegyünk be egy újabb floppyt, és a ráírt image-ek neveivel folyamatosan címkézzük fel a lemezeket. A megadott parancsot természetesen mindig írjuk át a konkrét <span class=filename>.flp</span> állományok tényleges elérési útvonalainak megfelelõen. Ha nincs CD-nk, akkor az <code>fdimage</code> programot az FreeBSD FTP oldalán található <a href=ftp://ftp.FreeBSD.org/pub/FreeBSD/tools/>tools könyvtárból</a> is letölthetjük.</p></div><div class=paragraph><p>Amikor a lemezeket egy UNIX® rendszeren készítenénk el (például egy másik FreeBSD rendszeren), akkor a <a href="https://man.freebsd.org/cgi/man.cgi?query=dd&amp;sektion=1&amp;format=html">dd(1)</a> parancs is használható az image állományok közvetlen lemezreírásához. FreeBSD alatt így néz ki a paraméterezése:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># dd if=boot.flp of=/dev/fd0</span></code></pre></div></div><div class=paragraph><p>FreeBSD-n a <span class=filename>/dev/fd0</span> az elsõ hajlékonylemezes meghajtóra hivatkozik (tehát az <span class=filename>A:</span> betûjelû meghajtóra). Ennek megfelelõen a <span class=filename>/dev/fd1</span> jelenti a <span class=filename>B:</span> meghajtót és így tovább. Más UNIX® változatok esetleg más neveket használhatnak a hajlékonylemezes meghajtók megnevezésére, ezért errõl érdemes ilyenkor tájékozódni az adott rendszerhez tartozó dokumentációban.</p></div></li></ol></div></div></div><div class=paragraph><p>Most már készen állunk a FreeBSD telepítésére!</p></div></div></div><div class=sect2><h3 id=install-start>2.4. A telepítés megkezdése<a class=anchor href=#install-start></a></h3><div class="admonitionblock important"><table><tbody><tr><td class=icon><i class="fa icon-important" title=Important></i></td><td class=content><div class=paragraph><p>Alapértelmezés szerint a telepítés egészen addig nem fog semmit sem írni a lemezekre, amíg a következõ üzenet fel nem bukkan:</p></div><div class=literalblock><div class=content><pre>Last Chance: Are you SURE you want continue the installation?

If you&#39;re running this on a disk with data you wish to save then WE
STRONGLY ENCOURAGE YOU TO MAKE PROPER BACKUPS before proceeding!

We can take no responsibility for lost disk contents!</pre></div></div><div class=paragraph><p>A szöveg fordítása:</p></div><div class=literalblock><div class=content><pre>Utolsó esély: BIZTOSAN folytatni kívánja a telepítést?

Ha olyan lemezre szeretne telepíteni, amelyen fontos adatok
találhatóak, HATÁROZOTTAN JAVASOLJUK, hogy a továbblépés elõtt
KÉSZÍTSEN RÓLUK MEGBÍZHATÓ BIZTONSÁGI MÁSOLATOT!

Nem vállalunk semmilyen felelõsséget az elveszett adatokért!</pre></div></div><div class=paragraph><p>A telepítõbõl tehát a fenti, végsõ figyelmeztetés elõtt bármikor ki lehet lépni anélkül, hogy a merevlemezünkön levõ adatokat veszélyeztetnénk. Ha úgy érezzük, hogy valamit véletlenül rosszul állítottunk volna be a telepítés során, ekkor még minden komolyabb kár okozása nélkül kikapcsolhatjuk a számítógépünket.</p></div></td></tr></tbody></table></div><div class=sect3><h4 id=install-starting>2.4.1. A rendszer indítása<a class=anchor href=#install-starting></a></h4><div class=sect4><h5 id=install-starting-i386>2.4.1.1. Rendszerindítás i386™-on<a class=anchor href=#install-starting-i386></a></h5><div class="exampleblock procedure"><div class=content><div class="olist arabic"><ol class=arabic><li><p>Kezdjünk egy kikapcsolt számítógéppel.</p></li><li><p>Kapcsoljuk be a számítógépet. Az indulása során látnunk kell egy olyan opciót, amivel be tudunk lépni a rendszer beállításait tartalmazó menübe, avagy a BIOS-ba. Ezt többnyire a <kbd>F2</kbd>, <kbd>F10</kbd>, <kbd>Del</kbd> vagy a <span class=keyseq><kbd>Alt</kbd>+<kbd>S</kbd></span> lenyomásával érhetjük el. Ezek közül használjuk a képernyõn megjelenõ billentyûket. Elõfordulhat, hogy induláskor a számítógépünk semmilyen szöveget, csak egy képet mutat. Ilyenkor általában a <kbd>Esc</kbd> billentyû megnyomására eltûnik a kép és láthatóvá válnak a számunkra fontos üzenetek.</p></li><li><p>Miután beléptünk a menübe, keressük meg azt a beállítást, amely a rendszerindításhoz használt eszközt határozza meg. Ennek a neve sokszor "Boot Order" (rendszerindítási sorrend) vagy valami hozzá hasonló. Itt mindenféle eszköz felsorolását találjuk: <code>Floppy</code>, <code>CDROM</code>, <code>First Hard Disk</code> (elsõ merevlemezes meghajtó) és így tovább.</p><div class=paragraph><p>Ha CD-rõl akarjuk a telepítést elindítani, akkor akkor a <code>CDROM</code> eszközt válasszuk. Ha bármilyen kétség merülne fel bennünk, keressük meg ezt a beállítást a számítógéphez és/vagy az alaplaphoz kapott kézikönyvben.</p></div><div class=paragraph><p>Igényeink szerint végezzük el a beállítást, majd mentsük el és lépjünk ki. Most indítsuk újra a számítógépet.</p></div></li><li><p>Ha a <a href=#install-boot-media>Készítsünk egy rendszerindító lemezt</a>ban leírtak szerint rendszerindító pendrive-ot készítettünk, akkor bekapcsolás elõtt csatlakoztassuk a számítógéphez.</p><div class=paragraph><p>Ha CD-rõl indítjuk a telepítést, akkor kapcsoljuk be a számítógépet és az elindulása után igyekezzünk minél hamarabb betenni a lemezt a meghajtóba.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>A FreeBSD 7.3 és az azt megelõzõ változatokban a <a href=#install-boot-media>Készítsünk egy rendszerindító lemezt</a>ban leírtak szerint elõkészített floppy-ról is el tudjuk kezdeni a telepítést. Ezek egyike lesz az elsõ rendszerindító lemez, a <span class=filename>boot.flp</span>. Helyezzük ezt a lemezt a meghajtóba, és indítsuk el vele a számítógépet.</p></div></td></tr></tbody></table></div><div class=paragraph><p>Ha minden próbálkozásunk ellenére a számítógépünk a megszokott módon indul és a meglevõ operációs rendszert tölti be, akkor a következõkkel lehet a gond:
.. A lemezeket nem raktuk be eléggé korán. Hagyjuk benn ezeket és próbáljuk meg ismét újraindítani a számítógépet.
.. Nem állítottuk be jól a BIOS-t. Próbáljuk meg egészen addig újra végrehajtani az elõzõ lépést, amíg a megfelelõ beállítást el nem találjuk.
.. A BIOS nem támogatja a kiválasztott eszközrõl történõ rendszerindítást.</p></div></li><li><p>A FreeBSD megkezdi az indulását. Ha CD-rõl indítjuk, akkor valami ehhez hasonlót fogunk látni (a konkrét verzióra vonatkozó adatokat itt most kihagytuk):</p><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>Booting from CD-Rom...
645MB medium detected
CD Loader 1.2

Building the boot loader arguments
Looking up /BOOT/LOADER... Found
Relocating the loader and the BTX
Starting the BTX loader

BTX loader 1.00 BTX version is 1.02
Console: internal video/keyboard
BIOS CD is cd0
BIOS drive C: is disk0
BIOS drive D: is disk1
BIOS 639kB/261056kB available memory

FreeBSD/i386 bootstrap loader, Revision 1.1

Loading /boot/defaults/loader.conf
/boot/kernel/kernel <span class=nv>text</span><span class=o>=</span>0x64daa0 <span class=nv>data</span><span class=o>=</span>0xa4e80+0xa9e40 <span class=nv>syms</span><span class=o>=[</span>0x4+0x6cac0+0x4+0x88e9d]
<span class=se>\</span></code></pre></div></div><div class=paragraph><p>Amikor floppyról indítjuk a rendszert, ehhez hasonlóval találkozhatunk (itt sem szerepelnek most verzióadatok):</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>Booting from Floppy...
Uncompressing ... <span class=k>done

</span>BTX loader 1.00  BTX version is 1.01
Console: internal video/keyboard
BIOS drive A: is disk0
BIOS drive C: is disk1
BIOS 639kB/261120kB available memory

FreeBSD/i386 bootstrap loader, Revision 1.1

Loading /boot/defaults/loader.conf
/kernel <span class=nv>text</span><span class=o>=</span>0x277391 <span class=nv>data</span><span class=o>=</span>0x3268c+0x332a8 |

Insert disk labelled <span class=s2>&#34;Kernel floppy 1&#34;</span> and press any key...</code></pre></div></div><div class=paragraph><p>Kövessük a képernyõn megjelenõ utasítást ("Helyezze be a "Kernel floppy 1" címkéjû lemezt és nyomjon meg egy billentyût…​"), tehát vegyük ki a <span class=filename>boot.flp</span> image-hez tartozó lemezt és tegyük be helyette a <span class=filename>kern1.flp</span> image-hez tartozó lemezt, majd nyomjuk le az <kbd>Enter</kbd> billentyût. Várjuk meg amíg a rendszer megkezdi az indulást az elsõ lemezrõl, majd az utasításoknak megfelelõen folyamatosan tegyük be a soron következõ lemezeket.</p></div></li><li><p>Miután elindítottuk a rendszert CD-rõl, pendrive-ról vagy floppy-ról, a rendszerindítási folyamat be fogja hozni a FreeBSD rendszertöltõjének menüjét:</p><div id=boot-loader-menu class=imageblock><div class=content><img src=../../../../images/books/handbook/install/boot-loader-menu.png alt="boot loader menu"></div><div class=title>Ábra 1. FreeBSD rendszerbetöltõ menüje</div></div><div class=paragraph><p>Várjuk ki a tíz másodperces szünetet vagy egybõl nyomjuk le az <kbd>Enter</kbd> billentyût.</p></div></li></ol></div></div></div></div><div class=sect4><h5 id=_rendszerindítás_sparc64_en>2.4.1.2. Rendszerindítás sparc64-en<a class=anchor href=#_rendszerindítás_sparc64_en></a></h5><div class=paragraph><p>A legtöbb sparc64 alapú rendszert úgy állították be, hogy automatikusan lemezrõl induljon. A FreeBSD telepítéséhez azonban hálózaton keresztül vagy CD-rõl kell indítanunk a rendszert, ezért módosítanunk kell a PROM (az OpenFirmware) beállításait.</p></div><div class=paragraph><p>Mindehhez indítsuk újra a rendszert és várjuk meg, amíg feltûnik a rendszerindító üzenet. A konkrét üzenet nagyban függ a számítógép típusától, azonban valami ilyesmi lesz:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>Sun Blade 100 <span class=o>(</span>UltraSPARC-IIe<span class=o>)</span>, Keyboard Present
Copyright 1998-2001 Sun Microsystems, Inc.  All rights reserved.
OpenBoot 4.2, 128 MB memory installed, Serial <span class=c>#51090132.</span>
Ethernet address 0:3:ba:b:92:d4, Host ID: 830b92d4.</code></pre></div></div><div class=paragraph><p>Amikor megpróbálja a rendszert elindítani a lemezrõl, a PROM parancssorának bekéréshez nyomjuk le a billentyûzeten az <span class=keyseq><kbd>L1</kbd>+<kbd>A</kbd></span> vagy a <span class=keyseq><kbd>Stop</kbd>+<kbd>A</kbd></span> billentyûket, esetleg a soros konzolon keresztül küldjünk egy <code>BREAK</code> parancsot (például a <a href="https://man.freebsd.org/cgi/man.cgi?query=tip&amp;sektion=1&amp;format=html">tip(1)</a> vagy <a href="https://man.freebsd.org/cgi/man.cgi?query=cu&amp;sektion=1&amp;format=html">cu(1)</a> man oldalakon szereplõ <code>~#</code> parancs használatával). Körülbelül így néz ki:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>ok     <i class=conum data-value=1></i><b>(1)</b>
ok <span class=o>{</span>0<span class=o>}</span> <i class=conum data-value=2></i><b>(2)</b></code></pre></div></div><div class="colist arabic"><table><tbody><tr><td><i class=conum data-value=1></i><b>1</b></td><td>Ez a fajta parancssor csak az egy processzorral rendelkezõ rendszereken jelenik meg.</td></tr><tr><td><i class=conum data-value=2></i><b>2</b></td><td>Ez a fajta parancssor többprocesszoros (SMP) rendszereken jelenik meg, ahol a szám az éppen aktív processzor sorszámát jelöli.</td></tr></tbody></table></div><div class=paragraph><p>Most helyezzük a CD-t a meghajtóba, és a PROM parancssorában pedig gépeljük be <code>boot cdrom</code> parancsot.</p></div></div></div><div class=sect3><h4 id=view-probe>2.4.2. Az eszközkeresés eredményeinek vizsgálata<a class=anchor href=#view-probe></a></h4><div class=paragraph><p>A képernyõn megjelenõ utolsó pár száz sor mindig eltárolódik, késõbb tetszõlegesen átvizsgálhatóak.</p></div><div class=paragraph><p>A puffer tartalmának átnézéséhez nyomjuk le a <kbd>Scroll Lock</kbd> billentyût, amivel bekapcsoljuk a korábban megjelent üzenetek közti visszalépést. Itt a nyílbillentyûk, vagy a <kbd>PageUp</kbd> és <kbd>PageDown</kbd> billentyûk használhatóak a kiírások átböngészéséhez. A <kbd>Scroll Lock</kbd> ismételt lenyomásával kiléphetünk ebbõl a módból.</p></div><div class=paragraph><p>Tegyük most mi is ezt, és nézzük az összes olyan üzenetet, amely a rendszermag indulása során keletkezett. A <a href=#install-dev-probe>Példa az eszközkeresés eredményeire</a>ban látható szövegekhez hasonlóakat fogunk találni, habár ez a számítógépben található konkrét eszközöktõl függõen eltérõ lehet.</p></div><div id=install-dev-probe class=listingblock><div class=title>Példa az eszközkeresés eredményeire</div><div class=content><pre class="rouge highlight"><code data-lang=shell>avail memory <span class=o>=</span> 253050880 <span class=o>(</span>247120K bytes<span class=o>)</span>
Preloaded elf kernel <span class=s2>&#34;kernel&#34;</span> at 0xc0817000.
Preloaded mfs_root <span class=s2>&#34;/mfsroot&#34;</span> at 0xc0817084.
md0: Preloaded image &lt;/mfsroot&gt; 4423680 bytes at 0xc03ddcd4

md1: Malloc disk
Using <span class=nv>$PIR</span> table, 4 entries at 0xc00fde60
npx0: &lt;math processor&gt; on motherboard
npx0: INT 16 interface
pcib0: &lt;Host to PCI bridge&gt; on motherboard
pci0: &lt;PCI bus&gt; on pcib0
pcib1:&lt;VIA 82C598MVP <span class=o>(</span>Apollo MVP3<span class=o>)</span> PCI-PCI <span class=o>(</span>AGP<span class=o>)</span> bridge&gt; at device 1.0 on pci0
pci1: &lt;PCI bus&gt; on pcib1
pci1: &lt;Matrox MGA G200 AGP graphics accelerator&gt; at 0.0 irq 11
isab0: &lt;VIA 82C586 PCI-ISA bridge&gt; at device 7.0 on pci0
isa0: &lt;iSA bus&gt; on isab0
atapci0: &lt;VIA 82C586 ATA33 controller&gt; port 0xe000-0xe00f at device 7.1 on pci0
ata0: at 0x1f0 irq 14 on atapci0
ata1: at 0x170 irq 15 on atapci0
uhci0 &lt;VIA 83C572 USB controller&gt; port 0xe400-0xe41f irq 10 at device 7.2 on pci
0
usb0: &lt;VIA 83572 USB controller&gt; on uhci0
usb0: USB revision 1.0
uhub0: VIA UHCI root hub, class 9/0, rev 1.00/1.00, addr1
uhub0: 2 ports with 2 removable, self powered
pci0: &lt;unknown card&gt; <span class=o>(</span><span class=nv>vendor</span><span class=o>=</span>0x1106, <span class=nv>dev</span><span class=o>=</span>0x3040<span class=o>)</span> at 7.3
dc0: &lt;ADMtek AN985 10/100BaseTX&gt; port 0xe800-0xe8ff mem 0xdb000000-0xeb0003ff ir
q 11 at device 8.0 on pci0
dc0: Ethernet address: 00:04:5a:74:6b:b5
miibus0: &lt;MII bus&gt; on dc0
ukphy0: &lt;Generic IEEE 802.3u media interface&gt; on miibus0
ukphy0: 10baseT, 10baseT-FDX, 100baseTX, 100baseTX-FDX, auto
ed0: &lt;NE2000 PCI Ethernet <span class=o>(</span>RealTek 8029<span class=o>)&gt;</span> port 0xec00-0xec1f irq 9 at device 10.
0 on pci0
ed0 address 52:54:05:de:73:1b, <span class=nb>type </span>NE2000 <span class=o>(</span>16 bit<span class=o>)</span>
isa0: too many dependant configs <span class=o>(</span>8<span class=o>)</span>
isa0: unexpected small tag 14
orm0: &lt;Option ROM&gt; at iomem 0xc0000-0xc7fff on isa0
fdc0: &lt;NEC 72065B or clone&gt; at port 0x3f0-0x3f5,0x3f7 irq 6 drq2 on isa0
fdc0: FIFO enabled, 8 bytes threshold
fd0: &lt;1440-KB 3.5<span class=s2>&#34; drive&gt; on fdc0 drive 0
atkbdc0: &lt;Keyboard controller (i8042)&gt; at port 0x60,0x64 on isa0
atkbd0: &lt;AT Keyboard&gt; flags 0x1 irq1 on atkbdc0
kbd0 at atkbd0
psm0: &lt;PS/2 Mouse&gt; irq 12 on atkbdc0
psm0: model Generic PS/@ mouse, device ID 0
vga0: &lt;Generic ISA VGA&gt; at port 0x3c0-0x3df iomem 0xa0000-0xbffff on isa0
sc0: &lt;System console&gt; at flags 0x100 on isa0
sc0: VGA &lt;16 virtual consoles, flags=0x300&gt;
sio0 at port 0x3f8-0x3ff irq 4 flags 0x10 on isa0
sio0: type 16550A
sio1 at port 0x2f8-0x2ff irq 3 on isa0
sio1: type 16550A
ppc0: &lt;Parallel port&gt; at port 0x378-0x37f irq 7 on isa0
pppc0: SMC-like chipset (ECP/EPP/PS2/NIBBLE) in COMPATIBLE mode
ppc0: FIFO with 16/16/15 bytes threshold
plip0: &lt;PLIP network interface&gt; on ppbus0
ad0: 8063MB &lt;IBM-DHEA-38451&gt; [16383/16/63] at ata0-master UDMA33
acd0: CD-RW &lt;LITE-ON LTR-1210B&gt; at ata1-slave PIO4
Mounting root from ufs:/dev/md0c
/stand/sysinstall running as init on vty0</span></code></pre></div></div><div class=paragraph><p>Figyelmesen olvassuk át az üzeneteket, és bizonyosodjuk meg róla, hogy a FreeBSD minden számunkra fontos eszközt felismert. Ha nem látunk egy eszközt, akkor azt valószínûleg nem találta meg. Egy <a href=./#kernelconfig>saját rendszermag</a> létrehozásával azonban fel tudunk ismertetni olyan eszközöket is, amelyek támogatása eredetileg nem szerepel a <span class=filename>GENERIC</span> rendszermagban. Ilyenek például a hangkártyák.</p></div><div class=paragraph><p>A FreeBSD 6.2 vagy késõbbi változataiban az eszközök felkutatása után a <a href=#config-country>Az ország kiválasztása</a>ban láthatóak következnek. Itt a nyílbillentyûk segítségével választhatjuk ki az országot (country), térséget (region) vagy csoportot (group). Az <kbd>Enter</kbd> lenyomása után pillanatok alatt beállítódik az országunk. Ha meg akarjuk ismételni az iménti beállítást, pillanatok alatt ki tudunk lépni a sysinstall programból.</p></div><div id=config-country class=imageblock><div class=content><img src=../../../../images/books/handbook/install/config-country.png alt="config country"></div><div class=title>Ábra 2. Az ország kiválasztása</div></div><div class=paragraph><p>Ha országként <span class=guimenuitem>United States</span> (Egyesült Államok) került beállításra, akkor a szabványos amerikai billentyûzet-kiosztás állítódik be. A többi ország esetében az alábbi menü jelenik meg. A kurzormozgató billentyûk segítségével ekkor keressük meg ki a számunkra megfelelõ kiosztást, és az <kbd>Enter</kbd> billentyû lenyomásával válasszuk ki.</p></div><div id=config-keymap class=imageblock><div class=content><img src=../../../../images/books/handbook/install/config-keymap.png alt="config keymap"></div><div class=title>Ábra 3. A billentyûzet típusának kiválasztása</div></div><div id=sysinstall-exit class=imageblock><div class=content><img src=../../../../images/books/handbook/install/sysinstall-exit.png alt="sysinstall exit"></div><div class=title>Ábra 4. Kilépés a sysinstall programból</div></div><div class=paragraph><p>A telepítõprogram fõképernyõjén válasszuk ki a nyílbillentyûkkel az <span class=guimenuitem>Exit Install</span> ("Kilépés a telepítésbõl") menüpontot. Erre a következõ üzenet fog megjelenni:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>                      User Confirmation Requested
         Are you sure you wish to <span class=nb>exit</span>? The system will reboot

                            <span class=o>[</span> Yes <span class=o>]</span>    No</code></pre></div></div><div class=paragraph><p>Az üzenet fordítása:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>                  Felhasználói megerősítés szükséges
         Valóban ki akar lépni? A rendszer ezt követően újra fog
         indulni

                           <span class=o>[</span> Igen <span class=o>]</span>    Nem</code></pre></div></div><div class=paragraph><p>Ha a <b class=button>yes</b> választ adjuk és a CD-t az újraindításkor is a meghajtóban hagyjuk, akkor a telepítõprogram még egyszer el fog indulni.</p></div><div class=paragraph><p>Ha floppyról indítottuk volna a rendszert, az újraindítás elõtt vegyük ki a <span class=filename>boot.flp</span> image-et tartalmazó lemezt.</p></div></div></div><div class=sect2><h3 id=using-sysinstall>2.5. A sysinstall bemutatása<a class=anchor href=#using-sysinstall></a></h3><div class=paragraph><p>A sysinstall a FreeBSD Projekt által fejlesztett telepítõprogram. Konzol alapú, menükre és képernyõkre oszlik, amelyeken a beállításokat és a telepítési folyamat irányítását tudjuk elvégezni.</p></div><div class=paragraph><p>A sysinstall menürendszerét több más billentyû mellett legfõképpen a nyílbillentyûkkel, az <kbd>Enter</kbd>, <kbd>Tab</kbd> és a <kbd>Szóköz</kbd> billentyûkkel kezelhetjük. Ezek és az általuk elvégezhetõ feladatok részletes leírása a sysinstall használatáról szóló információk között található.</p></div><div class=paragraph><p>Ennek megtekintéséhez elõször gyõzõdjünk meg róla, hogy a <a href=#sysinstall-main3>A "Usage" kiválasztása a sysinstall fõmenüjében</a> által illusztrált helyzetnek megfelelõen kiválasztottuk a <span class=guimenuitem>Usage</span> ("Használat") menüpontot és a <b class=button>Select</b> ("Kiválaszt") feliratú gombon állunk, majd nyomjuk le az <kbd>Enter</kbd> billentyût.</p></div><div class=paragraph><p>Ezt követõen megjelenik a menürendszer használatát bemutató leírás. Miután végigolvastuk, a fõmenübe az <kbd>Enter</kbd> billentyû lenyomásával tudunk visszajutni.</p></div><div id=sysinstall-main3 class=imageblock><div class=content><img src=../../../../images/books/handbook/install/main1.png alt=main1></div><div class=title>Ábra 5. A "Usage" kiválasztása a sysinstall fõmenüjében</div></div><div class=sect3><h4 id=select-doc>2.5.1. A dokumentációs menü kiválasztása<a class=anchor href=#select-doc></a></h4><div class=paragraph><p>A fõmenüben a nyílbillentyûkkel válasszuk a <span class=guimenuitem>Doc</span> feliratú menüpontot és nyomjuk meg az <kbd>Enter</kbd> billentyût.</p></div><div id=main-doc class=imageblock><div class=content><img src=../../../../images/books/handbook/install/main-doc.png alt="main doc"></div><div class=title>Ábra 6. A dokumentációs menü kiválasztása</div></div><div class=paragraph><p>Ezzel megjelenik a dokumentációs menü.</p></div><div id=docmenu1 class=imageblock><div class=content><img src=../../../../images/books/handbook/install/docmenu1.png alt=docmenu1></div><div class=title>Ábra 7. A sysinstall dokumentációs menüje</div></div><div class=paragraph><p>Feltétlenül olvassuk el az itt található leírásokat.</p></div><div class=paragraph><p>A dokumentumok elolvasásához elõször válasszunk közülük a nyílbillentyûkkel, majd nyomjuk meg az <kbd>Enter</kbd> billentyût. A dokumentum elolvasása után az <kbd>Enter</kbd> lenyomásával tudunk visszatérni a dokumentációs menübe.</p></div><div class=paragraph><p>A dokumentációs menübõl a fõmenübe úgy tudunk kilépni, ha a nyílbillentyûkkel kiválasztjuk az <span class=guimenuitem>Exit</span> ("Kilépés") menüpontot és megnyomjuk az <kbd>Enter</kbd> billentyût.</p></div></div><div class=sect3><h4 id=keymap>2.5.2. A billentyûkiosztás menüjének kiválasztása<a class=anchor href=#keymap></a></h4><div class=paragraph><p>A billentyûzetkiosztás megváltoztatásához válasszuk ki a nyílbillentyûk segítségével a <span class=guimenuitem>Keymap</span> menüpontot a menübõl és nyomjuk meg az <kbd>Enter</kbd> billentyût. Erre természetesen csak akkor lesz szükségünk, ha nem szabványos vagy nem angol billentyûzetet használunk.</p></div><div id=sysinstall-keymap class=imageblock><div class=content><img src=../../../../images/books/handbook/install/main-keymap.png alt="main keymap"></div><div class=title>Ábra 8. A sysinstall fõmenüje</div></div><div class=paragraph><p>A különbözõ billentyûkiosztásoknak megfelelõ menüpontok a fel/le nyílak és a <kbd>Szóköz</kbd> billentyû segítségével választhatóak ki. A <kbd>Szóköz</kbd> ismételt lenyomásával töröljük a választásunkat. A befejezéshez válasszuk ki a nyilakkal a <b class=button>OK</b> gombot és nyomjuk le az <kbd>Enter</kbd> billentyût.</p></div><div class=paragraph><p>A mellékelt képen a lista egy része látható csupán. Ha a <kbd>Tab</kbd> billentyûvel a <b class=button>Cancel</b> gombot választjuk, akkor az alapértelmezett billentyûkiosztást kapjuk és visszakerülünk a fõmenübe.</p></div><div id=sysinstall-keymap-menu class=imageblock><div class=content><img src=../../../../images/books/handbook/install/keymap.png alt=keymap></div><div class=title>Ábra 9. A sysinstall billentyûkiosztást beállító menüje</div></div></div><div class=sect3><h4 id=viewsetoptions>2.5.3. A telepítés beállításai tartalmazó képernyõ<a class=anchor href=#viewsetoptions></a></h4><div class=paragraph><p>Válasszuk az <span class=guimenuitem>Options</span> ("Beállítások") menüpontot, majd nyomjuk le az <kbd>Enter</kbd> billentyût.</p></div><div id=sysinstall-options class=imageblock><div class=content><img src=../../../../images/books/handbook/install/main-options.png alt="main options"></div><div class=title>Ábra 10. A sysinstall fõmenüje</div></div><div id=options class=imageblock><div class=content><img src=../../../../images/books/handbook/install/options.png alt=options></div><div class=title>Ábra 11. A sysinstall beállításai</div></div><div class=paragraph><p>Az itt szereplõ alapértelmezett értékek a legtöbb felhasználó számára minden további nélkül megfelelnek, nem szükséges a megváltoztatásuk. A kiadás neve ("release name") mezõ értéke a telepítendõ verziótól függõen változhat.</p></div><div class=paragraph><p>A kiválasztott mezõ rövid leírása a képernyõ alján, kékkel kiemelten jelenik meg. A <span class=guimenuitem>Use Defaults</span> ("Az alapértelmezések használata") beállítás az alapértelmezésére állítja vissza az összes értéket.</p></div><div class=paragraph><p>Az <kbd>F1</kbd> lenyomásával elolvashatjuk a különbözõ beállításokhoz tartozó súgót.</p></div><div class=paragraph><p>A <kbd>Q</kbd> billentyûvel visszatérhetünk a fõmenübe.</p></div></div><div class=sect3><h4 id=start-install>2.5.4. Egy szabványos telepítés megkezdése<a class=anchor href=#start-install></a></h4><div class=paragraph><p>A <span class=guimenuitem>Standard</span> ("Szabványos") elnevezésû menüpont által felkínált telepítési módszer ajánlott a UNIX®-szal vagy a FreeBSD-vel most ismerkedõk számára. A telepítés megkezdéséhez a nyilakkal válasszuk ki a <span class=guimenuitem>Standard</span> menüpontot, majd nyomjuk meg az <kbd>Enter</kbd> billentyût.</p></div><div id=sysinstall-standard class=imageblock><div class=content><img src=../../../../images/books/handbook/install/main-std.png alt="main std"></div><div class=title>Ábra 12. Egy szabványos telepítés megkezdése</div></div></div></div><div class=sect2><h3 id=install-steps>2.6. Lemezterület lefoglalása<a class=anchor href=#install-steps></a></h3><div class=paragraph><p>Elsõ feladatunk lemezterületet foglalni a FreeBSD számára, majd megcímkézni azt, hogy a sysinstall elõ tudja készíteni. Ehhez tisztában kell lennünk azzal, hogy a FreeBSD milyen formában is keresi az adatokat a lemezünkön.</p></div><div class=sect3><h4 id=install-drive-bios-numbering>2.6.1. A BIOS meghajtószámozása<a class=anchor href=#install-drive-bios-numbering></a></h4><div class=paragraph><p>Egy témára különösen tekintettel kell lennünk mielõtt telepítenénk és beállítanánk a FreeBSD-t a rendszerünkön, fõleg abban az esetben, ha több merevlemezünk is van.</p></div><div class=paragraph><p>Egy BIOS-függõ operációs rendszert, például MS-DOS®-t vagy Windows®-t futattó PC esetén a BIOS az operációs rendszer beleegyezésével képes elvonatkoztatni a lemezek megszokott sorrendjétõl. Ennek köszönhetõen a felhasználó nem csak az ún. "primary master" (elsõdleges master) merevlemezes meghajtótól tudja elindítani a rendszert. Ez kifejezetten kényelmes megoldás az olyan felhasználók számára, akik az elsõvel teljesen megegyezõ második merevlemez megvásárlásával kialakították a rendszerük egyszerû és egyben a legolcsóbb biztonsági mentését, amire a Ghost vagy XCOPY programokkal tudnak rendszeres másolatokat készíteni. Így, ha az elsõdleges meghajtó tönkremegy vagy vírus támadja meg, esetleg az operációs rendszer egy hiba miatt használhatatlanná teszi, akkor a BIOS-t utasíthatjuk a meghajtók logikai cseréjére és ezzel könnyen helyre tudjuk állítani. Olyan, mintha a ház felnyitása nélkül felcseréltük volna a lemezeket bekötõ kábeleket.</p></div><div class=paragraph><p>A SCSI-vezérlõkkel szerelt drágább rendszerek gyakran tartalmaznak olyan BIOS-bõvítéseket, amelyeken keresztül a SCSI-lemezek ugyanígy tetszõlegesen átrendezhetõek, egészen hét meghajtóig.</p></div><div class=paragraph><p>Az ilyen lehetõségek használatához szokott felhasználókat azonban könnyen csalódás érheti, amikor a FreeBSD nem az elvárásaiknak megfelelõen cselekszik. A FreeBSD ugyanis nem használja a BIOS-t és nem ismeri a "BIOS logikai meghajtókiosztását". Ez meghökkentõ eredményekre vezethet, fõleg akkor, amikor paramétereiket tekintve a meghajtók fizikailag teljesen megegyeznek és ráadásul egymás másolatait tartalmazzák.</p></div><div class=paragraph><p>A FreeBSD telepítése elõtt mindig állítsuk vissza a BIOS-ban a meghajtók eredeti sorrendjét, és a használatához hagyjuk is így ezt a beállítást. Ha valamiért mégis meg kellene cserélnünk a meghajtókat, akkor ezentúl válasszuk a nehezebb utat: nyissuk ki a gépházat és kössük át a kábeleket, tegyük át a jumpereket mi magunk.</p></div><div class=paragraph><p>Vili fogott egy öreg Winteles számítógépet, hogy készítsen belõle egy FreeBSD-s rendszert Frédinek. Vili ehhez beszerel egy SCSI-meghajtót, ami így nullás SCSI-egység lesz, majd telepíti rá a FreeBSD-t.</p></div><div class=paragraph><p>Frédi nekilát használni a rendszert, azonban pár nap elteltével tapasztalja, hogy az öregecske SCSI-meghajtó számos apróbb hibát jelez, és ezért szól Vilinek.</p></div><div class=paragraph><p>Néhány nappal késõbb Vili eldönti, ideje pontot tenni az ügy végére, ezért a raktárban levõ SCSI-lemezek köztül elhoz az eredetivel egy teljesen megegyezõt. Az elõzetes felületellenõrzés eredményei szerint a meghajtó tökéletesen mûködik, ezért Vili beszerelni ezt a meghajtót a négyes SCSI-egységként, majd lemásolja a nullás meghajtó tartalmát a négyesre. Miután beszerelte a tökéletesen üzemelõ új meghajtót, Vili úgy határoz, ideje megkezdeni a használatát, ezért beállítja a SCSI BIOS-át, hogy a rendszer a nullás helyett ezentúl a négyes egységrõl induljon. A FreeBSD elindul és mindenki örül.</p></div><div class=paragraph><p>Frédi ezután folytatja megszokott munkáját, majd Vili és Frédi úgy gondolják, itt az ideje az újabb izgalmaknak - frissítsünk a FreeBSD egy újabb változatára. Vili ekkor eltávolítja a nullás SCSI-egységet, mivel már egyébként is kezdett tönkremenni, és kicseréli egy másik teljesen azonos lemezes meghajtóra. Vili ezt követõen Frédi internetrõl letöltött varázslatos floppyjainak segítségével feltelepíti a FreeBSD új verzióját az új nullás SCSI-egységre. A telepítés minden gond nélkül lezajlik.</p></div><div class=paragraph><p>Frédi próbálgatja is a FreeBSD új változatát néhány napig, és számára ez elegendõ bizonyíték ahhoz, hogy a munkahelyén is használja. Ideje hát átmásolni a régi munkáit, ezért Frédi csatlakoztatja a (korábbi FreeBSD változat legfrissebb változatát tartalmazó) négyes SCSI-egységet. Frédin azonban hirtelen aggodalom tör ki, hiszen a négyes SCSI-egységen sehol sem találja munkája féltett eredményeit.</p></div><div class=paragraph><p>Hova tûntek azok a komisz adatok?</p></div><div class=paragraph><p>Amikor Vili másolatot készített az eredeti nullás SCSI-egységrõl a négyes SCSI-egységre, a négyes egység egy "új klón" lett. Amikor a rendszerindításhoz Vili átrendezte a meghajtókat a SCSI BIOS-ban, azzal csak magát csapta be, ugyanis a FreeBSD továbbra is a nullás SCSI-egységrõl indult el! A BIOS által kiválasztott meghajtóról az effajta beállítások hatására ugyan behozható a rendszerindító és -betöltõ programok egy része, de amikor a FreeBSD rendszermagja átveszi a vezérlést, a BIOS által meghatározott sorrendiség figyelmen kívül marad és a FreeBSD visszatér a meghajtók eredeti rendezéséhez. Tehát ebben az esetben a rendszer továbbra is az eredeti nullás SCSI-egységrõl folytatja a mûködést, és Frédi összes adata itt található, nem pedig a négyes SCSI-egységen. A négyes SCSI-egységrõl futó rendszer illuziója így mindössze az emberi elvárások szüleménye.</p></div><div class=paragraph><p>Örömmel említjük meg, hogy egyetlen byte-nyi adat sem sérült meg vagy pusztult el a jelenség felfedezése során. A korábbi nullás SCSI-egységet még sikerült megmenteni a szemétdombról és Frédi összes munkája visszakerült (és Vili most már el tud számolni nulláig).</p></div><div class=paragraph><p>Habár a tanmesénkben SCSI-meghajtókról esett szó, ugyanez fennáll az IDE-meghajtókra is.</p></div></div><div class=sect3><h4 id=main-fdisk>2.6.2. Slice-ok létrehozása az FDisk használatával<a class=anchor href=#main-fdisk></a></h4><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Itt még semmilyen változtatás nem kerül lemezre. Ha úgy érezzük, hogy valamit rosszul csináltunk és újra el akarjuk kezdeni a telepítést, a menük segítségével büntetlenül távozhatunk a sysinstallból és újra próbálkozhatunk, vagy az <kbd>U</kbd> billentyû lenyomásával aktiválhatjuk az <span class=guimenuitem>Undo</span> ("Visszacsinál") funkciót. Ha véletlenül összezavarodtunk volna és nem találunk kilépési lehetõséget, akkor bármikor ki tudjuk kapcsolni a számítógépet.</p></div></td></tr></tbody></table></div><div class=paragraph><p>A sysinstallban a szabványos telepítés megkezdésekor az alábbi üzenet jelenik meg:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>                                 Message
 In the next menu, you will need to <span class=nb>set </span>up a DOS-style <span class=o>(</span><span class=s2>&#34;fdisk&#34;</span><span class=o>)</span>
 partitioning scheme <span class=k>for </span>your hard disk. If you simply wish to devote
 all disk space to FreeBSD <span class=o>(</span>overwriting anything <span class=k>else </span>that might be on
 the disk<span class=o>(</span>s<span class=o>)</span> selected<span class=o>)</span> <span class=k>then </span>use the <span class=o>(</span>A<span class=o>)</span>ll <span class=nb>command </span>to <span class=k>select </span>the default
 partitioning scheme followed by a <span class=o>(</span>Q<span class=o>)</span>uit. If you wish to allocate only
 free space to FreeBSD, move to a partition marked <span class=s2>&#34;unused&#34;</span> and use the
 <span class=o>(</span>C<span class=o>)</span>reate command.
                                <span class=o>[</span>  OK  <span class=o>]</span>

                      <span class=o>[</span> Press enter or space <span class=o>]</span></code></pre></div></div><div class=paragraph><p>Az üzenet fordítása:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>                                  Üzenet
 A most következő menüben össze kell állítanunk a merevlemezünk
 DOS-szerű <span class=o>(</span><span class=s2>&#34;fdiskes&#34;</span><span class=o>)</span> partícióit. Amennyiben egyszerűen csak át
 akarjuk adni az összes lemezterületet a FreeBSD számára <span class=o>(</span>ezzel
 felülírva mindent, ami a kiválasztott lemezeken található<span class=o>)</span>, akkor
 az alapértelmezett partíció-kiosztás kiválasztásához használjuk az
 <span class=o>(</span>A<span class=o>)</span>ll <span class=o>(</span>Mind<span class=o>)</span>, majd utána a <span class=o>(</span>Q<span class=o>)</span>uit <span class=o>(</span>Kilépés<span class=o>)</span> parancsokat. Ha viszont
 csak az éppen szabad területet szánjuk a FreeBSD-nek, lépjünk egy
 <span class=s2>&#34;unused&#34;</span> <span class=o>(</span><span class=s2>&#34;üres&#34;</span><span class=o>)</span> feliratú partícióra és használjuk a <span class=o>(</span>C<span class=o>)</span>reate
 <span class=o>(</span>Létrehozás<span class=o>)</span> parancsot.

                               <span class=o>[</span>  OK  <span class=o>]</span>

            <span class=o>[</span> Nyomja le az Enter vagy a Szóköz billentyűt <span class=o>]</span></code></pre></div></div><div class=paragraph><p>Az utasításnak megfelelõen nyomjuk le az <kbd>Enter</kbd> billentyût. Ezután a rendszermag által az eszközök felkutatása során megtalált összes merevlemezes meghajtót láthatjuk. A <a href=#sysinstall-fdisk-drive1>A meghajtó kiválasztása az FDisk számára</a> egy két IDE-lemezzel rendelkezõ rendszert mutat be, amelyeknek nevei rendre <span class=filename>ad0</span> és <span class=filename>ad2</span>.</p></div><div id=sysinstall-fdisk-drive1 class=imageblock><div class=content><img src=../../../../images/books/handbook/install/fdisk-drive1.png alt="fdisk drive1"></div><div class=title>Ábra 13. A meghajtó kiválasztása az FDisk számára</div></div><div class=paragraph><p>Feltûnhet, hogy itt nem szerepel az <span class=filename>ad1</span>. Vajon miért maradt ki?</p></div><div class=paragraph><p>Képzeljük el, mi történne, ha két IDE-csatolós merevlemezünk lenne: az egyik az elsõ IDE-vezérlõn, a másik pedig a második IDE-vezérlõn lenne master. Ha a FreeBSD a megtalálásuk szerint <span class=filename>ad0</span> és <span class=filename>ad1</span> nevekkel számozná ezeket, attól még minden remekül mûködhetne.</p></div><div class=paragraph><p>Ha azonban beszerelnénk egy harmadik lemezt, például egy slave eszközt kapcsolnánk az elsõ IDE-vezérlõre, akkor már ez lenne a <span class=filename>ad1</span>, és ennek megfelelõen a korábban <span class=filename>ad1</span> megnevezésû meghajtó pedig az <span class=filename>ad2</span>. Mivel az állományrendszerek felkutatására általában az eszközneveket (mint amilyen a <span class=filename>ad1s1a</span>) használják, ezért ilyenkor azt tapasztalhatnánk, hogy bizonyos állományrendszerek helytelenül jelennek meg, ezért meg kell változtatnunk a FreeBSD ezeket érintõ beállításait.</p></div><div class=paragraph><p>A probléma megoldására a rendszermag beállítható úgy, hogy az IDE-lemezeket a kapcsolódásuk szerint azonosítsa, ne pedig a megtalálásuk sorrendje szerint. Ezzel a kialakítással a második IDE-vezérlõn található master lemez <em>mindig</em> az <span class=filename>ad2</span> eszköz lesz, tehát még olyankor is, amikor egyáltalán nincs a rendszerünkben <span class=filename>ad0</span> vagy <span class=filename>ad1</span> eszköz.</p></div><div class=paragraph><p>Ez a beállítás alapértelmezés a FreeBSD rendszermagjában, és ez magyarázza, hogy az iménti ábra miért csak <span class=filename>ad0</span> és <span class=filename>ad2</span> eszközöket mutat. Tehát a képen szereplõ számítógép mind a két IDE-vezérlõjének master csatornáján található egy-egy IDE-lemez, a slave csatornákon pedig nincs egy sem.</p></div><div class=paragraph><p>Itt válasszuk ki azt a lemezt, amelyre a FreeBSD-t telepíteni kívánjuk, majd nyomjuk meg a <b class=button>OK</b> gombot. Erre az <a href=#sysinstall-fdisk1>Átlagos Fdisk partíciók szerkesztés elõtt</a> által bemutatott képernyõvel elindul az FDisk.</p></div><div class=paragraph><p>Az FDisk képernyõje három részre osztható.</p></div><div class=paragraph><p>Az elsõ részben, amely a képernyõ felsõ két sorát foglalja össze, láthatjuk az éppen kiválasztott lemez adatait: a FreeBSD szerinti nevét, a paramétereit és az összméretét.</p></div><div class=paragraph><p>A második részben láthatjuk a lemezen megtalálható slice-okat: hol kezdõdnek (Offset) és hol érnek véget (End); mekkorák (Size); a FreeBSD milyen névvel hivatkozik rájuk (Name); milyen leírás (Description) és altípus (Subtype) tartozik hozzájuk. A példában két kicsi üres slice-ot láthatunk, ami a PC-k lemezkiosztására jellemzõ. Ezenkívül felfedezhetünk egy nagyobb méretû FAT típusú slice-ot is, amely az MS-DOS® / Windows® világban szinte minden bizonnyal a <span class=filename>C:</span> betûjelet viseli, valamint egy kiterjesztett slice-ot is, amely az MS-DOS® / Windows® számára további meghajtókat is tartalmazhat.</p></div><div class=paragraph><p>A harmadik részben az FDisk mûködtetésére használható parancsok láthatóak.</p></div><div id=sysinstall-fdisk1 class=imageblock><div class=content><img src=../../../../images/books/handbook/install/fdisk-edit1.png alt="fdisk edit1"></div><div class=title>Ábra 14. Átlagos Fdisk partíciók szerkesztés elõtt</div></div><div class=paragraph><p>A most következõ teendõink attól függenek, hogy miként is akarjuk felosztani a lemezünket.</p></div><div class=paragraph><p>Ha az egész lemezt a FreeBSD használatára áldozzuk (és amikor majd megerõsítjük a sysinstall számára a továbblépést, a lemezen így minden más adat törlõdni fog), akkor nyomjuk le az <kbd>A</kbd> billentyût, amely megfelel a <span class=guimenuitem>Use Entire Disk</span> (Az egész lemez használata) menüpontnak. A létezõ slice-ok eltávolításra kerülnek és helyettük megjelenik egy <code>unused</code> (üres) jelzésû kis méretû terület (elvégre PC-rõl beszélünk), valamint egy nagyobb slice a FreeBSD számára. Ha így jártunk el, akkor válasszuk ki nyilakkal a frissen létrejött FreeBSD slice-ot és az <kbd>S</kbd> billentyû lenyomásával jelöljük be indíthatónak (bootable). A képernyõ ekkor a <a href=#sysinstall-fdisk2>Particionálás az Fdisk "Using Entire Disk" funkciójával</a> által mutatotthoz fog erõsen hasonlítani. A <code>Flags</code> (Beállítások) oszlopban láthatjuk az <code>A</code> jelzést, amelybõl kiderül, hogy az adott slice <em>aktív</em>, tehát róla tud indulni a rendszer.</p></div><div class=paragraph><p>Ha a FreeBSD számára egy meglevõ slice törlésével szeretnénk helyet csinálni, akkor ehhez válasszuk ki nyílbillentyûkkel a használni kivánt slice-ot és nyomjuk le a <kbd>D</kbd> billentyût. Ezután nyomjuk le a <kbd>C</kbd> billentyût is, amire felbukkan a létrehozandó slice méretét kérdezõ ablak. Adjuk meg a számunkra megfelelõ méretet a számunkra megfelelõ formában, majd zárjuk le az <kbd>Enter</kbd> lenyomásával. Az ablakban szereplõ alapértelmezett érték a létrehozható lehetõ legnagyobb méretû slice-ot adja meg, ami vagy a legnagyobb összefüggõ üres terület, vagy pedig az egész merevlemez összterülete lehet.</p></div><div class=paragraph><p>Ha már korábban készítettünk elõ helyet a FreeBSD-nek (például egy PartitionMagic® vagy egy hozzá hasonló alkalmazás segítségével), akkor csak elegendõ az új slice létrehozásához megnyomnunk a <kbd>C</kbd> billentyût. Ekkor szintén megkérdezésre kerül a létrehozandó slice mérete.</p></div><div id=sysinstall-fdisk2 class=imageblock><div class=content><img src=../../../../images/books/handbook/install/fdisk-edit2.png alt="fdisk edit2"></div><div class=title>Ábra 15. Particionálás az Fdisk "Using Entire Disk" funkciójával</div></div><div class=paragraph><p>Amikor befejeztük, nyomjuk le a <kbd>Q</kbd> billentyût. Ekkor a sysinstall elmenti a beállított értékeket, azonban a lemezre ekkor még nem kerülnek ki.</p></div></div><div class=sect3><h4 id=bootmgr>2.6.3. A rendszerválasztó telepítése<a class=anchor href=#bootmgr></a></h4><div class=paragraph><p>Mindezek után lehetõségünk nyílik telepíteni egy rendszerválasztót (boot manager). Általában véve akkor van szükségünk a FreeBSD rendszerválasztójának telepítésére, ha:</p></div><div class=ulist><ul><li><p>Egynél több meghajtónk van, és közülük nem az elsõ meghajtóra telepítjük a FreeBSD-t.</p></li><li><p>A FreeBSD-t ugyanazon a lemezen más operációs rendszerek mellé telepítjük, és szeretnénk választhatóvá tenni, hogy a számítógép indításakor a FreeBSD vagy a többi operációs rendszer induljon-e el.</p></li></ul></div><div class=paragraph><p>Amennyiben a FreeBSD lesz az egyetlen operációs rendszer a gépünkön és az elsõ merevlemezes meghajtóra telepítjük, akkor a <span class=guimenuitem>Standard</span> (Szabványos) rendszerválasztó tökéletesen megteszi. Ha viszont a FreeBSD indításához egy másik rendszerválasztót szeretnénk használni, válasszuk a <span class=guimenuitem>None</span> (Nincs) opciót.</p></div><div class=paragraph><p>Válasszunk, majd nyomjuk le az <kbd>Enter</kbd> billentyût!</p></div><div id=sysinstall-bootmgr class=imageblock><div class=content><img src=../../../../images/books/handbook/install/boot-mgr.png alt="boot mgr"></div><div class=title>Ábra 16. A sysinstall rendszerválasztókat tartalmazó menüje</div></div><div class=paragraph><p>Az <kbd>F1</kbd> billentyû lenyomásán keresztül elérhetõ súgóképernyõn olvashatunk az egy merevlemezen több operációs rendszer használatával kapcsolatos problémákról.</p></div></div><div class=sect3><h4 id=_slice_ok_létrehozása_egy_másik_meghajtón>2.6.4. Slice-ok létrehozása egy másik meghajtón<a class=anchor href=#_slice_ok_létrehozása_egy_másik_meghajtón></a></h4><div class=paragraph><p>Ha egynél több meghajtónk van, a program a rendszerválasztó képernyõje után ismét visszatér a meghajtók kiválasztásához. Amennyiben a FreeBSD-t egy másik meghajtóra is telepíteni szeretnénk, itt válasszuk ki azt és ismételjük meg vele az imént az FDisk programmal végzett felosztási folyamatot.</p></div><div class="admonitionblock important"><table><tbody><tr><td class=icon><i class="fa icon-important" title=Important></i></td><td class=content><div class=paragraph><p>Amikor a FreeBSD-t nem az elsõ meghajtóra telepítjük, akkor a FreeBSD rendszerválasztóját mind a két meghajtóra telepíteni kell.</p></div></td></tr></tbody></table></div><div id=sysinstall-fdisk-drive2 class=imageblock><div class=content><img src=../../../../images/books/handbook/install/fdisk-drive2.png alt="fdisk drive2"></div><div class=title>Ábra 17. Kilépés a meghajtóválasztó menübõl</div></div><div class=paragraph><p>A <kbd>Tab</kbd> billentyûvel tudunk váltani a legutoljára kiválasztott meghajtó, a <b class=button>OK</b> és a <b class=button>Cancel</b> gombok között.</p></div><div class=paragraph><p>Az <b class=button>OK</b> gombra álláshoz nyomjuk le egyszer a <kbd>Tab</kbd>ot, majd a telepítés folytatásához nyomjuk le az <kbd>Enter</kbd> billentyût.</p></div></div><div class=sect3><h4 id=bsdlabeleditor>2.6.5. Partíciók létrehozása a Disklabel segítségével<a class=anchor href=#bsdlabeleditor></a></h4><div class=paragraph><p>A következõ lépésként létre kell hoznunk partíciókat a frissen létrehozott slice-okban. Ne felejtsük el, hogy minden partíció rendelkezik egy <code>a</code>-tól <code>h</code>-ig terjedõ betûjellel, amelyek közül a <code>b</code>, <code>c</code> és <code>d</code> jelzésûeknek külön szerepe van, amire tekintettel kell lennünk.</p></div><div class=paragraph><p>Bizonyos alkalmazások kedvelnek egyes partíciókiosztási sémákat, különösen az egynél több lemezen elhelyezkedõ partíciókat. Azonban az elsõ FreeBSD telepítésünk során még nem annyira fontos koncentrálnunk a lemezünk hatékony felosztására. Sokkal inkább fontosabb, hogy elõször egyszerûen csak telepítsük a FreeBSD-t és tanuljuk meg a használatát. Amikor már jobban ismerni fogjuk az operációs rendszert, a partíciók kiosztásának megváltoztatásához mindig újra tudjuk telepíteni a FreeBSD-t.</p></div><div class=paragraph><p>Ebben a sémában négy partíció szerepel - egy a lapozóállománynak és három az állományrendszereknek.</p></div><table class="tableblock frame-none grid-all stretch"><caption class=title>Táblázat 2. Az elsõ lemez partícióinak kiosztása</caption><col style=width:25%><col style=width:25%><col style=width:25%><col style=width:25%><thead><tr><th class="tableblock halign-left valign-top">Partíció</th><th class="tableblock halign-left valign-top">Állományrendszer</th><th class="tableblock halign-left valign-top">Méret</th><th class="tableblock halign-left valign-top">Leírás</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>a</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock><span class=filename>/</span></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>1 GB</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Ez a rendszerindításhoz használt, más néven a gyökér állományrendszer (root filesystem). Minden további állományrendszer ehhez csatlakozik valahol. Ennek az állományrendszernek 1 GB méret elfogadható, mivel nem fogunk túlságosan sok adatot tárolni rajta, a FreeBSD telepítõje is csak nagyjából 128 MB adatot fog ide tenni. Az így fennmaradó lemezterület felhasználható átmeneti adatok tárolására, illetve a <span class=filename>/</span> könyvtárban helyet ad a FreeBSD késõbbi változatainak terjeszkedéséhez is.</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>b</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>-</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>RAM mérete x 2-3</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>A rendszer lapozóállománya a <code>b</code> partíción tárolódik. Itt a megfelelõ méret megválasztása egyfajta mûvészet, azonban minden esetben hasznosnak bizonyulhat, ha tudjuk, hogy méretnek mindig érdemes a fizikai avagy központi memória (RAM) méretének két, esetleg háromszorosát választani. Legyen mindig legalább 64 MB-nyi méretû lapozóállományunk, és ha 32 MB RAM-nál kevesebb van a számítógépünkben, akkor is legalább 64 MB-ra állítsuk be.</p><p class=tableblock>Ha egynél több lemezünk van, mindegyikre rakhatunk lapozóállományt, ezzel a FreeBSD mindegyikõjüket fel tudja használni lapozásra, amivel pedig gyakorlatilag felgyorsítja a folyamatot. Ilyenkor számoljunk úgy, hogy elõször meghatározzuk a teljes lapozóállomány méretét (például 128 MB), majd ezt elosztjuk a rendelkezésünkre álló lemezek számával (például kettõ). Ebbõl kiszámítható az egyes lemezeken elhelyezendõ lapozóállomány mérete, ami most a példánk szerint 64 MB lesz.</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>e</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock><span class=filename>/var</span></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>512 MB-tl 4096 MB-ig</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>A <span class=filename>/var</span> könyvtár foglalja magában az állandó változó naplóállományokat, valamint a többi, adminisztrációhoz használt állományt. Ezek többsége a FreeBSD mindennapos mûködése közben folyamatosan íródnak vagy olvasódnak. Ha ezeket az állományokat egy külön állományrendszerre rakjuk, akkor ezzel segítünk a FreeBSD-nek optimalizálni az ilyen állományok elérését anélkül, hogy ez hatással lenne a többi, más hozzáférési gyakorisággal bíró állományra.</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>f</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock><span class=filename>/usr</span></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>A lemez többi része (legalább 8 GB)</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Az összes többi állomány többnyire a <span class=filename>/usr</span> könyvtárban és annak alkönyvtáraiban helyezkedik el.</p></td></tr></tbody></table><div class="admonitionblock warning"><table><tbody><tr><td class=icon><i class="fa icon-warning" title=Warning></i></td><td class=content><div class=paragraph><p>Az imént megadott értékeket csak példaként adtuk meg és csak a tapasztalt felhasználók számára ajánljuk. A többi felhasználónak inkább a partíciók automatikus kiosztását javasoljuk a FreeBSD partíciószerkesztõjében található <code>Auto Defaults</code> opció használatával.</p></div></td></tr></tbody></table></div><div class=paragraph><p>Ha a FreeBSD-t egynél több lemezre telepítjük, akkor a korábban megadott többi slice-ban is létre kell hoznunk partíciókat. Ezt legegyszerûbben úgy tehetjük meg, ha minden lemezen létrehozunk két partíciót: egyet a lapozóállománynak, egyet pedig az állományrendszernek.</p></div><table class="tableblock frame-none grid-all stretch"><caption class=title>Táblázat 3. Több lemez partícióinak kiosztása</caption><col style=width:25%><col style=width:25%><col style=width:25%><col style=width:25%><thead><tr><th class="tableblock halign-left valign-top">Partíció</th><th class="tableblock halign-left valign-top">Állományrendszer</th><th class="tableblock halign-left valign-top">Méret</th><th class="tableblock halign-left valign-top">Leírás</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>b</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>-</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Lásd a leírást</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Ahogy már korábban is említettük, szét tudjuk osztani a lapozóállományt a lemezek között. Habár az <code>a</code> partíció szabad, a hagyományok mégis azt diktálják, hogy a lapozáshoz használt terület maradjon a <code>b</code> partíción.</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>e</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>/disk<em>n</em></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>A lemez többi része</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>A lemez fennmaradó része egyetlen nagy partícióval fedhetõ le. Ez az <code>e</code> partíció helyett lehetne minden további nélkül az <code>a</code> partíció, azonban a hagyományok szerint az <code>a</code> partíciónak a rendszer gyökér állományrendszerét (<span class=filename>/</span>) kell tartalmaznia. Nekünk ugyan nem kellene ezt a megszokást követnünk, azonban a sysinstall viszont így tesz, ezért ezzel a választással csak magunkkal teszünk jót. Az állományrendszer bárhová csatlakoztatható - ebben a példában a lemezeket rendre a <span class=filename>/diskn</span> könyvtárakhoz csatoltuk, ahol az <em>n</em> az adott lemez sorszáma. De itt természetesen más rendszert is követhetünk.</p></td></tr></tbody></table><div class=paragraph><p>A partíciók elrendezésének kigondolása után most már létre is hozathatjuk ezeket a sysinstall segítségével. Ekkor a következõ üzenetet fogjuk látni:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>                                 Message
 Now, you need to create BSD partitions inside of the fdisk
 partition<span class=o>(</span>s<span class=o>)</span> just created. If you have a reasonable amount of disk
 space <span class=o>(</span>1GMB or more<span class=o>)</span> and don<span class=s1>&#39;t have any special requirements, simply
 use the (A)uto command to allocate space automatically. If you have
 more specific needs or just don&#39;</span>t care <span class=k>for </span>the layout chosen by
 <span class=o>(</span>A<span class=o>)</span>uto, press F1 <span class=k>for </span>more information on manual layout.

                                <span class=o>[</span>  OK  <span class=o>]</span>
                          <span class=o>[</span> Press enter or space <span class=o>]</span></code></pre></div></div><div class=paragraph><p>Az üzenet fordítása:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>                                  Üzenet
Most létre kell hoznunk az fdiskkel nemrég elkészített partíciókban a
BSD-s partíciókat. Ha van hozzá elegendő helyünk <span class=o>(</span>1G vagy több<span class=o>)</span> és
nincs semmilyen különleges elvárásunk, akkor egyszerűen csak osszuk
fel automatikusan az <span class=o>(</span>A<span class=o>)</span>uto paranccsal. Amennyiben azonban ennél
többre lenne szükségünk, vagy csak nincs szükségünk az <span class=o>(</span>A<span class=o>)</span>uto által
felkínált sémára, az F1 lenyomására bővebb információkat is kaphatunk
a kézi kiosztás lehetőségeiről.

                                <span class=o>[</span>  OK  <span class=o>]</span>
            <span class=o>[</span> Nyomja le az Enter vagy a Szóköz billentyűt <span class=o>]</span></code></pre></div></div><div class=paragraph><p>Nyomjuk le a <kbd>Enter</kbd> billentyût a FreeBSD partíciószerkesztõjének, avagy a Disklabel elindításához.</p></div><div class=paragraph><p>A <a href=#sysinstall-label>A sysinstall Disklabel partíciószerkesztõje</a> mutatja a Disklabel elsõ elindulásakor megjelenõ képet. A képernyõ három részre tagolható.</p></div><div class=paragraph><p>A felsõ pár sorban a jelenleg használt lemez nevét láthatjuk, valamint azt a slice-ot, ami az általunk létrehozott partíciókat tartalmazza (itt a Disklabel a <code>Partition name</code> megnevezéssel hivatkozik a slice-ra). A képernyõn továbbá láthatjuk a slice-ban levõ szabad helyet is, vagyis azt a helyet, amely ugyan a slice-hoz tartozik, viszont még nem rendeltünk hozzá partíciót.</p></div><div class=paragraph><p>A képernyõ közepén találhatóak az eddig már létrehozott partíciók, az általuk tartalmazott állományrendszerek, azok mérete és az állományrendszerek létrehozására vonatkozó különbözõ beállítások.</p></div><div class=paragraph><p>A képernyõ alsó harmadában a Disklabel programban használható billentyûk felsorolása szerepel.</p></div><div id=sysinstall-label class=imageblock><div class=content><img src=../../../../images/books/handbook/install/disklabel-ed1.png alt="disklabel ed1"></div><div class=title>Ábra 18. A sysinstall Disklabel partíciószerkesztõje</div></div><div class=paragraph><p>A Disklabel képes magától partíciókat készíteni a nekik megfelelõ alapértelmezett méretekkel. A partíciók automatikus méretét egy belsõ partícióméretezõ algoritmus számítja ki a lemez összmérete alapján. Próbáljuk most mi is ezt ki, és nyomjuk le az <kbd>A</kbd> billentyût. Ekkor a <a href=#sysinstall-label2>A sysinstall Disklabel partíciószerkesztõje, alapértelmezett értékekkel</a> szerint illusztráltaknak megfelelõ képernyõt tapasztalhatunk. A használt lemez méretétõl függõen az alapértelmezett értékek megfelelõek lesznek vagy sem. Ez igazából nem számít, hiszen nem kell feltétlenül elfogadnunk az alapértelmezetten megállapított értékeket.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Az alapértelmezett partícionálási sémában a <span class=filename>/tmp</span> könyvtár nem a <span class=filename>/</span> könyvtár része lesz, hanem saját partíciót kapott. Ezzel igyekszünk elkerülni, hogy a <span class=filename>/</span> partíció átmenetileg tárolt állományokkal teljen be.</p></div></td></tr></tbody></table></div><div id=sysinstall-label2 class=imageblock><div class=content><img src=../../../../images/books/handbook/install/disklabel-auto.png alt="disklabel auto"></div><div class=title>Ábra 19. A sysinstall Disklabel partíciószerkesztõje, alapértelmezett értékekkel</div></div><div class=paragraph><p>Ha nem az alapértelmezett partíciókat szeretnénk használni, és le akarjuk váltani ezeket a saját magunk által megadottakra, akkor a nyílbillentyûkkel válasszuk ki az elsõ partíciót és a törléséhez nyomjuk meg a <kbd>D</kbd> billentyût. Hasonlóan járjunk el az összes többi javasolt partíció törléséhez.</p></div><div class=paragraph><p>Az elsõ (<code>a</code>, vagyis a <span class=filename>/</span> könyvtárként, azaz a gyökérként csatolt) partíció elkészítéséhez elõször gyõzõdjünk arról, hogy a felsõ sorban a megfelelõ slice van kiválasztva, majd nyomjuk meg a <kbd>C</kbd> billentyût. Ekkor az új partíció méretét kérdezõ párbeszédablak jelenik meg (lásd: <a href=#sysinstall-label-add>Szabad hely a gyökérpartíción</a>). Itt a méret a lemez blokkjainak számában adható meg, amit viszont <code>M</code>-mel lezárva megabyte-ban, <code>G</code>-vel gigabyte-ban vagy <code>C</code>-vel cilinderben is kifejezhetünk.</p></div><div id=sysinstall-label-add class=imageblock><div class=content><img src=../../../../images/books/handbook/install/disklabel-root1.png alt="disklabel root1"></div><div class=title>Ábra 20. Szabad hely a gyökérpartíción</div></div><div class=paragraph><p>Az alapértelmezés szerint felkínált méret az egész slice-ot lefoglaló partíciót hoz létre. Amennyiben a korábbi példában tárgyalt partícióméreteket kívánjuk használni, akkor a <kbd>Backspace</kbd> billentyû használatával töröljük ki az így megadott értéket, és helyette gépeljük be, hogy <code>512M</code>, ahogy ez a <a href=#sysinstall-label-add2>A gyökérpartíció méretének szerkesztése</a> segítségével is látható. A bevitelt zárjuk a <b class=button>OK</b> gomb lenyomásával.</p></div><div id=sysinstall-label-add2 class=imageblock><div class=content><img src=../../../../images/books/handbook/install/disklabel-root2.png alt="disklabel root2"></div><div class=title>Ábra 21. A gyökérpartíció méretének szerkesztése</div></div><div class=paragraph><p>Miután meghatároztuk a partíció méretét, a telepítõ megkérdezi, hogy a létrehozandó partícióban állományrendszer vagy lapozóállomány foglaljon-e helyet. Ennek a párbeszédablakját a <a href=#sysinstall-label-type>A gyökérpartíció típusának kiválasztása</a> mutatja. Mivel az elsõ partíciónk állományrendszert fog tartalmazni, ezért mindenképpen az <span class=guimenuitem>FS</span> paramétert válasszuk ki, majd nyomjuk meg az <kbd>Enter</kbd> billentyût.</p></div><div id=sysinstall-label-type class=imageblock><div class=content><img src=../../../../images/books/handbook/install/disklabel-fs.png alt="disklabel fs"></div><div class=title>Ábra 22. A gyökérpartíció típusának kiválasztása</div></div><div class=paragraph><p>Végezetül, mivel egy állományrendszert hoztunk létre, meg kell mondanunk a Disklabelnek, hova csatlakoztassa. A hozzá tartozó párbeszédablak a <a href=#sysinstall-label-mount>A gyökér csatlakozási pontjának megadása</a>n látható. A gyökér állományrendszer csatlakozási pontja a <span class=filename>/</span>, ezért itt csak annyit adjunk meg, hogy <code>/</code> és zárjuk az <kbd>Enter</kbd> billentyû lenyomásával.</p></div><div id=sysinstall-label-mount class=imageblock><div class=content><img src=../../../../images/books/handbook/install/disklabel-root3.png alt="disklabel root3"></div><div class=title>Ábra 23. A gyökér csatlakozási pontjának megadása</div></div><div class=paragraph><p>A képernyõn látható lista ezután az újonnan létrehozott partíciónak megfelelõen frissül. A többi partícióra ugyanígy meg kell ismételnünk ezt a mûveletsort. Arra azonban figyeljünk, hogy a lapozásra használt partíciót létrehozásánál a szerkesztõ nem fogja megkérdezni a csatlakozási pontot, hiszen az ilyen típusú partíciókat sosem csatlakoztatjuk. A <span class=filename>/usr</span>, vagyis az utolsó partíció készítése során a slice fennmaradó részének lefoglalásához már nyugodtan meghagyhatjuk a felajánlott értéket.</p></div><div class=paragraph><p>A FreeBSD partíciószerkesztõjének utolsó képernyõje a <a href=#sysinstall-label4>A Disklabel partíciószerkesztõ</a>n hasonlóhoz, habár az általunk választott értékek minden bizonnyal eltérnek. A mûvelet befejezéséhez nyomjuk le a <kbd>Q</kbd> billentyût.</p></div><div id=sysinstall-label4 class=imageblock><div class=content><img src=../../../../images/books/handbook/install/disklabel-ed2.png alt="disklabel ed2"></div><div class=title>Ábra 24. A Disklabel partíciószerkesztõ</div></div></div></div><div class=sect2><h3 id=install-choosing>2.7. A telepítendõ összetevõk kiválasztása<a class=anchor href=#install-choosing></a></h3><div class=sect3><h4 id=distset>2.7.1. A terjesztések típusának kiválasztása<a class=anchor href=#distset></a></h4><div class=paragraph><p>A telepítendõ terjesztések típusa nagyban függ attól, hogy a rendszerünket mire szándékozzuk majd használni és mennyi szabad hely áll rendelkezésünkre. Az elõre megadott beállítások a lehetõ legkisebb konfiguráció telepítésétõl egészen a komplett rendszer telepítéséig terjednek. A UNIX® és/vagy FreeBSD világában még az új felhasználók számára szinte tökéletesen megfelelõnek bizonyulhat az egyik ilyen elõkészített beállítás kiválasztása. A terjesztések kiválogatása pedig általában a tapasztaltabb felhasználók számára lehet hasznos.</p></div><div class=paragraph><p>Az <kbd>F1</kbd> billentyûvel többet is megtudhatunk a terjesztések különbözõ típusairól és bennük található összetevõkrõl. Miután befejeztük a súgó áttanulmányozását, nyomjuk le az <kbd>Enter</kbd> billentyût, és ezzel visszatérünk a terjesztések kiválasztását tartalmazó menübe.</p></div><div class=paragraph><p>Ha grafikus felületet szeretnénk használni, akkor az X szerver beállítását az alapértelmezett munkakörnyezet beállítását a FreeBSD telepítése után kell megtenni. Az X szerver beállításáról részletesebben a <a href=./#x11>Az X Window System</a>ban olvashatunk.</p></div><div class=paragraph><p>Ha egy saját rendszermag építését is fontolgatjuk, akkor olyan terjesztést válasszuk, amiben a forráskód (kernel source) is megtalálható. A saját rendszermag építésének hátterérõl és mikéntjérõl lásd a <a href=./#kernelconfig>A FreeBSD rendszermag testreszabása</a>et.</p></div><div class=paragraph><p>Értelemszerûen a legsokoldalúbb rendszer az, amiben minden megtalálató. Így aztán, ha a lemezünk is megengedi, a nyilak és az <kbd>Enter</kbd> használatával válasszuk a <span class=guimenuitem>All</span> (Minden) opciót, ahogy azt az <a href=#distribution-set1>A terjesztések kiválasztása</a> is mutatja. Ha viszont úgy érezzük, hogy ehhez nem eléggé nagy a lemezünk, akkor válasszuk az igényeinkhez jobban illeszkedõ típust. Sokat azonban ne üljünk a tökéletes megoldás kiötlésén, hiszen ezek a terjesztések még a telepítés befejezése után is hozzáadhatóak a rendszerünkhöz.</p></div><div id=distribution-set1 class=imageblock><div class=content><img src=../../../../images/books/handbook/install/dist-set.png alt="dist set"></div><div class=title>Ábra 25. A terjesztések kiválasztása</div></div></div><div class=sect3><h4 id=portscol>2.7.2. A Portgyûjtemény telepítése<a class=anchor href=#portscol></a></h4><div class=paragraph><p>Miután kiválasztottuk a nekünk megfelelõ terjesztést, a telepítõprogram felajánlja a FreeBSD Portgyûjteményének (Ports Collection) telepítésének lehetõségét. A portok gyûjteménye a szoftverek telepítésének egyszerû és kényelmes módja. A Portgyûjtemény önmaga nem tartalmazza a szoftverek lefordításához szükséges forráskódot, hanem helyette csupán azokat az állományokat, amelyek a különbözõ külsõs programok letöltéséhez, fordításához és telepítéséhez kellenek. A <a href=./#ports>Alkalmazások telepítése. csomagok és portok</a>ben megtalálhatjuk, miként is kell használni ezt a gyûjteményt.</p></div><div class=paragraph><p>A telepítõprogram nem fogja ellenõrizni a kibontásához szükséges helyet, ezért csak abban az esetben válasszuk ezt a lehetõséget, ha mindenképpen elfér a merevlemezünkön. A FreeBSD jelenlegi, 12.0 változatában a Portgyûjtemény nagyjából 3 GB helyet foglal el a lemezen. A FreeBSD frissebb verzióiban nyugodtan feltételezhetünk ennél valamivel nagyobb értéket is.</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>                         User Confirmation Requested
 Would you like to <span class=nb>install </span>the FreeBSD ports collection?

 This will give you ready access to over 20 000 ported software packages,
 at a cost of around 417 MB of disk space when <span class=s2>&#34;clean&#34;</span> and possibly much
 more than that <span class=k>if </span>a lot of the distribution tarballs are loaded
 <span class=o>(</span>unless you have the extra CDs from a FreeBSD CD/DVD distribution
 available and can mount it on /cdrom, <span class=k>in </span>which <span class=k>case</span> this is far less
 of a problem<span class=p>)</span><span class=nb>.</span>

 The Ports Collection is a very valuable resource and well worth having
 on your /usr partition, so it is advisable to say Yes to this option.

 For more information on the Ports Collection &amp; the latest ports,
 visit:
     http://www.FreeBSD.org/ports

                              <span class=o>[</span> Yes <span class=o>]</span>     No</code></pre></div></div><div class=paragraph><p>Az üzenet fordítása:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>                      Felhasználói megerősítés szükséges
 Szeretné telepíteni a FreeBSD portjainak gyűjteményét?

 Ezen keresztül közel 20 000 portolt szoftvercsomaghoz tudunk
 könnyedén hozzáférni, amelyek <span class=s2>&#34;tiszta&#34;</span> állapotukban nagyjából
 417 MB lemezterületünkbe kerülnek, ami a későbbiekben
 valószínűleg majd növekedni fog, ahogy letöltjük a különböző
 szoftverekhez tartozó állományokat <span class=o>(</span>hacsak nincs meg a FreeBSD
 valamelyik CD- vagy DVD alapú terjesztésének az összes lemeze,
 amelyeket a /cdrom könyvtárba csatlakoztatva el tudjuk ezeket érni,
 mert ekkor kevesebb gondunk lesz vele<span class=o>)</span><span class=nb>.</span>

 A Portgyűjtemény egy nagyon értékes erőforrás, amelynek megéri helyet
 szentelni a /usr partíciónkon, ezért javasoljuk, hogy válassza az
 <span class=s2>&#34;Igen&#34;</span> opciót. A Portgyűjteményről és annak legújabb portjairól a
 http://www.FreeBSD.org/ports oldalon olvashat részletesebben.

                             <span class=o>[</span> Igen <span class=o>]</span>     Nem</code></pre></div></div><div class=paragraph><p>A Portgyûjtemény telepítéséhez a <b class=button>yes</b> gombot, ennek kihagyásához pedig a <b class=button>no</b> gombot válasszuk ki a nyilakkal, majd az <kbd>Enter</kbd> lenyomásával mehetünk tovább. Ekkor a kiválasztott terjesztések menüje fog újra megjelenni.</p></div><div id=distribution-set2 class=imageblock><div class=content><img src=../../../../images/books/handbook/install/dist-set2.png alt="dist set2"></div><div class=title>Ábra 26. A terjesztések telepítésének megerõsítése</div></div><div class=paragraph><p>Ha elégedettek vagyunk a beállításokkal, válasszuk ki a nyilakkal az <span class=guimenuitem>Exit</span> menüpontot, gyõzõdjünk meg róla, hogy a <b class=button>OK</b> gombon állunk, majd nyomjuk le az <kbd>Enter</kbd> billentyût a folytatáshoz.</p></div></div></div><div class=sect2><h3 id=install-media>2.8. A telepítés eszközének kiválasztása<a class=anchor href=#install-media></a></h3><div class=paragraph><p>Ha CD-rõl vagy DVD-rõl telepítünk, akkor a következõ képernyõn a nyílbillentyûkkel válasszuk ki a <span class=guimenuitem>Install from a CDROM or DVD</span> (Telepítés CD-rõl vagy DVD-rõl) menüpontot. Ügyeljünk a <b class=button>OK</b> gomb kiválasztására is, majd a telepítés megkezdéséhez nyomjuk meg az <kbd>Enter</kbd> billenyût.</p></div><div class=paragraph><p>A telepítés másfajta módszereinek alkalmazásához válasszuk ki a menüpontok közül a nekünk megfelelõt és kövessük a megjelenõ utasításokat.</p></div><div class=paragraph><p>Az <kbd>F1</kbd> billentyû lenyomására megjelenik az adott telepítõeszközhöz tartozó súgó. Innen az <kbd>Enter</kbd> lenyomása után térhetünk vissza a menühöz.</p></div><div id=choose-media class=imageblock><div class=content><img src=../../../../images/books/handbook/install/media.png alt=media></div><div class=title>Ábra 27. A telepítési eszköz kiválasztása</div></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=title>elepítés FTP szerverrõl</div><div class=paragraph><p>Három FTP-s telepítési mód közül választhatunk: aktív, passzív vagy HTTP proxyn keresztül.</p></div><div class=dlist><dl><dt class=hdlist1>Aktív FTP: <span class=guimenuitem>Install from an FTP server</span> (Telepítés FTP szerverrõl)</dt><dd><p>Ezzel a beállítással az összes FTP-n keresztüli átvitel "aktív" módban történik. Ez tûzfalak esetén nem mûködik, de gyakran alkalmazható olyan régebbi FTP szerverek esetén, amelyek nem ismerik az passzív adatátvitelt. Ha (az alapértelmezett) passzív módban megakadna a kapcsolat, próbáljunk meg helyette az aktívat.</p></dd><dt class=hdlist1>Passzív FTP: <span class=guimenuitem>Install from an FTP server through a firewall</span> (Telepítés tûzfalon keresztül FTP szerverrõl)</dt><dd><p>Ezzel a beállítással a sysinstall programot az FTP mûvelet végrehajtásakor a "passzív" mód használatára utasítjuk. Így át tudunk menni olyan tûzfalakon is, amelyek nem engedik a véletlenszerû TCP portokon érkezõ kapcsolatokat.</p></dd><dt class=hdlist1>FTP HTTP proxyn keresztül: <span class=guimenuitem>Install from an FTP server through a http proxy</span> (Telepítés HTTP proxyn keresztül FTP szerverrõl)</dt><dd><p>Ezzel a beállítással megmondhatjuk a sysinstall programnak, hogy (egy böngészõhöz hasonlóan) a HTTP protokollon keresztül használja az FTP mûveletek elvégzéséhez használt proxyt. Ennek a proxynak lesz a feladata az átadott kérések lefordítása és elküldése az FTP szervernek. Ennek köszönhetõen át tudunk menni olyan tûzfalakon is, amelyek egyáltalán nem engednek semmilyen FTP mûveletet, azonban tartozik hozzájuk egy HTTP proxy. Ilyenkor az FTP szerver beállításai mellett meg kell adnunk ezt a HTTP proxyt is.</p></dd></dl></div><div class=paragraph><p>Az FTP szervert proxyn keresztül általában úgy érjük el, hogy a felhasználói név részeként egy "@" jellel elválasztva megadjuk a ténylegesen elérni kívánt szerver nevét. A proxy szerver ezután "helyettesíti" a valódi szervert. Például tegyük fel, hogy a <code>ftp.FreeBSD.org</code> szerverrõl akarunk telepíteni az 1234 porton várakozó <code>ize.minta.com</code> proxy használatával.</p></div><div class=paragraph><p>Ehhez lépjünk be a beállításokat tartalmazó menübe, állítsuk az FTP kapcsolathoz használt felhasználói nevet az <code>ftp@ftp.FreeBSD.org</code> értékre, majd jelszónak adjuk meg az e-mail címünket. Telepítési eszközként adjuk meg az FTP-t (vagy a passzív FTP-t, amennyiben a proxy ismeri) és a <code><a href=ftp://ize.minta.com:1234/pub/FreeBSD class=bare>ftp://ize.minta.com:1234/pub/FreeBSD</a></code> címet.</p></div><div class=paragraph><p>Mivel az <code>ftp.FreeBSD.org</code> címrõl származó <span class=filename>/pub/FreeBSD</span> könyvtár a <code>ize.minta.com</code> szerveren keresztül érhetõ el számunkra, ezért lényegében <em>arról</em> a géprõl fogunk telepíteni (amely pedig a telepítõ kéréseire elhozza a <code>ftp.FreeBSD.org</code> szervertõl az állományokat).</p></div></td></tr></tbody></table></div></div><div class=sect2><h3 id=install-final-warning>2.9. A telepítés véglegesítése<a class=anchor href=#install-final-warning></a></h3><div class=paragraph><p>Ezután ha óhajtjuk, megkezdhetjük a telepítést. Ez egyben az utolsó lehetõségünk a telepítés megszakítására és merevlemezünket érintõ változtatások érvénytelenítésére.</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>                       User Confirmation Requested
 Last Chance! Are you SURE you want to <span class=k>continue </span>the installation?

 If you<span class=s1>&#39;re running this on a disk with data you wish to save then WE
 STRONGLY ENCOURAGE YOU TO MAKE PROPER BACKUPS before proceeding!

 We can take no responsibility for lost disk contents!

                             [ Yes ]    No</span></code></pre></div></div><div class=paragraph><p>Az üzenet fordítása:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>                    Felhasználói megerősítés szükséges
 Utolsó esély: BIZTOSAN folytatni kívánja a telepítést?

 Ha olyan lemezre szeretne telepíteni, amelyen fontos adatok
 találhatóak, HATÁROZOTTAN JAVASOLJUK, hogy a továbblépés előtt
 KÉSZÍTSEN RÓLUK MEGBÍZHATÓ BIZTONSÁGI MÁSOLATOT!

 Nem vállalunk semmilyen felelősséget az elvesztett adatokért!

                            <span class=o>[</span> Igen <span class=o>]</span>    Nem</code></pre></div></div><div class=paragraph><p>A továbblépéshez válasszuk a <b class=button>yes</b> gombot és nyomjuk meg az <kbd>Enter</kbd> billentyût.</p></div><div class=paragraph><p>A telepítés idõtartama a kiválasztott terjesztéstõl, a telepítésre használt eszköztõl és számítógépünk sebességétõl függ. A folyamat elõrehaladásáról üzenetek sorozata tájékoztat minket.</p></div><div class=paragraph><p>A telepítés befejezése után a következõ üzenet jelenik meg:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>                               Message

Congratulations! You now have FreeBSD installed on your system.

We will now move on to the final configuration questions.
For any option you <span class=k>do </span>not wish to configure, simply <span class=k>select </span>No.

If you wish to re-enter this utility after the system is up, you may
<span class=k>do </span>so by typing: /usr/sbin/sysinstall.

                                 <span class=o>[</span> OK <span class=o>]</span>

                      <span class=o>[</span>  Press enter or space  <span class=o>]</span></code></pre></div></div><div class=paragraph><p>A szöveg fordítása:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>                               Üzenet

Gratulálunk, sikeresen telepítette a FreeBSD rendszert a számítógépére!

Most rátérünk az utolsó néhány kérdésre. A <span class=s2>&#34;Nem&#34;</span> választásával
egyszerűen átugorhatjuk mindazt, amit nem szeretnénk beállítani. Ezt a
segédprogramot a rendszer újbóli elindítása után a <span class=s2>&#34;/usr/sbin/sysinstall&#34;</span>
parancs begépelésével tudjuk elérni.

                                 <span class=o>[</span> OK <span class=o>]</span>

            <span class=o>[</span> Nyomja le az Enter vagy a Szóköz billentyűt <span class=o>]</span></code></pre></div></div><div class=paragraph><p>Az <kbd>Enter</kbd> billentyû lenyomásával megkezdhetjük a telepítés utáni beállításokat.</p></div><div class=paragraph><p>A <b class=button>no</b> gomb kiválasztásával és az <kbd>Enter</kbd> lenyomásával megszakíthatjuk a telepítést, így a rendszerünkön semmilyen változtatás nem történik. Ilyenkor a következõ üzenet jelenik meg:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>                                Message
Installation <span class=nb>complete </span>with some errors.  You may wish to scroll
through the debugging messages on VTY1 with the scroll-lock feature.
You can also choose <span class=s2>&#34;No&#34;</span> at the next prompt and go back into the
installation menus to retry whichever operations have failed.

                                 <span class=o>[</span> OK <span class=o>]</span></code></pre></div></div><div class=paragraph><p>Az üzenet fordítása:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>                                 Üzenet
A telepítés során hiba történt. A Scroll Lock használatával érdemes
átnézni a VTY1 terminál megjelenő üzeneteket. A következő ablakban a
<span class=s2>&#34;Nem&#34;</span> választásával vissza tudunk menni a telepítőmenühöz és
megpróbálkozhatunk ismét a sikertelen műveletek végrehajtásával.

                                 <span class=o>[</span> OK <span class=o>]</span></code></pre></div></div><div class=paragraph><p>Ez az üzenet azért jelent meg, mert semmit sem sikerült telepíteni. Innen az <kbd>Enter</kbd> megnyomásával térhetünk vissza a fõmenübe, majd onnan tudunk kilépni a telepítõbõl.</p></div></div><div class=sect2><h3 id=install-post>2.10. A telepítés után<a class=anchor href=#install-post></a></h3><div class=paragraph><p>A sikeres telepítést különféle beállítások követik. Közülük az új FreeBSD rendszer indítása elõtt bármelyik megismételhetõ a beállítások opcióit tartalmazó menü újbóli használatával, vagy pedig a telepítés után a <code>sysinstall</code> parancs kiadásával, majd a <span class=guimenuitem>Configure</span> (Beállítások) menüpont kiválasztásával.</p></div><div class=sect3><h4 id=inst-network-dev>2.10.1. A hálózati eszközök beállítása<a class=anchor href=#inst-network-dev></a></h4><div class=paragraph><p>A következõ képernyõ már nem jelenik meg, ha az FTP szerveren keresztüli telepítéshez korábban már beállítottuk a PPP kapcsolatot. Ez a korábbiakban említettek szerint állítható be.</p></div><div class=paragraph><p>Ha többet szeretnénk megtudni a helyi hálózatokról (LAN), vagy a FreeBSD-t átjáróként, illetve útválasztóként kívánjuk beállítani, olvassuk el az <a href=./#advanced-networking>Egyéb haladó hálózati témák</a> címû fejezetet.</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>                      User Confirmation Requested
   Would you like to configure any Ethernet or PPP network devices?

                             <span class=o>[</span> Yes <span class=o>]</span>   No</code></pre></div></div><div class=paragraph><p>Fordítása:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>                   Felhasználói megerősítés szükséges
  Szeretnénk beállítani valamilyen Ethernet- vagy PPP hálózati eszközt?

                            <span class=o>[</span> Igen <span class=o>]</span>   Nem</code></pre></div></div><div class=paragraph><p>A hálózati eszközeink beállításához válasszuk a <b class=button>yes</b> gombot, majd nyomjuk meg az <kbd>Enter</kbd> billentyût. Ellenkezõ esetben a <b class=button>no</b> gombbal mehetünk tovább.</p></div><div id=ed-config1 class=imageblock><div class=content><img src=../../../../images/books/handbook/install/ed0-conf.png alt="ed0 conf"></div><div class=title>Ábra 28. Az Ethernet-eszköz kiválasztása</div></div><div class=paragraph><p>A beállítandó csatoló kiválasztásához használjuk a nyílbillentyûket és utána nyomjuk meg az <kbd>Enter</kbd> billentyût.</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>                      User Confirmation Requested
       Do you want to try IPv6 configuration of the interface?

                              Yes   <span class=o>[</span> No <span class=o>]</span></code></pre></div></div><div class=paragraph><p>Fordítás:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>                   Felhasználói megerősítés szükséges
           Megpróbálkozik az IPv6 beállításával a csatolón?

                             Igen   <span class=o>[</span> Nem <span class=o>]</span></code></pre></div></div><div class=paragraph><p>A példánkban szereplõ helyi hálózatban az aktuális internetes protokoll (IPv4) egyelõre megfelelõ, ezért válasszuk a <b class=button>no</b> gombot és nyomjuk meg az <kbd>Enter</kbd> billentyût.</p></div><div class=paragraph><p>Amennyiben RA-szerveren keresztül egy már létezõ IPv6 hálózathoz csatlakozunk, akkor válasszuk a <b class=button>yes</b> gombot és nyomjuk meg az <kbd>Enter</kbd> billentyût. Ezt követõen az RA-szerverek felderítése kezdõdik meg, ami néhány másodpercig eltarthat.</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>                             User Confirmation Requested
        Do you want to try DHCP configuration of the interface?

                              Yes   <span class=o>[</span> No <span class=o>]</span></code></pre></div></div><div class=paragraph><p>Az üzenet fordítása:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>                          Felhasználói megerősítés szükséges
            Megpróbálkozik a DHCP használatával a csatolón?

                             Igen   <span class=o>[</span> Nem <span class=o>]</span></code></pre></div></div><div class=paragraph><p>Ha nincs szükségünk a DHCP (Dynamic Host Configuration Protocol, azaz a Dinamikus állomáskonfigurációs protokoll) használatára, akkor a <b class=button>no</b> gomb kiválasztásával majd az <kbd>Enter</kbd> lenyomásával továbbléphetünk.</p></div><div class=paragraph><p>A <b class=button>yes</b> gomb kiválasztására elindul a dhclient nevû program, és amennyiben sikerrel jár, magától kitölti a hálózati beállításokra vonatkozó adatokat. Ennek részleteit a <a href=./#network-dhcp>A hálózat automatikus beállítása (DHCP)</a>ben találhatjuk meg.</p></div><div class=paragraph><p>Az alábbi hálózati beállító képernyõ mutatja a helyi hálózat átjárójaként használni kívánt Ethernet-eszköz konfigurációját.</p></div><div id=ed-config2 class=imageblock><div class=content><img src=../../../../images/books/handbook/install/ed0-conf2.png alt="ed0 conf2"></div><div class=title>Ábra 29. Az ed0 hálózati beállítása</div></div><div class=paragraph><p>A <kbd>Tab</kbd> billentyûvel tudunk navigálni az adatlap mezõi között és kitölteni ezeket a megfelelõ információkkal:</p></div><div class=dlist><dl><dt class=hdlist1>Host (Számítógépnév)</dt><dd><p>A számítógépünk teljes neve, amely a példában most <code>k6-2.example.com</code>.</p></dd><dt class=hdlist1>Domain (Tartomány)</dt><dd><p>Annak a tartománynak a neve, amelyben a számítógépünk a található. Ez itt konkrétan a <code>example.com</code>.</p></dd><dt class=hdlist1>IPv4 Gateway (IPv4-átjáró)</dt><dd><p>A helyben nem elérhetõ célok megközelítésére használt gép IP-címe. Ezt a mezõt mindenképpen töltsük ki akkor, ha a számítógépünk valamilyen hálózatba van kötve. Azonban <em>hagyjuk üresen</em>, ha a számítógép a hálózat átjárója az internet felé. Az IPv4 átjárót más néven "default gateway"-nek (alapértelmezett átjárónak) vagy "default route"-nak (alapértelmezett útvonalnak) is nevezik.</p></dd><dt class=hdlist1>Name server (Névszerver)</dt><dd><p>A helyi DNS (névfeloldó) szerverünk IP-címe. Ha nem található ilyen a helyi hálózatunkon, akkor az internet-szolgáltató DNS szerverének címét (a példában ez a <code>208.163.10.2</code>) adjuk meg.</p></dd><dt class=hdlist1>IPv4 address (IPv4-cím)</dt><dd><p>A csatoló IP-címe, amely az ábrán a <code>192.168.0.1</code>.</p></dd><dt class=hdlist1>Netmask (Hálózati maszk)</dt><dd><p>A helyi hálózatban használt címtartomány a <code>192.168.0.0</code> - <code>192.168.0.255</code>, amihez a <code>255.255.255.0</code> hálózati maszk tartozik.</p></dd><dt class=hdlist1>Extra options to ifconfig (Az ifconfig további beállításai)</dt><dd><p>Az <code>ifconfig</code> parancs adott csatolóra vonatkozó egyéb beállításai. Jelen esetünkben itt semmi sem szerepel.</p></dd></dl></div><div class=paragraph><p>Miután végeztünk, a <kbd>Tab</kbd> billentyû lenyomásával válasszuk ki a <b class=button>OK</b> gombot és nyomjuk le az <kbd>Enter</kbd> billentyût.</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>                      User Confirmation Requested
        Would you like to bring the ed0 interface up right now?

                             <span class=o>[</span> Yes <span class=o>]</span>   No</code></pre></div></div><div class=paragraph><p>A fordítás:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>                   Felhasználói megerősítés szükséges
                     Aktiválja most az ed0 csatolót?

                            <span class=o>[</span> Igen <span class=o>]</span>   Nem</code></pre></div></div><div class=paragraph><p>A <b class=button>yes</b> gomb kiválasztásával, majd az <kbd>Enter</kbd> lenyomásával csatlakoztatjuk a számítógépet a hálózathoz, ami ezután használhatóvá válik. Ez azonban a telepítés számára nem jelent túlságosan sokat, hiszen ettõl függetlenül a számítógépet egyébként is újra kell majd indítanunk.</p></div></div><div class=sect3><h4 id=gateway>2.10.2. Az átjáró beállítása<a class=anchor href=#gateway></a></h4><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>                       User Confirmation Requested
       Do you want this machine to <span class=k>function </span>as a network gateway?

                              <span class=o>[</span> Yes <span class=o>]</span>    No</code></pre></div></div><div class=paragraph><p>A fordítás:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>                    Felhasználói megerősítés szükséges
       Ezt a számítógépet hálózati átjáróként is használni akarja?

                             <span class=o>[</span> Igen <span class=o>]</span>    Nem</code></pre></div></div><div class=paragraph><p>Ha a számítógépet a helyi hálózat átjárójaként használni akarjuk gépek közti csomagok továbbítására, akkor válasszuk a <b class=button>yes</b> gombot és nyomjuk meg hozzá az <kbd>Enter</kbd> billentyût. Ha viszont ez a gép csupán a hálózat egy tagja, akkor válasszuk a <b class=button>no</b> gombot és a folytatáshoz nyomjuk meg az <kbd>Enter</kbd> billentyût.</p></div></div><div class=sect3><h4 id=inetd-services>2.10.3. A hálózati szolgáltatások beállítása<a class=anchor href=#inetd-services></a></h4><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>                      User Confirmation Requested
Do you want to configure inetd and the network services that it provides?

                               Yes   <span class=o>[</span> No <span class=o>]</span></code></pre></div></div><div class=paragraph><p>Fordítás:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>                   Felhasználói megerősítés szükséges
Beállítja az inetd démont és az általa felkínált hálózati szolgáltatásokat?

                              Igen   <span class=o>[</span> Nem <span class=o>]</span></code></pre></div></div><div class=paragraph><p>Ha itt a <b class=button>no</b> gombot választjuk, akkor ezzel kikapcsoljuk a különbözõ szolgáltatásokat, például a telnetd démont. Ez azt jelenti, hogy a távoli felhasználók nem lesznek képesek a telnet program használatával belépni erre a számítógépre. A helyi felhasználók viszont továbbra is képesek lesznek távoli számítógépeket elérni a telnet segítségével.</p></div><div class=paragraph><p>Az <span class=filename>/etc/inetd.conf</span> átírásával azonban ezek a szolgáltatások késõbb természetesen engedélyezhetõek. A <a href=./#network-inetd-overview>Áttekintés</a> foglalkozik a téma részleteivel.</p></div><div class=paragraph><p>A <b class=button>yes</b> gomb választásával már a telepítés során beállíthatjuk a szolgáltatásokat. Ekkor egy további párbeszédablak is felbukkan:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>                      User Confirmation Requested
The Internet Super Server <span class=o>(</span>inetd<span class=o>)</span> allows a number of simple Internet
services to be enabled, including finger, ftp and telnetd.  Enabling
these services may increase risk of security problems by increasing
the exposure of your system.

With this <span class=k>in </span>mind, <span class=k>do </span>you wish to <span class=nb>enable </span>inetd?

                             <span class=o>[</span> Yes <span class=o>]</span>   No</code></pre></div></div><div class=paragraph><p>Fordítása:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>                   Felhasználói megerősítés szükséges
A fő internetes kiszolgáló <span class=o>(</span>az inetd<span class=o>)</span> számos egyszerű internetes
szolgáltatás, többek közt a finger, ftp és telnet elérését teszi
lehetővé. Ezen szolgáltatások engedélyezése azonban a felmerülő
biztonsági problémák kockázatát, mivel ezzel rendszerünket jobban
kitesszük támadásoknak.

Mindezek tudatában használni kívánja az inetd démont?

                            <span class=o>[</span> Igen <span class=o>]</span>   Nem</code></pre></div></div><div class=paragraph><p>A folytatáshoz válasszuk a <b class=button>yes</b> gombot.</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>                      User Confirmation Requested
inetd<span class=o>(</span>8<span class=o>)</span> relies on its configuration file, /etc/inetd.conf, to determine
which of its Internet services will be available.  The default FreeBSD
inetd.conf<span class=o>(</span>5<span class=o>)</span> leaves all services disabled by default, so they must be
specifically enabled <span class=k>in </span>the configuration file before they will
<span class=k>function</span>, even once inetd<span class=o>(</span>8<span class=o>)</span> is enabled.  Note that services <span class=k>for
</span>IPv6 must be separately enabled from IPv4 services.

Select <span class=o>[</span>Yes] now to invoke an editor on /etc/inetd.conf, or <span class=o>[</span>No] to
use the current settings.

                             <span class=o>[</span> Yes <span class=o>]</span>   No</code></pre></div></div><div class=paragraph><p>Fordítás:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>                   Felhasználói megerősítés szükséges
Az inetd<span class=o>(</span>8<span class=o>)</span> démonnak az elérhető internetes szolgáltatások
megállapításához szüksége van a beállításait tartalmazó
/etc/inetd.conf állományra. A FreeBSD-hez tartozó inetd.conf<span class=o>(</span>5<span class=o>)</span>
állomány alapértelmezés szerint az összes szolgáltatást letiltja,
ezért a működéséhez minden egyes szolgáltatást külön kell engedélyezni
az említett állományban, még abban az esetben is, ha az inetd<span class=o>(</span>8<span class=o>)</span>
démont korábban már engedélyeztük. Az IPv6 szolgáltatások az IPv4
szolgáltatásoktól külön engedélyezendőek.

Az <span class=o>[</span> Igen <span class=o>]</span> választásával behívjuk az /etc/inetd.conf szerkesztését,
míg a <span class=o>[</span> Nem <span class=o>]</span> választásával pedig az imént felvázolt beállításokat
fogadjuk el.

                            <span class=o>[</span> Igen <span class=o>]</span>   Nem</code></pre></div></div><div class=paragraph><p>A <b class=button>yes</b> gomb kiválasztásával lehetõségünk nyílik szolgáltatásokat engedélyezni a sorok elején található <code>#</code> jel törlésével.</p></div><div id=inetd-edit class=imageblock><div class=content><img src=../../../../images/books/handbook/install/edit-inetd-conf.png alt="edit inetd conf"></div><div class=title>Ábra 30. Az <span class=filename>inetd.conf</span> módosítása</div></div><div class=paragraph><p>Miután felvettük az összes használni kívánt szolgáltatást, az <kbd>Esc</kbd> billentyû lenyomásával elõhozhatjuk azt a menüt, ahol elmenthetjük a módosításainkat és kiléphetünk.</p></div></div><div class=sect3><h4 id=ssh-login>2.10.4. Az SSH-n keresztüli bejelentkezés engedélyezése<a class=anchor href=#ssh-login></a></h4><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>                      User Confirmation Requested
                  Would you like to <span class=nb>enable </span>SSH login?
                           Yes        <span class=o>[</span>  No  <span class=o>]</span></code></pre></div></div><div class=paragraph><p>Fordítás:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>                   Felhasználói megerősítés szükséges
               Engedélyezi az SSH-n keresztüli bejelentkezést?
                          Igen        <span class=o>[</span>  Nem  <span class=o>]</span></code></pre></div></div><div class=paragraph><p>A <b class=button>yes</b> gomb kiválasztása engedélyezi az OpenSSH-hoz tartozó <a href="https://man.freebsd.org/cgi/man.cgi?query=sshd&amp;sektion=8&amp;format=html">sshd(8)</a> démont, aminek segítségével a számítógépünkre biztonságosan be tudunk jelentkezni távolról. Az OpenSSH részleteirõl lásd a <a href=./#openssh>OpenSSH</a>t.</p></div></div><div class=sect3><h4 id=ftpanon>2.10.5. Anonim FTP<a class=anchor href=#ftpanon></a></h4><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>                      User Confirmation Requested
 Do you want to have anonymous FTP access to this machine?

                              Yes    <span class=o>[</span> No <span class=o>]</span></code></pre></div></div><div class=paragraph><p>Fordítás:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>                   Felhasználói megerősítés szükséges
 Hozzáférhető legyen ez a számítógép anonim FTP használatán keresztül?

                             Igen    <span class=o>[</span> Nem <span class=o>]</span></code></pre></div></div><div class=sect4><h5 id=deny-anon>2.10.5.1. Az anonim FTP tiltása<a class=anchor href=#deny-anon></a></h5><div class=paragraph><p>Az alapértelmezett <b class=button>no</b> gomb kiválasztásával és az <kbd>Enter</kbd> billentyû lenyomásával a jelszóval védett FTP hozzáféréssel rendelkezõ felhasználók továbbra is elérhetik a számítógépünket.</p></div></div><div class=sect4><h5 id=ftpallow>2.10.5.2. Az anonim FTP engedélyezése<a class=anchor href=#ftpallow></a></h5><div class=paragraph><p>Ha ezt választjuk, akkor anonim FTP kapcsolaton keresztül bárki hozzáférhet a számítógépünkhöz. Ebben az esetben azonban alaposan meg kell fontolnunk néhány biztonsági következményt. A beállítással járó kockázatokról az <a href=./#security>Biztonság</a>ben olvashatunk többet.</p></div><div class=paragraph><p>Az anonim FTP bekapcsolásához a nyílbillentyûkkel válasszuk ki a <b class=button>yes</b> feliratú gombot és nyomjuk meg az <kbd>Enter</kbd> billentyût. Ekkor egy további párbeszédablak is megjelenik:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>                       User Confirmation Requested
 Anonymous FTP permits un-authenticated <span class=nb>users </span>to connect to the system
 FTP server, <span class=k>if </span>FTP service is enabled.  Anonymous <span class=nb>users </span>are
 restricted to a specific subset of the file system, and the default
 configuration provides a drop-box incoming directory to which uploads
 are permitted.  You must separately <span class=nb>enable </span>both inetd<span class=o>(</span>8<span class=o>)</span>, and <span class=nb>enable
 </span>ftpd<span class=o>(</span>8<span class=o>)</span> <span class=k>in </span>inetd.conf<span class=o>(</span>5<span class=o>)</span> <span class=k>for </span>FTP services to be available.  If you
 did not <span class=k>do </span>so earlier, you will have the opportunity to <span class=nb>enable </span>inetd<span class=o>(</span>8<span class=o>)</span>
 again later.

 If you want the server to be read-only you should leave the upload
 directory option empty and add the <span class=nt>-r</span> command-line option to ftpd<span class=o>(</span>8<span class=o>)</span>
 <span class=k>in </span>inetd.conf<span class=o>(</span>5<span class=o>)</span>

 Do you wish to <span class=k>continue </span>configuring anonymous FTP?

                          <span class=o>[</span> Yes <span class=o>]</span>         No</code></pre></div></div><div class=paragraph><p>Az üzenet fordítása:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>                     Felhasználói megerősítés szükséges

 Az anonim FTP használatával a rendszer FTP szolgáltatásához
 hitelesítetlen felhasználók is hozzáférhetnek, amennyiben az aktív. A
 névtelen felhasználók az állományrendszernek csak egy részét érhetik
 el, valamint az alapbeállítások szerint a feltöltést egy külön erre
 a célra fenntartott könyvtárba végezhetik el. Az FTP szolgáltatás
 használatát külön engedélyeznünk kell az inetd<span class=o>(</span>8<span class=o>)</span> démon részéről és
 az inetd.conf<span class=o>(</span>5<span class=o>)</span> állományban található ftpd<span class=o>(</span>8<span class=o>)</span> démon aktiválásával.
 Ha eddig még nem tettük volna meg, akkor az inetd<span class=o>(</span>8<span class=o>)</span> használatát
 később még újra engedélyezhetjük.

 Ha csak letöltést kívánunk engedni, akkor hagyjuk a feltöltési
 könyvtárra vonatkozó paramétert üresen és az inetd.conf<span class=o>(</span>5<span class=o>)</span>
 állományban az ftpd<span class=o>(</span>8<span class=o>)</span> parancssorához adjuk hozzá az <span class=nt>-r</span> kapcsolót.

 Folytatja az anonim FTP beállítását?

                         <span class=o>[</span> Igen <span class=o>]</span>         Nem</code></pre></div></div><div class=paragraph><p>Az üzenet értesít minket arról, hogy az anonim FTP kapcsolatok engedélyezéséhez az FTP szolgáltatást az <span class=filename>/etc/inetd.conf</span> állományban is be kell majd kapcsolni, lásd <a href=#inetd-services>A hálózati szolgáltatások beállítása</a>. Válasszuk a <b class=button>yes</b> gombot és a folytatáshoz nyomjuk meg az <kbd>Enter</kbd> billentyût. Ekkor a következõ képernyõ jön elõ:</p></div><div id=anon-ftp2 class=imageblock><div class=content><img src=../../../../images/books/handbook/install/ftp-anon1.png alt="ftp anon1"></div><div class=title>Ábra 31. Az anonim FTP alapbeállításai</div></div><div class=paragraph><p>A beállítások kitöltése során a <kbd>Tab</kbd> billentyûvel mozoghatunk az adatmezõk között:</p></div><div class=dlist><dl><dt class=hdlist1>UID (felhasználói azonosító)</dt><dd><p>A névtelen FTP felhasználókhoz társított felhasználói azonosító. A feltöltött állomány tulajdonosa ez az azonosító lesz.</p></dd><dt class=hdlist1>Group (csoport)</dt><dd><p>A névtelen FTP felhasználók csoportja.</p></dd><dt class=hdlist1>Comment (megjegyzés)</dt><dd><p>Ez a szöveg szerepel a felhasználónál az <span class=filename>/etc/passwd</span> állományban.</p></dd><dt class=hdlist1>FTP Root Directory (az FTP gyökere)</dt><dd><p>Itt találhatóak az anonim FTP-n keresztül elérhetõ állományok.</p></dd><dt class=hdlist1>Upload Subdirectory (feltöltési könyvtár)</dt><dd><p>A névtelen FTP felhasználók által feltöltött állományok ide kerülnek.</p></dd></dl></div><div class=paragraph><p>Az FTP gyökere alapból a <span class=filename>/var</span> könyvtár lesz. Ha a becsült FTP-forgalom lebonyolításához itt nem rendelkezünk elegendõ hellyel, akkor az <span class=filename>/usr</span> könyvtárban található <span class=filename>/usr/ftp</span> alkönyvtár is beállítható az FTP gyökerének.</p></div><div class=paragraph><p>Ha elfogadhatónak találjuk az értékeket, nyomjuk le az <kbd>Enter</kbd> billentyût a folytatáshoz.</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>                          User Confirmation Requested
         Create a welcome message file <span class=k>for </span>anonymous FTP <span class=nb>users</span>?

                              <span class=o>[</span> Yes <span class=o>]</span>    No</code></pre></div></div><div class=paragraph><p>Fordítás:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>                       Felhasználói megerősítés szükséges
        Létre kíván hozni egy köszöntő üzenetet tartalmazó állományt
        az anonim FTP felhasználók számára?

                             <span class=o>[</span> Igen <span class=o>]</span>    Nem</code></pre></div></div><div class=paragraph><p>A <b class=button>yes</b> választásával és az <kbd>Enter</kbd> megnyomásával az üzenet szerkesztéséhez egy szövegszerkesztõ fog elindulni.</p></div><div id=anon-ftp4 class=imageblock><div class=content><img src=../../../../images/books/handbook/install/ftp-anon2.png alt="ftp anon2"></div><div class=title>Ábra 32. Az FTP köszöntõ üzenetének szerkesztése</div></div><div class=paragraph><p>Ez az <code>ee</code> szövegszerkesztõ. Az üzenet átírásához használjuk a megadott utasításokat, de akár késõbb is módosíthatjuk ezt a kedvenc szövegszerkesztõnkkel. Ehhez a módosítandó állomány neve és helye a szerkesztõ képernyõjének alján olvasható.</p></div><div class=paragraph><p>A kilépéshez az <kbd>Esc</kbd> lenyomására felbukkanó menüben alapból az <span class=guimenuitem>a) leave editor</span> (kilépés a szerkesztõbõl) menüpont érhetõ el, ezért itt az <kbd>Enter</kbd> lenyomásával léphetünk tovább. Az <kbd>Enter</kbd> ismételt lenyomásával elmenthetjük a módosításainkat.</p></div></div></div><div class=sect3><h4 id=nfsconf>2.10.6. A hálózati állományrendszer beállítása<a class=anchor href=#nfsconf></a></h4><div class=paragraph><p>A hálózati állományrendszer (Network File System, NFS) állományok közzétételét teszi lehetõvé hálózaton keresztül. Használata során egy számítógép beállítható szervernek, kliensnek vagy akár mindkettõnek. Ezzel kapcsolatban a <a href=./#network-nfs>A hálózati állományrendszer (NFS)</a> ajánlott elolvasásra.</p></div><div class=sect4><h5 id=nsf-server-options>2.10.6.1. Az NFS szerver<a class=anchor href=#nsf-server-options></a></h5><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>                       User Confirmation Requested
 Do you want to configure this machine as an NFS server?

                              Yes    <span class=o>[</span> No <span class=o>]</span></code></pre></div></div><div class=paragraph><p>A fordítása:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>                   Felhasználói megerősítés szükséges
   Be akarja állítani NFS szervernek ezt a számítógépet?

                             Igen    <span class=o>[</span> Nem <span class=o>]</span></code></pre></div></div><div class=paragraph><p>Ha nincs szükségünk a hálózati állományrendszer szerver részére, akkor válasszuk a <b class=button>no</b> gombot és nyomjuk le az <kbd>Enter</kbd> billentyût.</p></div><div class=paragraph><p>Amennyiben a <b class=button>yes</b> gombot választjuk, egy üzenet fogja közölni velünk, hogy létre kell hoznunk az <span class=filename>exports</span> állományt.</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>                               Message
Operating as an NFS server means that you must first configure an
/etc/exports file to indicate which hosts are allowed certain kinds of
access to your <span class=nb>local </span>filesystems.
Press <span class=o>[</span>Enter] now to invoke an editor on /etc/exports
                               <span class=o>[</span> OK <span class=o>]</span></code></pre></div></div><div class=paragraph><p>Az üzenet fordítása:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>                               Üzenet
Az NFS szerver működtetéséhez először az /etc/exports állomány
összeállításán keresztül meg kell adnunk, hogy milyen gépek milyen
típusú hozzáféréssel rendelkezzenek a helyi állományrendszereinken.
Az <span class=o>[</span>Enter] lenyomására megkezdődik az /etc/exports állomány
szerkesztése.
                              <span class=o>[</span> OK <span class=o>]</span></code></pre></div></div><div class=paragraph><p>Az <kbd>Enter</kbd> billentyû lenyomásával továbbléphetünk. Ekkor az <span class=filename>exports</span> állomány létrehozására és szerkesztésére egy szövegszerkesztõ indul el.</p></div><div id=nfs-server-edit class=imageblock><div class=content><img src=../../../../images/books/handbook/install/nfs-server-edit.png alt="nfs server edit"></div><div class=title>Ábra 33. Az <span class=filename>exports</span> szerkesztése</div></div><div class=paragraph><p>A exportálni kívánt állományrendszerek felsorolásához használjuk képernyõn a megadott utasításokat, vagy tegyük meg ezt késõbb az általunk választott szövegszerkesztõ segítségével. Ilyenkor ne felejtsük el megjegyezni az állomány képernyõ alján látható nevét és helyét.</p></div><div class=paragraph><p>Amikor végeztünk, az <kbd>Esc</kbd> billentyûvel felhozható menüben alapból az <span class=guimenuitem>a) leave editor</span> (kilépés a szövegszerkesztõbõl) menüpont aktív, ezért itt a folytatáshoz egyszerûen nyomjuk le az <kbd>Enter</kbd> billentyût.</p></div></div><div class=sect4><h5 id=nfs-client-options>2.10.6.2. Az NFS kliens<a class=anchor href=#nfs-client-options></a></h5><div class=paragraph><p>Az NFS kliens beállításával NFS szerverekhez tudunk hozzáférni.</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>                       User Confirmation Requested
 Do you want to configure this machine as an NFS client?

                              Yes   <span class=o>[</span> No <span class=o>]</span></code></pre></div></div><div class=paragraph><p>Fordítás:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>                    Felhasználói megerősítés szükséges
      Beállítja NFS kliensnek ezt a számítógépet?

                             Igen   <span class=o>[</span> Nem <span class=o>]</span></code></pre></div></div><div class=paragraph><p>A nyílbillentyûkkel igényeinknek megfelelõen válasszuk a <b class=button>yes</b> vagy <b class=button>no</b> gombokat és utána nyomjuk meg az <kbd>Enter</kbd> billentyût.</p></div></div></div><div class=sect3><h4 id=console>2.10.7. A rendszerkonzol beállításai<a class=anchor href=#console></a></h4><div class=paragraph><p>Számos beállítás kapcsolódik a rendszerben található konzolok testreszabásához.</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>                      User Confirmation Requested
       Would you like to customize your system console settings?

                              <span class=o>[</span> Yes <span class=o>]</span>  No</code></pre></div></div><div class=paragraph><p>Fordítás:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>                   Felhasználói megerősítés szükséges
               Testreszabja a rendszerkonzol beállításait?

                             <span class=o>[</span> Igen <span class=o>]</span>  Nem</code></pre></div></div><div class=paragraph><p>A beállítások megtekintéséhez és megváltoztatásához válasszuk a <b class=button>yes</b> gombot és nyomjuk le az <kbd>Enter</kbd> billentyût.</p></div><div id=saver-options class=imageblock><div class=content><img src=../../../../images/books/handbook/install/console-saver1.png alt="console saver1"></div><div class=title>Ábra 34. A rendszerkonzol beállításai</div></div><div class=paragraph><p>A képernyõkímélõ beállítása egy gyakori opció. A nyilak használatával álljunk a <span class=guimenuitem>Saver</span> menüpontra, majd nyomjuk le az <kbd>Enter</kbd> billentyût.</p></div><div id=saver-select class=imageblock><div class=content><img src=../../../../images/books/handbook/install/console-saver2.png alt="console saver2"></div><div class=title>Ábra 35. A képernyõkímélõ beállításai</div></div><div class=paragraph><p>A nyilakkal válasszuk ki a használni kívánt képernyõkímélõt és nyomjuk meg hozzá az <kbd>Enter</kbd> billentyût. Ekkor a rendszerkonzol beállításait tartalmazó menü jelenik meg ismét.</p></div><div class=paragraph><p>Az aktivizálódás ideje alapbeállítás szerint 300 másodperc. Ennek megváltoztatásához válasszuk ismét a <span class=guimenuitem>Saver</span> menüpontot. A képernyõkímélõ beállításait tartalmazó menüben a nyílbillentyûkkel válasszuk a <span class=guimenuitem>Timeout</span> (Idõkorlát) menüpontot és nyomjuk meg az <kbd>Enter</kbd> billentyût. Ekkor egy párbeszédablak jelenik meg:</p></div><div id=saver-timeout class=imageblock><div class=content><img src=../../../../images/books/handbook/install/console-saver3.png alt="console saver3"></div><div class=title>Ábra 36. A képernyõkímélõhöz tartozó idõkorlát beállítása</div></div><div class=paragraph><p>Miután megváltoztattuk az értéket, a rendszerkonzol beállításához a <b class=button>OK</b> gomb kiválasztásával, majd az <kbd>Enter</kbd> billentyû lenyomásával térhetünk vissza.</p></div><div id=saver-exit class=imageblock><div class=content><img src=../../../../images/books/handbook/install/console-saver4.png alt="console saver4"></div><div class=title>Ábra 37. Kilépés a rendszerkonzol beállító menüjébõl</div></div><div class=paragraph><p>A <span class=guimenuitem>Exit</span> (Kilépés) választásával és az <kbd>Enter</kbd> lenyomásával folytathatjuk tovább a telepítés utólagos beállításait.</p></div></div><div class=sect3><h4 id=timezone>2.10.8. Az idõzóna beállítása<a class=anchor href=#timezone></a></h4><div class=paragraph><p>Ha kiválasztjuk számítógépünk számára a megfelelõ idõzónát, akkor lehetõvé tesszük, hogy magától elvégezze a helyi idõhöz kapcsolódó összes szükséges korrekciót és helyesen kezelje az idõzónákhoz kapcsolódó többi funkciót.</p></div><div class=paragraph><p>A példában az Egyesült Államok keleti idõzónájában elhelyezkedõ számítógépet láthatunk. A mi beállításaink természetesen a saját földrajzi helyzetünktõl függenek.</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>                      User Confirmation Requested
          Would you like to <span class=nb>set </span>this machine<span class=s1>&#39;s time zone now?

                            [ Yes ]   No</span></code></pre></div></div><div class=paragraph><p>Fordítás:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>                    Felhasználói megerősítés szükséges
                 Beállítja most a számítógép időzónáját?

                           <span class=o>[</span> Igen <span class=o>]</span>   Nem</code></pre></div></div><div class=paragraph><p>A <b class=button>yes</b> gomb és az <kbd>Enter</kbd> billentyû segítségével kiválaszthatjuk az idõzóna beállítását.</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>                       User Confirmation Requested
 Is this machine<span class=s1>&#39;s CMOS clock set to UTC? If it is set to local time
 or you don&#39;</span>t know, please choose NO here!

                              Yes   <span class=o>[</span> No <span class=o>]</span></code></pre></div></div><div class=paragraph><p>Fordítás:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>                     Felhasználói megerősítés szükséges
 A számítógép órája az egységes világidőhöz <span class=o>(</span>UTC<span class=o>)</span> van beállítva? Ha a
 helyi időhöz vagy nem tudjuk, akkor itt válasszuk a NEM gombot!

                             Igen   <span class=o>[</span> Nem <span class=o>]</span></code></pre></div></div><div class=paragraph><p>A számítógépünk órájának beállításának megfelelõen válasszuk a <b class=button>yes</b> vagy <b class=button>no</b> gombot, és nyomjuk meg az <kbd>Enter</kbd> billentyût.</p></div><div id=set-timezone-region class=imageblock><div class=content><img src=../../../../images/books/handbook/install/timezone1.png alt=timezone1></div><div class=title>Ábra 38. A térség kiválasztása</div></div><div class=paragraph><p>A nyilakkal kiválasztható a megfelelõ térség, amit aztán az <kbd>Enter</kbd> billentyûvel tudunk lezárni.</p></div><div id=set-timezone-country class=imageblock><div class=content><img src=../../../../images/books/handbook/install/timezone2.png alt=timezone2></div><div class=title>Ábra 39. Az ország kiválasztása</div></div><div class=paragraph><p>A megfelelõ ország a nyílbillentyûkkel, valamint az <kbd>Enter</kbd> billentyûvel választható ki.</p></div><div id=set-timezone-locality class=imageblock><div class=content><img src=../../../../images/books/handbook/install/timezone3.png alt=timezone3></div><div class=title>Ábra 40. Az idõzóna kiválasztása</div></div><div class=paragraph><p>A nekünk megfelelõ idõzóna a nyilakkal választható meg, amit ezután az <kbd>Enter</kbd> billentyûvel tudunk jóváhagyni.</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>                            Confirmation
            Does the abbreviation <span class=s1>&#39;EDT&#39;</span> look reasonable?

                            <span class=o>[</span> Yes <span class=o>]</span>   No</code></pre></div></div><div class=paragraph><p>Az üzenet fordítása:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>                             Megerősítés
                 Ezek szerint az <span class=s1>&#39;EDT&#39;</span> elfogadható?

                           <span class=o>[</span> Igen <span class=o>]</span>   Nem</code></pre></div></div><div class=paragraph><p>Erõsítsük meg, hogy az idõzóna helyes-e. Ha rendbenlevõnek látszik, nyomjuk meg az <kbd>Enter</kbd> billentyût a folytatáshoz.</p></div></div><div class=sect3><h4 id=linuxcomp>2.10.9. Linux binárisok használata<a class=anchor href=#linuxcomp></a></h4><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Ez a rész csak a FreeBSD 7.<em>X</em> telepítésére vonatkozik, FreeBSD 8.<em>X</em> esetén ez a képernyõ nem jelenik meg.</p></div></td></tr></tbody></table></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>                      User Confirmation Requested
          Would you like to <span class=nb>enable </span>Linux binary compatibility?

                            <span class=o>[</span> Yes <span class=o>]</span>   No</code></pre></div></div><div class=paragraph><p>A fordítás:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>                   Felhasználói megerősítés szükséges
               Engedélyezi a Linux binárisok futtatását?

                           <span class=o>[</span> Igen <span class=o>]</span>   Nem</code></pre></div></div><div class=paragraph><p>A <b class=button>yes</b> gomb kiválasztásával és az <kbd>Enter</kbd> lenyomásával megengedjük, hogy a Linuxra készült szoftvereket futtassunk FreeBSD-n. A telepítõ ennek biztosításához még további csomagokat is fel fog rakni.</p></div><div class=paragraph><p>Ha FTP-n keresztül telepítünk, akkor a számítógépnek csatlakoznia kell az internetre. Ilyenkor elõfordulhat, hogy az FTP szerveren nem találhatóak meg a Linux® kompatibilitással kapcsolatos csomagok. Ezeket azonban késõbb is telepíthetjük.</p></div></div><div class=sect3><h4 id=mouse>2.10.10. Az egér beállításai<a class=anchor href=#mouse></a></h4><div class=paragraph><p>Ezen beállítás használatával egy háromgombos egérrel lehetõségünk adódik a konzol és a felhasználói programok között kivágni és bemásolni szövegeket. Kétgombos egér használata esetén nézzük meg a <a href="https://man.freebsd.org/cgi/man.cgi?query=moused&amp;sektion=8&amp;format=html">moused(8)</a> man oldalán, miként tudjuk emulálni a háromgombos mûködést. A következõ példa egy nem USB-s (tehát PS/2-es vagy soros portra csatlakozó) egér beállítását illusztrálja:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>                      User Confirmation Requested
         Does this system have a PS/2, serial, or bus mouse?

                            <span class=o>[</span> Yes <span class=o>]</span>    No</code></pre></div></div><div class=paragraph><p>Fordítás:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>                   Felhasználói megerősítés szükséges
      Csatlakozik a rendszeréhez PS/2-es, soros vagy buszos egér?

                           <span class=o>[</span> Igen <span class=o>]</span>    Nem</code></pre></div></div><div class=paragraph><p>A PS/2, soros vagy buszos egér használatához válasszuk a <b class=button>yes</b> gombot, illetve az USB-s egérhez pedig a <b class=button>no</b> gombot, majd nyomjuk meg az <kbd>Enter</kbd> billentyût.</p></div><div id=mouse-protocol class=imageblock><div class=content><img src=../../../../images/books/handbook/install/mouse1.png alt=mouse1></div><div class=title>Ábra 41. Az egér által használt protokoll típusának beállítása</div></div><div class=paragraph><p>A nyílbillentyûk használatával keressük ki a <span class=guimenuitem>Type</span> (Típus) menüpontot és nyomjuk le az <kbd>Enter</kbd> billentyût.</p></div><div id=set-mouse-protocol class=imageblock><div class=content><img src=../../../../images/books/handbook/install/mouse2.png alt=mouse2></div><div class=title>Ábra 42. Az egér protokolljának beállítása</div></div><div class=paragraph><p>A példában használt egér típusa PS/2, ezért itt a alapértelmezés szerint felkínált <span class=guimenuitem>Auto</span> megfelelõ. A protokoll megváltoztatásához a nyilakkal válasszunk ki egy másikat. Ezután gondoskodjunk róla, hogy az <b class=button>OK</b> gombot választottuk ki és a kilépéshez nyomjuk meg az <kbd>Enter</kbd> billentyût.</p></div><div id=config-mouse-port class=imageblock><div class=content><img src=../../../../images/books/handbook/install/mouse3.png alt=mouse3></div><div class=title>Ábra 43. Az egér portjának beállítása</div></div><div class=paragraph><p>A nyílbillentyûkkel válasszuk ki a <span class=guimenuitem>Port</span> menüpontot és nyomjuk meg az <kbd>Enter</kbd> billentyût.</p></div><div id=set-mouse-port class=imageblock><div class=content><img src=../../../../images/books/handbook/install/mouse4.png alt=mouse4></div><div class=title>Ábra 44. Az egér portjának kiválasztása</div></div><div class=paragraph><p>Mivel a példában szereplõ rendszerhez egy PS/2 egér csatlakozik, ezért az alapértelmezett <span class=guimenuitem>PS/2</span> menüpont megfelelõnek tûnik. A port megváltoztatásához használjuk a nyilakat, majd nyomjuk le az <kbd>Enter</kbd> billentyût.</p></div><div id=test-daemon class=imageblock><div class=content><img src=../../../../images/books/handbook/install/mouse5.png alt=mouse5></div><div class=title>Ábra 45. Az egérdémon engedélyezése</div></div><div class=paragraph><p>Befejezésül a egérhez tartozó démon aktiválásához és kipróbálásához válasszuk ki a nyilakkal az <span class=guimenuitem>Enable</span> (Engedélyezés) menüpontot.</p></div><div id=test-mouse-daemon class=imageblock><div class=content><img src=../../../../images/books/handbook/install/mouse6.png alt=mouse6></div><div class=title>Ábra 46. Az egérdémon kipróbálása</div></div><div class=paragraph><p>Próbáljuk mozgatni a képernyõn megjelenõ egérkurzort, és ellenõrizzük, hogy a kurzor a mozdulatainknak megfelelõen reagál-e. Ha mindent rendben találunk, akkor válasszuk a <b class=button>yes</b> gombot és nyomjuk le az <kbd>Enter</kbd> billentyût. Ellenkezõ esetben az egeret nem jól állítottuk be - válasszuk a <b class=button>no</b> gombot és kísérletezzünk tovább más beállításokkal.</p></div><div class=paragraph><p>Az utólagos beállítások folytatásához válasszuk elõször az <span class=guimenuitem>Exit</span> (Kilépés) menüpontot, majd nyomjuk meg az <kbd>Enter</kbd> billentyût.</p></div></div><div class=sect3><h4 id=packages>2.10.11. Csomagok telepítése<a class=anchor href=#packages></a></h4><div class=paragraph><p>A csomagok elõre lefordított binárisokat tartalmaznak, és használatukkal igen kényelmesen tudunk szoftvereket telepíteni.</p></div><div class=paragraph><p>Szemléltetés céljából most bemutatjuk az egyik ilyen csomag telepítését. Természetesen igény szerint más csomagokat is hozzávehetünk. A telepítés után a <code>sysinstall</code> parancs használható további csomagok telepítésére.</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>                     User Confirmation Requested
 The FreeBSD package collection is a collection of hundreds of
 ready-to-run applications, from text editors to games to WEB servers
 and more. Would you like to browse the collection now?

                            <span class=o>[</span> Yes <span class=o>]</span>   No</code></pre></div></div><div class=paragraph><p>Az üzenet fordítása:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>                 Felhasználói megerősítés szükséges
 A FreeBSD csomaggyűjteménye többezernyi azonnal használható
 alkalmazást tartalmaz, a szövegszerkesztőktől a játékokon keresztül a
 WEBszervereken át szinte mindent. Át kívánja lapozni most ezt a
 gyűjteményt?

                           <span class=o>[</span> Igen <span class=o>]</span>   Nem</code></pre></div></div><div class=paragraph><p>A <b class=button>yes</b> kiválasztása és az <kbd>Enter</kbd> lenyomása után a csomagválasztó képernyõ következik:</p></div><div id=package-category class=imageblock><div class=content><img src=../../../../images/books/handbook/install/pkg-cat.png alt="pkg cat"></div><div class=title>Ábra 47. A csomagok kategóriájának kiválasztása</div></div><div class=paragraph><p>Ekkor csak az adott telepítõeszközön elérhetõ csomagok fognak megjelenni.</p></div><div class=paragraph><p>Az összes csomagot az <span class=guimenuitem>All</span> (Mind) menüpont kiválasztásával láthatjuk, vagy leszûkíthetjük ezt egy adott kategóriára is. Álljunk a kiválasztott kategóriához tartozó menüpontra és nyomjuk meg az <kbd>Enter</kbd> billentyût.</p></div><div class=paragraph><p>Ezután egy menü fogja felsorolni az adott kategórián belül telepíthetõ csomagokat:</p></div><div id=package-select class=imageblock><div class=content><img src=../../../../images/books/handbook/install/pkg-sel.png alt="pkg sel"></div><div class=title>Ábra 48. Csomag kiválasztása</div></div><div class=paragraph><p>A példában a bash parancsértelmezõt választottuk ki. Válogassunk kedvünkre a csomagok között, és álljunk a telepíteni kívántakra, majd a <kbd>Szóköz</kbd> billentyû lenyomásával jelöljük be ezeket. Minden egyes csomag rövid leírása a képernyõ bal alsó sarkában olvasható.</p></div><div class=paragraph><p>A <kbd>Tab</kbd> billentyû segítségével mozoghatunk az utoljára kiválasztott csomag, az <b class=button>OK</b> és <b class=button>Cancel</b> gombok között.</p></div><div class=paragraph><p>Miután bejelöltük az összes telepítésre szánt csomagot, a csomagválasztó menübe úgy tudunk visszatérni, ha a <kbd>Tab</kbd> billentyûvel átváltunk az <b class=button>OK</b> gombra és nyomjuk meg az <kbd>Enter</kbd> billentyût.</p></div><div class=paragraph><p>Ezeken felül a bal és jobb nyilak használhatóak az <b class=button>OK</b> és <b class=button>Cancel</b> gombok közti váltásra. Ugyanezzel a módszerrel választható ki az <b class=button>OK</b> gomb is, ami után az <kbd>Enter</kbd> billentyû megnyomásával visszajutunk a csomagválasztó menübe.</p></div><div id=package-install class=imageblock><div class=content><img src=../../../../images/books/handbook/install/pkg-install.png alt="pkg install"></div><div class=title>Ábra 49. Csomagok telepítése</div></div><div class=paragraph><p>A nyilakkal és a <kbd>Tab</kbd> billentyûvel válasszuk ki az <b class=button>Install</b> (Telepítés) gombot és nyomjuk meg az <kbd>Enter</kbd> billentyût. Ekkor meg kell erõsítenünk a csomagok telepítését:</p></div><div id=package-install-confirm class=imageblock><div class=content><img src=../../../../images/books/handbook/install/pkg-confirm.png alt="pkg confirm"></div><div class=title>Ábra 50. Csomagok telepítésének megerõsítése</div></div><div class=paragraph><p>Az <b class=button>OK</b> kiválasztása majd az <kbd>Enter</kbd> billentyû lenyomása indítja el a csomagok telepítését. A telepítés befejezéséig különbözõ üzenetek fognak megjelenni. Figyeljünk az ilyenkor felbukkanó hibaüzenetekre!</p></div><div class=paragraph><p>A beállítások véglegesítése a csomagok telepítése után folytatódik. Amennyiben egyetlen csomagot sem választottunk és szeretnénk továbblépni, akkor is az <b class=button>Install</b> (Telepítés) gombot válasszuk.</p></div></div><div class=sect3><h4 id=addusers>2.10.12. Felhasználók és csoportok felvétele<a class=anchor href=#addusers></a></h4><div class=paragraph><p>A telepítés során legalább egy felhasználót érdemes hozzáadnunk a rendszerhez, mivel a rendszer használatához így nem kell <code>root</code> felhasználóként bejelentkezni. Általánosságban véve ahhoz egyébként is kicsi a gyökérpartíció, hogy <code>root</code> felhasználóként (rendszeradminisztrátorként) futtassunk rajta programokat, és gyorsan be is telik. A nagyobb veszélyt azonban itt olvashatjuk:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>                     User Confirmation Requested
 Would you like to add any initial user accounts to the system? Adding
 at least one account <span class=k>for </span>yourself at this stage is suggested since
 working as the <span class=s2>&#34;root&#34;</span> user is dangerous <span class=o>(</span>it is easy to <span class=k>do </span>things which
 adversely affect the entire system<span class=o>)</span><span class=nb>.</span>

                            <span class=o>[</span> Yes <span class=o>]</span>   No</code></pre></div></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>                  Felhasználói megerősítés szükséges
 Szeretnénk mosta rendszerbe felvenni felhasználói fiókokat? Ebben a
 lépésben legalább egy felhasználó felvétele javasolt, hiszen <span class=s2>&#34;root&#34;</span>
 felhasználóként veszélyes dolgozni <span class=o>(</span>mivel így könnyen tehetünk olyan
 dolgokat, amelyek káros hatással lehetnek rendszerünkre<span class=o>)</span><span class=nb>.</span>

                           <span class=o>[</span> Igen <span class=o>]</span>   Nem</code></pre></div></div><div class=paragraph><p>Ezért válasszuk a <b class=button>yes</b> gombot és az <kbd>Enter</kbd> billentyû lenyomásával lépjünk tovább a felhasználók felvételéhez.</p></div><div id=add-user2 class=imageblock><div class=content><img src=../../../../images/books/handbook/install/adduser1.png alt=adduser1></div><div class=title>Ábra 51. Felhasználók kiválasztása</div></div><div class=paragraph><p>A nyílbillentyûkkel válasszuk ki a <span class=guimenuitem>User</span> (Felhasználó) menüpontot és nyomjuk meg az <kbd>Enter</kbd> billentyût.</p></div><div id=add-user3 class=imageblock><div class=content><img src=../../../../images/books/handbook/install/adduser2.png alt=adduser2></div><div class=title>Ábra 52. A felhasználó adatainak megadása</div></div><div class=paragraph><p>Amikor a <kbd>Tab</kbd> billentyûvel lépkedünk a kitöltendõ mezõk között, a képernyõ alsó részén az alábbi leírások magyarázzák az egyes mezõk tartalmát:</p></div><div class=dlist><dl><dt class=hdlist1>Login ID (Bejelentkezési azonosító)</dt><dd><p>Az új felhasználó bejelentkezési neve (kötelezõ).</p></dd><dt class=hdlist1>UID (Felhasználói azonosító)</dt><dd><p>A felhasználó számszerû azonosítója (automatikusan létrejön, ha üresen hagyjuk).</p></dd><dt class=hdlist1>Group (Csoport)</dt><dd><p>A felhasználó bejelentkezési csoportjának neve (automatikusan létrejön, ha üresen hagyjuk).</p></dd><dt class=hdlist1>Password (Jelszó)</dt><dd><p>A felhasználó jelszava (óvatosan bánjunk ezzel a mezõvel!)</p></dd><dt class=hdlist1>Full name (Teljes név)</dt><dd><p>A felhasználó teljes neve (megjegyzés).</p></dd><dt class=hdlist1>Member groups (További csoportok)</dt><dd><p>A felhasználó ezen csoportoknak is tagja (tehát rendelkezik az engedélyeikkel).</p></dd><dt class=hdlist1>Home directory (Felhasználói könyvtár)</dt><dd><p>A felhasználó saját könyvtára (ha üresen hagyjuk, az alapértelmezés szerint töltõdik ki).</p></dd><dt class=hdlist1>Login shell (Parancsértelmezõl)</dt><dd><p>A felhasználó által használt parancsértelmezõ (ha üresen hagyjuk, az alapértelmezés szerint töltõdik, mint például <span class=filename>/bin/sh</span>).</p></dd></dl></div><div class=paragraph><p>Az ábrán a bejelentkezés után használt parancsértelmezõt a <span class=filename>/bin/sh</span> parancsértelmezõrõl a <span class=filename>/usr/local/bin/bash</span> parancsértelmezõre változtattuk, így most a korábban telepített bash parancsértelmezõt fogjuk használni. Itt ne is próbáljunk nem létezõ parancsértelmezõt kiválasztani, hiszen ekkor nem tudunk majd bejelentkezni. A BSD világban egyébként a C shell a leggyakrabban használt, amelyet a <span class=filename>/bin/tcsh</span> megadásával választhatjuk ki.</p></div><div class=paragraph><p>Az ábrán szereplõ felhasználót ezenkívül még a <code>wheel</code> csoportba is felvettük, aminek köszönhetõen képes lesz a rendszerünkben a <code>root</code> felhasználói jogaival rendelkezõ rendszeradminisztrátorrá válni.</p></div><div class=paragraph><p>Amikor mindent megfelelõnek találunk, nyomjunk az <b class=button>OK</b> gombra és ekkor ismét a felhasználók és csoportok karbantartását tartalmazó menü jelenik meg:</p></div><div id=add-user4 class=imageblock><div class=content><img src=../../../../images/books/handbook/install/adduser3.png alt=adduser3></div><div class=title>Ábra 53. Kilépés a felhasználók és csoportok menüjébõl</div></div><div class=paragraph><p>Csoportokat is létre tudunk hozni, amennyiben erre szükségünk lenne. Ez a rész a telepítés befejezése után továbbra is elérhetõ a <code>sysinstall</code> parancs segítségével.</p></div><div class=paragraph><p>Amikor befejeztük a felhasználók hozzáadását, a nyilakkal válasszuk ki az <span class=guimenuitem>Exit</span> (Kilépés) menüpontot és a telepítés folytatásához nyomjuk meg az <kbd>Enter</kbd> billentyût.</p></div></div><div class=sect3><h4 id=rootpass>2.10.13. A <code>root</code> felhasználó jelszavának megadása<a class=anchor href=#rootpass></a></h4><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>                        Message
 Now you must <span class=nb>set </span>the system manager<span class=s1>&#39;s password.
 This is the password you&#39;</span>ll use to log <span class=k>in </span>as <span class=s2>&#34;root&#34;</span><span class=nb>.</span>

                         <span class=o>[</span> OK <span class=o>]</span>

               <span class=o>[</span> Press enter or space <span class=o>]</span></code></pre></div></div><div class=paragraph><p>Fordítása:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>                         Üzenet
 Most meg kell adnia a rendszergazda jelszavát. Ezt a jelszót
 kell a <span class=s2>&#34;root&#34;</span> felhasználó bejelentkezésekor használni.

                         <span class=o>[</span> OK <span class=o>]</span>

     <span class=o>[</span> Nyomja le az Enter vagy a Szóköz billentyűt <span class=o>]</span></code></pre></div></div><div class=paragraph><p>A <code>root</code> felhasználó jelszavának beállításához nyomjuk meg az <kbd>Enter</kbd> billentyût.</p></div><div class=paragraph><p>A jelszót kétszer kell megadnunk. Felesleges megemlíteni, hogy gondoskodjunk arról az esetrõl is, ha véletlenül elfelejtenénk ezt a jelszót. Megemlítjük, hogy az itt begépelt jelszó nem lesz látható és a betûk helyett sem jelennek meg csillagok.</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>New password:
Retype new password :</code></pre></div></div><div class=paragraph><p>A jelszó sikeres megadása után a telepítés folytatódik.</p></div></div><div class=sect3><h4 id=exit-inst>2.10.14. Kilépés a telepítõbõl<a class=anchor href=#exit-inst></a></h4><div class=paragraph><p>Ha be szeretnénk még állítani <a href=#network-services>egyéb hálózati szolgáltatást</a> vagy valamilyen más konfigurációs lépést kívánunk még elvégezni, ezen a ponton megtehetjük vagy a telepítés után a <code>sysinstall</code> parancs kiadásával.</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>                     User Confirmation Requested
 Visit the general configuration menu <span class=k>for </span>a chance to <span class=nb>set </span>any last
 options?

                              Yes   <span class=o>[</span> No <span class=o>]</span></code></pre></div></div><div class=paragraph><p>Fordítás:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>                  Felhasználói megerősítés szükséges
 Végignézi még utoljára a beállításokat arra az esetre, ha véletlenül
 kihagytunk volna valamit?

                             Igen   <span class=o>[</span> Nem <span class=o>]</span></code></pre></div></div><div class=paragraph><p>Ha a nyilakkal a <b class=button>no</b> gombot választjuk, majd megnyomjuk rajta az <kbd>Enter</kbd> billentyût, akkor visszatérünk a telepítõ fõmenüjébe.</p></div><div id=final-main class=imageblock><div class=content><img src=../../../../images/books/handbook/install/mainexit.png alt=mainexit></div><div class=title>Ábra 54. Kilépés a telepítõbõl</div></div><div class=paragraph><p>Válasszuk ki a nyílbillentyûkkel a <b class=button>X Exit Install</b> (Kilépés a telepítõbõl) gombot és nyomjuk meg az <kbd>Enter</kbd> billentyût. Ezután meg kell erõsítenünk kilépési szándékunkat:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>                     User Confirmation Requested
 Are you sure you wish to <span class=nb>exit</span>? The system will reboot.

                            <span class=o>[</span> Yes <span class=o>]</span>   No</code></pre></div></div><div class=paragraph><p>Fordítás:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>                  Felhasználói megerősítés szükséges
         Valóban ki akar lépni? A rendszer ezt követően újra fog
         indulni!

                           <span class=o>[</span> Igen <span class=o>]</span>    Nem</code></pre></div></div><div class=paragraph><p>Válasszuk a <b class=button>yes</b> gombot. Ha CD-meghajtóról indítottuk a telepítést, akkor a következõ üzenet fog figyelmeztetni minket a lemez kivételére:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>                     Message
 Be sure to remove the media from the drive.

                    <span class=o>[</span> OK <span class=o>]</span>
           <span class=o>[</span> Press enter or space <span class=o>]</span></code></pre></div></div><div class=paragraph><p>Fordítás:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>                     Üzenet
 Ne felejtsük el kivenni a CD-lemezt a meghajtóból.

                    <span class=o>[</span> OK <span class=o>]</span>
        <span class=o>[</span> Nyomjunk Entert vagy szóközt <span class=o>]</span></code></pre></div></div><div class=paragraph><p>A CD-meghajtó egészen az újraindítás megkezdéséig zárolt lesz, ezért csak ekkor tudjuk (gyorsan) kivenni a meghajtóból a lemezt. Nyomjuk meg az <b class=button>OK</b> gombot az újraindításhoz.</p></div><div class=paragraph><p>A rendszer újraindul, legyünk résen és figyeljük a megjelenõ hibaüzeneteket, errõl bõvebben lásd a <a href=#freebsdboot>A FreeBSD indulása</a>ban.</p></div></div><div class=sect3><h4 id=network-services>2.10.15. További hálózati szolgálatások beállítása<a class=anchor href=#network-services></a></h4><div class=paragraph><p>A hálózati szolgáltatások terén csekély tapasztalattal rendelkezõ kezdõ felhasználók számára ijesztõ lehet ezek beállítása. A hálózatok és többek közt az internet kezelése napjaink modern operációs rendszereink, így a FreeBSD-nek is az egyik fontos területe. Ezért nagyon hasznos ismernünk valamennyire a FreeBSD által felkínált hálózati lehetõségeket. A telepítés közben ezért a felhasználónak tisztában kell lennie a rendelkezésére álló szolgáltatásokkal.</p></div><div class=paragraph><p>A hálózati szolgáltatások olyan programok, amelyek a hálózat minden részérõl fogadnak adatokat. Mindent el kell követnünk annak érdekében, hogy ezek a programok ne tehessenek semmilyen "kárt". Sajnos a programozók sem tökéletesek, és az idõk során már elõfordult párszor, hogy a hálózati szolgáltatásokban maradtak hibák, amelyek kihasználásával a támadók rossz dolgokat tudtak csinálni. Ezért fontos, hogy csak is azokat a szolgáltatásokat engedélyezzük, amelyekre ténylegesen szükségünk van. Ha nem tudjuk eldönteni, akkor az a legjobb, ha egészen addig egyiket sem engedélyezzük, amíg valóban szükségünk nem lesz rájuk. A sysinstall újbóli elindításával vagy az <span class=filename>/etc/rc.conf</span> megfelelõ beállításával mindig tudunk új szolgáltatásokat aktiválni.</p></div><div class=paragraph><p>A <span class=guimenuitem>Networking</span> (Hálózatok) menüpont kiválasztása után valami ilyesmit láthatunk:</p></div><div id=network-configuration class=imageblock><div class=content><img src=../../../../images/books/handbook/install/net-config-menu1.png alt="net config menu1"></div><div class=title>Ábra 55. A hálózati beállítások menüjének felsõ szintje</div></div><div class=paragraph><p>Ezek közül a <span class=guimenuitem>Interfaces</span> (Csatolók), vagyis az elsõ menüpontról korábban már szó esett a <a href=#inst-network-dev>A hálózati eszközök beállítása</a>ban, ezért ez most nyugodtan kihagyható.</p></div><div class=paragraph><p>Az <span class=guimenuitem>AMD</span> menüpont kiválasztásával engedélyezzük a BSD automatikus csatlakoztatásokért felelõs segédeszközét (AMD, az AutoMounter Daemon). Ezt általában az NFS protokollal (lásd lentebb) együtt szokás használni a távoli állományrendszerek automatikus csatlakoztatásához. Itt nincs szükség semmilyen különleges beállításra.</p></div><div class=paragraph><p>A következõ sorban az <span class=guimenuitem>AMD Flags</span> (Az AMD beállításai) menüpont szerepel. Kiválasztása után az AMD beállításait bekérõ ablak fog felbukkani. Ez már számos alapértelmezett beállítást tartalmaz:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=nt>-a</span> /.amd_mnt <span class=nt>-l</span> syslog /host /etc/amd.map /net /etc/amd.map</code></pre></div></div><div class=paragraph><p>A <code>-a</code> kapcsolóval adjuk meg a csatlakozási pontok alapértelmezett helyét, amely ebben az esetben az <span class=filename>/.amd_mnt</span>. A <code>-l</code> kapcsolóval adjuk meg az alapértelmezett <span class=filename>log</span> (napló) állományt, habár a <code>syslogd</code> használata során az összes naplózási tevékenység a rendszer naplózó démonján fut majd keresztül. A <span class=filename>/host</span> könyvtárba fognak csatlakozni a távoli gépek exportált állományrendszerei, míg a <span class=filename>/net</span> könyvtárba a különbözõ IP-címekrõl exportált állományrendszerek kerülnek csatlakoztatásra. Az <span class=filename>/etc/amd.map</span> állomány tartalmazza az AMD exportjainak alapértelmezett beállításait.</p></div><div class=paragraph><p>Az <span class=guimenuitem>Anon FTP</span> menüponton keresztül engedélyezhetjük az anonim FTP kapcsolatokat. A menüpont kiválasztásával számítógépünket egy anonim FTP szerverré tehetjük, azonban legyünk tekintettel a beállításhoz tartozó biztonsági veszélyekre! A kiválasztásakor egy ablak tájékoztat minket a beállítás részleteirõl és felmerülõ biztonsági kockázatokról.</p></div><div class=paragraph><p>A <span class=guimenuitem>Gateway</span> (Átjáró) menüpont használatával a korábbiakban tárgyaltak szerint állíthatjuk be számítógépünket hálózati átjárónak. Ugyanekkor a <span class=guimenuitem>Gateway</span> menüben nyílik lehetõségük kikapcsolni ezt a beállítást, amennyiben a telepítési folyamat korábbi lépései során véletlenül engedélyeztük volna.</p></div><div class=paragraph><p>Az <span class=guimenuitem>Inetd</span> menüpont segítségével beállíthatjuk, vagy akár teljesen ki is kapcsolhatjuk a korábban tárgyalt <a href="https://man.freebsd.org/cgi/man.cgi?query=inetd&amp;sektion=8&amp;format=html">inetd(8)</a> démont.</p></div><div class=paragraph><p>A <span class=guimenuitem>Mail</span> (Levelezés) menüpontban beállíthatjuk a rendszer alapértelmezett MTA avagy levéltovábbító ügynökét (Mail Transfer Agent). Ennek hatására a következõ menü jelenik meg:</p></div><div id=mta-selection class=imageblock><div class=content><img src=../../../../images/books/handbook/install/mta-main.png alt="mta main"></div><div class=title>Ábra 56. Az alapértelmezett MTA kiválasztása</div></div><div class=paragraph><p>Itt válaszhatunk, hogy a különbözõ levélküldõ rendszerek közül melyiket telepítsük alapértelmezettként. Egy ilyen alkalmazás lényegében nem több, mint egy levélküldésre használt szerver, amely továbbítja a rendszerben vagy az interneten található felhasználók számára a leveleket.</p></div><div class=paragraph><p>A <span class=guimenuitem>Sendmail</span> választásával a FreeBSD alapból felkínált megoldását, a népszerû sendmail szervert telepíthetjük. A <span class=guimenuitem>Sendmail local</span> (Helyi Sendmail) menüpont kiválasztásával szintén a sendmail lesz a telepítendõ levélküldõ szerver, azonban nem lesz képes az internetrõl érkezõ leveleket fogadni. Az itt felsorolt többi beállítás, tehát a <span class=guimenuitem>Postfix</span> és <span class=guimenuitem>Exim</span>, a <span class=guimenuitem>Sendmail</span> beállításához hasonlóan zajlik. Mind a kettõ elektronikus levelek kézbesítésére használható, azonban bizonyos felhasználók a sendmail helyett inkább ezek valamelyikét használják.</p></div><div class=paragraph><p>Valamelyik vagy éppen semelyik levéltovábbító szerver kiválasztása után az <span class=guimenuitem>NFS client</span> (NFS kliens) beállítására vonatkozó menü jelentkezik.</p></div><div class=paragraph><p>Az <span class=guimenuitem>NFS client</span> beállításával a rendszerünk NFS szerverekkel lesz képes kapcsolatba lépni. Egy ilyen NFS szerver az NFS protokoll segítségével a hálózaton keresztül elérhetõvé tesz állományrendszereket. Ha gépünk független, akkor nem fontos kiválasztanunk ezt a menüpontot. A rendszernek késõbb további beállításokra is szüksége lehet, amelyekrõl az <a href=./#network-nfs>A hálózati állományrendszer (NFS)</a>ban olvashatunk részletesebben.</p></div><div class=paragraph><p>Az <span class=guimenuitem>NFS server</span> (NFS szerver) menüpont kiválasztásával hozzájárulunk, hogy rendszerünk NFS szerverként üzemeljen. Ehhez meg kell adnunk az RPC, vagyis a távoli eljáráshívások kiszolgálásának elindításához szükséges adatokat is. Az RPC használatával a különbözõ kiszolgálók és programok között tudjuk vezérelni a kapcsolatot.</p></div><div class=paragraph><p>A sorban az <span class=guimenuitem>Ntpdate</span> beállítása következik, ahol az idõszinkronizációhoz kapcsolódó opciókat találjuk. Kiválasztásakor az ábrán szereplõhöz hasonló menü fog megjelenni:</p></div><div id=Ntpdate-config class=imageblock><div class=content><img src=../../../../images/books/handbook/install/ntp-config.png alt="ntp config"></div><div class=title>Ábra 57. Az Ntpdate beállítása</div></div><div class=paragraph><p>Ebbõl a menübõl válasszuk ki a hozzánk legközelebb levõ szevert. Egy közeli szerver megadásával az idõszinkronizáció sokkalta pontosabbá válik, mivel a tõlünk távolabbi szerverek kapcsolatának késleltetése nagyobb lehet.</p></div><div class=paragraph><p>A következõ beállítás az PCNFSD. Ennek kiválasztása során a Portgyûjteménybõl telepítésre kerül a <a class=package href=https://cgit.freebsd.org/ports/tree/net/pcnfsd/>net/pcnfsd</a> csomag. Ez lényegében egy hasznos segédprogram, amellyel olyan operációs rendszerek számára tudunk hitelesítést szolgáltatni az NFS használata során, amelyek maguktól erre nem képesek, mint például a Microsoft® MS-DOS® rendszere.</p></div><div class=paragraph><p>A többi beállítás megtekintéséhez egy kicsit lejjebb kell haladnunk a listában:</p></div><div id=Network-configuration-cont class=imageblock><div class=content><img src=../../../../images/books/handbook/install/net-config-menu2.png alt="net config menu2"></div><div class=title>Ábra 58. A hálózati beállítások menüjének alsó szintje</div></div><div class=paragraph><p>Az <a href="https://man.freebsd.org/cgi/man.cgi?query=rpcbind&amp;sektion=8&amp;format=html">rpcbind(8)</a> és <a href="https://man.freebsd.org/cgi/man.cgi?query=rpc.statd&amp;sektion=8&amp;format=html">rpc.statd(8)</a>, valamint az <a href="https://man.freebsd.org/cgi/man.cgi?query=rpc.lockd&amp;sektion=8&amp;format=html">rpc.lockd(8)</a> segédprogramok mind a távoli eljáráshívásokhoz (Remote Procedure Call, RPC) használhatóak. Az <code>rpcbind</code> segédprogram az NFS szerverei és kliensei között felügyeli a kapcsolatot, ezért a használata az NFS szerverek és kliensek mûködéséhez elengedhetetlen. Az állapot figyeléséhez az rpc.statd démon felveszi a kapcsolatot a többi gépen futó rpc.statd démonokkal. A jelentett állapotok általában a <span class=filename>/var/db/statd.status</span> állományban találhatóak. Itt a következõként felsorolt elem az <span class=guimenuitem>rpc.lockd</span>, amelynek kiválasztásával állományzárolási szolgáltatásokat érhetünk el. Ezt többnyire az rpc.statd démonnal együtt alkalmazzák a zárolásokat kérõ gépek és a kérések gyakoriságának nyilvántartására. Míg ezekkel a beállításokkal gyönyörûen nyomon lehet követni a mûködést, az NFS szerverek és kliensek megfelelõ mûködéséhez nem kötelezõ a használatuk.</p></div><div class=paragraph><p>Ahogy haladunk tovább a listában, a következõ elem a <span class=guimenuitem>Routed</span>, vagyis az útválasztásért felelõs démon lesz. A <a href="https://man.freebsd.org/cgi/man.cgi?query=routed&amp;sektion=8&amp;format=html">routed(8)</a> segédprogram a hálózati útválasztó táblázatokat tartja karban, felderíti az elérhetõ útválasztókat és kérésre bármelyik hozzá fizikailag csatlakozó gép számára átadja az általa nyilvántartott útválasztási adatokat. Ezt leginkább a helyi hálózat átjárójaként mûködõ számítógépek használják. Kiválasztásakor egy ablak fog rákérdezni a segédprogram helyére. Az itt alapból felkínált érték általában megfelelõ, ezért nyugtázhatjuk az <kbd>Enter</kbd> billentyû lenyomásával. Ezt követõen egy másik menü jelenik meg, ahol a routed beállításait adhatjuk meg. Itt alapértelmezés szerint a <code>-q</code> kapcsoló szerepel.</p></div><div class=paragraph><p>A következõ sor az <span class=guimenuitem>Rwhod</span> beállításé, aminek kiválasztásával el tudjuk indíttatni az <a href="https://man.freebsd.org/cgi/man.cgi?query=rwhod&amp;sektion=8&amp;format=html">rwhod(8)</a> démont a rendszer elindítása során. Az <code>rwhod</code> segédprogram a rendszerüzeneteket a hálózaton idõközönként szétküldi vagy "figyelõ" (consumer) módban összegyûjti ezeket. Ennek pontosabb részleteit az <a href="https://man.freebsd.org/cgi/man.cgi?query=ruptime&amp;sektion=1&amp;format=html">ruptime(1)</a> és <a href="https://man.freebsd.org/cgi/man.cgi?query=rwho&amp;sektion=1&amp;format=html">rwho(1)</a> man oldalakon találhatjuk meg.</p></div><div class=paragraph><p>Az <a href="https://man.freebsd.org/cgi/man.cgi?query=sshd&amp;sektion=8&amp;format=html">sshd(8)</a> démoné az utolsó elõtti beállítás. Ez az OpenSSH biztonságos shell szervere, melyet a szabványos telnet és FTP szerverek helyett ajánlanak. Az sshd szerver tehát két gép közti biztonságos, titkosított kapcsolatok létrehozására használható.</p></div><div class=paragraph><p>A lista végén a <span class=guimenuitem>TCP Extensions</span> (TCP kiterjesztések) menüpontot találhatjuk. Segítségével a TCPRFC 1323 és RFC 1644 dokumentumokban leírt kiterjesztéseinek használatát engedélyezhetjük. Ezzel egyes gépek esetén felgyorsulhat a kapcsolat, azonban más esetekben pedig eldobódhat. Ez szerverek használatánál nem ajánlott, viszont független gépeknél kifizetõdõ lehet.</p></div><div class=paragraph><p>Most, miután beállítottuk a hálózati szolgáltatásokat, lépjünk vissza a lista elején található <span class=guimenuitem>X Exit</span> (Kilépés) menüpontra és folytassuk a beállítást a következõ opcióval, vagy egyszerûen az <span class=guimenuitem>X Exit</span> kétszeri kiválasztásával, majd a <b class=button>X Exit Install</b> (Kilépés a telepítõbõl) gomb lenyomásával lépjünk ki a sysinstall programból.</p></div></div><div class=sect3><h4 id=freebsdboot>2.10.16. A FreeBSD indulása<a class=anchor href=#freebsdboot></a></h4><div class=sect4><h5 id=freebsdboot-i386>2.10.16.1. A FreeBSD/i386 indulása<a class=anchor href=#freebsdboot-i386></a></h5><div class=paragraph><p>Ha minden remekült ment, a képernyõn lentrõl felfelé gördülõ üzeneteket fogunk látni, majd a rendszer várni fog tõlünk egy bejelentkezési nevet. A kiírt üzeneteket között a <kbd>Scroll Lock</kbd> lenyomása után a <kbd>PgUp</kbd> és <kbd>PgDn</kbd> billentyûk használatával tudunk lapozni. A <kbd>Scroll Lock</kbd> ismételt lenyomásával visszatérünk a bejelentkezéshez.</p></div><div class=paragraph><p>Nem minden esetben lesz látható az összes üzenet (a puffer végessége miatt), de miután bejelentkeztünk, ezeket a <code>dmesg</code> parancs kiadásával is megnézhetjük.</p></div><div class=paragraph><p>Bejelentkezni a telepítéskor megadott felhasználói név/jelszó párossal tudunk (a példában ez most <code>rpratt</code>). Lehetõleg ne jelentkezzünk be <code>root</code> felhasználóként!</p></div><div class=paragraph><p>A rendszer indításakor jellemzõen elõforduló üzenetek (a verzióra vonatkozó adatokat kihagytuk):</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>Copyright <span class=o>(</span>c<span class=o>)</span> 1992-2002 The FreeBSD Project.
Copyright <span class=o>(</span>c<span class=o>)</span> 1979, 1980, 1983, 1986, 1988, 1989, 1991, 1992, 1993, 1994
        The Regents of the University of California. All rights reserved.

Timecounter <span class=s2>&#34;i8254&#34;</span>  frequency 1193182 Hz
CPU: AMD-K6<span class=o>(</span>tm<span class=o>)</span> 3D processor <span class=o>(</span>300.68-MHz 586-class CPU<span class=o>)</span>
  Origin <span class=o>=</span> <span class=s2>&#34;AuthenticAMD&#34;</span>  Id <span class=o>=</span> 0x580  Stepping <span class=o>=</span> 0
  <span class=nv>Features</span><span class=o>=</span>0x8001bf&lt;FPU,VME,DE,PSE,TSC,MSR,MCE,CX8,MMX&gt;
  AMD <span class=nv>Features</span><span class=o>=</span>0x80000800&lt;SYSCALL,3DNow!&gt;
real memory  <span class=o>=</span> 268435456 <span class=o>(</span>262144K bytes<span class=o>)</span>
config&gt; di sn0
config&gt; di lnc0
config&gt; di le0
config&gt; di ie0
config&gt; di fe0
config&gt; di cs0
config&gt; di bt0
config&gt; di aic0
config&gt; di aha0
config&gt; di adv0
config&gt; q
avail memory <span class=o>=</span> 256311296 <span class=o>(</span>250304K bytes<span class=o>)</span>
Preloaded elf kernel <span class=s2>&#34;kernel&#34;</span> at 0xc0491000.
Preloaded userconfig_script <span class=s2>&#34;/boot/kernel.conf&#34;</span> at 0xc049109c.
md0: Malloc disk
Using <span class=nv>$PIR</span> table, 4 entries at 0xc00fde60
npx0: &lt;math processor&gt; on motherboard
npx0: INT 16 interface
pcib0: &lt;Host to PCI bridge&gt; on motherboard
pci0: &lt;PCI bus&gt; on pcib0
pcib1: &lt;VIA 82C598MVP <span class=o>(</span>Apollo MVP3<span class=o>)</span> PCI-PCI <span class=o>(</span>AGP<span class=o>)</span> bridge&gt; at device 1.0 on pci0
pci1: &lt;PCI bus&gt; on pcib1
pci1: &lt;Matrox MGA G200 AGP graphics accelerator&gt; at 0.0 irq 11
isab0: &lt;VIA 82C586 PCI-ISA bridge&gt; at device 7.0 on pci0
isa0: &lt;ISA bus&gt; on isab0
atapci0: &lt;VIA 82C586 ATA33 controller&gt; port 0xe000-0xe00f at device 7.1 on pci0
ata0: at 0x1f0 irq 14 on atapci0
ata1: at 0x170 irq 15 on atapci0
uhci0: &lt;VIA 83C572 USB controller&gt; port 0xe400-0xe41f irq 10 at device 7.2 on pci0
usb0: &lt;VIA 83C572 USB controller&gt; on uhci0
usb0: USB revision 1.0
uhub0: VIA UHCI root hub, class 9/0, rev 1.00/1.00, addr 1
uhub0: 2 ports with 2 removable, self powered
chip1: &lt;VIA 82C586B ACPI interface&gt; at device 7.3 on pci0
ed0: &lt;NE2000 PCI Ethernet <span class=o>(</span>RealTek 8029<span class=o>)&gt;</span> port 0xe800-0xe81f irq 9 at
device 10.0 on pci0
ed0: address 52:54:05:de:73:1b, <span class=nb>type </span>NE2000 <span class=o>(</span>16 bit<span class=o>)</span>
isa0: too many dependant configs <span class=o>(</span>8<span class=o>)</span>
isa0: unexpected small tag 14
fdc0: &lt;NEC 72065B or clone&gt; at port 0x3f0-0x3f5,0x3f7 irq 6 drq 2 on isa0
fdc0: FIFO enabled, 8 bytes threshold
fd0: &lt;1440-KB 3.5<span class=s2>&#34; drive&gt; on fdc0 drive 0
atkbdc0: &lt;keyboard controller (i8042)&gt; at port 0x60-0x64 on isa0
atkbd0: &lt;AT Keyboard&gt; flags 0x1 irq 1 on atkbdc0
kbd0 at atkbd0
psm0: &lt;PS/2 Mouse&gt; irq 12 on atkbdc0
psm0: model Generic PS/2 mouse, device ID 0
vga0: &lt;Generic ISA VGA&gt; at port 0x3c0-0x3df iomem 0xa0000-0xbffff on isa0
sc0: &lt;System console&gt; at flags 0x1 on isa0
sc0: VGA &lt;16 virtual consoles, flags=0x300&gt;
sio0 at port 0x3f8-0x3ff irq 4 flags 0x10 on isa0
sio0: type 16550A
sio1 at port 0x2f8-0x2ff irq 3 on isa0
sio1: type 16550A
ppc0: &lt;Parallel port&gt; at port 0x378-0x37f irq 7 on isa0
ppc0: SMC-like chipset (ECP/EPP/PS2/NIBBLE) in COMPATIBLE mode
ppc0: FIFO with 16/16/15 bytes threshold
ppbus0: IEEE1284 device found /NIBBLE
Probing for PnP devices on ppbus0:
plip0: &lt;PLIP network interface&gt; on ppbus0
lpt0: &lt;Printer&gt; on ppbus0
lpt0: Interrupt-driven port
ppi0: &lt;Parallel I/O&gt; on ppbus0
ad0: 8063MB &lt;IBM-DHEA-38451&gt; [16383/16/63] at ata0-master using UDMA33
ad2: 8063MB &lt;IBM-DHEA-38451&gt; [16383/16/63] at ata1-master using UDMA33
acd0: CDROM &lt;DELTA OTC-H101/ST3 F/W by OIPD&gt; at ata0-slave using PIO4
Mounting root from ufs:/dev/ad0s1a
swapon: adding /dev/ad0s1b as swap device
Automatic boot in progress...
/dev/ad0s1a: FILESYSTEM CLEAN; SKIPPING CHECKS
/dev/ad0s1a: clean, 48752 free (552 frags, 6025 blocks, 0.9% fragmentation)
/dev/ad0s1f: FILESYSTEM CLEAN; SKIPPING CHECKS
/dev/ad0s1f: clean, 128997 free (21 frags, 16122 blocks, 0.0% fragmentation)
/dev/ad0s1g: FILESYSTEM CLEAN; SKIPPING CHECKS
/dev/ad0s1g: clean, 3036299 free (43175 frags, 374073 blocks, 1.3% fragmentation)
/dev/ad0s1e: filesystem CLEAN; SKIPPING CHECKS
/dev/ad0s1e: clean, 128193 free (17 frags, 16022 blocks, 0.0% fragmentation)
Doing initial network setup: hostname.
ed0: flags=8843&lt;UP,BROADCAST,RUNNING,SIMPLEX,MULTICAST&gt; mtu 1500
        inet 192.168.0.1 netmask 0xffffff00 broadcast 192.168.0.255
        inet6 fe80::5054::5ff::fede:731b%ed0 prefixlen 64 tentative scopeid 0x1
        ether 52:54:05:de:73:1b
lo0: flags=8049&lt;UP,LOOPBACK,RUNNING,MULTICAST&gt; mtu 16384
        inet6 fe80::1%lo0 prefixlen 64 scopeid 0x8
        inet6 ::1 prefixlen 128
        inet 127.0.0.1 netmask 0xff000000
Additional routing options: IP gateway=YES TCP keepalive=YES
routing daemons:.
additional daemons: syslogd.
Doing additional network setup:.
Starting final network daemons: creating ssh RSA host key
Generating public/private rsa1 key pair.
Your identification has been saved in /etc/ssh/ssh_host_key.
Your public key has been saved in /etc/ssh/ssh_host_key.pub.
The key fingerprint is:
cd:76:89:16:69:0e:d0:6e:f8:66:d0:07:26:3c:7e:2d root@k6-2.example.com
 creating ssh DSA host key
Generating public/private dsa key pair.
Your identification has been saved in /etc/ssh/ssh_host_dsa_key.
Your public key has been saved in /etc/ssh/ssh_host_dsa_key.pub.
The key fingerprint is:
f9:a1:a9:47:c4:ad:f9:8d:52:b8:b8:ff:8c:ad:2d:e6 root@k6-2.example.com.
setting ELF ldconfig path: /usr/lib /usr/lib/compat /usr/X11R6/lib
/usr/local/lib
a.out ldconfig path: /usr/lib/aout /usr/lib/compat/aout /usr/X11R6/lib/aout
starting standard daemons: inetd cron sshd usbd sendmail.
Initial rc.i386 initialization:.
rc.i386 configuring syscons: blank_time screensaver moused.
Additional ABI support: linux.
Local package initialization:.
Additional TCP options:.

FreeBSD/i386 (k6-2.example.com) (ttyv0)

login: rpratt
Password:</span></code></pre></div></div><div class=paragraph><p>Az RSA és DSA kulcsok generálása a lassabb gépeken sokág is eltarthat, habár ez mindig csak a friss telepítések utáni elsõ indításkor történik meg. A rendszer késõbbi indulásai ettõl már gyorsabbak lesznek.</p></div><div class=paragraph><p>Ha X szervert is beállítottunk és választottunk hozzá egy alapértelmezett munkakörnyezetet, akkor ezt a parancssorból a <code>startx</code> kiadásával elindíthatjuk el.</p></div></div></div><div class=sect3><h4 id=shutdown>2.10.17. A FreeBSD leállítása<a class=anchor href=#shutdown></a></h4><div class=paragraph><p>Fontos, hogy mindig szabályosan állítsuk le az operációs rendszert, ne kapcsoljuk ki csak úgy egyszerûen a számítógépünket! A leállításhoz elõször a <code>su</code> parancs kiadásával, majd itt a <code>root</code> jelszavának megadásával vegyük fel az ehhez szükséges rendszeradminisztrátori jogosultságokat. Ez viszont csak abban az esetben fog mûködni, ha a felhasználónk tagja a <code>wheel</code> csoportnak. Minden más esetben egyszerûen jelentkezzünk be <code>root</code> felhasználóként és használjuk a <code>shutdown -h now</code> parancsot.</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>The operating system has halted.
Please press any key to reboot.</code></pre></div></div><div class=paragraph><p>A fenti üzenet jelzi, hogy a leállító parancs kiadása után már kikapcsolhatjuk a számítógépet, vagy ha ehelyett egy billentyût nyomunk le, akkor a gép újraindul.</p></div><div class=paragraph><p>A <span class=keyseq><kbd>Ctrl</kbd>+<kbd>Alt</kbd>+<kbd>Del</kbd></span> billentyûkombináció használatával is újra tudjuk indítani a rendszert, azonban ez normál mûködés közben nem ajánlott.</p></div></div></div><div class=sect2><h3 id=install-trouble>2.11. Hibakeresés<a class=anchor href=#install-trouble></a></h3><div class=paragraph><p>A most következõ szakaszban azokra a telepítés során felmerülõ problémákra próbálunk meg megoldásokat adni, amelyeket eddig már sokan jeleztek nekünk. Ezek mellett szerepel néhány kérdés és válasz is a FreeBSD és az MS-DOS® vagy Windows® közös használatáról.</p></div><div class=sect3><h4 id=_mit_tegyünk_ha_valami_nem_mûködik>2.11.1. Mit tegyünk ha valami nem mûködik<a class=anchor href=#_mit_tegyünk_ha_valami_nem_mûködik></a></h4><div class=paragraph><p>A PC architektúra különféle korlátozásai miatt szinte lehetetlen 100%-ban megbízhatóvá tenni az eszközök felderítését, azonban ennek hibája kapcsán néhány dolgot még tenni tudunk.</p></div><div class=paragraph><p>Ellenõrizzük a <a href=http://www.FreeBSD.org/releases/>Hardware Notes</a> (Hardverjegyzék) címû dokumentumban, hogy az adott hardvert a FreeBSD valóban ismeri.</p></div><div class=paragraph><p>Amennyiben a hardvereszközünket a rendszer ismeri, azonban még mindig jelentkeznek fagyások vagy egyéb gondok, készítenünk kell egy crosssref:kernelconfig[kernelconfig,saját rendszermag]ot. Ezzel olyan eszközök támogatását is beépíthetjük a rendszermagba, amelyek eredetileg nem szerepelnek a <span class=filename>GENERIC</span> rendszermagban. A telepítéshez készített rendszerindító lemezeken található rendszermag a legtöbb eszközt a gyári IRQ, IO-cím és DMA csatorna beállításaik mentén próbálja felkutatni. Ha viszont a hardverünket átállítottuk, ennek megfelelõen módosítanunk kell a rendszermag beállításait és újra kell fordítanunk, hogy a FreeBSD tudja, hol is keresse az eszközt.</p></div><div class=paragraph><p>Olyan is adódhat, hogy egy nem létezõ eszköz keresése egy utána keresendõ másik, jelenlevõ eszköz felkutatását akadályozza meg. Ilyenkor az ütközõ meghajtókat le kell tiltani.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Egyes problémák elkerülhetõek vagy csillapíthatóak a különbözõ hardverösszetevõk, különösen az alaplapi firmware frissítésével. Az alaplap firmware-jére sokszor csak BIOS-ként hivatkoznak, és a legtöbb alaplap- vagy számítógépgyártó honlapján találhatjuk meg ezeket, valamint a rájuk vonatkozó utasításokat.</p></div><div class=paragraph><p>A legtöbb gyártó azonban erõsen tiltakozik az alaplapi BIOS-frissítések ellen, és csak indokolt esetekben, például kritikus javításoknál javasolják. A frissítés kimenetele <em>lehet</em> rossz is, aminek következménye a BIOS tartós károsodása.</p></div></td></tr></tbody></table></div></div><div class=sect3><h4 id=_az_ms_dos_és_windows_állományrendszereinek_használata>2.11.2. Az MS-DOS® és Windows® állományrendszereinek használata<a class=anchor href=#_az_ms_dos_és_windows_állományrendszereinek_használata></a></h4><div class=paragraph><p>A FreeBSD jelenleg nem támogatja a Double Space™ alkalmazással tömörített állományrendszereket, ezért a FreeBSD csak úgy tud az adataihoz hozzáférni, ha elõtte kitömörítjük ezeket. Ezt a <span class=guimenuitem>Start</span> menü <span class=guimenuitem>Programs</span> (Programok) > <span class=guimenuitem>System Tools</span> (Rendszereszközök) menüjében található Compression Agent (Lemeztömörítés) elindításával tehetjük meg.</p></div><div class=paragraph><p>A FreeBSD támogatja az MS-DOS® alapú (gyakran csak FAT típusúnak nevezett) állományrendszereket. A <a href="https://man.freebsd.org/cgi/man.cgi?query=mount_msdosfs&amp;sektion=8&amp;format=html">mount_msdosfs(8)</a> parancs segítségével az ilyen rendszerek könnyedén becsatlakoztathatók a már létezõ könyvtárszerkezetbe, amivel így el tudjuk érni a tartalmát. A <a href="https://man.freebsd.org/cgi/man.cgi?query=mount_msdosfs&amp;sektion=8&amp;format=html">mount_msdosfs(8)</a> programot általában nem közvetlenül hívjuk meg, hanem az <span class=filename>/etc/fstab</span> vagy a <a href="https://man.freebsd.org/cgi/man.cgi?query=mount&amp;sektion=8&amp;format=html">mount(8)</a> segédprogram megfelelõ paraméterezésével.</p></div><div class=paragraph><p>Az <span class=filename>/etc/fstab</span> állományban általában így néz ki egy ilyen sor:</p></div><div class="literalblock programlisting"><div class=content><pre>/dev/ad0sN  /dos	msdosfs rw 0 0</pre></div></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>A mûvelet végrehajtásához a <span class=filename>/dos</span> könyvtárnak már léteznie kell. Az <span class=filename>/etc/fstab</span> pontos formátumával kapcsolatban a <a href="https://man.freebsd.org/cgi/man.cgi?query=fstab&amp;sektion=5&amp;format=html">fstab(5)</a> man oldalt olvassuk el.</p></div></td></tr></tbody></table></div><div class=paragraph><p>Az MS-DOS® állományrendszerek esetében a <a href="https://man.freebsd.org/cgi/man.cgi?query=mount&amp;sektion=8&amp;format=html">mount(8)</a> parancsot többnyire így adjuk ki:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># mount -t msdosfs /dev/ad0s1 /mnt</span></code></pre></div></div><div class=paragraph><p>Ebben a példában a MS-DOS® állományrendszer az elsõdleges merevlemez elsõ partícióján helyezkedik el. A mi helyzetünk ettõl eltérõ lehet, ezért ehhez vizsgáljuk meg a <code>dmesg</code> és <code>mount</code> parancsok kimeneteit. Segítségükkel elegendõ információt tudunk összeszedni a gépünkön található partíciók kiosztásáról.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Elõfordulhat, hogy a FreeBSD a többi operációs rendszertõl eltérõ módon számozza a slice-okat (vagyis az MS-DOS® partíciókat). Konkrétan: a kiterjesztett MS-DOS® partíciók általában nagyobb sorszámot kapnak, mint az elsõdleges MS-DOS® partíciók. Az <a href="https://man.freebsd.org/cgi/man.cgi?query=fdisk&amp;sektion=8&amp;format=html">fdisk(8)</a> segédprogram segíthet megállapítani, hogy mely slice-ok tartoznak a FreeBSD-hez és melyek más operációs rendszerekhez.</p></div></td></tr></tbody></table></div><div class=paragraph><p>A <a href="https://man.freebsd.org/cgi/man.cgi?query=mount_ntfs&amp;sektion=8&amp;format=html">mount_ntfs(8)</a> parancs használatával az NTFS partíciók hasonló módon csatlakoztathatóak.</p></div></div><div class=sect3><h4 id=_kérdések_és_válaszok>2.11.3. Kérdések és válaszok<a class=anchor href=#_kérdések_és_válaszok></a></h4><div class=sect4><h5 id=_a_rendszerem_teljesen_leáll_amikor_az_indítás_során_eszközöket_próbál_megtalálni_vagy_furcsán_viselkedik_a_telepítés_során_esetleg_a_floppy_meghajtót_nem_is_keresi>2.11.3.1. A rendszerem teljesen leáll amikor az indítás során eszközöket próbál megtalálni, vagy furcsán viselkedik a telepítés során, esetleg a floppy meghajtót nem is keresi.<a class=anchor href=#_a_rendszerem_teljesen_leáll_amikor_az_indítás_során_eszközöket_próbál_megtalálni_vagy_furcsán_viselkedik_a_telepítés_során_esetleg_a_floppy_meghajtót_nem_is_keresi></a></h5><div class=paragraph><p>A FreeBSD az i386, amd64 és ia64 platformokon az indítás közben az eszközök felderítésében erõsen építkeznek a rendszeren elérhetõ ACPI szolgáltatásra. Sajnos még mindig vannak hibák az ACPI meghajtóban, az alaplapokban és a BIOS-okban. A rendszerbetöltõ harmadik fokozatában viszont az <code>hint.acpi.0.disabled</code> megadásával kikapcsolható az ACPI használata:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell> <span class=nb>set </span>hint.acpi.0.disabled<span class=o>=</span><span class=s2>&#34;1&#34;</span></code></pre></div></div><div class=paragraph><p>Ez a beállítás a rendszer minden egyes indításakor törlõdik, ezért a <code>hint.acpi.0.disabled="1"</code> bejegyzést fel kell vennünk a <span class=filename>/boot/loader.conf</span> állományba. A rendszerbetöltõ mûködésérõl részletesebben a <a href=./#boot-synopsis>Áttekintés</a>ban olvashatunk.</p></div></div><div class=sect4><h5 id=_a_freebsd_telepítése_után_elõször_indítom_el_a_merevlemezrõl_a_rendszert_a_rendszermag_betöltõdik_és_nekilát_felkutatni_a_hardvereszközöket_azonban_megáll_a_következõ_üzenettel>2.11.3.2. A FreeBSD telepítése után elõször indítom el a merevlemezrõl a rendszert, a rendszermag betöltõdik és nekilát felkutatni a hardvereszközöket, azonban megáll a következõ üzenettel:<a class=anchor href=#_a_freebsd_telepítése_után_elõször_indítom_el_a_merevlemezrõl_a_rendszert_a_rendszermag_betöltõdik_és_nekilát_felkutatni_a_hardvereszközöket_azonban_megáll_a_következõ_üzenettel></a></h5><div class=paragraph><p>Ez egy régóta fennálló probléma olyan rendszerek esetén, ahol a rendszerindításhoz használt lemez nem az elsõ. A BIOS a FreeBSD-tõl eltérõ sorszámozást használ, és az általa alkalmazott megfeleltetések megfejtése nehézkes.</p></div><div class=paragraph><p>Amikor a rendszer indítására használt lemez nem az elsõ lemez a rendszerünkben, segítenünk kell a FreeBSD-nek a megtalálásában. Két gyakori helyzet alakulhat ki, és mind a kettõben el kell árulnunk a FreeBSD-nek, hogy hol található a rendszer indításához használható gyökér állományrendszer. Ezt a lemez BIOS-ban nyilvántartott sorszámának, típusának és a neki megfelelõ FreeBSD szerinti lemezszám megadásával tehetjük meg.</p></div><div class=paragraph><p>Az elsõ szituációban két IDE-lemezünk van, mind a kettõt masterként állítottuk be a hozzájuk tartozó IDE-buszokon, és a közülük a másodikról akarjuk indítani a FreeBSD-t. A BIOS ezeket 0. és 1. lemezként látja, miközben a FreeBSD pedig <span class=filename>ad0</span> és <span class=filename>ad2</span> eszközként.</p></div><div class=paragraph><p>A FreeBSD 1. BIOS-számozású lemezen van, amelynek a típusa <code>ad</code> és a FreeBSD szerinti a 2 sorszámot viseli. Ezért ezt kell használnunk:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell> 1:ad<span class=o>(</span>2,a<span class=o>)</span>kernel</code></pre></div></div><div class=paragraph><p>Ha az elsõdleges buszon van egy slave meghajtónk, akkor mindez nem szükséges (és valószínûleg rossz is).</p></div><div class=paragraph><p>A második szituációban egy SCSI-lemezrõl akarjuk indítani a rendszert, miközben egy vagy több IDE-lemez is található a gépünkben. Ebben az esetben a FreeBSD szerinti sorszám kisebb lesz, mint a BIOS szerinti. Ha tehát a két IDE-lemezünk mellett van még egy SCSI-lemez is, akkor annak a BIOS szerinti sorszáma 2, a típusa <code>da</code> és a FreeBSD szerinti sorszáma pedig 0. Ennek megfelelõen a</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell> 2:da<span class=o>(</span>0,a<span class=o>)</span>kernel</code></pre></div></div><div class=paragraph><p>sorral tudjuk elárulni a FreeBSD-nek, hogy a BIOS szerint 2. lemezrõl akarjuk indítani, amely a rendszerben található elsõ SCSI-lemeznek felel meg. Ha csak egy IDE-lemezünk van, akkor a sort kezdjük az <code>1:</code> beírásával.</p></div><div class=paragraph><p>Miután megtaláltuk a megfelelõ értékeket, a hozzá tartozó sort egy szövegszerkesztõ segítségével tegyük közvetlenül a <span class=filename>/boot.config</span> állományba. A FreeBSD ezen állomány tartalmát fogja alapból felhasználni a <code>boot:</code> bekérésénél, hacsak másképpen nem utasítjuk.</p></div></div><div class=sect4><h5 id=_a_telepítés_után_elõször_próbálom_meg_elindítani_a_merevlemezrõl_a_freebsd_t_azonban_a_rendszerválasztó_mindig_csak_f_opciókat_kínál_fel_és_a_rendszer_indítása_sem_halad_tovább>2.11.3.3. A telepítés után elõször próbálom meg elindítani a merevlemezrõl a FreeBSD-t, azonban a rendszerválasztó mindig csak F? opciókat kínál fel, és a rendszer indítása sem halad tovább.<a class=anchor href=#_a_telepítés_után_elõször_próbálom_meg_elindítani_a_merevlemezrõl_a_freebsd_t_azonban_a_rendszerválasztó_mindig_csak_f_opciókat_kínál_fel_és_a_rendszer_indítása_sem_halad_tovább></a></h5><div class=paragraph><p>A FreeBSD telepítése során rosszul adtunk meg a partíciószerkesztõben a merevlemezhez tartozó geometriát. Menjünk vissza a partíciószerkesztõhöz és adjuk meg újra a merevlemezünk helyes geometriáját. Ennek használatához pedig a FreeBSD-t is újra kell telepítenünk.</p></div><div class=paragraph><p>Ha egyáltalán képtelenek vagyunk megállapítani a merevlemezhez tartozó geometriát, akkor próbáljuk meg ezt: a lemez elején hozzunk létre egy kis méretû DOS partíciót és rakjuk utána a FreeBSD-t. Amikor a telepítõprogram észreveszi a DOS partíciót, megpróbálja magától kikövetkeztetni belõle a helyes geometriát, ami általában mûködik is.</p></div><div class=paragraph><p>Ez a tanács ugyan már nem érvényes, de álljon itt felvilágosításként:</p></div><div class="paragraph blockquote"><p>Ha teljesen egy FreeBSD alapú szerver vagy munkaállomás kialakítására szánjuk a számítógépünket, és nem törõdünk a DOS-szal, Linuxszal és a többi operációs rendszerrel történõ (jövõbeli) kompatibilitással, használhatjuk akár az egész lemezt is (a partíciószerkesztõben ez az <span class=guimenuitem>A</span> opció). Ezzel egy olyan nem szabványos beállítást engedélyezünk, amivel a FreeBSD elfoglalja a lemezt annak legelsõ szektorától a legutolsó szektoráig. Ilyenkor ugyan el tudunk tekinteni a geometriával kapcsolatos beállításoktól, azonban így a FreeBSD-n kívül semmilyen más operációs rendszert nem tudunk majd futtatni a gépen.</p></div></div><div class=sect4><h5 id=_a_rendszer_megtalálja_a_ed4_hálózati_kártyámat_azonban_folyamatosan_hibát_ad_idõtúllépésre_hivatkozva>2.11.3.4. A rendszer megtalálja a <a href="https://man.freebsd.org/cgi/man.cgi?query=ed&amp;sektion=4&amp;format=html">ed(4)</a> hálózati kártyámat, azonban folyamatosan hibát ad idõtúllépésre hivatkozva.<a class=anchor href=#_a_rendszer_megtalálja_a_ed4_hálózati_kártyámat_azonban_folyamatosan_hibát_ad_idõtúllépésre_hivatkozva></a></h5><div class=paragraph><p>Az említett kártya valószínûleg a <span class=filename>/boot/device.hints</span> állományban beállítottaktól eltérõ IRQ-t használ. A <a href="https://man.freebsd.org/cgi/man.cgi?query=ed&amp;sektion=4&amp;format=html">ed(4)</a> meghajtó alapértelmezés szerint nem használ "szoftveres" beállításokat (amiket DOS-ban az EZSETUP használatával adunk meg), viszont engedélyezhetjük, ha a kártyánál megadjuk az <code>-l</code> beállítást.</p></div><div class=paragraph><p>Hardveresen ezt a kártyán levõ jumperek segítségével állíthatjuk be (ehhez változtassuk meg a rendszermag beállításait is, amennyiben szükséges), vagy a <code>-l</code> kapcsolón keresztül a <code>hint.ed.0.irq="-l"</code> megadásával utasíthatjuk a rendszermagot az IRQ szoftveres beállítására.</p></div><div class=paragraph><p>Másik lehetõség, amikor a kártyánk a 9-es IRQ-t használja, amelyet általában megosztanak a 2-es IRQ-val, ami gyakori problémák forrása (különösen abban az esetben, amikor a VGA kártya a 2-es IRQ-t használja!) lehet. Lehetõleg ne használjuk a 2-es és 9-es IRQ-kat.</p></div></div><div class=sect4><h5 id=_amikor_a_sysinstall_programot_egy_x11_terminálban_futtatom_a_sárga_színû_betûket_viszonylag_nehéz_olvasni_a_világosszürke_háttérrel_esetleg_lehet_valahogy_növelni_a_kontrasztotszínek_kontraszt_az_alkalmazás_használatakor>2.11.3.5. Amikor a sysinstall programot egy X11 terminálban futtatom, a sárga színû betûket viszonylag nehéz olvasni a világosszürke háttérrel. Esetleg lehet valahogy növelni a kontrasztotszínek kontraszt az alkalmazás használatakor?<a class=anchor href=#_amikor_a_sysinstall_programot_egy_x11_terminálban_futtatom_a_sárga_színû_betûket_viszonylag_nehéz_olvasni_a_világosszürke_háttérrel_esetleg_lehet_valahogy_növelni_a_kontrasztotszínek_kontraszt_az_alkalmazás_használatakor></a></h5><div class=paragraph><p>Ha az X11 telepítése után a sysinstall által választott színekkel nem olvasható a szöveg <a href="https://man.freebsd.org/cgi/man.cgi?query=xterm&amp;sektion=1&amp;format=html">xterm(1)</a> vagy <a href="https://man.freebsd.org/cgi/man.cgi?query=rxvt&amp;sektion=1&amp;format=html">rxvt(1)</a> terminálokban, akkor vegyük fel a következõ sort a felhasználói könyvtárunkban levõ <span class=filename>.Xdefaults</span> konfigurációs állományunkba: <code>XTerm*color7:#c0c0c0</code>. Ezzel majd egy sötétebb szürke hátteret kapunk.</p></div></div></div></div><div class=sect2><h3 id=install-advanced>2.12. Telepítési útmutató haladóknak<a class=anchor href=#install-advanced></a></h3><div class=paragraph><p>Ebben a szakaszban megtudhatjuk, hogyan telepítsük a FreeBSD-t speciális esetekben.</p></div><div class=sect3><h4 id=headless-install>2.12.1. A FreeBSD telepítése billentyûzet vagy monitor nélkül<a class=anchor href=#headless-install></a></h4><div class=paragraph><p>A telepítés ezen fajtáját "fej nélküli telepítésnek" (headless install) hívják, mivel a gép, amire a FreeBSD-t telepíteni akarjuk, nem rendelkezik monitorral vagy éppen még VGA kimenettel sem. Felmerülhet a kérdés: hogyan lehetséges mindez? A soros vonali konzol használatával! A soros konzol segítségével lényegében egy másik számítógép monitorját és billentyûzetét használjuk. Ennek megvalósításához elsõként kövessük a rendszerindító pendrive készítésének <a href=#install-boot-media>Készítsünk egy rendszerindító lemezt</a>ban leírt lépéseit, vagy töltsük le a megfelelõ ISO image-et a telepítéshez, lásd <a href=#install-cdrom>Telepítõ CD készítése</a>.</p></div><div class=paragraph><p>A következõ lépésekkel tehetjük képessé a soros konzolon keresztüli rendszerindításra: (CD-lemez használata esetén az elsõ lépésre nincs szükség)</p></div><div class="exampleblock procedure"><div class=content><div class="olist arabic"><ol class=arabic><li><p>A rendszerindító pendrive átállítása soros konzolra</p><div class=paragraph><p>Ha a korábban elõkészített pendrive-val most csak egyszerûen elindítanánk a FreeBSD-t, akkor a megszokott telepítési módban indulna el. Mi viszont azt akarjuk, hogy a telepítéshez a FreeBSD a soros konzolon keresztül induljon el. Ehhez csatlakoztassuk az eszközt a számítógéphez, valamint a <a href="https://man.freebsd.org/cgi/man.cgi?query=mount&amp;sektion=8&amp;format=html">mount(8)</a> paranccsal FreeBSD rendszerünkhöz pedig a hozzátartozó állományrendszert.</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># mount /dev/da0a /mnt</span></code></pre></div></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>A konkrét eszköznevet és csatlakozási pontot módosítsuk a saját környezetünknek megfelelõen.</p></div></td></tr></tbody></table></div><div class=paragraph><p>Most, miután már fizikailag és logikailag is csatlakoztattuk a pendrive-ot, be kell állítanunk a soros konzol használatára rendszerindítás közben. Ehhez egy <span class=filename>loader.conf</span> nevû állományt kell elhelyeznünk a pendrive állományrendszerén a soros konzolra (mint rendszerkonzolra) vonatkozó beállítással:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># echo &#39;console=&#34;comconsole&#34;&#39; &gt;&gt; /mnt//boot/loader.conf</span></code></pre></div></div><div class=paragraph><p>Miután a pendrive-on sikeresen elvégeztük a szükséges beállítást, válasszuk le a <a href="https://man.freebsd.org/cgi/man.cgi?query=umount&amp;sektion=8&amp;format=html">umount(8)</a> parancs kiadásával:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># umount /mnt</span></code></pre></div></div><div class=paragraph><p>Most már leválaszthatjuk a pendrive-ot, és ugorjunk közvetlenül a harmadik lépésre.</p></div></li><li><p>A null-modem kábel csatlakoztatása</p><div class=paragraph><p>Össze kell kötnünk a két számítógépet egy <a href=./#term-cables-null>null-modem kábel</a>lel. Nincs más teendõnk, mit összekapcsolni a két gép soros portjait. <em>Itt a szokásos soros kábel nem mûködik</em>, konkrétan null-modem kábelre van szükség, mivel benne néhány vezetéket máshogy kötöttek be.</p></div></li><li><p>A telepítõ CD beállítása soros konzolra</p><div class=paragraph><p>Ha a telepítésre szánt ISO image-bõl készített lemezzel (lásd <a href=#install-cdrom>Telepítõ CD készítése</a>) a FreeBSD normál módban indul el. A soros konzol használatához viszont kibontani, módosítani és újragenerálni kell az adott image-et mielõtt lemezre írnánk.</p></div><div class=paragraph><p>A korábban, például a <span class=filename>FreeBSD-8.1-RELEASE-i386-disc1.iso</span> néven letöltött image-bõl a <a href="https://man.freebsd.org/cgi/man.cgi?query=tar&amp;sektion=1&amp;format=html">tar(1)</a> segédprogrammal tudjuk kinyerni a benne tárolt összes állományt:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># mkdir /a/hasznalt/iso/helye</span>
<span class=c># tar -C /a/hasznalt/iso/helye -pxvf FreeBSD-8.1-RELEASE-i386-disc1.iso</span></code></pre></div></div><div class=paragraph><p>Ezt követõen módosítanunk kell a telepítõlemezt a soros konzol használatára. Ehhez egy <span class=filename>loader.conf</span> állományt kell hozzáadnunk a kibontott ISO image tartalmához. Ebben állítjuk be a soros konzolt rendszerkonzolnak:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># echo &#39;console=&#34;comconsole&#34;&#39; &gt;&gt; /a/hasznalt/iso/helye/boot/loader.conf</span></code></pre></div></div><div class=paragraph><p>Ezután készítsünk egy új ISO image-et a módosított tartalom alapján. Ehhez a <a class=package href=https://cgit.freebsd.org/ports/tree/sysutils/cdrtools/>sysutils/cdrtools</a> port részeként elérhetõ <a href="https://man.freebsd.org/cgi/man.cgi?query=mkisofs&amp;sektion=8&amp;format=html">mkisofs(8)</a> segédprogramot használjuk:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># mkisofs -v -b boot/cdboot -no-emul-boot -r -J -V &#34;soroskonzolos&#34; -o soroskonzolos-FreeBSD-8.1-RELEASE-i386-disc1.iso /a/hasznalt/iso/helye</span></code></pre></div></div><div class=paragraph><p>Most már van egy megfelelõen összeállított ISO image-ünk, amelyet CD-lemezre tudunk írni a kedvenc CD-író alkalmazásunkkal.</p></div></li><li><p>A telepítés indítása</p><div class=paragraph><p>Most már ideje elkezdeni a telepítést. Tegyük a <span class=filename>boot.flp</span> image-et tartalmazó lemezt a fej nélkül telepítendõ gép meghajtójába és kapcsoljuk be.</p></div></li><li><p>Kapcsolódás a fej nélküli gépre</p><div class=paragraph><p>Ezután a <a href="https://man.freebsd.org/cgi/man.cgi?query=cu&amp;sektion=1&amp;format=html">cu(1)</a> parancs felhasználásával kapcsolódjunk rá a gépre:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># cu -l /dev/cuau0</span></code></pre></div></div><div class=paragraph><p>Ezt FreeBSD 7.<em>X</em> esetén így kell használnunk:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># cu -l /dev/cuad0</span></code></pre></div></div></li></ol></div></div></div><div class=paragraph><p>Ezzel készen is vagyunk! Innentõl a <code>cu</code> által megnyitott kapcsolaton keresztül tudjuk vezérelni a fej nélküli számítógépet. Hamarosan betölti a rendszermagot, majd megkérdezi a használt terminál típusát. Itt válasszuk ki a színes FreeBSD konzolt (FreeBSD color console) és folytassuk a telepítést a megszokott módon.</p></div></div></div><div class=sect2><h3 id=install-diff-media>2.13. Saját telepítõeszköz elkészítése<a class=anchor href=#install-diff-media></a></h3><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Az ismétlések elkerülése végett a továbbiakban a "FreeBSD lemez" a megvásárolható vagy a magunk által készített FreeBSD CD-re vagy DVD-re vonatkozik.</p></div></td></tr></tbody></table></div><div class=paragraph><p>Adódhatnak olyan esetek, amikor létre kell hoznunk a FreeBSD telepítésére használt saját eszközünket és/vagy forrásunkat. Ez lehet egy tetszõleges fizikai eszköz, például szalag, vagy bármilyen olyan forrás, ahonnan a sysinstall képes állományokat elérni, például egy FTP oldal vagy egy MS-DOS® partíció.</p></div><div class=paragraph><p>Például:</p></div><div class=ulist><ul><li><p>Egy FreeBSD lemezünk van és több hálózaton kapcsolódó számítógépünk. Készíteni akarunk egy helyi FTP oldalt a FreeBSD lemez felhasználásával, és így a hálózaton levõ gépre az internet helyett innen telepítjük a rendszert.</p></li><li><p>Van egy FreeBSD lemezünk, azonban a FreeBSD-nek nem sikerült felismernie a CD/DVD-meghajtónkat, viszont az MS-DOS®/Windows®-nak igen. Felmásoljuk a FreeBSD telepítéséhez használt állományokat ugyanazon a számítógépen található egyik DOS partícióra, majd a FreeBSD-t ezekkel telepítjük.</p></li><li><p>A gépben, amelyre telepíteni akarunk, nincs CD/DVD-meghajtó vagy hálózati kártya, viszont "Laplink stílusú" soros vagy párhuzamos kábellel hozzá tudunk kapcsolódni egy olyan számítógéprõl, amelyben viszont van.</p></li><li><p>Készíteni akarunk a FreeBSD telepítésére használható szalagot.</p></li></ul></div><div class=sect3><h4 id=install-cdrom>2.13.1. Telepítõ CD készítése<a class=anchor href=#install-cdrom></a></h4><div class=paragraph><p>A FreeBSD Projekt minden kiadás részeként architektúránként elérhetõvé tesz legalább két CD image-et ("ISO image-et"). Ha rendelkezünk CD-íróval, ezeket az image-eket fel-, illetve ki tudjuk írni ("égetni") CD-re, és a FreeBSD telepítésére tudjuk használni. Tehát ha van a kezünk ügyében CD-író és olcsón jutunk nagyobb sebességû interneteléréshez, akkor a FreeBSD telepítésének ez a legkönnyebb módja.</p></div><div class="exampleblock procedure"><div class=content><div class="olist arabic"><ol class=arabic><li><p>A megfelelõ ISO image-ek letöltése</p><div class=paragraph><p>Az egyes kiadások ISO image-ei letölthetõek a <span class=filename><a href=ftp://ftp.FreeBSD.org/pub/FreeBSD/ISO-IMAGES-architektúra/változat class=bare>ftp://ftp.FreeBSD.org/pub/FreeBSD/ISO-IMAGES-architektúra/változat</a></span> címrõl vagy annak legközelebbi tükrözésérõl. Az <em>architektúra</em> és <em>változat</em> részeket igényeinknek megfelelõen helyettesítsük.</p></div><div class=paragraph><p>Az említett könyvtár általában a következõ lemezek image-eit tartalmazza:</p></div><table class="tableblock frame-none grid-all stretch"><caption class=title>Táblázat 4. FreeBSD 7.<em>X</em> és 8.<em>X</em> ISO image-ek nevei és jelentései</caption><col style=width:50%><col style=width:50%><thead><tr><th class="tableblock halign-left valign-top">Állománynév</th><th class="tableblock halign-left valign-top">Tartalom</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class=tableblock><span class=filename>FreeBSD-változat-RELEASE-architektúra-bootonly.iso</span></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Ezzel a CD image-dzsel tudjuk a FreeBSD CD-meghajtóról indításával elkezdeni a telepítést. Fontos tudnunk azonban, hogy ez az image nem tartalmazza a FreeBSD telepítéséhez szükséges komponenseket. Ezt a rendszer indítása után hálózaton keresztül (például egy FTP szerver segítségével) tudjuk megtenni.</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><span class=filename>FreeBSD-változat-RELEASE-architektúra-dvd1.iso.gz</span></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Ez a DVD image minden, az alap FreeBSD rendszer telepítéséhez szükséges komponenst tartalmaz, bináris csomagokkal és dokumentációval együtt. Ezenkívül még "élõ" rendszert is tudunk indítani vele, közvetlenül a lemezrõl.</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><span class=filename>FreeBSD-változat-RELEASE-architektúra-memstick.img</span></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Ez az image egy USB pendrive-ra írható, és minden olyan számítógépen használható, amely képes ilyen eszközrõl elindulni. Támogatja az "élõ" módot is, amellyel rendszerünket állíthatjuk helyre. Ez az image nem érhetõ el FreeBSD 7.3 vagy korábbi rendszerek esetén.</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><span class=filename>FreeBSD-változat-RELEASE-architektúra-disc1.iso</span></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Ez az image tartalmazza az alap FreeBSD operációs rendszert és a hozzá tartozó dokumentációt, de semmilyen más további csomagot nem.</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><span class=filename>FreeBSD-változat-RELEASE-architektúra-disc2.iso</span></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Ezen az image-en bináris csomagok találhatóak. Ilyen a FreeBSD 8.0 és az utána következõ változatoknál már nincs.</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><span class=filename>FreeBSD-változat-RELEASE-architektúra-disc3.iso</span></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Ez egy másik image, amelyen szintén bináris csomagok találhatóak. Ilyen a FreeBSD 8.0 és az utána következõ változatoknál már nincs.</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><span class=filename>FreeBSD-változat-RELEASE-architektúra-docs.iso</span></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>A FreeBSD dokumentációja.</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><span class=filename>FreeBSD-változat-RELEASE-architektúra-livefs.iso</span></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Ez az image a rendszerhelyreállításhoz használt "élõ" indítási módot támogatja, telepítést alapvetõen nem lehet vele végezni.</p></td></tr></tbody></table><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>A FreeBSD 7.3 és a FreeBSD 8.1 elõtti 7.<em>X</em>, illetve 8.<em>X</em> kiadások egy ettõl eltérõ elnevezési sémát követnek: a hozzájuk tartozó ISO image-ek neveiben nem szerepel a <code>FreeBSD-</code> elõtag.</p></div></td></tr></tbody></table></div><div class=paragraph><p>Le <em>kell</em> töltenünk az elsõ lemez vagy (ha elérhetõ) a <code>bootonly</code> lemez ISO image-einek egyikét. A kettõt egyszerre viszont ne töltsük le, mivel a <code>disc1</code> image tartalmaz mindent, ami a <code>bootonly</code> image-en megtalálható.</p></div><div class=paragraph><p>Akkor használjuk a <code>bootonly</code> jelzésû image-et, ha szélessávú interneteléréssel rendelkezünk. Segítségével el tudjuk kezdeni a FreeBSD telepítését, és szükség szerint a port/csomagrendszer (lásd <a href=./#ports>Alkalmazások telepítése. csomagok és portok</a>) használatával csomagokat tudunk letölteni és telepíteni.</p></div><div class=paragraph><p>A DVD image-ét (<code>dvd1</code>) akkor érdemes használni, ha a FreeBSD adott kiadásának telepítése mellett igényt tartunk valamennyi csomagra is.</p></div><div class=paragraph><p>A további lemezek image-ei is hasznosak lehetnek, de nem feltétlenül kellenek a telepítéshez, fõleg abban az esetben, amikor gyors interneteléréssel rendelkezünk.</p></div></li><li><p>A CD-k írása</p><div class=paragraph><p>Ezután lemezekre kell írnunk a letöltött image-eket. Amennyiben ezt egy másik FreeBSD rendszeren végezzük, ennek részleteirõl a <a href=./#creating-cds>Lézeres tárolóeszközök (CD-k) létrehozása és használata</a> számol be (különösen a <a href=./#burncd>burncd</a> és a <a href=./#cdrecord>cdrecord</a> leírása).</p></div><div class=paragraph><p>Ha másik platformon végezzük ezt a mûveletet, akkor az adott platformon felkínált CD-író szoftverekkel kell dolgoznunk. Az image-ek szabványos ISO formátumúak, amelyet szinte az összes CD-író alkalmazás ismer.</p></div></li></ol></div></div></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Ha kíváncsiak vagyunk egy saját FreeBSD kiadás elkészítésére, olvassuk el a <a href=https://docs.freebsd.org/en/articles/releng/>kiadások szervezésérõl szóló cikket (angolul)</a>.</p></div></td></tr></tbody></table></div></div><div class=sect3><h4 id=install-ftp>2.13.2. Helyi FTP oldal létrehozása FreeBSD lemezzel<a class=anchor href=#install-ftp></a></h4><div class=paragraph><p>A FreeBSD lemezeken az FTP oldalakéhoz hasonló elrendezést találunk. Ez megkönnyíti a hálózatunkban található számítógépekhez a FreeBSD telepítésére használható helyi FTP oldal létrehozását.</p></div><div class="exampleblock procedure"><div class=content><div class="olist arabic"><ol class=arabic><li><p>Az FTP oldalnak otthont adó FreeBSD számítógépen tegyük a CD-t a meghajtóba, majd csatlakoztassuk a <span class=filename>/cdrom</span> könyvtárba.</p><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># mount /cdrom</span></code></pre></div></div></li><li><p>Hozzunk létre egy anonim FTP hozzáférést az <span class=filename>/etc/passwd</span> állományban. A <a href="https://man.freebsd.org/cgi/man.cgi?query=vipw&amp;sektion=8&amp;format=html">vipw(8)</a> segítségével tehát illesszük be a következõ sort az <span class=filename>/etc/passwd</span> állományba:</p><div class="literalblock programlisting"><div class=content><pre>ftp:*:99:99::0:0:FTP:/cdrom:/nonexistent</pre></div></div></li><li><p>Gondoskodjuk róla, hogy az FTP szolgáltatás engedélyezve legyen az <span class=filename>/etc/inetd.conf</span> állományban.</p></li></ol></div></div></div><div class=paragraph><p>Most már bárki, aki képes csatlakozni ehhez a számítógéphez, a telepítés típusának ki tudja választani az FTP-t. Az FTP oldalak menüjében válassza az "Other" (Egyéb) pontot, majd adja meg az <code><a href=ftp://gépnév class=bare>ftp://gépnév</a></code> címet.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Ha az FTP-n csatlakozó kliensek rendszerindításhoz használt eszköze (általában a floppy) verziója nem egyezik meg tökéletesen a helyi FTP oldalon találhatóval, akkor a sysinstall nem engedi a telepítést. Ha a változatok nem hasonlóak és ezt felül akarjuk bírálni, akkor be kell lépnünk az <b class=menuref>Options</b> (Beállítások) menübe, ahol át kell állítanunk a terjesztés nevét (distribution name) <span class=guimenuitem>any</span> (bármelyik)-re.</p></div></td></tr></tbody></table></div><div class="admonitionblock warning"><table><tbody><tr><td class=icon><i class="fa icon-warning" title=Warning></i></td><td class=content><div class=paragraph><p>A fenti megközelítés kizárólag csak egy tûzfallal védett helyi hálózaton javasolt. FTP szolgáltatás létrehozása az interneten (és nem a helyi hálózatunkban) levõ számítógépek számára különbözõ támadásoknak és egyéb kellemetlenségeknek teszi ki a számítógépünket. Határozottan javasoljuk, hogy ebben az esetben különösen ügyeljünk a biztonságra.</p></div></td></tr></tbody></table></div></div><div class=sect3><h4 id=_telepítõfloppyk_létrehozása>2.13.3. Telepítõfloppyk létrehozása<a class=anchor href=#_telepítõfloppyk_létrehozása></a></h4><div class=paragraph><p>Ha floppylemezrõl kellene telepítenünk (amit viszont <em>semmiképpen sem</em> ajánlanánk) egy nem támogatott hardvereszköz miatt, vagy mert egyszerûen szeretjük a dolgok nehezebbik oldalát megfogni, akkor ehhez elõször elõ kell készítenünk pár lemezt.</p></div><div class=paragraph><p>Legalább annyi 1,44 MB-os lemezre van szükségünk, mint amennyire ráférnek a <span class=filename>base</span> (alapterjesztés) könyvtárban található állományok. Ha DOS-ban hozzuk létre ezeket a lemezeket, akkor a használatukhoz meg <em>kell</em> formázni ezeket az MS-DOS® <code>FORMAT</code> parancsával. Windows® használata esetén az Windows Explorerben (Intézõben) tudjuk megformázni a lemezeket (kattintsunk a jobb gombbal az <span class=filename>A:</span> meghajtóra, majd válasszuk a "Format" (Formázás) menüpontot).</p></div><div class=paragraph><p><em>Ne</em> bízzunk a gyárilag formázott ("pre-formatted" jelzésû) lemezekben! Menjünk biztosra és formázzuk meg mi magunk is lemezeket. A felhasználóinktól régebben számtalan olyan panasz érkezett, amely a helytelenül megformázott lemezbõl fakadt, ezért erre most kiemelten felhívjuk a figyelmet.</p></div><div class=paragraph><p>A formázás abban az esetben sem bizonyul rossz ötletnek, ha egy másik FreeBSD gépen gyártjuk le a lemezeket, habár nem kell mindegyik lemezre DOS állományrendszert tennünk. Helyette a <code>bsdlabel</code> és <code>newfs</code> parancsok használatával UFS állományrendszert is tehetünk rájuk, ahogy (1,44 MB méretû lemezek esetén) ezt az alábbi parancsok mutatják:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># fdformat -f 1440 fd0.1440</span>
<span class=c># bsdlabel -w fd0.1440 floppy3</span>
<span class=c># newfs -t 2 -u 18 -l 1 -i 65536 /dev/fd0</span></code></pre></div></div><div class=paragraph><p>Ezután a többi állományrendszerhez hasonlóan a lemezeket tudjuk csatlakoztatni és írni.</p></div><div class=paragraph><p>Miután megformáztuk a lemezeket, rájuk kell másolnunk az állományokat. A terjesztésekhez tartozó állományokat adott méretû darabokra szeleteltük, így kényelmesen ráférnek egy hagyományos 1,44 MB méretû floppyra. Menjünk végig az összes floppyn és mindegyikre pakoljuk fel a lehetõ legtöbb állományt egészen addig, amíg így az összes szükséges terjesztést össze nem szedtük. A floppykon minden terjesztés kerüljön egy hozzá tartozó alkönyvtárba, például: <span class=filename>a:\base\base.aa</span>, <span class=filename>a:\base\base.ab</span> és így tovább.</p></div><div class="admonitionblock important"><table><tbody><tr><td class=icon><i class="fa icon-important" title=Important></i></td><td class=content><div class=paragraph><p>Az elsõ lemezre rá kell másolnunk a <span class=filename>base.inf</span> nevû állományt is, mivel ennek beolvasásával lesz képes kitalálni a telepítõ, hogy a terjesztések összeszedése és összefûzése során mennyi darabot keressen.</p></div></td></tr></tbody></table></div><div class=paragraph><p>Ahogy elérkezünk a telepítõeszköz kiválasztásához a telepítés folyamatában, ott válasszuk a <span class=guimenuitem>Floppy</span> menüpontot, majd utána kövessük a felbukkanó üzeneteket.</p></div></div><div class=sect3><h4 id=install-msdos>2.13.4. Telepítés MS-DOS® partícióról<a class=anchor href=#install-msdos></a></h4><div class=paragraph><p>Amikor egy MS-DOS® partícióról akarunk telepíteni, elõkészítés gyanánt másoljuk a terjesztésekhez tartozó állományokat a partícióra egy <span class=filename>freebsd</span> könyvtárba. Ez lesz például a <span class=filename>c:\freebsd</span>. Ebben a könyvtárban igyekezzük minél jobban megtartani a CD vagy az FTP oldal könyvtárszerkezetét, ezért erre a CD-rõl történõ átmásolásra a DOS <code>xcopy</code> parancsát javasoljuk. Például így tudjuk elõkészíteni a FreeBSD legegyszerûbb változatának telepítését:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>C:<span class=se>\&gt;</span> md c:<span class=se>\f</span>reebsd
C:<span class=se>\&gt;</span> xcopy e:<span class=se>\b</span><span class=k>in </span>c:<span class=se>\f</span>reebsd<span class=se>\b</span><span class=k>in</span><span class=se>\ </span>/s
C:<span class=se>\&gt;</span> xcopy e:<span class=se>\m</span>anpages c:<span class=se>\f</span>reebsd<span class=se>\m</span>anpages<span class=se>\ </span>/s</code></pre></div></div><div class=paragraph><p>A fentiekben feltételeztük, hogy ehhez a <span class=filename>C:</span> meghajtón elég szabad helyünk van, valamint az <span class=filename>E:</span> meghajtón érjük el a CD-t.</p></div><div class=paragraph><p>Ha nincs CD-meghajtónk, az <a href=ftp://ftp.FreeBSD.org/pub/FreeBSD/releases/i386/12.0-RELEASE/>ftp.FreeBSD.org</a> címrõl letölthetjük a terjesztésket. Minden egyes terjesztés külön könyvtárban található, tehát például a <em>base</em> (alap) terjesztés az <a href=ftp://ftp.FreeBSD.org/pub/FreeBSD/releases/i386/12.0-RELEASE/base/>12.0/base/</a> könyvtárban található.</p></div><div class=paragraph><p>Mindegyik telepítendõ terjesztést (ami még elfér) másoljuk át az MS-DOS® partíció <span class=filename>c:\freebsd</span> könyvtárába - a telepítéshez egyébként egyedül a <code>BIN</code> terjesztés szükséges.</p></div></div><div class=sect3><h4 id=_telepítõszalag_létrehozása>2.13.5. Telepítõszalag létrehozása<a class=anchor href=#_telepítõszalag_létrehozása></a></h4><div class=paragraph><p>Valószínûleg a szalagos módszer a legegyszerûbb, egyfajta élõ FTP-s vagy CD-s telepítés. A telepítõprogram arra számít, hogy a szalagon az állományok egymás után helyezkednek el. Tehát miután beszereztük a nekünk kellõ terjesztésekhez tartozó összes állományt, egyszerûen vegyük fel ezeket a szalagra:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># cd /freebsd/distdir</span>
<span class=c># tar cvf /dev/rwt0 dist1 ... dist2</span></code></pre></div></div><div class=paragraph><p>Mielõtt telepítenénk, ellenõrizzük, hogy legyen elég helyünk valamelyik (a telepítés során majd kiválasztható átmeneti) könyvtárban ahhoz, hogy az itt létrehozott szalag <em>teljes</em> tartalma elférjen benne. Mivel a szalagok csak szekvenciálisan érhetõek el, ezért ennél a módszernél jó sok ideiglenes tárhelyre lesz szükségünk.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>A telepítés megkezdése után a szalagnak már <em>azelõtt</em> a meghajtóban kell lennie, hogy rendszerindító floppyról elindítanánk a rendszert, máskülönben nem találja meg.</p></div></td></tr></tbody></table></div></div><div class=sect3><h4 id=_mielõtt_hálózatról_telepítenénk>2.13.6. Mielõtt hálózatról telepítenénk<a class=anchor href=#_mielõtt_hálózatról_telepítenénk></a></h4><div class=paragraph><p>Háromféle hálózati telepítési mód létezik: Ethernet (szabványos Ethernet-vezérlõvel), soros port (PPP) vagy párhuzamos port (PLIP (laplink kábel)).</p></div><div class=paragraph><p>Valószínûleg az Ethernet-csatlakozó választásával érjük el a leggyorsabb hálózati telepítést. A FreeBSD ismeri a legtöbb PC-s Ethernet kártyát. Az ismert kártyák (és a hozzájuk tartozó beállítások) a FreeBSD egyes kiadásának hardverjegyzékében (Hardware Notes) találhatóak meg. Amennyiben egy támogatott PCMCIA Ethernet kártyát használunk, mindig a laptop bekapcsolása <em>elõtt</em> helyezzük be! A FreeBSD telepítés közben sajnos nem támogatja a PCMCIA kártyák menetközbeni behelyezését.</p></div><div class=paragraph><p>Ezenkívül még ismernünk kell a hálózaton kapott IP-címünket, az általa használt címosztály hálózati maszkját, a gépünk nevét. Ha PPP kapcsolaton keresztül telepítünk és nincs statikus IP-címünk, akkor minden bizonnyal az internet-szolgáltatónktól kaptunk egyet dinamikusan. A konkrét hálózati beállításokat a hálózatunk rendszergazdájától is érdemes megkérdezni. Ha a hálózaton levõ többi gépre névvel és nem IP-címmel hivatkozunk, akkor szükségünk lesz még egy név(feloldó) szerverre és az internet eléréséhez egy átjáró címére is (ha PPP-t használunk, ez a szolgáltatónk IP-címe lesz). Ha FTP-rõl HTTP proxy használatával telepítünk, akkor a proxy címe is kelleni fog. Ha magunktól nem vagyunk képesek ezekre a kérdésekre válaszolni, akkor az ilyen típusú telepítés megkezdése <em>elõtt</em> tényleg segítséget kell kérnünk egy rendszergazdától vagy az internet-szolgáltatónktól.</p></div><div class=paragraph><p>Ha modemet használunk, akkor a PPP szinte biztosan megfelel nekünk. Gondoskodjunk róla, hogy már a telepítés korai szakaszában rendelkezésünkre áll az internet-szolgáltatónkkal kapcsolatosan minden hasznos információ.</p></div><div class=paragraph><p>Ha PAP vagy CHAP használatával kapcsolódunk a szolgáltatónkhoz (másképp szólva Windows®-ban így tudunk szkriptek nélkül csatlakozni), mindössze a <code>dial</code> parancsot kell kiadnunk a ppp parancssorában. Minden más esetben tudnunk kell a modemünk saját "AT parancsaival" tárcsázni az internet-szolgáltatónkat, hiszen ehhez a PPP tárcsázó csak egy nagyon kezdetleges terminálemulációt nyújt. Ezzel kapcsolatban olvassuk el <a href=./#userppp>a kézikönyv</a> és a <a href=https://docs.freebsd.org/hu/books/faq/#_ppp>GYIK</a> idevágó részeit. Ha gondjaink akadnának, a naplózás a <code>set log local …​</code> parancs kiadásával átirányítható közvetlenül a képernyõre.</p></div><div class=paragraph><p>Ha kötött módon tudunk csatlakozni egy másik (2.0-R vagy késõbbi verziójú) FreeBSD géphez, akkor megpróbálkozhatunk a párhuzamos "laplink" kábellel. A párhuzamos porton keresztüli adatátvitel sebessége a soros vonalénál jóval nagyobb (egészen 50 kbyte/mp), ezért vele a telepítés is gyorsabb.</p></div><div class=sect4><h5 id=_mielõtt_nfs_rõl_telepítenénk>2.13.6.1. Mielõtt NFS-rõl telepítenénk<a class=anchor href=#_mielõtt_nfs_rõl_telepítenénk></a></h5><div class=paragraph><p>A telepítés NFS-en keresztül szinte magától értetõdik. Egyszerûen csak másoljuk a FreeBSD terjesztéseihez tartozó állományokat az NFS szerverre és állítsuk be rá az NFS telepítõeszközt.</p></div><div class=paragraph><p>Ha a szerver csak "privilegizált portokat" ismer (ami általában alapértelmezett a Sun munkaállomásoknál), a telepítés megkezdése elõtt az <b class=menuref>Options</b> (Beállítások) menüben be kell állítani az <code>NFS Secure</code> (Biztonságos NFS) opciót.</p></div><div class=paragraph><p>Ha egy gyenge minõségû és kis adatátviteli sebességû Ethernet kártyánk van, akkor emellett még hasznos lehet beállítani az <code>NFS Slow</code> (Lassú NFS) opciót is.</p></div><div class=paragraph><p>Az NFS-en keresztüli telepítés mûködéséhez a szervernek támogatnia kell az alkönyvtárak csatlakoztatását is, tehát például ha a FreeBSD 12.0 terjesztésünk a <span class=filename>ziggy:/usr/archive/stuff/FreeBSD</span> könyvtárban található, akkor <code>ziggy</code> nevû gépnek lehetõvé kell tennie a <span class=filename>/usr/archive/stuff/FreeBSD</span> könyvtár közvetlen csatlakoztatását is, nem csak a <span class=filename>/usr</span> vagy <span class=filename>/usr/archive/stuff</span> könyvtárakét.</p></div><div class=paragraph><p>A FreeBSD <span class=filename>/etc/exports</span> állományában ezt az <code>-alldirs</code> beállítással vezérelhetjük. Más NFS szervereken esetleg más megszokásokat kell követnünk. Amennyiben a szervertõl <code>permission denied</code> (hozzáférés megtagadva) üzeneteket kapjuk, valószínû, hogy ezt nem állítottuk be megfelelõen.</p></div></div></div></div></div></div><div class=sect1><h2 id=basics>Chapter 3. A UNIX alapjai<a class=anchor href=#basics></a></h2><div class=sectionbody><div class=sect2><h3 id=basics-synopsis>3.1. Áttekintés<a class=anchor href=#basics-synopsis></a></h3><div class=paragraph><p>Ez a fejezet a FreeBSD operációs rendszer alapvetõ funkcióit és parancsait mutatja be. Az itt tárgyalásra kerülõ anyag nagy része érvényes bármelyik más UNIX®-szerû operációs rendszer esetén is. Ezért, ha már ismerjük az említésre kerülõ ismereteket, minden további gond nélkül átugorhatjuk ezt a fejezetet. Azonban ha még teljesen ismeretlen számunkra a FreeBSD, minden bizonnyal ez lesz az, amit alaposan át kell majd olvasnunk.</p></div><div class=paragraph><p>A fejezet elolvasása során megismerjük:</p></div><div class=ulist><ul><li><p>az ún. "virtuális konzolok" használatát FreeBSD alatt;</p></li><li><p>hogyan mûködnek együtt a UNIX® állományokra vonatkozó engedélyei a FreeBSD saját kiegészítéseivel;</p></li><li><p>egy FreeBSD állományrendszer alapértelmezett kialakítását;</p></li><li><p>a FreeBSD lemezszervezését;</p></li><li><p>hogyan csatlakoztassunk és válasszunk le állományrendszereket;</p></li><li><p>mik azok a folyamatok, démonok és jelzések;</p></li><li><p>mik azok a parancsértelmezõk, és miként tudjuk megváltoztatni az alapértelmezett bejelentkezési környezetünket;</p></li><li><p>hogyan használjuk az alapvetõ szövegszerkesztõket;</p></li><li><p>mik az eszközök és az eszközleírók;</p></li><li><p>FreeBSD alatt milyen bináris formátumokat használhatunk;</p></li><li><p>szükség esetén hogyan olvassuk el a megfelelõ man oldalakat.</p></li></ul></div></div><div class=sect2><h3 id=consoles>3.2. Virtuális konzolok és terminálok<a class=anchor href=#consoles></a></h3><div class=paragraph><p>A FreeBSD számos módon használható. Ezek közül az egyik az, ha parancsokat gépelünk be a szöveges terminálon. Így érhetõ el egyszerûen a UNIX® operációs rendszer rugalmasságának és erejének jelentõs része. Ebben a szakaszban megtudhatjuk, mik azok a "terminálok" és "konzolok" és miként tudjuk ezeket FreeBSD alatt használni.</p></div><div class=sect3><h4 id=consoles-intro>3.2.1. A konzol<a class=anchor href=#consoles-intro></a></h4><div class=paragraph><p>Ha nem állítottuk volna be, hogy a FreeBSD indulása során automatikusan induljon el a grafikus felület is, akkor a rendszer egy bejelentkezõ képernyõt fog mutatni közvetlenül a rendszerindítás befejezõdése után. Ekkor valami ilyesmit kell majd látnunk:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>Additional ABI support:.
Local package initialization:.
Additional TCP options:.

Fri Sep 20 13:01:06 EEST 2002

FreeBSD/i386 <span class=o>(</span>pc3.example.org<span class=o>)</span> <span class=o>(</span>ttyv0<span class=o>)</span>

login:</code></pre></div></div><div class=paragraph><p>Egyes rendszereken ugyan némileg eltérhetnek az üzenetek, de hasonlót kell látnunk. Minket most az utolsó két sor érdekel. Az utolsó elõtti sorban ez olvasható:</p></div><div class="literalblock programlisting"><div class=content><pre>FreeBSD/i386 (pc3.example.org) (ttyv0)</pre></div></div><div class=paragraph><p>Ez a sor arról értesít minket, hogy a rendszerünk éppen most indult el: egy "FreeBSD" konzolt látunk, amely egy Intel® x86 architektúrájú processzoron fut . A gépünk neve (mivel minden UNIX®-os gép rendelkezik egy névvel) <code>pc3.example.org</code>, és ennek a rendszerkonzolját látjuk most éppen - a <span class=filename>ttyv0</span> terminált.</p></div><div class=paragraph><p>Végezetül az utolsó sor mindig:</p></div><div class="literalblock programlisting"><div class=content><pre>login:</pre></div></div><div class=paragraph><p>Ez az a rész, ahova a FreeBSD-be történõ bejelentkezéshez meg kell adnunk a "felhasználói nevünket" (user name). A következõ szakaszban errõl olvashatunk.</p></div></div><div class=sect3><h4 id=consoles-login>3.2.2. Bejelentkezés a FreeBSD-be<a class=anchor href=#consoles-login></a></h4><div class=paragraph><p>A FreeBSD egy többfelhasználós, többfeladatos rendszer. Így hívják hivatalosan azokat a rendszereket, amelyeket többen tudnak használni és egyetlen számítógépen egyszerre rengeteg programot képesek futtatni.</p></div><div class=paragraph><p>Minden többfelhasználós rendszernek valamilyen módon meg kell tudnia különböztetnie egy "felhasználóját" a többitõl. A FreeBSD-ben (és minden más UNIX®-szerû operációs rendszerben) ezt úgy érik el, hogy a programok futtatása elõtt minden felhasználónak "be kell jelentkeznie" a rendszerbe. Minden felhasználó rendelkezik egy egyedi névvel (ez a "felhasználói név") és ehhez egy titkos kulcssal (ez a "jelszó"). A FreeBSD a programok futtatásához ezt a kettõt fogja elkérni a felhasználótól.</p></div><div class=paragraph><p>Egybõl miután a FreeBSD elindult és befejezte a rendszerindításhoz használt szkriptjeinek lefuttatását , ez a kijelzés (vagy más néven "prompt") fog megjelenni és kér egy érvényes felhasználói nevet:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>login:</code></pre></div></div><div class=paragraph><p>A példa kedvéért most tegyük fel, hogy a felhasználói nevünk <code>pgj</code>. Az iménti prompthoz írjuk be, hogy <code>pgj</code> és nyomjuk le az <kbd>Enter</kbd> billentyût. Ezt követõen meg kell jelennie egy másik promptnak is, amely egy "jelszót" (password) kér:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>login: pgj
Password:</code></pre></div></div><div class=paragraph><p>Most pedig gépeljük be <code>pgj</code> jelszavát és nyomjunk utána egy <kbd>Enter</kbd> billentyût. Vigyázzunk, hogy a jelszót <em>nem látjuk</em> a beírás során! Emiatt most ne aggódjunk. Ezzel kapcsolatban elegendõ csak annyit tudni, hogy mindez biztonsági megfontolásokból történik.</p></div><div class=paragraph><p>Amennyiben jól adtuk meg a jelszavunkat, sikeresen bejelentkezünk a FreeBSD rendszerébe és készen állunk az összes elérhetõ parancs kipróbálására.</p></div><div class=paragraph><p>Bejelentkezés után a MOTD (message of the day) vagy más néven "a nap üzenete" jelenik meg, amelyet a parancssor követ (egy <code>#</code>, <code>$</code> vagy <code>%</code> jel). Innen tudhatjuk meg, hogy sikerült bejelentkeznünk.</p></div></div><div class=sect3><h4 id=consoles-virtual>3.2.3. Több konzol használata<a class=anchor href=#consoles-virtual></a></h4><div class=paragraph><p>A UNIX® parancsokat egy konzolon is szépen ki tudjuk adni, de a FreeBSD egyszerre ugyebár több programot is tud futtatni. A parancsok megadásához viszont egyetlen konzol használata elég nagy pazarlás lenne, hiszen egy olyan operációs rendszer mint a FreeBSD, tucatnyi programot képes futtatni egy idõben. Ebben az esetben jelenthetnek számunkra segítséget a "virtuális konzolok".</p></div><div class=paragraph><p>A FreeBSD beállítható úgy, hogy sok-sok különféle virtuális konzolt ajánljon fel számunkra. A virtuális konzolok között a billentyûzeten a megfelelõ gombok lenyomásával tudunk váltani. Mindegyik konzolnak megvan a saját kimeneti csatornája, és a virtuális konzolok közti váltás folyamán a FreeBSD gondoskodik a billentyûzetrõl érkezõ bemenet, valamint a monitorra irányított kimenet megfelelõ kezelésérõl.</p></div><div class=paragraph><p>A konzolok közti váltásra a FreeBSD külön billentyûkombinációkat tart fenn . A FreeBSD-ben a különbözõ virtuális konzolok közti váltásra az <span class=keyseq><kbd>Alt</kbd>+<kbd>F1</kbd></span>, <span class=keyseq><kbd>Alt</kbd>+<kbd>F2</kbd></span> billentyûket, az <span class=keyseq><kbd>Alt</kbd>+<kbd>F8</kbd></span> billentyûkombinációval bezárólag használhatjuk.</p></div><div class=paragraph><p>A konzolok közti váltogatás során a FreeBSD ügyel a képernyõ tartalmának elmentésére és visszaállítására. Ennek eredményeképpen "úgy látszik", mintha több "virtuális" képernyõn és billentyûzeten adnánk parancsokat a FreeBSD-nek.</p></div></div><div class=sect3><h4 id=consoles-ttys>3.2.4. Az <span class=filename>/etc/ttys</span> állomány<a class=anchor href=#consoles-ttys></a></h4><div class=paragraph><p>A FreeBSD alapértelmezés szerint nyolc virtuális konzollal indul. Ez azonban nem egy elõre rögzített érték, hiszen könnyedén testreszabhatjuk úgy a telepített rendszerünket, hogy több vagy esetleg kevesebb virtuális konzollal induljon el. A virtuális konzolok száma és azok pontos beállítása az <span class=filename>/etc/ttys</span> állományon keresztül adható meg.</p></div><div class=paragraph><p>A FreeBSD virtuális konzoljait tehát az <span class=filename>/etc/ttys</span> állomány megfelelõ módosításával tudjuk behangolni. Itt minden egyes olyan sor, amely nem megjegyzés (vagyis azok a sorok, amelyek nem a <code>#</code> karakterrel kezdõdnek), tartalmazza az egyes terminálok vagy virtuális konzolok beállításait. Az állomány a FreeBSD telepítésében szereplõ, alapértelmezett változata kilenc virtuális konzol konfigurációját tartalmazza, amelyek közül nyolc aktív. Ezek a <code>ttyv</code> résszel kezdõdõ sorok:</p></div><div class="literalblock programlisting"><div class=content><pre># name  getty                           type    status          comments
#
ttyv0   &#34;/usr/libexec/getty Pc&#34;         cons25  on  secure
# Virtual terminals
ttyv1   &#34;/usr/libexec/getty Pc&#34;         cons25  on  secure
ttyv2   &#34;/usr/libexec/getty Pc&#34;         cons25  on  secure
ttyv3   &#34;/usr/libexec/getty Pc&#34;         cons25  on  secure
ttyv4   &#34;/usr/libexec/getty Pc&#34;         cons25  on  secure
ttyv5   &#34;/usr/libexec/getty Pc&#34;         cons25  on  secure
ttyv6   &#34;/usr/libexec/getty Pc&#34;         cons25  on  secure
ttyv7   &#34;/usr/libexec/getty Pc&#34;         cons25  on  secure
ttyv8   &#34;/usr/X11R6/bin/xdm -nodaemon&#34;  xterm   off secure</pre></div></div><div class=paragraph><p>Az állományban található oszlopok kimerítõ magyarázatát, illetve a virtuális konzolok beállításához használható kapcsolókat a <a href="https://man.freebsd.org/cgi/man.cgi?query=ttys&amp;sektion=5&amp;format=html">ttys(5)</a> man oldalon olvashatjuk.</p></div></div><div class=sect3><h4 id=consoles-singleuser>3.2.5. Az egyfelhasználós mód konzolja<a class=anchor href=#consoles-singleuser></a></h4><div class=paragraph><p>Az "egyfelhasználós mód" részletes leírása a <a href=./#boot-singleuser>Egyfelhasználós mód</a>ban található. Fontos tudni, hogy amikor a FreeBSD-t egyfelhasználós módban futtatjuk, csupán egyetlen konzolunk van, és a virtuális konzolok nem érhetõek el. Egyébként az egyfelhasználós mód erre vonatkozó beállításai is megtalálhatóak az <span class=filename>/etc/ttys</span> állományban. Ehhez keressük meg a <code>console</code> kezdetû sort:</p></div><div class="literalblock programlisting"><div class=content><pre># name  getty                           type    status          comments
#
# Ha a konzolt &#34;insecure&#34; (nem biztonságos) típusúnak választjuk meg,
# akkor a használatához az egyfelhasználós mód aktivilásá elõtt a rendszer
# kérni fogja a rendszeradminisztrátori jelszót.
console none                            unknown off secure</pre></div></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>A <code>console</code> felett látható megjegyzés jelzi, hogy át tudjuk írni ebben a sorban a <code>secure</code> (biztonságos) értékû paramétert <code>insecure</code> (nem biztonságos) értékûre. Ilyenkor, hogy ha a FreeBSD egyfelhasználós módban indul, kérni fogja a <code>root</code> felhasználó (a rendszeradminisztrátor) jelszavát.</p></div><div class=paragraph><p><em>Vigyázzunk, amikor ezt az értéket <code>insecure</code>-ra állítjuk!</em> Ha ugyanis véletlenül elfeledkeznénk a <code>root</code> jelszaváról, akkor azzal az egyfelhasználós mód használata is veszélybe kerülhet. Habár ettõl függetlenül is lehetséges, azokra számára mégis nehéz helyzetnek bizonyulhat, akik nem mozognak elég otthonosan a FreeBSD rendszerindítási folyamatának és a hozzákapcsolódó programok ismeretében.</p></div></td></tr></tbody></table></div></div><div class=sect3><h4 id=consoles-vidcontrol>3.2.6. A videomód váltása konzolban<a class=anchor href=#consoles-vidcontrol></a></h4><div class=paragraph><p>A FreeBSD konzol alapértelmezett videomódja átállítható 1024x768-ra, 1280x1024-re, vagy bármilyen olyan más méretre, amit a videokártyánk és monitorunk képes megjeleníteni. Az eltérõ videomódok használatához elõször újra kell fordítanunk a rendszermagunkat az alábbi két beállítás hozzáadásával:</p></div><div class="literalblock programlisting"><div class=content><pre>options VESA
options SC_PIXEL_MODE</pre></div></div><div class=paragraph><p>Miután a rendszermagot sikeresen újrafordítottuk a fenti beállításokkal, a <a href="https://man.freebsd.org/cgi/man.cgi?query=vidcontrol&amp;sektion=1&amp;format=html">vidcontrol(1)</a> segédprogrammal tudjuk megállapítani, hogy a hardverünk milyen videomódokat enged használni. Az összes támogatott videomódot a következõképpen tudjuk lekérdezni:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># vidcontrol -i mode</span></code></pre></div></div><div class=paragraph><p>A parancs eredményeképpen tehát megkapjuk a hardverünk által ismert videomódokat. Ezek közül tudjuk kiválasztani valamelyikõjüket és <code>root</code> felhasználóként a <a href="https://man.freebsd.org/cgi/man.cgi?query=vidcontrol&amp;sektion=1&amp;format=html">vidcontrol(1)</a> segítségével beállítani:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># vidcontrol MODE_279</span></code></pre></div></div><div class=paragraph><p>Ha az új videomód megfelel számunkra, akkor ezt a beállítást az <span class=filename>/etc/rc.conf</span> állományon keresztül véglegesíthetjük is:</p></div><div class="literalblock programlisting"><div class=content><pre>allscreens_flags=&#34;MODE_279&#34;</pre></div></div></div></div><div class=sect2><h3 id=permissions>3.3. Engedélyek<a class=anchor href=#permissions></a></h3><div class=paragraph><p>A FreeBSD, mivel a BSD UNIX® egyik közvetlen leszármazottja, számos UNIX®-os alapötletre épül. Ezek közül az elsõ és talán a leginkább kihangsúlyozott, hogy a FreeBSD egy többfelhasználós operációs rendszer. Egy olyan rendszer, amely egyszerre több, egymástól független feladattal foglalkozó felhasználót képes kiszolgálni. A rendszer felelõs a hardveres eszközök, a különféle perifériák, a memória és a processzor idejének minden egyes felhasználó számára szabályos és pártatlan megosztásáért és a feléjük irányuló kérések szervezéséért.</p></div><div class=paragraph><p>Mivel a rendszer több felhasználót is képes támogatni, az általa kezelt erõforrások rendelkeznek engedélyek egy adott halmazával, amelyek eldöntik, ki tudja ezeket olvasni, írni és végrehajtani. Az engedélyek háromszor három bit formájában jelennek meg, amelyek közül az elsõ bitcsoport az állomány tulajdonosára, a második az állomány csoportjára, végül az utolsó pedig a mindenki másra vonatkozó engedélyeket tárolja.</p></div><table class="tableblock frame-none grid-all stretch informaltable"><col style=width:33.3333%><col style=width:33.3333%><col style=width:33.3334%><thead><tr><th class="tableblock halign-left valign-top">Érték</th><th class="tableblock halign-left valign-top">Engedély</th><th class="tableblock halign-left valign-top">Könyvtárlistában</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class=tableblock>0</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Nem olvasható, nem írható, nem hajtható végre</p></td><td class="tableblock halign-left valign-top"><p class=tableblock><code>---</code></p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>1</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Nem olvasható, nem írható, végrehajtható</p></td><td class="tableblock halign-left valign-top"><p class=tableblock><code>--x</code></p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>2</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Nem olvasható, írható, nem hajtható végre</p></td><td class="tableblock halign-left valign-top"><p class=tableblock><code>-w-</code></p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>3</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Nem olvasható, írható, végrehajtható</p></td><td class="tableblock halign-left valign-top"><p class=tableblock><code>-wx</code></p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>4</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Olvasható, nem írható, nem hajtható végre</p></td><td class="tableblock halign-left valign-top"><p class=tableblock><code>r--</code></p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>5</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Olvasható, nem írható, végrehajtható</p></td><td class="tableblock halign-left valign-top"><p class=tableblock><code>r-x</code></p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>6</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Olvasható, írható, nem hajtható végre</p></td><td class="tableblock halign-left valign-top"><p class=tableblock><code>rw-</code></p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>7</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Olvasható, írható, végrehajtható</p></td><td class="tableblock halign-left valign-top"><p class=tableblock><code>rwx</code></p></td></tr></tbody></table><div class=paragraph><p>A <a href="https://man.freebsd.org/cgi/man.cgi?query=ls&amp;sektion=1&amp;format=html">ls(1)</a> <code>-l</code> kapcsolójának segítségével megnézhetjük a könyvtárak tartalmának részletes listáját, amiben megjelennek az állományok tulajdonosaira, csoportjára és a mindenki másra vonatkozó engedélyek is. Például ezt láthatjuk, ha kiadjuk az <code>ls -l</code> parancsot egy tetszõleges könyvtárban:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>% <span class=nb>ls</span> <span class=nt>-l</span>
total 530
<span class=nt>-rw-r--r--</span>  1 root  wheel     512 Sep  5 12:31 egyik
<span class=nt>-rw-r--r--</span>  1 root  wheel     512 Sep  5 12:31 masik
<span class=nt>-rw-r--r--</span>  1 root  wheel    7680 Sep  5 12:31 e-mail.txt
...</code></pre></div></div><div class=paragraph><p>A példabeli <code>ls -l</code> parancs kimenetének elsõ oszlopa így bomlik fel:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=nt>-rw-r--r--</span></code></pre></div></div><div class=paragraph><p>Az elsõ (bal szélsõ) karakter mondja meg, hogy ez egy hagyományos állomány, könyvtár, speciális karakteres eszköz, socket vagy bármilyen más különleges pszeudoállomány. Ebben az esetben a <code>-</code> jelzi, hogy egy hagyományos állományról van szó. A következõ három karakter, ami ebben a példában az <code>rw-</code>, adja meg az állomány tulajdonosának engedélyeit. Az ezután következõ három karakter, az <code>r--</code> mutatja az állomány csoportjának engedélyeit. Az utolsó három karakter, vagyis itt az <code>r--</code> adja meg a többiek engedélyeit. A kötõjel arra utal, hogy az adott engedélyû tevékenység nem engedélyezett. Tehát ennél az állománynál az engedélyek a következõek: a tulajdonosa tudja olvasni és írni, a csoportja csak olvasni tudja, ugyanígy bárki más. A fenti táblázatnak megfelelõen az állomány engedélyének kódja <code>644</code> lesz, ahol az egyes számjegyek jelentik az állomány engedélyeinek három elemét.</p></div><div class=paragraph><p>Ez mind szép és jó, de vajon a rendszer milyen módon kezeli az állományok engedélyeit? A FreeBSD a legtöbb hardveres eszközt állománynak tekinti, amelyeket a programok meg tudnak nyitni, tudnak róluk olvasni és adatokat tudnak kiírni rájuk pontosan úgy, mint bármilyen más állomány esetén. Ezeket a speciális állományokat a <span class=filename>/dev</span> könyvtárban találjuk.</p></div><div class=paragraph><p>A könyvtárakat is állományokként kezeli, ezért azok is rendelkeznek olvasási, írási és végrehajtási engedélyekkel. Azonban a könyvtárak végrehajtását engedélyezõ bit némileg más jelentéssel bír, mint az állományok esetén. Amikor ugyanis egy könyvtárat végrehajthatónak jelölünk meg, az arra fog utalni, hogy bele tudunk lépni, vagyis hogy ki tudjuk rá adni a "könyvtárváltás" (cd, change directory) parancsát. Ez továbbá arra is utal, hogy az ismert nevû állományokhoz hozzá tudunk férni (természetesen az egyes állományok engedélyeinek megfelelõen).</p></div><div class=paragraph><p>A könyvtárak tartalmát ennek megfelelõen viszont csak úgy láthatjuk, ha olvasási engedéllyel rendelkezünk a könyvtárra, míg egy általunk ismert állomány törléséhez a tartalmazó könyvtárhoz kell írási <em>és</em> végrehajtási engedélyekkel rendelkeznünk.</p></div><div class=paragraph><p>Ezeken kívül még léteznek további engedélyek is, de ezeket csak olyan különleges esetekben használják, mint például a felhasználóváltó programok (setuid program) vagy a ragadós könyvtárak (sticky directory) létrehozása. Az állományok engedélyeinek behatóbb megismeréséhez és beállításához mindenképpen nézzük át a <a href="https://man.freebsd.org/cgi/man.cgi?query=chmod&amp;sektion=1&amp;format=html">chmod(1)</a> man oldalt.</p></div><div class=sect3><h4 id=_szimbolikus_engedélyek>3.3.1. Szimbolikus engedélyek<a class=anchor href=#_szimbolikus_engedélyek></a></h4><div class=paragraph><p>A szimbolikus engedélyek (gyakran csak szimbolikus kifejezések) az állományok és könyvtárak engedélyeinek megadása során a számok helyett karaktereket használnak. A szimbolikus kifejezések (ki) (hogyan) (milyen engedélyt) alakúak, ahol az alábbi értékek adhatóak meg:</p></div><table class="tableblock frame-none grid-all stretch informaltable"><col style=width:33.3333%><col style=width:33.3333%><col style=width:33.3334%><thead><tr><th class="tableblock halign-left valign-top">Elem</th><th class="tableblock halign-left valign-top">Betû</th><th class="tableblock halign-left valign-top">Jelentése</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class=tableblock>(ki)</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>u</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>tulajdonos</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>(ki)</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>g</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>csoport tulajdonos</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>(ki)</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>o</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>egyéb</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>(ki)</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>a</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>mindenki (a "világ")</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>(hogyan)</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>+</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>engedély megadása</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>(hogyan)</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>-</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>engedély visszavonása</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>(hogyan)</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>=</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>engedély explicit beállítása</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>(milyen engedély)</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>r</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>olvasás</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>(milyen engedély)</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>w</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>írás</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>(milyen engedély)</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>x</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>végrehajtás</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>(milyen engedély)</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>t</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>ragadós (sticky bit)</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>(milyen engedély)</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>s</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>UID vagy GID állítása</p></td></tr></tbody></table><div class=paragraph><p>Ezek az értékek a <a href="https://man.freebsd.org/cgi/man.cgi?query=chmod&amp;sektion=1&amp;format=html">chmod(1)</a> paranccsal az eddigiekhez hasonló módon használhatóak, csak itt betûket kell megadnunk. Például az alábbi paranccsal akadályozhatjuk meg, hogy a tulajdonosán kívül bárki hozzáférhessen az <em>ÁLLOMÁNY</em> nevû állományhoz:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>% <span class=nb>chmod </span><span class=nv>go</span><span class=o>=</span> ÁLLOMÁNY</code></pre></div></div><div class=paragraph><p>Amennyiben egy állománnyal kapcsolatban több változtatást is el kívánunk végezni, össze tudjuk ezeket fûzni egy vesszõkkel elhatárolt felsorolásban:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>% <span class=nb>chmod </span>go-w,a+x ÁLLOMÁNY</code></pre></div></div></div><div class=sect3><h4 id=_a_freebsd_állományjelzõi>3.3.2. A FreeBSD állományjelzõi<a class=anchor href=#_a_freebsd_állományjelzõi></a></h4><div class=paragraph><p>A korábban tárgyalt engedélyek mellett még a FreeBSD ismeri az ún. "állományjelzõk" (file flags) beállítását is. Ezek a jelzõbitek egy további biztonsági és irányítási szintet nyújtanak az állományok felett, viszont a könyvtárakra nem vonatkoznak.</p></div><div class=paragraph><p>Ezek az állományjelzõk az állományok felett további vezérlést adnak a kezünkbe, aminek révén gondoskodhatunk róla, hogy akár még a <code>root</code> felhasználó (a rendszer adminisztrátora) se legyen képes állományokat eltávolítani vagy módosítani.</p></div><div class=paragraph><p>Az állományjelzõk értékei egy egyszerû felületen keresztül, a <a href="https://man.freebsd.org/cgi/man.cgi?query=chflags&amp;sektion=1&amp;format=html">chflags(1)</a> segédprogrammal változtathatóak meg. Például a következõ paranccsal állíthatjuk a rendszer törölhetetlen (undeletable) jelzését az <span class=filename>allomany1</span> állományon:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># chflags sunlink allomany1</span></code></pre></div></div><div class=paragraph><p>A törölhetetlen jelzés eltávolításához egyszerûen csak írjuk be az elõzõ parancsot úgy, hogy a "sunlink" paraméter elejére még beszúrunk egy "no" szövegrészt. Így:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># chflags nosunlink allomany1</span></code></pre></div></div><div class=paragraph><p>Az állományokra éppen érvényes jelzéseket az <a href="https://man.freebsd.org/cgi/man.cgi?query=ls&amp;sektion=1&amp;format=html">ls(1)</a> parancs <code>-lo</code> kapcsolójának segítségével jeleníthetjük meg:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># ls -lo file1</span></code></pre></div></div><div class=paragraph><p>Ennek megfelelõen az eredménynek valahogy így kellene kinéznie:</p></div><div class="literalblock programlisting"><div class=content><pre>-rw-r--r--  1 trhodes  trhodes  sunlnk 0 Mar  1 05:54 allomany1</pre></div></div><div class=paragraph><p>Sok jelzés csak a <code>root</code> felhasználón keresztül vehetõ fel vagy távolítható el. Más esetekben viszont az állomány tulajdonosa állíthatja ezeket. A rendszergazdáknak javasoljuk, hogy ezzel kapcsolatban a <a href="https://man.freebsd.org/cgi/man.cgi?query=chflags&amp;sektion=1&amp;format=html">chflags(1)</a> és <a href="https://man.freebsd.org/cgi/man.cgi?query=chflags&amp;sektion=2&amp;format=html">chflags(2)</a> man oldalakat tanulmányozzák át.</p></div></div><div class=sect3><h4 id=_a_setuid_setgid_és_sticky_engedélyek>3.3.3. A setuid, setgid és sticky engedélyek<a class=anchor href=#_a_setuid_setgid_és_sticky_engedélyek></a></h4><div class=paragraph><p>A korábban említett engedélyeken kívül létezik még további három, amelyekkel minden rendszergazdának illik tisztában lennie. Ezek név szerint a <code>setuid</code>, <code>setgid</code> és <code>sticky</code> típusú engedélyek.</p></div><div class=paragraph><p>Ezek a beállítások bizonyos UNIX® mûveletek esetén nagyon fontosak, mivel az átlagos felhasználók számára általában el nem érhetõ funkciók használatát támogatják. A megértésükhöz elsõként a felhasználók valódi és effektív azonosítója közti különbségeket kell tisztáznunk.</p></div><div class=paragraph><p>A valódi azonosító tulajdonképpen az a felhasználói azonosító, amellyel a programot indítjuk el vagy futás elõtt birtokoljuk. A program futása közben azonban az effektív felhasználói azonosítóval fut. Például a <a href="https://man.freebsd.org/cgi/man.cgi?query=passwd&amp;sektion=1&amp;format=html">passwd(1)</a> segédprogram a jelszavát megváltoztatni kívánó felhasználó valódi azonosítójával indul, miközben a jelszavakat tároló adatbázis elérésékor már a <code>root</code> felhasználó effektív azonosítójával fut. Ezáltal a privilégiumokkal nem rendelkezõ felhasználók is meg tudják anélkül változtatni a jelszavaikat, hogy a <code>Permission Denied</code> hibaüzenettel találkoznának.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>A <a href="https://man.freebsd.org/cgi/man.cgi?query=mount&amp;sektion=8&amp;format=html">mount(8)</a> <code>nosuid</code> beállításával azonban az ilyen típusú binárisok minden különösebb jel nélkül csõdöt fognak mondani. Mellesleg a <a href="https://man.freebsd.org/cgi/man.cgi?query=mount&amp;sektion=8&amp;format=html">mount(8)</a> man oldala szerint ez az opció nem is teljesen megbízható, mivel <code>nosuid</code> wrapperek segítségével meg lehet kerülni.</p></div></td></tr></tbody></table></div><div class=paragraph><p>Ahogy azt az alábbi példa is szemlélteti, a setuid engedélyt a többi elé egy négyes (4) beszúrásával tudjuk beállítani:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># chmod 4755 suidexample.sh</span></code></pre></div></div><div class=paragraph><p>A <span class=filename>suidexample.sh</span> állomány engedélyei ezt követõen már így fognak megjelenni:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=nt>-rwsr-xr-x</span>   1 trhodes  trhodes    63 Aug 29 06:36 suidexample.sh</code></pre></div></div><div class=paragraph><p>Most már jól látható, hogy az állomány tulajdonosához tartozó engedélyek között a végrehajthatóságot szabályozó bit lecserélõdött egy <code>s</code> bitre. Ennek köszönhetõen a <code>passwd</code> parancshoz hasonló módon kibõvített engedélyekkel leszünk képesek futtatni programokat.</p></div><div class=paragraph><p>Két terminál megnyitásával mindezt valós idõben is megvizsgálhatjuk. Az egyiken indítsuk el normál felhasználóként a <code>passwd</code> programot. Miközben a program várakozik az új jelszó megadására, a másik terminálon kérdezzük le a programhoz tartozó felhasználói információkat.</p></div><div class=paragraph><p>Tehát az egyik terminálon a következõt látjuk:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>% passwd
Changing <span class=nb>local </span>password <span class=k>for </span>trhodes
Old Password:</code></pre></div></div><div class=paragraph><p>Eközben pedig a másikon:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># ps aux | grep passwd</span>
trhodes  5232  0.0  0.2  3420  1608   0  R+    2:10AM   0:00.00 <span class=nb>grep </span>passwd
root     5211  0.0  0.2  3620  1724   2  I+    2:09AM   0:00.01 passwd</code></pre></div></div><div class=paragraph><p>A <code>passwd</code> parancsot egyszerû felhasználóként adtunk ki, azonban jól látható, hogy valójában a <code>root</code> felhasználó azonosítójával fut.</p></div><div class=paragraph><p>A <code>setgid</code> a <code>setuid</code> engedélyhez hasonlóan mûködik, egyedül annyiban tér el, hogy a csoportra vonatkozó beállításokat módosítja. Amikor egy alkalmazást vagy segédprogramot ilyen engedéllyel futtatunk, akkor az adott programot birtokló csoport engedélyeit kapjuk meg.</p></div><div class=paragraph><p>Úgy tudjuk állományokon beállítani a <code>setgid</code> típusú engedélyt, ha az iménti példához hasonlóan a <code>chmod</code> parancs hívásakor még egy kettest (2) írunk az engedélyek elé:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># chmod 2755 sgidexample.sh</span></code></pre></div></div><div class=paragraph><p>Az így beállított engedélyek az elõbbihöz hasonló módon szemlélhetõek meg, azonban ebben az esetben a csoporthoz tartozó engedélyeknél jelenik meg az <code>s</code> bit:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=nt>-rwxr-sr-x</span>   1 trhodes  trhodes    44 Aug 31 01:49 sgidexample.sh</code></pre></div></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Az elõbb tárgyalt példákkal kapcsolatban fontos megemlítenünk, hogy habár a szkriptek is végrehajtható állományok, nem fognak a valóditól eltérõ effektív felhasználói azonosítóval futni. Ennek oka abban keresendõ, hogy a parancssori szkriptek nem hívhatják a <a href="https://man.freebsd.org/cgi/man.cgi?query=setuid&amp;sektion=2&amp;format=html">setuid(2)</a> rendszerhívást.</p></div></td></tr></tbody></table></div><div class=paragraph><p>Ez a két speciális engedély (a <code>setuid</code> és a <code>setgid</code>) a programhoz tartozó engedélyek kiterjesztésével csökkentheti rendszerünk biztonságát. Ezzel szemben viszont a harmadik bemutatandó speciális engedély rendszerünk védelmének erõsítésére szolgál: ez az ún. <code>sticky</code> bit.</p></div><div class=paragraph><p>Ha a <code>sticky</code> típusú engedélyt könyvtárra adjuk meg, akkor a benne levõ állományok törlését kizárólag azok tulajdonosainak engedi. Ezzel az engedéllyel lényegében a <span class=filename>/tmp</span> könyvtárhoz hasonló nyilvános, bárki által elérhetõ könyvtárakban akadályozhatjuk meg az állományok idegen felhasználók általi törlését. Az engedély beállításához egy egyest (1) kell a többi elé fûznünk, mint például:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># chmod 1777 /tmp</span></code></pre></div></div><div class=paragraph><p>Most már az <code>ls</code> parancs segítségével láthatjuk ennek a hatását:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># ls -al / | grep tmp</span>
drwxrwxrwt  10 root  wheel          512 Aug 31 01:49 tmp</code></pre></div></div><div class=paragraph><p>A <code>sticky</code> bit a beállítások végén felbukkanó <code>t</code> révén azonosítható be.</p></div></div></div><div class=sect2><h3 id=dirstructure>3.4. A könyvtárak elrendezése<a class=anchor href=#dirstructure></a></h3><div class=paragraph><p>A FreeBSD könyvtárszerkezetének ismerete alapvetõ jelentõségû a rendszer egészének megértése szempontjából. Ezen belül is a legfontosabb a gyökérkönyvtár, a "/". Ez az elsõ könyvtár, amelyet a rendszer a rendszerindítás során csatlakoztat és a többfelhasználós mód elõkészítéséhez elegendhetlenül szükséges alaprendszert tartalmazza. A gyökérkönyvtár emellett csatlakozási pontokat szolgáltat a többfelhasználós mûködésre váltás során csatlakoztatandó további állományrendszerek számára.</p></div><div class=paragraph><p>A csatlakozási pont egy olyan könyvtár, ahová a szülõ állományrendszeren (ami gyakran maga a gyökér-állományrendszer) belül további állományrendszereket tudunk beoltani. Errõl bõvebben a <a href=#disk-organization>A lemezek szervezése</a>ban olvashatunk. A szabványos csatlakozási pontok: <span class=filename>/usr</span>, <span class=filename>/var</span>, <span class=filename>/tmp</span>, <span class=filename>/mnt</span> és <span class=filename>/cdrom</span>. Ezekre a könyvtárakra általában az <span class=filename>/etc/fstab</span> állományban találunk hivatkozásokat. Az <span class=filename>/etc/fstab</span> állomány a rendszer számára a különbözõ állományrendszerek és a hozzájuk tartozó csatlakozási pontok táblázatát tartalmazza. Az <span class=filename>/etc/fstab</span> állományban szereplõ legtöbb állományrendszer a rendszerindítás során automatikusan csatlakoztatásra kerül az <a href="https://man.freebsd.org/cgi/man.cgi?query=rc&amp;sektion=8&amp;format=html">rc(8)</a> szkriptbõl, hacsak nem tartalmazzák a <code>noauto</code> beállítást. Ennek részleteit a <a href=#disks-fstab>Az <span class=filename>fstab</span> állomány</a>ban találhatjuk meg.</p></div><div class=paragraph><p>Az állományrendszerek hierarchiájának teljes leírását a <a href="https://man.freebsd.org/cgi/man.cgi?query=hier&amp;sektion=7&amp;format=html">hier(7)</a> man oldalon olvashatjuk. Mi egyelõre most megelégszünk a leggyakrabban megjelenõ könyvtárak rövid áttekintésével.</p></div><table class="tableblock frame-none grid-all stretch informaltable"><col style=width:50%><col style=width:50%><thead><tr><th class="tableblock halign-left valign-top">Könyvtár</th><th class="tableblock halign-left valign-top">Mi található itt</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class=tableblock><span class=filename>/</span></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Az állományrendszer gyökere.</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><span class=filename>/bin/</span></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Az egy- és többfelhasználós környezetekben is egyaránt alapvetõ felhasználói segédprogramok.</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><span class=filename>/boot/</span></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Az operációs rendszer indítása során használt programok és konfigurációs állományok.</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><span class=filename>/boot/defaults/</span></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>A rendszerindítás alapértelmezett konfigurációs állományai. Lásd <a href="https://man.freebsd.org/cgi/man.cgi?query=loader.conf&amp;sektion=5&amp;format=html">loader.conf(5)</a></p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><span class=filename>/dev/</span></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Eszközleírók, lásd <a href="https://man.freebsd.org/cgi/man.cgi?query=intro&amp;sektion=4&amp;format=html">intro(4)</a>.</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><span class=filename>/etc/</span></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Rendszerkonfigurációs állományok és szkriptek.</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><span class=filename>/etc/defaults/</span></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Az alapértelmezett rendszerkonfigurációs állományok, lásd <a href="https://man.freebsd.org/cgi/man.cgi?query=rc&amp;sektion=8&amp;format=html">rc(8)</a>.</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><span class=filename>/etc/mail/</span></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>A <a href="https://man.freebsd.org/cgi/man.cgi?query=sendmail&amp;sektion=8&amp;format=html">sendmail(8)</a> programhoz hasonló levélküldõ rendszerek konfigurációs állományai.</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><span class=filename>/etc/namedb/</span></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>A <code>named</code> program konfigurációs állományai, lásd <a href="https://man.freebsd.org/cgi/man.cgi?query=named&amp;sektion=8&amp;format=html">named(8)</a>.</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><span class=filename>/etc/periodic/</span></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>A <a href="https://man.freebsd.org/cgi/man.cgi?query=cron&amp;sektion=8&amp;format=html">cron(8)</a> által naponta, hetente és havonta lefuttatandó szkriptek, lásd <a href="https://man.freebsd.org/cgi/man.cgi?query=periodic&amp;sektion=8&amp;format=html">periodic(8)</a>.</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><span class=filename>/etc/ppp/</span></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>A <code>ppp</code> program konfigurációs állományai, lásd <a href="https://man.freebsd.org/cgi/man.cgi?query=ppp&amp;sektion=8&amp;format=html">ppp(8)</a>.</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><span class=filename>/mnt/</span></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Egy üres könyvtár, amelyet a rendszergazdák általában ideiglenes csatlakozási pontként használnak.</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><span class=filename>/proc/</span></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>A futó programokat tartalmazó állományrendszer, lásd <a href="https://man.freebsd.org/cgi/man.cgi?query=procfs&amp;sektion=5&amp;format=html">procfs(5)</a>, illetve <a href="https://man.freebsd.org/cgi/man.cgi?query=mount_procfs&amp;sektion=8&amp;format=html">mount_procfs(8)</a>.</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><span class=filename>/rescue/</span></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Statikusan linkelt programok vészhelyzet esetére, lásd <a href="https://man.freebsd.org/cgi/man.cgi?query=rescue&amp;sektion=8&amp;format=html">rescue(8)</a>.</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><span class=filename>/root/</span></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>A <code>root</code> felhasználó könyvtára.</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><span class=filename>/sbin/</span></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Az egy- és többfelhasználós környezetekben fontos rendszerprogramok és rendszerfelügyeleti eszközök.</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><span class=filename>/tmp/</span></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Átmeneti állományok. A <span class=filename>/tmp</span> könyvtár tartalma általában NEM marad meg az újraindítás után. Erre a célra gyakran memóriában létrehozott állományrendszert szoktak csatlakoztatni a <span class=filename>/tmp</span> könyvtárba. Ez utóbbit az <a href="https://man.freebsd.org/cgi/man.cgi?query=rc.conf&amp;sektion=5&amp;format=html">rc.conf(5)</a> tmpmfs-re vonatkozó változóinak beállításával lehet automatikussá tenni (vagy a <span class=filename>/etc/fstab</span> megfelelõ módosításával, lásd <a href="https://man.freebsd.org/cgi/man.cgi?query=mdmfs&amp;sektion=8&amp;format=html">mdmfs(8)</a>).</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><span class=filename>/usr/</span></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>A felhasználói programok és alkalmazások többsége.</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><span class=filename>/usr/bin/</span></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Általános segédprogramok, programozási eszközök és alkalmazások.</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><span class=filename>/usr/include/</span></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Szabványos C include-állományok.</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><span class=filename>/usr/lib/</span></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Függvénykönyvtárak.</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><span class=filename>/usr/libdata/</span></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Egyéb hasznos adatállományok.</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><span class=filename>/usr/libexec/</span></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>(Más programok által használt) Rendszerdémonok és rendszereszközök.</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><span class=filename>/usr/local/</span></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>A helyi rendszeren telepített programok, függvénykönyvtárak stb. A FreeBSD portrendszere is ezt használja alapértelmezés szerint. A <span class=filename>/usr/local</span> könyvtáron belül a <a href="https://man.freebsd.org/cgi/man.cgi?query=hier&amp;sektion=7&amp;format=html">hier(7)</a> man oldalon található <span class=filename>/usr</span> könyvtár általános felépítése használatos. Ez alól kivételt képez a man alkönyvtár, amely közvetlenül a <span class=filename>/usr/local</span> alatt található, nem pedig a <span class=filename>/usr/local/share</span> könyvtáron belül, valamint a portok dokumentációja a <span class=filename>share/doc/port</span> könyvtárban található.</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><span class=filename>/usr/obj/</span></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>A <span class=filename>/usr/src</span> könyvtárfában található források fordítása során keletkezõ architektúrafüggõ objektumok.</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><span class=filename>/usr/ports/</span></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>A FreeBSD Portgyûjtemény (választható).</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><span class=filename>/usr/sbin/</span></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>(A felhasználók által használt) Rendszerdémonok és rendszereszközök.</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><span class=filename>/usr/shared/</span></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Architektúrafüggõ állományok.</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><span class=filename>/usr/src/</span></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>BSD és/vagy helyi források.</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><span class=filename>/usr/X11R6/</span></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Az X11R6 rendszer programjai, függvénykönyvtárai stb. (választható)</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><span class=filename>/var/</span></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Különféle napló, átmeneti, ideiglenes és pufferben tárolt állományok. A memóriában létrehozott állományrendszereket is olykor a <span class=filename>/var</span> könyvtárban találjuk. Ezt az <a href="https://man.freebsd.org/cgi/man.cgi?query=rc.conf&amp;sektion=5&amp;format=html">rc.conf(5)</a> állományban található varmfs-változók beállításával tehetjük automatikussá (vagy a <span class=filename>/etc/fstab</span> megfelelõ módosításával, lásd <a href="https://man.freebsd.org/cgi/man.cgi?query=mdmfs&amp;sektion=8&amp;format=html">mdmfs(8)</a>).</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><span class=filename>/var/log/</span></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Mindenféle rendszernaplók.</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><span class=filename>/var/mail/</span></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>A felhasználók postafiókjait tároló állományok.</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><span class=filename>/var/spool/</span></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>A nyomtatók és a levelezés puffereléséhez használt könyvtárak.</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><span class=filename>/var/tmp/</span></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Átmeneti állományok. Az itt található állományok általában megmaradnak a következõ rendszerindítás alkalmával is, hacsak a <span class=filename>/var</span> nem egy memóriában létezõ állományrendszer.</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><span class=filename>/var/yp</span></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>A NIS állományai.</p></td></tr></tbody></table></div><div class=sect2><h3 id=disk-organization>3.5. A lemezek szervezése<a class=anchor href=#disk-organization></a></h3><div class=paragraph><p>Az állománynév a legkisebb szervezési egység, amin keresztül a FreeBSD képes megtalálni az állományokat. Az állományok neveiben a kis- és nagybetût megkülönböztetjük, tehát a <span class=filename>readme.txt</span> és a <span class=filename>README.TXT</span> elnevezés két különbözõ állományra utal. A FreeBSD nem az állományok kiterjesztése (ami a konkrét példánkban a <span class=filename>.txt</span> volt) alapján dönti el, hogy az adott állomány vajon program, dokumentum vagy valamilyen más fajtájú adat.</p></div><div class=paragraph><p>Az állományok könyvtárakban tárolódnak. Egy könyvtár lehet akár üres (nincs benne egyetlen állomány sem), vagy többszáz állományt is tartalmazhat. Egy könyvtár ráadásul további könyvtárakat is tárolhat, és így az egymásban elhelyezkedõ könyvtárak segítségével könyvtárak egy hierarchiáját tudjuk felépíteni. Ezzel sokkalta könnyebben szervezhetõvé válnak az adataink.</p></div><div class=paragraph><p>Az állományokat és könyvtárakat úgy tudjuk elérni, ha megadjuk az állomány vagy a könyvtárt tároló könyvtár nevét, amit egy perjel, a <code>/</code> követ, valamint így összefûzve az eléréshez szükséges további könyvtárak felsorolása. Tehát, ha van egy <span class=filename>ize</span> nevû könyvtárunk, amelyben található egy <span class=filename>mize</span> könyvtár, amelyen belül pedig egy <span class=filename>readme.txt</span>, akkor ennek az állománynak a teljes neve, vagy másképpen szólva az <em>elérési útja</em> <span class=filename>ize/mize/readme.txt</span> lesz.</p></div><div class=paragraph><p>A könyvtárak és az állományok egy állományrendszerben tárolódnak. Minden állományrendszer pontosan egy könyvtárat tartalmaz a legfelsõ szintjén, amelyet az adott állományrendszer <em>gyökérkönyvtárának</em> nevezünk. Ez a gyökérkönyvtár tartalmazhat aztán további könyvtárakat.</p></div><div class=paragraph><p>Eddig még valószínûleg minden nagyon hasonló a más operációs rendszerekben tapasztalható fogalmakhoz. Azonban adónak különbségek: például az MS-DOS® a <code>\</code> jellel választja el az állományok és könyvtárak neveit, miközben a Mac OS® erre a <code>:</code> jelet használja.</p></div><div class=paragraph><p>A FreeBSD az elérési utakban sem betûkkel, sem pedig semmilyen más névvel nem jelöli meg a meghajtókat. Tehát a FreeBSD-ben nem írhatjuk, hogy a <span class=filename>c:/ize/mize/readme.txt</span>.</p></div><div class=paragraph><p>Helyette az egyik állományrendszert kijelölik <em>gyökér-állományrendszernek</em>. A gyökér-állományrendszer gyökérkönyvtárára hivatkoznak késõbb <code>/</code> könyvtárként. Ezután minden más állományrendszert a gyökér-állományrendszerhez <em>csatlakoztatunk</em>. Ennek értelmében nem számít, hogy mennyi lemezünk is van a FreeBSD rendszerünkben, hiszen minden könyvtár egyazon lemez részeként jelenik meg.</p></div><div class=paragraph><p>Tegyük fel, hogy van három állományrendszerünk, hívjuk ezeket <code>A</code>-nak, <code>B</code>-nek és <code>C</code>-nek. Minden állományrendszer rendelkezik egy gyökérkönyvtárral, amely két további könyvtárat tartalmaz: <code>A1</code>-et és <code>A2</code>-t (és ennek megfelelõen a többi <code>B1</code>-et és <code>B2</code>-t, valamint <code>C1</code> és <code>C2</code>-t).</p></div><div class=paragraph><p>Nevezzük <code>A</code>-t a gyökér-állományrendszernek. Ha a könyvtár tartalmának megjelenítéséhez most kiadnánk az <code>ls</code> parancsot, két alkönyvtárat látnánk, az <code>A1</code>-et és <code>A2</code>-t. A létrejött könyvtárfa valahogy így nézne ki:</p></div><div class=imageblock><div class=content><img src=../../../../images/books/handbook/basics/example-dir1.png alt="example dir1"></div></div><div class=paragraph><p>Egy állományrendszert csak egy másik állományrendszer valamelyik könyvtárába tudunk csatlakoztatni. Ezért most tételezzük fel, hogy a <code>B</code> állományrendszert az <code>A1</code> könyvtárba csatlakoztatjuk. Ezután a <code>B</code> gyökérkönyvtára átveszi a <code>A1</code> helyét az állományrendszerben, és ennek megfelelõen megjelennek a <code>B</code> könyvtárai is:</p></div><div class=imageblock><div class=content><img src=../../../../images/books/handbook/basics/example-dir2.png alt="example dir2"></div></div><div class=paragraph><p>A <code>B1</code> vagy <code>B2</code> könyvtárakban található állományok bármelyike innentõl kezdve a <span class=filename>/A1/B1</span>, illetve a <span class=filename>/A1/B2</span> elérési utakon érhetõek el. Az <span class=filename>A1</span> könyvtárban található állományok erre az idõre rejtve maradnak. Akkor fognak újra felbukkanni, ha a <code>B</code> állományrendszert <em>leválasztjuk</em> az <code>A</code> állományrendszerrõl.</p></div><div class=paragraph><p>Ha a <code>B</code> állományrendszert az <code>A2</code> könyvtárba csatlakoztatnánk, az iménti ábra nagyjából így nézne ki:</p></div><div class=imageblock><div class=content><img src=../../../../images/books/handbook/basics/example-dir3.png alt="example dir3"></div></div><div class=paragraph><p>és ennek megfelelõen az elõbb tárgyalt elérési utak <span class=filename>/A2/B1</span> és <span class=filename>/A2/B2</span> lennének.</p></div><div class=paragraph><p>Az állományrendszerek egymáshoz is csatlakoztathatóak. A példát ennek megfelelõen úgy is folytathatjuk, hogy a <code>C</code> állományrendszert csatlakoztatjuk <code>B</code> állományrendszerben található <code>B1</code> könyvtárhoz. Ennek eredménye a következõ elrendezés lesz:</p></div><div class=imageblock><div class=content><img src=../../../../images/books/handbook/basics/example-dir4.png alt="example dir4"></div></div><div class=paragraph><p>Vagy a <code>C</code> állományrendszer az <code>A1</code> könyvtáron keresztül csatlakoztatható akár közvetlenül az <code>A</code> állományrendszerhez is:</p></div><div class=imageblock><div class=content><img src=../../../../images/books/handbook/basics/example-dir5.png alt="example dir5"></div></div><div class=paragraph><p>Az MS-DOS® operációs rendszert ismerõk számára ez hasonló lehet a <code>join</code> parancshoz (habár teljesen nem egyezik meg vele).</p></div><div class=paragraph><p>Általában azonban ezzel nem kell törõdnünk, hiszen többnyire csak a FreeBSD telepítése során hozunk létre állományrendszereket és választjuk meg a csatlakozási pontjukat. A késõbbiekben ez legfeljebb akkor kerül elõ ismét, amikor újabb lemezeket adunk hozzá a rendszerhez.</p></div><div class=paragraph><p>Teljességgel megengedhetõ, hogy elhagyjuk a többit és csak egyetlen óriási gyökér-állományrendszert használjunk. Ennek viszont megvannak a maga hátrányai és az egyetlen elõnye.</p></div><div class=ulist><div class=title>Több állományrendszer használatának elõnyei</div><ul><li><p>A különbözõ állományrendszereknek különbözõ <em>csatlakoztatási beállításai</em> (mount options) lehetnek. Például, ha kellõen elõvigyázatosak akarunk lenni, a gyökér-állományrendszer írásvédett módon is csatlakoztatható, aminek köszönhetõen lehetetlenné válik a rendszer számára fontos állományok véletlen törlése vagy felülírása. Ha elkülönítjük a felhasználók számára írható állományrendszereket (például a <span class=filename>/home</span> könyvtárakat) a többi állományrendszertõl, lehetõvé válik számunkra, hogy <em>nosuid</em> beállítással csatlakoztassuk ezeket. Ez a beállítás megakadályozza, hogy ezekben a <em>suid</em>/<em>guid</em> bitekkel rendelkezõ végrehajtható állományok használhatóak legyenek, ezáltal növeli a rendszer biztonságosságát.</p></li><li><p>A FreeBSD az állományrendszer használatától függõen magától határoz a benne található állományok optimális kiosztását illetõen. Így tehát a gyakorta módosított, kisebb állományokat tartalmazó állományrendszerek esetén teljesen más technikákat alkalmaz, mint például a nagyobb, kevésbé változó állományok esetén. Azonban egyetlen állományrendszer használatával ez a gyorsítási módszer odavész.</p></li><li><p>Noha a FreeBSD állományrendszerei nagyon jól tûrik a hirtelen áramkimaradásokat, egy döntõ ponton bekövetkezõ váratlan leállás mégis kárt okozhat a szerkezetükben. Ha azonban több állományrendszerre osztjuk a tárolandó adatainkat, sokkal valószínûbbé válik, hogy egy ilyen eset után a rendszerünk talpra tud állni, és szükség esetén nekünk is könnyebb lesz a biztonsági mentéseinkbõl helyreállítani a sérült állományokat.</p></li></ul></div><div class=ulist><div class=title>Egyetlen állományrendszer használatának elõnyei</div><ul><li><p>Az állományrendszerek mérete rögzített. Miután a FreeBSD telepítése során létrehoztunk egy adott méretû állományrendszert, elõfordulhat, hogy késõbb szükségünk lesz a méretének növelésére. Ilyenkor nehezen kerülhetjük el az ilyenkor szokásos teendõket: biztonsági mentés készítése, az új méretnek megfelelõ állományrendszer létrehozása, majd ezután a lementett adataink visszaállítása.</p><div class="admonitionblock important"><table><tbody><tr><td class=icon><i class="fa icon-important" title=Important></i></td><td class=content><div class=paragraph><p>A FreeBSD-ben azonban megtalálható a <a href="https://man.freebsd.org/cgi/man.cgi?query=growfs&amp;sektion=8&amp;format=html">growfs(8)</a> parancs, amelynek segítségével az állományrendszerek mérete használat közben növelhetõ, és ezzel megszûnik a méretre vonatkozó korlátozás.</p></div></td></tr></tbody></table></div></li></ul></div><div class=paragraph><p>Az állományrendszerek partíciókban tárolódnak. A FreeBSD UNIX®-os eredete miatt azonban ez a kifejezés nem a hétköznapi "partíció" jelentését takarja (mint például egy MS-DOS® partíció). Minden partíciót egy betû azonosít <code>a</code>-tól <code>h</code>-ig. Mindegyik partíció csak egyetlen állományrendszert tartalmazhat, aminek révén az állományrendszereket vagy az állományrendszerek hierarchiájában található csatlakozási pontjukkal vagy pedig az ezeket tartalmazó partíció betûjével azonosíthatjuk.</p></div><div class=paragraph><p>A FreeBSD ezeken felül külön lemezterülen tárolja a <em>lapozóállomány</em>t (swap space). A lapozóállományt használja a FreeBSD <em>virtuális memória</em> (virtual memory) megvalósításához. Ennek köszönhetõen a számítógép képes úgy viselkedni, mintha jóval több memóriával rendelkezne, mint valójában. Így, amikor a FreeBSD kifogy a memóriából, egyszerûen kirakja a memóriából a lapozóállományba az éppen nem használt adatokat, majd amikor ismét szüksége lesz rájuk, visszatölti ezeket (és ilyenkor megint kirak valami mást).</p></div><div class=paragraph><p>Némely partícióhoz kötõdnek bizonyos megszokások.</p></div><table class="tableblock frame-none grid-all stretch informaltable"><col style=width:50%><col style=width:50%><thead><tr><th class="tableblock halign-left valign-top">Partíció</th><th class="tableblock halign-left valign-top">Megszokás</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>a</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Általában ez tartalmazza a gyökér-állományrendszert.</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>b</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Általában ez tartalmazza a lapozóállományt.</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>c</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Mérete általában a tartalmazó slice méretével egyezik meg. Ennek köszönhetõen a segédprogramok (például egy hibás szektorokat keresõ program) a <code>c</code> partíción keresztül képesek akár az egész slice-szal dolgozni. Normális esetben ezen a partíción nem hozunk létre állományrendszert.</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>d</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>A <code>d</code> partícióhoz egykoron kapcsolódott különleges jelentés, azonban mostanra ez már megszûnt, és a <code>d</code> egy teljesen átlagos partíciónak tekinthetõ.</p></td></tr></tbody></table><div class=paragraph><p>Minden állományrendszert tartalmazó partíciót a FreeBSD egy ún. <em>slice</em>-ban tárol. A FreeBSD számára a slice elnevezés utal mindarra, amit általában partíciónak neveznek, és ismét megemlítjük, mindez a UNIX®-os eredet miatt. A slice-okat 1-tõl 4-ig sorszámozzák.</p></div><div class=paragraph><p>A slice-ok sorszáma 1-tõl indulva az eszközök neve után egy <code>s</code> betûvel elválasztva következik. Így tehát a "da0<em>s1</em>" jelentése az elsõ slice lesz az elsõ SCSI-meghajtón. Lemezenként négy fizikai slice hozható létre, de ezeken belül tetszõleges típusú logikai slice-ok helyezhetõek el. Ezen további slice-ok sorszámozása 5-tõl kezdõdik, így ennek megfelelõen a "ad0<em>s5</em>" lesz az elsõ IDE-lemezen található elsõ kiterjesztett slice. Ezeket az eszközöket foglalják el a különbözõ állományrendszerek.</p></div><div class=paragraph><p>A slice-ok, a "veszélyesen dedikált" (Dangerously Dedicated) fizikai meghajtók, és minden más olyan meghajtó, amely <em>partíciókat</em> tartalmaz, <code>a</code>-tól <code>h</code>-ig jelölõdnek. Ez a betû az eszköz neve után következik, így ennek megfelelõen a "da0<em>a</em>" lesz az elsõ "da" meghajtó "a", vagyis a "veszélyesen dedikált" partíciója. Az "ad1s3<em>e</em>" lesz a második IDE-lemezmeghajtón a harmadik slice-ban szereplõ ötödik partíció.</p></div><div class=paragraph><p>Végezetül, a rendszerben minden lemezt azonosítunk. A lemez neve a típusára utaló kóddal kezdõdik, amely után aztán egy sorszám jelzi, hogy melyik lemezrõl is van szó. Azonban eltérõen a slice-okétól, a lemezek sorszámozása 0-tól indul. Az általánosan elterjedt kódolások a <a href=#basics-dev-codes>Lemezes eszközök kódjai</a>ban találhatóak.</p></div><div class=paragraph><p>Amikor hivatkozunk egy partícióra, a FreeBSD elvárja tõlünk, hogy nevezzük meg az adott partíciót tartalmazó slice-ot és lemezt is. Emiatt egy partícióra mindig úgy hivatkozunk, hogy elõször megadjuk a tartalmazó lemez nevét, ettõl <code>s</code>-sel elválasztva a tartalmazó slice sorszámát, majd ezt a partíció betûjelével zárjuk. Erre példákat a <a href=#basics-disk-slice-part>Példák lemezek, slice-ok és partíciók neveire</a>ban láthatunk.</p></div><div class=paragraph><p>Az érhetõség kedvéért a <a href=#basics-concept-disk-model>Egy lemez kialakításának sablonja</a> bemutatja egy lemez kiosztásának fogalmi sablonját.</p></div><div class=paragraph><p>A FreeBSD telepítéséhez elõször be kell állítani a lemezen található slice-okat, majd létrehozni benne a FreeBSD-hez használni kívánt partíciókat, kialakítani rajtuk az állományrendszereket (vagy a lapozóállományt) és eldönteni, melyik állományrendszert kívánjuk csatlakoztatni.</p></div><table id=basics-dev-codes class="tableblock frame-none grid-all stretch"><caption class=title>Táblázat 5. Lemezes eszközök kódjai</caption><col style=width:50%><col style=width:50%><thead><tr><th class="tableblock halign-left valign-top">Kód</th><th class="tableblock halign-left valign-top">Jelentés</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class=tableblock><span class=filename>ad</span></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>ATAPI (IDE) lemez</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><span class=filename>da</span></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>közvetlen hozzáférésû SCSI lemez</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><span class=filename>acd</span></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>ATAPI (IDE) CDROM</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><span class=filename>cd</span></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>SCSI CDROM</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><span class=filename>fd</span></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Floppylemez</p></td></tr></tbody></table><div id=basics-disk-slice-part class=exampleblock><div class=title>Példa 3. Példák lemezek, slice-ok és partíciók neveire</div><div class=content><table class="tableblock frame-none grid-all stretch informaltable"><col style=width:50%><col style=width:50%><thead><tr><th class="tableblock halign-left valign-top">Név</th><th class="tableblock halign-left valign-top">Jelentés</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>ad0s1a</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Az elsõ IDE lemezen (<code>ad0</code>) levõ elsõ slice (<code>s1</code>) elsõ partíciója (<code>a</code>).</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>da1s2e</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>A második SCSI-lemzen (<code>da1</code>) levõ második slice (<code>s2</code>) ötödik partíciója (<code>e</code>).</p></td></tr></tbody></table></div></div><div id=basics-concept-disk-model class=exampleblock><div class=title>Példa 4. Egy lemez kialakításának sablonja</div><div class=content><div class=paragraph><p>Az ábrán a rendszerhez csatlakoztatott elsõ IDE-lemez látható a FreeBSD szemszögébõl. Tegyük fel, hogy ez a lemez 4 GB méretû és két, egyenként 2 GB méretû slice-ot (avagy MS-DOS® partíciót) tartalmaz. Az elsõ slice egy MS-DOS® formátumú lemezt foglal magában, a <span class=filename>C:</span> meghajtót, illetve a második slice egy telepített FreeBSD-t tartalmaz. Ebben a példában a FreeBSD három adatot és egy lapozóállományt tároló partícióval rendelkezik.</p></div><div class=paragraph><p>A három partíció mindegyikén találhatunk egy-egy állományrendszert. Az <code>a</code> partíció lesz a gyökér-állományrendszer, az <code>e</code> lesz a rendszerünkben a <span class=filename>/var</span> és az <code>f</code> pedig a <span class=filename>/usr</span> könyvtár.</p></div><div class=imageblock><div class=content><img src=../../../../images/books/handbook/basics/disk-layout.png alt="disk layout"></div></div></div></div></div><div class=sect2><h3 id=mount-unmount>3.6. Állományrendszerek csatlakoztatása és leválasztása<a class=anchor href=#mount-unmount></a></h3><div class=paragraph><p>Az állományrendszereket legkönnyebben egy-egy faként tudjuk magunk elõtt elképzelni, amelyek a <span class=filename>/</span> könyvtárból nõnek ki. A <span class=filename>/dev</span>, <span class=filename>/usr</span> és mellettük szereplõ, hozzájuk hasonló összes többi könyvtár csupán egy-egy ág, amelyeknek saját ágaik is lehetnek, mint például a <span class=filename>/usr/local</span> és így tovább.</p></div><div class=paragraph><p>Különféle okai vannak annak, hogy egyes könyvtárakat különálló állományrendszereken tárolunk. A <span class=filename>/var</span> könyvtár tartalmazza a <span class=filename>log/</span>, <span class=filename>spool/</span> könyvtárakat és különféle átmeneti állományokat, azonban az ilyen állományok könnyen megszaporodhatnak és megtölthetik az állományrendszert. Mivel a gyökér-állományrendszert nem tanácsos elárasztani mindenféle állománnyal, ezért gyakran a hasznunkra válhat, ha a <span class=filename>/var</span> könyvtárat leválasztjuk a <span class=filename>/</span> könyvtárból.</p></div><div class=paragraph><p>A másik gyakori ok, ami az imént említett fa egyes ágainak különbözõ állományrendszereken történõ tárolását indokolja, hogy ezek gyakran más fizikai vagy virtuális lemezeken, például a rendszerhez csatlakoztatott <a href=./#network-nfs>Hálózati állományrendszer</a>eken vagy éppen CD-meghajtókon találhatóak.</p></div><div class=sect3><h4 id=disks-fstab>3.6.1. Az <span class=filename>fstab</span> állomány<a class=anchor href=#disks-fstab></a></h4><div class=paragraph><p>A <a href=./#boot>rendszerindítás folyamata</a> során az <span class=filename>/etc/fstab</span> állományban felsorolt állományrendszerek maguktól kerülnek csatlakoztatásra (kivéve amikor a <code>noauto</code> beállítással szerepelnek).</p></div><div class=paragraph><p>Az <span class=filename>/etc/fstab</span> állományban található sorok az alábbi szerkezetûek:</p></div><div class="literalblock programlisting"><div class=content><pre>eszköz       /csatlakozási-pont típus     beállítások      mentésigyak     ellszám</pre></div></div><div class=dlist><dl><dt class=hdlist1><code>eszköz</code></dt><dd><p>A <a href=./#disks-naming>Az eszközök elnevezései</a>ban leírtak szerint megnevezett (létezõ) eszköz.</p></dd><dt class=hdlist1><code>csatlakozási-pont</code></dt><dd><p>Egy (létezõ) könyvtár, ahova az állományrendszer csatlakozik.</p></dd><dt class=hdlist1><code>típus</code></dt><dd><p>Az állományrendszer <a href="https://man.freebsd.org/cgi/man.cgi?query=mount&amp;sektion=8&amp;format=html">mount(8)</a> parancs szerint ismert típusa. A FreeBSD alapértelmezett állományrendszere az <code>ufs</code>.</p></dd><dt class=hdlist1><code>beállítások</code></dt><dd><p>Az írható-olvasható állományrendszerek esetén <code>rw</code>, az írásvédettek esetén pedig <code>ro</code>, amelyet igény szerint további beállítások követhetnek. A rendszerindítás során automatikusan nem csatlakoztatandó állományrendszerek esetén gyakran alkalmazott beállítás itt még a <code>noauto</code>. Egyéb lehetõségeket a <a href="https://man.freebsd.org/cgi/man.cgi?query=mount&amp;sektion=8&amp;format=html">mount(8)</a> man oldalon láthatunk.</p></dd><dt class=hdlist1><code>mentésigyak</code></dt><dd><p>Ezt általában a <a href="https://man.freebsd.org/cgi/man.cgi?query=dump&amp;sektion=8&amp;format=html">dump(8)</a> parancs használja a menteni szükséges állományrendszerek megállapításához. Amennyiben hiányzik ez a mezõ, az automatikusan a nulla értéket jelöli.</p></dd><dt class=hdlist1><code>ellszám</code></dt><dd><p>Megadja, hogy mely állományrendszereket kell ellenõrizni. A nullás <code>pass</code> értékkel rendelkezõ állományrendszerek nem kerülnek ellenõrzésre. A gyökér-állományrendszer (melyet minden más elõtt kell ellenõrizni) <code>passno</code> értéke egy, míg az összes többi állományrendszer <code>passno</code> értéke általában egytõl különbözõ. Ha egynél több állományrendszer is ugyanazt a <code>passno</code> értéket kapta, akkor az <a href="https://man.freebsd.org/cgi/man.cgi?query=fsck&amp;sektion=8&amp;format=html">fsck(8)</a> a lehetõségei szerint megpróbálja ezeket egyszerre ellenõrizni.</p></dd></dl></div><div class=paragraph><p>Az <span class=filename>/etc/fstab</span> felépítésérõl és a benne használható beállításokról bõvebben a <a href="https://man.freebsd.org/cgi/man.cgi?query=fstab&amp;sektion=5&amp;format=html">fstab(5)</a> man oldalon olvashatunk.</p></div></div><div class=sect3><h4 id=disks-mount>3.6.2. A <code>mount</code> parancs<a class=anchor href=#disks-mount></a></h4><div class=paragraph><p>Az állományrendszerek tényleges csatlakoztatására avagy "mountolására" a <a href="https://man.freebsd.org/cgi/man.cgi?query=mount&amp;sektion=8&amp;format=html">mount(8)</a> parancs használható.</p></div><div class=paragraph><p>Legegyszerûbb formája:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># mount eszköz csatlakozási-pont</span></code></pre></div></div><div class=paragraph><p>Ahogy a <a href="https://man.freebsd.org/cgi/man.cgi?query=mount&amp;sektion=8&amp;format=html">mount(8)</a> man oldalán is olvashatjuk, itt rengeteg opció is megadható, de ezek közül a leggyakoribbak:</p></div><div class=dlist><div class=title>Csatlakoztatási opciók</div><dl><dt class=hdlist1><code>-a</code></dt><dd><p>Csatlakoztatja az <span class=filename>/etc/fstab</span> állományban felsorolt összes állományrendszert, kivéve azokat, amelyek a "noauto" beállítást tartalmazzák, vagy kizártuk a <code>-t</code> kapcsolóval, esetleg korábban már csatlakoztattuk.</p></dd><dt class=hdlist1><code>-d</code></dt><dd><p>A tényleges csatlakoztatás elvégzése nélkül végrehajt minden mást. Ez az opció leginkább <code>-v</code> opcióval együtt használható annak megállapítására, hogy a <a href="https://man.freebsd.org/cgi/man.cgi?query=mount&amp;sektion=8&amp;format=html">mount(8)</a> valójában mit is akar csinálni.</p></dd><dt class=hdlist1><code>-f</code></dt><dd><p>Egy nem tiszta állományrendszer csatlakoztatásának kényszerítése (veszélyes!) vagy egy korábban már csatlakoztatott állományrendszer írható állapotának felfüggesztése.</p></dd><dt class=hdlist1><code>-r</code></dt><dd><p>Az állományrendszer írásvédett csatlakoztatása. Megegyezik a <code>-o</code> opciónál megadható <code>ro</code> (vagy a FreeBSD 5.2-nél régebbi verziója esetén a <code>rdonly</code>) beállítás használatával.</p></dd><dt class=hdlist1><code>-t</code> <em>típus</em></dt><dd><p>Az adott állományrendszert az adott típusnak megfelelõen csatlakoztatja, vagy az <code>-a</code> használata esetén csak az adott típusú állományrendszereket.</p><div class=paragraph><p>Az "ufs" az állományrendszerek alapértelmezett típusa.</p></div></dd><dt class=hdlist1><code>-u</code></dt><dd><p>Frissíti az állományrendszerre vonatkozó csatlakoztatási beállításokat.</p></dd><dt class=hdlist1><code>-v</code></dt><dd><p>Részletesebb kijelzés.</p></dd><dt class=hdlist1><code>-w</code></dt><dd><p>Az állományrendszer csatlakoztatása írásra és olvasásra.</p></dd></dl></div><div class=paragraph><p>Az <code>-o</code> opció után vesszõvel elválasztott beállításokat adhatunk meg, többek közt az alábbiakat:</p></div><div class=dlist><dl><dt class=hdlist1>noexec</dt><dd><p>Az állományrendszeren található állományok végrehajtásának tiltása. Ez egy nagyon hasznos biztonsági beállítás.</p></dd><dt class=hdlist1>nosuid</dt><dd><p>Az állományrendszeren nem használhatóak a felhasználó- (setuid) vagy csoportváltásra (setgid) vonatkozó engedélyek. Nagyon hasznos biztonsági beállítás.</p></dd></dl></div></div><div class=sect3><h4 id=disks-umount>3.6.3. Az <code>umount</code> parancs<a class=anchor href=#disks-umount></a></h4><div class=paragraph><p>Az <a href="https://man.freebsd.org/cgi/man.cgi?query=umount&amp;sektion=8&amp;format=html">umount(8)</a> parancs paraméterként egy csatlakozási pontot, egy eszköznevet vagy a <code>-a</code>, illetve az <code>-A</code> opciókat várja.</p></div><div class=paragraph><p>A leválasztás kényszerítéséhez mindegyik alakban szerepelhet az <code>-f</code> opció, valamint a részletesebb kijelzést a <code>-v</code> opcióval kapcsolhatjuk be. Azonban szeretnénk mindenkit figyelmeztetni, hogy a <code>-f</code> használata alapvetõen nem ajánlott. Az erõszakkal leválasztott állományrendszerek összeomlaszthatják a számítógépet vagy kárt okozhatnak az állományrendszereken található adatokban.</p></div><div class=paragraph><p>Az <code>-a</code> és <code>-A</code> opciók használatosak az összes csatlakoztatott állományrendszer leválasztására, amelyek típusait a <code>-t</code> opció megadása után sorolhatjuk fel. Fontos különbség azonban, hogy az <code>-A</code> opció a gyökér állományrendszert nem próbálja meg leválasztani.</p></div></div></div><div class=sect2><h3 id=basics-processes>3.7. Folyamatok<a class=anchor href=#basics-processes></a></h3><div class=paragraph><p>A FreeBSD egy többfeladatos operációs rendszer. Ez azt jelenti, hogy képes látszólag egyszerre több programot is futtatni. Az így egyszerre futó programokat egyenként <em>folyamat</em>oknak (process) nevezzük. Minden kiadott parancsunk elindít legalább egy ilyen folyamatot, és a rendszerünk mozgásban tartásához bizonyos rendszerszintû folyamatok állandóan futnak a háttérben.</p></div><div class=paragraph><p>Minden folyamatot egy <em>folyamatazonosító</em>nak (process ID vagy <em>PID</em>) nevezett szám azonosít egyértelmûen, és az állományokhoz hasonlóan, minden folyamatnak van tulajdonosa és csoportja is. A tulajdonos és a csoport ismeretében állapítja meg a rendszer, hogy az adott folyamat a korábban említett engedélyek szerint milyen állományokhoz és eszközökhöz férhet hozzá. Ezenkívül a legtöbb folyamatnak van még egy szülõfolyamata is. A szülõfolyamat az a folyamat, amely az adott folyamatot elindította. Például amikor parancsokat adunk egy parancsértelmezõn keresztül, akkor maga a parancsértelmezõ is egy ilyen folyamat lesz ugyanúgy, ahogy a benne kiadott parancsok által elindított programok. Ennek megfelelõen az így létrehozott összes folyamat szülõje maga a parancsértelmezõ folyamata lesz. Az említettek alól egyik kivétel az <a href="https://man.freebsd.org/cgi/man.cgi?query=init&amp;sektion=8&amp;format=html">init(8)</a> nevû speciális folyamat. Az <code>init</code> lesz a rendszerben mindig az elsõ folyamat, ezért a PID-je is mindig 1. Az <code>init</code> programot a FreeBSD indulásakor a rendszermag fogja automatikusan elindítani.</p></div><div class=paragraph><p>A rendszerben futó programok vizsgálatához két, különösen hasznos parancsot találhatunk: ezek a <a href="https://man.freebsd.org/cgi/man.cgi?query=ps&amp;sektion=1&amp;format=html">ps(1)</a> és a <a href="https://man.freebsd.org/cgi/man.cgi?query=top&amp;sektion=1&amp;format=html">top(1)</a>. A <code>ps</code> parancs használatos a pillanatnyilag futó programok statikus listájának megjelenítésére. Ebben olvashatjuk a futó programok azonosítóit, mennyi memóriát használnak éppen, milyen paranccsal indították ezeket stb. A <code>top</code> parancs mutatja az összes aktívan futó programot, majd néhány másodpercenként automatikusan frissíti ezt a listát, aminek révén folyamatosan láthatjuk, miként viselkednek a futó programok.</p></div><div class=paragraph><p>A <code>ps</code> alapértelmezés szerint csupán az általunk futtatott programokat mutatja. Például:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>% ps
  PID  TT  STAT      TIME COMMAND
  298  p0  Ss     0:01.10 tcsh
 7078  p0  S      2:40.88 xemacs mdoc.xsl <span class=o>(</span>xemacs-21.1.14<span class=o>)</span>
37393  p0  I      0:03.11 xemacs freebsd.dsl <span class=o>(</span>xemacs-21.1.14<span class=o>)</span>
48630  p0  S      2:50.89 /usr/local/lib/netscape-linux/navigator-linux-4.77.bi
48730  p0  IW     0:00.00 <span class=o>(</span>dns helper<span class=o>)</span> <span class=o>(</span>navigator-linux-<span class=o>)</span>
72210  p0  R+     0:00.00 ps
  390  p1  Is     0:01.14 tcsh
 7059  p2  Is+    1:36.18 /usr/local/bin/mutt <span class=nt>-y</span>
 6688  p3  IWs    0:00.00 tcsh
10735  p4  IWs    0:00.00 tcsh
20256  p5  IWs    0:00.00 tcsh
  262  v0  IWs    0:00.00 <span class=nt>-tcsh</span> <span class=o>(</span>tcsh<span class=o>)</span>
  270  v0  IW+    0:00.00 /bin/sh /usr/X11R6/bin/startx <span class=nt>--</span> <span class=nt>-bpp</span> 16
  280  v0  IW+    0:00.00 xinit /home/nik/.xinitrc <span class=nt>--</span> <span class=nt>-bpp</span> 16
  284  v0  IW     0:00.00 /bin/sh /home/nik/.xinitrc
  285  v0  S      0:38.45 /usr/X11R6/bin/sawfish</code></pre></div></div><div class=paragraph><p>Ahogy az a fenti példában is látszik, a <a href="https://man.freebsd.org/cgi/man.cgi?query=ps&amp;sektion=1&amp;format=html">ps(1)</a> kimenete oszlopokra tagolható. Ezek közül a <code>PID</code> tartalmazza a korábban már ismertetett folyamatazonosítókat. Az azonosítók 1-tõl indulva egészen 99999-ig sorszámozódhatnak, illetve ha kifutnánk belõlük, akkor a számozás kezdõdik elölrõl (azonban a használatban levõ azonosítók sosem kerülnek újra kiosztásra). A <code>TT</code> oszlopban láthatjuk azt a terminált, amelyen az adott program éppen fut, de ezt pillanatnyilag akár nyugodtan figyelmen kívül is hagyhatjuk. A <code>STAT</code> oszlopban a program állapotát kapjuk meg, de szintén átugorható. A <code>TIME</code> a program processzoron eltöltött idejét mutatja - ez általában nem arra utal, hogy mennyi ideje fut maga a program, hiszen a legtöbb program sok idõt tölt tétlenül, mielõtt egyáltalán szüksége lenne processzora. Végezetül a <code>COMMAND</code> oszlopban olvashatjuk azt a parancsot, amellyel a programot elindították.</p></div><div class=paragraph><p>A <a href="https://man.freebsd.org/cgi/man.cgi?query=ps&amp;sektion=1&amp;format=html">ps(1)</a> számos különféle beállítást ismer az általa megjelenített információk megválasztásához. Az egyik ilyen leghasznosabb beállítás az <code>auxww</code>: az <code>a</code> segítségével az összes futó programot láthatjuk, nem csak a sajátjainkat; az <code>u</code> megadásával láthatóvá válik a folyamat tulajdonosának a felhasználói neve, valamint a memóriahasználata is; az <code>x</code> megmutatja a démon (avagy háttér)folyamatok adatait is és a <code>ww</code> hatására pedig a <a href="https://man.freebsd.org/cgi/man.cgi?query=ps&amp;sektion=1&amp;format=html">ps(1)</a> az összes folyamathoz a teljes parancssort kiírja, még akkor is, ha nem férne ki a képernyõre.</p></div><div class=paragraph><p>A <a href="https://man.freebsd.org/cgi/man.cgi?query=top&amp;sektion=1&amp;format=html">top(1)</a> kimenete is hasonló. Ha elindítjuk, általában ezt láthatjuk:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>% top
last pid: 72257<span class=p>;</span>  load averages:  0.13,  0.09,  0.03    up 0+13:38:33  22:39:10
47 processes:  1 running, 46 sleeping
CPU states: 12.6% user,  0.0% <span class=nb>nice</span>,  7.8% system,  0.0% interrupt, 79.7% idle
Mem: 36M Active, 5256K Inact, 13M Wired, 6312K Cache, 15M Buf, 408K Free
Swap: 256M Total, 38M Used, 217M Free, 15% Inuse

  PID USERNAME PRI NICE  SIZE    RES STATE    TIME   WCPU    CPU COMMAND
72257 nik       28   0  1960K  1044K RUN      0:00 14.86%  1.42% top
 7078 nik        2   0 15280K 10960K <span class=k>select   </span>2:54  0.88%  0.88% xemacs-21.1.14
  281 nik        2   0 18636K  7112K <span class=k>select   </span>5:36  0.73%  0.73% XF86_SVGA
  296 nik        2   0  3240K  1644K <span class=k>select   </span>0:12  0.05%  0.05% xterm
48630 nik        2   0 29816K  9148K <span class=k>select   </span>3:18  0.00%  0.00% navigator-linu
  175 root       2   0   924K   252K <span class=k>select   </span>1:41  0.00%  0.00% syslogd
 7059 nik        2   0  7260K  4644K poll     1:38  0.00%  0.00% mutt
...</code></pre></div></div><div class=paragraph><p>A kimenet két részre osztható. A fejlécben (vagyis az elsõ öt sorban) látható az utoljára futtatott program azonosítója (PID), a rendszer átlagos terhelése (load average, amellyel mérjük, hogy a rendszerünk mennyire lefoglalt), a rendszer indítása óta eltelt idõ (up mint uptime) és a jelenlegi idõ. A fejlécben még megtalálhatjuk azt is, mennyi program fut (esetünkben ez most 47), mennyi memóriát és lapozóállományt használnak, és mennyi idõt tölt a rendszer a processzor különbözõ állapotaiban.</p></div><div class=paragraph><p>A fejléc alatt a <a href="https://man.freebsd.org/cgi/man.cgi?query=ps&amp;sektion=1&amp;format=html">ps(1)</a> kimenetéhez hasonló módon oszlopokba rendezve találhatjuk meg a folyamatok adatait: az azonosítóikat, a tulajdonosaik nevét, a felhasznált processzoridõt, a futtatott parancsot. A <a href="https://man.freebsd.org/cgi/man.cgi?query=top&amp;sektion=1&amp;format=html">top(1)</a> alapértelmezés szerint mutatja a futó programok által használt memória mennyiségét is: ez további két oszlopra oszlik, ahol az egyikben a teljes memóriafoglalást (SIZE), a másikban pedig a jelen pillanatban aktívan használt memóriát (RES) láthatjuk. A példában látható is, hogy a <a href="https://man.freebsd.org/cgi/man.cgi?query=getenv&amp;sektion=3&amp;format=html">getenv(3)</a> (navigator-linu) alkalmazásnak majdnem 30 MB-nyi memóriára van szüksége, de ebbõl aktívan csak 9 MB-ot használ.</p></div><div class=paragraph><p>A <a href="https://man.freebsd.org/cgi/man.cgi?query=top&amp;sektion=1&amp;format=html">top(1)</a> a kijelzést minden második másodpercben magától frissíti, de ez az <code>s</code> kapcsolóval állítható.</p></div></div><div class=sect2><h3 id=basics-daemons>3.8. Démonok, jelzések és a futó programok leállítása<a class=anchor href=#basics-daemons></a></h3><div class=paragraph><p>Amikor elindítunk egy szövegszerkesztõt, nem sok gondunk akad az irányításával, könnyen utasíthatjuk az állományok betöltésére és így tovább. Mindezt azért tehetjük meg, mert a szövegszerkesztõ erre lehetõséget biztosít és mivel a szövegszerkesztõ egy <em>terminál</em>hoz kapcsolódik. Egyes programok azonban nem úgy lettek kialakítva, hogy állandóan a felhasználó utasításaira támaszkodjanak, ezért az elsõ adandó alkalommal lekapcsolódnak a terminálról. Például egy webszerver egész nap csak webes kéréseket válaszol meg, és általában semmi szüksége nincs a felhasználók utasításaira. A szerverek között leveleket közvetítõ programok is ugyanezen osztályba tartoznak.</p></div><div class=paragraph><p>Ezeket a programokat <em>démon</em>onoknak hívjuk. A démonok a görög mitológiában jelentek meg: sem a jót, sem pedig a gonoszt nem képviselték, egyszerû apró szellemecskék voltak, akik az emberiség javát szolgálták, pontosan úgy, ahogy ma teszik azt a különféle web- és levelezõ szerverek. Ezért is ábrázolták sokáig a BSD kabalafiguráját is egy tornacipõs, vasvillás vidám démonként.</p></div><div class=paragraph><p>A démonként futó programok nevéhez a hagyományok szerint hozzá szokták fûzni a "d" betût. A BIND a Berkeley Internet Name Domain (névfeloldó) szolgáltatása, azonban a hozzá tartozó program neve <code>named</code>, az Apache webszerver programját <code>httpd</code>-nek nevezik, a sornyomtató kezeléséért felelõs démon pedig az <code>lpd</code> és így tovább. Ez csupán egy hagyomány, megszokás, nem pedig egy kõbe vésett szabály: például a Sendmail levelezõ démonának neve <code>sendmail</code> és nem pedig <code>maild</code>.</p></div><div class=paragraph><p>Néha azért szükségünk lehet arra, hogy felvegyük valahogy a kapcsolatot a démonként futó programokkal is. Ennek egyik lehetséges módja a <em>jelzés</em>ek (signal) küldése (de alapvetõen bármilyen futó programnak küldhetünk). Több különféle jelzés küldhetõ - egyeseknek közülük megkülönböztetett jelentése van, másokat magukat az alkalmazások értelmeznek, amelyrõl a dokumentációjukban tájékozódhatunk. A <a href="https://man.freebsd.org/cgi/man.cgi?query=kill&amp;sektion=1&amp;format=html">kill(1)</a> vagy <a href="https://man.freebsd.org/cgi/man.cgi?query=kill&amp;sektion=2&amp;format=html">kill(2)</a> paranccsal más tulajdonában levõ futó programoknak nem tudunk jelzéseket küldeni, ami alól egyedüli kivétel a <code>root</code> felhasználó.</p></div><div class=paragraph><p>Bizonyos esetekben a FreeBSD maga is küld néha jelzéseket. Amikor egy alkalmazást rosszul programoznak le és megpróbál egy számára tiltott memóriaterülethez hozzáférni, a FreeBSD küld neki egy <em>Segmentation Violation</em> (<code>SIGSEGV</code>, szegmentálási hiba) jelzést. Ha egy alkalmazás az <a href="https://man.freebsd.org/cgi/man.cgi?query=alarm&amp;sektion=3&amp;format=html">alarm(3)</a> rendszerhíváson keresztül kér egy adott idõ utáni bekövetkezõ értesítést, akkor kap errõl egy Alarm (<code>SIGALRM</code>) jelzést és így tovább.</p></div><div class=paragraph><p>A folyamatok leállítására két jelzés használható: a <code>SIGTERM</code> (befejeztetés) és a <code>SIGKILL</code> (leállítás). A <code>SIGTERM</code> a folyamatok leállításának illedelmes módja, mivel ekkor a futó program képes <em>elkapni</em> ezt a jelzést és észrevenni, hogy le akarjuk állítani. Ilyenkor a leállítás elõtt lehetõsége van szabályosan lezárni a naplóit és általánosságban véve befejezni mindent, amit éppen csinál. Elõfordulhat azonban, hogy a folyamatok figyelmen kívül hagyják a <code>SIGTERM</code> jelzést, ha például éppen egy félbeszakíthatatlan feladat közepén tartanak.</p></div><div class=paragraph><p>A <code>SIGKILL</code> jelzést azonban egyetlen futó program sem hagyhatja figyelmen kívül. Ez lenne a "Nem érdekel, mivel foglalkozol, azonnal hagyd abba!" jelzés. Amikor <code>SIGKILL</code> jelzést küldünk egy folyamatnak, a FreeBSD leállítja a folyamatot ott és ahol tart .</p></div><div class=paragraph><p>További használható jelzések: <code>SIGHUP</code>, <code>SIGUSR1</code> és <code>SIGUSR2</code>. Ezek általános célú jelzések, amelyeket az alkalmazások eltérõ módokon kezelnek.</p></div><div class=paragraph><p>Tegyük fel, hogy megváltoztattuk a webszerverünk beállításait tartalmazó állományt - valamilyen módon szeretnénk tudatni a szerverrel, hogy olvassa be újra a beállításait. Ezt megtehetjük úgy, hogy leállítjuk és újraindítjuk a <code>httpd</code> démont, de ezzel kiesést okozhatunk a szerver mûködésében, amit viszont nem engedhetünk meg. A legtöbb démont úgy készítették el, hogy a <code>SIGHUP</code> jelzés hatására olvassa be újra a beállításait tartalmazó állományt. Így a <code>httpd</code> leállítása és újraindítása helyett egyszerûen elegendõ egy <code>SIGHUP</code> jelzés küldése. Mivel azonban ez nem szabványosított, a különbözõ démonok ezt a jelzést többféleképpen is értelmezhetik. Ezért a használata elõtt ennek mindenképpen járjunk utána a kérdéses démon dokumentációjában.</p></div><div class=paragraph><p>A jelzéseket a <a href="https://man.freebsd.org/cgi/man.cgi?query=kill&amp;sektion=1&amp;format=html">kill(1)</a> paranccsal tudjuk elküldeni, ahogy ezt a következõ példában is láthatjuk.</p></div><div class="exampleblock procedure"><div class=content><div class=paragraph><p><strong>Procedure: Jelzés küldése egy futó programnak</strong></p></div><div class=paragraph><p>Ebben a példában megmutatjuk, hogyan lehet jelzést küldeni az <a href="https://man.freebsd.org/cgi/man.cgi?query=inetd&amp;sektion=8&amp;format=html">inetd(8)</a> démonnak. Az <code>inetd</code> a beállításait az <span class=filename>/etc/inetd.conf</span> állományban tárolja, és az <code>inetd</code> a <code>SIGHUP</code> jelzés hatására képes újraolvasni ezt.</p></div><div class="olist arabic"><ol class=arabic><li><p>Keressük meg annak a folyamatnak az azonosítóját, amelynek a jelzést kívánjuk küldeni. Ezt a <a href="https://man.freebsd.org/cgi/man.cgi?query=ps&amp;sektion=1&amp;format=html">ps(1)</a> és a <a href="https://man.freebsd.org/cgi/man.cgi?query=grep&amp;sektion=1&amp;format=html">grep(1)</a> használatával tehetjük meg. A <a href="https://man.freebsd.org/cgi/man.cgi?query=grep&amp;sektion=1&amp;format=html">grep(1)</a> parancs segítségével más parancsok kimenetében tudunk megkeresni egy általunk megadott szöveget. Ezt a parancsot átlagos felhasználóként futtatjuk, azonban az <a href="https://man.freebsd.org/cgi/man.cgi?query=inetd&amp;sektion=8&amp;format=html">inetd(8)</a> démont a <code>root</code> birtokolja, ezért az <a href="https://man.freebsd.org/cgi/man.cgi?query=ps&amp;sektion=1&amp;format=html">ps(1)</a> használata során meg kell adnunk az <code>ax</code> kapcsolókat is.</p><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>% ps <span class=nt>-ax</span> | <span class=nb>grep </span>inetd
  198  ??  IWs    0:00.00 inetd <span class=nt>-wW</span></code></pre></div></div><div class=paragraph><p>Innen kiderül, hogy az <a href="https://man.freebsd.org/cgi/man.cgi?query=inetd&amp;sektion=8&amp;format=html">inetd(8)</a> azonosítója 198. Elõfordulhat, hogy az eredményben maga a <code>grep inetd</code> parancs is megjelenik. Ez a <a href="https://man.freebsd.org/cgi/man.cgi?query=ps&amp;sektion=1&amp;format=html">ps(1)</a> listázási módszere miatt következhet be.</p></div></li><li><p>A jelzés elküldésére használjuk a <a href="https://man.freebsd.org/cgi/man.cgi?query=kill&amp;sektion=1&amp;format=html">kill(1)</a> parancsot. Mivel az <a href="https://man.freebsd.org/cgi/man.cgi?query=inetd&amp;sektion=8&amp;format=html">inetd(8)</a> démont a <code>root</code> felhasználó futtatja, ehhez elõször a <a href="https://man.freebsd.org/cgi/man.cgi?query=su&amp;sektion=1&amp;format=html">su(1)</a> parancs kiadásával nekünk is <code>root</code> felhasználóvá (rendszeradminisztrátorrá) kell válnunk.</p><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>% su
Password:
<span class=c># /bin/kill -s HUP 198</span></code></pre></div></div><div class=paragraph><p>Ahogy az a legtöbb UNIX® esetén elfogadott, a sikeres végrehajtás esetén a <a href="https://man.freebsd.org/cgi/man.cgi?query=kill&amp;sektion=1&amp;format=html">kill(1)</a> sem válaszol semmit. Amikor viszont nem egy saját programunknak akarunk jelzést küldeni, akkor a <code>kill: <em>PID</em>: Operation not permitted</code> (a mûvelet nem engedélyezett) hibaüzenetet látunk. Ha véletlenül elgépeltük volna a futó program azonosítóját, akkor a küldendõ jelzés nem a megfelelõ folyamatnál fog kikötni (ami nem éppen jó), vagy ha szerencsénk van, akkor a jelzést egy éppen használaton kívüli azonosítóra küldtük. Az utóbbi esetben a következõ láthatjuk: <code>kill: <em>PID</em>: No such process</code> (nincs ilyen folyamat).</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=title>Miért <code>/bin/kill</code>?</div><div class=paragraph><p>A legtöbb parancsértelmezõ beépítetten tartalmazza a saját <code>kill</code> parancsát, tehát ilyenkor közvetlenül maga a parancsértelmezõ küldi a jelzést, nem pedig a <span class=filename>/bin/kill</span> programon keresztül. Ez gyakran a javunkra válhat, azonban a küldhetõ jelzések megadása parancsértelmezõnként eltérhet. Így, ahelyett, hogy egyenként ismernünk kellene mindegyiket, sokkal egyszerûbb közvetlenül a <code>/bin/kill …​</code> parancsot használni.</p></div></td></tr></tbody></table></div></li></ol></div></div></div><div class=paragraph><p>A többi jelzés küldése is nagyon hasonló módon történik, hiszen elegendõ csupán a <code>TERM</code> vagy a <code>KILL</code> behelyettesítése a parancs megfelelõ helyére.</p></div><div class="admonitionblock important"><table><tbody><tr><td class=icon><i class="fa icon-important" title=Important></i></td><td class=content><div class=paragraph><p>A rendszerünkben óvatosan bánjunk a futó programok leállítgatásával, és legyünk különös tekintettel az 1-es azonosítóval rendelkezõ, speciális feladattal bíró <a href="https://man.freebsd.org/cgi/man.cgi?query=init&amp;sektion=8&amp;format=html">init(8)</a> folyamatra. A <code>/bin/kill -s KILL 1</code> parancs kiadásával ugyanis gyorsan le tudjuk állítani a rendszerünket. <em>Mielõtt</em> egy <a href="https://man.freebsd.org/cgi/man.cgi?query=kill&amp;sektion=1&amp;format=html">kill(1)</a> parancsot lezárnánk az <kbd>Enter</kbd> billentyûvel, <em>mindig</em> gyõzõdjünk meg róla, hogy valóban tényleg a jó paramétereket adtuk meg.</p></div></td></tr></tbody></table></div></div><div class=sect2><h3 id=shells>3.9. Parancsértelmezõk<a class=anchor href=#shells></a></h3><div class=paragraph><p>A FreeBSD-ben hétköznapi munkánk legnagyobb részét a parancsértelmezõknek (shell) nevezett parancssoros felületen tudjuk elvégezni. A parancsértelmezõ fõ feladata a beérkezõ parancsok elfogadása és végrehajtatása. Sok parancsértelmezõ ezenfelül rendelkezik beépített funkciókkal is, amelyek olyan hétköznapi feladatokban igyekeznek segíteni, mint például az állományok kezelése és tömeges elérése reguláris kifejezések használatával, a parancssor szerkesztése, parancsok makrózása és a környezeti változók használata. A FreeBSD alapból tartalmaz néhány parancsértelmezõt, ilyen például az <code>sh</code>, a Bourne Shell, és a <code>tcsh</code>, a továbbfejlesztett C-shell. Sok más parancsértelmezõ, mint például a <code>zsh</code> és <code>bash</code> is elérhetõ a FreeBSD Portgyûjteményébõl.</p></div><div class=paragraph><p>De melyik parancsértelmezõt is válasszuk? Ez igazából ízlés kérdése. Ha inkább C programozók vagyunk, akkor valószínûleg egy olyan C-szerû shelllel tudunk kényelmesen dolgozni, amilyen például a <code>tcsh</code>. Ha viszont egy linuxos rendszert használtunk korábban vagy éppen még soha nem használtunk volna a UNIX® parancssorát, érdemes a <code>bash</code>-sel megpróbálkoznunk. A lényeg az, hogy minden parancsértelmezõnek vannak olyan egyedi jellemezõi, amiért használatóak vagy éppen nem használatóak a munkánkban, ezért magunknak kell kiválasztani a nekünk megfelelõt.</p></div><div class=paragraph><p>A shellek egyik legáltalánosabb jellemzõje az állományok neveinek kiegészítése. Miután begépeljük egy parancs vagy állománynév elsõ néhány karakterét, a <kbd>Tab</kbd> billentyû lenyomásával megkérhetjük a parancsértelmezõt, hogy magától egészítse ki ("találja ki") a fennmaradó részt. Nézzük erre egy példát. Tegyük fel, hogy van két állományunk, <span class=filename>izemize</span> és <span class=filename>ize.mize</span>, és szeretnénk letörölni az <span class=filename>ize.mize</span> nevût. Ehhez a következõt kell begépelnünk: <code>rm iz[Tab].[Tab]</code>.</p></div><div class=paragraph><p>Erre a parancsértelmezõ a következõ parancsot írja ki: <code>rm ize[SIPOLÁS].mize</code>.</p></div><div class=paragraph><p>A [SIPOLÁS] itt a konzol sípjára vonatkozik, amellyel jelzi, hogy nem tudta teljesen kiegészíteni az állomány nevét, mivel egynél több is megfelel a megadott alaknak. Az <span class=filename>izemize</span> és az <span class=filename>ize.mize</span> is egyaránt az <code>iz</code> elõtaggal kezdõdik, azonban ebbõl a parancsértelmezõ csak az <code>ize</code> elõtagot tudta kikövetkeztetni. Ha most begépelünk még egy <code>.</code> karaktert és újra megnyomjuk a <kbd>Tab</kbd> billentyût, a parancsértelmezõ ezúttal képes lesz az állomány teljes nevét megállapítani.</p></div><div class=paragraph><p>A parancsértelmezõk másik általános jellemzõje a környezeti változók használata. A környezeti változók lényegében a parancsértelmezõ környezetéhez tárolt név-érték párok. Ezt a környezetet látja minden olyan program, amit a parancsértelmezõbõl meghívunk, és ezért tartalmazni is szokott sok ilyen beállítást. Íme a leggyakoribb környezeti változók felsorolása és rövid leírása:</p></div><table class="tableblock frame-none grid-all stretch informaltable"><col style=width:50%><col style=width:50%><thead><tr><th class="tableblock halign-left valign-top">Változó</th><th class="tableblock halign-left valign-top">Leírás</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>USER</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>A bejelentkezett felhasználó neve.</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>PATH</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Vesszõvel elválasztott könyvtárak, ahol a parancsértelmezõ a végrehajtható állományokat keresi.</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>DISPLAY</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Az aktuálisan használt X11 megjelenítõ hálózati neve, amennyiben létezik ilyen.</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>SHELL</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>A használt parancsértelmezõ.</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>TERM</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>A felhasználó által használt terminál típusa. Ebbõl a terminál képességeit lehet megállapítani.</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>TERMCAP</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>A terminálok adatbázisából származó, különbözõ terminálfunkciókhoz tartozó helyettesítõ (escape) kódok.</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>OSTYPE</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Az operációs rendszer típusa, például FreeBSD.</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>MACHTYPE</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>A rendszer alatt futó gép architektúrája.</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>EDITOR</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>A felhasználó által használt szövegszerkesztõ.</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>PAGER</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>A felhasználó által lapozásra használt program.</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>MANPATH</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Vesszõvel elválasztott könyvtárak, ahol a parancsértelmezõ a man oldalakat keresi.</p></td></tr></tbody></table><div class=paragraph><p>A környezeti változók beállítása parancsértelmezõnként valamennyire eltér. Például egy C stílusú parancsértelmezõ, mint például a <code>tcsh</code> vagy a <code>csh</code>, a <code>setenv</code> paranccsal állítja a környezeti változókat. A Bourne-féle parancsértelmezõk, mint például az <code>sh</code> vagy a <code>bash</code>, az <code>export</code> parancsot használják a környezeti változók beállítására. Például a <code>csh</code> vagy a <code>tcsh</code> használata során a következõképpen tudjuk be- vagy átállítani az <code>EDITOR</code> környezeti változó értékét <span class=filename>/usr/local/bin/emacs</span>-re:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>% setenv EDITOR /usr/local/bin/emacs</code></pre></div></div><div class=paragraph><p>Ugyanez a Bourne-féle parancsértelmezõkben:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>% <span class=nb>export </span><span class=nv>EDITOR</span><span class=o>=</span><span class=s2>&#34;/usr/local/bin/emacs&#34;</span></code></pre></div></div><div class=paragraph><p>A legtöbb parancsértelmezõben a nevük elõtt szerepeltetett <code>$</code> jel segítségével kérhetjük a környezeti változók értékének behelyettesítését a parancssorba. Ennek megfelelõen az <code>echo $TERM</code> parancs kiíratja a <code>TERM</code> változó aktuális értékét, mivel ebbe a parancsértelmezõ már az <code>echo</code> meghívása elõtt behelyettesíti a <code>TERM</code> értékét.</p></div><div class=paragraph><p>A parancsértelmezõk számos speciális karaktert, ún. metakaraktert az adatok különleges reprezentációjaként kezelnek. Köztük a leggyakrabban használt a <code>*</code>, amely tetszõleges számú karaktert helyettesít egy állomány nevében. Az ilyen metakarakterek segítségével tudunk egyszerre több állományt is megnevezni. Például ha begépeljük az <code>echo *</code> parancsot, akkor majdnem ugyanazt kapjuk eredményül, mintha az <code>ls</code> parancsot adtuk volna ki, hiszen a parancsértelmezõ ilyenkor veszi az összes <code>*</code> metakarakterre illeszkedõ állományt, és a kiíratásukhoz pedig rendre behelyettesíti ezeket a parancssorba az <code>echo</code> paramétereként.</p></div><div class=paragraph><p>Ha nem szeretnénk, hogy a parancsértelmezõ értelmezze a speciális karaktereket, akkor egy "backslash" (visszaper) (<code>\</code>) karaktert eléjük téve mindezt megakadályozhatjuk. Az <code>echo $TERM</code> parancs ugyebár kiíratja a terminálra vonatkozó környezeti változó beállítását, azonban a <code>echo \$TERM</code> változatlanul kiírja a <code>$TERM</code> szöveget.</p></div><div class=sect3><h4 id=changing-shells>3.9.1. A parancsértelmezõnk megváltoztatása<a class=anchor href=#changing-shells></a></h4><div class=paragraph><p>A parancsértelmezõnk legegyszerûbben a <code>chsh</code> parancs használatával változtatható meg. A <code>chsh</code> kiadása után elindítja az <code>EDITOR</code> környezeti változónak megfelelõ szövegszerkesztõt, ha nem lenne ilyen, akkor alapértelmezés szerint a <code>vi</code> hívódik meg. Az így megnyitott állományban változtassuk meg kedvünk szerint a "Shell: " kezdetû sort.</p></div><div class=paragraph><p>A <code>chsh</code> parancsnak megadhatjuk az <code>-s</code> opciót is, amin keresztül szövegszerkesztõ használata nélkül be tudjuk állítani a parancsértelmezõt. Például ha a parancsértelmezõnket a <code>bash</code>-re akarjuk lecserélni, akkor ezt írjuk be:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>% chsh <span class=nt>-s</span> /usr/local/bin/bash</code></pre></div></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>A használni kívánt parancsértelmezõnek szerepelnie <em>kell</em> az <span class=filename>/etc/shells</span> állományban. Ha a kiválasztott parancsértelmezõt a <a href=./#ports>Portgyûjtemény</a>bõl telepítettük fel, akkor az már minden bizonnyal bekerült oda. Ha viszont saját magunk raktuk volna fel, akkor ide is fel kell vennünk.</p></div><div class=paragraph><p>Például ha a <code>bash</code>-t manuálisan telepítettük és másoltuk a <span class=filename>/usr/local/bin</span> könyvtárba, akkor így kell eljárnunk:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># echo &#34;/usr/local/bin/bash&#34; &gt;&gt; /etc/shells</span></code></pre></div></div><div class=paragraph><p>Majd próbálkozzunk újra a <code>chsh</code> paranccsal.</p></div></td></tr></tbody></table></div></div></div><div class=sect2><h3 id=editors>3.10. Szövegszerkesztõk<a class=anchor href=#editors></a></h3><div class=paragraph><p>A FreeBSD beállításának nagy része szöveges állományok szerkesztésével történik. Emiatt sosem árt legalább egy szövegszerkesztõt ismernünk. A FreeBSD alaprendszerében, valamint a Portgyûjteményben is találhatunk néhányat belõlük.</p></div><div class=paragraph><p>A legegyszerûbben megtanulható és legkönnyedebb szövegszerkesztõt ee-nek, avagy "easy editornak" hívják. Az ee indításához írjuk be az <code>ee állománynév</code> parancsot, ahol az <em>állománynév</em> lesz a szerkesztendõ állomány neve. Így például az <span class=filename>/etc/rc.conf</span> állomány szerkesztéséhez gépeljük be az <code>ee /etc/rc.conf</code> parancsot. Miután elindult az <code>ee</code>, az összes szerkesztéshez használható parancsa megjelenik a képernyõ felsõ részében. Itt a "kalap" (<code>^</code>) karakter a <kbd>Ctrl</kbd> billentyû lenyomására utal, így tehát a <code>^e</code> jelölés a <span class=keyseq><kbd>Ctrl</kbd>+<kbd>e</kbd></span> billentyûkombinációt jelenti. Ha ki akarunk lépni az ee-bõl, nyomjuk le az <kbd>Esc</kbd> billentyût, majd a felbukkanó menübõl válasszuk a szerkesztõ elhagyását (leave editor). Ha az állományt módosítottuk, kilépés elõtt még a szövegszerkesztõ rákérdez, hogy mentse-e a változtatásainkat.</p></div><div class=paragraph><p>A FreeBSD nagyobb tudású szövegszerkesztõket, mint például a vi-t, is tartalmaz az alaprendszer részeként, miközben a többi, mint például az Emacs vagy a vim a Portgyûjtemény részeként (<a class=package href=https://cgit.freebsd.org/ports/tree/editors/emacs/>editors/emacs</a> és <a class=package href=https://cgit.freebsd.org/ports/tree/editors/vim/>editors/vim</a>) érhetõ el. Ezek a szerkesztõk sokkal több lehetõséget és erõt képviselnek, amiért cserébe viszont valamivel nehezebb megtanulni a használatukat. Ha viszont rengeteg szöveget akarunk majd szerkeszteni, akkor egy vim vagy Emacs használatának megismerésével sok idõt megspórolhatunk.</p></div><div class=paragraph><p>Számos alkalmazás, amely állományokat akar módosítani vagy szöveges bemenetre van szüksége, automatikusan szövegszerkesztõt nyit meg. Ezt az <code>EDITOR</code> környezeti változó beállításával tudjuk meghatározni. Errõl részletesebben a <a href=#shells>parancsértelmezõknél</a> olvashatunk.</p></div></div><div class=sect2><h3 id=basics-devices>3.11. Eszközök és eszközleírók<a class=anchor href=#basics-devices></a></h3><div class=paragraph><p>Az eszköz elnevezést leginkább a rendszerben folyó, hardverrel kapcsolatos tevékenységek kapcsán használják lemezekre, nyomtatókra, grafikus kártyákra és billentyûzetekre. A FreeBSD indulása során többnyire azt láthatjuk, hogy milyen eszközöket sikerült felismernie. Ezeket a rendszerindításkor megjelenõ üzeneteket a <span class=filename>/var/run/dmesg.boot</span> állományban nézhetjük meg újra.</p></div><div class=paragraph><p>Például az <span class=filename>acd0</span> az elsõ IDE CD-meghajtót, míg a <span class=filename>kbd0</span> a billentyûzetet képviseli.</p></div><div class=paragraph><p>A UNIX® operációs rendszerben a legtöbb eszközt a <span class=filename>/dev</span> könyvtárban található, eszközleíróknak (device node) nevezett speciális állományokon keresztül érhetjük el.</p></div><div class=sect3><h4 id=_eszközleírók_létrehozása>3.11.1. Eszközleírók létrehozása<a class=anchor href=#_eszközleírók_létrehozása></a></h4><div class=paragraph><p>Amikor egy újfajta eszközt adunk hozzá a rendszerhez vagy csak annak egy új példányát, mindig létre kell hoznunk hozzá egy új eszközleírót.</p></div><div class=sect4><h5 id=_devfs_device_file_system_eszköz_állományrendszer>3.11.1.1. <code>DEVFS</code> (DEVice File System, Eszköz-állományrendszer)<a class=anchor href=#_devfs_device_file_system_eszköz_állományrendszer></a></h5><div class=paragraph><p>Az eszközöket tartalmazó állományrendszer, avagy <code>DEVFS</code>, ad hozzáférést a rendszermag által ismert eszközök neveihez a globális állományrendszer nevein keresztül. Így ahelyett, hogy magunknak kellene létrehoznunk és módosítanunk az eszközleírókat, a <code>DEVFS</code> erre a célra fenntart egy külön állományrendszert.</p></div><div class=paragraph><p>A <a href="https://man.freebsd.org/cgi/man.cgi?query=devfs&amp;sektion=5&amp;format=html">devfs(5)</a> man oldalon olvashatunk bõvebben errõl.</p></div></div></div></div><div class=sect2><h3 id=binary-formats>3.12. Bináris formátumok<a class=anchor href=#binary-formats></a></h3><div class=paragraph><p>Annak megértéséhez, hogy a FreeBSD miért az <a href="https://man.freebsd.org/cgi/man.cgi?query=elf&amp;sektion=5&amp;format=html">elf(5)</a> formátumot használja, elõször is tisztában kell lennünk a UNIX® típusú rendszerekben használt végrehajtható állományok három "uralkodó" formátumával:</p></div><div class=ulist><ul><li><p><a href="https://man.freebsd.org/cgi/man.cgi?query=a.out&amp;sektion=5&amp;format=html">a.out(5)</a></p><div class=paragraph><p>A legõsibb és egyben a "klasszikus" UNIX®-os tárgykódformátum. Egy tömör és rövidke fejlécet használ, aminek az elején a formátum leírására szolgáló "bûvös szám" található (errõl bõvebben lásd <a href="https://man.freebsd.org/cgi/man.cgi?query=a.out&amp;sektion=5&amp;format=html">a.out(5)</a>). Három betöltött szegmenst tartalmaz: .text, .data és .bss, valamint egy szimbólumokat és karakterláncokat tároló táblát.</p></div></li><li><p>COFF</p><div class=paragraph><p>Az SVR3 tárgykódformátuma. A fejléc itt már tartalmaz egy table nevû szegmenst is, tehát a .text, .data és .bss szegmensekhez hasonlóan ebbõl is többet tud tárolni.</p></div></li><li><p><a href="https://man.freebsd.org/cgi/man.cgi?query=elf&amp;sektion=5&amp;format=html">elf(5)</a></p><div class=paragraph><p>A COFF után következõ formátum, amelyben több szegmens is megtalálható, valamint létezik 32 bites és 64 bites változatban is. Egyetlen hátránya van: az ELF tervezése során rendszerarchitektúránként csupán egyetlen ABI-t (bináris alkalmazói felületet) feltételeztek. Ez azonban meglehetõsen helytelen, mivel még a kereskedelmi SYSV világában (ahol már legalább három ABI található: SVR4, Solaris és SCO) sem állja meg a helyét.</p></div><div class=paragraph><p>A FreeBSD ezt a problémát a <em>megbélyegzés</em> (branding) segítségével próbálja megoldani, aminek révén el tudunk látni egy ismert ELF állományt a futtatásához megfelelõ ABI-ra vonatkozó információkkal. Errõl részletesebben a <a href="https://man.freebsd.org/cgi/man.cgi?query=brandelf&amp;sektion=1&amp;format=html">brandelf(1)</a> oldalán tájékozódhatunk.</p></div></li></ul></div><div class=paragraph><p>A FreeBSD a "klasszikusok" táborából indult, ezért kezdetben az <a href="https://man.freebsd.org/cgi/man.cgi?query=a.out&amp;sektion=5&amp;format=html">a.out(5)</a> formátumot használta, mivel ez a technológia a BSD kiadások számos generációjában megmérettetett és bevált, egészen a 3.X ág elindulásáig. Habár már jóval elõtte lehetett fordítani és futtatni natív ELF binárisokat (és rendszermagokat) a FreeBSD rendszereken, a FreeBSD kezdetben ódzkodott váltani az alapértelmezés szerinti ELF formátumra. De vajon miért? Nos, amikor a Linux-tábor megtette a maga fájdalmas váltását az ELF-re, az nem annyira azért volt, hogy megszabaduljanak az <span class=filename>a.out</span> végrehajtható formátumtól, hanem mert a rugalmatlan, ugrótáblákon alapuló oszottkönyvtár-kezelési mechanizmusaik nagyon megnehezítették a gyártók és fejlesztõk számára az osztott függvénykönyvtárak létrehozását. Mivel az ELF formátumhoz rendelkezésre álló eszközök megoldást kínáltak az osztott könyvtárak gondjaira, és mivel általánosan elfogadták "a jövõbe vezetõ útként", a FreeBSD is felvállalta az átállással kapcsolatos költségeket és végrehajtotta azt. A FreeBSD az osztott könyvtárakat leginkább a Sun SunOS™ rendszeréhez hasonlóan kezeli, ami egy nagyon könnyen használható megoldás.</p></div><div class=paragraph><p>De miért van ilyen sok különbözõ formátum?</p></div><div class=paragraph><p>A ködös és sötét múltban egyszerûbb hardverek voltak. Ezek az egyszerû hardverek egyszerû, kicsi rendszereket támogattak. Az <span class=filename>a.out</span> tökéletesen megfelelõ volt egy ilyen egyszerû rendszer (egy PDP-11) binárisainak tárolására. Ahogy az emberek nekiláttak átültetni errõl az egyszerû rendszerrõl a UNIX®-ot más rendszerekre, az <span class=filename>a.out</span> formátumot továbbra is megtartották, mivel a UNIX® kezdeti, Motorola 68k-ra, VAXenre készített átírataihoz is elegendõ volt.</p></div><div class=paragraph><p>Ezután néhány éles elméjû hardvermérnök kitalálta, ha rá tudnák kényszeríteni a programokat egy-két ügyetlen trükkre, akkor a terveken meg tudnának spórolni néhány logikai kaput és ezzel a processzor is gyorsabban tudna futni. Miközben az <span class=filename>a.out</span> formátumot ilyen hardverre (amit manapság RISC-nek hívnak) is szerették volna áthozni, kiderült, hogy ebben az esetben szinte használhatatlan. Ezért az <span class=filename>a.out</span> formátum által felkínáltnál nagyobb teljesítmény elérése érdekében nekiláttak számos más formátumot is kidolgozni. Ekkor jöttek létre a COFF, ECOFF és más hasonló formátumok, amelyek elõbb-utóbb korlátokba ütköztek, még mielõtt a történelem megállapodott volna az ELF formátumnál.</p></div><div class=paragraph><p>Ráadásul a programok méretei egyre inkább kezdtek nõni, miközben a lemezek (valamint a fizikai memória) továbbra is viszonylag kicsik maradtak, ezért megszületett az osztott könyvtár ötlete, és a virtuális memóriát kezelõ alrendszer is sokat finomodott. Mivel ezek a különbözõ fejlesztések az <span class=filename>a.out</span> formátumra épültek, annak használatósága a beletömött módosítások számával együtt romlott. Emellett az emberek még szerettek volna betölteni különféle dolgokat futási idõben dinamikusan, vagy éppen a memória és a lapozóállomány megspórolásához kipucolni a programjaik egyes részeit az inicializáló kódrészletek lefutása után. A programozási nyelvek is fejlõdtek, és az emberek a fõprogram futása elõtt is akartak kódot futtatni. Az <span class=filename>a.out</span> formátum rengeteg apró foltozáson esett keresztül, amelyek egy ideig még tudták is tartani magukat. Azonban egy idõ után már az <span class=filename>a.out</span> formátum egyre növekvõ teljesítménycsökkenés nélkül már nem volt képes állni a sarat. Habár az ELF megszüntette a fennálló problémák jelentõs részét, egyúttal megnehezítette egy alapvetõen mûködõ rendszer leváltását. Ezért az ELF formátumnak meg kellett várnia azt a pillanatot, amikorra az <span class=filename>a.out</span> használata már kényelmetlenné vált.</p></div><div class=paragraph><p>Azonban ahogy múlt az idõ, az eszközökbõl, amelyekbõl a FreeBSD a fordításához szükséges eszközöket származtatta (különösen az assembler és a betöltõ),létrejött két párhuzamos fejlesztési fa. A FreeBSD-fa kiegészült az osztott könyvtárak támogatásával és hibákat javított, miközben a GNU-fa alkotói, akik eredetileg készítették ezeket a programokat, újraírták az eszközeiket és a keresztfordításhoz egyszerûbb támogatást készítettek, cserélhetõvé tették a különbözõ formátumokat és így tovább. Sokan akartak FreeBSD-re keresztfordítani, azonban nem volt szerencséjük, mert a FreeBSD régebbi forrásait az as és ld már nem emésztette meg. Az új GNU eszköztár (a binutils) viszont ismeri már a keresztfordítást, az ELF formátumot, az osztott könyvtárakat, a C++ kiterjesztéseit stb. Idõközben egyre több gyártó ELF formátumú binárisokat adott ki, és jó érzés volt ezeket FreeBSD-n is futtatni.</p></div><div class=paragraph><p>Az ELF sokkal kifejezõbb az <span class=filename>a.out</span> formátumnál, és jóval több bõvítési lehetõséget enged az alaprendszerben. Az ELF formátumhoz tartozó eszközöket jobban karbantartják és támogatja a keresztfordítást, ami viszont sokaknak fontos. Az ELF talán némileg lassabb, mint az <span class=filename>a.out</span>, azonban ez nehezen mérhetõ le. Számos részletben eltérnek ugyan, például hogyan képeznek le lapokat, hogyan kezelik az inicializáló kódot stb., de ezek egyike sem igazán fontos. Idõvel az <span class=filename>a.out</span> támogatása ki fog kerülni a <span class=filename>GENERIC</span> rendszermagból, és végül majd teljesen eltávolításra kerül, ahogy a régi <span class=filename>a.out</span> formátumú programok szépen lassan kifutnak.</p></div></div><div class=sect2><h3 id=basics-more-information>3.13. Bõvebben olvashatunk…​<a class=anchor href=#basics-more-information></a></h3><div class=sect3><h4 id=basics-man>3.13.1. Man oldalak<a class=anchor href=#basics-man></a></h4><div class=paragraph><p>A FreeBSD legátfogóbb dokumentációja a benne található man oldalak összessége. A rendszerben található szinte majdnem mindegyik programhoz létezik egy rövid használati útmutató, amely bemutatja az adott program alapvetõ mûködését és a különbözõ beállításait. Ezek a leírások a <code>man</code> parancs segítségével jeleníthetõek meg. A <code>man</code> parancs használata egyszerû:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>% man parancs</code></pre></div></div><div class=paragraph><p>ahol a <code>parancs</code> a megismerni kívánt parancsra utal. Például ha az <code>ls</code> parancsról szeretnénk többet megtudni, írjuk be:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>% man <span class=nb>ls</span></code></pre></div></div><div class=paragraph><p>Az elérhetõ használati útmutatókat a következõ számozott szakaszokra osztották:</p></div><div class="olist arabic"><ol class=arabic><li><p>Felhasználói parancsok</p></li><li><p>Rendszerhívások és hibakódok</p></li><li><p>A C függvénykönyvtár függvényei</p></li><li><p>Eszközmeghajtók</p></li><li><p>Állományformátumok</p></li><li><p>Játékok és egyéb szórakoztató alkalmazások</p></li><li><p>Egyéb információk</p></li><li><p>Rendszerkarbantartási és -mûködtetési parancsok</p></li><li><p>Rendszermagfejlesztõk számára</p></li></ol></div><div class=paragraph><p>Bizonyos esetekben ugyanaz a téma az útmutatók több szakaszában is elérhetõ. Például létezik <code>chmod</code> felhasználói parancs és a <code>chmod()</code> rendszerhívás. Ilyenkor a <code>man</code> parancsnak meg tudjuk adni pontosan, melyik szakaszra is vagyunk kíváncsiak:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>% man 1 <span class=nb>chmod</span></code></pre></div></div><div class=paragraph><p>Ennek hatására a <code>chmod</code> felhasználói parancshoz tartozó oldal jelenik meg. Írott formában a használati útmutatók különbözõ szakaszaira hagyományosan a név után zárójelbe tett számmal hivatkoznak, így a <a href="https://man.freebsd.org/cgi/man.cgi?query=chmod&amp;sektion=1&amp;format=html">chmod(1)</a> a <code>chmod</code> felhasználói parancs és a <a href="https://man.freebsd.org/cgi/man.cgi?query=chmod&amp;sektion=2&amp;format=html">chmod(2)</a> a rendszerhívás.</p></div><div class=paragraph><p>Ez a módszer remekül mûködik abban az esetben, amikor ismerjük a parancs nevét, azonban mit tegyünk akkor, ha nem is emlékszünk a nevére? A <code>man</code> parancs a <code>-k</code> segítségével paraméterezhetõ úgy is, hogy a parancsok leírásai között keressen valamilyen kulcsszó mentén:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>% man <span class=nt>-k</span> mail</code></pre></div></div><div class=paragraph><p>Ezzel a paranccsal megkapjuk azon parancsok listáját, amelyek leírásában szerepel a "mail" kulcsszó. Ez egyébként mûködésében teljesen megegyezik a <code>apropos</code> paranccsal.</p></div><div class=paragraph><p>Szóval szeretnénk megtudni, hogy a <span class=filename>/usr/bin</span> könyvtárban levõ parancsok pontosan mit is csinálnak? Ehhez írjuk be:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>% <span class=nb>cd</span> /usr/bin
% man <span class=nt>-f</span> <span class=k>*</span></code></pre></div></div><div class=paragraph><p>vagy</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>% <span class=nb>cd</span> /usr/bin
% whatis <span class=k>*</span></code></pre></div></div><div class=paragraph><p>ami ugyanezt teszi.</p></div></div><div class=sect3><h4 id=basics-info>3.13.2. A GNU info állományok<a class=anchor href=#basics-info></a></h4><div class=paragraph><p>A FreeBSD-ben megtalálható a Szabad Szoftver Alapítvány (Free Software Foundation, FSF) által készített számos alkalmazás. Ezek a programok a szokványos man oldalakon kívül még általában tartalmaznak egy <code>info</code>nak nevezett, sokkal részletesebb hipertext alapú leírást is, amelyeket az <code>info</code> paranccsal, vagy ha van fenn emacs, akkor annak az info módjában tudjuk megjeleníteni.</p></div><div class=paragraph><p>Az <a href="https://man.freebsd.org/cgi/man.cgi?query=info&amp;sektion=1&amp;format=html">info(1)</a> parancs használatához ennyit kell beírnunk:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>% info</code></pre></div></div><div class=paragraph><p>Itt a <code>h</code> lenyomásával kapunk egy rövid bemutatkozást. A parancsok rövid listáját a <code>?</code> billentyû hozza elõ.</p></div></div></div></div></div><div class=sect1><h2 id=ports>Chapter 4. Alkalmazások telepítése: csomagok és portok<a class=anchor href=#ports></a></h2><div class=sectionbody><div class=sect2><h3 id=ports-synopsis>4.1. Áttekintés<a class=anchor href=#ports-synopsis></a></h3><div class=paragraph><p>A FreeBSD rendszereszközök gazdag gyûjteményével érkezik az alaprendszer részeként. Azonban a külsõ alkalmazások telepítéséhez rengeteg teendõt kell elvégeznünk. A feladat elvégzésére ezért a FreeBSD két, egymást kiegészítõ technológiát kínál fel: a FreeBSD Portgyûjteményt (telepítés forráskódból) és a csomagokat (telepítés elõre elkészített bináris csomagokból). Mind a két módszerrel fel tudjuk telepíteni a kedvenc alkalmazásunk legújabb verzióját lokálisan vagy egyenesen a hálózatról.</p></div><div class=paragraph><p>A fejezet elolvasása során megismerjük:</p></div><div class=ulist><ul><li><p>hogyan telepítsünk külsõ fejlesztésû bináris szoftvercsomagokat;</p></li><li><p>hogyan fordítsunk le a forrásukból külsõ fejlesztésû szoftvereket a Portgyûjtemény segítségével;</p></li><li><p>hogyan távolítsunk el korábban már telepített csomagokat és portokat;</p></li><li><p>hogyan bíráljuk felül a Portgyûjtemény által használt alapértelmezett értékeket;</p></li><li><p>hogyan keressük meg a megfelelõ szoftvercsomagokat;</p></li><li><p>hogyan frissítsük a telepített alkalmazásokat.</p></li></ul></div></div><div class=sect2><h3 id=ports-overview>4.2. Az alkalmazások telepítésének összefoglalása<a class=anchor href=#ports-overview></a></h3><div class=paragraph><p>Ha korábban már használtunk UNIX® rendszereket, valószínûleg ismerjük a külsõ alkalmazások telepítésének jellemezõ menetét:</p></div><div class="exampleblock procedure"><div class=content><div class="olist arabic"><ol class=arabic><li><p>Töltsük le a szoftvert, amelyet vagy forráskód vagy pedig bináris formátumban érhetünk el.</p></li><li><p>Bontsuk ki az alkalmazás letöltött változatát (ez általában a <a href="https://man.freebsd.org/cgi/man.cgi?query=compress&amp;sektion=1&amp;format=html">compress(1)</a>, <a href="https://man.freebsd.org/cgi/man.cgi?query=gzip&amp;sektion=1&amp;format=html">gzip(1)</a> vagy a <a href="https://man.freebsd.org/cgi/man.cgi?query=bzip2&amp;sektion=1&amp;format=html">bzip2(1)</a> által tömörített tar állomány).</p></li><li><p>Keressük meg a dokumentációt (többnyire az <span class=filename>INSTALL</span> vagy a <span class=filename>README</span> állományban található, vagy a <span class=filename>doc/</span> alkönyvtárban) és olvassuk el benne, hogyan tudjuk telepíteni a szoftvert.</p></li><li><p>Ha a szoftver forrását töltöttük le, fordítsuk le. Elképzelhetõ, hogy ennek során szerkesztenünk kell a <span class=filename>Makefile</span> állományt vagy lefuttatnunk a <span class=filename>configure</span> szkriptet, illetve más lépéseket is el kell végeznünk.</p></li><li><p>Próbáljuk a ki szoftvert, majd telepítsük.</p></li></ol></div></div></div><div class=paragraph><p>Ez annak a forgatókönyve, amikor minden hiba nélkül lezajlik. Megeshet azonban, ha olyan szoftvert telepítünk, amelyet nem kifejezetten a FreeBSD-hez terveztek, akkor javítanunk kell a forráskódban a szoftver megfelelõ mûködéséhez.</p></div><div class=paragraph><p>Ha sikerül mûködésre bírni, folytathatjuk FreeBSD-n a szoftver telepítését a "megszokott" módon. Habár a FreeBSD erre a célra két lehetõséget is felkínál, amivel rengeteg erõfeszítéstõl megkímélhet minket: ezek a csomagok és a portok. Az írás pillanatában közel 36000 külsõ alkalmazás érhetõ el ilyen formában.</p></div><div class=paragraph><p>Egy adott alkalmazás esetén a hozzá tartozó FreeBSD-s csomag mindössze egyetlen letöltendõ állományt takar. A csomag tartalmazza az alkalmazás telepítéséhez szükséges összes parancs elõre lefordított változtatát, ugyanígy magát a dokumentációt is. A letöltött csomagokat a FreeBSD csomagkezelõ parancsaival vehetjük használatba: ezek a <a href="https://man.freebsd.org/cgi/man.cgi?query=pkg_add&amp;sektion=1&amp;format=html">pkg_add(1)</a>, <a href="https://man.freebsd.org/cgi/man.cgi?query=pkg_delete&amp;sektion=1&amp;format=html">pkg_delete(1)</a>, <a href="https://man.freebsd.org/cgi/man.cgi?query=pkg_info&amp;sektion=1&amp;format=html">pkg_info(1)</a> és így tovább. Az új alkalmazások telepítése ennek köszönhetõen egyetlen paranccsal elvégezhetõ.</p></div><div class=paragraph><p>Egy alkalmazás FreeBSD-s portja mögött lényegében állományok gyûjteménye áll, amelyek abban segítenek, hogy automatikusan tudjunk telepíteni a forráskód felhasználásával.</p></div><div class=paragraph><p>Ne felejtsük el, hogy normális esetben számos lépcsõt végig kell járnunk egy program sajátkezû lefordításához (letöltés, kitömörítés, javítgatás, fordítás, telepítés). A portot alkotó állományok tartalmazzák az összes olyan szükséges információt, amelyek átengedik ezt a feladatot a rendszernek. Kiadunk néhány egyszerû parancsot és az alkalmazás magától letöltõdik, kitömörítõdik, módosítja a forráskódját, lefordul és települ.</p></div><div class=paragraph><p>Valójában a portrendszer használható olyan csomagok létrehozására is, amelyeket késõbb a <code>pkg_add</code> és többi hozzá hasonló, hamarosan részletesebben is bemutatandó csomagkezelõ paranccsal is kezelni tudunk.</p></div><div class=paragraph><p>A csomagok és a portok egyaránt képesek <em>függõségeket</em> kezelni. Tegyük fel, hogy egy olyan alkalmazást akarunk telepíteni, amely egy adott függvénykönyvtár meglététõl függ a rendszeren. Az alkalmazás és a könyvtár is elérhetõ FreeBSD portként és csomagként. Akár a <code>pkg_add</code> parancsot, akár a portrendszert használjuk az alkalmazás hozzáadására, mind a kettõ észre fogja venni, hogy a szükséges könyvtárt még nem telepítettük, ezért elõször azt fogja automatikusan telepíteni.</p></div><div class=paragraph><p>Tudván, hogy a két említett megoldás szinte teljesen egyenértékû, felmerülhet a kérdés: a FreeBSD mégis miért rendelkezik mindkettõvel? A csomagoknak és a portoknak is megvannak a maguk elõnyei, és hogy a kettõ közül melyiket használjuk, csak az egyéni ízlésünkön múlik.</p></div><div class=ulist><div class=title>A csomagok használatának elõnyei</div><ul><li><p>Egy csomag általában kisebb, mint az alkalmazás forráskódját tartalmazó tömörített tar állomány.</p></li><li><p>A csomagokat nem kell fordítani. Nagyobb alkalmazások, mint például a Mozilla, KDE vagy GNOME esetén ez kulcsfontosságú lehet, fõleg abban az esetben, ha a rendszerünk ehhez nem eléggé gyors.</p></li><li><p>A csomagok használata nem várja el tõlünk, hogy behatóbban ismerjük, miként is kell FreeBSD-n szoftvereket lefordítani.</p></li></ul></div><div class=ulist><div class=title>A portok használatának elõnyei</div><ul><li><p>A csomagokat általános esetben igen óvatos beállításokkal készítik el, hiszen a lehetõ legtöbb rendszeren mûködõképesnek kell lenniük. Ha viszont portból telepítünk, nyugodtan hangolhatjuk úgy a beállításokat, hogy (például) a Pentium® 4 vagy az Athlon processzoroknak kedvezõ kódot hozzanak létre.</p></li><li><p>Bizonyos alkalmazások fordítás idején állítandó beállításokkal rendelkeznek arról, hogy mire lesznek képesek és mire nem. Például az Apache beépített konfigurációs opciók széles kelléktárával rendelkezik. Amikor viszont portból hozzuk létre, nem kell elfogadnunk ezek alapértelmezett értékeit, hanem a saját igényeinknek megfelelõen átállíthatjuk ezeket.</p><div class=paragraph><p>Egyes esetekben több különféle beállítást tükrözõ csomag is létezhet ugyanahhoz az alkalmazáshoz. Például a Ghostscript elérhetõ <span class=filename>ghostscript</span> és <span class=filename>ghostscript-nox11</span> csomagként is attól függõen, hogy telepítettük-e az X11 szervert. Ez természetesen egy meglehetõsen durva kijátszása a csomagrendszernek, és gyorsan lehetetlenné is válik a használata, ha az adott alkalmazás egy-két fordítási idejû beállításnál többel rendelkezik.</p></div></li><li><p>Néhány szoftver licencelése tiltja a bináris terjesztést. Ezért ezek a szoftverek kizárólag csak forráskód formájában továbbíthatóak.</p></li><li><p>Néhányan nem bíznak meg a bináris verziókban. Ha látjuk a forráskódot is, akkor (elméletben) át tudjuk nézni, és mi magunk is megkereshetjük a benne lappangó hibákat.</p></li><li><p>Ha vannak saját javításaink, csak a forráskód birtokában tudjuk ezeket felhasználni.</p></li><li><p>Sokan szeretik, ha egyszerûen csak "ott van" a szoftverek forráskódja. Ha éppen unatkoznak, beléjük tudnak nézni, ötleteket és kódot tudnak belõlük meríteni (persze csak akkor, ha ezt a licenc megengedi), vagy tovább tudják ezeket fejleszteni, orvosolni tudják a hibáikat stb.</p></li></ul></div><div class=paragraph><p>A portok frissítésérõl a <a href=https://lists.FreeBSD.org/subscription/freebsd-ports>FreeBSD ports levelezési lista</a> és a <a href=https://lists.FreeBSD.org/subscription/freebsd-ports-bugs>FreeBSD ports bugs levelezési lista</a> valamelyikérõl szerezhetünk naprakész információkat.</p></div><div class="admonitionblock warning"><table><tbody><tr><td class=icon><i class="fa icon-warning" title=Warning></i></td><td class=content><div class=paragraph><p>Mielõtt bármelyik alkalmazást is telepítenénk, érdemes meglátogatnunk az <a href=http://vuxml.freebsd.org>http://vuxml.freebsd.org</a> oldalt, ahol a hozzá tartozó ismert biztonsági problémákról olvashatunk.</p></div><div class=paragraph><p>Telepíthetjük a <a class=package href=https://cgit.freebsd.org/ports/tree/ports-mgmt/portaudit/>ports-mgmt/portaudit</a> programot is, amely automatikusan ellenõrzi a telepített alkalmazások ismert sebezhetõségeit. Ez az ellenõrzés egyébként megejthetõ minden port lefordítása elõtt is. Ezalatt a <code>portaudit -F -a</code> parancs kiadásával ellenõrizhetjük utólag a telepített csomagokat.</p></div></td></tr></tbody></table></div><div class=paragraph><p>A fejezet fennmaradó részében megmutatjuk, hogyan használjuk FreeBSD-ben a csomagokat és portokat külsõ alkalmazások telepítésére és karbantartására.</p></div></div><div class=sect2><h3 id=ports-finding-applications>4.3. A számunkra szükséges alkalmazások felkutatása<a class=anchor href=#ports-finding-applications></a></h3><div class=paragraph><p>Mielõtt telepítenénk bármilyen alkalmazást, tudnunk kell, hogyan is nevezik.</p></div><div class=paragraph><p>A FreeBSD-hez elérhetõ alkalmazások listája folyamatosan növekszik. Szerencsére számos módja van annak, hogy utánajárjunk a keresett szoftvernek:</p></div><div class=ulist><ul><li><p>A FreeBSD honlapján találhatunk egy rendszeresen frissülõ listát az összes elérhetõ alkalmazásról, a <a href=https://www.FreeBSD.org/ports/>http://www.FreeBSD.org/ports/</a> címen. Itt a portok különbözõ kategóriákba sorolva találhatóak meg, ahol név szerint megkereshetjük az alkalmazást (amennyiben ismerjük), vagy végigböngészhetjük az adott kategóriában elérhetõ alkalmazásokat is.</p></li><li><p>Dan Langlille a <a href=http://www.FreshPorts.org/>http://www.FreshPorts.org/</a> címen karbantartja a FreshPorts nevû oldalt. Ezen az oldalon folyamatosan nyomon lehet követni a Portgyûjteményben megtalálható alkalmazások változásait, lehetõvé téve, hogy egy vagy több portot is "figyeljünk", vagy e-mailt küldjünk a frissítésükrõl.</p></li><li><p>Amennyiben nem ismerjük a keresett alkalmazás nevét, próbáljuk meg felkutatni a FreshMeaten (<a href=http://www.freshmeat.net/>http://www.freshmeat.net/</a>) vagy hozzá hasonló oldalakon, majd nézzük meg a FreeBSD honlapján, hogy az adott alkalmazást portolták-e már a rendszerre.</p></li><li><p>Ha pontosan ismerjük a port nevét, és csak a kategóriáját kellene megkeresnünk, használjuk a <a href="https://man.freebsd.org/cgi/man.cgi?query=whereis&amp;sektion=1&amp;format=html">whereis(1)</a> parancsot. Egyszerûen csak adjuk ki a <code>whereis név</code> parancsot, ahol a <em>név</em> a telepítendõ program neve. Ha sikerült megtalálni, részletes információt kapunk arról, hogy hol található, valahogy így:</p><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># whereis lsof</span>
lsof: /usr/ports/sysutils/lsof</code></pre></div></div><div class=paragraph><p>A fenti példában megtudhatjuk, hogy az <code>lsof</code> parancs a <span class=filename>/usr/ports/sysutils/lsof</span> könyvtárban található.</p></div></li><li><p>Vagy egy egyszerû <a href="https://man.freebsd.org/cgi/man.cgi?query=echo&amp;sektion=1&amp;format=html">echo(1)</a> paranccsal is megkereshetjük a portfában a portokat. Mint például:</p><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># echo /usr/ports/*/*lsof*</span>
/usr/ports/sysutils/lsof</code></pre></div></div><div class=paragraph><p>Ez a módszer a <span class=filename>/usr/ports/distfiles</span> könyvtárba letöltött összes illeszkedõ állományt is kilistázza.</p></div></li><li><p>Egy másik lehetõség egy adott port megtalálására, ha a Portgyûjtemény beépített keresési mechanizmusát használjuk. Ennek használatához a <span class=filename>/usr/ports</span> könyvtárban kell lennünk. Miután beléptünk ide, futtassuk le a <code>make search name=programnév</code> parancsot, ahol a <em>programnév</em> a keresendõ program neve. Például, ha az <code>lsof</code> programot keressük:</p><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># cd /usr/ports</span>
<span class=c># make search name=lsof</span>
Port:   lsof-4.56.4
Path:   /usr/ports/sysutils/lsof
Info:   Lists information about open files <span class=o>(</span>similar to fstat<span class=o>(</span>1<span class=o>))</span>
Maint:  obrien@FreeBSD.org
Index:  sysutils
B-deps:
R-deps:</code></pre></div></div><div class=paragraph><p>A keresés eredményében leginkább a "Path:" kezdetû sorra kell odafigyelnünk, mivel ez árulja el, hol is találhatjuk meg a portot. Az itt szereplõ többi információ nem szükséges a port telepítéséhez, ezért azokkal itt most nem foglalkozunk.</p></div><div class=paragraph><p>Mélyebb keresésekhez használhatjuk a <code>make search key=szöveg</code> parancsot is, ahol a <em>szöveg</em> a keresendõ szöveg(részlet) lesz. Ezt a rendszer keresni fogja a portok neveiben, megjegyzésekben, leírásokban és függõségekben. Amikor nem ismerjük a keresett program nevét, ez olyan portok keresésére alkalmas, amelyek egy adott témához kapcsolódnak.</p></div><div class=paragraph><p>A fenti esetek mindegyikében a keresés nem különbözteti meg a kis- és nagybetûket. Tehát az "LSOF" keresése ugyanazt az eredményt adja, mint az "lsof" esetén.</p></div></li></ul></div></div><div class=sect2><h3 id=packages-using>4.4. A csomagrendszer használata<a class=anchor href=#packages-using></a></h3><div class=paragraph><p>FreeBSD alatt több különbözõ módon tudunk csomagokat használni:</p></div><div class=ulist><ul><li><p>A sysinstall használatán keresztül a futó rendszeren tudjuk megnézni a telepített csomagokat, tudunk vele csomagokat telepíteni vagy törölni. Ezzel részletesebben a <a href=./#packages>Csomagok telepítése</a> foglalkozik.</p></li><li><p>A szakasz további részében ismertetett egyéb parancssoros csomagkezelõ segédprogramok.</p></li></ul></div><div class=sect3><h4 id=_csomagok_telepítése>4.4.1. Csomagok telepítése<a class=anchor href=#_csomagok_telepítése></a></h4><div class=paragraph><p>A <a href="https://man.freebsd.org/cgi/man.cgi?query=pkg_add&amp;sektion=1&amp;format=html">pkg_add(1)</a> segédprogram segítségével telepíthetünk FreeBSD-hez készült szoftvercsomagokat lokálisan vagy a hálózaton levõ egyik szerveren megtalálható állományokból:</p></div><div class=exampleblock><div class=title>Példa 5. Csomagok letöltése manuálisan és telepítése lokálisan</div><div class=content><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># ftp -a ftp2.FreeBSD.org</span>
Connected to ftp2.FreeBSD.org.
220 ftp2.FreeBSD.org FTP server <span class=o>(</span>Version 6.00LS<span class=o>)</span> ready.
331 Guest login ok, send your email address as password.
230-
230-     This machine is <span class=k>in </span>Vienna, VA, USA, hosted by Verio.
230-         Questions? E-mail freebsd@vienna.verio.net.
230-
230-
230 Guest login ok, access restrictions apply.
Remote system <span class=nb>type </span>is UNIX.
Using binary mode to transfer files.
ftp&gt; <span class=nb>cd</span> /pub/FreeBSD/ports/packages/sysutils/
250 CWD <span class=nb>command </span>successful.
ftp&gt; get lsof-4.56.4.tgz
<span class=nb>local</span>: lsof-4.56.4.tgz remote: lsof-4.56.4.tgz
200 PORT <span class=nb>command </span>successful.
150 Opening BINARY mode data connection <span class=k>for</span> <span class=s1>&#39;lsof-4.56.4.tgz&#39;</span> <span class=o>(</span>92375 bytes<span class=o>)</span><span class=nb>.</span>
100% |<span class=k>**************************************************</span>| 92375       00:00 ETA
226 Transfer complete.
92375 bytes received <span class=k>in </span>5.60 seconds <span class=o>(</span>16.11 KB/s<span class=o>)</span>
ftp&gt; <span class=nb>exit</span>
<span class=c># pkg_add lsof-4.56.4.tgz</span></code></pre></div></div></div></div><div class=paragraph><p>Ha nincsenek egyáltalán helyben csomagjaink (például egy FreeBSD CD-készletben), akkor a legjobban úgy járunk, ha használjuk a <a href="https://man.freebsd.org/cgi/man.cgi?query=pkg_add&amp;sektion=1&amp;format=html">pkg_add(1)</a> <code>-r</code> kapcsolóját. Ennek hatására a segédprogram önmagától meghatározza a szükséges állományformátumot és verziót, majd FTP-n keresztül letölti és telepíti a csomagot.</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># pkg_add -r lsof</span></code></pre></div></div><div class=paragraph><p>Az iménti példában a program mindenféle további beavatkozás nélkül letölti a megfelelõ csomagot és felteszi. Ha a központi helyett egy másik szervert szeretnénk használni, felül kell bírálnunk az alapértelmezett beállításokat és igényeinknek megfelelõen be kell állítanunk a <code>PACKAGESITE</code> környezeti változó értékét. A <a href="https://man.freebsd.org/cgi/man.cgi?query=pkg_add&amp;sektion=1&amp;format=html">pkg_add(1)</a> a <a href="https://man.freebsd.org/cgi/man.cgi?query=fetch&amp;sektion=3&amp;format=html">fetch(3)</a> programot használja az állományok letöltésére, amely pedig számos egyéb környezeti változót is figyel, mint például az <code>FTP_PASSIVE_MODE</code>, az <code>FTP_PROXY</code> és az <code>FTP_PASSWORD</code>. Ha tûzfal mögött vagyunk, ezek közül néhányat biztosan be kell majd állítanunk, vagy FTP/HTTP proxyt kell használnunk. A <a href="https://man.freebsd.org/cgi/man.cgi?query=fetch&amp;sektion=3&amp;format=html">fetch(3)</a> man oldalán megtaláljuk ezen változók teljes felsorolását. Figyeljük meg, hogy az <code>lsof-4.56.4</code> helyett csak <code>lsof</code>-ot adtunk meg. Amikor ugyanis kérjük a csomag letöltését is, nem szabad verziószámot megadnunk. A <a href="https://man.freebsd.org/cgi/man.cgi?query=pkg_add&amp;sektion=1&amp;format=html">pkg_add(1)</a> mindig az alkalmazás legfrissebb verzióját fogja letöltetni.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Ha a FreeBSD-CURRENT vagy FreeBSD-STABLE verziókat használjuk, a <a href="https://man.freebsd.org/cgi/man.cgi?query=pkg_add&amp;sektion=1&amp;format=html">pkg_add(1)</a> mindig az alkalmazás elérhetõ legfrissebb verzióját fogja letölteni. Ha azonban valamelyik -RELEASE verziót használjuk, a csomagnak az adott kiadáshoz készült verzióját fogja leszedni. Ezt a mûködési módot a <code>PACKAGESITE</code> változó felülírásával viszont meg tudjuk változtatni. Például ha a FreeBSD 5.4-RELEASE változatával dolgozunk, a <a href="https://man.freebsd.org/cgi/man.cgi?query=pkg_add&amp;sektion=1&amp;format=html">pkg_add(1)</a> alapértelmezés szerint a <code><a href=ftp://ftp.freebsd.org/pub/FreeBSD/ports/i386/packages-5.4-release/Latest/ class=bare>ftp://ftp.freebsd.org/pub/FreeBSD/ports/i386/packages-5.4-release/Latest/</a></code> címrõl fogja letölteni a csomagokat. Ha mi viszont a FreeBSD 5-STABLE csomagok letöltését akarjuk elérni, állítsuk az <code>PACKAGESITE</code> értékét a <code><a href=ftp://ftp.freebsd.org/pub/FreeBSD/i386/packages-5-stable/Latest/ class=bare>ftp://ftp.freebsd.org/pub/FreeBSD/i386/packages-5-stable/Latest/</a></code> címre.</p></div></td></tr></tbody></table></div><div class=paragraph><p>A csomagok <span class=filename>.tgz</span> és <span class=filename>.tbz</span> formátumokban kerülnek terjesztésre. Ezek az <a href=ftp://ftp.FreeBSD.org/pub/FreeBSD/ports/packages/>ftp://ftp.FreeBSD.org/pub/FreeBSD/ports/packages/</a> címen, vagy pedig a FreeBSD CD-ken találhatóak meg. A 4 CD-bõl álló készlet (illetve a PowerPak stb.) minden CD-jén találhatunk csomagokat a <span class=filename>packages/</span> könyvtárban. A csomagokat tároló könyvtár struktúrája hasonló a <span class=filename>/usr/ports</span> könyvtárban kialakított könyvtárfához. Minden kategóriának saját könyvtára van, és minden csomag megtalálható az <span class=filename>All</span> (összes) kategóriában.</p></div><div class=paragraph><p>A csomagrendszer könyvtárszerkezete tehát megegyezik a portok szétosztásával, ezáltal így képesek egymással összedolgozni a teljes csomag/port rendszer megformálásában.</p></div></div><div class=sect3><h4 id=_a_csomagok_kezelése>4.4.2. A csomagok kezelése<a class=anchor href=#_a_csomagok_kezelése></a></h4><div class=paragraph><p>A <a href="https://man.freebsd.org/cgi/man.cgi?query=pkg_info&amp;sektion=1&amp;format=html">pkg_info(1)</a> egy olyan segédprogram, amellyel készíteni lehet egy listát a telepített csomagokról, és emellett még más egyéb információkat tudhatunk meg róluk.</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># pkg_info</span>
cvsup-16.1          A general network file distribution system optimized <span class=k>for </span>CV
docbook-1.2         Meta-port <span class=k>for </span>the different versions of the DocBook DTD
...</code></pre></div></div><div class=paragraph><p>A <a href="https://man.freebsd.org/cgi/man.cgi?query=pkg_version&amp;sektion=1&amp;format=html">pkg_version(1)</a> összefoglalja az összes telepített csomag verzióját. Ezenkívül össze is hasonlítja a csomagok verzióját a portfában található aktuális verziókéval.</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># pkg_version</span>
cvsup                       <span class=o>=</span>
docbook                     <span class=o>=</span>
...</code></pre></div></div><div class=paragraph><p>A második oszlopban látható jelek utalnak a telepített verzió a helyi portfában található verzióéhoz viszonyított korára.</p></div><table class="tableblock frame-none grid-all stretch informaltable"><col style=width:50%><col style=width:50%><thead><tr><th class="tableblock halign-left valign-top">Jel</th><th class="tableblock halign-left valign-top">Jelentés</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class=tableblock>=</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>A telepített csomag verziója megegyzik a helyi portfában található verziójával.</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>&lt;</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>A telepített verzió a portfában levõnél régebbi.</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>A telepített verzió újabb, mint a portfában található. (A helyi portfa valószínûleg nem lett frissítve.)</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>?</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>A telepített csomag nem található a portok között. (Ez akkor történhet meg, amikor például egy portot eltávolítottak a Portgyûjteménybõl vagy átnevezték.)</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>*</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>A csomagnak több verziója is jelen van.</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>!</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>A telepített csomag szerepel az indexben, de a <code>pkg_version</code> valamiért nem volt képes összehasonlítani a verziószámát az indexben levõ bejegyzéssel.</p></td></tr></tbody></table></div><div class=sect3><h4 id=_csomagok_törlése>4.4.3. Csomagok törlése<a class=anchor href=#_csomagok_törlése></a></h4><div class=paragraph><p>Egy korábban már telepített csomag eltávolításához használjuk a <a href="https://man.freebsd.org/cgi/man.cgi?query=pkg_delete&amp;sektion=1&amp;format=html">pkg_delete(1)</a> segédprogramot.</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># pkg_delete xchat-1.7.1</span></code></pre></div></div><div class=paragraph><p>A <a href="https://man.freebsd.org/cgi/man.cgi?query=pkg_delete&amp;sektion=1&amp;format=html">pkg_delete(1)</a> használatánál szükség van a csomag teljes nevének és verziószámának megadására. A fenti parancs tehát nem mûködik, ha csak az <em>xchat</em>-et adjuk meg az <em>xchat-1.7.1</em> helyett. A telepített csomag verzióját azonban könnyedén kitalálhatjuk a <a href="https://man.freebsd.org/cgi/man.cgi?query=pkg_version&amp;sektion=1&amp;format=html">pkg_version(1)</a> alkalmazásával. Esetleg egyszerûen dzsókerkaraktereket is használhatunk:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># pkg_delete xchat\*</span></code></pre></div></div><div class=paragraph><p>Ebben az esetben az összes <code>xchat</code>-tel kezdõdõ csomagot letörli.</p></div></div><div class=sect3><h4 id=_egyebek>4.4.4. Egyebek<a class=anchor href=#_egyebek></a></h4><div class=paragraph><p>A csomagokra vonatkozó összes információ a <span class=filename>/var/db/pkg</span> könyvtárban található. Az egyes csomagok leírása és hozzájuk telepített állományok listája az ezen a könyvtáron belül elhelyezkedõ állományokban tárolódik.</p></div></div></div><div class=sect2><h3 id=ports-using>4.5. A Portgyûjtemény használata<a class=anchor href=#ports-using></a></h3><div class=paragraph><p>A most következõ szakaszokban megismerhetjük azokat az alapvetõ utasításokat, amelyekkel a Portgyûjteményen keresztül tudunk programokat telepíteni és eltávolítani. Az ehhez használható <code>make</code> targetek és környezeti változók részletesebb leírását a <a href="https://man.freebsd.org/cgi/man.cgi?query=ports&amp;sektion=7&amp;format=html">ports(7)</a> man oldalán lelhetjük meg.</p></div><div class=sect3><h4 id=ports-tree>4.5.1. A Portgyûjtemény beszerzése<a class=anchor href=#ports-tree></a></h4><div class=paragraph><p>Mielõtt bármelyik portot is tudnánk telepíteni, elsõként magát a Portgyûjteményt kell megszereznünk - ez lényegében a <span class=filename>/usr/ports</span> könyvtárban megtalálható <span class=filename>Makefile</span> állományok, javítások és leírások gyûjteménye.</p></div><div class=paragraph><p>A FreeBSD telepítése közben a sysinstall rákérdez a Portgyûjtemény telepítésére is. Ha erre nemet válaszoltunk volna, a portok gyûjteményét az alábbi módokon szerezhetjük be:</p></div><div class="exampleblock procedure"><div class=content><div class=paragraph><p><strong>Procedure: A CVSup használatával</strong></p></div><div class=paragraph><p>A CVSup protokoll használatával viszonylag gyorsan el tudjuk érni és naprakészen tudjuk tartani a Portgyûjtemény egy példányát. A CVSup használatát alaposabban a <a href=./#cvsup>A CVSup használata</a> címû függelékben ismerhetjük meg.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>A FreeBSD 6.2 változatától kezdve az alaprendszerben a CVSup protokollt a csup valósítja meg. A FreeBSD korábbi változatának használói ezt a programot a <a class=package href=https://cgit.freebsd.org/ports/tree/net/csup/>net/csup</a> porton vagy csomagon keresztül tudják telepíteni.</p></div></td></tr></tbody></table></div><div class=paragraph><p>Gondoskodjunk róla, hogy a <span class=filename>/usr/ports</span> üres legyen a csup elsõ futtatása elõtt! Ha más forrásból raktuk ide a Portgyûjteményt, a csup nem fogja lenyesegetni az azóta eltávolított javításokat.</p></div><div class="olist arabic"><ol class=arabic><li><p>Futtassuk a <code>csup</code> programot:</p><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># csup -L 2 -h cvsup.FreeBSD.org /usr/shared/examples/cvsup/ports-supfile</span></code></pre></div></div><div class=paragraph><p>Itt írjuk át a <em>cvsup.FreeBSD.org</em> címét a hozzánk legközelebb levõ CVSup szerver címére. Az összes elérhetõ tükörszerver címét a <a href=./#cvsup-mirrors>CVSup tükrözések</a> (<a href=./#cvsup-mirrors>CVSup oldalak</a>) címû részben olvashatjuk.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Ha például el akarjuk kerülni a CVSup szerver megadását a parancssorban, akkor mindenképpen a <span class=filename>ports-supfile</span> állományból érdemes készíteni egy saját verziót.</p></div><div class="olist loweralpha procedure"><ol class=loweralpha type=a><li><p>Ebben az esetben <code>root</code> felhasználóként másoljuk a <span class=filename>/usr/shared/examples/cvsup/ports-supfile</span> állományt egy új helyre, például a <span class=filename>/root</span> könyvtárba vagy a saját felhasználói könyvtárunkba.</p></li><li><p>Szerkesszük át a <span class=filename>ports-supfile</span> állományt.</p></li><li><p>Írjuk át a <em>CHANGE_THIS.FreeBSD.org</em> értéket a hozzánk legközelebb található CVSup szerverére. A <a href=./#cvsup-mirrors>CVSup tükrözések</a> (<a href=./#cvsup-mirrors>CVSup oldalak</a>) címû részben megtaláljuk az összes ilyen tükörszervert.</p></li><li><p>És most indítsuk el a <code>csup</code> parancsot az alábbi módon:</p><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># csup -L 2 /root/ports-supfile</span></code></pre></div></div></li></ol></div></td></tr></tbody></table></div></li><li><p>A <a href="https://man.freebsd.org/cgi/man.cgi?query=csup&amp;sektion=1&amp;format=html">csup(1)</a> parancs késõbbi futása során már letölti és érvényesíti az észlelt változtatásokat a saját Portgyûjteményünkben, de a telepített portokat nem fogja újrafordítani.</p></li></ol></div></div></div><div class="exampleblock procedure"><div class=content><div class=paragraph><p><strong>Procedure: A Portsnap használatával</strong></p></div><div class=paragraph><p>A Portsnap egy másik módszert képvisel a Portgyûjtemény terjesztésére, a lehetõségeinek részletesebb megismeréséhez tekintsük át <a href=./#updating-upgrading-portsnap>A Portsnap használata</a> címû szakaszt.</p></div><div class="olist arabic"><ol class=arabic><li><p>Töltsük le a Portgyûjtemény tömörített pillanatképét a <span class=filename>/var/db/portsnap</span> könyvtárba. Ha akarjuk, ezután a lépés után már lekapcsolódhatunk az internetrõl.</p><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># portsnap fetch</span></code></pre></div></div></li><li><p>Ha még csak elõször futtatjuk a Portsnapet, bontsuk ki az imént letöltött állapotot a <span class=filename>/usr/ports</span> könyvtárba:</p><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># portsnap extract</span></code></pre></div></div><div class=paragraph><p>Ha viszont már korábban is létezett a <span class=filename>/usr/ports</span> könyvtárunk és most csak frissítjük, akkor helyette ezt a parancsot adjuk ki:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># portsnap update</span></code></pre></div></div></li></ol></div></div></div><div class="exampleblock procedure"><div class=content><div class=paragraph><p><strong>Procedure: A sysinstall használatával</strong></p></div><div class=paragraph><p>Ebben az esetben a sysinstall nevû programmal telepítjük a Portgyûjteményt valamilyen telepítõeszközrõl. Ilyenkor azonban a kiadás dátumának megfelelõ, valószínûleg régebbi változat kerül fel. Ha rendelkezünk internet-hozzáféréssel, akkor inkább az elõbb tárgyalt módszerek valamelyikét alkalmazzuk.</p></div><div class="olist arabic"><ol class=arabic><li><p><code>root</code> felhasználóként adjuk ki a <code>sysinstall</code> parancsot, ahogy itt is láthatjuk:</p><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># sysinstall</span></code></pre></div></div></li><li><p>Menjünk le és álljunk meg a <span class=guimenuitem>Configure</span> (Beállítások) menüpontnál, és nyomjunk <kbd>Enter</kbd> billentyût.</p></li><li><p>Menjünk le és keressük meg a <span class=guimenuitem>Distributions</span> (Terjesztések) menüponot, majd nyomjuk meg az <kbd>Enter</kbd> billentyût.</p></li><li><p>Menjünk le, válasszuk ki a <span class=guimenuitem>ports</span> elemet a <kbd>Szóköz</kbd> megnyomásával.</p></li><li><p>Menjünk fel az <span class=guimenuitem>Exit</span> (Kilépés) ponthoz, nyomjuk meg az <kbd>Enter</kbd> billentyût.</p></li><li><p>Válasszuk ki a telepítéshez használni kívánt eszközt, mint például CD, FTP stb.</p></li><li><p>Menjünk fel az <span class=guimenuitem>Exit</span> (Kilépés) menüpontig, majd nyomjuk meg az <kbd>Enter</kbd> billentyût.</p></li><li><p>Végezetül lépjünk ki a sysinstall programból, aminhez nyomjuk meg az <kbd>X</kbd> billentyût.</p></li></ol></div></div></div></div><div class=sect3><h4 id=ports-skeleton>4.5.2. Portok telepítése<a class=anchor href=#ports-skeleton></a></h4><div class=paragraph><p>A "váz" fogalma az elsõ, amit a Portgyûjteménnyel kapcsolatban tisztázni kell. Dióhéjban összefoglalva, egy port váza azon állományok legszûkebb halmaza, amelyek elárulják a FreeBSD számára, hogyan fordítsuk le hibamentesen és hogyan telepítsük az adott programot. Ehhez minden port vázában megtalálható:</p></div><div class=ulist><ul><li><p>Egy <span class=filename>Makefile</span> nevû állomány. Ez tartalmazza azokat a különbözõ utasításokat, amelyek megmondják, hogyan kell lefordítani és hova kell telepíteni a rendszerünkben az adott alkalmazást.</p></li><li><p>Egy <span class=filename>distinfo</span> nevû állomány. Ebben található információ a port lefordításához szükséges állományok letöltésérõl, valamint a letöltött állományok ellenõrzéséhez szükséges (az <a href="https://man.freebsd.org/cgi/man.cgi?query=md5&amp;sektion=1&amp;format=html">md5(1)</a> és <a href="https://man.freebsd.org/cgi/man.cgi?query=sha256&amp;sektion=1&amp;format=html">sha256(1)</a> programokkal számolt) ellenõrzõösszegek.</p></li><li><p>Egy <span class=filename>files</span> alkönyvtár. Itt találhatjuk meg azokat a javításokat, amelyek alkalmazásával le tudjuk fordítani a programot FreeBSD-n is. Ezek a javítások többnyire bizonyos állományok módosításaira vonatkozó apró állományok formájában jelennek meg. Természetüknél fogva szöveges formátumúak, és általában olyanok szerepelnek bennük, hogy "Töröld a 10. sort" vagy "Változtasd meg a 26. sort erre: …​". Ezeket a javításokat eredetileg patcheknek (foltoknak) nevezik, vagy másképp diffeknek (eltéréseknek) is, mivel a <a href="https://man.freebsd.org/cgi/man.cgi?query=diff&amp;sektion=1&amp;format=html">diff(1)</a> program segítségével hozzák ezeket létre.</p><div class=paragraph><p>Ez a könyvtár tartalmazhat további állományokat is portok elkészítéséhez.</p></div></li><li><p>Egy <span class=filename>pkg-descr</span> nevû állomány. Ez a program részletesebb, gyakran többsoros bemutatása.</p></li><li><p>Egy <span class=filename>pkg-plist</span> nevû állomány. Itt találjuk meg a port által telepítendõ összes állományt. Ez egyben közli a portrendszerrel is, hogy az eltávolítás során mely állományokat kell majd törölnie.</p></li></ul></div><div class=paragraph><p>Egyes portokban szerepelhetnek még egyéb állományok is, mint például a <span class=filename>pkg-message</span>. Ezeket az állományokat a portrendszer különleges helyzetek kezelésére tartogatja. Ha még többet kívánunk megtudni ezekrõl az állományokról, vagy magukról a portokról általánosságban, lapozzuk fel a <a href=https://docs.freebsd.org/en/books/porters-handbook/>FreeBSD porterek kézikönyv</a>ét.</p></div><div class=paragraph><p>A port ugyan tartalmazza a forráskód lefordításához szükséges utasításokat, de konkrétan a forráskódot nem. Ezt egy CD-rõl vagy az internetrõl tudjuk megszerezni. A forráskód általában a szerzõje által kedvelt formában jelenik meg: ez gyakran egy gzip-pel tömörített tar állomány, de lehet tömörítve mással is, vagy éppen lehet tömörítetlen. A program forráskódját, legyen akármilyen formában is, nevezik "distfile"-nak (terjesztési állománynak). A FreeBSD portok telepítésének két módszerét tárjuk fel a következõkben.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>A portok telepítéséhez <code>root</code> felhasználóként kell bejelentkeznünk.</p></div></td></tr></tbody></table></div><div class="admonitionblock warning"><table><tbody><tr><td class=icon><i class="fa icon-warning" title=Warning></i></td><td class=content><div class=paragraph><p>Mielõtt telepítenénk bármelyik portot is, ajánlott frissíteni a Portgyûjteményünket és ellenõriznünk az adott portot a <a href=http://vuxml.freebsd.org>http://vuxml.freebsd.org</a> címen található biztonsági adatbázisban.</p></div><div class=paragraph><p>Az újonnan telepítendõ alkalmazások biztonsági sebezhetõségeinek ellenõrzését automatikussá is tehetjük a portaudit használatával. Ez a segédeszköz is a Portgyûjteményben található (<a class=package href=https://cgit.freebsd.org/ports/tree/ports-mgmt/portaudit/>ports-mgmt/portaudit</a>). Érdemes minden port telepítése elõtt letöltenünk a legfrissebb sebezhetõségi adatbázist a <code>portaudit -F</code> parancs kiadásával. Mellesleg az adatbázis rendszeres frissítése és ez a biztonsági felülvizsgálat a naponként elvégzendõ biztonsági ellenõrzések közt is megjelenik. Ezekrõl részletesebben a <a href="https://man.freebsd.org/cgi/man.cgi?query=portaudit&amp;sektion=1&amp;format=html">portaudit(1)</a> és <a href="https://man.freebsd.org/cgi/man.cgi?query=periodic&amp;sektion=8&amp;format=html">periodic(8)</a> man oldalakon olvashatunk.</p></div></td></tr></tbody></table></div><div class=paragraph><p>A Portgyûjtemény feltételezi, hogy mûködõ internet-hozzáféréssel rendelkezünk. Amennyiben ez nem így lenne, a terjesztési állományokat, forráskódokat saját magunknak kell bemásolnunk a <span class=filename>/usr/ports/distfiles</span> könyvtárba.</p></div><div class=paragraph><p>A kezdéshez lépjünk be a telepítendõ port könyvtárába:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># cd /usr/ports/sysutils/lsof</span></code></pre></div></div><div class=paragraph><p>Miután beléptünk az <span class=filename>lsof</span> könyvtárába, láthatjuk a port vázát. A következõ lépés a fordítás, avagy a port "buildelése" (elkészítése). Ezt egy szimpla <code>make</code> parancs kiadásával kezdeményezhetjük. Miután megtettük, valami ilyesmit kell tapasztalnunk:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># make</span>
<span class=o>&gt;&gt;</span> lsof_4.57D.freebsd.tar.gz doesn<span class=s1>&#39;t seem to exist in /usr/ports/distfiles/.
&gt;&gt; Attempting to fetch from ftp://lsof.itap.purdue.edu/pub/tools/unix/lsof/.
===&gt;  Extracting for lsof-4.57
...
[ide jön a kitömörítés kimenete]
...
&gt;&gt; Checksum OK for lsof_4.57D.freebsd.tar.gz.
===&gt;  Patching for lsof-4.57
===&gt;  Applying FreeBSD patches for lsof-4.57
===&gt;  Configuring for lsof-4.57
...
[ide jön a configure szkript kimenete]
...
===&gt;  Building for lsof-4.57
...
[ide jön a fordítás kimenete]
...
#</span></code></pre></div></div><div class=paragraph><p>A fordítás befejeztével visszakapjunk a parancssort. A soron következõ lépés a port telepítése lesz. Ehhez mindössze egyetlen szóval kell kiegészítenünk a <code>make</code> parancs meghívását: ez a szó pedig az <code>install</code> (telepít) lesz.</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># make install</span>
<span class=o>===&gt;</span>  Installing <span class=k>for </span>lsof-4.57
...
<span class=o>[</span>a telepítés kimenete kimarad]
...
<span class=o>===&gt;</span>   Generating temporary packing list
<span class=o>===&gt;</span>   Compressing manual pages <span class=k>for </span>lsof-4.57
<span class=o>===&gt;</span>   Registering installation <span class=k>for </span>lsof-4.57
<span class=o>===&gt;</span>  SECURITY NOTE:
      This port has installed the following binaries which execute with
      increased privileges.
<span class=c>#</span></code></pre></div></div><div class=paragraph><p>Miután ismét visszakaptuk a parancssort, már futtatni is tudjuk a frissen telepített alkalmazásunkat. Mivel az <code>lsof</code> programnak tovább jogosultságokra is szüksége van, egy errõl szóló biztonsági figyelmeztetést is láthatunk. A portok létrehozása és telepítése során érdemes figyelnünk az ehhez hasonló figyelmeztetésekre.</p></div><div class=paragraph><p>A telepítés befejeztével nem árt törölnünk a fordításhoz felhasznált alkönyvtárat (work) is. Ezzel nemcsak a drága lemezterületet spóroljuk meg, hanem megelõzzük a port késõbbi frissítése során felmerülõ esetleges problémákat is.</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># make clean</span>
<span class=o>===&gt;</span>  Cleaning <span class=k>for </span>lsof-4.57
<span class=c>#</span></code></pre></div></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Az eljárásból két lépést meg is tudunk takarítani, ha egyszerûen csak a <code>make install clean</code> parancsot adjuk ki az elõbb három lépésben tagolt <code>make</code>, <code>make install</code> és <code>make clean</code> parancsok helyett.</p></div></td></tr></tbody></table></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Bizonyos parancsértelmezõk a <code>PATH</code> környezeti változóban felsorolt könyvtárakban található parancsokat gyorsítótárban tárolják, ezzel felgyorsítva a hozzájuk tartozó végrehajtható állományok keresését. Ha történetesen ilyen parancsértelmezõt használnánk, az új portok telepítése után szükségünk lehet a <code>rehash</code> parancs kiadására, mivel enélkül nem tudjuk elérni a frissen telepített parancsokat. Ezt a parancsot például a <code>tcsh</code> és a hozzá hasonló parancsértelmezõkben találhatjuk meg, az <code>sh</code> és rokonainál pedig a <code>hash -r</code> ennek a megfelelõje. A pontos információkat errõl a témáról a parancsértelmezõnk dokumentációjában lelhetjük meg.</p></div></td></tr></tbody></table></div><div class=paragraph><p>Némely külsõ DVD termék, mint például a <a href=http://www.freebsdmall.com>FreeBSD Mall</a>tól megrendelhetõ FreeBSD Toolkit, tartalmazhatnak terjesztési állományokat. Ezek remekül használhatóak a Portgyûjteménnyel. Ehhez csatlakoztatnunk kell a DVD-t a <span class=filename>/cdrom</span> könyvtárba. Ettõl eltérõ csatlakozási pontok használata esetén ne felejtsük el átállítani a <code>CD_MOUNTPTS</code> változót sem a <code>make</code> számára. Ekkor a fordításhoz szükséges állományokat úgy fogja kezelni a rendszer, mintha a merevlemezünkön lennének.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Vigyázzunk arra, hogy néhány portot nem lehet CD-n terjeszteni. Ez részben azért lehet, mert a szükséges állományok letöltéséhez, illetve újbóli terjesztéséhez ki kell tölteni valamilyen regisztrációs nyomtatványt, vagy pedig egyéb okok miatt. Tehát ha olyan portot akarunk telepíteni, ami nincs rajta a CD-n, mindenképpen rendelkeznünk kell internetkapcsolattal.</p></div></td></tr></tbody></table></div><div class=paragraph><p>A portrendszer a <a href="https://man.freebsd.org/cgi/man.cgi?query=fetch&amp;sektion=1&amp;format=html">fetch(1)</a> segédprogramot használja az állományok letöltésére, amely figyelembevesz különféle környezeti változókat, ilyenek többek közt az <code>FTP_PASSIVE_MODE</code>, <code>FTP_PROXY</code> és az <code>FTP_PASSWORD</code>. Ha tûzfal mögött vagyunk, szükségünk lehet ezek némelyikének helyes beállítására, vagy FTP/HTTP proxyt kell használnunk. A <a href="https://man.freebsd.org/cgi/man.cgi?query=fetch&amp;sektion=3&amp;format=html">fetch(3)</a> man oldala tartalmazza ezen változók teljes listáját.</p></div><div class=paragraph><p>A <code>make fetch</code> azon felhasználók számára nyújt segítséget, akik nem csatlakoznak minden esetben a hálózatra. Egyszerûen csak futtassuk le a könyvtárszerkezet legtetejérõl (<span class=filename>/usr/ports</span>) ezt a parancsot és a szükséges állományok letöltõdnek nekünk. A parancs mûködik az alsóbb szinteken is, például a <span class=filename>/usr/ports/net</span> könyvtárban. Azonban legyünk tekintettel arra, hogy ha egy port függ más portoktól vagy függvénykönyvtáraktól, ez a parancs <em>nem fogja</em> letölteni a hozzájuk tartozó állományokat. Ilyenkor a <code>fetch</code> helyett használjuk a <code>fetch-recursive</code> targetet.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Ha a <code>make</code> parancsot egy felsõbb szinten futtatjuk, akkor ezzel létre tudjuk hozni az összes vagy csak kategóriánként az összes portot, hasonlóan az elõbb említett <code>make fetch</code> módszerhez. Ez azonban veszélyes, mivel egyes portok kizárják mások használatát. Emellett elõfordulhat az is, hogy bizonyos portok ugyanazon a néven telepítenek több, tartalmukban különbözõ állományt.</p></div></td></tr></tbody></table></div><div class=paragraph><p>Nagyon ritkán adódhat, hogy a felhasználónak nem a <code>MASTER_SITES</code> által mutatott helyekrõl kell beszereznie a szükséges állományokat (innen töltõdnek ugyanis le). A <code>MASTER_SITES</code> beállítást az alábbi paranccsal bírálhatjuk felül:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># cd /usr/ports/könyvtár</span>
<span class=c># make MASTER_SITE_OVERRIDE= \</span>
ftp://ftp.FreeBSD.org/pub/FreeBSD/ports/distfiles/ fetch</code></pre></div></div><div class=paragraph><p>Ebben a példában a <code>MASTER_SITES</code> értékét a <code>ftp.FreeBSD.org/pub/FreeBSD/ports/distfiles/</code> címre változtattuk meg.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>A portok némelyike lehetõvé teszi (esetleg meg is követeli), hogy engedélyezzük vagy letiltsuk a készülõ program bizonyos elemeit hatékonysági, biztonsági vagy egyéb testreszabási irányelvek mentén. Ilyen többek közt a <a class=package href=https://cgit.freebsd.org/ports/tree/www/mozilla/>www/mozilla</a>, a <a class=package href=https://cgit.freebsd.org/ports/tree/security/gpgme/>security/gpgme</a> és a <a class=package href=https://cgit.freebsd.org/ports/tree/mail/sylpheed-claws/>mail/sylpheed-claws</a>. Ha elérhetõek ilyen beállítási lehetõségek, arról a rendszer egy üzenetben tájékoztat minket.</p></div></td></tr></tbody></table></div><div class=sect4><h5 id=_az_alapértelmezett_könyvtárak_felülbírálása>4.5.2.1. Az alapértelmezett könyvtárak felülbírálása<a class=anchor href=#_az_alapértelmezett_könyvtárak_felülbírálása></a></h5><div class=paragraph><p>Néha hasznos (vagy kötelezõ) lehet eltérõ munka- és célkönyvtárak alkalmazása. A <code>WRKDIRPREFIX</code> és a <code>PREFIX</code> változókkal ezek alapértelmezéseit tudjuk megváltoztatni. Például a</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># make WRKDIRPREFIX=/usr/home/example/ports install</span></code></pre></div></div><div class=paragraph><p>parancs a portot a <span class=filename>/usr/home/example/ports</span> könyvtárban fogja lefordítani és az eredményét a <span class=filename>/usr/local</span> könyvtárba telepíti. A</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># make PREFIX=/usr/home/example/local install</span></code></pre></div></div><div class=paragraph><p>parancs hatására a port a <span class=filename>/usr/ports</span> könyvtárban készül el és a <span class=filename>/usr/home/example/local</span> könyvtárba települ.</p></div><div class=paragraph><p>Természetesen a</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># make WRKDIRPREFIX=../ports PREFIX=../local install</span></code></pre></div></div><div class=paragraph><p>parancs ötvözi az elõbbi kettõt (amelyet most túlságosan is hosszú lenne kiírni, de vélhetõen sejthetõ belõle az alapötlet).</p></div><div class=paragraph><p>Lehetõség van ezen változókat a saját környezetünkben is beállítani. Ha erre lenne szükségünk, nézzünk utána az ezzel kapcsolatos teendõnek a parancsértelmezõnk man oldalán.</p></div></div><div class=sect4><h5 id=_az_imake_használatáról>4.5.2.2. Az <code>imake</code> használatáról<a class=anchor href=#_az_imake_használatáról></a></h5><div class=paragraph><p>Bizonyos portok az (X Window System részeként megjelenõ) <code>imake</code> segédprogramra támaszkodnak, ahol viszont nem mûködik a <code>PREFIX</code> átállítása és mindenképpen a <span class=filename>/usr/X11R6</span> könyvtárba akar telepíteni. Ehhez hasonlóan egyes Perl portok figyelmen kívül hagyják a <code>PREFIX</code> változót és közvetlenül a Perl fájába kerülnek. Az ilyen portok esetén nagyon nehéz vagy szinte lehetetlen betartatni a <code>PREFIX</code> használatát.</p></div></div><div class=sect4><h5 id=_a_portok_újrakonfigurálása>4.5.2.3. A portok újrakonfigurálása<a class=anchor href=#_a_portok_újrakonfigurálása></a></h5><div class=paragraph><p>Egyes portok lefordítása elõtt megjelenik egy ncurses alapú menü, ahol ki tudunk választani bizonyos fordítási beállításokat. Gyakran elõfordul, hogy a port lefordítása után a felhasználók szeretnék újra elõhozni ezt a menüt és megadni vagy kivenni bizonyos beállításokat. Erre több mód is kínálkozik. Egyik ilyen lehetõség az, ha belépünk a port könyvtárába és kiadjuk a <code>make config</code> parancsot, amivel lényegében ismét elõcsaljuk a beállításokat összefoglaló menüt. Másik ilyen lehetõség a <code>make showconfig</code> alkalmazása, amivel a porthoz tartozó összes beállítást tudjuk egyszerre megjeleníteni. Ezek mellett még használható a <code>make rmconfig</code> parancs is, amivel törölni tudjuk az összes eddigi beállítást és így újrakezdhetjük a port konfigurációját. Ezek és a többi ilyen opció a <a href="https://man.freebsd.org/cgi/man.cgi?query=ports&amp;sektion=7&amp;format=html">ports(7)</a> man oldalon kerül bõvebb kifejtésre.</p></div></div></div><div class=sect3><h4 id=ports-removing>4.5.3. A portok eltávolítása<a class=anchor href=#ports-removing></a></h4><div class=paragraph><p>Most már tudjuk, miként lehet portokat telepíteni, azonban valószínûleg még az is érdekelhet minket, hogy miként kell ezeket eltávolítani abban az esetben, ha például késõbb meggondolnánk magunkat velük kapcsolatban. A korábban telepített példaportot fogjuk eltávolítani (a figyelmetlenek kedvéért megemlítjük, hogy ez az <code>lsof</code> volt). A portok eltávolítása teljesen egybevág a csomagokéval (errõl a <a href=#packages-using>csomagokról szóló részben</a> beszéltünk), mivel ekkor is használhatjuk a <a href="https://man.freebsd.org/cgi/man.cgi?query=pkg_delete&amp;sektion=1&amp;format=html">pkg_delete(1)</a> parancsot:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># pkg_delete lsof-4.57</span></code></pre></div></div></div><div class=sect3><h4 id=ports-upgrading>4.5.4. A portok frissítése<a class=anchor href=#ports-upgrading></a></h4><div class=paragraph><p>Elõször is a <a href="https://man.freebsd.org/cgi/man.cgi?query=pkg_version&amp;sektion=1&amp;format=html">pkg_version(1)</a> parancs felhasználásával listázzuk ki azokat a portokat, amik felett már eljárt az idõ és a Portgyûjteményben található belõlük újabb verzió:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># pkg_version -v</span></code></pre></div></div><div class=sect4><h5 id=ports-file-updating>4.5.4.1. A <span class=filename>/usr/ports/UPDATING</span> állomány<a class=anchor href=#ports-file-updating></a></h5><div class=paragraph><p>Miután frissítettük a Portgyûjteményünket, de még mielõtt megpróbálnánk akármelyik portot is frissíteni, érdemes egy pillantást vetnünk a <span class=filename>/usr/ports/UPDATING</span> állományra. Itt megtalálhatóak azok a problémák és a hozzájuk tartozó lépések, amelyekkel a felhasználóknak a portok frissítése során szembe kell nézniük, beleértve az állományformátumok, a konfigurációs állományok helyének megváltozását vagy egyéb olyan módosításokat, amik a korábbi verziókkal összeférhetetlenséget szülhetnek.</p></div><div class=paragraph><p>Amennyiben az <span class=filename>UPDATING</span> állomány tartalma ellentmondana az itt olvasottakkal, mindig az <span class=filename>UPDATING</span> állományban leírtak az irányadóak.</p></div></div><div class=sect4><h5 id=portupgrade>4.5.4.2. Portok frissítése a portupgrade használatával<a class=anchor href=#portupgrade></a></h5><div class=paragraph><p>A portupgrade nevû segédprogramot a portok egyszerûbb frissítésére találták ki, és a <a class=package href=https://cgit.freebsd.org/ports/tree/ports-mgmt/portupgrade/>ports-mgmt/portupgrade</a> portban található meg. A <code>make install clean</code> paranccsal bármelyik más porthoz hasonlóan telepíthetjük:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># cd /usr/ports/ports-mgmt/portupgrade</span>
<span class=c># make install clean</span></code></pre></div></div><div class=paragraph><p>A <code>pkgdb -F</code> paranccsal fésültessük át a telepített portok listáját, és javítsuk az általa jelentett ellentmondásokat. Érdemes rendszeresen elvégezni ezt, lehetõleg minden frissítés elõtt.</p></div><div class=paragraph><p>Miután kiadtuk a <code>portupgrade -a</code> parancsot, a portupgrade nekilát frissíteni az összes elavult portot a rendszerünkben. Ha minden egyes frissítést külön meg szeretnénk erõsíteni, használjuk a <code>-i</code> kapcsolót is.</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># portupgrade -ai</span></code></pre></div></div><div class=paragraph><p>Ha nem akarjuk az összes portot frissíteni, csupán egy bizonyos alkalmazásét, használjuk a <code>portupgrade pkgname</code> paraméterezést. A <code>-R</code> kapcsoló megadásával a portupgrade elõször frissíti az adott alkalmazás függõségeit.</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># portupgrade -R firefox</span></code></pre></div></div><div class=paragraph><p>Ha a mûvelet során csomagokat kívánunk használni portok helyett, adjuk meg a <code>-P</code> kapcsolót. Ennek révén a portupgrade megkeresi a csomagokat a <code>PKG_PATH</code> környezeti változóban felsorolt könyvtárakban vagy ha itt nem találja, letölti ezeket egy távoli szerverrõl. Amennyiben a csomagokat sem helyben, sem pedig a távoli szerveren nem találja, a portupgrade helyettük portokat fog használni. Ilyenkor a portok használatát a <code>-PP</code> kapcsoló beállításával lehet elkerülni:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># portupgrade -PP gnome2</span></code></pre></div></div><div class=paragraph><p>Csak a terjesztési állományok (vagy a <code>-P</code> esetén csomagok) letöltéséhez használjuk a <code>-F</code> kapcsolót. Mindezekrõl részletesebben a <a href="https://man.freebsd.org/cgi/man.cgi?query=portupgrade&amp;sektion=1&amp;format=html">portupgrade(1)</a> man oldalon olvashatunk.</p></div></div><div class=sect4><h5 id=portmanager>4.5.4.3. Portok frissítése a Portmanager használatával<a class=anchor href=#portmanager></a></h5><div class=paragraph><p>A Portmanager egy másik hasznos segédprogram a portok könnyû frissítéséhez. A <a class=package href=https://cgit.freebsd.org/ports/tree/ports-mgmt/portmanager/>ports-mgmt/portmanager</a> porton keresztül érhetõ el:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># cd /usr/ports/ports-mgmt/portmanager</span>
<span class=c># make install clean</span></code></pre></div></div><div class=paragraph><p>Használatával az összes telepített port egyetlen paranccsal frissíthetõ:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># portmanager -u</span></code></pre></div></div><div class=paragraph><p>Ha a Portmanager minden egyes lépését külön meg kívánjuk erõsíteni, akkor a <code>-ui</code> kapcsolókat se felejtsük el megadni. A Portmanager emellett új portok telepítésére is használható. Eltérõen a <code>make install clean</code> parancsban megszokottaktól, a kiválasztott port összes függõségét még a fordítás és a telepítés elõtt fogja frissíteni.</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># portmanager x11/gnome2</span></code></pre></div></div><div class=paragraph><p>Ha bármilyen gondot tapasztalnánk a kiválasztott port függõségeit illetõen, a Portmanagert felkérhetjük az összes függõség helyes sorrendben történõ újrafordítására. Amikor befejezte, a problémás portot is újra létrehozza.</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># portmanager graphics/gimp -f</span></code></pre></div></div><div class=paragraph><p>Bõvebb információkért lásd <a href="https://man.freebsd.org/cgi/man.cgi?query=portmanager&amp;sektion=1&amp;format=html">portmanager(1)</a>.</p></div></div><div class=sect4><h5 id=_portok_frissítése_a_portmaster_használatával>4.5.4.4. Portok frissítése a Portmaster használatával<a class=anchor href=#_portok_frissítése_a_portmaster_használatával></a></h5><div class=paragraph><p>A Portmaster szintén a portok frissítésére alkalmas segédprogram. A Portmaster esetében a hangsúly az "alaprendszerben" is megtalálható eszközök használatán van (tehát nem függ semmilyen más porttól) és a <span class=filename>/var/db/pkg/</span> könyvtárban található információk alapján dönti el, hogy milyen portokat kell frissítenie. A <a class=package href=https://cgit.freebsd.org/ports/tree/ports-mgmt/portmaster/>ports-mgmt/portmaster</a> portból érhetõ el:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># cd /usr/ports/ports-mgmt/portmaster</span>
<span class=c># make install clean</span></code></pre></div></div><div class=paragraph><p>A Portmaster a portokat az alábbi négy kategória valamelyikébe sorolja be:</p></div><div class=ulist><ul><li><p>Gyökér (root) portok (nem függenek semmitõl, semmi sem függ tõlük)</p></li><li><p>Törzs (trunk) portok (nem függenek semmitõl, de mások függenek tõlük)</p></li><li><p>Ág (branch) portok (vannak függõségeik és mások is függenek tõlük)</p></li><li><p>Levél (leaf) portok (vannak függõségeik, de semmi sem függ tõlük)</p></li></ul></div><div class=paragraph><p>A következõ paranccsal le tudjuk kérni az összes telepített portot és az <code>-L</code> kapcsolóval frissítéseket keresni hozzájuk:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># portmaster -L</span>
<span class=o>===&gt;&gt;&gt;</span> Root ports <span class=o>(</span>No dependencies, not depended on<span class=o>)</span>
<span class=o>===&gt;&gt;&gt;</span> ispell-3.2.06_18
<span class=o>===&gt;&gt;&gt;</span> screen-4.0.3
        <span class=o>===&gt;&gt;&gt;</span> New version available: screen-4.0.3_1
<span class=o>===&gt;&gt;&gt;</span> tcpflow-0.21_1
<span class=o>===&gt;&gt;&gt;</span> 7 root ports
...
<span class=o>===&gt;&gt;&gt;</span> Branch ports <span class=o>(</span>Have dependencies, are depended on<span class=o>)</span>
<span class=o>===&gt;&gt;&gt;</span> apache-2.2.3
        <span class=o>===&gt;&gt;&gt;</span> New version available: apache-2.2.8
...
<span class=o>===&gt;&gt;&gt;</span> Leaf ports <span class=o>(</span>Have dependencies, not depended on<span class=o>)</span>
<span class=o>===&gt;&gt;&gt;</span> automake-1.9.6_2
<span class=o>===&gt;&gt;&gt;</span> bash-3.1.17
        <span class=o>===&gt;&gt;&gt;</span> New version available: bash-3.2.33
...
<span class=o>===&gt;&gt;&gt;</span> 32 leaf ports

<span class=o>===&gt;&gt;&gt;</span> 137 total installed ports
        <span class=o>===&gt;&gt;&gt;</span> 83 have new versions available</code></pre></div></div><div class=paragraph><p>Az összes telepített port egyetlen egyszerû paranccsal frissíthetõ:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># portmaster -a</span></code></pre></div></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>A Portmaster alapértelmezés szerint minden egyes törlendõ korábbi portról biztonsági másolatot készít. Amikor az új változat telepítése sikeresen lezajlott, akkor a Portmaster ezt a másolatot megsemmisíti. A <code>-b</code> paraméterrel azonban megkérhetjük, hogy ne törölje le a biztonsági mentést. Az <code>-i</code> megadásával a Portmaster interaktív módban indul el, és minden port frissítése elõtt a felhasználó megerõsítését fogja kérni.</p></div></td></tr></tbody></table></div><div class=paragraph><p>Amennyiben valamilyen hiba lép fel a frissítés folyamán, az <code>-f</code> opció megadásával kérhetjük az összes port frissítését és újrafordítását is:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># portmaster -af</span></code></pre></div></div><div class=paragraph><p>A Portmaster használatával új portokat is fel tudunk telepíteni a rendszerre úgy, hogy azok függõségeit is igyekszik frissíteni a lefordításuk elõtt:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># portmaster shells/bash</span></code></pre></div></div><div class=paragraph><p>A további részleteket a <a href="https://man.freebsd.org/cgi/man.cgi?query=portmaster&amp;sektion=8&amp;format=html">portmaster(8)</a> man oldalon találjuk.</p></div></div></div><div class=sect3><h4 id=ports-disk-space>4.5.5. A portok tárigénye<a class=anchor href=#ports-disk-space></a></h4><div class=paragraph><p>A Portgyûjtemény idõvel egyre több helyet fog elfoglalni a merevlemezünkön. Miután sikeresen létrehoztunk és telepítettünk egy szoftvert a hozzá tartozó portból, érdemes mindig eltakarítanunk magunk után a <span class=filename>work</span> könyvtárban menet közben keletkezett átmeneti állományokat a <code>make clean</code> parancs használatával. Az egész Portgyûjteményt egyetlen mozdulattal ezzel a paranccsal tudjuk végigsepregetni:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># portsclean -C</span></code></pre></div></div><div class=paragraph><p>Az idõ elõrehaladtával a <span class=filename>distfiles</span> könyvtárban is rengeteg régi forrás tud felhalmazódni. Ezeket eltávolíthatjuk kézzel, vagy az alábbi parancs segítségével törölhetjük az összes olyan terjesztési állományt, amelyekre már egyetlen port sem hivatkozik:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># portsclean -D</span></code></pre></div></div><div class=paragraph><p>Vagy törölhetjük az összes olyan terjesztési állományt, amelyre egyetlen pillanatnyilag feltelepített port sem hivatkozik a rendszerünkben:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># portsclean -DD</span></code></pre></div></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>A <code>portsclean</code> segédprogram a portupgrade programcsomag része.</p></div></td></tr></tbody></table></div><div class=paragraph><p>Ne felejtsük el eltávolítani azokat a portokat, amikre már nincs szükségünk a továbbiakban. Ebben a feladatban egy jól használható segédeszköz lehet a segítségünkre, a <a class=package href=https://cgit.freebsd.org/ports/tree/ports-mgmt/pkg_cutleaves/>ports-mgmt/pkg_cutleaves</a> port.</p></div></div></div><div class=sect2><h3 id=ports-nextsteps>4.6. Telepítés utáni teendõk<a class=anchor href=#ports-nextsteps></a></h3><div class=paragraph><p>Az új alkalmazás feltelepítése után minden bizonnyal szeretnénk elolvasni a hozzá társított dokumentációt, az egyedi beállításainknak megfelelõen módosítani a konfigurációs állományokat, engedélyezni a rendszerindítás során történõ automatikus indítását (ha démonról lenne szó) és így tovább.</p></div><div class=paragraph><p>Az egyes alkalmazások beállításához elvégzendõ lépések nyilvánvalóan egyedenként eltérõek. Azonban tudunk szolgálni néhány általános tanáccsal válaszként az ilyenkor felmerülõ "Na és akkor most mi legyen?" kérdésre:</p></div><div class=ulist><ul><li><p>Kérdezzük meg a <a href="https://man.freebsd.org/cgi/man.cgi?query=pkg_info&amp;sektion=1&amp;format=html">pkg_info(1)</a> programtól, milyen állományok és hova kerültek fel a telepítés során. Például, ha a SzuperCsomag 1.0.0-át raktunk fel, akkor a</p><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># pkg_info -L SzuperCsomag-1.0.0 | less</span></code></pre></div></div><div class=paragraph><p>parancs kilistázza az összes állományt, amit a csomagból felraktunk. Ezek közül leginkább a <span class=filename>man/</span> könyvtárban levõekre figyeljünk, mivel ezek lesznek az alkalmazás man oldalai. Ehhez hasonlóan az <span class=filename>etc/</span> könyvtárban a konfigurációs állományok és a <span class=filename>doc/</span> könyvtárban pedig a nagyobb lélegzetvételû dokumentációk foglalnak helyet.</p></div><div class=paragraph><p>Ha nem emlékszünk pontosan rá, hogy az alkalmazások melyik verzióját is telepítettük, a</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># pkg_info | grep -i SzuperCsomag</span></code></pre></div></div><div class=paragraph><p>alakú parancs megkeresi az összes olyan csomagot, aminek a nevében szerepel a <em>SzuperCsomag</em> szövegrészlet. A fenti példában természetesen igény szerint változtassuk meg a <em>SzuperCsomag</em> szöveget a tényleges csomag nevére.</p></div></li><li><p>Ahogy sikerült megtalálnunk az alkalmazáshoz tartozó man oldalakat, lapozzuk fel ezeket a <a href="https://man.freebsd.org/cgi/man.cgi?query=man&amp;sektion=1&amp;format=html">man(1)</a> segítségével. Ugyanígy nézzük át a mellékelt minta konfigurációs állományokat és az összes elérhetõ dokumentációt.</p></li><li><p>Ha az alkalmazásnak van saját honlapja, kutassunk ott is információk után, olvassuk el a gyakran ismételt kérdéseket és így tovább. Ha nem tudnánk pontosan a honlap címét, a</p><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># pkg_info SzuperCsomag-1.0.0</span></code></pre></div></div><div class=paragraph><p>kimenetébõl könnyen elõkeríthetõ. Itt egy <code>WWW:</code> kezdetû sort kell keresnünk (már amennyiben létezik), amit az alkalmazás honlapjának címe kell kövessen.</p></div></li><li><p>A rendszerrel együtt indítandó portok (ilyenek többek közt az internetes szolgáltatások), általában a <span class=filename>/usr/local/etc/rc.d</span> könyvtárba rakják a saját indítószkriptjüket. Érdemes leellenõrizni ezt a szkriptet és az igényeinknek megfelelõen módosítani, átnevezni. A <a href=./#configtuning-starting-services>Szolgáltatások indítása</a> címû szakaszban ezt részleteiben is megismerhetjük.</p></li></ul></div></div><div class=sect2><h3 id=ports-broken>4.7. Teendõ a sérült portokkal<a class=anchor href=#ports-broken></a></h3><div class=paragraph><p>Ha véletlenül ráakadnánk egy olyan portra, ami nem mûködik megfelelõen, nagyjából a következõket tudjuk tenni:</p></div><div class="olist arabic"><ol class=arabic><li><p>Derítsük ki a <a href=https://www.FreeBSD.org/support/#gnats>Hibajelentések adatbázisá</a>ból, hogy készül-e már javítás az adott porthoz. Ha igen, akkor annak befejezése után már képesek leszünk használni.</p></li><li><p>Kérjük meg a port karbantartóját, hogy segítsen. A karbantartó elérhetõségének felderítéséhez gépeljük be a <code>make maintainer</code> parancsot, vagy keressük meg a <span class=filename>Makefile</span> állományban a karbantartó e-mail címét. Ne felejtsük el neki megemlíteni a levélben a port nevét és verzióját (vagyis mindenképpen küldjük el a <code>$FreeBSD:</code> sort a <span class=filename>Makefile</span> állományból) és a parancs kiadásától a hiba felbukkanásáig tartó kimenetet.</p><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Némely portokat nem egyedülálló személyek tartanak karban, hanem egy <a href=https://docs.freebsd.org/en/articles/mailing-list-faq/>levelezési lista</a>. A legtöbbjük neve, ha nem is mindé, nagyjából ilyen alakú: <a href=mailto:freebsd-listanév@FreeBSD.org>freebsd-listanév@FreeBSD.org</a>. Egy ilyen jellegû kérdés megfogalmazása során ezt is vegyük figyelembe!</p></div><div class=paragraph><p>Kifejezetten a <a href=mailto:ports@FreeBSD.org>ports@FreeBSD.org</a> karbantartóval rendelkezõ portoknak nincs rendes gazdája. A hozzájuk kapcsolódó javítások és mindenféle segítség, ötlet errõl a levelezési listáról érkeznek. Ilyen esetekben számítunk az önkéntes segítõkre!</p></div></td></tr></tbody></table></div><div class=paragraph><p>Ha nem kapunk semmilyen választ, a hiba bejelentésére használhatjuk a <a href="https://man.freebsd.org/cgi/man.cgi?query=send-pr&amp;sektion=1&amp;format=html">send-pr(1)</a> programot is (errõl bõvebben lásd a <a href=https://docs.freebsd.org/en/articles/problem-reports/>FreeBSD-s hibajelentések írása</a> címû cikket).</p></div></li><li><p>Javítsuk meg mi magunk! A <a href=https://docs.freebsd.org/en/books/porters-handbook/>porterek kézikönyve</a> részletesen taglalja a "portok" belsõ felépítését, így onnan elindulva akár magunktól is meg tudunk javítani egy esetlegesen sérült portot, vagy be is küldhetjük a sajátunkat!</p></li><li><p>Töltsük le a porthoz tartozó csomagot a hozzánk legközelebb levõ FTP oldalról. A "központi" csomaggyûjtemény az <code>ftp.FreeBSD.org</code> címen, a <a href=ftp://ftp.FreeBSD.org/pub/FreeBSD/ports/packages/>packages nevû könyvtárban</a> található, de mielõtt ide fordulnánk, nézzük meg a hozzánk <a href=http://mirrorlist.FreeBSD.org/>legközelebb levõ tükörszervert</a> is! Ha egy csomagot így telepítünk, akkor több eséllyel fog mûködni és ráadásul még jóval gyorsabb is. A csomag telepítésére használjuk a <a href="https://man.freebsd.org/cgi/man.cgi?query=pkg_add&amp;sektion=1&amp;format=html">pkg_add(1)</a> programot.</p></li></ol></div></div></div></div><div class=sect1><h2 id=x11>Chapter 5. Az X Window System<a class=anchor href=#x11></a></h2><div class=sectionbody><div class=sect2><h3 id=x11-synopsis>5.1. Áttekintés<a class=anchor href=#x11-synopsis></a></h3><div class=paragraph><p>A FreeBSD az X11-en keresztül nyújt a felhasználók számára hatékony grafikus felhasználói felületet. Az X11 az X Window System szabadon elérhetõ változata, melyet az Xorg és az XFree86™ egyaránt implementál (valamint más egyéb programcsomagok is, amelyeket itt viszont nem tárgyalunk). A FreeBSD verziói a FreeBSD 5.2.1-RELEASE kiadással bezárólag a The XFree86™ Project, Inc. által kiadott X11 szervert, az XFree86™-ot tartalmazzák alapértelmezés szerint. A FreeBSD 5.3-RELEASE kiadástól kezdve az X11 alapértelmezett és hivatalos változata az Xorg, melyet az X.Org alapítvány a FreeBSD-éhez nagyon hasonló licenc alatt fejleszt. A FreeBSD-hez kereskedelmi X szerverek is elérhetõek.</p></div><div class=paragraph><p>Ebben a fejezetben az X11 telepítését és beállítását járjuk végig, miközben a hangsúlyt az Xorg 7.7 kiadására helyezzük. Az XFree86™ (vagyis a FreeBSD olyan régebbi változata, ahol az XFree86™ az alapértelmezett X11 rendszer) vagy az Xorg korábbi kiadásainak beállításával kapcsolatban mindig találhatunk információkat a FreeBSD kézikönyv <a href=http://docs.FreeBSD.org/doc/>http://docs.FreeBSD.org/doc/</a> címen található archivált változataiban.</p></div><div class=paragraph><p>Az X11 által támogatott megjelenítõkrõl bõvebben az <a href=http://www.x.org/>Xorg</a> honlapján olvashatunk.</p></div><div class=paragraph><p>A fejezet elolvasása során megismerjük:</p></div><div class=ulist><ul><li><p>az X Window System különbözõ alkotóelemeit, és hogy ezek miként mûködnek együtt;</p></li><li><p>hogyan telepítsük és állítsuk be az X11-et;</p></li><li><p>hogyan telepítsük és használjuk a különféle ablakkezelõket;</p></li><li><p>hogyan használjunk TrueType® betûtípusokat az X11-ben;</p></li><li><p>hogyan állítsuk be rendszerünkön a grafikus bejelentkezést (XDM).</p></li></ul></div><div class=paragraph><p>A fejezet elolvasásához ajánlott:</p></div><div class=ulist><ul><li><p>külsõ programok telepítésének ismerete (<a href=./#ports>Alkalmazások telepítése. csomagok és portok</a>).</p></li></ul></div></div><div class=sect2><h3 id=x-understanding>5.2. Az X áttekintése<a class=anchor href=#x-understanding></a></h3><div class=paragraph><p>Az X használata elsõre megdöbbentõ lehet azok számára, akik olyan más grafikus környezetekben járatosak, mint például a Microsoft® Windows® vagy a Mac OS®.</p></div><div class=paragraph><p>Míg az X minden komponensének részleteit és azok kapcsolatát nem szükséges megérteni a használatukhoz, néhány alapvetõ ismeret velük kapcsolatban elõsegíti kiaknázni az X erõsségeit.</p></div><div class=sect3><h4 id=_miért_x>5.2.1. Miért X?<a class=anchor href=#_miért_x></a></h4><div class=paragraph><p>Az X ugyan nem az elsõ UNIX®-ra íródott ablakozó rendszer, de fajtáját tekintve a legnépszerûbb. Az X eredeti fejlesztõcsapata az X elõtt egy másik ablakozó rendszeren dolgozott, aminek a neve "W" (mint "Window", azaz ablak) volt. Az X pedig az arab ábécében pontosan ezt a betût követi.</p></div><div class=paragraph><p>Az X-et hívhatjuk "X"-nek, "X Window System"-nek, és még sok más néven. Elõfordulhat azonban, hogy az "X Windows" elnevezés sértõ lehet egyes emberek számára. Errõl többet a <a href="https://man.freebsd.org/cgi/man.cgi?query=X&amp;sektion=7&amp;format=html">X(7)</a> man oldalon tudhatunk meg többet.</p></div></div><div class=sect3><h4 id=_az_x_kliens_szerver_modellje>5.2.2. Az X kliens-szerver modellje<a class=anchor href=#_az_x_kliens_szerver_modellje></a></h4><div class=paragraph><p>Az X-et már az elejétõl kezdve hálózatközpontúnak tervezték, és ezért az ún. "kliens-szerver" modellt használja.</p></div><div class=paragraph><p>Az X modelljében az "X szerver" egy olyan számítógépen fut, amelyhez billentyûzetet, monitort és egeret csatlakoztattunk. A szerver feladatai között találjuk a megjelenítés irányítását az egérrõl és a billentyûzetrõl, valamint a többi bemeneti és kimeneti eszközrõl érkezõ adatok feldolgozását és így tovább (például a digitális táblák is használhatóak beviteli eszközként, illetve egy projektor is lehet megjelenítõ). Mindegyik X alkalmazás (mint például az XTerm vagy a <a href="https://man.freebsd.org/cgi/man.cgi?query=getenv&amp;sektion=3&amp;format=html">getenv(3)</a>) egy kliens. A kliens üzeneteket küld a szervernek, például "Kérlek, rajzolj egy ablakot ezekre a koordinátákra", és a szerver pedig olyan üzeneteket küld, mint például "A felhasználó az OK gombra kattintott".</p></div><div class=paragraph><p>Az otthoni vagy a kisebb irodai környezetben az X szerver és az X kliensek általában ugyanazon a számítógépen futnak. Emellett azonban nagyon is lehetséges, hogy az X szerver egy kevésbé erõs gépen fusson, miközben az X alkalmazások (a kliensek) az irodát kiszolgáló erõsebb és drágább gépen fussanak. Egy ilyen konfigurációban az X kliensei és szerverei közti kommunikáció a hálózaton keresztül zajlik.</p></div><div class=paragraph><p>Jegyezzük meg, hogy az X szerver az a számítógép, ahol a monitor és a billentyûzet található, az X kliensek pedig azok a programok, amelyek az ablakokat jelenítik meg.</p></div><div class=paragraph><p>A protokollban semmi sem várja el, hogy a kliens és a szerver ugyanazon az operációs rendszeren vagy éppen ugyanolyan típusú számítógépen fusson. Ezért akár Microsoft® Windows®-on vagy Apple® Mac OS®-en is indíthatunk X szervert, és számos különbözõ szabad valamint kereskedelmi alkalmazás képes pontosan erre.</p></div></div><div class=sect3><h4 id=_az_ablakkezelõ>5.2.3. Az ablakkezelõ<a class=anchor href=#_az_ablakkezelõ></a></h4><div class=paragraph><p>Az X kialakításának filozófiája leginkább a UNIX® kialakításának filozófiájához hasonlítható, vagyis "eszközöket, ne szabályokat". Ez tehát azt jelenti, hogy az X nem köti meg, miként oldjuk meg vele a feladatokat. Helyette különféle eszközöket ad a felhasználó kezébe, és onnantól a saját felelõssége eldönteni, hogyan használja ki ezeket.</p></div><div class=paragraph><p>Ez a filozófia az X-ben egészen addig terjed, hogy nem rögzíti, hogyan nézzenek ki a képernyõn megjelenõ ablakok, miként kell ezeket mozgatni az egérrel, milyen billentyûk lenyomásával közlekedhetünk az ablakok között (ami a Microsoft® Windows® esetén az <span class=keyseq><kbd>Alt</kbd>+<kbd>Tab</kbd></span>), hogyan nézzen ki az ablakok címsora, a bezárás funkciónak legyen-e rajtuk gombja és így tovább.</p></div><div class=paragraph><p>Ehelyett az X az összes ezzel járó felelõsséget átadja az "ablakkezelõ" (window manager) részére. Tucatnyi ilyen ablakkezelõt találhatunk az X-hez: AfterStep, Blackbox, ctwm, Enlightenment, fvwm, Sawfish, twm, Window Maker és még sok más. Ezen ablakkezelõk mindegyike más és más kinézetet és hangulatot kínál fel: némelyikük támogatja a "virtuális munkaasztalok" (virtual desktop) létrehozását; néhányuk pedig megengedi, hogy mi magunk állítsuk be az asztal irányításához használt gombkombinációkat; köztük találhatunk olyat is, amelynek van "Start" gombja vagy ehhez hasonló eszköze; némelyek közülük ismerik a "témákat", aminek révén a kinézetük és hangulatuk teljesen megváltoztatható. Az említett ablakkezelõk és társaik a Portgyûjtemény <span class=filename>x11-wm</span> kategóriájában érhetõek el.</p></div><div class=paragraph><p>Ráadásul a KDE és a GNOME munkakörnyezetek mindegyikének van saját integrált ablakkezelõje.</p></div><div class=paragraph><p>Az egyes ablakkezelõk mellesleg eltérõ beállítási módszerrel rendelkeznek. Némelyikük kézzel összeállított konfigurációs állományt vár, mások pedig külön grafikus eszközöket tartalmaznak erre a feladatra is. Az egyikük (a Sawfish) konfigurációs állományát például a Lisp programozási nyelv egyik dialektuásban kell megírni.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=title>Az irányítás átadása</div><div class=paragraph><p>Az ablakkezelõ másik fontos feladata lekezelni, hogy az egérrel miként tudjuk átadni az ablakok között az irányítást, vagyis a fókuszt (focus policy). Minden ablakkezelõ rendszerben el kell tudnunk valahogy dönteni, hogy a beérkezõ billentyûleütések melyik ablakhoz vándoroljanak, valamint az ilyen értelemben aktív ablakot valamilyen módon jeleznünk is kell.</p></div><div class=paragraph><p>Ennek egyik ismert módszere a "fókusz kattintásra" megoldás, amely modellt a Microsoft® Windows® rendszerekben találhatjuk meg. Itt az ablakok akkor válnak aktívvá, amikor rájuk kattintunk az egérrel.</p></div><div class=paragraph><p>Az X viszont nem kötelezi el magát egyik vezérlésátadási módszer mellett sem, helyette az ablakkezelõ fogja majd eldönteni, melyik ablak birtokolja a fókuszt az adott pillanatban. A különbözõ ablakkezelõk különbözõ fókuszvezérlési technikákat ismernek. Mindegyikük ismeri a kattintásos fókuszt, azonban a többségük emellett még sok más megoldást is felkínál.</p></div><div class=paragraph><p>A legnépszerûbb fókuszvezérlési elvek:</p></div><div class=dlist><dl><dt class=hdlist1>A fókusz az egeret követi (focus-follows-mouse)</dt><dd><p>Az egérmutató alatt található ablak kapja meg fókuszt. Az érintett ablaknak nem kell feltétlenül az összes többi felett elhelyezkednie. Ilyenkor a fókuszt egyszerûen úgy vihetjük át egy másik ablakra, ha rámutatunk az egérrel, amihez még kattintanunk sem kell.</p></dd><dt class=hdlist1>Hanyag fókusz (sloppy-focus)</dt><dd><p>Ez az elv az elõbbi apró kibõvítése. Amikor a fókusz az egérmutatót követi, és az egeret a leghátsó ablakra (vagy a háttérre) visszük, akkor valójában egyik ablak sem birtokolja az irányítást, ezért a leütött billentyûk elvesznek. A hanyag fókusz használatával azonban az irányítás csak abban az esetben kerül át máshová, amikor egy másik ablakba lépünk be, nem pedig akkor, amikor a jelenlegibõl lépünk ki.</p></dd><dt class=hdlist1>Fókusz kattintásra (click-to-focus)</dt><dd><p>Az aktív ablakot egy egérkattintással választjuk ki. Ilyenkor a kiválasztott ablak "felemelkedhet" és a többi elõtt jelenhet meg. Ezt követõen az összes irányítás ebbe az ablakba vándorol, még abban az esetben is, amikor egy másik ablakra visszük az egérmutatót.</p></dd></dl></div><div class=paragraph><p>Sok ablakkezelõ ismer ezekbõl különbözõ variációikat, valamint rajtuk kívül más egyéb vezérlési elvet is. Ezzel kapcsolatban az adott ablakkezelõ dokumentációjából deríthetünk ki a legtöbbet.</p></div></td></tr></tbody></table></div></div><div class=sect3><h4 id=_widgetek>5.2.4. Widgetek<a class=anchor href=#_widgetek></a></h4><div class=paragraph><p>Az X megközelítése, vagyis az eszközök és nem a szabályok felsorakoztatása, kiterjed az egyes alkalmazásokban látható különféle widgetekre is.</p></div><div class=paragraph><p>A "widget" (window gadget, vagyis widget, de magyarul sok helyen a "mütyürke") elnevezést azokra a felhasználói felületen megjelenõ elemekre használjuk, amelyekkel valamilyen módon kapcsolatba léphetünk: kattinthatunk rájuk, "piszkálhatjuk" ezeket. Ilyenek többek közt a gombok, jelölõnégyzetek, rádiógombok, ikonok, listák és a többi. A Microsoft® Windows® nyelvén ezeket "vezérlõknek" (control) nevezzük.</p></div><div class=paragraph><p>A Microsoft® Windows® és az Apple® Mac OS® ezen a téren nagyon merev. Az alkalmazások fejlesztõinek gondoskodniuk kell róla, hogy a programjaik az elterjedt kinézetet és kialakítást kövessék. Az X viszont nem várja az egységes vezérlõeszközök vagy grafikai stílus használatát.</p></div><div class=paragraph><p>Ennek eredményeképpen az X cseppet sem kívánja meg az alkalmazásoktól, hogy közös kinézetben vagy viselkedésben osztozzanak. Természetesen léteznek népszerû eszközrendszerek és azoknak számos variációja is kialakult, beleértve az MIT Athenaját, a Motif®ot (amirõl a Microsoft® Windows® eszközeit is mintázták, az összes ferde élet és a három szürkeárnyalatot), az OpenLookot és társaikat.</p></div><div class=paragraph><p>Napjaink X alkalmazásai a KDE fejlesztéséhez használt Qt, esetleg a GNOME-hoz használt GTK+ könyvtárból származó, korszerû kinézetû widgeteket tartalmaznak. Ebbõl a szempontból megfigyelhetõ egyfajta tendencia a grafikus UNIX®-alkalmazások felépítésében, ami minden bizonnyal megkönnyíti a kezdõ felhasználók tájékozódását.</p></div></div></div><div class=sect2><h3 id=x-install>5.3. Az X11 telepítése<a class=anchor href=#x-install></a></h3><div class=paragraph><p>Az X11 FreeBSD-n alapértelmezett implementációja az Xorg. Az Xorg az X.Org alapítvány által kiadott, az X Window Systemet megvalósító nyílt forráskódú X szerver. Az Xorg az XFree86™ 4.4RC2 és X11R6.6 kódja alapján készült. A FreeBSD Portgyûjteményében jelenleg az Xorg 7.7 változata érhetõ el.</p></div><div class=paragraph><p>Az Xorg-ot a Portgyûjteménybõl így tudjuk lefordítani, majd telepíteni:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># cd /usr/ports/x11/xorg</span>
<span class=c># make install clean</span></code></pre></div></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Az egész Xorg lefordításához legalább 4 GB szabad helyre van szükségünk.</p></div></td></tr></tbody></table></div><div class=paragraph><p>Az X11-et természetesen telepíthetjük közvetlenül csomagok segítségével is. A <a href="https://man.freebsd.org/cgi/man.cgi?query=pkg_add&amp;sektion=1&amp;format=html">pkg_add(1)</a> használatával telepíthetõ bináris csomagok is elérhetõek az X11-hez. Amikor a <a href="https://man.freebsd.org/cgi/man.cgi?query=pkg_add&amp;sektion=1&amp;format=html">pkg_add(1)</a> programra bízzuk a csomag letöltését, ne adjunk meg verziószámot, a <a href="https://man.freebsd.org/cgi/man.cgi?query=pkg_add&amp;sektion=1&amp;format=html">pkg_add(1)</a> ugyanis mindig automatikusan az alkalmazás legfrissebb verzióját tölti le.</p></div><div class=paragraph><p>Az Xorg csomagjának letöltéséhez és telepítéséhez egyszerûen csak ennyit írjunk be:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># pkg_add -r xorg</span></code></pre></div></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>A fentebb megadott példák a teljes X11 rendszert telepíteni fogják, beleértve a szervereket, klienseket, betûtípusokat stb. Az X11 egyes részeihez külön találhatunk csomagokat és portokat.</p></div><div class=paragraph><p>Ha csak az X11 legszükségesebb elemeit szeretnénk telepíteni, akkor alternatívaként választhatjuk az <a class=package href=https://cgit.freebsd.org/ports/tree/x11/xorg-minimal/>x11/xorg-minimal</a> portot.</p></div></td></tr></tbody></table></div><div class=paragraph><p>A fejezet további részében szót ejtünk az X11, valamint egy irodai használatra alkalmas munkakörnyezet beállításáról.</p></div></div><div class=sect2><h3 id=x-config>5.4. Az X11 beállítása<a class=anchor href=#x-config></a></h3><div class=sect3><h4 id=_mielõtt_nekilátnánk>5.4.1. Mielõtt nekilátnánk<a class=anchor href=#_mielõtt_nekilátnánk></a></h4><div class=paragraph><p>Az X11 beállítása elõtt a célrendszer következõ adataira lesz szükségünk:</p></div><div class=ulist><ul><li><p>A monitor jellemzõi</p></li><li><p>A videokártya chipkészlete</p></li><li><p>A videokártya memóriájának mérete</p></li></ul></div><div class=paragraph><p>Az X11 a monitor jellemzõibõl állapítja meg, hogy milyen felbontásban és frissítési frekvenciával mûködtesse azt. Ezek általában a monitorhoz tartozó dokumentációból vagy a gyártó honlapjáról deríthetõek ki. Igazából két értékre van szükségünk: a függõleges és a vízszintes frissítési frekvenciára.</p></div><div class=paragraph><p>A videokártya chipkészlete határozza meg, hogy az X11 melyik meghajtóján keresztül kommunikál a grafikus hardverrel. Ez a legtöbb chipkészlet esetén magától megállapítható, de ennek ellenére mégis jó tisztában lenni ezzel arra az esetre, ha az automatikus felismerés mégsem mûködne.</p></div><div class=paragraph><p>A grafikus kártya memóriájának mérete határozza meg a rendszer által kihasználható felbontást és színmélységet. Ezt fontos tudunk ahhoz, hogy ismerjük a rendszerünk korlátait.</p></div></div><div class=sect3><h4 id=_az_x11_beállítása>5.4.2. Az X11 beállítása<a class=anchor href=#_az_x11_beállítása></a></h4><div class=paragraph><p>Az Xorg 7.3-as változatában gyakran mindenféle konfigurációs állomány használata nélkül egyszerûen csak adjuk ki a következõ parancsot:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>% startx</code></pre></div></div><div class=paragraph><p>A Xorg 7.4 verziójától kezdõdõen a számítógépünkhöz csatlakoztatott egerek és billentyûzetek HAL segítségével automatikusan felismerhetõek. Ennek megfelelõen a <a class=package href=https://cgit.freebsd.org/ports/tree/x11/xorg/>x11/xorg</a> port függõségeként telepítõdni fognak a <a class=package href=https://cgit.freebsd.org/ports/tree/sysutils/hal/>sysutils/hal</a> és <a class=package href=https://cgit.freebsd.org/ports/tree/devel/dbus/>devel/dbus</a> portok, viszont az <span class=filename>/etc/rc.conf</span> állományban a következõ sorok hozzáadásával külön engedélyeznünk kell még ezeket:</p></div><div class="literalblock programlisting"><div class=content><pre>hald_enable=&#34;YES&#34;
dbus_enable=&#34;YES&#34;</pre></div></div><div class=paragraph><p>Ezeket a szolgáltatásokat még az Xorg beállítása elõtt el kell indítanunk (a parancssorból manuálisan vagy a rendszer újraindításával).</p></div><div class=paragraph><p>Bizonyos hardvereszközök esetén az automatikus felismerés még nem mûködik megbízhatóan vagy nem jól állítja be az értékeket. Ilyen esetekben kézzel kell megadnunk a szükséges beállításokat.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>A különbözõ munkakörnyezetek, mint például a GNOME, a KDE vagy éppen az Xfce általában tartalmaznak olyan segédprogramokat, amelyekkel a felhasználó könnyedén be tudja állítani a megjelenítés paramétereit, többek közt a képernyõ felbontását. Tehát ha az alapértelmezések nem megfelelõek, viszont használni akarunk majd valamilyen munkakörnyezetet is, akkor egyszerûen csak telepítsük az adott környezetet és a hozzá tartozó eszközön keresztül állítsuk be a megjelenítést.</p></div></td></tr></tbody></table></div><div class=paragraph><p>Az X11 beállítása egy többlépcsõs folyamat. Elsõ lépésünk egy alap konfigurációs állomány összeállítása lesz. Rendszeradminisztrátorként adjuk ki az alábbi parancsot:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># Xorg -configure</span></code></pre></div></div><div class=paragraph><p>Ennek segítségével az X11 <span class=filename>xorg.conf.new</span> néven létrehozza a konfigurációs állomány vázát a <span class=filename>/root</span> könyvtárban (akár a <a href="https://man.freebsd.org/cgi/man.cgi?query=su&amp;sektion=1&amp;format=html">su(1)</a> parancsot használjuk, akár közvetlenül így jelentkezünk be, az így örökölt rendszeradminisztrátori szerepkör maga után vonja a <code>$HOME</code> könyvtár átállítását is). Az X11 megpróbálja megkeresni a célrendszerben elérhetõ grafikus eszközöket, és létrehozni egy olyan konfigurációs állományt, amely az észlelt eszközökhöz tartozó meghajtókat tölti be.</p></div><div class=paragraph><p>A következõ lépésünk legyen az imént létrehozott beállítás kipróbálása, amin keresztül ellenõrizhetjük, hogy az Xorg tényleg képes mûködni a célrendszer grafikus eszközén. Az Xorg 7.3 és azt megelõzõ változataiban ezt így tehetjük meg:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># Xorg -config xorg.conf.new</span></code></pre></div></div><div class=paragraph><p>A Xorg 7.4 és késõbbi változataiban a próba eredménye egy fekete képernyõ lesz, amely meglehetõsen megnehezítheti az X11 helyes mûködésének megállapítását. A <code>-retro</code> kapcsoló használatával azonban továbbra is elérhetjük a korábbi verziókban megszokott viselkedési módot:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># Xorg -config xorg.conf.new -retro</span></code></pre></div></div><div class=paragraph><p>Ha ezután a képernyõn egy fekete-fehér rácsot látunk egy X alakú egérmutatóval a közepén, akkor jó a beállítás. A próbát úgy szakíthatjuk meg, ha elõször a <span class=keyseq><kbd>Ctrl</kbd>+<kbd>Alt</kbd>+<kbd>Fn</kbd></span> billentyûk együttes lenyomásával átváltunk valamelyik virtuális konzolra (például az <kbd>F1</kbd> esetén az elsõre), majd megnyomjuk a <span class=keyseq><kbd>Ctrl</kbd>+<kbd>C</kbd></span> gombokat.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Az Xorg korábbi változataiban a 7.3 verzióig bezárólag a <span class=keyseq><kbd>Ctrl</kbd>+<kbd>Alt</kbd>+<kbd>Backspace</kbd></span> billentyûkombinációval tudjuk leállítani a mûködését. Amennyiben erre továbbra is szükségünk lenne, a 7.4 és késõbbi változatokban ezt úgy tudjuk engedélyezni, ha a begépeljük a következõ parancsot egy X terminálablakban:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>% setxkbmap <span class=nt>-option</span> terminate:ctrl_alt_bksp</code></pre></div></div><div class=paragraph><p>Egy másik lehetséges megoldás, ha a billenytûzet beállításához létrehozunk a <span class=filename>/usr/local/etc/hal/fdi/policy</span> könyvtárban egy konfigurációs állományt <span class=filename>x11-input.fdi</span> néven a hald számára. Ebben az állományban a következõknek kell szerepelnie:</p></div><div class="literalblock programlisting"><div class=content><pre>&lt;?xml version=&#34;1.0&#34; encoding=&#34;utf-8&#34;?&gt;
&lt;deviceinfo version=&#34;0.2&#34;&gt;
  &lt;device&gt;
    &lt;match key=&#34;info.capabilities&#34; contains=&#34;input.keyboard&#34;&gt;
	&lt;merge key=&#34;input.x11_options.XkbOptions&#34; type=&#34;string&#34;&gt;terminate:ctrl_alt_bksp&lt;/merge&gt;
    &lt;/match&gt;
&lt;/deviceinfo&gt;</pre></div></div><div class=paragraph><p>A hald a számítógép újraindításával fogja majd beolvasni ezt az állományt.</p></div><div class=paragraph><p>Ilyenkor az <span class=filename>xorg.conf.new</span> állomány <code>ServerLayout</code> vagy <code>ServerFlags</code> szekciójához vegyük még hozzá az alábbi sort:</p></div><div class="literalblock programlisting"><div class=content><pre>Option  &#34;DontZap&#34;      &#34;off&#34;</pre></div></div></td></tr></tbody></table></div><div class=paragraph><p>Ha az egér még nem mûködne, mindenképpen be kell állítanunk a továbblépés elõtt. Ezzel kapcsolatban a FreeBSD telepítésérõl szóló fejezetben levõ <a href=./#mouse>Az egér beállításai</a>t ajánljuk elolvasásra. Fontos megemlíteni, hogy az Xorg 7.4 változatától kezdõdõen az <span class=filename>xorg.conf</span><code>InputDevice</code> szekcióit az eszközök automatikusan észlelt beállításai felülbírálják. A régebbi változatok viselkedését úgy tudjuk visszanyerni, ha a <code>ServerLayout</code> és <code>ServerFlags</code> szekciók valamelyikéhez hozzáadjuk az alábbi sort:</p></div><div class="literalblock programlisting"><div class=content><pre>Option &#34;AutoAddDevices&#34; &#34;false&#34;</pre></div></div><div class=paragraph><p>Ezt követõen a beviteli eszközök a lehetséges beállítási opciók (például a billentyûzet-kiosztás váltása) mentén a korábbiakban megszokott módon konfigurálhatóak.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Ahogy arról korábban szó esett, a 7.4 verziótól kezdõdõen a hald magától érzékelni fogja a számítógépre csatlakoztatott billentyûzetet. Elõfordulhat, hogy a billentyûzet típusa vagy éppen kiosztása nem lesz megfelelõ. Ennek beállítására többnyire a népszerûbb munkakörnyezetek, mint például a GNOME, KDE vagy Xfce tartalmaznak külön segédprogramot. A <a href="https://man.freebsd.org/cgi/man.cgi?query=setxkbmap&amp;sektion=1&amp;format=html">setxkbmap(1)</a> vagy a hald konfigurációs szabályával azonban akár közvetlenül is meg tudjuk változtatni a billentyûzethez társított tulajdonságokat.</p></div><div class=paragraph><p>Például ha egy 102 gombos billentyûzetet szeretnénk használni francia kiosztással, akkor ehhez a <span class=filename>/usr/local/etc/hal/fdi/policy</span> könyvtárban kell létrehoznunk egy <span class=filename>x11-input.fdi</span> nevû állományt a hald részére. Ebben az állományban szerepeljenek az alábbi sorok:</p></div><div class="literalblock programlisting"><div class=content><pre>&lt;?xml version=&#34;1.0&#34; encoding=&#34;utf-8&#34;?&gt;
&lt;deviceinfo version=&#34;0.2&#34;&gt;
  &lt;device&gt;
    &lt;match key=&#34;info.capabilities&#34; contains=&#34;input.keyboard&#34;&gt;
	&lt;merge key=&#34;input.x11_options.XkbModel&#34; type=&#34;string&#34;&gt;pc102&lt;/merge&gt;
	&lt;merge key=&#34;input.x11_options.XkbLayout&#34; type=&#34;string&#34;&gt;fr&lt;/merge&gt;
    &lt;/match&gt;
  &lt;/device&gt;
&lt;/deviceinfo&gt;</pre></div></div><div class=paragraph><p>Ha létezik már ilyen állományunk, akkor a billentyûzet megfelelõ beállításához egyszerûen csak másoljuk ki a fenti sorokat és adjuk hozzá.</p></div><div class=paragraph><p>Indítsuk újra a számítógépet, hogy a hald beolvassa az állományt.</p></div><div class=paragraph><p>Ugyanezt egy X terminálból is kényelmesen el tudjuk végezni:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>% setxkbmap <span class=nt>-model</span> pc102 <span class=nt>-layout</span> fr</code></pre></div></div><div class=paragraph><p>A paraméterként megadható billentyûzettípusokat és -kiosztásokat a <span class=filename>/usr/local/shared/X11/xkb/rules/base.lst</span> állományban találhatjuk meg.</p></div></td></tr></tbody></table></div><div class=paragraph><p>Ezután az ízlésünknek megfelelõen hangoljuk be az <span class=filename>xorg.conf.new</span> állományt, nyissuk meg egy szövegszerkesztõben, például az <a href="https://man.freebsd.org/cgi/man.cgi?query=emacs&amp;sektion=1&amp;format=html">emacs(1)</a>-ben vagy az <a href="https://man.freebsd.org/cgi/man.cgi?query=ee&amp;sektion=1&amp;format=html">ee(1)</a>-ben. Elsõként adjuk meg a célrendszerhez csatlakoztatott monitor frekvenciájára vonatkozó adatokat. Ezek általában a függõleges és a vízszintes frissítés értékei, melyeket az <span class=filename>xorg.conf.new</span> állomány <code>"Monitor"</code> szakaszában (Section) kell feltüntetni:</p></div><div class="literalblock programlisting"><div class=content><pre>Section &#34;Monitor&#34;
        Identifier   &#34;Monitor0&#34;
        VendorName   &#34;A monitor gyártója&#34;
        ModelName    &#34;A monitor típusa&#34;
        HorizSync    30-107
        VertRefresh  48-120
EndSection</pre></div></div><div class=paragraph><p>A konfigurációs állományból valószínûleg csak a <code>HorizSync</code> és <code>VertRefresh</code> kulcsszavak fognak hiányozni. Amennyiben ez tényleg így lenne, a megfelelõ vízszintes frissítés értékét a <code>HorizSync</code> kulcsszó után, a hozzá tartozó függõleges frissítés értékét pedig a <code>VertRefresh</code> kulcsszó után kell hozzátennünk a szakaszhoz. Az iménti példában már megadtuk a célrendszer monitorának frissítési értékeit.</p></div><div class=paragraph><p>Az X megengedi, hogy DPMS (Energy Star) energiagazdálkodási szabványt ismerõ monitorok lehetõséget is kihasználjuk. A <a href="https://man.freebsd.org/cgi/man.cgi?query=xset&amp;sektion=1&amp;format=html">xset(1)</a> program vezérli a monitorok ki- és bekapcsolását, és segítségével készenléti vagy energiatakarékos üzemmódba tudjuk helyezni azokat. Ha engedélyezni kívánjuk a monitorunk DPMS lehetõségeit, egyszerûen csak tegyük hozzá az alábbi sort a monitorunkat leíró szakaszhoz:</p></div><div class="literalblock programlisting"><div class=content><pre>        Option       &#34;DPMS&#34;</pre></div></div><div class=paragraph><p>Ha már a <span class=filename>xorg.conf.new</span> konfigurációs állomány szerkesztésével vagyunk elfoglalva, válasszuk ki számunkra kedvezõ alapértelmezett felbontást és színmélységet is. Ezt a <code>"Screen"</code> (Képernyõ) nevû szakaszban tehetjük meg:</p></div><div class="literalblock programlisting"><div class=content><pre>Section &#34;Screen&#34;
        Identifier &#34;Screen0&#34;
        Device     &#34;Card0&#34;
        Monitor    &#34;Monitor0&#34;
        DefaultDepth 24
        SubSection &#34;Display&#34;
                Viewport  0 0
                Depth     24
                Modes     &#34;1024x768&#34;
        EndSubSection
EndSection</pre></div></div><div class=paragraph><p>A <code>DefaultDepth</code> kulcsszó után adjuk meg a rendszer alapértelmezett színmélységét. Ezt késõbb az <a href="https://man.freebsd.org/cgi/man.cgi?query=Xorg&amp;sektion=1&amp;format=html">Xorg(1)</a> <code>-depth</code> paraméterével bírálhatjuk felül a parancssorból. A <code>Modes</code> kulcsszó után jelennek meg azok a felbontások, amelyekben az adott színmélység elérhetõ. Itt csak olyan VESA szabványú módok jelenhetnek meg, amelyet a célrendszer grafikus eszköze is támogat. A fenti példában az alapértelmezett színmélység képpontonként huszonnégy bit, és ebben a színmélységben az elfogadott felbontás 1024-szer 768 pixel.</p></div><div class=paragraph><p>Végezetül mentsük el a szerkesztett konfigurációs állományt és próbáljuk ki a korábban leírt módszer szerint.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>A hibakeresés során maguk az X11 naplóállományai is hasznos eszköznek bizonyulhatnak, mivel ezek minden olyan eszközrõl tartalmaznak információt, amelyekhez az X11 szervernek sikerült csatlakoznia. Az Xorg naplóit a <span class=filename>/var/log/Xorg.0.log</span> elnevezést követõ állományokban találjuk meg. A konkrét naplók nevei <span class=filename>Xorg.0.log</span>-tól <span class=filename>Xorg.8.log</span>-ig és így tovább terjedhetnek.</p></div></td></tr></tbody></table></div><div class=paragraph><p>Ha minden a legnagyobb rendben haladt eddig, a konfigurációs állományt el kell tennünk egy olyan központi helyre, ahol az <a href="https://man.freebsd.org/cgi/man.cgi?query=Xorg&amp;sektion=1&amp;format=html">Xorg(1)</a> képes lesz majd megtalálni. Ez a hely általában az <span class=filename>/etc/X11/xorg.conf</span> vagy a <span class=filename>/usr/local/etc/X11/xorg.conf</span>.</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># cp xorg.conf.new /etc/X11/xorg.conf</span></code></pre></div></div><div class=paragraph><p>Az X11 beállítását ezzel befejeztük. Az Xorg innentõl elindítható a <a href="https://man.freebsd.org/cgi/man.cgi?query=startx&amp;sektion=1&amp;format=html">startx(1)</a> segédprogram vagy az <a href="https://man.freebsd.org/cgi/man.cgi?query=xdm&amp;sektion=1&amp;format=html">xdm(1)</a> használatával.</p></div></div><div class=sect3><h4 id=_témák_idõsebbeknek_és_haladóknak>5.4.3. Témák idõsebbeknek és haladóknak<a class=anchor href=#_témák_idõsebbeknek_és_haladóknak></a></h4><div class=sect4><h5 id=_az_i810_grafikus_chipkészlet_beállítása>5.4.3.1. Az i810 grafikus chipkészlet beállítása<a class=anchor href=#_az_i810_grafikus_chipkészlet_beállítása></a></h5><div class=paragraph><p>Az Intel® i810 integrált chipkészletének meghajtásához szükségünk lesz az <span class=filename>agpart</span> nevû AGP programozási felületre az X11-ben. Errõl az <a href="https://man.freebsd.org/cgi/man.cgi?query=agp&amp;sektion=4&amp;format=html">agp(4)</a> meghajtó man oldalán olvashatuk többet.</p></div><div class=paragraph><p>Ennek segítségével ezt a hardvert is a többi grafikus kártyához hasonlóan állíthatjuk be. Vegyük figyelembe azonban, hogy az <a href="https://man.freebsd.org/cgi/man.cgi?query=agp&amp;sektion=4&amp;format=html">agp(4)</a> meghajtót beépítve nem tartalmazó rendszermaggal futó rendszerekben a <a href="https://man.freebsd.org/cgi/man.cgi?query=kldload&amp;sektion=8&amp;format=html">kldload(8)</a> paranccsal utólag már nem tudjuk betölteni! Ezt a meghajtót már a rendszerindítás során be kell tudnunk tölteni: vagy a rendszermagba fordítjuk, vagy pedig a <span class=filename>/boot/loader.conf</span> állományban hivatkozunk rá.</p></div></div><div class=sect4><h5 id=_widescreen_flat_panel_monitorok_használata>5.4.3.2. Widescreen Flat Panel monitorok használata<a class=anchor href=#_widescreen_flat_panel_monitorok_használata></a></h5><div class=paragraph><p>Ebben a részben feltételezünk némi tapasztalatot a beállítások terén. Amennyiben a szabványos konfigurációs eszközök csõdöt mondtak a beállítás során, magukból a naplóállományokból is kinyerhetünk elegendõ információt ahhoz, hogy mûködésre bírjuk rendszerünket. Ehhez mindenképpen legyen kéznél egy szövegszerkesztõ!</p></div><div class=paragraph><p>A jelenlegi szélesvásznú (WSXGA, WSXGA+, WUXGA, WXGA, WXGA+ és társai) formátumok a 16:10-es és 10:9-es képarányokat ismerik, amik néha gondot okozhatnak. Például a 16:10-es képarány felbontásai:</p></div><div class=ulist><ul><li><p>2560x1600</p></li><li><p>1920x1200</p></li><li><p>1680x1050</p></li><li><p>1440x900</p></li><li><p>1280x800</p></li></ul></div><div class=paragraph><p>Bizonyos szempontból egyszerûen csak a fenti felbontások valamelyikét kell felvenni a <code>"Screen"</code> szakasz <code>Mode</code> sorába, valahogy így:</p></div><div class="literalblock programlisting"><div class=content><pre>Section &#34;Screen&#34;
Identifier &#34;Screen0&#34;
Device     &#34;Card0&#34;
Monitor    &#34;Monitor0&#34;
DefaultDepth 24
SubSection &#34;Display&#34;
	Viewport  0 0
	Depth     24
	Modes     &#34;1680x1050&#34;
EndSubSection
EndSection</pre></div></div><div class=paragraph><p>Az Xorg elég intelligens ahhoz, hogy a szélesvásznú megjelenítéssel kapcsolatos információkat lekérje a monitor I2C/DDC adatai közül, ezért meg tudja állapítani, hogy az eszköz milyen frissítési frekvenciákat és felbontásokat bír el.</p></div><div class=paragraph><p>Ha az alábbi <code>ModeLine</code> értékek nem szerepelnének a meghajtókban, akkor velük kapcsolatban egy kicsit súgnunk kell az Xorg-nak. A <span class=filename>/var/log/Xorg.0.log</span> átrágásával elegendõ információt tudunk gyûjteni ahhoz, hogy manuálisan vegyünk fel használható <code>ModeLine</code> értékeket. Nem kell mást tennünk, mint ehhez hasonló sorokat keresnünk:</p></div><div class="literalblock programlisting"><div class=content><pre>(II) MGA(0): Supported additional Video Mode:
(II) MGA(0): clock: 146.2 MHz   Image Size:  433 x 271 mm
(II) MGA(0): h_active: 1680  h_sync: 1784  h_sync_end 1960 h_blank_end 2240 h_border: 0
(II) MGA(0): v_active: 1050  v_sync: 1053  v_sync_end 1059 v_blanking: 1089 v_border: 0
(II) MGA(0): Ranges: V min: 48  V max: 85 Hz, H min: 30  H max: 94 kHz, PixClock max 170 MHz</pre></div></div><div class=paragraph><p>Ezeket nevezik EDID-adatoknak (Extended display identification data, vagyis "bõvített megjelenítési azonosító adatoknak"). Belõlük a megfelelõ <code>ModeLine</code> sor létrehozása csupán annyiból áll, hogy a számértékeket a megfelelõ sorrendbe tesszük:</p></div><div class="literalblock programlisting"><div class=content><pre>ModeLine &lt;name&gt; &lt;clock&gt; &lt;4 horiz. timings&gt; &lt;4 vert.  timings&gt;</pre></div></div><div class=paragraph><p>Ezáltal a példában látott <code>"Monitor"</code> szakasz <code>ModeLine</code> sora így fog kinézni:</p></div><div class="literalblock programlisting"><div class=content><pre>Section &#34;Monitor&#34;
Identifier      &#34;Monitor1&#34;
VendorName      &#34;Bigname&#34;
ModelName       &#34;BestModel&#34;
ModeLine        &#34;1680x1050&#34; 146.2 1680 1784 1960 2240 1050 1053 1059 1089
Option          &#34;DPMS&#34;
EndSection</pre></div></div><div class=paragraph><p>Miután végrehajtottuk ezeket az egyszerû beállítási lépéseket, az X most már valószínûleg el fog indulni az új szélesvásznú monitorunkon.</p></div></div></div></div><div class=sect2><h3 id=x-fonts>5.5. Betûtípusok használata az X11-ben<a class=anchor href=#x-fonts></a></h3><div class=sect3><h4 id=type1>5.5.1. Type1 betûtípusok<a class=anchor href=#type1></a></h4><div class=paragraph><p>Az X11-hez tartozó alap betûtípusok nem mondhatóak kifejezetten ideálisnak például egy átlagos asztali kiadványszerkesztõ alkalmazás számára. A nagyobb méretû bemutatókon a betûi szögletesen és idétlenül néznek ki, a <a href="https://man.freebsd.org/cgi/man.cgi?query=getenv&amp;sektion=3&amp;format=html">getenv(3)</a>ben megjelenõ kisebb betûk pedig szinte teljességgel olvashatatlanok. Viszont manapság már rengeteg szabad, nagyon jó minõségû és könnyen használható Type1 (PostScript®) betûtípus érhetõ el az X11-hez. Például az URW betûtípus-gyûjtemény (<a class=package href=https://cgit.freebsd.org/ports/tree/x11-fonts/urwfonts/>x11-fonts/urwfonts</a>) a szabványos Type1 betûtípusok (Times Roman™, Helvetica™, Palatino™ és még sok más) jó minõségû változatait tartalmazza. A Freefonts nevû gyûjtemény (<a class=package href=https://cgit.freebsd.org/ports/tree/x11-fonts/freefonts/>x11-fonts/freefonts</a>) is tartalmaz sok más betûtípust, de a legtöbbjüket inkább csak a Gimpben és a hozzá hasonló grafikai alkalmazásokban tudjuk használni, illetve nincsenek is még kellõ mértékben befejezve a hétköznapi munkákhoz. Ezeken felül az X11 minimális ügyeskedéssel beállítható a TrueType® betûtípusok használatára is. Errõl részleteket a <a href="https://man.freebsd.org/cgi/man.cgi?query=X&amp;sektion=7&amp;format=html">X(7)</a> man oldalon, illetve a <a href=#truetype>TrueType® betûtípusokról szóló szakaszban</a> olvashatunk.</p></div><div class=paragraph><p>A Portgyûjteménybõl az imént említett Type1 betûtípusokat az alábbi parancsok segítségével telepíthetjük:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># cd /usr/ports/x11-fonts/urwfonts</span>
<span class=c># make install clean</span></code></pre></div></div><div class=paragraph><p>Ugyanígy járjunk el a freefont és a többi gyûjtemény esetén is. Az X szerver akkor fogja észlelni ezeket a betûtípusokat, ha hozzáadjuk a következõ sort a konfigurációs állományához (<span class=filename>/etc/X11/xorg.conf</span>):</p></div><div class="literalblock programlisting"><div class=content><pre>FontPath &#34;/usr/local/lib/X11/fonts/URW/&#34;</pre></div></div><div class=paragraph><p>Vagy megtehetjük mindezt az X futtatása során is:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>% xset fp+ /usr/local/lib/X11/fonts/URW
% xset fp rehash</code></pre></div></div><div class=paragraph><p>Ez utóbbi beállítás viszont el fog veszni az X leállításával, hacsak nem vesszük hozzá az indítószkriptjéhez (ez az <span class=filename>~/.xinitrc</span> a <code>startx</code> használata esetén, illetve az <span class=filename>~/.xsession</span>, amikor egy XDM-szerû grafikus bejelentkezést használunk). Ezek mellett használhatjuk a <span class=filename>/usr/local/etc/fonts/local.conf</span> állományt is: errõl az <a href=#antialias>élsimítással</a> foglalkozó szakaszban szólunk részletesebben.</p></div></div><div class=sect3><h4 id=truetype>5.5.2. TrueType® betûtípusok<a class=anchor href=#truetype></a></h4><div class=paragraph><p>Az Xorg beépített támogatást tartalmaz a TrueType® betûtípusok rendereléséhez. Két különbözõ modul valósítja meg ezt a feladatot. Ebben példában a freetype nevû modult használjuk, mivel sokkal jobban illeszkedik a többi betûrenderelõhöz. A freetype modul használatához mindössze az <span class=filename>/etc/X11/xorg.conf</span> állomány <code>"Module"</code> szakaszába kell beírnunk a következõ sort:</p></div><div class="literalblock programlisting"><div class=content><pre>Load  &#34;freetype&#34;</pre></div></div><div class=paragraph><p>Most pedig hozzunk létre egy könyvtárat a TrueType® betûtípusok számára (ez legyen például a <span class=filename>/usr/local/lib/X11/fonts/TrueType</span>), majd másoljuk az összes TrueType® betûtípusunkat ide. Vigyázzunk rá, hogy Macintosh®-ról TrueType® betûtípusok közvetlenül nem hozhatóak át, az X11 számára UNIX®/MS-DOS®/Windows® formátumban kell lenniük. Miután sikerült átmásolnunk az állományokat ebbe a könyvtárba, használjuk a ttmkfdir parancsot a <span class=filename>fonts.dir</span> állomány létrehozására, aminek révén az X betûrenderelõje tudni fogja, hogy új állományokat telepítettünk. A <code>ttmkfdir</code><a class=package href=https://cgit.freebsd.org/ports/tree/x11-fonts/ttmkfdir/>x11-fonts/ttmkfdir</a> néven elérhetõ a FreeBSD Portgyûjteményébõl.</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># cd /usr/local/lib/X11/fonts/TrueType</span>
<span class=c># ttmkfdir -o fonts.dir</span></code></pre></div></div><div class=paragraph><p>Ezután adjuk hozzá a TrueType® könyvtárat a betûtípusok könyvtáraihoz. Itt is a <a href=#type1>Type1</a> betûtípusoknál leírtak szerint kell eljárnunk, vagyis használjunk a</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>% xset fp+ /usr/local/lib/X11/fonts/TrueType
% xset fp rehash</code></pre></div></div><div class=paragraph><p>parancsot, vagy adjunk hozzá a <span class=filename>xorg.conf</span> állományhoz egy további <code>FontPath</code> sort.</p></div><div class=paragraph><p>Ezzel végeztünk is. Innentõl kezdve a <a href="https://man.freebsd.org/cgi/man.cgi?query=getenv&amp;sektion=3&amp;format=html">getenv(3)</a>, Gimp, a StarOffice™ és mindegyik X alkalmazás fel fogja ismerni a frissen telepített TrueType® betûtípusokat. A nagyon kicsi betûk (egy honlap megtekintése során, nagyfelbontásban) és a nagyon nagy betûk (a StarOffice™ használatakor) most már sokkal jobban fognak mutatni.</p></div></div><div class=sect3><h4 id=antialias>5.5.3. A betûk élsimítása<a class=anchor href=#antialias></a></h4><div class=paragraph><p>Az X11 által használt, a <span class=filename>/usr/local/lib/X11/fonts/</span> és a <span class=filename>~/.fonts/</span> könyvtárakban található összes betûtípus élsimítása automatikusan elérhetõ az Xft-re felkészített alkalmazások számára. A mostanság megjelenõ legtöbb alkalmazás, mint például a KDE, GNOME és Firefox, ismeri az Xft-t.</p></div><div class=paragraph><p>A betûtípusok élsimításának be- és kikapcsolásához, valamint élsimítási jellemzõinek beállításához hozzuk létre (vagy ha már létezne, módosítsuk) a <span class=filename>/usr/local/etc/fonts/local.conf</span> állományt. Az Xft betûrendszer számos kifinomult lehetõsége hangolható ezzel az állománnyal, amelyekbõl ebben a szakaszban csupán rövidke ízelítõt fogunk adni. A pontosabb részletekrõl a <a href="https://man.freebsd.org/cgi/man.cgi?query=fonts-conf&amp;sektion=5&amp;format=html">fonts-conf(5)</a> man oldalon tájékozódhatunk.</p></div><div class=paragraph><p>Az állománynak XML formátumúnak kell lennie. Különösen ügyeljünk a kis- és nagybetûkre, illetve gyõzõdjünk meg mindig róla, hogy lezártuk-e az összes taget. Az állomány a szokásos XML-fejléccel kezdõdik, amelyet egy DOCTYPE definíció követ, majd a <code>&lt;fontconfig></code> tag:</p></div><div class="literalblock programlisting"><div class=content><pre>      &lt;?xml version=&#34;1.0&#34;?&gt;
      &lt;!DOCTYPE fontconfig SYSTEM &#34;fonts.dtd&#34;&gt;
      &lt;fontconfig&gt;</pre></div></div><div class=paragraph><p>Ahogy azt már korábban is említettük, a <span class=filename>/usr/local/lib/X11/fonts</span> és a <span class=filename>~/.fonts/</span> könyvtárakban található összes betûtípus élsimítása elérhetõ az Xft-re felkészített alkalmazások számára. Amennyiben ezeken túl még további könyvtárakat is fel kívánunk venni, írjuk bele a <span class=filename>/usr/local/etc/fonts/local.conf</span> állományba, nagyjából ilyen alakban:</p></div><div class="literalblock programlisting"><div class=content><pre>&lt;dir&gt;/az/en/betu/tipusaim&lt;/dir&gt;</pre></div></div><div class=paragraph><p>Az új betûtípusok, de legfõképpen az új betûtípusokat tartalmazó könyvtárak hozzáadása után a betûkkel kapcsolatos gyorsítótárak frissítéséhez mindenképpen javasolt lefuttatni az alábbi parancsot:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># fc-cache -f</span></code></pre></div></div><div class=paragraph><p>Az élsimítás hatására a betûk kontúrjai egy kissé elmosódnak, aminek köszönhetõen a nagyon kis méretû szövegek sokkal olvashatóbbá válnak és eltûnnek a nagy méretû betûkrõl a "lépcsõk", azonban a normál méretû betûknél megfájdulhat tõle a szemünk. A 14 pontnál kisebb méretû betûk esetén az alábbi sorok hozzáadásával tudjuk kikapcsolni az élsimítást:</p></div><div class="literalblock programlisting"><div class=content><pre>        &lt;match target=&#34;font&#34;&gt;
            &lt;test name=&#34;size&#34; compare=&#34;less&#34;&gt;
                &lt;double&gt;14&lt;/double&gt;
            &lt;/test&gt;
            &lt;edit name=&#34;antialias&#34; mode=&#34;assign&#34;&gt;
                &lt;bool&gt;false&lt;/bool&gt;
            &lt;/edit&gt;
        &lt;/match&gt;
        &lt;match target=&#34;font&#34;&gt;
            &lt;test name=&#34;pixelsize&#34; compare=&#34;less&#34; qual=&#34;any&#34;&gt;
                &lt;double&gt;14&lt;/double&gt;
            &lt;/test&gt;
            &lt;edit mode=&#34;assign&#34; name=&#34;antialias&#34;&gt;
                &lt;bool&gt;false&lt;/bool&gt;
            &lt;/edit&gt;
        &lt;/match&gt;</pre></div></div><div class=paragraph><p>Bizonyos egyenszélességû (monospaced) betûtípusok élsimítása esetén a betûk távolsága nem megfelelõ. Ez leginkább a KDE használata esetén merül fel. Ezt a problémát úgy is orvosolhatjuk, ha az ilyen betûtípusok térközét kézzel 100-ra állítjuk. Ehhez írjuk be a következõ sorokat:</p></div><div class="literalblock programlisting"><div class=content><pre>       &lt;match target=&#34;pattern&#34; name=&#34;family&#34;&gt;
           &lt;test qual=&#34;any&#34; name=&#34;family&#34;&gt;
               &lt;string&gt;fixed&lt;/string&gt;
           &lt;/test&gt;
           &lt;edit name=&#34;family&#34; mode=&#34;assign&#34;&gt;
               &lt;string&gt;mono&lt;/string&gt;
           &lt;/edit&gt;
        &lt;/match&gt;
        &lt;match target=&#34;pattern&#34; name=&#34;family&#34;&gt;
            &lt;test qual=&#34;any&#34; name=&#34;family&#34;&gt;
                &lt;string&gt;console&lt;/string&gt;
            &lt;/test&gt;
            &lt;edit name=&#34;family&#34; mode=&#34;assign&#34;&gt;
                &lt;string&gt;mono&lt;/string&gt;
            &lt;/edit&gt;
        &lt;/match&gt;</pre></div></div><div class=paragraph><p>(ezzel lefedjük összes rögzített méretû (fixed) betûtípust <code>"mono"</code>-ként), majd vegyük hozzá ezt is:</p></div><div class="literalblock programlisting"><div class=content><pre>         &lt;match target=&#34;pattern&#34; name=&#34;family&#34;&gt;
             &lt;test qual=&#34;any&#34; name=&#34;family&#34;&gt;
                 &lt;string&gt;mono&lt;/string&gt;
             &lt;/test&gt;
             &lt;edit name=&#34;spacing&#34; mode=&#34;assign&#34;&gt;
                 &lt;int&gt;100&lt;/int&gt;
             &lt;/edit&gt;
         &lt;/match&gt;</pre></div></div><div class=paragraph><p>Egyes betûtípusoknál, mint például a Helveticánál, gondok akadhatnak az élsimítással. Ez általában egy függõlegesen kettévágottnak látszó betû képében jelenik meg. De ami a legrosszabb, hogy emiatt némely alkalmazás képes összeomlani. Ennek elkerülésére tegyük hozzá még az alábbi sorokat a <span class=filename>local.conf</span> állományhoz:</p></div><div class="literalblock programlisting"><div class=content><pre>         &lt;match target=&#34;pattern&#34; name=&#34;family&#34;&gt;
             &lt;test qual=&#34;any&#34; name=&#34;family&#34;&gt;
                 &lt;string&gt;Helvetica&lt;/string&gt;
             &lt;/test&gt;
             &lt;edit name=&#34;family&#34; mode=&#34;assign&#34;&gt;
                 &lt;string&gt;sans-serif&lt;/string&gt;
             &lt;/edit&gt;
         &lt;/match&gt;</pre></div></div><div class=paragraph><p>Miután befejeztük a <span class=filename>local.conf</span> szerkesztését, ellenõrizzük, hogy szerepel-e az állomány végén a <code>&lt;/fontconfig></code> tag. Ha ugyanis nem zárjuk le rendesen, akkor a változtatásaink érvénytelenné válnak.</p></div><div class=paragraph><p>Végezetül a felhasználók is megadhatják a saját beállításaikat a saját <span class=filename>.fonts.conf</span> állományuk segítségével. Ehhez nem kell mást tenni, mindössze létrehozni egy <span class=filename>~/.fonts.conf</span> XML-állományt.</p></div><div class=paragraph><p>Még egy utolsó ötlet: LCD képernyõk esetén szükségünk lehet az ún. "sub-pixel sampling" (részképpont mintavételezési) technikára. Ezzel lényegében a (vízszintesen elválasztott) vörös, zöld és kék összetevõket külön-külön kezeljük a horizontális felbontás javítására. Bámulatos eredményeket lehet elérni a segítségével! A bekapcsolásához a következõ sorokat kell beszúrnunk valahova a <span class=filename>local.conf</span> állományba:</p></div><div class="literalblock programlisting"><div class=content><pre>         &lt;match target=&#34;font&#34;&gt;
             &lt;test qual=&#34;all&#34; name=&#34;rgba&#34;&gt;
                 &lt;const&gt;unknown&lt;/const&gt;
             &lt;/test&gt;
             &lt;edit name=&#34;rgba&#34; mode=&#34;assign&#34;&gt;
                 &lt;const&gt;rgb&lt;/const&gt;
             &lt;/edit&gt;
         &lt;/match&gt;</pre></div></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>A megjelenítõ fajtájától függõen lehet, hogy az <code>rgb</code> értéket <code>bgr</code>-re, <code>vrgb</code>-re vagy <code>vbgr</code>-re kell cserélnünk. Próbálgassuk és kiderül, hogy melyikkel mûködik jobban.</p></div></td></tr></tbody></table></div></div></div><div class=sect2><h3 id=x-xdm>5.6. Az X bejelentkeztetõ képernyõje<a class=anchor href=#x-xdm></a></h3><div class=sect3><h4 id=_összefoglalás>5.6.1. Összefoglalás<a class=anchor href=#_összefoglalás></a></h4><div class=paragraph><p>Az X bejelentkeztetõ képernyõje (az X Display Manager vagy röviden csak XDM) az X Window System egyik kiegészítõ eleme, melyet a bejelentkezések lebonyolítására használunk. Számtalan helyzetben hasznosnak bizonyulhat, beleértve a legkisebb "X terminálokat" és a legnagyobb hálózati szervereket is. Mivel az X Window System független hálózattól és protokolltól, a hálózaton összekapcsolt, X klienseket és szervereket futtató különbözõ számítógépek széles kombinációja elõfordulhat. Az XDM egy grafikus felületen keresztül segít választani az elérhetõ szerverek között, valamint a felhasználók, például felhasználónév és jelszón keresztüli, hitelesítésében.</p></div><div class=paragraph><p>Az XDM tulajdonképpen a felhasználó számára ugyanazokat a funkciókat nyújtja, mint a <a href="https://man.freebsd.org/cgi/man.cgi?query=getty&amp;sektion=8&amp;format=html">getty(8)</a> program (errõl bõvebben lásd <a href=./#term-config>Beállítás</a>). Tehát: belépteti a felhasználót a szerverre, ahova csatlakozott, illetve elindítja helyette a hozzá tartozó munkamenet kezelõjét (ami általában egy X-es ablakkezelõ). Az XDM megvárja ennek a programnak a befejezõdését, ami egyben jelzi számára, hogy a felhasználó elvégezte a dolgát, és kilépteti a szerverrõl. Ezután az XDM újra várakozni kezd a következõ felhasználóra, miközben a bejelentkezéshez és a szerver kiválasztásához szükséges képernyõket jeleníti meg.</p></div></div><div class=sect3><h4 id=_az_xdm_használata>5.6.2. Az XDM használata<a class=anchor href=#_az_xdm_használata></a></h4><div class=paragraph><p>A XDM használatához elõször telepítenünk kell rendszerünkre a <a class=package href=https://cgit.freebsd.org/ports/tree/x11/xdm/>x11/xdm</a> portot (mivel az Xorg újabb változatai ezt alapértelmezés szerint már nem telepítik). Ezt követõen az XDM démon a <span class=filename>/usr/local/bin/xdm</span> helyen található meg. A programot <code>root</code> felhasználóként bármikor tudjuk futtatni, és ez veszi kezelésbe a helyi gépen futó X szervert. Amennyiben az XDM-et a számítógép minden egyes indulása során el akarjuk indítani, egyszerûen csak adjuk hozzá a megfelelõ bejegyzést az <span class=filename>/etc/ttys</span> állományhoz. Ennek a formai szabályairól és használatáról bõvebben lásd <a href=./#term-etcttys>Egy bejegyzés felvétele az /etc/ttys állományba</a>. Az <span class=filename>/etc/ttys</span> alapértelmezett változatában az XDM démont ebben a formában találjuk meg a virtuális terminálok között:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>ttyv8   <span class=s2>&#34;/usr/local/bin/xdm -nodaemon&#34;</span>  xterm   off secure</code></pre></div></div><div class=paragraph><p>Ez a bejegyzés alapból nem aktív. Az engedélyezéséhez írjuk át az ötödik mezõben szereplõ <code>off</code> (kikapcsolva) értéket <code>on</code> (bekapcsolvá)-ra, majd indítsuk újra az <a href="https://man.freebsd.org/cgi/man.cgi?query=init&amp;sektion=8&amp;format=html">init(8)</a> programot a <a href=./#term-hup>A init utasítása az /etc/ttys újraolvasására</a>ban leírtak szerint. Az elsõ mezõben találhatjuk a program által kezelt terminált, ez jelen esetünkben a <code>ttyv8</code>. Ennek megfelelõen az XDM a 9. virtuális terminálon kezdi meg a futását.</p></div></div><div class=sect3><h4 id=_az_xdm_beállítása>5.6.3. Az XDM beállítása<a class=anchor href=#_az_xdm_beállítása></a></h4><div class=paragraph><p>Az XDM beállításait tartalmazó könyvtár a <span class=filename>/usr/local/lib/X11/xdm</span>. Itt találhatjuk meg azokat az állományokat, amelyek megváltoztatásával befolyásolhatjuk az XDM megjelenését és viselkedését. Általában a következõ állományok bukkannak fel ezen a helyen:</p></div><table class="tableblock frame-none grid-all stretch informaltable"><col style=width:50%><col style=width:50%><thead><tr><th class="tableblock halign-left valign-top">Állomány</th><th class="tableblock halign-left valign-top">Leírás</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class=tableblock><span class=filename>Xaccess</span></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>A kliens hitelesítésének szabályrendszere.</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><span class=filename>Xresources</span></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Az X erõforrásainak alapértelmezett értékei.</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><span class=filename>Xservers</span></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Az ismert távoli és helyi X szerverek listája.</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><span class=filename>Xsession</span></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>A bejelentkezések során lefutó alapértelmezett szkript.</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><span class=filename>Xsetup_</span>*</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>A bejelentkezõ felület indítása elõtt indítandó alkalmazásokkal kapcsolatos szkript.</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><span class=filename>xdm-config</span></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>A gépen futó összes X szerver globális beállításai.</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><span class=filename>xdm-errors</span></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>A szerver által jelentett hibák.</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><span class=filename>xdm-pid</span></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>A jelenleg futó XDM-hez tartozó azonosító.</p></td></tr></tbody></table><div class=paragraph><p>Ebben a könyvtárban találunk még néhány olyan programot és szkriptet, amelyekkel be tudjuk állítani a munkaasztalunkat az XDM futása alatt. Ezen állományok céljait egyenként ismertetni fogjuk. A felépítésükrõl és használatukról az <a href="https://man.freebsd.org/cgi/man.cgi?query=xdm&amp;sektion=1&amp;format=html">xdm(1)</a> man oldala árul el többet.</p></div><div class=paragraph><p>Az alapértelmezett beállítás egy téglalap alakú bejelentkezõ ablak, aminek tetején nagy betûkkel a gép neve olvasható, valamint alatta a "Login:" (felhasználói név) és "Password:" (jelszó) mezõk várnak kitöltésre. Ez egy remek kiindulási alap az XDM-képernyõ kinézetének megváltoztatásához.</p></div><div class=sect4><h5 id=_xaccess>5.6.3.1. Xaccess<a class=anchor href=#_xaccess></a></h5><div class=paragraph><p>Az XDM-mel szabályozott X szerverek által használt protokoll az X Display Manager Connection Protocol (XDMCP). Ez az állomány tartalmazza a távoli számítógépekrõl érkezõ XDMCP-kapcsolatok vezérlésére vonatkozó szabályokat. Ezt a rendszer általában figyelmen kívül hagyja, hacsak az <span class=filename>xdm-config</span> állományban be nem állítottuk a távoli számítógépek csatlakoztathatóságát. Alapértelmezés szerint viszont semmilyen klienst nem enged csatlakozni.</p></div></div><div class=sect4><h5 id=_xresources>5.6.3.2. Xresources<a class=anchor href=#_xresources></a></h5><div class=paragraph><p>Ez tartalmazza a szerverválasztó és bejelentkezõ képernyõ alapértelmezéseit. Segítségével a bejelentkeztetést végzõ program kinézetét változtathatjuk meg. Formátuma hasonló az X11 dokumentációjában leírt app-defaults állományhoz.</p></div></div><div class=sect4><h5 id=_xservers>5.6.3.3. Xservers<a class=anchor href=#_xservers></a></h5><div class=paragraph><p>A szerverválasztó által felkínálandó távoli X szerverek felsorolását tartalmazza.</p></div></div><div class=sect4><h5 id=_xsession>5.6.3.4. Xsession<a class=anchor href=#_xsession></a></h5><div class=paragraph><p>A felhasználó bejelentkezése után ez az XDM-szkript fog lefutni. Általában minden felhasználóhoz tartozik egy saját <span class=filename>~/.xsession</span> szkript, ami ezt felülbírálja.</p></div></div><div class=sect4><h5 id=_xsetup>5.6.3.5. Xsetup_*<a class=anchor href=#_xsetup></a></h5><div class=paragraph><p>Ezek fognak automatikusan lefutni a szerverválasztó vagy bejelentkeztetõ felületek megjelenése elõtt. Minden általunk használt X szerverhez tartozik egy ilyen szkript, amelyek neve <span class=filename>Xsetup_</span>-al kezdõdik és a helyi X szerver sorszámával folytatódik (például <span class=filename>Xsetup_0</span>). Ezek a szkriptek általában egy-két programot, mint például az <code>xconsole</code>, indítanak el a háttérben.</p></div></div><div class=sect4><h5 id=_xdm_config>5.6.3.6. xdm-config<a class=anchor href=#_xdm_config></a></h5><div class=paragraph><p>Az app-defaults nevû állományéhoz hasonló alakban tartalmaz beállításokat a program által kezelt minden egyes X szerverhez.</p></div></div><div class=sect4><h5 id=_xdm_errors>5.6.3.7. xdm-errors<a class=anchor href=#_xdm_errors></a></h5><div class=paragraph><p>Ebben található meg az XDM által futtatni próbált X szerverek kimenete. Itt érdemes hibaüzenetek után kutatni, ha az XDM által indított X szerver valamiért megállna. Ezek az üzenetek egyébként a felhasználó <span class=filename>~/.xsession-errors</span> állományába is beíródnak.</p></div></div></div><div class=sect3><h4 id=_hálózati_x_szerver_futtatása>5.6.4. Hálózati X szerver futtatása<a class=anchor href=#_hálózati_x_szerver_futtatása></a></h4><div class=paragraph><p>Az X szerverünkhöz csak akkor tudnak kívülrõl más felhasználók is kapcsolódni, ha átírjuk a hozzáférésre vonatkozó szabályokat és engedélyezzük rajta a kapcsolódást. Az alapértelmezett szabályok nagyon óvatosak. Ha tehát engedélyezni akarjuk a kívülrõl érkezõ kapcsolódásokat, akkor ahhoz elõször az <span class=filename>xdm-config</span> állományból vegyük ki az alábbi sort:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=o>!</span> SECURITY: <span class=k>do </span>not listen <span class=k>for </span>XDMCP or Chooser requests
<span class=o>!</span> Comment out this line <span class=k>if </span>you want to manage X terminals with xdm
DisplayManager.requestPort:     0</code></pre></div></div><div class=paragraph><p>Ezután indítsuk újra az XDM-et. Ne felejtsük el, hogy az app-defaults állományokban a megjegyzések "!" (felkiáltó)jellel kezdõdnek, nem pedig a megszokott "#" (kettõskereszt)tel. A fentieknél természetesen szigorúbb hozzáférési szabályok is szükségesek lehetnek - ezzel kapcsolatban nézzük meg <span class=filename>Xaccess</span> állományban szereplõ példákat, illetve lapozzuk fel az <a href="https://man.freebsd.org/cgi/man.cgi?query=xdm&amp;sektion=1&amp;format=html">xdm(1)</a> man oldalt.</p></div></div><div class=sect3><h4 id=_az_xdm_helyett>5.6.5. Az XDM helyett<a class=anchor href=#_az_xdm_helyett></a></h4><div class=paragraph><p>Az alapértelmezett XDM feladatát számos más program is képes ellátni. Ezek közül az egyik a kdm (a KDE része), amire ebben a fejezetben még vissza fogunk térni. A kdm különféle vizuális effekteket és egyéb kozmetikázást ígér, valamint lehetõvé teszi a felhasználók számára, hogy a bejelentkezés elõtt kiválaszthassák a használni kívánt ablakkezelõt.</p></div></div></div><div class=sect2><h3 id=x11-wm>5.7. Munkakörnyezetek<a class=anchor href=#x11-wm></a></h3><div class=paragraph><p>Ebben a szakaszban a FreeBSD-n futó X-hez elérhetõ különbözõ munkakörnyezetekrõl (desktop environment) lesz szó. Maga a "munkakörnyezet" elnevezés sok mindenre utalhat egy mezei ablakkezelõtõl kezdve az asztali alkalmazások teljes garmadájáig, ahogy igaz ez a KDE vagy a GNOME esetében is.</p></div><div class=sect3><h4 id=x11-wm-gnome>5.7.1. A GNOME<a class=anchor href=#x11-wm-gnome></a></h4><div class=sect4><h5 id=x11-wm-gnome-about>5.7.1.1. Röviden a GNOME-ról<a class=anchor href=#x11-wm-gnome-about></a></h5><div class=paragraph><p>A GNOME egy felhasználóbarát munkakörnyezet, aminek segítségével a felhasználók számára gyerekjáték a számítógép használata és beállítása. A GNOME-ban találhatunk egy panelt (az alkalmazások indítására és különféle állapotjelzõk megjelenítéséhez), egy asztalt (ahova az alkalmazások és az adatok kerülnek), szabványos asztali eszközöket és alkalmazásokat, valamint számos konvenciót, aminek mentén az alkalmazások könnyen együtt tudnak mûködni és tartani egymással az összhangot. Más operációs rendszerek vagy környezetek ismerõi otthon érezhetik magukat ebben a GNOME által nyújtott vizuális környezetben. A FreeBSD és a GNOME kapcsolatáról bõvebb információkat a <a href=http://www.FreeBSD.org/gnome>FreeBSD GNOME Projekt</a> honlapján találhatunk. Ezen az oldalon a GNOME telepítésérõl, beállításáról és karbantartásáról egy meglehetõsen átfogó leírást olvashatunk.</p></div></div><div class=sect4><h5 id=x11-wm-gnome-install>5.7.1.2. A GNOME telepítése<a class=anchor href=#x11-wm-gnome-install></a></h5><div class=paragraph><p>A programot könnyen fel tudjuk telepíteni csomagból vagy a Portgyûjtemény segítségével:</p></div><div class=paragraph><p>A hálózatról a GNOME csomagját mindössze ennek a sornak a beírásával fel tudjuk telepíteni:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># pkg_add -r gnome2</span></code></pre></div></div><div class=paragraph><p>A portfa felhasználásával pedig a GNOME-ot így tudjuk forrásból telepíteni:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># cd /usr/ports/x11/gnome2</span>
<span class=c># make install clean</span></code></pre></div></div><div class=paragraph><p>Miután a GNOME-ot sikerült feltelepítenünk, meg kell mondanunk az X szervernek, hogy az alapértelmezett ablakkezelõ helyett a GNOME-ot indítsa el.</p></div><div class=paragraph><p>A GNOME-ot legkönnyebben a GDM, vagyis a GNOME Display Manager használatával indíthatjuk el. A GDM a GNOME részeként települ (habár alapból nincs bekapcsolva), és úgy tudjuk aktiválni, ha <span class=filename>/etc/rc.conf</span> állományba beírjuk a <code>gdm_enable="YES"</code> sort. Újraindítás után a GDM automatikusan elindul.</p></div><div class=paragraph><p>Ha a GDM mellett az összes GNOME szolgáltatást is el akarjuk indítani, vegyük fel a <code>gnome_enable="YES"</code> sort az <span class=filename>/etc/rc.conf</span> állományba.</p></div><div class=paragraph><p>A GNOME-ot parancssorból is elindíthatjuk, ha hozzá megfelelõen beállítjuk az <span class=filename>.xinitrc</span> nevû állományt. Ha már van egy saját <span class=filename>.xinitrc</span> állományunk, akkor nincs más teendõnk, mint átírni az aktuális ablakkezelõnket hívó sort a /usr/local/bin/gnome-session sorra. Ha nem csináltunk elõtte semmilyen különleges dolgot az említett konfigurációs állománnyal, akkor elegendõ csak ennyit beírnunk:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>% <span class=nb>echo</span> <span class=s2>&#34;/usr/local/bin/gnome-session&#34;</span> <span class=o>&gt;</span> ~/.xinitrc</code></pre></div></div><div class=paragraph><p>Ezt követõen írjuk be a <code>startx</code> parancsot, és a GNOME munkakörnyezete fog elindulni.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Ha az XDM-hoz hasonló régebbi bejelentkeztetõ képernyõt használunk, ez a módszer nem fog mûködni. Helyette hozzunk létre egy <span class=filename>.xsession</span> nevû futtatható állományt, amely ezt a parancsot tartalmazza. Ehhez nyissuk meg és cseréljük ki benne a korábbi ablakkezelõnk hívását a /usr/local/bin/gnome-session utasításra:</p></div></td></tr></tbody></table></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>% <span class=nb>echo</span> <span class=s2>&#34;#!/bin/sh&#34;</span> <span class=o>&gt;</span> ~/.xsession
% <span class=nb>echo</span> <span class=s2>&#34;/usr/local/bin/gnome-session&#34;</span> <span class=o>&gt;&gt;</span> ~/.xsession
% <span class=nb>chmod</span> +x ~/.xsession</code></pre></div></div><div class=paragraph><p>Megcsinálhatjuk azt is, hogy a bejelentkezéskor választható legyen az ablakkezelõ. <a href=#x11-wm-kde-details>A KDE-rõl bõvebben</a> címû szakaszban látni fogjuk, hogyan tudjuk ezt a a KDE bejelentkeztetõ képernyõje, a kdm esetén beállítani.</p></div></div></div><div class=sect3><h4 id=x11-wm-kde>5.7.2. A KDE<a class=anchor href=#x11-wm-kde></a></h4><div class=sect4><h5 id=x11-wm-kde-about>5.7.2.1. Röviden a KDE-rõl<a class=anchor href=#x11-wm-kde-about></a></h5><div class=paragraph><p>A KDE egy könnyen használható modern munkakörnyezet. Ízelítõül a KDE felhasználók számára felkínált lehetõségei közül:</p></div><div class=ulist><ul><li><p>Gyönyörû, korszerû munkafelület</p></li><li><p>Az asztal hálózaton keresztüli transzparens kezelése</p></li><li><p>A KDE asztal és alkalmazásainak használatában egy beépített súgórendszer segíti a kényelmes és összefüggõ közlekedést</p></li><li><p>A KDE alkalmazásainak összehangolt kinézete és hangulata</p></li><li><p>Szabványosított menük és eszköztárak, billentyû-hozzárendelések, színsémák stb.</p></li><li><p>Honosítás: a KDE több, mint 40 nyelven elérhetõ</p></li><li><p>Központosított, összehangolt, párbeszédablak alapú asztalbeállítás</p></li><li><p>Számos hasznos KDE-alkalmazás</p></li></ul></div><div class=paragraph><p>A KDE-hez egy Konqueror nevû böngészõ is tartozik, mely a többi UNIX®-os böngészõ komoly ellenfelének bizonyul. A KDE-rõl többet a <a href=http://www.kde.org/>KDE honlapján</a> olvashatunk. A KDE FreeBSD-re vonatkozó tudnivalóiról és a hozzá tartozó anyagokról a <a href=http://freebsd.kde.org/>FreeBSD KDE csapat</a> honlapján találhatunk információkat.</p></div><div class=paragraph><p>FreeBSD alatt a KDE két verziója érhetõ el: a harmadik változat már régóta használható, nagyon megbízható, amely mellett viszont a következõ generációt képviselõ negyedik változat is megtalálható a Portgyûjteményben. Akár egymás mellé is telepíthetõek.</p></div></div><div class=sect4><h5 id=x11-wm-kde-install>5.7.2.2. A KDE telepítése<a class=anchor href=#x11-wm-kde-install></a></h5><div class=paragraph><p>Ahogy a GNOME és a többi más munkakörnyezet esetében is, maga a program könnyen telepíthetõ csomagból vagy a Portgyûjtemény segítségével is:</p></div><div class=paragraph><p>A KDE3 csomagját hálózaton keresztül így tudjuk telepíteni:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># pkg_add -r kde</span></code></pre></div></div><div class=paragraph><p>A KDE4 csomagját pedig hálózaton keresztül így tudjuk telepíteni:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># pkg_add -r kde4</span></code></pre></div></div><div class=paragraph><p>A <a href="https://man.freebsd.org/cgi/man.cgi?query=pkg_add&amp;sektion=1&amp;format=html">pkg_add(1)</a> magától letölti az alkalmazás legfrissebb verzióját.</p></div><div class=paragraph><p>Ha a KDE3 környezetet forrásból akarjuk telepíteni, használjuk a portfát:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># cd /usr/ports/x11/kde3</span>
<span class=c># make install clean</span></code></pre></div></div><div class=paragraph><p>Ha viszont a KDE4 környezetet akarjuk inkább a portfa felhasználásával forrásból telepíteni, akkor ezeket a parancsokat adjuk ki:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># cd /usr/ports/x11/kde4</span>
<span class=c># make install clean</span></code></pre></div></div><div class=paragraph><p>Miután a KDE-t sikeresen telepítettük, tudatnunk kell az X szerverrel, hogy az alapértelmezett ablakkezelõ helyett ezt indítsa el. Ezt az <span class=filename>.xinitrc</span> állomány módosításával érhetjük el.</p></div><div class=paragraph><p>KDE3 esetén:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>% <span class=nb>echo</span> <span class=s2>&#34;exec startkde&#34;</span> <span class=o>&gt;</span> ~/.xinitrc</code></pre></div></div><div class=paragraph><p>KDE4 esetén:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>% <span class=nb>echo</span> <span class=s2>&#34;exec /usr/local/kde4/bin/startkde&#34;</span> <span class=o>&gt;</span> ~/.xinitrc</code></pre></div></div><div class=paragraph><p>Mostantól pedig mindig KDE lesz az asztalunk, amikor az X Window Systemet elindítjuk a <code>startx</code> paranccsal.</p></div><div class=paragraph><p>Ha az XDM-et használjuk bejelentkeztetõ képernyõként, a beállítást némileg máshogyan kell elvégeznünk. Ekkor az iménti helyett az <span class=filename>.xsession</span> állományt kell szerkesztenünk. A kdm-re vonatkozó utasítások a fejezet késõbbi részében találhatóak meg.</p></div></div></div><div class=sect3><h4 id=x11-wm-kde-details>5.7.3. A KDE-rõl bõvebben<a class=anchor href=#x11-wm-kde-details></a></h4><div class=paragraph><p>Most, miután telepítettük a KDE-t a rendszerünkre, a dolgok többsége felfedezhetõ a különféle súgók segítségével vagy egyszerûen a menükre történõ kattintással. A Windows®-hoz vagy Mac®-hez szokott felhasználók itt most már egészen otthonosan érezhetik magukat.</p></div><div class=paragraph><p>A KDE-hez a legtöbb segítséget a saját internetes dokumentációjából nyerhetjük. A KDE a saját böngészõjét, a Konquerort tartalmazza, valamint tucatnyi ügyes alkalmazást és temérdek mennyiségû dokumentációt. A szakasz további részeiben ezért inkább olyan problémákkal foglalkozunk, amelyek megoldásai céltalan kóborlással már nem fedezhetõek fel olyan egyszerûen.</p></div><div class=sect4><h5 id=x11-wm-kde-kdm>5.7.3.1. A KDE bejelentkeztetõ képernyõje<a class=anchor href=#x11-wm-kde-kdm></a></h5><div class=paragraph><p>Egy többfelhasználós rendszer karbantartója minden bizonnyal szeretné üdvözölni rendszere felhasználóit egy grafikus bejelentkezõ képernyõn keresztül. A korábbiakban erre a célra az <a href=#x-xdm>XDM</a>-et javasoltuk. Azonban a KDE erre ajánl egy alternatívát, a kdm-et, amely jóval látványosabb és sokoldalúbb. Ez különösen abban merül ki, hogy a felhasználók (egy menün keresztül) ki tudják választani a bejelentkezés után használni kívánt munkakörnyezetet (legyen az KDE, GNOME vagy bármi más).</p></div><div class=paragraph><p>A kdm használatához a KDE aktuális verziójától függõen különbözõ állományokat kell szerkesztenünk.</p></div><div class=paragraph><p>KDE3 esetén a <span class=filename>/etc/ttys</span> állományban szereplõ <code>ttyv8</code> sort kell az alábbiak szerint módosítanunk:</p></div><div class="literalblock programlisting"><div class=content><pre>ttyv8 &#34;/usr/local/bin/kdm -nodaemon&#34; xterm on secure</pre></div></div><div class=paragraph><p>KDE4 esetén a következõ sorokat kell felvennünk az <span class=filename>/etc/rc.conf</span> állományba:</p></div><div class="literalblock programlisting"><div class=content><pre>local_startup=&#34;${local_startup} /usr/local/kde4/etc/rc.d&#34;
kdm4_enable=&#34;YES&#34;</pre></div></div></div></div><div class=sect3><h4 id=x11-wm-xfce>5.7.4. Az Xfce<a class=anchor href=#x11-wm-xfce></a></h4><div class=sect4><h5 id=x11-wm-xfce-about>5.7.4.1. Röviden az Xfce-rõl<a class=anchor href=#x11-wm-xfce-about></a></h5><div class=paragraph><p>Az Xfce a GNOME által használt GTK+-ra épülõ munkakörnyezet, amely azonban sokkal könnyedebb és azoknak készült, akik egy szimpla, hatékony, mindazonáltal könnyen használható és beállítható munkafelületre vágynak. Látvány szempontjából leginkább a kereskedelmi rendszereken megtalálható CDE-hez hasonlítható. Íme az Xfce néhány jellemzõje:</p></div><div class=ulist><ul><li><p>Egyszerû, könnyen kezelhetõ munkaasztal</p></li><li><p>Tökéletesen konfigurálható egérrel, drag-and-droppal ("vonszolás") stb.</p></li><li><p>A menükkel, kisalkalmazásokkal és alkalmazásindítókkal tarkított fõpanelje hasonló a CDE paneljéhez</p></li><li><p>Beépített ablak-, állomány- és hangkezelõvel, GNOME kompatibilitási modullal és még sok minden mással rendelkezik</p></li><li><p>Használhatunk témákat (mivel GTK+-ra épül)</p></li><li><p>Gyors, könnyû és hatékony: ideális régebbi vagy lassabb, esetleg kevés memóriával rendelkezõ számítógépekhez</p></li></ul></div><div class=paragraph><p>Az Xfce-rõl részletesebben az <a href=http://www.xfce.org/>Xfce honlapján</a> olvashatunk.</p></div></div><div class=sect4><h5 id=x11-wm-xfce-install>5.7.4.2. Az Xfce telepítése<a class=anchor href=#x11-wm-xfce-install></a></h5><div class=paragraph><p>Az Xfce-hez tartozik bináris csomag (legalábbis az leírás készítésének pillanatában). Ezt a következõ módon tudjuk telepíteni:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># pkg_add -r xfce4</span></code></pre></div></div><div class=paragraph><p>Vagy a Portgyûjtemény használatával forrásból is felrakhatjuk:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># cd /usr/ports/x11-wm/xfce4</span>
<span class=c># make install clean</span></code></pre></div></div><div class=paragraph><p>Ezután világosítsuk fel az X szervert, hogy a következõ indulása során mi már az Xfce-t kívánjuk használni. Ehhez csak ennyit kell tennünk:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>% <span class=nb>echo</span> <span class=s2>&#34;/usr/local/bin/startxfce4&#34;</span> <span class=o>&gt;</span> ~/.xinitrc</code></pre></div></div><div class=paragraph><p>Így az X következõ indításakor már az Xfce lesz a munkakörnyezetünk. Ahogy azt már korábban is jeleztük, az XDM használata során a <a href=#x11-wm-gnome>GNOME</a>ban leírtak szerint létre kell hoznunk az <span class=filename>.xsession</span> állományt, azonban ezúttal a <span class=filename>/usr/local/bin/startxfce4</span> parancs használatával. Vagy a <a href=#x11-wm-kde-kdm>kdm</a>-rõl szóló szakaszban tárgyaltak mentén beállíthatjuk úgy a bejelentkeztetõ képernyõt, hogy a bejelentkezés elõtt válasszuk ki a munkakörnyezetet.</p></div></div></div></div></div></div><h1 id=common-tasks class=sect0>Part II: Gyakori feladatok<a class=anchor href=#common-tasks></a></h1><div class="openblock partintro"><div class=content><div class=paragraph><p>Miután az alapokat már átvettük, a FreeBSD kézikönyv következõ része néhány gyakorta alkalmazott funkciót tárgyal. Az itt szereplõ fejezetek:</p></div><div class=ulist><ul><li><p>Bemutatnak különféle hasznos és népszerû asztali alkalmazásokat: böngészõket, irodai elõsegítõ eszközöket, dokumentum-megjelenítõket stb.</p></li><li><p>Bemutatják a FreeBSD alatt is elérhetõ multimédia eszközöket.</p></li><li><p>Kifejtik egy saját FreeBSD rendszermag elkészítésének folyamatát, amellyel így bõvíteni tudjuk rendszerünk funkcionalitását.</p></li><li><p>Részletesen bemutatják a nyomtatásért felelõs alrendszert, asztali és hálózati nyomtatók használata esetén egyaránt.</p></li><li><p>Megmutatják, hogyan futassunk Linuxra íródott alkalmazásokat a FreeBSD rendszerünkön.</p></li></ul></div><div class=paragraph><p>Egyes fejezetek elolvasásához ajánlott bizonyos mértékû felkészülés, amely megemlítésre is kerül az érintett fejezetek áttekintésében.</p></div></div></div><div class=sect1><h2 id=desktop>Chapter 6. II. Rész Gyakori feladatok<a class=anchor href=#desktop></a></h2><div class=sectionbody><div class=sect2><h3 id=desktop-synopsis>6.1. Áttekintés<a class=anchor href=#desktop-synopsis></a></h3><div class=paragraph><p>A FreeBSD-n asztali alkalmazások széles spektrumát lehet futtatni, például böngészõket és szövegszerkesztõket. Legtöbbjük csomagként áll rendelkezésre, illetve automatizált módon lefordíthatóak a Portgyûjteménybõl. Az új felhasználók közül sokan szeretnének ilyen fajta alkalmazásokat használni, ezért ez a fejezet bemutatja, miként lehet a népszerûbb asztali alkalmazásokat minden különösebb erõfeszítés nélkül telepíteni, legyen szó az elõre csomagolt vagy a Portgyûjteményben megtalálható formájukról.</p></div><div class=paragraph><p>Amikor portként telepítünk egy programot, lényegében a forráskódját fordítjuk le. Ez bizonyos esetekben nagyon sokáig is eltarthat attól függõen, hogy pontosan mit is fordítunk le, illetve mekkora az erre a célra felhasznált számítógépünk vagy számítógépeink teljesítménye. Amennyiben a fordításra nem tudunk vagy nem kívánunk elegendõ idõt szánni, a Portgyûjteményben található programok többségét már elõre lefordított csomagból is telepíthetjük.</p></div><div class=paragraph><p>Mivel a FreeBSD-ben bináris szintû Linux kompatibilitás is található, ezért az eredetileg Linuxra fejlesztett alkalmazások is használhatóak a munkakörnyezetünkben. Azonban határozottan javasoljuk, hogy a linuxos alkalmazások használatához elõször figyelmesen olvassuk át a <a href=./#linuxemu>Bináris Linux kompatibilitás</a>et. A linuxos bináris kompabilitást használó portok neve általában a "linux-" elõtaggal kezdõdik, amit ne felejtsük el figyelembe venni, amikor például a <a href="https://man.freebsd.org/cgi/man.cgi?query=whereis&amp;sektion=1&amp;format=html">whereis(1)</a> segítségével keressük valamelyiket. A fejezet további részében feltételezzük, hogy a linuxos alkalmazások telepítése elõtt aktiváltuk a bináris Linux kompatibilitást.</p></div><div class=paragraph><p>Íme a fejezetben tárgyalt kategóriák:</p></div><div class=ulist><ul><li><p>Böngészõk (mint a Firefox, Opera, Konqueror)</p></li><li><p>Irodai eszközök (mint a KOffice, AbiWord, The GIMP, OpenOffice.org)</p></li><li><p>Dokumentum-megjelenítõk (mint az Acrobat Reader®, gv, Xpdf, GQview)</p></li><li><p>Pénzügyi szoftverek (mint a GnuCash, Gnumeric, Abacus)</p></li></ul></div><div class=paragraph><p>A fejezet elolvasásához ajánlott:</p></div><div class=ulist><ul><li><p>a külsõ alkalmazások telepítésének ismerete (<a href=./#ports>Alkalmazások telepítése. csomagok és portok</a>);</p></li><li><p>linuxos alkalmazások telepítésének ismerete (<a href=./#linuxemu>Bináris Linux kompatibilitás</a>).</p></li></ul></div><div class=paragraph><p>a multimédiás környezet kialakítására vonatkozó információkért a <a href=./#multimedia>Multimédia</a>et érdemes elolvasni. Az elektronikus levelezés beállítását és használatát a <a href=./#mail>Elektronikus levelezés</a>bõl tudhatjuk meg.</p></div></div><div class=sect2><h3 id=desktop-browsers>6.2. Böngészõk<a class=anchor href=#desktop-browsers></a></h3><div class=paragraph><p>A FreeBSD-vel együtt nem települ semmilyen böngészõ. Helyette keressük meg a Portgyûjteményben a <a href=http://www.FreeBSD.org/ports/>www</a> könyvtárat, ahol ezzel szemben rengeteg böngészõ áll telepítésre készen. Ha nem lenne idõnk mindent lefordítani (ami egyes esetekben akár rengeteg idõnkbe is kerülhet), ezek csomagolt formában is elérhetõek.</p></div><div class=paragraph><p>A KDE-hez és a GNOME-hoz eleve tartoznak HTML-böngészõk. Ezen komplett munkakörnyezetek beállításához a <a href=./#x11-wm>Munkakörnyezetek</a>t olvassuk el.</p></div><div class=paragraph><p>Ha viszont csak egy kevés erõforrást igénylõ böngészõkre vágyunk, érdemes megnéznünk a Portgyûjteményben található <a class=package href=https://cgit.freebsd.org/ports/tree/www/dillo2/>www/dillo2</a>, <a class=package href=https://cgit.freebsd.org/ports/tree/www/links/>www/links</a> vagy <a class=package href=https://cgit.freebsd.org/ports/tree/www/w3m/>www/w3m</a> portokat.</p></div><div class=paragraph><p>Ez a rész az alábbi alkalmazásokat említi:</p></div><table class="tableblock frame-none grid-all stretch informaltable"><col style=width:25%><col style=width:25%><col style=width:25%><col style=width:25%><thead><tr><th class="tableblock halign-left valign-top">Alkalmazás</th><th class="tableblock halign-left valign-top">Erõforrásigény</th><th class="tableblock halign-left valign-top">Telepítés forrásból</th><th class="tableblock halign-left valign-top">Fõbb függõségek</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class=tableblock>Firefox</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>közepes</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>nehéz</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Gtk+</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>Opera</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>kevés</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>könnyû</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Vannak FreeBSD-s és linuxos változatai is. A linuxos verzió használatához azonban szükség van a bináris Linux kompatibilitásra és a linux-openmotif portra.</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>Konqueror</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>közepes</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>nehéz</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>A KDE függvénykönyvtárai.</p></td></tr></tbody></table><div class=sect3><h4 id=_firefox>6.2.1. Firefox<a class=anchor href=#_firefox></a></h4><div class=paragraph><p>A Firefox egy modern, szabad és nyílt forráskódú böngészõ, amely tökéletesen használható FreeBSD alatt. Megtalálható benne egy, a jelenlegi HTML szabványoknak nagyon jól megfelelõ megjelenítõ motor, a lapokra bontható böngészés támogatása, a kéretlenül felbukkanó ablakok blokkolása, különbözõ kiterjesztések, javított biztonsági lehetõségek és még sok minden más. A Firefox forrása a Mozilla kódján alapszik.</p></div><div class=paragraph><p>Csomagból így telepíthetõ:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># pkg_add -r firefox</span></code></pre></div></div><div class=paragraph><p>Ekkor a Firefox 3.6 változata fog települni. Ha helyette a Firefox 3.5 változatát szeretnénk használni, akkor ezt a parancsot adjuk ki:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># pkg_add -r firefox35</span></code></pre></div></div><div class=paragraph><p>Ha forrásból szeretnénk felrakni, használhatjuk a Portgyûjteményben található portját is:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># cd /usr/ports/www/firefox</span>
<span class=c># make install clean</span></code></pre></div></div><div class=paragraph><p>A Firefox 3.5 telepítéséhez az iménti parancsban cseréljük ki a <code>firefox</code> részt a <code>firefox35</code> könyvtárra.</p></div></div><div class=sect3><h4 id=moz-java-plugin>6.2.2. A Firefox és a Java™ plugin<a class=anchor href=#moz-java-plugin></a></h4><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Ennél és a következõ résznél feltételezzük, hogy már korábban telepítettük a Firefox alkalmazást.</p></div><div class=paragraph><p>A Java™ plugin jelenleg nem mûködik a Firefox 3.6 változatával.</p></div></td></tr></tbody></table></div><div class=paragraph><p>A FreeBSD Alapítvány megegyezett a Sun Microsystems-szel, hogy terjesztheti a Java™ futtatókörnyezet (JRE™) és a Java™ fejlesztõkörnyezet (JDK™) FreeBSD-re lefordított bináris változatait. Ezek a csomagok elérhetõek a <a href=http://www.freebsdfoundation.org/downloads/java.shtml>FreeBSD Alapítvány</a> honlapjáról.</p></div><div class=paragraph><p>Ha tehát Java™-támogatást szeretnénk hozzáadni a Firefox böngészõhöz, elsõként fel kell telepítenünk a <a class=package href=https://cgit.freebsd.org/ports/tree/java/javavmwrapper/>java/javavmwrapper</a> portot. Ezután le kell töltenünk a Diablo JRE™ csomagot a <a href=http://www.freebsdfoundation.org/downloads/java.shtml>http://www.freebsdfoundation.org/downloads/java.shtml</a> címrõl, majd telepítenünk azt a <a href="https://man.freebsd.org/cgi/man.cgi?query=pkg_add&amp;sektion=1&amp;format=html">pkg_add(1)</a> segítségével.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Ezen az oldalon nem találunk bináris csomagokat FreeBSD 8.<em>X</em> rendszerekhez, azonban a FreeBSD 7.<em>X</em> rendszerekhez készült csomagok használhatóak 8.<em>X</em> esetén is. Ehhez mindössze a <a class=package href=https://cgit.freebsd.org/ports/tree/misc/compat7x/>misc/compat7x</a> portot kell elõtte telepítenünk.</p></div><div class=paragraph><p>A másik lehetõség a Diablo JRE™ (valamint a Diablo JDK™) telepítése a Portgyûjteménybõl (<a class=package href=https://cgit.freebsd.org/ports/tree/java/diablo-jre16/>java/diablo-jre16</a> és <a class=package href=https://cgit.freebsd.org/ports/tree/java/diablo-jdk16/>java/diablo-jdk16</a>). Ehhez a szükséges forrásokat (distfile állományokat) licencelési megkötések miatt nekünk kell külön letölteni. A kapcsolódó utasításokat a <code>make maketarget</code> parancs meghívásával kaphatjuk meg.</p></div></td></tr></tbody></table></div><div class=paragraph><p>Indítsuk el a böngészõnket, és írjuk be a címsorba, hogy <code>about:plugins</code> és nyomjuk le az <kbd>Enter</kbd> billentyût. Az eredményül kapott oldalon láthatjuk az eddig telepített pluginok listáját, ahol mostanra már a Java™ pluginnak is meg kell jelennie. Amennyiben ez nem következne be, mindegyik felhasználónál adjuk ki az alábbi parancsot:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>% <span class=nb>ln</span> <span class=nt>-s</span> /usr/local/diablo-jre1.6.0/plugin/i386/ns7/libjavaplugin_oji.so <span class=se>\</span>
  <span class=nv>$HOME</span>/.mozilla/plugins/</code></pre></div></div><div class=paragraph><p>Vagy ha a Diablo JDK™ csomagot telepítettük:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>% <span class=nb>ln</span> <span class=nt>-s</span> /usr/local/diablo-jdk1.6.0/jre/plugin/i386/ns7/libjavaplugin_oji.so <span class=se>\</span>
  <span class=nv>$HOME</span>/.mozilla/plugins/</code></pre></div></div><div class=paragraph><p>Ezt követõen indítsuk újra a böngészõnket.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Ezek a parancsok az i386 architektúra használatát feltételezik, de a csomagok az amd64 architektúra esetén is elérhetõek.</p></div></td></tr></tbody></table></div></div><div class=sect3><h4 id=moz-flash-plugin>6.2.3. A Firefox és a Macromedia® Flash™ plugin<a class=anchor href=#moz-flash-plugin></a></h4><div class=paragraph><p>A Macromedia® Flash™ plugin nem érhetõ el közvetlenül FreeBSD-re. Azonban létezik egy, a plugin linuxos verziójára épített szoftveres réteg (wrapper). Ez a wrapper még többek közt az Adobe® Acrobat® és a RealPlayer® pluginjait is használhatóvá teszi.</p></div><div class=paragraph><p>Attól függõen, hogy a FreeBSD melyik változatát használjuk, különbözõ módokon tudjuk mûködésbe hozni:</p></div><div class="exampleblock procedure"><div class=content><div class="olist arabic"><ol class=arabic><li><p>FreeBSD 7.<em>X</em></p><div class=paragraph><p>Telepítsük a <a class=package href=https://cgit.freebsd.org/ports/tree/www/nspluginwrapper/>www/nspluginwrapper</a> portot. Ehhez szükség lesz még az <a class=package href=https://cgit.freebsd.org/ports/tree/emulators/linux_base-fc4/>emulators/linux_base-fc4</a> portra is, amely viszonylag nagy méretû.</p></div><div class=paragraph><p>Következõ lépésként telepítsük a <a class=package href=https://cgit.freebsd.org/ports/tree/www/linux-flashplugin9/>www/linux-flashplugin9</a> portot. Ezáltal megkapjuk a Flash™ 9.<em>X</em> változatát, amely FreeBSD 7.<em>X</em> alatt remekül mûködik.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>A 7.1-RELEASE elõtti FreeBSD verziók esetén a <a class=package href=https://cgit.freebsd.org/ports/tree/www/linux-flashplugin7/>www/linux-flashplugin7</a> portot telepítsük és hagyjuk ki a <a href="https://man.freebsd.org/cgi/man.cgi?query=linprocfs&amp;sektion=5&amp;format=html">linprocfs(5)</a> használatára vonatkozó részt.</p></div></td></tr></tbody></table></div></li><li><p>FreeBSD 8.<em>X</em></p><div class=paragraph><p>Telepítsük a <a class=package href=https://cgit.freebsd.org/ports/tree/www/nspluginwrapper/>www/nspluginwrapper</a> portot. Ehhez szükségünk lesz majd a valamivel nagyobb <a class=package href=https://cgit.freebsd.org/ports/tree/emulators/linux_base-f10/>emulators/linux_base-f10</a> portra.</p></div><div class=paragraph><p>Ezt követõen telepítsük a <a class=package href=https://cgit.freebsd.org/ports/tree/www/linux-f10-flashplugin10/>www/linux-f10-flashplugin10</a> portot. Ekkor a Flash™ 10.<em>X</em> változatát kapjuk, amely FreeBSD 8.<em>X</em> alatt remekül használható.</p></div><div class=paragraph><p>Ezen változat beüzemeléséhez még létre kell hoznunk az alábbi linket:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># ln -s /usr/local/lib/npapi/linux-f10-flashplugin/libflashplayer.so \</span>
  /usr/local/lib/browser_plugins/</code></pre></div></div></li></ol></div></div></div><div class=paragraph><p>Miután a FreeBSD rendszerünk változatának megfelelõen elvégeztük a Flash™ port telepítését, a plugint az egyes felhasználóknak a <code>nspluginwrapper</code> paranccsal tehetjük elérhetõvé:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>% nspluginwrapper <span class=nt>-v</span> <span class=nt>-a</span> <span class=nt>-i</span></code></pre></div></div><div class=paragraph><p>Ha Flash™ animációkat szeretnénk lejátszani, akkor ehhez a <span class=filename>/usr/compat/linux/proc</span> könyvtárba csatlakoztatnunk kell egy <a href="https://man.freebsd.org/cgi/man.cgi?query=linprocfs&amp;sektion=5&amp;format=html">linprocfs(5)</a> típusú linuxos proc állományrendszert. Ezt a következõ paranccsal tehetjük meg:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># mount -t linprocfs linproc /usr/compat/linux/proc</span></code></pre></div></div><div class=paragraph><p>Az <span class=filename>/etc/fstab</span> állományban az alábbi sor hozzáadásával azonban ennek csatlakoztatása akár automatikussá is tehetõ a rendszerindítás során:</p></div><div class="literalblock programlisting"><div class=content><pre>linproc  /usr/compat/linux/proc  linprocfs      rw       0       0</pre></div></div><div class=paragraph><p>Ezután indítsuk el a böngészõt, majd gépeljük be az <code>about:plugins</code> szöveget a címsorba és nyomjuk le az <kbd>Enter</kbd> billentyût. Ekkor a jelenleg elérhetõ pluginok listájának kell megjelennie.</p></div></div><div class=sect3><h4 id=moz-swfdec-flash-plugin>6.2.4. A Firefox és az Swfdec Flash™ plugin<a class=anchor href=#moz-swfdec-flash-plugin></a></h4><div class=paragraph><p>Az Swfdec egy Flash™ animációk dekódolásáért és megjelenítéséért felelõs programkönyvtár. Az Swfdec-Mozilla pedig egy Firefox böngészõkhöz készített plugin, amely az Swfdec könyvtáron keresztül játszik le SWF állományokat. Jelenleg még aktív fejlesztés alatt áll.</p></div><div class=paragraph><p>Ha nem akarjuk vagy netalán nem tudjuk forrásból lefordítani, akkor egyszerûen csak telepítsük csomagként a hálózaton keresztül:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># pkg_add -r swfdec-plugin</span></code></pre></div></div><div class=paragraph><p>Ha valamiért mégsem érhetõ el hozzá csomag, akkor a Portgyûjteménybõl is telepíthetjük:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># cd /usr/ports/www/swfdec-plugin</span>
<span class=c># make install clean</span></code></pre></div></div><div class=paragraph><p>Miután telepítettük a plugint, a használatához indítsuk újra a böngészõt.</p></div></div><div class=sect3><h4 id=_opera>6.2.5. Opera<a class=anchor href=#_opera></a></h4><div class=paragraph><p>Az Opera egy sokoldalú és szabványokkal kompatibilis böngészõ. Tartalmaz beépített levelezõ klienst és hírolvasót, IRC-klienst, RSS/Atom-olvasót és még sok mindent mást. Ennek ellenére az Opera viszonylag pehelysúlyúnak és gyorsnak számít. Két fajta módon is használható: létezik "natív" FreeBSD-s változata, valamint a Linux emulációval futó változata.</p></div><div class=paragraph><p>Az Opera FreeBSD-s változatát a megfelelõ csomag telepítésével érhetjük el:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># pkg_add -r opera</span></code></pre></div></div><div class=paragraph><p>Habár egyes FTP oldalakon nem található meg az összes csomag, viszont a Portgyûjteménybõl még ekkor is be tudjuk szerezni az Operat:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># cd /usr/ports/www/opera</span>
<span class=c># make install clean</span></code></pre></div></div><div class=paragraph><p>A linuxos Opera telepítéséhez <code>opera</code> helyett <code>linux-opera</code> nevet kell megadnunk a fenti parancsokban. Ennek a verziónak a használata akkor lehet elõnyös, ha olyan plugineket akarunk elérni, amelyek csak Linuxra léteznek. Ilyen például az Adobe Acrobat Reader®. Ettõl eltekintve azonban a FreeBSD-s és a linuxos változatok szinte teljesen megegyeznek.</p></div></div><div class=sect3><h4 id=_konqueror>6.2.6. Konqueror<a class=anchor href=#_konqueror></a></h4><div class=paragraph><p>A Konqueror a KDE része, de a használatához elegendõ, ha csak a <a class=package href=https://cgit.freebsd.org/ports/tree/x11/kdebase3/>x11/kdebase3</a> portot telepítjük fel. A Konqueror több, mint egy egyszerû böngészõ: állománykezelõ és multimédiás nézegetõ is.</p></div><div class=paragraph><p>Számtalan plugin áll rendelkezésre a Konquerorhoz, melyeket a <a class=package href=https://cgit.freebsd.org/ports/tree/misc/konq-plugins/>misc/konq-plugins</a> portban találunk meg.</p></div><div class=paragraph><p>A Konqueror ismeri a Flash™t is. A Flash™ és a Konqueror kapcsolatával egy külön "Hogyan" is foglalkozik, amelyet a <a href=http://freebsd.kde.org/howtos/konqueror-flash.php>http://freebsd.kde.org/howtos/konqueror-flash.php</a> címen olvashatunk el.</p></div></div></div><div class=sect2><h3 id=desktop-productivity>6.3. Irodai eszközök<a class=anchor href=#desktop-productivity></a></h3><div class=paragraph><p>Amikor irodai felhasználásról van szó, az új felhasználók gyakorta keresnek egy jó irodai programcsomagot vagy egy barátságos szövegszerkesztõt. Habár az egyes <a href=./#x11-wm>munkakörnyezetek</a>, mint például a KDE, gyakran saját irodai eszközöket is tartalmaznak, FreeBSD alatt nincs alapértelmezett irodai programcsomag. A rendszer a munkakörnyezetektõl függetlenül igyekszik felkínálni mindazt, amire szükségünk lehet.</p></div><div class=paragraph><p>Ebben a részben a következõ alkalmazásokról esik szó:</p></div><table class="tableblock frame-none grid-all stretch informaltable"><col style=width:25%><col style=width:25%><col style=width:25%><col style=width:25%><thead><tr><th class="tableblock halign-left valign-top">Alkalmazás</th><th class="tableblock halign-left valign-top">Erõforrásigény</th><th class="tableblock halign-left valign-top">Telepítés forrásból</th><th class="tableblock halign-left valign-top">Fõbb függõségek</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class=tableblock>KOffice</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>kevés</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>nehéz</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>KDE</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>AbiWord</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>kevés</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>könnyû</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Gtk+ vagy GNOME</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>The Gimp</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>kevés</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>nehéz</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Gtk+</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>OpenOffice.org</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>sok</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>nagyon nehéz</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>JDK™, Mozilla</p></td></tr></tbody></table><div class=sect3><h4 id=_koffice>6.3.1. KOffice<a class=anchor href=#_koffice></a></h4><div class=paragraph><p>A KDE közösség által kiadott munkakörnyezethez társul egy irodai programcsomag is, amely a KDE-tõl függetlenül is használható. Tartalmazza a többi irodai programcsomagban is megtalálható négy szabványos komponenst: a KWord szövegszerkesztõt, a KSpread táblazatkezelõt, a KPresenter prezentációkészítõt és végezetül a Kontourt, mellyel grafikus dokumentumokat tudunk elkészíteni.</p></div><div class=paragraph><p>A legfrissebb KOffice telepítése elõtt bizonyosodjuk meg róla, hogy a KDE legfrissebb verziójával is rendelkezünk.</p></div><div class=paragraph><p>Ha a KOffice-t csomagként akarjuk telepíteni, akkor adjuk ki az alábbi parancsot:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># pkg_add -r koffice</span></code></pre></div></div><div class=paragraph><p>Amennyiben ez a csomag nem érhetõ el, telepíthetjük a Portgyûjteménybõl is. Például a KDE3-hoz tartozó KOffice-t így rakhatjuk fel:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># cd /usr/ports/editors/koffice-kde3</span>
<span class=c># make install clean</span></code></pre></div></div></div><div class=sect3><h4 id=_abiword>6.3.2. AbiWord<a class=anchor href=#_abiword></a></h4><div class=paragraph><p>Az AbiWord egy szabad szövegszerkesztõ program, a Microsoft® Word-höz hasonló kinézettel. Remekül használható levelek, beszámolók, feljegyzések, cikkek stb. írásához. Nagyon gyors, rengeteg funkciót ajánl fel, és kifejezetten felhasználóbarát.</p></div><div class=paragraph><p>Az AbiWord képes többféle állományformátumba exportálni és onnan importálni, beleértve az olyan zárt formátumokat is, mint például a Microsoft® <span class=filename>.doc</span>.</p></div><div class=paragraph><p>Az AbiWord csomagból telepíthetõ a következõ módon:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># pkg_add -r abiword</span></code></pre></div></div><div class=paragraph><p>Amennyiben ez a csomag nem érhetõ el, lefordítható a Portgyûjteménybõl is, ami ráadásul sokszor egy frissebb verziót tartalmaz. Ezt így tudjuk megtenni:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># cd /usr/ports/editors/abiword</span>
<span class=c># make install clean</span></code></pre></div></div></div><div class=sect3><h4 id=_the_gimp>6.3.3. The GIMP<a class=anchor href=#_the_gimp></a></h4><div class=paragraph><p>Képek készítésére vagy retusálásra a The GIMP a legfejlettebb képszerkesztõ program. Egyszerû rajzolóprogram gyanánt is használható, de akár minõségi fényképretusálásra is. Óriási mennyiségû plugin található hozzá és magában foglal egy szkriptes interfészt is. A The GIMP formátumok széles skáláját ismeri. Számos scanner és digitális rajztábla csatlakoztatható hozzá.</p></div><div class=paragraph><p>A hozzá tartozó csomag a következõ módon telepíthetõ fel:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># pkg_add -r gimp</span></code></pre></div></div><div class=paragraph><p>Ha a csomagoknak beállított FTP oldalon nem található meg ez a csomag, megpróbálkozhatunk vele a Portgyûjteményen keresztül is. A gyûjtemény <a href=http://www.FreeBSD.org/ports/>graphics</a> könyvtárában ezen felül fellelhetjük a The Gimp Manualt, vagyis a The GIMP kézikönyvét. Így kell ezeket innen telepíteni:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># cd /usr/ports/graphics/gimp</span>
<span class=c># make install clean</span>
<span class=c># cd /usr/ports/graphics/gimp-manual-pdf</span>
<span class=c># make install clean</span></code></pre></div></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>A Portgyûjtemény <a href=http://www.FreeBSD.org/ports/>graphics</a> könyvtárában a The GIMP fejlesztõi változatával is találkozhatunk a <a class=package href=https://cgit.freebsd.org/ports/tree/graphics/gimp-devel/>graphics/gimp-devel</a> alkönyvtárban. A The Gimp Manual HTML változata pedig a <a class=package href=https://cgit.freebsd.org/ports/tree/graphics/gimp-manual-html/>graphics/gimp-manual-html</a> alkönyvtárban található.</p></div></td></tr></tbody></table></div></div><div class=sect3><h4 id=_openoffice_org>6.3.4. OpenOffice.org<a class=anchor href=#_openoffice_org></a></h4><div class=paragraph><p>Az OpenOffice.org tartalmaz minden olyan elengedhetetlenül fontos alkalmazást, amelyek napjaink bármelyik irodájához hozzátartoznak: egy szövegszerkesztõt, egy táblázatkezelõt, egy prezentációszerkesztõt és egy rajzolóprogramot. A felhasználói felülete nagyon hasonlít a többi irodai programcsomagéhoz, és képes többféle elterjedt állományformátumot kezelni. Számos különbözõ nyelven elérhetõ - a honosítása kiterjed a felületekre, helyesírás-ellenõrzõkre és szótárakra is.</p></div><div class=paragraph><p>Az OpenOffice.org szövegszerkesztõje natív XML állományformátumot használ a hordozhatóság és a rugalmasság növeléséhez. A táblázatkezelõje tartalmaz egy makrónyelvet és könnyedén összekapcsolható külsõ adatbázisokkal. Az OpenOffice.org natívan és megbízhatóan fut Windows®-on, Solaris™-on, Linux®-on, FreeBSD-n és Mac OS® X-en. Az OpenOffice.org-ról bõvebb információt a <a href=http://www.openoffice.org/>projekt saját honlapján</a> találhatunk. A FreeBSD-s változatra vonatkozó információkat és a csomagokat pedig a <a href=http://porting.openoffice.org/freebsd/>FreeBSD OpenOffice.org Porting Team</a> honlapján lelhetjük meg.</p></div><div class=paragraph><p>Az OpenOffice.org telepítéséhez ennyit kell csak beírni:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># pkg_add -r openoffice.org</span></code></pre></div></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Ha a FreeBSD -RELEASE ágát használjuk, ennek mûködnie kell. Ettõl eltérõ esetben érdemes egy pillantást vetni a FreeBSD OpenOffice.org Porting Team honlapjára, ahonnan le tudjuk tölteni a verziókhoz megfelelõ csomagot, amelyet ezután a <a href="https://man.freebsd.org/cgi/man.cgi?query=pkg_add&amp;sektion=1&amp;format=html">pkg_add(1)</a>-al fel is tudunk telepíteni. A legfrissebb megbízható és a fejlesztõi változat egyaránt elérhetõ errõl a helyrõl.</p></div></td></tr></tbody></table></div><div class=paragraph><p>Ahogy sikerült feltelepíteni a csomagot, egyszerûen csak be kell gépelni a következõ parancsot az OpenOffice.org futtatásához:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>% openoffice.org</code></pre></div></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Az elsõ futtatás során válaszolnunk kell még néhány további kérdésre is, valamint a felhasználói könyvtárunkban keletkezik egy <span class=filename>.openoffice.org</span> könyvtár.</p></div></td></tr></tbody></table></div><div class=paragraph><p>Ha nem érhetõek el OpenOffice.org csomagok, lefordíthatjuk a forrását is. Azonban mielõtt még ennek nekilátnánk, el kell fogadnunk, hogy ez a mûvelet a lemezünkön rettenetesen sok területet fog igényelni és meglehetõsen sokáig tart.</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># cd /usr/ports/editors/openoffice.org-3</span>
<span class=c># make install clean</span></code></pre></div></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Ha egy honosított verziót szeretnénk fordítani, az utolsó parancs helyett írjuk inkább ezt:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># make LOCALIZED_LANG=nyelv install clean</span></code></pre></div></div><div class=paragraph><p>A <em>nyelv</em> helyett itt természetesen a nyelvnek megfelelõ ISO-kódot kell megadni. Az itt támogatott nyelvek kódjának listája a port könyvtárán belül, a <span class=filename>files/Makefile.localized</span> állományban található meg.</p></div></td></tr></tbody></table></div><div class=paragraph><p>Ahogy a fordítás befejezõdött, az OpenOffice.org így indítható el parancssorból:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>% openoffice.org</code></pre></div></div></div></div><div class=sect2><h3 id=desktop-viewers>6.4. Dokumentum-megjelenítõk<a class=anchor href=#desktop-viewers></a></h3><div class=paragraph><p>A UNIX® megjelenése óta néhány új népszerû dokumentumformátum is felbukkant, melyek szabványos megjelenítõi nem minden esetben részei az alaprendszernek. Ebben a részben azt tekintjük át, hogyan lehet ilyen megjelenítõket telepíteni.</p></div><div class=paragraph><p>Ez a rész az alábbi alkalmazásokat említi:</p></div><table class="tableblock frame-none grid-all stretch informaltable"><col style=width:25%><col style=width:25%><col style=width:25%><col style=width:25%><thead><tr><th class="tableblock halign-left valign-top">Alkalmazás</th><th class="tableblock halign-left valign-top">Erõforrásigény</th><th class="tableblock halign-left valign-top">Telepítés forrásból</th><th class="tableblock halign-left valign-top">Fõbb függõségek</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class=tableblock>Acrobat Reader®</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>kevés</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>könnyû</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Bináris Linux kompatibilitás</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>gv</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>kevés</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>könnyû</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Xaw3d</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>Xpdf</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>kevés</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>könnyû</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>FreeType</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>GQview</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>kevés</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>könnyû</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Gtk+ vagy GNOME</p></td></tr></tbody></table><div class=sect3><h4 id=_acrobat_reader>6.4.1. Acrobat Reader®<a class=anchor href=#_acrobat_reader></a></h4><div class=paragraph><p>A dokumentumok többsége manapság PDF (Portable Document Format, avagy "hordozható dokumentumformátum)" állományok formájában terjed. Az ilyen típusú állományok megnézésére az egyik legmegfelelõbb alkalmazás az Acrobat Reader®, melyet az Adobe adott ki Linuxra. De mivel a FreeBSD képes Linux binárisok futtatására, ezért így FreeBSD-re is elérhetõ.</p></div><div class=paragraph><p>Ha az Acrobat Reader® 8-at a Portgyûjteménybõl akarjuk telepíteni, akkor írjuk be:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># cd /usr/ports/print/acroread8</span>
<span class=c># make install clean</span></code></pre></div></div><div class=paragraph><p>Licencelési megszorítások miatt csomag nem áll rendelkezésre.</p></div></div><div class=sect3><h4 id=_gv>6.4.2. gv<a class=anchor href=#_gv></a></h4><div class=paragraph><p>A gv egy PostScript® és PDF megjelenítõ. Eredetileg a ghostview alapján készült, de a Xaw3d-nek köszönhetõen sokkal szebben néz ki. Gyors és a felülete letisztult. A gv sok mindent tud, többek közt beállítható benne a dokumentum tájolása, a papírméret, skálázás és az élsimítás. Szinte bármelyik mûvelet elvégezhetõ csak billentyûzetrõl vagy egérrel.</p></div><div class=paragraph><p>A gv csomagjának telepítéséhez a következõ parancsot használhatjuk:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># pkg_add -r gv</span></code></pre></div></div><div class=paragraph><p>Ha pedig nem tudjuk letölteni a csomagot, használhatjuk a Portgyûjteményt is:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># cd /usr/ports/print/gv</span>
<span class=c># make install clean</span></code></pre></div></div></div><div class=sect3><h4 id=_xpdf>6.4.3. Xpdf<a class=anchor href=#_xpdf></a></h4><div class=paragraph><p>Ha egy egyszerû FreeBSD-s PDF megjelenítõre lenne szükségünk, erre a célra az Xpdf pontosan megfelel. Nagyon kevés erõforrást igényel és nagyon megbízható. A szabványos X-beli betûtípusokat használja, és nincs szüksége sem a Motif®ra, sem pedig más X-es eszközkészletre.</p></div><div class=paragraph><p>Az Xpdf csomagjának felrakásához az alábbi parancs javasolt:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># pkg_add -r xpdf</span></code></pre></div></div><div class=paragraph><p>Amennyiben nem áll rendelkezésre az említett csomag, vagy egyszerûen csak a Portgyûjteménybõl szeretnénk felrakni, adjuk ki ezeket a parancsokat:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># cd /usr/ports/graphics/xpdf</span>
<span class=c># make install clean</span></code></pre></div></div><div class=paragraph><p>Ahogy a telepítés befejezõdik, már el is indíthatjuk az Xpdf alkalmazást, ahol a jobb egérgombbal tudjuk aktiválni a menüt.</p></div></div><div class=sect3><h4 id=_gqview>6.4.4. GQview<a class=anchor href=#_gqview></a></h4><div class=paragraph><p>A GQview egy képkezelõ. Állományokat tudunk megnyitni benne egyetlen kattintással, külsõ szerkesztõprogramot tudunk indítani vagy akár még a képek kicsinyített változatait is láthatjuk és így tovább. Megtalálható benne a diavetítés és az alapvetõ állománymûveletek. Képgyûjteményeket is kezelhetünk és könnyedén megtalálhatjuk a bennük levõ képek között az egyezõeket. A GQview teljes képernyõs nézegetést is megenged, illetve támogatja a honosítást.</p></div><div class=paragraph><p>A GQview csomag telepítéséhez ezt a parancsot kell kiadni:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># pkg_add -r gqview</span></code></pre></div></div><div class=paragraph><p>Amikor ez a csomag nem tölthetõ le, vagy amikor inkább a Portgyûjteménybõl szeretnénk felrakni, ezt írjuk be:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># cd /usr/ports/graphics/gqview</span>
<span class=c># make install clean</span></code></pre></div></div></div></div><div class=sect2><h3 id=desktop-finance>6.5. Pénzügyi szoftverek<a class=anchor href=#desktop-finance></a></h3><div class=paragraph><p>Ha bármilyen ok folytán a FreeBSD-vel szeretnénk kezeli személyes pénzügyeinket, akadnak olyan kellõen komoly és könnyen kezelhetõ alkalmazások, amelyek csak a telepítésükre várnak. Néhány közülük kompatibilis az elterjedtebb állományformátumokkal, mint például amiben a Quicken és az Excel is tárolja az adatait.</p></div><div class=paragraph><p>Ebben a részben az alábbi programokat vesszük sorra:</p></div><table class="tableblock frame-none grid-all stretch informaltable"><col style=width:25%><col style=width:25%><col style=width:25%><col style=width:25%><thead><tr><th class="tableblock halign-left valign-top">Alkalmazás</th><th class="tableblock halign-left valign-top">Erõforrásigény</th><th class="tableblock halign-left valign-top">Telepítés forrásból</th><th class="tableblock halign-left valign-top">Fõbb függõségek</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class=tableblock>GnuCash</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>kevés</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>nehéz</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>GNOME</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>Gnumeric</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>kevés</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>nehéz</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>GNOME</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>Abacus</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>kevés</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>könnyû</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Tcl/Tk</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>KMyMoney</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>kevés</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>nehéz</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>KDE</p></td></tr></tbody></table><div class=sect3><h4 id=_gnucash>6.5.1. GnuCash<a class=anchor href=#_gnucash></a></h4><div class=paragraph><p>A GnuCash a GNOME része, és egy felhasználóbarát, mégis hatékony eszközt ad a felhasználók kezébe. A GnuCash segítségével nyilván tudjuk tartani a bevételeinket és kiadásainkat, bankszámláinkat és befektetéseinket. Felülete intuitív, miközben továbbra is professzionális minõségû.</p></div><div class=paragraph><p>A GnuCash-ben megtalálhatunk egy intelligens nyilvántartást, a számlák hierarchikus rendszerét, és számtalan billentyûkombinációt és automatikus kiegészítést, amivel felgyorsul a munkánk. Egyetlen tranzakciót képes felbontani több kisebb és részletesebb elemre. A GnuCash képes importálni és exportálni a Quicken QIF típusú állományait. Ezenkívül még kezeli a legtöbb nemzetközi dátumformátumot és pénznemet.</p></div><div class=paragraph><p>A GnuCash-t az alábbi módon tudjuk telepíteni a rendszerünkre:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># pkg_add -r gnucash</span></code></pre></div></div><div class=paragraph><p>Ha ez a csomag nem érhetõ el, használhatjuk a Portgyûjteményt is:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># cd /usr/ports/finance/gnucash</span>
<span class=c># make install clean</span></code></pre></div></div></div><div class=sect3><h4 id=_gnumeric>6.5.2. Gnumeric<a class=anchor href=#_gnumeric></a></h4><div class=paragraph><p>A Gnumeric egy táblázatkezelõ program, a GNOME munkakörnyezet része. Sok esetben képes a helyzethez alkalmazkodva automatikusan "kitalálni" a felhasználó gondolatait a cellák formátumának megfelelõ automatikus kiegészítõ rendszerével. Be tud olvasni számos népszerûbb formátumot, mint például az Excel, Lotus 1-2-3 vagy a Quattro Pro állományait. A <a class=package href=https://cgit.freebsd.org/ports/tree/math/guppi/>math/guppi</a> grafikonkészítõ programon keresztül támogatja grafikonok rajzolását is. Nagyszámú beépített funkcióval rendelkezik, és ismeri az összes megszokott cellaformátumot, legyen az szám, pénznem, dátum, idõ vagy bármi más.</p></div><div class=paragraph><p>A Gnumeric telepítését az alábbi paranccsal adhatjuk ki:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># pkg_add -r gnumeric</span></code></pre></div></div><div class=paragraph><p>Ha valamiért nem érhetõ el ez a csomag, a Portgyûjteménybõl is fel tudjuk rakni:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># cd /usr/ports/math/gnumeric</span>
<span class=c># make install clean</span></code></pre></div></div></div><div class=sect3><h4 id=_abacus>6.5.3. Abacus<a class=anchor href=#_abacus></a></h4><div class=paragraph><p>Az Abacus egy kicsi és egyszerûen használható táblázatkezelõ program. Számos olyan funkciót tartalmaz beépítve, amelyek kifejezetten hasznosnak bizonyulhatnak a statisztika, pénzügyek és a matematika területén. Importálni és exportálni tudja az Excel állományformátumát is. Az Abacus még PostScript® formátumú kimenetet is tud készíteni.</p></div><div class=paragraph><p>Az Abacus telepítéséhez csupán ennyit kell tennünk:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># pkg_add -r abacus</span></code></pre></div></div><div class=paragraph><p>Amennyiben viszont nem érhetõ el ez a csomag, használhatjuk a Portgyûjteményt is:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># cd /usr/ports/deskutils/abacus</span>
<span class=c># make install clean</span></code></pre></div></div></div><div class=sect3><h4 id=_kmymoney>6.5.4. KMyMoney<a class=anchor href=#_kmymoney></a></h4><div class=paragraph><p>A KMyMoney a KDE részeként kifejlesztett személyi pénzügyi nyilvántartó. A KMyMoney igyekszik az összes kereskedelmi pénzügyi nyilvántartó programban megtalálható fontosabb lehetõséget magában foglalni és rendelkezésre bocsátani. Mindezek mellett egy könnyen használható és nagyon ügyes kettõs könyvelést is találhatunk benne. A KMyMoney képes beolvasni a szabványos Quicken Interchange Format (QIF) szerint készült állományokat, követni a befektetéseket, többféle pénznemet kezelni és sokfajta kimutatást tudunk vele készíteni. A megfelelõ bõvítmény hozzáadásával még az OFX formátumú állományok olvasására is alkalmas.</p></div><div class=paragraph><p>A KMyMoney csomagként így telepíthetõ:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># pkg_add -r kmymoney2</span></code></pre></div></div><div class=paragraph><p>Ha ez a csomag nem érhetõ el, akkor a Portgyûjteményen keresztül is fel tudjuk rakni:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># cd /usr/ports/finance/kmymoney2</span>
<span class=c># make install clean</span></code></pre></div></div></div></div><div class=sect2><h3 id=desktop-summary>6.6. Összefoglalás<a class=anchor href=#desktop-summary></a></h3><div class=paragraph><p>Miközben a FreeBSD igen népszerû az internetszolgáltatók körében a teljesítménye és megbízhatósága révén, a hétköznapi használatban is remekül beválik. Többezernyi olyan alkalmazás érhetõ el hozzá <a href=http://www.FreeBSD.org/where/>csomag</a>ként vagy <a href=http://www.FreeBSD.org/ports/>port</a>ként, amelyekkel az igényeinknek megfelelõ munkakörnyezetet tudjuk kiépíteni.</p></div><div class=paragraph><p>Íme egy rövidke emlékeztetõ azokról az asztali alkalmazásokról, melyeket a fejezetben tárgyaltunk:</p></div><table class="tableblock frame-none grid-all stretch informaltable"><col style=width:33.3333%><col style=width:33.3333%><col style=width:33.3334%><thead><tr><th class="tableblock halign-left valign-top">Alkalmazás</th><th class="tableblock halign-left valign-top">Csomag</th><th class="tableblock halign-left valign-top">Port</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class=tableblock>Opera</p></td><td class="tableblock halign-left valign-top"><p class=tableblock><code>opera</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock><a class=package href=https://cgit.freebsd.org/ports/tree/www/opera/>www/opera</a></p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>Firefox</p></td><td class="tableblock halign-left valign-top"><p class=tableblock><code>firefox</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock><a class=package href=https://cgit.freebsd.org/ports/tree/www/firefox/>www/firefox</a></p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>KOffice</p></td><td class="tableblock halign-left valign-top"><p class=tableblock><code>koffice-kde3</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock><a class=package href=https://cgit.freebsd.org/ports/tree/editors/koffice-kde3/>editors/koffice-kde3</a></p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>AbiWord</p></td><td class="tableblock halign-left valign-top"><p class=tableblock><code>abiword</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock><a class=package href=https://cgit.freebsd.org/ports/tree/editors/abiword/>editors/abiword</a></p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>The GIMP</p></td><td class="tableblock halign-left valign-top"><p class=tableblock><code>gimp</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock><a class=package href=https://cgit.freebsd.org/ports/tree/graphics/gimp/>graphics/gimp</a></p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>OpenOffice.org</p></td><td class="tableblock halign-left valign-top"><p class=tableblock><code>openoffice</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock><a class=package href=https://cgit.freebsd.org/ports/tree/editors/openoffice.org-3/>editors/openoffice.org-3</a></p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>Acrobat Reader®</p></td><td class="tableblock halign-left valign-top"><p class=tableblock><code>acroread</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock><a class=package href=https://cgit.freebsd.org/ports/tree/print/acroread8/>print/acroread8</a></p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>gv</p></td><td class="tableblock halign-left valign-top"><p class=tableblock><code>gv</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock><a class=package href=https://cgit.freebsd.org/ports/tree/print/gv/>print/gv</a></p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>Xpdf</p></td><td class="tableblock halign-left valign-top"><p class=tableblock><code>xpdf</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock><a class=package href=https://cgit.freebsd.org/ports/tree/graphics/xpdf/>graphics/xpdf</a></p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>GQview</p></td><td class="tableblock halign-left valign-top"><p class=tableblock><code>gqview</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock><a class=package href=https://cgit.freebsd.org/ports/tree/graphics/gqview/>graphics/gqview</a></p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>GnuCash</p></td><td class="tableblock halign-left valign-top"><p class=tableblock><code>gnucash</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock><a class=package href=https://cgit.freebsd.org/ports/tree/finance/gnucash/>finance/gnucash</a></p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>Gnumeric</p></td><td class="tableblock halign-left valign-top"><p class=tableblock><code>gnumeric</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock><a class=package href=https://cgit.freebsd.org/ports/tree/math/gnumeric/>math/gnumeric</a></p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>Abacus</p></td><td class="tableblock halign-left valign-top"><p class=tableblock><code>abacus</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock><a class=package href=https://cgit.freebsd.org/ports/tree/deskutils/abacus/>deskutils/abacus</a></p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>KMyMoney</p></td><td class="tableblock halign-left valign-top"><p class=tableblock><code>kmymoney2</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock><a class=package href=https://cgit.freebsd.org/ports/tree/finance/kmymoney2/>finance/kmymoney2</a></p></td></tr></tbody></table></div></div></div><div class=sect1><h2 id=multimedia>Chapter 7. Multimédia<a class=anchor href=#multimedia></a></h2><div class=sectionbody><div class=sect2><h3 id=multimedia-synopsis>7.1. Áttekintés<a class=anchor href=#multimedia-synopsis></a></h3><div class=paragraph><p>A FreeBSD a hangkártyák széles választékát ismeri, ami által képesek vagyunk számítógépünkkel hi-fi minõségû hangzást létrehozni. Ennek részeként rögzíteni és visszajátszani tudunk többek közt MPEG Audio Layer 3 (MP3), WAV és Ogg Vorbis formátumokban. A FreeBSD Portgyûjteménye ezenkívül tartalmaz még olyan alkalmazásokat is, amelyekkel szerkeszteni lehet a felvett hangokat, effekteket hozzátenni és vezérelni a hangkártyánkhoz csatlakoztatott MIDI eszközöket.</p></div><div class=paragraph><p>Némi kísérletezéssel a FreeBSD még videoállományok és DVD-k lejátszására is rávehetõ. A különféle videoanyagok kódolására, konvertálására és visszajátszására alkalmas programok száma azonban jóval kisebb, mint a hanganyagok esetén. Például az írás pillanatában nincs a FreeBSD Portgyûjteményében a formátumok közti konvertálásra alkalmas, a videókat olyan jól újrakódolni tudó alkalmazás, amilyen az audio esetén az <a class=package href=https://cgit.freebsd.org/ports/tree/audio/sox/>audio/sox</a>. Azonban ezen a területen a szoftverek palettája gyorsan változik.</p></div><div class=paragraph><p>Ebben a fejezetben bemutatjuk a hangkártyánk beállításához szükséges lépéseket. Az X11 telepítése és beállítása (<a href=./#x11>Az X Window System</a>) során ugyan már foglalkoztunk a videokártyánkkal kapcsolatos hardveres problémákkal, azonban a jobb visszajátszás érdekében további cselfogásokat is be kell majd vetnünk.</p></div><div class=paragraph><p>A fejezet elolvasása során megismerjük:</p></div><div class=ulist><ul><li><p>hogyan állítsuk be úgy a rendszerünket, hogy felismerje a hangkártyánkat;</p></li><li><p>hogyan bizonyosodjuk meg róla, hogy a kártyánk valóban mûködik;</p></li><li><p>hogyan oldjuk meg a hangkártya beállítása során felmerülõ problémákat;</p></li><li><p>hogyan játsszunk le és kódoljunk MP3-at vagy más egyéb hangformátumot;</p></li><li><p>hogyan támogatja a videokat az X szerver;</p></li><li><p>hogyan adnak az egyes lejátszók és kódolók még jobb eredményt</p></li><li><p>hogyan játsszunk le DVD-ket, <span class=filename>.mpg</span> és <span class=filename>.avi</span> állományokat;</p></li><li><p>hogyan mentsük a CD-k és DVD-k tartalmát állományokba;</p></li><li><p>hogyan állítsuk be a TV kártyánkat</p></li><li><p>hogyan állítsunk be egy scannert.</p></li></ul></div><div class=paragraph><p>A fejezet elolvasásához ajánlott:</p></div><div class=ulist><ul><li><p>egy új rendszermag beállításának és telepítésének ismerete (<a href=./#kernelconfig>A FreeBSD rendszermag testreszabása</a>).</p></li></ul></div><div class="admonitionblock warning"><table><tbody><tr><td class=icon><i class="fa icon-warning" title=Warning></i></td><td class=content><div class=paragraph><p>Ha zenei CD-ket próbálunk meg a <a href="https://man.freebsd.org/cgi/man.cgi?query=mount&amp;sektion=8&amp;format=html">mount(8)</a> paranccsal csatlakoztatni, akkor az hibával, vagy a legrosszabb esetben akár <em>teljes rendszerösszeomlással</em> is járhat. Az ilyen típusú lemezek az ISO szabványú állományrendszerekétõl eltérõ kódolással rendelkeznek.</p></div></td></tr></tbody></table></div></div><div class=sect2><h3 id=sound-setup>7.2. A hangkártya beállítása<a class=anchor href=#sound-setup></a></h3><div class=sect3><h4 id=sound-device>7.2.1. A rendszer beállítása<a class=anchor href=#sound-device></a></h4><div class=paragraph><p>A mûvelet megkezdése elõtt ki kell derítenünk, milyen típusú hangkártyánk van, milyen chip van rajta, PCI vagy ISA buszon csatlakozik-e. A FreeBSD rengeteg PCI és ISA buszos kártyát ismer egyaránt. A sajátunk beazonosításához a támogatott hangeszközök listáját a <a href=https://www.FreeBSD.org/releases/12.0R/hardware/>Hardware Notes</a> (Hardverjegyzék) oldalán találhatjuk meg. Ebbõl a jegyzékbõl mellesleg azt is megtudhatjuk, hogy melyik meghajtó kezeli a kártyánkat.</p></div><div class=paragraph><p>A hangeszközünk használatához be kell töltenünk a neki megfelelõ meghajtót. Ez két módon is megtehetõ. Ezek közül az a legkönnyebb, ha a <a href="https://man.freebsd.org/cgi/man.cgi?query=kldload&amp;sektion=8&amp;format=html">kldload(8)</a> paranccsal egyszerûen betöltjük a rendszermag hangkártyánkhoz tartozó modulját. Ezt megtehetjük közvetlenül parancssorból:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># kldload snd_emu10k1</span></code></pre></div></div><div class=paragraph><p>vagy a <span class=filename>/boot/loader.conf</span> állományból az alábbihoz hasonló sor hozzáadásával:</p></div><div class="literalblock programlisting"><div class=content><pre>snd_emu10k1_load=&#34;YES&#34;</pre></div></div><div class=paragraph><p>A fenti példák a Creative SoundBlaster® Live! hangkártyára vonatkoznak. A többi betölthetõ hangkártya-modul felsorolása a <span class=filename>/boot/defaults/loader.conf</span> állományban található. Ha nem vagyunk benne biztosak, hogy melyik meghajtót is akarjuk pontosan használni, akkor próbálkozzunk az <span class=filename>snd_driver</span> modul betöltésével:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># kldload snd_driver</span></code></pre></div></div><div class=paragraph><p>Ez egy olyan metameghajtó, ami egyszerre betölti az összes érintett eszközmeghajtót, és segítségével felgyorsíthatjuk a megfelelõ meghajtó megtalálását. A <span class=filename>/boot/loader.conf</span> használatával is be tudjuk ugyanígy tölteni az összes meghajtót.</p></div><div class=paragraph><p>Az <span class=filename>snd_driver</span> metameghajtó betöltése után úgy kereshetjük meg a ténylegesen használatban levõ meghajtót, ha megnézzük a <span class=filename>/dev/sndstat</span> állományt a <code>cat /dev/sndstat</code> paranccsal.</p></div><div class=paragraph><p>A második módszer szerint a hangkártyánk támogatását statikusan beépítjük a rendszermagba. A lentebb található szakaszban olvashatjuk mindazok az információkat, amelyekre szükségünk lehet ennek elvégzése közben. A rendszermag újrafordításával kapcsolatban forduljunk a <a href=./#kernelconfig>A FreeBSD rendszermag testreszabása</a>hez.</p></div><div class=sect4><h5 id=_a_hangkártya_támogatásával_rendelkezõ_saját_rendszermag_összeállítása>7.2.1.1. A hangkártya támogatásával rendelkezõ saját rendszermag összeállítása<a class=anchor href=#_a_hangkártya_támogatásával_rendelkezõ_saját_rendszermag_összeállítása></a></h5><div class=paragraph><p>Elsõként hozzá kell adnunk a rendszermaghoz a hangeszközök alapmeghajtóját, a <a href="https://man.freebsd.org/cgi/man.cgi?query=sound&amp;sektion=4&amp;format=html">sound(4)</a> eszközt. Ezt a rendszermag beállításait tartalmazó állományban az alábbi sor felvételével tehetjük meg:</p></div><div class="literalblock programlisting"><div class=content><pre>device sound</pre></div></div><div class=paragraph><p>Ezután tegyük még hozzá a hangkártyánkhoz kapcsolódó támogatást is. Ehhez viszont pontosan tudunk kell, melyik meghajtó képes mûködtetni a kártyát. A hangkártyához tartozó meghajtót a <a href=https://www.FreeBSD.org/releases/12.0R/hardware/>Hardware Notes</a> (Hardverjegyzék)-ben található eszközök listájából deríthetjük ki. Például a Creative SoundBlaster® Live! hangkártyát a <a href="https://man.freebsd.org/cgi/man.cgi?query=snd_emu10k1&amp;sektion=4&amp;format=html">snd_emu10k1(4)</a> meghajtó kezeli. Ennek a hangkártyának a támogatását az alábbi sorral állíthatjuk be:</p></div><div class="literalblock programlisting"><div class=content><pre>device snd_emu10k1</pre></div></div><div class=paragraph><p>Az itt használatos formátumot a meghajtó man oldalának átolvasásából tudhatjuk meg. Azonban az összes támogatott hangkártya meghajtó megadásának pontos formátuma megtalálható a <span class=filename>/usr/src/sys/conf/NOTES</span> állományban is.</p></div><div class=paragraph><p>A PnP (Plug n Play)-t nem ismerõ ISA kártyák esetén az összes többi nem PnP-s ISA kártyához hasonlóan szükséges lehet a rendszermag számára megadnunk a kártya hardveres beállításait (IRQ, I/O port stb). Ezt a <span class=filename>/boot/device.hints</span> állományon keresztül tehetjük meg. A rendszerindítási folyamat során a <a href="https://man.freebsd.org/cgi/man.cgi?query=loader&amp;sektion=8&amp;format=html">loader(8)</a> beolvassa ezt az állományt, majd átadja a benne szereplõ információkat a rendszermagnak. Például a Creative SoundBlaster® 16, nem PnP-s ISA kártya az <code>snd_sb16</code> meghajtóval együtt az <a href="https://man.freebsd.org/cgi/man.cgi?query=snd_sbc&amp;sektion=4&amp;format=html">snd_sbc(4)</a> meghajtót használja. A kártya használatához a rendszermag beállításait tartalmazó állományba ezeket a sorokat kell megadni:</p></div><div class="literalblock programlisting"><div class=content><pre>device snd_sbc
device snd_sb16</pre></div></div><div class=paragraph><p>valamint a <span class=filename>/boot/device.hints</span> állományba ezeket:</p></div><div class="literalblock programlisting"><div class=content><pre>hint.sbc.0.at=&#34;isa&#34;
hint.sbc.0.port=&#34;0x220&#34;
hint.sbc.0.irq=&#34;5&#34;
hint.sbc.0.drq=&#34;1&#34;
hint.sbc.0.flags=&#34;0x15&#34;</pre></div></div><div class=paragraph><p>Ekkor a kártya a <code>0x220</code> I/O portot és <code>5</code> IRQ-t használja.</p></div><div class=paragraph><p>A <span class=filename>/boot/device.hints</span> állományban alkalmazott felírási módról bõvebben a <a href="https://man.freebsd.org/cgi/man.cgi?query=sound&amp;sektion=4&amp;format=html">sound(4)</a>, valamint a kérdéses meghajtó man oldalán tájékozódhatunk.</p></div><div class=paragraph><p>A fentiekben bemutatott beállítások alapértelmezettek, néhány esetben azonban a kártyánknak megfelelõen meg kell változtatnunk az IRQ és egyéb értékeket. Errõl a kártyáról konkrétan a <a href="https://man.freebsd.org/cgi/man.cgi?query=snd_sbc&amp;sektion=4&amp;format=html">snd_sbc(4)</a> man oldalon olvashatunk részletesebben.</p></div></div></div><div class=sect3><h4 id=sound-testing>7.2.2. A hangkártya kipróbálása<a class=anchor href=#sound-testing></a></h4><div class=paragraph><p>Miután újraindítottuk a számítógépünket a módosított rendszermaggal, vagy miután betöltöttük a szükséges modult, a hangkártyának valahogy így kell megjelennie a rendszerünk üzenetpufferében (<a href="https://man.freebsd.org/cgi/man.cgi?query=dmesg&amp;sektion=8&amp;format=html">dmesg(8)</a>):</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>pcm0: &lt;Intel ICH3 <span class=o>(</span>82801CA<span class=o>)&gt;</span> port 0xdc80-0xdcbf,0xd800-0xd8ff irq 5 at device 31.5 on pci0
pcm0: <span class=o>[</span>GIANT-LOCKED]
pcm0: &lt;Cirrus Logic CS4205 AC97 Codec&gt;</code></pre></div></div><div class=paragraph><p>A hangkártyánk állapota a <span class=filename>/dev/sndstat</span> állományon keresztül ellenõrizhetõ:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># cat /dev/sndstat</span>
FreeBSD Audio Driver <span class=o>(</span>newpcm<span class=o>)</span>
Installed devices:
pcm0: &lt;Intel ICH3 <span class=o>(</span>82801CA<span class=o>)&gt;</span> at io 0xd800, 0xdc80 irq 5 bufsz 16384
kld snd_ich <span class=o>(</span>1p/2r/0v channels duplex default<span class=o>)</span></code></pre></div></div><div class=paragraph><p>Ez a kiírás rendszerenként eltérhet. Ha nem látunk semmilyen <span class=filename>pcm0</span> eszközt, akkor menjünk vissza és nézzük át újra, pontosan mit is csináltunk. Vizsgáljuk át a rendszermagunk beállításait tartalmazó állományt és gyõzõdjünk meg róla, hogy a megfelelõ meghajtót adtuk meg. Az itt felmerülõ gyakori gondokkal a <a href=#troubleshooting>Gyakori problémák</a> foglalkozik.</p></div><div class=paragraph><p>Ha azonban minden remekül haladt, akkor most már van egy mûködõ hangkártyánk. Ha rendesen összekapcsoltuk hangkártyánkat a CD- vagy DVD-meghajtónk audio csatlakozásával, akkor tegyünk egy CD-t a meghajtóba és kezdjük el játszani a <a href="https://man.freebsd.org/cgi/man.cgi?query=cdcontrol&amp;sektion=1&amp;format=html">cdcontrol(1)</a> paranccsal:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>% cdcontrol <span class=nt>-f</span> /dev/acd0 play 1</code></pre></div></div><div class=paragraph><p>Az olyan alkalmazások, mint például az <a class=package href=https://cgit.freebsd.org/ports/tree/audio/workman/>audio/workman</a>, ehhez egy sokkal barátságosabb felületet nyújtanak. Az MP3 formátumú állományok meghallgatásához pedig minden bizonnyal jól fog jönni egy olyan alkalmazás is, mint például az <a class=package href=https://cgit.freebsd.org/ports/tree/audio/mpg123/>audio/mpg123</a>.</p></div><div class=paragraph><p>A kártyát úgy is tesztelhetjük, ha az alábbihoz hasonló módon adatokat küldünk a <span class=filename>/dev/dsp</span> állományba:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>% <span class=nb>cat </span>állománynév <span class=o>&gt;</span> /dev/dsp</code></pre></div></div><div class=paragraph><p>ahol az <em>állománynév</em> tetszõleges állomány neve lehet. A parancs hatására valamilyen zajt kell hallanunk, és ez egyben meg is erõsíti, hogy a hangkártyánk mûködik.</p></div><div class=paragraph><p>A hangkártyánk csatornáinak jellemzõit a <a href="https://man.freebsd.org/cgi/man.cgi?query=mixer&amp;sektion=8&amp;format=html">mixer(8)</a> paranccsal állíthatjuk. Errõl további részleteket a <a href="https://man.freebsd.org/cgi/man.cgi?query=mixer&amp;sektion=8&amp;format=html">mixer(8)</a> man oldalon olvashatunk.</p></div><div class=sect4><h5 id=troubleshooting>7.2.2.1. Gyakori problémák<a class=anchor href=#troubleshooting></a></h5><table class="tableblock frame-none grid-all stretch informaltable"><col style=width:50%><col style=width:50%><thead><tr><th class="tableblock halign-left valign-top">Hiba</th><th class="tableblock halign-left valign-top">Megoldás</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>sb_dspwr(XX) timed out</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Nem állítottuk be jól az I/O portot.</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>bad irq XX</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Nem állítottuk be jól az IRQ értékét. Gondoskodjunk róla, hogy a beállított érték megegyezik a hangkártyánkéval.</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>xxx: gus pcm not attached, out of memory</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Nincs elég memória az eszköz használatához.</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>xxx: can’t open /dev/dsp!</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>A <code>fstat | grep dsp</code> parancs kiadásával ellenõrizzük, hogy valamelyik alkalmazás használja-e már az eszközt. Gyakori bajkeverõ az esound és a KDE hangtámogatása.</p></td></tr></tbody></table></div></div><div class=sect3><h4 id=sound-multiple-sources>7.2.3. Több hangforrás kihasználása<a class=anchor href=#sound-multiple-sources></a></h4><div class=paragraph><p>Gyakran szükségünk lehet több hangforrás egyidejû használatára, fõleg olyankor, amikor az esound vagy az artsd bizonyos alkalmazásokkal nem hajlandó megosztani a hangeszközt.</p></div><div class=paragraph><p>A FreeBSD ezt a <em>virtuális hangcsatornák</em> használatával oldja meg, amit a <a href="https://man.freebsd.org/cgi/man.cgi?query=sysctl&amp;sektion=8&amp;format=html">sysctl(8)</a> eszközön keresztül tudunk engedélyezni. Amikor a rendszermagban virtuális csatornák használatával keverünk, akkor lényegében képesek vagyunk a hangkártyánk által egyszerre játszható hangok számát megtöbbszörözni.</p></div><div class=paragraph><p>A virtuális csatornák számának beállításához a sysctl három változóját kell módosítanunk, amelyet <code>root</code> felhasználóként így tehetünk meg:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># sysctl dev.pcm.0.play.vchans=4</span>
<span class=c># sysctl dev.pcm.0.rec.vchans=4</span>
<span class=c># sysctl hw.snd.maxautovchans=4</span></code></pre></div></div><div class=paragraph><p>A fenti példa négy virtuális csatornát hoz létre, ami egészen jellemzõ a mindennapi használatban. A <code>dev.pcm.0.play.vchans</code> és <code>dev.pcm.0.rec.vchans</code> a <span class=filename>pcm0</span> eszköz lejátszásra és felvételre használt virtuális csatornáinak számát adja meg, amelyet az eszköz csatlakoztatása után tudunk beállítani. A <code>hw.snd.maxautovchans</code> az új eszközhöz tartozó virtuális csatornákat adja meg, ami akkor állítódik be, amikor a <a href="https://man.freebsd.org/cgi/man.cgi?query=kldload&amp;sektion=8&amp;format=html">kldload(8)</a> paranccsal csatlakoztatjuk. Mivel a <span class=filename>pcm</span> modul a többi eszközmeghajtótól függetlenül töltõdik be, ezért a <code>hw.snd.maxautovchans</code> azt tárolja, hogy a késõbb hozzá csatlakozó eszközök mennyi virtuális csatornát fognak majd kapni. Errõl részletesebben a <a href="https://man.freebsd.org/cgi/man.cgi?query=pcm&amp;sektion=4&amp;format=html">pcm(4)</a> man oldalon olvashatunk.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>A használatban levõ eszközöknél nem tudjuk megváltoztatni a virtuális csatornák számát. Ehhez elõször le kell állítanunk az eszközt használó összes programot, tehát a zenelejátszókat és hangdémonokat.</p></div></td></tr></tbody></table></div><div class=paragraph><p>Amennyiben nem használjuk ki a <a href="https://man.freebsd.org/cgi/man.cgi?query=devfs&amp;sektion=5&amp;format=html">devfs(5)</a> által nyújtott lehetõségeket, az összes alkalmazásnak a <span class=filename>/dev/dsp0.x</span> eszközre kell mutatnia, ahol az <em>x</em> értéke 0-tól 3-ig terjedhet attól függõen, hogy a <code>dev.pcm.0.rec.vchans</code> értékét a fenti példához hasonlóan 4-re állítottuk-e. A <a href="https://man.freebsd.org/cgi/man.cgi?query=devfs&amp;sektion=5&amp;format=html">devfs(5)</a> megoldását használó rendszerek esetén ez a folyamat automatikusan lezajlik, tehát az összes <span class=filename>/dev/dsp</span> eszközre irányuló kérés magától átirányítódik.</p></div></div><div class=sect3><h4 id=_a_keverõ_alapértelmezett_értékeinek_beállítása>7.2.4. A keverõ alapértelmezett értékeinek beállítása<a class=anchor href=#_a_keverõ_alapértelmezett_értékeinek_beállítása></a></h4><div class=paragraph><p>A keverõben megjelenõ különbözõ csatornák alapértékei a <a href="https://man.freebsd.org/cgi/man.cgi?query=pcm&amp;sektion=4&amp;format=html">pcm(4)</a> meghajtó forráskódjában huzalozottan találhatóak meg. Számos alkalmazás és démon segít két hívás közt megõrizni a keverõben beállított értékeket, azonban ez nem teljesen tiszta megoldás. A meghajtó szintjén is be tudjuk állítani a keverõ alapértékeit - ezt a <span class=filename>/boot/device.hints</span> állomány megfelelõ módosításával érhetjük el, például:</p></div><div class="literalblock programlisting"><div class=content><pre>hint.pcm.0.vol=&#34;50&#34;</pre></div></div><div class=paragraph><p>Ezzel a <a href="https://man.freebsd.org/cgi/man.cgi?query=pcm&amp;sektion=4&amp;format=html">pcm(4)</a> modul betöltése során a hangerõ (volume) csatorna alapértelmezett értéket 50-re állítjuk.</p></div></div></div><div class=sect2><h3 id=sound-mp3>7.3. MP3<a class=anchor href=#sound-mp3></a></h3><div class=paragraph><p>Az MP3 (MPEG Layer 3 Audio) használatával közel CD minõségû hangot lehet elérni, ezért a mi FreeBSD munkaállomásunk sem maradhat ki elõnyeinek élvezetébõl.</p></div><div class=sect3><h4 id=mp3-players>7.3.1. MP3 lejátszók<a class=anchor href=#mp3-players></a></h4><div class=paragraph><p>Az XMMS (X Multimedia System) kiemelkedõen a legnépszerûbb X11-es MP3 lejátszó. Mivel az XMMS grafikus felhasználói felülete szinte teljesen megegyezik a Nullsoft Winampjának felületével, ezért még a Winamp skinjeit is használhatjuk vele. Az XMMS-ben ezenkívül még a natív pluginek támogatását is megtalálhatjuk.</p></div><div class=paragraph><p>Az XMMS a <a class=package href=https://cgit.freebsd.org/ports/tree/multimedia/xmms/>multimedia/xmms</a> portból vagy csomagból telepíthetõ.</p></div><div class=paragraph><p>Az XMMS használatára könnyû ráérezni: megtaláljuk benne a lejátszandó számok listáját, egy grafikus hangszínszabályzót és még sok minden mást. Akik már ismerik a Winamp mûködését, azok az XMMS-t is egyszerûnek érzik majd.</p></div><div class=paragraph><p>Mellette az <a class=package href=https://cgit.freebsd.org/ports/tree/audio/mpg123/>audio/mpg123</a> port egy másik, parancssoros MP3 lejátszót kínál fel.</p></div><div class=paragraph><p>Az mpg123 futtatásához paraméterként meg kell adnunk a hangeszközt és lejátszandó MP3 állományt. Ha a hangeszközünk a <span class=filename>/dev/dsp1.0</span> és a <em>IzéMizé-Sláger.mp3</em> nevû MP3 állományt akarjuk rajta lejátszatni, akkor a következõt kell begépelnünk:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># mpg123 -a /dev/dsp1.0 IzéMizé-Sláger.mp3</span>
High Performance MPEG 1.0/2.0/2.5 Audio Player <span class=k>for </span>Layer 1, 2 and 3.
Version 0.59r <span class=o>(</span>1999/Jun/15<span class=o>)</span><span class=nb>.</span> Written and copyrights by Michael Hipp.
Uses code from various people. See <span class=s1>&#39;README&#39;</span> <span class=k>for </span>more!
THIS SOFTWARE COMES WITH ABSOLUTELY NO WARRANTY! USE AT YOUR OWN RISK!

Playing MPEG stream from IzéMizé-Sláger.mp3 ...
MPEG 1.0 layer III, 128 kbit/s, 44100 Hz joint-stereo</code></pre></div></div></div><div class=sect3><h4 id=rip-cd>7.3.2. Sávok lementése CD-rõl<a class=anchor href=#rip-cd></a></h4><div class=paragraph><p>Mielõtt MP3 formátumba tömörítenénk egy CD-t vagy annak egy sávját, a CD-n található audio adatot valahogy le kell tudnunk szedni a merevlemezre. Ezt úgy tehetjük meg, ha a nyers CDDA (CD Digital Audio) adatot WAV formátumú állományokba mentjük.</p></div><div class=paragraph><p>A <a class=package href=https://cgit.freebsd.org/ports/tree/sysutils/cdrtools/>sysutils/cdrtools</a> csomag részeként elérhetõ <code>cdda2wav</code> segédprogrammal tudjuk a CD-ken levõ audio és a hozzájuk tartozó egyéb információkat leszedni.</p></div><div class=paragraph><p>A meghajtóban levõ CD teljes tartalmát (<code>root</code> felhasználóként) a következõ parancs kiadásával lehet (sávonként) különálló WAV állományokba menteni:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># cdda2wav -D 0,1,0 -B</span></code></pre></div></div><div class=paragraph><p>A cdda2wav ismeri az ATAPI (IDE) CD-meghajtókat, használatukhoz a SCSI egység sorszáma helyett az eszköz nevét kell megadni. Tehát például így szedjük le egy IDE-meghajtóról a 7. sávot:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># cdda2wav -D /dev/acd0 -t 7</span></code></pre></div></div><div class=paragraph><p>A <code>-D <em>0,1,0</em></code> a <span class=filename>0,1,0</span> sorszámú SCSI eszközre utal, ami megfelel <code>cdrecord -scanbus</code> parancs eredményének.</p></div><div class=paragraph><p>Az egyes sávok lementéséhez a <code>-t</code> kapcsoló használható:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># cdda2wav -D 0,1,0 -t 7</span></code></pre></div></div><div class=paragraph><p>A példa szerint a zenei CD-rõl a hetedik sávot szedjük le. Egyszerre több sávot, például az elsõtõl a hetedikig, egy tartomány megadásával menthetünk le:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># cdda2wav -D 0,1,0 -t 1+7</span></code></pre></div></div><div class=paragraph><p>A <a href="https://man.freebsd.org/cgi/man.cgi?query=dd&amp;sektion=1&amp;format=html">dd(1)</a> segédprogram is használható ATAPI eszközökön levõ hangsávok kimentéséhez. Ennek lehetõségérõl részletesebben a <a href=./#duplicating-audiocds>Audio CD-k másolása</a>ban olvashatunk.</p></div></div><div class=sect3><h4 id=mp3-encoding>7.3.3. MP3 állományok tömörítése<a class=anchor href=#mp3-encoding></a></h4><div class=paragraph><p>Az MP3 állomány tömörítésére manapság a legtöbben a lame elnevezésû kódolót választják. A portfában a lame az <a class=package href=https://cgit.freebsd.org/ports/tree/audio/lame/>audio/lame</a> helyen található meg.</p></div><div class=paragraph><p>Az elõbb kimentett WAV állományok felhasználásával az alábbi paranccsal tudjuk átalakítani a <span class=filename>audio01.wav</span> állományt <span class=filename>audio01.mp3</span> állománnyá:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># lame -h -b 128 \</span>
<span class=nt>--tt</span> <span class=s2>&#34;Izé dal címe&#34;</span> <span class=se>\</span>
<span class=nt>--ta</span> <span class=s2>&#34;Izé-mizé előadó&#34;</span> <span class=se>\</span>
<span class=nt>--tl</span> <span class=s2>&#34;Izé-mizé album&#34;</span> <span class=se>\</span>
<span class=nt>--ty</span> <span class=s2>&#34;2001&#34;</span> <span class=se>\</span>
<span class=nt>--tc</span> <span class=s2>&#34;Leszedte és tömörítette: Izé&#34;</span> <span class=se>\</span>
<span class=nt>--tg</span> <span class=s2>&#34;Műfaj&#34;</span> <span class=se>\</span>
audio01.wav audio01.mp3</code></pre></div></div><div class=paragraph><p>A 128 kbites tömörítés a gyakorlatban leginkább használt kódolási arány, sokan azonban a sokkal jobb minõségû 160 vagy 192 kbites tömörítést szeretik. Minél nagyobb a kódolási arány, annál több helyet fog foglalni a keletkezõ MP3 állomány - habár a minõsége is jobb lesz. A <code>-h</code> kapcsoló alkalmazásával tudjuk aktivizálni a "jobb minõségû de valamivel lassabb" módot. A <code>--t</code> kezdetû paraméterek ID3 tageket adnak meg, amelyek segítségével az MP3 állományokba rájuk vonatkozó információkat tudunk beágyazni. A tömörítés további beállításairól a lame man oldalán tájékozódhatunk.</p></div></div><div class=sect3><h4 id=mp3-decoding>7.3.4. MP3 állományok kitömörítése<a class=anchor href=#mp3-decoding></a></h4><div class=paragraph><p>Ha MP3 formátumú állományokat szeretnénk audio CD-re írni, akkor ehhez elõször tömörítetlen WAV formátumba kell ezeket alakítanunk. Az XMMS és az mpg123 is egyaránt lehetõséged ad az MP3 állományok kitömörítésére.</p></div><div class=paragraph><p>Lemezre írás az XMMS-sel:</p></div><div class="exampleblock procedure"><div class=content><div class="olist arabic"><ol class=arabic><li><p>Indítsuk el az XMMS alkalmazást.</p></li><li><p>Az XMMS menüjének felhozásához kattinsunk jobb gombbal az ablakjára.</p></li><li><p>Válasszuk az <code>Options</code> almenüben található <code>Preference</code> menüpontot.</p></li><li><p>Változtassuk meg az "Output Plugin" beállítást a "Disk Writer Plugin" értékre.</p></li><li><p>Nyomjunk a <code>Configure</code> gombra.</p></li><li><p>Írjuk be (vagy válasszuk ki a <code>Browse</code> gombbal) a könyvtárat, ahová majd a kitömörített állományok kerülnek.</p></li><li><p>Az eddig megszokottak szerint töltsük be az XMMS-be az MP3 állományt, állítsuk 100%-ra a hangerõt és kapcsoljuk ki a hangszínszabályzót (EQ, equalizer).</p></li><li><p>Nyomjuk le a <code>Play</code> gombot - úgy fog tûnni, mintha az XMMS játszaná az MP3 állományt, de nem hallunk semmit. Ekkor a tartalmát állományba menti.</p></li><li><p>Mikor befejeztük a kitömörítést, ne felejtsük el visszaállítani az "Output Plugin" értékét az alapértelmezettre.</p></li></ol></div></div></div><div class=paragraph><p>Írás a szabványos kimenetre az mpg123-mal:</p></div><div class="exampleblock procedure"><div class=content><div class="olist arabic"><ol class=arabic><li><p>Futtassuk le a <code>mpg123 -s audio01.mp3 > audio01.pcm</code> parancsot.</p></li></ol></div></div></div><div class=paragraph><p>Az XMMS az állományokat WAV formátumban írja, miközben az mpg123 nyers PCM hangadatokat képez belõlük. A cdrecord használata során mind a két formátumból hozhatóak létre audio CD-k. A nyers PCM a <a href="https://man.freebsd.org/cgi/man.cgi?query=burncd&amp;sektion=8&amp;format=html">burncd(8)</a> programmal használható. Amikor WAV állományokkal dolgozunk, minden egyes sáv elején egy apró kattanást hallhatunk: ez a WAV állomány fejléce lesz. A (<a class=package href=https://cgit.freebsd.org/ports/tree/audio/sox/>audio/sox</a> portból vagy csomagból telepíthetõ) SoX segédprogrammal a WAV formátumú állományok fejléce pillanatok alatt eltávolítható:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>% sox <span class=nt>-t</span> wav <span class=nt>-r</span> 44100 <span class=nt>-s</span> <span class=nt>-w</span> <span class=nt>-c</span> 2 track.wav track.raw</code></pre></div></div><div class=paragraph><p>A CD-írók FreeBSD alatti használatával kapcsolatban olvassuk el a <a href=./#creating-cds>Lézeres tárolóeszközök (CD-k) létrehozása és használata</a>t.</p></div></div></div><div class=sect2><h3 id=video-playback>7.4. Videók lejátszása<a class=anchor href=#video-playback></a></h3><div class=paragraph><p>A videolejátszás egy nagyon friss és gyorsan fejlõdõ alkalmazási terület. Legyünk türelmesek, ez nem minden fog annyira könnyen menni, mint a hangok esetében.</p></div><div class=paragraph><p>A kezdéshez nem árt tudnunk, hogy a videokártyánk milyen gyártmányú és milyen chipet használ. Míg az Xorg és az XFree86™ számos különféle videokártyát ismer, csupán töredékükkel lehet jó lejátszási teljesítményt elõhozni. Az X11 futtatása közben az <a href="https://man.freebsd.org/cgi/man.cgi?query=xdpyinfo&amp;sektion=1&amp;format=html">xdpyinfo(1)</a> parancs kiadásával kérdezhetjük le az X szervertõl a kártyánk használatával elérhetõ kiterjesztéseket.</p></div><div class=paragraph><p>Érdemes a kezünk ügyében tartani egy rövidke MPEG formátumú állományt, amellyel majd ki tudjuk próbálni a különféle lejátszókat és azok beállításait. Mivel egyes DVD lejátszók alapértelmezés szerint a <span class=filename>/dev/dvd</span> helyen keresik a lejátszandó DVD eszközt, vagy egyszerûen csak így írták meg ezeket, mindenképpen hasznos lehet, ha szimbolikus linkeket hozunk létre a megfelelõ eszközökre:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># ln -sf /dev/acd0 /dev/dvd</span>
<span class=c># ln -sf /dev/acd0 /dev/rdvd</span></code></pre></div></div><div class=paragraph><p>A <a href="https://man.freebsd.org/cgi/man.cgi?query=devfs&amp;sektion=5&amp;format=html">devfs(5)</a> mûködése miatt azonban ezek a kézzel létrehozott linkek az újraindítás után már nem maradnak meg. A szimbolikus linkeket a rendszer minden egyes indulásakor úgy tudjuk automatikusan létrehozni, hogyha az <span class=filename>/etc/devfs.conf</span> állományba felvesszük az alábbi sort:</p></div><div class="literalblock programlisting"><div class=content><pre>link acd0 dvd
link acd0 rdvd</pre></div></div><div class=paragraph><p>Emellett a DVD-k titkosításának feloldása, mely a DVD-meghajtók speciális funkcióit igényli, a DVD eszközökön írási jogot is igényel.</p></div><div class=paragraph><p>Az X11 osztott memóriát kezelõ felületének gyorsításához javasolt néhány <a href="https://man.freebsd.org/cgi/man.cgi?query=sysctl&amp;sektion=8&amp;format=html">sysctl(8)</a> változó értékének megnövelése is:</p></div><div class="literalblock programlisting"><div class=content><pre>kern.ipc.shmmax=67108864
kern.ipc.shmall=32768</pre></div></div><div class=sect3><h4 id=video-interface>7.4.1. A megjelenítõ képességeinek megállapítása<a class=anchor href=#video-interface></a></h4><div class=paragraph><p>Több különbözõ úton lehet X11 alatt videókat nézni, de ennek tényleges módját igazából a rendelkezésre álló hardver határozza meg. Az itt leírt módszerek által kihozható minõség hardverenként eltérhet. Másodsorban a videók megjelenítése az X11-ben az utóbbi idõben igen nagy hangsúlyt kapott, ezért az Xorg és az XFree86™ minden egyes változatával jelentõsen javulhat a helyzet ezen a téren.</p></div><div class=paragraph><p>A videók megjelenítésére használt gyakori felületek:</p></div><div class="olist arabic"><ol class=arabic><li><p>X11: az X11 normális kimenete osztott memórián keresztül</p></li><li><p>XVideo: az X11 felületének kiterjesztése, ami tetszõleges X11 által kirajzolható objektum esetén támogat videót</p></li><li><p>SDL: a Simple Directmedia Layer</p></li><li><p>DGA: a Direct Graphics Access (közvetlen grafikus hozzáférés)</p></li><li><p>SVGAlib: alacsonyszintû konzolos grafikus réteg</p></li></ol></div><div class=sect4><h5 id=video-interface-xvideo>7.4.1.1. XVideo<a class=anchor href=#video-interface-xvideo></a></h5><div class=paragraph><p>Az Xorg és az XFree86™ 4.X rendelkezik egy <em>XVideo</em> (avagy Xvideo, Xv, xv) elnevezésû kiterjesztéssel, amelyen keresztül egy speciális gyorsítás segítségével a kirajzolható objektumokban közvetlenül meg tudunk jeleníteni videókat. Ezzel a kiterjesztéssel még a gyengébb gépeken is nagyon jó minõségû lejátszást tudunk elérni.</p></div><div class=paragraph><p>A kiterjesztés mûködésérõl az <code>xvinfo</code> parancs kiadásával gyõzõdhetünk meg:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>% xvinfo</code></pre></div></div><div class=paragraph><p>Ha a parancs eredménye ehhez hasonló, akkor a kártyánk támogatja az XVideót:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>X-Video Extension version 2.2
screen <span class=c>#0</span>
  Adaptor <span class=c>#0: &#34;Savage Streams Engine&#34;</span>
    number of ports: 1
    port base: 43
    operations supported: PutImage
    supported visuals:
      depth 16, visualID 0x22
      depth 16, visualID 0x23
    number of attributes: 5
      <span class=s2>&#34;XV_COLORKEY&#34;</span> <span class=o>(</span>range 0 to 16777215<span class=o>)</span>
              client settable attribute
              client gettable attribute <span class=o>(</span>current value is 2110<span class=o>)</span>
      <span class=s2>&#34;XV_BRIGHTNESS&#34;</span> <span class=o>(</span>range <span class=nt>-128</span> to 127<span class=o>)</span>
              client settable attribute
              client gettable attribute <span class=o>(</span>current value is 0<span class=o>)</span>
      <span class=s2>&#34;XV_CONTRAST&#34;</span> <span class=o>(</span>range 0 to 255<span class=o>)</span>
              client settable attribute
              client gettable attribute <span class=o>(</span>current value is 128<span class=o>)</span>
      <span class=s2>&#34;XV_SATURATION&#34;</span> <span class=o>(</span>range 0 to 255<span class=o>)</span>
              client settable attribute
              client gettable attribute <span class=o>(</span>current value is 128<span class=o>)</span>
      <span class=s2>&#34;XV_HUE&#34;</span> <span class=o>(</span>range <span class=nt>-180</span> to 180<span class=o>)</span>
              client settable attribute
              client gettable attribute <span class=o>(</span>current value is 0<span class=o>)</span>
    maximum XvImage size: 1024 x 1024
    Number of image formats: 7
      <span class=nb>id</span>: 0x32595559 <span class=o>(</span>YUY2<span class=o>)</span>
        guid: 59555932-0000-0010-8000-00aa00389b71
        bits per pixel: 16
        number of planes: 1
        <span class=nb>type</span>: YUV <span class=o>(</span>packed<span class=o>)</span>
      <span class=nb>id</span>: 0x32315659 <span class=o>(</span>YV12<span class=o>)</span>
        guid: 59563132-0000-0010-8000-00aa00389b71
        bits per pixel: 12
        number of planes: 3
        <span class=nb>type</span>: YUV <span class=o>(</span>planar<span class=o>)</span>
      <span class=nb>id</span>: 0x30323449 <span class=o>(</span>I420<span class=o>)</span>
        guid: 49343230-0000-0010-8000-00aa00389b71
        bits per pixel: 12
        number of planes: 3
        <span class=nb>type</span>: YUV <span class=o>(</span>planar<span class=o>)</span>
      <span class=nb>id</span>: 0x36315652 <span class=o>(</span>RV16<span class=o>)</span>
        guid: 52563135-0000-0000-0000-000000000000
        bits per pixel: 16
        number of planes: 1
        <span class=nb>type</span>: RGB <span class=o>(</span>packed<span class=o>)</span>
        depth: 0
        red, green, blue masks: 0x1f, 0x3e0, 0x7c00
      <span class=nb>id</span>: 0x35315652 <span class=o>(</span>RV15<span class=o>)</span>
        guid: 52563136-0000-0000-0000-000000000000
        bits per pixel: 16
        number of planes: 1
        <span class=nb>type</span>: RGB <span class=o>(</span>packed<span class=o>)</span>
        depth: 0
        red, green, blue masks: 0x1f, 0x7e0, 0xf800
      <span class=nb>id</span>: 0x31313259 <span class=o>(</span>Y211<span class=o>)</span>
        guid: 59323131-0000-0010-8000-00aa00389b71
        bits per pixel: 6
        number of planes: 3
        <span class=nb>type</span>: YUV <span class=o>(</span>packed<span class=o>)</span>
      <span class=nb>id</span>: 0x0
        guid: 00000000-0000-0000-0000-000000000000
        bits per pixel: 0
        number of planes: 0
        <span class=nb>type</span>: RGB <span class=o>(</span>packed<span class=o>)</span>
        depth: 1
        red, green, blue masks: 0x0, 0x0, 0x0</code></pre></div></div><div class=paragraph><p>Az XVideo nem mindegyik implementációjában vannak jelen a felsorolt formátumok (YUV2, YUV12 stb.), ami viszont néhány lejátszó számára akadályokat jelenthet.</p></div><div class=paragraph><p>Amennyiben viszont ezt látjuk:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>X-Video Extension version 2.2
screen <span class=c>#0</span>
no adaptors present</code></pre></div></div><div class=paragraph><p>Akkor a kártyánk nem rendelkezik XVideo támogatással.</p></div><div class=paragraph><p>Ha az XVideo nem támogatott a kártyánk számára, akkor az csupán csak annyit jelent, hogy a gépünknek nehéz dolga lesz a videók megjelenítéséhez szükséges számítási kapacitás kiszolgálásában. Azonban a videokártyánktól és processzorunktól függõen még így is kielégítõ eredményt tudunk elõcsalni. Ekkor viszont minden bizonnyal érdemes lesz átolvasnunk a <a href=#video-further-reading>Ajánlott olvasmányok</a>ban, miként tudjuk növelni a teljesítményét.</p></div></div><div class=sect4><h5 id=video-interface-SDL>7.4.1.2. A Simple Directmedia Layer<a class=anchor href=#video-interface-SDL></a></h5><div class=paragraph><p>A Simple Directmedia Layer, vagy SDL, eredetileg a Microsoft® Windows®, BeOS és UNIX® közti hordozhatóságot szándékozta megvalósítani, aminek segítségével a hangot és grafikát hatékonyan használni tudó alkalmazások hozhatóak létre. Az SDL által nyújtott réteg a hardver olyan alacsonyszintû absztrakcióját öleli fel, amely gyakran még az X11 felületénél is hatékonyabb.</p></div><div class=paragraph><p>Az SDL a <a class=package href=https://cgit.freebsd.org/ports/tree/devel/sdl12/>devel/sdl12</a> helyen található.</p></div></div><div class=sect4><h5 id=video-interface-DGA>7.4.1.3. Direct Graphics Access (Közvetlen grafikus hozzáférés)<a class=anchor href=#video-interface-DGA></a></h5><div class=paragraph><p>A közvetlen grafikus hozzáférés az X11 egy olyan kiterjesztése, ami lehetõvé teszi a programok számára az X szerver megkerülését és így közvetlenül a videokártya memóriáját képesek elérni. Mivel a megosztás hatékony megvalósításához ez nagyban építkezik alacsonyszintû leképzési mûveletekre, ezért az ilyet használó programokat <code>root</code> felhasználóként kell futtatni.</p></div><div class=paragraph><p>A DGA kiterjesztés a <a href="https://man.freebsd.org/cgi/man.cgi?query=dga&amp;sektion=1&amp;format=html">dga(1)</a> segítségével tesztelhetõ és mérhetõ. A <code>dga</code> parancs kiadása után minden billentyû lenyomására megváltoztatja a képernyõn látható színeket. A kilépéshez a <kbd>q</kbd> billentyût kell lenyomni.</p></div></div></div><div class=sect3><h4 id=video-ports>7.4.2. A videókkal foglalkozó portok és csomagok<a class=anchor href=#video-ports></a></h4><div class=paragraph><p>Ebben a szakaszban a FreeBSD Portgyûjteményébõl a videók lejátszására alkalmas programokat vesszük számba. A videolejátszás nagyon gyorsan fejlõdõ terület, ezért az itt említett különbözõ alkalmazások képességei az itt leírtaktól némileg eltérhetnek.</p></div><div class=paragraph><p>Elõször is fontos tisztában lennünk azzal, hogy számos FreeBSD-n futó videoalkalmazás eredetileg linuxos alkalmazásként indult, és közülük sokan még csak béta minõségûek. Íme a FreeBSD-n is megtalálható videocsomagokkal kapcsolatos néhány olyan gond, amivel esetleg összefuthatunk:</p></div><div class="olist arabic"><ol class=arabic><li><p>Az egyik alkalmazás nem képes visszajátszani olyan állományt, amit egy másik alkalmazás hozott létre.</p></li><li><p>Az alkalmazás nem képes visszajátszani a saját maga által készített állományokat.</p></li><li><p>Ugyanazon alkalmazás két különbözõ gépen, amikor mind a kettõn az adott konfigurációra fordítjuk le, ugyanazt az állományt másképpen játssza vissza.</p></li><li><p>Egy olyan látszólag egyértelmû szûrõ, mint például a kép átméretezése, a hibás átméretezõ rutin miatt nagyon csúnya eredményt produkál.</p></li><li><p>Az alkalmazás gyakran elszáll.</p></li><li><p>A porthoz nem találjuk a dokumentációt, egyedül csak az interneten vagy a port <span class=filename>work</span> könyvtárában van.</p></li></ol></div><div class=paragraph><p>Sok alkalmazás a "linuxizmus" jeleit is hordozza, vagyis gondok adódhatnak abból, hogy a szerzõk az alkalmazások mûködtetéséhez a Linux rendszermag és a különféle terjesztésekben megtalálható módosított szabványos könyvtárak különlegességeit használják ki. Ezeket a portok karbantartói nem mindig észlelik és javítják ki, ami miatt az alábbiak bármikor bekövetkezhetnek:</p></div><div class="olist arabic"><ol class=arabic><li><p>A processzor jellemzõit a <span class=filename>/proc/cpuinfo</span> állományon keresztül állapítják meg.</p></li><li><p>A szálak helytelen használatuk miatt a program befejezõdésekor összeakadnak.</p></li><li><p>Az alkalmazással gyakran együtt használt egyéb alkalmazások még nem nincsenek benne a FreeBSD Portgyûjteményében.</p></li></ol></div><div class=paragraph><p>Az ilyen alkalmazások fejlesztõi a hordozhatóság javításával és a problémák megoldásával kapcsolatban eddig mindig igyekeztek együttmûködni a portok karbantartóival.</p></div><div class=sect4><h5 id=video-mplayer>7.4.2.1. MPlayer<a class=anchor href=#video-mplayer></a></h5><div class=paragraph><p>Az MPlayer az utóbbi idõben felbukkant, gyorsan fejlõdõ videolejátszó. Fejlesztõinek célja a sebesség és rugalmasság a Linux, illetve más UNIX® rendszereken. A kezdeményezés abból fakadt, hogy a fejlesztés mögött álló csapat alapítójának elege lett az akkoriban elérhetõ lejátszók teljesítményébõl. Mondhatnánk, hogy ez a program feláldozta a grafikus felületet az áramvonalas kialakításért, azonban ha hozzászokunk a parancssori beállításokhoz és a billentyûkön keresztüli vezérléshez, remekül mûködik.</p></div><div class=sect5><h6 id=video-mplayer-building>7.4.2.1.1. Az MPlayer lefordítása<a class=anchor href=#video-mplayer-building></a></h6><div class=paragraph><p>Az MPlayer a <a class=package href=https://cgit.freebsd.org/ports/tree/multimedia/mplayer/>multimedia/mplayer</a> helyen található. A program a fordítási folyamat során elvégez számos hardverellenõrzést, aminek eredményeképpen az egyik rendszeren fordított program nem vihetõ a másikra. Ezért különösen fontos portból fordítani és nem pedig bináris csomagot használni. Mindezek mellett a <span class=filename>Makefile</span> állományban még számos, a <code>make</code> parancsnak a fordítás megkezdésekor átadható beállítást találhatunk:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># cd /usr/ports/multimedia/mplayer</span>
<span class=c># make</span>
N - O - T - E

Take a careful look into the Makefile <span class=k>in </span>order
to learn how to tune mplayer towards you personal preferences!
For example,
make WITH_GTK1
builds MPlayer with GTK1-GUI support.
If you want to use the GUI, you can either <span class=nb>install</span>
/usr/ports/multimedia/mplayer-skins
or download official skin collections from
http://www.mplayerhq.hu/homepage/dload.html</code></pre></div></div><div class=paragraph><p>Az üzenet fordítása:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>F - I - G - Y - E - L - E - M

Az mplayert személyes igényeinkhez úgy tudjuk igazítani, ha
figyelmesen átnézzük a Makefile állományt!  Például a WITH_GTK1
megadásával az MPlayer GTK1 alapú grafikus felülettel jön létre.
A grafikus felület használatához telepítenünk kell a
/usr/ports/multimedia/mplayer-skins portot is, vagy letölteni a
hivatalos skingyűjteményt a http://www.mplayerhq.hu/homepage/dload.html
oldalról.</code></pre></div></div><div class=paragraph><p>A port alapbeállításai a legtöbb felhasználó számára megfelelõek, habár az Xvid kódek használatához meg kell adnunk a <code>WITH_XVID</code> beállítást. Rajta kívül még az alapértelmezett DVD eszközt is érdemes megadni a <code>WITH_DVD_DEVICE</code> beállítással, amelynek alapértéke a <span class=filename>/dev/acd0</span>.</p></div><div class=paragraph><p>A leírás elkészítésének idõpontjában az MPlayer portja létrehozza a HTML dokumentációt és a két végrehajtható állományt: az <code>mplayer</code> lejátszót és a videók újrakódolásáért felelõs <code>mencoder</code> segédprogramot.</p></div><div class=paragraph><p>Az MPlayer HTML dokumentációja nagyon közlékeny, és ha az olvasó nem találná valamelyik videohardver vagy felület leírását ebben a fejezetben, akkor ez a dokumentáció mindenképpen hasznos olvasnivalónak bizonyul. Ha a UNIX®-ok alatt elérhetõ videotámogatás leírását keressük, határozottan megéri idõt szánni az MPlayer dokumentációjának alapos végigolvasására.</p></div></div><div class=sect5><h6 id=video-mplayer-using>7.4.2.1.2. Az MPlayer használata<a class=anchor href=#video-mplayer-using></a></h6><div class=paragraph><p>Az MPlayer használatához a felhasználói könyvtárunkban rendelkeznünk kell egy <span class=filename>.mplayer</span> elnevezésû könyvtárral. Ezt a következõ paranccsal tudjuk létrehozni:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>% <span class=nb>cd</span> /usr/ports/multimedia/mplayer
% make install-user</code></pre></div></div><div class=paragraph><p>Az <code>mplayer</code> parancssori paraméterei a hozzá tartozó man oldalon találhatóak meg, valamint mindezek a HTML dokumentációban még részletesebben. Ebben a szakaszban csupán néhányukat mutatjuk be.</p></div><div class=paragraph><p>Egy állomány, mint például a <span class=filename>tesztvideo.avi</span>, a <code>-vo</code> beállításával játszható le a különbözõ felületeken:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>% mplayer <span class=nt>-vo</span> xv tesztvideo.avi</code></pre></div></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>% mplayer <span class=nt>-vo</span> sdl tesztvideo.avi</code></pre></div></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>% mplayer <span class=nt>-vo</span> x11 tesztvideo.avi</code></pre></div></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># mplayer -vo dga tesztvideo.avi</span></code></pre></div></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># mplayer -vo &#39;sdl:dga&#39; tesztvideo.avi</span></code></pre></div></div><div class=paragraph><p>Érdemes az itt felsorolt konfigurációk mindegyikét kipróbálni, mivel az egymáshoz mért teljesítményük rengeteg tényezõn múlik, de közülük talán maga a hardver a legjelentõsebb.</p></div><div class=paragraph><p>A DVD-k lejátszásához cseréljük ki a <span class=filename>tesztvideo.avi</span> paramétert a <code>dvd://<em>N</em> -dvd-device <em>ESZKÖZ</em></code> paraméterekkel, ahol az <em>N</em> a lejátszandó fejezet sorszáma, valamint az <span class=filename>ESZKÖZ</span> a DVD-hez tartozó eszközleíró. Például így tudjuk elkezdeni <span class=filename>/dev/dvd</span> eszközrõl a 3. fejezet lejátszását:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># mplayer -vo xv dvd://3 -dvd-device /dev/dvd</span></code></pre></div></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>A port fordítása során a <code>WITH_DVD_DEVICE</code> paraméter segítségével megadható az alapértelmezett DVD eszköz, amely alapból a <span class=filename>/dev/acd0</span>. Errõl többet a port <span class=filename>Makefile</span> állományában találhatunk.</p></div></td></tr></tbody></table></div><div class=paragraph><p>A leállításhoz, szüneteltetéshez, továbblépéshez és többi hasonló funkcióhoz tartozó billentyûket a <code>mplayer -h</code> parancs kimenetébõl vagy a man oldal elolvasásából deríthetjük ki.</p></div><div class=paragraph><p>A lejátszáshoz tartozó néhány viszonylag fontos beállítás: az <code>-fs -zoom</code> teljesképernyõs módra vált, valamint a <code>-framedrop</code> segít növeli a teljesítményt.</p></div><div class=paragraph><p>A lejátszáskor kiadandó parancs túlburjánzását el tudjuk kerülni, ha létrehozunk egy <span class=filename>.mplayer/config</span> állományt és itt állítjuk be a gyakori opciókat:</p></div><div class="literalblock programlisting"><div class=content><pre>vo=xv
fs=yes
zoom=yes</pre></div></div><div class=paragraph><p>Végezetül megemlítjük, hogy az <code>mplayer</code> segítségével a DVD-n található fejezeteket ki tudjuk menteni <span class=filename>.vob</span> állományokba. A DVD második fejezetének kimentéséhez gépeljük be ezt:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># mplayer -dumpstream -dumpfile out.vob dvd://2 -dvd-device /dev/dvd</span></code></pre></div></div><div class=paragraph><p>A parancs eredményeképpen keletkezõ <span class=filename>out.vob</span> állomány formátuma MPEG lesz, amit a fejezetben bemutatott további csomagokkal tudunk feldolgozni.</p></div></div><div class=sect5><h6 id=video-mencoder>7.4.2.1.3. mencoder<a class=anchor href=#video-mencoder></a></h6><div class=paragraph><p>A <code>mencoder</code> használatának megkezdése elõtt javasolt alaposan beleásnunk magunkat a HTML dokumentációba és megismerkednünk az alapvetõ beállításaival. Van külön man oldala is, azonban a HTML leírás nélkül önmagában ez nem túl sokat ér. Megszámlálhatatlan úton és módon növelhetõ benne a minõség, csökkenthetõ a kódolási arány, változtatható a formátum, és ezen apró finomságok felelõsek a jó vagy éppen a rossz teljesítményért. A témába néhány példa bemutatásával igyekszünk beavatni az olvasót. Elõször vegyünk egy egyszerû másolást:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>% mencoder bemenő.avi <span class=nt>-oac</span> copy <span class=nt>-ovc</span> copy <span class=nt>-o</span> eredmény.avi</code></pre></div></div><div class=paragraph><p>A parancssori paraméterek helytelen kombinációja olyan állományokat eredményezhet, amelyeket még maga az <code>mplayer</code> sem képes lejátszani. Ezért ha csak le akarunk szedni egy állományt, akkor maradjunk meg az <code>mplayer</code> <code>-dumpfile</code> opciójánál.</p></div><div class=paragraph><p>A <span class=filename>bemenõ.avi</span> állományt MPEG4 video- és MPEG3 hangtömörítéssel (amihez kell majd a <a class=package href=https://cgit.freebsd.org/ports/tree/audio/lame/>audio/lame</a>) így tudjuk lekódolni:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>% mencoder bemenõ.avi <span class=nt>-oac</span> mp3lame <span class=nt>-lameopts</span> <span class=nv>br</span><span class=o>=</span>192 <span class=se>\</span>
	 <span class=nt>-ovc</span> lavc <span class=nt>-lavcopts</span> <span class=nv>vcodec</span><span class=o>=</span>mpeg4:vhq <span class=nt>-o</span> eredmény.avi</code></pre></div></div><div class=paragraph><p>Ezzel az <code>mplayer</code> és <code>xine</code> programok számára is egyaránt lejátszható állomány jön létre.</p></div><div class=paragraph><p>A DVD fejezeteit úgy tudjuk közvetlenül kódolni, ha a parancssorban kicseréljük a <span class=filename>bemenõ.avi</span> állományt az <code>dvd://1 -dvd-device /dev/dvd</code> beállításra, illetve ha a programot <code>root</code> felhasználóként futtatjuk. De mivel elsõre általában ritkán vagyunk elégedettek a kódolással, érdemes elõször inkább lementeni az egész fejezetet egy állományba, majd azon dolgozni.</p></div></div></div><div class=sect4><h5 id=video-xine>7.4.2.2. A xine videolejátszó<a class=anchor href=#video-xine></a></h5><div class=paragraph><p>A xine egy széles hatókörû projekt, amelynek nem csak az a célja, hogy egy "mindenes" videolejátszó alkalmazást fejlesszenek, hanem az is, hogy újrahasznosítható függvénykönyvtárakat és egy moduláris felépítésû programot hozzanak létre, amely kiegészítûkkel bûvíthetû. A <a class=package href=https://cgit.freebsd.org/ports/tree/multimedia/xine/>multimedia/xine</a> helyen portként, valamint csomagként is elérhetõ.</p></div><div class=paragraph><p>A xine itt-ott még valamelyest durva, de mindenképpen egy dicséretes kezdeményezés. A xine a gyakorlatban erõs processzort és mellé gyors videokártyát kíván, vagy pedig az XVideo kiterjesztés támogatását. A grafikus felhasználói felülete ugyan használható, de még kicsit esetlen.</p></div><div class=paragraph><p>Az írás pillanatában a xine mellé még nem kapunk olyan modult, amivel le tudnánk játszani a CSS kódolású DVD-ket. Léteznek azonban olyan külsõs modulok, amelyekkel meg lehet valósítani ezt a feladatot, azonban a FreeBSD Portgyûjteményében ezeket még nem találhatjuk meg.</p></div><div class=paragraph><p>A xine az MPlayerhez képes többet tesz a felhasználóért, azonban ezzel egyidõben el is veszi tõle a finomhangolás lehetõségét. A xine legjobban az XVideót ismerõ felületeken teljesít.</p></div><div class=paragraph><p>A xine alapértelmezés szerint grafikus felülettel indul, ahol a menük segítségével tudunk megnyitni egy adott állományt:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>% xine</code></pre></div></div><div class=paragraph><p>Vagy a grafikus felület használata nélkül kiadhatjuk közvetlenül is az állomány lejátszását:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>% xine <span class=nt>-g</span> <span class=nt>-p</span> kedvencmozim.avi</code></pre></div></div></div><div class=sect4><h5 id=video-ports-transcode>7.4.2.3. A transcode<a class=anchor href=#video-ports-transcode></a></h5><div class=paragraph><p>A transcode nem egy újabb lejátszó, hanem a video- és audio állományok újratömörítésére használható programok gyûjteménye. A transcode segítségével a szabványos be- és kimeneten keresztül parancssoros programokkal képesek vagyunk videoállományokat összefûzni, megjavítani.</p></div><div class=paragraph><p>A <a class=package href=https://cgit.freebsd.org/ports/tree/multimedia/transcode/>multimedia/transcode</a> port fordítása során temérdek beállítást adhatunk meg, amelyek közül az alábbi parancsban foglaljuk össze az általunk javasolandókat:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># make WITH_OPTIMIZED_CFLAGS=yes WITH_LIBA52=yes WITH_LAME=yes WITH_OGG=yes \</span>
<span class=nv>WITH_MJPEG</span><span class=o>=</span><span class=nb>yes</span> <span class=nt>-DWITH_XVID</span><span class=o>=</span><span class=nb>yes</span></code></pre></div></div><div class=paragraph><p>Ezek a beállítások a legtöbb felhasználó számára elegendõek.</p></div><div class=paragraph><p>A <code>transcode</code> képességeinek illusztrálásához lássunk egy példát, amiben megmutatjuk, hogyan kell egy DivX állományt PAL szabványú MPEG-1 formátumú (PAL VCD) állománnyá alakítani:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>% transcode <span class=nt>-i</span> bemenõ.avi <span class=nt>-V</span> <span class=nt>--export_prof</span> vcd-pal <span class=nt>-o</span> output_vcd
% mplex <span class=nt>-f</span> 1 <span class=nt>-o</span> eredmény_vcd.mpg eredmény_vcd.m1v eredmény_vcd.mpa</code></pre></div></div><div class=paragraph><p>Az eredményül keletkezõ <span class=filename>eredmény_vcd.mpg</span> MPEG állomány akár már játszható is MPlayerrel. Ha az állományt kiírjuk egy írható CD-re, akkor ezzel video CD-t is létre tudunk hozni, amihez viszont szükségünk van mind a <a class=package href=https://cgit.freebsd.org/ports/tree/multimedia/vcdimager/>multimedia/vcdimager</a> és <a class=package href=https://cgit.freebsd.org/ports/tree/sysutils/cdrdao/>sysutils/cdrdao</a> programokra.</p></div><div class=paragraph><p>A <code>transcode</code> parancsnak van saját man oldala, azonban ehelyett a <a href=http://www.transcoding.org/cgi-bin/transcode>transcode wiki</a>ben érdemes inkább további információkat és példákat keresni.</p></div></div></div><div class=sect3><h4 id=video-further-reading>7.4.3. Ajánlott olvasmányok<a class=anchor href=#video-further-reading></a></h4><div class=paragraph><p>A FreeBSD-hez tartozó videoszoftverek nagyon gyorsan fejlõdnek. Könnyen elképzelhetõ, hogy az imént tárgyalt problémák legtöbbje a közeljövõben hamarosan megoldódik. Addig viszont bárkinek, aki a legtöbbet szeretné kihozni a FreeBSD audio- és video lehetõségeibõl, rengeteg leírás és dokumentáció elolvasása alapján kell összecsiszolnia a különbözõ beállításokat, és csak néhány alkalmazás mellett érdemes kitartania. Ebben a szakaszban igyekszünk segíteni az olvasónak megtalálni az ilyen jellegû információkat.</p></div><div class=paragraph><p>Az <a href=http://www.mplayerhq.hu/DOCS/>MPlayer dokumentációja</a> szakmai szempontból igen közlékeny. Ezt mindenkinek érdemes elolvasnia, aki a késõbbiekben magasabb szakmai szinten akar foglalkozni a UNIX®-os videózással. Az MPlayer levelezési listája viszont alig tolerálja a dokumentációt rendesen el nem olvasó emberek kérdéseit, ezért minden egyes hiba bejelentése elõtt lehetõleg rendesen nézzük át a dokumentáció odavágó részeit.</p></div><div class=paragraph><p>A <a href=http://dvd.sourceforge.net/xine-howto/en_GB/html/howto.html>xine HOGYAN</a> egyik külön fejezetében az összes lejátszó esetén érvényesíthetõ teljesítménynövelési módszereket mutat be.</p></div><div class=paragraph><p>Végül íme néhány ígéretes alkalmazás, amelyeket érdemes kipróbálnunk:</p></div><div class=ulist><ul><li><p><a href=http://avifile.sourceforge.net/>Avifile</a>, ami egyben a <a class=package href=https://cgit.freebsd.org/ports/tree/multimedia/avifile/>multimedia/avifile</a> port</p></li><li><p><a href=http://www.dtek.chalmers.se/groups/dvd/>Ogle</a>, ami a <a class=package href=https://cgit.freebsd.org/ports/tree/multimedia/ogle/>multimedia/ogle</a> port</p></li><li><p><a href=http://xtheater.sourceforge.net/>Xtheater</a></p></li><li><p><a class=package href=https://cgit.freebsd.org/ports/tree/multimedia/dvdauthor/>multimedia/dvdauthor</a>, egy nyílt forráskódú DVD-tartalom szerkesztõ</p></li></ul></div></div></div><div class=sect2><h3 id=tvcard>7.5. TV kártyák beállítása<a class=anchor href=#tvcard></a></h3><div class=sect3><h4 id=_bevezetés>7.5.1. Bevezetés<a class=anchor href=#_bevezetés></a></h4><div class=paragraph><p>A TV kártyák segítségével kábeles vagy antennás televízióadásokat tudunk nézni a számítógépünkön. A legtöbbjük RCA vagy S-video bemenettel rendelkezik, valamint néhányukon még FM rádiókészülék is megtalálható.</p></div><div class=paragraph><p>A FreeBSD a <a href="https://man.freebsd.org/cgi/man.cgi?query=bktr&amp;sektion=4&amp;format=html">bktr(4)</a> meghajtón keresztül a Brooktree Bt848/849/878/879, illetve a Conexant CN-878/Fusion 878a típusú, PCI-os videorögzító chipeket ismeri. Ügyelnünk kell arra, hogy a kártyánkon levõ vevõkészülék is használható legyen, amit pedig a <a href="https://man.freebsd.org/cgi/man.cgi?query=bktr&amp;sektion=4&amp;format=html">bktr(4)</a> man oldalán megtalálható támogatott eszközök listájából ellenõrizhetünk.</p></div></div><div class=sect3><h4 id=_a_meghajtó_beállítása>7.5.2. A meghajtó beállítása<a class=anchor href=#_a_meghajtó_beállítása></a></h4><div class=paragraph><p>A kártyánk használatához be kell töltenünk a <a href="https://man.freebsd.org/cgi/man.cgi?query=bktr&amp;sektion=4&amp;format=html">bktr(4)</a> meghajtót, ami csupán annyiból áll, hogy a <span class=filename>/boot/loader.conf</span> állományhoz hozzáadunk egy ilyen sort:</p></div><div class="literalblock programlisting"><div class=content><pre>bktr_load=&#34;YES&#34;</pre></div></div><div class=paragraph><p>Másik lehetõségünk, ha a TV kártya támogatását statikusan beleépítjük a rendszermagba. Ha ezt a megoldást választjuk, a következõ sorokat kell elhelyeznünk a rendszermag beállításait tartalmazó állományba:</p></div><div class="literalblock programlisting"><div class=content><pre>device	 bktr
device	iicbus
device	iicbb
device	smbus</pre></div></div><div class=paragraph><p>A fentebb látható egyéb eszközök megadása azért szükséges, mert a kártya részegységei egy I2C buszon csatlakoznak egymáshoz. Miután beillesztettük a szükséges változtatásokat, fordítsuk le és telepítsük az új rendszermagot.</p></div><div class=paragraph><p>A támogatás hozzáadása után újra kell indítanunk a számítógépünket. A rendszerindítási folyamat során meg kell jelennie a TV kártyánknak is, valahogy így:</p></div><div class="literalblock programlisting"><div class=content><pre>bktr0: &lt;BrookTree 848A&gt; mem 0xd7000000-0xd7000fff irq 10 at device 10.0 on pci0
iicbb0: &lt;I2C bit-banging driver&gt; on bti2c0
iicbus0: &lt;Philips I2C bus&gt; on iicbb0 master-only
iicbus1: &lt;Philips I2C bus&gt; on iicbb0 master-only
smbus0: &lt;System Management Bus&gt; on bti2c0
bktr0: Pinnacle/Miro TV, Philips SECAM tuner.</pre></div></div><div class=paragraph><p>Természetesen a fenti üzenetek az aktuális hardvereszközünknek megfelelõen némileg eltérhetnek. Ellenõrizzük, hogy a vevõkészüléket helyesen ismerte-e fel a rendszer. Ha nem sikerült volna, akkor a <a href="https://man.freebsd.org/cgi/man.cgi?query=sysctl&amp;sektion=8&amp;format=html">sysctl(8)</a> és a rendszermag beállításai segítségével még mindig van lehetõségünk állítani rajta. Például, ha egy Philips SECAM vevõkészüléket akarunk beállítani, akkor a rendszermag beállításaihoz még hozzá kell adni a következõ sort:</p></div><div class="literalblock programlisting"><div class=content><pre>options OVERRIDE_TUNER=6</pre></div></div><div class=paragraph><p>vagy erre közvetlenül használhatjuk a <a href="https://man.freebsd.org/cgi/man.cgi?query=sysctl&amp;sektion=8&amp;format=html">sysctl(8)</a> programot is:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># sysctl hw.bt848.tuner=6</span></code></pre></div></div><div class=paragraph><p>A <a href="https://man.freebsd.org/cgi/man.cgi?query=bktr&amp;sektion=4&amp;format=html">bktr(4)</a> man oldalán és a <span class=filename>/usr/src/sys/conf/NOTES</span> állományban megtalálhatjuk a többi beállítás részletes leírását is.</p></div></div><div class=sect3><h4 id=_hasznos_alkalmazások>7.5.3. Hasznos alkalmazások<a class=anchor href=#_hasznos_alkalmazások></a></h4><div class=paragraph><p>A TV kártyánk tényleges használatához azonban még a következõ alkalmazások valamelyikét is telepítenünk kell:</p></div><div class=ulist><ul><li><p>A <a class=package href=https://cgit.freebsd.org/ports/tree/multimedia/fxtv/>multimedia/fxtv</a> használatával ablakban tévézhetünk, valamint lehetõségünk van kép/audio/video kimentésére is.</p></li><li><p>A <a class=package href=https://cgit.freebsd.org/ports/tree/multimedia/xawtv/>multimedia/xawtv</a> az fxtv-hez hasonló lehetõségekkel bíró tévénézõ alkalmazás.</p></li><li><p>A <a class=package href=https://cgit.freebsd.org/ports/tree/misc/alevt/>misc/alevt</a> dekódolja és megjeleníti a mûsorhoz kapcsolódó Videotex/Teletext üzeneteket.</p></li><li><p>Az <a class=package href=https://cgit.freebsd.org/ports/tree/audio/xmradio/>audio/xmradio</a> segítségével az egyes TV kártyákon megtalálható FM rádiókészülékeket tudjuk használatba venni.</p></li><li><p>Az <a class=package href=https://cgit.freebsd.org/ports/tree/audio/wmtune/>audio/wmtune</a> a rádióvevõkhöz használható hasznos grafikus alkalmazás.</p></li></ul></div><div class=paragraph><p>Ebben a témában a FreeBSD Portgyûjteményében további érdekes alkalmazások találhatóak még.</p></div></div><div class=sect3><h4 id=_hibakeresés>7.5.4. Hibakeresés<a class=anchor href=#_hibakeresés></a></h4><div class=paragraph><p>Ha bármilyen gond adódna a TV kártyánkkal kapcsolatosan, akkor elõször mindenképpen érdemes megnézni, hogy a rajta levõ videorögzítõ chipet és vevõkészüléket a <a href="https://man.freebsd.org/cgi/man.cgi?query=bktr&amp;sektion=4&amp;format=html">bktr(4)</a> meghajtó ténylegesen ismeri-e, illetve hogy jól állítottuk-e be. A TV kártyákra irányuló különféle egyéb kérdések és segítség tekintetében érdemes lehet még levelet küldeni a <a href=https://lists.FreeBSD.org/subscription/freebsd-multimedia>FreeBSD multimedia levelezési lista</a> címére is.</p></div></div></div><div class=sect2><h3 id=scanners>7.6. Lapolvasók<a class=anchor href=#scanners></a></h3><div class=sect3><h4 id=_bevezetés_2>7.6.1. Bevezetés<a class=anchor href=#_bevezetés_2></a></h4><div class=paragraph><p>A FreeBSD lapolvasókhoz a SANE (Scanner Access Now Easy) elnevezésû API (alkalmazásfejlesztõi felület) segítségével képes hozzáférni, amelyet a Portgyûjteményben találhatunk meg. A lapolvasást végzõ hardvereszközök használatához a FreeBSD a SANE mellett még néhány eszközmeghajtóra is támaszkodik.</p></div><div class=paragraph><p>A FreeBSD egyaránt ismeri az SCSI és USB csatlakoztatású lapolvasókat is. Még mielõtt nekikezdenénk a lapolvasó beállításához, bizonyosodjuk meg róla, hogy a SANE támogatja. A SANE <a href=http://www.sane-project.org/sane-supported-devices.html>által ismert eszközök</a> felsorolásában ellenõrizhetjük a lapolvasónk támogatottságának állapotát. A FreeBSD 8.<em>X</em> elõtti kiadásaiban ezenkívül még a <a href="https://man.freebsd.org/cgi/man.cgi?query=uscanner&amp;sektion=4&amp;format=html">uscanner(4)</a> man oldalon is láthatjuk az ismert USB-s lapolvasók listáját.</p></div></div><div class=sect3><h4 id=_a_rendszermag_beállítása>7.6.2. A rendszermag beállítása<a class=anchor href=#_a_rendszermag_beállítása></a></h4><div class=paragraph><p>A korábbiak értelmében tehát mind a SCSI, mind pedig a USB felületen csatlakozó eszközök támogatottak. A lapolvasónknak megfelelõen eltérõ eszközmeghajtók szükségesek.</p></div><div class=sect4><h5 id=scanners-kernel-usb>7.6.2.1. Beállítás USB felületen<a class=anchor href=#scanners-kernel-usb></a></h5><div class=paragraph><p>A <span class=filename>GENERIC</span> rendszermag alapértelmezés szerint tartalmazza az USB-s lapolvasók használatához szükséges eszközmeghajtókat. Ha valamiért azonban mégis saját rendszermagot akarunk használni, akkor ne felejtsük el ellenõrizni, hogy a rendszermag beállításai között megtalálhatóak a következõ sorok:</p></div><div class="literalblock programlisting"><div class=content><pre>device usb
device uhci
device ohci
device ehci</pre></div></div><div class=paragraph><p>A FreeBSD 8.<em>X</em> elõtti kiadásaiban még a következõ sorra is szükségünk lesz:</p></div><div class="literalblock programlisting"><div class=content><pre>device uscanner</pre></div></div><div class=paragraph><p>A FreeBSD ezen változataiban a <a href="https://man.freebsd.org/cgi/man.cgi?query=uscanner&amp;sektion=4&amp;format=html">uscanner(4)</a> eszközmeghajtón keresztül tudjuk használni az USB csatolóval rendelkezõ lapolvasókat. A FreeBSD 8.0 változatától kezdõdõen pedig ehhez a <a href="https://man.freebsd.org/cgi/man.cgi?query=libusb&amp;sektion=3&amp;format=html">libusb(3)</a> függvénykönyvtár nyújt közvetlen támogatást.</p></div><div class=paragraph><p>A megfelelõen elõkészített rendszermag elindítása után csatlakoztassuk az USB-s lapolvasónkat. Ez a sor fog megjelenni a rendszer üzenetpufferében (<a href="https://man.freebsd.org/cgi/man.cgi?query=dmesg&amp;sektion=8&amp;format=html">dmesg(8)</a>):</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>ugen0.2: &lt;EPSON&gt; at usbus0</code></pre></div></div><div class=paragraph><p>Vagy FreeBSD 7.<em>X</em> rendszerek esetében:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>uscanner0: EPSON EPSON Scanner, rev 1.10/3.02, addr 2</code></pre></div></div><div class=paragraph><p>Ezek az üzenetek elárulják nekünk, hogy a lapolvasóhoz mostantól a használt FreeBSD verziótól függõen a <span class=filename>/dev/ugen0.2</span> vagy a <span class=filename>/dev/uscanner0</span> eszközleíró tartozik. A fenti példában egy EPSON Perfection® 1650 típusú USB lapolvasót láthatunk.</p></div></div><div class=sect4><h5 id=_beállítás_scsi_felületen>7.6.2.2. Beállítás SCSI felületen<a class=anchor href=#_beállítás_scsi_felületen></a></h5><div class=paragraph><p>Ha a lapolvasónk SCSI felületen csatlakozik, fontos tisztában lennünk azzal, hogy pontosan milyen SCSI-vezérlõn keresztül is érhetjük el, ugyanis a rajta található SCSI chipkészletnek megfelelõen kell majd hangolnunk a rendszermag beállításait. A <span class=filename>GENERIC</span> rendszermag alapból ismeri a leggyakrabban elõforduló SCSI-vezérlõket. Mindenképpen olvassuk át a <span class=filename>NOTES</span> nevû állományt és adjuk hozzá a rendszermag beállításaihoz a megfelelõ sort. A SCSI-kártya meghajtóján kívül még az alábbi beállításokat is meg kell adnunk a rendszermagunk számára:</p></div><div class="literalblock programlisting"><div class=content><pre>device scbus
device pass</pre></div></div><div class=paragraph><p>Ahogy sikerült a rendszermagot sikeresen lefordítani és telepíteni, a rendszer indulása során az üzenetpufferben már láthatjuk is a felismert eszközt:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>pass2 at aic0 bus 0 target 2 lun 0
pass2: &lt;AGFA SNAPSCAN 600 1.10&gt; Fixed Scanner SCSI-2 device
pass2: 3.300MB/s transfers</code></pre></div></div><div class=paragraph><p>Ha a rendszer indulásakor még nem kapcsoltuk volna be a lapolvasónkat, a <a href="https://man.freebsd.org/cgi/man.cgi?query=camcontrol&amp;sektion=8&amp;format=html">camcontrol(8)</a> parancs segítségével késõbb külön kérhetjük a SCSI buszon található eszközök újbóli felderítését:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># camcontrol rescan all</span>
Re-scan of bus 0 was successful
Re-scan of bus 1 was successful
Re-scan of bus 2 was successful
Re-scan of bus 3 was successful</code></pre></div></div><div class=paragraph><p>Ekkor a lapolvasó megjelenik a SCSI eszközök felsorolásában:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># camcontrol devlist</span>
&lt;IBM DDRS-34560 S97B&gt;              at scbus0 target 5 lun 0 <span class=o>(</span>pass0,da0<span class=o>)</span>
&lt;IBM DDRS-34560 S97B&gt;              at scbus0 target 6 lun 0 <span class=o>(</span>pass1,da1<span class=o>)</span>
&lt;AGFA SNAPSCAN 600 1.10&gt;           at scbus1 target 2 lun 0 <span class=o>(</span>pass3<span class=o>)</span>
&lt;PHILIPS CDD3610 CD-R/RW 1.00&gt;     at scbus2 target 0 lun 0 <span class=o>(</span>pass2,cd0<span class=o>)</span></code></pre></div></div><div class=paragraph><p>A SCSI eszközökrõl további leírásokat a <a href="https://man.freebsd.org/cgi/man.cgi?query=scsi&amp;sektion=4&amp;format=html">scsi(4)</a> és <a href="https://man.freebsd.org/cgi/man.cgi?query=camcontrol&amp;sektion=8&amp;format=html">camcontrol(8)</a> man oldalakon találhatunk.</p></div></div></div><div class=sect3><h4 id=_a_sane_beállítása>7.6.3. A SANE beállítása<a class=anchor href=#_a_sane_beállítása></a></h4><div class=paragraph><p>A SANE rendszere két részre oszlik: a backendekre (<a class=package href=https://cgit.freebsd.org/ports/tree/graphics/sane-backends/>graphics/sane-backends</a>) és a frontendekre (<a class=package href=https://cgit.freebsd.org/ports/tree/graphics/sane-frontends/>graphics/sane-frontends</a>). Ezek közül maguk a backendek szolgáltatják a lapolvasó hozzáférhetõségét. A SANE által <a href=http://www.sane-project.org/sane-supported-devices.html>ismert eszközeinek</a> listájából kifürkészhetjük, hogy lapolvasónkat melyik backenden keresztül érhetjük el. Az eszköz megfelelõ használatához döntõ fontosságú megállapítani a hozzá tartozó backendet. A frontendek között találjuk meg a lapolvasást felügyelõ grafikus felületeket (mint például az xscanimage).</p></div><div class=paragraph><p>Elsõként telepítsük a <a class=package href=https://cgit.freebsd.org/ports/tree/graphics/sane-backends/>graphics/sane-backends</a> portot vagy csomagot. Ezután ellenõrizzük, hogy a SANE felismeri a lapolvasót, és ehhez adjuk ki a <code>sane-find-scanner</code> parancsot:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># sane-find-scanner -q</span>
found SCSI scanner <span class=s2>&#34;AGFA SNAPSCAN 600 1.10&#34;</span> at /dev/pass3</code></pre></div></div><div class=paragraph><p>A kimenetében jelzi a felületet, amin a lapolvasó csatlakozik, valamint a hozzá tartozó eszközleírót. A gyártó neve és a termék típusa nem minden esetben jelenik meg, de ez nem is annyira fontos.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Némely USB-s lapolvasók esetén még egy firmware-t is be kell töltenünk, amirõl bõvebben a backendhez tartozó man oldalokon olvashatunk. Ajánlott még elolvasni a <a href="https://man.freebsd.org/cgi/man.cgi?query=sane-find-scanner&amp;sektion=1&amp;format=html">sane-find-scanner(1)</a> és <a href="https://man.freebsd.org/cgi/man.cgi?query=linprocfs&amp;sektion=7&amp;format=html">linprocfs(7)</a> man oldalakat is.</p></div></td></tr></tbody></table></div><div class=paragraph><p>Most pedig nézzük meg, hogy vajon a frontend is be tudja-e azonosítani a lapolvasónkat. Alapértelmezés szerint a SANE backendjéhez tartozik még egy <a href="https://man.freebsd.org/cgi/man.cgi?query=sane&amp;sektion=1&amp;format=html">sane(1)</a> nevû segédprogram is, aminek segítségével listázni tudjuk a használható eszközöket és képeket tudunk beolvasni parancssorból. Közülük a <code>-L</code> kapcsoló listáz:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># scanimage -L</span>
device <span class=sb>`</span>snapscan:/dev/pass3<span class=s1>&#39; is a AGFA SNAPSCAN 600 flatbed scanner</span></code></pre></div></div><div class=paragraph><p>Vagy ha a <a href=#scanners-kernel-usb>Beállítás USB felületen</a>ban szereplõ USB lapolvasóval nézzük:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># scanimage -L</span>
device <span class=s1>&#39;epson2:libusb:/dev/usb:/dev/ugen0.2&#39;</span> is a Epson GT-8200 flatbed scanner</code></pre></div></div><div class=paragraph><p>Ezt a kimenetet egy FreeBSD 8.<em>X</em> rendszeren kaptuk, ahol a <code>'epson2:libusb:/dev/usb:/dev/ugen0.2'</code> az eszközhöz tartozó backendet (<code>epson2</code>) és eszközleírót (<code>/dev/ugen0.2</code>) adja meg.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Ha ennek eredményeképpen semmi sem jelenik meg, vagy a <a href="https://man.freebsd.org/cgi/man.cgi?query=sane&amp;sektion=1&amp;format=html">sane(1)</a> látszólag nem talált semmilyen eszközt, akkor a lapolvasó azonosítása nem sikerült. Ilyen esetekben valószínûleg módosítanunk kell a backend beállításait tartalmazó állományt a használni kívánt lapolvasó eszköz szerint. A backendek beállításait a <span class=filename>/usr/local/etc/sane.d/</span> könyvtárban találjuk. Ez a probléma bizonyos USB-s lapolvasók esetében jelentkezik.</p></div><div class=paragraph><p>Például, ha <a href=#scanners-kernel-usb>Beállítás USB felületen</a>ban használt USB-s lapolvasónkat FreeBSD 8.<em>X</em> alatt tökéletesen felismeri a rendszer, de a FreeBSD korábbi változatai esetén (ahol a <a href="https://man.freebsd.org/cgi/man.cgi?query=uscanner&amp;sektion=4&amp;format=html">uscanner(4)</a> eszközmeghajtót használják) a <code>sane-find-scanner</code> parancs a következõket adja vissza:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># sane-find-scanner -q</span>
found USB scanner <span class=o>(</span>UNKNOWN vendor and product<span class=o>)</span> at device /dev/uscanner0</code></pre></div></div><div class=paragraph><p>Akkor a lapolvasót sikerült megtalálni, és láthatjuk, hogy USB-n keresztül csatlakozik és a <span class=filename>/dev/uscanner0</span> eszközleíró tartozik hozzá. Most már ellenõrizhetjük a lapolvasó helyes beazonosítását is:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># scanimage -L</span>

No scanners were identified. If you were expecting something different,
check that the scanner is plugged <span class=k>in</span>, turned on and detected by the
sane-find-scanner tool <span class=o>(</span><span class=k>if </span>appropriate<span class=o>)</span><span class=nb>.</span> Please <span class=nb>read </span>the documentation
which came with this software <span class=o>(</span>README, FAQ, manpages<span class=o>)</span>.</code></pre></div></div><div class=paragraph><p>Az üzenet fordítása:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>Nincs azonosítható lapolvasó.  Ha nem erre számítottunk, akkor ellenőrizzük,
hogy az eszközt tényleg bekapcsoltuk, csatlakoztattuk és észlelte a
sane-find-scanner segédprogram <span class=o>(</span>amennyiben szükséges<span class=o>)</span><span class=nb>.</span>  Kérjük, olvassa el a
szoftverhez tartozó dokumentációt <span class=o>(</span>README, FAQ, man oldalak<span class=o>)!</span></code></pre></div></div><div class=paragraph><p>Mivel a lapolvasót nem sikerült azonosítani, át kell írnunk a <span class=filename>/usr/local/etc/sane.d/epson2.conf</span> állományt. A használt lapolvasó típusa EPSON Perfection® 1650, ezért hozzá az <code>epson2</code> backendet fogjuk használni. Ehhez feltétlenül olvassuk el a konfigurációs állományban található megjegyzéseket is. A sorokat igen könnyû átírni: tegyük megjegyzésbe az összes olyat, ahol a lapolvasónk számára nem megfelelõ felületek találhatóak (a mi esetünkben tehát megjegyzésbe fogjuk tenni az összes <code>scsi</code> szóval kezdõdõ sort, hiszen nekünk USB-s eszközünk van), majd az állomány végére írjuk be a használni kívánt felületet és eszközleírót. Ez ebben a konkrét esetben ennyi lenne:</p></div><div class="literalblock programlisting"><div class=content><pre>usb /dev/uscanner0</pre></div></div><div class=paragraph><p>A megfelelõ formátum és a további részletek leírásához ne felejtsük el azonban elolvasni a backend konfigurációs állományában felbukkanó megjegyzéseket és az ide tartozó man oldalt sem. Most már megpróbálkozhatunk újra a lapolvasó azonosításával:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># scanimage -L</span>
device <span class=sb>`</span>epson:/dev/uscanner0<span class=s1>&#39; is a Epson GT-8200 flatbed scanner</span></code></pre></div></div><div class=paragraph><p>Láthatjuk, hogy az USB-s lapolvasónkat sikerült azonosítani. Nem számít, ha esetleg nem egyezne a valósággal a gyártó vagy a típus megjelölése. Itt a valóban lényeges elem az <code>epson:/dev/uscanner0</code> mezõ lesz, melynek a backend és az eszközleíró nevét kell helyesen tartalmaznia.</p></div></td></tr></tbody></table></div><div class=paragraph><p>A beállítást akkor zárhatjuk le, miután a <code>scanimage -L</code> parancs képes észlelni a lapolvasót. A eszköz ekkor már készen áll a beolvasásra.</p></div><div class=paragraph><p>Míg a <a href="https://man.freebsd.org/cgi/man.cgi?query=sane&amp;sektion=1&amp;format=html">sane(1)</a> parancssorból teszi lehetõvé számunkra a lapolvasást, addig érdemesebb a képek olvasását egy grafikus felületen keresztül végeznünk. A SANE egy egyszerû, ám hatékony grafikus felületet ajánl fel ehhez, ez az xscanimage (<a class=package href=https://cgit.freebsd.org/ports/tree/graphics/sane-frontends/>graphics/sane-frontends</a>).</p></div><div class=paragraph><p>Az Xsane (<a class=package href=https://cgit.freebsd.org/ports/tree/graphics/xsane/>graphics/xsane</a>) egy másik népszerû grafikus frontend. Segítségével speciális lehetõségeket is kihasználhatunk, mint például többféle képolvasási mód (fénymásoló, fax stb.), színkorrekció, kötegelt beolvasás, stb. Mind a két említett alkalmazás elérhetõ a The GIMP bõvítményeként is.</p></div></div><div class=sect3><h4 id=_a_lapolvasó_használatának_engedélyezése_más_felhasználók_számára>7.6.4. A lapolvasó használatának engedélyezése más felhasználók számára<a class=anchor href=#_a_lapolvasó_használatának_engedélyezése_más_felhasználók_számára></a></h4><div class=paragraph><p>A korábban tárgyalt mûveletek mindegyikét <code>root</code> felhasználóként tudjuk csak végrehajtani. Azonban elõfordulhat, hogy más felhasználók számára is szeretnénk hozzáférést biztosítani a lapolvasóhoz. Ehhez az érintett felhasználóknak a lapolvasóhoz tartozó eszközleíróhoz olvasási és írás joggal kell rendelkezniük. Például az USB-s lapolvasónk a <span class=filename>/dev/ugen0.2</span> eszközleírót használja, amely valójában csak a <span class=filename>/dev/usb/0.2.0</span> eszközleíróra mutató szimbolikus link (ezt gyorsan le tudjuk ellenõrizni, ha megnézzük a <span class=filename>/dev</span> könyvtár tartalmát). Az eszközleíró és a rá mutató szimbolikus link rendre a <code>wheel</code> és <code>operator</code> csoportok birtokában van. Ha a <code><em>pgj</em></code> nevû felhasználót felvesszük ezekbe a csoportokba, akkor ezáltal hozzá tud majd férni a lapolvasóhoz. Nyilvánvaló biztonsági megfontolásokból azonban kétszer is javasolt meggondolni, mely felhasználókat mely csoportokba vesszük fel, különösen, ha <code>wheel</code> csoportról van szó. Ennél valamivel jobb megoldást kínál, ha létrehozunk külön az USB eszközök használatára vonatkozó csoportot és a lapolvasót ezen csoport tagjainak számára elérhetõvé tesszük.</p></div><div class=paragraph><p>Tehát erre a célra például megalkotjuk a <code><em>usb</em></code> csoportot. Ehhez elsõ lépésként a <a href="https://man.freebsd.org/cgi/man.cgi?query=pw&amp;sektion=8&amp;format=html">pw(8)</a> parancs segítségével hozzuk létre magát a csoportot:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># pw groupadd usb</span></code></pre></div></div><div class=paragraph><p>Ezután a <span class=filename>/dev/usb/0.2.0</span> eszközleírót és a rá mutató <span class=filename>/dev/ugen0.2</span> szimbolikus linket kell az <code>usb</code> csoport részére elérhetõvé tennünk, a megfelelõ írási engedélyekkel (<code>0660</code> vagy <code>0664</code>) együtt, mivel alapértelmezetten csak a tulajdonosuk (<code>root</code>) tudja írni ezeket. Mindezt úgy tudjuk megtenni, ha az <span class=filename>/etc/devfs.rules</span> állományhoz hozzáadjuk a megfelelõ sorokat:</p></div><div class="literalblock programlisting"><div class=content><pre>[system=5]
add path ugen0.2 mode 0660 group usb
add path usb/0.2.0 mode 0660 group usb</pre></div></div><div class=paragraph><p>A FreeBSD 7.<em>X</em> változatok esetén valószínûleg a következõ sorokra lesz szükségünk a <span class=filename>/dev/uscanner0</span> eszközleíróhoz:</p></div><div class="literalblock programlisting"><div class=content><pre>[system=5]
add path uscanner0 mode 0660 group usb</pre></div></div><div class=paragraph><p>Ezt követõen az <span class=filename>/etc/rc.conf</span> állományba írjuk be az alábbi sort és utána indítsuk újra a számítógépet:</p></div><div class="literalblock programlisting"><div class=content><pre>devfs_system_ruleset=&#34;system&#34;</pre></div></div><div class=paragraph><p>Az itt szereplõ sorok pontos jelentésérõl a <a href="https://man.freebsd.org/cgi/man.cgi?query=devfs&amp;sektion=8&amp;format=html">devfs(8)</a> man oldaláról tájékozódhatunk.</p></div><div class=paragraph><p>Ezután már csak fel kell vennünk azokat a felhasználókat a <code><em>usb</em></code> csoportba, amelyeknek engedélyezzük a lapolvasó használatát:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># pw groupmod usb -m pgj</span></code></pre></div></div><div class=paragraph><p>A további részletekrõl a <a href="https://man.freebsd.org/cgi/man.cgi?query=pw&amp;sektion=8&amp;format=html">pw(8)</a> man oldalon olvashatunk.</p></div></div></div></div></div><div class=sect1><h2 id=kernelconfig>Chapter 8. A FreeBSD rendszermag testreszabása<a class=anchor href=#kernelconfig></a></h2><div class=sectionbody><div class=sect2><h3 id=kernelconfig-synopsis>8.1. Áttekintés<a class=anchor href=#kernelconfig-synopsis></a></h3><div class=paragraph><p>A rendszermag a FreeBSD operációs rendszer lelke. Felelõs a memória kezelésért, a biztonsági szabályozások betartatásáért, a hálózat mûködtetéséért, a lemezhozzáférésért és sok minden másért is. Miközben maga a FreeBSD egyre jobban konfigurálható dinamikusan, addig alkalmanként elegedhetetlen, hogy újrakonfiguráljuk és újrafordítsuk a rendszermagot.</p></div><div class=paragraph><p>A fejezet elolvasása során megismerjük:</p></div><div class=ulist><ul><li><p>miért lehet szükségünk egy saját rendszermagra;</p></li><li><p>hogyan készítsünk konfigurációs állományt a rendszermaghoz, vagy hogyan módosítsunk egy már létezõt;</p></li><li><p>hogyan használjuk a rendszermag konfigurációs állományát egy új rendszermag lefordítására és létrehozására;</p></li><li><p>hogyan telepítsük az új rendszermagot;</p></li><li><p>hogyan orvosoljuk a felmerülõ problémákat.</p></li></ul></div><div class=paragraph><p>A fejezetben az összes példaként bemutatásra kerülõ parancsot <code>root</code> felhasználóként kell kiadni a sikeres végrehajtásukhoz.</p></div></div><div class=sect2><h3 id=kernelconfig-custom-kernel>8.2. Miért készítsünk saját rendszermagot?<a class=anchor href=#kernelconfig-custom-kernel></a></h3><div class=paragraph><p>A FreeBSD eredetileg ún. "monolitikus" rendszermaggal rendelkezett. Ez azt jelenti, hogy a rendszermag egyetlen nagy program volt, ami elõre rögzített eszközöket ismert, és ha meg akartuk változtatni a rendszermag mûködését, akkor új rendszermagot kellett fordítanunk, majd újra kellett indítanunk vele a számítógépet.</p></div><div class=paragraph><p>Manapság azonban a FreeBSD már inkább afelé a megközelítés felé halad, ahol a rendszermag funkcionalitásának nagy részét mûködés közben az igények szerint betölthetõ és eltávolítható modulok adják. Ezzel lehetõvé válik, hogy a rendszermag gyorsan illeszkedjen az újonnan megjelenõ hardvereszközökhöz (mint például a laptopok PCMCIA-kártyáihoz), vagy olyan új funkciókat tegyünk a rendszermaghoz, amelyek a fordításánál nem voltak feltétlenül szükségesek. Ezt a modellt nevezik moduláris rendszermagnak.</p></div><div class=paragraph><p>Ennek ellenére még mindig elkerülhetetlen, hogy esetenként ne legyen szükség a rendszermag statikus testreszabására. Ez a legtöbb esetben azzal magyarázható, hogy vannak olyan funkciók, amelyek túlságosan is mélyen helyezkednek el a rendszermagban, ezáltal nem tölthetõek be dinamikusan. Máskor viszont egyszerûen azért nem lehetséges, mert még senki sem szánt idõt az adott funkcióhoz tartozó, dinamikusan betölthetõ modul elkészítésére.</p></div><div class=paragraph><p>Egy saját rendszermag készítése azon legfontosabb próbatételek egyike, melyet egy haladó BSD felhasználónak ki kell állnia. Ez a folyamat, habár némileg idõigényes, számos elõnyt tartogat FreeBSD rendszerünk számára. Eltérõen egy <span class=filename>GENERIC</span> (általános) rendszermagtól, amely rengeteg hardvert támogat, egy saját rendszermag csak a <em>saját</em> PC-nk hardverét ismeri. Ennek több elõnye is van, például:</p></div><div class=ulist><ul><li><p>A rendszerünk gyorsabban indul. Mivel a rendszermag csak azokat a hardvereket fogja keresni, melyek a rendszerünkben megtalálhatóak, jelentõs mértékben le tud csökkeni az induláshoz szükséges idõ.</p></li><li><p>Kisebb memóriahasználat. Egy saját rendszermag a szükségtelen részek és eszközmeghajtók elhagyása miatt gyakran kevesebb memóriát emészt fel, mint a <span class=filename>GENERIC</span> rendszermag. Ez azért is fontos, mert a rendszermag mindig benn van a fizikai memóriában, és ezzel az alkalmazások elõl veszi el a helyet. Emiatt egy saját rendszermag elkészítése különösen hasznos lehet egy kevés fizikai memóriával rendelkezõ rendszeren.</p></li><li><p>További hardverek támogatása. A saját rendszermagunkba olyan eszközök támogatását is beletehetjük, amelyek nem szerepelnek a <span class=filename>GENERIC</span> rendszermagban, mint például a hangkártyákét.</p></li></ul></div></div><div class=sect2><h3 id=kernelconfig-devices>8.3. A rendszerünkben levõ hardverek összeszedése<a class=anchor href=#kernelconfig-devices></a></h3><div class=paragraph><p>Mielõtt belevetnénk magunkat a rendszermag beállításába, érdemes egy leltárt készíteni a gépünkben található különbözõ eszközökrõl. Ahol a FreeBSD nem elsõdlegesen használt operációs rendszer, ott ehhez elegendõ megnézni a jelenlegi rendszerben található elemeket. Például a Microsoft® rendszerek Eszközkezelõjében (Device Manager) általában az összes eszköz fontosabb adatait megtaláljuk. Magát az Eszközkezelõt pedig a Vezérlõpultból (Control Panel) érhetjük el.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>A Microsoft® Windows® egyes verzióiban a Rendszer (System) ikonjára kattintva megkapjuk azt a képernyõt, ahonnan közvetlenül el tudjuk érni az Eszközkezelõt.</p></div></td></tr></tbody></table></div><div class=paragraph><p>Ha viszont nincs másik operációs rendszer a gépünkön, akkor magunknak kell mindezeknek utánanéznünk. Erre az egyik alkalmas módszer a <a href="https://man.freebsd.org/cgi/man.cgi?query=dmesg&amp;sektion=8&amp;format=html">dmesg(8)</a> és a <a href="https://man.freebsd.org/cgi/man.cgi?query=man&amp;sektion=1&amp;format=html">man(1)</a> parancsok használata. A FreeBSD-ben található legtöbb meghajtónak van saját man oldala, ami tartalmazza az általuk kezelt eszközök listáját, illetve így a rendszerindítás során észlelt hardvereket nézhetjük vissza. Például az alábbi sorok arra utalnak, hogy a <span class=filename>psm</span> meghajtó megtalálta a gépünkhöz tartozó egeret:</p></div><div class="literalblock programlisting"><div class=content><pre>psm0: &lt;PS/2 Mouse&gt; irq 12 on atkdbc0
psm0: [GIANT-LOCKED]
psm0: [ITHREAD]
psm0: model Generic PS/2 mouse, device ID 0</pre></div></div><div class=paragraph><p>Ezután ezt a meghajtót vagy a rendszermagba kell beépítenünk, vagy pedig a <a href="https://man.freebsd.org/cgi/man.cgi?query=loader.conf&amp;sektion=5&amp;format=html">loader.conf(5)</a> állományon keresztül betöltenünk.</p></div><div class=paragraph><p>Bizonyos esetekben a <code>dmesg</code> az eszközök felkutatásának eredményei helyett csak a rendszer üzeneteit mutatja. Ilyen helyzetekben a teljes kimenet a <span class=filename>/var/run/dmesg.boot</span> állományban tekinthetõ meg.</p></div><div class=paragraph><p>A hardverek manuális felderítésének módja a <a href="https://man.freebsd.org/cgi/man.cgi?query=pciconf&amp;sektion=8&amp;format=html">pciconf(8)</a> segédprogram kimenetének böngészése, ami valamivel részletesebb eredményt ad. Mint például:</p></div><div class="literalblock programlisting"><div class=content><pre>ath0@pci0:3:0:0:        class=0x020000 card=0x058a1014 chip=0x1014168c rev=0x01 hdr=0x00
         vendor     = &#39;Atheros Communications Inc.&#39;
         device     = &#39;AR5212 Atheros AR5212 802.11abg wireless&#39;
         class      = network
         subclass   = ethernet</pre></div></div><div class=paragraph><p>A <code>pciconf -lv</code> paranccsal kapott kimenet ezen része azt mutatja, hogy az <span class=filename>ath</span> meghajtó talált egy vezeték nélküli Ethernet eszközt. Innen a <code>man ath</code> paranccsal érhetjük el a <a href="https://man.freebsd.org/cgi/man.cgi?query=ath&amp;sektion=4&amp;format=html">ath(4)</a> man oldalát.</p></div><div class=paragraph><p>A <a href="https://man.freebsd.org/cgi/man.cgi?query=man&amp;sektion=1&amp;format=html">man(1)</a> a <code>-k</code> paraméter megadásával további hasznos információkkal is tud szolgálni. A fentiekbõl kiindulva például a következõ paranccsal:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># man -k Atheros</span></code></pre></div></div><div class=paragraph><p>le tudjuk kérdezni azokat a man oldalakat, amelyek tartalmazzák az adott szót:</p></div><div class="literalblock programlisting"><div class=content><pre>ath(4)                   - Atheros IEEE 802.11 wireless network driver
ath_hal(4)               - Atheros Hardware Access Layer (HAL)</pre></div></div><div class=paragraph><p>A hardvereszközeink listájával felvértezve most már egy saját rendszermag létrehozása sem lesz annyira ijesztõ.</p></div></div><div class=sect2><h3 id=kernelconfig-modules>8.4. Meghajtók, alrendszerek és modulok<a class=anchor href=#kernelconfig-modules></a></h3><div class=paragraph><p>Mielõtt új rendszermagot készítenénk, érdemes megfontolnunk, hogy egyáltalán szükségünk lesz-e rá. Ha például valamilyen eszköz támogatásához kell, akkor könnyen elõfordulhat, hogy azt modulként is be tudjuk tölteni.</p></div><div class=paragraph><p>A rendszermaghoz tartozó modulok a <span class=filename>/boot/kernel</span> könyvtárban találhatóak, és a <a href="https://man.freebsd.org/cgi/man.cgi?query=kldload&amp;sektion=8&amp;format=html">kldload(8)</a> segítségével a rendszer mûködése közben dinamikusan betölthetõek. Ha nem is az összes, de a legtöbb meghajtóhoz tartozik egy modul és egy man oldal. Például az elõzõ szakaszban az <span class=filename>ath</span> vezeték nélküli Ethernet meghajtóval foglalkoztunk. A következõ leírást találjuk a hozzá tartozó man oldalon:</p></div><div class="literalblock programlisting"><div class=content><pre>Vagy ha modulként akarjuk betölteni ezt a meghajtót a rendszer indítása
során, akkor a man:loader.conf[5] állományba vegyük fel a következõ
sort:

    if_ath_load=&#34;YES&#34;</pre></div></div><div class=paragraph><p>A fentebb leírtak szerint tehát, ha az <code>if_ath_load="YES"</code> sort hozzáadjuk a <span class=filename>/boot/loader.conf</span> állományhoz, akkor a rendszer indulásakor ez a modul mindig dinamikusan betöltõdik.</p></div><div class=paragraph><p>Némely esetben azonban nem áll rendelkezésünkre ilyen modul. Ez különösen igaz bizonyos alrendszerekre és a fontosabb meghajtókra, például az FFS állományrendszerre vonatkozóan, mivel ezeknek kötelezõen a rendszermagban kell lenniük. Ugyanez elmondható a hálózati támogatásra is (INET). Csak úgy tudjuk megmondani, hogy valamelyik meghajtóra szükség van a rendszermagban, ha elõször megpróbáljuk megkeresni hozzá a megfelelõ modult.</p></div><div class="admonitionblock warning"><table><tbody><tr><td class=icon><i class="fa icon-warning" title=Warning></i></td><td class=content><div class=paragraph><p>A beépített meghajtók figyelmetlen eltávolításával könnyen lefordíthatatlan állapotba kerülhet a rendszermag. Például, ha az <a href="https://man.freebsd.org/cgi/man.cgi?query=ata&amp;sektion=4&amp;format=html">ata(4)</a> meghajtót kivesszük a rendszermag konfigurációs állományából, az ATA alrendszert használó meghajtók csak abban az esetben fognak biztosan mûködni, ha egyúttal felvesszük a <span class=filename>loader.conf</span> állományba. Ha nem vagyunk benne biztosak, akkor elõször próbáljuk meg használni a modult, és csak utána hagyjuk el a rendszermagba épített változatát.</p></div></td></tr></tbody></table></div></div><div class=sect2><h3 id=kernelconfig-building>8.5. Saját rendszermag készítése és telepítése<a class=anchor href=#kernelconfig-building></a></h3><div class=paragraph><p>Elõször is tegyünk egy rövidke sétát a rendszermag könyvtárában. A továbbiakban említendõ összes könyvtár a <span class=filename>/usr/src/sys</span> könyvtáron belül található, amely <span class=filename>/sys</span> néven is elérhetõ. Itt rengeteg alkönyvtár található, mindegyikük a rendszermag különbözõ részeit testesíti meg. Ezek közül most számunkra a legfontosabb az <span class=filename>architektúra/conf</span> lesz, ahol majd létrehozzuk a saját rendszermagunk konfigurációs állományát, valamint a <span class=filename>compile</span>, ahol majd a rendszermagunk fordítása történik. Itt az <em>architektúra</em> lehet <span class=filename>i386</span>, <span class=filename>alpha</span>, <span class=filename>amd64</span>, <span class=filename>ia64</span>, <span class=filename>powerpc</span>, <span class=filename>sparc64</span> vagy <span class=filename>pc98</span> (a PC-k egyik, leginkább Japánban elterjedt változata). Az adott architektúra könyvtárában található összes állomány csak arra az architektúrára vonatkozik, a kód többi része pedig gépfüggetlen és közös az összes többi létezõ és leendõ FreeBSD platformon. Érdemes megfigyelni a könyvtárak logikai elrendezését: minden egyes ismert eszköz, állományrendszer és bõvítmény saját alkönyvtárral rendelkezik.</p></div><div class=paragraph><p>A példák során ez a fejezet feltételezi, hogy az i386 architektúrát használjuk. Ha ez a mi esetünkben nem így lenne, ne felejtsük el átírni bennük az elérési útvonalakat a rendszerünk architektúrájának megfelelõen.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Ha <em>nem lenne</em> <span class=filename>/usr/src/sys</span> könyvtár a rendszerünkben, valószínûleg még nem telepítettük a rendszermag forráskódját. Ezt a legkönnyebben úgy tudjuk megtenni, ha <code>root</code> felhasználóként elindítjuk a <code>sysinstall</code> programot és ott kiválasztjuk a <span class=guimenuitem>Configure</span> (Beállítások), azon belül <span class=guimenuitem>Distributions</span> (Terjesztések) menüpontot, amiben válasszuk ki a <span class=guimenuitem>src</span>, <span class=guimenuitem>base</span> és <span class=guimenuitem>sys</span> terjesztéseket. Ha nem szeretnénk erre a célra a sysinstall programot használni, de rendelkezésünkre áll a "hivatalos" FreeBSD CD, akkor a forrásokat akár parancssorból is telepíthetjük:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># mount /cdrom</span>
<span class=c># mkdir -p /usr/src/sys</span>
<span class=c># ln -s /usr/src/sys /sys</span>
<span class=c># cat /cdrom/src/ssys.[a-d]* | tar -xzvf -</span>
<span class=c># cat /cdrom/src/sbase.[a-d]* | tar -xzvf -</span></code></pre></div></div></td></tr></tbody></table></div><div class=paragraph><p>Ezután lépjünk be az <span class=filename>i386/conf</span> könyvtárba és másoljuk le a <span class=filename>GENERIC</span> konfigurációs állományt a kedvünk szerinti nevûre. Például:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># cd /usr/src/sys/i386/conf</span>
<span class=c># cp GENERIC SAJÁT</span></code></pre></div></div><div class=paragraph><p>Általában a nevet végig nagybetûkkel írjuk, és ha több FreeBSD-s gépet is üzemeltetünk különbözõ hardverekkel, hasznosnak bizonyulhat megemlíteni benne az adott gép rendszerének nevét is. Ebben a példában ez most a <span class=filename>SAJÁT</span> lesz.</p></div><div class="admonitionblock tip"><table><tbody><tr><td class=icon><i class="fa icon-tip" title=Tip></i></td><td class=content><div class=paragraph><p>A rendszermagunk konfigurációs állományát nem éppen a legjobb ötlet a <span class=filename>/usr/src</span> könyvtárban tárolni. Ugyanis könnyen elõfordulhat, hogy egy rosszul sikerült fordítás után egyszerûen csak letöröljük az egész <span class=filename>/usr/src</span> könyvtárat és onnan kezdjük újra. Azonban csak ezután juthat eszünkbe, hogy vele együtt bizony letöröltük a saját rendszermagunk konfigurációs állományát is! Ehhez hasonlóan, közvetlenül a <span class=filename>GENERIC</span> konfigurációs állomány szerkesztése sem ajánlott, mivel a források egy esetleges <a href=./#updating-upgrading>frissítésénél</a> könnyen felülíródhat és ezzel együtt elvesznek a módosításaink is.</p></div><div class=paragraph><p>Tehát érdemes inkább valahol máshol tárolnunk a rendszermagunk konfigurációs állományát, majd létrehozni rá egy szimbolikus linket a <span class=filename>i386</span> könyvtárban.</p></div><div class=paragraph><p>Valahogy így:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># cd /usr/src/sys/i386/conf</span>
<span class=c># mkdir /root/kernel</span>
<span class=c># cp GENERIC /root/kernel/SAJÁT</span>
<span class=c># ln -s /root/kernel/SAJÁT</span></code></pre></div></div></td></tr></tbody></table></div><div class=paragraph><p>Most pedig a kedvenc szövegszerkesztõnkkel lássunk neki a <span class=filename>SAJÁT</span> átírásának! Ha nemrég telepítettük csak a rendszerünket, az egyetlen elérhetõ szövegszerkesztõnk minden bizonnyal a vi lesz. Róla most túlságosan is bonyolult lenne leírást adnunk, de az <a href=./#bibliography>Irodalomjegyzék</a>ben található könyvek közül sokban elég jól bemutatják. Ezen kívül a FreeBSD ajánl egy könnyebben megtanulható szövegszerkesztõt is az ee személyében, amely a kezdõk számára az ideális választás. Nyugodtan átírhatjuk az elöl található megjegyzéseket a saját konfigurációnknak megfelelõen, vagy akár azt is rögzíthetjük, hogy miben tértünk el a <span class=filename>GENERIC</span> beállításaitól.</p></div><div class=paragraph><p>Ha fordítottunk már rendszermagot SunOS™ vagy más BSD operációs rendszer alatt, ez az állomány ismerõsnek tûnhet. Ha viszont más operációs rendszerek, mint például a DOS felõl érkezünk, a <span class=filename>GENERIC</span> konfigurációs állomány egy kissé terebélyesnek tûnhet számunkra, ezért <a href=#kernelconfig-config>A konfigurációs állomány</a> címû részt figyelmesen és lassan olvassuk át.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Amennyiben a forrásfánkat a FreeBSD projekt legfrissebb forrásaival <a href=./#updating-upgrading>szinkronizáljuk</a>, mindig olvassuk el a <span class=filename>/usr/src/UPDATING</span> állományt, mielõtt bármilyen frissítéshez is kezdenénk. Itt megtalálhatóak azok a fontos érintett kérdések és területek, amely külön figyelmet igényelnek a frissített forráskód esetén. A <span class=filename>/usr/src/UPDATING</span> mindig a FreeBSD forrásának legfrissebb változatához igazodik, és ezért sokkal naprakészebb információkat tartalmaz, mint ez a kézikönyv.</p></div></td></tr></tbody></table></div><div class=paragraph><p>Most pedig le kell lefordítanunk a rendszermag forráskódját.</p></div><div class="exampleblock procedure"><div class=content><div class=paragraph><p><strong>Procedure: A rendszermag lefordítása</strong></p></div><div class="olist arabic"><ol class=arabic><li><p>Lépjünk be a <span class=filename>/usr/src</span> könyvtárba:</p><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># cd /usr/src</span></code></pre></div></div></li><li><p>Fordítsuk le a rendszermagot:</p><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># make buildkernel KERNCONF=SAJÁT</span></code></pre></div></div></li><li><p>Telepítsük az új rendszermagot:</p><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># make installkernel KERNCONF=SAJÁT</span></code></pre></div></div></li></ol></div></div></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>A FreeBSD teljes forrásfájára szükség van a rendszermag lefordításához.</p></div></td></tr></tbody></table></div><div class="admonitionblock tip"><table><tbody><tr><td class=icon><i class="fa icon-tip" title=Tip></i></td><td class=content><div class=paragraph><p>Amikor egy saját rendszermagot alapértelmezés szerint fordítunk, vele együtt az <em>összes</em> modul is lefordításra kerül. Ha viszont idõt szeretnénk megtakarítani a rendszermag frissítése során, vagy csak a saját moduljainkat akarjuk lefordítani, érdemes átírnunk az <span class=filename>/etc/make.conf</span> állományt a rendszermag fordításának megkezdése elõtt:</p></div><div class="literalblock programlisting"><div class=content><pre>MODULES_OVERRIDE = linux acpi sound/sound sound/driver/ds1 ntfs</pre></div></div><div class=paragraph><p>Ez a változó megadja a ténylegesen lefordítandó modulok listáját.</p></div><div class="literalblock programlisting"><div class=content><pre>WITHOUT_MODULES = linux acpi sound ntfs</pre></div></div><div class=paragraph><p>Ez a változó a fordításból kihagyandó felsõ szintû modulokat sorolja fel. A rendszermag fordításának folyamatában egyéb hasznosnak tekinthetõ változókról a <a href="https://man.freebsd.org/cgi/man.cgi?query=make.conf&amp;sektion=5&amp;format=html">make.conf(5)</a> man oldalán olvashatunk.</p></div></td></tr></tbody></table></div><div class=paragraph><p>Ezután az új rendszermag a <span class=filename>/boot/kernel</span> könyvtárba kerül <span class=filename>/boot/kernel/kernel</span> néven, a korábbi rendszermag pedig <span class=filename>/boot/kernel.old/kernel</span> néven õrzõdik meg. Most állítsuk le a rendszert és indítsuk újra az új rendszermag aktiválásához. Ha közben valamilyen hiba történt volna, nézzük meg a fejezet végén található, <a href=#kernelconfig-trouble>hibakeresés</a>re vonatkozó utasításokat. Mindenképpen olvassuk el azt a részt, amely leírja, hogyan állítsuk helyre a rendszerünket abban az esetben, ha az új rendszermaggal <a href=#kernelconfig-noboot>nem indul</a>.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>A rendszerindítási folyamathoz tartozó további állományok, mint például a rendszerbetöltõ (<a href="https://man.freebsd.org/cgi/man.cgi?query=loader&amp;sektion=8&amp;format=html">loader(8)</a>) és annak konfigurációs állománya, a <span class=filename>/boot</span> könyvtárban találhatóak. A külsõ és saját modulok a <span class=filename>/boot/kernel</span> a könyvtárba kerülhetnek, azonban a felhasználóknak nagyon ügyelniük kell rá, hogy az itt található modulok szinkronban legyenek a lefordított rendszermaggal. Ellenkezõ esetben a rendszerben megbízhatatlanságot, hibákat észlelhetünk.</p></div></td></tr></tbody></table></div></div><div class=sect2><h3 id=kernelconfig-config>8.6. A konfigurációs állomány<a class=anchor href=#kernelconfig-config></a></h3><div class=paragraph><p>A konfigurációs állomány általános formátuma igen egyszerû. Minden sor tartalmaz egy kulcsszót és egy vagy több paramétert. A további egyszerûsítés kedvéért a legtöbb sor csak egyetlen paramétert tartalmaz. Bármi, ami egy <code>#</code> (kettõskereszt) jelet követ, megjegyzésnek minõsül és nem számít konfigurációs elemnek. A most következõ részek bemutatják az egyes kulcsszavakat abban a sorrendben, ahogy azokat a <span class=filename>GENERIC</span> állományban is megtalálhatjuk. <a id=kernelconfig-options></a>Az architektúrafüggõ opciók és eszközök teljes listáját a <span class=filename>GENERIC</span> állománnyal egy könyvtárban levõ <span class=filename>NOTES</span> állományban találhatjuk meg. Az architektúrától független opciókat a <span class=filename>/usr/src/sys/conf/NOTES</span> állományban találjuk.</p></div><div class=paragraph><p>A FreeBSD 5.0 megjelenése óta a konfigurációs állományokban használható az <code>include</code> direktíva. Ennek segítségével egy másik konfigurációs állomány tartalma logikailag beilleszthetõ az aktuálisba, így könnyebbé válik egy már meglevõ állományhoz tartozó kisebb mennyiségû változtatás karbantartása. Például ha csupán pár egyszerû kiegészítést szeretnénk hozzáadni a <span class=filename>GENERIC</span> rendszermaghoz, akkor elegendõ a hozzá vett eltéréseket nyilvántartanunk egy külön konfigurációs állományban:</p></div><div class="literalblock programlisting"><div class=content><pre>include GENERIC
ident SAJAT

options         IPFIREWALL
options         DUMMYNET
options         IPFIREWALL_DEFAULT_TO_ACCEPT
options         IPDIVERT</pre></div></div><div class=paragraph><p>Valószínûleg sok rendszergazda számára jelentõs elõnyt jelent ez a megoldás a konfigurációs állományok korábbról már megszokott újraírásával szemben: a helyi konfigurációs állomány csak a <span class=filename>GENERIC</span> rendszermag helyi rendszerre vonatkozó eltéréseit tartalmazza. Így amikor frissítjük a rendszerünket, a <span class=filename>GENERIC</span> rendszermag összes újítása elérhetõvé válik, kivéve ha explicit módon le nem tiltottuk ezeket a <code>noptions</code> vagy a <code>nodevice</code> megadásával. A fejezet további részében egy átlagos konfigurációs állománnyal fogunk foglalkozni, mind a beállítások, mind pedig az eszközök tekintetében.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Ha olyan állományt akarunk készíteni, amely tartalmazza az összes lehetséges opciót, például teszteléshez, futtassuk le <code>root</code> felhasználóként az alábbi parancsot:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># cd /usr/src/sys/i386/conf &amp;&amp; make LINT</span></code></pre></div></div></td></tr></tbody></table></div><div class=paragraph><p>Itt a <span class=filename>GENERIC</span> rendszermag-konfigurációs állomány ismertetése következik, az érthetõség kedvéért helyenként megjegyzésekkel kibõvítve. A bemutatott állománynak majdnem pontosan meg kell egyeznie a rendszerünkben található <span class=filename>/usr/src/sys/i386/conf/GENERIC</span> állománnyal.</p></div><div class="literalblock programlisting"><div class=content><pre>machine      i386</pre></div></div><div class=paragraph><p>A számítógépünk architektúráját adja meg. A következõk valamelyikének kell lennie: <code>alpha</code>, <code>amd64</code>, <code>i386</code>, <code>ia64</code>, <code>pc98</code>, <code>powerpc</code>, vagy <code>sparc64</code>.</p></div><div class="literalblock programlisting"><div class=content><pre>cpu          I486_CPU
cpu          I586_CPU
cpu          I686_CPU</pre></div></div><div class=paragraph><p>A fenti beállítás segítségével megadhatjuk, milyen típusú processzor található a számítógépünkben. Több ilyen sorunk is lehet (ha például nem lennénk biztosak benne, hogy az <code>I586_CPU</code> vagy <code>I686_CPU</code> értéket kellene megadnunk), de a saját rendszermagunk összeállításához érdemes csak egyet meghagynunk. Ha nem ismerjük pontosan a processzorunk típusát, vessünk egy pillantást a <span class=filename>/var/run/dmesg.boot</span> állományra és keressük ki belõle.</p></div><div class="literalblock programlisting"><div class=content><pre>ident          GENERIC</pre></div></div><div class=paragraph><p>Ez a rendszermag azonosítója. Változtassuk meg rendszermagunk nevére, legyen például <code>SAJAT</code>, ha a korábbi utasításokat követtük. Az <code>ident</code> után írt sztring fog megjelenni a rendszermag neve mellett a rendszer indítása során, ezért fontos, hogy az új rendszermagunknak más nevet adjunk, ha meg akarjuk különböztetni az általában használttól (például egy tesztelésre szánt rendszermagot akarunk készíteni).</p></div><div class="literalblock programlisting"><div class=content><pre># ha a /boot/device.hints használata helyett statikusan bele akarjuk fordítani
#hints          &#34;GENERIC.hints&#34;         # itt szerepelnek a device hintek</pre></div></div><div class=paragraph><p>A <a href="https://man.freebsd.org/cgi/man.cgi?query=device.hints&amp;sektion=5&amp;format=html">device.hints(5)</a> használható az eszközmeghajtók beállítására. A <a href="https://man.freebsd.org/cgi/man.cgi?query=loader&amp;sektion=8&amp;format=html">loader(8)</a> a rendszer indítása során alapértelmezés szerint a <span class=filename>/boot/device.hints</span> állományt olvassa be erre a célra. A <code>hints</code> beállítás használatával ezeket a "hinteket" statikusan bele tudjuk építeni a rendszermagba. Ebben az esetben nincs szükségünk külön <span class=filename>device.hints</span> állomány létrehozására a <span class=filename>/boot</span> könyvtárban.</p></div><div class="literalblock programlisting"><div class=content><pre>makeoptions     DEBUG=-g          # a nyomkövetéshez szükséges gdb(1) szimbólumok beépítése</pre></div></div><div class=paragraph><p>A FreeBSD hagyományos fordításának folyamata során a rendszermagot a <code>-g</code> használatával készítjük el, aminek köszönhetõen hibakeresési információkat tudunk átadni a <a href="https://man.freebsd.org/cgi/man.cgi?query=gcc&amp;sektion=1&amp;format=html">gcc(1)</a> fordítónak.</p></div><div class="literalblock programlisting"><div class=content><pre>options          SCHED_ULE          # ULE ütemezõ</pre></div></div><div class=paragraph><p>A FreeBSD alapértelmezett rendszerütemezõje. Ne változtassuk meg!</p></div><div class="literalblock programlisting"><div class=content><pre>options          PREEMPTION         # a rendszerszálak megszakíthatóságának engedélyezése</pre></div></div><div class=paragraph><p>Ha engedélyezzük, a rendszermagban futó szálakat meg tudják szakítani más, magasabb prioritású szálak. Ez segít növelni a rendszer válaszadási sebességét és csökkenti a megszakításokat kezelõ szálak várakozását.</p></div><div class="literalblock programlisting"><div class=content><pre>options          INET              # hálózatkezelés</pre></div></div><div class=paragraph><p>A hálózatkezelés támogatása. Ne töröljük ki, még akkor sem, ha nem tervezzük hálózatra kapcsolni a rendszert. Sok programnak szüksége van legalább az ún. loopback típusú hálózat támogatására (vagyis a számítógépünkön belüli hálózati kapcsolatokra), ezért ez feltétlenül kötelezõ!</p></div><div class="literalblock programlisting"><div class=content><pre>options          INET6             # IPv6 kommunikációs prokotollok</pre></div></div><div class=paragraph><p>Engedélyezi az IPv6 kommunikációs protokollok használatát.</p></div><div class="literalblock programlisting"><div class=content><pre>options          FFS               # Berkeley Fast Filesystem</pre></div></div><div class=paragraph><p>Ez a legalapvetõbb merevlemezes állományrendszer. Hagyjuk meg, ha merevlemezrõl akarjuk indítani a rendszerünket.</p></div><div class="literalblock programlisting"><div class=content><pre>options          SOFTUPDATES       # az FFS Soft Updates támogatása</pre></div></div><div class=paragraph><p>Ez a beállítás engedélyezi a rendszermagban a Soft Updates használatát, amely segít felgyorsítani a lemez írási sebességét. Ha már a rendszermag ezt a funkcionalitást ismeri, akkor még külön az egyes lemezeken is engedélyezni kell. Nézzük meg a <a href="https://man.freebsd.org/cgi/man.cgi?query=mount&amp;sektion=8&amp;format=html">mount(8)</a> kimenetét, hogy lássuk, a rendszerünkben levõ lemezek közül melyiken van ténylegesen engedélyezve a Soft Updates használata. Ha nem látjuk benne sehol sem a <code>soft-updates</code> opciót, akkor azt (meglevõ állományrendszerek esetén) a <a href="https://man.freebsd.org/cgi/man.cgi?query=tunefs&amp;sektion=8&amp;format=html">tunefs(8)</a> vagy (új állományrendszerek esetén) a <a href="https://man.freebsd.org/cgi/man.cgi?query=newfs&amp;sektion=8&amp;format=html">newfs(8)</a> parancsokkal tudjuk bekapcsolni.</p></div><div class="literalblock programlisting"><div class=content><pre>options          UFS_ACL           # a hozzáférés-vezérlési listák (ACL) támogatása</pre></div></div><div class=paragraph><p>Ezzel a beállítással engedélyezhetjük a rendszermagban a hozzáférés-vezérlési listák támogatását. Ez a kiterjesztett attribútumok és az UFS2 használatára támaszkodik. Ezt a lehetõséget részleteiben a <a href=./#fs-acl>Az állományrendszerek hozzáféréseit vezérlő listák</a>ban tárgyaljuk. Az ACL alapértelmezés szerint támogatott, és ha korábban már használtuk, akkor semmiképpen se kapcsoljuk ki, mert ezzel az eddig létrehozott hozzáférés-vezérlési listáink érvénytelenné, az állományaink pedig védtelenné válnak.</p></div><div class="literalblock programlisting"><div class=content><pre>options          UFS_DIRHASH       # nagyobb könyvtárak esetén gyorsulást hoz</pre></div></div><div class=paragraph><p>Ezzel a beállítással némi memória feláldozása árán fel tudjuk gyorsítani a nagyobb könyvtárakon végzett lemezmûveletek sebességét, ezért ezt a beállítást érdemes nagyobb szerverekre vagy interaktivitást igénylõ munkaállomásokra tartogatni, és eltávolítani olyan esetekben, amikor a FreeBSD-t olyan kisebb számítógépeken használjuk, ahol a memória kevés és a lemezmûveletek sebessége kevésbé fontos, például egy tûzfalon.</p></div><div class="literalblock programlisting"><div class=content><pre>options          MD_ROOT           # tudunk memórialemezrõl is rendszert indítani</pre></div></div><div class=paragraph><p>Ezzel az opcióval engedélyezni tudjuk a rendszer indítását memóriában tárolt virtuális lemezekrõl.</p></div><div class="literalblock programlisting"><div class=content><pre>options          NFSCLIENT         # hálózati állományrendszer (NFS) kliens
options          NFSSERVER         # NFS szerver
options          NFS_ROOT          # NFS használható gyökérként is, kell hozzá az NFSCLIENT</pre></div></div><div class=paragraph><p>A hálózati állományrendszer támogatása. Hacsak nem akarunk TCP/IP-n keresztül állományrendszereket csatlakoztatni egy UNIX® állományszerverrõl, kivehetjük.</p></div><div class="literalblock programlisting"><div class=content><pre>options          MSDOSFS           # MS-DOS állományrendszer</pre></div></div><div class=paragraph><p>Az MS-DOS® állományrendszer. Hacsak nem akarunk DOS-ra formázott merevlemezes partíciót csatlakoztatni a rendszerindítás során, nyugodtan elhagyhatjuk. A fentebb leírtak szerint az elsõ olyan alkalommal automatikusan betöltõdik, amikor egy DOS partíciót csatlakoztatni akarunk. Sõt, a nagyszerû <a class=package href=https://cgit.freebsd.org/ports/tree/emulators/mtools/>emulators/mtools</a> szoftver segítségével külön csatlakoztatás és leválasztás nélkül tudunk DOS-os floppykat olvasni (és az <code>MSDOSFS</code>-re egyáltalán nincs is szüksége).</p></div><div class="literalblock programlisting"><div class=content><pre>options          CD9660            # ISO 9660 állományrendszer</pre></div></div><div class=paragraph><p>Az ISO 9660 állományrendszert a CD-k használják. Vegyük ki, ha nincs a számítógépben CD-ROM meghajtó, vagy csak ritkán fogunk CD-ket csatlakoztatni (mivel a hozzá tartozó modul magától betöltõdik az elsõ adat CD csatlakoztatása során). Az audio CD-k nem használják ezt az állományrendszert.</p></div><div class="literalblock programlisting"><div class=content><pre>options          PROCFS            # a futó programok állományrendszere (szükséges hozzá a PSEUDOFS)</pre></div></div><div class=paragraph><p>A futó programok állományrendszere. Ez csak a <span class=filename>/proc</span> könyvtárra csatlakoztatott "színlelt" állományrendszer, amelynek segítségével a <a href="https://man.freebsd.org/cgi/man.cgi?query=ps&amp;sektion=1&amp;format=html">ps(1)</a> és hozzá hasonló programok képesek több információt adni a futó programokról. A <code>PROCFS</code> használata a legtöbb esetben nem indokolt, mivel a különféle nyomkövetõ és felügyeleti eszközök képesek a <code>PROCFS</code> használata nélkül is mûködni: alapértelmezés szerint a telepített rendszerek sem csatlakoztatják ezt az állományrendszer.</p></div><div class="literalblock programlisting"><div class=content><pre>options          PSEUDOFS          # pszeudo állományrendszerek támogatása</pre></div></div><div class=paragraph><p>A 6.X verziójú rendszermagokban a <code>PROCFS</code> használatához engedélyeznünk kell a <code>PSEUDOFS</code> használatát is.</p></div><div class="literalblock programlisting"><div class=content><pre>options          GEOM_GPT          # GUID típusú partíciós táblák használata</pre></div></div><div class=paragraph><p>Ezzel a beállítással engedélyezni tudjuk nagy mennyiségû partíció támogatását egyetlen lemezen.</p></div><div class="literalblock programlisting"><div class=content><pre>options          COMPAT_43         # kompatibilitás fenntartása a 4.3 BSD-vel [NE TÖRÖLD!]</pre></div></div><div class=paragraph><p>Kompatibilitás a 4.3BSD-vel. Ne vegyük ki, mert bizonyos programok furcsán fognak viselkedni a hiánya esetén.</p></div><div class="literalblock programlisting"><div class=content><pre>options          COMPAT_FREEBSD4   # kompatibilitás a FreeBSD4-el</pre></div></div><div class=paragraph><p>Ez a beállítás szükséges a FreeBSD 5.X i386™ és Alpha rendszerein a FreeBSD korábbi verzióihoz fordított alkalmazások támogatásához, melyek régebbi rendszerhívásokat használnak. Az összes i386™ és Alpha típusú rendszeren ajánlott engedélyezni, mivel itt elõfordulhatnak régebbi alkalmazások. A többi platform, mint például az ia64 vagy a sparc64, támogatása csak az 5.X verzióban jelent meg, ezért ott nincs szükség erre.</p></div><div class="literalblock programlisting"><div class=content><pre>options          COMPAT_FREEBSD5   # kompatibilitás a FreeBSD5-el</pre></div></div><div class=paragraph><p>Ezt a beállítást a FreeBSD 6.X és afeletti verziókban kell használni az olyan FreeBSD 5.X verziókra fordított alkalmazások futtatásának támogatásához, melyek a FreeBSD 5.X rendszerhívásait használják.</p></div><div class="literalblock programlisting"><div class=content><pre>options          SCSI_DELAY=5000  # a SCSI eszközök keresése elõtt késleltetés (ezredmásodpercben)</pre></div></div><div class=paragraph><p>Ezzel a beállítással a rendszermag 5 másodpercig várakozni fog a SCSI eszközök keresése elõtt. Ha kizárólag csak IDE típusú merevlemezeink vannak, nyugodtan kihagyhatjuk, máskülönben érdemes a rendszerindítás gyorsítása érdekében csökkenteni ezt az értéket. Természetesen, ha így teszünk és a FreeBSD nem tudja felismerni a SCSI eszközeinket, akkor növeljük meg valamennyivel.</p></div><div class="literalblock programlisting"><div class=content><pre>options          KTRACE            # a ktrace(1) támogatása</pre></div></div><div class=paragraph><p>Engedélyezi a rendszermagban futó rutinok nyomonkövetését, ami hasznos lehet a hibák keresése során.</p></div><div class="literalblock programlisting"><div class=content><pre>options          SYSVSHM           # SYSV-szerû osztott memória</pre></div></div><div class=paragraph><p>Ezzel a beállítással engedélyezni tudjuk a rendszerben a System V típusú osztott memória használatát. Leggyakrabban az X rendszer XSHM kiterjesztése használja, amelyen keresztül számos mûveletigényes grafikus program mûködését fel lehet gyorsítani. Ha X-et használunk, mindenképpen szükségünk lehet erre.</p></div><div class="literalblock programlisting"><div class=content><pre>options          SYSVMSG           # SYSV-szerû üzenetsorok</pre></div></div><div class=paragraph><p>A System V üzenetek támogatása. Ez a beállítás csupán néhány száz byte-tal növeli a rendszermagot.</p></div><div class="literalblock programlisting"><div class=content><pre>options          SYSVSEM           # SYSV-szerû szemaforok</pre></div></div><div class=paragraph><p>A System V szemaforok támogatása. Nem túl gyakran alkalmazzák ezeket, de ez csak néhány száz byte-ot tesz hozzá a rendszermaghoz.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>A <a href="https://man.freebsd.org/cgi/man.cgi?query=ipcs&amp;sektion=1&amp;format=html">ipcs(1)</a> parancs <code>-p</code> paraméterével ki tudjuk listáztatni azokat a futó programokat, amelyek ezen System V eszközöket használják.</p></div></td></tr></tbody></table></div><div class="literalblock programlisting"><div class=content><pre>options          _KPOSIX_PRIORITY_SCHEDULING # POSIX P1003_1B valósidejû kiterjesztések</pre></div></div><div class=paragraph><p>A POSIX® 1993-as változatában megjelent valósidejû bõvítések. A Portgyûjteményben megjelenõ egyes alkalmazások használják ezeket (mint például a StarOffice™).</p></div><div class="literalblock programlisting"><div class=content><pre>options          KBD_INSTALL_CDEV  # CDEV bejegyzés létrehozása a /dev könyvtárban</pre></div></div><div class=paragraph><p>Ez a beállítás kell ahhoz, hogy a <span class=filename>/dev</span> könyvtárban létre tudjunk hozni eszközleírókat a billentyûzethez.</p></div><div class="literalblock programlisting"><div class=content><pre>options          ADAPTIVE_GIANT    # adaptív Giant mutexek</pre></div></div><div class=paragraph><p>A Giant annak a kölcsönös kizárási mechanizmusnak (blokkolt mutexnek) a neve, amely a rendszermag erõforrásainak jelentõs részét védi. Manapság ez már egy elfogadhatatlanul szûk keresztmetszetet képez a teljesítményben, ezért a fejlesztésben fokozatosan felváltják az egyes erõforrásokat külön-külön védõ zárolások. Az <code>ADAPTIVE_GIANT</code> beállítás hatására a Giant a helyzethez igazodóan forgó (spin) mutexek közé kerül. Ez azt jelenti, hogy amikor egy szál zárolni akarja a Giant mutexet, de ezt már megtette elõtte egy másik processzorról futó szál, a szál tovább fut és várakozni fog a zárolás feloldására. Normális esetben ugyanis egy szál továbbra is blokkolt állapotban marad, várakozva a futásra. Ha nem tudunk dönteni, hagyjuk változatlanul.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Hozzátesszük, hogy a FreeBSD 8.0-CURRENT és késõbbi változataiban az össszes mutex alapértelmezés szerint adaptív, hacsak meg nem adjuk a <code>NO_ADAPTIVE_MUTEXES</code> beállítást. Ennek eredményeképpen a Giant most már alapból adaptív, ezért esetükben az <code>ADAPTIVE_GIANT</code> nem szerepel a rendszermag beállításai között.</p></div></td></tr></tbody></table></div><div class="literalblock programlisting"><div class=content><pre>device          apic               # I/O APIC</pre></div></div><div class=paragraph><p>Az <span class=filename>apic</span> nevû eszköz engedélyezésével használhatjuk a hardveres APIC-ot a megszakítások vezérlésére. Az <span class=filename>apic</span> alkalmazható egy- és többprocesszoros rendszerek esetén is egyaránt, de az SMP rendszermagoknál szükséges. Több processzor támogatásánál mindenképpen tegyük hozzá az <code>options SMP</code> beállítást is.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Az apic eszköz csak az i386 architektúrán létezik, ezért a többi architektúrán nem szabad használnunk ezt a beállítást.</p></div></td></tr></tbody></table></div><div class="literalblock programlisting"><div class=content><pre>device          eisa</pre></div></div><div class=paragraph><p>Abban az esetben engedélyezzük, ha EISA-s alaplapunk van, ezzel aktiváljuk az EISA buszra csatlakoztatott eszközök automatikus felismerését és beállíthatóságát.</p></div><div class="literalblock programlisting"><div class=content><pre>device          pci</pre></div></div><div class=paragraph><p>Tegyük hozzá a konfigurációs állományhoz, ha PCI-os alaplapuk van. Ezzel engedélyezhetjük a PCI kártyák automatikus felismerését és a PCI és ISA buszok közti átirányítást.</p></div><div class="literalblock programlisting"><div class=content><pre># Hajlékonylemezes meghajtók
device          fdc</pre></div></div><div class=paragraph><p>Ez a hajlékonylemezes meghajtó vezérlõje.</p></div><div class="literalblock programlisting"><div class=content><pre># ATA és ATAPI eszközök
device          ata</pre></div></div><div class=paragraph><p>Ez az eszközmeghajtó felelõs az összes ATA és ATAPI eszközért. A modern számítógépeken csak egyszer kell megadnunk a <code>device ata</code> sort a beállítások között az összes PCI-os ATA/ATAPI eszköz felismeréséhez.</p></div><div class="literalblock programlisting"><div class=content><pre>device          atadisk                 # ATA lemezmeghajtók</pre></div></div><div class=paragraph><p>Az ATA lemezmeghajtók támogatásához erre van még szükség a <code>device ata</code> mellett.</p></div><div class="literalblock programlisting"><div class=content><pre>device          ataraid                 # ATA RAID-meghajtók</pre></div></div><div class=paragraph><p>Az ATA RAID-meghajtók kezeléséhez erre a sorra van szükség a <code>device ata</code> mellett.</p></div><div class="literalblock programlisting"><div class=content><pre>device          atapicd                 # ATAPI CD-meghajtók</pre></div></div><div class=paragraph><p>Az ATAPI CD-meghajtók használatához ezt is tegyük a konfigurációba a <code>device ata</code> mellé.</p></div><div class="literalblock programlisting"><div class=content><pre>device          atapifd                 # ATAPI floppy meghajtók</pre></div></div><div class=paragraph><p>A <code>device ata</code> használata mellett erre van még szükségünk az ATAPI floppy meghajtók kezeléséhez.</p></div><div class="literalblock programlisting"><div class=content><pre>device          atapist                 # ATAPI szalagos meghajtók</pre></div></div><div class=paragraph><p>Az ATAPI szalagos egységek használatához ezt a sort is tegyük a konfigurációba a <code>device ata</code> mellé.</p></div><div class="literalblock programlisting"><div class=content><pre>options         ATA_STATIC_ID           # statikus eszközszámozás</pre></div></div><div class=paragraph><p>Ezzel a beállítással a vezérlõk számozása állandó lesz. Nélküle az eszközszámok dinamikusan kerülnek kiosztásra.</p></div><div class="literalblock programlisting"><div class=content><pre># SCSI vezérlõk
device          ahb        # EISA AHA1742 család
device          ahc        # AHA2940 és integrált AIC7xxx eszközök
options         AHC_REG_PRETTY_PRINT    # a hibák kereséséhez kiíratja a regiszterek
                                        # bitmezõit.  Kb. 128 KB-al növeli a méretét.
device          ahd        # AHA39320/29320 és integrált AIC79xx eszközök
options         AHD_REG_PRETTY_PRINT    # a hibák kereséséhez kiíratja a regiszterek
                                        # bitmezõit.  Kb. 215 KB-al növeli a méretét.
device          amd        # AMD 53C974 (Teckram DC-390(T))
device          isp        # Qlogic család
#device         ispfw      # a QLogic HBA firmware-e, többnyire modul
device          mpt        # LSI-Logic MPT-Fusion
#device         ncr        # NCR/Symbios Logic
device          sym        # NCR/Symbios Logic (újabb chipsetek, illetve az `ncr&#39; típusúak)
device          trm        # Tekram DC395U/UW/F DC315U csatolók

device          adv        # Advansys SCSI-csatolók
device          adw        # Advansys wide SCSI-csatolók
device          aha        # Adaptec 154x SCSI-csatolók
device          aic        # Adaptec 15[012]x SCSI-csatolók, AIC-6[23]60.
device          bt         # Buslogic/Mylex MultiMaster SCSI-csatolók

device          ncv        # NCR 53C500
device          nsp        # Workbit Ninja SCSI-3
device          stg        # TMC 18C30/18C50</pre></div></div><div class=paragraph><p>SCSI-vezérlõk. Vegyük ki azokat, amelyekkel ténylegesen nem rendelkezünk. Ha csak IDE eszközeink vannak a rendszerünkben, az összeset eltávolíthatjuk. A <code>_REG_PRETTY_PRINT</code> végzõdésû sorok a megfelelõ meghajtók hibakerési beállításait takarják.</p></div><div class="literalblock programlisting"><div class=content><pre># SCSI-perifériák
device          scbus      # SCSI-busz (kell a SCSI-hoz)
device          ch         # SCSI médiumváltók (media changer)
device          da         # közvetlen hozzáférés (lemezek)
device          sa         # soros hozzáférés (szalag stb.)
device          cd         # CD
device          pass       # áteresztõ eszköz (közvetlen SCSI hozzáférés)
device          ses        # SCSI környezeti szolgáltatások (és SAF-TE)</pre></div></div><div class=paragraph><p>SCSI-perifériák. Itt is érvényes, hogy kivehetjük azokat az eszközöket, amelyekkel nem rendelkezünk. De ha csak IDE hardvereink vannak, teljesen eltávolíthatjuk ezeket.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Annak ellenére, hogy valójában nem igazi SCSI-eszközök, az USB-s <a href="https://man.freebsd.org/cgi/man.cgi?query=umass&amp;sektion=4&amp;format=html">umass(4)</a> és még néhány más egyéb meghajtó is használja a SCSI alrendszert. Emiatt semmiképpen se távolítsuk el a SCSI támogatást a rendszerünkõl abban az esetben, ha ilyen meghajtókat is használni szándékozunk.</p></div></td></tr></tbody></table></div><div class="literalblock programlisting"><div class=content><pre># a SCSI alrendszerhez kapcsolódó RAID-vezérlõk
device          amr        # AMI MegaRAID
device          arcmsr     # Areca SATA II RAID
device          asr        # DPT SmartRAID V, VI és Adaptec SCSI RAID
device          ciss       # Compaq Smart RAID 5*
device          dpt        # DPT Smartcache III, IV - lásd a NOTES állományt
device          hptmv      # Highpoint RocketRAID 182x
device          rr232x     # Highpoint RocketRAID 232x
device          iir        # Intel Integrated RAID
device          ips        # IBM (Adaptec) ServeRAID
device          mly        # Mylex AcceleRAID/eXtremeRAID
device          twa        # 3ware 9000 series PATA/SATA RAID

# RAID vezérlõk
device          aac        # Adaptec FSA RAID
device          aacp       # SCSI áteresztõ az aac-hez (kell hozzá a CAM)
device          ida        # Compaq Smart RAID
device          mfi        # LSI MegaRAID SAS
device          mlx        # Mylex DAC960 család
device          pst        # Promise Supertrak SX6000
device          twe        # 3ware ATA RAID</pre></div></div><div class=paragraph><p>Az ismert RAID-vezérlõk. Ha közülük egyikkel sem rendelkezünk, távolítsuk el ezeket a konfigurációból.</p></div><div class="literalblock programlisting"><div class=content><pre># az atkbdc0 vezérli a billentyûzetet és a PS/2-es egeret
device          atkbdc     # AT billentyûzet vezérlõ</pre></div></div><div class=paragraph><p>A billentyûzet vezérlõje (<code>atkbdc</code>) az AT-s billentyûzet és a PS/2 stílusú pozícionáló eszközök vezérléséhez szükséges I/O szolgáltatásokat biztosítja. Erre a vezérlõre a billentyûzet meghajtójának (<code>atkbd</code>) és a PS/2 pozícionáló eszközök eszközmeghajtójának (<code>psm</code>) is szüksége van.</p></div><div class="literalblock programlisting"><div class=content><pre>device          atkbd      # AT billentyûzet</pre></div></div><div class=paragraph><p>Az <code>atkbd</code> meghajtó, a <code>atkbdc</code> vezérlõvel együtt, adja a hozzáférést az AT billentyûzet vezérlõre csatlakoztatott AT 84 és a fejlettebb AT billentyûzetek felé.</p></div><div class="literalblock programlisting"><div class=content><pre>device          psm        # PS/2 egér</pre></div></div><div class=paragraph><p>Használjuk ezt az eszközt, ha az egerünk a PS/2 portra csatlakozik.</p></div><div class="literalblock programlisting"><div class=content><pre>device          kbdmux        # billentyûzet multiplexer</pre></div></div><div class=paragraph><p>A billentyûzet multiplexer alapszintû támogatása. Ha nem kívánunk a jövõben egynél több billentyûzetet csatlakoztatni a rendszerünkre, nyugodt szívvel kivehetjük ezt a sort.</p></div><div class="literalblock programlisting"><div class=content><pre>device          vga        # VGA videokártya meghajtó</pre></div></div><div class=paragraph><p>Videokártya meghajtó.</p></div><div class="literalblock programlisting"><div class=content><pre>device          splash     # üdvözlõképernyõk és képernyõkímélõk támogatása</pre></div></div><div class=paragraph><p>Nyissunk egy üdvözlõképernyõvel! A képernyõkímélõknek is szükségük van erre az eszközre.</p></div><div class="literalblock programlisting"><div class=content><pre># a syscons az alapértelmezett konzolmeghajtó, hasonlít a SCO konzolra
device          sc</pre></div></div><div class=paragraph><p>Az <code>sc</code> az alapértelmezett meghajtó a konzolok számára, és sokban hasonlít a SCO konzolra. Mivel a legtöbb teljesképernyõs program a <span class=filename>termcap</span> termináladatbázis könyvtáron keresztül éri el a konzolt, nem igazán számít, hogy ezt vagy a <code>VT220</code>-kompatibilis <code>vt</code> konzolmeghajtót használjuk. Ha bármilyen gondunk lenne a teljesképernyõs programok futtatásával ezen a konzolon, a bejelentkezéskor állítsuk a <code>TERM</code> környezeti változónkat a <code>scoansi</code> értékre.</p></div><div class="literalblock programlisting"><div class=content><pre># ezzel tudjuk engedélyezni a pcvt (VT220-kompatibilis) konzolmeghajtót
#device          vt
#options         XSERVER          # az X szerver támogatása vt konzolon
#options         FAT_CURSOR       # telt kurzor használata</pre></div></div><div class=paragraph><p>Ez a VT220-kompatibilis konzolmeghajtó, amely visszafelé kompatibilis a VT100/102-vel is. Remekül mûködik olyan laptopokon, ahol a hardver nem használható az <code>sc</code> konzollal. Itt ugyanúgy érdemes egyébként a <code>vt100</code> értékre vagy a <code>vt220</code> értékre állítani a <code>TERM</code> környezeti változónkat. Hasznosnak bizonyulhat abban az esetben is, amikor hálózaton keresztül nagy mennyiségû és eltérõ típusú számítógépekhez csatlakozunk, és ahol a <span class=filename>termcap</span> és <span class=filename>terminfo</span> adatbázisokban az <code>sc</code> bejegyzései gyakran nem is érhetõek el - a <code>vt100</code> viszont virtuálisan az összes platformon elérhetõ.</p></div><div class="literalblock programlisting"><div class=content><pre>device          agp</pre></div></div><div class=paragraph><p>Írjuk bele a konfigurációba, ha van AGP kártya a rendszerünkben. Ezzel engedélyezzük az AGP és az AGP GART támogatását az ezeket ismerõ kártyák számára.</p></div><div class="literalblock programlisting"><div class=content><pre># energiagazdálkodás támogatása (bõvebben lásd: NOTES)
#device          apm</pre></div></div><div class=paragraph><p>A fejlett energiagazdálkodás támogatása. Laptopok esetén hasznos, habár ez alapértelmezés szerint nincs engedélyezve a <span class=filename>GENERIC</span> konfigurációban.</p></div><div class="literalblock programlisting"><div class=content><pre># az i8254 készenléti módjának támogatása
device           pmtimer</pre></div></div><div class=paragraph><p>Az energiagazdálkodási események, mint például APM és ACPI idõzítõjének eszközmeghajtója.</p></div><div class="literalblock programlisting"><div class=content><pre># PCCARD (PCMCIA) támogatás
# PCMCIA és cardbus támogatás
device          cbb               # cardbus (yenta) bridge
device          pccard            # PC Card (16 bites) busz
device          cardbus           # CardBus (32 bites) busz</pre></div></div><div class=paragraph><p>A PCMCIA támogatása. Mindenképpen szükségünk lesz rá, ha laptopunk van.</p></div><div class="literalblock programlisting"><div class=content><pre># soros (COM) portok
device          sio               # 8250, 16[45]50 alapú soros portok</pre></div></div><div class=paragraph><p>Ezek azok a soros portok, amelyek az MS-DOS®/Windows® világban csak <span class=filename>COM</span> portokként ismernek.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Ha van egy belsõ modemünk a <span class=filename>COM4</span>-en és egy soros portunk a <span class=filename>COM2</span>-n, a modem IRQ-ját meg kell változtatnunk 2-re (valamilyen homályos mûszaki okból kifolyólag a COM2 = IRQ9), hogy hozzá tudjunk férni FreeBSD-bõl. Ha többportos soros kártyánk lenne, lapozzuk fel a <a href="https://man.freebsd.org/cgi/man.cgi?query=sio&amp;sektion=4&amp;format=html">sio(4)</a> man oldalát, és ott hozzá megtaláljuk a <span class=filename>/boot/device.hints</span> állományba írandó megfelelõ értékeket. Egyes videokártyák (különösen az S3 chipekre épülõk) az I/O címeket <code>0x*2e8</code> alakban használják, és mivel rengeteg olcsó soros kártya nem kódolja vissza egészében a 16 bites I/O címteret, ütközni fognak ezekkel a kártyákkal, és ezáltal a <span class=filename>COM4</span> port gyakorlatilag elérhetetlenné válik.</p></div><div class=paragraph><p>Minden egyes soros portnak egyedi IRQ-ja kell legyen (hacsak nem használunk olyan többportos kártyát, amely támogatja a megosztott megszakításokat), ezért a <span class=filename>COM3</span> és <span class=filename>COM4</span> esetén alapértelmezett IRQ-k nem használhatóak.</p></div></td></tr></tbody></table></div><div class="literalblock programlisting"><div class=content><pre># párhuzamos port
device          ppc</pre></div></div><div class=paragraph><p>Ez az ISA busz párhuzamos portjának felülete.</p></div><div class="literalblock programlisting"><div class=content><pre>device          ppbus      # a párhuzamos port busza (kell)</pre></div></div><div class=paragraph><p>A párhuzamos porthoz tartozó busz támogatása.</p></div><div class="literalblock programlisting"><div class=content><pre>device          lpt        # nyomtató</pre></div></div><div class=paragraph><p>A párhuzamos portra csatlakozó nyomtatók támogatása.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>A fentiek közül mind a három szükséges a párhuzamos porton csatlakozó nyomtatók használatához.</p></div></td></tr></tbody></table></div><div class="literalblock programlisting"><div class=content><pre>device          plip       # TCP/IP párhuzamos porton keresztül</pre></div></div><div class=paragraph><p>Ez a párhuzamos port hálózati felületének meghajtója.</p></div><div class="literalblock programlisting"><div class=content><pre>device          ppi        # a párhuzamos port felületének eszköze</pre></div></div><div class=paragraph><p>Általános célú ("geek port") és IEEE1284 I/O.</p></div><div class="literalblock programlisting"><div class=content><pre>#device         vpo        # az scbus és a da kell a használatához</pre></div></div><div class=paragraph><p>Ez az Iomega Zip meghajtóihoz tartozó eszköz. A mûködéséhez szükség van az <code>scbus</code> és <code>da</code> engedélyezésére. A legjobb teljesítményt EPP 1.9 módban mûködõ portokkal lehet kihozni belõle.</p></div><div class="literalblock programlisting"><div class=content><pre>#device         puc</pre></div></div><div class=paragraph><p>Tegyük bele a konfigurációba ezt az eszközt, ha egy olyan "buta" soros vagy párhuzamos PCI kártyánk van, amelyet a <a href="https://man.freebsd.org/cgi/man.cgi?query=puc&amp;sektion=4&amp;format=html">puc(4)</a> segédmeghajtó ismer.</p></div><div class="literalblock programlisting"><div class=content><pre># PCI Ethernet kártyák
device          de         # DEC/Intel DC21x4x (Tulip)
device          em         # Intel PRO/1000 Gigabit Ethernet kártya
device          ixgb       # Intel PRO/10GbE Ethernet kártya
device          txp        # 3Com 3cR990 (Typhoon)
device          vx         # 3Com 3c590, 3c595 (Vortex)</pre></div></div><div class=paragraph><p>Különféle PCI hálózati kártyák meghajtói. Vegyük ki azokat, amelyek nem találhatóak meg a rendszerünkben.</p></div><div class="literalblock programlisting"><div class=content><pre># PCI Ethernet kártyák, melyek az MII busz vezérlõkódját használják
# FIGYELEM: Ne töröljük ki a &#39;device miibus&#39; sort, ha ilyen kártyánk van!
device          miibus     # az MII busz támogatása</pre></div></div><div class=paragraph><p>Az MII busz engedélyezése elengedhetetlen bizonyos 10/100-as PCI Ethernet kártyák használatához, konkrétan azokéhoz, amelyek az MII-vel együttmûködni képes adó-vevõt használnak vagy az MII-höz hasonló adó-vevõ vezérlõ felületet valósítanak meg. A <code>device miibus</code> hozzáadása a rendszermaghoz magával vonja az általános miibus API és az összes PHY meghajtó támogatását, beleértve azt az általános PHY eszközt is, amelyet az egyes eszközmeghajtók külön nem támogatnak.</p></div><div class="literalblock programlisting"><div class=content><pre>device          bce        # Broadcom BCM5706/BCM5708 Gigabit Ethernet
device          bfe        # Broadcom BCM440x 10/100 Ethernet
device          bge        # Broadcom BCM570xx Gigabit Ethernet
device          dc         # DEC/Intel 21143 és egyéb hasonlóak
device          fxp        # Intel EtherExpress PRO/100B (82557, 82558)
device          lge        # Level 1 LXT1001 gigabit ethernet
device          msk        # Marvell/SysKonnect Yukon II Gigabit Ethernet
device          nge        # NatSemi DP83820 gigabit ethernet
device          nve        # nVidia nForce MCP integrált Ethernet hálózat
device          pcn        # AMD Am79C97x PCI 10/100 (az &#39;lnc&#39; elõtt)
device          re         # RealTek 8139C+/8169/8169S/8110S
device          rl         # RealTek 8129/8139
device          sf         # Adaptec AIC-6915 (Starfire)
device          sis        # Silicon Integrated Systems SiS 900/SiS 7016
device          sk         # SysKonnect SK-984x &amp; SK-982x gigabit Ethernet
device          ste        # Sundance ST201 (D-Link DFE-550TX)
device          stge       # Sundance/Tamarack TC9021 gigabit Ethernet
device          ti         # Alteon Networks Tigon I/II gigabit Ethernet
device          tl         # Texas Instruments ThunderLAN
device          tx         # SMC EtherPower II (83c170 EPIC)
device          vge        # VIA VT612x gigabit ethernet
device          vr         # VIA Rhine, Rhine II
device          wb         # Winbond W89C840F
device          xl         # 3Com 3c90x (Boomerang, Cyclone)</pre></div></div><div class=paragraph><p>Meghajtók, melyek az MII busz vezérlõkódját használják.</p></div><div class="literalblock programlisting"><div class=content><pre># ISA Ethernet és pccard hálózati kártyák.
device          cs         # Crystal Semiconductor CS89x0 NIC
# az &#39;device ed&#39; eszközhöz kell a &#39;device miibus&#39;
device          ed         # NE[12]000, SMC Ultra, 3c503, DS8390 cards
device          ex         # Intel EtherExpress Pro/10 és Pro/10+
device          ep         # Etherlink III alapú kártyák
device          fe         # Fujitsu MB8696x alapú kártyák
device          ie         # EtherExpress 8/16, 3C507, StarLAN 10 stb.
device          lnc        # NE2100, NE32-VL Lance Ethernet kártyák
device          sn         # az SMC 9000-res sorozatú Ethernet chipjei
device          xe         # Xircom pccard Ethernet

# ISA eszközök, melyek a régi ISA betétet használják
#device         le</pre></div></div><div class=paragraph><p>ISA Ethernet meghajtók. A konkrétan támogatott kártyák teljes felsorolását lásd a <span class=filename>/usr/src/sys/i386/conf/NOTES</span> állományban.</p></div><div class="literalblock programlisting"><div class=content><pre># vezeték nélküli hálózati kártyák
device          wlan            # 802.11 támogatás</pre></div></div><div class=paragraph><p>Általános 802.11 támogatás. Erre a sorra mindenképpen szükség van a vezeték nélküli hálózatok használatához.</p></div><div class="literalblock programlisting"><div class=content><pre>device          wlan_wep        # 802.11 WEP támogatás
device          wlan_ccmp       # 802.11 CCMP támogatás
device          wlan_tkip       # 802.11 TKIP támogatás</pre></div></div><div class=paragraph><p>A 802.11 eszközök esetén a titkosítás támogatása. Ezeket a sorokat akkor adjuk meg, ha titkosítást akarunk használni vagy a 802.11i biztonsági protokolljait.</p></div><div class="literalblock programlisting"><div class=content><pre>device          an         # Aironet 4500/4800 802.11 vezeték nélküli hálózati kártyák
device          ath             # Atheros pci/cardbus hálózati kártyák
device          ath_hal         # Atheros HAL (Hardware Access Layer)
device          ath_rate_sample # küldési mintavételi vezérlés az ath-hoz
device          awi        # BayStack 660 és mások
device          ral        # Ralink Technology RT2500 vezeték nélküli hálózati kártyák
device          wi         # WaveLAN/Intersil/Symbol 802.11 vezeték nélküli hálózati kártyák
#device         wl         # régebbi, nem 802.11 Wavelan vezeték nélküli hálózati kártyák</pre></div></div><div class=paragraph><p>A különbözõ vezeték nélküli kártyák támogatása.</p></div><div class="literalblock programlisting"><div class=content><pre># Pszeudo eszközök
device   loop          # hálózati loopback</pre></div></div><div class=paragraph><p>Ez a TCP/IP általános loopback eszköze. Ha telnettel vagy FTP-vel rácsatlakozunk a <code>localhost</code> címére (vagyis a <code>127.0.0.1</code>-re), akkor rajta keresztül saját magunkhoz jutunk vissza. Ennek a megléte <em>kötelezõ</em>!</p></div><div class="literalblock programlisting"><div class=content><pre>device   random        # álvéletlenszám eszköz</pre></div></div><div class=paragraph><p>Kriptográfiai szempontból biztonságos álvéletlenszám generátor.</p></div><div class="literalblock programlisting"><div class=content><pre>device   ether         # Ethernet támogatás</pre></div></div><div class=paragraph><p>Az <code>ether</code> eszközre csak abban az esetben van szükség, ha Ethernet kártyánk van. Ez magában foglalja az általános Ethernet protokoll kódját.</p></div><div class="literalblock programlisting"><div class=content><pre>device   sl            # belsõ SLIP</pre></div></div><div class=paragraph><p>Az <code>sl</code> a SLIP használatát engedélyezi. Ez egy régi protokoll, amelyet azóta már szinte teljesen kiszorított a PPP, mivel azt könnyebb beállítani és sokkal jobban is illik a modem-modem kapcsolatokhoz, illetve sokkal erõteljesebb.</p></div><div class="literalblock programlisting"><div class=content><pre>device   ppp           # belsõ PPP</pre></div></div><div class=paragraph><p>Ez a tárcsázós kapcsolatok rendszermagon belüli PPP támogatását adja meg. Van a PPP-nek egy külsõ, a felhasználói programként megvalósított változata is, amely a <code>tun</code> eszközt használja és sokkal nagyobb rugalmasságot kínál fel, illetve olyan lehetõségeket, mint például az igény szerinti tárcsázás.</p></div><div class="literalblock programlisting"><div class=content><pre>device   tun           # csomag alagút</pre></div></div><div class=paragraph><p>Ezt a felhasználói PPP szoftver használja. A könyv <a href=./#userppp>PPP</a>-rõl szóló részében többet is megtudhatunk róla.</p></div><div class="literalblock programlisting"><div class=content><pre>device   pty           # Pszeudo terminálok (telnet stb.)</pre></div></div><div class=paragraph><p>Ezek a "pszeudo terminálok", vagy más néven szimulált bejelentkezési portok. A bejövõ <code>telnet</code> és <code>rlogin</code> munkamenetek használják, valamint az xterm és a hozzá hasonló alkalmazások, mint például az Emacs.</p></div><div class="literalblock programlisting"><div class=content><pre>device   md            # memórialemezek</pre></div></div><div class=paragraph><p>A memóriában levõ pszeudo lemezes meghajtók.</p></div><div class="literalblock programlisting"><div class=content><pre>device   gif           # IPv6 és IPv4 tunnelek használata</pre></div></div><div class=paragraph><p>Megvalósítja az IPv6 IPv4 feletti, az IPv4 IPv6 feletti, az IPv4 IPv4 feletti és az IPv6 IPv6 feletti közvetítését. A <code>gif</code> eszköz "magától másolódik", vagyis szükség szerint hozza létre a megfelelõ eszközleírókat.</p></div><div class="literalblock programlisting"><div class=content><pre>device   faith         # IPv6-IPv4 közti továbbítás (fordítás)</pre></div></div><div class=paragraph><p>Ez a pszeudo eszköz elfogja a hozzá küldött csomagokat és átadja ezeket az IPv4/IPv6 fordítással foglalkozó démonnak.</p></div><div class="literalblock programlisting"><div class=content><pre># a `bpf&#39; eszköz használatával a Berkeley csomagszûrõt (Berkeley Packet Filter) engedélyezzük
# Legyünk rá tekintettel, hogy ennek komoly következményei lehetnek
# rendszeradminisztrációs szempontból!
# A &#39;bpf&#39;-re szükség van a DHCP-hez.
device   bpf           # Berkeley csomagszûrõ</pre></div></div><div class=paragraph><p>A Berkeley csomagszûrõje. Ez egy olyan pszeudo eszköz, amely lehetõvé teszi, hogy a hálózati csatolók forgalmát megfigyeljük, mivel a (pl. Ethernet) hálózatunkon minden csomagot elkap. Ezek a csomagok lemezre is menthetõek vagy kielemezhetõek a <a href="https://man.freebsd.org/cgi/man.cgi?query=tcpdump&amp;sektion=1&amp;format=html">tcpdump(1)</a> program segítségével.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>A <a href="https://man.freebsd.org/cgi/man.cgi?query=bpf&amp;sektion=4&amp;format=html">bpf(4)</a> eszközt a <a href="https://man.freebsd.org/cgi/man.cgi?query=dhclient&amp;sektion=8&amp;format=html">dhclient(8)</a> is használja többek közt az alapértelmezett átjáró IP-címének megszerzéséhez. Ha DHCP-t akarunk használni, hagyjuk így.</p></div></td></tr></tbody></table></div><div class="literalblock programlisting"><div class=content><pre># USB támogatás
device          uhci          # UHCI PCI-&gt;USB felület
device          ohci          # OHCI PCI-&gt;USB felület
device          ehci          # EHCI PCI-&gt;USB felület (USB 2.0)
device          usb           # USB busz (kell)
#device         udbp          # USB Double Bulk Pipe eszközök
device          ugen          # általános
device          uhid          # Human Interface Devices
device          ukbd          # billentyûzet
device          ulpt          # nyomtató
device          umass         # lemez/háttértároló - kell hozzá az scbus és a da
device          ums           # egér
device          ural          # Ralink Technology RT2500USB vezeték nélküli hálózati kártyák
device          urio          # Diamond Rio 500 MP3 lejátszó
device          uscanner      # lapolvasók
# USB Ethernet, kell hozzá az mii
device          aue           # ADMtek USB Ethernet
device          axe           # ASIX Electronics USB Ethernet
device          cdce          # általános USB, Etherneten keresztül
device          cue           # CATC USB Ethernet
device          kue           # Kawasaki LSI USB Ethernet
device          rue           # RealTek RTL8150 USB Ethernet</pre></div></div><div class=paragraph><p>A különféle USB eszközök támogatása.</p></div><div class="literalblock programlisting"><div class=content><pre># FireWire támogatás
device          firewire      # FireWire buszkód
device          sbp           # SCSI FireWire-ön keresztül (kell hozzá az scbus és a da)
device          fwe           # Ethernet FireWire-ön keresztül (nem szabványos!)</pre></div></div><div class=paragraph><p>A különféle Firewire eszközök támogatása.</p></div><div class=paragraph><p>A FreeBSD által ismert további eszközökrõl a <span class=filename>/usr/src/sys/i386/conf/NOTES</span> állományból tájékozódhatunk.</p></div><div class=sect3><h4 id=_sok_memória_kezelése_pae>8.6.1. Sok memória kezelése (PAE)<a class=anchor href=#_sok_memória_kezelése_pae></a></h4><div class=paragraph><p>A sok memóriával rendelkezõ számítógépek esetén szükség lehet a felhasználói és rendszerszintû virtuális címek (Kernel Virtual Address, KVA) 4 gigabyte feletti használatára. Ennek a korlátozásnak a kiküszöbölésére az Intel® külön támogatást épített be a Pentium® Pro és az azt követõ processzorok 36 bites fizikai címzésének kialakításához.</p></div><div class=paragraph><p>A Fizikai Címkiterjesztés (Physical Address Extension, PAE) az Intel® Pentium® Pro és késõbbi processzoraiban található meg, és lehetõvé teszi egészen 64 gigabyte-ig a memóriahasználatot. A FreeBSD is támogatja ezt a tulajdonságot a <code>PAE</code> rendszermag beállítás használatával, és megtalálható a FreeBSD összes jelenlegi verziójában. Az Intel® architektúrájú processzorok memóriaszervezésének korlátai miatt nem különböztethetõ meg a 4 gigabyte alatti és feletti memória. A 4 gigabyte felett található memóriaterületek egyszerûen hozzáadódnak a rendelkezésre álló memóriához.</p></div><div class=paragraph><p>A rendszermagban a PAE támogatását egyszerûen az alábbi sor hozzáadásával tudjuk engedélyezni:</p></div><div class="literalblock programlisting"><div class=content><pre>options          PAE</pre></div></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>A FreeBSD-ben a PAE támogatása csak az Intel® IA-32 architektúrájú processzoraihoz érhetõ el. Emellett meg kell említenünk, hogy a FreeBSD-ben található PAE támogatás nem lett szélesebb körben próbára téve, ezért a FreeBSD többi megbízható elemeihez képest csak béta állapotúnak tekinthetõ.</p></div></td></tr></tbody></table></div><div class=paragraph><p>A FreeBSD PAE támogatásának van néhány hiányossága:</p></div><div class=ulist><ul><li><p>Egy futó program a virtuális memóriában nem képes 4 gigabyte-nál többet elérni.</p></li><li><p>A <a href="https://man.freebsd.org/cgi/man.cgi?query=bus_dma&amp;sektion=9&amp;format=html">bus_dma(9)</a> felületet nem használó eszközmeghajtók adathibákat okozhatnak a PAE-t támogató rendszermagokban, és emiatt nem ajánljuk a használatukat. Ebbõl a megfontolásból készítettünk egy <span class=filename>PAE</span> nevû konfigurációs állományt a FreeBSD-hez, amelyben nem szerepel egyetlen olyan meghajtó sem, amely ismereteink szerint nem mûködik együtt a PAE-t támogató rendszermagokkal.</p></li><li><p>Bizonyos finomhangolási beállítások a memóriahasználatot a rendelkezésre álló fizikai memória mennyiségébõl számítják ki. A PAE támogatással mûködõ rendszerek esetében megjelenõ sok memória miatt azonban az ilyen eszközök szükségtelenül több területet foglalhatnak le. Erre példa lehet a <code>kern.maxvnodes</code> sysctl változó, amely a rendszermag által maximálisan felhasználható virtuális csomópontok számát korlátozza. Ajánlott tehát az ilyen és ehhez hasonló beállítások értelmes értékre történõ visszaállítása.</p></li><li><p>Szükséges lehet a rendszermag virtuális címterének (KVA) növelése vagy a rendszermag által túlságosan nagy méretûre foglalt címterû különféle erõforrások (lásd fentebb) csökkentése a KVA kifogyásának elkerülésére. A KVA területének növelését a <code>KVA_PAGES</code> beállításával tehetjük meg.</p></li></ul></div><div class=paragraph><p>Ha gondjaink lennének a teljesítménnyel vagy a megbízhatósággal, keressük fel a <a href="https://man.freebsd.org/cgi/man.cgi?query=tuning&amp;sektion=7&amp;format=html">tuning(7)</a> man oldalt. A <a href="https://man.freebsd.org/cgi/man.cgi?query=pae&amp;sektion=4&amp;format=html">pae(4)</a> man oldalon pedig a FreeBSD PAE támogatásáról találhatunk naprakész információkat.</p></div></div></div><div class=sect2><h3 id=kernelconfig-trouble>8.7. Ha valamilyen hiba történne<a class=anchor href=#kernelconfig-trouble></a></h3><div class=paragraph><p>Négyféle probléma jelentkezhet egy saját rendszermag készítése során. Ezek:</p></div><div class=dlist><dl><dt class=hdlist1>A <code>config</code> hibát jelez</dt><dd><p>Amikor a <a href="https://man.freebsd.org/cgi/man.cgi?query=config&amp;sektion=8&amp;format=html">config(8)</a> parancs hibát jelez vissza a rendszermagunk konfigurációs beállításainak feldolgozása során, akkor minden bizonnyal csak egy apró hibát vétettünk valahol. Szerencsére a <a href="https://man.freebsd.org/cgi/man.cgi?query=config&amp;sektion=8&amp;format=html">config(8)</a> kiírja a hibás sor számát, ezért gyorsan fel tudjuk kutatni a hibát tartalmazó sort. Például, ha ezt látjuk:</p><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>config: line 17: syntax error</code></pre></div></div><div class=paragraph><p>Akkor gyõzõdjünk meg róla, hogy helyesen írtuk be az adott sorban szereplõ kulcsszót. Ebben segítségünkre lehet, ha összevetjük a <span class=filename>GENERIC</span> konfigurációs állománnyal vagy más hivatkozásokkal.</p></div></dd><dt class=hdlist1>A <code>make</code> hibát jelez</dt><dd><p>Ha a <code>make</code> jelez hibát, az általában arra utal, hogy az általunk korábban megadott rendszermag konfigurációs állományt a <a href="https://man.freebsd.org/cgi/man.cgi?query=config&amp;sektion=8&amp;format=html">config(8)</a> nem értette meg rendesen. Megint azt tudjuk csak javasolni, hogy nézzük át a konfigurációs beállításainkat, és ha ezután sem sikerül megoldani a problémát, akkor mellékeljük egy levélben a rendszermagunk konfigurációs beállításait és küldjük el a <a href=https://lists.FreeBSD.org/subscription/freebsd-questions>FreeBSD general questions levelezési lista</a> címére, ahol a hozzáértõk gyorsan átnézik.</p><div class=dlist><dl><dt class=hdlist1>A rendszermag nem indul:<a id=kernelconfig-noboot></a></dt><dd><p>Ha az új rendszermagunk nem indul vagy nem képes felismerni az eszközeinket, ne essünk kétségbe! Szerencsére a FreeBSD tökéletes megoldással tud szolgálni az összeférhetetlen rendszermagok esetére: a FreeBSD rendszerbetöltõjében egyszerûen válasszuk ki az indítandó rendszermagot. Ezt akkor tudjuk elõhívni, amikor a rendszerindító menü megjelenik. Válasszuk ki a hatos, vagyis az "Escape to a loader prompt" (a betöltõ parancssorának elõhívása) menüpontot. Mikor megjelenik a parancssor, írjuk be, hogy <code>unload kernel</code>, majd adjuk ki a <code>boot /boot/kernel.old/kernel</code>, parancsot, amiben bármilyen más olyan rendszermagot is megnevezhetünk, ami korábban már mûködött. Ezért amikor beállítunk egy új rendszermagot, mindig érdemes a kezünk ügyében tartani legalább egy olyan rendszermagot, amely mûködik.</p><div class=paragraph><p>Miután sikerült elindítanunk az egyik használható rendszermagot, nézzük át még egyszer a konfigurációs állományt és próbáljuk újra lefordítani a rendszermagot. A probléma megoldását segítheti a <span class=filename>/var/log/messages</span> állomány áttanulmányozása is, ami többek közt rögzíti a rendszermag sikeres indulása során keletkezõ üzeneteket. Ezenkívül a <a href="https://man.freebsd.org/cgi/man.cgi?query=dmesg&amp;sektion=8&amp;format=html">dmesg(8)</a> parancs is meg tudja jeleníteni az aktuális rendszerindítás üzeneteit.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Ha gondok merülnének fel a rendszermag elkészítése során, mindenképpen tartsuk meg a <span class=filename>GENERIC</span>, vagy bármilyen másik olyan rendszermagot, amelyrõl tudjuk, hogy mûködik. Nevezzük át, így nem fog felülíródni a következõ fordítás és telepítés során. A <span class=filename>kernel.old</span> állományra ugyanis nem minden esetben számíthatunk, mivel az új rendszermagok telepítésénél a <span class=filename>kernel.old</span> mindig felülíródik a legutóbb telepített rendszermaggal, amely azonban nem feltétlenül lesz mûködõképes. Sõt, amint csak lehetséges, rakjuk a mûködõ rendszermagot a <span class=filename>/boot/kernel</span> könyvtárba vagy különben a <a href="https://man.freebsd.org/cgi/man.cgi?query=ps&amp;sektion=1&amp;format=html">ps(1)</a> és a hozzá hasonló parancsok nem fognak rendesen mûködni. Mindezek elvégzéséhez egyszerûen nevezzük át a jó rendszermagot tartalmazó könyvtárt:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># mv /boot/kernel /boot/kernel.rossz</span>
<span class=c># mv /boot/kernel.jó /boot/kernel</span></code></pre></div></div></td></tr></tbody></table></div></dd></dl></div></dd><dt class=hdlist1>A rendszermag mûködik, a <a href="https://man.freebsd.org/cgi/man.cgi?query=ps&amp;sektion=1&amp;format=html">ps(1)</a> viszont nem</dt><dd><p>Ha olyan rendszermagot telepítettünk, aminek a verziója nem egyezik meg a hozzá tartozó segédprogramokéval, tehát például -CURRENT rendszermagot raktunk egy -RELEASE rendszerhez, egyes rendszerállapotjelzõ parancsok, mint például a <a href="https://man.freebsd.org/cgi/man.cgi?query=ps&amp;sektion=1&amp;format=html">ps(1)</a> vagy a <a href="https://man.freebsd.org/cgi/man.cgi?query=vmstat&amp;sektion=8&amp;format=html">vmstat(8)</a> nem fognak mûködni. Ebben az esetben <a href=./#makeworld>az egész rendszert újra kell fordítanunk és telepítenünk</a> a rendszermagunkkal megegyezõ verziójú forrásból. Részben ezért sem különösen ajánlott, hogy az operációs rendszer többi részétõl eltérõ verziójú rendszermagot használjunk.</p></dd></dl></div></div></div></div><div class=sect1><h2 id=printing>Chapter 9. Nyomtatás<a class=anchor href=#printing></a></h2><div class=sectionbody><div class=sect2><h3 id=printing-synopsis>9.1. Áttekintés<a class=anchor href=#printing-synopsis></a></h3><div class=paragraph><p>A FreeBSD a nyomtatók széles skálájával képes együttmûködni, a legrégebbi vegyszeres nyomtatótól kezdve egészen napjaink lézernyomtatójáig, aminek köszönhetõen alkalmazásainkkal nagyon jó minõségû nyomtatásokat tudunk készíteni.</p></div><div class=paragraph><p>A FreeBSD a helyi hálózaton nyomtatószervernek is beállítható. Ekkor a vele közös hálózatra csatlakozó többi, FreeBSD, Windows® vagy Mac OS® rendszerû számítógéptõl képes nyomtatási kéréseket elfogadni. A FreeBSD gondoskodik róla, hogy egyszerre csak egy nyomtatás készüljön el, számon tartja, hogy mely felhasználók és számítógépek nyomtatnak a legtöbbet, és minden feladathoz "munkalapot" (banner page) készít, amiben többek közt megtalálhatjuk, hogy kihez tartozik.</p></div><div class=paragraph><p>A fejezet elolvasása során megismerjük:</p></div><div class=ulist><ul><li><p>hogyan állítsuk be a FreeBSD nyomtatási sorát;</p></li><li><p>hogyan telepítsünk nyomtatási szûrõket, hogyan kezeljünk különbözõ speciális nyomtatási feladatokat, tehát például miként alakítsuk át a beérkezõ dokumentumokat olyan nyomtatási formátumra, amelyet a nyomtatónk is megért;</p></li><li><p>hogyan engedélyezzük a fejléc- vagy nyomtatási információk kinyomtatását;</p></li><li><p>hogyan nyomtassunk más számítógépekhez csatlakoztatott nyomtatókkal;</p></li><li><p>hogyan nyomtassunk a hálózatra közvetlenül kapcsolt nyomtatókkal;</p></li><li><p>hogyan állítsuk be a nyomtatási korlátozásokat, például a nyomtatási feladatok méretét, amivel egyes felhasználók nyomtatását visszafoghatjuk;</p></li><li><p>hogyan készítsünk nyomtatási kimutatásokat és nyilvántartást a nyomtató használatáról;</p></li><li><p>hogyan keressük meg a nyomtatás során felmerülõ problémák okait.</p></li></ul></div><div class=paragraph><p>A fejezet elolvasásához ajánlott:</p></div><div class=ulist><ul><li><p>egy új rendszermag beállításának és telepítésének ismerete (<a href=./#kernelconfig>A FreeBSD rendszermag testreszabása</a>).</p></li></ul></div></div><div class=sect2><h3 id=printing-intro-spooler>9.2. Bevezetés<a class=anchor href=#printing-intro-spooler></a></h3><div class=paragraph><p>A FreeBSD-ben a nyomtatók mûködéséhez be kell állítani az LPD nyomtatási rendszert. Ez a Berkeley sornyomtatási rendszere, amelyet ezentúl röviden csak LPD-nek fogunk hívni. Ez a FreeBSD alapértelmezett szabványos nyomtatásvezérlõ rendszere. Ebben a fejezetben az LPD és annak konfigurációja kerül bemutatásra.</p></div><div class=paragraph><p>Ha már találkoztunk az LPD-vel vagy hozzá hasonló rendszerekkel, akkor innen nyugodtan ugorhatunk a <a href=#printing-intro-setup>Kezdeti beállítások</a> címû szakaszra.</p></div><div class=paragraph><p>Az LPD vezérli a számítógéphez csatlakoztatott nyomtató összes funkcióját. Számos feladata van:</p></div><div class=ulist><ul><li><p>Felügyeli a lokálisan és hálózaton keresztül csatlakoztatott nyomtatók hozzáféréseit.</p></li><li><p>Lehetõvé teszi az átküldött állományok kinyomtatását, amelyeket <em>nyomtatási feladatoknak</em> nevezünk.</p></li><li><p>Minden nyomtatóhoz fenntart egy nyomtatási <em>sort</em>, amivel meg tudja akadályozni, hogy egyszerre több felhasználó is hozzá tudjon férni az egyes nyomtatókhoz.</p></li><li><p>A <em>fejléceket</em> (vagy más néven <em>munka-</em> vagy <em>elválasztó lapokat</em>) nyomtat, így a felhasználók könnyen megtalálják a saját nyomtatásaikat a többi közt.</p></li><li><p>Felügyeli a soros portokon csatlakozó nyomtatók kommunikációs beállításait.</p></li><li><p>A hálózaton keresztül átküldi a nyomtatási feladatokat egy másik számítógép LPD sorába.</p></li><li><p>A nyomtatási feladatok formázásához lefuttatja az adott nyomtató nyelvéhez és képességeihez illeszkedõ speciális szûrõket.</p></li><li><p>Nyilvántartja a nyomtató kihasználtságát.</p></li></ul></div><div class=paragraph><p>A beállításait tartalmazó állomány (<span class=filename>/etc/printcap</span>) és a speciális szûrõprogramok segítségével az LPD sokféle nyomtatón képes az összes említett feladatot vagy annak egy részét megvalósítani.</p></div><div class=sect3><h4 id=printing-intro-why>9.2.1. Amiért nyomtatási sort érdemes használni<a class=anchor href=#printing-intro-why></a></h4><div class=paragraph><p>Amikor csak egyedül vagyunk a rendszerben, felmerülhet bennünk a kérdés, hogy minek is kellene nekünk veszõdni a nyomtatási sor beállításával, hiszen nincs szükségünk sem a hozzáférések vezérlésére, sem fejlécekre, sem pedig nyilvántartásra. Noha akár közvetlenül is el tudjuk érni a nyomtatót, néhány okból azért mégis érdemes nyomtatási sort használni:</p></div><div class=ulist><ul><li><p>Az LPD a háttérben nyomtat, ezért ilyenkor nem kell megvárni, amíg az adat átmásolódik a nyomtatóra.</p></li><li><p>Az LPD tetszõlegesen tudja alakítani a nyomtatási feladatokat: hozzájuk tud tenni különbözõ adatokat (dátum és idõ), vagy a speciális állományokat (például a TeX DVI formátumát) képes megértetni a nyomtatóval, és nem nekünk kell mindezeket a lépéseket elvégeznünk.</p></li><li><p>Számos nyomtatási lehetõséggel rendelkezõ szabad és kereskedelmi program arra számít, hogy a rendszerünkben nyomtatási sor található, ezért annak beállításával sokkal könnyebb használni ezeket a szoftvereket.</p></li></ul></div></div></div><div class=sect2><h3 id=printing-intro-setup>9.3. Kezdeti beállítások<a class=anchor href=#printing-intro-setup></a></h3><div class=paragraph><p>Úgy tudjuk használni a nyomtatókat az LPD nyomtatási rendszerével, ha egyaránt beállítjuk a nyomtatót és magát az LPD-t is. Itt a beállítás két szintjét tárgyaljuk:</p></div><div class=ulist><ul><li><p>Az <a href=#printing-simple>Alacsonyszintû nyomtatóbeállítás</a> címû szakaszból megtudhatjuk, hogyan tudunk csatlakoztatni egy nyomtatót, hogyan adjuk meg az LPD-nek, miként kommunikáljon vele, hogyan nyomtassunk ki egyszerû szöveges állományokat a nyomtatón.</p></li><li><p>A <a href=#printing-advanced>Magasszintû nyomtatóbeállítás</a> szakaszban bemutatjuk, hogyan nyomtassunk ki különféle speciális állományokat, hogyan készíttessünk fejléceket, hogyan nyomtassunk hálózaton keresztül, hogyan vezéreljük a nyomtatók hozzáférését és hogyan tartsuk nyilván a nyomtató használatát.</p></li></ul></div><div class=sect3><h4 id=printing-simple>9.3.1. Alacsonyszintû nyomtatóbeállítás<a class=anchor href=#printing-simple></a></h4><div class=paragraph><p>Ebben a szakaszban láthatjuk, miképpen kell beállítani a nyomtatónkat és az LPD hogyan lesz képes azt használatba venni. Az alapoktól kezdünk:</p></div><div class=ulist><ul><li><p>A <a href=#printing-hardware>Hardveres beállítás</a> címû szakaszban abban kapunk segítséget, hogyan kell a nyomtatót a számítógéphez csatlakoztatni.</p></li><li><p>A <a href=#printing-software>Szoftveres beállítás</a> címû szakaszban az LPD nyomtatási rendszer beállítását tartalmazó állományt (<span class=filename>/etc/printcap</span>) vesszük sorra.</p></li></ul></div><div class=paragraph><p>Amennyiben olyan nyomtatót akarunk beállítani, amely nem helyileg, hanem valamilyen hálózati protokollon keresztül csatlakozik, nézzük meg a <a href=#printing-advanced-network-net-if>Nyomtatók hálózati adatcsatlakozással</a> címû szakaszt.</p></div><div class=paragraph><p>Habár ez a szakasz nevében csupán "Alacsonyszintû nyomtatóbeállításról" szól, meglehetõsen szerteágazó tud lenni. A nyomtató hardveres és szoftveres életre keltése az egyik legnehezebb feladat. Ha van egy mûködõ nyomtatónk, a fejlécek és a nyilvántartás beállítása tulajdonképpen már gyerekjáték.</p></div><div class=sect4><h5 id=printing-hardware>9.3.1.1. Hardveres beállítás<a class=anchor href=#printing-hardware></a></h5><div class=paragraph><p>Ebben a szakaszban a nyomtatók csatlakoztatásának lehetséges módozatairól esik szó. Beszélni fogunk mindenféle portokról és kábelekrõl, és a FreeBSD rendszermagjának az egyes nyomtatók használatához szükséges beállításairól is.</p></div><div class=paragraph><p>Ha korábban tudtuk csatlakoztatni a nyomtatónkat, és más operációs rendszerekkel már sikeresen nyomtattunk is vele, akkor rögtön ugorhatunk is a <a href=#printing-software>Szoftveres beállítás</a>okat tartalmazó szakaszra.</p></div><div class=sect5><h6 id=printing-ports>9.3.1.1.1. Portok és kábelek<a class=anchor href=#printing-ports></a></h6><div class=paragraph><p>A személyi számítógépekhez kapható nyomtatók általában a következõ három csatolófelület egyikével rendelkeznek:</p></div><div class=ulist><ul><li><p>A <em>soros</em>, más néven RS-232-es vagy COM porton keresztül kommunikáló felületek a számítógép soros portján küldenek adatot a nyomtatónak. A soros csatolófelületek igen elterjedtek a számítógépiparban, könnyen tudunk ilyen kábelt szerezni, gyorsan is gyártható. Elõfordulhat, hogy a soros csatolófelületek használatához valamilyen különleges kábelre, valamint bonyolult kommunikációs beállítások megadására van szükség. A legtöbb soros port által elérhetõ legnagyobb adatátviteli sebesség másodpercenként 115 200 bit, ami miatt azonban a komolyabb grafikai tartalmak nyomtatása szinte lehetetlen.</p></li><li><p>A <em>párhuzamos</em> csatolófelületek a számítógépünk párhuzamos portjával küldenek adatokat a nyomtatónak. A párhuzamos felületek gyorsabbak az RS-232 soros felületnél, és a számítógéppiacon is gyakran megtalálhatóak. Könnyen tudunk ilyen kábelt szerezni, azonban kézileg nehezebb elkészíteni. A párhuzamos csatolófelületekhez általában nem tartoznak kommunikációs beállítások, ezért rendkívül egyszerûen el lehet boldogulni velük.</p><div class=paragraph><p>A párhuzamos felületekre olykor "Centronics" csatolófelületként is hivatkoznak, amelyet egy nyomtatótípus után neveztek el.</p></div></li><li><p>A Universal Serial Bus (Univerzális soros busz) rövidítéseként használt USB elnevezésû csatolófelület a párhuzamos és a soros felületeknél jóval nagyobb sebességre képes. A hozzá tartozó kábelek felépítése egyszerû és az áruk olcsó. Habár a nyomtatás terén az USB hivatott leváltani az RS-232-es soros és a párhuzamos felületeket, nem mindegyik UNIX® rendszer támogatja kellõképpen. Ezt a problémát például úgy kerülhetjük el, ha olyan nyomtatót vásárolunk, amelyen a legtöbbhöz hasonlóan a párhuzamos és az USB csatlakozás is megtalálható.</p></li></ul></div><div class=paragraph><p>A párhuzamos felületeken általában csak egy irányban tudunk üzeneteket küldeni (a számítógéptõl a nyomtatóhoz), miközben az USB és a soros felület használatával mind a két irányban is. FreeBSD alatt viszont már az újabb (EPP és ECP) párhuzamos portok egy IEEE 1284 szabványú kábellel képesek oda-vissza kommunikálni.</p></div><div class=paragraph><p>A párhuzamos nyomtatók kétirányú kommunikációját általában két mód közül az egyiken szokták megvalósítani. Az elsõ esetben a FreeBSD a nyomtatóhoz egy speciális meghajtót használ, amely ismeri az általa beszélt nyelvet. Ilyenek a tintasugaras nyomtatók, amelyek más egyéb állapotinformációk mellett ezen keresztül képesek jelezni a tintapatronokban levõ tinta mennyiségét. A második esetben a nyomtató ismeri a PostScript® nyelvet.</p></div><div class=paragraph><p>A PostScript® nyelvû nyomtatási feladatok valójában a nyomtatónak küldött programok. Használatukhoz még papírra sincs feltétlenül szükség, és elõfordulhat, hogy közvetlenül a számítógépnek válaszolnak. A PostScript® is kétirányú kommunikáción keresztül értesíti a számítógépet az olyan gondokról, mint például a PostScript® programokban levõ hibák vagy a papír beakadása, amely információnak a felhasználók szoktak örülni. Hovatovább ez a kétirányú kommunikáció a kulcsa a PostScript® nyomtatók hatékony nyilvántartásának is: egyszerûen lekérdezzük a nyomtatótól a lapszámlálót (ami megadja, hogy a nyomtató eddig mennyi lapot nyomtatott ki), kiküldjük a felhasználóhoz tartozó feladatot és ismét lekérdezzük a lapszámlálót. A két érték kivonásából tájékozódhatunk a felhasználó által igényelt lapok mennyiségérõl.</p></div></div><div class=sect5><h6 id=printing-parallel>9.3.1.1.2. Párhuzamos portok<a class=anchor href=#printing-parallel></a></h6><div class=paragraph><p>A párhuzamos csatolófelületen érintkezõ nyomtató használatához kapcsoljunk össze számítógépünket és nyomtatónkat egy párhuzamos kábellel. Az erre vonatkozó konkrét utasítások a nyomtató és/vagy a számítógép kézikönyvében olvashatóak.</p></div><div class=paragraph><p>Jegyezzük meg, hogy a számítógép melyik párhuzamos portjára csatlakoztattuk a kábelt. FreeBSD alatt az elsõ ilyen port a <span class=filename>ppc0</span> eszköz, a második pedig a <span class=filename>ppc1</span> eszköz lesz és így tovább. A nyomtatóeszköz elnevezése ugyanezt a sémát követi: a <span class=filename>/dev/lpt0</span> lesz az elsõ párhuzamos porton levõ nyomtató stb.</p></div></div><div class=sect5><h6 id=printing-serial>9.3.1.1.3. Soros portok<a class=anchor href=#printing-serial></a></h6><div class=paragraph><p>A soros csatolófelületet használó nyomtatók beüzemeléséhez elõször egy soros kábel segítségével kapcsoljuk össze a számítógépünkkel. Ennek pontos részleteit a nyomtató és/vagy a számítógépünk kézikönyvében találhatjuk meg.</p></div><div class=paragraph><p>Ha nem vagyunk benne biztosak, hogy milyen a "megfelelõ soros kábel", próbáljunk az alábbiak alapján dönteni:</p></div><div class=ulist><ul><li><p>A <em>modem</em> kábele a két oldalán levõ, egymásnak megfelelõ tüskéket közvetlenül összeköti. Ezt a típust nevezik "DTE-DCE" kábelnek.</p></li><li><p>A <em>null-modem</em> kábel bizonyos érintkezõket rendesen, másokat pedig fordítva köt össze (például a küldõt a fogadóval), illetve némelyeket rövidre zár közvetlenül a csatlakozón belül. Ez a típus a "DTE-DTE" kábel.</p></li><li><p>Néhány speciális nyomtató esetén elõfordul még a <em>soros nyomtató</em>kábel, amely leginkább a null-modem kábelekhez hasonlít, azonban az ott rövidre zárt csatornák itt a nekik megfelelõ érintkezõknek továbbítanak jeleket.</p></li></ul></div><div class=paragraph><p>Emellett még a nyomtató elõlapján vagy az alján található kapcsolók segítségével be kell állítanunk a nyomtatóhoz tartozó kommunikációs paramétereket is. Itt válasszuk azt a <code>bps</code> (a bitek száma másodpercenként) értéket, amelyet még a számítógépünk és a nyomtatónk is egyaránt képes támogatni. Válasszunk 7 vagy 8 adatbitet, páros, páratlan vagy kikapcsolt paritásbitet és 1 vagy 2 stopbitet. Ekkor tudjuk megadni a forgalomirányítási protokollt is: lehet kikapcsolt, XON/XOFF (ez az ún. "sávon belüli" vagy "szoftveres") forgalomirányítás. Ne felejtsük el ezeket a beállításokat a most következõ szoftveres beállítások elvégzése során sem.</p></div></div></div><div class=sect4><h5 id=printing-software>9.3.1.2. Szoftveres beállítás<a class=anchor href=#printing-software></a></h5><div class=paragraph><p>Ebben a fejezetben tárgyaljuk a FreeBSD-ben található LPD nyomtatási rendszer mûködéséhez és a nyomtatáshoz szükséges szoftveres beállításokat.</p></div><div class=paragraph><p>Íme az elvégzendõ lépések rövid vázlata:</p></div><div class="exampleblock procedure"><div class=content><div class="olist arabic"><ol class=arabic><li><p>Amennyiben szükséges, állítsuk be a rendszermagunkat a nyomtató által használt portra. Ehhez <a href=#printing-kernel>A rendszermag beállítása</a> szakaszban olvashatjuk el, mit is kell pontosan tenni.</p></li><li><p>Ha párhuzamos portot használunk, akkor állítsuk be, hogy a párhuzamos port miként fog kommunikálni. <a href=#printing-parallel-port-mode>A párhuzamos port kommunikációs módjának beállítása</a> címû szakasz tárja fel ennek részleteit.</p></li><li><p>Próbáljuk ki, hogy ezek után az operációs rendszer képes-e adatot küldeni a nyomtatónak. <a href=#printing-testing>A nyomtató kommunikációjának ellenõrzése</a> szakaszban kapunk erre pár javaslatot.</p></li><li><p>Az <span class=filename>/etc/printcap</span> állomány felhasználásával állítsuk be a nyomtatónkhoz az LPD-t. Errõl a fejezet további részei adnak majd felvilágosítást.</p></li></ol></div></div></div><div class=sect5><h6 id=printing-kernel>9.3.1.2.1. A rendszermag beállítása<a class=anchor href=#printing-kernel></a></h6><div class=paragraph><p>Az operációs rendszer magja eszközök egy adott csoportjával képes együttmûködni, amelyben a soros és párhuzamos felületen csatlakozó nyomtatók is megtalálhatóak. Azonban ha a rendszermag nem ismeri fel még valamelyiket, akkor a soros vagy párhuzamos portok használatához külön támogatásra van szükség.</p></div><div class=paragraph><p>Így tudjuk megnézni, hogy a jelenleg használt rendszermag támogatja-e a soros csatolófelületet:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># grep sioN /var/run/dmesg.boot</span></code></pre></div></div><div class=paragraph><p>Itt az <em>N</em> nullától kezdõdõen adja meg a soros port sorszámát. Amennyiben látunk valami ilyesmit:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>sio2 at port 0x3e8-0x3ef irq 5 on isa
sio2: <span class=nb>type </span>16550A</code></pre></div></div><div class=paragraph><p>Ez azt jelenti, hogy a rendszermag sikeresen észlelte a portot.</p></div><div class=paragraph><p>A párhuzamos csatolófelület támogatásáról így gyõzõdhetünk meg:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># grep ppcN /var/run/dmesg.boot</span></code></pre></div></div><div class=paragraph><p>Itt az <em>N</em> nullától kezdõdõen sorszámozza a párhuzamos portot. Ha eredményül valami hasonlót kapunk:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>ppc0: &lt;Parallel port&gt; at port 0x378-0x37f irq 7 on isa0
ppc0: SMC-like chipset <span class=o>(</span>ECP/EPP/PS2/NIBBLE<span class=o>)</span> <span class=k>in </span>COMPATIBLE mode
ppc0: FIFO with 16/16/8 bytes threshold</code></pre></div></div><div class=paragraph><p>Ez arra utal, hogy a rendszermagunk tud a portról.</p></div><div class=paragraph><p>Elõfordulhat azonban, hogy az operációs rendszer csak akkor fogja észrevenni a nyomtatásra használt soros vagy párhuzamos portot, ha átállítjuk a rendszermagunkat.</p></div><div class=paragraph><p>A soros port támogatásának beállításához olvassuk el a rendszermag beállításáról szóló szakaszt. A párhuzamos port támogatásához szintén olvassuk el ugyanazt a szakaszt <em>és</em> a most következõt.</p></div></div></div><div class=sect4><h5 id=printing-parallel-port-mode>9.3.1.3. A párhuzamos port kommunikációs módjának beállítása<a class=anchor href=#printing-parallel-port-mode></a></h5><div class=paragraph><p>A párhuzamos csatolófelület használata esetén választhatunk, hogy a FreeBSD milyen módon tartsa a kapcsolatot a nyomtatóval: megszakításokkal vezérelje (interrupt-driven), vagy esetleg folyamatosan kérdezgesse (polled). A FreeBSD általános meghajtója (<a href="https://man.freebsd.org/cgi/man.cgi?query=lpt&amp;sektion=4&amp;format=html">lpt(4)</a>) a <a href="https://man.freebsd.org/cgi/man.cgi?query=ppbus&amp;sektion=4&amp;format=html">ppbus(4)</a> alrendszert használja, ami a portot a <a href="https://man.freebsd.org/cgi/man.cgi?query=ppc&amp;sektion=4&amp;format=html">ppc(4)</a> meghajtón keresztül vezérli.</p></div><div class=ulist><ul><li><p>A <em>megszakítás alapú</em> módszer a GENERIC rendszermagban alapértelmezés. Ilyenkor az operációs rendszer egy megszakításkérés felhasználásával értesül arról, hogy a nyomtató mikor áll készen adatok fogadására.</p></li><li><p>A <em>lekérdezéses</em> módszer használata során az operációs rendszer folyamatosan érdeklõdik a nyomtató rendelkezésre állásáról. Amikor erre pozitív megerõsítést kap, akkor a rendszermag újabb adatokat küld.</p></li></ul></div><div class=paragraph><p>A megszakításos módszer valamivel gyorsabb, azonban cserébe lefoglal egy értékes IRQ vonalat. A HP újabb nyomtatói állítólag nem mûködnek megfelelõen ilyen módban, valamilyen (pillanatnyilag még nem teljesen tisztázott) idõzítési probléma miatt. Ezért az ilyen nyomtatóknak is valószínûleg a lekérdezéses módszert kell használniuk. Más nyomtatók pedig, habár mûködnek mind a két módszerrel, hihetetlenül lassúak a megszakításokkal.</p></div><div class=paragraph><p>Kétféleképpen állíthatjuk be a kommunikációs módot: a rendszermagon keresztül, vagy az <a href="https://man.freebsd.org/cgi/man.cgi?query=lptcontrol&amp;sektion=8&amp;format=html">lptcontrol(8)</a> segédprogrammal.</p></div><div class=paragraph><p><em>A rendszermagban így állíthatjuk be a kommunikációt:</em></p></div><div class="exampleblock procedure"><div class=content><div class="olist arabic"><ol class=arabic><li><p>Írjuk át a rendszermag beállításait tartalmazó állományt. Keressük meg benne a használt párhuzamos portnak megfelelõen a <code>ppc0</code>, <code>ppc1</code> (második párhuzamos port) vagy <code>ppc2</code> (harmadik párhuzamos port) bejegyzést, és engedélyezzük.</p><div class=ulist><ul><li><p>A megszakításos mód használatához nyissuk meg a <span class=filename>/boot/device.hints</span> állományt, és az <em>N</em> helyére írjuk be a</p><div class="literalblock programlisting"><div class=content><pre>hint.ppc.0.irq=&#34;N&#34;</pre></div></div><div class=paragraph><p>sorba a megfelelõ IRQ számát. A rendszermag beállításait tartalmazó állománynak tartalmaznia kell a <a href="https://man.freebsd.org/cgi/man.cgi?query=ppc&amp;sektion=4&amp;format=html">ppc(4)</a> meghajtót is:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>device ppc</code></pre></div></div></li><li><p>A lekérdezéses mód használatához a <span class=filename>/boot/device.hints</span> állományból távolítsuk el a következõ sort:</p><div class="literalblock programlisting"><div class=content><pre>hint.ppc.0.irq=&#34;N&#34;</pre></div></div><div class=paragraph><p>Némely esetben azonban ennyi még nem lesz elég a port lekérdezéses beállításához. Ugyanis ha a hozzá tartozó meghajtó az <a href="https://man.freebsd.org/cgi/man.cgi?query=acpi&amp;sektion=4&amp;format=html">acpi(4)</a>, akkor ez fogja felismerni, kezelni és a nyomtatóhoz tartozó portok hozzáférési módját vezérelni. A problémát ezért gyakran érdemes az <a href="https://man.freebsd.org/cgi/man.cgi?query=acpi&amp;sektion=4&amp;format=html">acpi(4)</a> beállításai között is keresni.</p></div></li></ul></div></li><li><p>Mentsük el az állományt. Konfiguráljuk be, fordítsuk le és telepítsük az új rendszermagot. Ennek pontos részleteit <a href=./#kernelconfig>a rendszermag beállításáról</a> szóló fejezetben olvashatjuk.</p></li></ol></div></div></div><div class=paragraph><p><em>A kommunikáció módjának beállítása</em> az <a href="https://man.freebsd.org/cgi/man.cgi?query=lptcontrol&amp;sektion=8&amp;format=html">lptcontrol(8)</a> programmal:</p></div><div class="exampleblock procedure"><div class=content><div class="olist arabic"><ol class=arabic><li><p>A megszakításos mód beállításához írjuk be:</p><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># lptcontrol -i -d /dev/lptN</span></code></pre></div></div><div class=paragraph><p>ahol az <code>lptN</code> a nyomtatóhoz tartozó eszköz neve.</p></div></li><li><p>A lekérdezéses mód beállításához írjuk be:</p><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># lptcontrol -p -d /dev/lptN</span></code></pre></div></div><div class=paragraph><p>ahol az <code>lptN</code> a nyomtatóhoz tartozó eszköz neve.</p></div></li></ol></div></div></div><div class=paragraph><p>Ha ezeket a parancsokat berakjuk az <span class=filename>/etc/rc.local</span> állományunkba, akkor azzal a rendszer minden egyes indítása során beállítjuk a számunkra megfelelõ módot. Errõl többet az <a href="https://man.freebsd.org/cgi/man.cgi?query=lptcontrol&amp;sektion=8&amp;format=html">lptcontrol(8)</a> man oldaláról tudhatunk meg.</p></div></div><div class=sect4><h5 id=printing-testing>9.3.1.4. A kommunikáció ellenõrzése<a class=anchor href=#printing-testing></a></h5><div class=paragraph><p>Még mielõtt nekilátnánk a nyomtatási rendszer beállításának, bizonyosodjuk meg róla, hogy az operációs rendszer képes adatokat továbbítani a nyomtatónak. Sokkal könnyebb egymástól függetlenül megvizsgálni a kommunikáció és a nyomtatási rendszer mûködését.</p></div><div class=paragraph><p>A nyomtatót úgy tudjuk kipróbálni, ha küldünk neki valamilyen szöveget. Az <a href="https://man.freebsd.org/cgi/man.cgi?query=lptest&amp;sektion=1&amp;format=html">lptest(1)</a> tökéletesen megfelelõ akkor, ha olyan nyomtatónk van, amely azonnal kinyomtatja a kapott szöveget. Ez a program 96 sorban létrehozza mind a 96 kinyomtatható ASCII karaktert.</p></div><div class=paragraph><p>A PostScript® (vagy más egyéb nyelvet ismerõ) nyomtatóknak azonban ennél kifinomultabb próbára van szüksége. Erre a célra tökéletesen megfelel egy olyan kisebb PostScript® programocska, mint például ez:</p></div><div class="literalblock programlisting"><div class=content><pre>%!PS
100 100 moveto 300 300 lineto stroke
310 310 moveto /Helvetica findfont 12 scalefont setfont
(Remek! Ez mukodik!) show
showpage</pre></div></div><div class=paragraph><p>Ezt a PostScript® kódot nyugodtan elmenthetjük egy állományba, amelyet aztán a késõbbi szakaszokban megjelenõ példák szerint használni is tudunk majd.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>A kézikönyvben a nyomtató nyelve alatt leginkább egy PostScript®-szerû nyelvet értünk, nem pedig a Hewlett Packard PCL típusú nyelvét. Habár a PCL nagyon sokra képes, hiszen keverhetjük még benne akár a programokat és a nyers szövegeket is. Ezzel szemben a PostScript® nem képes nyers szöveget kinyomtatni, ezért az ilyen típusú nyomtatók mûködtetéséhez külön támogatásra van szükségünk.</p></div></td></tr></tbody></table></div><div class=sect5><h6 id=printing-checking-parallel>9.3.1.4.1. A párhuzamos nyomtató ellenõrzése<a class=anchor href=#printing-checking-parallel></a></h6><div class=paragraph><p>Ebben a szakaszban megtudhatjuk, hogy FreeBSD alatt miként ellenõrizzük a párhuzamos portra csatlakozó nyomtatók mûködését.</p></div><div class=paragraph><p><em>A párhuzamos porton levõ nyomtató kipróbálásához:</em></p></div><div class="exampleblock procedure"><div class=content><div class="olist arabic"><ol class=arabic><li><p>A <a href="https://man.freebsd.org/cgi/man.cgi?query=su&amp;sektion=1&amp;format=html">su(1)</a> segítségével váljunk <code>root</code> felhasználóvá.</p></li><li><p>Küldjünk a nyomtatónak valamilyen adatot.</p><div class=ulist><ul><li><p>Ha a nyomtató képes nyers szöveget fogadni, akkor használjuk az <a href="https://man.freebsd.org/cgi/man.cgi?query=lptest&amp;sektion=1&amp;format=html">lptest(1)</a> programot. Ehhez gépeljük be:</p><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># lptest &gt; /dev/lptN</span></code></pre></div></div><div class=paragraph><p>ahol az <em>N</em> nullától kezdõdõen a párhuzamos port sorszáma.</p></div></li><li><p>Ha a nyomtató PostScript® vagy más nyomtatási nyelvet ismer, akkor egy apró programot kell küldenünk neki. Ehhez írjuk be:</p><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># cat &gt; /dev/lptN</span></code></pre></div></div><div class=paragraph><p>Ezután soronként írjuk be a programot, de <em>vigyázzunk</em>, mert az <kbd>Enter</kbd> vagy a <kbd>Return</kbd> lenyomása után már nem tudjuk kijavítani! A program begépelése után nyomjuk meg a <span class=keyseq><kbd>Ctrl</kbd>+<kbd>D</kbd></span> vagy bármely más olyan billentyûkombinációt, amivel ki tudunk lépni.</p></div><div class=paragraph><p>Ezt a programot belerakhatjuk egy állományba is, amire aztán adjuk ki az alábbi parancsot:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># cat állomány &gt; /dev/lptN</span></code></pre></div></div><div class=paragraph><p>ahol az <em>állomány</em> a nyomtatóra küldendõ program neve lesz.</p></div></li></ul></div></li></ol></div></div></div><div class=paragraph><p>Ezután a nyomtató megkezdi a nyomtatást. Ne aggódjunk, ha netalán valami furcsán nézne ki, mert a késõbbiekben ezt még úgyis rendbetesszük.</p></div></div><div class=sect5><h6 id=printing-checking-serial>9.3.1.4.2. A soros nyomtató ellenõrzése<a class=anchor href=#printing-checking-serial></a></h6><div class=paragraph><p>Ebben a szakaszban megtudhatjuk, hogyan ellenõrizzük a FreeBSD és soros portra kötött nyomtató kapcsolódását.</p></div><div class=paragraph><p><em>Így tudjuk kipróbálni a soros porton csatlakozó nyomtatónkat:</em></p></div><div class="exampleblock procedure"><div class=content><div class="olist arabic"><ol class=arabic><li><p>A <a href="https://man.freebsd.org/cgi/man.cgi?query=su&amp;sektion=1&amp;format=html">su(1)</a> paranccsal váljunk <code>root</code> felhasználóvá.</p></li><li><p>Nyissuk meg az <span class=filename>/etc/remote</span> állományt. Tegyük hozzá a következõ sort:</p><div class="literalblock programlisting"><div class=content><pre>printer:dv=/dev/port:br#bps:pa=paritás</pre></div></div><div class=paragraph><p>ahol a <em>port</em> a soros porthoz tartozó eszközleíró neve (<code>ttyd0</code>, <code>ttyd1</code>, stb.), a <em>bps</em> a nyomtató által használt adatátviteli sebesség, végül a <em>paritás</em> a nyomtatóhoz használt paritás (ami lehet <code>even</code> (páros), <code>odd</code> (páratlan), <code>none</code> (nincs), vagy <code>zero</code> (nulla)).</p></div><div class=paragraph><p>Íme egy olyan soros nyomtató beállítása (<code>printer</code> néven), amely sebessége 19 200 bps, a harmadik portra csatlakozik és nem használ paritást:</p></div><div class="literalblock programlisting"><div class=content><pre>printer:dv=/dev/ttyd2:br#19200:pa=none</pre></div></div></li><li><p>Kapcsolódjunk a nyomtatóhoz a <a href="https://man.freebsd.org/cgi/man.cgi?query=tip&amp;sektion=1&amp;format=html">tip(1)</a> segítségével. Ennek parancsa:</p><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># tip printer</span></code></pre></div></div><div class=paragraph><p>Ha az iménti lépés nem mûködne, próbálkozzunk az <span class=filename>/etc/remote</span> állomány újbóli módosításával, és a <span class=filename>/dev/cuaaN</span> eszköz helyett használjuk a <span class=filename>/dev/ttydN</span> eszközt!</p></div></li><li><p>Küldjünk adatot a nyomtatónak.</p><div class=ulist><ul><li><p>Ha a nyomtató képes nyers szöveget nyomtatni, akkor használjuk az <a href="https://man.freebsd.org/cgi/man.cgi?query=lptest&amp;sektion=1&amp;format=html">lptest(1)</a> segédprogramot. Gépeljük be:</p><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>% <span class=nv>$lptest</span></code></pre></div></div></li><li><p>Ha a nyomtató a PostScript® vagy egy hozzá hasonló nyomtatási nyelven kommunikál, akkor a nyomtatónak egy rövid programot kell küldenünk. Soronként gépeljük be a programot, azonban <em>vigyázzunk</em> arra, hogy a törlés és minden más szerkesztésre használt billentyû a nyomtató számára is értelmes lehet. Az is elõfordulhat, hogy a program küldését egy speciális jelsorozattal tudjuk csak lezárni. A PostScript® nyomtatók esetén ilyenkor elegendõ a <span class=keyseq><kbd>Ctrl</kbd>+<kbd>D</kbd></span> billentyûk együttes lenyomása.</p><div class=paragraph><p>Vagy tehetjük az egész programot egy állományba, amihez aztán írjuk be ezt:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>% <span class=o>&gt;</span>állomány</code></pre></div></div><div class=paragraph><p>ahol az <em>állomány</em> a programot tartalmazó állomány neve. Miután a <a href="https://man.freebsd.org/cgi/man.cgi?query=tip&amp;sektion=1&amp;format=html">tip(1)</a> elküldte az állományt, nyomjuk le a lezáráshoz szükséges billentyûkombinációt.</p></div></li></ul></div></li></ol></div></div></div><div class=paragraph><p>Most már meg kellene jelennie valaminek a nyomtatón. Az még nem számít, pontosan mi is lesz az - késõbb még majd úgyis beállítjuk.</p></div></div></div><div class=sect4><h5 id=printing-printcap>9.3.1.5. A nyomtatási rendszer aktiválása: a <span class=filename>/etc/printcap</span> állomány<a class=anchor href=#printing-printcap></a></h5><div class=paragraph><p>Csatlakoztattuk a nyomtatónkat, a mûködtetéséhez beállítottuk a rendszermagot (amennyiben erre szükségünk volt), és tudtunk neki adatokat küldeni. Most már készen állunk arra, hogy LDP alkalmazáson keresztül beállítsuk a nyomtató hozzáférésének vezérlését.</p></div><div class=paragraph><p>Az LPD beállításait az <span class=filename>/etc/printcap</span> állományban találjuk. Az LPD nyomtatási rendszer minden egyes mûvelet elõtt beolvassa ezt az állományt, ezért a benne végzett módosítások szinte azonnal életbe is lépnek.</p></div><div class=paragraph><p>A <a href="https://man.freebsd.org/cgi/man.cgi?query=printcap&amp;sektion=5&amp;format=html">printcap(5)</a> tartalma könnyen érthetõ, a <span class=filename>/etc/printcap</span> állományt egyszerûen módosíthatjuk a kedvenc szövegszerkesztõnkkel. A felépítése teljesen megegyezik a többi hozzá hasonló állományéval: ilyenek például a <span class=filename>/usr/shared/misc/termcap</span> és a <span class=filename>/etc/remote</span>. Az itt alkalmazott formátum teljes leírását a <a href="https://man.freebsd.org/cgi/man.cgi?query=cgetent&amp;sektion=3&amp;format=html">cgetent(3)</a> man oldalon találjuk.</p></div><div class=paragraph><p>A nyomtatási rendszer egyszerû beállítása az alábbi lépésekbõl áll:</p></div><div class="exampleblock procedure"><div class=content><div class="olist arabic"><ol class=arabic><li><p>Adjunk nevet (és még néhány álnevet) a nyomtatónak, írjuk ezeket az <span class=filename>/etc/printcap</span> állományba. A nevekrõl <a href=#printing-naming>A nyomtató elnevezése</a> címû szakaszban kapunk felvilágosítást.</p></li><li><p>A(z alapból bekapcsolt) fejléclapokat az <code>sh</code> tulajdonság megadásával kapcsolhatjuk ki. A részleteket <a href=#printing-no-header-pages>A fejléclapok letiltása</a> címû szakaszban találjuk.</p></li><li><p>Hozzunk létre egy nyomtatási könyvtárat, és adjuk meg a helyét az <code>sd</code> tulajdonság beállításával. <a href=#printing-spooldir>A nyomtatási könyvtár létrehozása</a> címû szakaszban fogunk errõl többet mondani.</p></li><li><p>Állítsunk be egy nyomtató által használt <span class=filename>/dev</span> könyvtárbeli leírót, és az <code>lp</code> tulajdonsággal adjuk meg az <span class=filename>/etc/printcap</span> állományban. Errõl részletesebben <a href=#printing-device>A nyomtatóeszköz azonosítása</a> címû szakaszban olvashatunk. Ha a nyomtató soros porton keresztül csatlakozik, az <code>ms#</code> tulajdonsággal még meg kell adnunk <a href=#printing-commparam>A nyomtatási rendszer kommunikációs paraméterei</a> szakaszban tárgyaltakat is.</p></li><li><p>Helyezzünk el egy szûrõt a beérkezõ nyers szövegek számára. Errõl <a href=#printing-textfilter>A szövegszûrõ telepítése</a> címû szakasz értekezik.</p></li><li><p>Az <a href="https://man.freebsd.org/cgi/man.cgi?query=lpr&amp;sektion=1&amp;format=html">lpr(1)</a> parancs segítségével próbáljuk ki a nyomtatást. Ennek pontos részleteit a <a href=#printing-trying>Próbáljuk ki!</a> és a <a href=#printing-troubleshooting>Hibakeresés</a> címû fejezetekben találhatjuk meg.</p></li></ol></div></div></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>A magasabb szintû nyomtatók, mint például a PostScript® nyomtatók nem képesek közvetlenül nyers szöveget nyomtatni. Az imént felvázolt egyszerû beállítási séma feltételezi, hogy csak olyan állományokat fogunk nyomtatni a nyomtatón, amelyeket meg is ért.</p></div></td></tr></tbody></table></div><div class=paragraph><p>A felhasználók gyakran arra számítanak, hogy bármelyik általuk elérhetõ nyomtatón képesek nyers szöveget kinyomtatni. Az LPD alkalmazással kapcsolatban álló programok is általában ugyanezt az elgondolást követik. Ha egy saját nyelvvel rendelkezõ nyomtatót akarunk telepíteni, de a nyomtató saját nyelvén <em>és</em> a nyers szöveg formájában érkezõ nyomtatási feladatok is rendesen ki akarjuk nyomtatni, akkor mindenképpen javasoljuk, hogy illeszünk még egy további lépést is ebbe a sorba: illesszünk a rendszerbe egy nyers szövegrõl automatikusan PostScript® (vagy más egyéb) nyelvre tolmácsoló programot. Errõl a <a href=#printing-advanced-if-conversion>Szöveges nyomtatási feladatok PostScript® nyomtatókon</a> címû fejezetben olvashatunk.</p></div><div class=sect5><h6 id=printing-naming>9.3.1.5.1. A nyomtató elnevezése<a class=anchor href=#printing-naming></a></h6><div class=paragraph><p>Az elsõ (egyszerû) lépés a nyomtatónk nevének kiválasztása. Igazából nem számít, mennyire kifejezõ vagy éppen hóbortos nevet adunk neki, hiszen emellett még számos álnévvel is illethetjük.</p></div><div class=paragraph><p>Az <span class=filename>/etc/printcap</span> állományban megtalálható nyomtatók egyikének legalább az <code>lp</code> álnévvel rendelkeznie kell, mivel ez lesz az alapértelmezett nyomtató neve. Tehát ha a felhasználó nem adja meg sem a <code>PRINTER</code> környezeti változót, sem pedig az LPD-vel kapcsolatban álló aktuális parancsban a használni kívánt nyomtató nevét, akkor a rendszer az <code>lp</code> nevût fogja keresni.</p></div><div class=paragraph><p>Ezenkívül általában még gyakran adnak egy olyan álnevet is a nyomtatónak, ahol annak teljes leírása, többek közt a gyártmánya és a típusa szerepel.</p></div><div class=paragraph><p>Ahogy sikerült nevet és álneveket adni a nyomtatónak, írjuk is be ezeket az <span class=filename>/etc/printcap</span> állományba. Itt a nyomtató neveit balról kezdjük felsorolni, mindegyik álnevet egy függõleges vonallal válasszunk el, és az utolsó után tegyünk pontosvesszõt.</p></div><div class=paragraph><p>A most következõ példában egy olyan vázt mutatunk be az <span class=filename>/etc/printcap</span> állományhoz, amelyben két nyomtatót (egy Diablo 630 márkájú sornyomtatót és egy Panasonic KX-P4455 típusú PostScript® lézernyomtatót) adunk meg:</p></div><div class="literalblock programlisting"><div class=content><pre>#
#  /etc/printcap (rose)
#
rattan|line|diablo|lp|Diablo 630 Line Printer:

bamboo|ps|PS|S|panasonic|Panasonic KX-P4455 PostScript v51.4:</pre></div></div><div class=paragraph><p>Ebben a példában az elsõ nyomtató neve <code>rattan</code>, és ehhez tartozik még a <code>line</code>, <code>diablo</code>, <code>lp</code>, és <code>Diablo 630 Line Printer</code> álnév. Mivel itt soroltuk fel az <code>lp</code> álnevet is, ezért a rendszerben ez lesz az alapértelmezett nyomtató. A második nyomtató neve <code>bamboo</code>, és álnevei többek közt a <code>ps</code>, <code>PS</code>, <code>S</code>, <code>panasonic</code>, valamint a <code>Panasonic KX-P4455 PostScript v51.4</code>.</p></div></div><div class=sect5><h6 id=printing-no-header-pages>9.3.1.5.2. A fejléclapok letiltása<a class=anchor href=#printing-no-header-pages></a></h6><div class=paragraph><p>Az LPD nyomtatási rendszer alapértelmezés szerint minden egyes feladathoz <em>fejléclapot</em> készít. Ez a lap szép nagy betûkkel tartalmazza a nyomtatási feladatot kiadó felhasználó nevét, a gépet, amirõl küldték, és a feladat nevét. Sajnálatos módon ez azonban inkább akadályozza a hibakeresést a nyomtató beállításában, ezért most inkább kapcsoljuk ki ezeket.</p></div><div class=paragraph><p>Ha le akarjuk tiltani a fejléclapokat, az <span class=filename>/etc/printcap</span> állományban adjuk meg az <code>sh</code> (úgymint "suppress header pages") tulajdonságot. Íme egy példa az <code>sh</code> tulajdonsággal bõvített <span class=filename>/etc/printcap</span> állományra:</p></div><div class="literalblock programlisting"><div class=content><pre>#
#  /etc/printcap (rose) - sehol sem lesznek fejléclapok
#
rattan|line|diablo|lp|Diablo 630 Line Printer:\
        :sh:

bamboo|ps|PS|S|panasonic|Panasonic KX-P4455 PostScript v51.4:\
        :sh:</pre></div></div><div class=paragraph><p>Ebben a példában megfigyelhetjük a helyes felírási módot: az elsõ sor a bal szélsõ oszlopban kezdõdik, az azt követõ sorok pedig bentebb. Minden bejegyzésben az utolsó kivételével mindegyik sor egy visszaper (backslash) karakterrel zárul.</p></div></div><div class=sect5><h6 id=printing-spooldir>9.3.1.5.3. A nyomtatási könyvtár létrehozása<a class=anchor href=#printing-spooldir></a></h6><div class=paragraph><p>A nyomtatási rendszerünk beállításának következõ lépése a <em>nyomtatási könyvtár</em> létrehozása. Ez egy olyan könyvtár, ahová a különbözõ nyomtatási feladatok kerülnek a feldolgozásuk elõtt, valamint ahol a nyomtatási rendszer többi állománya lakozik.</p></div><div class=paragraph><p>A nyomtatási rendszer adatait tároló könyvtárakat tartalmuk gyakori változása miatt általában a <span class=filename>/var/spool</span> könyvtárba szokás tenni. Ezen könyvtárak tartalmát nem szükséges menteni sem. Az <a href="https://man.freebsd.org/cgi/man.cgi?query=mkdir&amp;sektion=1&amp;format=html">mkdir(1)</a> parancs futtatásával egyszerûen újra létre tudjuk hozni.</p></div><div class=paragraph><p>Általában minden nyomtatóhoz külön létre szoktak hozni egy könyvtárat az adott nyomtató nevén. Erre példa:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># mkdir /var/spool/nyomtatónév</span></code></pre></div></div><div class=paragraph><p>Azonban ha a hálózatunkon rengeteg nyomtató található, akkor érdemes inkább egyetlen könyvtárat használni, amelyet az LPD számára tartunk fenn.</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># mkdir /var/spool/lpd</span>
<span class=c># mkdir /var/spool/lpd/rattan</span>
<span class=c># mkdir /var/spool/lpd/bamboo</span></code></pre></div></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Amennyiben fontos nekünk a felhasználói nyomtatások titkosságának megóvása, érdemes levédenünk a nyomtatási könyvtárat, így az nem lesz mindenki által elérhetõ. A nyomtatási könyvtárak tulajdonosa egyedül és kizárólag a <code>daemon</code> felhasználó és a <code>daemon</code> csoport legyen, és hozzá olvasási, írási és keresési engedélyekkel rendelkezzen. Ezt fogjuk most beállítani a példáinkban szereplõ nyomtatóinkhoz is:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># chown daemon:daemon /var/spool/lpd/rattan</span>
<span class=c># chown daemon:daemon /var/spool/lpd/bamboo</span>
<span class=c># chmod 770 /var/spool/lpd/rattan</span>
<span class=c># chmod 770 /var/spool/lpd/bamboo</span></code></pre></div></div></td></tr></tbody></table></div><div class=paragraph><p>Végezetül az <span class=filename>/etc/printcap</span> állományban ezeket a könyvtárakat se felejtsük el megadni az LPD-nek. Itt a nyomtatási könyvtár nevét az <code>sd</code> tulajdonsággal írjuk le:</p></div><div class="literalblock programlisting"><div class=content><pre>#
#  /etc/printcap (rose) - a nyomtatási könyvtárak hozzáadása
#
rattan|line|diablo|lp|Diablo 630 Line Printer:\
        :sh:sd=/var/spool/lpd/rattan:

bamboo|ps|PS|S|panasonic|Panasonic KX-P4455 PostScript v51.4:\
        :sh:sd=/var/spool/lpd/bamboo:</pre></div></div><div class=paragraph><p>Vegyük észre, hogy a nyomtató neve ugyan a sor elején kezdõdik, azonban a hozzá tartozó összes többi sor mind bentebb kezdõdik és egy visszaper (backslash) karakterrel választjuk le.</p></div><div class=paragraph><p>Ha az <code>sd</code> tulajdonsággal nem adunk meg semmilyen nyomtatási könyvtárat, akkor ennek az értéke alapértelmezés szerint a <span class=filename>/var/spool/lpd</span> lesz.</p></div></div><div class=sect5><h6 id=printing-device>9.3.1.5.4. A nyomtatóeszköz azonosítása<a class=anchor href=#printing-device></a></h6><div class=paragraph><p>A <a href=#printing-hardware>Hardveres beállítás</a> címû szakaszban már beazonosítottuk, hogy a FreeBSD a <span class=filename>/dev</span> könyvtárban melyik eszközleírón keresztül fogja megszólítani a nyomtatót. Most ideje ugyanezt tudatni az LPD démonnal is. Így amikor a nyomtatási rendszer végre szeretne hajtani egy nyomtatási feladatot, a szûrõprogram nevében ezt az eszközt nyitja meg (ahol a szûrõn keresztül továbbítjuk az adatokat a nyomtató felé).</p></div><div class=paragraph><p>Az <code>lp</code> tulajdonság segítségével a <span class=filename>/etc/printcap</span> állományban soroljuk fel a nyomtatók <span class=filename>/dev</span> könyvtárban található leíróit.</p></div><div class=paragraph><p>Az eddig használt példánkban most tételezzük fel, hogy a <code>rattan</code> nevû nyomtató az elsõ párhuzamos porton található, míg a <code>bamboo</code> nevû a hatodik soros porton. Ebben a helyzetben így kellene kiegészítenünk az <span class=filename>/etc/printcap</span> állományunkat:</p></div><div class="literalblock programlisting"><div class=content><pre>#
#  /etc/printcap (rose) - a használni kívánt eszközök
#  beazonosítása
#
rattan|line|diablo|lp|Diablo 630 Line Printer:\
        :sh:sd=/var/spool/lpd/rattan:\
        :lp=/dev/lpt0:

bamboo|ps|PS|S|panasonic|Panasonic KX-P4455 PostScript v51.4:\
        :sh:sd=/var/spool/lpd/bamboo:\
        :lp=/dev/ttyd5:</pre></div></div><div class=paragraph><p>Az LPD alapértelmezés szerint a <span class=filename>/dev/lp</span> eszközt fogja használni, ha nem adjuk meg az <code>lp</code> tulajdonságot az <span class=filename>/etc/printcap</span> állományban. A <span class=filename>/dev/lp</span> azonban a FreeBSD-ben jelenleg nem létezik.</p></div><div class=paragraph><p>Ha a telepítendõ nyomtatónk valamelyik párhuzamos portra csatlakozik, akkor innen akár tovább is léphetünk <a href=#printing-textfilter>A szövegszûrõ telepítése</a> címû szakaszra. Ha viszont nem, kövessük a most következõ szakaszban szereplõ utasításokat.</p></div></div><div class=sect5><h6 id=printing-commparam>9.3.1.5.5. A nyomtatási rendszer kommunikációs paraméterei<a class=anchor href=#printing-commparam></a></h6><div class=paragraph><p>A soros portra csatlakozó nyomtatóknál az LPD képes beállítani az adatátviteli sebességet, a paritást, valamint más egyéb olyan kommunikációs paramétereket, amelyekkel a szûrõprogram adatokat tud továbbítani a nyomtató felé. Ez több szempontból is elõnyös, mivel:</p></div><div class=ulist><ul><li><p>Egyszerûen az <span class=filename>/etc/printcap</span> állomány átírásával ki tudunk próbálni több kommunikációs beállítást, nem kell magát a szûrõprogramot újrafordítanunk.</p></li><li><p>A nyomtatási rendszer képes ugyanazt a szûrõt több, különbözõ kommunikációs beállítást alkalmazó nyomtatóhoz is használni.</p></li></ul></div><div class=paragraph><p>Az <span class=filename>/etc/printcap</span> állományban az <code>lp</code> tulajdonsággal megadott eszközök soros kommunikációjának beállításait az alábbi tulajdonságok határozzák meg:</p></div><div class=dlist><dl><dt class=hdlist1><code>br#sebesség</code></dt><dd><p>Beállítja az eszköz adatátviteli sebességét a <em>sebesség</em> értékre, ahol a <em>sebesség</em> lehet 50, 75, 110, 134, 150, 200, 300, 600, 1200, 1800, 2400, 4800, 9600, 19 200, 38 400, 57 600 vagy 115 200 bit másodpercenként (bps).</p></dd><dt class=hdlist1><code>ms#stty-mód</code></dt><dd><p>Beállítja az eszköz megnyitása után használt termináleszköz mûködésének paramétereit. Az <a href="https://man.freebsd.org/cgi/man.cgi?query=stty&amp;sektion=1&amp;format=html">stty(1)</a> man oldalon többet is megtudhatunk róluk.</p></dd></dl></div><div class=paragraph><p>Miután az LPD megnyitja az <code>lp</code> tulajdonsággal megadott eszközt, beállítja az <code>ms#</code> tulajdonság értéke szerint annak jellemzõit. Itt a <code>parenb</code>, <code>parodd</code>, <code>cs5</code>, <code>cs6</code>, <code>cs7</code>, <code>cs8</code>, <code>cstopb</code>, <code>crtscts</code>, és <code>ixon</code> módok lehetnek lényegesek, melyekrõl az <a href="https://man.freebsd.org/cgi/man.cgi?query=stty&amp;sektion=1&amp;format=html">stty(1)</a> man oldalon többet is megtudhatunk.</p></div><div class=paragraph><p>Állítsuk most be az egyik képzeletbeli nyomtatónkat a hatodik soros portra. Az adatátviteli sebessége 38 400 bps lesz. A kommunikáció módjánál kapcsoljuk ki a paritást (<code>-parenb</code>), 8 bites karakterek legyenek (<code>cs8</code>), ne legyen modemes vezérlés (<code>clocal</code>) és a hardveres forgalomirányítás legyen <code>crtscts</code>:</p></div><div class="literalblock programlisting"><div class=content><pre>bamboo|ps|PS|S|panasonic|Panasonic KX-P4455 PostScript v51.4:\
        :sh:sd=/var/spool/lpd/bamboo:\
        :lp=/dev/ttyd5:ms#-parenb cs8 clocal crtscts:</pre></div></div></div><div class=sect5><h6 id=printing-textfilter>9.3.1.5.6. A szövegszûrõ telepítése<a class=anchor href=#printing-textfilter></a></h6><div class=paragraph><p>Most már utasíthatjuk az LPD-t, hogy milyen szövegszûrõt használjon a nyomtatási feladatok eszközre küldéséhez. A <em>szövegszûrõ</em> (text filter), vagy más néven <em>bemeneti szûrõ</em> (input filter) egy olyan program, amelyet az LPD egy nyomtatási feladat elvégzésekor lefuttat. Amikor az LPD lefuttatja a nyomtatóhoz tartozó szövegszûrõt, a szûrõ szabványos bemenetére elküldi az elvégzendõ nyomtatási feladatot, és a szabványos kimenetét pedig átirányítja az <code>lp</code> tulajdonság által megadott nyomtatóeszközre. Ennek megfelelõen a szûrõnek a szabványos bemenetrõl kell olvasnia az elvégzendõ feladatot, a szabványos kimenetre pedig a ténylegesen nyomtatandót kell kiírnia. A szövegszûrõk részleteirõl a <a href=#printing-advanced-filters>Hogyan mûködnek a szûrõk?</a> szakasz szól.</p></div><div class=paragraph><p>A mi esetünkben most szövegszûrõnek tökéletesen megfelel egy olyan rövid szkript, ami a nyomtatóra a nyomtatási feladatot a <code>/bin/cat</code> paranccsal küldi ki. A FreeBSD-ben még találhatunk egy másik szûrõt is, amelynek a neve <span class=filename>lpf</span>. Ez képes a törlést és aláhúzást jelzõ karaktereket érthetõvé tenni bizonyos nyomtatók számára. Természetesen itt használhatunk kedvünk szerinti szûrõt is. Az <code>lpf</code> szûrõ mûködésének részleteit <a href=#printing-advanced-lpf>Az lpf szövegszûrõ</a> címû szakaszban fejtjük ki bõvebben.</p></div><div class=paragraph><p>Elõször is készítsünk egy <span class=filename>/usr/local/libexec/if-simple</span> nevû egyszerû szövegszûrõ szkriptet. A kedvenc szövegszerkesztõnkkel írjuk bele a következõ sorokat:</p></div><div class="literalblock programlisting"><div class=content><pre>#!/bin/sh
#
# if-simple - egyszerû szövegszûrõ szkript az lpd-hez
# Helye: /usr/local/libexec/if-simple
#
# Egyszerûen átmásolja a kimenetére a bemenetérõl érkezõ adatokat; nem
# fogad el semmilyen paramétert.

/bin/cat &amp;&amp; exit 0
exit 2</pre></div></div><div class=paragraph><p>Tegyük indíthatóvá:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># chmod 555 /usr/local/libexec/if-simple</span></code></pre></div></div><div class=paragraph><p>Ezután tájékoztassuk róla az LPD-t az <span class=filename>/etc/printcap</span> állományban található <code>if</code> tulajdonság megadásával. Itt most a példánkban szereplõ mind a két nyomtatóhoz beillesztjük:</p></div><div class="literalblock programlisting"><div class=content><pre>#
#  /etc/printcap (rose) - a szövegszûrõ hozzáadása
#
rattan|line|diablo|lp|Diablo 630 Line Printer:\
        :sh:sd=/var/spool/lpd/rattan:\
        :lp=/dev/lpt0:\
        :if=/usr/local/libexec/if-simple:

bamboo|ps|PS|S|panasonic|Panasonic KX-P4455 PostScript v51.4:\
        :sh:sd=/var/spool/lpd/bamboo:\
        :lp=/dev/ttyd5:ms#-parenb cs8 clocal crtscts:\
        :if=/usr/local/libexec/if-simple:</pre></div></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Az <span class=filename>if-simple</span> szkript megtalálható a <span class=filename>/usr/shared/examples/printing</span> könyvtárban.</p></div></td></tr></tbody></table></div></div><div class=sect5><h6 id=_az_lpd_elindítása>9.3.1.5.7. Az LPD elindítása<a class=anchor href=#_az_lpd_elindítása></a></h6><div class=paragraph><p>Az <a href="https://man.freebsd.org/cgi/man.cgi?query=lpd&amp;sektion=8&amp;format=html">lpd(8)</a> az <span class=filename>/etc/rc</span> szkriptbõl, az <code>lpd_enable</code> változó értékének megfelelõen indul el. Ennek értéke alapból <code>NO</code>, vagyis nem. Ha eddig még nem tettük volna meg, akkor az <span class=filename>/etc/rc.conf</span> állományba most vegyük fel a következõ sort:</p></div><div class="literalblock programlisting"><div class=content><pre>lpd_enable=&#34;YES&#34;</pre></div></div><div class=paragraph><p>Ezután vagy indítsuk újra a számítógépünket, vagy pedig adjuk ki az <a href="https://man.freebsd.org/cgi/man.cgi?query=lpd&amp;sektion=8&amp;format=html">lpd(8)</a> parancsot:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># lpd</span></code></pre></div></div></div><div class=sect5><h6 id=printing-trying>9.3.1.5.8. Próbáljuk ki!<a class=anchor href=#printing-trying></a></h6><div class=paragraph><p>Elérkeztünk az LPD egyszerû beállításának utolsó lépéséhez. Sajnos azonban még nem gratulálhatunk, hiszen hátra van még a nyomtató kipróbálása és az esetlegesen elõforduló hibák kijavítása. A beállítást úgy tudjuk a legegyszerûbben letesztelni, ha megpróbálunk valamit kinyomtatni. Az LPD rendszerben az <a href="https://man.freebsd.org/cgi/man.cgi?query=lpr&amp;sektion=1&amp;format=html">lpr(1)</a> parancs használatával tudunk nyomtatási feladatokat kiadni.</p></div><div class=paragraph><p><a href=#printing-testing>A kommunikáció ellenõrzése</a> címû szakaszban megtalálhatjuk, hogy hozzunk létre tesztelésre alkalmas szövegeket az <a href="https://man.freebsd.org/cgi/man.cgi?query=lpr&amp;sektion=1&amp;format=html">lpr(1)</a> és az <a href="https://man.freebsd.org/cgi/man.cgi?query=lptest&amp;sektion=1&amp;format=html">lptest(1)</a> programok segítségével.</p></div><div class=paragraph><p><em>Az LPD beállításainak egyszerû tesztelése:</em></p></div><div class=paragraph><p>Írjuk be:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># lptest 20 5 | lpr -Pnyomtatónév</span></code></pre></div></div><div class=paragraph><p>ahol a <em>nyomtatónév</em> az <span class=filename>/etc/printcap</span> állományban megadott egyik nyomtató neve (vagy álneve) lehet. Az alapértelmezett nyomtató kipróbálásához ne adjunk meg az <a href="https://man.freebsd.org/cgi/man.cgi?query=lpr&amp;sektion=1&amp;format=html">lpr(1)</a> parancsnak semmilyen <code>-P</code> paramétert. Még egyszer megemlítenénk, hogy amennyiben PostScript® nyomtatót tesztelünk, az elõbbi helyett az <a href="https://man.freebsd.org/cgi/man.cgi?query=lptest&amp;sektion=1&amp;format=html">lptest(1)</a> paranccsal küldjünk ki egy PostScript® programot. Ehhez tegyük a tesztelõ programunkat egy állományba, majd írjuk be az <code>lpr állománynév</code> parancsot.</p></div><div class=paragraph><p>A PostScript® nyomtató esetén a kiküldött program eredményét kell látnunk. Amennyiben az <a href="https://man.freebsd.org/cgi/man.cgi?query=lptest&amp;sektion=1&amp;format=html">lptest(1)</a> parancsot használjuk, valami ilyesmire kell számítanunk:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=o>!</span><span class=s2>&#34;#</span><span class=nv>$%</span><span class=s2>&amp;&#39;()*+,-./01234
&#34;</span><span class=c>#$%&amp;&#39;()*+,-./012345</span>
<span class=c>#$%&amp;&#39;()*+,-./0123456</span>
<span class=nv>$%</span>&amp;<span class=s1>&#39;()*+,-./01234567
%&amp;&#39;</span><span class=o>()</span><span class=k>*</span>+,-./012345678</code></pre></div></div><div class=paragraph><p>A nyomtató kimerítõbb teszteléséhez próbáljunk meg nagyobb programokat keríteni valahonnan (ha a nyomtatónk valamilyen nyelven kommunikál) vagy adjunk meg az <a href="https://man.freebsd.org/cgi/man.cgi?query=lptest&amp;sektion=1&amp;format=html">lptest(1)</a> parancsnak más paramétereket. Például az <code>lptest 80 60</code> soronként 80 karaktert írat ki 60 sorban.</p></div><div class=paragraph><p>Amennyiben a nyomtató nem mûködne, nézzük meg a <a href=#printing-troubleshooting>Hibakeresés</a>hez tartozó szakaszt.</p></div></div></div></div></div><div class=sect2><h3 id=printing-advanced>9.4. Magasszintû nyomtatóbeállítás<a class=anchor href=#printing-advanced></a></h3><div class=paragraph><p>Ebben a szakaszban olyan szûrõket mutatunk be, amelyek speciálisan formázott állományok, fejléclapok, hálózati nyomtatás, nyomtatási nyilvántartás vagy szabályozás esetén használhatóak.</p></div><div class=sect3><h4 id=printing-advanced-filter-intro>9.4.1. Szûrõk<a class=anchor href=#printing-advanced-filter-intro></a></h4><div class=paragraph><p>Noha az LPD képes hálózati protokollokat, nyomtatási sorokat, hozzáférést és sok minden más nyomtatási feladatot kezelni, a <em>tényleges</em> munka legnagyobb része a <em>szûrõkben</em> (filter) történik. A szûrõk olyan programok, amelyek tartják a kapcsolatot a nyomtatóval és megbirkóznak annak eszközfüggõségeivel és különleges igényeivel. Az egyszerû beállítás során egy primitív szövegszûrõt állítottunk be (lásd <a href=#printing-textfilter>A szövegszûrõ telepítése</a>) - ami annyira egyszerû, hogy szinte minden nyomtatón mûködnie kell.</p></div><div class=paragraph><p>Azonban mindahhoz, hogy ki tudjuk használni a különbözõ átalakítási, nyilvántartási lehetõségeket, valamint a nyomtatók különlegességeit és egyebeit, meg kell értenünk a szûrõk pontos mûködését. Az elõbb említett feladatok ugyanis teljesen a szûrõ kezében vannak. Ezzel kapcsolatban azonban rossz hír, hogy ezeket a szûrõket <em>nekünk</em> kell megírnunk. A jó hír ellenben az, hogy könnyen találunk ilyen szûrõket, vagy ha éppen nem lelnénk valamelyiket, akkor is gyorsan meg tudjuk ezeket írni.</p></div><div class=paragraph><p>Sõt, a FreeBSD alapból tartalmaz is egyet, amit a <span class=filename>/usr/libexec/lpr/lpf</span> helyen találunk meg, és sok olyan nyomtatóval képes együttmûködni, amelyek nyers szöveget tudnak nyomtatni. (Kezeli az állományokban felbukkanó törléseket és tabulálásokat, valamint képes nyilvántartást vezetni, de semmi többet.) Rajta kívül még számos szûrõt és szûrõelemet is találhatunk a FreeBSD Portgyûjteményében.</p></div><div class=paragraph><p>Lássuk, mit tartogat számunkra ez a rész:</p></div><div class=ulist><ul><li><p>A <a href=#printing-advanced-filters>Hogyan mûködnek a szûrõk?</a> címû szakaszban megpróbálunk egyfajta áttekintést adni a szûrõk nyomtatási folyamatban betöltött szerepérõl. Mindenképpen érdemes elolvasnunk ezt a szakaszt, mivel ebben derül ki, hogy valójában mi is történik a "függöny mögött", vagyis amikor az LPD használja ezeket a szûrõket. Ezzel a tudással el tudjuk kerülni vagy éppen nyakon tudjuk csípni azokat a problémákat, amelyek a nyomtatóinkhoz telepített szûrõk hozzáadása során adódhatnak.</p></li><li><p>Az LPD alapból arra számít, hogy minden nyomtató képes nyers szöveget nyomtatni. Ez gondot okoz a PostScript® (és minden más nyelv alapú) nyomtatók esetén, mivel azok nem képesek nyers szöveget nyomtatni. <a href=#printing-advanced-if-conversion>Szöveges nyomtatási feladatok PostScript® nyomtatókon</a> címû szakaszban viszont fény derül rá, hogyan kerekedjünk felül ezen. Feltétlenül olvassuk el, ha PostScript® nyomtatónk van.</p></li><li><p>A PostScript® számos program közkedvelt kimeneti formátuma, sõt gyakran maguk a felhasználók is szeretnek ilyen programokat írni. Sajnos azonban a PostScript® nyomtatók egyáltalán nem olcsók. A <a href=#printing-advanced-ps>PostScript® szimulációja nem PostScript® nyomtatókon</a> címû szakaszban megtudhatjuk, miképp tudjuk úgy módosítani a szûrõt, hogy <em>nem PostScript®</em> nyomtatókon is tudjunk PostScript® programokkal nyomtatni. Ezt a szakaszt akkor érdemes elolvasni, ha nincs PostScript® nyomtatónk.</p></li><li><p>A <a href=#printing-advanced-convfilters>Konverziós szûrõk</a> címû szakaszban eláruljuk, miként lehetséges automatizálni a különbözõ állományformátumok és a nyomtatók által érthetõ formátumok közti konverziókat, legyen az grafikus vagy betûszedésre vonatkozó adat. A szakasz elolvasása során megismerjük, hogyan tudjuk a nyomtatónkat képessé tenni az <code>lpr -t</code> paranccsal troff adatok, vagy a <code>lpr -d</code> paranccsal a TeX DVI állományainak, esetleg az <code>lpr -v</code> paranccsal raszteres képek nyomtatására és így tovább. Csak ajánlani tudjuk ennek elolvasását.</p></li><li><p>A <a href=#printing-advanced-of>Kimeneti szûrõk</a> címû szakaszban kivesézzük az LPD egyik kevésbé használt lehetõségét is, a kimeneti szûrõket. Hacsak nem fejléclapokat akarunk készíteni (lásd <a href=#printing-advanced-header-pages>Fejléclapok</a>), akkor ezt a szakaszt nyugodtan kihagyhatjuk.</p></li><li><p><a href=#printing-advanced-lpf>Az lpf szövegszûrõ</a> szakaszban bemutatásra kerül a FreeBSD-ben alapból megtalálható <code>lpf</code> szûrõ, amely egy sornyomtatóknál (vagy az így viselkedõ lézernyomtatóknál) használható egyszerû szövegszûrõ. Ha nyers szövegek nyomtatásánál meg akarjuk oldani a nyomtatási feladatok nyilvántartását, vagy a törlés karakter láttán a nyomtatónk füstölni kezdene, akkor mindenképpen érdemes belemerülnünk az <code>lpf</code> titkaiba.</p></li></ul></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>A most következõ szkriptek mindegyike megtalálható a <span class=filename>/usr/shared/examples/printing</span> könyvtárban.</p></div></td></tr></tbody></table></div><div class=sect4><h5 id=printing-advanced-filters>9.4.1.1. Hogyan mûködnek a szûrõk?<a class=anchor href=#printing-advanced-filters></a></h5><div class=paragraph><p>Ahogy már korábban is jeleztük, a szûrõ egy olyan végrehajtható program, amelyet az LPD indít el, amikor a nyomtatóval eszközfüggetlen módon kommunikál.</p></div><div class=paragraph><p>Amikor az LPD egy feladat elvégzése során ki akar nyomtatni egy állományt, akkor elindít egy ilyen szûrõprogramot. A szûrõ szabványos bemenetére elküldi a kinyomtatandó állományt, a szabványos kimenetét a nyomtatóra, a szabványos hibajelzéseit pedig egy naplóállományba irányítja (ez utóbbit az <span class=filename>/etc/printcap</span> állományban az <code>lf</code> tulajdonsággal adhatjuk meg, vagy alapértelmezés szerinti a <span class=filename>/dev/console</span> állományba kerül).</p></div><div class=paragraph><p>Az LPD a használni kívánt szûrõt és annak paramétereit az <span class=filename>/etc/printcap</span> állományban felsoroltak vagy az <a href="https://man.freebsd.org/cgi/man.cgi?query=lpr&amp;sektion=1&amp;format=html">lpr(1)</a> parancssorában megadottak szerint választja ki. Például, ha a felhasználó a <code>lpr -t</code> parancsot adja ki, akkor az LPD a célként megadott nyomtatónál szereplõ <code>tf</code> tulajdonság által megadott troff szûrõt kezdi el használni. Amennyiben a felhasználó egyszerûen csak nyers szöveget akar nyomtatni, akkor az <code>if</code> szûrõnek kellene elindulnia (ez viszont csak részben igaz: lásd <a href=#printing-advanced-of>Kimeneti szûrõk</a>).</p></div><div class=paragraph><p>Háromfajta szûrõ jelenhet meg az <span class=filename>/etc/printcap</span> állományban:</p></div><div class=ulist><ul><li><p>A <em>szövegszûrõ</em> (text filter), ami a hagyományos szöveges nyomtatásért felelõs, és amit az LPD dokumentációjában érdekes módon <em>bemeneti szûrõnek</em> (input filter) hívnak. Mivel az LPD arra számít, hogy minden nyomtató alapból képes kinyomtatni bármilyen nyers szöveget, ezért a szövegszûrõ feladata, hogy a nyomtató számára gondoskodjon a tabulátorok, törlések és más egyéb speciális karakterek megfelelõ kezelésérõl. Emellett ha olyan helyen vagyunk, ahol szükség van a nyomtatási feladatok nyilvántartására is, a szövegszûrõ ennek megoldására is képes, méghozzá úgy, hogy összeszámolja a kinyomtatott sorokat, és elosztja ezeket a nyomtató által oldalanként nyomtatott sorok számával. Egy szövegszûrõ a következõ paraméterekkel indulhat:</p><div class=paragraph><p><code>szûrõnév [ -c ] -w <em>szélesség</em> -l <em>hossz</em> -i <em>behúzás</em> -n <em>hozzáférés</em> -h <em>gépnév</em> <em>nyilvántartás</em></code></p></div><div class=paragraph><p>ahol a</p></div><div class=dlist><dl><dt class=hdlist1><code>-c</code></dt><dd><p>akkor jelenik meg, ha egy nyomtatási feladatot az <code>lpr -l</code> paranccsal adunk át</p></dd><dt class=hdlist1><em>szélesség</em></dt><dd><p>az <span class=filename>/etc/printcap</span> állományban definiált <code>pw</code> (page width, avagy oldalszélesség) tulajdonság értéke, ami alapbeállítás szerint 132</p></dd><dt class=hdlist1><em>hossz</em></dt><dd><p>a <code>pl</code> (page length, avagy oldalhossz) tulajdonság értéke, amely az alapbeállítás szerint 66</p></dd><dt class=hdlist1><em>behúzás</em></dt><dd><p>az <code>lpr -i</code> parancs megadása során használt behúzás mértéke, ami alapból 0</p></dd><dt class=hdlist1><em>hozzáférés</em></dt><dd><p>a nyomtatást végzõ felhasználó hozzáférésének megnevezése</p></dd><dt class=hdlist1><em>gépnév</em></dt><dd><p>a gép neve, amirõl a nyomtatási feladat érkezett</p></dd><dt class=hdlist1><em>nyilvántartás</em></dt><dd><p>ez a nyilvántartást tároló állomány <code>af</code> tulajdonsággal definiált neve</p></dd></dl></div></li><li><p>A <em>konverziós szûrõk</em> (conversion filter) egy adott állományformátumot hoznak a nyomtató számára értelmes formára. Például ditroff adatok közvetlenül ugyan nem nyomtathatóak, azonban a ditroff állományokhoz tudunk telepíteni egy olyan szûrõt, amely a ditroff adatokat a nyomtató számára is emészthetõ és nyomtatható formájúvá teszi. A <a href=#printing-advanced-convfilters>Konverziós szûrõk</a> címû szakasz tud ezekrõl többet mondani. Ilyen esetekben kérhetünk nyilvántartást. A konverziós szûrõk az alábbi paraméterekkel indulhatnak:</p><div class=paragraph><p><code>szûrõnév -x <em>pixelszélesség</em> -y <em>pixelmagasság</em> -n <em>hozzáférés</em> -h <em>gépnév</em> <em>nyilvántartás</em></code></p></div><div class=paragraph><p>ahol a <em>pixelszélesség</em> a <code>px</code> tulajdonság értékébõl (ami alapból 0), a <em>pixelmagasság</em> a <code>py</code> tulajdonság értékébõl (ami alapból szintén 0) származik.</p></div></li><li><p>A <em>kimeneti szûrõ</em> (output filter), ami csak akkor aktív, ha a szövegszûrõ nem, vagy ha engedélyeztük fejléclapok nyomtatását. Tapasztalatom szerint az ilyen szûrõket ritkán használják. A <a href=#printing-advanced-of>Kimeneti szûrõk</a> címû szakasz mutatja be a mûködésüket. Ekkor csupán két paraméterünk van:</p><div class=paragraph><p><code>szûrõnév -w <em>szélesség</em> -l <em>hosszúság</em></code></p></div><div class=paragraph><p>amik rendre megegyeznek a szövegszûrõk <code>-w</code> és <code>-l</code> paramétereivel.</p></div></li></ul></div><div class=paragraph><p>A szûrõk <em>ki is tudnak lépni</em> a következõ kódokkal (exit status):</p></div><div class=dlist><dl><dt class=hdlist1>0</dt><dd><p>A szûrõ sikeresen kinyomtatta az állományt.</p></dd><dt class=hdlist1>1</dt><dd><p>A szûrõnek nem sikerült kinyomtatnia az állományt, azonban szeretné, ha az LPD újból megpróbálkozna vele. Az LPD tehát ebben az esetben újraindítja a szûrõt.</p></dd><dt class=hdlist1>2</dt><dd><p>A szûrõnek nem sikerült kinyomtatnia az állományt, és nem is kívánja újra megpróbálni. Ekkor az LPD eldobja az állományt.</p></dd></dl></div><div class=paragraph><p>A FreeBSD kiadásokban megtalálható <span class=filename>/usr/libexec/lpr/lpf</span> szövegszûrõ képes a kapott szélesség és hossz paraméterekkel megállapítani az oldaltöréseket és a nyomtató használatát nyilvántartani, amihez a hozzáférés, gépnév és nyilvántartás adatait használja fel.</p></div><div class=paragraph><p>Amikor majd igyekszünk mellé újabb szûrõket beszerezni, ne felejtsük el ellenõrizni, hogy együtt tudnak-e mûködni az LPD-vel. Ha a válasz igen, akkor a fentebb említett paraméterek mindegyikét ismerniük kell. Az általános használatra készült szûrõk készítése során mi magunknak is be kell tartanunk ezeket az elvárásokat.</p></div></div><div class=sect4><h5 id=printing-advanced-if-conversion>9.4.1.2. Szöveges nyomtatási feladatok PostScript® nyomtatókon<a class=anchor href=#printing-advanced-if-conversion></a></h5><div class=paragraph><p>Ha csak egyedül dolgozunk a számítógépen és PostScript® (vagy bármilyen más nyelvet ismerõ) nyomtatónk van, valamint megígérjük, hogy soha nem küldünk sem mi, sem pedig nem küldetünk semmilyen más programmal nyers szöveget a nyomtatóra, akkor átléphetjük ezt a szakaszt.</p></div><div class=paragraph><p>Ha viszont egyaránt akarunk küldeni PostScript® programot és nyers szöveget tartalmazó nyomtatási feladatot a nyomtatónak, akkor ehhez kénytelenek vagyunk a rendszerünket beállítani. Elõször is szükségünk van szövegszûrõre, ami megállapítja, hogy a frissen érkezett nyomtatási feladat nyers szöveget vagy PostScript® programot tartalmaz-e. Minden PostScript®-alapú feladat a <code>%!</code> karaktersorozattal kezdõdik (a többi esetben olvassuk a nyomtató leírását). Szóval, ha a nyomtatandó állomány elsõ két karaktere ilyen, akkor egy PostScript® programmal van dolgunk és közvetlenül továbbküldhetjük a nyomtatási feladatot a nyomtatónak. Minden más esetben a szûrõnek elõbb át kell alakítania a szöveget PostScript® nyelvre.</p></div><div class=paragraph><p>Hogyan érhetjük el mindezt?</p></div><div class=paragraph><p>Ha soros nyomtatónk van, akkor erre a feladatra az <code>lprps</code> parancs tökéletes. Az <code>lprps</code> egy olyan PostScript® szûrõ, amely mind a két irányban képes közvetíteni. Folyamatosan rögzíti egy állományba a nyomtató állapotát, így a felhasználók és rendszergazdák pontosan látják a nyomtató jelenlegi állapotát (például <code>toner low</code> (a toner hamarosan kifogy) vagy <code>paper jam</code> (a papír beragadt)). Ami viszont sokkal lényegesebb, hogy a <code>psif</code> nevû program képes megmondani az érkezõ nyomtatási feladat valódi típusát, és ennek megfelelõen meg tudja hívni nyers szöveg átalakítására a <code>textps</code> (egy másik program, amit a <code>lprps</code> mellé kapunk) parancsot. Ezután az <code>lprps</code> elküldi a feladatot a nyomtatónak.</p></div><div class=paragraph><p>Az <code>lprps</code> a FreeBSD Portgyûjteményének része (lásd <a href=./#ports>A Portgyûjtemény</a>), ezért a használni kívánt papír méretétõl függõen pillanatok alatt magunk is letölhetjük, fordíthatjuk és telepíthetjük a <a class=package href=https://cgit.freebsd.org/ports/tree/print/lprps-a4/>print/lprps-a4</a> és <a class=package href=https://cgit.freebsd.org/ports/tree/print/lprps-letter/>print/lprps-letter</a> csomagok valamelyikét. Az <code>lprps</code> telepítése után egyszerûen csak adjuk meg a <code>psif</code> elérési útvonalát. Ha tehát telepítettük a Portgyûjteménybõl az <code>lprps</code> csomagot, akkor egy soros portra csatlakozó PostScript® nyomtató esetén ezt kell beírnunk az <span class=filename>/etc/printcap</span> állományba:</p></div><div class="literalblock programlisting"><div class=content><pre>:if=/usr/local/libexec/psif:</pre></div></div><div class=paragraph><p>Ezenkívül még az <code>rw</code> tulajdonsággal meg kell mondanunk az LPD-nek, hogy a nyomtatót írásra és olvasásra nyissa meg.</p></div><div class=paragraph><p>Amennyiben a PostScript® nyomtatónk a párhuzamos porton csatlakozik (és amiért a nyomtatónk nem képes az <code>lprps</code> által igényelt kétirányú kommunikációra), szövegszûrõként a következõ szkriptet fogjuk használni:</p></div><div class="literalblock programlisting"><div class=content><pre>#!/bin/sh
#
#  psif - PostScript vagy nyers szöveg nyomtatása PostScript nyomtatón
#  Ez a szkriptes változat, NEM pedig az lprps-hez mellékelt szûrõ
#  (a /usr/local/libexec/psif állomány)!
#

IFS=&#34;&#34; read -r first_line
first_two_chars=`expr &#34;$first_line&#34; : &#39;\(..\)&#39;`

if [ &#34;$first_two_chars&#34; = &#34;%!&#34; ]; then
    #
    #  PostScript: nyomtassuk ki.
    #
    echo &#34;$first_line&#34; &amp;&amp; cat &amp;&amp; printf &#34;\004&#34; &amp;&amp; exit 0
    exit 2
else
    #
    #  Nyers szöveg: alakítsuk át, majd nyomtassuk ki.
    #
    ( echo &#34;$first_line&#34;; cat ) | /usr/local/bin/textps &amp;&amp; printf &#34;\004&#34; &amp;&amp; exit 0
    exit 2
fi</pre></div></div><div class=paragraph><p>A fentebb szereplõ szkriptben a <code>textps</code> programot használjuk a nyers szövegek PostScript® programokra alakításához, de helyette bármilyen más konvertáló programot is igénybe vehetünk. A FreeBSD Portgyûjteményében (lásd <a href=./#ports>A Portgyûjtemény</a>) találhatunk erre a célra egy <code>a2ps</code> nevû programot is, amit esetleg érdemes lehet közelebbrõl megnéznünk.</p></div></div><div class=sect4><h5 id=printing-advanced-ps>9.4.1.3. PostScript® szimulációja nem PostScript® nyomtatókon<a class=anchor href=#printing-advanced-ps></a></h5><div class=paragraph><p>A PostScript® a magas színvonalú betûszedés és nyomtatás <em>de facto</em> szabványa. Emellett azonban a PostScript® egy <em>költséges</em> szabvány is. Az Aladdin Enterprises-nak hála azonban létezik egy hozzá hasonló szabad szoftver, a Ghostscript, amely képes FreeBSD-n is futni. A Ghostscript képes a legtöbb PostScript® állomány olvasására, megjelenítésére mindenféle eszközökön, beleértve a PostScript®et nem ismerõ nyomtatókat is. A Ghostscript és egy speciális szövegszûrõ telepítésével el tudjuk érni, hogy egy nem PostScript® nyomtató valódi PostScript® nyomtatóként viselkedjen.</p></div><div class=paragraph><p>Ha telepíteni szeretnénk, a Ghostscript megtalálható a FreeBSD Portgyûjteményében. Innen tehát magunk is könnyedén le tudjuk tölteni, fordítani és telepíteni.</p></div><div class=paragraph><p>A PostScript® nyomtatás szimulációjához elõször egy szûrõ segítségével észre kell vennünk, hogy egy PostScript® formátumú állományt készülünk kinyomtatni. Ha nem ilyen a nyomtatási feladat, akkor egyenesen a nyomtatóra küldjük, azonban minden más esetben elõször a Ghostscript segítségével átalakítjuk egy olyan formátumba, amit a nyomtató is képes feldolgozni.</p></div><div class=paragraph><p>Nézzünk erre egy példát: a most következõ szövegszûrõ a Hewlett Packard DeskJet 500-as nyomtatóihoz használható. Más nyomtató esetén cseréljük ki a <code>gs</code> (Ghostscript) parancs <code>-sDEVICE</code> paraméterét a neki megfelelõre. (A telepített Ghostscript által ismert nyomtatók listáját a <code>gs -h</code> paranccsal kérdezhetjük le.)</p></div><div class="literalblock programlisting"><div class=content><pre>#!/bin/sh
#
#  ifhp - Ghostscripttel szimulált Postscript nyomtatás DeskJet 500-on
#  Helye: /usr/local/libexec/ifhp

#
#  LF karaktereket CR+LF-ként kezeljük (elkerülve ezzel a HP/PCL
#  nyomtatókon a &#34;lépcsõzést&#34;):
#
printf &#34;\033&amp;k2G&#34; || exit 2

#
#  Az állomány elsõ két karakterének beolvasása
#
IFS=&#34;&#34; read -r first_line
first_two_chars=`expr &#34;$first_line&#34; : &#39;\(..\)&#39;`

if [ &#34;$first_two_chars&#34; = &#34;%!&#34; ]; then
    #
    #  Ez PostScript: küldjük át a Ghostscripten és nyomtassuk ki.
    #
    /usr/local/bin/gs -dSAFER -dNOPAUSE -q -sDEVICE=djet500 \
      -sOutputFile=- - &amp;&amp; exit 0
else
    #
    #  Nyers szöveg vagy HP/PCL, ezért küldjük át közvetlenül. Az utolsó
    #  lap kidobásához küldünk még egy lapdobást is.
    #
    echo &#34;$first_line&#34; &amp;&amp; cat &amp;&amp; printf &#34;\033&amp;l0H&#34; &amp;&amp;
exit 0
fi

exit 2</pre></div></div><div class=paragraph><p>Befejezésül az <code>if</code> tulajdonságon keresztül értesítenünk kell errõl a szûrõrõl az LPD-t is:</p></div><div class="literalblock programlisting"><div class=content><pre>:if=/usr/local/libexec/ifhp:</pre></div></div><div class=paragraph><p>Készen is vagyunk! Most már nyugodtan beírhatjuk, hogy <code>lpr sima.szöveg</code> vagy <code>lpr akármi.ps</code>, mind a kettõnek ki kell tudnia nyomtatódnia.</p></div></div><div class=sect4><h5 id=printing-advanced-convfilters>9.4.1.4. Konverziós szûrõk<a class=anchor href=#printing-advanced-convfilters></a></h5><div class=paragraph><p>Miután elvégeztük az <a href=#printing-simple>Alacsonyszintû nyomtatóbeállítás</a> címû szakaszban leírt beállításokat, a (nyers ASCII szöveg mellett) kedvenc állományformátumainkhoz is minden bizonnyal szeretnénk telepíteni néhány konverziós szûrõt.</p></div><div class=sect5><h6 id=_miért_használjunk_konverziós_szûrõket>9.4.1.4.1. Miért használjunk konverziós szûrõket?<a class=anchor href=#_miért_használjunk_konverziós_szûrõket></a></h6><div class=paragraph><p>A konverziós szûrõk segítségével állományok mindenféle formátumait könnyen ki tudjuk nyomtatni. Például tegyük fel, hogy sokat dolgozunk a TeX betûszedõ rendszerrel és egy PostScript® nyomtatónk van. Minden alkalommal, amikor egy DVI állományt hozunk létre a TeX forrásból, azt közvetlenül még nem tudjuk a nyomtatóra küldeni. Ehhez a következõ parancsokat kell kiadnunk:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>% dvips hínár-elemzés.dvi
% lpr hínár-elemzés.ps</code></pre></div></div><div class=paragraph><p>Ha telepítünk egy konverziós szûrõt a DVI állományokhoz, meg tudjuk spórolni ezt a manuális átalakítási lépést azzal, hogy átadjuk ezt a feladatot az LPD-nek. Így ezután mindig, amikor egy DVI állományt akarunk kinyomtatni, csupán egyetlen lépésre lesz szükségünk:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>% lpr <span class=nt>-d</span> hínár-elemzés.dvi</code></pre></div></div><div class=paragraph><p>Az LPD-nek a <code>-d</code> paraméterrel adjuk meg, hogy a nyomtatás elõtt hajtsa végre a DVI átalakítását. A <a href=#printing-lpr-options-format>Formázási és konverziós beállítások</a> címû szakaszban találjuk meg a többi konverziós opciót.</p></div><div class=paragraph><p>Minden olyan konverziós beállításhoz, amit használni szeretnénk a nyomtatóval, telepítenünk kell egy <em>konverziós szûrõt</em> (conversion filter) és meg kell adnunk a nevét az <span class=filename>/etc/printcap</span> állományban. A konverziós szûrõk az egyszerû nyomtatóbeállításnál szereplõ szövegszûrõkhöz hasonlítanak (lásd <a href=#printing-textfilter>A szövegszûrõ telepítése</a> szakasz) azzal a kivétellel, hogy a nyers szövegek kinyomtatása helyett ezek a szûrõk a nyomtató számára értelmes formátumra alakítják az állományokat.</p></div></div><div class=sect5><h6 id=_milyen_konverziós_szûrõket_érdemes_telepíteni>9.4.1.4.2. Milyen konverziós szûrõket érdemes telepíteni?<a class=anchor href=#_milyen_konverziós_szûrõket_érdemes_telepíteni></a></h6><div class=paragraph><p>Olyan konverziós szûrõket telepítsünk, amelyekre gyakran szükségünk lehet. Ha például sok DVI adatot szeretnénk nyomtatni a jövõben, akkor használjunk DVI konverziós szûrõt, vagy ha sok troff formátumú adatot nyomtatunk, akkor minden bizonnyal jól fog jönni egy troff szûrõ.</p></div><div class=paragraph><p>A következõ táblázat foglalja össze azokat a szûrõket, amelyekkel az LPD képes együttmûködni. Megtudhatjuk, hogy az <span class=filename>/etc/printcap</span> állományban melyik tulajdonság tartozik hozzájuk és hogyan hívjuk meg ezeket az <code>lpr</code> paranccsal:</p></div><table class="tableblock frame-none grid-all stretch informaltable"><col style=width:33.3333%><col style=width:33.3333%><col style=width:33.3334%><thead><tr><th class="tableblock halign-left valign-top">Állománytípus</th><th class="tableblock halign-left valign-top">Tulajdonság az /etc/printcap állományban</th><th class="tableblock halign-left valign-top">Az lpr kapcsolója</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class=tableblock>cifplot</p></td><td class="tableblock halign-left valign-top"><p class=tableblock><code>cf</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock><code>-c</code></p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>DVI</p></td><td class="tableblock halign-left valign-top"><p class=tableblock><code>df</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock><code>-d</code></p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>plot</p></td><td class="tableblock halign-left valign-top"><p class=tableblock><code>gf</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock><code>-g</code></p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>ditroff</p></td><td class="tableblock halign-left valign-top"><p class=tableblock><code>nf</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock><code>-n</code></p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>FORTRAN forrás</p></td><td class="tableblock halign-left valign-top"><p class=tableblock><code>rf</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock><code>-f</code></p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>troff</p></td><td class="tableblock halign-left valign-top"><p class=tableblock><code>tf</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock><code>-f</code></p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>raster</p></td><td class="tableblock halign-left valign-top"><p class=tableblock><code>vf</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock><code>-v</code></p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>nyers szöveg</p></td><td class="tableblock halign-left valign-top"><p class=tableblock><code>if</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>nincs, <code>-p</code>, vagy <code>-l</code></p></td></tr></tbody></table><div class=paragraph><p>A példánkban tehát a <code>lpr -d</code> parancs használata arra utal, hogy a nyomtatónak az <span class=filename>/etc/printcap</span> állományból a <code>df</code> tulajdonságára van szüksége.</p></div><div class=paragraph><p>Minden hadakozás ellenére állíthatjuk, hogy a FORTRAN források és a plot által használt szövegek formátuma napjainkra már elavultnak tekinthetõ. Ezért ezekhez az opciókhoz a saját szûrõinkkel tetszõleges formázási lehetõségeket rendelhetünk. Például, ha Printerleaf (az Interleaf asztali kiadványszerkesztõ formátuma) állományokat szeretnénk közvetlenül nyomtatni, akkor valószínûleg nem lesz szükségünk plot állományokra. Ezért a <code>gf</code> tulajdonságnak megadhatunk egy Printerleaf konverziós szûrõt, amelyen keresztül aztán a felhasználók az <code>lpr -g</code> paranccsal Printerleaf állományokat tudnak nyomtatni.</p></div></div><div class=sect5><h6 id=_konverziós_szûrõk_telepítése>9.4.1.4.3. Konverziós szûrõk telepítése<a class=anchor href=#_konverziós_szûrõk_telepítése></a></h6><div class=paragraph><p>Mivel a konverziós szûrõk az alap FreeBSD rendszeren kívülre kerülnek, ezért ezeket minden valószínûség szerint valahol a <span class=filename>/usr/local</span> könyvtárban találjuk meg. Ezen belül is általában a <span class=filename>/usr/local/libexec</span> könyvtárban fordulnak elõ, mivel ezeket csak az LPD futtatja, senki másnak nincs rájuk szüksége.</p></div><div class=paragraph><p>A konverziós szûrõk aktiválásához az <span class=filename>/etc/printcap</span> állományban egyszerûen adjuk meg az alkalmas tulajdonságoknak megfelelõ szûrõk elérési útvonalait.</p></div><div class=paragraph><p>A példánkban most felveszünk egy DVI konverziós szûrõt a <code>bamboo</code> nevû nyomtatóhoz. Itt ismét láthatjuk a korábban használt <span class=filename>/etc/printcap</span> állományt, ahol most azonban a <code>bamboo</code> nevû nyomtatónál hozzáadtunk egy <code>df</code> tulajdonságot:</p></div><div class="literalblock programlisting"><div class=content><pre>#
#  /etc/printcap (rose) -  egy df szûrõ hozzáadása a bamboo
#  nevû nyomtatóhoz
#
rattan|line|diablo|lp|Diablo 630 Line Printer:\
        :sh:sd=/var/spool/lpd/rattan:\
        :lp=/dev/lpt0:\
        :if=/usr/local/libexec/if-simple:

bamboo|ps|PS|S|panasonic|Panasonic KX-P4455 PostScript v51.4:\
        :sh:sd=/var/spool/lpd/bamboo:\
        :lp=/dev/ttyd5:ms#-parenb cs8 clocal crtscts:rw:\
        :if=/usr/local/libexec/psif:\
        :df=/usr/local/libexec/psdf:</pre></div></div><div class=paragraph><p>A DVI szûrõ ebben az esetben a <span class=filename>/usr/local/libexec/psdf</span> néven elérhetõ aprócska szkript. Ezt találhatjuk benne:</p></div><div class="literalblock programlisting"><div class=content><pre>#!/bin/sh
#
#  psdf - DVI szûrõ PostScript nyomtatóhoz
#  Helye: /usr/local/libexec/psdf
#
# Az lpr -d parancs hatására hívódik meg
#
exec /usr/local/bin/dvips -f | /usr/local/libexec/lprps &#34;$@&#34;</pre></div></div><div class=paragraph><p>A szkript a <code>dvips</code> parancsot szûrõként futtatja (az <code>-f</code> paraméterrel) a szabványos bemenetrõl, ahova a nyomtatási feladatot is kapja. Ezután elindítja az <code>lprps</code> PostScript® szûrõt (lásd a <a href=#printing-advanced-if-conversion>Szöveges nyomtatási feladatok PostScript® nyomtatókon</a> címû szakaszt) az LPD által átadott paraméterekkel. Az <code>lprps</code> parancs ezekkel a paraméterekkel tartja nyilván az így kinyomtatott lapokat.</p></div></div><div class=sect5><h6 id=_további_példák_konverziós_szûrõkre>9.4.1.4.4. További példák konverziós szûrõkre<a class=anchor href=#_további_példák_konverziós_szûrõkre></a></h6><div class=paragraph><p>A konverziós szûrõk telepítésének nincs bevált receptje, ezért ebben a szakaszban bemutatunk rájuk néhány mûködõ illusztrációt. Ezeket tudjuk felhasználni saját szûrõk elkészítésére. Vagy ha megtehetjük, használjuk közvetlenül ezeket.</p></div><div class=paragraph><p>Ebben a példa szkriptben Hewlett Packard LaserJet III-Si nyomtatókhoz hozunk létre raszteres (pontosabban GIF formátumú) konverziós szûrõt:</p></div><div class="literalblock programlisting"><div class=content><pre>#!/bin/sh
#
#  hpvf - GIF állományokat konvertál át HP/PCL-be, majd kinyomtatja
#  Helye: /usr/local/libexec/hpvf

PATH=/usr/X11R6/bin:$PATH; export PATH
giftopnm | ppmtopgm | pgmtopbm | pbmtolj -resolution 300 \
    &amp;&amp; exit 0 \
    || exit 2</pre></div></div><div class=paragraph><p>Úgy mûködik, hogy a GIF állományt elõször PNM (portable anymap), utána PGM (portable graymap), majd PBM (portable bitmap) formátumúra alakítja, amibõl végül LaserJet/PCL-kompatibilis adat lesz.</p></div><div class=paragraph><p>Ez lesz a hozzá tartozó <span class=filename>/etc/printcap</span> állomány:</p></div><div class="literalblock programlisting"><div class=content><pre>#
#  /etc/printcap (orchid)
#
teak|hp|laserjet|Hewlett Packard LaserJet 3Si:\
        :lp=/dev/lpt0:sh:sd=/var/spool/lpd/teak:mx#0:\
        :if=/usr/local/libexec/hpif:\
        :vf=/usr/local/libexec/hpvf:</pre></div></div><div class=paragraph><p>A most következõ szkript a groff betûszedû rendszerbõl érkezõ troff adatokat alakítja át a <code>bamboo</code> nevû PostScript® nyomtató számára:</p></div><div class="literalblock programlisting"><div class=content><pre>#!/bin/sh
#
#  pstf - a groff troff adait alakítja PS-re, majd kinyomtatja
#  Helye: /usr/local/libexec/pstf
#
exec grops | /usr/local/libexec/lprps &#34;$@&#34;</pre></div></div><div class=paragraph><p>A szkript az <code>lprps</code> parancs segítségével kommunikál a nyomtatóval. Ha a nyomtatónk párhuzamos porton csatlakozik, akkor helyette ezt a szkriptet használjuk:</p></div><div class="literalblock programlisting"><div class=content><pre>#!/bin/sh
#
#  pstf - a groff troff adatait alakítja PS-re, majd kinyomtatja
#  Helye: /usr/local/libexec/pstf
#
exec grops</pre></div></div><div class=paragraph><p>Kész is! A szûrõ életrekeltéséhez mindössze ennyit kell beillesztenünk az <span class=filename>/etc/printcap</span> állományba:</p></div><div class="literalblock programlisting"><div class=content><pre>:tf=/usr/local/libexec/pstf:</pre></div></div><div class=paragraph><p>Most pedig jöjjön a FORTRAN szerelmeseinek szívét megmelengetõ szkript. Ez egy olyan szövegszûrõ, amely bármelyik nyers szöveget közvetlenül kezelni tudó nyomtató esetén mûködik. A <code>teak</code> nevû nyomtatóhoz helyezzük be:</p></div><div class="literalblock programlisting"><div class=content><pre>#!/bin/sh
#
# hprf - FORTRAN szövegszûrõ LaserJet 3si-hez
# Helye: /usr/local/libexec/hprf
#

printf &#34;\033&amp;k2G&#34; &amp;&amp; fpr &amp;&amp; printf &#34;\033&amp;l0H&#34; &amp;&amp;
 exit 0
exit 2</pre></div></div><div class=paragraph><p>Az <span class=filename>/etc/printcap</span> állományban a <code>teak</code> nyomtatóhoz a következõ sor beírásával tudjuk engedélyezni ezt a szûrõt:</p></div><div class="literalblock programlisting"><div class=content><pre>:rf=/usr/local/libexec/hprf:</pre></div></div><div class=paragraph><p>Most pedig következzen egy utolsó, de az eddigieknél valamivel összetettebb példa. Ebben a korábban bemutatott <code>teak</code> nevû LaserJet nyomtatóhoz fogunk hozzáadni egy DVI szûrõt. Elõször is következzen a mûvelet egyszerûbb része: bõvítsük ki az <span class=filename>/etc/printcap</span> állományt a DVI szûrõ helyének megadásával:</p></div><div class="literalblock programlisting"><div class=content><pre>:df=/usr/local/libexec/hpdf:</pre></div></div><div class=paragraph><p>Ezután következzék a nehezebb rész: a szûrõ elkészítése. Ehhez szükségünk lesz egy DVI-rõl LaserJet/PCL-re alakító programra. A FreeBSD Portgyûjteményében (lásd <a href=./#ports>A Portgyûjtemény</a>) találunk is egyet: a csomag neve <a class=package href=https://cgit.freebsd.org/ports/tree/print/dvi2xx/>print/dvi2xx</a>. A csomag telepítésével megkapjunk a nekünk kellõ <code>dvilj2p</code> programot, ami képes DVI-t LaserJet IIp, LaserJet III és a LaserJet 2000 típusok által ismert kódokra fordítani.</p></div><div class=paragraph><p>A <code>dvilj2p</code> felhasználásától függetlenül a <code>hpdf</code> néven létrehozni kívánt szûrõnk még így is bonyolult lesz, hiszen a <code>dvilj2p</code> nem tud olvasni a szabványos bemenetrõl, hanem mindenáron egy állománnyal akar dolgozni. Sõt, olyan állománnyal, amelynek <span class=filename>.dvi</span> kiterjesztése van, ezért még a <span class=filename>/dev/fd/0</span> (vagyis a szabványos bemenethez tartozó eszközleíró) használata is akadályokba ütközik.</p></div><div class=paragraph><p>Üröm még az örömünkben, hogy a <span class=filename>/tmp</span> könyvtárat sem tudjuk felhasználni ideiglenes link létrehozására: a szimbolikus linkeket a <code>bin</code> felhasználó és csoport birtokolja, a szûrõt pedig a <code>daemon</code> felhasználó futtatja. A <span class=filename>/tmp</span> könyvtárban rááadásul csak a tulajdonosaik képesek állományokat átnevezni vagy törölni (sticky bit). Ezért a szûrõ ugyan létre tudna hozni egy linket, azonban ezt a feladata végeztével nem lesz majd képes törölni, mivel a link egy másik felhasználóhoz tartozik.</p></div><div class=paragraph><p>Ezért a szûrõ az aktuális könyvtárban fogja létrehozni ezt a szimbolikus linket, ami jelen esetünkben a nyomtatási rendszer által használt könyvtár lesz (ezt az <span class=filename>/etc/printcap</span> állomány <code>sd</code> tulajdonságával adjuk meg). Itt remekül el tudják végezni a feladataikat a szûrõk, különösen mivel (néha) több hely van itt, mint a <span class=filename>/tmp</span> könyvtárban.</p></div><div class=paragraph><p>Végül lássuk magát a szûrõt:</p></div><div class="literalblock programlisting"><div class=content><pre>#!/bin/sh
#
#  hpdf - DVI adat nyomtatása HP/PCL nyomtatón
#  Helye: /usr/local/libexec/hpdf

PATH=/usr/local/bin:$PATH; export PATH

#
#  Létrehozunk egy függvényt az átmeneti állományok törlésére. Ezek
#  az aktuális könyvtárban jönnek létre, ami pedig a nyomtatási
#  rendszer adott nyomtatóhoz tartozó könyvtára lesz.
#
cleanup() {
   rm -f hpdf$$.dvi
}

#
#  Létrehozunk egy függvényt a súlyos hibák kezelésére: írassunk ki
#  egy adott üzenetet és lépjünk ki a 2-es hibakóddal.  Ezzel üzenünk
#  az LPD-nek, hogy ne hajtsa végre újra a nyomtatási feladatot.
#
fatal() {
    echo &#34;$@&#34; 1&gt;&amp;2
    cleanup
    exit 2
}

#
#  Ha a felhasználó eltávolítja a nyomtatási feladatot a sorból, akkor az
#  LPD egy SIGINT jelzést fog küldeni, ezért próbáljuk meg azt elkapni
#  (néhány más egyéb jelzéssel együtt), így még tudjuk törölni az
#  ideiglenesen # létrehozott állományokat.
#
trap cleanup 1 2 15

#
#  Gondoskodjunk róla, hogy a feladat megkezdésekor még egyetlen
#  használt állomány sem létezik.
#
cleanup

#
#  Kössük össze a szabványos bemenetet egy DVI állománnyal (amit
#  majd nyomtatni akarunk).
#
ln -s /dev/fd/0 hpdf$$.dvi || fatal &#34;Cannot symlink /dev/fd/0&#34;

#
#  LF = CR+LF
#
printf &#34;\033&amp;k2G&#34; || fatal &#34;Cannot initialize printer&#34;

#
#  Alakítsuk át az adatot és nyomtassunk. A dvilj2p által visszaadott érték
#  nem túlságosan megbízható, ezért ne is foglalkozzunk vele.
#
dvilj2p -M1 -q -e- dfhp$$.dvi

#
#  Takarítsunk el magunk után és lépjünk ki szabályosan
#
cleanup
exit 0</pre></div></div></div><div class=sect5><h6 id=printing-advanced-autoconv>9.4.1.4.5. Automatikus konverziók: a konverziós szûrõk helyett<a class=anchor href=#printing-advanced-autoconv></a></h6><div class=paragraph><p>A konverziós szûrõk sokat segítenek egy kényelmes nyomtatási környezet kialakításában, azonban a használatukhoz a felhasználóknak (az <a href="https://man.freebsd.org/cgi/man.cgi?query=lpr&amp;sektion=1&amp;format=html">lpr(1)</a> parancson keresztül) egyenként hivatkozniuk kell rájuk. Ha a rendszerünk felhasználói nem eléggé mûveltek számítástechnikai téren, akkor még egy szûrõ megadása is zavaró lehet számukra. Ami még ennél is rosszabb, hogy egy rosszul megadott szûrõ hatására a nyomtató sem fogja jól kezelni az adott állomány formátumát és erre válaszul akár többszáz lapot is pillanatok alatt kiköphet magából.</p></div><div class=paragraph><p>A konverziós szûrõk telepítése helyett gyakran csak egy (alapértelmezett) szövegszûrõre van szükségünk, amely kideríti a nyomtatandó állomány pontos formátumát és magától elindítja a neki megfelelõ konverziós szûrõt. Ilyen esetekben például a <code>file</code> parancs pont a hasznunkra válhat. Persze <em>bizonyos</em> állománytípusok közt nagyon nehéz különbséget tenni - de ezekre továbbra is adhatunk még külön konverziós szûrõket.</p></div><div class=paragraph><p>A FreeBSD Portgyûjteményében találhatunk egy <code>apsfilter</code> elnevezésû szövegszûrõt (<a class=package href=https://cgit.freebsd.org/ports/tree/print/apsfilter/>print/apsfilter</a>), ami képes ilyen automatikus konverzióra. Képes felismerni a nyers szöveget, PostScript® programokat, DVI és szinte bármilyen formátumú állományokat, lefuttatni rájuk a megfelelõ átalakításokat, majd kinyomtatni ezeket.</p></div></div></div><div class=sect4><h5 id=printing-advanced-of>9.4.1.5. Kimeneti szûrõk<a class=anchor href=#printing-advanced-of></a></h5><div class=paragraph><p>Az LPD nyomtatási rendszer kezel egy eddig még nem tárgyalt szûrõtípust is: ez a kimeneti szûrõ. A kimeneti szûrõ a szövegszûrõhöz hasonlóan csak nyers szöveg nyomtatására használatos, de tartalmaz néhány egyszerûsítést. Ha kizárólag csak kimeneti szûrõket alkalmazunk, akkor:</p></div><div class=ulist><ul><li><p>Az LPD az egész nyomtatási feladathoz egyetlen kimeneti szûrõt fog használni, nem pedig minden állományhoz külön.</p></li><li><p>Az LPD a kimeneti szûrõ számára nem nyújt semmilyen segítséget a nyomtatási feladaton belül szereplõ állományok kezdetének vagy végének megállapításában.</p></li><li><p>Az LPD a szûrõnek nem adja át sem a felhasználó hozzáférését, sem pedig gépnevét, ezért nyilvántartásra nem alkalmas. Mindent összegezve lényegében csak két paramétert kap meg:</p><div class=paragraph><p><code>szûrõnév -w_szélesség_ -l_hossz_</code></p></div><div class=paragraph><p>ahol a <em>szélesség</em> a kérdéses nyomtató <code>pw</code> tulajdonságából, a <em>hossz</em> pedig a <code>pl</code> tulajdonságából származik.</p></div></li></ul></div><div class=paragraph><p>Ne bûvöljön el minket a szûrõ egyszerûsége! Ha például a nyomtatási feladatban minden állományt újabb lapon szeretnénk kezdeni, akkor azt kimeneti szûrõvel <em>nem tudjuk megoldani</em>. Erre a célra használjunk szövegszûrõt (másik nevén bemeneti szûrõt), lásd <a href=#printing-textfilter>A szövegszûrõ telepítése</a> szakaszt. Továbbá, a kimeneti szûrõ valójában <em>sokkal bonyolultabb</em> abban a tekintetben, hogy a beérkezõ adatok közül neki kell kikeresnie a speciális jelentéssel bíró karaktereket ugyanúgy, ahogy az LPD helyett saját magának kell küldenie a jelzéseket.</p></div><div class=paragraph><p>Azonban a kimeneti szûrõk használata <em>elkerülhetetlen</em>, ha például fejléclapokat akarunk nyomtatni, és esetleg még különbözõ inicializálásra használatos speciális kódokat vagy karakterláncokat akarunk ez elõtt kiküldeni. (Ellenben <em>badarság</em> a fejléclapoktól követelni a felhasználó adatait, hiszen az LPD a kimeneti szûrõnek nem ad semmilyen erre vonatkozó információt.)</p></div><div class=paragraph><p>Egyetlen nyomtató esetén az LPD egyaránt lehetõvé teszi kimeneti, szöveg- és más egyéb szûrõk használatát. Ilyenkor az LPD a kimeneti szûrõn keresztül csak a fejlécet tartalmazó oldal (lásd a <a href=#printing-advanced-header-pages>Fejléclapok</a> szakaszt) nyomtatását indítja el. Ezt követõen az LPD arra számít, hogy a kimeneti szûrõ két karakter, az ASCII 031 és az ezt követõ ASCII 001, hatására <em>leállítja magát</em>. Amikor tehát a kimeneti szûrõ érzékeli ezt a két karaktert (031, 001), akkor a <code>SIGSTOP</code> jelzéssel le kell állnia. Miután az LPD lefuttatta a többi szûrõt, a <code>SIGCONT</code> jelzéssel újraindítja a kimeneti szûrõt.</p></div><div class=paragraph><p>Ha van kimeneti szûrõnk, de <em>nincs</em> szövegszûrõnk, akkor az LPD minden további feldolgozás nélkül továbbadja a nyomtatási feladatot a kimeneti szûrõnek. Ahogy már korábban is említettük, a kimeneti szûrõ a nyomtatási feladatban levõ összes állományt egymás után nyomtatja ki, lapdobások vagy bármilyen más papírmozgatás nélkül, ezért valószínûleg <em>nem</em> ez kell nekünk. Az esetek túlnyomó részében ehhez elég egy szövegszûrõ.</p></div><div class=paragraph><p>A korábban szövegszûrõként beharangozott <code>lpf</code> program kimeneti szûrõként is képes funkcionálni. Ha szükségünk lenne egy gyorsan összecsapható kimeneti szûrõre, és nem akarunk a speciális karakterek, valamint a jelzések küldésével elidõzni, akkor próbálkozzunk az <code>lpf</code> használatával. Az <code>lpf</code> parancsot mellesleg becsomagolhatjuk egy olyan szkriptbe is, amely elvégzi a nyomtató számára szükséges inicializálást.</p></div></div><div class=sect4><h5 id=printing-advanced-lpf>9.4.1.6. Az <code>lpf</code> szövegszûrõ<a class=anchor href=#printing-advanced-lpf></a></h5><div class=paragraph><p>A FreeBSD bináris terjesztéséhez mellékelt <span class=filename>/usr/libexec/lpr/lpf</span> program egy szövegszûrõ (bemeneti szûrõ), amely képes (az <code>lpr -i</code> paranccsal hozzáadott nyomtatási feladatokat) tabulálni, (az <code>lpr -l</code> paranccsal felvett nyomtatási feladatokban) a vezérlõkaraktereket figyelemen kívül hagyni, a nyomtatási feladatban elõforduló törlések és behúzások nyomtatási pozícióját igazítani és nyilvántartani a kinyomtatott lapokat. Kimeneti szûrõként is tud viselkedni.</p></div><div class=paragraph><p>Az <code>lpf</code> szûrõ rengeteg nyomtatási környezetben felhasználható. Habár nem képes a nyomtatónak inicializáló jelsorozatokat küldeni, mégis könnyû olyan szkriptet írni, amely elvégzi ezeket a hiányzó kezdeti beállításokat, majd lefuttatja az <code>lpf</code> szûrõt.</p></div><div class=paragraph><p>Az <code>lpf</code> akkor lesz képes helyesen számolni a kinyomtatott lapokat, ha ehhez az <span class=filename>/etc/printcap</span> állományban jól töltjük ki a <code>pw</code> és <code>pl</code> tulajdonságokat. Ezen értékek segítségével határozható meg ugyanis, hogy mennyi szöveg fért rá egy lapra és így mennyi lapot emésztett fel az adott felhasználó által küldött nyomtatási feladat. A nyomtatás nyilvántartásával kapcsolatban <a href=#printing-advanced-acct>A nyomtató használatának nyilvántartása</a> címû szakaszt érdemes elolvasni.</p></div></div></div><div class=sect3><h4 id=printing-advanced-header-pages>9.4.2. Fejléclapok<a class=anchor href=#printing-advanced-header-pages></a></h4><div class=paragraph><p>Ha <em>nagyon sok</em> felhasználónk van, és sok különbözõ nyomtatót is használnak, akkor elõbb vagy utóbb minden bizonnyal elkerülhetetlenné fog válni a <em>fejléclapok</em> használata.</p></div><div class=paragraph><p>A fejléc-, vagy más néven <em>munka-</em> vagy <em>elválasztó lapok</em> segítik elõ az elvégzett nyomtatási feladatok azonosítását. A többi dokumentumtól eltérõ módon, általában dekoratív keretben, nagy, vastag betûkkel nyomtatódnak ki, hogy a halomnyi papír között a felhasználók könnyedén megtalálhassák az elküldött nyomtatási feladataik eredményét. Természetesen a fejléclapok nyilvánvaló hátulütõje, hogy így minden nyomtatási feladathoz még egy lappal többet kell elhasználni és mivel gyakorlatilag néhány percnél tovább nincs is rájuk szükség, meglehetõsen hamar a kukába kerülnek. (A fejléclapok nyomtatási feladatonként jönnek létre, nem pedig a nyomtatási feladatokban levõ állományokhoz egyenként, ezért nem is akkora pazarlás ez.)</p></div><div class=paragraph><p>Az LPD rendszer képes magától fejléclapokat készíteni a nyomtatásokhoz, <em>amennyiben</em> a nyomtatónk képes közvetlenül nyers szöveget nyomtatni. Ha PostScript® nyomtatónk van, akkor ennek legyártásához egy külsõ programra van szükségünk, lásd a <a href=#printing-advanced-header-pages-ps>Fejléclapok PostScript® nyomtatókon</a> szakaszt.</p></div><div class=sect4><h5 id=printing-advanced-header-pages-enabling>9.4.2.1. A fejléclapok engedélyezése<a class=anchor href=#printing-advanced-header-pages-enabling></a></h5><div class=paragraph><p>Az <a href=#printing-simple>Alacsonyszintû nyomtatóbeállítás</a> címû szakaszban az <span class=filename>/etc/printcap</span> állományban a <code>sh</code> (úgy mint "suppress header") tulajdonsággal kikapcsoltuk a fejléclapokat. A fejléclapok engedélyezéséhez mindössze el kell távolítanunk ezt az <code>sh</code> tulajdonságot.</p></div><div class=paragraph><p>Ez túl egyszerû, nemde?</p></div><div class=paragraph><p>Igen, ez így van. <em>Elõfordulhat</em>, hogy szükségünk van még egy olyan kimeneti szûrõre is, amely inicializáló karaktereket küld a nyomtatónak. Íme egy példa ehhez a Hewlett Packard PCL-kompatibilis nyomtatói esetére:</p></div><div class="literalblock programlisting"><div class=content><pre>#!/bin/sh
#
#  hpof - Kimeneti szûrõ Hewlett Packard PCL-kompatibilis nyomtatókhoz
#  Helye: /usr/local/libexec/hpof

printf &#34;\033&amp;k2G&#34; || exit 2
exec /usr/libexec/lpr/lpf</pre></div></div><div class=paragraph><p>Az <code>of</code> tulajdonsággal adjuk meg a kimeneti szûrõt. A <a href=#printing-advanced-of>Kimeneti szûrõk</a> szakaszban errõl részletesebben is olvashatunk.</p></div><div class=paragraph><p>A korábban ismertetett <code>teak</code> nevû nyomtatóhoz most az alábbi minta <span class=filename>/etc/printcap</span> állományt mellékeljük. Itt engedélyeztük a fejléclapokat és hozzátettük az iménti kimeneti szûrõt:</p></div><div class="literalblock programlisting"><div class=content><pre>#
#  /etc/printcap (orchid)
#
teak|hp|laserjet|Hewlett Packard LaserJet 3Si:\
        :lp=/dev/lpt0:sd=/var/spool/lpd/teak:mx#0:\
        :if=/usr/local/libexec/hpif:\
        :vf=/usr/local/libexec/hpvf:\
        :of=/usr/local/libexec/hpof:</pre></div></div><div class=paragraph><p>Mostantól kezdve, amikor a felhasználók a <code>teak</code> nyomtatón akarnak nyomtatni, minden nyomtatási feladathoz kapni fognak egy fejléclapot. Amennyiben a kedves felhasználók mégis keresgetni akarják a nyomtatásaikat, az <code>lpr -h</code> paranccsal tetszõleges módon letilthatják azokat. Az <a href="https://man.freebsd.org/cgi/man.cgi?query=lpr&amp;sektion=1&amp;format=html">lpr(1)</a> többi hasonló opcióját <a href=#printing-lpr-options-misc>A fejléclapokhoz tartozó beállítások</a> szakaszban találjuk.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Az LPD minden fejléclap után egy lapdobást küld. Ha erre a célra a nyomtatónk egy eltérõ karaktert vagy karaktersorozatot használ, akkor azt az <span class=filename>/etc/printcap</span> állomány <code>ff</code> tulajdonságával határozhatjuk meg.</p></div></td></tr></tbody></table></div></div><div class=sect4><h5 id=printing-advanced-header-pages-controlling>9.4.2.2. A fejléclapok vezérlése<a class=anchor href=#printing-advanced-header-pages-controlling></a></h5><div class=paragraph><p>A fejléclapok engedélyezésével az LPD egy ún. <em>hosszú fejlécet</em> fog készíteni, vagyis a felhasználót, a gépet és a nyomtatási feladatot jól azonosító, egész lapot kitöltõ óriási betûket. Erre egy példa (amiben a <code>rose</code> nevû géprõl <code>kelly</code> küldte az "outline" elnevezésû nyomtatási feladatot):</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>      k                   ll       ll
      k                    l        l
      k                    l        l
      k   k     eeee       l        l     y    y
      k  k     e    e      l        l     y    y
      k k      eeeeee      l        l     y    y
      kk k     e           l        l     y    y
      k   k    e    e      l        l     y   yy
      k    k    eeee      lll      lll     yyy y
                                               y
                                          y    y
                                           yyyy

                                   ll
                          t         l        i
                          t         l
       oooo    u    u   ttttt       l       ii     n nnn     eeee
      o    o   u    u     t         l        i     nn   n   e    e
      o    o   u    u     t         l        i     n    n   eeeeee
      o    o   u    u     t         l        i     n    n   e
      o    o   u   uu     t  t      l        i     n    n   e    e
       oooo     uuu u      tt      lll      iii    n    n    eeee

      r rrr     oooo     ssss     eeee
      rr   r   o    o   s    s   e    e
      r        o    o    ss      eeeeee
      r        o    o      ss    e
      r        o    o   s    s   e    e
      r         oooo     ssss     eeee

                                              Job:  outline
                                              Date: Sun Sep 17 11:04:58 1995</code></pre></div></div><div class=paragraph><p>Ezt követõen az LPD elküld még egy lapdobást is, ezért maga a nyomtatási feladat eredménye egy új oldalon fog kezdõdni (kivéve, ha az <span class=filename>/etc/printcap</span> állományban az adott nyomtatóhoz tartozó bejegyzésben megadtuk az <code>sf</code> (úgy mint "suppress form feeds", vagyis a lapdobások letiltása) tulajdonságot.</p></div><div class=paragraph><p>Ha úgy jobban tetszik, akkor az <span class=filename>/etc/printcap</span> állományban a <code>sb</code> tulajdonsággal az LPD utasítható <em>rövid fejlécek</em> készítésére is. Ilyenkor a fejléclap tartalma mindössze ennyi lesz:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>rose:kelly  Job: outline  Date: Sun Sep 17 11:07:51 1995</code></pre></div></div><div class=paragraph><p>Alapértelmezés szerint az LPD elõször a fejléclapot, majd a nyomtatási feladatot végzi el. Ezt a sorrendet az <span class=filename>/etc/printcap</span> állományban a <code>hl</code> (header last) tulajdonsággal meg tudjuk fordítani.</p></div></div><div class=sect4><h5 id=printing-advanced-header-pages-accounting>9.4.2.3. A nyomtató használatának nyilvántartása<a class=anchor href=#printing-advanced-header-pages-accounting></a></h5><div class=paragraph><p>Az LPD által felkínált fejléclapok használata során egyetlen irányelv érvényesül a nyilvántartásukban: a fejléclapok <em>költségmentesek</em>.</p></div><div class=paragraph><p>De miért?</p></div><div class=paragraph><p>Azért, mert kizárólag csak a kimeneti szûrõ képes a fejléclapok viselkedését irányítani, ami viszont nem képes semmiféle nyilvántartásra, hiszen nem kapja meg az ehhez szükséges <em>felhasználói- vagy gépnév</em> információkat, illetve nyilvántartásokat. Emiatt fogalma sincs róla, hogy kit terhel az adott nyomtató használata. Úgy sem tudjuk megoldani a problémát, ha a szöveg- vagy konverziós szûrõkben (ahol már rendelkezésünkre állnak a felhasználó és a gépének adatai) "növeljük a lapok számát eggyel" a nyomtatási feladatban, mivel a felhasználók az <code>lpr -h</code> parancs használatával kedvük szerint letilthatják a fejléclapokat. Ezt ugyan alapvetõen a természetet óvni kívánó felhasználók részesítik elõnyben, de ettõl függetlenül sem erõszakolhatjuk rá mindenkire.</p></div><div class=paragraph><p><em>Az sem elég</em>, ha minden szûrõ létrehozza a saját fejlécét (amiért aztán pénzt kérhetnénk). Mivel ha a felhasználók az <code>lpr -h</code> paranccsal le akarják tiltani a fejlécek használatát, attól a szûrõkhöz még mindig létrejönnek, hiszen az LPD a <code>-h</code> opcióról semmilyen értesítést nem küld át a szûrõknek.</p></div><div class=paragraph><p>Nos, ilyenkor mitévõk legyünk?</p></div><div class=paragraph><p>A lehetõségeink:</p></div><div class=ulist><ul><li><p>Elfogadjuk az LPD elvét, és nem számítunk fel költséget a fejléclapokra.</p></li><li><p>Az LPD helyett egy másik nyomtatási rendszert használunk, például az LPRng rendszert. A <a href=#printing-lpd-alternatives>Más nyomtatási rendszerek</a> címû szakaszban kiderül, milyen alternatívák érhetõek el az LPD kiváltására.</p></li><li><p>Írjunk mi magunk egy <em>intelligens</em> kimeneti szûrõt. Normális esetben a kimeneti szûrõk nem valók másra, csupán a nyomtató alaphelyzetbe hozására vagy egyszerûbb karakterkonverziók elvégzésére. Fejléclapokhoz és nyers szöveget tartalmazó nyomtatási feladathoz remekül használható (ahol nincs szöveg- (avagy bemeneti) szûrõ). Azonban ha a nyers szövegekhez van szövegszûrõnk, akkor az LPD a kimeneti szûrõt csak a fejléclapokhoz indítja el. Emellett a kimeneti szûrõ az LPD által generált fejléc szövegébõl képes megmondani, melyik felhasználóhoz és géphez tartozik a szóbanforgó fejléc. A módszer egyetlen bökkenõje, hogy a nyilvántartásokat tároló állományról viszont még így se tudunk semmilyen információt szerezni (mivel nem kapjuk meg az <code>af</code> tulajdonsággal beállított állomány nevét). Ha azonban egy rendszerszinten elérhetõ állományba mentjük ezeket az adatokat, akkor akár bele is drótozhatjuk ezt a kimeneti szûrõbe. A kimeneti szûrõnek az adatok megtalálásában ilyenkor úgy tudunk segíteni, ha az <span class=filename>/etc/printcap</span> állományban az <code>sh</code> (rövid fejléc) tulajdonságot állítjuk be. De ez igazából sok hûhó semmiért, és a felhasználók is jobban megbecsülik az olyan nagylelkû rendszergazdát, aki nem számítja fel nekik a fejléclapokat.</p></li></ul></div></div><div class=sect4><h5 id=printing-advanced-header-pages-ps>9.4.2.4. Fejléclapok PostScript® nyomtatókon<a class=anchor href=#printing-advanced-header-pages-ps></a></h5><div class=paragraph><p>Ahogy arról már korábban is szó esett, az LPD képes többféle nyomtató számára is megfelelõ, nyers szövegû fejléclapokat készíteni. Persze a PostScript® közvetlenül nem képes nyers szövegek nyomtatására, ezért az LPD ezen lehetõsége lényegében használhatatlan - többnyire.</p></div><div class=paragraph><p>Ilyen helyzetben a fejléclapok használatának nyilvánvaló módja, hogy minden szövegszûrõt fejlécek gyártására utasítunk. Ezek a szûrõk a felhasználóról és a gépérõl kapott információkból össze tudják állítani a megfelelõ fejléclapot. A megoldás hátránya, hogy ez még olyankor is megtörténik, amikor a felhasználók az <code>lpr -h</code> paranccsal küldik a nyomtatási feladataikat.</p></div><div class=paragraph><p>Kísérletezzünk egy kicsit ezzel a módszerrel! A most következõ szkript három paramétert fogad el (a felhasználó hozzáférést, a gép és a nyomtatási feladat nevét), majd ezekbõl létrehoz egy egyszerû PostScript® formátumú fejlécet:</p></div><div class="literalblock programlisting"><div class=content><pre>#!/bin/sh
#
#  make-ps-header - PostScript fejléc létrehozása a szabvány kimenetre
#  Helye: /usr/local/libexec/make-ps-header
#

#
#  Ezek itt a PostScript által használt egységekben vannak megadva
#  (72/col vagy 28/cm).  Írjuk át az általunk használt papírméretre,
#  A4-re vagy amit éppen használunk:
#
page_width=612
page_height=792
border=72

#
#  A paraméterek ellenõrzése.
#
if [ $# -ne 3 ]; then
    echo &#34;Usage: `basename $0` &lt;user&gt; &lt;host&gt; &lt;job&gt;&#34; 1&gt;&amp;2
    exit 1
fi

#
#  Mentsük el ezeket, leginkább az olvashatóság miatt.
#
user=$1
host=$2
job=$3
date=`date`

#
#  Küldjük el a PostScript-kódot a szabványos kimenetre.
#
exec cat &lt;&lt;EOF
%!PS

%
%  Gondoskodjunk róla, hogy ne zavarjuk az utánunk következõ
%  felhasználó nyomtatási feladatának végrehajtását.
%
save

%
%  Csináljunk egy csúf vastag szegélyt, körbe a papíron.
%
$border $border moveto
$page_width $border 2 mul sub 0 rlineto
0 $page_height $border 2 mul sub rlineto
currentscreen 3 -1 roll pop 100 3 1 roll setscreen
$border 2 mul $page_width sub 0 rlineto closepath
0.8 setgray 10 setlinewidth stroke 0 setgray

%
%  Jelenítsük meg a felhasználó azonosítóját szép, feltûnõ
%  betûkkel.
%
/Helvetica-Bold findfont 64 scalefont setfont
$page_width ($user) stringwidth pop sub 2 div $page_height 200 sub moveto
($user) show

%
%  Most pedig mutassuk az unalmas részleteket.
%
/Helvetica findfont 14 scalefont setfont
/y 200 def
[ (Job:) (Host:) (Date:) ] {
200 y moveto show /y y 18 sub def }
forall

/Helvetica-Bold findfont 14 scalefont setfont
/y 200 def
[ ($job) ($host) ($date) ] {
        270 y moveto show /y y 18 sub def
} forall

%
% Ennyi lett volna.
%
restore
showpage
EOF</pre></div></div><div class=paragraph><p>Ezzel a szkripttel pedig mindegyik konverziós és szövegszûrõ elõször létrehoz egy fejléclapot, majd elvégzi a felhasználó nyomtatási feladatát. Íme egy korábban már bemutatott DVI szûrõ, amit most kiegészítünk a fejléclapok használatával:</p></div><div class="literalblock programlisting"><div class=content><pre>#!/bin/sh
#
#  psdf - DVI szûrõ PostScript nyomtatóhoz
#  Helye: /usr/local/libexec/psdf
#
#  Az lpr -d parancs hatására hívódik meg.
#

orig_args=&#34;$@&#34;

fail() {
    echo &#34;$@&#34; 1&gt;&amp;2
    exit 2
}

while getopts &#34;x:y:n:h:&#34; option; do
    case $option in
        x|y)  ;; # Ignore
        n)    login=$OPTARG ;;
        h)    host=$OPTARG ;;
        *)    echo &#34;LPD started `basename $0` wrong.&#34; 1&gt;&amp;2
              exit 2
              ;;
    esac
done

[ &#34;$login&#34; ] || fail &#34;No login name&#34;
[ &#34;$host&#34; ] || fail &#34;No host name&#34;

( /usr/local/libexec/make-ps-header $login $host &#34;DVI File&#34;
  /usr/local/bin/dvips -f ) | eval /usr/local/libexec/lprps $orig_args</pre></div></div><div class=paragraph><p>Láthatjuk, hogy a szûrõnek a felhasználói- és a gépnév megállapításához végig kell néznie a paraméterek listáját. Ez lényegében minden más konverziós szûrõnél ugyanígy néz ki. Ez a lista azonban a szövegszûrõk esetén némileg eltér (lásd a <a href=#printing-advanced-filters>Hogyan mûködnek a szûrõk?</a> szakaszt).</p></div><div class=paragraph><p>Már az elõbbiekben is tárgyaltuk, hogy ez a megoldás, habár eléggé egyszerû, az <code>lpr</code> számára nem teszi lehetõvé a fejléclapok letiltását (a <code>-h</code> opció). Ha a felhasználóink kímélni akarják a fákat (vagy meg akarják úszni a fejléclapok égbeszökõ költségeit), akkor ezt nem tudják megtenni, hiszen a szûrõk minden nyomtatási feladathoz készíteni fognak fejléceket.</p></div><div class=paragraph><p>Ezt a korlátozást csak úgy tudjuk elsöpörni, ha bevetjük a <a href=#printing-advanced-header-pages-accounting>A nyomtató használatának nyilvántartása</a> szakaszban leírt cselt, tehát készítünk egy olyan kimeneti szûrõt, amely megkeresi az LPD-vel generált fejléceket és létrehozza azok PostScript® változatát. Ha valaki az <code>lpr -h</code> paranccsal küld nyomtatnivalót, akkor LPD nem készít hozzá fejléclapot, ahogy a kimeneti szûrõnk sem. A kimeneti szûrõ minden más esetben beolvassa az LPD által küldött szöveget és átküldi a neki megfelelõ PostScript® kódot a nyomtatóra.</p></div><div class=paragraph><p>Ha soros PostScript® nyomtatónk van, akkor használhatjuk a <code>psof</code> kimeneti szûrõhöz tartozó <code>lprps</code> parancsot is, ami pontosan az elõbbit végzi el. Hozzátennénk azonban, hogy a <code>psof</code> nem számolja a fejléclapokat.</p></div></div></div><div class=sect3><h4 id=printing-advanced-network-printers>9.4.3. Hálózati nyomtatás<a class=anchor href=#printing-advanced-network-printers></a></h4><div class=paragraph><p>A FreeBSD tud hálozaton is nyomtatni, vagyis tud távoli számítógépeknek is nyomtatási feladatot küldeni. A hálózati nyomtatás kifejezés általánosságban véve két különbözõ dologra utalhat:</p></div><div class=ulist><ul><li><p>Egy távoli számítógéphez kapcsolt nyomtató hozzáférését. A géphez a nyomtató a hagyományos soros vagy párhuzamos csatolófelületen keresztül kapcsolódik, amit aztán az LPD alkalmas beállításával a hálózaton mindenki számára elérhetõvé teszünk. A <a href=#printing-advanced-network-rm>Távoli számítógépekre csatlakoztatott nyomtatók</a> címû szakasz errõl szól.</p></li><li><p>Egy közvetlenül a hálózatra kapcsolt nyomtató hozzáférését. A nyomtató tehát rendelkezik még egy hálózati csatlakozással is a hagyományos soros vagy párhuzamos felület mellett (vagy éppen helyett). Egy ilyen nyomtató a következõképpen mûködhet:</p><div class=ulist><ul><li><p>Elfogadja az LPD kéréseit, és még képes nyomtatási feladatokat is tárolni. Ebben az esetben teljesen egyenértékû egy LPD alkalmazást futtató számítógéppel. Ekkor nincs más teendõnk, csak követnünk kell a <a href=#printing-advanced-network-rm>Távoli számítógépeken telepített nyomtatók</a> címû szakasz utasításait.</p></li><li><p>Hálózati adatfolyamokkal dolgozik. Ebben az esetben a nyomtatót "hozzá kell kapcsolnunk" a hálózaton található egyik számítógéphez, ami majd a nyomtatási feladatok tárolásáért és folyamatos küldéséért lesz felelõs. A <a href=#printing-advanced-network-net-if>Nyomtatók hálózati adatcsatlakozással</a> szakasz az ilyen fajtájú nyomtatók telepítésére tesz néhány javaslatot.</p></li></ul></div></li></ul></div><div class=sect4><h5 id=printing-advanced-network-rm>9.4.3.1. Távoli számítógépekre csatlakoztatott nyomtatók<a class=anchor href=#printing-advanced-network-rm></a></h5><div class=paragraph><p>Az LPD nyomtatási rendszer alapból képes más, szintén LPD-t (vagy vele kompatibilis rendszert) futtató számítógépekre nyomtatási feladatokat küldeni. Ezzel lényegében az egyik géphez hozzá tudunk kapcsolni egy nyomtatót, amit aztán a többiek számára elérhetõvé teszünk. Ez olyan nyomtatók esetében is mûködik, amelyek ismerik az LPD által alkalmazott protokollt.</p></div><div class=paragraph><p>A távoli nyomtatáshoz elõször telepítsük a nyomtatót valamelyik számítógépre az <a href=#printing-simple>Alacsonyszintû nyomtatóbeállítás</a> szakaszban leírtak szerint, és ezzel az lesz a <em>nyomtatószerverünk</em>. Ezután, amennyiben szükségesnek találjuk, végezzünk <a href=#printing-advanced>magasabb szintû nyomtatóbeállítások</a>at is. Ne felejtsük el kipróbálni a nyomtatón, hogy rendesen mûködik az LPD mindegyik olyan beállításával, amit engedélyeztünk. Emellett gondoskodjunk minden olyan jogosultságról is, amivel a <em>helyi számítógéprõl</em> el tudjuk érni a <em>távoli számítógép</em> által felkínált LPD szolgáltatást (lásd <a href=#printing-advanced-restricting-remote>Távoli számítógépekrõl érkezõ kérések szabályozása</a>).</p></div><div class=paragraph><p>Ha olyan nyomtatót használunk, aminek a hálózati felülete kompatibilis az LPD rendszerrel, akkor az elõbb említett <em>nyomtatószerver</em> lényegében maga lesz a nyomtató, valamint a <em>nyomtató neve</em> a rajta beállított név. Ezzel kapcsolatban olvassuk el a nyomtatóhoz és/vagy a hálózati csatolójához mellékelt dokumentációt.</p></div><div class="admonitionblock tip"><table><tbody><tr><td class=icon><i class="fa icon-tip" title=Tip></i></td><td class=content><div class=paragraph><p>Amikor a Hewlett Packard Laserjet típusú nyomtatóit használjuk, a <code>text</code> nevû nyomtatónév magától elvégzi a LF és CRLF formátumú sortörések közti átalakítást, ezért ilyenkor nincs szükségünk a <span class=filename>hpif</span> szkriptre.</p></div></td></tr></tbody></table></div><div class=paragraph><p>Ezután ha szeretnénk más gépek részére is elérhetõvé tenni a frissen telepített nyomtatónkat, adjuk meg mindegyikük <span class=filename>/etc/printcap</span> állományában a következõket:</p></div><div class="olist arabic"><ol class=arabic><li><p>Tetszõlegesen választott nevet, álneveket. Az egyszerûség kedvéért azonban itt érdemes ugyanazokat a neveket választani, mint amit a nyomtatószerveren is használunk.</p></li><li><p>Szándékosan hagyjuk az <code>lp</code> tulajdonságot üresen (<code>:lp=:</code>).</p></li><li><p>Hozzunk létre egy nyomtatási könyvtárat, és jelöljük meg a helyét az <code>sd</code> tulajdonsággal. Az LPD itt fogja összegyûjteni a nyomtatási feladatokat, mielõtt elküldené azokat a nyomtatószervernek.</p></li><li><p>Adjuk meg a nyomtatószerver nevét az <code>rm</code> tulajdonság segítségével.</p></li><li><p>Az <code>rp</code> tulajdonsággal adjuk meg a <em>nyomtatószerverre</em> csatlakoztatott nyomtató nevét.</p></li></ol></div><div class=paragraph><p>Kész! Az <span class=filename>/etc/printcap</span> állományban már nem kell megadni konverziós szûrõket, oldalbeállításokat és semmi más egyebet.</p></div><div class=paragraph><p>Lássunk mindezekre egy példát. A <code>rose</code> nevû számítógéphez két nyomtató csatlakozik, a <code>bamboo</code> és a <code>rattan</code>. Most pedig beállítjuk, hogy az <code>orchid</code> nevû gép felhasználói képesek legyenek ezekkel a nyomtatókkal dolgozni. Ekkor a most következõk szerint fog kinézni az <code>orchid</code> (a <a href=#printing-advanced-header-pages-enabling>Fejléclapok engedélyezése</a> szakaszban bemutatott) <span class=filename>/etc/printcap</span> állománya. Tartalmazza a <code>teak</code> nevû nyomtató beállításait is, és ehhez fogjuk hozzáadni a <code>rose</code> másik két nyomtatóját:</p></div><div class="literalblock programlisting"><div class=content><pre>#
#  /etc/printcap (orchid) - a rose két (távoli) nyomtatójának
#  hozzáadása
#

#
#  A &#34;teak&#34; egy helyi nyomtató, közvetlenül az orchidhoz
#  csatlakozik:
#
teak|hp|laserjet|Hewlett Packard LaserJet 3Si:\
        :lp=/dev/lpt0:sd=/var/spool/lpd/teak:mx#0:\
        :if=/usr/local/libexec/ifhp:\
        :vf=/usr/local/libexec/vfhp:\
        :of=/usr/local/libexec/ofhp:

#
#  A &#34;rattan&#34; rose-hoz csatlakozik, így küldhetünk neki nyomtatási
#  feladatot:
#
rattan|line|diablo|lp|Diablo 630 Line Printer:\
        :lp=:rm=rose:rp=rattan:sd=/var/spool/lpd/rattan:

#
#  A &#34;bamboo&#34; is a rose-hoz tartozik:
#
bamboo|ps|PS|S|panasonic|Panasonic KX-P4455 PostScript v51.4:\
        :lp=:rm=rose:rp=bamboo:sd=/var/spool/lpd/bamboo:</pre></div></div><div class=paragraph><p>Ezután már csak létre kell hoznunk a megfelelõ nyomtatási könyvtárakat az <code>orchid</code> nevû gépen:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># mkdir -p /var/spool/lpd/rattan /var/spool/lpd/bamboo</span>
<span class=c># chmod 770 /var/spool/lpd/rattan /var/spool/lpd/bamboo</span>
<span class=c># chown daemon:daemon /var/spool/lpd/rattan /var/spool/lpd/bamboo</span></code></pre></div></div><div class=paragraph><p>Mostantól kezdve az <code>orchid</code> felhasználói képesek lesznek nyomtatni a <code>rattan</code> és <code>bamboo</code> nevû nyomtatókon is. Ezért, ha az <code>orchid</code> egyik felhasználója beírja, hogy:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>% lpr <span class=nt>-P</span> bamboo <span class=nt>-d</span> sushi-leírás.dvi</code></pre></div></div><div class=paragraph><p>Az <code>orchid</code> gépen mûködõ LPD rendszer ezt a nyomtatási feladatot a bemásolja a <span class=filename>/var/spool/lpd/bamboo</span> nevû nyomtatási könyvtárba és feljegyzi róla, hogy a nyomtatásához DVI szûrõre lesz szükség. Ahogy <code>rose</code> gépen található <code>bamboo</code> nyomtatási könyvtárában elegendõ hely keletkezik, a két LPD átküldi egymás közt a <code>rose</code> nevû gépre az állományt. Ezután az állomány egészen addig várakozik a <code>rose</code> nyomtatási sorában, amíg végezetül kinyomtatásra nem kerül. A <code>rose</code> fogja átalakítani DVI-rõl PostScript® formátumra átalakítani (mivel a <code>bamboo</code> egy PostScript® nyomtató).</p></div></div><div class=sect4><h5 id=printing-advanced-network-net-if>9.4.3.2. Nyomtatók hálózati adatcsatlakozással<a class=anchor href=#printing-advanced-network-net-if></a></h5><div class=paragraph><p>Amikor hálózati kártyát vásárolunk a nyomtatónkhoz, általában két változatukkal találkozhatunk: az egyikük nyomtatási rendszerként mûködik (ez a drágább), a másikuk pedig egyszerûen csak soros vagy párhuzamos csatlakozón továbbítandó adatként közvetíti az adatokat a nyomtató felé (az olcsóbb). A drágábbik változatot az elõzõ, <a href=#printing-advanced-network-rm>Távoli számítógépekre csatlakoztatott nyomtatók</a> címû szakaszban leírtak szerint tudjuk használni.</p></div><div class=paragraph><p>Az <span class=filename>/etc/printcap</span> állományban ugyan meg tudjuk adni, hogy a nyomtató soros vagy párhuzamos portra csatlakozik, és azon keresztül milyen adatátviteli sebességgel (amennyiben soros), forgalomirányítással, tabulálással, sortörési konvenció szerint stb. kommunikáljunk vele. Azonban TCP/IP vagy más hálózati porton ülõ nyomtatók adatait itt nem tudjuk kifejteni.</p></div><div class=paragraph><p>A hálózatra kötött nyomtatók használatához lényegében egy olyan külön kifejlesztett kommunikációs programra van szükségünk, amely a szöveg- vagy konverziós szûrõkhöz hasonló módon hívható meg. Erre rögtön adunk is egy példát: a <code>netprint</code> szkript a szabványos bemenetrõl beolvassa az összes kinyomtatandó adatot és átküldi azokat a hálózatra csatlakoztatott nyomtatónak. A szkript elsõ paramétereként a nyomtató hálózati nevét adjuk meg, másodiknak pedig portot. Azonban megjegyezzünk, hogy ez csak egyirányú kommunikációt tesz lehetõvé (a FreeBSD-tõl a nyomtatóig). Sok hálózati nyomtató viszont két irányban is képes kommunikálni, ezért érdemes lehet ezt kihasználni (a nyomtató állapotának lekérdezésére, nyilvántartások készítésére stb).</p></div><div class="literalblock programlisting"><div class=content><pre>#!/usr/bin/perl
#
#  netprint - A hálózatra csatlakoztatott nyomtató szövegszûrõje
#  Helye: /usr/local/libexec/netprint
#
$#ARGV eq 1 || die &#34;Usage: $0 &lt;printer-hostname&gt; &lt;port-number&gt;&#34;;

$printer_host = $ARGV[0];
$printer_port = $ARGV[1];

require &#39;sys/socket.ph&#39;;

($ignore, $ignore, $protocol) = getprotobyname(&#39;tcp&#39;);
($ignore, $ignore, $ignore, $ignore, $address)
    = gethostbyname($printer_host);

$sockaddr = pack(&#39;S n a4 x8&#39;, &amp;AF_INET, $printer_port, $address);

socket(PRINTER, &amp;PF_INET, &amp;SOCK_STREAM, $protocol)
    || die &#34;Can&#39;t create TCP/IP stream socket: $!&#34;;
connect(PRINTER, $sockaddr) || die &#34;Can&#39;t contact $printer_host: $!&#34;;
while (&lt;STDIN&gt;) { print PRINTER; }
exit 0;</pre></div></div><div class=paragraph><p>Rengeteg szûrõben fel tudjuk használni ezt a szkriptet. Például tegyük fel, hogy egy Diablo 750-N típusú sornyomtatót csatlakoztattunk a hálózatra, amely az 5100-as porton várja a nyomtatandó adatokat. A hálózati neve most <code>scrivener</code> lesz. Íme a hozzá tartozó szövegszûrõ:</p></div><div class="literalblock programlisting"><div class=content><pre>#!/bin/sh
#
#  diablo-if-net - Az 5100-as porton figyelõ `scrivener&#39; nevû Diablo
#  nyomtató szövegszûrõje. Helye: /usr/local/libexec/diablo-if-net
#
exec /usr/libexec/lpr/lpf &#34;$@&#34; | /usr/local/libexec/netprint scrivener 5100</pre></div></div></div></div><div class=sect3><h4 id=printing-advanced-restricting>9.4.4. A nyomtató használatának szabályozása<a class=anchor href=#printing-advanced-restricting></a></h4><div class=paragraph><p>Ebben a szakaszban a nyomtató használatának korlázásáról írunk. Az LPD rendszeren keresztül meghatározhatjuk, hogy ki képes helyben vagy távolról hozzáférni a nyomtatóhoz, mennyi másolatot nyomtathat, mennyi és egyenként mekkora nyomtatási feladatokat küldhet.</p></div><div class=sect4><h5 id=printing-advanced-restricting-copies>9.4.4.1. A másolatok számának szabályozása<a class=anchor href=#printing-advanced-restricting-copies></a></h5><div class=paragraph><p>Az LPD segítségével a felhasználók egy állományt könnyen ki tudnak nyomtatni akár többször is. Ha (például) a felhasználó egy nyomtatási feladat kiküldéséhez az <code>lpr -#5</code> parancsot használja, akkor a nyomtatási feladatban levõ összes állományból öt példányt kap. Ennek létjogosultságát azonban nekünk kell megítélni.</p></div><div class=paragraph><p>Amennyiben úgy érezzük, hogy a további példányok készítése csupán felesleges papír- és tintapazarlás, akkor az <code>sc</code> tulajdonság megadásával az <span class=filename>/etc/printcap</span> állományban kikapcsolhatjuk az <a href="https://man.freebsd.org/cgi/man.cgi?query=lpr&amp;sektion=1&amp;format=html">lpr(1)</a> <code>-<mark></mark></code> lehetõség használatát. Így amikor a felhasználók a <code>-</code> kapcsolóval küldenek el feladatokat a nyomtatóra, a következõt fogják tapasztalni:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>lpr: multiple copies are not allowed</code></pre></div></div><div class=paragraph><p>Fordítása:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>lpr: másolatok nyomtatása nem engedélyezett</code></pre></div></div><div class=paragraph><p>Vigyázzunk arra, hogy ha távoli számítógépen zajlik a nyomtatás (lásd <a href=#printing-advanced-network-rm>Távoli számítógépekre csatlakoztatott nyomtatók</a>), akkor az <code>sc</code> tulajdonságot a távoli számítógép <span class=filename>/etc/printcap</span> állományában is be kell állítani, máskülönben a felhasználók egy másik számítógéprõl mindig képesek lesznek több példány nyomtatására.</p></div><div class=paragraph><p>Nézzünk erre egy példát. Itt most a <code>rose</code> nevû számítógép <span class=filename>/etc/printcap</span> állományát vesszük szemügyre. Ebben a <code>rattan</code> egy nagyon szívélyes nyomtató lesz, ezért engedélyezi a másolatok nyomtatását, azonban a <code>bamboo</code> nevû lézernyomtató nála már sokkal válogatósabb lesz, ezért a beállításai közt az <code>sc</code> tulajdonsággal kikapcsoljuk a másodpéldányok nyomtatását:</p></div><div class="literalblock programlisting"><div class=content><pre>#
#  /etc/printcap (rose) - A másolatok korlátozása a &#34;bamboo&#34;
#  nevû nyomtatón
#
rattan|line|diablo|lp|Diablo 630 Line Printer:\
        :sh:sd=/var/spool/lpd/rattan:\
        :lp=/dev/lpt0:\
        :if=/usr/local/libexec/if-simple:

bamboo|ps|PS|S|panasonic|Panasonic KX-P4455 PostScript v51.4:\
        :sh:sd=/var/spool/lpd/bamboo:sc:\
        :lp=/dev/ttyd5:ms#-parenb cs8 clocal crtscts:rw:\
        :if=/usr/local/libexec/psif:\
        :df=/usr/local/libexec/psdf:</pre></div></div><div class=paragraph><p>Az <code>sc</code> tulajdonságot az <code>orchid</code><span class=filename>/etc/printcap</span> állományában is meg kell adni (és ha már itt vagyunk, akkor tegyük meg ugyanezt a <code>teak</code> esetében is):</p></div><div class="literalblock programlisting"><div class=content><pre>#
#  /etc/printcap (orchid) - Nincsenek másodpéldányok sem a helyi
#  &#34;teak&#34; nyomtatón, sem pedig a távoli &#34;bamboo&#34; nyomtatón
teak|hp|laserjet|Hewlett Packard LaserJet 3Si:\
        :lp=/dev/lpt0:sd=/var/spool/lpd/teak:mx#0:sc:\
        :if=/usr/local/libexec/ifhp:\
        :vf=/usr/local/libexec/vfhp:\
        :of=/usr/local/libexec/ofhp:

rattan|line|diablo|lp|Diablo 630 Line Printer:\
        :lp=:rm=rose:rp=rattan:sd=/var/spool/lpd/rattan:

bamboo|ps|PS|S|panasonic|Panasonic KX-P4455 PostScript v51.4:\
        :lp=:rm=rose:rp=bamboo:sd=/var/spool/lpd/bamboo:sc:</pre></div></div><div class=paragraph><p>Az <code>sc</code> tulajdonság használatával ugyan megakadályozzuk az <code>lpr -#</code> parancs teljesítését, azonban ez még mindig nem óv meg minket attól, hogy a felhasználók képesek legyenek többször egymás után lefuttatni az <a href="https://man.freebsd.org/cgi/man.cgi?query=lpr&amp;sektion=1&amp;format=html">lpr(1)</a> parancsot, vagy éppen egyetlen nyomtatási feladatban több állományt is elküldeni:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>% lpr forsale.sign forsale.sign forsale.sign forsale.sign forsale.sign</code></pre></div></div><div class=paragraph><p>Számos módszer kínálkozik az effajta visszaélések kivédésére (beleértve a figyelmen kívül hagyást is), lehet velük kísérletezgetni!</p></div></div><div class=sect4><h5 id=printing-advanced-restricting-access>9.4.4.2. A nyomtatók hozzáférésének szabályozása<a class=anchor href=#printing-advanced-restricting-access></a></h5><div class=paragraph><p>A UNIX® csoportkezelésével és az <span class=filename>/etc/printcap</span> állományban található <code>rg</code> tulajdonság felhasználásával korlátozni tudjuk, ki milyen nyomtatón dolgozhat. Ehhez mindössze annyit kell tennünk, hogy besoroljuk egy csoportba azokat a felhasználókat, amelyek hozzáférhetnek a nyomtatóhoz, és az <code>rg</code> tulajdonsággal megnevezzük azt.</p></div><div class=paragraph><p>A csoporton kívüli felhasználókat (köztük magát a <code>root</code> felhasználót is) pedig ezután így üdvözli a rendszer, ha megpróbálnak valamit kinyomtatni egy korlátozott felhasználású nyomtatón:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>lpr: Not a member of the restricted group</code></pre></div></div><div class=paragraph><p>Az üzenet fordítása:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>lpr: Nem jogosult felhasználó</code></pre></div></div><div class=paragraph><p>Ha erre a távoli számítógépek esetén szükségünk lenne (lásd <a href=#printing-advanced-network-rm>Távoli számítógépekre csatlakoztatott nyomtatók</a>), akkor tegyük ugyanazt, mint amit az <code>sc</code> (a másodpéldányok letiltása, "suppress multiple copies") tulajdonság esetén is, vagyis az <code>rg</code> tulajdonságot adjuk meg azokon a távoli számítógépeken is, amelyek hozzá tudnak férni a megosztott nyomtatóhoz.</p></div><div class=paragraph><p>Például megengedjük, hogy a <code>rattan</code> nevû nyomtatót bárki használhassa, azonban a <code>bamboo</code> nyomtatót csak az <code>artists</code> nevû csoport használhatja. Következzen hát akkor a <code>rose</code> korábbról már ismert <span class=filename>/etc/printcap</span> állománya:</p></div><div class="literalblock programlisting"><div class=content><pre>#
#  /etc/printcap (rose) - A bamboo hozzáférésének korlátozása
#
rattan|line|diablo|lp|Diablo 630 Line Printer:\
        :sh:sd=/var/spool/lpd/rattan:\
        :lp=/dev/lpt0:\
        :if=/usr/local/libexec/if-simple:

bamboo|ps|PS|S|panasonic|Panasonic KX-P4455 PostScript v51.4:\
        :sh:sd=/var/spool/lpd/bamboo:sc:rg=artists:\
        :lp=/dev/ttyd5:ms#-parenb cs8 clocal crtscts:rw:\
        :if=/usr/local/libexec/psif:\
        :df=/usr/local/libexec/psdf:</pre></div></div><div class=paragraph><p>Most ne bántsuk a másik (az <code>orchid</code> nevû gépen levõ) <span class=filename>/etc/printcap</span> állományt. Így persze az <code>orchid</code> bármelyik felhasználója nyomtathat a <code>bamboo</code> nyomtatón. De ez most egy olyan eset, ahol egyébként lekorlátozzuk a <code>orchid</code> elérését is, ezért az ott beengedett felhasználók már akár használhatják is a nyomtatót. Vagy sem.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Minden nyomtatóhoz csak egy ilyen csoportot adhatunk meg.</p></div></td></tr></tbody></table></div></div><div class=sect4><h5 id=printing-advanced-restricting-sizes>9.4.4.3. A beküldött nyomtatási feladatok méretének szabályozása<a class=anchor href=#printing-advanced-restricting-sizes></a></h5><div class=paragraph><p>Ha sok felhasználó szeretne a nyomtatóinkhoz hozzáférni, akkor minden bizonnyal meg akarunk adni egy felsõ határt a felhasználók által beküldhetõ nyomtatások méretére vonatkozóan. Mivel a nyomtatási könyvtáraknak otthont adó állományrendszer is egyszer betelhet, ezért mindenképpen érdemes gondoskodni arról, hogy mindenki nyomtatási feladatát el tudjuk rendesen tárolni.</p></div><div class=paragraph><p>Az LPD az <code>mx</code> tulajdonsággal lehetõséget ad arra, hogy lekorlátozzuk a nyomtatási feladatokban található egyes állományok méretét. Ennek mértékegysége egy <code>BUFSIZ</code> blokk, ami pedig 1024 byte. Ha értékül nullát adunk meg, akkor nincs korlátozás, viszont ha semmit sem rögzítünk, akkor az <code>mx</code> tulajdonság alapértéke, vagyis 1000 blokk lesz a határ.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Ez az érték a nyomtatási feladatokban levõ <em>egyes állományok</em> méretére vonatkozik, <em>nem</em> pedig a nyomtatási feladatok teljes méretére.</p></div></td></tr></tbody></table></div><div class=paragraph><p>Fontos tudni, hogy az LPD nem dobja vissza a méreten felüli állományokat. Ehelyett a méret alatti részt szépen berakja a sorba és kinyomtatja, a többi pedig elhagyja. Lehetne rajta vitázni, hogy ez mennyire helyes cselekedet.</p></div><div class=paragraph><p>Példaképpen definiáljunk a korábban használt <code>rattan</code> és <code>bamboo</code> nyomtatóinkhoz ilyen korlátokat. Mivel az <code>artists</code> csoport tagjai hajlamosak nagy PostScript® állományokat küldeni, ezért most lekorlátozzuk ezt öt megabyte-ra. A szöveges nyomtatónk esetén azonban nem lesz semmilyen határ:</p></div><div class="literalblock programlisting"><div class=content><pre>#
#  /etc/printcap (rose)
#

#
#  Itt nincs korlát a nyomtatási feladatokra:
#
rattan|line|diablo|lp|Diablo 630 Line Printer:\
        :sh:mx#0:sd=/var/spool/lpd/rattan:\
        :lp=/dev/lpt0:\
        :if=/usr/local/libexec/if-simple:

#
#  Öt megabyte a PostScript:
#
bamboo|ps|PS|S|panasonic|Panasonic KX-P4455 PostScript v51.4:\
        :sh:sd=/var/spool/lpd/bamboo:sc:rg=artists:mx#5000:\
        :lp=/dev/ttyd5:ms#-parenb cs8 clocal crtscts:rw:\
        :if=/usr/local/libexec/psif:\
        :df=/usr/local/libexec/psdf:</pre></div></div><div class=paragraph><p>Ismét hozzátesszük, hogy ezek a korlátok csak a helyi felhasználókra vonatkoznak. Amennyiben távolról is el lehet érni ezt a nyomtatót, a távoli felhasználókat nem fog semmilyen korlátozás érinteni. Azokon a számítógépeken is meg kell adnunk az <span class=filename>/etc/printcap</span> állományban az <code>mx</code> tulajdonságot. Ehhez a <a href=#printing-advanced-network-rm>Távoli számítógépekre csatlakoztatott nyomtatók</a> címû szakaszban találunk segítséget.</p></div><div class=paragraph><p>Van még egy speciális módszer, amivel képesek vagyunk szabályozni a távolról érkezõ kérések méretét. Errõl a <a href=#printing-advanced-restricting-remote>Távoli számítógépekrõl érkezõ kérések szabályozása</a> szakaszban olvashatunk.</p></div></div><div class=sect4><h5 id=printing-advanced-restricting-remote>9.4.4.4. Távoli számítógépekrõl érkezõ kérések szabályozása<a class=anchor href=#printing-advanced-restricting-remote></a></h5><div class=paragraph><p>Az LPD nyomtatási rendszer több módot is szolgáltat a távolról érkezõ nyomtatási feladatok szabályozására:</p></div><div class=dlist><dl><dt class=hdlist1>Az elérés szabályozása</dt><dd><p>Az <span class=filename>/etc/hosts.equiv</span> és <span class=filename>/etc/hosts.lpd</span> állományok segítségével beállíthatjuk, hogy mely távoli számítógépektõl fogadjon el kéréseket az LPD. Az LPD minden kérés elfogadásakor ellenõrzi, hogy a küldõ számítógép címe szerepel-e az említett állományok valamelyikében. Ha nem, akkor az LPD visszautasítja a kérést.</p><div class=paragraph><p>A két állomány felépítése egyszerû, mert bennük minden sorban egy-egy hálózati nevet adunk meg. Hozzátennénk azonban, hogy legyünk óvatosak, mivel az <span class=filename>/etc/hosts.equiv</span> állományt az <a href="https://man.freebsd.org/cgi/man.cgi?query=ruserok&amp;sektion=3&amp;format=html">ruserok(3)</a> protokoll is használja, ezért ennek módosítása hatással van az <a href="https://man.freebsd.org/cgi/man.cgi?query=rsh&amp;sektion=1&amp;format=html">rsh(1)</a> és <a href="https://man.freebsd.org/cgi/man.cgi?query=rcp&amp;sektion=1&amp;format=html">rcp(1)</a> programok mûködésére.</p></div><div class=paragraph><p>Például most nézzük meg a <code>rose</code><span class=filename>/etc/hosts.lpd</span> állományát:</p></div><div class="literalblock programlisting"><div class=content><pre>orchid
violet
madrigal.fishbaum.de</pre></div></div><div class=paragraph><p>Ennek megfelelõen tehát a <code>rose</code> elfogadja az <code>orchid</code>, <code>violet</code> és <code>madrigal.fishbaum.de</code> nevû távoli számítógépek kéréseit. Ha bármilyen más gép próbál hozzáférni a <code>rose</code> által felkínált LPD szolgáltatáshoz, visszautasítja.</p></div></dd><dt class=hdlist1>A méret szabályozása</dt><dd><p>Szabályozhatjuk többek közt azt is, hogy mennyi szabad területnek kell fennmaradnia a nyomtatási könyvtárnak otthont adó állományrendszeren. A helyi nyomtató könyvtárában ehhez hozzunk létre egy <span class=filename>minfree</span> nevû állományt. Ide írjuk be, mennyi szabad lemezblokk (512 byte-os egység a lemezen) szükségeltetik egy távolról beérkezõ nyomtatási feladat fogadásához.</p><div class=paragraph><p>Így gondoskodhatunk róla, hogy a távoli felhasználók nem fogják eltömíteni az állományrendszerünket, illetve ezzel egyúttal adhatunk némi elõnyt a helyi felhasználóknak is: õk ugyanis még azután is képesek lesznek nyomtatási feladatokat küldeni a nyomtatónak, miután az állományrendszeren található szabad terület mennyisége már rég a <span class=filename>minfree</span> állományban szereplõ érték alá csökkent.</p></div><div class=paragraph><p>Példaként most a <code>bamboo</code> nevû nyomtatónkhoz adjunk meg egy ilyen <span class=filename>minfree</span> állományt. Ehhez az <span class=filename>/etc/printcap</span> állományból tudjuk kideríteni a hozzá tartozó nyomtatási könyvtárat. Lássuk tehát belõle a <code>bamboo</code> bejegyzését:</p></div><div class="literalblock programlisting"><div class=content><pre>bamboo|ps|PS|S|panasonic|Panasonic KX-P4455 PostScript v51.4:\
        :sh:sd=/var/spool/lpd/bamboo:sc:rg=artists:mx#5000:\
        :lp=/dev/ttyd5:ms#-parenb cs8 clocal crtscts:rw:mx#5000:\
        :if=/usr/local/libexec/psif:\
        :df=/usr/local/libexec/psdf:</pre></div></div><div class=paragraph><p>A nyomtatási könyvtárat az <code>sd</code> tulajdonság határozza meg. Úgy állítjuk most be, hogy az LPD számára a távoli nyomtatási feladatok fogadásához ebben a könyvtárban legalább három megabyte (6144 blokk) szabad területnek mindig lennie kell:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># echo 6144 &gt; /var/spool/lpd/bamboo/minfree</span></code></pre></div></div></dd><dt class=hdlist1>A felhasználók szabályozása</dt><dd><p>Az <span class=filename>/etc/printcap</span> állományban megadható <code>rs</code> tulajdonság segítségével korlátozhatjuk a helyi nyomtatókhoz hozzáférni képes távoli felhasználókat. Amikor az <code>rs</code> tulajdonság szerepel egy helyben csatlakozó nyomtató leírásánál, akkor az LPD csak abban az esetben fogad el távoli felhasználóktól nyomtatási feladatot, <em>ha</em> az adott feladatot küldõ felhasználónak ugyanazon a néven van a helyi gépen is hozzáférése. Máskülönben az LPD vissza fogja utasítani a kérést.</p><div class=paragraph><p>Ez a tulajdonság különösen fontos olyan környezetben, ahol (például) több szervezeti egység használ egyetlen közös hálózatot és bizonyos felhasználók képesek átlépni szervezeti egységük határait, mivel ha a hozzáférést adunk nekik a rendszereinkhez, akkor képesek a saját helyükrõl használni ezeket. Ha ehelyett <em>csupán</em> a nyomtatóinkat és a számítógépünk összes erõforrását akarjuk megosztani, akkor létrehozhatunk a számukra olyan "token" hozzáféréseket is, amikhez nem tartozik sem felhasználói könyvtár, sem pedig parancsértelmezõ (pontosabban a <span class=filename>/usr/bin/false</span>).</p></div></dd></dl></div></div></div><div class=sect3><h4 id=printing-advanced-acct>9.4.5. A nyomtató használatának nyilvántartása<a class=anchor href=#printing-advanced-acct></a></h4><div class=paragraph><p>Tehát szükségünk lenne a nyomtatások költségének elszámolására. Miért is ne tennénk ilyet? A papír és a tinta bizony pénzbe kerül, amihez még hozzájárulnak más egyéb karbantartási költségek is - a nyomtatók dugig vannak mindenféle mozgó alkatrésszel, amelyek elõbb-utóbbi el is romlanak. Tegyük fel, hogy a nyomtatóink kapacitása, kihasználtsága és karbantartási költsége alapján már megállapítottunk egy elszámolási egységet (oldalanként, méterenként, akárminként). De hogyan lássunk hozzá a nyomtatások költségének tényleges nyilvántartásához?</p></div><div class=paragraph><p>Van egy rossz hírünk: az LPD nyomtatási rendszer önmaga nem tud segíteni ebben a feladatban. A nyilvántartás nagyban függ a használt nyomtatóktól, a nyomtatott formátumoktól és nyomtató <em>általunk</em> kiszabott költségeitõl.</p></div><div class=paragraph><p>A nyilvántartás létrehozásához át kell írnunk a nyomtatóhoz tartozó szûrõt (a nyers szövegek költségének felszámításához) és konverziós szûrõket (a különféle formátumok költségei miatt), amikkel aztán számolhatjuk vagy lekérdezhetjük a kinyomtatott lapokat. Egyetlen kimeneti szûrõ használatával szinte semmire se megyünk, mivel az nem képes nyilvántartás vezetésére. Errõl bõvebb útmutatást a <a href=#printing-advanced-filter-intro>Szûrõk</a> szakaszban találhatunk.</p></div><div class=paragraph><p>Általánosságban véve két módon vezethetünk nyilvántartást:</p></div><div class=ulist><ul><li><p>Az <em>idõszakos elszámolás</em> a gyakoribb, mivel ez az egyszerûbb. Amikor valaki végrehajt egy nyomtatási feladatot, a szûrõ a nyilvántartást tároló állományba feljegyzi a felhasználó azonosítóját, a gépének nevét és a kinyomtatott oldalakat. Ezután minden hónapban, félévben, évben vagy akár tetszõleges idõközönként összegyûjtjük a nyomtatók nyilvántartásait és külön feljegyezzük az egyes felhasználók nyomtatásait, majd benyújtjuk róla a számlát. Töröljük az összes naplóállományt, és tiszta lappal kezdjük a következõ idõszakot.</p></li><li><p>Az <em>azonnali elszámolás</em> már nem annyira népszerû, mivel nehezebb megvalósítani. Ekkor a felhasználók már közvetlenül a nyomtatás után megkapják a számlát, hasonlóan a lemezkvótákhoz. Meg tudjuk akadályozni ezzel azt is, hogy a felhasználók túlléphessék az elõre kiszabott "nyomtatási kvótájukat", amit persze menet közben lehet ellenõrizni és állítgatni. A felhasználók és kvótájuk nyomonkövetéséhez viszont szükségünk lesz egy kis adatbáziskezelésre is.</p></li></ul></div><div class=paragraph><p>Az LPD nyomtatási rendszer mind a két módszer kivitelezéséhez tud segítséget nyújtani, hiszen amikor szûrõket állítunk be (vagyis szinte mindig), lehetõségünk van a nyilvántartást végzõ programrészleteket is beilleszteni. És ami feltétlenül elõnyös: óriási mértékû rugalmasságot ajánl fel a nyilvántartás megvalósításához. Például magunk választhatjuk ki, hogy idõszakos vagy azonnali elszámolást alkalmazunk. Meg tudjuk adni, milyen információkat rögzítsünk: felhasználói neveket, számítógépek neveit, a nyomtatási feladatok típusát, vagy a kinyomtatott oldalakat, a felhasznált lapok területét, a nyomtatások idõbeli igényeit és így tovább. Ehhez mindössze csak a szûrõket kell módosítani.</p></div><div class=sect4><h5 id=_nyilvántartás_gyorsan_és_egyszerûen>9.4.5.1. Nyilvántartás gyorsan és egyszerûen<a class=anchor href=#_nyilvántartás_gyorsan_és_egyszerûen></a></h5><div class=paragraph><p>A FreeBSD-ben egybõl találunk is két programot, amivel pillanatok alatt ki tudunk alakítani egy egyszerû idõszakos elszámolási rendszert. Ezek <a href=#printing-advanced-lpf>Az lpf szövegszûrõ</a> címû szakaszban ismertetett <code>lpf</code> és a nyomtatók nyilvántartásait tartalmazó állományok adatainak összegyûjtését és kiértékelését végzõ <a href="https://man.freebsd.org/cgi/man.cgi?query=pac&amp;sektion=8&amp;format=html">pac(8)</a>.</p></div><div class=paragraph><p>Ahogy korábban már leírtuk a szûrõkrõl szóló szakaszban (<a href=#printing-advanced-filters>Szûrõk</a>), az LPD a szöveg- és konverziós szûrõket parancssorból a nyilvántartást tároló állomány nevével indítja el. Ezt a paramétert a szûrõk aztán fel tudják használni a nyilvántartások feljegyzéséhez. Az állomány nevét az <span class=filename>/etc/printcap</span> állományban szereplõ <code>af</code> tulajdonsággal tudjuk megadni, vagy teljes elérési úttal, vagy pedig a nyomtatási könyvtárhoz viszonyítva.</p></div><div class=paragraph><p>Az LPD az <code>lpf</code> szûrõt a lap szélességének és hosszának megadásával indítja el (ezeket az értékeket a <code>pw</code> és <code>pl</code> tulajdonságokból származtatja). Az <code>lpf</code> ezek felhasználásával meg tudja mondani, mennyi papírt használtunk el. Miután kiküldte az állományt a nyomtatóra, nyilvántartásba is veszi. Ezek a típusú bejegyzések valahogy így néznek ki:</p></div><div class="literalblock programlisting"><div class=content><pre>2.00 rose:andy
3.00 rose:kelly
3.00 orchid:mary
5.00 orchid:mary
2.00 orchid:zhang</pre></div></div><div class=paragraph><p>Minden nyomtatóhoz érdemes külön nyilvántartást vezetni, mivel az <code>lpf</code> nem tartalmaz semmilyen beépített zárolási megoldást, ezért két <code>lpf</code> párhuzamos futtatása könnyen összezagyválhatja a közösen használt nyilvántartások tartalmát. Az <span class=filename>/etc/printcap</span> állományban az <code>af=acct</code> tulajdonság megadásával könnyen létre tudunk hozni minden nyomtatóhoz külön nyilvántartást. Ilyenkor minden nyomtató könyvtárában megjelenik egy <span class=filename>acct</span> nevû állomány.</p></div><div class=paragraph><p>Amikor elérkezünk a nyomtatások kiszámlázásához, futtassuk le a <a href="https://man.freebsd.org/cgi/man.cgi?query=pac&amp;sektion=8&amp;format=html">pac(8)</a> programot. Ehhez mindössze annyit kell tennünk, hogy átlépünk az elszámolni kívánt nyomtató könyvtárába és begépeljük a <code>pac</code> parancsot. Ekkor kapunk egy ehhez hasonló, dollár alapú kimutatást:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>  Login               pages/feet   runs    price
orchid:kelly                5.00    1   <span class=nv>$ </span> 0.10
orchid:mary                31.00    3   <span class=nv>$ </span> 0.62
orchid:zhang                9.00    1   <span class=nv>$ </span> 0.18
rose:andy                   2.00    1   <span class=nv>$ </span> 0.04
rose:kelly                177.00  104   <span class=nv>$ </span> 3.54
rose:mary                  87.00   32   <span class=nv>$ </span> 1.74
rose:root                  26.00   12   <span class=nv>$ </span> 0.52

total                     337.00  154   <span class=nv>$ </span> 6.74</code></pre></div></div><div class=paragraph><p>A <a href="https://man.freebsd.org/cgi/man.cgi?query=pac&amp;sektion=8&amp;format=html">pac(8)</a> a következõ paramétereket várja:</p></div><div class=dlist><dl><dt class=hdlist1><code>-P <em>nyomtató</em></code></dt><dd><p>Az kiértékelendõ <em>nyomtató</em> neve. Ez a paraméter csak akkor használható, ha az <span class=filename>/etc/printcap</span> állományban az <code>af</code> tulajdonságnak teljes elérési utat adtunk meg.</p></dd><dt class=hdlist1><code>-c</code></dt><dd><p>A felhasználók nevei helyett a fizetendõ összeg szerint rendezze a listát.</p></dd><dt class=hdlist1><code>-m</code></dt><dd><p>Hagyja figyelmen kívül a nyilvántartásban szereplõ gépek hálózati neveit. Ennek hatására az <code>alpha</code> géprõl nyomtató <code>smith</code> meg fog egyezni a <code>gamma</code> géprõl nyomtatóval. A beállítás nélkül ez a két felhasználó el fog térni.</p></dd><dt class=hdlist1><code>-p <em>ár</em></code></dt><dd><p>A paraméterként megadott <em>ár</em> dollár értékkel számol oldalanként vagy lábanként az <span class=filename>/etc/printcap</span> állományban megadott <code>pc</code> tulajdonság értéke helyett (ami alapból két cent). Az <em>ár</em> lebegõpontos (valós) számként is megadható.</p></dd><dt class=hdlist1><code>-r</code></dt><dd><p>A rendezési sorrend megfordítása.</p></dd><dt class=hdlist1><code>-s</code></dt><dd><p>Hozzon létre egy elszámolást, majd törölje a hozzá kapcsolódó nyilvántartási adatokat.</p></dd><dt class=hdlist1><em>név…​</em></dt><dd><p>Csak az adott <em>nevû</em> felhasználók adatait értékelje ki.</p></dd></dl></div><div class=paragraph><p>A <a href="https://man.freebsd.org/cgi/man.cgi?query=pac&amp;sektion=8&amp;format=html">pac(8)</a> által alapértelmezés szerint generált kimutatásban láthatjuk az egyes gépekrõl származó egyes felhasználók kinyomtatott oldalait. Ha nekünk viszont nem számít, hogy honnan küldték a kéréseket (mivel bárhonnan lehet küldeni), akkor a <code>pac -m</code> paranccsal az alábbi táblázatot készíttethetjük el:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>  Login               pages/feet   runs    price
andy                        2.00    1   <span class=nv>$ </span> 0.04
kelly                     182.00  105   <span class=nv>$ </span> 3.64
mary                      118.00   35   <span class=nv>$ </span> 2.36
root                       26.00   12   <span class=nv>$ </span> 0.52
zhang                       9.00    1   <span class=nv>$ </span> 0.18

total                     337.00  154   <span class=nv>$ </span> 6.74</code></pre></div></div><div class=paragraph><p>Itt megtaláljuk a ténylegesen kifizetendõ összegeket is, amik kiszámításához a <a href="https://man.freebsd.org/cgi/man.cgi?query=pac&amp;sektion=8&amp;format=html">pac(8)</a> az <span class=filename>/etc/printcap</span> állomány <code>pc</code> tulajdonságát használja (ez alapból 200, avagy 2 cent oldalanként). Ezzel a tulajdonsággal tehát egy cent századrészében mérve tudjuk megadni az oldalakénti vagy lábankénti árakat. Ezt a beállítást természetesen a <a href="https://man.freebsd.org/cgi/man.cgi?query=pac&amp;sektion=8&amp;format=html">pac(8)</a> <code>-p</code> opciójával felül tudjuk bírálni. Arra azonban vigyázzunk, hogy a <code>-p</code> után dollárban kell megadnunk az árat. Emiatt tehát a</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># pac -p1.50</span></code></pre></div></div><div class=paragraph><p>parancs szerint minden egyes oldal másfél dollárba fog kerülni. Ezzel az opcióval aztán alaposan megdönthetjük az árakat.</p></div><div class=paragraph><p>Végezetül megemlítjük, hogy a <code>pac -s</code> parancs az általa létrehozott elszámolást egy külön állományba menti, amelynek a neve nagyjából megegyezik a nyilvántartást végzõével, de <code>_sum</code>-ra (mint "summary", azaz elszámolás) végzõdik. Ezután nullázza a nyilvántartást. Amikor a <a href="https://man.freebsd.org/cgi/man.cgi?query=pac&amp;sektion=8&amp;format=html">pac(8)</a> programot újra lefuttatjuk, újból beolvassa a korábban elmentett elszámolásokat, majd hozzászámolja a többit a hagyományos nyilvántartási adatokból.</p></div></div><div class=sect4><h5 id=_hogyan_tudjuk_számolni_a_kinyomtatott_lapokat>9.4.5.2. Hogyan tudjuk számolni a kinyomtatott lapokat?<a class=anchor href=#_hogyan_tudjuk_számolni_a_kinyomtatott_lapokat></a></h5><div class=paragraph><p>A nyilvántartás pontos vezetéséhez még távolról is valamilyen módon meg kell tudnunk mondani, hogy mennyi lapot használt egy nyomtatási feladat végrehajtása. Ez a nyomtatás nyilvántartásának egyik alapvetõ problémája.</p></div><div class=paragraph><p>A nyers szövegek esetében ez nem is annyira bonyolult: egyszerûen számoljuk össze, hogy a nyomtatási feladatban mennyi sor kinyomtatására lesz szükség és vessük össze ezt a nyomtató által lapoként kinyomtatott sorok számálva. Ne felejtsük el számításba venni a szövegben felbukkanó törlések hatását, vagy az olyan hosszú sorokat, amelyek a valóságban több sorban fognak megjelenni.</p></div><div class=paragraph><p>Viszont (<a href=#printing-advanced-lpf>Az lpf szövegszûrõ</a> címû szakaszban bemutatott) <code>lpf</code> program ezeket mind lekezeli a nyilvántartások készítése során. Ezért ha szintén egy nyilvántartást vezetni képes szövegszûrõt akarunk írni, akkor mindenképpen érdemes megnéznünk az <code>lpf</code> forráskódját.</p></div><div class=paragraph><p>De hogyan bánjunk el a többi formátummal?</p></div><div class=paragraph><p>Nos, a DVI-Laserjet és DVI-PostScript® közti átalakítások esetén a kinyomtatott lapok számának megállapításához meg kell tanítanunk a szûrõnket értelmezni a <code>dvilj</code> vagy <code>dvips</code> parancsok kimenetét. Ugyanezt meg tudjuk tenni más formátumok és más konverziós programok használata során is.</p></div><div class=paragraph><p>Azonban ezek a módszerek nem veszik számításba, hogy a nyomtató egyáltalán kinyomtatta-e az összes elküldött oldalt. Sok minden történhet még addig, például beragadhat a papír, kifogyhat a tinta vagy akár felrobbanhat a nyomtató - a felhasználónak ettõl függetlenül még fizetnie kell.</p></div><div class=paragraph><p>Mit lehet ilyenkor tenni?</p></div><div class=paragraph><p>A <em>precíz</em> nyilvántartásnak csak egyetlen <em>biztos</em> módja létezik. Olyan nyomtatót szerezzünk be, amely képes megmondani, mennyi lapot használt el a nyomtatás során, majd egy ilyet csatlakoztassunk soros porton vagy hálózaton keresztül. Szinte majdnem az összes PostScript® nyomtató támogatja ezt a lehetõséget, ahogy sok más gyártmány és típus is (például a hálózati Imagen lézernyomtatók). A nyomtatóhoz tartozó szûrõt ehhez úgy kell módosítani, hogy lekérdezzük a kinyomtatott lapok számát a nyomtatás után és <em>kizárólag</em> erre az értékre alapozva készítünk nyilvántartást. Itt nincs szükség sem a sorok számolására, sem pedig az állományok (könnyen elhibázható) átvizsgálására.</p></div><div class=paragraph><p>Természetesen lehetünk nagylelkûek és ne számítsunk fel semmit a nyomtatásért.</p></div></div></div></div><div class=sect2><h3 id=printing-using>9.5. A nyomtatók használata<a class=anchor href=#printing-using></a></h3><div class=paragraph><p>Ebbõl a szakaszból megtudhatjuk, hogyan használjuk a FreeBSD-n beállított nyomtatónkat. Röviden most itt foglaljuk össze az ide tartozó felhasználói parancsokat:</p></div><div class=dlist><dl><dt class=hdlist1><a href="https://man.freebsd.org/cgi/man.cgi?query=lpr&amp;sektion=1&amp;format=html">lpr(1)</a></dt><dd><p>Nyomtatási feladatokat hajt végre.</p></dd><dt class=hdlist1><a href="https://man.freebsd.org/cgi/man.cgi?query=lpq&amp;sektion=1&amp;format=html">lpq(1)</a></dt><dd><p>Ellenõrzi a nyomtatási sorokat.</p></dd><dt class=hdlist1><a href="https://man.freebsd.org/cgi/man.cgi?query=lprm&amp;sektion=1&amp;format=html">lprm(1)</a></dt><dd><p>Feladatokat vesz ki a nyomtatási sorokból.</p></dd></dl></div><div class=paragraph><p>Ezek mellett létezik még a nyomtatók és a hozzájuk tartozó sorok irányítására alkalmas parancs is, az <a href="https://man.freebsd.org/cgi/man.cgi?query=lpc&amp;sektion=8&amp;format=html">lpc(8)</a>, amelyre a <a href=#printing-lpc>A nyomtatók vezérlése</a> címû szakaszban fogunk részleteiben kitérni.</p></div><div class=paragraph><p>A nyomtatók/sorok <span class=filename>/etc/printcap</span> állományban szereplõ nevük szerinti megadásához az <a href="https://man.freebsd.org/cgi/man.cgi?query=lpr&amp;sektion=1&amp;format=html">lpr(1)</a>, <a href="https://man.freebsd.org/cgi/man.cgi?query=lprm&amp;sektion=1&amp;format=html">lprm(1)</a> és <a href="https://man.freebsd.org/cgi/man.cgi?query=lpq&amp;sektion=1&amp;format=html">lpq(1)</a> parancsok közül mindegyik elfogadja a <code>-P <em>nyomtatónév</em></code> paramétert. Ennek köszönhetõen képesek vagyunk nyomtatási feladatokat küldeni, eltávolítani vagy felügyelni az egyes nyomtatók soraiban. Ha nem használjuk a <code>-P</code> kapcsolót, akkor az érintett nyomtató a <code>PRINTER</code> környezeti változó által meghatározott lesz. Végül, ha a <code>PRINTER</code> nevû környezeti változót sem állítottuk be, akkor a parancsok alapértelmezett módon az <code>lp</code> nevû nyomtatót fogják használni.</p></div><div class=paragraph><p>A továbbiakban az <em>alapértelmezett nyomtató</em> kifejezés a <code>PRINTER</code> környezeti változó által megnevezett nyomtatóra fog utalni, illetve ha ezt nem definiáltuk, akkor az <code>lp</code> nevû nyomtatóra.</p></div><div class=sect3><h4 id=printing-lpr>9.5.1. Nyomtatási feladatok végrehajtása<a class=anchor href=#printing-lpr></a></h4><div class=paragraph><p>Az állományok kinyomtatásához írjuk be:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>% lpr állománynév ...</code></pre></div></div><div class=paragraph><p>Ezzel kinyomtatjuk az összes felsorolt állományt az alapértelmezett nyomtatón. Ha nem adunk meg állományokat, akkor az <a href="https://man.freebsd.org/cgi/man.cgi?query=lpr&amp;sektion=1&amp;format=html">lpr(1)</a> parancs a szabványos bemenetrõl várja a nyomtatandó adatokat. Például ezzel a paranccsal néhány igen fontos rendszerállományt tudunk kinyomtatni:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>% lpr /etc/host.conf /etc/hosts.equiv</code></pre></div></div><div class=paragraph><p>A nyomtató megválasztásához így adjuk ki a parancsot:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>% lpr <span class=nt>-P</span> nyomtatónév állománynév ...</code></pre></div></div><div class=paragraph><p>Ez a példa kinyomtatja az aktuális könyvtár részletes listáját a <code>rattan</code> nevû nyomtatón:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>% <span class=nb>ls</span> <span class=nt>-l</span> | lpr <span class=nt>-P</span> rattan</code></pre></div></div><div class=paragraph><p>Mivel egyetlen állományt sem adtunk meg az <a href="https://man.freebsd.org/cgi/man.cgi?query=lpr&amp;sektion=1&amp;format=html">lpr(1)</a> programnak, az <code>lpr</code> parancs a nyomtatandó adatokat a szabványos bemenetrõl várja, ami jelen esetünkben a <code>ls -l</code> parancs kimenete.</p></div><div class=paragraph><p>Az <a href="https://man.freebsd.org/cgi/man.cgi?query=lpr&amp;sektion=1&amp;format=html">lpr(1)</a> ezeken felül még képes értelmezni rengeteg formázásra, konverzióra, másolatok készítésére stb. utasító kapcsolót is. Errõl bõvebben a <a href=#printing-lpr-options>Nyomtatási beállítások</a> címû szakaszban lesz szó.</p></div></div><div class=sect3><h4 id=printing-lpq>9.5.2. Nyomtatási feladatok felügyelete<a class=anchor href=#printing-lpq></a></h4><div class=paragraph><p>Amikor az <a href="https://man.freebsd.org/cgi/man.cgi?query=lpr&amp;sektion=1&amp;format=html">lpr(1)</a> programmal nyomtatunk, az összes nyomtatandónk egy "nyomtatási feladatnak" nevezett csomagba kerül, ami pedig az LPD nyomtatási rendszerébe. Minden nyomtatóhoz tartozik egy nyomtatási sor, ahol részünkrõl és mások által eddig kiadott nyomtatási feladatokat találhatjuk. A nyomtató ezután ezeket érkezési sorrend szerint dolgozza fel.</p></div><div class=paragraph><p>Az alapértelmezett nyomtatóhoz tartozó sor állapotát az <a href="https://man.freebsd.org/cgi/man.cgi?query=lpq&amp;sektion=1&amp;format=html">lpq(1)</a> programmal tudjuk megnézni. Ha egy adott nyomtatóra vagyunk kíváncsiak, akkor használjuk a <code>-P</code> kapcsolót. Például a</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>% lpq <span class=nt>-P</span> bamboo</code></pre></div></div><div class=paragraph><p>parancs a <code>bamboo</code> nevû nyomtató sorát fogja megmutatni. Példaképpen lássuk is ilyen esetben az <code>lpq</code> parancs eredményét:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>bamboo is ready and printing
Rank   Owner    Job  Files                              Total Size
active kelly    9    /etc/host.conf, /etc/hosts.equiv   88 bytes
2nd    kelly    10   <span class=o>(</span>standard input<span class=o>)</span>                   1635 bytes
3rd    mary     11   ...                                78519 bytes</code></pre></div></div><div class=paragraph><p>Itt három nyomtatási feladatot láthatunk a <code>bamboo</code> nyomtatási sorában. Az elsõ nyomtatási feladat, amit a <code>kelly</code> nevû felhasználó küldött, a 9-es "feladatszámot" kapta. A nyomtatóhoz tartozó összes feladat kap egy ilyen egyedi számot. Többnyire nyugodtan figyelmen kívül hagyhatjuk, azonban szükségünk lehet rá, ha éppen törölni kívánjuk a hozzá tartozó nyomtatási feladatot. Ezzel majd a <a href=#printing-lprm>Nyomtatási feladatok eltávolítása</a> címû szakaszban foglalkozunk.</p></div><div class=paragraph><p>A kilences számú nyomtatási feladat két állományt tartalmaz: ha a parancssorban több állományt adunk meg az <a href="https://man.freebsd.org/cgi/man.cgi?query=lpr&amp;sektion=1&amp;format=html">lpr(1)</a> programnak, akkor az egy nyomtatási feladatnak számít. Ez egyben a pillanatnyilag aktív nyomtatási feladat (ezt a "Rank" oszlopban szereplõ <code>active</code> érték jelzi), tehát a nyomtató éppen ezzel foglalatoskodik. A második nyomtatási feladat közvetlenül az <a href="https://man.freebsd.org/cgi/man.cgi?query=lpr&amp;sektion=1&amp;format=html">lpr(1)</a> szabványos bemenetére érkezett. A harmadik a <code>mary</code> nevû felhasználótól jött, és ez egy nagyobb méretû nyomtatási feladat. A nyomtatandó állomány elérési útvonala túlságosan hosszú ahhoz, hogy ki lehessen írni, ezért az <a href="https://man.freebsd.org/cgi/man.cgi?query=lpr&amp;sektion=1&amp;format=html">lpr(1)</a> csak három pontot jelez ki helyette.</p></div><div class=paragraph><p>Az <a href="https://man.freebsd.org/cgi/man.cgi?query=lpq&amp;sektion=1&amp;format=html">lpq(1)</a> kimenetének elsõ sorai is nagyon hasznos információt tartalmaz: megtudhatjuk, mit csinál éppen (legalább is az LPD szerint) a nyomtató.</p></div><div class=paragraph><p>A <code>-l</code> kapcsolóval az <a href="https://man.freebsd.org/cgi/man.cgi?query=lpq&amp;sektion=1&amp;format=html">lpq(1)</a> parancstól kérhetünk sokkal részletesebb listázást is. Például így nézhet ki a <code>lpq -l</code> parancs eredménye:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>waiting <span class=k>for </span>bamboo to become ready <span class=o>(</span>offline ?<span class=o>)</span>
kelly: 1st				 <span class=o>[</span>job 009rose]
       /etc/host.conf                    73 bytes
       /etc/hosts.equiv                  15 bytes

kelly: 2nd				 <span class=o>[</span>job 010rose]
       <span class=o>(</span>standard input<span class=o>)</span>                  1635 bytes

mary: 3rd                                <span class=o>[</span>job 011rose]
      /home/orchid/mary/research/venus/alpha-regio/mapping 78519 bytes</code></pre></div></div></div><div class=sect3><h4 id=printing-lprm>9.5.3. Nyomtatási feladatok eltávolítása<a class=anchor href=#printing-lprm></a></h4><div class=paragraph><p>Ha meggondoltuk volna magunkat egy nyomtatási feladattal kapcsolatban, az <a href="https://man.freebsd.org/cgi/man.cgi?query=lprm&amp;sektion=1&amp;format=html">lprm(1)</a> paranccsal még törölni tudjuk a sorból. Az <a href="https://man.freebsd.org/cgi/man.cgi?query=lprm&amp;sektion=1&amp;format=html">lprm(1)</a> gyakran még a folyamatban levõ nyomtatási feladatot is képes eltávolítani, azonban elõfordulhat, hogy a nyomtatási feladat egy része már elvégzésre került.</p></div><div class=paragraph><p>Az alapértelmezett nyomtató sorából csak úgy tudunk nyomtatási feladatokat törölni, ha elõször az <a href="https://man.freebsd.org/cgi/man.cgi?query=lpq&amp;sektion=1&amp;format=html">lpq(1)</a> segítségével megkeressük a számukat. Ha ez megvan, írjuk be:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>% lprm feladatám</code></pre></div></div><div class=paragraph><p>Adott nyomtatóról a <code>-P</code> kapcsoló segítségével tudunk nyomtatási feladatot törölni. A most következõ parancs a <code>bamboo</code> nevû nyomtatóról törli a 10-es számú nyomtatási feladatot:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>% lprm <span class=nt>-P</span> bamboo 10</code></pre></div></div><div class=paragraph><p>Az <a href="https://man.freebsd.org/cgi/man.cgi?query=lprm&amp;sektion=1&amp;format=html">lprm(1)</a> parancs esetén még használhatóak az alábbi rövidítések is:</p></div><div class=dlist><dl><dt class=hdlist1>lprm -</dt><dd><p>Eltávolítja a hozzánk tartozó az összes nyomtatási feladatot (az alapértelmezett nyomtatón).</p></dd><dt class=hdlist1>lprm <em>felhasználó</em></dt><dd><p>Eltávolítja az adott <em>felhasználó</em>hoz tartozó összes nyomtatási feladatot (az alapértelmezett nyomtatón). Kizárólag a rendszergazdák képesek erre, a rendes felhasználók csak a saját nyomtatási feladataikat törölhetik.</p></dd><dt class=hdlist1>lprm</dt><dd><p>A nyomtatási feladat száma, a felhasználói név vagy a <code>-</code>megadása nélkül az <a href="https://man.freebsd.org/cgi/man.cgi?query=lprm&amp;sektion=1&amp;format=html">lprm(1)</a> törli az alapértelmezett nyomtatón éppen aktív nyomtatási feladatot, amennyiben az a miénk. Csak a rendszergazdák képesek bármilyen aktív nyomtatási feladatot törölni.</p></dd></dl></div><div class=paragraph><p>Ha kiegészítjük az imént említett rövidítéséket a <code>-P</code> paraméter megadásával, akkor az alapértelmezett nyomtató helyett bármelyik másikat is használhatjuk. Például ez a parancs eltávolítja az aktuális felhasználó összes nyomtatási feladatot a <code>rattan</code> nevû nyomtatón:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>% lprm <span class=nt>-P</span> rattan -</code></pre></div></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Hálózati környezetben az <a href="https://man.freebsd.org/cgi/man.cgi?query=lprm&amp;sektion=1&amp;format=html">lprm(1)</a> csak arról a géprõl engedi törölni a nyomtatási feladatokat, amelyrõl küldték ezeket, még abban az esetben is, amikor ugyanaz a nyomtató más számítógépekrõl is elérhetõ. A következõ parancssorozat ezt igyekszik szemléltetni:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>% lpr <span class=nt>-P</span> rattan myfile
% rlogin orchid
% lpq <span class=nt>-P</span> rattan
Rank   Owner	  Job  Files                          Total Size
active seeyan	  12	...                           49123 bytes
2nd    kelly      13   myfile                         12 bytes
% lprm <span class=nt>-P</span> rattan 13
rose: Permission denied
% <span class=nb>logout</span>
% lprm <span class=nt>-P</span> rattan 13
dfA013rose dequeued
cfA013rose dequeued</code></pre></div></div></td></tr></tbody></table></div></div><div class=sect3><h4 id=printing-lpr-options>9.5.4. Túl a nyers szövegen: nyomtatási beállítások<a class=anchor href=#printing-lpr-options></a></h4><div class=paragraph><p>Az <a href="https://man.freebsd.org/cgi/man.cgi?query=lpr&amp;sektion=1&amp;format=html">lpr(1)</a> parancs számos olyan beállítást enged, amelyekkel a szövegek formázását, grafikák átalakítását illetve más állományformátumok használatát, másolatok készítését, nyomtatási feladatok irányítását és még sok minden mást el tudunk végezni. Ebben a szakaszban pontosan ezekrõl a kapcsolókról lesz szó.</p></div><div class=sect4><h5 id=printing-lpr-options-format>9.5.4.1. Formázási és konverziós beállítások<a class=anchor href=#printing-lpr-options-format></a></h5><div class=paragraph><p>Az <a href="https://man.freebsd.org/cgi/man.cgi?query=lpr&amp;sektion=1&amp;format=html">lpr(1)</a> most következõ opciói a nyomtatási feladatokban található állományok formázását vezérlik. Akkor használjuk ezeket a beállításokat, ha a nyomtatási feladat nem tartalmaz nyers szöveget, vagy ha nyers szöveget akarunk formázni a <a href="https://man.freebsd.org/cgi/man.cgi?query=pr&amp;sektion=1&amp;format=html">pr(1)</a> segédprogrammal.</p></div><div class=paragraph><p>Például az alábbi parancs kinyomtat egy <span class=filename>halászati-jelentés.dvi</span> nevû (a TeX betûszedû rendszerbõl már jól ismert) DVI állományt a <code>bamboo</code> nevû nyomtatón:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>% lpr <span class=nt>-P</span> bamboo <span class=nt>-d</span> halászati-jelentés.dvi</code></pre></div></div><div class=paragraph><p>Ezek a beállítások a nyomtatási feladatban szereplõ minden egyes állományra vonatkoznak, ezért nem keverhetjük (például) a DVI és ditroff formátumú állományokat egy nyomtatási feladaton belül. Ehelyett külön nyomtatási feladatokban kell elküldenünk az eltérõ formátumú állományokat, és mindegyik nyomtatási feladathoz külön konverziós beállításokat kell megadnunk.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>A <code>-p</code> és <code>-T</code> kapcsolók kivételével az itt felsorolt összes beállításnak a kiválasztott nyomtatóhoz szüksége van a megfelelõ konverziós szûrõre. Például a <code>-d</code> opció használatához kell egy konverziós szûrõ a DVI formátumhoz. A <a href=#printing-advanced-convfilters>Konverziós szûrõk</a> címû szakasz errõl ad bõvebb tájékoztatást.</p></div></td></tr></tbody></table></div><div class=dlist><dl><dt class=hdlist1><code>-c</code></dt><dd><p>Cifplot állományok nyomtatása.</p></dd><dt class=hdlist1><code>-d</code></dt><dd><p>DVI állományok nyomtatása.</p></dd><dt class=hdlist1><code>-f</code></dt><dd><p>FORTRAN forrás nyomtatása.</p></dd><dt class=hdlist1><code>-g</code></dt><dd><p>Plot formátumú adatok nyomtatása.</p></dd><dt class=hdlist1><code>-i <em>szám</em></code></dt><dd><p>A kinyomtatott szöveg behúzásának növelése a <em>szám</em> értékével. Ha nem adjuk meg a <em>számot</em>, akkor ennek értéke 8 lesz. Ez a beállítás csak bizonyos konverziós szûrõkkel mûködik.</p><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Ne hagyjunk helyet az <code>-i</code> és a szám között.</p></div></td></tr></tbody></table></div></dd><dt class=hdlist1><code>-l</code></dt><dd><p>A szöveg formázás nélküli nyomtatása, vezérlõkarakterekkel együtt.</p></dd><dt class=hdlist1><code>-n</code></dt><dd><p>Ditroff (eszközfüggetlen troff) adat nyomtatása.</p></dd><dt class=hdlist1>-p</dt><dd><p>Nyomtatás elõtt a szöveg formázása a <a href="https://man.freebsd.org/cgi/man.cgi?query=pr&amp;sektion=1&amp;format=html">pr(1)</a> programmal. Lásd <a href="https://man.freebsd.org/cgi/man.cgi?query=pr&amp;sektion=1&amp;format=html">pr(1)</a>.</p></dd><dt class=hdlist1><code>-T <em>cím</em></code></dt><dd><p>Az állomány neve helyett a fejlécben a <em>címet</em> jeleníti meg a <a href="https://man.freebsd.org/cgi/man.cgi?query=pr&amp;sektion=1&amp;format=html">pr(1)</a>. Ennek a beállításnak csak a <code>-p</code> opcióval együtt van hatása.</p></dd><dt class=hdlist1><code>-t</code></dt><dd><p>Troff adat nyomtatása.</p></dd><dt class=hdlist1><code>-v</code></dt><dd><p>Raszteres adatok nyomtatása.</p></dd></dl></div><div class=paragraph><p>Vegyünk az iméntiekre egy példát. A következõ parancs az <a href="https://man.freebsd.org/cgi/man.cgi?query=ls&amp;sektion=1&amp;format=html">ls(1)</a> szépen megformázott man oldalát nyomtatja ki az alapértelmezett nyomtatón:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>% zcat /usr/shared/man/man1/ls.1.gz | troff <span class=nt>-t</span> <span class=nt>-man</span> | lpr <span class=nt>-t</span></code></pre></div></div><div class=paragraph><p>A <a href="https://man.freebsd.org/cgi/man.cgi?query=zcat&amp;sektion=1&amp;format=html">zcat(1)</a> kitömöríti az <a href="https://man.freebsd.org/cgi/man.cgi?query=ls&amp;sektion=1&amp;format=html">ls(1)</a> man oldalának forrását és átadja a <a href="https://man.freebsd.org/cgi/man.cgi?query=troff&amp;sektion=1&amp;format=html">troff(1)</a> parancsnak, ami ebbõl létrehoz a GNU troff formátumának megfelelõ kimenetet és továbbadja az <a href="https://man.freebsd.org/cgi/man.cgi?query=lpr&amp;sektion=1&amp;format=html">lpr(1)</a> parancsnak, ami végül elküldi a nyomtatási feladatot az LPD nyomtatási rendszernek. Mivel az <a href="https://man.freebsd.org/cgi/man.cgi?query=lpr&amp;sektion=1&amp;format=html">lpr(1)</a> parancsnak megadtuk az <code>-t</code> kapcsolót, a nyomtatási rendszer a GNU troff formátumban érkezõ adatokat magától át fogja alakítani olyan formátumra, amit a nyomtató is képes lesz megérteni.</p></div></div><div class=sect4><h5 id=printing-lpr-options-job-handling>9.5.4.2. Nyomtatási feladatok kezelése<a class=anchor href=#printing-lpr-options-job-handling></a></h5><div class=paragraph><p>Az <a href="https://man.freebsd.org/cgi/man.cgi?query=lpr&amp;sektion=1&amp;format=html">lpr(1)</a> most felsorolandó beállításaival az LPD rendszert arra tudjuk utasítani, hogy a nyomtatási feladatot különleges módon kezelje:</p></div><div class=dlist><dl><dt class=hdlist1>-# <em>példányszám</em></dt><dd><p>Egyetlen példány helyett hozzon létre <em>példányszám</em> számú példányt a nyomtatási feladatban található összes állományból. A rendszergazda a nyomtató kímélése érdekében ezt a lehetõséget letilthatja, amivel inkább a fénymásoló használatára ösztönzi a felhasználókat. Lásd <a href=#printing-advanced-restricting-copies>A másolatok számának szabályozása</a> szakasz.</p><div class=paragraph><p>A beállítás illusztrálásaként most az alapértelmezett nyomtatón elõször nyomtassunk ki három példányt a <span class=filename>parser.c</span>, majd ezután a <span class=filename>parser.h</span> állományokból:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>% lpr -#3 parser.c parser.h</code></pre></div></div></dd><dt class=hdlist1>-m</dt><dd><p>A rendszer küldjön levelet a nyomtatási feladat teljesítése után. Ekkor az LPD a nyomtatási feladat elvégzése után levelet küld a helyi postafiókunkba. A levélben kifejti, hogy sikeres volt-e a nyomtatás, vagy esetleg valamilyen hiba keletkezett, és ha hiba történt, akkor pontosan mi is volt az.</p></dd><dt class=hdlist1>-s</dt><dd><p>Ne másolja közvetlenül az állományokat a nyomtatási könyvtárba, hanem készítsen hozzájuk szimbolikus linkeket.</p><div class=paragraph><p>Egy nagyobb nyomtatási feladat elvégzése esetén javasolt használni ezt a kapcsolót. Ezzel a megoldással helyet tudunk spórolni a nyomtatási könyvtárban (amikor a nyomtatási feladatok könnyen megtelítheti a nyomtatási könyvtárat tároló állományrendszert). Emellett idõt is takarítunk meg, mivel az LPD-nek nem kell a nyomtatási feladat minden egyes bitjét átmásolni a nyomtatási könyvtárba.</p></div><div class=paragraph><p>Van azonban egy hátránya: mivel az LPD ekkor közvetlenül az eredeti állományra fog hivatkozni, ezért a nyomtatás befejezéséig azt nem módosíthatjuk vagy törölhetjük.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Ha egy távoli nyomtatónak küldjük a nyomtatási feladatot, akkor az LPD a helyi és a távoli számítógép között mégis kénytelen lesz átmásolni a nyomtatási feladatot, így a <code>-s</code> kapcsoló egyedül csak a helyi nyomtatási könyvtárban fog helyet spórolni. Ettõl eltekintve még ilyenkor is hasznunkra válhat.</p></div></td></tr></tbody></table></div></dd><dt class=hdlist1>-r</dt><dd><p>Törölje a nyomtatási feladatban szereplõ állományokat, miután átmásolta ezeket a nyomtatási könyvtárba, vagy miután a <code>-s</code> kapcsoló használatával kinyomtatta ezeket. Nagy körültekintéssel használjuk!</p></dd></dl></div></div><div class=sect4><h5 id=printing-lpr-options-misc>9.5.4.3. A fejléclapok beállításai<a class=anchor href=#printing-lpr-options-misc></a></h5><div class=paragraph><p>Az <a href="https://man.freebsd.org/cgi/man.cgi?query=lpr&amp;sektion=1&amp;format=html">lpr(1)</a> most következõ beállításai a nyomtatási feladatok fejlécében megjelenõ szövegekre vannak hatással. Így ha letiltottuk a fejléclapok használatát, akkor ezek a kapcsolók lényegében semmit sem állítanak. A <a href=#printing-advanced-header-pages>Fejléclapok</a> címû szakaszból tudhatunk meg többet ezek beállításáról.</p></div><div class=dlist><dl><dt class=hdlist1>-C <em>szöveg</em></dt><dd><p>A fejléclapon megjelenõ hálózati név helyett a <em>szöveg</em> fog szerepelni. A hálózati név általában annak a gépnek a neve, ahonnan a nyomtatási feladatot küldték.</p></dd><dt class=hdlist1>-J <em>szöveg</em></dt><dd><p>A fejléclapon megjelenõ nyomtatási feladat neve helyett a <em>szöveg</em> fog megjelenni. A nyomtatási feladat neve általában a benne szereplõ elsõ állomány nevével egyezik meg, ha a szabványos bemenetrõl nyomtatunk, akkor egyszerûen csak <span class=filename>stdin</span>.</p></dd><dt class=hdlist1>-h</dt><dd><p>Ne nyomtasson fejléclapot.</p><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Bizonyos helyeken elõfordulhat, hogy ennek a kapcsolónak nincs semmilyen hatása a fejléclapok létrehozásának módszerébõl fakadóan. A részleteket lásd a <a href=#printing-advanced-header-pages>Fejléclapok</a> szakaszban.</p></div></td></tr></tbody></table></div></dd></dl></div></div></div><div class=sect3><h4 id=printing-lpc>9.5.5. A nyomtatók vezérlése<a class=anchor href=#printing-lpc></a></h4><div class=paragraph><p>A nyomtatóink rendszergazdájaként nekünk kell telepítenük, üzembe helyeznünk és kipróbálnunk ezeket. Az <a href="https://man.freebsd.org/cgi/man.cgi?query=lpc&amp;sektion=8&amp;format=html">lpc(8)</a> parancs használatával még jobban képesek vagyunk kapcsolatba lépni velük. Az <a href="https://man.freebsd.org/cgi/man.cgi?query=lpc&amp;sektion=8&amp;format=html">lpc(8)</a> paranccsal:</p></div><div class=ulist><ul><li><p>el tudjuk indítani és le tudjuk állítani a nyomtatókat;</p></li><li><p>be- és ki tudjuk kapcsolni a nyomtatási soraikat;</p></li><li><p>át tudjuk rendezni az egyes sorokban található nyomtatási feladatokat.</p></li></ul></div><div class=paragraph><p>Elõször is essen pár szó a fogalmakról: ha a nyomtató <em>leállt</em>, akkor semmit sem fog kinyomtatni a sorából. A felhasználók továbbra is képesek nyomtatási feladatokat küldeni, amik azonban egészen addig fognak várakozni, amíg a nyomtatót <em>el nem indítjuk</em> vagy a sorát ki nem ürítjük.</p></div><div class=paragraph><p>Ha egy sort <em>kikapcsolunk</em>, akkor (a <code>root</code> kivételével) egyetlen felhasználó sem képes nyomtatási feladatokat küldeni a nyomtatónak. A <em>bekapcsolt</em> sorok képesek csak nyomtatási feladatot fogadni. A nyomtató <em>elindítható</em> kikapcsolt sorral is, ilyenkor egészen addig folytatja a nyomtatási feladatok elvégzését, amíg a sor ki nem ürül.</p></div><div class=paragraph><p>Általánosan elmondható, hogy az <a href="https://man.freebsd.org/cgi/man.cgi?query=lpc&amp;sektion=8&amp;format=html">lpc(8)</a> parancs használatához a <code>root</code> felhasználó jogosultságaira van szükségünk. Az <a href="https://man.freebsd.org/cgi/man.cgi?query=lpc&amp;sektion=8&amp;format=html">lpc(8)</a> parancsot minden más esetben csak a nyomtató állapotának ellenõrzésére vagy a megakadt nyomtató újraindítására használhatjuk.</p></div><div class=paragraph><p>Foglaljuk röviden össze az <a href="https://man.freebsd.org/cgi/man.cgi?query=lpc&amp;sektion=8&amp;format=html">lpc(8)</a> parancsait. A legtöbb parancs kiadásához még szükséges egy <em>nyomtatónév</em> paraméter megadása is, amivel megnevezzük az utasítani kívánt nyomtatót. Helyette használható az <code>all</code> szó is, amivel az <span class=filename>/etc/printcap</span> állományban szereplõ összes nyomtatót egyszerre utasíthatjuk.</p></div><div class=dlist><dl><dt class=hdlist1><code>abort nyomtatónév</code></dt><dd><p>Az aktuális nyomtatási feladat megszakítása és a nyomtató leállítása. Ha a nyomtatási sort még nem kapcsoltuk ki, a felhasználók küldhetnek további nyomtatási feladatokat.</p></dd><dt class=hdlist1><code>clean nyomtatónév</code></dt><dd><p>A nyomtató könyvtárából töröljük a régi állományokat. Esetenként adódhat, hogy bizonyos nyomtatási feladatok állományait nem takarította el az LPD, különösen abban az esetben, amikor a nyomtatás vagy az adminisztrálás során keletkezett valamilyen hiba. Ez a parancs segít megtalálni a nyomtatási könyvtárból már kikopott állományokat és törli ezeket.</p></dd><dt class=hdlist1><code>disable nyomtatónév</code></dt><dd><p>Az újonnan érkezõ nyomtatási feladatok besorolásának kikapcsolása. Ha a nyomtató még mûködik, akkor folytatni fogja a sorban még bennmaradt nyomtatási feladatok elvégzését. A rendszergazda (a <code>root</code>) még a kikapcsolt sorok esetén is küldhet nyomtatási feladatokat.</p><div class=paragraph><p>Ez a parancs valójában akkor hasznos, ha egy új nyomtató vagy egy új szûrõ mûködését próbálgatjuk: ilyenkor érdemes kikapcsolni a nyomtatási sort és <code>root</code> felhasználóként nyomtatási feladatokat küldeni. A többi felhasználó a tesztelés befejezéséig nem tud majd nyomtatási feladatokat küldeni, vagyis egészen addig, amíg a nyomtatási sort vissza nem kapcsoljuk az <code>enable</code> paranccsal.</p></div></dd><dt class=hdlist1><code>down nyomtatónév üzenet</code></dt><dd><p>A nyomtató üzemen kívül helyezése. Lényegében megegyezik egy <code>disable</code> és utána egy <code>stop</code> parancs kiadásával. Az <em>üzenet</em> akkor jelenik meg, amikor a valaki megpróbálja lekérdezni a nyomtató állapotát az <code>lpc status</code> paranccsal, vagy amikor megnézi a nyomtatási sorát az <a href="https://man.freebsd.org/cgi/man.cgi?query=lpq&amp;sektion=1&amp;format=html">lpq(1)</a> paranccsal.</p></dd><dt class=hdlist1><code>enable nyomtatónév</code></dt><dd><p>A nyomtatóhoz tartozó nyomtatási sor bekapcsolása. A felhasználók ezután már képesek lesznek a nyomtatónak feladatokat küldeni, azonban egészen addig nem nyomtatódik ki semmi, amíg a nyomtatót el nem indítjuk.</p></dd><dt class=hdlist1><code>help parancsnév</code></dt><dd><p>Megmutatja a <em>parancsnév</em> parancshoz tartozó súgót. A <em>parancsnév</em> megadása nélkül a rendelkezésre álló parancsok listáját kapjuk meg.</p></dd><dt class=hdlist1><code>restart nyomtatónév</code></dt><dd><p>Elindítja a nyomtatót. A felhasználók ezt a parancsot tudják használni abban az esetben, amikor valamilyen megmagyarázhatatlan okból az LPD mûködése megáll, viszont ezzel nem tudják elindítani a <code>stop</code> vagy <code>down</code> parancsokkal leállított nyomtatót. A <code>restart</code> parancs megegyezik az <code>abort</code> és a <code>start</code> egymás utáni kiadásával.</p></dd><dt class=hdlist1><code>start nyomtatónév</code></dt><dd><p>Elindítja a nyomtatót, és a nyomtató nekilát kinyomtatni a sorában levõ nyomtatási feladatokat.</p></dd><dt class=hdlist1><code>stop nyomtatónév</code></dt><dd><p>Leállítja a nyomtatót, és a nyomtató az aktuális nyomtatási feladat befejezése után már nem kezd neki újabbnak. Ettõl függetlenül a felhasználók még továbbra is képesek feladatokat küldeni a nyomtatási sorába.</p></dd><dt class=hdlist1><code>topq nyomtatónév feladat-vagy-felhasználónév</code></dt><dd><p>Átrendezi a <em>nyomtatónév</em> nevû nyomtató sorát úgy, hogy a megadott azonosítójú <em>feladatot</em> vagy a megadott <em>felhasználónévhez</em> tartozó nyomtatási feladatokat a sor elejére teszi. Ennél a parancsnál <em>nyomtatónévnek</em> nem adhatjuk meg az <code>all</code> értéket.</p></dd><dt class=hdlist1><code>up nyomtatónév</code></dt><dd><p>Üzembe helyezi a nyomtatót, tulajdonképpen a <code>down</code> parancs ellentéte. Megegyezik egy egymás után kiadott <code>start</code> és <code>enable</code> paranccsal.</p></dd></dl></div><div class=paragraph><p>Az <a href="https://man.freebsd.org/cgi/man.cgi?query=lpc&amp;sektion=8&amp;format=html">lpc(8)</a> a fenti parancsokat a parancssorból fogadja el. Ha itt nem adunk meg neki semmilyen parancsot, akkor az <a href="https://man.freebsd.org/cgi/man.cgi?query=lpc&amp;sektion=8&amp;format=html">lpc(8)</a> interaktív módba vált, ahol ugyanezeket a parancsokat adhatjuk ki, egészen az <code>exit</code>, <code>quit</code> parancsok vagy az állományvége jelzés begépeléséig.</p></div></div></div><div class=sect2><h3 id=printing-lpd-alternatives>9.6. Más nyomtatási rendszerek<a class=anchor href=#printing-lpd-alternatives></a></h3><div class=paragraph><p>Ha derekasan végigolvastuk eddig ezt a fejezetet, akkor mostanra már valószínûleg mindent tudunk a FreeBSD-ben található LPD nyomtatási rendszerrõl. Ezzel együtt tisztában vagyunk a hiányosságaival is, aminek kapcsán természetes módon felmerülhet bennünk a kérdés: "Milyen más (FreeBSD-vel is mûködni képes) nyomtatási rendszerek léteznek még?"</p></div><div class=dlist><dl><dt class=hdlist1>LPRng</dt><dd><p>Az LPRng, aminek jelentése "LPR Next Generation" (Az LPR következõ generációja), a PLP teljesen újraírt változata. Patrick Powell és Justin Mason (a PLP eredeti karbantartója) együttes munkájának gyümölcse az LPRng. Az LPRng honlapja: <a href=http://www.lprng.org/>http://www.lprng.org/</a>.</p></dd><dt class=hdlist1>CUPS</dt><dd><p>A CUPS, vagy más néven a "Common UNIX Printing System" (Közös UNIX®-os nyomtatási rendszer), egy hordozható nyomtatási réteget nyújt a UNIX®-alapú operációs rendszerek számára. Az Easy Software Products fejlesztése és szinte az összes UNIX® gyártó és felhasználó szemében elfogadott szabványos nyomtatási rendszer.</p><div class=paragraph><p>A CUPS a nyomtatási feladatok és sorok kezelését az internetes nyomtatási protokollon (Internet Printing Protocol, IPP) használatával oldja meg. Csökkentett képességekkel ugyan, de a sornyomtató démon (Line Printer Daemon, LPD), szerverüzenet-blokk (Server Message Block, SMB), és AppSocket (más néven JetDirect) protokollokat is ismeri. A CUPS a komolyabb UNIX®-os nyomtatási feladatokhoz ezeken felül még a hálózati nyomtatók közti választást és PostScript nyomtatók leírásán (PostScript Printer Description, PPD) alapuló nyomtatási beállításokat is támogatja.</p></div><div class=paragraph><p>A CUPS honlapja: <a href=http://www.cups.org/>http://www.cups.org/</a>.</p></div></dd><dt class=hdlist1>HPLIP</dt><dd><p>A HPLIP, másnéven HP Linux® Imaging and Printing, egy HP által kidolgozott programcsalád, amely támogatja a HP eszközök nyomtatási, lapolvasási és faxolási lehetõségeit. A benne található programok bizonyos nyomtatási feladatokhoz backendként a CUPS nyomtatási rendszert használják.</p><div class=paragraph><p>A HPLIP honlapja a <a href=http://hplipopensource.com/hplip-web/index.html>http://hplipopensource.com/hplip-web/index.html</a> címen érhetõ el.</p></div></dd></dl></div></div><div class=sect2><h3 id=printing-troubleshooting>9.7. Hibakeresés<a class=anchor href=#printing-troubleshooting></a></h3><div class=paragraph><p>Miután az <a href="https://man.freebsd.org/cgi/man.cgi?query=lptest&amp;sektion=1&amp;format=html">lptest(1)</a> programmal elvégeztünk néhány egyszerû próbát, a várt helyett a következõk egyikét kaphatjuk eredményül:</p></div><div class=dlist><dl><dt class=hdlist1>Egy kis idõ után minden remekül mûködött, vagy nem dobta ki az egész lapot.</dt><dd><p>A nyomtató nyomtatott egy keveset, aztán egy ideig csendben maradt és nem csinált semmit. Ilyenkor a nyomtatnivalók megjelenéséhez minden bizonnyal meg kell nyomnunk a nyomtatón levõ "PRINT REMAINING" vagy "FORM FEED" feliratú gombokat.</p><div class=paragraph><p>Ebben az esetben a nyomtató valószínûleg még arra várt, hogy még a nyomtatás megkezdése elõtt érkezik valamilyen további adat. Ettõl a gondtól úgy szabadulhatunk meg, ha beállítunk egy szövegszûrõt, amely minden (szükséges) esetben küld egy "FORM FEED" (lapdobás) jelzést is a nyomtatónak. Ez kell általában ahhoz, hogy a szövegnek a nyomtató belsõ pufferében megmaradt része azonnal kinyomtatódjon. Akkor is a javunkra válhat ez, ha minden egyes nyomtatási feladatot külön lapon akarunk kezdeni, mivel így a következõ nyomtatási feladat sosem közvetlenül ott kezdõdik, ahol az elõzõ feladat befejezte a nyomtatást.</p></div><div class=paragraph><p>A <span class=filename>/usr/local/libexec/if-simple</span> szûrõ helyett a következõ szkript használhatával tudunk minden nyomtatási feladat elvégzése után elküldeni egy lapdobást:</p></div><div class="literalblock programlisting"><div class=content><pre>#!/bin/sh
#
# if-simple - Egyszerû lpd szövegszûrõ
# Helye: /usr/local/libexec/if-simple
#
# Egyszerûen átmásolja a szabvány bemenetet a szabvány kimenetre, és
# figyelmen kívül hagyja az összes többi paramétert.  Minden nyomtatási
# nyomtatási feladat elvégzése után küld egy lapdobást (\f).

/bin/cat &amp;&amp; printf &#34;\f&#34; &amp;&amp; exit 0
exit 2</pre></div></div></dd><dt class=hdlist1>"Lépcsõsen" jelentek meg a sorok.</dt><dd><p>Ekkor a következõt látjuk a lapon:</p><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=o>!</span><span class=s2>&#34;#</span><span class=nv>$%</span><span class=s2>&amp;&#39;()*+,-./01234
                &#34;</span><span class=c>#$%&amp;&#39;()*+,-./012345</span>
                                 <span class=c>#$%&amp;&#39;()*+,-./0123456</span></code></pre></div></div><div class=paragraph><p>Az ún. <em>lépcsõhatás</em> áldozatává váltunk, amelyet a sortörést jelzõ karakter eltérõ értelmezései okoznak. A UNIX® stílusú operációs rendszerek erre mindössze egyetlen karaktert használnak: ez a 10-es kódú ASCII karakter (sordobás, Line Feed, LF). Az MS-DOS®, OS/2® és mások pedig két karakterrel oldják meg ezt a feladatot: a 10-es <em>és</em> 13-as kódú (kocsivissza, Carriage Return, CR) ASCII karakterekkel. A sortöréseknél sok nyomtató az MS-DOS® szokásait követi.</p></div><div class=paragraph><p>Amikor a FreeBSD-vel nyomtatunk, akkor csak egyetlen karaktert használunk sortörésre. Ennek láttán a nyomtató lépteti a sort, azonban a fej vízszintes pozícióját nem változtatja meg a következõ sor nyomtatásának megkezdésekor. Erre lenne a kocsivissza karakter, vagyis ennek hatására fogja a nyomtató a papír bal oldalára visszaállítani a következõ nyomtatandó karakter pozícióját.</p></div><div class=paragraph><p>A FreeBSD így szeretné utasítani a nyomtatót:</p></div><table class="tableblock frame-none grid-all stretch informaltable"><col style=width:50%><col style=width:50%><tbody><tr><td class="tableblock halign-left valign-top"><p class=tableblock>A nyomtató kocsivisszát kap</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>A nyomtató visszalépteti a pozíciót</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>A nyomtató sordobást kap</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>A nyomtató új sort kezd</p></td></tr></tbody></table><div class=paragraph><p>Néhány módszer ennek kiváltására:</p></div><div class=ulist><ul><li><p>A nyomtatón található kapcsolók vagy vezérlõpanel segítségével próbáljuk meg átállítani a vezérlõkarakterek nyomtató szerinti értelmezését. Keressük meg a nyomtató kézikönyvében, hogyan tudjuk ezt megcsinálni.</p><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Ha a FreeBSD mellett más operációs rendszerekkel is használni akarjuk a nyomtatót, akkor azok indítása elõtt mindig <em>át kell állítani</em> a nyomtatót a megfelelõ értelmezés alkalmazására. Ilyenkor valószínûleg a lentebb szereplõ megoldásokat részesítjük majd inkább elõnyben.</p></div></td></tr></tbody></table></div></li><li><p>Állítsuk be úgy a FreeBSD soros vonali meghajtóját, hogy magától alakítsa át az LF karaktereket CR+LF párokká. Természetesen ez a megoldás <em>csak</em> a soros portra csatlakozó nyomtatók esetében mûködhet. Ehhez az <span class=filename>/etc/printcap</span> állományban a nyomtató leírásánál az <code>ms#</code> tulajdonságnál adjuk meg az <code>onlcr</code> módot.</p></li><li><p>Küldjünk olyan <em>kódot</em> a nyomtatónak, amelynek hatására ideiglenesen máshogy fogja kezelni az LF karaktereket. Nézzük meg a nyomtatóhoz mellékelt útmutatóban, hogy milyen kódokat tudunk ilyen célra használni. Ha találtunk ilyen kódot, akkor írjuk át úgy a hozzá tartozó szövegszûrõt, hogy a nyomtatási feladatok elõtt mindig elküldjük azt.</p><div class=paragraph><p>Most bemutatjuk egy olyan szövegszûrõ kódját, amely a Hewlett-Packard PCL kódjait ismerõ nyomtatókhoz készült. Ebben a szûrõben elõször kiadjuk, hogy az LF karaktereket LF és CR karakterek kombinációjának tekintse a nyomtató, majd elküldjük magát a nyomtatási feladatot, és a nyomtatási feladat eredményének utolsó lapja után elküldünk egy lapdobást. Szinte az összes Hewlett Packard nyomtatóval mûködnie kell.</p></div><div class="literalblock programlisting"><div class=content><pre>#!/bin/sh
#
# hpif - Egyszerû lpd bemeneti szûrõ a HP-PCL alapú nyomtatókhoz
# Helye: /usr/local/libexec/hpif
#
# Egyszerûen átmásolja a szabvány kimenetet a szabvány bemenetre, és
# figyelmen kívül hagyja a paramétereket. Elküldi a nyomtatónak, hogy
# az LF karaktereket CR+LF-ként kezelje, majd a feladat befejeztével
# lapot dobat.

printf &#34;\033&amp;k2G&#34; &amp;&amp; cat &amp;&amp; printf &#34;\033&amp;l0H&#34; &amp;&amp; exit 0
exit 2</pre></div></div><div class=paragraph><p>Példaként megadjuk még az <code>orchid</code> nevû számítógép <span class=filename>/etc/printcap</span> állományát is. Ebben egyetlen nyomtató csatlakozik a párhuzamos portra, amelynek a típusa LaserJet 3Si és a neve <code>teak</code>. Az elõbb bemutatott szövegszûrõt használja:</p></div><div class="literalblock programlisting"><div class=content><pre>#
#  /etc/printcap (orchid)
#
teak|hp|laserjet|Hewlett Packard LaserJet 3Si:\
        :lp=/dev/lpt0:sh:sd=/var/spool/lpd/teak:mx#0:\
        :if=/usr/local/libexec/hpif:</pre></div></div></li></ul></div></dd><dt class=hdlist1>Egymásra írja a sorokat.</dt><dd><p>A nyomtató nem lépteti a sorokat, ezért az összes sor egymáson jelenik meg.</p><div class=paragraph><p>Ez pontosan a ritka "ellentéte" a fentebb leírt lépcsõhatásnak. A FreeBSD által sortörésre használt LF karakterek valamiért CR karakterekként viselkednek, ezért a nyomtató nem sort vált, hanem a lap bal szélére állítja a fejet.</p></div><div class=paragraph><p>A nyomtatón található kapcsolókkal vagy vezérlõpanellel így állítsuk be a sordobás és kocsivissza karakterek értelmezését:</p></div><table class="tableblock frame-none grid-all stretch informaltable"><col style=width:50%><col style=width:50%><thead><tr><th class="tableblock halign-left valign-top">Amit a nyomtató kap</th><th class="tableblock halign-left valign-top">Arra a nyomtató nyomtat</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class=tableblock>CR</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>CR</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>LF</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>CR + LF</p></td></tr></tbody></table></dd><dt class=hdlist1>A nyomtató elhagy karaktereket.</dt><dd><p>Miközben nyomtatunk, a nyomtató bizonyos karaktereket nem hajlandó megjeleníteni. A probléma ennél nagyobb, ha a nyomtató mûködése közben egyre több és több karaktert hagy ki.</p><div class=paragraph><p>Itt az a gond, hogy a nyomtató nem képes tartani az iramot a számítógép által a soros vonalon átküldött adatok sebességével (ez a probléma nem jelentkezhet a párhuzamos nyomtatók esetén). Két módon kerekedhetünk felül ezen:</p></div><div class=ulist><ul><li><p>Ha a nyomtató ismeri a XON/XOFF típusú forgalomirányítást, akkor az <code>ms#</code> tulajdonságnál adjuk meg a FreeBSD számára az <code>ixon</code> beállítást.</p></li><li><p>Ha a nyomtató ismeri a "Request to Send / Clear to Send" alapú hardveres kézfogást (más néven <code>RTS/CTS</code> forgalomirányítást), akkor az <code>ms#</code> tulajdonságnál a <code>crtscts</code> beállítást adjuk meg. Gondoskodjunk róla, hogy a számítógépet és a nyomtatót összekötõ kábel meg tudjon majd birkózni ezzel a típusú forgalomirányítással.</p></li></ul></div></dd><dt class=hdlist1>Mindenféle szemetet nyomtat.</dt><dd><p>A nyomtató nem a nyomtatni kívánt szöveget hozza létre, hanem összevissza nyomtat.</p><div class=paragraph><p>Ez a soros nyomtatók helytelen kommunikációs beállításának egy másik jellemzõ tünete. Ellenõrizzük a <code>br</code> tulajdonságnál megadott adatátviteli sebességet és az <code>ms#</code> tulajdonságnál megadott paritási beállításokat. Egyeztessük a nyomtató saját és az <span class=filename>/etc/printcap</span> állományban tárolt beállításait.</p></div></dd><dt class=hdlist1>Semmi sem történik.</dt><dd><p>Ha semmi sem történt, akkor a gond magával a FreeBSD-vel lehet, nem pedig a hardverrel. Az <span class=filename>/etc/printcap</span> állományba a vizsgálni kívánt nyomtató leírásához (az <code>lf</code> tulajdonsággal) illesszünk be naplózást. Például így fog kinézni a <code>rattan</code> nevû nyomtató bejegyzése az <code>lf</code> tulajdonság megadásával kibõvítve:</p><div class="literalblock programlisting"><div class=content><pre>rattan|line|diablo|lp|Diablo 630 Line Printer:\
        :sh:sd=/var/spool/lpd/rattan:\
        :lp=/dev/lpt0:\
        :if=/usr/local/libexec/if-simple:\
        :lf=/var/log/rattan.log</pre></div></div><div class=paragraph><p>Miután ezt megcsináltuk, próbálkozzunk újra. Nézzük meg a naplóállományban (ami a példánkban a <span class=filename>/var/log/rattan.log</span> nevén érhetõ el), hogy látunk-e valamilyen hibaüzenetet. Az itt tapasztalt hibaüzenetek nyomán elindulva igyekezzünk megszüntetni a probléma forrását.</p></div><div class=paragraph><p>Ha nem adjuk meg az <code>lf</code> tulajdonságot, akkor az LPD erre a célra alapértelmezés szerint a <span class=filename>/dev/console</span> állományt használja.</p></div></dd></dl></div></div></div></div><div class=sect1><h2 id=linuxemu>Chapter 10. Bináris Linux kompatibilitás<a class=anchor href=#linuxemu></a></h2><div class=sectionbody><div class=sect2><h3 id=linuxemu-synopsis>10.1. Áttekintés<a class=anchor href=#linuxemu-synopsis></a></h3><div class=paragraph><p>A FreeBSD számos más UNIX®-szerû operációs rendszerhez nyújt bináris kompatibilitást, köztük a Linuxhoz is. Elcsodálkozhatnánk rajta, hogy vajon miért kell tudnia a FreeBSD-nek Linux binárisokat futtatnia. A válasz erre nagyon egyszerû. Rengeteg cég és fejlesztõ kizárólag csak Linuxra fejleszt, hiszen ez mostanság egy nagyon "izgalmas téma" az informatika világában. Emiatt azonban a FreeBSD közösségnek külön gyõzködnie kell ezeket a cégeket és fejlesztõket, hogy készítsék el a termékeik natív FreeBSD-s változatát. Ezzel az a gond, a legtöbb ilyen cég egyszerûen nem veszi észre, hogy ha létezne a terméküknek FreeBSD-re írt változata, akkor még többen használnák. Így továbbra is csak Linuxra fejlesztenek. Mit tudnak tenni ilyenkor a FreeBSD használói? Nos, ekkor jön jól a FreeBSD bináris szintû kompatibilitása.</p></div><div class=paragraph><p>Dióhéjban úgy tudnánk összefoglalni, hogy ennek köszönhetõen a FreeBSD felhasználók képesek a linuxos alkalmazások közel 90%-át mindenféle további módosítás nélkül futtatni. Így tehát használható a StarOffice™, <a href="https://man.freebsd.org/cgi/man.cgi?query=getenv&amp;sektion=3&amp;format=html">getenv(3)</a> Linux változata, az Adobe® Acrobat®, RealPlayer®, VMware, Oracle®, WordPerfect®, Doom, Quake, és még sok minden más. Sõt, egyes tapasztalatok szerint bizonyos helyzetekben a FreeBSD által futtatott Linux binárisok sokkal jobban teljesítenek, mint Linux alatt.</p></div><div class=paragraph><p>Azonban vannak olyan Linuxra jellemzõ, az operációs rendszer szintjén meghúzódó eszközök, amelyek FreeBSD alatt nem használhatóak. FreeBSD-n nem fognak mûködni azok a Linux binárisok, amelyek túlzottan kihasználják az olyan i386™-os rendszerhívásokat, mint például a virtuális 8086 mód.</p></div><div class=paragraph><p>A fejezet elolvasása során megismerjük:</p></div><div class=ulist><ul><li><p>hogyan engedélyezzük rendszerünkön a Linux kompatibilitást;</p></li><li><p>hogyan telepítsünk linuxos osztott könyvtárakat;</p></li><li><p>hogyan telepítsünk linuxos alkalmazásokat a FreeBSD rendszerünkre;</p></li><li><p>a FreeBSD Linux kompatibilitásának implementációs részleteit.</p></li></ul></div><div class=paragraph><p>A fejezet elolvasásához ajánlott:</p></div><div class=ulist><ul><li><p>külsõ szoftverek telepítésének ismerete (<a href=./#ports>Alkalmazások telepítése. csomagok és portok</a>).</p></li></ul></div></div><div class=sect2><h3 id=linuxemu-lbc-install>10.2. Telepítés<a class=anchor href=#linuxemu-lbc-install></a></h3><div class=paragraph><p>A bináris Linux kompatibilitás alapértelmezés szerint nem engedélyezett. Legkönnyebben úgy tudjuk elérhetõvé tenni, ha betöltjük a <code>linux</code> nevû KLD modult ("Kernel LoaDable"). Ehhez <code>root</code> felhasználóként a következõket kell begépelni:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># kldload linux</span></code></pre></div></div><div class=paragraph><p>Ha minden egyes rendszerindítás során engedélyezni szeretnénk a bináris kompatibilitást, akkor tegyük bele az <span class=filename>/etc/rc.conf</span> állományba ezt a sort:</p></div><div class="literalblock programlisting"><div class=content><pre>linux_enable=&#34;YES&#34;</pre></div></div><div class=paragraph><p>A modul betöltõdését a <a href="https://man.freebsd.org/cgi/man.cgi?query=kldstat&amp;sektion=8&amp;format=html">kldstat(8)</a> paranccsal tudjuk ellenõrizni:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>% kldstat
Id Refs Address    Size     Name
 1    2 0xc0100000 16bdb8   kernel
 7    1 0xc24db000 d000     linux.ko</code></pre></div></div><div class=paragraph><p>Ha valamiért nem akarjuk vagy nem éppen nem tudjuk betölteni a modult, akkor a bináris Linux kompatibilitást az <code>options COMPAT_LINUX</code> beállítással be is tudjuk építeni a rendszermagba. Ennek pontos menetét a <a href=./#kernelconfig>A FreeBSD rendszermag testreszabása</a>ben találjuk meg.</p></div><div class=sect3><h4 id=_linuxos_futtatókönyvtárak_telepítése>10.2.1. Linuxos futtatókönyvtárak telepítése<a class=anchor href=#_linuxos_futtatókönyvtárak_telepítése></a></h4><div class=paragraph><p>A linuxos könyvtárakat két módon is felrakhatjuk: egyrészt a <a href=#linuxemu-libs-port>linux_base</a> port telepítésével, másrészt <a href=#linuxemu-libs-manually>manuálisan</a>.</p></div><div class=sect4><h5 id=linuxemu-libs-port>10.2.1.1. A könyvtárak telepítése a linux_base porttal<a class=anchor href=#linuxemu-libs-port></a></h5><div class=paragraph><p>A futtatókönyvtárakat a lehetõ legegyszerûbben a <a class=package href=https://cgit.freebsd.org/ports/tree/emulators/linux_base/>emulators/linux_base</a> porton keresztül tudjuk telepíteni. Teljesen úgy történik, mint a <a href=file://localhost/usr/ports/>Portgyûjtemény</a> akármelyik másik portjának telepítése. Csupán ennyit kell beírnunk:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># cd /usr/ports/emulators/linux_base-f10</span>
<span class=c># make install distclean</span></code></pre></div></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>A FreeBSD 8.0 kiadását megelõzõ változataiban az <a class=package href=https://cgit.freebsd.org/ports/tree/emulators/linux_base-f10/>emulators/linux_base-f10</a> port helyett az <a class=package href=https://cgit.freebsd.org/ports/tree/emulators/linux_base-fc4/>emulators/linux_base-fc4</a> portot használjuk.</p></div></td></tr></tbody></table></div><div class=paragraph><p>A telepítés végeztével kaptunk is egy mûködõ bináris Linux kompatibilitást, habár egyes programok még panaszkodhatnak a rendszerkönyvtárak alverzióit illetõen. Általánosságban véve ez azonban nem okoz nagyobb gondot.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>A <a class=package href=https://cgit.freebsd.org/ports/tree/emulators/linux_base/>emulators/linux_base</a> portnak több változata is használható, melyek az egyes Linux disztribúcióknak feleltethetõek meg. Ilyenkor mindig érdemes közülük azt választani, amelyik a leginkább megfelel a telepíteni kívánt linuxos alkalmazás igényeinek.</p></div></td></tr></tbody></table></div></div><div class=sect4><h5 id=linuxemu-libs-manually>10.2.1.2. A könyvtárak telepítése manuálisan<a class=anchor href=#linuxemu-libs-manually></a></h5><div class=paragraph><p>Ha korábban még nem telepítettük volna a Portgyûjteményt, akkor egyénileg kell felraknunk az egyes könyvtárakat. Közülük azokra lesz szükségünk, amelyeket maga az alkalmazás is használni akar, valamint a futásidejû linkerre. Emellett még a FreeBSD rendszerünkön levõ Linux binárisok számára a <span class=filename>/compat/linux</span> könyvtárban létre kell hoznunk a gyökér ún. "árnyékkönyvtárát" is. A FreeBSD alatt elindított Linux programok elõször ebben a könyvtárban fogják keresni a hozzájuk tartozó osztott könyvtárakat. Így tehát, amikor egy linuxos program betölti például a <span class=filename>/lib/libc.so</span> függvénykönyvtárat, akkor a FreeBSD elõször a <span class=filename>/compat/linux/lib/libc.so</span> állományt próbálja meg megnyitni, majd ha az nem létezik, akkor a <span class=filename>/lib/libc.so</span> állományt. Az osztott könyvtárak ezért a <span class=filename>/compat/linux/lib</span> árnyékkönyvtárba telepítendõek, és nem oda, ahova a linuxos <code>ld.so</code> mutat.</p></div><div class=paragraph><p>Általánosságban szólva eleinte elég csak azokat az osztott könyvtárakat megkeresni és felrakni, amelyekre a telepítendõ linuxos alkalmazásunknak ténylegesen szüksége van. Egy idõ után úgyis összegyûlnek azok a fontosabb függvénykönyvtárak, amelyek segítségével már minden további ráfordítás nélkül futtatni tudjuk a frissen importált programokat.</p></div></div><div class=sect4><h5 id=_hogyan_telepítsünk_újabb_osztott_könyvtárakat>10.2.1.3. Hogyan telepítsünk újabb osztott könyvtárakat?<a class=anchor href=#_hogyan_telepítsünk_újabb_osztott_könyvtárakat></a></h5><div class=paragraph><p>Mit tegyünk, ha az <a class=package href=https://cgit.freebsd.org/ports/tree/emulators/linux_base/>emulators/linux_base</a> port telepítése után az alkalmazás még mindig hiányol néhány osztott könyvtárat? Honnan tudhatjuk meg, hogy milyen osztott könyvtárak kellenek majd egy Linux bináris használatához, és honnan szerezzük be ezeket? Erre alapvetõn két lehetõségünk van (az utasításokat <code>root</code> felhasználóként kell majd végrehajtanunk).</p></div><div class=paragraph><p>Ha hozzáférünk egy Linux rendszerhez, akkor szedjük össze az alkalmazásunk futtatásához szükséges osztott könyvtárakat, és másoljuk ezeket a FreeBSD partíciójára. Például:</p></div><div class=paragraph><p>Tegyük fel, hogy FTP-n keresztül leszedtük a Doom Linux változatát, és felraktuk egy általunk elérhetõ Linux rendszerre. Az <code>ldd linuxdoom</code> parancs segítségével ki tudjuk deríteni, milyen osztott könyvtárak kellenek majd nekünk:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>% ldd linuxdoom
libXt.so.3 <span class=o>(</span>DLL Jump 3.1<span class=o>)</span> <span class=o>=&gt;</span> /usr/X11/lib/libXt.so.3.1.0
libX11.so.3 <span class=o>(</span>DLL Jump 3.1<span class=o>)</span> <span class=o>=&gt;</span> /usr/X11/lib/libX11.so.3.1.0
libc.so.4 <span class=o>(</span>DLL Jump 4.5pl26<span class=o>)</span> <span class=o>=&gt;</span> /lib/libc.so.4.6.29</code></pre></div></div><div class=paragraph><p>Az utolsó oszlopban levõ állományokat másoljuk át, tegyük ezeket a <span class=filename>/compat/linux</span> könyvtárba, és hozzunk létre az elsõ oszlopban szereplõ szimbolikus linkeket. Így tehát a következõ állományok kellenének:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>/compat/linux/usr/X11/lib/libXt.so.3.1.0
/compat/linux/usr/X11/lib/libXt.so.3 -&gt; libXt.so.3.1.0
/compat/linux/usr/X11/lib/libX11.so.3.1.0
/compat/linux/usr/X11/lib/libX11.so.3 -&gt; libX11.so.3.1.0
/compat/linux/lib/libc.so.4.6.29
/compat/linux/lib/libc.so.4 -&gt; libc.so.4.6.29</code></pre></div></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Ha már rendelkezünk az <code>ldd</code> kimenetének elsõ oszlopában szereplõ fõverziószámú osztott könyvtárral, akkor nem kell átmásolni az utolsó oszlopban levõ állományokat, hiszen így is mûködnie kellene mindennek. Ha viszont egy újabb változattal találkozunk, akkor érdemes mégis inkább átmásolni. Miután a szimbolikus linkeket átirányítottuk az új változatra, a régit akár törölhetjük is. Ha például ezek a könyvtárak elérhetõek a rendszerünkön:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>/compat/linux/lib/libc.so.4.6.27
/compat/linux/lib/libc.so.4 -&gt; libc.so.4.6.27</code></pre></div></div><div class=paragraph><p>Észrevesszük, hogy az <code>ldd</code> kimenetében az új bináris egy újabb változatot igényel:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>libc.so.4 <span class=o>(</span>DLL Jump 4.5pl26<span class=o>)</span> -&gt; libc.so.4.6.29</code></pre></div></div><div class=paragraph><p>Ha csak az utolsó jegyében marad le valamivel a verziószám, akkor nem kell különösebben aggódnunk a <span class=filename>/lib/libc.so.4.6.29</span> miatt sem, hiszen a programnak egy picivel korábbi verzióval is remekül kellene tudnia mûködni. Természetesen, ha akarjuk, ettõl függetlenül lecserélhetjük a <span class=filename>libc.so</span> állományt, ami ezt eredményezi:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>/compat/linux/lib/libc.so.4.6.29
/compat/linux/lib/libc.so.4 -&gt; libc.so.4.6.29</code></pre></div></div></td></tr></tbody></table></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>A szimbolikus linkek karbantartása <em>csak</em> a Linux binárisok esetén szükséges. A FreeBSD saját futásidejû linkere magától megkeresi a megfelelõ fõverziószámú könyvtárakat, ezért emiatt általában nem kell aggódni.</p></div></td></tr></tbody></table></div></div></div><div class=sect3><h4 id=_linux_elf_binárisok_telepítése>10.2.2. Linux ELF binárisok telepítése<a class=anchor href=#_linux_elf_binárisok_telepítése></a></h4><div class=paragraph><p>Az ELF binárisok futtatása elõtt néha még szükség van a "megbélyegzés" (branding) használatára is. Ha egy bélyegezetlen ELF binárist akarunk elindítani, akkor a következõ hibaüzenetet kapjuk:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>% ./egy-linux-elf-bináris
ELF binary <span class=nb>type </span>not known
Abort</code></pre></div></div><div class=paragraph><p>A FreeBSD rendszermagjának a <a href="https://man.freebsd.org/cgi/man.cgi?query=brandelf&amp;sektion=1&amp;format=html">brandelf(1)</a> paranccsal tudunk segíteni a FreeBSD és a Linux binárisainak megkülönböztetésében.</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>% brandelf <span class=nt>-t</span> Linux egy-linux-elf-bináris</code></pre></div></div><div class=paragraph><p>A GNU által fejlesztett eszközök manapság már automatikusan elhelyezik az ELF binárisok azonosításához szükséges bélyegeket, ezért ez a lépés a jövõben egyre inkább feleslegessé válik.</p></div></div><div class=sect3><h4 id=_tetszõleges_rpm_formátumú_csomag_telepítése>10.2.3. Tetszõleges RPM formátumú csomag telepítése<a class=anchor href=#_tetszõleges_rpm_formátumú_csomag_telepítése></a></h4><div class=paragraph><p>A FreeBSD a telepített (akár linuxos) alkalmazások nyomonkövetésére saját csomagadatbázissal rendelkezik, amelynek következtében a Linux® által felkínált RPM adatbázisokat nem támogatja.</p></div><div class=paragraph><p>Ennek ellenére akármelyik RPM alapú Linux® alkalmazás telepíthetõ rendszerünkre a következõ módon:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># cd /compat/linux</span>
<span class=c># rpm2cpio -q &lt; /a/linuxos/allomány.helye.rpm | cpio -id</span></code></pre></div></div><div class=paragraph><p>Ezt követõen a <a href="https://man.freebsd.org/cgi/man.cgi?query=brandelf&amp;sektion=1&amp;format=html">brandelf(1)</a> segítségével állítsuk be az ELF binárisokat (könyvtárakat viszont ne!) megfelelõ típusúra. Ekkor ugyan nem leszünk képesek rendesen eltávolítani az így telepített szoftvert, de ez a módszer teszteléshez megfelelõ.</p></div></div><div class=sect3><h4 id=_a_névfeloldó_beállítása>10.2.4. A névfeloldó beállítása<a class=anchor href=#_a_névfeloldó_beállítása></a></h4><div class=paragraph><p>Ha a névfeloldás (DNS) valamiért nem mûködne, vagy egy ehhez hasonló üzenetet kapunk:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>resolv+: <span class=s2>&#34;bind&#34;</span> is an invalid keyword resolv+:
<span class=s2>&#34;hosts&#34;</span> is an invalid keyword</code></pre></div></div><div class=paragraph><p>Akkor a <span class=filename>/compat/linux/etc/host.conf</span> állományba be kell illesztenünk a következõ sorokat:</p></div><div class="literalblock programlisting"><div class=content><pre>order hosts, bind
multi on</pre></div></div><div class=paragraph><p>Az itt megszabott sorrend szerint elõször az <span class=filename>/etc/hosts</span> állományt nézi át, és majd csak ezután próbálja meg feloldani a nevet. Ha a <span class=filename>/compat/linux/etc/host.conf</span> állomány nem létezik, akkor a linuxos alkalmazás a FreeBSD <span class=filename>/etc/host.conf</span> állományát találja meg, és panaszkodni fog a FreeBSD eltérõ formátumára. Távolítsuk el a <code>bind</code> szócskát, ha nem állítottunk be névszervert az <span class=filename>/etc/resolv.conf</span> állományhoz.</p></div></div></div><div class=sect2><h3 id=linuxemu-mathematica>10.3. A Mathematica® telepítése<a class=anchor href=#linuxemu-mathematica></a></h3><div class=paragraph><p>Ebben a szakaszban megismerhetjük, hogyan telepítsük a Mathematica® 5.X Linux változatát FreeBSD rendszerekre.</p></div><div class=paragraph><p>A Mathematica® vagy a Mathematica® for Students linuxos változatai közvetlenül megrendelhetõek a fejlesztõtõl: <a href=http://www.wolfram.com/>http://www.wolfram.com/</a>.</p></div><div class=sect3><h4 id=_a_mathematica_telepítõjének_elindítása>10.3.1. A Mathematica® telepítõjének elindítása<a class=anchor href=#_a_mathematica_telepítõjének_elindítása></a></h4><div class=paragraph><p>Elõször is jeleznünk kell a FreeBSD-nek, hogy a Mathematica® binárisai a linuxos ABI-t (Application Binary Interface) fogják használni. Itt legkönnyebben úgy járhatunk el, ha egyszerûen beállítjuk, hogy a rendszer a bélyegezetlen ELF binárisokat automatikusan Linux binárisoknak tekintse:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># sysctl kern.fallback_elf_brand=3</span></code></pre></div></div><div class=paragraph><p>Ennek köszönhetõen a FreeBSD most már az összes bélyegezetlen ELF bináris esetén a linuxos ABI-t fogja használni, és így a telepítõt akár már közvetlenül a CD-rõl is indíthatjuk.</p></div><div class=paragraph><p>Most másoljuk át a <span class=filename>MathInstaller</span> nevû állományt a merevlemezünkre:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># mount /cdrom</span>
<span class=c># cp /cdrom/Unix/Installers/Linux/MathInstaller helyi_könyvtár</span></code></pre></div></div><div class=paragraph><p>Az állományban cseréljük ki az elsõ sorban található <code>/bin/sh</code> hivatkozást a <code>/compat/linux/bin/sh</code> hivatkozásra. Ezzel biztosíthatjuk, hogy a telepítõt a linuxos <a href="https://man.freebsd.org/cgi/man.cgi?query=sh&amp;sektion=1&amp;format=html">sh(1)</a> fogja elindítani. Ezután a kedvenc szövegszerkesztõnkkel vagy a következõ szakaszban található szkript segítségével helyettesítsük benne a <code>Linux)</code> szöveg összes elõfordulását a <code>FreeBSD)</code> szöveggel. Mivel a Mathematica® telepítõje az <code>uname -s</code> parancsra kapott válaszból állapítja meg az operációs rendszer típusát, ezért ezzel a módosítással a FreeBSD-t is a Linuxhoz hasonló módon fogja kezelni. A <code>MathInstaller</code> elindítása után most már telepíthetõ a Mathematica®.</p></div></div><div class=sect3><h4 id=_a_mathematica_állományainak_módosítása>10.3.2. A Mathematica® állományainak módosítása<a class=anchor href=#_a_mathematica_állományainak_módosítása></a></h4><div class=paragraph><p>A Mathematica® telepítése során létrejött szkripteket a használatuk elõtt át kell írnunk. Amennyiben a Mathematica®hoz tartozó programokat a <span class=filename>/usr/local/bin</span> könyvtárba telepítettük, akkor itt találjuk a <span class=filename>math</span>, <span class=filename>mathematica</span>, <span class=filename>Mathematica</span> és <span class=filename>MathKernel</span> állományokra mutató szimbolikus linkeket. Ezek mindegyikében cseréljük ki a <code>Linux)</code> karakterláncot a <code>FreeBSD)</code> szövegre a kedvenc szövegszerkesztõnkkel vagy az alábbi szkripttel:</p></div><div class="literalblock programlisting"><div class=content><pre>#!/bin/sh
cd /usr/local/bin
for i in math mathematica Mathematica MathKernel
  do sed &#39;s/Linux)/FreeBSD)/g&#39; $i &gt; $i.tmp
  sed &#39;s/\/bin\/sh/\/compat\/linux\/bin\/sh/g&#39; $i.tmp &gt; $i
  rm $i.tmp
  chmod a+x $i
done</pre></div></div></div><div class=sect3><h4 id=_a_mathematica_jelszavának_megszerzése>10.3.3. A Mathematica® jelszavának megszerzése<a class=anchor href=#_a_mathematica_jelszavának_megszerzése></a></h4><div class=paragraph><p>A Mathematica® elsõ indítása során kérni fog egy jelszót. Ha még nem kértünk volna jelszót a fejlesztõtõl, akkor a "számítógépünk azonosítójának" (machine ID) megállapításához indítsuk el a telepítés könyvtárában található <code>mathinfo</code> nevû programot. Ez az azonosító lényegében az elsõdleges Ethernet kártyánk MAC-címe lesz, ezért a Mathematica® nem futtatható több számítógépen.</p></div><div class=paragraph><p>Amikor e-mailen, telefonon vagy faxon keresztül regisztráljuk a terméket a Wolframnál, akkor meg kell adnunk nekik ezt az azonosítót "machine ID" néven, amire õk elküldik a hozzá tartozó jelszót.</p></div></div><div class=sect3><h4 id=_a_mathematica_frontendjének_futtatása_hálózaton_keresztül>10.3.4. A Mathematica® frontendjének futtatása hálózaton keresztül<a class=anchor href=#_a_mathematica_frontendjének_futtatása_hálózaton_keresztül></a></h4><div class=paragraph><p>A Mathematica® a szabványos betûkészletekkel meg nem jeleníthetõ szimbólumokhoz (integráljelek, szummák, görög betûk, matematikai jelölések stb.) használ néhány olyan speciális betûtípust, amelyek nem minden esetben állnak rendelkezésre. Az X által használt protokoll miatt ezeket a betûtípusokat <em>helyben</em> kell telepíteni. Ennek értelmében a Mathematica® CD-jén található betûtípusokat telepítenünk kell a számítógépünkre is. A CD-n ezeket általában a <span class=filename>/cdrom/Unix/Files/SystemFiles/Fonts</span> könyvtárban találjuk meg, vagy a merevlemezen a <span class=filename>/usr/local/mathematica/SystemFiles/Fonts</span> könyvtárban. Ezen belül pedig a <span class=filename>Type1</span> és <span class=filename>X</span> alkönyvtárakra van szükségünk. Az alábbiakban leírtak szerint több módon is használhatjuk ezeket.</p></div><div class=paragraph><p>Az egyik ilyen módszer, ha átmásoljuk az imént említett könyvtárakat a többi mellé, vagyis a <span class=filename>/usr/X11R6/lib/X11/fonts</span> könyvtárba. Ekkor szükségünk lesz még a <span class=filename>fonts.dir</span> állomány átírására is, ahova fel kell vennünk a betûtípusok neveit, majd ennek megfelelõen az elsõ sorban módosítanunk a könyvtárban található betûtípusok számát. De ugyanígy lefuttathatjuk ebben a könyvtárban a <a href="https://man.freebsd.org/cgi/man.cgi?query=mkfontdir&amp;sektion=1&amp;format=html">mkfontdir(1)</a> parancsot is.</p></div><div class=paragraph><p>Az a másik megoldás, ha a könyvtárakat így másoljuk át a <span class=filename>/usr/X11R6/lib/X11/fonts</span> helyre:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># cd /usr/X11R6/lib/X11/fonts</span>
<span class=c># mkdir X</span>
<span class=c># mkdir MathType1</span>
<span class=c># cd /cdrom/Unix/Files/SystemFiles/Fonts</span>
<span class=c># cp X/* /usr/X11R6/lib/X11/fonts/X</span>
<span class=c># cp Type1/* /usr/X11R6/lib/X11/fonts/MathType1</span>
<span class=c># cd /usr/X11R6/lib/X11/fonts/X</span>
<span class=c># mkfontdir</span>
<span class=c># cd ../MathType1</span>
<span class=c># mkfontdir</span></code></pre></div></div><div class=paragraph><p>Most adjuk hozzá az új könyvtárakat a betûtípusok könyvtáraihoz:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># xset fp+ /usr/X11R6/lib/X11/fonts/X</span>
<span class=c># xset fp+ /usr/X11R6/lib/X11/fonts/MathType1</span>
<span class=c># xset fp rehash</span></code></pre></div></div><div class=paragraph><p>Ha az Xorg szervert használjuk, akkor az <span class=filename>xorg.conf</span> állományban megadhatjuk ezen könyvtárak automatikus betöltését is.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Az XFree86™ típusú szerverek esetén az <span class=filename>XF86Config</span> konfigurációs állományt kell módosítanunk.</p></div></td></tr></tbody></table></div><div class=paragraph><p>Ha még <em>nincs</em> <span class=filename>/usr/X11R6/lib/X11/fonts/Type1</span> nevû könyvtárunk, akkor a példában szereplõ <span class=filename>MathType1</span> könyvtárat nyugodtan átnevezhetjük <span class=filename>Type1</span> nevûre.</p></div></div></div><div class=sect2><h3 id=linuxemu-maple>10.4. A Maple™ telepítése<a class=anchor href=#linuxemu-maple></a></h3><div class=paragraph><p>A Maple™ egy Mathematica®hoz hasonló kereskedelmi alkalmazás. A használatához elõször meg kell vásárolni a <a href=http://www.maplesoft.com/>http://www.maplesoft.com/</a> címrõl, majd a licenc megszerzéséhez ugyanott regisztrálni. FreeBSD-re a szoftvert a következõ egyszerû lépéseken keresztül tudjuk telepíteni.</p></div><div class="exampleblock procedure"><div class=content><div class="olist arabic"><ol class=arabic><li><p>Indítsuk el a termékhez mellékelt <span class=filename>INSTALL</span> nevû szkriptet. Válasszuk a telepítõprogram által felkínált opciók közül a "RedHat" címkéjût. A telepítés célkönyvtára legyen a <span class=filename>/usr/local/maple</span>.</p></li><li><p>Ha eddig még nem tettük volna meg, rendeljük meg a Maple™ licencét a Maple Waterloo Software-tõl (<a href=http://register.maplesoft.com/>http://register.maplesoft.com/</a>) és másoljuk az <span class=filename>/usr/local/maple/license/license.dat</span> állományba.</p></li><li><p>Az Maple™-höz mellékelt <span class=filename>INSTALL_LIC</span> szkript elindításával telepítsük a FLEXlm licenckezelõt. A szervernek adjuk meg a számítógépünk hálózati nevét.</p></li><li><p>Javítsuk át a <span class=filename>/usr/local/maple/bin/maple.system.type</span> állományt a következõ módon:</p><div class="literalblock programlisting"><div class=content><pre>   ----- itt kezdõdik a módosítás ---------
*** maple.system.type.orig      Sun Jul  8 16:35:33 2001
--- maple.system.type   Sun Jul  8 16:35:51 2001
***************
*** 72,77 ****
--- 72,78 ----
          # the IBM RS/6000 AIX case
          MAPLE_BIN=&#34;bin.IBM_RISC_UNIX&#34;
          ;;
+     &#34;FreeBSD&#34;|\
      &#34;Linux&#34;)
          # the Linux/x86 case
        # We have two Linux implementations, one for Red Hat and
   ----- módosítás vége -------------------</pre></div></div><div class=paragraph><p>Vigyázzunk, hogy a <code>"FreeBSD"|\</code> kezdetû sor végén nem szabad semmilyen további whitespace karakternek lennie.</p></div><div class=paragraph><p>Ez a javítás arra utasítja a Maple™-t, hogy a "FreeBSD"-t Linux rendszerként ismerje fel. A <span class=filename>bin/maple</span> szkript hívja a <span class=filename>bin/maple.system.type</span> szkriptet, amely pedig a <code>uname -a</code> hívással próbálja kideríteni az operációs rendszer nevét. Ettõl függõen választja ki, hogy milyen típusú binárisokat fog futtatni.</p></div></li><li><p>Indítsuk el a licenckezelõ szervert.</p><div class=paragraph><p>A most következõ szkripttel könnyedén el tudjuk indítani az <code>lmgrd</code> programot. A szkriptet <span class=filename>/usr/local/etc/rc.d/lmgrd.sh</span> néven hozzuk létre:</p></div><div class="literalblock programlisting"><div class=content><pre>   ----- nyissz -----------

#! /bin/sh
PATH=/usr/local/sbin:/usr/local/bin:/sbin:/bin:/usr/sbin:/usr/bin:/usr/X11R6/bin
PATH=${PATH}:/usr/local/maple/bin:/usr/local/maple/FLEXlm/UNIX/LINUX
export PATH

LICENSE_FILE=/usr/local/maple/license/license.dat
LOG=/var/log/lmgrd.log

case &#34;$1&#34; in
start)
	lmgrd -c ${LICENSE_FILE} 2&gt;&gt; ${LOG} 1&gt;&amp;2
	echo -n &#34; lmgrd&#34;
	;;
stop)
	lmgrd -c ${LICENSE_FILE} -x lmdown 2&gt;&gt; ${LOG} 1&gt;&amp;2
	;;
*)
	echo &#34;Usage: `basename $0` {start|stop}&#34; 1&gt;&amp;2
	exit 64
	;;
esac

exit 0
   ----- nyissz -----------</pre></div></div></li><li><p>Próbáljuk meg elindítani a Maple™-t:</p><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>% <span class=nb>cd</span> /usr/local/maple/bin
% ./xmaple</code></pre></div></div><div class=paragraph><p>Szerencsés esetben innentõl kezdve már minden mûködik. És ne felejtsünk el írni a Maplesoftnak, hogy szeretnénk egy natív FreeBSD verziót a termékükbõl!</p></div></li></ol></div></div></div><div class=sect3><h4 id=_általános_buktatók>10.4.1. Általános buktatók<a class=anchor href=#_általános_buktatók></a></h4><div class=ulist><ul><li><p>A FLEXlm licenckezelõvel esetenként nehéz lehet elboldogulni. Errõl a témáról bõvebben a <a href=http://www.globetrotter.com/>http://www.globetrotter.com/</a> címen találunk leírásokat.</p></li><li><p>Az <code>lmgrd</code> nagyon válogatós a licencállományokat illetõen és bármilyen apróságra kiakad. Egy szabályos licencállomány valahogy így néz ki:</p><div class="literalblock programlisting"><div class=content><pre># =======================================================
# License File for UNIX Installations (&#34;Pointer File&#34;)
# =======================================================
SERVER chillig ANY
#USE_SERVER
VENDOR maplelmg

FEATURE Maple maplelmg 2000.0831 permanent 1 XXXXXXXXXXXX \
         PLATFORMS=i86_r ISSUER=&#34;Waterloo Maple Inc.&#34; \
         ISSUED=11-may-2000 NOTICE=&#34; Technische Universitat Wien&#34; \
         SN=XXXXXXXXX</pre></div></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>A sorozatszámot természetesen eltávolítottuk. Itt a <code>chillig</code> a számítógép neve.</p></div></td></tr></tbody></table></div><div class=paragraph><p>Az itt megadott licencállomány remekül használható egészen addig a pontig, amíg békén hagyjuk a "FEATURE" kezdetû sort (melyet a licenckulcs véd).</p></div></li></ul></div></div></div><div class=sect2><h3 id=linuxemu-matlab>10.5. A MATLAB® telepítése<a class=anchor href=#linuxemu-matlab></a></h3><div class=paragraph><p>Ez a leírás azt mutatja be, hogyan telepítsük FreeBSD rendszerekre a MATLAB® version 6.5 Linux változatát. A Java Virtual Machine™ (lásd <a href=#matlab-jre>A Java™ futtató környezet élesítése</a>) használatától eltekintve meglepõen jól mûködik.</p></div><div class=paragraph><p>A MATLAB® Linux változata közvetlenül megrendelhetõ a The MathWorks-tõl, a <a href=http://www.mathworks.com>http://www.mathworks.com</a> címen. Ne felejtsük el beszerezni a licencállományt és az elkészítéséhez szükséges útmutatót. Ha már úgyis arra járunk, jelezzük a fejlesztõknek, hogy igényt tartanánk a termékük natív FreeBSD-s változatára is!</p></div><div class=sect3><h4 id=_a_matlab_telepítése>10.5.1. A MATLAB® telepítése<a class=anchor href=#_a_matlab_telepítése></a></h4><div class=paragraph><p>A MATLAB® telepítéséhez a következõket kell tennünk:</p></div><div class="exampleblock procedure"><div class=content><div class="olist arabic"><ol class=arabic><li><p>Helyezzük be a telepítõ CD-t és csatlakoztassuk. A telepítõszkript javaslatának megfelelõen váltsunk át a <code>root</code> felhasználóra. A szóbanforgó szkript elindításához gépeljük be a következõt:</p><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># /compat/linux/bin/sh /cdrom/install</span></code></pre></div></div><div class="admonitionblock tip"><table><tbody><tr><td class=icon><i class="fa icon-tip" title=Tip></i></td><td class=content><div class=paragraph><p>A telepítõ grafikus. Ha a megjelenítõ használatáról szóló hibaüzeneteket kapunk, akkor adjuk ki a <code>setenv HOME ~FELHASZNÁLÓ</code> parancsot, ahol a <em>FELHASZNÁLÓ</em> annak a felhasználónak a neve legyen, amivel az imént meghívtuk a <a href="https://man.freebsd.org/cgi/man.cgi?query=su&amp;sektion=1&amp;format=html">su(1)</a> programot.</p></div></td></tr></tbody></table></div></li><li><p>Amikor a MATLAB® könyvtárát kell megadnunk, ezt írjuk be: <code>/compat/linux/usr/local/matlab</code>.</p><div class="admonitionblock tip"><table><tbody><tr><td class=icon><i class="fa icon-tip" title=Tip></i></td><td class=content><div class=paragraph><p>A telepítés további részeinek megkönnyítése érdekében írjuk be ezt a parancssorba: <code>set MATLAB=/compat/linux/usr/local/matlab</code></p></div></td></tr></tbody></table></div></li><li><p>Miután megkaptuk a MATLAB® licencét, az útmutatás szerint szerkesszük át.</p><div class="admonitionblock tip"><table><tbody><tr><td class=icon><i class="fa icon-tip" title=Tip></i></td><td class=content><div class=paragraph><p>A licencállományt a kedvenc szövegszerkesztõnkkel akár már korábban elõ is készíthetjük, és majd amikor a telepítõnek szüksége lesz rá, másoljuk be <span class=filename>$MATLAB/license.dat</span> helyre.</p></div></td></tr></tbody></table></div></li><li><p>Futtassuk le a telepítést.</p></li></ol></div></div></div><div class=paragraph><p>Ezzel befejezõdött a MATLAB® hagyományos telepítése. Innentõl már csak a FreeBSD rendszer "hozzátapasztásán" fogunk dolgozni.</p></div></div><div class=sect3><h4 id=_a_licenckezelõ_elindítása>10.5.2. A licenckezelõ elindítása<a class=anchor href=#_a_licenckezelõ_elindítása></a></h4><div class="exampleblock procedure"><div class=content><div class="olist arabic"><ol class=arabic><li><p>Hozzunk létre szimbolikus linkeket a licenckezelõ szkriptjeire:</p><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># ln -s $MATLAB/etc/lmboot /usr/local/etc/lmboot_TMW</span>
<span class=c># ln -s $MATLAB/etc/lmdown /usr/local/etc/lmdown_TMW</span></code></pre></div></div></li><li><p>Hozzunk létre egy indítószkriptet <span class=filename>/usr/local/etc/rc.d/flexlm.sh</span> néven. A lentebb látható minta a MATLAB®hoz mellékelt <span class=filename>$MATLAB/etc/rc.lm.glnx86</span> állomány egy módosított változata. Benne az állományok helyét és a licenckezelõ indításának körülményeit változtattuk meg (hogy Linux emuláció alatt fusson).</p><div class="literalblock programlisting"><div class=content><pre>#!/bin/sh
case &#34;$1&#34; in
  start)
        if [ -f /usr/local/etc/lmboot_TMW ]; then
              /compat/linux/bin/sh /usr/local/etc/lmboot_TMW -u felhasználó &amp;&amp; echo &#39;MATLAB_lmgrd&#39;
        fi
        ;;
  stop)
	if [ -f /usr/local/etc/lmdown_TMW ]; then
            /compat/linux/bin/sh /usr/local/etc/lmdown_TMW  &gt; /dev/null 2&gt;&amp;1
	fi
        ;;
  *)
	echo &#34;Usage: $0 {start|stop}&#34;
	exit 1
	;;
esac

exit 0</pre></div></div><div class="admonitionblock important"><table><tbody><tr><td class=icon><i class="fa icon-important" title=Important></i></td><td class=content><div class=paragraph><p>Tegyük ezt az állományt végrehajthatóvá:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># chmod +x /usr/local/etc/rc.d/flexlm.sh</span></code></pre></div></div><div class=paragraph><p>A fenti szkriptben cseréljük ki a <em>felhasználó</em> nevét a rendszerünkben levõ egyik felhasználó nevére (ami persze nem a <code>root</code>).</p></div></td></tr></tbody></table></div></li><li><p>A licenckezelõt az alábbi paranccsal indítsuk el:</p><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># /usr/local/etc/rc.d/flexlm.sh start</span></code></pre></div></div></li></ol></div></div></div></div><div class=sect3><h4 id=matlab-jre>10.5.3. A Java™ futtató környezet élesítése<a class=anchor href=#matlab-jre></a></h4><div class=paragraph><p>A Java™ futtató környezet (Java™ Runtime Environment, JRE) linkjét irányítsuk át egy FreeBSD alatt mûködõ változatéra:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># cd $MATLAB/sys/java/jre/glnx86/</span>
<span class=c># unlink jre; ln -s ./jre1.1.8 ./jre</span></code></pre></div></div></div><div class=sect3><h4 id=_a_matlab_indítószkriptjének_elkészítése>10.5.4. A MATLAB® indítószkriptjének elkészítése<a class=anchor href=#_a_matlab_indítószkriptjének_elkészítése></a></h4><div class="exampleblock procedure"><div class=content><div class="olist arabic"><ol class=arabic><li><p>Hozzunk létre egy ilyen indítószkriptet a <span class=filename>/usr/local/bin/matlab</span> könyvtárban:</p><div class="literalblock programlisting"><div class=content><pre>#!/bin/sh
/compat/linux/bin/sh /compat/linux/usr/local/matlab/bin/matlab &#34;$@&#34;</pre></div></div></li><li><p>Futtassuk le a <code>chmod +x /usr/local/bin/matlab</code> parancsot.</p></li></ol></div></div></div><div class="admonitionblock tip"><table><tbody><tr><td class=icon><i class="fa icon-tip" title=Tip></i></td><td class=content><div class=paragraph><p>A szkript lefutása során az <a class=package href=https://cgit.freebsd.org/ports/tree/emulators/linux_base/>emulators/linux_base</a> verziójától függõen hibákat is kaphatunk. Ha el akarjuk kerülni ezeket, akkor szerkesszük át a <span class=filename>/compat/linux/usr/local/matlab/bin/matlab</span> állomány következõ sorát:</p></div><div class="literalblock programlisting"><div class=content><pre>if [ `expr &#34;$lscmd&#34; : &#39;.*-&gt;.*&#39;` -ne 0 ]; then</pre></div></div><div class=paragraph><p>(a 13.0.1 számú verzióban ez 410. sor) erre:</p></div><div class="literalblock programlisting"><div class=content><pre>if test -L $newbase; then</pre></div></div></td></tr></tbody></table></div></div><div class=sect3><h4 id=_a_matlab_leállító_szkriptjének_elkészítése>10.5.5. A MATLAB® leállító szkriptjének elkészítése<a class=anchor href=#_a_matlab_leállító_szkriptjének_elkészítése></a></h4><div class=paragraph><p>A MATLAB® szabálytalan kilépéseit az alábbi utasítások nyomán tudjuk megszüntetni.</p></div><div class="exampleblock procedure"><div class=content><div class="olist arabic"><ol class=arabic><li><p>Hozzunk létre egy <span class=filename>$MATLAB/toolbox/local/finish.m</span> nevû állományt, majd írjuk bele ezt a sort:</p><div class="literalblock programlisting"><div class=content><pre>! $MATLAB/bin/finish.sh</pre></div></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>A <code>$MATLAB</code> szöveget pontosan így írjuk be.</p></div></td></tr></tbody></table></div><div class="admonitionblock tip"><table><tbody><tr><td class=icon><i class="fa icon-tip" title=Tip></i></td><td class=content><div class=paragraph><p>Ugyanebben a könyvtárban találjuk a beállításaink kilépés elõtti mentéséért felelõs <span class=filename>finishsav.m</span> és <span class=filename>finishdlg.m</span> állományokat. Ha ezek valamelyikét módosítjuk, akkor az elõbbi parancsot közvetlenül a <code>save</code> után szúrjuk be.</p></div></td></tr></tbody></table></div></li><li><p>Hozzunk létre egy <span class=filename>$MATLAB/bin/finish.sh</span> állományt, amelyben szerepeljen a következõ:</p><div class="literalblock programlisting"><div class=content><pre>#!/usr/compat/linux/bin/sh
(sleep 5; killall -1 matlab_helper) &amp;
exit 0</pre></div></div></li><li><p>Tegyük végrehajthatóvá:</p><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># chmod +x $MATLAB/bin/finish.sh</span></code></pre></div></div></li></ol></div></div></div></div><div class=sect3><h4 id=matlab-using>10.5.6. A MATLAB® használata<a class=anchor href=#matlab-using></a></h4><div class=paragraph><p>Most már a <code>matlab</code> parancs begépelésével bármikor elindíthatjuk.</p></div></div></div><div class=sect2><h3 id=linuxemu-oracle>10.6. Az Oracle® telepítése<a class=anchor href=#linuxemu-oracle></a></h3><div class=sect3><h4 id=_elõszó>10.6.1. Elõszó<a class=anchor href=#_elõszó></a></h4><div class=paragraph><p>Ez a leírás azt mutatja be, hogyan telepítsük FreeBSD-re az Oracle® 8.0.5 és Oracle® 8.0.5.1 Enterprise Edition Linux változatait.</p></div></div><div class=sect3><h4 id=_a_linux_környezet_telepítése>10.6.2. A Linux környezet telepítése<a class=anchor href=#_a_linux_környezet_telepítése></a></h4><div class=paragraph><p>Telepítsük az <a class=package href=https://cgit.freebsd.org/ports/tree/emulators/linux_base/>emulators/linux_base</a> és <a class=package href=https://cgit.freebsd.org/ports/tree/devel/linux_devtools/>devel/linux_devtools</a> portokat a Portgyûjteménybõl. Amennyiben ennek során nehézségekbe ütköznénk, próbálkozzunk a korábbi változataikkal.</p></div><div class=paragraph><p>Fel kell raknunk a Red Hat Tcl csomagját is, ha az alkalmazáshoz tartozó intelligens ügynököt is futtatni szeretnénk. Ez a <span class=filename>tcl-8.0.3-20.i386.rpm</span>. A hivatalos RPM port segítségével az alábbi általános parancson keresztül tudunk csomagokat telepíteni:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># rpm -i --ignoreos --root /compat/linux --dbpath /var/lib/rpm csomag</span></code></pre></div></div><div class=paragraph><p>A <em>csomag</em> telepítésének semmilyen hibát nem kellene okoznia.</p></div></div><div class=sect3><h4 id=_az_oracle_környezetének_létrehozása>10.6.3. Az Oracle® környezetének létrehozása<a class=anchor href=#_az_oracle_környezetének_létrehozása></a></h4><div class=paragraph><p>Az Oracle® telepítéséhez elõször ki kell alakítanunk a megfelelõ környezetet. Ez a leírás <em>kifejezetten</em> arról szól, hogy FreeBSD-n hogyan futtassuk a linuxos Oracle®-t, nem pedig az Oracle® telepítési útmutatójában bemutatottakat taglalja.</p></div><div class=sect4><h5 id=linuxemu-kernel-tuning>10.6.3.1. A rendszermag hangolása<a class=anchor href=#linuxemu-kernel-tuning></a></h5><div class=paragraph><p>Ahogy az Oracle® telepítési útmutatójában is olvashatjuk, be kell állítanunk az osztott memória maximális méretét. FreeBSD alatt erre a célra ne használjuk az <code>SHMMAX</code> értéket, mivel az <code>SHMMAX</code> az <code>SHMMAXPGS</code> és <code>PGSIZE</code> értékekbõl számolódik ki. Ezért nekünk itt a <code>SHMMAXPGS</code> értékét kell meghatároznunk. Minden egyéb beállítás történhet az útmutatóban megadottak szerint. Például:</p></div><div class="literalblock programlisting"><div class=content><pre>options SHMMAXPGS=10000
options SHMMNI=100
options SHMSEG=10
options SEMMNS=200
options SEMMNI=70
options SEMMSL=61</pre></div></div><div class=paragraph><p>Hangoljuk be ezeket az értékeket az Oracle® tervezett használatához.</p></div><div class=paragraph><p>Emellett a konfigurációs állományban ne feledkezzünk meg az alábbi beállítások megadásáról sem:</p></div><div class="literalblock programlisting"><div class=content><pre>options SYSVSHM #SysV osztott memória
options SYSVSEM #SysV szemaforok
options SYSVMSG #SysV folyamatok közti kommunikáció</pre></div></div></div><div class=sect4><h5 id=linuxemu-oracle-account>10.6.3.2. Az Oracle® hozzáférése<a class=anchor href=#linuxemu-oracle-account></a></h5><div class=paragraph><p>Egy rendes hozzáféréshez hasonlóan hozzunk létre egy külön <code>oracle</code> hozzáférést is rendszerünkön. Az <code>oracle</code> hozzáférés csak annyiban különleges, hogy linuxos parancsértelmezõt kell társítanunk hozzá. Ehhez vegyük fel <code>/compat/linux/bin/bash</code> sort az <span class=filename>/etc/shells</span> állományba, majd állítsuk át az <code>oracle</code> nevû felhasználó parancsértelmezõjét a <span class=filename>/compat/linux/bin/bash</span> programra.</p></div></div><div class=sect4><h5 id=linuxemu-environment>10.6.3.3. Környezet<a class=anchor href=#linuxemu-environment></a></h5><div class=paragraph><p>A megszokott Oracle® környezeti változók, mint például az <code>ORACLE_HOME</code> és <code>ORACLE_SID</code> mellett még definiálnunk kell a következõket is:</p></div><table class="tableblock frame-none grid-all stretch informaltable"><col style=width:50%><col style=width:50%><thead><tr><th class="tableblock halign-left valign-top">Változó</th><th class="tableblock halign-left valign-top">Érték</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>LD_LIBRARY_PATH</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock><code>$ORACLE_HOME/lib</code></p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>CLASSPATH</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock><code>$ORACLE_HOME/jdbc/lib/classes111.zip</code></p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>PATH</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock><code>/compat/linux/bin /compat/linux/sbin /compat/linux/usr/bin /compat/linux/usr/sbin /bin /sbin /usr/bin /usr/sbin /usr/local/bin $ORACLE_HOME/bin</code></p></td></tr></tbody></table><div class=paragraph><p>Javasoljuk, hogy az összes környezeti változót a <span class=filename>.profile</span> állományban adjuk meg. Ennek megfelelõen a példa beállításai így fognak kinézni benne:</p></div><div class="literalblock programlisting"><div class=content><pre>ORACLE_BASE=/oracle; export ORACLE_BASE
ORACLE_HOME=/oracle; export ORACLE_HOME
LD_LIBRARY_PATH=$ORACLE_HOME/lib
export LD_LIBRARY_PATH
ORACLE_SID=ORCL; export ORACLE_SID
ORACLE_TERM=386x; export ORACLE_TERM
CLASSPATH=$ORACLE_HOME/jdbc/lib/classes111.zip
export CLASSPATH
PATH=/compat/linux/bin:/compat/linux/sbin:/compat/linux/usr/bin
PATH=$PATH:/compat/linux/usr/sbin:/bin:/sbin:/usr/bin:/usr/sbin
PATH=$PATH:/usr/local/bin:$ORACLE_HOME/bin
export PATH</pre></div></div></div></div><div class=sect3><h4 id=_az_oracle_telepítése>10.6.4. Az Oracle® telepítése<a class=anchor href=#_az_oracle_telepítése></a></h4><div class=paragraph><p>A Linux emulátorban meghúzódó apró egyenletlenségek miatt a telepítés elõtt létre kell hoznunk egy <span class=filename>.oracle</span> nevû alkönyvtárat a <span class=filename>/var/tmp</span> könyvtárban. Helyezzük ezt az <code>oracle</code> felhasználó tulajdonába. Ezt követõen minden további gond nélkül képesek leszünk az Oracle® telepítésére. Ha netalán mégis problémákba ütköznénk, elõször mindig az Oracle® telepítési és konfigurációs állományait ellenõrizzük! Az Oracle® telepítése után rakjuk fel a következõ szakaszokban bemutatandó javításokat.</p></div><div class=paragraph><p>Gyakran problémát okoz, ha a TCP protokollt még nem telepítettük. Ennek következményeképpen ugyanis nem tudnak elindulni a TCP alapú szolgáltatások. Az alábbi mûveletek ebben igyekeznek segíteni:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># cd $ORACLE_HOME/network/lib</span>
<span class=c># make -f ins_network.mk ntcontab.o</span>
<span class=c># cd $ORACLE_HOME/lib</span>
<span class=c># ar r libnetwork.a ntcontab.o</span>
<span class=c># cd $ORACLE_HOME/network/lib</span>
<span class=c># make -f ins_network.mk install</span></code></pre></div></div><div class=paragraph><p>Ne felejtsük el ismét elindítani a <span class=filename>root.sh</span> szkriptet!</p></div><div class=sect4><h5 id=linuxemu-patch-root>10.6.4.1. A root.sh javítása<a class=anchor href=#linuxemu-patch-root></a></h5><div class=paragraph><p>Az Oracle® telepítése során <code>root</code> (privilegizált) felhasználóként elvégzendõ mûveleteket a <span class=filename>root.sh</span> elnevezésû szkriptben találjuk. Ez a szkript az <span class=filename>orainst</span> könyvtárba kerül. A <code>chown</code> parancs helyes lefutásához alkalmazzuk az alább mellékelt javítást, vagy az egész szkriptet egy linuxos parancsértelmezõbõl indítsuk el.</p></div><div class="literalblock programlisting"><div class=content><pre>*** orainst/root.sh.orig Tue Oct 6 21:57:33 1998
--- orainst/root.sh Mon Dec 28 15:58:53 1998
***************
*** 31,37 ****
# This is the default value for CHOWN
# It will redefined later in this script for those ports
# which have it conditionally defined in ss_install.h
! CHOWN=/bin/chown
#
# Define variables to be used in this script
--- 31,37 ----
# This is the default value for CHOWN
# It will redefined later in this script for those ports
# which have it conditionally defined in ss_install.h
! CHOWN=/usr/sbin/chown
#
# Define variables to be used in this script</pre></div></div><div class=paragraph><p>Ha nem CD-rõl telepítjük az Oracle®-t, akkor akár a <span class=filename>root.sh</span> forrását is kijavíthatjuk. A neve <span class=filename>rthd.sh</span>, és a forrásfa <span class=filename>orainst</span> könyvtárában találhatjuk.</p></div></div><div class=sect4><h5 id=linuxemu-patch-tcl>10.6.4.2. A genclntsh javítása<a class=anchor href=#linuxemu-patch-tcl></a></h5><div class=paragraph><p>A <code>genclntsh</code> szkript a kliensek által használt osztott könyvtár létrehozására alkalmazható. Általában demók fordításához van rá szükség. Az alábbi javítás alkalmazásával a <code>PATH</code> változó értéke törölhetõ:</p></div><div class="literalblock programlisting"><div class=content><pre>*** bin/genclntsh.orig Wed Sep 30 07:37:19 1998
--- bin/genclntsh Tue Dec 22 15:36:49 1998
***************
*** 32,38 ****
#
# Explicit path to ensure that we&#39;re using the correct commands
#PATH=/usr/bin:/usr/ccs/bin export PATH
! PATH=/usr/local/bin:/bin:/usr/bin:/usr/X11R6/bin export PATH
#
# each product MUST provide a $PRODUCT/admin/shrept.lst
--- 32,38 ----
#
# Explicit path to ensure that we&#39;re using the correct commands
#PATH=/usr/bin:/usr/ccs/bin export PATH
! #PATH=/usr/local/bin:/bin:/usr/bin:/usr/X11R6/bin export PATH
#
# each product MUST provide a $PRODUCT/admin/shrept.lst</pre></div></div></div></div><div class=sect3><h4 id=_az_oracle_futtatása>10.6.5. Az Oracle® futtatása<a class=anchor href=#_az_oracle_futtatása></a></h4><div class=paragraph><p>Ha rendesen követtük az iménti utasításokat, akkor most már úgy tudjuk futtatni az Oracle®-t, mintha csak Linuxon futna.</p></div></div></div><div class=sect2><h3 id=sapr3>10.7. Az SAP® R/3® telepítése<a class=anchor href=#sapr3></a></h3><div class=paragraph><p>Az SAP® típusú rendszerek telepítéséhez FreeBSD-re hivatalosan nem kaphatunk mûszaki segélynyújtást - csak a minõsített platformokat támogatják.</p></div><div class=sect3><h4 id=preface>10.7.1. Elõszó<a class=anchor href=#preface></a></h4><div class=paragraph><p>Ez a leírás az SAP® R/3® rendszer és Oracle® adatbázis Linux változatainak telepítését mutatja be FreeBSD-n, beleértve a FreeBSD és az Oracle® telepítését. Kétféle konfigurációt írunk le:</p></div><div class=ulist><ul><li><p>SAP® R/3® 4.6B (IDES) és Oracle® 8.0.5, FreeBSD 4.3-STABLE</p></li><li><p>SAP® R/3® 4.6C és Oracle® 8.1.7, FreeBSD 4.5-STABLE</p></li></ul></div><div class=paragraph><p>Habár ez a dokumentum igyekszik az összes fontos lépést a lehetõ legrészletesebb módon tárgyalni, semmiképpen sem célja az Oracle® és az SAP® R/3® alkalmazásokhoz mellékelt telepítési útmutatók kiváltása.</p></div><div class=paragraph><p>A kifejezetten az SAP® vagy az Oracle® Linux változataira vonatkozó kérdések, valamint az Oracle® és az SAP® OSS konkrét használatával kapcsolatos leírások tekintetében a saját dokumentációjukat olvassuk el.</p></div></div><div class=sect3><h4 id=software>10.7.2. A szoftver<a class=anchor href=#software></a></h4><div class=paragraph><p>Az SAP® telepítéséhez az alábbi CD-ket használtuk fel:</p></div><div class=sect4><h5 id=software-46b>10.7.2.1. SAP® R/3® 4.6B, Oracle® 8.0.5<a class=anchor href=#software-46b></a></h5><table class="tableblock frame-none grid-all stretch informaltable"><col style=width:33.3333%><col style=width:33.3333%><col style=width:33.3334%><thead><tr><th class="tableblock halign-left valign-top">Név</th><th class="tableblock halign-left valign-top">Szám</th><th class="tableblock halign-left valign-top">Leírás</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class=tableblock>KERNEL</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>51009113</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>SAP Kernel Oracle / telepítõ / AIX, Linux, Solaris</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>RDBMS</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>51007558</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Oracle / RDBMS 8.0.5.X / Linux</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>EXPORT1</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>51010208</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>IDES / DB-Export / 1. lemez</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>EXPORT2</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>51010209</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>IDES / DB-Export / 2. lemez</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>EXPORT3</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>51010210</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>IDES / DB-Export / 3. lemez</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>EXPORT4</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>51010211</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>IDES / DB-Export / 4. lemez</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>EXPORT5</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>51010212</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>IDES / DB-Export / 5. lemez</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>EXPORT6</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>51010213</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>IDES / DB-Export / 6. (utolsó) lemez</p></td></tr></tbody></table><div class=paragraph><p>Emellett még használtuk az Oracle® 8 Server (az elõzetes 8.0.5 változat a Linux 2.0.33 verziójához) CD-jét is, amely igazából nem feltétlenül szükséges, valamint a FreeBSD (a 4.3 RELEASE kiadása után nem sokkal levõ) 4.3-STABLE változatát.</p></div></div><div class=sect4><h5 id=software-46c>10.7.2.2. SAP® R/3® 4.6C SR2, Oracle® 8.1.7<a class=anchor href=#software-46c></a></h5><table class="tableblock frame-none grid-all stretch informaltable"><col style=width:33.3333%><col style=width:33.3333%><col style=width:33.3334%><thead><tr><th class="tableblock halign-left valign-top">Név</th><th class="tableblock halign-left valign-top">Szám</th><th class="tableblock halign-left valign-top">Leírás</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class=tableblock>KERNEL</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>51014004</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>SAP Kernel Oracle / SAP Kernel 4.6D változat / DEC, Linux</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>RDBMS</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>51012930</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Oracle 8.1.7/ RDBMS / Linux</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>EXPORT1</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>51013953</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>4.6C kiadás SR2 / Export / 1. lemez</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>EXPORT1</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>51013953</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>4.6C kiadás SR2 / Export / 2. lemez</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>EXPORT1</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>51013953</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>4.6C kiadás SR2 / Export / 3. lemez</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>EXPORT1</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>51013953</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>4.6C kiadás SR2 / Export / 4. (utolsó) lemez</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>LANG1</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>51013954</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>4.6C kiadás SR2 / Nyelvi támogatás / német, angol, francia / 1. lemez</p></td></tr></tbody></table><div class=paragraph><p>A telepítendõ nyelvtõl függõen egyéb nyelvi támogatást tartalmazó CD használata is szükségessé válhat. Itt most csak a német és angol nyelveket használjuk, ezért elegendõ az elsõ CD. Csendben hozzátesszük, hogy mind a négy EXPORT CD száma megegyezik. Ugyanígy a három nyelvi CD-nek is megegyeznek a számai (ez eltér a 4.6B IDES kiadás CD számozásától). Az írás pillanatában a FreeBSD 4.5-STABLE (2002.03.20-i) változatát használjuk.</p></div></div></div><div class=sect3><h4 id=sap-notes>10.7.3. SAP® füzetek<a class=anchor href=#sap-notes></a></h4><div class=paragraph><p>Az SAP® R/3® telepítésével kapcsolatban az alábbi füzetek bizonyultak hasznosnak:</p></div><div class=sect4><h5 id=sap-notes-46b>10.7.3.1. SAP® R/3® 4.6B, Oracle® 8.0.5<a class=anchor href=#sap-notes-46b></a></h5><table class="tableblock frame-none grid-all stretch informaltable"><col style=width:50%><col style=width:50%><thead><tr><th class="tableblock halign-left valign-top">Szám</th><th class="tableblock halign-left valign-top">Cím</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class=tableblock>0171356</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>SAP Software on Linux: Essential Comments</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>0201147</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>INST: 4.6C R/3 Inst. on UNIX - Oracle</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>0373203</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Update / Migration Oracle 8.0.5 -→ 8.0.6/8.1.6 LINUX</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>0072984</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Release of Digital UNIX 4.0B for Oracle</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>0130581</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>R3SETUP step DIPGNTAB terminates</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>0144978</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Your system has not been installed correctly</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>0162266</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Questions and tips for R3SETUP on Windows NT / W2K</p></td></tr></tbody></table></div><div class=sect4><h5 id=sap-notes-46c>10.7.3.2. SAP® R/3® 4.6C, Oracle® 8.1.7<a class=anchor href=#sap-notes-46c></a></h5><table class="tableblock frame-none grid-all stretch informaltable"><col style=width:50%><col style=width:50%><thead><tr><th class="tableblock halign-left valign-top">Szám</th><th class="tableblock halign-left valign-top">Cím</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class=tableblock>0015023</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Initializing table TCPDB (RSXP0004) (EBCDIC)</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>0045619</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>R/3 with several languages or typefaces</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>0171356</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>SAP Software on Linux: Essential Comments</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>0195603</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>RedHat 6.1 Enterprise version: Known problems</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>0212876</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>The new archiving tool SAPCAR</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>0300900</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Linux: Released DELL Hardware</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>0377187</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>RedHat 6.2: important remarks</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>0387074</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>INST: R/3 4.6C SR2 Installation on UNIX</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>0387077</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>INST: R/3 4.6C SR2 Inst. on UNIX - Oracle</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>0387078</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>SAP Software on UNIX: OS Dependencies 4.6C SR2</p></td></tr></tbody></table></div></div><div class=sect3><h4 id=hardware-requirements>10.7.4. Hardverkövetelmények<a class=anchor href=#hardware-requirements></a></h4><div class=paragraph><p>Az alábbi hardvereszközök szükségesek az SAP® R/3® rendszer telepítéséhez. Az éles használathoz ennél természetesen valamivel több kell majd:</p></div><table class="tableblock frame-none grid-all stretch informaltable"><col style=width:33.3333%><col style=width:33.3333%><col style=width:33.3334%><thead><tr><th class="tableblock halign-left valign-top">Változat</th><th class="tableblock halign-left valign-top">4.6B</th><th class="tableblock halign-left valign-top">4.6C</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class=tableblock>Processzor</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Két Pentium® III 800MHz</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Két Pentium® III 800MHz</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>Memória</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>1GB ECC</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>2GB ECC</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>Szabad hely a merevlemezen</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>50 - 60GB (IDES)</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>50 - 60GB (IDES)</p></td></tr></tbody></table><div class=paragraph><p>Éles használatra nagyobb gyorsítótárral rendelkezõ Xeon™ processzorokat, nagysebességû háttértárakat (SCSI, hardveres RAID vezérlõvel), USV és ECC memória modulok ajánlottak. A nagy tárigényt egyébként az elõre beállított IDES rendszer indokolja, ami egy 27 GB méretû adatbázist hoz létre a telepítés során. Ez a terület általában elegendõ egy frissen induló rendszer és hozzá tartozó alkalmazásadatok tárolására.</p></div><div class=sect4><h5 id=hardware-46b>10.7.4.1. SAP® R/3® 4.6B, Oracle® 8.0.5<a class=anchor href=#hardware-46b></a></h5><div class=paragraph><p>A következõ hardverkonfigurációt használtuk: két 800 MHz-es Pentium® III processzor és a hozzájuk tartozó alaplap, egy Adaptec® 29160 Ultra160 SCSI-vezérlõ (a 40/80 GB méretû DLT szalagos meghajtó és CD-meghajtó használatához) és egy Mylex® AcceleRAID™ RAID-vezérlõ (2 csatorna, 6.00-1-00 verziójú firmware és 32 MB memória), amihez két 17 GB-os (tükrözött) merevlemez és négy 36 GB-os merevlemez (RAID 5) csatlakozik.</p></div></div><div class=sect4><h5 id=hardware-46c>10.7.4.2. SAP® R/3® 4.6C, Oracle® 8.1.7<a class=anchor href=#hardware-46c></a></h5><div class=paragraph><p>Itt a hardver egy Dell™ PowerEdge™ 2500 volt: kétprocesszoros alaplap, két darab 1000 MHz-es Pentium® III processzorral (fejenként 256 KB gyorsítótárral), 2 GB PC133-as ECC SDRAM memóriával, PERC/3 DC PCI RAID-vezérlõvel (128 MB memória), valamint egy EIDE DVD-meghajtóval. A RAID-vezérlõre két, egyenként 18 GB méretû merevlemezt (tükrözve) és négy 36 GB méretû merevlemezt csatlakoztattunk (RAID 5-ben).</p></div></div></div><div class=sect3><h4 id=installation>10.7.5. A FreeBSD telepítése<a class=anchor href=#installation></a></h4><div class=paragraph><p>Elõször is telepítenünk kell a FreeBSD-t. Ez több módon is lehetséges, ezekrõl a <a href=./#install-diff-media>Saját telepítőeszköz elkészítése</a>ban olvashatunk bõvebben.</p></div><div class=sect4><h5 id=disk-layout>10.7.5.1. A lemezek felosztása<a class=anchor href=#disk-layout></a></h5><div class=paragraph><p>Az egyszerûség kedvéért az SAP® R/3® 46B és SAP® R/3® 46C SR2 telepítése során is ugyanazt a felosztást használtuk. Egyedül az eszközök nevei változtak, mivel a telepítés eltérõ hardvereken történt (<span class=filename>/dev/da</span>) és <span class=filename>/dev/amr</span>, tehát ha az AMI MegaRAID® esetén a <span class=filename>/dev/da0s1a</span> helyett a <span class=filename>/dev/amr0s1a</span> eszközt láthatjuk):</p></div><table class="tableblock frame-none grid-all stretch informaltable"><col style=width:33.3333%><col style=width:33.3333%><col style=width:33.3334%><thead><tr><th class="tableblock halign-left valign-top">Állományrendszer</th><th class="tableblock halign-left valign-top">Méret</th><th class="tableblock halign-left valign-top">Csatlakozási pont</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class=tableblock><span class=filename>/dev/da0s1a</span></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>1 GB</p></td><td class="tableblock halign-left valign-top"><p class=tableblock><span class=filename>/</span></p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><span class=filename>/dev/da0s1b</span></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>6 GB</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>lapozóállomány</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><span class=filename>/dev/da0s1e</span></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>2 GB</p></td><td class="tableblock halign-left valign-top"><p class=tableblock><span class=filename>/var</span></p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><span class=filename>/dev/da0s1f</span></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>8 GB</p></td><td class="tableblock halign-left valign-top"><p class=tableblock><span class=filename>/usr</span></p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><span class=filename>/dev/da1s1e</span></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>45 GB</p></td><td class="tableblock halign-left valign-top"><p class=tableblock><span class=filename>/compat/linux/oracle</span></p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><span class=filename>/dev/da1s1f</span></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>2 GB</p></td><td class="tableblock halign-left valign-top"><p class=tableblock><span class=filename>/compat/linux/sapmnt</span></p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><span class=filename>/dev/da1s1g</span></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>2 GB</p></td><td class="tableblock halign-left valign-top"><p class=tableblock><span class=filename>/compat/linux/usr/sap</span></p></td></tr></tbody></table><div class=paragraph><p>Elõre állítsuk be és inicializáljuk a két logikai meghajtót a Mylex® és a PERC/3 RAID-vezérlõkön. A hozzá tartozó szoftver a BIOS indításának fázisában hívható be.</p></div><div class=paragraph><p>A lemezek felosztása némileg eltér az SAP® által javasoltaktól, mivel az SAP® szerint az Oracle® könyvtárait (néhány másikkal együtt) külön-külön érdemes csatlakoztatni - mi most az egyszerûsítés kedvéért csak létrehoztuk ezeket.</p></div></div><div class=sect4><h5 id=makeworldandnewkernel>10.7.5.2. A <code>make world</code> és egy új rendszermag<a class=anchor href=#makeworldandnewkernel></a></h5><div class=paragraph><p>Töltsük le a legfrissebb -STABLE forrásokat. Fordítsuk újra az összes forrást (<code>make world</code>) és a beállításainak elvégzése után a saját rendszermagunkat is. Itt ne felejtsük el megadni az SAP® R/3® és az Oracle® mûködéséhez szükséges <a href=#kerneltuning>paramétereket</a>.</p></div></div></div><div class=sect3><h4 id=installingthelinuxenviornment>10.7.6. A Linux környezet telepítése<a class=anchor href=#installingthelinuxenviornment></a></h4><div class=sect4><h5 id=installinglinuxbase-system>10.7.6.1. Az linuxos alaprendszer telepítése<a class=anchor href=#installinglinuxbase-system></a></h5><div class=paragraph><p>Elsõként a <a href=#linuxemu-libs-port>linux_base</a> portot kell felraknunk (<code>root</code> felhasználóként):</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># cd /usr/ports/emulators/linux_base-fc4</span>
<span class=c># make install distclean</span></code></pre></div></div></div><div class=sect4><h5 id=installinglinuxdevelopment>10.7.6.2. A linuxos fejlesztõi környezet telepítése<a class=anchor href=#installinglinuxdevelopment></a></h5><div class=paragraph><p>Ha az Oracle®-t FreeBSD-re a <a href=#linuxemu-oracle>Az Oracle® telepítése</a>ban leírtak szerint akarjuk telepíteni, akkor szükségünk lesz a linuxos fejlesztõeszközökre is:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># cd /usr/ports/devel/linux_devtools</span>
<span class=c># make install distclean</span></code></pre></div></div><div class=paragraph><p>A linuxos fejlesztõkörnyezetet csak az SAP® R/3® 46B IDES telepítésénél raktuk fel. Nincs rá szükségünk, ha a FreeBSD rendszeren nem akarjuk újralinkelni az Oracle® adatbázist. Pontosan ez a helyzet, amikor egy Linux rendszerhez gyártott Oracle® készletet használunk.</p></div></div><div class=sect4><h5 id=installingnecessaryrpms>10.7.6.3. A szükséges RPM csomagok telepítése<a class=anchor href=#installingnecessaryrpms></a></h5><div class=paragraph><p>Az <code>R3SETUP</code> elindításához PAM támogatásra is szükségünk lesz. Amikor elõször próbáltuk meg telepíteni a FreeBSD 4.3-STABLE változatára az SAP®-t, felraktuk a PAM-et és az összes hozzá tartozó csomagot, majd végül úgy bírtuk mûködésre, hogy kényszerítettük a PAM telepítését is. Az SAP® R/3® 4.6C SR2 esetén szintén sikerült önmagában felrakni a PAM RPM csomagját is, tehát úgy néz ki, hogy a függõségeit már nem kell telepíteni:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># rpm -i --ignoreos --nodeps --root /compat/linux --dbpath /var/lib/rpm \</span>
pam-0.68-7.i386.rpm</code></pre></div></div><div class=paragraph><p>Az Oracle® 8.0.5 verziójához mellékelt intelligens ügynök futtatásához fel kell rakni a RedHat <span class=filename>tcl-8.0.5-30.i386.rpm</span> nevû Tcl csomagját is (máskülönben a az Oracle® telepítése közben szükséges újralinkelés nem fog mûködni). Vannak ugyan egyébként is gondok az Oracle® újralinkelésével, azonban ez linuxos probléma, nem pedig FreeBSD-s.</p></div></div><div class=sect4><h5 id=linuxprocandfallbackelfbrand>10.7.6.4. Néhány további tipp<a class=anchor href=#linuxprocandfallbackelfbrand></a></h5><div class=paragraph><p>Hasznos lehet, ha felvesszük a <code>linprocfs</code> bejegyzést az <span class=filename>/etc/fstab</span> állományba. Ennek pontos részleteit a <a href="https://man.freebsd.org/cgi/man.cgi?query=linprocfs&amp;sektion=5&amp;format=html">linprocfs(5)</a> man oldalon találjuk meg. Másik fontos paraméter a <code>kern.fallback_elf_brand=3</code>, amelyet az <span class=filename>/etc/sysctl.conf</span> állományba kell beszúrnunk.</p></div></div></div><div class=sect3><h4 id=creatingsapr3env>10.7.7. Az SAP® R/3® környezetének létrehozása<a class=anchor href=#creatingsapr3env></a></h4><div class=sect4><h5 id=filesystemsandmountpoints>10.7.7.1. A szükséges állományrendszerek és csatlakozási pontok létrehozása<a class=anchor href=#filesystemsandmountpoints></a></h5><div class=paragraph><p>Egy egyszerûbb telepítéshez elég csupán a következõ állományrendszereket elkészíteni:</p></div><table class="tableblock frame-none grid-all stretch informaltable"><col style=width:50%><col style=width:50%><thead><tr><th class="tableblock halign-left valign-top">csatlakozási pont</th><th class="tableblock halign-left valign-top">méret GB-ban</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class=tableblock><span class=filename>/compat/linux/oracle</span></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>45 GB</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><span class=filename>/compat/linux/sapmnt</span></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>2 GB</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><span class=filename>/compat/linux/usr/sap</span></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>2 GB</p></td></tr></tbody></table><div class=paragraph><p>Készítenünk kell még néhány linket is, különben az SAP® telepítõje panaszkodni fogni az ellenõrzésük során:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># ln -s /compat/linux/oracle /oracle</span>
<span class=c># ln -s /compat/linux/sapmnt /sapmnt</span>
<span class=c># ln -s /compat/linux/usr/sap /usr/sap</span></code></pre></div></div><div class=paragraph><p>Az egyik ilyen telepítés közben megjelenõ hibaüzenet (a <em>PRD</em> rendszer és az SAP® R/3® 4.6C SR2 telepítése esetén):</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>INFO 2002-03-19 16:45:36 R3LINKS_IND_IND SyLinkCreate:200
    Checking existence of symbolic <span class=nb>link</span> /usr/sap/PRD/SYS/exe/dbg to
    /sapmnt/PRD/exe. Creating <span class=k>if </span>it does not exist...

WARNING 2002-03-19 16:45:36 R3LINKS_IND_IND SyLinkCreate:400
    Link /usr/sap/PRD/SYS/exe/dbg exists but it points to file
    /compat/linux/sapmnt/PRD/exe instead of /sapmnt/PRD/exe. The
    program cannot go on as long as this <span class=nb>link </span>exists at this
    location. Move the <span class=nb>link </span>to another location.

ERROR 2002-03-19 16:45:36 R3LINKS_IND_IND Ins_SetupLinks:0
    can not setup <span class=nb>link</span> <span class=s1>&#39;/usr/sap/PRD/SYS/exe/dbg&#39;</span> with content
    <span class=s1>&#39;/sapmnt/PRD/exe&#39;</span></code></pre></div></div></div><div class=sect4><h5 id=creatingusersanddirectories>10.7.7.2. A felhasználók és könyvtárak létrehozása<a class=anchor href=#creatingusersanddirectories></a></h5><div class=paragraph><p>Az SAP® R/3® rendszernek két felhasználóra és három csoportra van szüksége. Az igényelt felhasználók nevei az SAP® rendszer azonosítójától (System ID, SID) függenek, amely három betûbõl áll. Egyes ilyen rendszerazonosítók az SAP® számára vannak fenntartva. (Például a <code>SAP</code> és a <code>NIX</code>. Ezek teljes listáját az SAP® dokumentációjában találjuk meg.) Erre az IDES telepítéséhez az <code>IDS</code>, a 4.6C SR2 telepítésénél a <code>PRD</code> neveket adtuk, mivel ezeket a rendszereket éles használatra szánták. Ennélfogva a következõ csoportokat hoztuk létre hozzájuk (a csoportok azonosítói ugyan eltérhetnek az általunk használtaktól):</p></div><table class="tableblock frame-none grid-all stretch informaltable"><col style=width:33.3333%><col style=width:33.3333%><col style=width:33.3334%><thead><tr><th class="tableblock halign-left valign-top">csoport azonosítója</th><th class="tableblock halign-left valign-top">csoport neve</th><th class="tableblock halign-left valign-top">leírás</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class=tableblock>100</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>dba</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Adatbázis adminisztrátor</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>101</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>sapsys</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>SAP® rendszer</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>102</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>oper</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Adatbázis operátor</p></td></tr></tbody></table><div class=paragraph><p>Az Oracle® alapértelmezett telepítésénél csak a <code>dba</code> csoport jön létre. A <code>dba</code> csoportot <code>oper</code> csoportként is használhatjuk (bõvebb információkért lásd az Oracle® és az SAP® dokumentációját).</p></div><div class=paragraph><p>Ezenkívül az alábbi felhasználókra van még szükségünk:</p></div><table class="tableblock frame-none grid-all stretch informaltable"><col style=width:16.6666%><col style=width:16.6666%><col style=width:16.6666%><col style=width:16.6666%><col style=width:16.6666%><col style=width:16.667%><thead><tr><th class="tableblock halign-left valign-top">felhasználói azonosító</th><th class="tableblock halign-left valign-top">felhasználói név</th><th class="tableblock halign-left valign-top">általános név</th><th class="tableblock halign-left valign-top">csoport</th><th class="tableblock halign-left valign-top">egyéb csoportok</th><th class="tableblock halign-left valign-top">leírás</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class=tableblock>1000</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>idsadm/prdadm</p></td><td class="tableblock halign-left valign-top"><p class=tableblock><em>sid</em>adm</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>sapsys</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>oper</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>SAP® adminisztrátor</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>1002</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>oraids/oraprd</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>ora<em>sid</em></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>dba</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>oper</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Oracle® adminisztrátor</p></td></tr></tbody></table><div class=paragraph><p>Az <a href="https://man.freebsd.org/cgi/man.cgi?query=adduser&amp;sektion=8&amp;format=html">adduser(8)</a> parancs használata során a következõkre lesz szükségünk egy "SAP® Administrator" létrehozásához (figyeljük a parancsértelmezõt (shell) és a felhasználói könyvtárat (home directory)):</p></div><div class="literalblock programlisting"><div class=content><pre>Name: sidadm
Password: ******
Fullname: SAP Administrator SID
Uid: 1000
Gid: 101 (sapsys)
Class:
Groups: sapsys dba
HOME: /home/sidadm
Shell: bash  (/compat/linux/bin/bash)</pre></div></div><div class=paragraph><p>Ugyanígy az "Oracle® Administrator" esetében:</p></div><div class="literalblock programlisting"><div class=content><pre>Name: orasid
Password: ******
Fullname: Oracle Administrator SID
Uid: 1002
Gid: 100 (dba)
Class:
Groups: dba
HOME: /oracle/sid
Shell: bash  (/compat/linux/bin/bash)</pre></div></div><div class=paragraph><p>A <code>dba</code> és <code>oper</code> csoportok használata során ne felejtsük el megadni az <code>oper</code> csoportot sem.</p></div></div><div class=sect4><h5 id=creatingdirectories>10.7.7.3. Könyvtárak létrehozása<a class=anchor href=#creatingdirectories></a></h5><div class=paragraph><p>A könyvtárakat általában külön állományrendszerekként hozzák létre, de ez teljesen az igényeinken múlik. Mi most egyszerû könyvtárakként alakítottuk ki ezeket, ezért tulajdonképpen ugyanazon a RAID 5 tömbön találhatóak meg:</p></div><div class=paragraph><p>Ehhez elõször beállítjuk az egyes könyvtárak tulajdonosait és engedélyeit (<code>root</code> felhasználóként):</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># chmod 775 /oracle</span>
<span class=c># chmod 777 /sapmnt</span>
<span class=c># chown root:dba /oracle</span>
<span class=c># chown sidadm:sapsys /compat/linux/usr/sap</span>
<span class=c># chmod 775 /compat/linux/usr/sap</span></code></pre></div></div><div class=paragraph><p>Másodsorban <code>ora<em>sid</em></code> felhasználóként hozzuk létre az <span class=filename>/oracle/SID</span> alkönyvtárait:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># su - orasid</span>
<span class=c># cd /oracle/SID</span>
<span class=c># mkdir mirrlogA mirrlogB origlogA origlogB</span>
<span class=c># mkdir sapdata1 sapdata2 sapdata3 sapdata4 sapdata5 sapdata6</span>
<span class=c># mkdir saparch sapreorg</span>
<span class=c># exit</span></code></pre></div></div><div class=paragraph><p>Az Oracle® 8.1.7 telepítésénél még további könyvtárakra is szükségünk lesz:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># su - orasid</span>
<span class=c># cd /oracle</span>
<span class=c># mkdir 805_32</span>
<span class=c># mkdir client stage</span>
<span class=c># mkdir client/80x_32</span>
<span class=c># mkdir stage/817_32</span>
<span class=c># cd /oracle/SID</span>
<span class=c># mkdir 817_32</span></code></pre></div></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>A <span class=filename>client/80x_32</span> könyvtárnak pontosan ilyen névvel kell rendelkeznie. Ne cseréljük ki a benne szereplõ <em>x</em>-et semmire se!</p></div></td></tr></tbody></table></div><div class=paragraph><p>A harmadik lépésben létrehozzuk a <code><em>sid</em>adm</code> felhasználóhoz tartozó könyvtárakat:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># su - sidadm</span>
<span class=c># cd /usr/sap</span>
<span class=c># mkdir SID</span>
<span class=c># mkdir trans</span>
<span class=c># exit</span></code></pre></div></div></div><div class=sect4><h5 id=entriesinslashetcslashservices>10.7.7.4. Az <span class=filename>/etc/services</span><a class=anchor href=#entriesinslashetcslashservices></a></h5><div class=paragraph><p>A SAP® R/3® mûködéséhez fel kell vennünk néhány olyan bejegyzést is az <span class=filename>/etc/services</span> állományba, amelyek a FreeBSD telepítése során nem jönnek létre. Így tehát írjuk be az alábbi sorokat (legalább a használni kívánt példány számához illõ sorokat adjuk meg - ez jelen esetünkben most a <code>00</code>. Természetesen az sem okoz gondot, ha a <code>dp</code>, <code>gw</code>, <code>sp</code> és <code>ms</code> esetén beírjuk az összes példánynak megfelelõ portot <code>00</code>-tól <code>99</code>-ig). Amennyiben a SAProuter vagy az SAP® OSS használatára lenne szükségünk, akkor adjuk meg a SAProuter által lefoglalt <code>99</code>-es példánynak megfelelõ 3299-es portot a rendszerünkön:</p></div><div class="literalblock programlisting"><div class=content><pre>sapdp00  3200/tcp # SAP menetirányító        3200 + a példány száma
sapgw00  3300/tcp # SAP átjáró               3300 + a példány száma
sapsp00  3400/tcp #                          3400 + a példány száma
sapms00  3500/tcp #                          3500 + a példány száma
sapmsSID 3600/tcp # SAP üzenetkezelõ szerver 3600 + a példány száma
sapgw00s 4800/tcp # biztonságos SAP átjáró   4800 + a példány száma</pre></div></div></div><div class=sect4><h5 id=necessarylocales>10.7.7.5. A szükséges nyelvi beállítások<a class=anchor href=#necessarylocales></a></h5><div class=paragraph><p>Az SAP®-nek legalább két olyan nyelvre van szüksége, amely nem része az alap RedHat telepítéseknek. Az SAP® a saját FTP szervereirõl elérhetõvé tette az ehhez szükséges RPM csomagokat (amelyek viszont csak OSS típusú hozzáférés birtokában tölthetõek le). A 0171356 számú jegyzet tartalmazza a beszerzendõ RPM-ek listáját.</p></div><div class=paragraph><p>Megcsinálhatjuk úgy is, hogy egyszerûen csak linkeket hozunk létre (például a <em>de_DE</em> és <em>en_US</em> könyvtárakra), habár ezt egy éles rendszer esetében semmiképpen sem ajánljuk (az IDES rendszerrel tapasztalataink szerint eddig még remekül mûködött). Az alábbi nyelvi beállítások fognak tehát nekünk kelleni:</p></div><div class="literalblock programlisting"><div class=content><pre>de_DE.ISO-8859-1
en_US.ISO-8859-1</pre></div></div><div class=paragraph><p>Így hozzuk létre hozzájuk a linkeket:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># cd /compat/linux/usr/shared/locale</span>
<span class=c># ln -s de_DE de_DE.ISO-8859-1</span>
<span class=c># ln -s en_US en_US.ISO-8859-1</span></code></pre></div></div><div class=paragraph><p>A telepítés során az iméntiek hiánya gondokat okozhat. Ha folyamatosan figyelmen kívül hagyjuk az ezekbõl fakadó hibákat (vagyis a <span class=filename>CENTRDB.R3S</span> állományban a gondot okozó lépések <code>STATUS</code> értékét <code>OK</code>-ra állítjuk), akkor komolyabb erõfeszítések megtétele nélkül majd képtelenek leszünk bejelentkezni a frissen telepített SAP® rendszerünkbe.</p></div></div><div class=sect4><h5 id=kerneltuning>10.7.7.6. A rendszermag finomhangolása<a class=anchor href=#kerneltuning></a></h5><div class=paragraph><p>Az SAP® R/3® rendszerek temérdek mennyiségû erõforrást igényelnek. Ennek kielégítésére az alábbi paramétereket adjuk hozzá a rendszermag beállításait tartalmazó állományhoz:</p></div><div class="literalblock programlisting"><div class=content><pre># Adjunk a memóriazabálóknak (SAP és Oracle):
options MAXDSIZ=&#34;(1024*1024*1024)&#34;
options DFLDSIZ=&#34;(1024*1024*1024)&#34;
# Kell néhány System V beállítás is:
options SYSVSHM # SYSV típusú osztott memória be
options SHMMAXPGS=262144 # a megosztható memória maximális mérete lapokban
#options SHMMAXPGS=393216 # a 46C telepítésekor ezt használjuk
options SHMMNI=256 # az osztott memóriákhoz tartozó azonosítók maximális száma
options SHMSEG=100 # a futó programonként megosztható szegmensek maximuma
options SYSVMSG # SYSV típusú üzenetsorok
options MSGSEG=32767 # a rendszerben keringõ üzenetszegmensek maximális száma
options MSGSSZ=32 # az üzenetszegmensek mérete. 2 hatványa LEGYEN
options MSGMNB=65535 # maximális karakter üzenetsoronként
options MSGTQL=2046 # a rendszerben levõ üzenetek maximuma
options SYSVSEM # SYSV típusú szemaforok
options SEMMNU=256 # a szemaforok UNDO struktúráinak száma
options SEMMNS=1024 # a rendszerben levõ szemaforok száma
options SEMMNI=520 # a szemaforok azonosítóinak mennyisége
options SEMUME=100 # az UNDO kulcsok száma</pre></div></div><div class=paragraph><p>Az itt megadott minimum értékek az SAP® által kiadott dokumentációkból származnak. Mivel a Linux változathoz errõl nincs külön leírás, ezért a (32 bites) HP-UX változat dokumentációi között érdemes ennek utánanézni. Mivel a 4.6C SR2 telepítéséhez használt rendszeren valamivel több fizikai memória állt rendelkezésünkre, ezért az osztott szegmensek méretét nagyobbra tudtuk megválasztani mind az SAP®, mind az Oracle® esetében, ami magyarázza a megosztható lapok nagyobb számát.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>A FreeBSD i386™ változatának telepítése során hagyjuk meg a <code>MAXDSIZ</code> és <code>DFLDSIZ</code> értékek alapértelmezett 1 GB-os maximumát. Ellenkezõ esetben ezekhez hasonló furcsa hibaüzeneteket láthatunk: <code>ORA-27102: out of memory</code> vagy <code>Linux Error: 12: Cannot allocate memory</code>.</p></div></td></tr></tbody></table></div></div></div><div class=sect3><h4 id=installingsapr3>10.7.8. Az SAP® R/3® telepítése<a class=anchor href=#installingsapr3></a></h4><div class=sect4><h5 id=preparingsapcdroms>10.7.8.1. Az SAP® CD-k elõkészítése<a class=anchor href=#preparingsapcdroms></a></h5><div class=paragraph><p>Sok CD-t kell a telepítés során mozgatni, tehát csatlakoztatni és leválasztani. Ha viszont elegendõ meghajtóval rendelkezünk, akkor akár csatlakoztathatjuk egyszerre is az összeset. Vagy felmásolhatjuk a CD-k tartalmát a nekik megfelelõ könyvtárakba:</p></div><div class="literalblock programlisting"><div class=content><pre>/oracle/SID/sapreorg/cd-neve</pre></div></div><div class=paragraph><p>ahol a <em>cd-neve</em> a következõk valamelyike: <span class=filename>KERNEL</span>, <span class=filename>RDBMS</span>, <span class=filename>EXPORT1</span>, <span class=filename>EXPORT2</span>, <span class=filename>EXPORT3</span>, <span class=filename>EXPORT4</span>, <span class=filename>EXPORT5</span> és <span class=filename>EXPORT6</span> (4.6B/IDES), valamint <span class=filename>KERNEL</span>, <span class=filename>RDBMS</span>, <span class=filename>DISK1</span>, <span class=filename>DISK2</span>, <span class=filename>DISK3</span>, <span class=filename>DISK4</span> és <span class=filename>LANG</span> (4.6C SR2). A csatlakoztatott CD-ken található állományok neveinek nagybetûseknek kell lenniük. Ha nem így lenne, akkor a csatlakoztatásnál adjuk meg a <code>-g</code> opciót. Így tehát a következõ parancsokat kell kiadnunk:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># mount_cd9660 -g /dev/cd0a /mnt</span>
<span class=c># cp -R /mnt/* /oracle/SID/sapreorg/cd-neve</span>
<span class=c># umount /mnt</span></code></pre></div></div></div><div class=sect4><h5 id=runningtheinstall-script>10.7.8.2. A telepítõszkript futtatása<a class=anchor href=#runningtheinstall-script></a></h5><div class=paragraph><p>Elsõként egy <span class=filename>install</span> nevû könyvtárat kell elõkészítenünk:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># cd /oracle/SID/sapreorg</span>
<span class=c># mkdir install</span>
<span class=c># cd install</span></code></pre></div></div><div class=paragraph><p>Ezután futtassuk le a telepítõszkriptet, ami pedig bemásolja az <span class=filename>install</span> könyvtárba szinte az összes fontos állományt:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># /oracle/SID/sapreorg/KERNEL/UNIX/INSTTOOL.SH</span></code></pre></div></div><div class=paragraph><p>Az IDES (4.6B) változathoz egy teljes SAP® R/3® bemutató rendszer is tartozik, ezért a megszokott három CD helyett hat EXPORT típusú CD-bõl áll. Itt a <span class=filename>CENTRDB.R3S</span> telepítõsablon csak a szabvány központi példányt hozza létre (R/3® és az adatbázis), az IDES központi példányát már nem. Ezért az <span class=filename>EXPORT1</span> könyvtárból ki kell másolnunk a <span class=filename>CENTRDB.R3S</span> állományt, különben az <code>R3SETUP</code> csak három EXPORT CD-t fog kérni.</p></div><div class=paragraph><p>Az újabb SAP® 4.6 SR2 kiadáshoz négy EXPORT CD tartozik. A telepítés folyamatát a <span class=filename>CENTRAL.R3S</span> állományban levõ paraméterek vezérlik. A korábbi kiadásokkal ellentétben nincsenek külön sablonok az adatbázissal és a nélküle telepítendõ központi példányok számára. Az SAP® az adatbázisok telepítésére külön sablont használ. Újrakezdéskor a telepítést ettõl függetlenül elegendõ az eredeti állománnyal újraindítani.</p></div><div class=paragraph><p>A telepítés közben és után az SAP®-nek a <code>hostname</code> paranccsal csak a gép saját nevét, nem pedig a teljes hálózati nevét kell megadnunk. Ilyenkor ezt vagy egyenként begépeljük, vagy létrehozunk rá egy álnevet az <code>ora_sid_</code> és <code>_sid_adm</code> (valamint a megfelelõ lépésekben a <code>root</code>) felhasználóknak: <code>alias hostname='hostname -s'</code>. Ezenkívül még az SAP® telepítésekor létrehozott mindkét felhasználó <span class=filename>.profile</span> és <span class=filename>.login</span> állományait is beállíthatjuk ennek megfelelõen.</p></div></div><div class=sect4><h5 id=startr3setup-46B>10.7.8.3. Az <code>R3SETUP</code> 4.6B verziójának indítása<a class=anchor href=#startr3setup-46B></a></h5><div class=paragraph><p>Ne felejtsük el jól beállítani az <code>LD_LIBRARY_PATH</code> környezeti változót:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># export LD_LIBRARY_PATH=/oracle/IDS/lib:/sapmnt/IDS/exe:/oracle/805_32/lib</span></code></pre></div></div><div class=paragraph><p>A telepítés könyvtárában <code>root</code> felhasználóként indítsuk el az <code>R3SETUP</code> programot:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># cd /oracle/IDS/sapreorg/install</span>
<span class=c># ./R3SETUP -f CENTRDB.R3S</span></code></pre></div></div><div class=paragraph><p>A szkript ezek után feltesz néhány kérdést (az alapértelmezett válaszok zárójelben, közvetlenül a megadottak után):</p></div><table class="tableblock frame-none grid-all stretch informaltable"><col style=width:33.3333%><col style=width:33.3333%><col style=width:33.3334%><thead><tr><th class="tableblock halign-left valign-top">Kérdés</th><th class="tableblock halign-left valign-top">Alapértelmezés</th><th class="tableblock halign-left valign-top">Válasz</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class=tableblock>Enter SAP System ID</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>[C11]</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>IDS<kbd>Enter</kbd></p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>Enter SAP Instance Number</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>[00]</p></td><td class="tableblock halign-left valign-top"><p class=tableblock><kbd>Enter</kbd></p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>Enter SAPMOUNT Directory</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>[/sapmnt]</p></td><td class="tableblock halign-left valign-top"><p class=tableblock><kbd>Enter</kbd></p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>Enter name of SAP central host</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>[troubadix.domain.de]</p></td><td class="tableblock halign-left valign-top"><p class=tableblock><kbd>Enter</kbd></p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>Enter name of SAP db host</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>[troubadix]</p></td><td class="tableblock halign-left valign-top"><p class=tableblock><kbd>Enter</kbd></p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>Select character set</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>[1] (WE8DEC)</p></td><td class="tableblock halign-left valign-top"><p class=tableblock><kbd>Enter</kbd></p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>Enter Oracle server version (1) Oracle 8.0.5, (2) Oracle 8.0.6, (3) Oracle 8.1.5, (4) Oracle 8.1.6</p></td><td class="tableblock halign-left valign-top"></td><td class="tableblock halign-left valign-top"><p class=tableblock>1<kbd>Enter</kbd></p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>Extract Oracle Client archive</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>[1] (Yes, extract)</p></td><td class="tableblock halign-left valign-top"><p class=tableblock><kbd>Enter</kbd></p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>Enter path to KERNEL CD</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>[/sapcd]</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>/oracle/IDS/sapreorg/KERNEL</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>Enter path to RDBMS CD</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>[/sapcd]</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>/oracle/IDS/sapreorg/RDBMS</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>Enter path to EXPORT1 CD</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>[/sapcd]</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>/oracle/IDS/sapreorg/EXPORT1</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>Directory to copy EXPORT1 CD</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>[/oracle/IDS/sapreorg/CD4_DIR]</p></td><td class="tableblock halign-left valign-top"><p class=tableblock><kbd>Enter</kbd></p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>Enter path to EXPORT2 CD</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>[/sapcd]</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>/oracle/IDS/sapreorg/EXPORT2</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>Directory to copy EXPORT2 CD</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>[/oracle/IDS/sapreorg/CD5_DIR]</p></td><td class="tableblock halign-left valign-top"><p class=tableblock><kbd>Enter</kbd></p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>Enter path to EXPORT3 CD</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>[/sapcd]</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>/oracle/IDS/sapreorg/EXPORT3</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>Directory to copy EXPORT3 CD</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>[/oracle/IDS/sapreorg/CD6_DIR]</p></td><td class="tableblock halign-left valign-top"><p class=tableblock><kbd>Enter</kbd></p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>Enter path to EXPORT4 CD</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>[/sapcd]</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>/oracle/IDS/sapreorg/EXPORT4</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>Directory to copy EXPORT4 CD</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>[/oracle/IDS/sapreorg/CD7_DIR]</p></td><td class="tableblock halign-left valign-top"><p class=tableblock><kbd>Enter</kbd></p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>Enter path to EXPORT5 CD</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>[/sapcd]</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>/oracle/IDS/sapreorg/EXPORT5</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>Directory to copy EXPORT5 CD</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>[/oracle/IDS/sapreorg/CD8_DIR]</p></td><td class="tableblock halign-left valign-top"><p class=tableblock><kbd>Enter</kbd></p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>Enter path to EXPORT6 CD</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>[/sapcd]</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>/oracle/IDS/sapreorg/EXPORT6</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>Directory to copy EXPORT6 CD</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>[/oracle/IDS/sapreorg/CD9_DIR]</p></td><td class="tableblock halign-left valign-top"><p class=tableblock><kbd>Enter</kbd></p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>Enter amount of RAM for SAP + DB</p></td><td class="tableblock halign-left valign-top"></td><td class="tableblock halign-left valign-top"><p class=tableblock>850<kbd>Enter</kbd> (megabyte)</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>Service Entry Message Server</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>[3600]</p></td><td class="tableblock halign-left valign-top"><p class=tableblock><kbd>Enter</kbd></p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>Enter Group-ID of sapsys</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>[101]</p></td><td class="tableblock halign-left valign-top"><p class=tableblock><kbd>Enter</kbd></p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>Enter Group-ID of oper</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>[102]</p></td><td class="tableblock halign-left valign-top"><p class=tableblock><kbd>Enter</kbd></p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>Enter Group-ID of dba</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>[100]</p></td><td class="tableblock halign-left valign-top"><p class=tableblock><kbd>Enter</kbd></p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>Enter User-ID of _sid_adm</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>[1000]</p></td><td class="tableblock halign-left valign-top"><p class=tableblock><kbd>Enter</kbd></p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>Enter User-ID of ora_sid_</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>[1002]</p></td><td class="tableblock halign-left valign-top"><p class=tableblock><kbd>Enter</kbd></p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>Number of parallel procs</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>[2]</p></td><td class="tableblock halign-left valign-top"><p class=tableblock><kbd>Enter</kbd></p></td></tr></tbody></table><div class=paragraph><p>Ha a CD-ket nem különbözõ helyekre másoltuk, akkor az SAP® telepítõje nem fogja megtalálni ezeket (a rajtuk levõ <span class=filename>LABEL.ASC</span> segít neki az azonosításban) és kérni fogja a CD csatlakoztatását, illetve a csatlakozási pontjának megadását.</p></div><div class=paragraph><p>A <span class=filename>CENTRDB.R3S</span> sem minden esetben mentes a hibáktól. A tapasztalataink szerint az EXPORT4 címkéjû CD-t kérte újra, miközben a helyes kulcsokat jelezte ki (6_LOCATION, majd 7_LOCATION stb.), így egyszerûen csak lépjünk tovább az értékek meghagyásával.</p></div><div class=paragraph><p>Függetlenül az imént említett problémáktól, egészen az Oracle® adatbáziskezelõ telepítéséig mindennek mûködnie kellene.</p></div></div><div class=sect4><h5 id=startr3setup-46C>10.7.8.4. Az <code>R3SETUP</code> 4.6C SR2 elindítása<a class=anchor href=#startr3setup-46C></a></h5><div class=paragraph><p>Állítsuk be jól az <code>LD_LIBRARY_PATH</code> környezeti változó értékét. Ez némileg eltér a 4.6B és az Oracle® 8.0.5 párosának beállításától:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># export LD_LIBRARY_PATH=/sapmnt/PRD/exe:/oracle/PRD/817_32/lib</span></code></pre></div></div><div class=paragraph><p>A telepítés könyvtárából <code>root</code> felhasználóként indítsuk el az <code>R3SETUP</code> programot:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># cd /oracle/PRD/sapreorg/install</span>
<span class=c># ./R3SETUP -f CENTRAL.R3S</span></code></pre></div></div><div class=paragraph><p>A szkript ezek után feltesz néhány kérdést (az alapértelmezett válaszok zárójelben, közvetlenül a megadottak után):</p></div><table class="tableblock frame-none grid-all stretch informaltable"><col style=width:33.3333%><col style=width:33.3333%><col style=width:33.3334%><thead><tr><th class="tableblock halign-left valign-top">Kérdés</th><th class="tableblock halign-left valign-top">Alapértelmezés</th><th class="tableblock halign-left valign-top">Válasz</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class=tableblock>Enter SAP System ID</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>[C11]</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>PRD<kbd>Enter</kbd></p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>Enter SAP Instance Number</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>[00]</p></td><td class="tableblock halign-left valign-top"><p class=tableblock><kbd>Enter</kbd></p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>Enter SAPMOUNT Directory</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>[/sapmnt]</p></td><td class="tableblock halign-left valign-top"><p class=tableblock><kbd>Enter</kbd></p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>Enter name of SAP central host</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>[majestix]</p></td><td class="tableblock halign-left valign-top"><p class=tableblock><kbd>Enter</kbd></p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>Enter Database System ID</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>[PRD]</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>PRD<kbd>Enter</kbd></p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>Enter name of SAP db host</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>[majestix]</p></td><td class="tableblock halign-left valign-top"><p class=tableblock><kbd>Enter</kbd></p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>Select character set</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>[1] (WE8DEC)</p></td><td class="tableblock halign-left valign-top"><p class=tableblock><kbd>Enter</kbd></p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>Enter Oracle server version (2) Oracle 8.1.7</p></td><td class="tableblock halign-left valign-top"></td><td class="tableblock halign-left valign-top"><p class=tableblock>2<kbd>Enter</kbd></p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>Extract Oracle Client archive</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>[1] (Yes, extract)</p></td><td class="tableblock halign-left valign-top"><p class=tableblock><kbd>Enter</kbd></p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>Enter path to KERNEL CD</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>[/sapcd]</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>/oracle/PRD/sapreorg/KERNEL</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>Enter amount of RAM for SAP + DB</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>2044</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>1800<kbd>Enter</kbd> (megabyte)</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>Service Entry Message Server</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>[3600]</p></td><td class="tableblock halign-left valign-top"><p class=tableblock><kbd>Enter</kbd></p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>Enter Group-ID of sapsys</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>[100]</p></td><td class="tableblock halign-left valign-top"><p class=tableblock><kbd>Enter</kbd></p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>Enter Group-ID of oper</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>[101]</p></td><td class="tableblock halign-left valign-top"><p class=tableblock><kbd>Enter</kbd></p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>Enter Group-ID of dba</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>[102]</p></td><td class="tableblock halign-left valign-top"><p class=tableblock><kbd>Enter</kbd></p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>Enter User-ID of <code>oraprd</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>[1002]</p></td><td class="tableblock halign-left valign-top"><p class=tableblock><kbd>Enter</kbd></p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>Enter User-ID of <code>prdadm</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>[1000]</p></td><td class="tableblock halign-left valign-top"><p class=tableblock><kbd>Enter</kbd></p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>LDAP support</p></td><td class="tableblock halign-left valign-top"></td><td class="tableblock halign-left valign-top"><p class=tableblock>3<kbd>Enter</kbd> (nincs támogatás)</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>Installation step completed</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>[1] (continue)</p></td><td class="tableblock halign-left valign-top"><p class=tableblock><kbd>Enter</kbd></p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>Choose installation service</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>[1] (DB inst,file)</p></td><td class="tableblock halign-left valign-top"><p class=tableblock><kbd>Enter</kbd></p></td></tr></tbody></table><div class=paragraph><p>Az OSUSERDBSID_IND_ORA és OSUSERIDADM_IND_ORA lépésekben az <code>ora<em>sid</em></code> és <code><em>sid</em>adm</code> felhasználók létrehozása hibákra futhat.</p></div><div class=paragraph><p>Függetlenül az említett problémáktól, az Oracle® adatbáziskezelõ telepítéséig mindennek remekül kell mûködnie.</p></div></div></div><div class=sect3><h4 id=installingoracle805>10.7.9. Az Oracle® 8.0.5 telepítése<a class=anchor href=#installingoracle805></a></h4><div class=paragraph><p>Az Oracle® Linux változatának telepítése során felmerülõ problémák tekintetében keressük fel az SAP® füzeteket és az Oracle® <span class=filename>Readme</span> állományait. A legtöbb, ha nem is az összes gondot az egymással nem kompatibilis függvénykönyvtárak okozzák.</p></div><div class=paragraph><p>Az Oracle® telepítésének részleteit a <a href=#linuxemu-oracle>Az Oracle® telepítése</a> címû szakaszban találjuk.</p></div><div class=sect4><h5 id=installingtheoracle805withorainst>10.7.9.1. Az Oracle® 8.0.5 telepítése az <code>orainst</code> segítségével<a class=anchor href=#installingtheoracle805withorainst></a></h5><div class=paragraph><p>Az Oracle® 8.0.5 verziójának használata esetén néhány további függvénykönyvtár újralinkelésére is szükség lesz, mivel az Oracle® 8.0.5 még a régi glibc könyvtárral lett fordítva (RedHat 6.0), viszont a RedHat 6.1 már a glibc újabb verzióját használja. A linkelés mûködéséhez az alábbi csomagokat kell még telepítenünk:</p></div><div class=ulist><ul><li><p><span class=filename>compat-libs-5.2-2.i386.rpm</span></p></li><li><p><span class=filename>compat-glibc-5.2-2.0.7.2.i386.rpm</span></p></li><li><p><span class=filename>compat-egcs-5.2-1.0.3a.1.i386.rpm</span></p></li><li><p><span class=filename>compat-egcs-c++-5.2-1.0.3a.1.i386.rpm</span></p></li><li><p><span class=filename>compat-binutils-5.2-2.9.1.0.23.1.i386.rpm</span></p></li></ul></div><div class=paragraph><p>A részleteket lásd az SAP® füzeteiben vagy az Oracle® <span class=filename>Readme</span> állományaiban. Amennyiben ez nem oldható meg, akkor az eredeti binárisok, esetleg az eredeti RedHat rendszerbõl származó újralinkelt binárisok is használhatóak (habár a telepítés pillanatában személyesen ezt nem tudtuk ellenõrizni).</p></div><div class=paragraph><p>Az intelligens ügynök lefordításához fel kell raknunk a RedHat saját Tcl csomagját. Ha ehhez nem tudjuk beszerezni a <span class=filename>tcl-8.0.3-20.i386.rpm</span> csomagot, akkor a RedHat 6.1 változatához készült <span class=filename>tcl-8.0.5-30.i386.rpm</span> is megteszi.</p></div><div class=paragraph><p>Az újralinkeléstõl eltekintve a telepítés többi része szinte adja magát:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># su - oraids</span>
<span class=c># export TERM=xterm</span>
<span class=c># export ORACLE_TERM=xterm</span>
<span class=c># export ORACLE_HOME=/oracle/IDS</span>
<span class=c># cd $ORACLE_HOME/orainst_sap</span>
<span class=c># ./orainst</span></code></pre></div></div><div class=paragraph><p>Az <em>Oracle® On-Line Text Viewer</em> kikapcsolásán (mivel az jelenleg Linux alatt sem érhetõ el) kívül mindegyik képernyõt hagyjuk jóvá az <kbd>Enter</kbd> billentyû lenyomásával. Az Oracle® ezután a rendelkezésre álló <code>gcc</code>, <code>egcs</code> vagy <code>i386-redhat-linux-gcc</code> helyett a <code>i386-glibc20-linux-gcc</code> használatával újra akarja linkelni magát.</p></div><div class=paragraph><p>Idõ hiányában az Oracle® 8.0.5 PreProduction kiadásából emeltünk ki binárisokat, de az adatbáziskezelõ rendszer felélesztésére tett elsõ kísérleteink kudarcba fulladtak, és ezután a megfelelõ RPM-ek összeszedése valódi rémálomnak bizonyult.</p></div></div><div class=sect4><h5 id=installingtheoracle805preproduction>10.7.9.2. Az Oracle® 8.0.5 Pre-production Release for Linux (Kernel 2.0.33) telepítése<a class=anchor href=#installingtheoracle805preproduction></a></h5><div class=paragraph><p>A telepítés nagyon könnyû. Csatlakoztassuk a CD-t, majd indítsuk el a telepítõt. Ezután meg kell adnunk az Oracle® felhasználói könyvtárát és a telepítõ odamásolja az összes binárist. Habár a telepítés megkezdése elõtt a korábbi kísérleteink nyomát nem tüntettük el.</p></div><div class=paragraph><p>Ezt követõen az Oracle® adatbázisrendszer minden további gond nélkül elindítható.</p></div></div></div><div class=sect3><h4 id=installingoracle817>10.7.10. Az Oracle® 8.1.7 Linux változatának telepítése<a class=anchor href=#installingoracle817></a></h4><div class=paragraph><p>Szedjük le az <span class=filename>oracle8172.tgz</span> állományt a Linux rendszeren létrehozott könyvtárából, és bontsuk ki a <span class=filename>/oracle/SID/817_32/</span> könyvtárba.</p></div></div><div class=sect3><h4 id=continuewithsapr4installation>10.7.11. Az SAP® R/3® telepítésének folytatása<a class=anchor href=#continuewithsapr4installation></a></h4><div class=paragraph><p>Elõször is ellenõrizzük az <code>isamd</code> (<em>sid</em>adm) és <code>oraids</code> (ora<em>sid</em>) felhasználók környezeti beállításait. A <span class=filename>.profile</span>, <span class=filename>.login</span> és <span class=filename>.cshrc</span> állományaikban a korábbi beállítások szerint kell szerepelnie a <code>hostname</code> parancsnak. Ha még mindig a teljes hálózati név lenne meg bennük, akkor a <code>hostname</code> parancsot át kell írni mind a három állományban a <code>hostname -s</code> parancsra.</p></div><div class=sect4><h5 id=databaseload>10.7.11.1. Az adatbázis feltöltése<a class=anchor href=#databaseload></a></h5><div class=paragraph><p>Ezután az <code>R3SETUP</code> folytatható vagy újraindítható (attól függõen, hogy a kilépést választottuk-e vagy sem). Az <code>R3SETUP</code> ekkor létrehozza az adatbázisban a táblákat és az <code>R3load</code> meghívásával feltölti ezeket adatokkal (a 46B IDES változat esetében az EXPORT1 - EXPORT6, a 46C esetében pedig a DISK1 - DISK4 lemezekrõl).</p></div><div class=paragraph><p>Amikor a feltöltés befejezõdött (ami akár órákig is eltarthat), szükség lesz még néhány jelszó megadására is. A próbatelepítéseknél nyugodtan használhatjuk a jól ismert alapértelmezett jelszavakat (azonban mindenképpen változtassuk meg ezeket, ha egy kicsit is számít a biztonság!):</p></div><table class="tableblock frame-none grid-all stretch informaltable"><col style=width:50%><col style=width:50%><thead><tr><th class="tableblock halign-left valign-top">Kérdés</th><th class="tableblock halign-left valign-top">Válasz</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class=tableblock>Enter Password for sapr3</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>sap<kbd>Enter</kbd></p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>Confirum Password for sapr3</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>sap<kbd>Enter</kbd></p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>Enter Password for sys</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>change_on_install<kbd>Enter</kbd></p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>Confirm Password for sys</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>change_on_install<kbd>Enter</kbd></p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>Enter Password for system</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>manager<kbd>Enter</kbd></p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>Confirm Password for system</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>manager<kbd>Enter</kbd></p></td></tr></tbody></table><div class=paragraph><p>A 4.6B telepítése során még gondjaink akadtak a <code>dipgntab</code> használatával.</p></div></div><div class=sect4><h5 id=listener>10.7.11.2. Az Oracle® Listener elindítása<a class=anchor href=#listener></a></h5><div class=paragraph><p>Így kell elindítani az <code>ora<em>sid</em></code> felhasználóval az Oracle® Listenert:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>% <span class=nb>umask </span>0<span class=p>;</span> lsnrctl start</code></pre></div></div><div class=paragraph><p>Ha máshogy próbálkozunk, akkor az ORA-12546 kódú hibát fogjuk kapni, mert a hálózati portok socketei nem rendelkeznek a szükséges engedélyekkel. Lásd a 072984-es SAP® füzet.</p></div></div><div class=sect4><h5 id=mnlstables>10.7.11.3. Az MNLS táblák frissítése<a class=anchor href=#mnlstables></a></h5><div class=paragraph><p>Ha nem Latin 1 kódolású nyelveket akarunk importálni az SAP® rendszerbe, akkor frissítenünk kell a többnyelvû nyelvi támogatáshoz (Multi National Language Support, MNLS) tartozó táblázatokat. Ezek bemutatását a 15023 és 45619 számú SAP® OSS füzetekben olvashatjuk. Minden más esetben az SAP® telepítésekor nyugodtan kihagyhatjuk.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Ha még nincs is konkrétan szükségünk az MNLS-re, akkor is ellenõriznünk és inicializálnunk kell a TCPDB táblát. A 0015023 és 0045619 számú SAP® füzetekben tudhatunk meg errõl többet.</p></div></td></tr></tbody></table></div></div></div><div class=sect3><h4 id=postinstallationsteps>10.7.12. Telepítés utáni teendõk<a class=anchor href=#postinstallationsteps></a></h4><div class=sect4><h5 id=requestsapr3licensekey>10.7.12.1. Az SAP® R/3® licenckulcsának megszerzése<a class=anchor href=#requestsapr3licensekey></a></h5><div class=paragraph><p>Az SAP® R/3® licenckulcsát külön kell kérni. Fontos, mert a telepítéshez használatos ideiglenes licenc csak négy hétig érvényes. Elõször szerezzük meg a hardverkulcsot. Jelentkezzünk be az <code>idsadm</code> felhasználóval és adjuk ki a <code>saplicense</code> parancsot:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># /sapmnt/IDS/exe/saplicense -get</span></code></pre></div></div><div class=paragraph><p>A <code>saplicense</code> paraméter nélkül meghívására válaszul opciókat listáz ki. A licenckulcsot megérkezése után így tudjuk élesíteni:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># /sapmnt/IDS/exe/saplicense -install</span></code></pre></div></div><div class=paragraph><p>Ezután a következõ értékeket kell megadni:</p></div><div class="literalblock programlisting"><div class=content><pre>SAP SYSTEM ID   = SID, 3 karakter
CUSTOMER KEY    = hardverkulcs, 11 karakter
INSTALLATION NO = telepítés száma, 10 számjegy
EXPIRATION DATE = ééééhhnn, tehát &#34;99991231&#34;
LICENSE KEY     = licenckulcs, 24 karakter</pre></div></div></div><div class=sect4><h5 id=creatingusers>10.7.12.2. A felhasználók létrehozása<a class=anchor href=#creatingusers></a></h5><div class=paragraph><p>Hozzunk létre egy felhasználót a 000 kliensen belül (a csak rajta belül elvégezhetõ feladatokhoz, aki különbözik a <code>sap*</code> és <code>ddic</code> felhasználóktól). Felhasználónévként általában a <code>wartung</code> nevet választottuk (ami angolul a <code>service</code> névnek, avagy szolgáltatásnak felel meg). A <code>sap_new</code> és <code>sap_all</code> nevû profilok is kellenek. A biztonságosság kedvéért a kliens összes alapértelmezett felhasználójának (beleértve a <code>sap*</code> és <code>ddic</code> felhasználókat is) változtassuk meg a jelszavát.</p></div></div><div class=sect4><h5 id=configtranssysprofileopermodesetc>10.7.12.3. A szállítási rendszer, a profilok, mûködési módok stb. beállítása<a class=anchor href=#configtranssysprofileopermodesetc></a></h5><div class=paragraph><p>A <code>ddic</code> és <code>sap*</code> felhasználóktól eltérõ nevû felhasználóval a 000 kliensen belül legalább a következõket végezzük el:</p></div><table class="tableblock frame-none grid-all stretch informaltable"><col style=width:50%><col style=width:50%><thead><tr><th class="tableblock halign-left valign-top">Feladat</th><th class="tableblock halign-left valign-top">Tranzakció</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class=tableblock>A szállítási rendszer (Transport System) beállítása, például a <em>Stand-Alone Transport Domain Entity</em> értékre</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>STMS</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>A rendszer profiljának létrehozása és szerkesztése</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>RZ10</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>A mûködési módok és példányok karbantartása</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>RZ04</p></td></tr></tbody></table><div class=paragraph><p>Az iménti és az összes többi telepítés utáni lépések leírása teljes egészében megtalálható az SAP® telepítési útmutatóiban.</p></div></div><div class=sect4><h5 id=editintsidsap>10.7.12.4. Az <span class=filename>initsid.sap</span> (<span class=filename>initIDS.sap</span>) szerkesztése<a class=anchor href=#editintsidsap></a></h5><div class=paragraph><p>Az <span class=filename>/oracle/IDS/dbs/initIDS.sap</span> állomány tartalmazza a SAP® tartalék profilját. Itt többek közt a használni kívánt szalag méretét, a tömörítés típusát és hasonló paramétereket kell definiálni. A <code>sapdba</code> / <code>brbackup</code> futtatásához a következõ értékeket változtattuk meg:</p></div><div class="literalblock programlisting"><div class=content><pre>compress = hardware
archive_function = copy_delete_save
cpio_flags = &#34;-ov --format=newc --block-size=128 --quiet&#34;
cpio_in_flags = &#34;-iuv --block-size=128 --quiet&#34;
tape_size = 38000M
tape_address = /dev/nsa0
tape_address_rew = /dev/sa0</pre></div></div><div class=paragraph><p>Magyarázat:</p></div><div class=paragraph><p><code>compress</code> (tömörítés): HP DLT1 típusú szalagot használtunk, ami tud hardveres tömörítést.</p></div><div class=paragraph><p><code>archive_function</code> (archiválási házirend): Ez adja meg, hogy alapértelmezés szerint mi történjen az Oracle® archivált naplóival: az új naplóállományok elõször a szalagra mentõdnek, majd a már lementett naplók ismét mentésre kerülnek és végül törlõdnek. Ezzel sok fejfájástól menekülünk meg, mivel ilyenkor az archiváló szalagok esetleges sérülése esetén is valószínûleg képesek leszünk visszaállítani az adatbázist.</p></div><div class=paragraph><p><code>cpio_flags</code> (a cpio beállítása): A <code>-B</code> használata alapértelmezés, amivel a blokkok mérete 5120 byte-ra állítódik. A DLT típusú szalagokhoz a HP legalább 32 KB-os blokkméretet javasolt, ezért a <code>--block-size=128</code> beállítással ezt 64 KB-ra növeltük. Szükségünk volt a <code>--format=newc</code> beállításra is, mivel 65535-nél több inode számunk van. Az utolsó beállítás a <code>--quiet</code>, amivel megakadályozzuk, hogy a <code>cpio</code> lementett blokkokat összefoglaló kijelzésére begerjedjen a <code>brbackup</code>.</p></div><div class=paragraph><p><code>cpio_in_flags</code> (a cpio bemeneti beállításai): A szalagok visszatöltésénél használt beállítások. A formátumot automatikusan felismeri.</p></div><div class=paragraph><p><code>tape_size</code> (szalagméret): Ezzel adjuk meg általában a szalag nyers kapacitását. Biztonsági okokból (hardveres tömörítést használunk) ez az érték a ténylegesnél valamivel kisebb.</p></div><div class=paragraph><p><code>tape_address</code> (szalagos eszköz): a <code>cpio</code> által használható nem visszatekerhetõ eszköz.</p></div><div class=paragraph><p><code>tape_address_rew</code> (visszatekerhetõ szalagos eszköz): A <code>cpio</code> által használható visszatekerhetõ eszköz.</p></div></div><div class=sect4><h5 id=_telepítés_utáni_beállítások>10.7.12.5. Telepítés utáni beállítások<a class=anchor href=#_telepítés_utáni_beállítások></a></h5><div class=paragraph><p>Az SAP® alábbi paramétereit kell beállítani a telepítés után (IDES 46B, 1 GB memóriával):</p></div><table class="tableblock frame-none grid-all stretch informaltable"><col style=width:50%><col style=width:50%><thead><tr><th class="tableblock halign-left valign-top">Név</th><th class="tableblock halign-left valign-top">Érték</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class=tableblock>ztta/roll_extension</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>250000000</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>abap/heap_area_dia</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>300000000</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>abap/heap_area_nondia</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>400000000</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>em/initial_size_MB</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>256</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>em/blocksize_kB</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>1024</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>ipc/shm_psize_40</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>70000000</p></td></tr></tbody></table><div class=paragraph><p>0013026 SAP® füzet:</p></div><table class="tableblock frame-none grid-all stretch informaltable"><col style=width:50%><col style=width:50%><thead><tr><th class="tableblock halign-left valign-top">Név</th><th class="tableblock halign-left valign-top">Érték</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class=tableblock>ztta/dynpro_area</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>2500000</p></td></tr></tbody></table><div class=paragraph><p>0157246 SAP® füzet:</p></div><table class="tableblock frame-none grid-all stretch informaltable"><col style=width:50%><col style=width:50%><thead><tr><th class="tableblock halign-left valign-top">Név</th><th class="tableblock halign-left valign-top">Érték</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class=tableblock>rdisp/ROLL_MAXFS</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>16000</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>rdisp/PG_MAXFS</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>30000</p></td></tr></tbody></table><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>A fenti paraméterek használatával egy 1 gigabyte fizikai memóriával rendelkezõ rendszer esetén nagyjából így alakul a memóriahasználat:</p></div><div class="literalblock programlisting"><div class=content><pre>Mem: 547M Active, 305M Inact, 109M Wired, 40M Cache, 112M Buf, 3492K Free</pre></div></div><div class=paragraph><p>(547 MB aktív, 305 MB inaktív, 109 MB rögzített, 40 MB gyorsítótár, 112 MB puffer, 3492 KB szabad)</p></div></td></tr></tbody></table></div></div></div><div class=sect3><h4 id=problemsduringinstallation>10.7.13. A telepítés során adódó problémák<a class=anchor href=#problemsduringinstallation></a></h4><div class=sect4><h5 id=restartr3setup>10.7.13.1. Az <code>R3SETUP</code> újraindítása egy probléma kijavítása után<a class=anchor href=#restartr3setup></a></h5><div class=paragraph><p>Az <code>R3SETUP</code> hiba esetén leáll. Miután átnéztük a hibára utaló naplókat és elhárítottuk a hiba okát, újra el kell indítanunk az <code>R3SETUP</code> programot, majd a REPEAT opció kiválasztásával próbáljuk megismételni az <code>R3SETUP</code> által kifogásolt legutóbbi mûveletet.</p></div><div class=paragraph><p>Az <code>R3SETUP</code> újraindításához egyszerûen adjuk meg a megfelelõ <span class=filename>R3S</span> állományt:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># ./R3SETUP -f CENTRDB.R3S</span></code></pre></div></div><div class=paragraph><p>a 4.6B verzió esetén, vagy a</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># ./R3SETUP -f CENTRAL.R3S</span></code></pre></div></div><div class=paragraph><p>a 4.6C verzió esetén, függetlenül attól, hogy a hiba a <span class=filename>CENTRAL.R3S</span> vagy <span class=filename>DATABASE.R3S</span> állományoknál keletkezett.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Egyes lépéseknél az <code>R3SETUP</code> úgy véli, hogy az SAP® programjai mûködnek (mivel a hozzájuk tartozó lépéseket már megtettük), így a hibák miatt az adatbázist esetleg korábban nem tudta elindítani. Ezért a hibák kijavításának végeztével az <code>R3SETUP</code> ismételt indítása elõtt nekünk kell beindítani mind az adatbázist, mind pedig az SAP® rendszert.</p></div><div class=paragraph><p>Ne felejtsük el újra elindítani az Oracle® Listener segédprogramját sem (az <code>ora_sid_</code> felhasználóval adjuk ki a <code>umask 0; lsnrctl start</code> parancsot), ha az idõközben leállt volna (például a rendszer kényszerû újraindítása miatt).</p></div></td></tr></tbody></table></div></div><div class=sect4><h5 id=indoraduringduringr3setup>10.7.13.2. OSUSERSIDADM_IND_ORA az <code>R3SETUP</code> közben<a class=anchor href=#indoraduringduringr3setup></a></h5><div class=paragraph><p>Ha az <code>R3SETUP</code> panaszkodik ebben a lépésben, akkor írjuk át az általa ekkor használt sablont (a 4.6B esetén ez a <span class=filename>CENTRDB.R3S</span>, illetve a 4.6C esetén ez a <span class=filename>CENTRAL.R3S</span> vagy a <span class=filename>DATABASE.R3S</span>). Keressük a <code>[OSUSERSIDADM_IND_ORA]</code> szöveget, vagy csak a <code>STATUS=ERROR</code> bejegyzést, majd írjuk be a következõ értékeket:</p></div><div class="literalblock programlisting"><div class=content><pre>HOME=/home/sidadm (üres volt)
STATUS=OK (ERROR státusza volt)</pre></div></div><div class=paragraph><p>Ezután indítsuk újra az <code>R3SETUP</code> programot.</p></div></div><div class=sect4><h5 id=indoraduringr3setup>10.7.13.3. OSUSERDBSID_IND_ORA az <code>R3SETUP</code> közben<a class=anchor href=#indoraduringr3setup></a></h5><div class=paragraph><p>Az <code>R3SETUP</code> ebben a lépésben is hajlamos panaszkodni. Az itt felbukkanó hiba hasonló az OSUSERSIDADM_IND_ORA lépésben jelentkezõhöz. Szerkesszük át az <code>R3SETUP</code> által ilyenkor használt sablont (4.6B verzió esetén ez a <span class=filename>CENTRDB.R3S</span>, illetve 4.6C verziónál a <span class=filename>CENTRAL.R3S</span> vagy <span class=filename>DATABASE.R3S</span>). Keressük meg a <code>[OSUSERDBSID_IND_ORA]</code> részt, vagy csak a <code>STATUS=ERROR</code> bejegyzést, majd írjuk át az ebben a szakaszban szereplõ értéket így:</p></div><div class="literalblock programlisting"><div class=content><pre>STATUS=OK</pre></div></div><div class=paragraph><p>Indítsuk újra az <code>R3SETUP</code> programot.</p></div></div><div class=sect4><h5 id=oraviewvrffilenotfound>10.7.13.4. <code>oraview.vrf FILE NOT FOUND</code> hiba az Oracle® telepítése közben<a class=anchor href=#oraviewvrffilenotfound></a></h5><div class=paragraph><p>A telepítés megkezdése elõtt nem tiltottuk le az <em>Oracle® On-Line Text Viewer</em> felrakását. Habár Linux esetén ez nem használható, alapértelmezés szerint mégis ki van választva. Az Oracle® telepítõ menüjében tiltsuk le ezt és nélküle kezdjük újra a telepítést.</p></div></div><div class=sect4><h5 id=textenvincalid>10.7.13.5. <code>TEXTENV_INVALID</code> hiba az <code>R3SETUP</code>, RFC vagy SAPgui Start programokban<a class=anchor href=#textenvincalid></a></h5><div class=paragraph><p>Ha ilyen hibával kerülünk szembe, akkor hiányoznak a megfelelõ nyelvi állományok. A 0171356 SAP® füzet tartalmazza a telepítendõ RPM csomagok felsorolását (például a RedHat 6.1 esetén a <span class=filename>saplocales-1.0-3</span> és <span class=filename>saposcheck-1.0-1</span>). Amennyiben figyelmen kívül hagyjuk az ilyen hibákat, és az <code>R3SETUP</code> minden kiakadásánál átírjuk (a <span class=filename>CENTRDB.R3S</span> állományban) az <code>STATUS</code> értékét az <code>ERROR</code> értékrõl az <code>OK</code> értékre és újraindítjuk, az SAP® nem állítódik be jól és nem tudunk a SAPgui alkalmazással rácsatlakozni a frissen telepített rendszerre még akkor sem, ha el tudtuk indítani. Amikor a régebbi linuxos SAPgui alkalmazással csatlakozunk, a következõ üzeneteket kapjuk:</p></div><div class="literalblock programlisting"><div class=content><pre>Sat May 5 14:23:14 2001
*** ERROR =&gt; no valid userarea given [trgmsgo. 0401]
Sat May 5 14:23:22 2001
*** ERROR =&gt; ERROR NR 24 occured [trgmsgi. 0410]
*** ERROR =&gt; Error when generating text environment. [trgmsgi. 0435]
*** ERROR =&gt; function failed [trgmsgi. 0447]
*** ERROR =&gt; no socket operation allowed [trxio.c 3363]
Speicherzugriffsfehler</pre></div></div><div class=paragraph><p>Ez a viselkedés annak köszönhetõ, hogy az SAP® R/3® nem képes jól összerendelni a nyelvi beállításokat, sõt, magát sem képes jól beállítani (hiányoznak némely bejegyzések az adatbázis egyes tábláiban). Az SAP®-hez úgy tudunk ilyenkor csatlakozni, ha a <span class=filename>DEFAULT.PFL</span> állományba felvesszük a következõ bejegyzéseket (lásd 0043288 füzet):</p></div><div class="literalblock programlisting"><div class=content><pre>abap/set_etct_env_at_new_mode = 0
install/collate/active = 0
rscp/TCP0B = TCP0B</pre></div></div><div class=paragraph><p>Majd indítsuk újra az egész SAP® rendszert. Ezután már tudunk csatlakozni hozzá, még ha az országra jellemzõ nyelvi beállítások nem is mûködnek tökéletesen. Miután korrigáltuk az ország beállításait (és felraktuk a megfelelõ nyelvi állományokat), távolítsuk el az iménti bejegyzéseket a <span class=filename>DEFAULT.PFL</span> állományból és indítsuk újra az SAP® rendszert.</p></div></div><div class=sect4><h5 id=ora-00001>10.7.13.6. Az ORA-00001 hiba<a class=anchor href=#ora-00001></a></h5><div class=paragraph><p>Ez a hiba FreeBSD alatt az Oracle® 8.1.7 használata során következhet be. Akkor történik, amikor az Oracle® adatbázis nem volt képes rendesen inicializálni magát és összeomlott, aminek révén szemaforokat és memóriát hagyott megosztva a rendszerben. Így az adatbázis következõ indításakor kapunk egy kövér ORA-00001 hibát.</p></div><div class=paragraph><p>Az <code>ipcs -a</code> paranccsal keressük meg ezeket, majd az <code>ipcrm</code> segítségével pedig számoljuk fel.</p></div></div><div class=sect4><h5 id=ora-00445pmon>10.7.13.7. Az ORA-00445 (a PMON háttérprogram nem indult el) hiba<a class=anchor href=#ora-00445pmon></a></h5><div class=paragraph><p>Ez a hiba az Oracle® 8.1.7 használatakor következhet be. Akkor kapjuk ezt a hibát, amikor <code>prdadm</code> felhasználóként a elindítjuk <code>startsap</code> szkriptet (például <code>startsap_majestix_00</code>).</p></div><div class=paragraph><p>Erre gyógyír lehet, ha ehelyette az adatbázis elindításához az <code>oraprd</code> felhasználóval adjuk ki az <code>svrmgrl</code> parancsot:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>% svrmgrl
SVRMGR&gt; connect internal<span class=p>;</span>
SVRMGR&gt; startup<span class=p>;</span>
SVRMGR&gt; <span class=nb>exit</span></code></pre></div></div></div><div class=sect4><h5 id=ora-12546>10.7.13.8. Az ORA-12546 (A Listener indítása megfelelõ engedélyekkel) hiba<a class=anchor href=#ora-12546></a></h5><div class=paragraph><p>Az Oracle® Listener alkalmazását <code>oraids</code> felhasználóként az alábbi paranccsal indítsuk el:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># umask 0; lsnrctl start</span></code></pre></div></div><div class=paragraph><p>Máskülönben ORA-12546 hibát kapunk, mivel a hálózati portokhoz tartozó socketek nem rendelkeznek a megfelelõ engedélyekkel. Lásd 0072984 SAP® füzet.</p></div></div><div class=sect4><h5 id=ora-27102>10.7.13.9. Az ORA-27102 (Nincs elég memória) hiba<a class=anchor href=#ora-27102></a></h5><div class=paragraph><p>Akkor fordul elõ ilyen hiba, amikor a <code>MAXDSIZ</code> és <code>DFLDSIZ</code> értékeit 1 GB-nál (1024 x 1024 x 1024-nél) nagyobbra állítottuk. Mellé még kapunk egy <code>Linux Error 12: Cannot allocate memory</code> hibát is.</p></div></div><div class=sect4><h5 id=dipgntabindind>10.7.13.10. [DIPGNTAB_IND_IND] az <code>R3SETUP</code> közben<a class=anchor href=#dipgntabindind></a></h5><div class=paragraph><p>Errõl alapvetõen a 0130581 számú SAP® füzet ad tájékoztatást (az <code>R3SETUP DIPGNTAB</code> lépése hibára fut). Az IDES telepítése során az SAP® rendszer valamiért az "IDS" név helyett egy üres karakterláncot használ. Ez a könyvtárak elérésében kisebb gondokat okoz, mivel az elérési útvonaluk a <em>SID</em>-bõl generálódik (ami ebben az esetben az IDS). Tehát a</p></div><div class="literalblock programlisting"><div class=content><pre>/usr/sap/IDS/SYS/...
/usr/sap/IDS/DVMGS00</pre></div></div><div class=paragraph><p>helyett a következõt próbálja meg elérni:</p></div><div class="literalblock programlisting"><div class=content><pre>/usr/sap//SYS/...
/usr/sap/D00</pre></div></div><div class=paragraph><p>A telepítés folytatásához létrehoztunk egy linket és egy másik könyvtárat:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># pwd</span>
/compat/linux/usr/sap
<span class=c># ls -l</span>
total 4
drwxr-xr-x 3  idsadm sapsys 512 May 5 11:20 D00
drwxr-x--x 5  idsadm sapsys 512 May 5 11:35 IDS
lrwxr-xr-x 1  root   sapsys 7 May 5 11:35 SYS -&gt; IDS/SYS
drwxrwxr-x 2  idsadm sapsys 512 May 5 13:00 tmp
drwxrwxr-x 11 idsadm sapsys 512 May 4 14:20 trans</code></pre></div></div><div class=paragraph><p>Észrevettük, hogy a SAP® füzetekben (0029227 és 0008401) ugyanezt a viselkedést írják le. Az SAP® 4.6C telepítésénél azonban ilyen hibával nem találkoztunk.</p></div></div><div class=sect4><h5 id=rfcrswboiniindind>10.7.13.11. [RFCRSWBOINI_IND_IND] az <code>R3SETUP</code> közben<a class=anchor href=#rfcrswboiniindind></a></h5><div class=paragraph><p>Az SAP® 4.6C telepítése folyamán ez a hiba csupán egy korábban bekövetkezett másik hiba utóhatása volt. Itt át kell néznünk az összes érintett naplót és ki kell javítanunk a tényleges problémát.</p></div><div class=paragraph><p>Amennyiben a naplók átvizsgálása után csak ezt találjuk egyedüli hibának (lásd SAP® füzetek), állítsuk át (a <span class=filename>CENTRDB.R3S</span> állományban) a <code>STATUS</code> értékét az <code>OK</code> értékre, majd indítsuk újra az <code>R3SETUP</code> programot. A telepítés befejezése után hajtsuk végre az SE38 tranzakcióból az <code>RSWBOINS</code> riportot. A további <code>RFCRSWBOINI</code> és <code>RFCRADDBDIF</code> lépésekkel kapcsolatban lásd a 0162266 SAP® füzetet.</p></div></div><div class=sect4><h5 id=rfcraddbdifindind>10.7.13.12. [RFCRADDBDIF_IND_IND] az <code>R3SETUP</code> közben<a class=anchor href=#rfcraddbdifindind></a></h5><div class=paragraph><p>Itt az elõbbihez hasonló feltételek élnek: mindenképpen ellenõrizzük a naplókban, hogy a hibát nem egy korábban keletkezett hiba okozta.</p></div><div class=paragraph><p>Ha tényleg csak az 0162266 SAP® füzetben leírtak érvényesek, akkor (a <span class=filename>CENTRDB.R3S</span> állományban) állítsuk a gondot okozó lépés <code>STATUS</code> értékét az <code>ERROR</code> értékrõl az <code>OK</code> értékre, és indítsuk újra az <code>R3SETUP</code> programot. A telepítés után pedig hajtsuk végre az SE38 tranzakciból az <code>RADDBDIF</code> riportot.</p></div></div><div class=sect4><h5 id=sigactionsig31>10.7.13.13. A sigaction sig31: File size limit exceeded hiba<a class=anchor href=#sigactionsig31></a></h5><div class=paragraph><p>Ez a <em>disp és work</em> SAP® programok indítása során történhet meg. Az SAP® rendszert indító <code>startsap</code> szkriptrõl leválva indulnak el a többi SAP® program elindításáért felelõs alfolyamatok. Ennek eredményeképpen a szkript maga nem fogja észrevenni a hibát.</p></div><div class=paragraph><p>Az SAP® programok elindulását az <code>ps ax | grep SID</code> paranccsal tudjuk ellenõrizni. Az eredményül kapott listában az összes aktív Oracle® és SAP® programnak szerepelnie kell. Ha ebbõl az tûnik ki, hogy bizonyos programok hiányoznak, vagy nem képesek kapcsolódni az SAP® rendszerhez, akkor az <span class=filename>/usr/sap/SID/DVEBMGSnr/work/</span> könyvtárban nézzük át a hozzájuk tartozó naplóállományokat. Elsõsorban a <span class=filename>dev_ms</span> és a <span class=filename>dev_disp</span> állományok fontosak számunkra.</p></div><div class=paragraph><p>A 31-es jelzés akkor keletkezik, ha az Oracle® és az SAP® által használt osztott memória mértéke meghaladja a rendszermag beállításai közt megadott értéket. Ezt tehát ennek növelésével lehet orvosolni:</p></div><div class="literalblock programlisting"><div class=content><pre># az éles 46C rendszereknek több kell:
options SHMMAXPGS=393216
# a 46B beéri kevesebbel is:
#options SHMMAXPGS=262144</pre></div></div></div><div class=sect4><h5 id=saposcolfails>10.7.13.14. A <code>saposcol</code> nem indul<a class=anchor href=#saposcolfails></a></h5><div class=paragraph><p>A <code>saposcol</code> (4.6D verzió) programmal akad néhány probléma. Az SAP® rendszer az <code>saposcol</code> segítségével próbál adatokat gyûjteni a rendszer teljesítményérõl. Mivel ez a program nem feltétlenül szükséges az SAP® rendszer mûködéséhez, ez a probléma nem tekinthetõ komolynak. A korábbi (4.6B) verziókban ugyan mûködik, de semmilyen adatot nem képes begyûjteni (mivel a legtöbb hívás, például a processzorhasználat függvénye, egyszerûen csak nullát ad vissza).</p></div></div></div></div><div class=sect2><h3 id=linuxemu-advanced>10.8. Témák haladóknak<a class=anchor href=#linuxemu-advanced></a></h3><div class=paragraph><p>Ha kíváncsiak vagyunk a Linux emuláció mûködésére, olvassuk el ezt a szakaszt. Az itt leírtak leginkább Terry Lambert (<a href=mailto:tlambert@primenet.com>tlambert@primenet.com</a>) <a href=https://lists.FreeBSD.org/subscription/freebsd-chat>FreeBSD chat levelezési lista</a> címére írt levele nyomán kerülnek bemutatásra (Az üzenet azonosítója: <code>&lt;<a href=mailto:199906020108.SAA07001@usr09.primenet.com>199906020108.SAA07001@usr09.primenet.com</a>></code>).</p></div><div class=sect3><h4 id=_hogyan_mûködik>10.8.1. Hogyan mûködik?<a class=anchor href=#_hogyan_mûködik></a></h4><div class=paragraph><p>A FreeBSD rendelkezik egy ún. "végrehajtási osztály betöltõvel" (execution class loader). Ez lényegében a <a href="https://man.freebsd.org/cgi/man.cgi?query=execve&amp;sektion=2&amp;format=html">execve(2)</a> rendszerhívás alatt meghúzódó absztrakciós réteg.</p></div><div class=paragraph><p>A FreeBSD-nek a <code>#!</code> karaktersorozat hatására parancsértelmezõk vagy a hozzájuk tartozó szkriptek betöltésére utasító biztonsági betöltõ helyett van egy listája az alkalmas betöltõkrõl.</p></div><div class=paragraph><p>A UNIX® rendszerek a hagyományok szerint egyetlen betöltõvel rendelkeznek, ami elõször megvizsgálja a betölteni kívánt állomány bûvös számát (ami általában az elsõ 4 vagy 8 byte) és ez alapján eldönti, hogy az adott formátum támogatott-e. Amennyiben ez így van, meghívja a betöltõt.</p></div><div class=paragraph><p>Ha a bináris típusa nem ismert a rendszer számára, akkor az <a href="https://man.freebsd.org/cgi/man.cgi?query=execve&amp;sektion=2&amp;format=html">execve(2)</a> hívás hibával tér vissza, és a parancsértelmezõ próbálja meg a saját parancsaiként értelmezni.</p></div><div class=paragraph><p>Eddig ez volt az alapértelmezés, "akármilyen parancsértelmezõnk is volt".</p></div><div class=paragraph><p>Késõbb az <a href="https://man.freebsd.org/cgi/man.cgi?query=sh&amp;sektion=1&amp;format=html">sh(1)</a> kódjába bekerült egy aprócska okosítás, amivel megnézte az állomány elsõ két karakterét, és ha az <code>:\n</code> volt, akkor a futtatáshoz maga helyett a <a href="https://man.freebsd.org/cgi/man.cgi?query=csh&amp;sektion=1&amp;format=html">csh(1)</a> parancsértelmezõt hívta meg (ezt állítólag elõször a SCO csinálta).</p></div><div class=paragraph><p>A FreeBSD viszont végignézi a betöltõk teljes listáját, amiben a sor végén szerepel egy általános <code><mark>!</mark></code> formátumú betöltõ. Ez az állomány futtatásához használatos értelmezõk kódját keresi, és ha egyet sem sikerül azonosítania, akkor a [.filename]/bin/sh# programot indítja el.</p></div><div class=paragraph><p>A Linux ABI támogatását a FreeBSD úgy oldja meg, hogy elõször észleli az ELF bináris bûvös számát (ekkor még nem tesz különbséget a FreeBSD, Solaris™, Linux vagy más ELF típusú binárisokat használó operációs rendszerek közt).</p></div><div class=paragraph><p>Ezután az ELF formátum betöltõje az ELF állomány megjegyzéseket tároló szakaszában <em>bélyegek</em> (brand) után kutat, ami SVR4 és Solaris™ ELF binárisok esetén nem létezik.</p></div><div class=paragraph><p>A Linux binárisokat mûködésükhöz a <a href="https://man.freebsd.org/cgi/man.cgi?query=brandelf&amp;sektion=1&amp;format=html">brandelf(1)</a> segítségével <code>Linux</code> típusúnak kell <em>megbélyegezni</em>:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># brandelf -t Linux állomány</span></code></pre></div></div><div class=paragraph><p>Miután ezt megcsináltuk, az ELF betöltõ észre fogja venni az állomány <code>Linux</code> típusát.</p></div><div class=paragraph><p>Mikor az ELF betöltõ észleli, hogy az állomány <code>Linux</code> típusú, kicseréli egy mutató értékét a <code>proc</code> struktúrában. Minden rendszerhívás ezen a mutatón keresztül érhetõ el (a hagyományos UNIX® rendszerekben ez a rendszerhívásokat tartalmazó <code>sysent[]</code> struktúratömb). Emellett a frissen elindított program szoftveres megszakításait tartalmazó tömbjéhez beállítja a speciális jelzések kezelését, valamint a Linux modul által végzett néhány további (kisebb) javítást.</p></div><div class=paragraph><p>A Linux rendszerhívásokat tartalmazó tömb többek közt tartalmazza a <code>sysent[]</code> bejegyzések egy listáját, amelyek címei a rendszermag Linux moduljára mutatnak.</p></div><div class=paragraph><p>Amikor a Linux bináris hív egy rendszerhívást, a hozzá tartozó szoftveres megszakítás kódja a <code>proc</code> struktúrából a neki megfelelõ rendszerhívás kódját hivatkozza, így FreeBSD rendszerhívás belépési pontja helyett a Linuxét kapja meg.</p></div><div class=paragraph><p>Ráadásul Linux módban a különbözõ állományok hivatkozásai is <em>átirányítódnak</em>. Ez lényegében olyan, mint amit az állományrendszerek csatlakoztatásánál a <code>union</code> beállítás csinál (ami <em>nem</em> egyezik meg az <code>unionfs</code> állományrendszerrel!). Ilyenkor az állományokat elõször a <span class=filename>/compat/linux/eredeti-hely</span> könyvtárában keresi, és <em>majd</em> ha ott nem találja, csak akkor kezdi el keresni az <span class=filename>/eredeti-hely</span> ponton. Ezzel oldhatjuk meg, hogy más binárisok futtatását igénylõ binárisok is képesek legyenek rendesen mûködni (például így az egész linuxos eszköztár tud futni a Linux ABI-n keresztül). Egyúttal arra is utal, hogy ha a Linux binárisok számára nem áll rendelkezésre a megfelelõ bináris, akkor FreeBSD binárisokat is el tudnak indítani. Ha a <a href="https://man.freebsd.org/cgi/man.cgi?query=uname&amp;sektion=1&amp;format=html">uname(1)</a> programot pedig bemásoljuk a <span class=filename>/compat/linux</span> könyvtáron belülre, akkor a Linux binárisok képtelenek lesznek megmondani, hogy nem Linux alatt futnak.</p></div><div class=paragraph><p>Így lényegében egy Linux magot találunk a FreeBSD rendszermagjában. A benne megtalálható különbözõ szolgáltatásokat megvalósító függvények: az állománymûveletek, a virtuális memória kezelése, a jelzések küldése és System V típusú folyamatok közti kommunikáció stb. megegyeznek a FreeBSD és a Linux hívásai esetén egyaránt. Egyetlen eltérés, hogy a FreeBSD binárisok a FreeBSD <em>segédfüggvényein</em> (glue function), a Linux binárisok pedig a Linux segédfüggvényein keresztül férnek hozzájuk (a legelsõ operációs rendszerek tulajdonképpen csak a saját segédfüggvényeiket tartalmazták: a hívást kezdeményezõ program <code>proc</code> struktúrájában a függvények dinamikusan beállított címe helyett egy globális <code>sysent[]</code> struktúratömbben tárolták a meghívható függvényeket).</p></div><div class=paragraph><p>Melyik közülük a FreeBSD natív ABI-ja? Ez teljesen lényegtelen. Alapvetõen az egyetlen különbség csupán annyi (pillanatnyilag, de ez a jövõben még változhat, valószínûleg hamarosan), hogy a FreeBSD <em>segédfüggvényei</em> statikusan megtalálhatóak a rendszermagban, míg a Linux <em>segédfüggvényei</em> egyaránt elérhetõek modulból vagy statikus linkeléssel.</p></div><div class=paragraph><p>Na igen, de akkor ez most emuláció? Nem. Ez egy ABI, nem emuláció. Itt szó sincs emulátorról (ahogy szimulátorról sincs).</p></div><div class=paragraph><p>De akkor mégis miért hívják ezt sokszor "Linux emulációnak"? Hát hogy nehezebb legyen eladni a FreeBSD-t! Komolyra fordítva a szót: ennek a kezdeti változata akkoriban született meg, amikor erre még nem volt rendes szó. Nem mondhattuk, hogy a FreeBSD befordítás vagy egy modul betöltése nélkül képes lett volna Linux binárisokat futtatni, ezért valamilyen módon meg kellett neveznünk az ilyenkor betöltött kódot - ebbõl lett "a Linux emulátor".</p></div></div></div></div></div><h1 id=system-administration class=sect0>Part III: Rendszeradminisztráció<a class=anchor href=#system-administration></a></h1><div class="openblock partintro"><div class=content><div class=paragraph><p>A FreeBSD kézikönyv fennmaradó fejezeteiben a FreeBSD rendszerek adminisztrációjának különbözõ aspektusait mutatjuk be. Mindegyik fejezet elején megtudhatjuk mit is fogunk megismerni a fejezet elolvasása során, illetve arról is információkat kapunk, hogy mivel kell már tisztában lennünk a tárgyalt anyag feldolgozásához.</p></div><div class=paragraph><p>Ezeket a fejezeteket annak érdekében alakítottuk ki, hogy az adott témákban ismereteket adjunk. Nincs köztük semmilyen sorrendi kötöttség, sõt, ezeket egyáltalán nem is szükséges elolvasni a FreeBSD alapvetõ használatához.</p></div></div></div><div class=sect1><h2 id=config-tuning>Chapter 11. Beállítás és finomhangolás<a class=anchor href=#config-tuning></a></h2><div class=sectionbody><div class=sect2><h3 id=config-synopsis>11.1. Áttekintés<a class=anchor href=#config-synopsis></a></h3><div class=paragraph><p>A FreeBSD egyik fontos szempontja a rendszer megfelelõ beállítása, aminek segítségével elkerülhetjük a késõbbi frissítések során keletkezõ kellemetlenségeket. Ez a fejezet a FreeBSD beállítási folyamatából kíván minél többet bemutatni, köztük a FreeBSD rendszerek finomhangolására szánt paramétereket.</p></div><div class=paragraph><p>A fejezet elolvasása során megismerjük:</p></div><div class=ulist><ul><li><p>hogyan dolgozzunk hatékonyan az állományrendszerekkel és a lapozóállományokkal;</p></li><li><p>az <span class=filename>rc.conf</span> beállításának alapjait és a <span class=filename>/usr/local/etc/rc.d</span> könyvtárban található indítási rendszert;</p></li><li><p>hogyan állítsunk be és próbáljunk ki egy hálózati kártyát;</p></li><li><p>hogyan állítsunk be virtuális címeket a hálózati eszközeinken;</p></li><li><p>hogyan használjuk az <span class=filename>/etc</span> könyvtárban megtalálható különféle konfigurációs állományokat;</p></li><li><p>hogyan hangoljuk a FreeBSD mûködését a <code>sysctl</code> változóinak segítségével;</p></li><li><p>hogyan hangoljuk a lemezek teljesítményét és módosítsuk a rendszermag korlátozásait.</p></li></ul></div><div class=paragraph><p>A fejezet elolvasásához ajánlott:</p></div><div class=ulist><ul><li><p>a UNIX® és a FreeBSD alapjainak megértése (<a href=./#basics>A UNIX alapjai</a>);</p></li><li><p>a rendszermag beállításához és fordításához kötõdõ alapok ismerete (<a href=./#kernelconfig>A FreeBSD rendszermag testreszabása</a>).</p></li></ul></div></div><div class=sect2><h3 id=configtuning-initial>11.2. Kezdeti beállítások<a class=anchor href=#configtuning-initial></a></h3><div class=sect3><h4 id=_a_partíciók_kiosztása>11.2.1. A partíciók kiosztása<a class=anchor href=#_a_partíciók_kiosztása></a></h4><div class=sect4><h5 id=_alappartíciók>11.2.1.1. Alappartíciók<a class=anchor href=#_alappartíciók></a></h5><div class=paragraph><p>Amikor a <a href="https://man.freebsd.org/cgi/man.cgi?query=bsdlabel&amp;sektion=8&amp;format=html">bsdlabel(8)</a> vagy a <a href="https://man.freebsd.org/cgi/man.cgi?query=sysinstall&amp;sektion=8&amp;format=html">sysinstall(8)</a> segítségével állományrendszereket telepítünk, nem szabad figyelmen kívül hagynunk a tényt, hogy a merevlemezes egységekben a külsõ sávokból gyorsabban lehet hozzáférni az adatokhoz, mint a belsõkbõl. Emiatt a kisebb és gyakrabban elérni kívánt állományrendszereket a meghajtó lemezének külsejéhez közel kell létrehozni, míg például a <span class=filename>/usr</span> partícióhoz hasonló nagyobb partíciókat annak belsõ része felé. A partíciókat a következõ sorrendben érdemes kialakítani: gyökér (rendszerindító), lapozóállomány, <span class=filename>/var</span> és <span class=filename>/usr</span>.</p></div><div class=paragraph><p>A <span class=filename>/var</span> méretének tükröznie kell a számítógép szándékolt használatát. A <span class=filename>/var</span> partíción foglalnak helyet a felhasználók postaládái, a naplóállományok és a nyomtatási sorok. A postaládák és a naplóállományok egészen váratlan mértékben is képesek megnövekedni attól függõen, hogy mennyi felhasználónk van a rendszerben és hogy mekkora naplókat tartunk meg. Itt a legtöbb felhasználónak soha nem lesz szüksége egy gigabyte-nál több helyre.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Bizonyos esetekben a <span class=filename>/var/tmp</span> könyvtárban azért ennél több tárterület szükségeltetik. Amikor a <a href="https://man.freebsd.org/cgi/man.cgi?query=pkg_add&amp;sektion=1&amp;format=html">pkg_add(1)</a> segítségével egy friss szoftvert telepítünk a rendszerünkre, akkor a program a <span class=filename>/var/tmp</span> könyvtárba tömöríti ki a hozzá tartozó csomag tartalmát. Ezért a nagyobb szoftvercsomagok, mint például a Firefox vagy az OpenOffice esetén gondok merülhetnek fel, ha nem rendelkezünk elegendõ szabad területtel a <span class=filename>/var/tmp</span> könyvtárban.</p></div></td></tr></tbody></table></div><div class=paragraph><p>A <span class=filename>/usr</span> partíció tartalmaz számos, a rendszer mûködéséhez elengedhetetlenül fontos állományt, többek közt a portok gyûjteményét (ajánlott, lásd <a href="https://man.freebsd.org/cgi/man.cgi?query=ports&amp;sektion=7&amp;format=html">ports(7)</a>) és a forráskódot (választható). A portok és az alaprendszer forrásai telepítés során választhatóak, de telepítésük esetén akkor ezen a partíción legalább két gigabyte-nyi hely ajánlott.</p></div><div class=paragraph><p>Vegyük figyelembe a tárbeli igényeket, amikor megválasztjuk a partíciók méretét. Igen kellemetlen lehet, amikor úgy futunk ki az egyik partíción a szabad helybõl, hogy a másikat alig használjuk.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Egyes felhasználók szerint elõfordulhat, hogy a <a href="https://man.freebsd.org/cgi/man.cgi?query=sysinstall&amp;sektion=8&amp;format=html">sysinstall(8)</a> <code>Auto-defaults</code> opciója a <span class=filename>/var</span> és <span class=filename>/</span> partíciók méretét túl kicsire választja. Particionáljunk okosan és nagylelkûen!</p></div></td></tr></tbody></table></div></div><div class=sect4><h5 id=swap-design>11.2.1.2. A lapozóállomány partíciója<a class=anchor href=#swap-design></a></h5><div class=paragraph><p>Általános szabály, hogy a lapozóállományt tároló partíció mérete legyen a rendszer fizikai memóriájának (RAM) kétszerese. Például, ha a számítógépünk 128 megabyte memóriával rendelkezik, akkor a lapozóállomány méretének 256 megabyte-nak kell lennie. Az ennél kevesebb memóriát maguknak tudó rendszerek több lapozóállománnyal jobban teljesítenek. 256 megabyte-nál kevesebb lapozóállományt semmiképpen sem ajánlunk, és inkább a fizikai memóriát érdemes bõvítenünk. A rendszermag virtuális memóriát kezelõ lapozási algoritmusait úgy állították be, hogy abban az esetben teljesítsenek a legjobban, ha a lapozóállomány mérete legalább kétszerese a központi memória mennyiségének. A túl kicsi lapozóállomány beállítása rontja a virtuális memória lapkeresésési rutinjának hatékonyságát és a memória bõvítése esetén még további gondokat is okozhat.</p></div><div class=paragraph><p>A több SCSI-lemezzel (vagy a különbözõ vezérlõkre csatlakoztatott több IDE-lemezzel) bíró nagyobb rendszerek esetében érdemes minden egyes (de legfeljebb négy) meghajtóra beállítani lapozóállományt. A lapozóállományoknak közel azonos méretûnek kell lenniük. A rendszermag tetszõleges méretûeket képes kezelni, azonban a belsejében alkalmazott adatszerkezetek a legnagyobb lapozóállomány méretének négyszereséig képesek növekedni. Ha a lapozóállományokat nagyjából ugyanazon a méreten tartjuk, akkor a rendszermag képes lesz a lapozáshoz felhasznált területet optimálisan elosztani a lemezek között. A nagyobb lapozóállományok használata még akkor is jól jön, ha nem is használjuk annyira. Segítségével sokkal könnyebben talpra tudunk állni egy elszabadult program tombolásából, és nem kell rögtön újraindítanunk a rendszert.</p></div></div><div class=sect4><h5 id=_miért_particionáljunk>11.2.1.3. Miért particionáljunk?<a class=anchor href=#_miért_particionáljunk></a></h5><div class=paragraph><p>Egyes felhasználók úgy gondolják, hogy egyetlen nagyobb méretû partíció mindenre megfelel, ám ez a gondolat több okból is helytelennek tekinthetõ. Elõször is, minden egyes partíciónak eltér a mûködési jellemzõje, és különválasztásukkal lehetõvé válik az állományrendszerek megfelelõ behangolása. Például a rendszerindításhoz használt és a <span class=filename>/usr</span> partíciókat többségében csak olvasásra használják, és nem sokat írnak rájuk. Eközben a <span class=filename>/var</span> és <span class=filename>/var/tmp</span> könyvtárakban zajlik az írások és olvasások túlnyomó része.</p></div><div class=paragraph><p>A rendszer megfelelõ felosztásával a kisebb, intenzívebben írt partíciókon megjelenõ töredezettség nem szivárog át a többségében csak olvasásra használt partíciókra. Ha a sokat írt partíciókat közel tartjuk a lemez széléhez, akkor azokon a partíciókon növekszik az I/O teljesítménye, ahol az a leggyakrabban megjelenik. Mivel mostanság az I/O teljesítményére inkább a nagyobb partíciók esetén van szükség, azzal nem érünk el ebben különösebb mértékû növekedést, ha a <span class=filename>/var</span> partíciót a lemez szélére toljuk. Befejezésképpen hozzátesszük, hogy ennek vannak biztonsági megfontolásai is. Egy kisebb és takarosabb rendszerindító partíció, ami többnyire írásvédett, nagyobb eséllyel él túl egy csúfos rendszerösszeomlást.</p></div></div></div></div><div class=sect2><h3 id=configtuning-core-configuration>11.3. A mag beállítása<a class=anchor href=#configtuning-core-configuration></a></h3><div class=paragraph><p>A rendszer beállításaira vonatkozó információk központi lelõhelye az <span class=filename>/etc/rc.conf</span> állomány. Ez az állomány tartalmazza a beállításokra vonatkozó adatok széles körét, amelyet elsõsorban a rendszer indulása során a rendszer beállítására használnak. Erre a neve is utal: ez az <span class=filename>rc*</span> állományok konfigurációs állománya.</p></div><div class=paragraph><p>A rendszergazda az <span class=filename>rc.conf</span> állományban tudja felülbírálni az <span class=filename>/etc/defaults/rc.conf</span> állományban szereplõ alapértelmezett beállításokat. Az alapértelmezéseket tartalmazó állományt nem szabad közvetlenül átmásolni az <span class=filename>/etc</span> könyvtárba, hiszen alapértelmezett értékeket tartalmaz, nem pedig mintákat. Minden rendszerfüggõ beállítást magában az <span class=filename>rc.conf</span> állományban kell elvégezni.</p></div><div class=paragraph><p>Számos stratégia létezik a tömegesen adminisztrált számítógépeknél a közös és rendszerfüggõ beállítások különválasztására, ezáltal a karbantartási költségek csökkentésére. A közös beállításokat ajánlott egy másik helyre, például az <span class=filename>/etc/rc.conf.site</span> állományba rakni, majd hivatkozni erre a kizárólag csak rendszerfüggõ információkat tartalmazó <span class=filename>/etc/rc.conf</span> állományból.</p></div><div class=paragraph><p>Mivel az <span class=filename>rc.conf</span> állományt az <a href="https://man.freebsd.org/cgi/man.cgi?query=sh&amp;sektion=1&amp;format=html">sh(1)</a> dolgozza fel, ezt elég könnyen el tudjuk érni. Például:</p></div><div class=ulist><ul><li><p>rc.conf:</p><div class="literalblock programlisting"><div class=content><pre>	. /etc/rc.conf.site
	hostname=&#34;node15.example.com&#34;
	network_interfaces=&#34;fxp0 lo0&#34;
	ifconfig_fxp0=&#34;inet 10.1.1.1&#34;</pre></div></div></li><li><p>rc.conf.site:</p><div class="literalblock programlisting"><div class=content><pre>	defaultrouter=&#34;10.1.1.254&#34;
	saver=&#34;daemon&#34;
	blanktime=&#34;100&#34;</pre></div></div></li></ul></div><div class=paragraph><p>Az <span class=filename>rc.conf.site</span> állomány ezt követõen az <code>rsync</code> parancs használatával már szétszórható a rendszerben, miközben az <span class=filename>rc.conf</span> állomány mindenkinél egyedi marad.</p></div><div class=paragraph><p>Ha a rendszert a <a href="https://man.freebsd.org/cgi/man.cgi?query=sysinstall&amp;sektion=8&amp;format=html">sysinstall(8)</a> vagy a <code>make world</code> használatával frissítjük, akkor az <span class=filename>rc.conf</span> tartalma nem íródik felül, így a rendszer beállításairól szóló adatok nem vesznek el.</p></div></div><div class=sect2><h3 id=configtuning-appconfig>11.4. Az alkalmazások beállítása<a class=anchor href=#configtuning-appconfig></a></h3><div class=paragraph><p>A telepített alkalmazások általában saját konfigurációs állományokkal, azok pedig saját formátummal stb. rendelkeznek. Fontos, hogy ezeket az állományokat az alaprendszertõl elkülönítve tároljuk, ezáltal a csomagkezelõ eszközök könnyen rájuk tudjanak találni és dolgozni velük.</p></div><div class=paragraph><p>Ezeket az állományokat általában a <span class=filename>/usr/local/etc</span> könyvtárban találjuk meg. Amennyiben egy alkalmazáshoz több konfigurációs állomány is tartozik, akkor ahhoz ezen belül egy külön alkönyvtár jön létre.</p></div><div class=paragraph><p>Normális esetben, amikor egy portot vagy csomagot telepítünk, minta konfigurációs állományokat is kapunk. Ezek nevében többnyire a <span class=filename>.default</span> utótag szerepel. Ha még nincs konfigurációs állomány az adott alkalmazáshoz, akkor a <span class=filename>.default</span> jelzésû állományokból ez létrehozható.</p></div><div class=paragraph><p>Példaképpen most tekintsük a <span class=filename>/usr/local/etc/apache</span> könyvtár tartalmát:</p></div><div class=literalblock><div class=content><pre>-rw-r--r--  1 root  wheel   2184 May 20  1998 access.conf
-rw-r--r--  1 root  wheel   2184 May 20  1998 access.conf.default
-rw-r--r--  1 root  wheel   9555 May 20  1998 httpd.conf
-rw-r--r--  1 root  wheel   9555 May 20  1998 httpd.conf.default
-rw-r--r--  1 root  wheel  12205 May 20  1998 magic
-rw-r--r--  1 root  wheel  12205 May 20  1998 magic.default
-rw-r--r--  1 root  wheel   2700 May 20  1998 mime.types
-rw-r--r--  1 root  wheel   2700 May 20  1998 mime.types.default
-rw-r--r--  1 root  wheel   7980 May 20  1998 srm.conf
-rw-r--r--  1 root  wheel   7933 May 20  1998 srm.conf.default</pre></div></div><div class=paragraph><p>Az állományok mérete jól mutatja, hogy csak az <span class=filename>srm.conf</span> változott meg. Az Apache késõbbi frissítései ezt az állományt nem fogják felülírni.</p></div></div><div class=sect2><h3 id=configtuning-starting-services>11.5. Szolgáltatások indítása<a class=anchor href=#configtuning-starting-services></a></h3><div class=paragraph><p>A felhasználók közül sokan választják a FreeBSD Portgyûjteményében található külsõ szoftverek telepítését. A telepített szoftvert ilyenkor gyakran úgy kell beállítani, hogy a rendszer indulásával együtt induljon. Az olyan szolgáltatások, mint például a <a class=package href=https://cgit.freebsd.org/ports/tree/mail/postfix/>mail/postfix</a> vagy a <a class=package href=https://cgit.freebsd.org/ports/tree/www/apache13/>www/apache13</a> csupán két olyan szoftvercsomag, amelyet a rendszerrel együtt kell elindítani. Ebben a szakaszban a külsõ szoftverek indítására használatos eljárásokkal foglalkozunk.</p></div><div class=paragraph><p>A FreeBSD-ben megjelenõ legtöbb szolgáltatás, mint például a <a href="https://man.freebsd.org/cgi/man.cgi?query=cron&amp;sektion=8&amp;format=html">cron(8)</a>, a rendszerindító szkripteken keresztül kel életre. Habár ezek a szkriptek a FreeBSD egyes verziói vagy az egyes gyártók esetén különbözhetnek, azonban az mindegyikükben közös, hogy az elindításukra vonatkozó beállítások egyszerû indítószkriptekkel adhatóak meg.</p></div><div class=sect3><h4 id=_az_alkalmazások_részletesebb_beállítása>11.5.1. Az alkalmazások részletesebb beállítása<a class=anchor href=#_az_alkalmazások_részletesebb_beállítása></a></h4><div class=paragraph><p>Most miután a FreeBSD rendelkezik egy <span class=filename>rc.d</span> könyvtárral, az alkalmazások indításának beállítása is könnyebbé és ügyesebbé vált. Az <a href=#configtuning-rcd>rc.d</a> mûködésérõl szóló szakaszban megismert kulcsszavak segítségével az alkalmazások mostantól kezdve a többi szolgáltatás, például a DNS után indulnak el, és az <span class=filename>rc.conf</span> állományon keresztül a szkriptekbe huzalozottak helyett most már tetszõleges paramétereket is átadhatunk stb. Egy egyszerû szkript ehhez hasonlóan néz ki:</p></div><div class="literalblock programlisting"><div class=content><pre>#!/bin/sh
#
# PROVIDE: utility
# REQUIRE: DAEMON
# KEYWORD: shutdown

. /etc/rc.subr

name=utility
rcvar=utility_enable

command=&#34;/usr/local/sbin/utility&#34;

load_rc_config $name

#
# NE VÁLTOZTASSUK MEG AZ ITT LÉVõ ALAPÉRTELMEZÉSEKET,
# INKÁBB AZ /etc/rc.conf ÁLLOMÁNYBAN ÁLLÍTSUK BE EZEKET
#
utility_enable=${utility_enable-&#34;NO&#34;}
pidfile=${utility_pidfile-&#34;/var/run/utility.pid&#34;}

run_rc_command &#34;$1&#34;</pre></div></div><div class=paragraph><p>Ez a szkript gondoskodik arról, hogy a utility nevû alkalmazás a <code>DAEMON</code> szolgáltatás után induljon el. Emellett még felkínál egy módszert a PID avagy futó programok azonosítójának beállítására és nyomonkövetésére is.</p></div><div class=paragraph><p>Ezt követõen az <span class=filename>/etc/rc.conf</span> állományból az alkalmazás elindítható az alábbi sor hozzáadásával:</p></div><div class="literalblock programlisting"><div class=content><pre>utility_enable=&#34;YES&#34;</pre></div></div><div class=paragraph><p>Ez a módszer megkönnyíti a parancssorban átadott paraméterek módosítását, az <span class=filename>/etc/rc.subr</span> állományban szereplõ alapértelmezett függvények használatát, az <a href="https://man.freebsd.org/cgi/man.cgi?query=rcorder&amp;sektion=8&amp;format=html">rcorder(8)</a> segédprogrammal szembeni kompatibilitást és az <span class=filename>rc.conf</span> állomány könnyebb beállítását.</p></div></div><div class=sect3><h4 id=_szolgáltatások_indítása_szolgáltatásokkal>11.5.2. Szolgáltatások indítása szolgáltatásokkal<a class=anchor href=#_szolgáltatások_indítása_szolgáltatásokkal></a></h4><div class=paragraph><p>Más szolgáltatások, mint például a POP3 vagy IMAP szerverek démonai stb. az <a href="https://man.freebsd.org/cgi/man.cgi?query=inetd&amp;sektion=8&amp;format=html">inetd(8)</a> segítségével indíthatóak el. Ez a Portgyûjteménybõl telepített szolgáltatások esetén magával vonja az adott segédprogram felvételét vagy a hozzá tartozó sor engedélyezését az <span class=filename>/etc/inetd.conf</span> állományban. Az inetd mûködésével és annak beállításával mélyrehatóbban az <a href=./#network-inetd>inetd</a> szakasza foglalkozik.</p></div><div class=paragraph><p>A legtöbb esetben a <a href="https://man.freebsd.org/cgi/man.cgi?query=cron&amp;sektion=8&amp;format=html">cron(8)</a> démon használata kézenfekvõ a rendszerszintû szolgáltatások elindításában. Ez a megközelítés számos elõnyt tartogat, mivel a <code>cron</code> ezeket a programokat a felhasználó <span class=filename>crontab</span> állománya alapján futtatja. Ezzel a mezei felhasználók számára is lehetõvé válik, hogy elindítsanak és karbantartsanak alkalmazásokat.</p></div><div class=paragraph><p>A <code>cron</code> segédprogramnak van egy olyan speciális lehetõsége, hogy az idõ helyett a <code>@reboot</code> értéket adhatjuk meg. Ennek hatására a feladat a <a href="https://man.freebsd.org/cgi/man.cgi?query=cron&amp;sektion=8&amp;format=html">cron(8)</a> indításával együtt fut le, tehát megszokott esetben a rendszer indítása során.</p></div></div></div><div class=sect2><h3 id=configtuning-cron>11.6. A <code>cron</code> segédprogram beállítása<a class=anchor href=#configtuning-cron></a></h3><div class=paragraph><p>A <a href="https://man.freebsd.org/cgi/man.cgi?query=cron&amp;sektion=8&amp;format=html">cron(8)</a> a FreeBSD egyik leghasznosabb segédprogramja. A <code>cron</code> segédprogram a háttérben fut és folyamatosan figyeli az <span class=filename>/etc/crontab</span> állományt. Emellett a <code>cron</code> új <span class=filename>crontab</span> állományok után kutatva folyamatosan ellenõrzi a <span class=filename>/var/cron/tabs</span> könyvtárat. Ezek a <span class=filename>crontab</span> állományok olyan feladatokról tárolnak adatokat, amelyeket a <code>cron</code> programnak egy adott pillanatban el kell végeznie.</p></div><div class=paragraph><p>A <code>cron</code> a konfigurációs állományok két külön fajtáját, a rendszer- és felhasználói crontabokat használja. A két típus között levõ egyetlen különbség a hatodik mezõben található. A rendszerszintû crontabok esetében a hatodik mezõ annak a felhasználónak a nevét tartalmazza, amivel a program fut. Ezzel a rendszer szintjén mûködõ crontaboknak megadatott az a képesség, hogy tetszõleges felhasználó nevében futtassanak programokat. A felhasználók crontabjaiban a hatodik mezõ a futtatandó parancsot tartalmazza, és ilyenkor az összes parancs a crontabot létrehozó felhasználó nevében hajtódik végre. Ez utóbbi egy fontos biztonsági jellemzõ.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>A felhasználói crontabok lehetõvé teszik az egyes felhasználók számára, hogy a <code>root</code> felhasználó jogosultságai nélkül képesek legyenek feladatokat ütemezni, ugyanis a felhasználóhoz tartozó crontabban szereplõ parancsok mindegyike a tulajdonosának engedélyeivel fut.</p></div><div class=paragraph><p>Az átlagos felhasználókhoz hasonlóan a <code>root</code> felhasználónak is lehet crontabja, ami nem ugyanaz, mint az <span class=filename>/etc/crontab</span> (a rendszer saját crontab állománya). De mivel a rendszernek külön crontabja van, ezért a <code>root</code> felhasználónak nem kell külön crontabot létrehozni.</p></div></td></tr></tbody></table></div><div class=paragraph><p>Vessünk egy pillanatást az <span class=filename>/etc/crontab</span> (a rendszer crontabjának) tartalmára:</p></div><div class="literalblock programlisting"><div class=content><pre># /etc/crontab - a root crontabja FreeBSD alatt
#
# $FreeBSD: src/etc/crontab,v 1.32 2002/11/22 16:13:39 tom Exp $
#<i class=conum data-value=1></i><b>(1)</b>
#
SHELL=/bin/sh
PATH=/etc:/bin:/sbin:/usr/bin:/usr/sbin <i class=conum data-value=2></i><b>(2)</b>
HOME=/var/log
#
#
#minute	hour	day	month	wday	who	command <i class=conum data-value=3></i><b>(3)</b>
#
#
*/5	*	*	*	*	root	/usr/libexec/atrun <i class=conum data-value=4></i><b>(4)</b></pre></div></div><div class="colist arabic"><table><tbody><tr><td><i class=conum data-value=1></i><b>1</b></td><td>A FreeBSD legtöbb konfigurációs állományához hasonlóan itt is a <code>#</code> jelöli a megjegyzéseket. Az ilyen megjegyzések remekül használhatóak annak feljegyzésére, hogy mit és miért akarunk futtatni. A megjegyzések azonban nem szerepelhetnek a paranccsal egy sorban, mivel máskülönben a parancs részeként kerülnek értelmezésre. Tehát mindig új sorba kell raknunk ezeket. Az üres sorokat a program nem veszi figyelembe.</td></tr><tr><td><i class=conum data-value=2></i><b>2</b></td><td>Elõször is meg kell adnunk egy környezetet. Az egyenlõség (<code>=</code>) karakter használatos a környezeti beállítások meghatározására, ahogy mindezt az itteni példában is tapasztalhatjuk a <code>SHELL</code>, <code>PATH</code> és <code>HOME</code> értékek esetében. Ha nem adunk meg mást, akkor a <code>cron</code> az alapértelmezés szerinti <code>sh</code> parancsértelmezõt használja. Ha nem adjuk meg a <code>PATH</code> változó értékét, akkor minden állományra abszolút elérési úttal kell hivatkoznunk, mivel ennek nincs alapértelmezett értéke. Ha nem definiáljuk a <code>HOME</code> változó értékét, akkor a <code>cron</code> a parancshoz tartozó felhasználó könyvtárából fog dolgozni.</td></tr><tr><td><i class=conum data-value=3></i><b>3</b></td><td>Ez a sor írja le a megadható hét mezõt. Az itt szereplõ értékek a <code>minute</code> (perc), <code>hour</code> (óra), <code>mday</code> (a hónap napja), <code>month</code> (hónap), <code>wday</code> (a hét napja), <code>who</code> (ki) és <code>command</code> (mit). A mezõk szinte maguktól értetõdnek. A <code>minute</code> egy órán belül adja meg azokat a perceket, amikor az adott parancsot le kell futtatni. A <code>hour</code> hasonló a <code>minute</code> beállításhoz, csak az itt szereplõ értékét órákban kell értelmezni. Az <code>mday</code> a hónap napjaiban számol. A <code>month</code> hasonló a <code>minute</code> és <code>hour</code> opciókhoz, de ez hónapot jelöl. A <code>wday</code> a hét egy napját jelzi. Ezeknek a mezõknek numerikus, valamint a huszonnégy órás idõformátumnak megfelelõ értékeket kell tartalmazniuk. A <code>who</code> mezõ, a többiektõl eltérõ módon, csak az <span class=filename>/etc/crontab</span> állományban jelenik meg. Ez a mezõ adja meg, hogy a parancsot milyen felhasználóval kell futtatni. Ez az opció nem jelenik meg a felhasználók saját <span class=filename>crontab</span> állományainak telepítésekor. A sor végén láthatjuk még a <code>command</code> oszlopot is. Ez az utolsó mezõ, és ide kerül a végrehajtandó parancs.</td></tr><tr><td><i class=conum data-value=4></i><b>4</b></td><td>Ez az utolsó sor a fentebb tárgyalt értékeket határozza meg. Észrevehetjük, hogy a sor egy <code><strong>/5</strong></code><strong> alakú felírással kezdõdik, amelyet további <code></code></strong> karakterek követnek. A <code>*</code> karakterek jelentése "elsõ-utolsó", ami arra utal, hogy <em>mindig</em>. Ennek megfelelõen úgy értelmezhetjük ezt a sort, hogy a <code>root</code> felhasználóval le kell futtatni az <code>atrun</code> parancsot minden ötödik percben, függetlenül attól, hogy milyen nap vagy hónap van. Az <code>atrun</code> parancsról részletesebban az <a href="https://man.freebsd.org/cgi/man.cgi?query=atrun&amp;sektion=8&amp;format=html">atrun(8)</a> man oldalán kapunk felvilágosítást.Az itt szereplõ parancsoknak tetszõleges mennyiségû paraméter adható át, azonban a több soron keresztül átívelõ parancsok tördelését a sor végén a "\" karakterrel kell jelezni.</td></tr></tbody></table></div><div class=paragraph><p>Ez mindegyik <span class=filename>crontab</span> állomány alapbeállítása, habár ettõl általában egy dologban eltérnek. A hatodik mezõ, ahol a felhasználót adtuk meg, csak a rendszer <span class=filename>/etc/crontab</span> állományában jelenik meg. Ez a mezõ a felhasználók <span class=filename>crontab</span> állományaiból kimarad.</p></div><div class=sect3><h4 id=configtuning-installcrontab>11.6.1. Egy crontab telepítése<a class=anchor href=#configtuning-installcrontab></a></h4><div class="admonitionblock important"><table><tbody><tr><td class=icon><i class="fa icon-important" title=Important></i></td><td class=content><div class=paragraph><p>Nem kötelezõ az itt ismertetésre kerülõ módon szerkeszteni vagy telepíteni a rendszer crontabját. Egyszerûen nyissuk meg a kedvenc szövegszerkesztõnkkel, és a <code>cron</code> segédprogram majd észreveszi, hogy az állomány megváltozott, majd ennek megfelelõen neki is lát a módosított változat használatának. Errõl <a href=https://docs.freebsd.org/hu/books/faq/#ROOT-NOT-FOUND-CRON-ERRORS>a GYIK-ban (angolul)</a> többet is megtudhatunk.</p></div></td></tr></tbody></table></div><div class=paragraph><p>Egy frissen készített felhasználói <span class=filename>crontab</span> telepítéséhez elõször a kedvenc szövegszerkesztõnk segítségével létre kell hoznunk a megfelelõ formátumú állományt, majd használnunk a <code>crontab</code> segédprogramot. Ennek általános alakja:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>% crontab crontab_állomány</code></pre></div></div><div class=paragraph><p>Ebben a példában a <span class=filename>crontab_állomány</span> a korábban létrehozott <span class=filename>crontab</span> neve lesz.</p></div><div class=paragraph><p>Lehetõségünk van lekérdezni a telepített <span class=filename>crontab</span> állományokat: egyszerûen adjuk át a <code>-l</code> kapcsolót a <code>crontab</code> parancsnak, és nézzük meg, mit ad vissza.</p></div><div class=paragraph><p>A <code>crontab -e</code> használata olyan felhasználók számára ajánlott, akik sablon alkalmazása nélkül szeretnének teljesen maguktól megírni egy crontab állományt. Ennek hatására a kiválasztott szövegszerkesztõ egy üres állományt kap. Miután ezt az állományt elmentettük, a <code>crontab</code> programmal magától telepítésre kerül.</p></div><div class=paragraph><p>Ha a késõbbiekben törölni akarjuk a felhasználónkhoz tartozó <span class=filename>crontab</span> állományt, akkor erre a célra használjuk a <code>crontab -r</code> kapcsolóját.</p></div></div></div><div class=sect2><h3 id=configtuning-rcd>11.7. Az rc használata FreeBSD alatt<a class=anchor href=#configtuning-rcd></a></h3><div class=paragraph><p>A rendszer indítására a FreeBSD 2002-ben átvette a NetBSD <span class=filename>rc.d</span> rendszerét. Ezt a felhasználók könnyen felismerhetik az <span class=filename>/etc/rc.d</span> könyvtárban található állományokról. A legtöbbjük olyan alapvetõ szolgáltatás, amelyet a <code>start</code>, <code>stop</code> és <code>restart</code> paraméterekkel lehet vezérelni. Például az <a href="https://man.freebsd.org/cgi/man.cgi?query=sshd&amp;sektion=8&amp;format=html">sshd(8)</a> az alábbi paranccsal indítható újra:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># /etc/rc.d/sshd restart</span></code></pre></div></div><div class=paragraph><p>Ez az eljárás hasonló a többi szolgáltatás esetén is. Természetesen ezek a szolgáltatások általában maguktól indulnak el a rendszer indítása során az <a href="https://man.freebsd.org/cgi/man.cgi?query=rc.conf&amp;sektion=5&amp;format=html">rc.conf(5)</a> állományban megadottak szerint. Például ha a rendszerünk indulásakor szeretnénk aktiválni a hálózati címfordítással foglalatoskodó démont, akkor csak adjuk hozzá az <span class=filename>/etc/rc.conf</span> állományhoz a következõ sort:</p></div><div class="literalblock programlisting"><div class=content><pre>natd_enable=&#34;YES&#34;</pre></div></div><div class=paragraph><p>Amennyiben a <code>natd_enable="NO"</code> sor már szerepel benne, akkor egyszerûen írjuk át a <code>NO</code> értéket <code>YES</code>-re. Ezután az rc szkriptek a rendszer következõ indításakor a lentieknek megfelelõen automatikusan elindítják a hozzá tartozó szolgáltatásokat is.</p></div><div class=paragraph><p>Mivel az <span class=filename>rc.d</span> rendszert elsõsorban arra használják, hogy szolgáltatásokat indítsanak el vagy állítsanak le az operációs rendszerrel együtt, a szabványos <code>start</code>, <code>stop</code> és <code>restart</code> paraméterek csak abban az esetben látják el a feladatukat, ha a nekik megfelelõ változókat beállítottuk az <span class=filename>/etc/rc.conf</span> állományban. Tehát például az <code>sshd restart</code> csak abban az esetben fog bármit is csinálni, ha az <span class=filename>/etc/rc.conf</span> állományban az <code>sshd_enable</code> változót a <code>YES</code> értékre állítottuk. Ha az <span class=filename>/etc/rc.conf</span> beállításaitól függetlenül kívánunk egy szolgáltatásnak <code>start</code>, <code>stop</code> vagy <code>restart</code> parancsot adni, akkor elé kell tennünk egy "one" szót. Például ha az <code>sshd</code> szolgáltatás újraindításához az <span class=filename>/etc/rc.conf</span> tartalmát figyelmen kívül akarjuk hagyni, akkor ezt a parancsot kell kiadnunk:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># /etc/rc.d/sshd onerestart</span></code></pre></div></div><div class=paragraph><p>Könnyen ellenõrizni tudjuk, hogy az adott szolgáltatás az <span class=filename>/etc/rc.conf</span> részérõl engedélyezett-e, ha a neki megfelelõ <span class=filename>rc.d</span> szkriptnek megadjuk az <code>rcvar</code> paramétert. Ennek segítségével például a rendszergazda így képes ellenõrizni, hogy az <code>sshd</code> szolgáltatást engedélyezi-e az <span class=filename>/etc/rc.conf</span>:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># /etc/rc.d/sshd rcvar</span>
<span class=c># sshd</span>
<span class=nv>$sshd_enable</span><span class=o>=</span>YES</code></pre></div></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>A második sor (<code># sshd</code>) az <code>sshd</code> parancs kimenete, nem pedig a <code>root</code> parancssora.</p></div></td></tr></tbody></table></div><div class=paragraph><p>A <code>status</code> paraméterrel kideríthetjük, hogy egy szolgáltatás aktív-e. Ezzel például így tudjuk ellenõrizni az <code>sshd</code> szolgáltatás mûködését:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># /etc/rc.d/sshd status</span>
sshd is running as pid 433.</code></pre></div></div><div class=paragraph><p>Az üzenet:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>Az sshd a 433-as azonosítóval fut.</code></pre></div></div><div class=paragraph><p>Bizonyos esetekben a <code>reload</code> paraméter használatával lehetõségünk van a szolgáltatások újraindítására is. Ilyenkor a rendszer megpróbál egy olyan jelzést küldeni a szolgáltatásnak, amivel a konfigurációs állományainak újraolvasását kéri. A legtöbbször lényegében ez a <code>SIGHUP</code> jelzés kiküldését rejti magában. Ez a lehetõség azonban nem mindegyik szolgáltatás esetén érhetõ el.</p></div><div class=paragraph><p>Az <span class=filename>rc.d</span> rendszer nem csupán hálózati szolgáltatások esetén használatos, hanem nagyrészben hozzájárul a rendszer indításához is. Erre vegyük példának a <span class=filename>bgfsck</span> állományt. Amikor ez a szkript lefut, a következõ üzenetet jeleníti meg:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>Starting background file system checks <span class=k>in </span>60 seconds.</code></pre></div></div><div class=paragraph><p>Az üzenet fordítása:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>A háttérben 60 másodperc múlva megkezdõdik az állományrendszerek ellenõrzése.</code></pre></div></div><div class=paragraph><p>Ennek megfelelõen tehát ezt az állományt az állományrendszerek háttérben folyó ellenõrzésére használják, ami pedig a rendszer indítása során fut le.</p></div><div class=paragraph><p>Számos rendszerszolgáltatás igényel a mûködéséhez további szolgáltatásokat. Például a NIS és más egyéb távoli eljáráshíváson alapú szolgáltatások egészen addig nem képesek elindulni, amíg az <code>rpcbind</code> (portmapper) szolgáltatást el nem indítjuk. Az ilyen jellegû gondok feloldására az indítószkriptek elején levõ megjegyzésekben található egy kevés metainformáció a szkript mûködéséhez szükséges elemekre (függõségeire) vonatkozóan. A rendszer indítása közben az <a href="https://man.freebsd.org/cgi/man.cgi?query=rcorder&amp;sektion=8&amp;format=html">rcorder(8)</a> nevû program képes a megjegyzések közt ezeket az információkat feldolgozni és ebbõl megállapítani, hogy a függõségi viszonyok betartásával milyen sorrendben kell elindítani a rendszer által felkínált szolgáltatásokat.</p></div><div class=paragraph><p>Ehhez a következõ kulcsszavakat kell megadni az egyes indító szkriptek elején (az <a href="https://man.freebsd.org/cgi/man.cgi?query=rc.subr&amp;sektion=8&amp;format=html">rc.subr(8)</a> így tudja "engedélyezni" az indító szkriptet):</p></div><div class=ulist><ul><li><p><code>PROVIDE</code>: segítségével megmondjuk, hogy ez az állomány milyen szolgáltatásokat nyújt.</p></li></ul></div><div class=paragraph><p>A következõ kulcsszavak az egyes indítóállományok elején szerepelhetnek. Nem kell feltétlenül használnunk ezeket, de velük az <a href="https://man.freebsd.org/cgi/man.cgi?query=rcorder&amp;sektion=8&amp;format=html">rcorder(8)</a> munkáját segíthetjük:</p></div><div class=ulist><ul><li><p><code>REQUIRE</code>: felsoroljuk azokat a szolgáltatásokat, amelyek a futásához kellenek. Az állomány tehát az itt megadott szolgáltatások <em>után</em> fog lefutni.</p></li><li><p><code>BEFORE</code>: felsoroljuk azokat a szolgáltatásokat, amelyek <em>elõtt</em> futtatni kell ezt az állományt.</p></li></ul></div><div class=paragraph><p>Az indító szkriptekben a kulcsszavak ügyes megválasztásával a rendszergazda nagyon finoman képes az indításkor végrehajtódó szkriptek sorrendjét szabályozni és a többi UNIX® alapú operációs rendszerbõl ismert "futtatási szintek" használata nélkül vezérelni a rendszerben megjelenõ szolgáltatásokat.</p></div><div class=paragraph><p>Az <span class=filename>rc.d</span> rendszerrõl bõvebben az <a href="https://man.freebsd.org/cgi/man.cgi?query=rc&amp;sektion=8&amp;format=html">rc(8)</a> és <a href="https://man.freebsd.org/cgi/man.cgi?query=rc.subr&amp;sektion=8&amp;format=html">rc.subr(8)</a> man oldalakon olvashatunk. Ha szeretnénk saját <span class=filename>rc.d</span> szkripteket írni vagy javítani a már meglévõkön, akkor ez <a href=https://docs.freebsd.org/en/articles/rc-scripting/>a cikk</a> (angolul) segítségünkre lehet.</p></div></div><div class=sect2><h3 id=config-network-setup>11.8. A hálózati kártyák beállítása<a class=anchor href=#config-network-setup></a></h3><div class=paragraph><p>Manapság már el sem tudunk képzelni számítógépet hálózati csatlakozás nélkül. A hálózati csatolókártyák hozzáadása és beállítása egy FreeBSD rendszergazda mindennapos feladata.</p></div><div class=sect3><h4 id=_a_megfelelõ_meghajtóprogram_felderítése>11.8.1. A megfelelõ meghajtóprogram felderítése<a class=anchor href=#_a_megfelelõ_meghajtóprogram_felderítése></a></h4><div class=paragraph><p>Mielõtt bárminek is nekikezdenénk, érdemes tisztában lennünk azzal, hogy a rendelkezésünkre álló kártya milyen típusú, milyen chipet használ és hogy PCI vagy ISA buszon csatlakozik-e. A FreeBSD a PCI és ISA csatolós kártyák széles spektrumát ismeri. Az egyes kiadásokhoz mellékelt "Hardware Compatibility List" (Hardverkompatibilitási lista) dokumentumokban tudjuk ellenõrizni, hogy a kártyákat ismeri a rendszer.</p></div><div class=paragraph><p>Miután meggyõzõdtünk róla, hogy a kártyánkat ismeri a rendszer, meg kell keresnünk a hozzá tartozó meghajtót. A <span class=filename>/usr/src/sys/conf/NOTES</span> és a <span class=filename>/usr/src/sys/arch/conf/NOTES</span> állományok tartalmazzák a hálózati kártyák meghajtóinak rövid leírását, benne a támogatott chipsetek és kártyák típusaival. Ha ez alapján nem tudjuk teljes biztosággal eldönteni, hogy melyik a számunkra megfelelõ meghajtó, nézzük meg a saját man oldalát. Ezen a man oldalon megtaláljuk az általa ismert összes eszközt és a velük kapcsolatban elõforduló jellemzõ problémákat.</p></div><div class=paragraph><p>Ha egy elterjedt típust sikerült beszereznünk, akkor nem kell különösebben sokáig keresnünk a neki megfelelõ meghajtót. Az ismertebb hálózati kártyák meghajtói ugyanis alapból benne vannak a <span class=filename>GENERIC</span> rendszermagban, ezért a rendszer indítása során ehhez hasonlóan meg is jelennek a kártyák:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>dc0: &lt;82c169 PNIC 10/100BaseTX&gt; port 0xa000-0xa0ff mem 0xd3800000-0xd38
000ff irq 15 at device 11.0 on pci0
miibus0: &lt;MII bus&gt; on dc0
bmtphy0: &lt;BCM5201 10/100baseTX PHY&gt; PHY 1 on miibus0
bmtphy0:  10baseT, 10baseT-FDX, 100baseTX, 100baseTX-FDX, auto
dc0: Ethernet address: 00:a0:cc:da:da:da
dc0: <span class=o>[</span>ITHREAD]
dc1: &lt;82c169 PNIC 10/100BaseTX&gt; port 0x9800-0x98ff mem 0xd3000000-0xd30
000ff irq 11 at device 12.0 on pci0
miibus1: &lt;MII bus&gt; on dc1
bmtphy1: &lt;BCM5201 10/100baseTX PHY&gt; PHY 1 on miibus1
bmtphy1:  10baseT, 10baseT-FDX, 100baseTX, 100baseTX-FDX, auto
dc1: Ethernet address: 00:a0:cc:da:da:db
dc1: <span class=o>[</span>ITHREAD]</code></pre></div></div><div class=paragraph><p>Ebben a példában láthatunk is két olyan kártyát, amelyek a <a href="https://man.freebsd.org/cgi/man.cgi?query=dc&amp;sektion=4&amp;format=html">dc(4)</a> meghajtót használják.</p></div><div class=paragraph><p>Ha a hálózati kártyánk meghajtója nem szerepel a <span class=filename>GENERIC</span> konfigurációban, akkor a mûködéséhez be kell tölteni a megfelelõ meghajtót. Ezt alapvetõen kétféleképpen érhetjük el:</p></div><div class=ulist><ul><li><p>Ennek legegyszerûbb módja, ha a <a href="https://man.freebsd.org/cgi/man.cgi?query=kldload&amp;sektion=8&amp;format=html">kldload(8)</a> használatával alkalmanként vagy a <span class=filename>/boot/loader.conf</span> állományban a megfelelõ sor hozzáadásával a rendszer indításával együtt betöltjük a hálózati kártya meghajtójához tartozó modult. Nem mindegyik hálózati kártya meghajtója érhetõ el modul formájában. Erre konkrét például szolgálnak az ISA kártyákhoz tartozó modulok.</p></li><li><p>Másik lehetõségünk, ha statikusan beépítjük a kártyánk támogatását a rendszermagba. A <span class=filename>/usr/src/sys/conf/NOTES</span> és az <span class=filename>/usr/src/sys/arch/conf/NOTES</span> állományok, valamint a meghajtóhoz tartozó man oldal elolvasásából megtudhatjuk a rendszermag beállításait tartalmazó állományban megadandó paramétereket. A rendszermag újrafordítását lásd <a href=./#kernelconfig>A FreeBSD rendszermag testreszabása</a>. Ha a rendszermag (<span class=filename>GENERIC</span>) az indulás során észlelte a kártyánkat, nem kell újat készítenünk.</p></li></ul></div><div class=sect4><h5 id=config-network-ndis>11.8.1.1. A Windows® NDIS meghajtóinak használata<a class=anchor href=#config-network-ndis></a></h5><div class=paragraph><p>Sajnos még mindig sok olyan gyártó akad, akik a nyílt forrású közösség számára nem adják ki a meghajtóik mûködésének alapjait, mivel az ilyen adatokat szakmai titoknak tekintik. Ebbõl következik, hogy a FreeBSD és más operációs rendszerek fejlesztõi számára két választás marad: vagy a gyári meghajtók visszafejtésének hosszú és fájdalmas útján haladva fejlesztik ki a saját meghajtójukat, vagy pedig a Microsoft® Windows® platformra kiadott meghajtók binárisait hasznosítják. A legtöbb fejlesztõ, köztük a FreeBSD fejlesztõi is, ez utóbbi megközelítést választották.</p></div><div class=paragraph><p>Bill Paul (wpaul) jóvoltából a FreeBSD 5.3-RELEASE változatában megjelent a "Network Driver Interface Specification" (NDIS, avagy hálózati meghajtók szabványos felülete) "natív" támogatása. A FreeBSD NDISulator (másnéven Project Evil, a Gonosz terve) nevû komponense fog egy Windows®-os meghajtót és elhiteti vele, hogy a Windows® operációs rendszerrel kommunikál. Mivel az <a href="https://man.freebsd.org/cgi/man.cgi?query=ndis&amp;sektion=4&amp;format=html">ndis(4)</a> meghajtó Windows® binárisokat használ fel, ezért csak i386 és amd64 rendszerek esetén érhetõ el.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Az <a href="https://man.freebsd.org/cgi/man.cgi?query=ndis&amp;sektion=4&amp;format=html">ndis(4)</a> meghajtó leginkább a PCI, CardBus és PCMCIA csatolójú eszközök támogatására lett kitalálva, az USB eszközöket még nem ismeri.</p></div></td></tr></tbody></table></div><div class=paragraph><p>Az NDISulator használatához három tényezõre van szükségünk:</p></div><div class="olist arabic"><ol class=arabic><li><p>A rendszermag forrása</p></li><li><p>a Windows® XP meghajtó binárisa (<span class=filename>.SYS</span> a kiterjesztése)</p></li><li><p>a Windows® XP meghajtó konfigurációs állománya (<span class=filename>.INF</span> a kiterjesztése)</p></li></ol></div><div class=paragraph><p>Keressük meg az említett állományokat az adott kártyához. Ezeket általában a mellékelt CD-n vagy a gyártó honlapján találjuk meg. A most következõ példákban a <span class=filename>W32DRIVER.SYS</span> és a <span class=filename>W32DRIVER.INF</span> neveket fogjuk használni.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>A Windows® i386 architektúrájú verziójához készült meghajtóprogramokat nem tudjuk a FreeBSD/amd64 verziójával használni. A mûködéshez amd64-re készült Windows®-os meghajtókra van szükség.</p></div></td></tr></tbody></table></div><div class=paragraph><p>A következõ lépés a meghajtó binárisainak betölthetõ modulba fordítása. Ennek eléréséhez használjuk az <a href="https://man.freebsd.org/cgi/man.cgi?query=ndisgen&amp;sektion=8&amp;format=html">ndisgen(8)</a> parancsot a <code>root</code> felhasználóval:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># ndisgen /windowsos/meghajtó/W32DRIVER.INF /windowsos/meghajtó/W32DRIVER.SYS</span></code></pre></div></div><div class=paragraph><p>Az <a href="https://man.freebsd.org/cgi/man.cgi?query=ndisgen&amp;sektion=8&amp;format=html">ndisgen(8)</a> egy interaktív segédprogram, amely mûködése közben még rákérdez néhány szükséges információra. Az aktuális könyvtárban létrehoz egy rendszermagmodult, amelyet az alábbi módon tudunk betölteni:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># kldload ./W32DRIVER_SYS.ko</span></code></pre></div></div><div class=paragraph><p>Az elõállított modul mellé be kell töltenünk még az <span class=filename>ndis.ko</span> és az <span class=filename>if_ndis.ko</span> modulokat is. Ez általában minden olyan modul esetén megtörténik magától, amely függ az <a href="https://man.freebsd.org/cgi/man.cgi?query=ndis&amp;sektion=4&amp;format=html">ndis(4)</a> használatától. Kézileg a következõ parancsokkal tudjuk ezeket betölteni:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># kldload ndis</span>
<span class=c># kldload if_ndis</span></code></pre></div></div><div class=paragraph><p>Itt az elsõ parancs betölti az NDIS miniport meghajtó burkolására szánt kódot, valamint a második a tényleges hálózati csatolófelületet.</p></div><div class=paragraph><p>Most pedig a <a href="https://man.freebsd.org/cgi/man.cgi?query=dmesg&amp;sektion=8&amp;format=html">dmesg(8)</a> kimenetében ellenõrizzük, hogy történt-e valamilyen hiba a betöltés során. Ha minden jól ment, akkor az alábbiakhoz hasonló kimenetet produkált:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>ndis0: &lt;Wireless-G PCI Adapter&gt; mem 0xf4100000-0xf4101fff irq 3 at device 8.0 on pci1
ndis0: NDIS API version: 5.0
ndis0: Ethernet address: 0a:b1:2c:d3:4e:f5
ndis0: 11b rates: 1Mbps 2Mbps 5.5Mbps 11Mbps
ndis0: 11g rates: 6Mbps 9Mbps 12Mbps 18Mbps 36Mbps 48Mbps 54Mbps</code></pre></div></div><div class=paragraph><p>Innentõl kezdve az <span class=filename>ndis0</span> nevû eszközt úgy tudjuk használni, mint bármelyik más hálózati felületet (például <span class=filename>dc0</span>).</p></div><div class=paragraph><p>A többi modulhoz hasonló módon be tudjuk állítani, hogy a rendszer indulásával együtt betöltõdjenek az NDIS modulok. Ehhez elõször másoljuk az imént létrehozott modult, az <span class=filename>W32DRIVER_SYS.ko</span> állományt a <span class=filename>/boot/modules</span> könyvtárba. Ezután adjuk hozzá a következõ sort a <span class=filename>/boot/loader.conf</span> állomány tartalmához:</p></div><div class="literalblock programlisting"><div class=content><pre>W32DRIVER_SYS_load=&#34;YES&#34;</pre></div></div></div></div><div class=sect3><h4 id=_a_hálózati_kártya_beállítása>11.8.2. A hálózati kártya beállítása<a class=anchor href=#_a_hálózati_kártya_beállítása></a></h4><div class=paragraph><p>Ahogy betöltõdött a megfelelõ meghajtó a hálózati kártyánkhoz, be is kell állítanunk a kártyát. A hálózati kártyák sok más dologgal együtt beállíthatóak a telepítés során a sysinstall segítségével.</p></div><div class=paragraph><p>A rendszerünkben beállított hálózati csatolófelületek megjelenítéséhez gépeljük be a következõ parancsot:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>% ifconfig
dc0: <span class=nv>flags</span><span class=o>=</span>8843&lt;UP,BROADCAST,RUNNING,SIMPLEX,MULTICAST&gt; metric 0 mtu 1500
        <span class=nv>options</span><span class=o>=</span>80008&lt;VLAN_MTU,LINKSTATE&gt;
        ether 00:a0:cc:da:da:da
        inet 192.168.1.3 netmask 0xffffff00 broadcast 192.168.1.255
        media: Ethernet autoselect <span class=o>(</span>100baseTX &lt;full-duplex&gt;<span class=o>)</span>
        status: active
dc1: <span class=nv>flags</span><span class=o>=</span>8843&lt;UP,BROADCAST,RUNNING,SIMPLEX,MULTICAST&gt; metric 0 mtu 1500
        <span class=nv>options</span><span class=o>=</span>80008&lt;VLAN_MTU,LINKSTATE&gt;
        ether 00:a0:cc:da:da:db
        inet 10.0.0.1 netmask 0xffffff00 broadcast 10.0.0.255
        media: Ethernet 10baseT/UTP
        status: no carrier
plip0: <span class=nv>flags</span><span class=o>=</span>8810&lt;POINTOPOINT,SIMPLEX,MULTICAST&gt; mtu 1500
lo0: <span class=nv>flags</span><span class=o>=</span>8049&lt;UP,LOOPBACK,RUNNING,MULTICAST&gt; metric 0 mtu 16384
        <span class=nv>options</span><span class=o>=</span>3&lt;RXCSUM,TXCSUM&gt;
        inet6 fe80::1%lo0 prefixlen 64 scopeid 0x4
        inet6 ::1 prefixlen 128
        inet 127.0.0.1 netmask 0xff000000
        nd6 <span class=nv>options</span><span class=o>=</span>8010&lt;POINTOPOINT,MULTICAST&gt; mtu 1500</code></pre></div></div><div class=paragraph><p>Az elõbbi parancs kimenetében a következõ eszközök jelentek meg:</p></div><div class=ulist><ul><li><p><span class=filename>dc0</span>: az elsõ Ethernet felület</p></li><li><p><span class=filename>dc1</span>: a második Ethernet felület</p></li><li><p><span class=filename>plilp0</span>: a párhuzamos port felülete (amennyiben található párhuzamos port a számítógépben)</p></li><li><p><span class=filename>lo0</span>: a loopback eszköz</p></li></ul></div><div class=paragraph><p>A FreeBSD a kártyához tartozó meghajtó nevével és egy sorszámmal azonosítja a rendszermag indulása során talált eszközöket. Például az <span class=filename>sis2</span> a rendszerben található harmadik olyan eszköz, amely a <a href="https://man.freebsd.org/cgi/man.cgi?query=sis&amp;sektion=4&amp;format=html">sis(4)</a> meghajtót használja.</p></div><div class=paragraph><p>A példában a <span class=filename>dc0</span> eszköz aktív és mûködõképes. Ennek legfontosabb jelei:</p></div><div class="olist arabic"><ol class=arabic><li><p>Az <code>UP</code> szó mutatja, hogy a kártyát sikerült beállítani és készen áll a használatra.</p></li><li><p>A kártya internet (<code>inet</code>) címe (jelen esetünkben ez <code>192.168.1.3</code>).</p></li><li><p>Érvényes hálózati maszkkal rendelkezik (<code>netmask</code>, ahol a <code>0xffffff00</code> a <code>255.255.255.0</code> címnek felel meg).</p></li><li><p>Érvényes broadcast (üzenetszóró) címmel rendelkezik (ami itt most <code>192.168.1.255</code>).</p></li><li><p>A kártya MAC-címe (<code>ether</code>) <code>00:a0:cc:da:da:da</code>.</p></li><li><p>A hozzá tartozó fizikai eszköz kiválasztása automatikus (<code>media: Ethernet autoselect (100baseTX &lt;full-duplex>)</code>). Láthatjuk, hogy a <span class=filename>dc1</span> eszközt egy <code>10baseT/UTP</code> típusú fizikai eszközhöz állítottuk be. Az egyes meghajtókhoz tartozó fizikai módokról a nekik megfelelõ man oldalakon olvashatunk.</p></li><li><p>A kapcsolat állapota (<code>status</code>) <code>active</code> értékû, tehát van vonal. A <span class=filename>dc1</span> esetén láthatjuk, hogy a <code>status: no carrier</code> (nincs vonal). Ez teljesen normálisnak tekinthetõ minden olyan esetben, amikor a kártyába még nem dugtunk Ethernet-kábelt.</p></li></ol></div><div class=paragraph><p>Amennyiben az <a href="https://man.freebsd.org/cgi/man.cgi?query=ifconfig&amp;sektion=8&amp;format=html">ifconfig(8)</a> kimenete valami ilyesmi:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>dc0: <span class=nv>flags</span><span class=o>=</span>8843&lt;BROADCAST,SIMPLEX,MULTICAST&gt; metric 0 mtu 1500
	        <span class=nv>options</span><span class=o>=</span>80008&lt;VLAN_MTU,LINKSTATE&gt;
	        ether 00:a0:cc:da:da:da
	        media: Ethernet autoselect <span class=o>(</span>100baseTX &lt;full-duplex&gt;<span class=o>)</span>
	        status: active</code></pre></div></div><div class=paragraph><p>akkor az arra utal, hogy a kártyát nem állítottuk be.</p></div><div class=paragraph><p>A kártya beállításához a <code>root</code> felhasználó jogosultságaira van szükségünk. A hálózati kártyák beállítása az <a href="https://man.freebsd.org/cgi/man.cgi?query=ifconfig&amp;sektion=8&amp;format=html">ifconfig(8)</a> segítségével elvégezhetõ parancssorból is, de a gép újraindításakor az így megadott értékek elvesznek. Ezért az <span class=filename>/etc/rc.conf</span> állományba kell felvennünk a hálózati kártyák érvényes beállításait.</p></div><div class=paragraph><p>A kedvenc szövegszerkesztõnkben nyissuk meg az <span class=filename>/etc/rc.conf</span> állományt. Minden egyes hálózati csatolóhoz fel kell vennünk benne egy sort, ennek megfelelõen most a példához tartozó módon az alábbiakat:</p></div><div class="literalblock programlisting"><div class=content><pre>ifconfig_dc0=&#34;inet 192.168.1.3 netmask 255.255.255.0&#34;
ifconfig_dc1=&#34;inet 10.0.0.1 netmask 255.255.255.0 media 10baseT/UTP&#34;</pre></div></div><div class=paragraph><p>A <span class=filename>dc0</span> és <span class=filename>dc1</span> neveket kell a rendszerünkben ténylegesen megtalálható eszközök neveire kicserélni, valamint megadni a nekik megfelelõ címeket. A kártya meghajtójának és az <a href="https://man.freebsd.org/cgi/man.cgi?query=ifconfig&amp;sektion=8&amp;format=html">ifconfig(8)</a> man oldalának elolvasásával kideríthetjük az itt megadható további beállításokat, valamint az <a href="https://man.freebsd.org/cgi/man.cgi?query=rc.conf&amp;sektion=5&amp;format=html">rc.conf(5)</a> man oldalán részletesebben megismerhetjük az <span class=filename>/etc/rc.conf</span> formai követelményeit.</p></div><div class=paragraph><p>Ha a telepítés során beállítottuk volna a hálózati kapcsolatokat, akkor tapasztalhatjuk, hogy egyes hálózati kártyák sorai itt már szerepelnek. Ellenõrizzük az <span class=filename>/etc/rc.conf</span> tartalmát, mielõtt bõvítenénk!</p></div><div class=paragraph><p>Mindezek mellett az <span class=filename>/etc/hosts</span> állományba is be kell írnunk a helyi hálózatunkon található különféle gépek neveit és IP-címeit, ha még nem szerepelnének ott. Errõl további részleteket a <a href="https://man.freebsd.org/cgi/man.cgi?query=hosts&amp;sektion=5&amp;format=html">hosts(5)</a> man oldalról és az <span class=filename>/usr/shared/examples/etc/hosts</span> állományból tudhatunk meg.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Ha a géppel szeretnénk majd csatlakozni az internetre, akkor ne felejtsük el manuálisan beállítani az alapértelmezett átjárót és a névfeloldáshoz szükséges kiszolgálót:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># echo &#39;defaultrouter=&#34;alapertelmezett_atjaro&#34;&#39; &gt;&gt; /etc/rc.conf</span>
<span class=c># echo &#39;nameserver DNS_kiszolgalo&#39; &gt;&gt; /etc/resolv.conf</span></code></pre></div></div></td></tr></tbody></table></div></div><div class=sect3><h4 id=_tesztelés_és_hibaelhárítás>11.8.3. Tesztelés és hibaelhárítás<a class=anchor href=#_tesztelés_és_hibaelhárítás></a></h4><div class=paragraph><p>Miután az <span class=filename>/etc/rc.conf</span> állományban elvégeztük a szükséges változtatásokat, érdemes újraindítanunk a rendszerünket. Ennek révén érvényesítjük a csatolófelületekkel kapcsolatos változtatásainkat és ellenõrizzük, hogy így a rendszer mindenféle hibaüzenet nélkül képes elindulni. A másik lehetõség, ha csak magát a hálózati alrendszer konfigurációját indítjuk el újra:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># /etc/rc.d/netif restart</span></code></pre></div></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Ha az <span class=filename>/etc/rc.conf</span> állományban már beállítottuk az alapértelmezett átjárót, akkor elegendõ csupán ez a parancs:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># /etc/rc.d/routing restart</span></code></pre></div></div></td></tr></tbody></table></div><div class=paragraph><p>Ahogy újrakonfiguráltuk a hálózati alrendszert, ki is tudjuk próbálni a hálózati felületeket.</p></div><div class=sect4><h5 id=_az_ethernet_kártyák_tesztelése>11.8.3.1. Az Ethernet kártyák tesztelése<a class=anchor href=#_az_ethernet_kártyák_tesztelése></a></h5><div class=paragraph><p>Az Ethernet kártyák helyes beállításának vizsgálatához két dolgot kell kipróbálnunk. Elõször is pingeljük magát a felületet, majd ezután pingeljünk meg a helyi hálózaton egy másik számítógépet.</p></div><div class=paragraph><p>Elsõként tehát próbáljuk meg a helyi felületet:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>% ping <span class=nt>-c5</span> 192.168.1.3
PING 192.168.1.3 <span class=o>(</span>192.168.1.3<span class=o>)</span>: 56 data bytes
64 bytes from 192.168.1.3: <span class=nv>icmp_seq</span><span class=o>=</span>0 <span class=nv>ttl</span><span class=o>=</span>64 <span class=nb>time</span><span class=o>=</span>0.082 ms
64 bytes from 192.168.1.3: <span class=nv>icmp_seq</span><span class=o>=</span>1 <span class=nv>ttl</span><span class=o>=</span>64 <span class=nb>time</span><span class=o>=</span>0.074 ms
64 bytes from 192.168.1.3: <span class=nv>icmp_seq</span><span class=o>=</span>2 <span class=nv>ttl</span><span class=o>=</span>64 <span class=nb>time</span><span class=o>=</span>0.076 ms
64 bytes from 192.168.1.3: <span class=nv>icmp_seq</span><span class=o>=</span>3 <span class=nv>ttl</span><span class=o>=</span>64 <span class=nb>time</span><span class=o>=</span>0.108 ms
64 bytes from 192.168.1.3: <span class=nv>icmp_seq</span><span class=o>=</span>4 <span class=nv>ttl</span><span class=o>=</span>64 <span class=nb>time</span><span class=o>=</span>0.076 ms

<span class=nt>---</span> 192.168.1.3 ping statistics <span class=nt>---</span>
5 packets transmitted, 5 packets received, 0% packet loss
round-trip min/avg/max/stddev <span class=o>=</span> 0.074/0.083/0.108/0.013 ms</code></pre></div></div><div class=paragraph><p>Most pedig pingeljünk meg egy másik számítógépet a helyi hálózaton:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>% ping <span class=nt>-c5</span> 192.168.1.2
PING 192.168.1.2 <span class=o>(</span>192.168.1.2<span class=o>)</span>: 56 data bytes
64 bytes from 192.168.1.2: <span class=nv>icmp_seq</span><span class=o>=</span>0 <span class=nv>ttl</span><span class=o>=</span>64 <span class=nb>time</span><span class=o>=</span>0.726 ms
64 bytes from 192.168.1.2: <span class=nv>icmp_seq</span><span class=o>=</span>1 <span class=nv>ttl</span><span class=o>=</span>64 <span class=nb>time</span><span class=o>=</span>0.766 ms
64 bytes from 192.168.1.2: <span class=nv>icmp_seq</span><span class=o>=</span>2 <span class=nv>ttl</span><span class=o>=</span>64 <span class=nb>time</span><span class=o>=</span>0.700 ms
64 bytes from 192.168.1.2: <span class=nv>icmp_seq</span><span class=o>=</span>3 <span class=nv>ttl</span><span class=o>=</span>64 <span class=nb>time</span><span class=o>=</span>0.747 ms
64 bytes from 192.168.1.2: <span class=nv>icmp_seq</span><span class=o>=</span>4 <span class=nv>ttl</span><span class=o>=</span>64 <span class=nb>time</span><span class=o>=</span>0.704 ms

<span class=nt>---</span> 192.168.1.2 ping statistics <span class=nt>---</span>
5 packets transmitted, 5 packets received, 0% packet loss
round-trip min/avg/max/stddev <span class=o>=</span> 0.700/0.729/0.766/0.025 ms</code></pre></div></div><div class=paragraph><p>Ha beállítottuk az <span class=filename>/etc/hosts</span> állományt, akkor a <code>192.168.1.2</code> helyett a gép nevét is megadhatjuk.</p></div></div><div class=sect4><h5 id=_a_hibák_elhárítása>11.8.3.2. A hibák elhárítása<a class=anchor href=#_a_hibák_elhárítása></a></h5><div class=paragraph><p>A hardverek és szoftverek beállításaiban mindig is valódi kín megtalálni a hibákat, és ezeket a kínokat többnyire úgy tudjuk enyhíteni, ha elõször az egyszerû hibaforrásokat szûrjük ki. Csatlakoztattuk a hálózati kábelt? Tisztességesen beállítottuk a hálózati szolgáltatásokat? Jól állítottuk be a tûzfalat? A FreeBSD képes kezelni a kártyát? A hibajelentések elküldése elõtt mindig bújjuk át a támogatott hardvereszközök listáját. A FreeBSD verziókat frissítsük a legújabb STABLE változatra. Olvassuk át a levelezési listák archívumait vagy legalább keressünk rá a témára az interneten.</p></div><div class=paragraph><p>Ha a kártya mûködik, de a teljesítménye nem kielégítõ, érdemes ennek utánanézni a <a href="https://man.freebsd.org/cgi/man.cgi?query=tuning&amp;sektion=7&amp;format=html">tuning(7)</a> man oldalon. Ilyenkor érdemes ellenõrizni a hálózati beállításainkat is, mivel a helytelen beállítások gyakran okoznak teljesítményvesztést.</p></div><div class=paragraph><p>Bizonyos esetekben láthatunk egy vagy két <code>device timeout</code> típusú hibát is, ami a kártyák egyes fajtáinál elfogadható. Ha azonban folyamatosan megjelennek vagy zavaróvá válnak, érdemes utánanéznünk, hogy az eszköz nem ütközik-e valamelyik másikkal. Mindenképpen gyõzõdjünk meg a kábelek épségérõl és csatlakoztatásáról. Még az is elképzelhetõ, hogy egyszerûen csak egy másik hálózati kártyára van szükségünk.</p></div><div class=paragraph><p>Néha felbukkanak <code>watchdog timeout</code> jellegû hibák is. Ilyenkor elsõként mindig a hálózati kábelt ellenõrizzük. Egyes kártyáknak olyan PCI foglalatra van szükségük, ami támogatja a Bus Mastering opciót. Néhány régebbi alaplapon csak ilyen PCI bõvítõhely található (ami általában a 0. foglalat). Olvassunk utána a hálózati kártya és az alaplap dokumentációjában, hátha ezek okozzák a problémát.</p></div><div class=paragraph><p>A <code>No route to host</code> üzenet akkor jelenik meg, ha a rendszer képtelen megállapítani, milyen úton juttassa el a csomagokat a megadott célhoz. Ez többnyire olyankor történik meg, amikor nem adtunk meg alapértelmezett kézbesítési irányt (default route) vagy nem dugtuk be a hálózati kábelt. A <code>netstat -rn</code> kimenetébõl meg tudjuk állapítani, hogy létezik-e érvényes út az elérni kívánt cél felé. Ha nincs, akkor haladjunk tovább a <a href=./#advanced-networking>Egyéb haladó hálózati témák</a>re.</p></div><div class=paragraph><p>A <code>ping: sendto: Permission denied</code> jellegû üzeneteket többségében egy helytelenül beállított tûzfal okozza. Ha az <code>ipfw</code> mûködését engedélyeztük a rendszermagban, de nem adtunk meg hozzá szabályokat, akkor az alapértelmezett házirend szerint minden forgalmat blokkolni fog, tehát még a pingeket is! Ezzel kapcsolatban a <a href=./#firewalls>Tűzfalak</a> elolvasását ajánljuk.</p></div><div class=paragraph><p>Elõfordulhat, hogy a kártya teljesítménye igen gyenge vagy az átlagos alatt van. Ilyenkor a fizikai eszköz <code>autoselect</code> (automatikus) típusú kiválasztása helyett érdemes megadnunk a konkrét eszköznek megfelelõ típust. Habár ez a legtöbb hardver esetén beválik, nem mindenki számára jelent megoldást. Ismételten csak annyit tudunk ehhez hozzátenni, hogy ellenõrizzük a hálózati beállításainkat és olvassuk el a <a href="https://man.freebsd.org/cgi/man.cgi?query=tuning&amp;sektion=7&amp;format=html">tuning(7)</a> man oldalt.</p></div></div></div></div><div class=sect2><h3 id=configtuning-virtual-hosts>11.9. Virtuális címek<a class=anchor href=#configtuning-virtual-hosts></a></h3><div class=paragraph><p>A FreeBSD alkalmazása során igen gyakori a virtuális címek használata, aminek segítségével egyetlen szerver több szerverként képes látszódni a hálózaton. Ezt úgy érik el, hogy egyetlen felülethez több hálózati címet rendelnek hozzá.</p></div><div class=paragraph><p>Az adott hálózati csatolófelületnek van egy "valódi címe" és tetszõleges számú "álcíme". Ezeket az álcímeket általában az <span class=filename>/etc/rc.conf</span> állományban kell feltüntetni.</p></div><div class=paragraph><p>Az <span class=filename>fxp0</span> felület esetén az álcímek megadása valahogy így néz ki:</p></div><div class="literalblock programlisting"><div class=content><pre>ifconfig_fxp0_alias0=&#34;inet xxx.xxx.xxx.xxx netmask xxx.xxx.xxx.xxx&#34;</pre></div></div><div class=paragraph><p>Figyeljük meg, hogy az álcímekhez tartozó bejegyzések az <code>alias0</code> névvel kezdõdnek és szám szerint növekvõleg következnek egymás után (például, <code>_alias1</code>, <code>_alias2</code> és így tovább). A beállítás a sorozat elsõ kimaradó tagjánál megszakad.</p></div><div class=paragraph><p>Az álcímek hálózati maszkjának pontos meghatározása nagyon fontos, de szerencsére nem különösebben bonyolult. Minden felület esetén lennie kell egy olyan címnek, amely helyesen reprezentálja a hálózat hálózati maszkját. Minden egyéb olyan címnek, ami ugyanabba az alhálózatba esik, végig <code>1</code>-esekbõl álló hálózati maszkkal kell rendelkezniük (ami felírható <code>255.255.255.255</code> vagy <code>0xffffffff</code> formájában is).</p></div><div class=paragraph><p>Például vegyük azt, hogy az <span class=filename>fxp0</span> felületen keresztül két hálózathoz csatlakozunk, melyek közül az egyik a <code>10.1.1.0</code>, amelynek hálózati maszkja <code>255.255.255.0</code>, és a <code>202.0.75.16</code>, amelynek hálózati maszkja <code>255.255.255.240</code>. Azt szeretnénk elérni, hogy a rendszerünk a <code>10.1.1.1</code> címtõl a <code>10.1.1.5</code> címig, valamint a <code>202.0.75.17</code> címtõl a <code>202.0.75.20</code> címig jelenjen meg a nekik megfelelõ hálózatokon. Ahogy arra már fentebb is utaltunk, az adott hálózati tartományban csak az elsõ címnek (ebben az esetben ez a <code>10.0.1.1</code> és a <code>202.0.75.17</code>) kell valódi hálózati maszkkal rendelkeznie. Minden további címnek (a <code>10.1.1.2</code> és <code>10.1.1.5</code> között, valamint a <code>202.0.75.18</code> és <code>202.0.75.20</code> között) legyen <code>255.255.255.255</code> a hálózati maszkja.</p></div><div class=paragraph><p>Az alábbi <span class=filename>/etc/rc.conf</span> bejegyzések ennek az elrendezésnek megfelelõen állítják be a kártyát:</p></div><div class="literalblock programlisting"><div class=content><pre>ifconfig_fxp0=&#34;inet 10.1.1.1 netmask 255.255.255.0&#34;
ifconfig_fxp0_alias0=&#34;inet 10.1.1.2 netmask 255.255.255.255&#34;
ifconfig_fxp0_alias1=&#34;inet 10.1.1.3 netmask 255.255.255.255&#34;
ifconfig_fxp0_alias2=&#34;inet 10.1.1.4 netmask 255.255.255.255&#34;
ifconfig_fxp0_alias3=&#34;inet 10.1.1.5 netmask 255.255.255.255&#34;
ifconfig_fxp0_alias4=&#34;inet 202.0.75.17 netmask 255.255.255.240&#34;
ifconfig_fxp0_alias5=&#34;inet 202.0.75.18 netmask 255.255.255.255&#34;
ifconfig_fxp0_alias6=&#34;inet 202.0.75.19 netmask 255.255.255.255&#34;
ifconfig_fxp0_alias7=&#34;inet 202.0.75.20 netmask 255.255.255.255&#34;</pre></div></div></div><div class=sect2><h3 id=configtuning-configfiles>11.10. Konfigurációs állományok<a class=anchor href=#configtuning-configfiles></a></h3><div class=sect3><h4 id=_az_etc_felépítése>11.10.1. Az <span class=filename>/etc</span> felépítése<a class=anchor href=#_az_etc_felépítése></a></h4><div class=paragraph><p>A beállításokkal kapcsolatos információk számos könyvtárban tárolódnak. Többek közt:</p></div><table class="tableblock frame-none grid-all stretch informaltable"><col style=width:50%><col style=width:50%><tbody><tr><td class="tableblock halign-left valign-top"><p class=tableblock><span class=filename>/etc</span></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Általános rendszerszintû beállítások. Az itt levõ adatok a rendszer egészére vonatkoznak.</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><span class=filename>/etc/defaults</span></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>A rendszer konfigurációs állományainak alapértelmezett változatai.</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><span class=filename>/etc/mail</span></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>A <a href="https://man.freebsd.org/cgi/man.cgi?query=sendmail&amp;sektion=8&amp;format=html">sendmail(8)</a> beállításához tartozó további állományok, egyéb levélküldéshez használt adatok.</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><span class=filename>/etc/ppp</span></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>A felhasználói és rendszermag szintû ppp programok beállításai.</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><span class=filename>/etc/namedb</span></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>A <a href="https://man.freebsd.org/cgi/man.cgi?query=named&amp;sektion=8&amp;format=html">named(8)</a> mûködéséhez szükséges adatok alapértelmezett helye. Általában a <span class=filename>named.conf</span> és a zónák leírását tároló állományok kerülnek ide.</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><span class=filename>/usr/local/etc</span></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>A telepített alkalmazások konfigurációs állományai. Néha alkalmazásonként külön könyvtárakba kerülnek a benne található állományok.</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><span class=filename>/usr/local/etc/rc.d</span></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>A telepített alkalmazások indításával és leállításával kapcsolatos szkriptek.</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><span class=filename>/var/db</span></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Automatikusan generált rendszerszintû adatbázisok a csomagokkal, a programok helyével stb. kapcsolatosan.</p></td></tr></tbody></table></div><div class=sect3><h4 id=_hálózati_nevek>11.10.2. Hálózati nevek<a class=anchor href=#_hálózati_nevek></a></h4><div class=sect4><h5 id=_etcresolv_conf>11.10.2.1. <span class=filename>/etc/resolv.conf</span><a class=anchor href=#_etcresolv_conf></a></h5><div class=paragraph><p>Az <span class=filename>/etc/resolv.conf</span> határozza meg, hogy a FreeBSD névfeloldója miként fér hozzá az internet tartománynév rendszeréhez (a DNS-hez).</p></div><div class=paragraph><p>Az <span class=filename>resolv.conf</span> állományban leggyakrabban a következõ bejegyzések fordulnak elõ:</p></div><table class="tableblock frame-none grid-all stretch informaltable"><col style=width:50%><col style=width:50%><tbody><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>nameserver</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Annak a névszernek az IP-címe, ahova a névfeloldó küldi a kéréseit. A névszervereket a felírás sorrendjében kérdezi meg, maximum hármat.</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>search</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>A hálózati nevek keresõlistája. Ezt általában a helyi hálózati nevek tartománya határozza meg.</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>domain</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>A helyi tartomány neve.</p></td></tr></tbody></table><div class=paragraph><p>Egy átlagos <span class=filename>resolv.conf</span> tartalma:</p></div><div class="literalblock programlisting"><div class=content><pre>search example.com
nameserver 147.11.1.11
nameserver 147.11.100.30</pre></div></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Csak egy <code>search</code> és <code>domain</code> opciót szabad megadni.</p></div></td></tr></tbody></table></div><div class=paragraph><p>A DHCP használatakor a <a href="https://man.freebsd.org/cgi/man.cgi?query=dhclient&amp;sektion=8&amp;format=html">dhclient(8)</a> felül szokta írni a <span class=filename>resolv.conf</span> tartalmát a DHCP szervertõl kapott információkkal.</p></div></div><div class=sect4><h5 id=_etchosts>11.10.2.2. <span class=filename>/etc/hosts</span><a class=anchor href=#_etchosts></a></h5><div class=paragraph><p>Az <span class=filename>/etc/hosts</span> az internet kezdeti napjaira emlékeztetõ egyszerû szöveges adatbázis. A nevek és IP-címek közti leképzéseket a DNS és NIS rendszerekkel karöltve oldja fel. Ide a helyi hálózaton csatlakozó számítógépek neveit lehet beírni ahelyett, hogy erre a célra beállítanánk egy külön <a href="https://man.freebsd.org/cgi/man.cgi?query=named&amp;sektion=8&amp;format=html">named(8)</a> szervert. Ezenkívül még az <span class=filename>/etc/hosts</span> állományba internetes nevek rekordját is felvehetjük, amivel így csökkenthetjük a gyakran használt nevek feloldására irányuló külsõ kéréseket.</p></div><div class="literalblock programlisting"><div class=content><pre># $FreeBSD$
#
#
# A hálózati nevek adatbázisa
#
# Ebbe az állományba rakjuk a helyi hálózaton található címeket és
# a hozzájuk tartozó hálózati neveket, ahol szinte ugyanez az
# adatbázis megtalálható.  A &#39;my.domain&#39; helyére a saját gépünk
# nevét írjuk be.
#
# A DNS vagy NIS alkalmazása esetén ez az állomány nem feltétlenül kerül
# felhasználásra. A névfeloldás sorrendjét az /etc/nsswitch.conf
# állományban adhatjuk meg.
#
::1                     localhost localhost.my.domain
127.0.0.1               localhost localhost.my.domain

#
# Egy képzeletbeli hálózat.
#10.0.0.2               myname.my.domain myname
#10.0.0.3               myfriend.my.domain myfriend
#
# Az RFC 1918-nak megfelelõen a következõ IP-címekkel rendelkezõ
# alhálózatok sosem csatlakozhatnak közvetlenül az internetre:
#
#       10.0.0.0        -   10.255.255.255
#       172.16.0.0      -   172.31.255.255
#       192.168.0.0     -   192.168.255.255
#
# Amikor csatlakozunk az internethez, egy valódi, hivatalosan
# kiosztott számra lesz szükségünk.  Ne találjunk ki magunknak
# hálózati címeket, hanem használjuk az internetszolgáltatótól
# kapott címet (amennyiben rendelkezünk # ilyennel) vagy az
# regionális internetes nyilvántartásban szereplõ címek közül
# valamelyiket (ARIN, APNIC, LACNIC, RIPE NCC vagy AfriNIC).</pre></div></div><div class=paragraph><p>Az <span class=filename>/etc/hosts</span> formai felépítése igen egyszerû:</p></div><div class="literalblock programlisting"><div class=content><pre>[internetes cím] [hivatalos hálózati név] [álnév1] [álnév2] ...</pre></div></div><div class=paragraph><p>Tehát például:</p></div><div class="literalblock programlisting"><div class=content><pre>10.0.0.1 azEnValodiNevem.aHalozaton.hu azEnValodiNevem izemize1 izemize2</pre></div></div><div class=paragraph><p>A részletekért keressük fel a <a href="https://man.freebsd.org/cgi/man.cgi?query=hosts&amp;sektion=5&amp;format=html">hosts(5)</a> man oldalt.</p></div></div></div><div class=sect3><h4 id=_a_naplóállományok_beállítása>11.10.3. A naplóállományok beállítása<a class=anchor href=#_a_naplóállományok_beállítása></a></h4><div class=sect4><h5 id=_syslog_conf>11.10.3.1. <span class=filename>syslog.conf</span><a class=anchor href=#_syslog_conf></a></h5><div class=paragraph><p>A <span class=filename>syslog.conf</span> állomány a <a href="https://man.freebsd.org/cgi/man.cgi?query=syslogd&amp;sektion=8&amp;format=html">syslogd(8)</a> program beállításait tartalmazza. Segítségével megadhatjuk, hogy a <code>syslog</code> által generált üzenetek egyes típusait milyen naplóállományokba mentsük.</p></div><div class="literalblock programlisting"><div class=content><pre># $FreeBSD$
#
# Ebben az állományban HASZNÁLHATÓAK szóközök a mezõk elválasztására,
# habár a többi *nix-típusú rendszer inkább tabulátorokat használ
# erre a célra. Ha több rendszeren is használni akarjuk ezt az
# állományt, akkor ne használjunk szóközöket.
#
# A többit lásd a syslog.conf(5) man oldalon.
#
.err;kern.debug;auth.notice;mail.crit           /dev/console
*.notice;kern.debug;lpr.info;mail.crit;news.err /var/log/messages
security.*                                      /var/log/security
mail.info                                       /var/log/maillog
lpr.info                                        /var/log/lpd-errs
cron.*                                          /var/log/cron
*.err                                           root
*.notice;news.err                               root
*.alert                                         root
*.emerg                                         *
# Tegyük vissza ezt a sort, ha a /dev/console eszközre kiírt
# üzeneteket át akarjuk irányítani az /var/log/console.log állományba.
#console.info                                   /var/log/console.log
# Ha az összes üzenetet a /var/log/all.log állományba akarjuk menteni,
# akkor tegyük vissza ezt a sort.
#*.*                                            /var/log/all.log
# Ha egy &#34;loghost&#34; nevû gépre szeretnénk naplózni, akkor tegyük vissza
# ezt a sort.
#*.*                                            @loghost
# Az inn használatakor tegyük vissza ezeket a sorokat.
# news.crit                                     /var/log/news/news.crit
# news.err                                      /var/log/news/news.err
# news.notice                                   /var/log/news/news.notice
!startslip
*.*                                             /var/log/slip.log
!ppp
*.*                                             /var/log/ppp.log</pre></div></div><div class=paragraph><p>A <a href="https://man.freebsd.org/cgi/man.cgi?query=syslog.conf&amp;sektion=5&amp;format=html">syslog.conf(5)</a> man oldalának elolvasásával tudhatunk meg többet ezekrõl.</p></div></div><div class=sect4><h5 id=_newsyslog_conf>11.10.3.2. <span class=filename>newsyslog.conf</span><a class=anchor href=#_newsyslog_conf></a></h5><div class=paragraph><p>A <span class=filename>newsyslog.conf</span> a <a href="https://man.freebsd.org/cgi/man.cgi?query=newsyslog&amp;sektion=8&amp;format=html">newsyslog(8)</a> beállításait tároló állomány. Ez egy olyan program, amelyet általában a <a href="https://man.freebsd.org/cgi/man.cgi?query=cron&amp;sektion=8&amp;format=html">cron(8)</a> futtat le. A <a href="https://man.freebsd.org/cgi/man.cgi?query=newsyslog&amp;sektion=8&amp;format=html">newsyslog(8)</a> dönti el, hogy mikor van szükség a naplók archiválására és átrendezésére. Ennek során a <span class=filename>logfile</span> állományból <span class=filename>logfile.0</span> lesz, a <span class=filename>logfile.0</span> állományból pedig <span class=filename>logfile.1</span> és így tovább. Beállíthatjuk úgy is, hogy a naplóállományokat archiválja <a href="https://man.freebsd.org/cgi/man.cgi?query=gzip&amp;sektion=1&amp;format=html">gzip(1)</a> formátumban, aminek megfelelõen ezek <span class=filename>logfile.0.gz</span>, <span class=filename>logfile.1.gz</span> és ehhez hasonló névvel jönnek létre.</p></div><div class=paragraph><p>A <span class=filename>newsyslog.conf</span> megadja, hogy melyik naplóállományokat kell felügyelni, mennyi példányt tartsunk meg belõlük és mikor kell velük foglalkozni. A naplóállományok átrendezhetõek és/vagy archiválhatóak egy adott méret elérésekor vagy egy adott idõ eltelte után.</p></div><div class="literalblock programlisting"><div class=content><pre># A newsyslog konfigurációs állománya
# $FreeBSD$
#
# állománynév     [tulajdonos:csoport]  mód  darab méret mikor [ZB] [/pid_állomány] [jelzés]
/var/log/cron                           600  3     100  *     Z
/var/log/amd.log                        644  7     100  *     Z
/var/log/kerberos.log                   644  7     100  *     Z
/var/log/lpd-errs                       644  7     100  *     Z
/var/log/maillog                        644  7     *    @T00  Z
/var/log/sendmail.st                    644  10    *    168   B
/var/log/messages                       644  5     100  *     Z
/var/log/all.log                        600  7     *    @T00  Z
/var/log/slip.log                       600  3     100  *     Z
/var/log/ppp.log                        600  3     100  *     Z
/var/log/security                       600  10    100  *     Z
/var/log/wtmp                           644  3     *    @01T05 B
/var/log/daily.log                      640  7     *    @T00  Z
/var/log/weekly.log                     640  5     1    $W6D0 Z
/var/log/monthly.log                    640  12    *    $M1D0 Z
/var/log/console.log                    640  5     100  *     Z</pre></div></div><div class=paragraph><p>További információkat a <a href="https://man.freebsd.org/cgi/man.cgi?query=newsyslog&amp;sektion=8&amp;format=html">newsyslog(8)</a> man oldaláról nyerhetünk.</p></div></div></div><div class=sect3><h4 id=configtuning-sysctlconf>11.10.4. <span class=filename>sysctl.conf</span><a class=anchor href=#configtuning-sysctlconf></a></h4><div class=paragraph><p>A <span class=filename>sysctl.conf</span> állomány leginkább az <span class=filename>rc.conf</span> állományhoz hasonlít, benne az értékeket <code>változó=érték</code> párokban adhatjuk meg. Az itt definiált értékek akkor kerülnek ténylegesen beállításra, amikor a rendszer többfelhasználós módba vált. Ezen a módon nem mindegyik változó értékét tudjuk átállítani.</p></div><div class=paragraph><p>A <span class=filename>sysctl.conf</span> állományban az alábbi érték beállításával tudjuk beállítani, hogy a rendszer ne naplózza, amikor a programok végzetes jelzéssel fejezõdnek be, valamint azt, hogy a felhasználók láthassák egymás futó programjait:</p></div><div class="literalblock programlisting"><div class=content><pre># Ne naplózzuk a végzetes jelzésekhez (például sig 11) tartozó kilépéseket.
kern.logsigexit=0

# Ne engedjük a felhasználóknak, hogy lássák egy másik felhasználó
# azonosítójával futó programokat.
security.bsd.see_other_uids=0</pre></div></div></div></div><div class=sect2><h3 id=configtuning-sysctl>11.11. Finomhangolás a sysctl használatával<a class=anchor href=#configtuning-sysctl></a></h3><div class=paragraph><p>A <a href="https://man.freebsd.org/cgi/man.cgi?query=sysctl&amp;sektion=8&amp;format=html">sysctl(8)</a> egy olyan felület, amely lehetõséget biztosít egy mûködõ FreeBSD rendszer megváltoztatására. Segítségével többek közt hozzáférhetünk a TCP/IP protokollkészlet és a virtuális memóriát kezelõ alrendszer rengeteg apró opciójához, melyek megfelelõ beállításával egy tapasztalt rendszergazda kezében drasztikusan növelhetõ a rendszer teljesítménye. A <a href="https://man.freebsd.org/cgi/man.cgi?query=sysctl&amp;sektion=8&amp;format=html">sysctl(8)</a> alkalmazásával több mint ötszáz rendszerszintû változó kérdezhetõ le és állítható be.</p></div><div class=paragraph><p>A <a href="https://man.freebsd.org/cgi/man.cgi?query=sysctl&amp;sektion=8&amp;format=html">sysctl(8)</a> két funkciót rejt magában: a rendszer beállításainak lekérdezését és módosítását.</p></div><div class=paragraph><p>Így nézhetjük meg az összes lekérdezhetó változót:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>% sysctl <span class=nt>-a</span></code></pre></div></div><div class=paragraph><p>Így kérhetjük egy konkrét változó, például a <code>kern.maxproc</code> értékét:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>% sysctl kern.maxproc
kern.maxproc: 1044</code></pre></div></div><div class=paragraph><p>Egy adott változó értékének módosításához pedig használjuk a <em>változó</em>=<em>érték</em> felírást:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># sysctl kern.maxfiles=5000</span>
kern.maxfiles: 2088 -&gt; 5000</code></pre></div></div><div class=paragraph><p>A sysctl változók értékei lehetnek karakterláncok, számok és logikai értékek (ahol az <code>1</code> az igennek, a <code>0</code> a nemnek felel meg).</p></div><div class=paragraph><p>Ha a számítógép indításakor automatikusan be akarunk állítani bizonyos változókat, akkor vegyük fel ezeket az <span class=filename>/etc/sysctl.conf</span> állományba. Ennek pontosabb részleteit a <a href="https://man.freebsd.org/cgi/man.cgi?query=sysctl.conf&amp;sektion=5&amp;format=html">sysctl.conf(5)</a> man oldalon és a <a href=#configtuning-sysctlconf><span class=filename>sysctl.conf</span></a>ban találhatjuk meg.</p></div><div class=sect3><h4 id=sysctl-readonly>11.11.1. A <a href="https://man.freebsd.org/cgi/man.cgi?query=sysctl&amp;sektion=8&amp;format=html">sysctl(8)</a> írásvédett értékei<a class=anchor href=#sysctl-readonly></a></h4><div class=paragraph><p>Egyes esetekben szükséges lehet a <a href="https://man.freebsd.org/cgi/man.cgi?query=sysctl&amp;sektion=8&amp;format=html">sysctl(8)</a> írásvédett változóinak módosítása. Habár gyakran elengedhetetlen, ezt kizárólag csak a rendszer (újra)indításakor tudjuk megtenni.</p></div><div class=paragraph><p>Például egyes laptopoknál a <a href="https://man.freebsd.org/cgi/man.cgi?query=cardbus&amp;sektion=4&amp;format=html">cardbus(4)</a> eszköz nem próbálkozik több memóriaterület használatával, ezért egy ehhez hasonló hibával leáll:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>cbb0: Could not map register memory
device_probe_and_attach: cbb0 attach returned 12</code></pre></div></div><div class=paragraph><p>Az ilyen és ehhez hasonló esetekben gyakran olyan <a href="https://man.freebsd.org/cgi/man.cgi?query=sysctl&amp;sektion=8&amp;format=html">sysctl(8)</a> változók alapértelmezett értékeit kellene megváltoztatnunk, amelyek írásvédettek. Ilyenkor tegyük az érintett <a href="https://man.freebsd.org/cgi/man.cgi?query=sysctl&amp;sektion=8&amp;format=html">sysctl(8)</a> változó "objektumazonosítóját" (OID) és a hozzá tartozó értéket a <span class=filename>/boot/loader.conf</span> állományunkba. Az alapértelmezéseket a <span class=filename>/boot/defaults/loader.conf</span> állományban találjuk meg.</p></div><div class=paragraph><p>A fentebb tárgyalt probléma megoldásához a felhasználónak a <code>hw.pci.allow_unsupported_io_range=1</code> értéket kell beállítania az elõbb említett állományban. Ezután már a <a href="https://man.freebsd.org/cgi/man.cgi?query=cardbus&amp;sektion=4&amp;format=html">cardbus(4)</a> megfelelõen fog mûködni.</p></div></div></div><div class=sect2><h3 id=configtuning-disk>11.12. A lemezek finomhangolása<a class=anchor href=#configtuning-disk></a></h3><div class=sect3><h4 id=_sysctl_változók>11.12.1. Sysctl változók<a class=anchor href=#_sysctl_változók></a></h4><div class=sect4><h5 id=_vfs_vmiodirenable>11.12.1.1. <code>vfs.vmiodirenable</code><a class=anchor href=#_vfs_vmiodirenable></a></h5><div class=paragraph><p>A <code>vfs.vmiodirenable</code> sysctl változó értéke lehet 0 (ki) vagy 1 (be, és ez az alapértelmezés is). Ez a változó vezérli a könyvtárak gyorsítótárazását a rendszerben. A könyvtárak többsége kis méretû, így az állományrendszerbõl csak egyetlen (általában 1 KB méretû) darabkát használnak és még ennél is kevesebbet (általában 512 byte-ot) a pufferben. A változó kikapcsolt (avagy 0) értéke mellett a puffer csak rögzített számú könyvtárat táraz be még abban az esetben is, amikor temérdek mennyiségû memória áll a rendelkezésére. Ha viszont (az 1 értékkel) engedélyezzük, akkor a rendszer a könyvtárak tárazására felhasználja a virtuális memóriában pufferelt lapokat is, amivel lényegében az összes elérhetõ memóriát a könyvtárak tárazására fordítja. Ilyenkor azonban az egyes könyvtárak tárazására használt legkisebb memóriaterület a fizikai lapmérettel egyezik meg (ami általában 4 KB) és nem 512 byte. Abban az esetben javasoljuk ennek a beállításnak a használatát, ha olyan szolgáltatásokkal dolgozunk, amelyek nagy számú állománnyal dolgoznak egyszerre. Ilyen szolgáltatások többek közt a webes gyorsítótárak, nagyobb levelezõrendszerek és hírrendszerek. Az opció engedélyezése alapvetõen nem veti vissza a rendszer teljesítményét még akkor sem, ha ezzel memóriát pazarlunk el, de ezt igazából érdemes kikísérletezni.</p></div></div><div class=sect4><h5 id=_vfs_write_behind>11.12.1.2. <code>vfs.write_behind</code><a class=anchor href=#_vfs_write_behind></a></h5><div class=paragraph><p>A <code>vfs.write_behind</code> sysctl változó alapértelmezett értéke <code>1</code> (bekapcsolt). Ez arra utasítja az állományrendszert, hogy csak akkor küldje ki az adatokat az eszközre, ha belõlük teljes fürtök gyûltek össze. Ez jellemzõ módon nagyobb szekvenciális állományok írása esetén kedvezõ. Arra szolgál, hogy segítségével el lehessen kerülni az I/O túlságosan gyakori módosítások okozta terhelését. Bizonyos körülmények közt ez azonban lassíthatja a futó programok mûködését, ezért ilyenkor érdemes megfontolni a kikapcsolását.</p></div></div><div class=sect4><h5 id=_vfs_hirunningspace>11.12.1.3. <code>vfs.hirunningspace</code><a class=anchor href=#_vfs_hirunningspace></a></h5><div class=paragraph><p>A <code>vfs.hirunningspace</code> sysctl változó értéke azt adja meg, hogy tetszõleges számú példánynál rendszerszinten mekkora mértékû írási mûvelet irányítható át a lemezvezérlõk soraiba. Az alapértelmezés többnyire elegendõ, de olyan gépeken, ahol sok lemez dolgozik egyszerre, ez az érték négy vagy öt <em>megabyte-ra</em> is felszökhet! Hozzátennénk, hogy ha ezt az értéket túlságosan nagyra állítjuk (és így túllépjük a puffer írási küszöbértékét), akkor ezzel hihetetlenül gyenge fürtözési teljesítményt nyerünk. Semmiképp se állítsuk túlzottan nagy értékre! A nagyobb írási értékek a velük párhuzamos olvasások számára késleltetést is jelentenek.</p></div><div class=paragraph><p>Találhatunk még más egyéb pufferelési és gyorsítótárazási sysctl változókat, azonban ezek megváltoztatását egyáltalán nem javasoljuk, mivel a virtuális memória alrendszer kiválóan tudja önállóan állítani ezeket a paramétereit.</p></div></div><div class=sect4><h5 id=_vm_swap_idle_enabled>11.12.1.4. <code>vm.swap_idle_enabled</code><a class=anchor href=#_vm_swap_idle_enabled></a></h5><div class=paragraph><p>A <code>vm.swap_idle_enabled</code> sysctl változó módosítása olyan nagyobb többfelhasználós rendszerekben bizonyulhat hasznosnak, ahol sok felhasználó lép be és lép ki a rendszerbe és sok az üresjáratban futó program. Az ilyen jellegû rendszerek hajlamosak nagy mennyiségû folyamatos terhelést mérni a tartalékolt szabad memóriára. A beállítás engedélyezésével, valamint a <code>vm.swap_idle_threshold1</code> és a <code>vm.swap_idle_threshold2</code> változókon keresztül a kilapozás "reakcióidejének" alkalmas behangolásával a megszokottnál gyorsabban lenyomhatjuk az üresjáratban dolgozó programokhoz tartozó memórialapok prioritását, amivel a kilapozásokat vezérlõ démon kezére játszunk. Azonban tényleg csak akkor engedélyezzük ezt a lehetõséget, ha valóban szükségünk van rá, mivel így a memóriát jóval elõbb lapozzuk ki és ezzel több lapozóállományt és lemezteljesítményt emésztünk fel. Kisebb rendszerekben jól behatárolható a hatása, azonban a nagyobb rendszerekben, ahol már eleve visszafogott mértékû lapozás történik, ez a beállítás lehetõvé teszi a virtuális memóriát kezelõ alrendszer számára, hogy könnyedén ki- és be rakosgasson komplett futó programokat a memóriába.</p></div></div><div class=sect4><h5 id=_hw_ata_wc>11.12.1.5. <code>hw.ata.wc</code><a class=anchor href=#_hw_ata_wc></a></h5><div class=paragraph><p>A FreeBSD 4.3 egyszer már kacérkodott az IDE-lemezek írási pufferének kikapcsolásával. Ez ugyan csökkentette az IDE-lemezek írási sávszélességét, azonban bizonyos merevlemezgyártók gondatlanságából eredõ súlyos adatvesztések miatt szükséges volt a használata. A gond ezzel kapcsolatban ott van, hogy egyes IDE-meghajtók hazudnak az írások teljesítésérõl. A lemezek írási gyorsítótárazásának bekapcsolásával az IDE-meghajtók nem csak az írások sorrendjét rendezik át, hanem nagyobb terhelés esetén egyes blokkokat jóval késõbb is rögzítenek. Ezért a rendszer esetleges összeomlása vagy egy áramkimaradás súlyos károkat okozhat az állományrendszerben. A FreeBSD úgy döntött, hogy a megbízhatóságot választja. Sajnos ez olyan nagyságú teljesítményvesztést okozott, hogy a következõ kiadásban már kénytelenek voltunk alapértelmezés szerint is visszakapcsolni ezt a lehetõséget. A <code>hw.ata.wc</code> nevû sysctl változó vizsgálatával ellenõrizhetjük a rendszerünkön érvényes alapértelmezett beállítást. Amennyiben az IDE írások gyorsítótárazása nem engedélyezett, akkor ezt a változó értékének 1-re állításával állíthatjuk vissza. Ezt a rendszer indításakor a rendszerbetöltõben tehetjük meg. A rendszermag indítása után ennek már nincs hatása.</p></div><div class=paragraph><p>A részleteket a <a href="https://man.freebsd.org/cgi/man.cgi?query=ata&amp;sektion=4&amp;format=html">ata(4)</a> man oldalon tudhatjuk meg.</p></div></div><div class=sect4><h5 id=_scsi_delay_kern_cam_scsi_delay>11.12.1.6. <code>SCSI_DELAY</code> (<code>kern.cam.scsi_delay</code>)<a class=anchor href=#_scsi_delay_kern_cam_scsi_delay></a></h5><div class=paragraph><p>A rendszermag <code>SCSI_DELAY</code> nevû beállítása a rendszer indulásának idejét hivatott mérsékelni. Az alapértelmezett értéke viszonylag magas, innen származik a rendszer indítása során keletkezõ <code>15</code> másodperces csúszás. Általában az is megfelelõ, ha ezt visszavesszük az <code>5</code> értékre (fõleg a modernebb meghajtók számára). A FreeBSD újabb (5.0 vagy késõbbi) változataiban ez az érték már a <code>kern.cam.scsi_delay</code> sysctl változó értékével is megadható a rendszer indításakor. Azonban ügyeljünk rá, hogy mind a finomhangoláshoz használt változó, mind pedig rendszermag beállítása <em>ezredmásodpercben</em> és <em>nemmásodpercben</em> értelmezi ezt az értéket.</p></div></div></div><div class=sect3><h4 id=soft-updates>11.12.2. Soft Updates<a class=anchor href=#soft-updates></a></h4><div class=paragraph><p>A <a href="https://man.freebsd.org/cgi/man.cgi?query=tunefs&amp;sektion=8&amp;format=html">tunefs(8)</a> nevû program használható az állományrendszerek finomhangolására. Nagyon sok opciót találhatunk benne, de itt most csak a "Soft Updates" ki- és bekapcsolásával foglalkozunk, amit a következõ módon tehetünk meg:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># tunefs -n enable /allomanyrendszer</span>
<span class=c># tunefs -n disable /allomanyrendszer</span></code></pre></div></div><div class=paragraph><p>Amíg egy állományrendszer csatlakoztatott állapotban van, addig nem módosítható a <a href="https://man.freebsd.org/cgi/man.cgi?query=tunefs&amp;sektion=8&amp;format=html">tunefs(8)</a> paranccsal. A Soft Updates bekapcsolására ezért az a legalkalmasabb idõpont, amikor egyfelhasználós módban vagyunk és még egyetlen partíciót sem csatlakoztattunk.</p></div><div class=paragraph><p>A Soft Updates beállítás engedélyezése a memóriában pufferelt gyorsítótáron keresztül jelentõs mértékben fokozza a metaadatok teljesítményét, elsõsorban az állományok létrehozását és törlését. A Soft Updates használatát ezért minden állományrendszer esetén ajánljuk. A Soft Updates alkalmazásának két rossz oldalára kell tekintettel lennünk. Elõször is a Soft Updates a rendszer összeomlása esetén ugyan garantálja az állományrendszer konzisztenciáját, de könnyen elképzelhetõ, hogy több másodperccel (vagy akár egy egész perccel!) hátrébb jár a fizikai lemez frissítésében. Másodszor a Soft Updates késlelteti az állományrendszer blokkjainak felszabadítását. Ha van egy olyan állományrendszerünk (mint például a rendszer indításához használt gyökér partíció), ami már majdnem betelt, akkor egy nagyobb frissítés, például a <code>make installworld</code> parancs kiadása, során az állományrendszer egyszerûen kifogy a helybõl és így a frissítés meghiúsul.</p></div><div class=sect4><h5 id=_bõvebben_a_soft_updates_mûködésérõl>11.12.2.1. Bõvebben a Soft Updates mûködésérõl<a class=anchor href=#_bõvebben_a_soft_updates_mûködésérõl></a></h5><div class=paragraph><p>Két hagyományos megközelítés létezik az állományrendszerek metaadatainak visszaírására. (A metaadatok módosításakor olyan nem adatot tartalmazó blokkok változnak meg, mint például az állományokra vonatkozó információk vagy a könyvtárak.)</p></div><div class=paragraph><p>Eredetileg alapértelmezés szerint a metaadatok változásait szinkron módon írták ki. Amikor egy könyvtár megváltozott, a rendszer egészen addig várt, amíg ez a változás a lemezre nem íródott. Ugyanekkor az állományok adatait tartalmazó pufferek (az állományok tartalma) átkerültek a pufferelt gyorsítótárba, hogy majd késõbb, aszinkron módon kerüljenek kiírásra. Ennek az implementációnak a biztonságos mûködés volt az elõnye, mivel így a metaadatok még akkor is konzisztens állapotban maradtak, amikor valamilyen hiba következett be. Tehát egy állomány vagy teljesen létrejött vagy egyáltalán nem. Ha az állományhoz tartozó blokkok már nem tudtak kijutni a gyorsítótárból az összeomlás ideje elõtt, akkor az <a href="https://man.freebsd.org/cgi/man.cgi?query=fsck&amp;sektion=8&amp;format=html">fsck(8)</a> felismerte ezt a helyzetet és az állományrendszer ilyen jellegû hibáját úgy orvosolta, hogy az adott állomány méretét nullára állította. Ezenkívül még az implementációs részletek is tiszták és egyszerûek maradtak. Ennek viszont hátránya, hogy a metaadatok kezelése lassú. Ha például kiadunk egy <code>rm -r</code> parancsot, akkor az a könyvtárban levõ állományokat szekvenciálisan dolgozza fel, de minden egyes változtatást (az állományok törlését) csak szinkron módon rögzíti a lemezre. Ezek a frissítések érintik magát a könyvtárat, az állományokkal kapcsolatos információkat tároló táblázatot (az ún. inode táblát) és minden valószínûség szerint az állományok által lefoglalt blokkokat is közvetve. Hasonló megfontolások élnek a nagyobb könyvtárszerkezetek kibontása esetén is (<code>tar -x</code>).</p></div><div class=paragraph><p>A második lehetõség a metaadatok aszinkron frissítése. Ez az alapértelmezés a Linux ext2fs és BSD-k <code>mount -o async</code> opcióval csatlakoztatott UFS állományrendszerei esetén. Ilyenkor minden metaadattal kapcsolatos aktualizálás egyszerûen bekerült a pufferelt gyorsítótárba, tehát az állományok adatai és ezek a típusú frissítések keverednek. Ennek a megvalósításnak az az elõnye, hogy nem kell megvárni, amíg a metaadatok is kiíródnak a lemezre, ezért a metaadatok óriási mennyiségû változásával járó mûveletek sokkal gyorsabban hajtódnak végre, mint a szinkron esetben. Sõt, maga az implementáció is tiszta és egyszerû marad, ezért a kódban megjelenõ hibák beszivárgásának kockázata alacsony. A módszer hátránya, hogy egyáltalán semmilyen garanciát nem kapunk az állományrendszer konzisztenciájára. Ha tehát egy rengeteg metaadat megváltozásával együttjáró mûvelet közben történik valamilyen probléma (áramkimaradás, vagy valaki egyszerûen megnyomja a reset gombot), akkor az állományrendszer elõre kiszámíthatatlan állapotba kerül. A rendszer újbóli indításakor ezért nincs lehetõségünk megvizsgálni az állományrendszer állapotát. Elképzelhetõ, hogy az állományokhoz tartozó adatok már kikerültek a lemezre, miközben a rá vonatkozó inode- vagy könyvtári bejegyzések még nem. Így lényegében lehetetlen olyan <code>fsck</code> implementációt készíteni, ami képes lenne eltüntetni ezt a káoszt (hiszen az ehhez szükséges adatok nem állnak rendelkezésre). Ha az állományrendszer helyrehozhatatlanul károsodott, akkor csak a <a href="https://man.freebsd.org/cgi/man.cgi?query=newfs&amp;sektion=8&amp;format=html">newfs(8)</a> és a biztonsági mentés visszaállítása segíthet rajta.</p></div><div class=paragraph><p>Ezt általában úgy küszöbölik ki, hogy az egészhez hozzáteszik még a <em>módosított területek feljegyzését</em>, amit gyakran csak <em>naplózásnak</em> (journaling) neveznek, habár ezt az elnevezést nem mindenhol ilyen értelemben használják, ezért a tranzakciók naplózásának más formáira is utalhat. A metaadatok frissítése ebben az esetben is csak szinkron módon történik, de csak a lemez egy kisebb területére. Késõbb ez a megfelelõ helyére kerül. Mivel a lemez naplózásra fordított része egy viszonylag kis méretû, folytonos terület, a lemez fejének még a megterhelõbb mûveletek esetén sem kell sokat mozognia, ezért valójában ez a megoldás gyorsabb, mint a mezei szinkron frissítések. Az implementáció bonyolultsága továbbra is jól behatárolható, a velejáró hibalehetõségek kockázata alacsony. Hátránya, hogy minden metaadat kétszer íródik ki (egyszer a naplózási területre, aztán a megfelelõ helyre), ezért a hétköznapi használat során "visszaesés" tapasztalható a teljesítményben. Másrészrõl azonban egy összeomlás esetén a naplózási terület segítségével minden függõben levõ metaadattal kapcsolatos mûvelet könnyen visszafordítható vagy lezárható a rendszer következõ indításakor, így ezzel egy gyors helyreállítást nyerünk.</p></div><div class=paragraph><p>Kirk McKusick, a Berkeley FFS fejlesztõje ezt a problémát a Soft Updates segítségével hidalta át: a metaadatokkal kapcsolatos minden függõben levõ frissítést a memóriában tart, majd ezeket rendezett sorrendben írja ki a lemezre ("a metaadatok rendezett frissítése"). Ennek következményeképpen a metaadatok komolyabb frissítése során a késõbb érkezõ módosításoknak lehetõségük van "elkapni" a memóriában levõ korábbi változataikat, ha azok még nem kerültek ki a lemezre. Így az összes, például könyvtárakon végzett, mûvelet a lemezre írás elõtt általában elõször a memóriában játszódik le (az adatblokkok a pozíciójuknak megfelelõen kerülnek rendezésre, ezért a rájuk vonatkozó metaadatok elõtt nem jutnak ki a lemezre). Ha eközben a rendszer összeomlik, akkor így implicit módon a "napló visszalapozását" eredményezi: minden olyan mûvelet, ami már nem tudott kijutni a lemezre, meg nem történtnek számít. Ezen a módon az állományrendszernek egy 30 és 60 másodperc közti korábbi állapota marad fenn. Az algoritmus garantálja, hogy az összes használt erõforrás a nekik megfelelõ bittérképekben helyesen jelölõdik, a blokkokban és az inode-okban. Az összeomlás után az erõforrások kiosztásával kapcsolatban csak egyetlen hiba léphet fel: amikor olyan erõforrások jelölõdnek "használtnak", amelyek igazából "szabadok". Az <a href="https://man.freebsd.org/cgi/man.cgi?query=fsck&amp;sektion=8&amp;format=html">fsck(8)</a> azonban képes felismerni ezeket a helyzeteket és felszabadítani a nem használt erõforrásokat. A <code>mount -f</code> parancs kiadásával minden további következmény nélkül figyelmen kívül hagyhatjuk az állományrendszer félkész állapotát és csatlakoztathatjuk az állományrendszereket. A használatban már nem levõ erõforrások felszabadításához az <a href="https://man.freebsd.org/cgi/man.cgi?query=fsck&amp;sektion=8&amp;format=html">fsck(8)</a> parancsot késõbb kell futtatni. Ez az alapötlet húzódik meg a <em>háttérben végzett lemezellenõrzés</em> mögött. A rendszer indításakor az állományrendszernek csupán egy <em>pillanatképét</em> rögzítjük, és az <code>fsck</code> tényleges lefuttatását késõbbre toljuk. Mivel mindegyik állományrendszer csatlakoztatható "félkész" állapotban, ezért a rendszer képes elindulni többfelhasználós módban. Eközben a háttérben az <code>fsck</code> beütemezhetõ minden olyan állományrendszer számára, ahol arra szükség van, hogy szabadítsa fel az esetlegesen már nem használt erõforrásokat. (Így a Soft Updates opciót nem alkalmazó állományrendszerek esetén továbbra is szükség van az elõtérben elvégzett <code>fsck</code> parancsra.)</p></div><div class=paragraph><p>A módszer elõnye, hogy így a metaadatokkal kapcsolatos mûveletek közel olyan gyorsak, mint az aszinkron módon végzett frissítések (tehát gyorsabb, mintha <em>naplóznánk</em>, ami ugye minden metaadatot kétszer ír ki). A hátránya a bonyolultabb kód (ami miatt növekszik az olyan hibák lehetõsége, amelyek érzékenyen befolyásolhatják a felhasználói adatok elvesztését) és a nagyobb memóriaigény. Ezenkívül még van néhány olyan egyéni jellemzõje, amelyet meg kell szokni. A rendszer összeomlása után az állományrendszer valamivel "régebbi" lesz. Amikor pedig megszokott szinkron megközelítés szerint az <code>fsck</code> lefutása után nulla méretû állományok jönnének létre, ezek az állományok a Soft Updates esetén egyáltalán meg sem jelennek, mivel sem a rájuk vonatkozó metaadatok, sem pedig a tartalmuk nem került ki a lemezre. Egy <code>rm</code> lefuttatása után a lemezterület addig nem kerül felszabadításra, amíg a frissítések teljesen rá nem kerülnek a lemezre. Ez nagyobb mennyiségû adat telepítésekor gondokat okozhat egy olyan állományrendszeren, ahol nincs elegendõ hely az állományok kétszeri tárolására.</p></div></div></div></div><div class=sect2><h3 id=configtuning-kernel-limits>11.13. A rendszermag korlátainak finomhangolása<a class=anchor href=#configtuning-kernel-limits></a></h3><div class=sect3><h4 id=file-process-limits>11.13.1. Az állományok és a futó programok korlátozásai<a class=anchor href=#file-process-limits></a></h4><div class=sect4><h5 id=kern-maxfiles>11.13.1.1. <code>kern.maxfiles</code><a class=anchor href=#kern-maxfiles></a></h5><div class=paragraph><p>A <code>kern.maxfiles</code> értéke a rendszerünk igényeinek megfelelõen növelhetõ vagy csökkenthetõ. Ez a változó adja meg a rendszerünkben levõ állományleírók maximális számát. Amikor az állományleírókat tároló táblázat megtelik, a rendszer üzenetpufferében egy <code>file: table is full</code> üzenet jelenik meg, amit a <code>dmesg</code> paranccsal tudunk megnézni.</p></div><div class=paragraph><p>Minden megnyitott állomány, csatlakozás vagy FIFO elhasznál egy állományleírót. Egy nagyméretû szerver könnyen felemészthet több ezernyi állományleírót attól függõen, hogy milyen és mennyi szolgáltatást futtat egymás mellett.</p></div><div class=paragraph><p>A FreeBSD korábbi kiadásaiban a <code>kern.maxfiles</code> a rendszermag beállításait tartalmazó állomány <code>maxusers</code> (a rendszerben egyszerre jelenlevõ felhasználók maximumának) értékébõl származott, tehát a <code>kern.maxfiles</code> a <code>maxusers</code> értékével arányosan növekszik. Amikor készítünk egy saját rendszermagot, mindig érdemes a rendszerünk használatának megfelelõen beállítani ezt az értéket, mivel a rendszermag ebbõl a számból határozza meg a legtöbb elõre meghatározott korlátait. Mivel még egy komoly szerveren sem jelentkeznek be egyszerre 256 felhasználónál többen, nagyjából ugyanannyi erõforrásra van szüksége, mint egy nagyobb webszervernek.</p></div><div class=paragraph><p>A <code>kern.maxusers</code> értéke a rendelkezésre álló memóriának megfelelõen magától méretezõdik a rendszer indításakor, és amit futás közben csak a <code>kern.maxusers</code> sysctl változó írásvédett értékének lekérdezésébõl tudhatunk meg. Egyes oldalak üzemeltetése a <code>kern.maxusers</code> így megállapított értékétõl nagyobbat vagy éppen kisebbet igényel, ezért a betöltéskor minden gond nélkül át lehet állítani 64, 128 vagy 256 értékûre. Senkinek sem ajánljuk, hogy 256 felé menjen, hacsak tényleg nincs szüksége ekkora mennyiségû állományleíróra. A <code>kern.maxusers</code> függvényében beállított alapértelmezett értékek tetszõleges módon átállíthatóak a rendszer indításakor vagy futás közben a <span class=filename>/boot/loader.conf</span> módosításával (az ide kapcsolódó javaslatokról bõvebben lásd a <a href="https://man.freebsd.org/cgi/man.cgi?query=loader.conf&amp;sektion=5&amp;format=html">loader.conf(5)</a> man oldalt vagy a <span class=filename>/boot/defaults/loader.conf</span> állományt) illetve a leírás más részén megadott módok szerint.</p></div><div class=paragraph><p>A korábbi kiadásokban úgy lehet önszabályozóra állítani a <code>maxusers</code> beállítást, ha explicit módon <code>0</code> értéket adtunk meg neki . A <code>maxusers</code> paraméter beállításakor érdemes legalább 4-et megadni, különösen akkor, ha használjuk az X Window Systemet vagy szoftvereket fordítunk le. Azért van erre szükség, mert a <code>maxusers</code> értéke által szabályozott legfontosabb mennyiség az egyszerre futtatható programok táblázatának maximális mérete, amelyet így számolunk ki: <code>20 + 16 * maxusers</code>. Tehát ha a <code>maxusers</code> értékét 1-re állítjuk be, akkor az elõbbi képlet értelmében csak 36 programunk futhat egymással párhuzamosan, beleértve mindazt a kb. 18 programot, amelyek a rendszerrel együtt indulnak, illetve még azt a további 15 programot, amelyeket az X Window System használatával indítunk el. Még egy olyan egyszerû dolog is, mint például egy man oldal megnézése, legalább kilenc programot indít el a szûréshez, kitömörítéshez és megnézéshez. Azonban ha a <code>maxusers</code> értékét 64-re állítjuk, akkor egyszerre akár már 1044 programot futtathatunk, ami szinte mindenre elegendõ. Ha persze egy új program indításakor kapunk egy típusú üzenetet vagy nagy számú konkurens felhasználóval futtatunk szervert (ilyen például az <code>ftp.FreeBSD.org</code>), akkor érdemes növelni ezt a számot és újrafordítani a rendszermagot.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>A <code>maxusers</code> <em>nem</em> korlátozza a számítógépre egyszerre bejelentkezni képes felhasználók számát. Egyszerûen csak beállítja néhány táblázat méretét és az egyszerre futtatható programok mennyiségét a rendszert egyidejûleg használni kívánó felhasználók maximális számának figyelembevételével.</p></div></td></tr></tbody></table></div></div><div class=sect4><h5 id=_kern_ipc_somaxconn>11.13.1.2. <code>kern.ipc.somaxconn</code><a class=anchor href=#_kern_ipc_somaxconn></a></h5><div class=paragraph><p>Az <code>kern.ipc.somaxconn</code> sysctl változó a beérkezõ TCP kapcsolatokat fogadó sor hosszát határozza meg. Ennek az alapértelmezett értéke <code>128</code>, ami az új kapcsolatok megbízható kezeléséhez általában kevés egy erõsen leterhelt webszerver számára. Ilyen helyzetekben ezt az értéket javasolt <code>1024</code>-re vagy még annál is nagyobbra állítani. Az egyes szolgáltatások démonai ugyan szintén korlátozni szokták a fogadósoruk méretét (például a <a href="https://man.freebsd.org/cgi/man.cgi?query=sendmail&amp;sektion=8&amp;format=html">sendmail(8)</a> vagy az Apache), de gyakran találunk a beállításai között olyat, amivel ennek a sornak a mérete növelhetõ. A nagyobb fogadósorok mellesleg jó szolgálatot tesznek a Denial of Service () típusú támadásokkal szemben is.</p></div></div></div><div class=sect3><h4 id=nmbclusters>11.13.2. Hálózati korlátozások<a class=anchor href=#nmbclusters></a></h4><div class=paragraph><p>A rendszermag <code>NMBCLUSTERS</code> nevû beállítása szab határt a rendszer részére elérhetõ memóriapufferek mennyiségének. Egy nagyobb forgalmú szerver esetén a pufferek alacsony száma gátat szabhat a FreeBSD képességeinek. Minden klaszter nagyjából 2 KB memóriát takar, így az 1024-es érték azt jelenti, hogy a rendszermag memóriájából 2 megabyte-ot fordítunk a hálózati pufferelésre. Egyszerûen kiszámítható, mennyire is van szükségünk: ha van egy webszerverünk, amely egyszerre legfeljebb 1000 párhuzamos kapcsolatot fogad, és minden kapcsolat lefoglal 16 KB-ot a fogadó-, valamint újabb 16 KB-ot a küldõpuffer számára, akkor megközelítõleg 32 MB-nyi hálózati pufferre lesz szükségünk a webszerver hatékony mûködéséhez. Ezt az értéket gyakran még érdemes megszorozni kettõvel, így 2 x 32 MB / 2 KB = 64 MB / 2 KB = 32768. Több memóriával rendelkezõ számítógépek esetén egy 4096 és 32768 közti értéket javaslunk. Semmilyen körülmények között ne adjunk meg ennél nagyobb értéket, mert ezzel a rendszer már az indítása során összeomolhat. A <a href="https://man.freebsd.org/cgi/man.cgi?query=netstat&amp;sektion=1&amp;format=html">netstat(1)</a> <code>-m</code> beállításával ellenõrizhetjük a hálózati klaszterek kihasználtságát.</p></div><div class=paragraph><p>A <code>kern.ipc.nmbclusters</code> változó értékét a rendszer indításakor érdemes megváltoztatni. A FreeBSD korábbi változataiban ehhez a rendszermag <code>NMBCLUSTERS</code> nevû <a href="https://man.freebsd.org/cgi/man.cgi?query=config&amp;sektion=8&amp;format=html">config(8)</a> paraméterének módosítására van szükségünk.</p></div><div class=paragraph><p>Az olyan forgalmasabb szervereken, ahol sokat használják a <a href="https://man.freebsd.org/cgi/man.cgi?query=sendfile&amp;sektion=2&amp;format=html">sendfile(2)</a> rendszerhívást, szükségünk lehet a <a href="https://man.freebsd.org/cgi/man.cgi?query=sendfile&amp;sektion=2&amp;format=html">sendfile(2)</a> által használt pufferek számának növelésére a rendszermag <code>NFSBUFS</code> nevû konfigurációs paraméterén vagy a <span class=filename>/boot/loader.conf</span> állományon keresztül (lásd <a href="https://man.freebsd.org/cgi/man.cgi?query=loader&amp;sektion=8&amp;format=html">loader(8)</a>). Amikor a futó programok közül sokan vannak <code>sfbufa</code> állapotban, akkor az egyértelmûen annak a jele, hogy ezen a paraméteren állítanunk kell. A <code>kern.ipc.nsfbufs</code> egy írásvédett változót, amelyet a rendszermag állít be. Ez a paraméter névlegesen a <code>kern.maxusers</code> változó értékének megfelelõen változik, de bizonyos esetekben ettõl függetlenül önállóan kell behangolni.</p></div><div class="admonitionblock important"><table><tbody><tr><td class=icon><i class="fa icon-important" title=Important></i></td><td class=content><div class=paragraph><p>Annak ellenére, hogy egy socketet blokkolásmentesnek jelöltünk meg, a <a href="https://man.freebsd.org/cgi/man.cgi?query=sendfile&amp;sektion=2&amp;format=html">sendfile(2)</a> meghívása egy blokkolásmentes socketre blokkolódást eredményezhet egészen addig, amíg a használatához elegendõ <code>struct sf_buf</code> struktúra össze nem gyûlik.</p></div></td></tr></tbody></table></div><div class=sect4><h5 id=_net_inet_ip_portrange>11.13.2.1. <code>net.inet.ip.portrange.*</code><a class=anchor href=#_net_inet_ip_portrange></a></h5><div class=paragraph><p>A <code>net.inet.ip.portrange.*</code> sysctl változók vezérlik a TCP és UDP csatlakozásokhoz automatikusan hozzárendelt portszámok tartományát. Három ilyen tartomány létezik: az alsó, az alapértelmezett és a felsõ tartomány. A legtöbb hálózati program a <code>net.inet.ip.portrange.first</code> és <code>net.inet.ip.portrange.last</code> változók által rendre az 1024-tõl 5000-ig kijelölt alapértelmezett tartományt használja. A kimenõ kapcsolatok is rögzített porttartományokat követnek, és adott körülmények mellett be lehet állítani úgy a rendszerünket, hogy ezen kívül osszon ki portokat. Ez a legtöbbször akkor fordul elõ, amikor egy erõsen leterhelt webproxyt mûködtetünk. A porttartományok nem okoznak gondot olyan szervereknél, ahol általában bejövõ kapcsolatokra lehet számítani, tehát például webszerverek esetén, vagy ahol korlátozott a kimenõ kapcsolatok száma, mint például a levelek továbbításánál. Ha olyan helyzetbe keverednénk, ahol már kifutunk a felhasználható portokból, a <code>net.inet.ip.portrange.last</code> mérsékelt növelésével javasolt kitörni. Ilyenkor a <code>10000</code>, <code>20000</code> vagy <code>30000</code> értékek elfogadhatóak. Amikor megváltoztatjuk a porttartományok határait, elõtte mindig gondoljuk át, milyen hatással lehet ez a tûzfalra. Egyes tûzfalak blokkolhatnak bizonyos tartományokat (általában az alacsonyabbakat) és arra számítanak, hogy a rendszerek a kimenõ kapcsolatokhoz a nagyobb számú portokat használják - ebbõl kifolyólag nem ajánlott csökkenteni a <code>net.inet.ip.portrange.first</code> értékét.</p></div></div><div class=sect4><h5 id=_a_tcp_sávszélesség_késletetés_szorzat>11.13.2.2. A TCP sávszélesség-késletetés szorzat<a class=anchor href=#_a_tcp_sávszélesség_késletetés_szorzat></a></h5><div class=paragraph><p>A TCP sávszélesség-késleltetés szorzat korlátozása hasonlít a NetBSD-ben megtalálható TCP/Vegas implementációhoz. A <code>net.inet.tcp.inflight.enable</code> sysctl változó <code>1</code>-re állításával lehet engedélyezni. A rendszer ilyenkor minden egyes kapcsolathoz megpróbálja kiszámítani a sávszélesség-késleltetés szorzatot és az optimális átviteli sebesség fenntartásához illeszkedõen korlátozni a hálózat felé küldött adatok sorának hosszát.</p></div><div class=paragraph><p>Ez a lehetõség még olyankor bizonyulhat hasznosnak, amikor modemen, Gigabit Etherneten vagy nagysebességû WAN (vagy bármilyen más nagy sávszélesség-késleltetés szorzattal bíró) összeköttetéseken keresztül küldünk át adatokat, különösen abban az esetben, amikor ablakméretezést is használnunk vagy nagy küldési ablakot állítottunk be. Az engedélyezésekor ne felejtsük el <code>net.inet.tcp.infligt.debug</code> változót sem beállítani <code>0</code>-ra (amivel így kikapcsoljuk a nyomkövetést),éles használat esetén pedig elõnyös lehet a <code>net.inet.cp.inflight.min</code> változót legalább <code>6144</code>-re állítani. Azonban hozzátesszük, hogy összeköttetéstõl függõen a nagy minimum értékek tulajdonképpen kikapcsolják a sávszélességkorlátozást. Ez a korlátozási lehetõség csökkenti a közbensõ út adatainak és csomagváltásokhoz tartozó soroknak a méretét, miközben csökkenti a helyi számítógép felületén felépülõ sorok méretét is. Ha kevesebb csomagot rakunk be a sorba, akkor az interaktív kapcsolatok, különösen a lassabb modemek esetében, kisebb <em>körbejárási idõvel</em> (Round Trip Time) mûködnek. Továbbá megemlítenénk, hogy ez a lehetõség csak az adatok küldésére (feltöltésére, szerveroldalra) van hatással. Semmilyen befolyása nincs az adatok fogadására (letöltésére).</p></div><div class=paragraph><p>A <code>net.inet.tcp.inflight.stab</code> állítgatása <em>nem</em> ajánlott. A paraméter értéke alapértelmezés szerint 20, ami legfeljebb 2 csomag hozzáadását jelenti a sávszélesség-késleltetés szorzat ablakának kiszámításakor. Erre a kiegészítõ ablakra azért van szükség, hogy stabilizálni tudjuk vele az algoritmust és javítani tudjuk a változó feltételekre adott reakciót, de lassabb összeköttetések esetében nagyobb ping idõket is eredményezhet (habár ezek még így kisebbek, mint ha nem használnánk az algoritmust). Ilyen esetekben megpróbálhatjuk 15-re, 10-re vagy esetleg 5-re visszavenni a paraméter értékét, de ekkor a kívánt hatás eléréséhez minden bizonnyal a <code>net.inet.tcp.inflight.min</code> értékét is redukálunk kell majd (például 3500-ra). Ezen paraméterek megváltoztatását csak végsõ esetben ajánljuk!</p></div></div></div><div class=sect3><h4 id=_virtuális_memória>11.13.3. Virtuális memória<a class=anchor href=#_virtuális_memória></a></h4><div class=sect4><h5 id=_kern_maxvnodes>11.13.3.1. <code>kern.maxvnodes</code><a class=anchor href=#_kern_maxvnodes></a></h5><div class=paragraph><p>A vnode egy állomány vagy könyvtár belsõ ábrázolása. Ennek megfelelõen a vnode-ok számának növelésével az operációs rendszer spórolni tud a lemezmûveletekkel. Ezt általában maga az operációs rendszer szabályozza, és nincs szükség a finomhangolására. Néhány esetben, amikor a lemezmûveletek jelentik a rendszerben a szûk keresztmetszetet és kezdenek elfogyni a vnode-ok, szükség lehet ennek a számnak a növelésére. Ehhez az inaktív és szabad fizikai memória mennyiségét kell számításba vennünk.</p></div><div class=paragraph><p>Így kérhetjük le a pillanatnyilag használatban levõ vnode-ok mennyiségét:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># sysctl vfs.numvnodes</span>
vfs.numvnodes: 91349</code></pre></div></div><div class=paragraph><p>Így tudhatjuk meg a vnode-ok maximális számát:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># sysctl kern.maxvnodes</span>
kern.maxvnodes: 100000</code></pre></div></div><div class=paragraph><p>Ha a vnode-ok aktuális kihasználtsága megközelíti a csúcsértéket, nagyjából ezerrel javasolt megnövelni a <code>kern.maxvnodes</code> értékét. Ezután figyeljük továbbra is a <code>vfs.numvnodes</code> változását. Ha ismét felkúszik a maximális értékre, akkor növeljük megint egy keveset a <code>kern.maxvnodes</code> értékén. Eközben a <a href="https://man.freebsd.org/cgi/man.cgi?query=top&amp;sektion=1&amp;format=html">top(1)</a> használatával figyelhetjük a memória kihasználtságának növekedését is, ilyenkor tehát több memóriának kell használatban lennie.</p></div></div></div></div><div class=sect2><h3 id=adding-swap-space>11.14. A lapozóterület bõvítése<a class=anchor href=#adding-swap-space></a></h3><div class=paragraph><p>Nem számít, mennyire tervezünk jól elõre, mindig elõfordulhat, hogy a rendszerünk mégsem teljesíti a kitûzött elvárásokat. Amennyiben további lapozóterület hozzáadására lenne szükségünk, azt igen könnyen megtehetjük. Háromféleképpen növelhetjük a lapozásra szánt területet: hozzáadunk a rendszerhez egy újabb merevlemezes meghajtót, NFS-en keresztül lapozunk, vagy egy már meglevõ partíción hozunk létre lapozóállományt.</p></div><div class=paragraph><p>A lapozóterület titkosításával, valamint annak lehetõségeivel és okaival kapcsolatban lapozzuk fel a kézikönyv <a href=./#swap-encrypting>A lapozóterület titkosítása</a>át.</p></div><div class=sect3><h4 id=new-drive-swap>11.14.1. Lapozás egy új merevlemezre<a class=anchor href=#new-drive-swap></a></h4><div class=paragraph><p>A lapozóterület bõvítésének legjobb módja természetesen remek indok egy új merevlemez beszerzésére is. Elvégre egy merevlemezt mindig fel tudunk ilyen célra használni. Ha ezt a megoldást választjuk, elõtte ajánlott (újra) elolvasni a kézikönyv <a href=#configtuning-initial>Kezdeti beállítások</a>ában a lapozóterületek elrendezésére vonatkozó javaslatokat.</p></div></div><div class=sect3><h4 id=nfs-swap>11.14.2. Lapozás NFS-en keresztül<a class=anchor href=#nfs-swap></a></h4><div class=paragraph><p>NFS-en keresztül csak akkor lapozzunk, ha ezt helyi lemezek segítségével nem tudjuk megtenni. Az NFS alapú lapozás hatékonyságát erõsen behatárolja a rendelkezésre álló hálózati sávszélesség és további terheket ró az NFS szerverünkre is.</p></div></div><div class=sect3><h4 id=create-swapfile>11.14.3. Lapozóállományok<a class=anchor href=#create-swapfile></a></h4><div class=paragraph><p>Lapozóállománynak egy adott méretû állományt hozzunk létre. Ebben a példában erre egy <span class=filename>/usr/swap0</span> nevû, 64 MB méretû állományt fogunk használni. Természetesen bármilyen más nevet is választhatunk.</p></div><div class=exampleblock><div class=title>Példa 6. Lapozóállomány létrehozása FreeBSD-ben</div><div class=content><div class="olist arabic"><ol class=arabic><li><p>Gyõzõdjünk meg róla, hogy a rendszermagunk beállításai között megtalálható a memórialemez meghajtójának (<a href="https://man.freebsd.org/cgi/man.cgi?query=md&amp;sektion=4&amp;format=html">md(4)</a>) használata. Ez a <span class=filename>GENERIC</span> rendszermag alapból tartalmazza.</p><div class="literalblock programlisting"><div class=content><pre>device   md   # Memória &#34;lemezek&#34;</pre></div></div></li><li><p>Hozzunk létre egy lapozóállományt (<span class=filename>/usr/swap0</span>):</p><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># dd if=/dev/zero of=/usr/swap0 bs=1024k count=64</span></code></pre></div></div></li><li><p>Állítsuk be rá a megfelelõ engedélyeket (<span class=filename>/usr/swap0</span>):</p><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># chmod 0600 /usr/swap0</span></code></pre></div></div></li><li><p>Adjuk meg a lapozóállományt az <span class=filename>/etc/rc.conf</span> állományban:</p><div class="literalblock programlisting"><div class=content><pre>swapfile=&#34;/usr/swap0&#34;   # Állítsuk be swapfile értékét, ha külsõ lapozóállományra van szükségünk.</pre></div></div></li><li><p>Indítsuk újra a számítógépünket, vagy a lapozóállomány azonnali használtba vételéhez írjuk be:</p><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># mdconfig -a -t vnode -f /usr/swap0 -u 0 &amp;&amp; swapon /dev/md0</span></code></pre></div></div></li></ol></div></div></div></div></div><div class=sect2><h3 id=acpi-overview>11.15. Energia- és erõforrásgazdálkodás<a class=anchor href=#acpi-overview></a></h3><div class=paragraph><p>Fontos a hardveres erõforrásaink hatékony kihasználása. Az ACPI megjelenése elõtt az operációs rendszerek csak nehézkesen és rugalmatlanul tudták kezelni a rendszer energiafelhasználási és hõszabályzási lehetõségeit. A hardvert a BIOS kezelte, ezért a felhasználó kevesebbet tudott látni és irányítani az energiagazdálkodási beállításokból. Az <em>Fejlett energiagazdálkodás (Advanced Power Management, APM)</em> ehhez nyújtott egy erõsen korlátozott felületet. Napjaink operációs rendszereiben az energia- és erõforráskezelés az egyik legfontosabb alkotóelem. Például, ha az operációs rendszerrel folyamatosan figyelni akarjuk a rendszer hõmérsékletének váratlan növekedését (és errõl figyelmeztetést kérni).</p></div><div class=paragraph><p>A FreeBSD kézikönyvének ezen szakaszában az ACPI-rõl adunk egy átfogó áttekintést, a végén pedig összefoglaljuk a témához tartozó irodalmat.</p></div><div class=sect3><h4 id=acpi-intro>11.15.1. Mi az ACPI?<a class=anchor href=#acpi-intro></a></h4><div class=paragraph><p>A speciális energia- és konfigurációs illesztõ felület (Advanced Configuration and Power Interface, avagy ACPI) gyártók egy csoportja által létrehozott szabvány, amely a hardveres erõforrások és az energiagazdálkodás egységes felületét rögzíti (innen a neve). Döntõ szerepet játszik a <em>Beállítások és az energiagazdálkodás operációs rendszerek áltai vezérlésében</em>, vagyis segítségével az operációs rendszer még nagyobb mértékben és rugalmassággal tudja irányítani ezeket a lehetõségeket. A modern operációs rendszerek az ACPI felbukkanásával "kitolták" a jelenleg meglevõ Plug and Play felületek korlátait. Az ACPI az APM közvetlen leszármazottja.</p></div></div><div class=sect3><h4 id=acpi-old-spec>11.15.2. A Fejlett energiagazdálkodás (APM) hiányosságai<a class=anchor href=#acpi-old-spec></a></h4><div class=paragraph><p>A <em>Fejlett energiagazdálkodás (APM)</em> a rendszer által felhasznált energiát annak elfoglaltsága alapján vezérli. Az APM-et támogató BIOS-t a (rendszert) gyártó állítja elõ és az adott hardverplatformra jellemzõ. Az APM operációs rendszerben levõ meghajtója hozzáférést biztosít az <em>APM szoftveres felületéhez</em>, amivel lehetõség nyílik az energiaszintek kezelésére. Az APM-et 2000 elõtt és körül még mindig használták egyes rendszerek gyártásánál.</p></div><div class=paragraph><p>Az APM használata négy nagyobb gondot rejt magában. Elõször is, az energiagazdálkodást a (gyártófüggõ) BIOS végzi el, és az operációs rendszernek errõl semmilyen ismerete nincsen. Ennek egyik példája az, amikor a felhasználó az APM-et ismerõ BIOS-ban beállítja a merevlemezek automatikus kikapcsolásának idejét, majd amikor ez letelik, a BIOS az operációs rendszer tudta nélkül egyszerûen leállítja a lemezt. Másodszor: az APM mûködését a BIOS-ban programozták le, és teljesen az operációs rendszer hatáskörén túl tevékenykedik. Ez azt jelenti, hogy a felhasználó csak úgy tudja korrigálni az APM-es BIOS-ok problémáit, ha frissíti az alaplapi ROM-ot. Ez viszont egy nagyon kockázatos folyamat, amelynek hibája révén a rendszerünk helyrehozhatatlan állapotba kerülhet. Harmadszor: az APM alapvetõen egy gyártófüggõ megoldás, ami azt vonja maga után, hogy sok az átfedés (ugyanazt valósítják meg több módon), és ha az egyik gyártó BIOS-ában hibát találnak, akkor a másikéban az nem feltétlenül javítható. Végül, de nem utolsósorban, az APM alapú BIOS-okban nincs elég hely az igazán kifinomult energiagazdálkodási sémák vagy bármi más kialakítására, amivel a felhasználók képesek lennének az igényeikhez alakítani a számítógépet.</p></div><div class=paragraph><p>A <em>Plug and Play BIOS (PNPBIOS)</em> sok szempontból megbízhatatlannak bizonyult. A PNPBIOS ráadásul egy 16 bites megoldás, ezért az operációs rendszereknek 16 bites emulációt kell használniuk a PNPBIOS eszközeinek "eléréséhez".</p></div><div class=paragraph><p>A FreeBSD APM meghajtójának dokumentációját az <a href="https://man.freebsd.org/cgi/man.cgi?query=apm&amp;sektion=4&amp;format=html">apm(4)</a> man oldalon találjuk.</p></div></div><div class=sect3><h4 id=acpi-config>11.15.3. Az ACPI beállítása<a class=anchor href=#acpi-config></a></h4><div class=paragraph><p>Az <span class=filename>acpi.ko</span> meghajtó alapértelmezés szerint a <a href="https://man.freebsd.org/cgi/man.cgi?query=loader&amp;sektion=8&amp;format=html">loader(8)</a> segítségével töltõdik be, és <em>ne</em> is fordítsuk bele a rendszermagba. Ezt azzal tudnánk magyarázni, hogy modulokkal könnyebb dolgozni, például ha a rendszermag újrafordítása nélkül egy másik <span class=filename>acpi.ko</span> modult akarunk használni. Ezzel a lényegében a tesztelés is egyszerûbbé válik. Másik magyarázat, hogy a rendszer ACPI támogatása nem minden esetben mûködik rendesen. Ha a rendszer indítása során valamilyen problémát tapasztalunk, akkor próbálkozzunk meg az ACPI kikapcsolásával. Ezt a meghajtót nem lehet és nem is szabad kidobni a memóriából, mivel a hardverrel a rendszerbuszon keresztül tartja a kapcsolatot. Az ACPI a <code>hint.acpi.0.disabled="1"</code> sor megadásával kapcsolható a <span class=filename>/boot/loader.conf</span> állományban vagy a <a href="https://man.freebsd.org/cgi/man.cgi?query=loader&amp;sektion=8&amp;format=html">loader(8)</a> parancssorában.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Az ACPI és az APM nem használató egyszerre. Közülük a késõbb betöltött magától kilép, ha észreveszi, hogy a másikuk már mûködésbe lépett.</p></div></td></tr></tbody></table></div><div class=paragraph><p>Az ACPI és az <a href="https://man.freebsd.org/cgi/man.cgi?query=acpiconf&amp;sektion=8&amp;format=html">acpiconf(8)</a> használatával a rendszerünk készenléti módba helyezhetõ az <code>-s</code> valamint az <code>1-5</code> paraméterek megadásával. Ezek közül is a legtöbb felhasználó számára csak az <code>1</code> vagy a <code>3</code> (állapot mentése a fizikai memóriába) érdekes. Az <code>5</code> opció egy szoftveres kikapcsolást eredményez, ehhez hasonlóan:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># halt -p</span></code></pre></div></div><div class=paragraph><p>A további opciók a <a href="https://man.freebsd.org/cgi/man.cgi?query=sysctl&amp;sektion=8&amp;format=html">sysctl(8)</a> man oldaláról érhetõek el. Ezen kívül még olvassuk el az <a href="https://man.freebsd.org/cgi/man.cgi?query=acpi&amp;sektion=4&amp;format=html">acpi(4)</a> és <a href="https://man.freebsd.org/cgi/man.cgi?query=acpiconf&amp;sektion=8&amp;format=html">acpiconf(8)</a> man oldalakat is.</p></div></div></div><div class=sect2><h3 id=ACPI-debug>11.16. A FreeBSD ACPI támogatásának használata és nyomonkövetése<a class=anchor href=#ACPI-debug></a></h3><div class=paragraph><p>Az ACPI az eszközök felderítésének, energiagazdálkodásának és a korábban a BIOS által kezelt hardverek szabványosított hozzáférésének alapjaiban új módja. Az ACPI folyamatosan fejlõdik, de útját az egyes alaplapok <em>ACPI Machine Language</em> (AML) bytekód implementációjában megjelenõ hibák, a FreeBSD rendszermag alrendszereinek befejezetlensége és az Intel® ACPI-CA értelmezõjében levõ hibák lassítják.</p></div><div class=paragraph><p>Ez a leírás azzal a szándékkal készült, hogy segítsünk a felhasználóknak megtalálni az általuk tapasztalt problémák gyökerét és ezzel segíteni az ACPI fejlesztõket a nyomonkövetésében és kijavításában. A fejlesztõk köszönik, hogy ezt elolvassuk és segédkezünk a rendszerünkkel kapcsolatban felmerülõ problémák orvosolásában!</p></div><div class=sect3><h4 id=ACPI-submitdebug>11.16.1. A nyomkövetési információk beküldése<a class=anchor href=#ACPI-submitdebug></a></h4><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Mielõtt beküldenénk bármilyen problémát is, gondoskodjunk róla, hogy a BIOS-unk, és ha lehetséges, akkor a beágyazott vezérlõk, legfrissebb verzióját használjuk.</p></div></td></tr></tbody></table></div><div class=paragraph><p>Megkérnénk azokat, akik hibát akarnak bejelenteni, hogy a következõ információkat küldjék a <a href=mailto:freebsd-acpi@FreeBSD.org></a><a href=mailto:freebsd-acpi@FreeBSD.org>freebsd-acpi@FreeBSD.org</a> címre:</p></div><div class=ulist><ul><li><p>A hibás mûködés leírása, beleértve a rendszer típusát és gyártmányát, illetve minden olyat, aminek köze lehet a hibához. Ha eddig még nem tapasztaltuk, igyekezzünk minél pontosabban leírni a hiba keletkezésének folyamatát.</p></li><li><p>A <code>boot -v</code> paranccsal indított rendszer <a href="https://man.freebsd.org/cgi/man.cgi?query=dmesg&amp;sektion=8&amp;format=html">dmesg(8)</a> kimenetét, beleértve a vizsgálni kívánt hiba által okozott összes hibaüzenetet.</p></li><li><p>A <code>boot -v</code> paranccsal és az ACPI használata nélkül indított rendszer <a href="https://man.freebsd.org/cgi/man.cgi?query=dmesg&amp;sektion=8&amp;format=html">dmesg(8)</a> kimenete abban az esetben, ha ez segít megoldani a problémát.</p></li><li><p>A <code>sysctl hw.acpi</code> parancs kimenete. Ezzel egyébként kitûnõen kideríthetõ, milyen lehetõségeket is kínál fel a rendszerünk.</p></li><li><p>Az általunk használt <em>ACPI forrásnyelvének</em> (ACPI Source Language, ASL) elérhetõsége az interneten. Mivel ezek akár igen nagyok is lehetnek, ezért a listára közvetlenül ne küldjünk ASL kódokat! Az ASL másolatát az alábbi parancs kiadásával hozhatjuk létre:</p><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># acpidump -dt &gt; név-rendszer.asl</span></code></pre></div></div><div class=paragraph><p>(Adjuk meg a <em>név</em> helyett a bejelentkezéshez használt nevünket, a <em>rendszer</em> helyett pedig a gyártót/típust. Például: <span class=filename>njl-FooCo6000.asl</span>)</p></div></li></ul></div><div class=paragraph><p>Habár a legtöbb fejlesztõ a <a href=https://lists.FreeBSD.org/subscription/freebsd-current>FreeBSD-CURRENT levelezési lista</a>t figyeli, a problémáink leírását mindenképpen a <a href=https://lists.FreeBSD.org/subscription/freebsd-acpi>FreeBSD ACPI levelezési lista</a> listára küldjük, hogy biztosan észrevegyék. A fejlesztõk azt kérik, hogy legyünk türelmesek, hiszen emellett mindannyian teljes állásban is dolgoznak. Ha az általunk felfedezett hiba nem teljesen egyértelmû, akkor a fejlesztõk valószínûleg meg fognak kérni arra, hogy a <a href="https://man.freebsd.org/cgi/man.cgi?query=send-pr&amp;sektion=1&amp;format=html">send-pr(1)</a> használatával hozzunk róla létre egy hivatalos hibajelentést. A hibajelentés készítésekor lehetõleg a fentebb megadott információkat ugyanúgy adjuk meg. Ez segít a probléma szemmel tartásában és elhárításában. Az <a href=https://lists.FreeBSD.org/subscription/freebsd-acpi>FreeBSD ACPI levelezési lista</a> lista kihagyása nélkül közvetlenül ne küldjünk hibajelentést, mivel a hibabejelentõ rendszert elsõsorban emlékeztetõnek használjuk, nem pedig a hibák tényleges bejelentésére. Gyakran elõfordul, hogy valaki korábban már találkozott az adott problémával.</p></div></div><div class=sect3><h4 id=ACPI-background>11.16.2. Háttér<a class=anchor href=#ACPI-background></a></h4><div class=paragraph><p>Az ACPI minden olyan modern számítógépben megtalálható, mely megfelel az ia32 (x86), ia64 (Itanium) vagy amd64 (AMD) architektúrának. A teljes szabvány rengeteg lehetõséget biztosít, többek közt a processzor teljesítményének kezelését, az energiaszintek vezérlését, hõzónákat, különféle akkumulátor rendszereket, beágyazott vezérlõk és a buszok felsorolását. A legtöbb rendszer általában nem a teljes szabványt valósítja meg. Például egy asztali rendszer általában csak a buszok felsorolásával kapcsolatos részeket tartalmazza, miközben egy laptop felajánlhatja a hûtés és az akkumulátor kezelését is. A laptopokban gyakorta találunk készenléti üzemmódot a maguk elbonyolított formájában.</p></div><div class=paragraph><p>Egy ACPI-nak megfelelõ rendszert számos összetevõ alkot. A BIOS-ok és chipkészletek gyártói a memóriában egy elõre rögzített ponton elhelyeznek bizonyos táblázatokat (például FADT), amelyekkel megadják például az APIC összerendeléseit (ezt az SMP rendszerek használják), a konfigurációs regisztereket és az egyszerûbb konfigurációs értékeket. Itt ezenkívül még bytekódok egy táblázata (amit <em>Differenciált rendszerleírtó táblának</em>, Differentiated System Description Table, DSDT nevezünk) is megtalálható, ahol az eszközök és módszerek nevei szerepelnek faszerû elrendezésben.</p></div><div class=paragraph><p>Az ACPI-hoz tartozó meghajtónak képesnek kell lennie értelmezni ezeket a rögzített táblázatokat, implementálni egy bytekód-értelmezõt, módosítani az eszközmeghajtókat és a rendszermagot az ACPI alrendszerbõl érkezõ információk befogadásához. A Linuxszal és a NetBSD-vel közösen a FreeBSD kapott egy ilyen értelmezõt az Intel®tõl (ACPI-CA). Az ACPI-CA forráskódja a rendszer forrásai között, a <span class=filename>src/sys/dev/acpica</span> könyvtárban található. A <span class=filename>src/sys/dev/acpica/0sd</span> könyvtárban található források pedig lehetõvé teszik, hogy az ACPI-CA mûködhessen FreeBSD-n. Végezetül, az ACPI eszközöket megvalósító meghajtók a <span class=filename>src/sys/dev/acpica</span> könyvtárban találhatóak.</p></div></div><div class=sect3><h4 id=ACPI-comprob>11.16.3. Gyakori problémák<a class=anchor href=#ACPI-comprob></a></h4><div class=paragraph><p>Az ACPI megfelelõ mûködéséhez minden alkotórésznek helyesen kell mûködnie. A most következendõkben elõfordulásuk gyakorisága szerint felsorolunk néhány ismert problémát, valamint a hozzájuk tartozó javításokat vagy elkerülésük módszerét.</p></div><div class=sect4><h5 id=_gondok_az_egérrel>11.16.3.1. Gondok az egérrel<a class=anchor href=#_gondok_az_egérrel></a></h5><div class=paragraph><p>Egyes esetekben felfüggesztett állapotból visszatérve az egerünk nem hajlandó mûködni. Ezt úgy lehet elkerülni, ha <span class=filename>/boot/loader.conf</span> állományba beírjuk a <code>hint.psm.0.flags="0x3000"</code> sort. Ha ez nem segít, akkor a fentieknek megfelelõen küldjünk be egy hibajelentést.</p></div></div><div class=sect4><h5 id=_felfüggesztésfolytatás>11.16.3.2. Felfüggesztés/Folytatás<a class=anchor href=#_felfüggesztésfolytatás></a></h5><div class=paragraph><p>Az ACPI három (STR) állapotban képes a fizikai memória segítségével készenléti módba váltani, ezek az <code>S1</code>-<code>S3</code>, és egy állapotban használja a lemezt (<code>STD</code>), amelyet <code>S4</code>-nek hívnak. Az <code>S5</code> neve a "szoftveres kikapcsolás", ami egy olyan állapotot takar, amikor a rendszerünk áram alatt van, de még nem üzemel. Az <code>S4</code>BIOS állapot a BIOS segítségével a lemezre menti a rendszert, az <code>S4</code>OS állapotot pedig teljes egészében az operációs rendszer valósítja meg.</p></div><div class=paragraph><p>A rendszerünk által ismert készenléti módokat a <code>sysctl hw.acpi</code> paranccsal ellenõrizhetjük. Íme mindez egy Thinkpad esetén:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>hw.acpi.supported_sleep_state: S3 S4 S5
hw.acpi.s4bios: 0</code></pre></div></div><div class=paragraph><p>Ez azt jelenti, hogy az <code>acpiconf -s</code> parancs kiadásával kipróbálhatjuk az <code>S3</code>, <code>S4</code>OS, és <code>S5</code> állapotokat. Ha az <code>s4bios</code> értéke egy (<code>1</code>), akkor az <code>S4</code>BIOS támogatása helyett az <code>S4</code>OS állapotot kapjuk.</p></div><div class=paragraph><p>A felfüggesztés és folytatás kipróbálása során kezdjük az <code>S1</code> állapottal, már amennyiben az támogatott a rendszerünkön. Ez az állapot többnyire használható, mivel nem igényel túlságosan sok támogatást a meghajtó részérõl. Eddig még senki sem implementálta az <code>S2</code> állapotot, de ha ezt is tudja a rendszerünk, akkor az <code>S1</code>-hez hasonlót nyerünk vele. A következõ próba az <code>S3</code> állapoté. Ez a legmélyebb STR állapot, és a hardver megfelelõ újraélesztéséhez rengeteg támogatás szükségeltetik a meghajtó részérõl. Ha gondjaink lennének a rendszerünk felébresztésével, nyugodtan írjunk egy levelet a <a href=https://lists.FreeBSD.org/subscription/freebsd-acpi>FreeBSD ACPI levelezési lista</a> listára, ám a probléma gyors megoldódásában ne reménykedjünk, hiszen ehhez még temérdek meghajtón és hardveren kell tesztelni és kell dolgozni.</p></div><div class=paragraph><p>Felfüggesztés és folytatás esetén gyakori probléma, hogy sok eszközmeghajtó nem menti el, nem állítja vissza vagy éppen nem hozza újra rendesen mûködésbe az adott eszközön található firmware-t, a regisztereket vagy memóriát. Az okok felderítéséhez elõször érdemes a következõket kipróbálni:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># sysctl debug.bootverbose=1</span>
<span class=c># sysctl debug.acpi.suspend_bounce=1</span>
<span class=c># acpiconf -s 3</span></code></pre></div></div><div class=paragraph><p>Ezzel a módszerrel tesztelni tudjuk az összes meghajtó felfüggesztési és folytatási rutinjait anélkül, hogy ténylegesen <code>S3</code> állapotba helyeznénk az eszközt. Bizonyos esetekben ezzel könnyen elcsíphetõ a hiba (például a firmware állapotának elvesztése, watchdog time out, megállás nélküli újrapróbálkozások). A rendszer ilyenkor nem vált <code>S3</code> állapotra, vagyis az eszköz nem kerül energiatakarékos állapotba, és eltérõen a valós <code>S3</code> állapottól továbbra is mûködik még abban az esetben is, amikor a szükséges felfüggesztési és folytatási rutinok teljesen hiányoznak.</p></div><div class=paragraph><p>Komolyabb esetben további segédeszközökre lesz szükségünk, vagyis soros portra és kábelre a soros vonali nyomkövetéshez, vagy Firewire portra és kábelre a <a href="https://man.freebsd.org/cgi/man.cgi?query=dcons&amp;sektion=4&amp;format=html">dcons(4)</a> használatához, valamint némi tapasztalatra a rendszermagon belüli hibakeresésben.</p></div><div class=paragraph><p>A problémát nagy mértékben segíti különválasztani, ha igyekszünk minél több meghajtót kivenni a rendszermagból. Ha így javul a helyzet, akkor már könnyen le lehet szûkíteni arra a meghajtóra a kört, aminek betöltésével esetleg gondok akadhatnak. Általában ilyenek a bináris meghajtók, mint például az <span class=filename>nvidia.ko</span>, az X11 megjelenítésért felelõs és az USB eszközök meghajtói, miközben az Ethernet eszközök remekül szoktak mûködni. Ha különösebb gond nélkül képesek vagyunk betölteni és eltávolítani ezeket a meghajtókat, akkor ezt a folyamatot önállósítani is tudjuk úgy, hogy az <span class=filename>/etc/rc.suspend</span> és <span class=filename>/etc/rc.resume</span> szkriptekbe beillesztjük az ehhez szükséges parancsokat. Ezekben egyébként találunk is egy megjegyzésbe rakott példát a meghajtók betöltésérõl és eltávolításáról. Ha az ébresztés után elszemetelõdik a képernyõ tartalma, akkor állítsuk át a <code>hw.acpi.reset_video</code> változó értékét nullára (<code>0</code>). Sokat segíthet meg az is, ha a <code>hw.acpi.sleep_delay</code> értékét csökkentjük vagy növeljük.</p></div><div class=paragraph><p>Megpróbálhatjuk azt is, hogy elindítunk egy frissebb Linux disztribúciót ACPI támogatással és ugyanazon a hardveren kipróbáljuk az általa felkínált felfüggesztési és folytatási lehetõséget. Ha Linux alatt ez megbízhatóan mûködik, akkor nagy a valószínûsége, hogy ez FreeBSD alatt az egyik meghajtó hibájából fakadóan nem használható. Így fokozatosan le is tudjuk szûkíteni, hogy pontosan melyikkel lehet a gond, és ezzel a fejlesztõk munkáját segítjük. Megjegyeznénk, hogy az ACPI-t karbantartó fejlesztõk általában nem foglalkoznak más meghajtókkal (például hangkártya vagy ATA stb.), ezért az adott meghajtóval kapcsolatos hibáról javasolt értesíteni a <a href=https://lists.FreeBSD.org/subscription/freebsd-current>FreeBSD-CURRENT levelezési lista</a> listát és a meghajtóért felelõs fejlesztõt is. Ha van egy kis kedvünk és idõnk, mi magunk is belebiggyeszthetünk a meghajtóba néhány <a href="https://man.freebsd.org/cgi/man.cgi?query=printf&amp;sektion=3&amp;format=html">printf(3)</a> függvényt annak kiderítésére, pontosan hol is fagy le a folytatási funkció.</p></div><div class=paragraph><p>Végül megpróbálkozhatunk az ACPI kikapcsolásával is, és áttérhetünk helyette az APM használatára. Ha az APM-mel mûködnek a készenléti állapotok, akkor érdemes inkább azzal dolgozni, különösen a régebbi (2000 elõtti) hardverek esetében. A gyártóknak eltartott egy ideig, amíg rendes ACPI támogatást voltak képesek adni, ezért a régebbi hardvereknél inkább a BIOS-nak akadnak gondjai az ACPI-val.</p></div></div><div class=sect4><h5 id=_a_rendszer_lemerevedik_ideiglenesen_vagy_teljesen>11.16.3.3. A rendszer lemerevedik (ideiglenesen vagy teljesen)<a class=anchor href=#_a_rendszer_lemerevedik_ideiglenesen_vagy_teljesen></a></h5><div class=paragraph><p>A legtöbb rendszer olyankor akad meg, amikor sok megszakítás elveszik, vagy amikor éppen sok megszakítás érkezik egyszerre. A chipkészleteknek számos baja származik abból, hogy a BIOS milyen módon állítja be a rendszer indítása elõtt a megszakításokat, mennyire helyes az APIC (MADT) táblázata és hogyan vezérli a <em>Rendszervezérlõ megszakítást</em> (System Control Interrupt, SCI).</p></div><div class=paragraph><p>A megszakítás-viharok a <code>vmstat -i</code> parancs kimenetében szereplõ elveszett megszakításokból azonosíthatók be, ahol keressünk rá az <code>acpi0</code> sorra. Ha ez a számláló másodpercenként kettõnél többel növekszik, akkor a megszakításaink viharba keveredtek. Ha a rendszer látszólag lefagyott, próbáljuk meg elõhívni a DDB-t (konzolban a <span class=keyseq><kbd>CTRL</kbd>+<kbd>ALT</kbd>+<kbd>ESC</kbd></span>) és gépeljük be, hogy <code>show interrupts</code>.</p></div><div class=paragraph><p>A megszakítási problémákkal kapcsolatban egyetlen reményünk az APIC támogatás kikapcsolása lehet a <span class=filename>loader.conf</span> állományban a <code>hint.apic.0.disabled="1"</code> sor hozzáadásával.</p></div></div><div class=sect4><h5 id=_végzetes_hibák>11.16.3.4. Végzetes hibák<a class=anchor href=#_végzetes_hibák></a></h5><div class=paragraph><p>Az ACPI-vel kapcsolatos végzetes hibák viszonylag ritkák, és javításuk a legfontosabb. Ilyenkor az elsõ teendõnk elkülöníteni a hiba reprodukálásának egyes lépéseit és (ha lehetséges) lekérni a hívási láncot. Kövessük az <code>options DDB</code> és a soros vonali konzol beállításához adott tanácsokat (lásd <a href=./#serialconsole-ddb>A DDB elérése a soros vonalról</a>) vagy hozzunk létre egy <a href="https://man.freebsd.org/cgi/man.cgi?query=dump&amp;sektion=8&amp;format=html">dump(8)</a> partíciót. A DDB-ben a hívási láncot a <code>tr</code> parancs segítségével kérhetjük le. Ha kézzel írjuk le láncot, akkor legalább az alsó öt (5) és a felsõ öt (5) sorát mindenképpen jegyezzük fel!</p></div><div class=paragraph><p>Ezután próbáljuk meg úgy szûkíteni a probléma lehetõségét, hogy az ACPI használata nélkül indítjuk a rendszert. Ha ezzel nincs semmi gond, akkor a <code>debug.acpi.disable</code> változó értékének megfelelõ beállításával egyenként meg tudjuk figyelni az ACPI alrendszer egyes részeit. Ehhez példákat az <a href="https://man.freebsd.org/cgi/man.cgi?query=acpi&amp;sektion=4&amp;format=html">acpi(4)</a> man oldalon találunk.</p></div></div><div class=sect4><h5 id=_felfüggesztés_vagy_leállítás_után_elindul_a_rendszer>11.16.3.5. Felfüggesztés vagy leállítás után elindul a rendszer<a class=anchor href=#_felfüggesztés_vagy_leállítás_után_elindul_a_rendszer></a></h5><div class=paragraph><p>Elõször is próbáljuk meg a <code>hw.acpi.disable_on_poweroff</code> változó értékét <code>0</code>-ra állítani a <a href="https://man.freebsd.org/cgi/man.cgi?query=loader.conf&amp;sektion=5&amp;format=html">loader.conf(5)</a> állományban. Ezzel távoltartjuk az ACPI alrendszert a rendszer leállítási folyamatától. Egyes rendszereknek valamilyen okból kifolyólag szükségük van itt az <code>1</code> (az alapértelmezett) értékre. Ez többnyire megoldja a problémát, amikor a rendszer váratlanul elindul a készenléti mód aktiválásákor vagy kikapcsoláskor.</p></div></div><div class=sect4><h5 id=_egyéb_problémák>11.16.3.6. Egyéb problémák<a class=anchor href=#_egyéb_problémák></a></h5><div class=paragraph><p>Ha más gondjaink lennének az ACPI-val (dokkoló állomásunk van, egyes eszközöket nem vesz észre stb.), akkor természetesen errõl is küldjünk egy leírást a levelezési listára. Azonban vegyük figyelembe, hogy egyes problémák a ACPI alrendszer eddig még nem implementált, befejezetlen részeihez kötõdnek, ezért azok megoldása még várat magára. Kérünk mindenkit, hogy legyen türelemmel és álljon készen a kiküldött javítások tesztelésére!</p></div></div></div><div class=sect3><h4 id=ACPI-aslanddump>11.16.4. ASL, <code>acpidump</code> és IASL<a class=anchor href=#ACPI-aslanddump></a></h4><div class=paragraph><p>A problémák leggyakoribb forrása, hogy a BIOS-gyártók rossz (vagy kifejezetten hibás!) bytekódokat adnak. Ez általában a következõhöz hasonló rendszerüzenetbõl derül ki:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>ACPI-1287: <span class=k>***</span> Error: Method execution failed <span class=o>[</span><span class=se>\\</span>_SB_.PCI0.LPC0.FIGD._STA] <span class=se>\\</span>
<span class=o>(</span>Node 0xc3f6d160<span class=o>)</span>, AE_NOT_FOUND</code></pre></div></div><div class=paragraph><p>Az ilyen jellegû hibákat gyakran úgy lehet orvosolni, ha a BIOS-unkat frissítjük a legújabb verzióra. A legtöbb ilyen üzenet teljesen ártalmatlan, de ha vannak más problémáink is, például az akkumulátor állapota nem olvasható le, akkor elõször az AML környékén érdemes kutakodnunk. A bytekód, más néven AML, az ASL elnevezésû forrásnyelvbõl származik. Az AML egy DSDT néven ismert táblázatban található meg. Az ASL másolatát az <a href="https://man.freebsd.org/cgi/man.cgi?query=acpidump&amp;sektion=8&amp;format=html">acpidump(8)</a> paranccsal készíthetjük el. Paraméterként egyaránt adjuk meg a <code>-t</code> (megmutatja a rögzített táblák tartalmát) és <code>-d</code> (visszafejti az AML kódokat az ASL nyelvére) kapcsolókat. A felírás pontos formátumát a <a href=#ACPI-submitdebug>A nyomkövetési információk beküldése</a> címû szakaszban olvashatjuk.</p></div><div class=paragraph><p>Elsõként próbáljuk meg újrafordítani az így nyert ASL programot és keressünk benne hibákat. A figyelmeztetések általában nyugodtan figyelmen kívül hagyhatóak, azonban a hibák olyan implementációs hibákra utalnak, amelyek akadályozzák az ACPI helyes mûködését. Az ASL újrafordítását az alábbi paranccsal tudjuk elvégezni:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># iasl saját.asl</span></code></pre></div></div></div><div class=sect3><h4 id=ACPI-fixasl>11.16.5. Az ASL kijavítása<a class=anchor href=#ACPI-fixasl></a></h4><div class=paragraph><p>Végeredményben az a célunk, hogy az ACPI megfelelõ mûködéséhez senkinek se kelljen hozzányúlnia semmihez. Azonban még mindig szükség van BIOS-gyártók által elkövetett gyakori hibák elkerülésének kifejlesztésére. A Microsoft® értelmezõje (<span class=filename>acpi.sys</span> és <span class=filename>acpiec.sys</span>) nem ellenõrzi szigorúan a szabvány szerinti megfelelést, ezért számos olyan BIOS-gyártó, akik csak Windows® alatt tesztelik az ACPI implementációjukat, soha nem fogják kijavítani a ASL kódjukban ejtett hibáikat. Reménykedünk, hogy folyamatosan sikerül felderíteni és dokumentálni a Microsoft® értelmezõje által eltûrt szabványon kívüli viselkedést és leutánozni FreeBSD alatt is, hogy így ne kelljen a felhasználóknak kézzel a saját ASL forrásaikat javítgatni. Az ebbõl fakadó hibákat úgy tudjuk elkerülni és segíteni a fejlesztõknek azonosítani a hozzá társuló viselkedést, hogy magunk javítjuk az ASL-ben felfedezett hibákat. Ha ez beválik, akkor küldjük el a régi és új ASL közti <a href="https://man.freebsd.org/cgi/man.cgi?query=diff&amp;sektion=1&amp;format=html">diff(1)</a>-et a fejlesztõknek, akik így majd az ACPI-CA-ban ki tudnak dolgozni egy megoldást a hibás viselkedésre, ezzel a javításunk szükségtelenné válik.</p></div><div class=paragraph><p>Most pedig következzenek a legismertebb hibaüzenetek, az okaik és javításuk:</p></div><div class=sect4><h5 id=_operációs_rendszeri_függõségek>11.16.5.1. Operációs rendszeri függõségek<a class=anchor href=#_operációs_rendszeri_függõségek></a></h5><div class=paragraph><p>Néhány AML úgy gondolja, hogy a világ csak a különbözõ Windows® verziókból áll. A FreeBSD-nek megadható, hogy másik operációs rendszernek adja ki magát, és ezzel talán meg is szüntethetõ pár hiba. Ezt a legegyszerûbb úgy tudjuk megtenni, ha a <span class=filename>/boot/loader.conf</span> állományhoz hozzáfûzzük a <code>hw.acpi.osname="Windows 2001"</code> sort, vagy itt egy olyan karakterláncot adunk meg, amit az ASL forrásban láttunk.</p></div></div><div class=sect4><h5 id=_hiányzó_visszatérési_érték>11.16.5.2. Hiányzó visszatérési érték<a class=anchor href=#_hiányzó_visszatérési_érték></a></h5><div class=paragraph><p>Bizonyos módszerek a szabvány szerint elvártaktól eltérõen nem adnak vissza explicit módon értéket. Mivel az ACPI-CA ezt nem kezeli le, ezért a FreeBSD részérõl tartalmaz egy olyan módosítást, amivel implicit módon is vissza lehet adni értéket. Ha biztosak akarunk lenni a visszaadni kívánt értékben, akkor helyezzünk el a megfelelõ helyekre explicit Return utasításokat. Az <code>iasl</code> a <code>-f</code> paraméterrel kényszeríthetõ az ilyen ASL források lefordítására.</p></div></div><div class=sect4><h5 id=_az_alapértelmezett_aml_felülbírálása>11.16.5.3. Az alapértelmezett AML felülbírálása<a class=anchor href=#_az_alapértelmezett_aml_felülbírálása></a></h5><div class=paragraph><p>Miután módosítottuk a <span class=filename>saját.asl</span> állományunkat, így tudjuk lefordítani:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># iasl saját.asl</span></code></pre></div></div><div class=paragraph><p>Az <code>-f</code> kapcsoló megadásával kikényszeríthetjük az AML létrehozását még abban az esetben is, amikor hibákat tartalmaz. Ügyeljünk rá, hogy bizonyos hibákat (például a hiányzó visszatérési értékeket) a fordító magától kikerül.</p></div><div class=paragraph><p>Az <code>iasl</code> alapértelmezett kimenete a <span class=filename>DSDT.aml</span> állomány. A <span class=filename>/boot/loader.conf</span> átírásával így tudjuk ezzel helyettesíteni a BIOS-unk hibás változatát (ami még mindig megtalálható a flash memóriában):</p></div><div class="literalblock programlisting"><div class=content><pre>acpi_dsdt_load=&#34;YES&#34;
acpi_dsdt_name=&#34;/boot/DSDT.aml&#34;</pre></div></div><div class=paragraph><p>Ehhez ne felejtsük el a saját <span class=filename>DSDT.aml</span> állományunkat bemásolni a <span class=filename>/boot</span> könyvtárba.</p></div></div></div><div class=sect3><h4 id=ACPI-debugoutput>11.16.6. Nyomkövetési információk kinyerése az ACPI-bõl<a class=anchor href=#ACPI-debugoutput></a></h4><div class=paragraph><p>Az ACPI meghajtója nagyon rugalmas nyomkövetési lehetõségekkel rendelkezik. Ennek révén ugyanúgy megadhatjuk a nyomonkövetni kívánt alrendszert, mint ahogy annak mélységét is. A nyomkövetni kívánt alrendszereket "rétegekként" adjuk meg, valamint ezek ACPI-CA komponensekre (ACPI_ALL_COMPONENTS) és ACPI hardvertámogatásra (ACPI_ALL_DRIVERS) bomlanak le. A nyomkövetéskor keletkezõ kimenet részletességét a "szintként" adjuk meg, ami az ACPI_LV_ERROR-tól (csak a hibák) ACPI_LV_VERBOSE-ig (minden) terjedhet. A "szint" itt egy bitmaszk, ezért szóközzel elválasztva egyszerre több beállítás megadható. Ha túlságosan sok üzenet érkezik a konzol üzenetpufferébe, akkor szükségünk lehet a soros konzol keresztüli nyomkövetésre is. Az összes szint és réteg az <a href="https://man.freebsd.org/cgi/man.cgi?query=acpi&amp;sektion=4&amp;format=html">acpi(4)</a> man oldalon található meg.</p></div><div class=paragraph><p>A nyomkövetés alapértelmezés szerint nem engedélyezett. Az engedélyezéséhez hozzá kell adnunk az <code>options ACPI_DEBUG</code> sort a rendszermagunk beállításait tartalmazó állományhoz, amennyiben a rendszermagba fordítjuk az ACPI támogatást. Ha az <span class=filename>/etc/make.conf</span> állományba írjuk bele az <code>ACPI_DEBUG=1</code> sort, akkor azt globálisan engedélyezhetjük. Ha modulként használjuk, elegendõ csak a következõ módon újrafordítani az <span class=filename>acpi.ko</span> modult:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># cd /sys/modules/acpi/acpi</span>
<span class=o>&amp;&amp;</span> make clean <span class=o>&amp;&amp;</span>
make <span class=nv>ACPI_DEBUG</span><span class=o>=</span>1</code></pre></div></div><div class=paragraph><p>Telepítsük fel a <span class=filename>acpi.ko</span> modult a <span class=filename>/boot/kernel</span> könyvtárba és állítsuk be a számunkra megfelelõ szintet és réteget a <span class=filename>loader.conf</span> állományban. Az alábbi példában engedélyezzük az összes ACPI-CA komponens és az összes ACPI hardvermeghajtó (processzor, LID stb.) nyomkövetését. Csak a hibaüzeneteket írja ki részletesen.</p></div><div class="literalblock programlisting"><div class=content><pre>debug.acpi.layer=&#34;ACPI_ALL_COMPONENTS ACPI_ALL_DRIVERS&#34;
debug.acpi.level=&#34;ACPI_LV_ERROR&#34;</pre></div></div><div class=paragraph><p>Ha az általunk keresett információt egy adott esemény váltja ki (például egy felfüggesztés vagy egy ébresztés), akkor nem is fontos átírnunk hozzá a <span class=filename>loader.conf</span> állományt, hanem helyette a rendszer indítása után használjuk a <code>sysctl</code> parancsot a réteg és a szint megadására akkor, amikor a rendszert felkészítjük az eseményre. A <code>sysctl</code> változókat ugyanúgy nevezték el, mint a <span class=filename>loader.conf</span> állományban található beállításokat.</p></div></div><div class=sect3><h4 id=ACPI-References>11.16.7. Hivatkozások<a class=anchor href=#ACPI-References></a></h4><div class=paragraph><p>Az ACPI-rõl az alábbi helyeken találunk részletesebb információkat:</p></div><div class=ulist><ul><li><p>A <a href=https://lists.FreeBSD.org/subscription/freebsd-acpi>FreeBSD ACPI levelezési lista</a></p></li><li><p>Az ACPI levelezési lista archívuma: <a href=http://lists.freebsd.org/pipermail/freebsd-acpi/>http://lists.freebsd.org/pipermail/freebsd-acpi/</a></p></li><li><p>A korábbi ACPI levelezési lista archívuma: <a href=http://home.jp.FreeBSD.org/mail-list/acpi-jp/>http://home.jp.FreeBSD.org/mail-list/acpi-jp/</a></p></li><li><p>Az <a href=https://uefi.org/specifications#ACPI>ACPI specifikációja</a></p></li><li><p>A FreeBSD következõ man oldalai: <a href="https://man.freebsd.org/cgi/man.cgi?query=acpi&amp;sektion=4&amp;format=html">acpi(4)</a>, <a href="https://man.freebsd.org/cgi/man.cgi?query=acpi_thermal&amp;sektion=4&amp;format=html">acpi_thermal(4)</a>, <a href="https://man.freebsd.org/cgi/man.cgi?query=acpidump&amp;sektion=8&amp;format=html">acpidump(8)</a>, <a href="https://man.freebsd.org/cgi/man.cgi?query=iasl&amp;sektion=8&amp;format=html">iasl(8)</a>, <a href="https://man.freebsd.org/cgi/man.cgi?query=acpidb&amp;sektion=8&amp;format=html">acpidb(8)</a></p></li><li><p><a href=http://www.cpqlinux.com/acpi-howto.html#fix_broken_dsdt>A DSDT nyomkövetése (angolul)</a>. (Példának a Compaqot hozza fel, de általánosságban véve hasznos.)</p></li></ul></div></div></div></div></div><div class=sect1><h2 id=boot>Chapter 12. A FreeBSD rendszerindítási folyamata<a class=anchor href=#boot></a></h2><div class=sectionbody><div class=sect2><h3 id=boot-synopsis>12.1. Áttekintés<a class=anchor href=#boot-synopsis></a></h3><div class=paragraph><p>A számítógép indulását és a rajta található operációs rendszer betöltõdését "rendszerindítási folyamatnak" nevezzük, vagy egyszerûen csak "bootolásnak". A FreeBSD rendszerindítási folyamata nagymértékû rugalmasságot kínál a rendszer indulását követõ események vezérlését illetõen, legyen az a számítógépre telepített különféle operációs rendszerek egyikének kiválasztása, vagy pedig ugyanazon operációs rendszer valamelyik változatának vagy rendszermagjának kiválasztása.</p></div><div class=paragraph><p>Ez a fejezet részleteiben bemutatja a rendszerindításhoz kapcsolódó konfigurációs opciókat, illetve a FreeBSD bootolásának testreszabhatóságát. Ebbe minden beleértendõ, ami a FreeBSD rendszermag beindulása és az eszközök keresése során történik, majd az <a href="https://man.freebsd.org/cgi/man.cgi?query=init&amp;sektion=8&amp;format=html">init(8)</a> elindításával zárul. Ha nem vagyunk teljesen biztosak benne, ez pontosan mikor is következik be, figyeljük, amikor a szöveg színe fehérrõl szürkére vált.</p></div><div class=paragraph><p>A fejezet elolvasása során megismerjük:</p></div><div class=ulist><ul><li><p>milyen elemekbõl áll a FreeBSD rendszertöltõ alrendszere, és ezek miként kapcsolódnak egymáshoz;</p></li><li><p>melyek azok a FreeBSD rendszerindításában résztvevõ elemeknek átadható opciók, amelyekkel vezérelhetõ ez a folyamat;</p></li><li><p>a <a href="https://man.freebsd.org/cgi/man.cgi?query=device.hints&amp;sektion=5&amp;format=html">device.hints(5)</a> alapjait.</p></li></ul></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=title>Csak x86</div><div class=paragraph><p>Ez a fejezet kizárólag csak az Intel® x86 típusú architektúráján futó FreeBSD rendszerindítási folyamatát mutatja be.</p></div></td></tr></tbody></table></div></div><div class=sect2><h3 id=boot-introduction>12.2. A rendszerindítás problémája<a class=anchor href=#boot-introduction></a></h3><div class=paragraph><p>Az operációs rendszer elindítása a számítógép bekapcsolása után egy felettébb érdekes problémát vet fel. Definíció szerint a számítógép ugyanis egy lépést sem tud megtenni az operációs rendszer elindulása nélkül. Például nem tud programokat futtatni a lemezrõl. Eszerint ha a számítógépünk nem képes programokat futtatni a lemezrõl az operációs rendszer segítsége nélkül, viszont az operációs rendszer programjai a lemezen vannak, mégis hogyan képes elindulni maga az operációs rendszer?</p></div><div class=paragraph><p>Maga a probléma a Münchhausen báró kalandjai c. könyvben leírtakhoz hasonló. A történet szerint ugyanis a fõszereplõ egy mocsárban ragadt derék lovával, azonban sikerült kihúznia magát belõle a saját hajánál fogva. Ez a motívum vált a számítógépek hõskorában a <em>rendszerbetöltés</em> alapjává, vagyis ahogyan betöltötték az operációs rendszereket. <em>(Ford.: ezt az angolban bootstrappingnek hívják, mivel a történet angol változata szerint a csizmáján (boot) emelkedett ki. Ebbõl alakult ki késõbb az elterjedt bootolás szó is.)</em></p></div><div class=paragraph><p>Az x86-os konfigurációkon a BIOS (Basic Input/Output System, avagy "alapvetõ be- és kimeneti rendszer") felelõs az operációs rendszer betöltéséért. Ehhez a BIOS elõször megkeresi a merevlemez egy speciális helyén található Master Boot Record-ot (MBR). A BIOS elegendõ tudással rendelkezik az MBR beolvasásához és lefuttatásához, és feltételezi, hogy az MBR majd elvégzi az operációs rendszer betöltéséhez szükséges további feladatokat, helyenként a BIOS közremûködésével.</p></div><div class=paragraph><p>Az MBR-ben található programkódot hívják általában <em>boot manager</em>nek, kiváltképp abban az esetben, amikor az a felhasználóval is kommunikál. Ilyenkor a boot manager többnyire további kódot tartalmaz a lemez elsõ <em>sáv</em>ján vagy az egyik állományrendszerben. (A boot managereket néha <em>boot loader</em>nek is nevezzük, de a FreeBSD-s terminológia ezt a kifejezést a rendszerindítás egy késõbbi fokozatára használja.) Népszerûbb boot managerek: boot0 (avagy Boot Easy, a FreeBSD alapvetõ boot managere), GRUB, GAG és a LILO. (Ezek közül egyedül csak a boot0 fér el az MBR-ben.)</p></div><div class=paragraph><p>Amennyiben merevlemezeinken csupán egyetlen operációs rendszer foglal helyet, akkor egy szabványos MBR tökéletesen megfelelõ. Ez az MBR megkeresi az elsõ indítható (más néven aktív) slice-ot a lemezen, majd lefuttatja a benne található indítókódot az operációs rendszer többi részének felélesztéséhez. Az <a href="https://man.freebsd.org/cgi/man.cgi?query=fdisk&amp;sektion=8&amp;format=html">fdisk(8)</a> által alapértelmezés szerint telepített MBR pontosan ilyen. Ennek alapja a <span class=filename>/boot/mbr</span> állomány.</p></div><div class=paragraph><p>Ha viszont több operációs rendszert is telepítettünk a lemezeinkre, akkor egy ettõl eltérõ boot managert érdemes használnunk, olyat, amely képes felsorolni a rendelkezésre álló operációs rendszereket, lehetõvé téve, hogy választani lehessen az indításuk között. Ezek közül kettõrõl esik szó a következõ alfejezetekben.</p></div><div class=paragraph><p>A FreeBSD rendszertöltõ alrendszerének fennmaradó része három fokozatra bontható. Az elsõ fokozatot az MBR indítja el, amely pontosan eleget tud ahhoz, hogy a számítógépet egy elõre megadott állapotba hozza és lefuttassa rajta a második fokozatot. A második fokozat ennél már egy kicsivel többre képes, majd ezt követi a harmadik fokozat. Ez a fokozat zárja le végül az operációs rendszer betöltésének feladatát. A munka tehát ezen három fokozat között oszlik meg, mivel a PC-szabványok komoly korlátozásokat tesznek az elsõ, illetve második fokozatban futtatható programok méretére. Ha így fûzzük össze a feladatokat, akkor a FreeBSD számára egy sokkal rugalmasabb betöltõt kapunk.</p></div><div class=paragraph><p>Ezután beindul a rendszermag (más néven kernel), és nekilát a számítógépben rendelkezésre álló hardvereszközök keresésének, majd elõkészíti õket a használatra. Ahogy a rendszermag beindításának folyamata véget ért, az átadja a vezérlést az <a href="https://man.freebsd.org/cgi/man.cgi?query=init&amp;sektion=8&amp;format=html">init(8)</a> nevû felhasználói programnak, amely megbizonyosodik a lemezek használhatóságáról. Az <a href="https://man.freebsd.org/cgi/man.cgi?query=init&amp;sektion=8&amp;format=html">init(8)</a> ezt követõen megkezdi az erõforrások felhasználói szintû konfigurálását: csatlakoztatja az állományrendszereket, beállítja a hálózati kártyá(ka)t, és elindítja mindazon programokat, amelyeknek egy FreeBSD rendszer indulásakor futnia kell.</p></div></div><div class=sect2><h3 id=boot-blocks>12.3. A boot manager és az indulás fokozatai<a class=anchor href=#boot-blocks></a></h3><div class=sect3><h4 id=boot-boot0>12.3.1. A boot manager<a class=anchor href=#boot-boot0></a></h4><div class=paragraph><p>Az MBR-ben található programkódot, avagy boot managert, sokszor csak a rendszerindítás <em>nulladik fokozat</em>aként emlegetik. Ez az alfejezet a korábban említett két boot managert tárgyalja: a boot0-t és a LILO-t.</p></div><div class=paragraph><p><strong>A boot0 boot manager:</strong> A FreeBSD telepítõje vagy a <a href="https://man.freebsd.org/cgi/man.cgi?query=boot0cfg&amp;sektion=8&amp;format=html">boot0cfg(8)</a> által kialakított MBR alapértelmezett állapotban a <span class=filename>/boot/boot0</span> állományon alapszik. (A boot0 program nagyon egyszerû, hiszen az -ben elhelyezhetõ kód csak 446 byte hosszúságú lehet, mert a végében még el kell férnie a slice-táblának és az <code>0x55AA</code> azonosítónak.) Ha telepítettük a boot0-t és a lemezeinken több operációs rendszer is megtalálható, akkor a rendszerindítás során egy hasonló képet kell látnunk:</p></div><div id=boot-boot0-example class=exampleblock><div class=title>Példa 7. A <span class=filename>boot0</span> munkában</div><div class=content><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>F1 DOS
F2 FreeBSD
F3 Linux
F4 ??
F5 Drive 1

Default: F2</code></pre></div></div></div></div><div class=paragraph><p>Más operációs rendszerek, különösen a Windows®, telepítésük során felülírják a már meglevõ MBR-t a sajátjukkal. Ha ez történne, vagy egyszerûen csak szeretnénk a meglevõ MBR-t lecserélni a FreeBSD MBR-jével, adjuk ki a következõ parancsot:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># fdisk -B -b /boot/boot0 eszköznév</span></code></pre></div></div><div class=paragraph><p>ahol az <em>eszköznév</em> annak az eszköznek a neve, ahonnan a rendszert indítani szeretnénk, tehát például <span class=filename>ad0</span> az elsõ IDE-lemez esetén, vagy <span class=filename>ad2</span> a második IDE-vezérlõn található elsõ IDE-lemez esetén, illetve <span class=filename>da0</span> az elsõ SCSI-lemez esetén, és így tovább. Ha testre akarjuk szabni az MBR-t, használjuk a <a href="https://man.freebsd.org/cgi/man.cgi?query=boot0cfg&amp;sektion=8&amp;format=html">boot0cfg(8)</a>-t.</p></div><div class=paragraph><p><strong>A LILO boot manager:</strong> Ezen boot manager telepítéséhez és beállításához elsõként indítsuk el a Linuxot és vegyük hozzá az alábbi sort a rendszerünkben található <span class=filename>/etc/lilo.conf</span> konfigurációs állományhoz:</p></div><div class="literalblock programlisting"><div class=content><pre>other=/dev/hdXY
table=/dev/hdX
loader=/boot/chain.b
label=FreeBSD</pre></div></div><div class=paragraph><p>A fenti sablont kiegészítve, a linuxos konvenciók szerint adjuk meg a FreeBSD elsõdleges partícióját és meghajtóját úgy, hogy az <em>X</em>-et átírjuk a linuxos meghajtó betûjelére és az <em>Y</em>-t átírjuk a Linux® elsõdleges partíciójának számára. Ha SCSI-meghajtót használunk, a <em>/dev/hd</em> részt is át kell írnunk az elõbbiek mellett <em>/dev/sd</em>-re. A <code>loader=/boot/chain.b</code> sor elhagyható abban az esetben, ha mind a két operációs rendszer ugyanazon a meghajtón található. Ha befejeztük a módosítást, futtassuk le a <code>/sbin/lilo -v</code> parancsot a változtatásaink életbe léptetéséhez. Ezt ellenõrizhetjük is a képernyõn megjelenõ üzenetek alapján.</p></div></div><div class=sect3><h4 id=boot-boot1>12.3.2. Az elsõ fokozat (<span class=filename>/boot/boot1</span>) és a második fokozat (<span class=filename>/boot/boot2</span>)<a class=anchor href=#boot-boot1></a></h4><div class=paragraph><p>Az elsõ és a második fokozat fogalmilag ugyanannak a programnak a része, a lemezen ugyanott helyezkedik el. A tárbeli megszorítások miatt ugyan el kellett választani õket egymástól, de a telepítésük mindig egy helyre történik. A telepítõ vagy a bsdlabel (lásd lentebb) használata során a <span class=filename>/boot/boot</span> nevû kombinált állományból másolódnak ki.</p></div><div class=paragraph><p>Az állományrendszereken kívül találhatóak, az aktív slice elsõ sávjában, annak elsõ szektorától kezdõdõen. Ez az a hely, ahol a <a href=#boot-boot0>boot0</a>, illetve a többi boot manager is keresi a rendszerindítás folytatására alkalmas programot. A felhasznált szektorok száma könnyedén kideríthetõ a <span class=filename>/boot/boot</span> méretébõl.</p></div><div class=paragraph><p>Legfeljebb 512 byte-os méreténél fogva a <span class=filename>boot1</span> állomány nagyon egyszerû felépítésû, és éppen csak annyit tud a slice-ra vonatkozó információkat tároló FreeBSD <em>bsdlabel</em>-rõl, hogy megtalálja a <span class=filename>boot2</span>-t és elindítsa.</p></div><div class=paragraph><p>A <span class=filename>boot2</span> már egy kicsivel ügyesebb, és eléggé ismeri a FreeBSD állományrendszerét ahhoz, hogy megtaláljon rajta állományokat, valamint képes egy egyszerû felületet nyújtani a rendszermag vagy a betöltõ megválasztásához.</p></div><div class=paragraph><p>Mivel a <a href=#boot-loader>betöltõ</a> pedig már ennél is okosabb, és egy könnyen használható rendszerindítási konfigurációt tud a felhasználó számára nyújtani, ezért a <span class=filename>boot2</span> általában ezt indítja el, de elõtte közvetlenül a rendszermag futtatását végzi el.</p></div><div id=boot-boot2-example class=exampleblock><div class=title>Példa 8. A <span class=filename>boot2</span> mûködés közben</div><div class=content><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=o>&gt;&gt;</span> FreeBSD/i386 BOOT
Default: 0:ad<span class=o>(</span>0,a<span class=o>)</span>/boot/loader
boot:</code></pre></div></div></div></div><div class=paragraph><p>Ha le kellene váltani a korábban telepített <span class=filename>boot1</span> és <span class=filename>boot2</span> fokozatokat, használjuk a <a href="https://man.freebsd.org/cgi/man.cgi?query=bsdlabel&amp;sektion=8&amp;format=html">bsdlabel(8)</a>-t:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># bsdlabel -B lemezslice</span></code></pre></div></div><div class=paragraph><p>ahol a <em>lemezslice</em> annak a lemeznek és slice-nak a kombinációja, ahonnan indítjuk a rendszerünket, például az elsõ IDE-lemez elsõ slice-a esetén ez az <span class=filename>ad0s1</span>.</p></div><div class="admonitionblock warning"><table><tbody><tr><td class=icon><i class="fa icon-warning" title=Warning></i></td><td class=content><div class=title>A veszélyesen dedikált mód (Dangerously Dedicated Mode)</div><div class=paragraph><p>Amikor a <a href="https://man.freebsd.org/cgi/man.cgi?query=bsdlabel&amp;sektion=8&amp;format=html">bsdlabel(8)</a> meghívásakor csak a lemez nevét használjuk, például <span class=filename>ad0</span>-t, a parancs egy veszélyesen dedikált lemezt hoz létre, slice-ok nélkül! Szinte biztos, hogy nem ez az, amire szükségünk lenne, ezért mindig ellenõrizzük kiadása elõtt a <a href="https://man.freebsd.org/cgi/man.cgi?query=bsdlabel&amp;sektion=8&amp;format=html">bsdlabel(8)</a> parancsot!</p></div></td></tr></tbody></table></div></div><div class=sect3><h4 id=boot-loader>12.3.3. A harmadik fokozat (<span class=filename>/boot/loader</span>)<a class=anchor href=#boot-loader></a></h4><div class=paragraph><p>A betöltõ a három fokozatú rendszertöltés utolsó állomása. Az állományrendszerben <span class=filename>/boot/loader</span> néven találhatjuk meg.</p></div><div class=paragraph><p>A rendszertöltõt az egyszerû konfigurálhatóságot támogató, felhasználóbarát eszköznek tervezték, és könnyen megtanulható, beépített parancsokat használ, melyek mögött egy összetettebb parancsokat ismerõ, erõsebb értelmezõ áll.</p></div><div class=sect4><h5 id=boot-loader-flow>12.3.3.1. A rendszertöltõ mûködése<a class=anchor href=#boot-loader-flow></a></h5><div class=paragraph><p>Az inicializálás során a rendszertöltõ megpróbálja megkeresni a konzolt, és a lemezek közül igyekszik megtalálni azt, amelyikrõl elindult a rendszer. A keresések eredményének megfelelõen beállítja a változókat, majd elindul egy értelmezõ, ahol vagy szkriptbõl olvasva, vagy pedig interaktívan feldolgozásra kerülnek a parancsok.</p></div><div class=paragraph><p>A rendszertöltõ ezt követõen beolvassa a <span class=filename>/boot/loader.rc</span> állományt, az pedig alapértelmezés szerint feldolgozza a <span class=filename>/boot/defaults/loader.conf</span> állományt, ahol a változók értelmes kezdõértéket kapnak, valamint feldolgozza még a <span class=filename>/boot/loader.conf</span> állományt is, ahol a változók értékeit változtathatjuk meg. Miután ez lezajlott, a <span class=filename>loader.rc</span> a változók értékeinek megfelelõen cselekszik, betöltve az ily módon kiválasztott rendszermagot és a hozzá választott modulokat.</p></div><div class=paragraph><p>Végezetül, a rendszertöltõ beiktat egy, alapértelmezés szerint 10 másodperces várakozási szünetet, majd elindítja a rendszermagot, ha azt meg nem szakítjuk egy billentyû lenyomásával. Ha megszakítjuk ezt a várakozást, a rendszertöltõ egy parancssort ad, amelyen keresztül egyszerû parancsokat adhatunk ki neki: állíthatjuk a változók értékeit, modulokat távolíthatunk el a memóriából, modulokat töltethetünk be, elindíthatjuk a rendszert vagy újraindíthatjuk a számítógépet.</p></div></div><div class=sect4><h5 id=boot-loader-commands>12.3.3.2. A rendszertöltõ beépített parancsai<a class=anchor href=#boot-loader-commands></a></h5><div class=paragraph><p>Következzenek a leggyakrabban használt parancsok a rendszertöltõben. Az összes itt elérhetõ parancsot a <a href="https://man.freebsd.org/cgi/man.cgi?query=loader&amp;sektion=8&amp;format=html">loader(8)</a> man oldalon találjuk meg.</p></div><div class=dlist><dl><dt class=hdlist1>autoboot <em>másodperc</em></dt><dd><p>Megkezdi a rendszermag betöltését, ha nem szakítjuk meg a várakozást másodpercekben megadott idõtartam alatt. Ekkor egy visszaszámlálást láthatunk, ami az alapértelmezés szerint 10 másodperctõl indul.</p></dd><dt class=hdlist1>boot [-opciók] [rendszermag]</dt><dd><p>Amennyiben léteznek, a megadott opciókkal azonnal megkezdi a megadott rendszermag betöltését. A <em>rendszermag</em> paraméter csak abban az esetben adható meg, ha elõtte kiadtunk egy <em>unload</em> parancsot, máskülönben a korábban betöltött rendszermaggal indul a rendszer.</p></dd><dt class=hdlist1>boot-conf</dt><dd><p>Végigmegy a modulok ugyanazon automatikus konfigurációján, ahogy az a normális rendszerindítás során is történik. Ezen parancs használatának csak akkor van értelme, ha elõtte az <code>unload</code> parancsot használjuk, megváltoztatunk egy-két változót, általában a <code>kernel</code>-t.</p></dd><dt class=hdlist1>help [témakör]</dt><dd><p>A <span class=filename>/boot/loader.help</span> állományban fellelhetõ súgóüzeneteket mutatja meg. Ha témakörnek <code>index</code>et adunk meg, akkor az elérhetõ témakörök listáját kapjuk meg.</p></dd><dt class=hdlist1>include <em>állománynév</em> …​</dt><dd><p>Feldolgozza a megnevezett állományt: beolvassa, majd sorról sorra értelmezi. Hiba esetén azonnal megállítja a feldolgozást.</p></dd><dt class=hdlist1>load [-t típus] <em>állománynév</em></dt><dd><p>A név alapján betölti a rendszermagot, modult vagy az adott típusú állományt. Az állománynév után megadott további paraméterek az állománynak adódnak át.</p></dd><dt class=hdlist1>ls [-l] [elérési útvonal]</dt><dd><p>Kilistázza a megadott elérési útvonalon található állományokat, vagy ennek hiányában a gyökér tartalmát. Ha hozzátesszük a <code>-l</code> kapcsolót, az állományok mérete is látható válik.</p></dd><dt class=hdlist1>lsdev [-v]</dt><dd><p>Kilistázza az összes olyan eszközt, ahonnan modulokat tölthetünk be. Amennyiben a <code>-v</code> kapcsolót is megadjuk, további részleteket tudhatunk meg róluk.</p></dd><dt class=hdlist1>lsmod [-v]</dt><dd><p>Kilistázza a betöltött modulokat. Ha többet szeretnénk megtudni róluk, adjuk meg a <code>-v</code> kapcsolót.</p></dd><dt class=hdlist1>more <em>állománynév</em></dt><dd><p>Megmutatja a megadott állomány tartalmát, minden <code>LINES</code> számú sor után szünetet tartva.</p></dd><dt class=hdlist1>reboot</dt><dd><p>Azonnal újraindítja a számítógépet.</p></dd><dt class=hdlist1>set <em>változó</em></dt><dd><p>Beállítja a rendszertöltõ környezeti változójának értékét.</p></dd><dt class=hdlist1>unload</dt><dd><p>Eltávolítja a memóriából az összes betöltött modult.</p></dd></dl></div></div><div class=sect4><h5 id=boot-loader-examples>12.3.3.3. Rendszertöltõ példák<a class=anchor href=#boot-loader-examples></a></h5><div class=paragraph><p>Íme néhány konkrét példa a rendszertöltõ használatára:</p></div><div class=ulist><ul><li><p>Így indíthatjuk egyfelhasználós módban az általunk használt rendszermagot:</p><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell> boot <span class=nt>-s</span></code></pre></div></div></li><li><p>Távolítsuk el a betöltött rendszermagot és a moduljait, és töltsük be helyettük a korábbi (vagy egy másik) rendszermagot:</p><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>unload
load kernel.old</code></pre></div></div><div class=paragraph><p>Itt használhatjuk a <span class=filename>kernel.GENERIC</span> nevet is, amely a telepítõlemezen található általános rendszermagra utal, vagy a <span class=filename>kernel.old</span> nevet, amely a korábban használt rendszermagot rejti (például amikor rendszermagot frissítettünk vagy készítettünk magunknak).</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>A következõképpen lehet betölteni a szokásos moduljainkat egy másik rendszermaggal:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>unload
<span class=nb>set </span><span class=nv>kernel</span><span class=o>=</span><span class=s2>&#34;kernel.old&#34;</span>
boot-conf</code></pre></div></div></td></tr></tbody></table></div></li><li><p>Egy rendszermag-konfigurációs szkript (automatizált szkript, amely ugyanazokat a beállításokat végzi el, amelyeket mi magunk tennénk akkor, amikor a rendszermagot indítjuk) betöltése:</p><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell> load <span class=nt>-t</span> userconfig_script /boot/kernel.conf</code></pre></div></div></li></ul></div></div><div class=sect4><h5 id=boot-splash>12.3.3.4. Rendszerbetöltõ képernyõk<a class=anchor href=#boot-splash></a></h5><div class=paragraph><p>A rendszertöltés során megjelenõ rendszerüzenetek megjelenítése helyett egy sokkal megnyerõbb, látványosabb rendszerindítást tudunk elérni betöltõ képernyõk használatával. Egy ilyen képet egészen a konzolos bejelentkezésig, vagy az X felett futó valamelyik bejelentkezõ képernyõ megjelenéséig láthatunk.</p></div><div class=paragraph><p>FreeBSD alatt alapvetõen két típusú környezet létezik. Ezek közül az egyik a hagyományos virtuális konzolos parancssoros felület. Ekkor a rendszertöltés befejezõdésekor egy szöveges parancssori bejelentkezõ promptot kapunk. A másik környezet az X11 által felkínált grafikus felület. Miután telepítettük az <a href=./#x-install>X11</a> szervert és valamelyik <a href=./#x11-wm>munkakörnyezetet</a>, tehát például a GNOME, a KDE vagy az XFce környezetek valamelyikét, a <code>startx</code> paranccsal indíthatjuk el a grafikus felületet.</p></div><div class=paragraph><p>Némely felhasználók a megszokott szöveges bejelentkezés helyett is inkább valamelyik X11 alapú grafikus bejelentkezést szeretnék használni. A különbözõ bejelentkezõ képernyõk, mint amilyen az Xorg esetén az XDM, a GNOME esetén a gdm, vagy a KDE esetén a kdm (illetve a Portgyûjteménybõl származó egyéb megoldások) alapvetõen a konzolos bejelentkezés helyett nyújtanak egy grafikus bejelentkezõ felületet. Ilyenkor a sikeres bejelentkezést követõen a felhasználó közvetlenül egy grafikus környezetbe kerül.</p></div><div class=paragraph><p>A parancssoros felület esetén a rendszertöltõ képernyõ elrejti az összes rendszerüzenetet és a rendszer indításakor futtatott programok üzeneteit. Az X11 használata esetén azonban a felhasználók ezzel együtt már a többi, alapértelmezés szerint grafikus felülettel rendelkezõ rendszerhez (Microsoft® Windows® vagy más nem-UNIX operációs rendszer) hasonló élményt nyernek.</p></div><div class=sect5><h6 id=boot-splash-function>12.3.3.4.1. A rendszerbetöltõ képek támogatása<a class=anchor href=#boot-splash-function></a></h6><div class=paragraph><p>A FreeBSD csak BMP (<span class=filename>.bmp</span>) vagy ZSoft PCX formátumú, 256 színû rendszerbetöltõ képek megjelenítését támogatja. Emellett szabványos VGA kártyákon csak akkor fog mûködni, ha a kép 320x200 vagy annál kisebb felbontású.</p></div><div class=paragraph><p>Nagyobb méretû képek esetén, egészen az 1024x768-as felbontásig, a FreeBSD VESA támogatására lesz szükségünk. Ezt vagy a rendszer indításakor a VESA modul betöltésével engedélyezhetjük, vagy ha a rendszermag konfigurációs állományában megadjuk a <code>VESA</code> sort és készítünk egy saját rendszermagot (lásd <a href=./#kernelconfig>A FreeBSD rendszermag testreszabása</a>). A VESA támogatáson keresztül a felhasználók a teljes képernyõt betöltõ rendszerbetöltõ képeket is meg tudnak így jeleníteni.</p></div><div class=paragraph><p>A rendszerbetöltõ képernyõ a rendszer indítása közben bármikor tetszõlegesen kikapcsolható egy tetszõleges billentyû lenyomásával.</p></div><div class=paragraph><p>A megadott betöltõképernyõ alapértelmezés szerint a képernyõvédõ szerepét is betölti az X11 felületén kívül. Ha tehát egy ideig nem használjuk a számítógépünket, akkor a képernyõ átvált a betöltõképre és folyamatosan változtatni kezdi az intenzitását, a nagyon világosból a nagyon sötétbe, majd újrakezdi. Az alapértelmezett képernyõvédõ az <span class=filename>/etc/rc.conf</span> állományban a <code>saver=</code> sor megadásával állítható át. Ehhez a beállításhoz több különbözõ beépített képernyõvédõ tartozik, ezek teljes listáját a <a href="https://man.freebsd.org/cgi/man.cgi?query=splash&amp;sektion=4&amp;format=html">splash(4)</a> man oldalon olvashatjuk. Ezek közül az alapértelmezett a "warp". Az <span class=filename>/etc/rc.conf</span> állományban megadható <code>saver=</code> csak a virtuális konzolokra vonatkozik, az X11 bejelentkezõ képernyõire semmilyen hatással sincs.</p></div><div class=paragraph><p>A rendszerbetöltõ néhány üzenete, valamint a rendszerindítási opciókat tartalmazó menü és a hozzá tartozó visszaszámlálás még a rendszerbetöltõ képernyõ használata során is meg fog jelenni.</p></div><div class=paragraph><p>A <a href=http://artwork.freebsdgr.org/node/3/>http://artwork.freebsdgr.org</a> címen találhatunk néhány ilyen betöltõképernyõt. A <a class=package href=https://cgit.freebsd.org/ports/tree/sysutils/bsd-splash-changer/>sysutils/bsd-splash-changer</a> port telepítésével pedig a rendszer egyes indításakor egy elõre megadott gyûjteménybõl tudunk véletlenszerûen választani egyet.</p></div></div><div class=sect5><h6 id=boot-splash-enable>12.3.3.4.2. A rendszerbetöltõ képek használata<a class=anchor href=#boot-splash-enable></a></h6><div class=paragraph><p>A betöltõképet tartalmazó (<span class=filename>.bmp</span> vagy <span class=filename>.pcx</span> kiterjesztésû) állományt a rendszerindító partícióra, például a <span class=filename>/boot</span> könyvtárba kell tennünk.</p></div><div class=paragraph><p>A normál (256 szín, legfeljebb 320x200-as felbontású) képek esetén a következõ sorokat adjuk hozzá a <span class=filename>/boot/loader.conf</span> állományhoz:</p></div><div class="literalblock programlisting"><div class=content><pre>splash_bmp_load=&#34;YES&#34;
bitmap_load=&#34;YES&#34;
bitmap_name=&#34;/boot/betöltõkép.bmp&#34;</pre></div></div><div class=paragraph><p>Nagyobb felbontás esetén (legfeljebb 1024x768-as méretig) pedig a <span class=filename>/boot/loader.conf</span> állománynak a következõket kell tartalmaznia:</p></div><div class="literalblock programlisting"><div class=content><pre>vesa_load=&#34;YES&#34;
splash_bmp_load=&#34;YES&#34;
bitmap_load=&#34;YES&#34;
bitmap_name=&#34;/boot/betöltõkép.bmp&#34;</pre></div></div><div class=paragraph><p>Az iménti példában feltételeztük, hogy a <span class=filename>/boot/betöltõkép.bmp</span> állományt használjuk betöltõképként. Amikor azonban PCX állományokat akarunk használni, a következõ sorokat kell megadnunk, a felbontástól függõen a <code>vesa_load="YES"</code> sorral kiegészítve:</p></div><div class="literalblock programlisting"><div class=content><pre>splash_pcx_load=&#34;YES&#34;
bitmap_load=&#34;YES&#34;
bitmap_name=&#34;/boot/betöltõkép.pcx&#34;</pre></div></div><div class=paragraph><p>Természetesen a kép neve sem csak "betöltõkép" lehet. Tetszõlegesen elnevezhetjük, egyedül csak arra kell ügyelünk, hogy BMP vagy PCX formátumú legyen: <span class=filename>splash_640x400.bmp</span> vagy például <span class=filename>blue_wave.pcx</span>.</p></div><div class=paragraph><p>További érdekes beállítások a <span class=filename>loader.conf</span> állományból:</p></div><div class=dlist><dl><dt class=hdlist1><code>beastie_disable="YES"</code></dt><dd><p>Ennek megadásakor nem jelenik meg a rendszerindítási lehetõségeket felkínáló menü, de a visszaszámlálás megmarad. Hiába tiltjuk le a menüt, ilyenkor továbbra is választanunk kell a lehetõségek közül.</p></dd><dt class=hdlist1><code>loader_logo="beastie"</code></dt><dd><p>Ezzel a beállítással a menüben látható "FreeBSD" feliratot cserélhetjük le a korábbi kiadásokban szereplõ színes démonos emblémára.</p></dd></dl></div></div></div></div></div><div class=sect2><h3 id=boot-kernel>12.4. Kapcsolat a rendszermaggal a rendszerindítás folyamán<a class=anchor href=#boot-kernel></a></h3><div class=paragraph><p>Ahogy sikerült betölteni (a szokásos módon) a <a href=#boot-loader>rendszertöltõ</a>vel vagy (a rendszertöltõ átugrásával) a <a href=#boot-boot1>boot2</a> segítségével, a rendszermag megvizsgálja az esetlegesen átvett rendszerindítási paramétereket, és azoknak megfelelõen viselkedik.</p></div><div class=sect3><h4 id=boot-kernel-bootflags>12.4.1. A rendszermag paraméterei<a class=anchor href=#boot-kernel-bootflags></a></h4><div class=paragraph><p>A rendszermag leginkább használt paraméterei:</p></div><div class=dlist><dl><dt class=hdlist1><code>-a</code></dt><dd><p>a rendszermag inicializálása során rákérdez a gyökér állományrendszerként csatlakoztatandó eszközre.</p></dd><dt class=hdlist1><code>-C</code></dt><dd><p>a rendszer indítása CD-rõl.</p></dd><dt class=hdlist1><code>-c</code></dt><dd><p>a UserConfig, a rendszerindítás során használt rendszermag-beállító, futtatása.</p></dd><dt class=hdlist1><code>-s</code></dt><dd><p>a rendszer indítása egyfelhasználós módban.</p></dd><dt class=hdlist1><code>-v</code></dt><dd><p>részletesebb információk megjelenítése a rendszermag indítása során.</p></dd></dl></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Ezeken kívül még számos paraméter létezik, a teljes listát a <a href="https://man.freebsd.org/cgi/man.cgi?query=boot&amp;sektion=8&amp;format=html">boot(8)</a> man oldalon találhatjuk meg.</p></div></td></tr></tbody></table></div></div></div><div class=sect2><h3 id=device-hints>12.5. Eszköz útmutatók (device.hints)<a class=anchor href=#device-hints></a></h3><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Ez a lehetõség csak a FreeBSD 5.0 vagy annál késõbbi verzióiban jelenik meg.</p></div></td></tr></tbody></table></div><div class=paragraph><p>A rendszerindítás kezdeti szakaszában a <a href="https://man.freebsd.org/cgi/man.cgi?query=loader&amp;sektion=8&amp;format=html">loader(8)</a> beolvassa a <a href="https://man.freebsd.org/cgi/man.cgi?query=device.hints&amp;sektion=5&amp;format=html">device.hints(5)</a> állományt. Ebben az állományban tárolódnak a gyakran csak "eszköz útmutatóknak" nevezett változók, amelyek a rendszermag számára nyújtanak hasznos információkat az indulás során. Ezeket az "útmutatókat" az eszközmeghajtók hasznosítják az általuk ismert eszközök beállítása során.</p></div><div class=paragraph><p>Az eszközökre vonatkozó ilyen jellegû útmutatások a <a href=#boot-loader>harmadik fázisban</a> megjelenõ parancssorban is megadhatóak. A változókat a <code>set</code> (beállít) parancs segítségével tudjuk felvenni, míg az <code>unset</code> (eltávolít) paranccsal tudunk törölni, valamint a <code>show</code> (megmutat) paranccsal megjeleníteni az értéküket. Sõt, ezen a ponton a <span class=filename>/boot/device.hints</span> állománnyal már beállított változókat is felülbírálhatjuk. A rendszerindító parancssorában elvégzett módosítások viszont nem fognak megmaradni, és a következõ rendszerindítás alkalmával elvesznek.</p></div><div class=paragraph><p>Ahogy a rendszerünk használatra kész állapotba került, a <a href="https://man.freebsd.org/cgi/man.cgi?query=kenv&amp;sektion=1&amp;format=html">kenv(1)</a> parancs használható a változók értékeinek listázásához.</p></div><div class=paragraph><p>A <span class=filename>/boot/device.hints</span> állományban soronként egy-egy változót tudunk megadni, illetve a kettõskereszttel ("#") bevezetve megjegyzéseket illeszthetünk bele. A sorok szerkezete az alábbi:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell> útmutató.meghajtó.egység.kulcsszó<span class=o>=</span><span class=s2>&#34;érték&#34;</span></code></pre></div></div><div class=paragraph><p>A harmadik fázisban pedig így adhatjuk meg:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell> <span class=nb>set </span>útmutató.meghajtó.egység.kulcsszó<span class=o>=</span>érték</code></pre></div></div><div class=paragraph><p>Itt a <code>meghajtó</code> az eszközmeghajtó neve, az <code>egység</code> az eszközmeghajtó által kezelt egyik egység sorszáma, a <code>kulcsszó</code> pedig az útmutatáshoz tartozó kulcsszó. Ez a következõk egyike lehet:</p></div><div class=ulist><ul><li><p><code>at</code>: az útmutatás az eszköz által használt buszra vonatkozik.</p></li><li><p><code>port</code>: az útmutatás az eszköz által használt I/O-címre vonatkozik.</p></li><li><p><code>irq</code>: az útmutatás az eszköz által használt megszakítás sorszámára vonatkozik.</p></li><li><p><code>drq</code>: az útmutatás az eszköz által használt DMA-csatorna sorszámára vonatkozik.</p></li><li><p><code>maddr</code>: az útmutatás az eszköz által használt fizikai memóriaterület kezdõcímére vonatkozik.</p></li><li><p><code>flags</code>: az eszközhöz tartozó bitek beállítása.</p></li><li><p><code>disabled</code>: ha az értéke <code>1</code>, akkor az adott eszköz használatát letiltjuk.</p></li></ul></div><div class=paragraph><p>Az eszközmeghajtók elfogadhatnak (vagy várhatnak) olyan útmutatásokat is, amelyek itt nem szerepelnek, ezért mindegyik esetében érdemes áttekinteni a hozzájuk tartozó man oldalt. Bõvebb információért lásd a <a href="https://man.freebsd.org/cgi/man.cgi?query=device.hints&amp;sektion=5&amp;format=html">device.hints(5)</a>, <a href="https://man.freebsd.org/cgi/man.cgi?query=kenv&amp;sektion=1&amp;format=html">kenv(1)</a>, <a href="https://man.freebsd.org/cgi/man.cgi?query=loader.conf&amp;sektion=5&amp;format=html">loader.conf(5)</a> és <a href="https://man.freebsd.org/cgi/man.cgi?query=loader&amp;sektion=8&amp;format=html">loader(8)</a> man oldalakat.</p></div></div><div class=sect2><h3 id=boot-init>12.6. Init: A folyamatirányítás elindítása<a class=anchor href=#boot-init></a></h3><div class=paragraph><p>Miután a rendszermag sikeresen elindult, átadja a vezérlést az <a href="https://man.freebsd.org/cgi/man.cgi?query=init&amp;sektion=8&amp;format=html">init(8)</a> felhasználói folyamatnak, amely vagy az <span class=filename>/sbin/init</span>, vagy pedig a rendszerindítóban megadott <code>init_path</code> változó által mutatott program.</p></div><div class=sect3><h4 id=boot-autoreboot>12.6.1. Az automatikus újraindulási folyamat<a class=anchor href=#boot-autoreboot></a></h4><div class=paragraph><p>Az automatikus újraindulási folyamat gondoskodik róla, hogy az indulást követõen rendelkezésre álló állományrendszerek ne legyenek sérültek. Amennyiben mégis sérültek és a <a href="https://man.freebsd.org/cgi/man.cgi?query=fsck&amp;sektion=8&amp;format=html">fsck(8)</a> nem tudja megjavítani õket, az <a href="https://man.freebsd.org/cgi/man.cgi?query=init&amp;sektion=8&amp;format=html">init(8)</a> a rendszert <a href=#boot-singleuser>egyfelhasználós mód</a>ba állítja, ahol a rendszergazdának kell közvetlenül megoldania a fennálló problémákat.</p></div></div><div class=sect3><h4 id=boot-singleuser>12.6.2. Egyfelhasználós mód<a class=anchor href=#boot-singleuser></a></h4><div class=paragraph><p>Ezt a módot az <a href=#boot-autoreboot>automatikus újraindítási folyamat</a> során érhetjük el, vagy akkor, ha a rendszert a <code>-s</code> kapcsolóval indítjuk, esetleg a rendszerindítóban beállítjuk a <code>boot_single</code> változót.</p></div><div class=paragraph><p>Ezt a módot <a href=#boot-multiuser>többfelhasználós mód</a>ban, a <a href="https://man.freebsd.org/cgi/man.cgi?query=shutdown&amp;sektion=8&amp;format=html">shutdown(8)</a> hívásával is aktiválhatjuk, ha nem adjuk meg az újraindítást (<code>-r</code>) vagy leállítást (<code>-h</code>) kérõ opciók egyikét sem.</p></div><div class=paragraph><p>Ha az <span class=filename>/etc/ttys</span> állományban a <code>console</code> értékét <code>insecure</code> (nem biztonságos)ra állítjuk, a rendszer az egyfelhasználós módba lépés elõtt kérni fogja a <code>root</code> felhasználó jelszavát.</p></div><div id=boot-insecure-console class=exampleblock><div class=title>Példa 9. Nem biztonságos konzol megadása az <span class=filename>/etc/ttys</span>-ben</div><div class=content><div class="literalblock programlisting"><div class=content><pre># name  getty                           type    status          comments
#
# If console is marked &#34;insecure&#34;, then init will ask for the root password
# when going to single-user mode.
console none                            unknown off insecure</pre></div></div></div></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Az <code>insecure</code> (nem biztonságos) konzol az, ahol nem tekintjük megbízhatónak a rendszerkonzol fizikai biztonságát, és biztosak akarunk lenni benne, hogy csak az képes használni a rendszert egyfelhasználós módban, aki ismeri a <code>root</code> felhasználó jelszavát. Ez tehát nem arra utal, hogy magát a konzolt akarjuk nem biztonságos módban mûködtetni. Szóval, ha biztonságot akarunk, az <code>insecure</code>-t válasszuk, ne pedig a <code>secure</code>-t.</p></div></td></tr></tbody></table></div></div><div class=sect3><h4 id=boot-multiuser>12.6.3. Többfelhasználós mód<a class=anchor href=#boot-multiuser></a></h4><div class=paragraph><p>Ha az <a href="https://man.freebsd.org/cgi/man.cgi?query=init&amp;sektion=8&amp;format=html">init(8)</a> mindent rendben talál, vagy ha a felhasználó kilépett az <a href=#boot-singleuser>egyfelhasználós mód</a>ból, a rendszer többfelhasználós módba lép át, ahol megkezdi az erõforrások konfigurálását.</p></div><div class=sect4><h5 id=boot-rc>12.6.3.1. Az erõforrások konfigurációja (rc)<a class=anchor href=#boot-rc></a></h5><div class=paragraph><p>Az erõforrásokat konfiguráló alrendszer beolvassa a folyamathoz kapcsolódó változók alapértelmezett értékeit az <span class=filename>/etc/defaults/rc.conf</span> állományból, majd módosítja õket a rendszer egyéni beállításai szerint, amit a <span class=filename>/etc/rc.conf</span> állományból olvas ki. Ezután elvégzi az <span class=filename>/etc/fstab</span> alapján az állományrendszerek csatlakoztatását, elindítja a hálózati szolgáltatásokat, egyéb rendszerdaemonokat, és végezetül lefuttatja a telepített csomagok indítószkriptjeit.</p></div><div class=paragraph><p>Az erõforrásokat konfiguráló alrendszerrõl magáról az <a href="https://man.freebsd.org/cgi/man.cgi?query=rc&amp;sektion=8&amp;format=html">rc(8)</a> man oldalon, valamint az érintett szkriptek tanulmányozásával tudhatunk meg többet.</p></div></div></div></div><div class=sect2><h3 id=boot-shutdown>12.7. A leállítási folyamat<a class=anchor href=#boot-shutdown></a></h3><div class=paragraph><p>A <a href="https://man.freebsd.org/cgi/man.cgi?query=shutdown&amp;sektion=8&amp;format=html">shutdown(8)</a> paranccsal vezérelt leállítás során az <a href="https://man.freebsd.org/cgi/man.cgi?query=init&amp;sektion=8&amp;format=html">init(8)</a> megpróbálja lefuttatni az <span class=filename>/etc/rc.shutdown</span> szkriptet, majd ezt követõen <code>TERM</code> (befejeztetés) jelzést küld az aktuálisan futó folyamatoknak, kis idõ múlva pedig <code>KILL</code> (leállítás) jelzést azoknak, amelyek még nem álltak le addig a pillanatig.</p></div><div class=paragraph><p>Azokon az architektúrákon és rendszereken, ahol elérhetõ a fejlett energiagazdálkodás támogatása, a FreeBSD-t a <code>shutdown -p now</code> paranccsal állíthatjuk le, amit közvetlenül a számítógép automatikus kikapcsolása követ. A FreeBSD-s rendszer újraindításához egyszerûen csak adjuk ki a <code>shutdown -r now</code> parancsot. Fontos tudni, hogy alapértelmezés szerint a <a href="https://man.freebsd.org/cgi/man.cgi?query=shutdown&amp;sektion=8&amp;format=html">shutdown(8)</a> használatához <code>root</code> felhasználónak, vagy legalább az <code>operator</code> csoport tagjának kell lennünk. Ezekre a feladatokra egyébként a <a href="https://man.freebsd.org/cgi/man.cgi?query=halt&amp;sektion=8&amp;format=html">halt(8)</a> és <a href="https://man.freebsd.org/cgi/man.cgi?query=reboot&amp;sektion=8&amp;format=html">reboot(8)</a> parancsok is használhatóak. Alkalmazásukról bõvebben a hozzájuk, valamint a <a href="https://man.freebsd.org/cgi/man.cgi?query=shutdown&amp;sektion=8&amp;format=html">shutdown(8)</a>-hoz tartozó man oldalakon találhatunk bõvebben információkat.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Az energiagazdálkodás használatához a rendszermagnak beépítve vagy a megfelelõ modul betöltésével bizosítania kell az <a href="https://man.freebsd.org/cgi/man.cgi?query=acpi&amp;sektion=4&amp;format=html">acpi(4)</a> támogatást.</p></div></td></tr></tbody></table></div></div></div></div><div class=sect1><h2 id=users>Chapter 13. Felhasználók és hozzáférések alapvető kezelése<a class=anchor href=#users></a></h2><div class=sectionbody><div class=sect2><h3 id=users-synopsis>13.1. Áttekintés<a class=anchor href=#users-synopsis></a></h3><div class=paragraph><p>A FreeBSD lehetõvé teszi, hogy egyazon idõben egyszerre több felhasználó is dolgozhasson a számítógépen. Közülük nyilvánvalóan csak egy képes elõtte ülni , de rajta kívül még sok más felhasználó is be tud jelentkezni a munkájához hálózaton keresztül. A rendszer használatához minden egyes felhasználónak hozzáféréssel kell rendelkeznie.</p></div><div class=paragraph><p>A fejezet elolvasása során megismerjük:</p></div><div class=ulist><ul><li><p>a FreeBSD rendszerben megtalálható különféle felhasználói hozzáférések közti különbségeket;</p></li><li><p>hogyan készítsünk új felhasználói hozzáféréseket;</p></li><li><p>hogyan töröljünk felhasználói hozzáféréseket;</p></li><li><p>hogyan változtassuk meg a hozzáférés adatait, mint például a felhasználók teljes nevét vagy a választott parancsértelmezõjét;</p></li><li><p>hogyan korlátozzuk az egyes hozzáféréseket vagy hozzáférések egy csoportját az olyan erõforrások, mint például a memória vagy a processzoridõ védelmében;</p></li><li><p>hogyan használjuk csoportokat a hozzáférések karbantartásának megkönnyítésére.</p></li></ul></div><div class=paragraph><p>A fejezet elolvasásához ajánlott:</p></div><div class=ulist><ul><li><p>a UNIX® és a FreeBSD alapjainak ismerete (<a href=./#basics>A UNIX alapjai</a>).</p></li></ul></div></div><div class=sect2><h3 id=users-introduction>13.2. Bevezetés<a class=anchor href=#users-introduction></a></h3><div class=paragraph><p>A rendszert bármilyen fajta módon csak hozzáféréseken keresztül tudjuk elérni, minden programot felhasználók futtatnak, ezért a felhasználók és hozzáférések kezelése a FreeBSD rendszerek szerves része.</p></div><div class=paragraph><p>A FreeBSD rendszerben minden hozzáférés rendelkezik bizonyos információkkal az azonosításhoz.</p></div><div class=dlist><dl><dt class=hdlist1>Felhasználó neve</dt><dd><p>A felhasználónevet a <code>login:</code> felirat megjelenésekor kell megadni. A felhasználók neveinek egyedinek kell lenni a számítógépen, tehát két felhasználó nem használhatja ugyanazt a nevet. A <a href="https://man.freebsd.org/cgi/man.cgi?query=passwd&amp;sektion=5&amp;format=html">passwd(5)</a> man oldalon megtalálhatjuk azokat a szabályokat, amelyek az érvényes felhasználónevek létrehozására vonatkoznak. Általánosságban elmondható, hogy a felhasználóneveknek kisbetûseknek kell lenniük és legfeljebb nyolc karakterbõl állhatnak.</p></dd><dt class=hdlist1>Jelszó</dt><dd><p>Minden hozzáféréshez tartozik egy jelszó is. Ez a jelszó lehet akár üres is, ebben az esetben nincs szükség jelszóra a hozzáféréshez. Ez viszont többnyire nagyon rossz ötlet: minden hozzáférést erõsen ajánlott jelszóval védeni.</p></dd><dt class=hdlist1>Felhasználó azonosítója (User ID, UID)</dt><dd><p>Az UID egy szám, amely hagyományosan 0-tól 65535-ig terjed , és a felhasználó rendszeren belüli egyedi azonosítására használatos. A FreeBSD az UID-ot a felhasználók azonosítására használja - bármelyik parancs, amely lehetõvé teszi felhasználónevek megadását, át fogja alakítani UID-dé, mielõtt ténylegesen dolgozni kezdene vele. Ez tehát azt jelenti, hogy több hozzáférésünk is lehet több különbözõ felhasználónévvel, de ugyanazzal az UID-del. Legalább is a FreeBSD ezeket egyetlen felhasználónak tekinti, de nem is valószínû, hogy ilyenre valaha szükségünk is lenne.</p></dd><dt class=hdlist1>Csoportazonosító (Group ID, GID)</dt><dd><p>A csoportazonosító (Group ID, GID) egy szám, amely általában 0-tól 65535-ig terjed , és azt az elsõdleges csoportot azonosítja be egyedileg, amelyikhez a felhasználó tartozik. A csoportok segítségével az erõforrások hozzáférésének vezérlését tudjuk megoldani a felhasználók GID-jével az UID-dek helyett. Ezzel jelentõs mértékben csökkenthetõ egyes konfigurációs állományok mérete. Egy felhasználó egyszerre több csoport tagja is lehet.</p></dd><dt class=hdlist1>Bejelentkezési osztály</dt><dd><p>A bejelentkezési osztályok a csoportszervezés kibõvítését célozzák meg, további rugalmasságot nyújtanak, amikor a rendszert az egyes felhasználók igényeihez szabjuk.</p></dd><dt class=hdlist1>Jelszóváltási idõ</dt><dd><p>Alapértelmezés szerint a FreeBSD nem kényszeríti rá a felhasználókat, hogy rendszeresen megváltoztassák a jelszavukat. Ezt felhasználónként kikényszeríthetjük, és így az egyes, vagy akár az összes felhasználót kötelezhetjük az adott idõközönként jelszóváltásra.</p></dd><dt class=hdlist1>A hozzáférés lejárati ideje</dt><dd><p>A FreeBSD-ben alapértelmezés szerint nem évülnek el a hozzáférések. Ha azonban olyan hozzáféréseket kell létrehoznunk, melyeknek korlátoznunk kell az élettartamukat, mint például egy iskolában a diákok számára, akkor ilyenkor meg tudjuk adni a lejáratuk idejét. Ezen dátum után a hozzáféréssel már nem lehet bejelentkezni a rendszerbe, viszont a hozzá tartozó könyvtárban tárolt állományok továbbra is megmaradnak.</p></dd><dt class=hdlist1>Felhasználó teljes neve</dt><dd><p>Míg a felhasználónév tökéletesen azonosítja a FreeBSD számára a hozzáférést, nem feltétlenül tükrözi a felhasználó valódi nevét. Ezt az információt is meg lehet adni a hozzáféréshez.</p></dd><dt class=hdlist1>Felhasználói könyvtár</dt><dd><p>A felhasználói könyvtár a rendszerben található azon könyvtár teljes elérési útvonala, ahová a felhasználó a bejelentkezést követõen kerül. Elterjedt megszokás, hogy az összes felhasználó könyvtárát a <span class=filename>/home/felhasználónév</span> vagy a <span class=filename>/usr/home/felhasználónév</span> könyvtárba teszik. A felhasználók ezekben a könyvtárakban tárolják a személyes állományaikat, és tetszõleges könyvtárakat hozhatnak létre benne.</p></dd><dt class=hdlist1>Felhasználói parancsértelmezõ</dt><dd><p>A parancsértelmezõ biztosítja azt az alapértelmezett környezetet, amelyben a felhasználó kapcsolatba tud lépni a rendszerrel. Többféle parancsértelmezõ is akad, és a tapasztaltabb felhasználók ragaszkodnak is némelyikükhöz, ami gyakran látható is a hozzáférésük beállításaiban.</p></dd></dl></div><div class=paragraph><p>Három fõ típusa van a hozzáféréseknek: az <a href=#users-superuser>adminisztrátori</a>, a <a href=#users-system>rendszer</a> és a <a href=#users-user>felhasználói</a> hozzáférések. Az adminisztátori hozzáférés, amelyre gyakran <code>root</code>ként hivatkoznak, használatos a rendszer karbantartására, és semmilyen korlátozás nem érvényes rá. A rendszerhozzáférések szolgáltatásokat futtatnak. Végezetül a felhasználói hozzáféréseket használják a valódi emberek, akik bejelentkeznek, leveleket olvasnak és így tovább.</p></div></div><div class=sect2><h3 id=users-superuser>13.3. Az adminisztrátori hozzáférés<a class=anchor href=#users-superuser></a></h3><div class=paragraph><p>Az adminisztátori hozzáférés, amelyet általában csak <code>root</code>nak nevezünk, a rendszeradminisztrációs feladatok elvégzéséhez van igazítva, és nem ajánlott az olyan hétköznapi tevékenységek elvégzéséhez, mint például a levelek olvasása és írása, a rendszer bejárása vagy a programozás.</p></div><div class=paragraph><p>Ezért az adminisztrátor, eltérõen az átlagos felhasználói hozzáférésektõl, képes mindenféle határok nélkül tevékenykedni, és az adminisztrátori hozzáférés helytelen használata látványos katasztrófákat idézhet elõ. A felhasználói hozzáférések képtelenek merõ véletlenségbõl tönkretenni a rendszert, ezért általánosságban véve az a legjobb, ha egyszerû felhasználói hozzáféréseket használunk, amint módunk van rá, hacsak nincs szükségünk kifejezetten különleges jogosultságokra.</p></div><div class=paragraph><p>Minden esetben érdemes alaposan megfontolni az adminisztrátorként kiadott parancsokat, mivel egyetlen hiányzó szóköz vagy más egyéb karakter helyrehozhatatlan károkat okozhat a rendszerben.</p></div><div class=paragraph><p>Ezért, ha még nem tettük volna meg korábban, legyen az elsõ dolgunk a fejezet elolvasása után, hogy létrehozunk egy kiemelt jogosultságokkal nem rendelkezõ felhasználót saját magunk számára a hétköznapi feladatok lebonyolítására. Ez ugyanúgy vonatkozik a többfelhasználós és az egyfelhasználós módban futó rendszerekre is. A fejezet egy késõbbi részében leírjuk, hogyan lehet további hozzáféréseket létrehozni, és hogyan kell váltani egy mezei felhasználó és az adminisztrátor hozzáférése között.</p></div></div><div class=sect2><h3 id=users-system>13.4. Rendszerhozzáférések<a class=anchor href=#users-system></a></h3><div class=paragraph><p>A rendszer általi hozzáférések azok, amelyek olyan szolgáltatások futtatásáért felelõsek, mint például a DNS, a levelezés, a webszerverek és így tovább. Ennek oka a biztonság: ha minden szolgáltatást adminisztrátorként futtatnánk, bármit meg tudnának tenni a rendszerben.</p></div><div class=paragraph><p>Ilyen rendszerfelhasználók a <code>daemon</code>, <code>operator</code>, <code>bind</code> (a névfeloldáshoz), <code>news</code>, és a <code>www</code>.</p></div><div class=paragraph><p>A <code>nobody</code> ("senki") egy általános jogosultságok nélküli rendszerfelhasználó. Mindazonáltal nem szabad elfelejtenünk, hogy minél több szolgáltatást bízunk a <code>nobody</code>-ra, annál több állomány és program kerül vele kapcsolatba, ennélfogva annál erõsebbé válik a rendszer számára ez a felhasználó.</p></div></div><div class=sect2><h3 id=users-user>13.5. Felhasználói hozzáférések<a class=anchor href=#users-user></a></h3><div class=paragraph><p>A felhasználói hozzáférések a valós felhasználók elsõdleges eszközei a rendszer felé, és ezek a hozzáférések szigetelik el a felhasználókat és a környezeteket, megakadályozva, hogy a felhasználók kárt okozzanak akár a rendszerben, akár egymásnak, valamint lehetõvé teszik a felhasználók számára a környezeteik testreszabását anélkül, hogy a többiekét módosítani kellene.</p></div><div class=paragraph><p>Minden olyan személynek, aki hozzá akar férni a rendszerünkhöz, rendelkeznie kell felhasználói azonosítóval. Ezáltal meg tudjuk állapítani, ki mivel foglalkozik éppen a rendszerben, és meg tudjuk akadályozni, hogy a felhasználók elérjék egymás beállításait, olvassák egymás leveleit és így tovább.</p></div><div class=paragraph><p>Minden felhasználó alakítani tudja a saját környezetét, és ezzel mintegy berendezkedik a rendszerünkben, különféle parancsértelmezõk, szövegszerkesztõk, billentyû-hozzárendelések és nyelvek használatával.</p></div></div><div class=sect2><h3 id=users-modifying>13.6. A hozzáférések módosítása<a class=anchor href=#users-modifying></a></h3><div class=paragraph><p>Egy UNIX®-os környezetben több különbözõ parancs közül választhatunk a felhasználói hozzáférések módosításakor. A legáltalánosabb parancsokat az alábbiakban foglaljuk össze, amit ezután a használatukat részletesebben bemutató példák követnek.</p></div><table class="tableblock frame-none grid-all stretch informaltable"><col style=width:50%><col style=width:50%><thead><tr><th class="tableblock halign-left valign-top">Parancs</th><th class="tableblock halign-left valign-top">Leírás</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class=tableblock><a href="https://man.freebsd.org/cgi/man.cgi?query=adduser&amp;sektion=8&amp;format=html">adduser(8)</a></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>az új felhasználók felvételére ajánlott parancssoros alkalmazás</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><a href="https://man.freebsd.org/cgi/man.cgi?query=rmuser&amp;sektion=8&amp;format=html">rmuser(8)</a></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>a felhasználók eltávolítására ajánlott parancssoros alkalmazás</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><a href="https://man.freebsd.org/cgi/man.cgi?query=chpass&amp;sektion=1&amp;format=html">chpass(1)</a></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>rugalmas eszköz a felhasználói adatbázis információinak megváltoztatására</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><a href="https://man.freebsd.org/cgi/man.cgi?query=passwd&amp;sektion=1&amp;format=html">passwd(1)</a></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>egy egyszerû parancssoros segédprogram a felhasználói jelszavak megváltoztatásához</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><a href="https://man.freebsd.org/cgi/man.cgi?query=pw&amp;sektion=8&amp;format=html">pw(8)</a></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>egy erõteljes és rugalmas segédeszköz a felhasználói hozzáférések teljeskörû módosításához</p></td></tr></tbody></table><div class=sect3><h4 id=users-adduser>13.6.1. <code>adduser</code><a class=anchor href=#users-adduser></a></h4><div class=paragraph><p>Az <a href="https://man.freebsd.org/cgi/man.cgi?query=adduser&amp;sektion=8&amp;format=html">adduser(8)</a> a felhasználók hozzáadására használható egyszerû program. Bejegyzéseket hoz létre a rendszer <span class=filename>passwd</span> és <span class=filename>group</span> állományaiban. Ezen kívül még létrehozza az új felhasználó könyvtárát is, odamásolja az alapértelmezett konfigurációs állományokat a <span class=filename>/usr/shared/skel</span> könyvtárból (ezek a felhasználóknál ponttal kezdõdõen jelennek meg, de az említett könyvtárban "dot" elõtaggal szerepelnek), és opcionálisan küld egy üdvözlõlevelet az újdonsült felhasználónak.</p></div><div class=exampleblock><div class=title>Példa 10. Felhasználó hozzáadása a FreeBSD-ben</div><div class=content><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># adduser</span>
Username: jantyik
Full name: Jantyik Zsolt
Uid <span class=o>(</span>Leave empty <span class=k>for </span>default<span class=o>)</span>:
Login group <span class=o>[</span>jantyik]:
Login group is jantyik. Invite jantyik into other <span class=nb>groups</span>? <span class=o>[]</span>: wheel
Login class <span class=o>[</span>default]:
Shell <span class=o>(</span>sh csh tcsh zsh nologin<span class=o>)</span> <span class=o>[</span>sh]: zsh
Home directory <span class=o>[</span>/home/jantyik]:
Use password-based authentication? <span class=o>[</span><span class=nb>yes</span><span class=o>]</span>:
Use an empty password? <span class=o>(</span><span class=nb>yes</span>/no<span class=o>)</span> <span class=o>[</span>no]:
Use a random password? <span class=o>(</span><span class=nb>yes</span>/no<span class=o>)</span> <span class=o>[</span>no]:
Enter password:
Enter password again:
Lock out the account after creation? <span class=o>[</span>no]:
Username   : jantyik
Password   : <span class=k>****</span>
Full Name  : Jantyik Zsolt
Uid        : 1001
Class      :
Groups     : jantyik wheel
Home       : /home/jantyik
Shell      : /usr/local/bin/zsh
Locked     : no
OK? <span class=o>(</span><span class=nb>yes</span>/no<span class=o>)</span>: <span class=nb>yes
</span>adduser: INFO: Successfully added <span class=o>(</span>jantyik<span class=o>)</span> to the user database.
Add another user? <span class=o>(</span><span class=nb>yes</span>/no<span class=o>)</span>: no
Goodbye!
<span class=c>#</span></code></pre></div></div></div></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>A jelszó a beírás során egyáltalán nem jelenik meg, még csillagokat sem láthatunk a karakterek helyén. Ezért vigyázzunk, nehogy elgépeljük véletlenül a jelszót!</p></div></td></tr></tbody></table></div></div><div class=sect3><h4 id=users-rmuser>13.6.2. <code>rmuser</code><a class=anchor href=#users-rmuser></a></h4><div class=paragraph><p>Az <a href="https://man.freebsd.org/cgi/man.cgi?query=rmuser&amp;sektion=8&amp;format=html">rmuser(8)</a> használható a felhasználók teljes eltávolítására a rendszerbõl. Az <a href="https://man.freebsd.org/cgi/man.cgi?query=rmuser&amp;sektion=8&amp;format=html">rmuser(8)</a> az alábbi lépéseket hajtja végre:</p></div><div class="exampleblock procedure"><div class=content><div class="olist arabic"><ol class=arabic><li><p>Eltávolítja a felhasználó <a href="https://man.freebsd.org/cgi/man.cgi?query=crontab&amp;sektion=1&amp;format=html">crontab(1)</a> bejegyzéseit (amennyiben léteznek).</p></li><li><p>Eltávolítja az <a href="https://man.freebsd.org/cgi/man.cgi?query=at&amp;sektion=1&amp;format=html">at(1)</a> felhasználóhoz tartozó munkáit.</p></li><li><p>Leállítja a felhasználó által birtokolt összes futó programot.</p></li><li><p>Eltávolítja a felhasználót a rendszer helyi jelszó állományából.</p></li><li><p>Eltávolítja a felhasználó könyvtárát (amennyiben az a felhasználó birtokában van).</p></li><li><p>Eltávolítja a felhasználóhoz tartozó beérkezõ leveleket tartalmazó állományt a <span class=filename>/var/mail</span> könyvtárból.</p></li><li><p>Eltávolítja a felhasználó tulajdonában levõ összes állományt az olyan ideiglenes tárhelyekrõl, mint például a <span class=filename>/tmp</span> könyvtár.</p></li><li><p>Végezetül eltávolítja a felhasználó nevét az összes olyan csoportból, amelyhez az <span class=filename>/etc/group</span> szerint tartozik.</p><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Ha menet közben egy csoport üressé válik, és a csoport neve megegyezik a felhasználó nevével, a csoport is eltávolításra kerül. Ez kiegészíti az <a href="https://man.freebsd.org/cgi/man.cgi?query=adduser&amp;sektion=8&amp;format=html">adduser(8)</a> eszközzel létrehozott felhasználónkénti egyedi csoportokat.</p></div></td></tr></tbody></table></div></li></ol></div></div></div><div class=paragraph><p>A <a href="https://man.freebsd.org/cgi/man.cgi?query=rmuser&amp;sektion=8&amp;format=html">rmuser(8)</a> nem használható adminisztrátori hozzáférések törlésére, mivel az szinte majdnem mindig a teljes összeomlást vonja maga után.</p></div><div class=paragraph><p>Alapértelmezés szerint interaktív módban mûködik, melynek során megpróbál megbizonyosodni róla, hogy tényleg a megfelelõ dolgot cselekedjük.</p></div><div class=exampleblock><div class=title>Példa 11. <code>rmuser</code> Hozzáférések interaktív eltávolítása</div><div class=content><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># rmuser jantyik</span>
Matching password entry:
jantyik:<span class=k>*</span>:1001:1001::0:0:Jantyik Zsolt:/home/jantyik:/usr/local/bin/zsh
Is this the entry you wish to remove? y
Remove user<span class=s1>&#39;s home directory (/home/jantyik)? y
Updating password file, updating databases, done.
Updating group file: trusted (removing group jantyik -- personal group is empty) done.
Removing user&#39;</span>s incoming mail file /var/mail/jantyik: <span class=k>done</span><span class=nb>.</span>
Removing files belonging to jantyik from /tmp: <span class=k>done</span><span class=nb>.</span>
Removing files belonging to jantyik from /var/tmp: <span class=k>done</span><span class=nb>.</span>
Removing files belonging to jantyik from /var/tmp/vi.recover: <span class=k>done</span><span class=nb>.</span>
<span class=c>#</span></code></pre></div></div></div></div></div><div class=sect3><h4 id=users-chpass>13.6.3. <code>chpass</code><a class=anchor href=#users-chpass></a></h4><div class=paragraph><p>A <a href="https://man.freebsd.org/cgi/man.cgi?query=chpass&amp;sektion=1&amp;format=html">chpass(1)</a> segítségével meg tudjuk változtatni a felhasználói adatbázisban található információkat, mint például a jelszavakat, parancsértelmezõket és a személyes adatokat.</p></div><div class=paragraph><p>Csak a rendszeradminisztrátoroknak, mint például magának az adminisztrátornak, szabad megváltoztatnia a felhasználók adatait a <a href="https://man.freebsd.org/cgi/man.cgi?query=chpass&amp;sektion=1&amp;format=html">chpass(1)</a> programmal.</p></div><div class=paragraph><p>Amikor az opcionálisan megadható felhasználói névtõl eltekintve nem adunk át neki paramétereket, a <a href="https://man.freebsd.org/cgi/man.cgi?query=chpass&amp;sektion=1&amp;format=html">chpass(1)</a> egy szövegszerkesztõben megnyitja az érintett felhasználó adatait. Miután kiléptünk belõle, a felhasználói adatbázist a megváltoztatott adatoknak megfelelõen frissíti.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Ha nem adminisztrátorként hívjuk meg, akkor a rendszer kérni fogja a jelszavunkat, miután kiléptünk a szövegszerkesztõbõl.</p></div></td></tr></tbody></table></div><div class=exampleblock><div class=title>Példa 12. A <code>chpass</code> interaktív használata adminisztrátorként</div><div class=content><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># A jantyik nevű felhasználó adatainak módosítása.</span>
Login: jantyik
Password: <span class=k>*</span>
Uid <span class=o>[</span><span class=c>#]: 1001</span>
Gid <span class=o>[</span><span class=c># or name]: 1001</span>
Change <span class=o>[</span>month day year]:
Expire <span class=o>[</span>month day year]:
Class:
Home directory: /home/jantyik
Shell: /usr/local/bin/zsh
Full Name: Jantyik Zsolt
Office Location:
Office Phone:
Home Phone:
Other information:</code></pre></div></div></div></div><div class=paragraph><p>Egy átlagos felhasználó a bemutatott adatoknak csak igen kis részét képes módosítani, és azokat is csak saját maga számára.</p></div><div class=exampleblock><div class=title>Példa 13. A <code>chpass</code> interaktív használata normál felhasználóként</div><div class=content><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># A jantyik nevű felhasználó adatainak megváltoztatása.</span>
Shell: /usr/local/bin/zsh
Full Name: Jantyik Zsolt
Office Location:
Office Phone:
Home Phone:
Other information:</code></pre></div></div></div></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>A <a href="https://man.freebsd.org/cgi/man.cgi?query=chfn&amp;sektion=1&amp;format=html">chfn(1)</a> és <a href="https://man.freebsd.org/cgi/man.cgi?query=chsh&amp;sektion=1&amp;format=html">chsh(1)</a> parancsok csupán linkek a <a href="https://man.freebsd.org/cgi/man.cgi?query=chpass&amp;sektion=1&amp;format=html">chpass(1)</a> parancsra, akárcsak a <a href="https://man.freebsd.org/cgi/man.cgi?query=ypchpass&amp;sektion=1&amp;format=html">ypchpass(1)</a>, <a href="https://man.freebsd.org/cgi/man.cgi?query=ypchfn&amp;sektion=1&amp;format=html">ypchfn(1)</a> és az <a href="https://man.freebsd.org/cgi/man.cgi?query=ypchsh&amp;sektion=1&amp;format=html">ypchsh(1)</a>. A NIS támogatása teljesen magától mûködik, ezért az <code>yp</code> elõtag használata nem kötelezõ. Ha ez nem érthetõ, nem kell megijedni, a NIS-t majd a <a href=./#network-servers>Hálózati szerverek</a>ben bemutatjuk.</p></div></td></tr></tbody></table></div></div><div class=sect3><h4 id=users-passwd>13.6.4. <code>passwd</code><a class=anchor href=#users-passwd></a></h4><div class=paragraph><p>Felhasználóként a saját jelszavunkat, adminisztrátorként pedig bármelyik felhasználó jelszavát a <a href="https://man.freebsd.org/cgi/man.cgi?query=passwd&amp;sektion=1&amp;format=html">passwd(1)</a> segítségével váloztathatjuk meg a megszokott módon.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>A véletlen balesetek és az illetéktelen változtatások ellen védelmet nyújt, hogy az eredeti jelszót is meg kell adnunk az új jelszó beállításához.</p></div></td></tr></tbody></table></div><div class=exampleblock><div class=title>Példa 14. A jelszavunk megváltoztatása</div><div class=content><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>% passwd
Changing <span class=nb>local </span>password <span class=k>for </span>jantyik.
Old password:
New password:
Retype new password:
passwd: updating the database...
passwd: <span class=k>done</span></code></pre></div></div></div></div><div class=exampleblock><div class=title>Példa 15. Egy másik felhasználó jelszavának megváltoztatása adminisztrátorként</div><div class=content><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># passwd jantyik</span>
Changing <span class=nb>local </span>password <span class=k>for </span>jantyik.
New password:
Retype new password:
passwd: updating the database...
passwd: <span class=k>done</span></code></pre></div></div></div></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Ahogy a <a href="https://man.freebsd.org/cgi/man.cgi?query=chpass&amp;sektion=1&amp;format=html">chpass(1)</a>, az <a href="https://man.freebsd.org/cgi/man.cgi?query=yppasswd&amp;sektion=1&amp;format=html">yppasswd(1)</a> is csak egy link a <a href="https://man.freebsd.org/cgi/man.cgi?query=passwd&amp;sektion=1&amp;format=html">passwd(1)</a> parancsra, így a NIS mind a két megadási módban mûködik.</p></div></td></tr></tbody></table></div></div><div class=sect3><h4 id=users-pw>13.6.5. <code>pw</code><a class=anchor href=#users-pw></a></h4><div class=paragraph><p>A <a href="https://man.freebsd.org/cgi/man.cgi?query=pw&amp;sektion=8&amp;format=html">pw(8)</a> egy olyan parancssori segédprogram, amellyel felhasználókat és csoportokat tudunk létrehozni, törölni, módosítani és megjeleníteni. Ez tulajdonképpen a rendszer felhasználókat és csoportokat tároló állományainak egyfajta kezelõfelülete. A <a href="https://man.freebsd.org/cgi/man.cgi?query=pw&amp;sektion=8&amp;format=html">pw(8)</a> kiválóan paraméterezhetõ, aminek köszönhetõen remekül kiaknázható tudása a különféle parancsértelmezõk szkriptjeiben, habár a kezdõ felhasználók nehézkesebbnek érezhetik a kezelését a korábban mutatott parancsokhoz képest.</p></div></div></div><div class=sect2><h3 id=users-limiting>13.7. A felhasználók korlátozása<a class=anchor href=#users-limiting></a></h3><div class=paragraph><p>Ha már vannak felhasználóink, gyakran szóba kerülhet esetükben a rendszer használatának korlátozása. A FreeBSD rengeteg módon engedi korlátozni a rendszergazdának az egyénenként használható erõforrások mennyiségét a rendszerben. Ezek a korlátok két részre oszthatóak: a lemezkvótákra és egyéb erõforráskorlátokra.</p></div><div class=paragraph><p>A lemezkvóták a felhasználók lemezhasználatát korlátozzák, és lehetõvé teszik, hogy állandó újraszámolás nélkül, gyorsan ellenõrizni tudjuk ennek mértékét. A kvótákat a <a href=./#quotas>Az állományrendszerek kvótái</a>ban részletezzük.</p></div><div class=paragraph><p>A többi erõforrás korlátozása magában foglalja a processzoridõ, memória és minden olyan erõforrás behatárolását, amihez a felhasználó csak hozzá tud férni. Ezeket bejelentkezési osztályokon keresztül határozzuk meg, ezekrõl esik itt most szó.</p></div><div class=paragraph><p>A bejelentkezési osztályokat az <span class=filename>/etc/login.conf</span> állományban adhatjuk meg. Ennek pontos ismertetése nem tárgya ennek a szakasznak, de ezt megtalálhatjuk a <a href="https://man.freebsd.org/cgi/man.cgi?query=login.conf&amp;sektion=5&amp;format=html">login.conf(5)</a> man oldalon. Elegendõ csak annyit mondanunk, hogy minden felhasználóhoz tartozik egy bejelentkezési osztály (alapértelmezés szerint a <code>default</code> nevû), és minden egyes bejelentkezési osztályhoz tulajdonságok egy halmaza társul. Ezek a bejelentkezési tulajdonságok <code>név=érték</code> párosokból állnak, ahol <em>név</em> egy jól ismert azonosító, illetve az <em>érték</em> egy tetszõleges sztring, melyet a nevétõl függõ módon dolgozunk fel. A bejelentkezési osztályok és tulajdonságok beállítása eléggé magától értetõdõ, és a <a href="https://man.freebsd.org/cgi/man.cgi?query=login.conf&amp;sektion=5&amp;format=html">login.conf(5)</a> man oldal is jól leírja.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>A rendszer általában nem magát az <span class=filename>/etc/login.conf</span> állományban található beállításokat olvassa be, hanem az <span class=filename>/etc/login.conf.db</span> állományt, amiben gyorsabban lehet keresni. Az <span class=filename>/etc/login.conf</span> állományból az <span class=filename>/etc/login.conf.db</span> állományt az alábbi paranccsal tudjuk legyártani:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># cap_mkdb /etc/login.conf</span></code></pre></div></div></td></tr></tbody></table></div><div class=paragraph><p>Az erõforrások korlátozása két irányban is eltér a sima hétköznapi bejelentkezési tulajdonságoktól. Elõször is minden korláthoz létezik egy gyenge (aktuális) és egy erõs korlát. A gyenge korlátok a felhasználók vagy az alkalmazások részérõl még finomíthatóak, de az erõs korláton túl már nem. Ez utóbbit mindig tudja csökkenteni a felhasználó, de sose tudja növelni. Másodsorban a legtöbb erõforráskorlát az adott felhasználó által futtatott programokra egyenként vonatkozik, nem pedig az összesre együttesen. Megjegyezzük azonban, hogy ezeket az eltéréseket a korlátok különleges kezelése indokolja, nem pedig a bejelentkezési tulajdonságok rendszerének megvalósítása (tehát a korlátok <em>valójában nem</em> ezen tulajdonságok speciális esetei.)</p></div><div class=paragraph><p>Így aztán, minden további magyarázkodás nélkül, felsoroljunk alant a leggyakrabban alkalmazott erõforráskorlátokat (a többi, más egyéb bejelentkezési tulajdonságokkal együtt, megtalálható a <a href="https://man.freebsd.org/cgi/man.cgi?query=login.conf&amp;sektion=5&amp;format=html">login.conf(5)</a> man oldalon).</p></div><div class=dlist><dl><dt class=hdlist1><code>coredumpsize</code></dt><dd><p>A program által létrehozott memóriakivonat maximális méretét határolja be ez a korlát, értelemszerûen a többi lemezterületre vonatkozó korlátnak (például a <code>filesize</code> vagy a lemezkvóták) alárendelt módon. Mindazonáltal ezt gyakran használjuk egyfajta enyhébb lemezfoglalási korlátként. Mivel nem maguk a felhasználók hozzák létre ezeket az állományokat és sokszor nem is törlik le ezeket, ez a beállítás azonban megmentheti ezeket a nagyobb programok (mint például az emacs) összeomlása során keletkezõ memóriakivonatok felesleges helyfoglalásától.</p></dd><dt class=hdlist1><code>cputime</code></dt><dd><p>Az a maximális processzoridõ, amit a felhasználó által futtatott programok egyenként fogyaszthatnak. A vétkezõ programok futását a rendszermag leállítja.</p><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Ez a korlát a processzor<em>idõ</em>re vonatkozik, nem pedig a processzor kihasználtságának százalékára, ahogy a <a href="https://man.freebsd.org/cgi/man.cgi?query=top&amp;sektion=1&amp;format=html">top(1)</a> és a <a href="https://man.freebsd.org/cgi/man.cgi?query=ps&amp;sektion=1&amp;format=html">ps(1)</a> szokta megjeleníteni. Ez utóbbi alapján korlátozni ugyanis, még ezen leírás készítésének pillanataiban nem lehetséges, és meglehetõsen hasztalan is lenne: egy fordítóprogram - ami minden bizonnyal egy szabályosan futó program - könnyen fel tudja emészteni majdnem az egész processzort egy idõre.</p></div></td></tr></tbody></table></div></dd><dt class=hdlist1><code>filesize</code></dt><dd><p>A felhasználó által birtokolható állományok maximális mérete. Eltérõen a <a href=./#quotas>lemezkvótáktól</a>, ez a korlát az egyes állományokra vonatkozik, nem pedig a felhasználó összes állományára együttesen.</p></dd><dt class=hdlist1><code>maxproc</code></dt><dd><p>A felhasználó által egyidõben, az elõtérben és a háttérben futtatható programok maximális száma. Érthetõ okokból ez az érték nem lehet nagyobb, mint a rendszerben a <a href="https://man.freebsd.org/cgi/man.cgi?query=sysctl&amp;sektion=8&amp;format=html">sysctl(8)</a> által definiált <code>kern.maxproc</code> (a rendszermag által maximálisan futtatható programok számának) értéke. Érdemes még továbbá megjegyezni, hogy ez a beállítás gátolhatja a felhasználó munkáját: gyakran hasznos lehet egyszerre több példányban is bejelentkezni a rendszerbe vagy csövekkel összekapcsolt programokat futtatni. Bizonyos feladatok, mint például egy nagyobb program lefordítása, több program futására is szétterjedhetnek (például a <a href="https://man.freebsd.org/cgi/man.cgi?query=make&amp;sektion=1&amp;format=html">make(1)</a>, <a href="https://man.freebsd.org/cgi/man.cgi?query=cc&amp;sektion=1&amp;format=html">cc(1)</a> és egyéb köztes feldolgozókra).</p></dd><dt class=hdlist1><code>memorylocked</code></dt><dd><p>Ezzel korlátozhatjuk az egyes futó programok által zárolható memóriaterület méretét a központi memóriában (lásd <a href="https://man.freebsd.org/cgi/man.cgi?query=mlock&amp;sektion=2&amp;format=html">mlock(2)</a>). Egyes rendszerkritikus programok, mint például az <a href="https://man.freebsd.org/cgi/man.cgi?query=amd&amp;sektion=8&amp;format=html">amd(8)</a>, zárolják magukat a központi memóriában, és ezért soha nem lapozódnak ki onnan. Ennek köszönhetõen nem érinti ezeket a rendszer lapozásból eredõ esetleges lelassulása.</p></dd><dt class=hdlist1><code>memoryuse</code></dt><dd><p>Ez az a maximális memóriamennyiség, amelyet egy futó program egyszerre használhat. Ebbe együttesen beleértendõ a központi memóriában és a lapozóállományban elfoglalt hely. Ez ugyan nem minden szempontból korlátozza egy program memóriahasználatát, de indulásnak megfelelõ.</p></dd><dt class=hdlist1><code>openfiles</code></dt><dd><p>A felhasználó egyes futtatott programjai által egy idõben megnyitható állományok maximális száma. FreeBSD-ben az állományok közé a foglalatok és az IPC-csatornák is beszámítanak. Ezért vigyázzunk, nehogy véletlenül túlságosan alacsonyra állítsuk ezt az értéket. Ezt rendszerszinten a <code>kern.maxfiles</code> <a href="https://man.freebsd.org/cgi/man.cgi?query=sysctl&amp;sektion=8&amp;format=html">sysctl(8)</a> érték határozza meg.</p></dd><dt class=hdlist1><code>sbsize</code></dt><dd><p>A korlátozás a felhasználó által egyszerre maximálisan elérhetõ hálózati memória és így a rendszermag puffereire vonatkozik. Eredetileg a régebbi, sok csatlakozást felemésztõ DoS (Denial of Service) támadások ellen nyújtana védelmet, de általánosságban alkalmazható a hálózati kommunikáció korlátozására is.</p></dd><dt class=hdlist1><code>stacksize</code></dt><dd><p>Ez a felhasználó által mûködtetett egyes programok vermeinek maximális mérete. Önmagában nem elegendõ a programok által használt memóriamennyiség korlátozására, így emiatt inkább a többi korláttal együtt érdemes alkalmazni.</p></dd></dl></div><div class=paragraph><p>Van néhány tényezõ, amelyekre érdemes odafigyelni az erõforrások korlátainak beállítása során. Most következik pár tipp, javaslat és egyéb megjegyzés a témához.</p></div><div class=ulist><ul><li><p>A rendszerindítás során az <span class=filename>/etc/rc</span> által indított programok a <code>daemon</code> bejelentkezési osztályba tartoznak.</p></li><li><p>Habár a rendszerrel érkezõ <span class=filename>/etc/login.conf</span> állományban remekül be van állítva a legtöbb korlát, de nekünk, mint rendszergazdáknak, kell ismernünk a saját rendszerünk korlátait. Ezen korlátok túlzott tágításával a rendszerünk könnyen leterhelhetõvé válik, míg a túlzott szûkítésével akadályozhatjuk a hatékony használatát.</p></li><li><p>Az X Window System (X11) felhasználóinak a többi felhasználónál valószínûleg jóval több erõforráshoz kell tudniuk hozzáférni. Az X11 már önmagában sok erõforrást eszik, de egyben bátorítja is a felhasználókat több program párhuzamos futtatására.</p></li><li><p>Ne felejtsük el, hogy sok korlát az egyes különállóan futó programokra vonatkozik, nem pedig a felhasználó összes futtatott programjára. Például ha beállítjuk 50-re az <code>openfiles</code> értékét, a felhasználó által elindított programok mindegyike legfeljebb 50 állományt tud majd megnyitni. Emiatt a felhasználó által egyszerre ténylegesen megnyitható állományok száma az <code>openfiles</code> és a <code>maxproc</code> aktuális értékeinek szorzatából adódik. Ugyanez igaz a memóriahasználatra is.</p></li></ul></div><div class=paragraph><p>Az erõforrások korlátozásáról, a bejelentkezési osztályokról és tulajdonságaikról a hozzájuk tartozó man oldalakon olvashatunk: <a href="https://man.freebsd.org/cgi/man.cgi?query=cap.mkdb&amp;sektion=1&amp;format=html">cap.mkdb(1)</a>, <a href="https://man.freebsd.org/cgi/man.cgi?query=getrlimit&amp;sektion=2&amp;format=html">getrlimit(2)</a> és <a href="https://man.freebsd.org/cgi/man.cgi?query=login.conf&amp;sektion=5&amp;format=html">login.conf(5)</a>.</p></div></div><div class=sect2><h3 id=users-groups>13.8. Csoportok<a class=anchor href=#users-groups></a></h3><div class=paragraph><p>Egy csoport nem több felhasználók összességénél. A csoportokat a nevük és az azonosítójuk (Group ID, GID) azonosítja be. A FreeBSD-ben (és a legtöbb UNIX®-szerû rendszerben) a rendszermag két tényezõ alapján dönt arról, mit szabad tennie egy futó programnak: ezek közül az egyik a tulajdonosának azonosítója (UID), a másik azon csoportok listája, melyeknek tagja a tulajdonos. Eltérõen a UID-tõl, egy futó programhoz csoportok listája tartozik. Amikor egy felhasználó vagy egy futó program "csoportazonosítójára" hivatkoznak, általában csak a lista elsõ elemére gondolnak.</p></div><div class=paragraph><p>A csoportok nevei és azonosítói közti megfeleltetéseket az <span class=filename>/etc/group</span> állományban találjuk. Ez lényegében egy szimpla szöveges állomány, négy kettõsponttal elválasztott mezõt tartalmaz. Ezek közül az elsõ a csoport neve, a második a titkosított jelszó, a harmadik a csoport azonosítója, a negyedik pedig a tagok vesszõvel tagolt felsorolása. Akár kézzel is nyugodtan szerkeszthetõ (feltételezve persze, hogy nem vétünk benne szintaktikai hibát!). A szintaxis teljes leírását a <a href="https://man.freebsd.org/cgi/man.cgi?query=group&amp;sektion=5&amp;format=html">group(5)</a> man oldalon találhatjuk meg.</p></div><div class=paragraph><p>Ha nem akarjuk magunk szerkeszteni az <span class=filename>/etc/group</span> állományt, használhatjuk a <a href="https://man.freebsd.org/cgi/man.cgi?query=pw&amp;sektion=8&amp;format=html">pw(8)</a> parancsot is csoportok létrehozására és törlésére. Például hozzuk létre a <code>pg_csoport</code> nevû csoportot és vizsgáljuk meg, valóban létrejött-e:</p></div><div class=exampleblock><div class=title>Példa 16. A csoportok tagjainak beállítása a <a href="https://man.freebsd.org/cgi/man.cgi?query=pw&amp;sektion=8&amp;format=html">pw(8)</a> használatával</div><div class=content><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># pw groupadd pg_csoport</span>
<span class=c># pw groupshow pg_csoport</span>
pg_csoport:<span class=k>*</span>:1100:</code></pre></div></div></div></div><div class=paragraph><p>A fent szereplõ <code>1100</code>-as érték a <code>pg_csoport</code> csoportazonosítója. Ebben a pillanatban a <code>pg_csoport</code>nak még egyetlen tagja sincs, ami miatt lényegében haszontalan. Így hát hívjuk meg a <code>pg_csoport</code>ba a korábban létrehozott <code>jantyik</code> nevû felhasználót.</p></div><div class=exampleblock><div class=title>Példa 17. A csoport tagjainak beállítása a <a href="https://man.freebsd.org/cgi/man.cgi?query=pw&amp;sektion=8&amp;format=html">pw(8)</a> használatával</div><div class=content><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># pw groupmod pg_csoport -M jantyik</span>
<span class=c># pw groupshow pg_csoport</span>
pg_csoport:<span class=k>*</span>:1100:jantyik</code></pre></div></div></div></div><div class=paragraph><p>Az <code>-M</code> kapcsoló paramétere a csoportba sorolandó felhasználók neveinek vesszõkkel tagolt listája. A korábbi szakaszok alapján már tudjuk, hogy a jelszavakat tároló állomány egyben azokat a csoportokat is tartalmazza, ahova az egyes felhasználók tartoznak. Az utóbbiakat (a felhasználókat) automatikusan beleteszi a rendszer a csoportlistába, de az érintett felhasználó nem fog megjelenni tagként a <a href="https://man.freebsd.org/cgi/man.cgi?query=pw&amp;sektion=8&amp;format=html">pw(8)</a> parancs <code>groupshow</code> utasításával, azonban az <a href="https://man.freebsd.org/cgi/man.cgi?query=id&amp;sektion=1&amp;format=html">id(1)</a> és a hozzá hasonló eszközökkel már látható lesz. Más szavakkal élve, a <a href="https://man.freebsd.org/cgi/man.cgi?query=pw&amp;sektion=8&amp;format=html">pw(8)</a> csak az <span class=filename>/etc/group</span> állományt módosítja, és soha nem próbál meg további adatokat kiolvasni az <span class=filename>/etc/passwd</span> állományból.</p></div><div class=exampleblock><div class=title>Példa 18. Egy új tag felvétele a csoportba a <a href="https://man.freebsd.org/cgi/man.cgi?query=pw&amp;sektion=8&amp;format=html">pw(8)</a> használatával</div><div class=content><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># pw groupmod pg_csoport -m kisati</span>
<span class=c># pw groupshow pg_csoport</span>
pg_csoport:<span class=k>*</span>:1100:jantyik,kisati</code></pre></div></div></div></div><div class=paragraph><p>Az <code>-m</code> kapcsoló paramétere azon felhasználók vesszõvel tagolt listája, akiket fel akarunk venni a csoportba. Tehát eltérõen az elõzõ példától, ezeket a felhasználókat felvesszük a csoportba, nem pedig átírjuk velük a csoport jelenlegi tagjainak listáját.</p></div><div class=exampleblock><div class=title>Példa 19. Az <a href="https://man.freebsd.org/cgi/man.cgi?query=id&amp;sektion=1&amp;format=html">id(1)</a> használata a csoporttagság megállapítására</div><div class=content><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>% <span class=nb>id </span>jantyik
<span class=nv>uid</span><span class=o>=</span>1001<span class=o>(</span>jantyik<span class=o>)</span> <span class=nv>gid</span><span class=o>=</span>1001<span class=o>(</span>jantyik<span class=o>)</span> <span class=nb>groups</span><span class=o>=</span>1001<span class=o>(</span>jantyik<span class=o>)</span>, 1100<span class=o>(</span>pg_csoport<span class=o>)</span></code></pre></div></div></div></div><div class=paragraph><p>Ahogy láthatjuk is, a <code>jantyik</code> nevû felhasználó tagja a <code>jantyik</code> nevû csoportnak és a <code>pg_csoport</code>nak is.</p></div><div class=paragraph><p>A <a href="https://man.freebsd.org/cgi/man.cgi?query=pw&amp;sektion=8&amp;format=html">pw(8)</a> mûködésérõl a saját man oldalán, az <span class=filename>/etc/group</span> formátumáról pedig a <a href="https://man.freebsd.org/cgi/man.cgi?query=group&amp;sektion=5&amp;format=html">group(5)</a> man oldalon találhatunk több információt.</p></div></div></div></div><div class=sect1><h2 id=security>Chapter 14. Biztonság<a class=anchor href=#security></a></h2><div class=sectionbody><div class=sect2><h3 id=security-synopsis>14.1. Áttekintés<a class=anchor href=#security-synopsis></a></h3><div class=paragraph><p>Ez a fejezet egy alapvetõ bevezetés a rendszerek biztonsági fogalmaiba, ad néhány általános jótanácsot és a FreeBSD-vel kapcsolatban feldolgoz néhány komolyabb témát. Az itt megfogalmazott témák nagy része egyaránt ráhúzható rendszerünk és általánosságban véve az internet biztonságára is. A internet már nem az "békés" hely, ahol mindenki a kedves szomszéd szerepét játssza. A rendszerünk bebiztosítása elkerülhetetlen az adataink, szellemi tulajdonunk, idõnk és még sok minden más megvédésére az internetes banditák és hasonlók ellen.</p></div><div class=paragraph><p>A FreeBSD segédprogramok és mechanizmusok sorát kínálja fel a rendszerünk és hálózatunk sértetlenségének és biztonságának fenntartására.</p></div><div class=paragraph><p>A fejezet elolvasása során megismerjük:</p></div><div class=ulist><ul><li><p>az alapvetõ rendszerbiztonsági fogalmakat, különös tekintettel a FreeBSD-re;</p></li><li><p>milyen olyan különbözõ titkosítási mechanizmusok érthetõek el a FreeBSD-ben, mint például a DES és az MD5;</p></li><li><p>hogyan állítsunk be egyszeri jelszavas azonosítást;</p></li><li><p>hogyan burkoljunk az inetd segítségével TCP kapcsolatokat;</p></li><li><p>hogyan állítsuk be a KerberosIV-t a FreeBSD 5.0-nál korábbi változatain;</p></li><li><p>hogyan állítsuk be a Kerberos5-t a FreeBSD-n;</p></li><li><p>hogyan állítsuk be az IPsec-et és hozzunk létre VPN-t FreeBSD/Windows® gépek között;</p></li><li><p>hogyan állítsuk be és használjuk az OpenSSH-t, a FreeBSD SSH implementációját;</p></li><li><p>mik azok az ACL-ek az állományrendszerben és miként kell ezeket használni;</p></li><li><p>hogyan kell használni a Portaudit segédprogramot a Portgyûjteménybõl telepített külsõ szoftvercsomagok biztonságosságának ellenõrzésére;</p></li><li><p>hogyan hasznosítsuk a FreeBSD biztonsági tanácsait tartalmazó leírásokat</p></li><li><p>mit jelent a futó programok nyilvántartása és hogyan engedélyezzük azt FreeBSD-n.</p></li></ul></div><div class=paragraph><p>A fejezet elolvasásához ajánlott:</p></div><div class=ulist><ul><li><p>az alapvetõ FreeBSD és internetes fogalmak ismerete.</p></li></ul></div><div class=paragraph><p>A könyvben további biztonsági témákról is szó esik, például a <a href=./#mac>Kötelező hozzáférés-vezérlés (MAC)</a>ben a Kötelezõ hozzáférés-vezérlésrõl (MAC) és a <a href=./#firewalls>Tűzfalak</a>ben pedig az internetes tûzfalakról.</p></div></div><div class=sect2><h3 id=security-intro>14.2. Bevezetés<a class=anchor href=#security-intro></a></h3><div class=paragraph><p>A biztonság egy olyan funkció, ami a rendszergazdától indul és nála is végzõdik. Míg az összes többfelhasználós BSD UNIX® rendszer önmagában is valamennyire biztonságos, a felhasználók "fegyelmezéséhez" szükség további biztonsági mechanizmusok kiépítésére és karbantartására, ami minden bizonnyal egy rendszergazda egyik legfontosabb kötelessége. A számítógépek csak annyira biztonságosak, mint amennyire beállítjuk, és a biztonsági megfontolások állandó versenyben vannak az emberi kényelemmel. A UNIX® rendszerek általánosságban véve órási mennyiségû program párhuzamos futtatására képesek, melyek többsége kiszolgálóként fut - ez azt jelenti, hogy hozzájuk kívülrõl érkezõ egyedek csatlakozhatnak és társaloghatnak velük. Ahogy a tegnap kicsi és nagy számítógépei napjaink asztali gépeivé váltak és ahogy a számítógépek egyre többen csatlakoznak hálózatra és az internetre, a biztonság fontossága is egyre jobban növekszik.</p></div><div class=paragraph><p>A rendszerek biztonsága a támadások különbözõ formáival is foglalkozik, többek közt olyan támadásokkal, amelyek a rendszer összeomlását vagy használhatatlanságát célozzák meg, de nem próbálják meg veszélybe sodorni a <code>root</code> felhasználó hozzáférését ("feltörni a gépet"). A biztonsággal kapcsolatos problémák több kategóriára oszthatóak:</p></div><div class="olist arabic"><ol class=arabic><li><p>A szolgáltatások mûködésképtelenné tételére irányuló (DoS, Denial of Service) támadások.</p></li><li><p>A felhasználói fiókok veszélyeztetése.</p></li><li><p>Rendszergazdai jogok megszerzése a közeli szervereken keresztül.</p></li><li><p>Rendszergazdai jogok megszerzése a felhasználói fiókokon keresztül.</p></li><li><p>Kiskapuk létrehozása a rendszerben.</p></li></ol></div><div class=paragraph><p>A szolgáltatások mûködésképtelenné tételére irányuló támadások olyan tevékenységre utalnak, amelyek képesek megfosztani egy számítógépet az erõforrásaitól. A DoS támadások többnyire nyers erõvel kivitelezett technikák, melyek vagy a rendszer összeomlasztását vagy pedig a használhatatlanná tételét veszik célba úgy, hogy túlterhelik az általa felkínált szolgáltatásokat vagy a hálózati alrendszert. Egyes DoS támadások a hálózati alrendszerben rejtõzõ hibákat igyekeznek kihasználni, amivel akár egyetlen csomaggal is képesek romba dönteni egy számítógépet. Ez utóbbit csak úgy lehet orvosolni, ha a hibát kijavítjuk a rendszermagban. A szerverekre mért csapásokat gyakran ki lehet védeni a paramétereik ügyes beállításával, melyek segítségével korlátozni tudjuk az ezeket ért terhelést egy kellemetlenebb helyezetben. A nyers erõt alkalmazó hálózati támadásokkal a legnehezebb szembenézni. Például az álcázott támadadások, melyeket szinte lehetetlen megállítani, remek eszközök arra, hogy elvágják gépünket az internettõl. Ezzel viszont nem csak azt iktatják ki, hanem az internet-csatlakozásunkat is eldugítják.</p></div><div class=paragraph><p>A DoS támadásoknál még gyakrabban elõfordul, hogy feltörik a felhasználók fiókjait. A rendszergazdák többsége még mindig futtat telnetd, rlogin, rshd és ftpd szervereket a gépen. Ezek a szerverek alapértelmezés szerint nem titkosított kapcsolaton keresztül mûködnek. Ebbõl következik, hogy ha nincs annyira sok felhasználónk és közülük néhányan távoli helyekrõl jelentkeznek be (ami az egyik leggyakoribb és legkényelmesebb módja ennek), akkor elõfordulhat, hogy valami megneszeli a jelszavaikat. A körültekintõ rendszergazdák mindig ellenõrzik a bejelentkezéseket tartalmazó naplókat és igyekeznek kiszûrni a gyanús címeket még abban az esetben is, amikor a bejelentkezés sikeres volt.</p></div><div class=paragraph><p>Mindig arra kell gondolni, hogy ha a támadónak sikerült megszerezni az egyik felhasználó hozzáférését, akkor akár képes lehet a <code>root</code> felhasználó fiókjának feltörésére is. Azonban a valóságban egy jól õrzött és karbantarott rendszer esetén a felhasználói hozzáférések megszerzése nem feltétlenül adja a támadó kezére a <code>root</code> hozzáférését. Ebben fontos különbséget tenni, hiszen a <code>root</code> felhasználó jogai nélkül a támadó nem képes elrejteni a nyomait és legjobb esetben sem tud többet tenni, mint tönkretenni az adott felhasználó állományait vagy összeomlasztani a rendszert. A felhasználói fiókok feltörése nagyon gyakran megtörténik, mivel a felhasználók messze nem annyira elõvigyázatosak, mint egy rendszergazda.</p></div><div class=paragraph><p>A rendszergazdáknak mindig észben kell tartani, hogy egy számítógépen több módon is meg lehet szerezni a <code>root</code> felhasználó hozzáférését. A támadó megtudhatja a <code>root</code> jelszavát, hibát fedezhet fel az egyik rendszergazdai jogosultsággal futó szerverben és képes feltörni a <code>root</code> hozzáférést egy hálózati kapcsolaton keresztül, vagy a támadó olyan programban talál hibát, aminek segítségével el tudja érni a <code>root</code> fiókját egy felhasználói hozzáférésen keresztül. Miután a támadó megtalálta a rendszergazdai jogok megszerzésének módját, nem feltétlenül kell kiskapukat elhelyeznie a rendszerben. Az eddig talált és javított, rendszergazdai jogok megszerzését lehetõvé tevõ biztonsági rések egy része esetében viszont a támadónak akkora mennyiségû munkát jelentene eltûntetni maga után a nyomokat, hogy megéri neki egy kiskaput telepíteni. Ennek segítségével a támadó ismét könnyedén hozzájuthat a <code>root</code> felhasználó hozzáféréséhez a rendszerben, de ezen keresztül egy okos rendszergazda képes is a behatolót leleplezni. A kiskapuk lerakásának megakadályozása valójában káros a biztonság szempontjából nézve, mert ezzel nem szüntetjük meg azokat a lyukakat, amin keresztül a támadó elõször bejutott.</p></div><div class=paragraph><p>A támadások elleni védelmet mindig több vonalban kell megvalósítani, melyeket így oszthatunk fel:</p></div><div class="olist arabic"><ol class=arabic><li><p>A rendszergazda és a személyzet hozzáférésének védelme.</p></li><li><p>A rendszergazdai jogokkal futó szerverek és a suid/sgid engedélyekkel rendelkezõ programok védelme.</p></li><li><p>A felhasználói hozzáférések védelme.</p></li><li><p>A jelszavakat tároló állomány védelme.</p></li><li><p>A rendszermag belsejének, a nyers eszközök és az állományrendszerek védelme.</p></li><li><p>A rendszert ért szabálytalan módosítások gyors észlelése.</p></li><li><p>Állandó paranoia.</p></li></ol></div><div class=paragraph><p>A fejezet most következõ szakaszában az imént felsorolt elemeket fejtjük ki részletesebben.</p></div></div><div class=sect2><h3 id=securing-freebsd>14.3. A FreeBSD védelme<a class=anchor href=#securing-freebsd></a></h3><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=title>Parancs kontra protokoll</div><div class=paragraph><p>A dokumentumban a félkövéren fogjuk szedni az alkalmazásokat, és <code>egyenszélességû</code> betûkkel pedig az adott parancsokra hivatkozunk. A protokollokat nem különböztetjük meg. Ez a tipográfiai elkülönítés hasznos például az ssh egyes vonatkozásainak esetén, mivel ez egyben egy protokoll és egy parancs is.</p></div></td></tr></tbody></table></div><div class=paragraph><p>A most következõ szakaszok a FreeBSD védelmének azon módszereit ismertetik, amelyekrõl a fejezet <a href=#security-intro>elõzõ szakaszában</a> már írtunk.</p></div><div class=sect3><h4 id=securing-root-and-staff>14.3.1. A rendszergazda és a személyzet hozzáférésének védelme<a class=anchor href=#securing-root-and-staff></a></h4><div class=paragraph><p>Elõször is: ne törjük magunkat a személyzeti fiókok biztonságossá tételével, ha még a rendszergazda hozzáférését sem tettük eléggé biztonságossá. A legtöbb rendszerben a <code>root</code> hozzáféréshez tartozik egy jelszó. Elsõként fel kell tennünk, hogy ez a jelszó <em>mindig</em> megszerezhetõ. Ez természetesen nem arra utal, hogy el kellene távolítanunk. A jelszó szinte mindig szükséges a számítógép konzolon keresztüli eléréséhez. Valójában arra szeretnénk rávilágítani, hogy a konzolon kívül sehol máshol ne lehessen használni ezt a jelszót, még a <a href="https://man.freebsd.org/cgi/man.cgi?query=su&amp;sektion=1&amp;format=html">su(1)</a> paranccsal sem. Például gondoskodjunk róla, hogy az <span class=filename>/etc/ttys</span> állományban megadott pszeudó terminálokat "insecure" (nem biztonságos) típusúnak állítottuk be, és így a <code>telnet</code> vagy az <code>rlogin</code> parancsokon keresztül nem lehet rendszergazdaként bejelentkezni. Ha más szolgáltatáson keresztül jelentkezünk be, például az sshd segítségével, akkor ebben az esetben is gondoskodjunk róla, hogy letiltottuk a közvetlen rendszergazdai bejelentkezés lehetõségét. Ezt úgy tudjuk megtenni, ha megnyitjuk az <span class=filename>/etc/ssh/sshd_config</span> állományt és a <code>PermitRootLogin</code> paramétert átállítjuk a <code>no</code> értékre. Vegyünk számba minden lehetséges hozzáférési módot - az FTP és a hozzá hasonló módok gyakran átszivárognak a repedéseken. A rendszergazdának csak a rendszerkonzolon keresztül szabad tudnia bejelentkeznie.</p></div><div class=paragraph><p>Természetesen egy rendszergazdának valahogy el kell érnie a <code>root</code> hozzáférést, ezért ezzel felnyitunk néhány biztonsági rést. De gondoskodjunk róla, hogy ezek a rések további jelszavakat igényelnek a mûködésükhöz. A <code>root</code> hozzáférés eléréséhez érdemes felvenni tetszõleges személyzeti (staff) hozzáféréseket a <code>wheel</code> csoportba (az <span class=filename>/etc/group</span> állományban). Ha a személyzet tagjait a <code>wheel</code> csoportba rakjuk, akkor innen a <code>su</code> paranccsal fel tudjuk venni a <code>root</code> felhasználó jogait. A személyzet tagjait létrehozásukkor közvetlenül sose vegyük fel a <code>wheel</code> csoportba! A személyzet tagjai elõször kerüljenek egy <code>staff</code> csoportba, és majd csak ezután az <span class=filename>/etc/group</span> állományon keresztül a <code>wheel</code> csoportba. A személyzetnek csak azon tagjait tegyük ténylegesen a <code>wheel</code> csoportba, akiknek valóban szükségük van a <code>root</code> felhasználó hozzáférésére. Ha például a Kerberost használjuk hitelesítésre, akkor megcsinálhatjuk azt is, hogy a Kerberos <span class=filename>.k5login</span> állományában engedélyezzük a <a href="https://man.freebsd.org/cgi/man.cgi?query=ksu&amp;sektion=1&amp;format=html">ksu(1)</a> parancson keresztül a <code>root</code> hozzáférés elérését a <code>wheel</code> csoport alkalmazása nélkül. Ez a megoldás talán még jobb is, mivel a <code>wheel</code> használata esetén a behatolónak még mindig lehetõsége van hozzájutni a <code>root</code> hozzáféréséhez olyankor, amikor a kezében van a jelszavakat tároló állomány és meg tudja szerezni a személyzet valamelyik tagjának hozzáférését. A <code>wheel</code> csoport által felkínált megoldás ugyan jobb, mint a semmi, de kétségtelenül nem a legbiztonságosabb.</p></div><div class=paragraph><p>A hozzáférések teljes körû letiltásához a <a href="https://man.freebsd.org/cgi/man.cgi?query=pw&amp;sektion=8&amp;format=html">pw(8)</a> parancsot érdemes használni:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># pw lock személyzet</span></code></pre></div></div><div class=paragraph><p>Ezzel meg tudjuk akadályozni, hogy a felhasználó akármilyen módon, beleértve az <a href="https://man.freebsd.org/cgi/man.cgi?query=ssh&amp;sektion=1&amp;format=html">ssh(1)</a> használatát is, hozzá tudjon férni a rendszerünkhöz.</p></div><div class=paragraph><p>A hozzáférések blokkolásának másik ilyen módszere a titkosított jelszó átírása egyetlen “*” karakterre. Mivel ez a karakter egyetlen titkosított jelszóra sem illeszkedik, ezért a felhasználó nem lesz képes bejelentkezni. Ahogy például a személyzet alábbi tagja sem:</p></div><div class="literalblock programlisting"><div class=content><pre>izemize:R9DT/Fa1/LV9U:1000:1000::0:0:Ize-Mize:/home/izemize:/usr/local/bin/tcsh</pre></div></div><div class=paragraph><p>Erre cseréljük ki:</p></div><div class="literalblock programlisting"><div class=content><pre>izemize:*:1000:1000::0:0:Ize-Mize:/home/izemize:/usr/local/bin/tcsh</pre></div></div><div class=paragraph><p>Ezzel megakadályozzuk, hogy az <code>izemize</code> nevû felhasználó a hagyományos módszerekkel be tudjon jelentkezni. Ez a megoldás azonban a Kerberost alkalmazó rendszerek esetén nem mûködik, illetve olyan helyezetekben sem, amikor a felhasználó az <a href="https://man.freebsd.org/cgi/man.cgi?query=ssh&amp;sektion=1&amp;format=html">ssh(1)</a> paranccsal már létrehozott magának kulcsokat.</p></div><div class=paragraph><p>Az ilyen védelmi mechanizmusok esetében mindig egy szigorúbb biztonsági szintû géprõl jelentkezünk be egy kevésbé biztonságosabb gépre. Például, ha a szerverünk mindenféle szolgáltatásokat futtat, akkor a munkaállomásunknak egyetlen egyet sem lenne szabad. A munkaállomásunk biztonságossá tételéhez a lehetõ legkevesebb szolgáltatást szabad csak futtatnunk, de ha lehet, egyet sem, és mindig jelszóval védett képernyõvédõt használjuk. Természetesen ha a támadó képes fizikailag hozzáférni a munkaállomásunkhoz, akkor szinte bármilyen mélységû védelmet képes áttörni. Ezt mindenképpen számításba kell vennünk, azonban ne felejtsük el, hogy a legtöbb betörési kísérlet távolról, hálózaton keresztülrõl érkezik olyan emberektõl, akik fizikailag nem férnek hozzá a munkaállomásunkhoz vagy a szervereinkhez.</p></div><div class=paragraph><p>A Kerberos és a hozzá hasonló rendszerek használatával egyszerre tudjuk a személyzet tagjainak jelszavát letiltani vagy megváltoztatni, ami egybõl érvényessé válik minden olyan gépen, ahová az adott felhasználónak bármilyen hozzáférése is volt. Nem szabad lebecsülnünk ezt a gyors jelszóváltási lehetõséget abban az esetben, ha a személyzet valamelyik tagjának hozzáférését megszerezték. Hagyományos jelszavak használatával a jelszavak megváltoztatása N gépen igazi káosz. A Kerberosban jelszóváltási megszorításokat is felállíthatunk: nem csak a Kerberos által adott jegyek járnak le idõvel, hanem a Kerberos rendszer meg is követelheti a felhasználóktól, hogy egy adott idõ (például egy hónap) után változtasson jelszót.</p></div></div><div class=sect3><h4 id=_a_rendszergazdai_jogokkal_futó_szerverek_és_suidsgid_engedélyekkel_rendelkezõ_programok_védelme>14.3.2. A rendszergazdai jogokkal futó szerverek és SUID/SGID engedélyekkel rendelkezõ programok védelme<a class=anchor href=#_a_rendszergazdai_jogokkal_futó_szerverek_és_suidsgid_engedélyekkel_rendelkezõ_programok_védelme></a></h4><div class=paragraph><p>A bölcs rendszergazda mindig csak akkor futtat szervereket, amikor szüksége van rá, se többet, se kevesebbet. Az egyéb fejlesztõktõl származó szerverekkel bánjunk különösen óvatosan, mivel gyakran hajlamosak hibákat tartalmazni. Például az imapd vagy a popper használata olyan, mintha az egész világnak ingyenjegyet osztogatnánk a rendszerünk <code>root</code> hozzáféréséhez. Soha ne futtassunk olyan szervert, amelyet nem vizsgáltunk át kellõ alapossággal. Sok szervert nem is feltétlenül kell <code>root</code> felhasználóként futtatni. Például az ntalk, comsat és finger démonok egy speciális <em>járókában</em> (sandbox) futnak. Ezek a járókák sem teljesen tökéletesek, hacsak erre külön figyelmet nem fordítunk. Ilyenkor a többvonalas védelem eszménye még mindig él: ha valakinek sikerült betörnie a járókába, akkor onnan ki is tud törni. Minél több védelmi vonalat húzunk a támadó elé, annál jobban csökken a sikerének valószínûsége. A történelem során lényegében minden <code>root</code> jogokkal futó szerverben, beleértve az alapvetõ rendszerszintû szervereket is, találtak már biztonsági jellegû hibát. Ha a gépünkre csak az sshd szolgáltatáson keresztül tudnak belépni, és soha nem használja senki a telnetd, rshd vagy rlogind szolgáltatásokat, akkor kapcsoljuk is ki ezeket!</p></div><div class=paragraph><p>A FreeBSD most már alapértelmezés szerint járókában futtatja az ntalkd, comsat és finger szolgáltatásokat. Másik ilyen program, amely szintén esélyes lehet erre, az a <a href="https://man.freebsd.org/cgi/man.cgi?query=named&amp;sektion=8&amp;format=html">named(8)</a>. Az <span class=filename>/etc/defaults/rc.conf</span> megjegyzésben tartalmazza a named járókában futtatásához szükséges paramétereket. Attól függõen, hogy egy új rendszert telepítünk vagy frissítjük a már meglévõ rendszerünket, a járókákhoz tartozó speciális felhasználói hozzáférések nem feltétlenül jönnek létre. Amikor csak lehetséges, az elõrelátó rendszergazda kikísérletez és létrehoz ilyen járókákat.</p></div><div class=paragraph><p>Vannak más olyan szerverek, amelyek tipikusan nem járókákban futnak. Ilyen többek közt a sendmail, popper, imapd, ftpd és még sokan mások. Léteznek rájuk alternatívák, de a telepítésük valószínûleg több munkát igényel, mint amennyit megérné számunkra veszõdni velük (és itt megint lesújt a kényelmi tényezõ). Ezeket a szervereket többnyire <code>root</code> felhasználóként kell futtatnunk és a rajtuk keresztül érkezõ betörési kísérleteket más módokra támaszkodva kell észlelnünk.</p></div><div class=paragraph><p>A <code>root</code> felhasználó keltette biztonsági rések másik nagy csoportja azok a végrehajtható állományok a rendszerben, amelyek a suid és sgid engedélyekkel rendelkeznek, futtatásuk rendszergazdai jogokkal történik. Az ilyen binárisok többsége, mint például az rlogin, a <span class=filename>/bin</span> és <span class=filename>/sbin</span>, <span class=filename>/usr/bin</span> vagy <span class=filename>/usr/sbin</span> könyvtárakban található meg. Habár semmi sem biztonságos 100%-ig, a rendszerben alapértelmezetten suid és sgid engedéllyel rendelkezõ binárisok ebbõl a szempontból meglehetõsen megbízhatónak tekinhetõek. Alkalmanként azonban találnak a <code>root</code> felhasználót veszélyeztetõ lyukakat az ilyen binárisokban is. Például 1998-ban az <code>Xlib</code>-ben volt egy olyan rendszergazdai szintû hiba, amellyel az xterm (ez általában suid engedéllyel rendelkezik) sebezhetõvé vált. Mivel jobb félni, mint megijedni, ezért az elõretekintõ rendszergazda mindig igyekszik úgy csökkenteni az ilyen engedélyekkel rendelkezõ binárisok körét, hogy csak a személyzet tagjai legyenek képesek ezeket futtatni. Ezt egy olyan speciális csoport létrehozásával oldhatjuk meg, amelyhez csak a személyzet tagjai férhetnek hozzá. Az olyan suid binárisoktól pedig, amelyeket senki sem használ, igyekszik teljesen megszabadulni (<code>chmod 000</code>). A monitorral nem rendelkezõ szervereknek általában nincs szükségük az xterm mûködtetésére. Az sgid engedéllyel rendelkezõ binárisok is legalább ugyanennyire veszélyesek. Ha a behatoló képes feltörni egy <code>kmem</code> csoporthoz tartozó sgid binárist, akkor képes lesz olvasni a <span class=filename>/dev/kmem</span> állomány tartalmát, ezáltal hozzájut a titkosított jelszavakhoz és így megszerezheti magának akármelyik hozzáférést. Sõt, a <code>kmem</code> csoportot megszerzõ behatolók figyelni tudják a pszeudó terminálokon keresztül érkezõ billentyûleütéseket, még abban az esetben is, amikor a felhasználók egyébként biztonságos módszereket használnak. A <code>tty</code> csoportot bezsebelõ támadók szinte bármelyik felhasználó termináljára képesek írni. Ha a felhasználó valamilyen terminál programot vagy terminál emulátort használ a billentyûzet szimulációjával, akkor a behatoló tud olyan adatokat generálni, amivel a felhasználó nevében adhat ki parancsokat.</p></div></div><div class=sect3><h4 id=secure-users>14.3.3. A felhasználói hozzáférések védelme<a class=anchor href=#secure-users></a></h4><div class=paragraph><p>A felhasználók hozzáféréseit szinte a legnehezebb megvédeni. Míg a személyzet tagjaival szemben lehetünk kíméletlenül szigorúak és "ki is csillagozhatjuk" a jelszavukat, addig a felhasználók hozzáféréseivel általánosságban véve ezt nem tehetjük meg. Ha a kezünkben van a megfelelõ mértékû irányítás, akkor még gyõzhetünk és kényelmesen biztonságba helyezethetjük a felhasználók hozzáférését. Ha nincs, akkor nem tehetünk mást, mint állandóan õrködünk a hozzáférések felett. Az ssh és Kerberos használata a felhasználók esetén sokkalta problematikusabb, mivel ilyenkor jóval több adminisztrációra és mûszaki segítségnyújtásra van szükség, de még mindig jobb megoldás a titkosított jelszavakhoz képest.</p></div></div><div class=sect3><h4 id=_a_jelszavakat_tároló_állomány_védelme>14.3.4. A jelszavakat tároló állomány védelme<a class=anchor href=#_a_jelszavakat_tároló_állomány_védelme></a></h4><div class=paragraph><p>Az a legbiztosabb, ha minél több jelszót kicsillagozunk és a hozzáférések hitelesítésére ssh-t vagy Kerberost használunk. Igaz, a titkosított jelszavakat tároló állományt (<span class=filename>/etc/spwd.db</span>) csak a <code>root</code> képes olvasni, de a támadó meg tudja szerezni ezt a jogot még olyankor is, ha <code>root</code> felhasználóként nem feltétlenül tud írni.</p></div><div class=paragraph><p>A rendszerünkben futó biztonsági szkripteknek a jelszavakat tároló állomány változását folyamatosan tudnia kell figyelnie és jelentie (lásd lentebb a <a href=#security-integrity>Az állományok sértetlenségének ellenõrzése</a> címû fejezetet).</p></div></div><div class=sect3><h4 id=_a_rendszermag_belsejének_a_nyers_eszközök_és_az_állományrendszerek_védelme>14.3.5. A rendszermag belsejének, a nyers eszközök és az állományrendszerek védelme<a class=anchor href=#_a_rendszermag_belsejének_a_nyers_eszközök_és_az_állományrendszerek_védelme></a></h4><div class=paragraph><p>Ha a támadó megszerzi a <code>root</code> hozzáférését, akkor szinte bármit képes megtenni, de vannak bizonyos elõnyei. Például a mostanság fejlesztett legtöbb rendszermag tartalmaz valamilyen beépített csomaglehallgatót, amit FreeBSD alatt a <span class=filename>bpf</span> eszköz valósít meg. A támadók szinte mindig megpróbálnak valamilyen csomaglehallgatót használni a feltört gépen. A legtöbb rendszeren azonban nem kell feltétlenül megadnunk ezt az örömet, ezért nem is kell beépítenünk a rendszermagba a <span class=filename>bpf</span> eszközt.</p></div><div class=paragraph><p>De ha még ki is iktatjuk a <span class=filename>bpf</span> eszközt, még aggódhatunk a <span class=filename>/dev/mem</span> és <span class=filename>/dev/kmem</span> miatt. Egyébként ami azt illeti, a behatoló még így is képes írni a nyers eszközökre. Sõt, a rendszermagba képesek vagyunk modulokat is betölteni a <a href="https://man.freebsd.org/cgi/man.cgi?query=kldload&amp;sektion=8&amp;format=html">kldload(8)</a> használatával. A vállalkozó kedvû támadó a rendszermag moduljaként képes telepíteni és használni a saját <span class=filename>bpf</span> eszközét vagy bármilyen más, a csomagok lehallgatására alkalmas eszközt. Az ilyen problémák elkerülése érdekében a rendszermagot a legmagasabb védelmi szinten kell üzemeltetni, tehát legalább egyes szinten.</p></div><div class=paragraph><p>A rendszermag védelmi szintjét több különbözõ módon lehet állítani. A védelmi szintet úgy lehet a legegyszerûbben növelni, ha a <code>sysctl</code> paranccsal beállítjuk a <code>kern.securelevel</code> nevû, rendszerszintû változó értékét:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># sysctl kern.securelevel=1</span></code></pre></div></div><div class=paragraph><p>A FreeBSD rendszermag alapértelmezés szerint a <code>-1</code> védelmi szinten indul. Ez egészen addig <code>-1</code> marad, amíg a rendszergazda vagy valamelyik <a href="https://man.freebsd.org/cgi/man.cgi?query=init&amp;sektion=8&amp;format=html">init(8)</a> során hívott rendszerindító szkript ezt meg nem változtatja. A rendszer indítása során úgy tudjuk beállítani a megfelelõ védelmi szintet, ha az <span class=filename>/etc/rc.conf</span> állományban megadjuk a <code>kern_securelevel_enable</code> változót a <code>YES</code> értékkel, illetve <code>kern_securelevel</code> értékeként a kívánt védelmi szintet.</p></div><div class=paragraph><p>A FreeBSD alapértelmezett védelmi szintje közvetlenül a rendszerindító szkriptek lefutása után <code>-1</code>. Ezt "nem biztonságos módnak" nevezik, mivel az állományok írásáért felelõs állományjelzõk nem feltétlenül mûködnek, mindegyik eszköz írható, olvasható és a többi.</p></div><div class=paragraph><p>Miután a védelmi szintet <code>1</code> vagy annál magasabb értékre állítottuk, akkor a rendszer figyelembe veszi a csak hozzáfûzést (append-only) és módosíthatatlanságot (immutable) megszorító állományjelzõket, nem engedélyezi a tiltásukat és az eszközök közvetlenül nem érhetõek el. A különbözõ védelmi szintek részletesebb bemutatását a <a href="https://man.freebsd.org/cgi/man.cgi?query=security&amp;sektion=7&amp;format=html">security(7)</a> man oldalon olvashatjuk (vagy a FreeBSD 7.0 elõtti változataiban a <a href="https://man.freebsd.org/cgi/man.cgi?query=init&amp;sektion=8&amp;format=html">init(8)</a> man oldalon).</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Az <code>1</code> és az afeletti védelmi szinteken többek közt az X11 nem feltétlenül lesz futtatható (mivel a <span class=filename>/dev/io</span> eszköz elérése blokkolt), illetve a rendszer frissítése is akadályokba fog ütközni (a <code>installworld</code> futtatása során ideiglenesen ki kell kapcsolni az append-only és immutable állományjelzõket). Az X11 esetében ezt valahogy még ki lehet kerülni úgy, hogy ha az <a href="https://man.freebsd.org/cgi/man.cgi?query=xdm&amp;sektion=1&amp;format=html">xdm(1)</a> démont még a rendszerindítás elején aktiváljuk (amikor a védelmi szint még kellõen alacsony). Az összes védelmi szint és megszorítás esetén azonban nem mindig adható ilyen jellegû javaslat, ezért ilyenkor mindig érdemes elõre tervezni egy keveset. Emellett fontos alaposan megismerni a különbözõ védelmi megszorításokat, mivel jelentõs mértékben visszafoghatják a rendszer használhatóságát. Ez segít az adott helyzetben az egyszerûbb megoldást választani és ezáltal elkerülni a kellemetlen meglepetéseket.</p></div></td></tr></tbody></table></div><div class=paragraph><p>Ha a rendszermag védelmi szintjét az <code>1</code> érték vagy afelé emeljük, akkor hasznos lehet a fontosabb (lényegében minden olyan programnak, amely a védelmi szint helyes beállítódása elõtt lefut) programoknak, könyvtáraknak és szkripteknek beállítani az <code>schg</code> állományjelzõt. Ilyenkor azonban vegyük figyelembe, hogy a rendszer frissítése is nehezebbé válik a magasabb védelmi szinteken. Egy mûködõképesebb megoldás lehet, ha rendszerünket egy magasabb védelmi szinten használjuk, de nem állítjuk be mindegyik rendszerszintû állományra az <code>schg</code> állományjelzõt. Másik lehetõség még a <span class=filename>/</span> és <span class=filename>/usr</span> partíciók írásvédett csatlakoztatása. Ne felejtsük el azonban, hogy ha túlságosan szigorúak vagyunk magunkhoz, akkor azzal egyúttal a behatolás észlelését is meg tudjuk nehezíteni!</p></div></div><div class=sect3><h4 id=security-integrity>14.3.6. Az állományok sértetlenségének ellenõrzése: binárisok, konfigurációs állományok stb.<a class=anchor href=#security-integrity></a></h4><div class=paragraph><p>Ha arról van szó, csak a legfontosabb rendszerszintû konfigurációs- és vezérlõállományokat tudjuk megvédeni, még mielõtt a korábban emlegetett kényelmi tényezõ kimutatná a foga fehérjét. Például, ha a <code>chflags</code> paranccsal beállítjuk az <code>schg</code> állományjelzõt a <span class=filename>/</span> és <span class=filename>/usr</span> állományrendszereken található legtöbb állományra, akkor az minden bizonnyal csökkenti a hatékonyságunkat, hiszen az állományok védelmének növekedésével csökken az észlelés lehetõsége. A védelmi vonalaink közül ugyanis az utolsó talán az egyik legfontosabb - a detektálás. A felépített biztonsági rendszerünk legnagyobb része szinte teljesen hasztalan (vagy ami még rosszabb, a biztonság hamis érzetét kelti), ha nem vagyunk képesek észrevenni a betörési kísérleteket. A védelmi rendszer egyik részére nem a támadó megállításához, hanem a lelassításához van szükség, hogy így majd munka közben érhessük tetten.</p></div><div class=paragraph><p>A betörés tényét legjobban a megváltozott, hiányzó vagy éppen váratlanul felbukkanó állományok utáni kutatással tudjuk felismerni. A módosított állományokat általában egy másik (gyakran központosított) korlátozott hozzáférésû rendszerbõl ellenõrizhetjük a legjobban. Fontos, hogy ha egy korlátozott hozzáférésû, kiemelten védett rendszeren írjuk a védelemért felelõs szkripteket, akkor azok szinte teljesen láthatlanok lesznek a támadó számára. A legjobb kihasználás érdekében a korlátozott hozzáférésû gépnek jelentõs mértékû rálátással kell rendelkeznie az összes többi gépre, amit írásvédett NFS exportok vagy ssh kulcspárok felhasználásával érhetünk el. A hálózati forgalmat leszámítva az NFS látszik a legkevésbé - segítségével lényegében észrevétlenül tudjuk figyelni az egyes gépek állományrendszereit. Ha a megfigyelésre használt szerver a kliensekhez switchen keresztül csatlakozik, akkor az NFS gyakran jobb választásnak bizonyul. Ha a szerver hubon vagy több hálózati elemen keresztül éri el a megfigyelni kívánt klienseket, akkor az NFS nem eléggé biztonságos (és hatékony), ezért ilyen esetekben az ssh választása lehet a kedvezõ még az ssh által hagyott nyomokkal együtt is.</p></div><div class=paragraph><p>Miután a korlátozott hozzáférésû gépünk legalább látja a hozzá tartozó kliensek rendszereit, el kell készítenünk a tényleges monitorozást végzõ szkripteket. Ha NFS csatlakozást tételezünk fel, akkor az olyan egyszerû rendszereszközökkel, mint például a <a href="https://man.freebsd.org/cgi/man.cgi?query=find&amp;sektion=1&amp;format=html">find(1)</a> és <a href="https://man.freebsd.org/cgi/man.cgi?query=md5&amp;sektion=1&amp;format=html">md5(1)</a> képesek vagyunk összerakni ezeket. A szemmel tartott kliensek állományait naponta legalább egyszer érdemes ellenõrizni md5-tel, valamint még ennél gyakrabban is tesztelni az <span class=filename>/etc</span> és <span class=filename>/usr/local/etc</span> könyvtárakban található konfigurációs és vezérlõállományokat. Ha valamilyen eltérést tapasztal az ellenõrzést végzõ szerverünk és a rajta levõ md5 információk is helyesek, akkor értesítenie kell a rendszergazdát. Egy jó védelmi szkript képes megkeresni az oda nem illõ suid binárisokat, valamint az új vagy törölt állományokat a <span class=filename>/</span> és a <span class=filename>/usr</span> partíciókon.</p></div><div class=paragraph><p>A védelmi szkriptek megírása valamivel nehezebb feladat, ha ssh-t használunk az NFS helyett. A futtatásukhoz a szkripteket és az általuk használt eszközöket (például find) az <code>scp</code> paranccsal lényegében át kell másolni a kliensekre, amivel így láthatóvá válnak. Ne feledjük továbbá, hogy az ssh kliens már eleve feltört lehet. Szó, ami szó, ha nem megbízható összeköttetésekrõl beszélünk, akkor az ssh használata elkerülhetetlen, de nem feltétlenül egyszerû.</p></div><div class=paragraph><p>Egy jó védelmi szkript észreveszi a felhasználók és a személyzet tagjainak hozzáférését vezérlõ állományokban, mint például az <span class=filename>.rhosts</span>, <span class=filename>.shosts</span>, <span class=filename>.ssh/authorized_keys</span> és társaiban keletkezett változásokat is, amelyek esetleg elkerülhetik egy <code>MD5</code> alapú ellenõrzés figyelmét.</p></div><div class=paragraph><p>Ha netalán órási mennyiségû tárterületettel rendelkeznénk, akkor eltarthat egy ideig, amíg végigsöprünk az összes partíció összes állományán. Ebben az esetben érdemes olyan beállításokat megadni az állományrendszerek csatlakoztatásánál, amivel le tudjuk tiltani a suid engedéllyel rendelkezõ binárisok futtatását. Ezzel kapcsolatban a <a href="https://man.freebsd.org/cgi/man.cgi?query=mount&amp;sektion=8&amp;format=html">mount(8)</a> parancs <code>nosuid</code> opcióját nézzük meg. Hetente legalább egyszer azért mégis érdemes átnézni az ilyen partíciókat is, mivel ez a réteg a betörési kísérletek felderítésével foglalkozik, függetlenül a sikerességüktõl.</p></div><div class=paragraph><p>A futó programok nyilvántartása (lásd <a href="https://man.freebsd.org/cgi/man.cgi?query=accton&amp;sektion=8&amp;format=html">accton(8)</a>) egy olyan viszonylag kevés költséggel járó lehetõség az operációs rendszerben, ami segítségünkre lehet a betörés utáni események kiértékelésében. Különösen hasznos olyankor, amikor megpróbáljuk modellezni, miképp is sikerült a támadónak bejutnia a rendszerünkbe, természetesen feltételezve, hogy az ehhez felhasznált feljegyzések a betörés után is érintetlenek maradtak.</p></div><div class=paragraph><p>Végül a védelmet ellátó szkripteknek javasolt feldolgozni a naplóállományokat is, valamint a naplókat magukat is a lehetõ legbiztonságosabb formában generálni - ilyenkor nagyon hasznos lehet, ha egy távoli gépre naplózunk. A behatoló megpróbálja majd eltüntetni a nyomait, a naplóállományok viszont nagyon fontosak a rendszergazda számára a betörési kísérletek idejének és módjának megállapításában. A naplókat úgy tudjuk tartósan rögzíteni, ha a rendszerkonzol üzeneteit soros porton keresztül gyûjtjük össze a konzolok felügyeletéért felelõs biztonságos gépen.</p></div></div><div class=sect3><h4 id=_állandó_paranoia>14.3.7. Állandó paranoia<a class=anchor href=#_állandó_paranoia></a></h4><div class=paragraph><p>Egy kis paranoia sosem árt. Elmondható, hogy a rendszergazda tetszõleges számú biztonsági intézkedéssel élhet egészen addig, amíg az nincs hatással a kényelmére, és a kényelmet <em>befolyásoló</em> biztonsági intézkedéseket pedig megfelelõ mérlegelés mellett tegye meg. Ami még ennél is fontosabb, hogy mindig változtassunk valamit a biztonsági hálónkon - mivel ha egy az egyben követjük a dokumentumban leírtakat, akkor ezzel együtt kiadjuk a bejutás receptjét annak a leendõ támadónknak, aki szintén elolvasta ugyanezt.</p></div></div><div class=sect3><h4 id=_a_szolgáltatások_mûködésképtelenné_tételét_célzó_támadások>14.3.8. A szolgáltatások mûködésképtelenné tételét célzó támadások<a class=anchor href=#_a_szolgáltatások_mûködésképtelenné_tételét_célzó_támadások></a></h4><div class=paragraph><p>Ez a szakasz a szolgáltatások mûködésképtelenségét elérni kívánó, más néven "Denial of Service" típusú támadásokkal foglalkozik. Noha nem tudunk túlságosan sokat tenni a manapság felbukkanó álcázott, a hálózatunk totális leterhelését célbavevõ támadások ellen, akadnak olyan általános érvényû eszközök, amelyekkel elejét vehetjük a szervereink szétbomzásának:</p></div><div class="olist arabic"><ol class=arabic><li><p>A létjövõ szerverpéldányok korlátozása.</p></li><li><p>Az ugródeszkaszerû támadások (támadás ICMP-válasszal, pingszórás stb.) korlátozása.</p></li><li><p>A rendszermag útválasztási gyorsítótárának túlterhelése.</p></li></ol></div><div class=paragraph><p>A DoS támadások egyik jellemzõ sémája szerint egy sokszorozódni képes szervert támadnak meg, amelynek igyekeznek minél több példányát legyártatni, míg végül az ezt futtató rendszer ki nem fogy a memóriából, állományleíróból satöbbibõl és megállásra nem kényszerül. Az inetd (lásd <a href="https://man.freebsd.org/cgi/man.cgi?query=inetd&amp;sektion=8&amp;format=html">inetd(8)</a>) számos lehetõséget kínál fel ennek megakadályozására. Ezzel kapcsolatban szeretnénk megjegyezni, hogy bár ezzel el tudjuk kerülni a gépünk leállását, semmilyen garanciát nem ad arra, hogy a szolgáltatás a támadás során is zavartalanul üzemel tovább. Alaposan olvassuk el az inetd man oldalát és legyünk különös tekintettel a <code>-c</code>, <code>-C</code> és <code>-R</code> kapcsolóira. Vigyázzunk, hogy az inetd <code>-C</code> kapcsolóját képesek kijátszani az álcázott IP-vel érkezõ támadások, ezért inkább az elõbbi kapcsolók valamilyen kombinációja az ajánlott. Egyes szerverprogramoknál be lehet állítani a példányainak maximális számát.</p></div><div class=paragraph><p>A Sendmail rendelkezik egy <code>-OMaxDaemonChildren</code> beállítással, ami a terhelésben levõ késleltetése miatt néha mintha jobban beválna, mint a Sendmail terheléskorlátozó paraméterei. A Sendmail indításakor tehát a <code>MaxDaemonChildren</code> paramétert javasolt megadni egy olyan értékkel, amely elegendõ a Sendmail számára betervezett terhelés kiszolgálására, de még kevés ahhoz, hogy a Sendmail fûbe harapjon tõle. Továbbá bölcs dolog a Sendmailt várakozási sorral (<code>-ODeliveryMode=queued</code>) és démonként (<code>sendmail -bd</code>), külön feldolgozási menetekkel (<code>sendmail -q15m</code>) futtatni. Ha továbbra is valós idejû kézbesítést akarunk, akkor a feldolgozást kisebb idõközökkel is lefuttathatjuk (például <code>-q1m</code>), de arra <em>mindig ügyeljünk</em>, hogy a <code>MaxDaemonChildren</code> beállítása ne okozzon kaszkádosítási hibákat a Sendmail mûködésében.</p></div><div class=paragraph><p>A Syslogd közvetlenül is támadható, ezért határozottan javasoljuk a <code>-s</code> használatát, amikor csak lehet, minden más esetben pedig a <code>-a</code> beállítást.</p></div><div class=paragraph><p>Fordítsunk kellõ figyelmet a TCP kapcsolatok burkolását végzõ TCP Wrapper"reverse-ident" lehetõségére, ami szintén közvetlenül támadható. Ebbõl az okból kifolyólag valószínûleg nem is akarjuk a TCP Wrapper által felkínált reverse-ident-et használni.</p></div><div class=paragraph><p>Jól járunk el abban az esetben, ha a belsõ szolgáltatásainkat az útválasztóink mentén tûzfal segítségével védjük meg a külsõ hozzáféréstõl. Ezzel lényegében a helyi hálózatunkat kívülrõl fenyegetõ támadások ellen védekezünk, de ez nem nyújt elegendõ védelmet a belsõ szolgáltatásaink esetén a <code>root</code> hozzáférés megszerzésére irányuló kísérletek ellen. Mindig egy exkluzív, tehát zárt tûzfalat állítsunk be, vagyis "tûzfalazzunk mindent <em>kivéve</em> az A, B, C, D és M-Z portokat". Ezen a módon ki tudjuk szûrni az összes alacsonyabb portot, kivéve bizonyos eseteket, mint például a named (ha az adott zónában ez az elsõdleges gép), ntalkd, sendmail vagy más interneten keresztül elérhetõ szolgáltatásokat. Ha másképpen állítjuk a tûzfalat - inkluzív, nyílt avagy megengedõ módon, akkor jó eséllyel elfelejtünk "lezárni" egy csomó szolgáltatást, vagy úgy adunk hozzá egy új belsõ szolgáltatást, hogy közben elfelejtjük frissíteni a tûzfalat. Ennél még azon is jobb, ha a tûzfalon nyitunk egy magasabb portszámú tartományt, és ott valósítjuk meg ezt a megengedõ jellegû mûködést, az alacsonyabb portok veszélybe sodrása nélkül. Vegyük azt is számításba, hogy a FreeBSD-ben a kiosztott portokat dinamikusan állíthatjuk a <code>net.inet.ip.portrange</code> sysctl változókon keresztül (<code>sysctl -a | fgrep portrange</code>), ami nagyságrendekkel megkönnyíti a tûzfal beállítását. Ennek megfelelõen például meg tudjuk adni, hogy a 4000-tõl 5000-ig terjedõ porttartomány a 49152-tõl 65535-ig húzódó tartományba kerüljön át, majd a 4000 alatti összes portot blokkoljuk (természetesen az internetrõl szándékosan hozzáférhetõ portok kivételével).</p></div><div class=paragraph><p>A DoS támadások másik elterjedt fajtája az ún. "ugródeszka támadás" - ilyenkor a szervert úgy próbálják túlterhelni, hogy folyamatosan válaszokat kérnek tõle a helyi hálózatról vagy egy másik számítógéprõl. Az ilyen természetû támadások közül is a legnépszerûbb az <em>ICMP pingszórásos támadás</em>. A támadó olyan ping csomagokat küld szét a helyi hálózaton, amelyek forrásának azt a gépet jelöli meg, amelyiket meg akarja támadni. Ha a hálózatokat elválasztó útválasztók nem fogják meg a pingszórást, akkor a helyi hálózatról összes gépe nekilát válaszolgatni a meghamisított forrás címére, amivel így teljesen leterhelik az áldozatot. Ez különösen akkor hatásos, amikor a támadó ugyanezt a trükköt eljátssza egyszerre több tucat különbözõ hálózatban is. Az üzenetszórással járó támadások akár százhúsz megabitnyi forgalmat is képesek generálni másodpercenként. A második legelterjedtebb ugródeszkás támadás az ICMP hiba-visszajelzési rendszere ellen irányul. Ilyenkor a támadó ICMP hibaüzeneteket kiváltó csomagok készítésével képes eltömíteni egy szerver bejövõ hálózati kapcsolatát és az ICMP válaszokkal pedig a szerver maga dugítja el a kimenõ hálózati kapcsolatát. Ez a fajtájú támadás képes kinyomni az összes memóriát a szerverbõl és ezzel összeomlasztani, különösen olyankor, amikor a szerver nem tudja elég gyorsan elnyelni az általa generált ICMP válaszokat. A <code>net.inet.icmp.icmplim</code> sysctl változóval tudunk gátat szabni a támadások ezen fajtájának. Az ugródeszkás támadások utolsó nagyobb osztálya az inetd olyan szolgáltatásait szemeli ki, mint például az udp echo. A támadó ilyenkor egyszerûen küld a helyi hálózatunkon található A és B szerverünknek egy olyan UDP csomagot, ahol forrásként az A szerver echo portját adja meg, célnak pedig a B szerver echo portját. Ezután a két szerver elkezdi egymás között passzolgatni ezt az egyetlen csomagot. A támadó még több ilyen csomag befecskendezésével pillanatok alatt képes leterhelni a két szervert és helyi hálózatot. Hasonló problémák vannak a belsõ chargen portjával is. Egy hozzáértõ rendszergazda ezért kikapcsolja az összes ilyen inetd-alapú belsõ tesztelõ szolgáltatást.</p></div><div class=paragraph><p>Az álcázott csomagok felhasználhatóak a rendszermag útválasztó gyorsítótárának túlterhelésére is. Ezzel kapcsolatban nézzük meg a <code>net.inet.ip.rtexpire</code>, <code>rtminexpire</code> és <code>rtmaxcache</code> sysctl változókat. A véletlenszerû IP-címekkel megcímzett álcázott csomagok hatására a rendszermag létrehoz mindegyikõjükhöz egy ideiglenesen pufferelt utat az útválasztó táblázatában, amelyet a <code>netstat -rna | fgrep W3</code> paranccsal tudunk lekérdezni. Az ilyen útvonalak nagyjából 1600 másodperc múlva elévülnek. Ha a rendszermag észleli, hogy a gyorsítótárazott útválasztási táblázat mérete túlságosan megnövekedett, akkor automatikusan csökkenti az <code>rtexpire</code> értékét, de soha nem megy a <code>rtminexpire</code> alá. Ebbõl két probléma adódik:</p></div><div class="olist arabic"><ol class=arabic><li><p>A rendszermag nem reagál elég gyorsan amikor egy alig terhelt szervert hirtelen megtámadnak.</p></li><li><p>Az <code>rtminexpire</code> nem elég kicsi ahhoz, hogy a rendszermag túléljen egy tartósabb rohamot.</p></li></ol></div><div class=paragraph><p>Ha a szervereink az internethez T3 (kb. 45 Mbit/s) vagy gyorsabb összeköttetésen keresztül csatlakoznak, akkor határozottan javasolt kézileg behangolni a <a href="https://man.freebsd.org/cgi/man.cgi?query=sysctl&amp;sektion=8&amp;format=html">sysctl(8)</a> segítségével az <code>rtexpire</code> és az <code>rtminexpire</code> értékeket. Soha ne állítsuk egyiket sem nullára (hacsak nem akarjuk összeomlasztani a gépünket). Ha például mind a kettõt 2 másodpercre állítjuk, akkor az többnyire elegendõ az útválasztási táblázat megvédéséhez.</p></div></div><div class=sect3><h4 id=_hozzáférés_kerberosszal_és_ssh_val>14.3.9. Hozzáférés Kerberosszal és SSH-val<a class=anchor href=#_hozzáférés_kerberosszal_és_ssh_val></a></h4><div class=paragraph><p>Van néhány dolog, amit a Kerberos és az ssh esetén ajánlatos tisztázni, mielõtt használjuk ezeket. A Kerberos 5 egy kifogástalan hitelesítési protokoll. A telnet és rlogin Kerberos által módosított változatában vannak olyan hibák, amelyek alkalmatlanná teszik ezeket a bináris adatfolyamok helyes kezelésére. Sõt, alapértelmezés szerint a Kerberos nem titkosítja a kapcsolatot, csak ha megadjuk neki a <code>-x</code> kapcsolót. Az ssh alapértelmezés szerint mindent titkosít.</p></div><div class=paragraph><p>Az ssh minden szempontból nagyon jól teljesít kivéve, hogy alapértelmezés szerint átküldi a kulcsokat is. Ez azt jelenti, hogy ha van egy olyan biztonságos munkaállomásunk, ahol a rendszer többi részéhez tartozó kulcsainkat tartjuk és egy nem biztonságos gépre akarunk vele ssh-n keresztül belépni, akkor a kulcsaink használatóvá válnak. A tényleges kulcsokat ugyan nem látja senki, de a bejelentkezés során az ssh megnyit egy közvetítéshez használt portot, amit a nem biztonságos gépen a támadó egy feltört <code>root</code> hozzáférés birtokában ki tud használni úgy, hogy a kulcsaink segítségével hozzá tudjon férni egy másik olyan géphez, amelyet a kulcsok nyitnak.</p></div><div class=paragraph><p>Ha lehetséges, akkor a személyzet bejelentkeztetéséhez az ssh-t és Kerberost együttesen használjuk. Az ssh lefordíható Kerberos támogatással. Ezzel csökkentjük a potenciálisan kiszivárgó ssh kulcsok esélyét, miközben jelszavainkat a Kerberosszal védjük. Az ssh kulcsokat csak biztonságos gépekrõl és csak automatizált feladatok esetén használjuk (amire a Kerberos lényegében nem alkalmas). Emellett javasoljuk azt is, hogy az ssh beállításai között tiltsuk le a kulcsok átküldését (key forwarding) vagy használjuk az <code>from=IP/DOMAIN</code> opciót, amivel az ssh csak a megadott gépekrõl engedi az <span class=filename>authorized_keys</span> állomány és a így benne levõ kulcsok használatát.</p></div></div></div><div class=sect2><h3 id=crypt>14.4. DES, Blowfish, MD5 és a Crypt<a class=anchor href=#crypt></a></h3><div class=paragraph><p>Minden UNIX® rendszer használójához tartozik egy jelszó is a hozzáféréséhez. Teljesen nyilvánvalónak tûnik, hogy ezt a jelszót csak az adott felhasználó és az adott operációs rendszer ismeri. A jelszavakat a titokban tartásukhoz ún. "csapóajtó függvényekkel" titkosítják, amelyeket könnyû titkosítani, ám nehéz visszafejteni. Tehát amit egy perccel ezelõtt még nyilvalónak tituláltunk, az mostanra már nem is teljesen igaz: <em>valójában</em> az operációs rendszer sem ismeri a jelszót. Az operációs rendszer csak a jelszó <em>titkosított</em> változatát ismeri. A jelszó "titkosítatlan" formáját csak nyers erõ igényebevételével tudjuk megkeresni az összes lehetséges jelszó szénakazlában.</p></div><div class=paragraph><p>Sajnos, annak idején, amikor a jelszavak titkosítása bekerült a UNIX®-ba, egyedül a DES, vagy más néven a Data Encryption Standard (Adattitkosítási szabvány) jött szóba. Ez alapvetõen nem jelentett problémát az Egyesült Államok állampolgárai számára, de mivel a DES forráskódját nem lehetett kivinni az Egyesült Államokból, a FreeBSD-nek találnia kellett valami olyasmit, ami mind megfelel az Egyesült Államok törvényeinek, mind pedig kompatibilis marad az összes többi DES-t használó UNIX® variánssal.</p></div><div class=paragraph><p>Ezt úgy oldották meg, hogy felosztották a titkosítással foglalkozó függvénykönyvtárakat, így az Egyesült Államokban élõ felhasználók tudtak DES könyvtárakat telepíteni és használni, miközben a többi nemzet felhasználói olyan más titkosítási módszert tudtak választani, amit kinn is lehetett alkalmazni. Ennek tulajdonítható, hogy a FreeBSD alapértelmezés szerint az MD5 segítségével titkosít. Az MD5-öt a DES-nél sokkalta biztonságosabbnak tartják, ezért a DES telepítésének lehetõségét leginkább csak kompatibilitási okokból ajánlották fel.</p></div><div class=sect3><h4 id=_a_titkosítási_mechanizmus_azonosítása>14.4.1. A titkosítási mechanizmus azonosítása<a class=anchor href=#_a_titkosítási_mechanizmus_azonosítása></a></h4><div class=paragraph><p>Jelenleg a könyvtár ismeri a DES, MD5 és Blowfish függvényeit. A FreeBSD a jelszavak titkosításához alapból az MD5-öt használja.</p></div><div class=paragraph><p>Nagyon könnyen meg tudjuk mondani, hogy a FreeBSD éppen melyik titkosítási módszert alkalmazza. Ennek egyik lehetõsége, ha az <span class=filename>/etc/master.passwd</span> állományt vizsgáljuk meg. Az MD5 függvényével titkosított jelszavak hosszabbak, mint a DES függvényével titkosítottak és a <code>$1$</code> karakterekkel kezdõdnek. A <code>$2a$</code> karakterekkel kezdõdõ jelszavakat Blowfish-sel titkosították. A DES kódolású jelszavaknak nincs semmilyen különleges ismertetõjelük, de általánosságban elmondható róluk, hogy rövidebbek az MD5 jelszavaknál és olyan 64 karakteres ábécével kódolják ezeket, amelyek nem tartalmazzák a <code>$</code> karaktert, így tehát a viszonylag rövid, nem dollárjellel kezdõdõ karakterláncok minden bizonnyal DES kódolású jelszavak.</p></div><div class=paragraph><p>Az új jelszavak kódolásához használt formátumot az <span class=filename>/etc/login.conf</span> állományban tárolt <code>passwd_format</code> bejelentkezési tulajdonság adja meg, amelynek értékei <code>des</code>, <code>md5</code> vagy <code>blf</code> lehetnek. A <a href="https://man.freebsd.org/cgi/man.cgi?query=login.conf&amp;sektion=5&amp;format=html">login.conf(5)</a> man oldalon tájékozódhatunk bõvebben a bejelentkezési tulajdonságokról.</p></div></div></div><div class=sect2><h3 id=one-time-passwords>14.5. Egyszeri jelszavak<a class=anchor href=#one-time-passwords></a></h3><div class=paragraph><p>A FreeBSD alapértelmezés szerint támogatja az OPIE-t (One-time Passwords In Everything, azaz "Egyszeri jelszavak mindenben"), ami alapból az MD5 függvényét használja.</p></div><div class=paragraph><p>A jelszavak három fajtáját fogjuk a továbbiakban tárgyalni. Az elsõ a megszokott UNIX® stílusú avagy Kerberos jelszó. Ezt a továbbiakban "UNIX® jelszónak" nevezzük. A második fajtában az OPIE <a href="https://man.freebsd.org/cgi/man.cgi?query=opiekey&amp;sektion=1&amp;format=html">opiekey(1)</a> nevû segédprogramja által generált és a bejelentkezésnél a <a href="https://man.freebsd.org/cgi/man.cgi?query=opiepasswd&amp;sektion=1&amp;format=html">opiepasswd(1)</a> által elfogadott jelszavak tartoznak. Ezeket "egyszeri jelszavaknak" fogjuk nevezni. A jelszavak utolsó típusa az a titkos jelszó, amit az <code>opiekey</code> programnak (és néha a <code>opiepasswd</code> programnak) adunk meg, ami ebbõl egyszer használatos jelszavakat állít elõ. Ezt innentõl "titkos jelszónak" vagy csak egyszerûen "jelszónak" hívjuk.</p></div><div class=paragraph><p>A titkos jelszónak semmi köze sincs a UNIX® jelszavunkhoz. Természetesen megegyezhetnek, de ezt nem ajánljuk. Az OPIE által használt titkos jelszavaknak nem kell a régi UNIX® jelszavakhoz hasonlóan legfeljebb 8 karakteresnek lenniük , bármekkorát használhatunk. A hat vagy hét szóból álló jelszavak ilyenkor igen gyakoriak. Az OPIE jobbára a UNIX® jelszórendszerétõl teljesen függetlenül mûködik.</p></div><div class=paragraph><p>A jelszavak mellett két másik fajta adat fontos az OPIE számára. Közülük az egyiket "magnak" vagy "kulcsnak" nevezik, ami két betûbõl és öt számjegybõl áll. A másik az "iterációk száma", ami egy 1 és 100 közötti számot takar. Az OPIE úgy hozza létre az egyszeri jelszavakat, hogy egymás után fûzi a magot és a titkos jelszót, majd az iterációk megadott számának megfelelõ mennyiségben kiszámolja rá az MD5 függvény értékét és az eredményt hat rövid angol szóba önti. Ez a hat angol szó lesz a mi egyszeri jelszavunk. A hitelesítéssel foglalkozó rendszer (elsõsorban a PAM) figyelemmel kíséri a legutoljára használt egyszeri jelszavunkat, és csak akkor engedi a felhasználót hitelesíteni, ha az általa megadott jelszó kódolt változata megegyezik az elõzõleg megadott jelszaváéval. A csapóajtó függvények használata miatt lehetetlen legenerálni a következõ egyszeri jelszót, ha a sikerült megszereznünk az egyiket. Az iterációk száma minden egyes sikeres bejelentkezés után csökken eggyel, amivel a felhasználót és a bejelentkeztetõ programot szinkronban tartja. Amikor így az iterációk száma eléri az egyet, az OPIE-t újra kell inicializálni.</p></div><div class=paragraph><p>Az említésre kerülõ rendszerek mindegyikéhez tartozik néhány program. Az <code>opiekey</code> bekéri az iterációk számát, a magot és a titkos jelszót, majd elõállít egy egyszer használatos jelszót vagy azok folytonos listáját. Az <code>opiepasswd</code> az OPIE inicializálásért, a jelszavak, az iterációk számának és a mag megváltoztatásáért felelõs. Egyaránt elfogad titkos jelmondatot, iterációs számot vagy magot és egy egyszeri jelszót. Az <code>opieinfo</code> megvizsgálja a felhasználókra vonatkozó adatbázist (<span class=filename>/etc/opiekeys</span>) és kiírja az adott felhasználó által használt iterációs számot és magot.</p></div><div class=paragraph><p>Négyféle különbözõ mûveletrõl fogunk most itt beszélni. Az elsõben egy biztonságos kapcsolaton keresztül elsõként inicializáljuk az egyszeri jelszavakat, vagy megváltoztatjuk a jelszót vagy a magot az <code>opiepasswd</code> segítségével. A második mûveletben ugyanarra adjuk ki az <code>opiepasswd</code> parancsot egy nem biztonságos kapcsolaton keresztül az <code>opiekey</code> paranccsal együtt egy biztonságos kapcsolaton keresztül. A harmadikban az <code>opiekey</code> használatával nem biztonságos kapcsolaton keresztül jelentkezünk be. A negyedikben az <code>opiekey</code> paranccsal létrehozunk egy adott mennyiségû kulcsot, amelyeket aztán leírhatunk vagy kinyomtathatunk, hogy magunkkal tudjuk vinni olyan helyre, ahonnan nem tudnk biztonságos módon csatlakozni.</p></div><div class=sect3><h4 id=_inicializálás_biztonságos_kapcsolattal>14.5.1. Inicializálás biztonságos kapcsolattal<a class=anchor href=#_inicializálás_biztonságos_kapcsolattal></a></h4><div class=paragraph><p>Az OPIE elsõ inicializálásához adjuk ki az <code>opiepasswd</code> parancsot:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>% opiepasswd <span class=nt>-c</span>
<span class=o>[</span>grimreaper] ~ <span class=nv>$ </span>opiepasswd <span class=nt>-f</span> <span class=nt>-c</span>
Adding unfurl:
Only use this method from the console<span class=p>;</span> NEVER from remote. If you are using
telnet, xterm, or a dial-in, <span class=nb>type</span> ^C now or <span class=nb>exit </span>with no password.
Then run opiepasswd without the <span class=nt>-c</span> parameter.
Using MD5 to compute responses.
Enter new secret pass phrase:
Again new secret pass phrase:
ID unfurl OTP key is 499 to4268
MOS MALL GOAT ARM AVID COED</code></pre></div></div><div class=paragraph><p>A figyelmeztetés fordítása:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>Ezt a módszert csak konzolról alkalmazzuk, SOHA ne távoli kapcsolaton
keresztül!  Ha telnetet, xtermet vagy betárcsázós kapcsolatot használunk, akkor
azonnal nyomjunk ^C-t vagy ne adjunk meg jelszót.</code></pre></div></div><div class=paragraph><p>Az <code>Enter new secret pass phrase:</code> vagy <code>Enter secret password:</code> kérdések után adjunk meg egy jelmondatot, illetve jelszót. Ne felejtsük el, hogy ez nem bejelentkezéshez használt jelszó lesz, hanem ebbõl jönnek majd létre az egyszeri kulcsaink. Az "ID" sor adja meg az aktuális példányunk paramétereit: a bejelentkezéshez használt nevünket, az iterációk számát és a magot. Amikor a bejelentkezések során a rendszer emlékszik a paraméterekre és megjeleníti ezeket, nem kell megjegyeznünk. Az utolsó sor adja meg a paramétereinknek és a titkos jelszavunknak megfelelõ egyszeri jelszót. Ha most azonnal akarnánk bejelentkezni, akkor ezt az egyszeri jelszót kellene hozzá használnunk.</p></div></div><div class=sect3><h4 id=_inicializálás_nem_biztonságos_kapcsolattal>14.5.2. Inicializálás nem biztonságos kapcsolattal<a class=anchor href=#_inicializálás_nem_biztonságos_kapcsolattal></a></h4><div class=paragraph><p>Ha egy nem biztonságos kapcsolaton keresztül akarjuk inicializálni vagy megváltoztatni a jelszavunkat, akkor szükségünk lesz valahol egy megbízható kapcsolatra, ahol le tudjuk futtatni az <code>opiekey</code> parancsot. Ez lehet egy számunkra biztonsági szempontból elfogadható gép parancssora. Emellett ki kell találnunk egy iterációs számot (erre a 100 egy jó választás) és adnunk egy magot vagy használni egy véletlenszerûen generáltat. Az inicializálás színtere felé vezetõ nem biztonságos kapcsolaton keresztül adjuk ki az <code>opiepasswd</code> parancsot:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>% opiepasswd

Updating unfurl:
You need the response from an OTP generator.
Old secret pass phrase:
        otp-md5 498 to4268 ext
        Response: GAME GAG WELT OUT DOWN CHAT
New secret pass phrase:
        otp-md5 499 to4269
        Response: LINE PAP MILK NELL BUOY TROY

ID mark OTP key is 499 gr4269
LINE PAP MILK NELL BUOY TROY</code></pre></div></div><div class=paragraph><p>Az alapértelmezett mag elfogadásához nyomjuk le a <kbd>Return</kbd> billentyût. Mielõtt megadnánk a hozzáférés jelszavát, menjünk át a biztonságos kapcsolatra és adjuk meg neki ugyanezeket a paramétereket:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>% opiekey 498 to4268
Using the MD5 algorithm to compute response.
Reminder: Don<span class=s1>&#39;t use opiekey from telnet or dial-in sessions.
Enter secret pass phrase:
GAME GAG WELT OUT DOWN CHAT</span></code></pre></div></div><div class=paragraph><p>Most váltsunk vissza a nem biztonságos kapcsolatra és másoljuk be az így generált egyszeri jelszót a megfelelõ programba.</p></div></div><div class=sect3><h4 id=_egyetlen_egyszeri_jelszó_létrehozása>14.5.3. Egyetlen egyszeri jelszó létrehozása<a class=anchor href=#_egyetlen_egyszeri_jelszó_létrehozása></a></h4><div class=paragraph><p>Miután sikeresen inicializáltuk az OPIE-t és bejelentkezünk, a következõket láthatjuk:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>% telnet example.com
Trying 10.0.0.1...
Connected to example.com
Escape character is <span class=s1>&#39;^]&#39;</span><span class=nb>.</span>

FreeBSD/i386 <span class=o>(</span>example.com<span class=o>)</span> <span class=o>(</span>ttypa<span class=o>)</span>

login: felhasználói_név
otp-md5 498 gr4269 ext
Password:</code></pre></div></div><div class=paragraph><p>Mellékesen megjegyezzük, hogy az OPIE paranccsorának van egy (itt nem látható) hasznos képessége: ha <kbd>Return</kbd> billentyût nyomunk a jelszó bekérésekor, akkor a program megmutatja a begépelt betûket, így láthatjuk pontosan mit is írunk be. Ez nagyon kényelmes lehet olyankor, amikor valahonnan, például egy lapról olvassuk a jelszót.</p></div><div class=paragraph><p>A bejelentkezéshez ekkor le kell valahogy generálnunk az egyszeri jelszavunkat. Ezt egy megbízható rendszeresen tudjuk megtenni az <code>opiekey</code> lefuttatásával. (Ennek vannak DOS-os, Windows®-os és Mac OS®-es változatai is.) Paraméterként az iterációs számot és a magot kell megadnunk. Ezt akár közvetlenül át is másolhatjuk annak a gépnek a bejelentkezési képernyõjérõl, ahova be akarunk jelentkezni.</p></div><div class=paragraph><p>A megbízható rendszeren tehát:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>% opiekey 498 to4268
Using the MD5 algorithm to compute response.
Reminder: Don<span class=s1>&#39;t use opiekey from telnet or dial-in sessions.
Enter secret pass phrase:
GAME GAG WELT OUT DOWN CHAT</span></code></pre></div></div><div class=paragraph><p>Most már megvan a bejelentkezéshez szükséges egyszeri jelszavunk.</p></div></div><div class=sect3><h4 id=_több_egyszeri_jelszó_létrehozása>14.5.4. Több egyszeri jelszó létrehozása<a class=anchor href=#_több_egyszeri_jelszó_létrehozása></a></h4><div class=paragraph><p>Néha olyan helyekre kell mennünk, ahol se egy megbízható gép, sem pedig biztonságos kapcsolat nem található. Ilyen esetekben megadhatjuk az <code>opiekey</code> parancsnak, hogy elõre gyártson le több egyszer használatos jelszót, amit késõbb aztán ki tudunk nyomtatni. Például:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>% opiekey <span class=nt>-n</span> 5 30 zz99999
Using the MD5 algorithm to compute response.
Reminder: Don<span class=s1>&#39;t use opiekey from telnet or dial-in sessions.
Enter secret pass phrase: &lt;secret password&gt;
26: JOAN BORE FOSS DES NAY QUIT
27: LATE BIAS SLAY FOLK MUCH TRIG
28: SALT TIN ANTI LOON NEAL USE
29: RIO ODIN GO BYE FURY TIC
30: GREW JIVE SAN GIRD BOIL PHI</span></code></pre></div></div><div class=paragraph><p>Az <code>-n 5</code> öt kulcsot kér egymás után, a <code>30</code> pedig megadja az utolsó iterációs számot. Vegyük észre, hogy a kulcsokat a felhasználás sorrendjével <em>ellentétes</em> sorrendben írja ki a program. Ha igazán paranoiások vagyunk, akkor írjuk le kézzel a jelszavakat. Ha viszont annyira nem, akkor egyszerûen küldjük át ezeket az <code>lpr</code> parancsnak. Megfigyelhetjük, hogy minden sorban látható az iterációs szám és a hozzá tartozó egyszeri jelszó. Hasznos lehet a felhasználás szerinti felírni a jelszavakat.</p></div></div><div class=sect3><h4 id=_a_unix_jelszavak_használatának_leszûkítése>14.5.5. A UNIX® jelszavak használatának leszûkítése<a class=anchor href=#_a_unix_jelszavak_használatának_leszûkítése></a></h4><div class=paragraph><p>Az OPIE képes a bejelentkezéshez használt IP-címek alapján leszûkíteni a UNIX® jelszavak használatát. Ehhez az <span class=filename>/etc/opieaccess</span> használható, amely alapból megtalálható a rendszerünkön. Az <a href="https://man.freebsd.org/cgi/man.cgi?query=opieaccess&amp;sektion=5&amp;format=html">opieaccess(5)</a> man oldalán találhatjuk meg a rá vonatkozó információkat és az összes vele kapcsolatos biztonsági megfontolást.</p></div><div class=paragraph><p>Íme egy példa az <span class=filename>opieaccess</span> állományra:</p></div><div class="literalblock programlisting"><div class=content><pre>permit 192.168.0.0 255.255.0.0</pre></div></div><div class=paragraph><p>Ezzel a sorral megengedjük a UNIX® jelszavak használatát minden olyan felhasználó számára, akinek az IP-je illeszkedik a megadott címre és maszkra (ez viszont álcázással kijátszható).</p></div><div class=paragraph><p>Ha az <span class=filename>opieaccess</span> állományból egyetlen szabály sem illeszkedik, akkor alapértelmezés szerint nem engedélyezettek a nem OPIE típusú jelszavak.</p></div></div></div><div class=sect2><h3 id=tcpwrappers>14.6. A TCP kapcsolatok burkolása<a class=anchor href=#tcpwrappers></a></h3><div class=paragraph><p>Aki ismeri az <a href="https://man.freebsd.org/cgi/man.cgi?query=inetd&amp;sektion=8&amp;format=html">inetd(8)</a> programot, az már biztosan hallott a TCP kapcsolatok burkolásáról, eredeti nevén a a TCP wrapperekrõl. Azonban csak kevesek képesek felfogni ezek valódi hasznát. Úgy néz ki, mindenki csak tûzfalakon keresztül akarja megoldani a hálózati kapcsolatot kezelését. Habár a tûzfalakat sok mindenre fel lehet ugyan használni, egyetlen tûzfal nem képes például szövegesen válaszolni a kapcsolatok kezdeményezõinek. Ellenben bármelyik TCP-wrapper szoftver képes erre, sõt még többre is. A következõ néhány szakaszban szemügyre vesszük a TCP wrapperek számos lehetõségét, és ahol lehetséges, ott konfigurációs állományokkal is illusztráljuk ezek használatát.</p></div><div class=paragraph><p>A TCP burkoló szoftverek kiterjesztik az inetd képességeit minden alatta dolgozó szerverdémon támogatására. Ezzel a módszerrel meg lehet oldani a naplózást, üzenetek küldését a kapcsolatokhoz, a démonok elérhetõségének korlátozását stb. Noha ezen lehetõségek közül néhány tûzfallal is megvalósítható, ezzel nem csupán egy további védelmi réteget húzunk fel a rendszerünk köré, hanem túllépjük mindazt, amit egy tûzfallal irányítani lehet.</p></div><div class=paragraph><p>A TCP burkolók használatával hozzáadott funkcionalitás azonban nem helyettesít egy jó tûzfalat. A TCP kapcsolatok burkolását tûzfallal vagy más egyéb biztonsági megoldással együtt tudjuk csak eredményesen használni, viszont a rendszerünk biztonságában egy újabb remek védelmi vonalat képvisel.</p></div><div class=paragraph><p>Mivel lényegében ez az inetd beállításának kibõvítése, ezért a szakasz elolvasásához feltételezzük az <a href=./#network-inetd>inetd beállításával</a> kapcsolatos tudnivalók ismeretét.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Bár az <a href="https://man.freebsd.org/cgi/man.cgi?query=inetd&amp;sektion=8&amp;format=html">inetd(8)</a> által indított programok nem egészen tekinthetõen "démonoknak", hagyományosan démonnak hívják ezeket. Ezért rájuk ebben a szakaszban is ezt a kifejezést használjuk.</p></div></td></tr></tbody></table></div><div class=sect3><h4 id=_kezdeti_beállítások>14.6.1. Kezdeti beállítások<a class=anchor href=#_kezdeti_beállítások></a></h4><div class=paragraph><p>FreeBSD alatt a TCP burkolók használatának egyetlen feltétele csupán annyi, hogy az inetd parancsot a <code>-Ww</code> paraméterrel indítsuk az <span class=filename>rc.conf</span> állományból. Az egyébként az alapbeállítás. Természetesen nem árt, ha helyesen állítjuk be az <span class=filename>/etc/hosts.allow</span> állományt is, ellenkezõ esetben a <a href="https://man.freebsd.org/cgi/man.cgi?query=syslogd&amp;sektion=8&amp;format=html">syslogd(8)</a> egyébként dobálni fogja errõl az üzeneteket.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Eltérõen a TCP burkolók egyéb implementációitól, a <span class=filename>hosts.deny</span> állományt itt már nem használjuk. Minden beállítást az <span class=filename>/etc/host.allow</span> állományba kell raknunk.</p></div></td></tr></tbody></table></div><div class=paragraph><p>A legegyszerûbb konfiguráció esetén a démonok kapcsolódását egyszerûen engedélyezhetjük vagy letilthatjuk az <span class=filename>/etc/hosts.allow</span> állományban szereplõ beállításokkal. A FreeBSD alapértelmezett beállításai szerint minden inetd által indított démonhoz lehet kapcsolódni. Ennek megváltoztatásával az alapkonfiguráció áttekintése után foglalkozunk.</p></div><div class=paragraph><p>Az alapkonfiguráció általában <code>démon : cím : cselekvés</code> alakú. Itt a <code>démon</code> egy olyan démonra utal, amelyet az <code>inetd</code> indított el. A <code>cím</code> egy érvényes hálózati név, IP-cím vagy szögletes zárójelek ([ ]) között megadott IPv6 formátumú cím. A cselekvést tartalmazó mezõ (<code>action</code>) lehet <code>allow</code> vagy <code>deny</code> annak megfelelõen, hogy engedélyezzük vagy tiltjuk a megadott címrõl a csatlakozást. Nem szabad elfelejtenünk, hogy az így megadott beállítások közül mindig az elsõként illeszkedõ érvényesül, ami arra utal, hogy a konfigurációs állományban szereplõ szabályok egymás után növekvõ sorrendben értékelõdnek ki. Ha valamelyikük illeszkedik, akkor a keresés megáll.</p></div><div class=paragraph><p>Rengeteg egyéb opció is megadható még, de ezekrõl csak a késõbbi szakaszokban fogunk szólni. Egy egyszerû konfigurációs állomány már ennyi információból is könnyedén összeállítható. Például, ha engedélyezni szeretnénk a POP3 kapcsolatokat a <a class=package href=https://cgit.freebsd.org/ports/tree/mail/qpopper/>mail/qpopper</a> démonon keresztül, akkor a következõ sorral kell kiegészítenünk a <span class=filename>hosts.allow</span> állományt:</p></div><div class="literalblock programlisting"><div class=content><pre># Ez a sor kell a POP3 kapcsolatokhoz:
qpopper : ALL : allow</pre></div></div><div class=paragraph><p>Miután hozzáadtuk ezt a sort, az inetd szervert újra kell indítanunk. Ezt vagy a <a href="https://man.freebsd.org/cgi/man.cgi?query=kill&amp;sektion=1&amp;format=html">kill(1)</a> paranccsal, vagy pedig az <span class=filename>/etc/rc.d/inetd</span> szkript <span class=parameter>restart</span> paraméterével tehetjük meg.</p></div></div><div class=sect3><h4 id=_komolyabb_beállítások>14.6.2. Komolyabb beállítások<a class=anchor href=#_komolyabb_beállítások></a></h4><div class=paragraph><p>A TCP kapcsolatok burkolásánál is meg lehet adni további opciókat. Segítségükkel még jobban irányítani tudjuk a kapcsolatok kezelésének módját. Néhány esetben az is hasznos lehet, ha küldünk valamilyen választ az egyes gépeknek vagy démonoknak. Máskor szükségünk lehet a csatlakozások naplózására vagy e-mailen keresztüli jelzésére a rendszergazda felé. Teljesen más helyezetekben csak a helyi hálózatunkról engedjük meg a csatlakozást. Ez mind lehetséges a <code>helyettesítõ jelekként</code> ismert beállítási opciók, kiterjesztõ karakterek és külsõ parancsok végrehajtásának használatával. A következõ két szakasz az ilyen és ehhez hasonló szituációk megoldására íródott.</p></div><div class=sect4><h5 id=_külsõ_parancsok>14.6.2.1. Külsõ parancsok<a class=anchor href=#_külsõ_parancsok></a></h5><div class=paragraph><p>Tegyük fel, hogy olyan helyezetben vagyunk, amikor a kapcsolatot tiltani akarjuk, de közben azért szeretnénk errõl értesíteni a kapcsolatot kezdeményezõ felet is. Hogyan tudjuk ezt megcsinálni? Ezt a <code>twist</code> nevû opcióval tehetjük meg. Amikor megpróbál valaki csatlakozni, akkor a <code>twist</code> hívódik meg és végrehajt egy megadott parancsot vagy szkriptet. Erre találunk is egy példát a <span class=filename>hosts.allow</span> állományban:</p></div><div class="literalblock programlisting"><div class=content><pre># The rest of the daemons are protected.
ALL : ALL \
        : severity auth.info \
        : twist /bin/echo &#34;You are not welcome to use %d from %h.&#34;</pre></div></div><div class=paragraph><p>Ez a példa a következõ üzenetet jeleníti meg: "You are not allowd to use <code>a démon neve</code> from <code>hálózati név</code>." (Jelentése: "A <code>démon neve</code> démont nem érheti el a <code>hálózati név</code> helyrõl!") Ez minden olyan démon esetén megjelenik, amirõl nem nyilatkoztunk korábban az állományban. Ezzel nagyon könnyen vissza tudunk küldeni egy választ a kapcsolat kezdményezõje felé, miután a kapcsolatot eldobtuk. Vegyük észre, hogy a visszaküldendõ üzenetet <code>"</code> karakterek közé <em>kell</em> tennünk, ez alól semmi sem kivétel.</p></div><div class="admonitionblock warning"><table><tbody><tr><td class=icon><i class="fa icon-warning" title=Warning></i></td><td class=content><div class=paragraph><p>DoS támadást lehet elõidézni azzal, ha egy támadó vagy támadók egy csoportja csatlakozási kérelmekkel kezdi el bombázni a démonainkat.</p></div></td></tr></tbody></table></div><div class=paragraph><p>Ilyen esetekben használhatjuk a <code>spawn</code> opciót is. A <code>spawn</code> a <code>twist</code> opcióhoz hasonlóan implicit módon tiltja a kapcsolódást és arra használható, hogy lefuttassunk vele egy parancsot vagy szkriptet. A <code>spawn</code> azonban a <code>twist</code> opciótól eltérõen nem küld vissza semmilyen választ a kapcsolatot létrehozni kívánó egyénnek. Ehhez példaként vegyük a következõ sort a konfigurációs állományban:</p></div><div class="literalblock programlisting"><div class=content><pre># We do not allow connections from example.com:
ALL : .example.com \
	: spawn (/bin/echo %a from %h attempted to access %d &gt;&gt; \
	  /var/log/connections.log) \
	: deny</pre></div></div><div class=paragraph><p>Ezzel a <code>*.example.com</code> címtartományból érkezõ összes kapcsolódási kísérlet sikertelen lesz, miközben ezzel egyidõben a <span class=filename>/var/log/connections.log</span> állományba rögzítjük a csatlakozni akaró egyén hálózati nevét, IP-címét és a démont.</p></div><div class=paragraph><p>A korábban már kifejtett helyettesítõ karakterek túl, mint például az <code>%a</code>, még léteznek továbbiak is. Róluk a <a href="https://man.freebsd.org/cgi/man.cgi?query=hosts_access&amp;sektion=5&amp;format=html">hosts_access(5)</a> man oldalon találhatjuk meg a teljes listát.</p></div></div><div class=sect4><h5 id=_helyettesítõ_jelek>14.6.2.2. Helyettesítõ jelek<a class=anchor href=#_helyettesítõ_jelek></a></h5><div class=paragraph><p>Az eddigi példákban folyamatosan csak az <code>ALL</code> opciót adtuk meg. Azonban rajta kívûl léteznek mások is, amivel a megoldás funkcionalitását még egy kicsivel tovább növelhetjük. Például az <code>ALL</code> használható egy démon, egy tartomány vagy egy IP-cím illesztésére. A másik ilyen helyettesítõ jel a <code>PARANOID</code>, amelyet olyan gépek IP-címének illesztésekor alkalmazhatunk, ami feltételezhetõen hamis. Más szóval a <code>PARANOID</code> olyan cselekvések megadását teszi lehetõvé, amelyek akkor hajtódnak végre, amikor a kapcsolatot létrehozó gép IP-címe eltér a hálózati nevétõl. A most következõ példa valószínûleg segít fényt deríteni ennek lényegére:</p></div><div class="literalblock programlisting"><div class=content><pre># Block possibly spoofed requests to sendmail:
sendmail : PARANOID : deny</pre></div></div><div class=paragraph><p>A példában minden olyan kapcsolatkérést elutasítunk, ami a <code>sendmail</code> felé a hálózati névtõl eltérõ IP-címrõl irányul.</p></div><div class="admonitionblock caution"><table><tbody><tr><td class=icon><i class="fa icon-caution" title=Caution></i></td><td class=content><div class=paragraph><p>Ha rossz DNS beállításokat használunk, a <code>PARANOID</code> megadásával súlyosan mozgásképtelenné tehetjük a kliensünket vagy szerverünket. Ezért legyünk óvatosak vele!</p></div></td></tr></tbody></table></div><div class=paragraph><p>A helyettesítõ jelekrõl és hozzájuk tartozó további lehetõségekrõl a <a href="https://man.freebsd.org/cgi/man.cgi?query=hosts_access&amp;sektion=5&amp;format=html">hosts_access(5)</a> man oldalon tájékozódhatunk.</p></div><div class=paragraph><p>A <span class=filename>hosts.allow</span> állományból ki kell venni az elsõ sort ahhoz, hogy bármilyen egyéb konfigurációs beállítás mûködõképes legyen. Ezt említettük a szakasz elején is.</p></div></div></div></div><div class=sect2><h3 id=kerberosIV>14.7. KerberosIV<a class=anchor href=#kerberosIV></a></h3><div class=paragraph><p>A Kerberos egy olyan járulékos rendszer/protokoll, amellyel a felhasználók egy biztonságos szerver szolgáltatásain keresztül tudják hitelesíteni magukat. Ilyen szolgáltatás többek közt a távoli bejelentkezés, távoli másolás, a rendszeren belüli biztonságos másolás és minden olyan egyéb veszélyes feladat, amit számottevõen megbízhatóbbá és irányíthatóbbá tettek.</p></div><div class=paragraph><p>A következõ utasítások a FreeBSD-hez mellékelt Kerberos beállításához adnak útmutatást. A teljes leíráshoz azonban érdemes fellapoznunk a menet közben hivatkozott man oldalakat is.</p></div><div class=sect3><h4 id=_a_kerberosiv_telepítése>14.7.1. A KerberosIV telepítése<a class=anchor href=#_a_kerberosiv_telepítése></a></h4><div class=paragraph><p>A Kerberos a FreeBSD egyik választható komponense. Legkönnyebben úgy tudjuk feltelepíteni, ha a FreeBSD telepítése során a sysinstall programban kiválasztjuk a <code>krb4</code> vagy <code>krb5</code> terjesztések valamelyikét. Ezzel felrakhatjuk a Kerberos "eBones" (KerberosIV) vagy "Heimdal" (Kerberos5) elnevezésû változatait. A FreeBSD azért tartalmazza ezeket az implementációkat, mert nem az Amerikai Egyesült Államokban vagy Kanadában fejlesztették, így az Egyesült Államok titkosításokkal kapcsolatos kiviteli korlátozások korában minden olyan rendszer adminisztrátora el tudta érni, aki nem ezekben az országokban lakott.</p></div><div class=paragraph><p>A Kerberos MIT által fejlesztett implementációját egyébként a Portgyûjteménybõl a <a class=package href=https://cgit.freebsd.org/ports/tree/security/krb5/>security/krb5</a> porton keresztül érhetjük el.</p></div></div><div class=sect3><h4 id=_a_kezdeti_adatbázis_létrehozása>14.7.2. A kezdeti adatbázis létrehozása<a class=anchor href=#_a_kezdeti_adatbázis_létrehozása></a></h4><div class=paragraph><p>Ezt a lépést csak a Kerberos szerveren kell elvégezni. Elõször is gyõzõdjünk meg róla, hogy semmilyen korábbi Kerberos adatbázis nem található a gépen. Váltsunk az <span class=filename>/etc/kerberosIV</span> könyvtárra és ellenõrizzük a következõ állományok meglétét:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># cd /etc/kerberosIV</span>
<span class=c># ls</span>
README		krb.conf        krb.realms</code></pre></div></div><div class=paragraph><p>Ha rajtuk kívül további állományok is feltûnnének (mint például a <span class=filename>principal.*</span> vagy <span class=filename>master_key</span>), akkor a <code>kdb_destroy</code> paranccsal pusztítsuk el a régi Kerberos adatbázist, vagy ha nem fut már a Kerberos, akkor egyszerûen csak törüljük le ezeket.</p></div><div class=paragraph><p>Ezután lássunk neki a <span class=filename>krb.conf</span> és <span class=filename>krb.realms</span> állományok átírásán keresztül a Kerberos egyes övezeteinek (realm) létrehozásához. Itt most az <code>EXAMPLE.COM</code> lesz a létrehozandó övezet, a hozzá tartozó szerver pedig a <code>grunt.example.com</code>. Így szerkesszük át vagy készítsünk el a neki megfelelõ <span class=filename>krb.conf</span> állományt:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># cat krb.conf</span>
EXAMPLE.COM
EXAMPLE.COM grunt.example.com admin server
CS.BERKELEY.EDU okeeffe.berkeley.edu
ATHENA.MIT.EDU kerberos.mit.edu
ATHENA.MIT.EDU kerberos-1.mit.edu
ATHENA.MIT.EDU kerberos-2.mit.edu
ATHENA.MIT.EDU kerberos-3.mit.edu
LCS.MIT.EDU kerberos.lcs.mit.edu
TELECOM.MIT.EDU bitsy.mit.edu
ARC.NASA.GOV trident.arc.nasa.gov</code></pre></div></div><div class=paragraph><p>A többi övezetnek valójában nem feltétlenül kell itt lennie. Ezek csupán azért szerepelnek itt, hogy bemutassák miként lehet egyetlen géphez hozzárendelni egyszerre több övezetet is. Az egyszerûség kedvéért nyugodtan elhagyhatóak.</p></div><div class=paragraph><p>Az elsõ sor nevezi meg a rendszer által mûködtetett övezeteket. Az utána következõ sorokban övezeteket és hálózati neveket láthatunk. Itt az elsõ elem egy övezetet nevez meg, a második elem pedig az övezet "kulcselosztó központját" (key distribution center). A hálózati nevet követõ <code>admin server</code> kulcsszavak arra utalnak, hogy az adott gép adminisztratív szerepet ellátó adatbázist is tartalmaz. Ezeket a fogalmakat részleteiben a Kerberos man oldalain ismerhetjük meg.</p></div><div class=paragraph><p>Ezután hozzá kell adnunk a <code>grunt.example.com</code> nevû gépet az <code>EXAMPLE.COM</code> övezethez, valamint az <code>.example.com</code> tartományban levõ összes géphez létre kell hoznunk egy bejegyzést az <code>EXAMPLE.COM</code> övezetben. A <span class=filename>krb.realms</span> állományt ehhez a következõképpen kellene módosítanunk:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># cat krb.realms</span>
grunt.example.com EXAMPLE.COM
.example.com EXAMPLE.COM
.berkeley.edu CS.BERKELEY.EDU
.MIT.EDU ATHENA.MIT.EDU
.mit.edu ATHENA.MIT.EDU</code></pre></div></div><div class=paragraph><p>Ismét hozzátesszük, hogy a többi övezetnek nem kötelezõ itt szerepelnie. Ezek csupán azt demonstrálják, hogy miként kell egy gépet egyszerre több övezethez is beállítani. Az átláthatóság kedvéért minden további nélkül eltávolíthatjuk ezeket.</p></div><div class=paragraph><p>Itt az elsõ sor az <em>adott</em> rendszert elhelyezi egy nevesített övezetbe. A többi sor azt mutatja meg, hogyan kell alapértelmezett módon a meghatározott altartományokba tartozó gépeket egy nevesített övezethez hozzárendelni.</p></div><div class=paragraph><p>Most már készen állunk az adatbázis létrehozására. Ehhez egyedül a Kerberos szerverét (avagy Kulcselosztó központját) kell elindítanunk. Adjuk ki a <code>kdb_init</code> parancsot:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># kdb_init</span>
Realm name <span class=o>[</span>default  ATHENA.MIT.EDU <span class=o>]</span>: EXAMPLE.COM
You will be prompted <span class=k>for </span>the database Master Password.
It is important that you NOT FORGET this password.

Enter Kerberos master key:</code></pre></div></div><div class=paragraph><p>Az üzenet fordítása:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>Most az adatbázis mesterkulcsát kell megadni.  Fontos, hogy
NE FELEJTSÜK EL ezt a jelszót.</code></pre></div></div><div class=paragraph><p>Most el kell mentenünk a kulcsot, így a helyi gépen futó szerverek fel tudják szedni. Ehhez a <code>kstash</code> parancsra van szükségünk:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># kstash</span>

Enter Kerberos master key:

Current Kerberos master key version is 1.

Master key entered. BEWARE!</code></pre></div></div><div class=paragraph><p>Az üzenet fordítása:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>A Kerberos mesterkulcsának jelenlegi változata: 1.

VIGYÁZAT, megadták a mesterkulcsot!</code></pre></div></div><div class=paragraph><p>Ez elmenti a titkosított mesterkulcsot az <span class=filename>/etc/kerberosIV/master_key</span> állományba.</p></div></div><div class=sect3><h4 id=_az_egész_beüzemelése>14.7.3. Az egész beüzemelése<a class=anchor href=#_az_egész_beüzemelése></a></h4><div class=paragraph><p><em>Mindegyik</em> Kerberosszal õrzött rendszerrel kapcsolatban két ún. szereplõt (principal) kell még hozzátennünk az adatbázishoz. A nevük <code>kpasswd</code> és <code>rcmd</code>. Minden rendszerhez létre kell hoznunk ezeket a szereplõket, példányonként (instance) az egyes rendszerek neveivel.</p></div><div class=paragraph><p>A kpasswd és rcmd démonok teszik lehetõvé a többi rendszer számára, hogy megváltoztathassák a Kerberos jelszavukat, valamint hogy futtathassák az <a href="https://man.freebsd.org/cgi/man.cgi?query=rcp&amp;sektion=1&amp;format=html">rcp(1)</a>, <a href="https://man.freebsd.org/cgi/man.cgi?query=rlogin&amp;sektion=1&amp;format=html">rlogin(1)</a> és <a href="https://man.freebsd.org/cgi/man.cgi?query=rsh&amp;sektion=1&amp;format=html">rsh(1)</a> parancsokat.</p></div><div class=paragraph><p>Vegyük fel ezeket a bejegyzéseket is:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># kdb_edit</span>
Opening database...

Enter Kerberos master key:

Current Kerberos master key version is 1.

Master key entered.  BEWARE!
Previous or default values are <span class=k>in</span> <span class=o>[</span>brackets] ,
enter <span class=k>return </span>to leave the same, or new value.

Principal name: passwd
Instance: grunt

&lt;Not found&gt;, Create <span class=o>[</span>y] ? y

Principal: passwd, Instance: grunt, kdc_key_ver: 1
New Password:                    &lt;<span class=nt>----</span> írjuk be, hogy <span class=s2>&#34;RANDOM&#34;</span>
Verifying password

New Password: &lt;<span class=nt>----</span> írjuk be, hogy <span class=s2>&#34;RANDOM&#34;</span>

Random password <span class=o>[</span>y] ? y

Principal<span class=s1>&#39;s new key version = 1
Expiration date (enter yyyy-mm-dd) [ 2000-01-01 ] ?
Max ticket lifetime (*5 minutes) [ 255 ] ?
Attributes [ 0 ] ?
Edit O.K.
Principal name: rcmd
Instance: grunt

&lt;Not found&gt;, Create [y] ?

Principal: rcmd, Instance: grunt, kdc_key_ver: 1
New Password:		&lt;---- írjuk be, hogy &#34;RANDOM&#34;
Verifying password

New Password:           &lt;---- írjuk be, hogy &#34;RANDOM&#34;

Random password [y] ?

Principal&#39;</span>s new key version <span class=o>=</span> 1
Expiration <span class=nb>date</span> <span class=o>(</span>enter yyyy-mm-dd<span class=o>)</span> <span class=o>[</span> 2000-01-01 <span class=o>]</span> ?
Max ticket lifetime <span class=o>(</span><span class=k>*</span>5 minutes<span class=o>)</span> <span class=o>[</span> 255 <span class=o>]</span> ?
Attributes <span class=o>[</span> 0 <span class=o>]</span> ?
Edit O.K.
Principal name:         &lt;<span class=nt>----</span> ha nem adunk meg semmit, akkor kilép</code></pre></div></div></div><div class=sect3><h4 id=_a_szerver_állomány_létrehozása>14.7.4. A szerver állomány létrehozása<a class=anchor href=#_a_szerver_állomány_létrehozása></a></h4><div class=paragraph><p>Most pedig kivonatolni kell azokat a példányokat, amelyek szolgáltatást definiálnak a gépen. Erre az <code>ext_srvtab</code> parancsot használjuk. Ennek eredményeképpen keletkezik egy állományt, amelyet <em>biztonságos eszközökkel</em> át kell másolni vagy át kell mozgatni az egyes Kerberos kliensek <span class=filename>/etc</span> könyvtárába. Ennek az állománynak egyaránt jelent kell lennie a szerveren és a kliensen is, nélküle a Kerberos mûködésképtelen.</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># ext_srvtab grunt</span>
Enter Kerberos master key:

Current Kerberos master key version is 1.

Master key entered. BEWARE!
Generating <span class=s1>&#39;grunt-new-srvtab&#39;</span>....</code></pre></div></div><div class=paragraph><p>Ez a parancs most létrehozott egy ideiglenes állományt, amit át kell nevezni az <span class=filename>srvtab</span> névre, hogy megtalálhassák a szerverek. Az eredeti rendszeren a <a href="https://man.freebsd.org/cgi/man.cgi?query=mv&amp;sektion=1&amp;format=html">mv(1)</a> paranccsal tudjuk a helyére rakni:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># mv grunt-new-srvtab srvtab</span></code></pre></div></div><div class=paragraph><p>Ha egy kliensnek szánjuk az állományt és a hálozatunkat nem tekinthetjük biztonságosnak, akkor a <span class=filename>kliens-new-srvtab</span> állományt másoljuk egy mozgatható adathordozóra és megbízható módon jutassuk el. Ne felejtsük el az állományt <span class=filename>srvtab</span> néven átrakni a kliens <span class=filename>/etc</span> könyvtárába és az engedélyeit 600-ra állítani:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># mv grumble-new-srvtab srvtab</span>
<span class=c># chmod 600 srvtab</span></code></pre></div></div></div><div class=sect3><h4 id=_az_adatbázis_feltöltése>14.7.5. Az adatbázis feltöltése<a class=anchor href=#_az_adatbázis_feltöltése></a></h4><div class=paragraph><p>Ezt követõen rögzítenünk kell néhány felhasználót is adatbázisban. Elõször is hozzunk létre egy bejegyzést a <code>janos</code> nevû felhasználónak. Ezt a <code>kdb_edit</code> parancs kiadásával tesszük meg:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># kdb_edit</span>
Opening database...

Enter Kerberos master key:

Current Kerberos master key version is 1.

Master key entered.  BEWARE!
Previous or default values are <span class=k>in</span> <span class=o>[</span>brackets] ,
enter <span class=k>return </span>to leave the same, or new value.

Principal name: janos
Instance:

&lt;Not found&gt;, Create <span class=o>[</span>y] ? y

Principal: janos, Instance: , kdc_key_ver: 1
New Password:                &lt;<span class=nt>----</span> adjunk meg egy biztonságos jelszót
Verifying password

New Password:                &lt;<span class=nt>----</span> itt ismét adjuk meg a jelszót
Principal<span class=s1>&#39;s new key version = 1
Expiration date (enter yyyy-mm-dd) [ 2000-01-01 ] ?
Max ticket lifetime (*5 minutes) [ 255 ] ?
Attributes [ 0 ] ?
Edit O.K.
Principal name:		   &lt;---- ha nem írunk be semmit, akkor kilép</span></code></pre></div></div></div><div class=sect3><h4 id=_próbáljuk_ki>14.7.6. Próbáljuk ki<a class=anchor href=#_próbáljuk_ki></a></h4><div class=paragraph><p>Elsõként a Kerberos démonait kell beindítanunk. Ezzel kapcsolatban megjegyeznénk, hogy ha ehhez megfelelõen átírtuk az <span class=filename>/etc/rc.conf</span> állományunkat, akkor ez az újraindítással együtt magától lezajlik. Ezt csak a Kerberos szerveren kell megcsinálni. A Kerberos kliensei maguktól összeszedik a mûködésükhöz szükséges adatokat az <span class=filename>/etc/kerberosIV</span> könyvtárból.</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># kerberos &amp;</span>
Kerberos server starting
Sleep forever on error
Log file is /var/log/kerberos.log
Current Kerberos master key version is 1.

Master key entered. BEWARE!

Current Kerberos master key version is 1
Local realm: EXAMPLE.COM
<span class=c># kadmind -n &amp;</span>
KADM Server KADM0.0A initializing
Please <span class=k>do </span>not use <span class=s1>&#39;kill -9&#39;</span> to <span class=nb>kill </span>this job, use a
regular <span class=nb>kill </span>instead

Current Kerberos master key version is 1.

Master key entered.  BEWARE!</code></pre></div></div><div class=paragraph><p>A fenti figyelmeztetés fordítása:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>A program leállítására ne a <span class=s1>&#39;kill -9&#39;</span> parancsot, hanem a
normális <span class=nb>kill </span>parancsot használjuk</code></pre></div></div><div class=paragraph><p>Ezután a <code>kinit</code> parancs használatával próbáljunk meg az elõbb létrehozott <code>janos</code> azonosítónak kérni egy jegyet:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>% kinit janos
MIT Project Athena <span class=o>(</span>grunt.example.com<span class=o>)</span>
Kerberos Initialization <span class=k>for</span> <span class=s2>&#34;janos&#34;</span>
Password:</code></pre></div></div><div class=paragraph><p>A <code>klist</code> paranccsal most próbáljuk meg kilistázni a tokeneket és így ellenõrizni, hogy valóban rendelkezünk velük:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>% klist
Ticket file:    /tmp/tkt245
Principal:      janos@EXAMPLE.COM

  Issued           Expires          Principal
Apr 30 11:23:22  Apr 30 19:23:22  krbtgt.EXAMPLE.COM@EXAMPLE.COM</code></pre></div></div><div class=paragraph><p>Ezután a <a href="https://man.freebsd.org/cgi/man.cgi?query=passwd&amp;sektion=1&amp;format=html">passwd(1)</a> használatával próbáljuk meg megváltoztatni a jelszavunkat. Ezzel tudjuk ellenõrizni, hogy a kpasswd démon hozzáfér a Kerberos adatbázisához:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>% passwd
realm EXAMPLE.COM
Old password <span class=k>for </span>janos:
New Password <span class=k>for </span>janos:
Verifying password
New Password <span class=k>for </span>janos:
Password changed.</code></pre></div></div></div><div class=sect3><h4 id=_adminisztrátori_jogosultságok_felvétele>14.7.7. Adminisztrátori jogosultságok felvétele<a class=anchor href=#_adminisztrátori_jogosultságok_felvétele></a></h4><div class=paragraph><p>A Kerberos lehetõvé teszi, hogy <em>mindegyik</em> olyan felhasználónak, akinek rendszergazdai jogokra lenne szüksége, a <a href="https://man.freebsd.org/cgi/man.cgi?query=su&amp;sektion=1&amp;format=html">su(1)</a> eléréséhez <em>külön</em> meg tudjunk adni egy jelszót. Most már tudunk mondani egy olyan azonosítót is, amely jogosult a <a href="https://man.freebsd.org/cgi/man.cgi?query=su&amp;sektion=1&amp;format=html">su(1)</a> használatával <code>root</code> jogokat szerezni. Ezt úgy tudjuk megoldani, ha az adott szereplõhöz társítunk egy <code>root</code> példányt. A <code>kdb_edit</code> használatával készíteni tudunk egy <code>janos.root</code> bejegyzést a Kerberos adatbázisában:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># kdb_edit</span>
Opening database...

Enter Kerberos master key:

Current Kerberos master key version is 1.

Master key entered.  BEWARE!
Previous or default values are <span class=k>in</span> <span class=o>[</span>brackets] ,
enter <span class=k>return </span>to leave the same, or new value.

Principal name: janos
Instance: root

&lt;Not found&gt;, Create <span class=o>[</span>y] ? y

Principal: janos, Instance: root, kdc_key_ver: 1
New Password:                    &lt;<span class=nt>----</span> ide csak egy BIZTONSÁGOS jelszót adjuk meg!
Verifying password

New Password:    	 	 &lt;<span class=nt>----</span> adjuk meg ismét a jelszót

Principal<span class=s1>&#39;s new key version = 1
Expiration date (enter yyyy-mm-dd) [ 2000-01-01 ] ?
Max ticket lifetime (*5 minutes) [ 255 ] ? 12 &lt;--- ne állítsuk nagyon hosszúra!
Attributes [ 0 ] ?
Edit O.K.
Principal name:		         &lt;---- ha nem adunk meg semmit, akkor kilép</span></code></pre></div></div><div class=paragraph><p>Ezt követõen úgy tudunk megbizonyosodni a mûködésérõl, hogy megpróbálunk neki tokeneket szerezni:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># kinit janos.root</span>
MIT Project Athena <span class=o>(</span>grunt.example.com<span class=o>)</span>
Kerberos Initialization <span class=k>for</span> <span class=s2>&#34;janos.root&#34;</span>
Password:</code></pre></div></div><div class=paragraph><p>Most rakjuk bele a felhasználót a <code>root</code><span class=filename>.klogin</span> állományába:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># cat /root/.klogin</span>
janos.root@EXAMPLE.COM</code></pre></div></div><div class=paragraph><p>Ezután próbáljunk meg kiadni a <a href="https://man.freebsd.org/cgi/man.cgi?query=su&amp;sektion=1&amp;format=html">su(1)</a> parancsát:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>% su
Password:</code></pre></div></div><div class=paragraph><p>Nézzük meg milyen tokenjeink is vannak:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># klist</span>
Ticket file:	/tmp/tkt_root_245
Principal:      janos.root@EXAMPLE.COM

  Issued           Expires          Principal
May  2 20:43:12  May  3 04:43:12  krbtgt.EXAMPLE.COM@EXAMPLE.COM</code></pre></div></div></div><div class=sect3><h4 id=_más_parancsok_használata>14.7.8. Más parancsok használata<a class=anchor href=#_más_parancsok_használata></a></h4><div class=paragraph><p>Az iménti példában létrehoztunk egy <code>janos</code> nevû szereplõt, amihez a <code>root</code> egy példányát rendeltük. Ez egy olyan felhasználón alapján történt, akinek a neve megegyezik a hozzá tartozó szereplõvel, ami a Kerberosban alapértelmezés. Amennyiben a szükséges megjegyzések megtalálhatóak a <code>root</code> könyvtárában levõ <span class=filename>.klogin</span> állományban, akkor a <code>felhasználó.root</code> formátumú <code>szereplõ.példány</code> azonosító megengedi a <code>felhasználó</code> számára, hogy végrehajtsa a <a href="https://man.freebsd.org/cgi/man.cgi?query=su&amp;sektion=1&amp;format=html">su(1)</a> parancsot.</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># cat /root/.klogin</span>
janos.root@EXAMPLE.COM</code></pre></div></div><div class=paragraph><p>Ehhez hasonlóan, ha a felhasználó saját könyvtárában megtalálható egy ilyen állomány:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>% <span class=nb>cat</span> ~/.klogin
janos@EXAMPLE.COM
jozsef@EXAMPLE.COM</code></pre></div></div><div class=paragraph><p>Ezzel a konfigurációval bárki, aki <code>janos</code> felhasználóként vagy <code>jozsef</code> felhasználóként (a <code>kinit</code> parancson keresztül) hitelesítette magát <code>EXAMPLE.COM</code> övezetbõl, ezen a rendszeren (<code>grunt</code>) bejelentkezhet a <code>janos</code> nevû felhasználóként vagy hozzáférhet az állományaihoz az <a href="https://man.freebsd.org/cgi/man.cgi?query=rlogin&amp;sektion=1&amp;format=html">rlogin(1)</a>, <a href="https://man.freebsd.org/cgi/man.cgi?query=rsh&amp;sektion=1&amp;format=html">rsh(1)</a> vagy <a href="https://man.freebsd.org/cgi/man.cgi?query=rcp&amp;sektion=1&amp;format=html">rcp(1)</a> használatával.</p></div><div class=paragraph><p>Például <code>janos</code> most egy másik Kerberost használó rendszerre jelentkezik be:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>% kinit
MIT Project Athena <span class=o>(</span>grunt.example.com<span class=o>)</span>
Password:
% rlogin grunt
Last login: Mon May  1 21:14:47 from grumble
Copyright <span class=o>(</span>c<span class=o>)</span> 1980, 1983, 1986, 1988, 1990, 1991, 1993, 1994
        The Regents of the University of California.   All rights reserved.

FreeBSD BUILT-19950429 <span class=o>(</span>GR386<span class=o>)</span> <span class=c>#0: Sat Apr 29 17:50:09 SAT 1995</span></code></pre></div></div><div class=paragraph><p>Vagy <code>jozsef</code> jelentkezik be ugyanazon a gépen <code>janos</code> hozzáférésével (a <code>janos</code> nevû felhasználónak a fentebb bemutatt <span class=filename>.klogin</span> állomány található a könyvtárában és a Kerberos üzemeltetéséért felelõs személy létrehozott egy <em>jozsef</em> nevû szereplõt egy null példánnyal):</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>% kinit
% rlogin grunt <span class=nt>-l</span> janos
MIT Project Athena <span class=o>(</span>grunt.example.com<span class=o>)</span>
Password:
Last login: Mon May  1 21:16:55 from grumble
Copyright <span class=o>(</span>c<span class=o>)</span> 1980, 1983, 1986, 1988, 1990, 1991, 1993, 1994
        The Regents of the University of California.   All rights reserved.
FreeBSD BUILT-19950429 <span class=o>(</span>GR386<span class=o>)</span> <span class=c>#0: Sat Apr 29 17:50:09 SAT 1995</span></code></pre></div></div></div></div><div class=sect2><h3 id=kerberos5>14.8. Kerberos5<a class=anchor href=#kerberos5></a></h3><div class=paragraph><p>A FreeBSD 5.1 után következõ mindegyik FreeBSD kiadás már csak a Kerberos5 támogatást tartalmaz. Ezért bennük csak a Kerberos5 található meg, és a beállítása sok szempontból hasonlít a KerberosIV beállításához. A most következõ információk csak és kizárólag a FreeBSD 5.0 kiadás után következõkben található Kerberos5 változatra vonatkoznak. A KerberosIV szolgáltatásait a felhasználók csomagként, a <a class=package href=https://cgit.freebsd.org/ports/tree/security/krb4/>security/krb4</a> porton keresztül érhetik el.</p></div><div class=paragraph><p>A Kerberos egy hálózati kiegészítõ rendszer/protokoll, amivel a felhasználók egy biztonságos szerveren keresztül képesek magukat azonosítani. A távoli bejelentkezések, távoli másolások, a rendszer belüli védett másolások valamint egyéb nagyon kockázatos feladatok, szolgáltatások biztonsága és felügyelete így jelentõs mértékben javítható.</p></div><div class=paragraph><p>A Kerberos úgy írható le, mint az személyazonosságok ellenõrzésére feljogosított rendszer. Vagy tekinthetjük egy megbízható külsõ megfigyelõ által végzett hitelesítési rendszernek is. A Kerberos csak egyetlen funkciót kínál fel - ez a felhasználók biztonságos hitelesítése a hálózaton. Viszont nem nyújt semmilyen felhatalmazási (mit csinálhatnak a felhasználók) vagy vizsgálati (mit csináltak végül a felhasználók) lehetõséget. Miután egy kliens és a szerver a Kerberos használatával azonosították egymást, az egymás közt folyó kommunikációjuk titkosításával képesek megõrzi az átáramló adatok sértetlenségét és lehallgathatatlanságát.</p></div><div class=paragraph><p>Ennek tükrében a Kerberos használata csak más olyan biztonsági módszerekkel együttesen javasolt, amelyek felhatalmazást és vizsgálati szolgáltatásokkal is rendelkeznek.</p></div><div class=paragraph><p>A most következõ utasítások arra igyekeznek útmutatást adni, hogy miként használjuk a FreeBSD-vel együtt terjesztett Kerberos verziót. Azonban a teljes leírást csak a témához tartozó man oldalak átolvasásával együtt kapjuk meg.</p></div><div class=paragraph><p>A Kerberos telepítésének bemutatásához az alábbi névtereket fogjuk használni:</p></div><div class=ulist><ul><li><p>A DNS tartomány ("zóna") az <code>example.org</code> lesz.</p></li><li><p>A Kerberos övezet az EXAMPLE.ORG lesz.</p></li></ul></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Kérjük, hogy még abban az esetben is valódi tartományneveket adjuk meg, amikor a Kerberos használatát csak a belsõ hálózaton tervezzük. Ezzel elkerülhetjük az egyes Kerberos övezetek együttmûködése során felmerülõ DNS problémákat.</p></div></td></tr></tbody></table></div><div class=sect3><h4 id=_a_kerberos_története>14.8.1. A Kerberos története<a class=anchor href=#_a_kerberos_története></a></h4><div class=paragraph><p>A Kerberost az MIT hozta létre a hálózati biztonsággal kapcsolatos problémák egyik megoldásaként. A Kerberos erõs titkosítást használ, ezért a kliensek képesek egy nem biztonságos hálózaton is azonosítani magukat a szerver felé (és fordítva).</p></div><div class=paragraph><p>A Kerberos egyaránt utal egy hálózati protokoll nevére és azokra programokra, amelyek implementálják (például Kerberos telnet). Az 5 a protokoll jelenlegi verziója, amit az RFC 1510 ír le.</p></div><div class=paragraph><p>A protokollnak számos szabad változata létezik, rengeteg típusú operációs rendszerre. A Massachusettsi Mûszaki Intézet (Massachusetts Institute of Technology, MIT), ahol a Kerberost eredetileg kifejlesztették, napjainkban is folytatja a saját Kerberos csomagjának fejlesztését. Többnyire az Egyesült Államokban használják titkosításra, mivel régebben az amerikai kiviteli korlátozások voltak rá érvényesek. Az MITKerberos változata portként érhetõ el (<a class=package href=https://cgit.freebsd.org/ports/tree/security/krb5/>security/krb5</a>). A Heimdal Kerberos egy másik 5 verziójú implementáció, amit a kiviteli korlátozások elkerülése érdekében határozottan az Egyesült Államokon kívül fejlesztettek ki (ezért gyakran megtalálhatjuk a különbözõ nem kereskedelmi UNIX® variánsokban). A Heimdal Kerberos terjesztés portként elérhetõ (<a class=package href=https://cgit.freebsd.org/ports/tree/security/heimdal/>security/heimdal</a>) és kisebb méretben a FreeBSD alaptelepítésének is része.</p></div><div class=paragraph><p>Mivel ezzel az írással a legtöbb felhasználót kívánjuk segíteni, ezért a következõ utasítások a FreeBSD telepítésében mellékelt Heimdal terjesztés használatát feltételezik.</p></div></div><div class=sect3><h4 id=_a_heimdal_kulcselosztójának_telepítése>14.8.2. A Heimdal kulcselosztójának telepítése<a class=anchor href=#_a_heimdal_kulcselosztójának_telepítése></a></h4><div class=paragraph><p>A kulcselosztó központ (Key Distribution Center, avagy KDC) az a centralizált hitelesítési szolgáltatás, amit a Kerberos nyújt - lényegében az a számítógép, amely Kerberos-jegyeket bocsájt ki. A KDC"megbízhatónak" tekinthetõ a Kerberos által kialakított övezetben levõ többi számítógép számára, ezért védelme kiemelten fontos.</p></div><div class=paragraph><p>Itt jegyeznénk meg, hogy habár a Kerberos szerver futtatása nagyon kevés számítógépes erõforrást igényel, ennek ellenére biztonsági szempontból egy külön számítógépet javasoljunk a kulcselosztó szerepének betöltéséhez.</p></div><div class=paragraph><p>Mielõtt nekifognánk a KDC konfigurálásának, ellenõrizzük, hogy az <span class=filename>/etc/rc.conf</span> tartalmazza a KDC mûködéséhez szükséges beállításokat (az elérési utakat természetesen a saját rendszerünk szerint állítsuk be):</p></div><div class="literalblock programlisting"><div class=content><pre>kerberos5_server_enable=&#34;YES&#34;
kadmind5_server_enable=&#34;YES&#34;</pre></div></div><div class=paragraph><p>A következõ lépésben vegyük szemügyre a Kerberos beállításait tartalmazó <span class=filename>/etc/krb5.conf</span> állományt:</p></div><div class="literalblock programlisting"><div class=content><pre>[libdefaults]
    default_realm = EXAMPLE.ORG
[realms]
    EXAMPLE.ORG = {
        kdc = kerberos.example.org
        admin_server = kerberos.example.org
    }
[domain_realm]
    .example.org = EXAMPLE.ORG</pre></div></div><div class=paragraph><p>Vegyük észre, hogy az itt szereplõ <span class=filename>/etc/krb5.conf</span> állomány szerint a kulcselosztónk teljes hálózati neve <code>kerberos.example.org</code>. Ha a kulcselosztónknak nem ez a neve, akkor a zónákat leíró állományba vegyünk még fel egy ilyen CNAME (álnév) bejegyzést.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Ha egy nagyobb hálózatban vagyunk, ahol a DNS szervert is megfelelõen beállították, akkor az iménti példa ennyire leszûkíthetõ:</p></div><div class="literalblock programlisting"><div class=content><pre>[libdefaults]
      default_realm = EXAMPLE.ORG</pre></div></div><div class=paragraph><p>Itt már a következõ sorokat hozzáadták <code>example.org</code> zónát leíró állományhoz:</p></div><div class="literalblock programlisting"><div class=content><pre>_kerberos._udp      IN  SRV     01 00 88 kerberos.example.org.
_kerberos._tcp      IN  SRV     01 00 88 kerberos.example.org.
_kpasswd._udp       IN  SRV     01 00 464 kerberos.example.org.
_kerberos-adm._tcp  IN  SRV     01 00 749 kerberos.example.org.
_kerberos           IN  TXT     EXAMPLE.ORG</pre></div></div></td></tr></tbody></table></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>A kliensek csak akkor lesznek képesek elérni a Kerberos szolgáltatásait, ha vagy <em>kötelezõ jelleggel</em> megadunk egy teljesen beállított <span class=filename>/etc/krb5.conf</span> állományt, vagy egy minimális <span class=filename>/etc/krb5.conf</span> állományt <em>és</em> egy helyesen beállított DNS szervert használunk.</p></div></td></tr></tbody></table></div><div class=paragraph><p>Ezután létrehozzuk a Kerberos adatbázisát. Ez az adatbázis tartalmazza az összes szereplõ kulcsát a mesterkulcssal titkosítva. Erre a jelszóra nem kell feltétlenül emlékeznünk, mivel ez egy állományban tárolódik (<span class=filename>/var/heimdal/m-key</span>). A mesterkulcsot a <code>kstash</code> parancs kiadásával és egy jelszó megadásával tudjuk létrehozni.</p></div><div class=paragraph><p>Ahogy a mesterkulcs elkészült, a <code>kadmin</code> parancs <code>-l</code> (mint "lokális", azaz helyi) opciójával inicializálni tudjuk az adatbázist. Ez az opció arra utasítja a <code>kadmin</code> programot, hogy ne a <code>kadmind</code> hálózati szolgáltatást használja, hanem közvetlenül az adatbázis állományait módosítsa. Ezzel oldható meg az adatbázis kezdeti létrehozásának problémája. Miután megkaptuk a <code>kadmin</code> parancssorát, az övezetünkhöz tartozó adatbázis inicializálásához adjuk ki az <code>init</code> parancsot.</p></div><div class=paragraph><p>Végül, még mindig a <code>kadmin</code> parancssorát használva, az <code>add</code> paranccsal hozzuk létre az elsõ szereplõnket. Egyelõre érjük be az alapértelmezett értékekkel, a <code>modify</code> paranccsal késõbb úgyis meg tudjuk változtatni ezeket. Hozzátesszük, hogy itt a <code>?</code> parancs segítségével bármikor lekérhetjük az opciók ismertetését.</p></div><div class=paragraph><p>Példa egy adatbázis létrehozására:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># kstash</span>
Master key: xxxxxxxx
Verifying password - Master key: xxxxxxxx

<span class=c># kadmin -l</span>
kadmin&gt; init EXAMPLE.ORG
Realm max ticket life <span class=o>[</span>unlimited]:
kadmin&gt; add tillman
Max ticket life <span class=o>[</span>unlimited]:
Max renewable life <span class=o>[</span>unlimited]:
Attributes <span class=o>[]</span>:
Password: xxxxxxxx
Verifying password - Password: xxxxxxxx</code></pre></div></div><div class=paragraph><p>Most már ideje elindítani a KDC szolgáltatásait. Ezeket az <code>/etc/rc.d/kerberos start</code> és <code>/etc/rc.d/kadmind start</code> parancsok kiadásával tudjuk felhozni. Megjegyezzük, hogy most még semmilyen kerberizált démont nem kell elindítanunk. Ellenben igyekezzünk ellenõrizni a KDC mûködõképességét azzal, hogy KDC parancssorából kérünk egy jegyet a frissen hozzáadott szereplõnknek (felhasználónknak) és kilistázzuk:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>% kinit tillman
tillman@EXAMPLE.ORG<span class=s1>&#39;s Password:

% klist
Credentials cache: FILE:/tmp/krb5cc_500
	Principal: tillman@EXAMPLE.ORG

  Issued           Expires          Principal
Aug 27 15:37:58  Aug 28 01:37:58  krbtgt/EXAMPLE.ORG@EXAMPLE.ORG</span></code></pre></div></div><div class=paragraph><p>Miután végeztünk, nyugodtan törölhetjük a jegyet:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>% kdestroy</code></pre></div></div></div><div class=sect3><h4 id=_szerverek_kerberizálása_a_heimdal_használatával>14.8.3. Szerverek kerberizálása a Heimdal használatával<a class=anchor href=#_szerverek_kerberizálása_a_heimdal_használatával></a></h4><div class=paragraph><p>Ehhez elõször is szükségünk lesz a Kerberos konfigurációs állományának, az <span class=filename>/etc/krb5.conf</span> másolatára. Ezt úgy tudjuk megtenni, ha egyszerûen átmásoljuk a kulcselosztóról az egyik kliensre valamilyen megbízható módon (vagy az <a href="https://man.freebsd.org/cgi/man.cgi?query=scp&amp;sektion=1&amp;format=html">scp(1)</a> programhoz hasonló hálózati segédprogramok, vagy például fizikailag egy floppy lemez használatával).</p></div><div class=paragraph><p>Ezután szükségünk lesz egy <span class=filename>/etc/krb5.keytab</span> nevû állományra. Ez az alapvetõ különbség a kerberizált démonokat felkínáló szerver és egy munkaállomás közt - a szervernek rendelkeznie kell egy <span class=filename>keytab</span> állománnyal. Ez az állomány tartalmazza a szerver kulcsát, amivel így a kulcselosztóval kölcsönösen azonosítani tudják egymást. Ezt a szerverre biztonságosan kell eljuttatnunk, mivel ennek napvilágra kerülésével a szerver védelme komoly veszélybe kerül. Tehát, ha egy titkosítás nélküli csatornán, például FTP-n keresztül visszük át, akkor kifejezetten rossz ötlet.</p></div><div class=paragraph><p>A szerverre általában a <code>kadmin</code> program használatával érdemes átvinni a <span class=filename>keytab</span> állományt. Ez azért is hasznos, mert ehhez a <code>kadmin</code> segítségével létre kell hoznunk a befogadó szereplõt is (a kulcselosztó a <span class=filename>krb5.keytab</span> állomány végén).</p></div><div class=paragraph><p>Vegyük észre, hogy már kaptunk egy jegyet és ezzel a jeggyel jogosultaknak kell lennünk a <span class=filename>kadmind.acl</span> állomány <code>kadmin</code> felület használatára. A hozzáférést vezérlõ listák (ACL-ek) tervezésével kapcsolatban olvassuk el Heimdal info oldalán található "Remote administration" címû szakaszt (<code>info heimdal</code>). Amennyiben nem kívánjuk engedélyezni a <code>kadmin</code> távoli elérését, egyszerûen csak csatlakozzunk valamilyen biztonságos módon (helyi konzolon, <a href="https://man.freebsd.org/cgi/man.cgi?query=ssh&amp;sektion=1&amp;format=html">ssh(1)</a> vagy egy kerberizált <a href="https://man.freebsd.org/cgi/man.cgi?query=telnet&amp;sektion=1&amp;format=html">telnet(1)</a> használatával) a kulcselosztóhoz, és a <code>kadmin -l</code> paranccsal végezzük el helyben az adminisztrációt.</p></div><div class=paragraph><p>Miután telepítettük az <span class=filename>/etc/krb5.conf</span> állományt, a Kerberos szerverrõl el tudjuk érni a <code>kadmin</code> felületét. Az <code>add --random-key</code> paranccsal most már hozzáadhatjuk a szerver befogadó szereplõjét és az <code>ext</code> paranccsal ki tudjuk vonni a szerver befogadó szereplõjét a saját keytab állományából. Például:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># kadmin</span>
kadmin&gt; add <span class=nt>--random-key</span> host/myserver.example.org
Max ticket life <span class=o>[</span>unlimited]:
Max renewable life <span class=o>[</span>unlimited]:
Attributes <span class=o>[]</span>:
kadmin&gt; ext host/myserver.example.org
kadmin&gt; <span class=nb>exit</span></code></pre></div></div><div class=paragraph><p>Itt jegyeznénk meg, hogy az <code>ext</code> parancs (az "extract" rövdítése) a kivont kulcsot alapértelmezés szerint az <span class=filename>/etc/krb5.keytab</span> állományba menti ki.</p></div><div class=paragraph><p>Ha a kulcselosztón nem fut a <code>kadmind</code> szolgáltatás (valószínûleg biztonsági okokból) és ezért távolról nem tudjuk elérni a <code>kadmin</code> felületét, akkor így tudjuk közvetlenül hozzáadni a befogadó szereplõt (<code>host/myserver.EXAMPLE.ORG</code>), majd kivonatolni azt egy ideiglenes állományba (elkerülve az <span class=filename>/etc/krb5.keytab</span> felülírását):</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># kadmin</span>
kadmin&gt; ext <span class=nt>--keytab</span><span class=o>=</span>/tmp/example.keytab host/myserver.example.org
kadmin&gt; <span class=nb>exit</span></code></pre></div></div><div class=paragraph><p>Ezután valamilyen biztonságos eszközzel (például <code>scp</code> vagy floppy használatával) át tudjuk másolni keytab állományt a szerverre. A kulcselosztón levõ keytab felülírását elkerülendõ, ne feledkezzünk el egy megfelelõ név megadásáról sem.</p></div><div class=paragraph><p>Ezen a ponton már a szerver képes felvenni a kapcsolatot a kulcselosztóval (a <span class=filename>krb5.conf</span> állomány miatt) és bizonyítani a személyazonosságát (a <span class=filename>krb5.keytab</span> állomány miatt). Így tehát készen állunk a szolgáltatások kerberizálására. Ebben a példában most a <code>telnet</code> szolgáltatást vesszük célba úgy, hogy elõször az <span class=filename>/etc/inetd.conf</span> állományba berakjuk az alábbi sort, majd újraindítjuk az <a href="https://man.freebsd.org/cgi/man.cgi?query=inetd&amp;sektion=8&amp;format=html">inetd(8)</a> szolgáltatást az <code>/etc/rc.d/inetd restart</code> paranccsal:</p></div><div class="literalblock programlisting"><div class=content><pre>telnet    stream  tcp     nowait  root    /usr/libexec/telnetd  telnetd -a user</pre></div></div><div class=paragraph><p>Itt az a legfontosabb, hogy az <code>-a</code> (mint authentication, azaz hitelesítés) paramétert a "user" beállítással adjuk meg. A <a href="https://man.freebsd.org/cgi/man.cgi?query=telnetd&amp;sektion=8&amp;format=html">telnetd(8)</a> man oldalán olvashatunk ennek pontos részleteirõl.</p></div></div><div class=sect3><h4 id=_kliensek_kerberizálása_a_heimdal_használatával>14.8.4. Kliensek kerberizálása a Heimdal használatával<a class=anchor href=#_kliensek_kerberizálása_a_heimdal_használatával></a></h4><div class=paragraph><p>A kliensek beállítása szinte majdnem gyerekjáték. A Kerberos beállításához egyedül az <span class=filename>/etc/krb5.conf</span> állományra lesz szükségünk. Valamilyen biztonságos eszközzel másoljuk át a kulcselosztóról a kliensre.</p></div><div class=paragraph><p>Úgy tudjuk letesztelni klienst, ha megpróbáljuk róla kiadni a <code>kinit</code>, <code>klist</code> és <code>kdestroy</code> parancsokat a fentebb létrehozott szereplõ jegyének megszerzéséhez, lekérdezéséhez és megsemmisítéséhez. A Kerberos használatával megpróbálkozhatunk csatlakozni valamelyik kerberizált szerverre is, ha viszont ez nem mûködik még egy jegy megszerzése után sem, akkor a gond többnyire a szerverrel van, nem pedig a klienssel vagy a kulcselosztóval.</p></div><div class=paragraph><p>Amikor egy <code>telnet</code> vagy egy hozzá hasonló alkalmazást tesztelünk, egy csomaglehallgató (mint amilyen például a <a href="https://man.freebsd.org/cgi/man.cgi?query=tcpdump&amp;sektion=1&amp;format=html">tcpdump(1)</a>) elindításával gyõzödjünk meg róla, hogy a jelszavak ilyenkor titkosítva mennek át. Próbáljuk meg titkosítani a teljes kommunikációt a <code>telnet -x</code> paraméterével (hasonlóan az <code>ssh</code> parancshoz).</p></div><div class=paragraph><p>Alapból még számos más kiegészítõ Kerberos kliensalkalmazás is telepítõdik. Ezeken érezhetõ meg valójában az alaprendszerhez tartozó Heimdal változat "minimalitása": ebben a <code>telnet</code> az egyedüli kerberizált szolgáltatás.</p></div><div class=paragraph><p>A Heimdal port igyekszik pótolni a hiányzó klienseket a kerberizált <code>ftp</code>, <code>rsh</code>, <code>rcp</code>, <code>rlogin</code> és néhány kevéséb ismert program telepítésével. Az MIT változat portja szintén tartalmazza a Kerberos kliensek teljes kelléktárát.</p></div></div><div class=sect3><h4 id=_a_felhasználók_konfigurációs_állományai_a_k5login_és_a_k5users>14.8.5. A felhasználók konfigurációs állományai: a <span class=filename>.k5login</span> és a <span class=filename>.k5users</span><a class=anchor href=#_a_felhasználók_konfigurációs_állományai_a_k5login_és_a_k5users></a></h4><div class=paragraph><p>Általában az övezetben található felhasználók mindegyikéhez tartozik egy Kerberos-szereplõ (mint például a <code>tillman@EXAMPLE.ORG</code>), ami a felhasználó helyi hozzáférésére mutat (mint például a <code>tillman</code> nevû helyi hozzáférés). A <code>telnet</code> és a hozzá hasonló kliensalkalmazások általában nem igényelnek felhasználót vagy szereplõt.</p></div><div class=paragraph><p>Elõfordulhat azonban, hogy valaki olyan szeretné elérni egy helyi felhasználó hozzáférését, aki nem rendelkezik a hozzá tartozó Kerberos-szereplõvel. Például a <code>tillman@EXAMPLE.ORG</code> nevû felhasználó el szeretné érni a helyi számítógépen levõ <code>webdevelopers</code> hozzáférést. Más szereplõk is elérhetik a helyi hozzáféréseket.</p></div><div class=paragraph><p>A probléma megoldásához a felhasználók könyvtárában található <span class=filename>.k5login</span> és a <span class=filename>.k5users</span> állományok használhatóak a <span class=filename>.host</span> és <span class=filename>.rhosts</span> állományok kombinációjához hasonlóan. Például a <span class=filename>.k5login</span> így néz ki:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>tillman@example.org
jdoe@example.org</code></pre></div></div><div class=paragraph><p>Ezt a <code>webdevelopers</code> nevû helyi felhasználó könyvtárában kell elhelyeznünk, így a felsorolt szereplõt megosztott jelszó használata nélkül képesek elérni a hozzáférést.</p></div><div class=paragraph><p>Az említett parancsok man oldalának elolvasása ajánlott. Megjegyezzük, hogy a <code>ksu</code> man oldal foglalkozik a <span class=filename>.k5users</span> állománnyal.</p></div></div><div class=sect3><h4 id=_tippek_trükkök_a_kerberos_használatáról_és_hibaelhárítás>14.8.6. Tippek, trükkök a Kerberos használatáról és hibaelhárítás<a class=anchor href=#_tippek_trükkök_a_kerberos_használatáról_és_hibaelhárítás></a></h4><div class=ulist><ul><li><p>Akár a Kerberos Heimdal vagy az MIT változatát használjuk, ne felejtsük úgy beállítani a <code>PATH</code> környezeti változóban felsorolt elérési utakat, hogy a kliensalkalmazások kerberizált változatai a rendszerben használatos verziók elé kerüljenek.</p></li><li><p>Az övezetben minden számítógép órája ugyanúgy jár? Ha nem, akkor a hitelesítés csõdöt mondhat. A <a href=./#network-ntp>Az órák egyeztetése az NTP használatával</a>ból tudhatjuk meg hogyan szinkronizáljunk órákat az NTP segítségével.</p></li><li><p>Az MIT és a Heimdal verziók a <code>kadmin</code> kivételével remekül megvannak egymással, mivel az általa használt protokollt még nem szabványosították.</p></li><li><p>Ha megváltoztatjuk a gépünk hálózati nevét, akkor a ugyanígy a <code>host/</code> szereplõnket is meg kell változtatni és frissíteni a keytab állományunkat. Ez olyan speciális keytab bejegyzésekre is vonatkozik, mint például az Apache <a class=package href=https://cgit.freebsd.org/ports/tree/www/mod_auth_kerb/>www/mod_auth_kerb</a> moduljához tartozó <code>www/</code> szereplõ.</p></li><li><p>Az övezetünkben levõ összes számítógépnek (mind a két irányba) feloldható DNS névvel kell rendelkeznie (vagy legalább egy <span class=filename>/etc/hosts</span> állománnyal). Erre a CNAME rekord megfelelõ, de az A és PTR rekordoknak mindenképpen rendben kell lenniük. Az ilyenkor keletkezõ hibaüzenet nem éppen fogja meg a lényeget: <code>Kerberos5 refuses authentication because Read req failed: Key table entry not found</code>.</p></li><li><p>A kulcselosztó számára kliensként viselkedõ bizonyos operációs rendszerek nem állítják be megfelelõen a <code>ksu</code> engedélyeit, ezért nem lehet <code>root</code> jogokkal futtatni. Ezért a <code>ksu</code> parancs nem fog mûködni, ami alapvetõen nem egy rossz ötlet, de idegesítõ. Ez nem a kulcselosztó hibája.</p></li><li><p>Ha a KerberosMIT változatát használjuk és a meg akarjuk hosszabbítani a szereplõknek kiadott jegyek élettartamát az alapértelmezett tíz óráról, akkor a <code>kadmin</code> felületén a <code>modify_principal</code> paranccsal tudjuk megváltoztatni mind a kérdéses szereplõ, mind pedig a <code>krbtgt</code> jegyeinek élettartamának maximumát. Ezt követõen a szereplõ a <code>kinit -l</code> opciójával tud egy nagyobb élettartammal rendelkezõ jegyet kérni.</p></li></ul></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Amikor egy kulcselosztóval kapcsolatos hibát próbálunk felderíteni a csomagok lehallgatásával, és a munkaállomásunkról kiadjuk a <code>kinit</code> parancsot, akkor arra lehetünk figyelmesek, hogy a TGT már egybõl a <code>kinit</code> indításakor átküldésre kerül - még mielõtt egyáltalán megadtuk volna a jelszavunkat! Ezt azzal lehet magyarázni, hogy a Kerberos szerver bármilyen hitelesítetlen kérésre elküld egy TGT-t (Jegyadó jegy, azaz Ticket Granting Ticket). Azonban mindegyik ilyen TGT a felhasználó jelszavából származtatott kulccsal titkosítódik. Ezért amit a felhasználó jelszóként megad, nem megy el a kulcselosztónak, hanem vele a <code>kinit</code> a már megkapott TGT-t kódolja ki. Amennyiben a visszakódolás egy érvényes idõbélyeggel rendelkezõ, használható jegyet eredményez, akkor a felhasználó érvényes Kerberos hitelesítést szerez. Ez a hitelesítés magában foglal egy kulcsot, amellyel a késõbbiekben a Kerberos szerverekkel tudjuk felvenni biztonságos módon a kapcsolatot, és rajta kívül egy újabb jegyadó jegyet, amelyet a Kerberos szerver a saját kulcsával titkosított. A titkosítás második vonala a felhasználó számára ismeretlen, de segítségével a Kerberos szerer képes ellenõrizni az egyes jegyadó jegyek hitelességét.</p></div></td></tr></tbody></table></div><div class=ulist><ul><li><p>Ha a jegyeket hosszabb (például egyhetes) élettartammal akarjuk használni és a jegyeket tároló géphez OpenSSH segítségével csatlakozunk, akkor mindenképpen ellenõrizzük, hogy az <span class=filename>sshd_config</span> állományban a Kerberos <code>TicketCleanup</code> beállításának értéke <code>no</code>, máskülönben a kijelentkezés után automatikusan törlõdnek a jegyeink.</p></li><li><p>Ne hagyjuk figyelmen kívül azt sem, hogy a befogadó szereplõk is rendelkezhetnek nagyobb élettartamú jegyekkel. Ha a felhasználónkhoz tartozó szereplõ jegye például egy hét alatt évül el, de a számítógép, amire bejelentkezük, csupán kilenc óráig tartja életben ezeket, akkor a jegyeket tároló gyorsítótárunkban hamarabb elévül a hozzá tartozó jegy, ami miatt pedig hibák keletkeznek.</p></li><li><p>Ha a rossz jelszavak használata ellen beállítjuk a <span class=filename>krb5.dic</span> állományt (errõl a <code>kadmind</code> man oldalán találunk egy rövid leírást), akkor nem szabad elfelejteni, hogy ez csak olyan szereplõkre vonatkozik, akiknek a jelszavára is állítottunk be szabályozásokat. A <span class=filename>krb5.dict</span> állományok felépítési nem bonyolult: minden sorban egyetlen karakterlánc szerepel. Érdemes lehet például létrehozni ezen a néven egy szimbolikus linket a <span class=filename>/usr/shared/dict/words</span> állományra.</p></li></ul></div></div><div class=sect3><h4 id=_eltérések_az_mit_porttól>14.8.7. Eltérések az MIT porttól<a class=anchor href=#_eltérések_az_mit_porttól></a></h4><div class=paragraph><p>A Heimdal és az MIT változatok közti egyik legnagyobb eltérés a <code>kadmin</code> programmal kapcsolatban van, ami eltérõ (de egyébként ekivalens) parancskészlettel rendelkezik és más protokollt használ. Ennek komoly következménye, hogy ha az MIT-féle kulcselosztót használjuk, akkor azt a Heimdal <code>kadmin</code> felületével nem tudjuk távolról adminisztrálni (és vica versa).</p></div><div class=paragraph><p>A kliensalkalmazások paraméterezése is eltérhet ugyanazon feladatoknál. Ezért velük kapcsolatban az MITKerberos honlapja (<a href=http://web.mit.edu/Kerberos/www/>http://web.mit.edu/Kerberos/www/</a>) a mérvadó. Vigyázzunk az elérési utakkal: az MIT port magát alapértelmezés szerint a <span class=filename>/usr/local</span> könyvtárba telepíti, ezért az általuk kiváltani kívánt "normális" rendszerprogramokat esetleg hamarabb találja meg a rendszer, ha nem jól állítottuk be a <code>PATH</code> környezeti változónkat.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Ha nem értjük, hogy miért mûködnek olyan furcsán a <code>telnetd</code> és a <code>klogind</code> által kezelt bejelentkezések, akkor olvassuk el a FreeBSD <a class=package href=https://cgit.freebsd.org/ports/tree/security/krb5/>security/krb5</a> portjával települõ MIT változat <span class=filename>/usr/local/shared/doc/krb5/README.FreeBSD</span> állományt (angolul). Az a legfontosabb, hogy a <code>incorrect permissions on cache file</code> hiba eltüntetéséhez a <code>login.krb5</code> binárist kell használnunk, így a továbbított jogosultságoknak megfelelõen át tudja állítani a tulajdonost.</p></div></td></tr></tbody></table></div><div class=paragraph><p>Az <span class=filename>rc.conf</span> állományt is módosítani kell a következõ beállítás kialakításához:</p></div><div class="literalblock programlisting"><div class=content><pre>kerberos5_server=&#34;/usr/local/sbin/krb5kdc&#34;
kadmind5_server=&#34;/usr/local/sbin/kadmind&#34;
kerberos5_server_enable=&#34;YES&#34;
kadmind5_server_enable=&#34;YES&#34;</pre></div></div><div class=paragraph><p>Erre azért van szükség, mert a KerberosMIT változata a <span class=filename>/usr/local</span> könyvtáron belülre telepíti fel a hozzá tartozó alkalmazásokat.</p></div></div><div class=sect3><h4 id=_a_kerberosban_talált_korlátozások_enyhítése>14.8.8. A Kerberosban talált korlátozások enyhítése<a class=anchor href=#_a_kerberosban_talált_korlátozások_enyhítése></a></h4><div class=sect4><h5 id=_a_kerberos_a_mindent_vagy_semmit_megközelítést_követi>14.8.8.1. A Kerberos a "mindent vagy semmit" megközelítést követi<a class=anchor href=#_a_kerberos_a_mindent_vagy_semmit_megközelítést_követi></a></h5><div class=paragraph><p>A hálózaton minden szolgáltatást módosítanunk kell ahhoz, hogy együtt tudjanak mûködni a Kerberosszal (vagy valamilyen más módon védenünk kell ezeket a támadások ellen), különben a felhasználók jogait el lehet lopni vagy újra fel lehet használni. Erre jó példa lehet az összes távoli parancssoros elérés (például az <code>rsh</code> valamint a <code>telnet</code>) kerberizálása, de a jelszavakat titkosítatlanul küldõ POP3 levelezõ szerver kihagyása.</p></div></div><div class=sect4><h5 id=_a_kerberos_az_egyfelhasználós_munkaállomások_számára_készült>14.8.8.2. A Kerberos az egyfelhasználós munkaállomások számára készült<a class=anchor href=#_a_kerberos_az_egyfelhasználós_munkaállomások_számára_készült></a></h5><div class=paragraph><p>Többfelhasználós környezetben a Kerberos már nem annyira biztonságos. Ez azért mondható el, mert a jegyeket a mindenki által olvasható <span class=filename>/tmp</span> könyvtárban tárolja. Ha az adott felhasználó számítógépét egyszerre több emberrel is megosztja (tehát többfelhasználós), akkor a felhasználó jegyeit egy másik felhasználó bármikor lemásolhatja (ellophatja).</p></div><div class=paragraph><p>Ezt a <code>-c</code> opció után megadott állománynévvel vagy (inkább) a <code>KRB5CCNAME</code> környezeti változó megfelelõ beállításával tudjuk áthidalni, habár ezt ritkán teszik is meg. Ha a felhasználók könyvtárában és a megfelelõ engedélyekkel tároljuk ezeket a jegyeket, akkor némileg visszaszoríthatjuk a probléma kockázatát.</p></div></div><div class=sect4><h5 id=_a_kulcselosztó_a_rendszer_legsebezhetõbb_pontja>14.8.8.3. A kulcselosztó a rendszer legsebezhetõbb pontja<a class=anchor href=#_a_kulcselosztó_a_rendszer_legsebezhetõbb_pontja></a></h5><div class=paragraph><p>A rendszer kialakításából fakadóan a kulcselosztónak legalább annyira megbízhatónak kell lennie, mint a rajta levõ központi jelszóadatbázisnak. A kulcselosztón semmilyen más szolgáltatás nem futhat és fizikailag is biztonságba kell helyezni. A kockázat nagy, mivel a Kerberos az összes jelszót ugyanazzal a kulcssal (a "mesterkulcssal") titkosítja, amelyet a kulcselosztó egy állományban tárol.</p></div><div class=paragraph><p>Széljegyzet gyanánt hozzátesszük, hogy a mesterkulcs elvesztése nem annyira rossz, mint azt elsõ gondolnánk. A mesterkulcsot csupán a véletlenszám-generátor inicializálásához használják a Kerberos adatbázisának titkosításakor. Amíg a kulcselosztóhoz nem tudnak illetéktelenek hozzáférni, addig nem tudnak sokat kezdeni a mesterkulccsal.</p></div><div class=paragraph><p>Mellesleg ha a kulcselosztó nem elérhetõ (talán pontosan egy DoS támadás vagy éppen hálózati problémák miatt), akkor a hitelesítés nem végezhetõ el, mivel így a hozzá szükséges hálózati szolgáltatások sem használhatóak. Ez remek eszköz egy DoS támadáshoz. Ezen több (egy központi és egy vagy több alárendelt) kulcselosztó telepítésével, valamint a másodlagos vagy tartalékként használt hitelesítési eszközök (a PAM erre tökéletes) körültekintõ megvalósításával enyhíthetünk.</p></div></div><div class=sect4><h5 id=_a_kerberos_hiányosságai>14.8.8.4. A Kerberos hiányosságai<a class=anchor href=#_a_kerberos_hiányosságai></a></h5><div class=paragraph><p>A Kerberos révén a felhasználók, számítógépek és szolgáltatások tudják egymást hitelesíteni. Ellenben semmilyen eszközt nem kínál fel a kulcselosztó hitelességének ellenõrzésére. Így tehát (például) egy eltérített <code>kinit</code> képes ellopni az összes felhasználói nevet és jelszót. Az ilyen incidensek elkerülésére a <a class=package href=https://cgit.freebsd.org/ports/tree/security/tripwire/>security/tripwire</a> és a hozzá hasonló segédprogramok segítségével lehet megõrizni a rendszer sértelenségét.</p></div></div></div><div class=sect3><h4 id=_erõforrások_és_további_információk>14.8.9. Erõforrások és további információk<a class=anchor href=#_erõforrások_és_további_információk></a></h4><div class=ulist><ul><li><p><a href=http://www.faqs.org/faqs/Kerberos-faq/general/preamble.html>A Kerberos GYIK (angolul)</a></p></li><li><p><a href=http://web.mit.edu/Kerberos/www/dialogue.html>Egy hitelesítési rendszer kidolgozása: párbeszéd négy színben (angolul)</a></p></li><li><p><a href="http://www.ietf.org/rfc/rfc1510.txt?number=1510">RFC 1510: A Kerberos hálózati hitelesítési szolgáltatás (V5) (angolul)</a></p></li><li><p><a href=http://web.mit.edu/Kerberos/www/>Az MIT Kerberos holnapja (angolul)</a></p></li><li><p><a href=http://www.pdc.kth.se/heimdal/>A Heimdal Kerberos honlapja (angolul)</a></p></li></ul></div></div></div><div class=sect2><h3 id=openssl>14.9. OpenSSL<a class=anchor href=#openssl></a></h3><div class=paragraph><p>A FreeBSD-hez adott OpenSSL az egyik olyan tényezõ, amit a legtöbb felhasználó figyelmen kívül hagy. Az OpenSSL egy titkosítási réteget nyújt a hagyományos kommunikációs csatorna felett, így rengeteg hálózati alkalmazásba és szolgáltatásba bele lehet szõni.</p></div><div class=paragraph><p>Az OpenSSL felhasználható többek közt a levelezõ kliensek titkosított hitelesítésére, hitelkártyás fizetések weben keresztüli lebonyolítására alkalmas, és még sok minden másra. Sok port, köztük a <a class=package href=https://cgit.freebsd.org/ports/tree/www/apache13-ssl/>www/apache13-ssl</a> és a <a class=package href=https://cgit.freebsd.org/ports/tree/mail/sylpheed-claws/>mail/sylpheed-claws</a> is felajánlja az OpenSSL felhasználását.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>A legtöbb esetben a Portgyûjtemény megpróbálja lefordítani a <a class=package href=https://cgit.freebsd.org/ports/tree/security/openssl/>security/openssl</a> portot, hacsak a <code>WITH_OPENSSL_BASE</code> változót határozottan a "yes" értékre nem állítjuk.</p></div></td></tr></tbody></table></div><div class=paragraph><p>A FreeBSD-hez mellékelt OpenSSL ismeri a Secure Sockets Layer v2/v3 (SSLv2/SSLv3) és Transport Layer Security v1 (TLSv1) hálózatbiztonsági protokollokat, és általános célú titkosítási könyvtárként is alkalmazható.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Noha az OpenSSL ismeri az IDEA algoritmusát is, az Egyesült Államokban érvényben levõ szabadalmak miatt alapértelmezés szerint nem engedélyezett. A használatához el kell olvasni a hozzá tartozó licencet, és ha elfogadjuk a benne foglaltakat, akkor állítsuk be a <code>MAKE_IDEA</code> változót a <span class=filename>make.conf</span> állományban.</p></div></td></tr></tbody></table></div><div class=paragraph><p>Az OpenSSL-t leginkább a szoftverek tanúsítványainak elkészítéséhez használják. Ilyen tanúsítvánnyokkal lehet szavatolni, hogy az érte felelõs cég vagy egyén valóban megbízható és nem szélhámos. Amennyiben a kérdéses tanúsítványt nem vizsgálta be valamelyik "tanúsítványok hitelesítésével foglalkozó hatóság" (Certificate Authority, vagy CA), akkor errõl általában kap egy figyelmeztetést a felhasználó. A tanúsítványokat hitelesítõ cégek, mint például a <a href=http://www.verisign.com>VeriSign</a>, írják alá ezeket a tanúsítványokat és ezzel érvényesítik az egyes cégek vagy egyének megbízhatóságát. Ez ugyan pénzbe kerül, de használatuk egyáltalán nem is kötelezõ. Azonban az átlagosnál paranoidabb felhasználók számára megnyugvást jelenthet.</p></div><div class=sect3><h4 id=_tanúsítványok_elõállítása>14.9.1. Tanúsítványok elõállítása<a class=anchor href=#_tanúsítványok_elõállítása></a></h4><div class=paragraph><p>A tanúsítványok létrehozására a következõ parancs áll rendelkezésre:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># openssl req -new -nodes -out req.pem -keyout cert.pem</span>
Generating a 1024 bit RSA private key
................++++++
.......................................++++++
writing new private key to <span class=s1>&#39;cert.pem&#39;</span>
<span class=nt>-----</span>
You are about to be asked to enter information that will be incorporated
into your certificate request.
What you are about to enter is what is called a Distinguished Name or a DN.
There are quite a few fields but you can leave some blank
For some fields there will be a default value,
If you enter enter <span class=s1>&#39;.&#39;</span>, the field will be left blank.
<span class=nt>-----</span>
Country Name <span class=o>(</span>2 letter code<span class=o>)</span> <span class=o>[</span>AU]:országnév <span class=o>(</span>kétbetűs kóddal<span class=o>)</span>
State or Province Name <span class=o>(</span>full name<span class=o>)</span> <span class=o>[</span>Some-State]:állam vagy tartomány teljes neve
Locality Name <span class=o>(</span>eg, city<span class=o>)</span> <span class=o>[]</span>:település neve
Organization Name <span class=o>(</span>eg, company<span class=o>)</span> <span class=o>[</span>Internet Widgits Pty Ltd]:szervezet neve
Organizational Unit Name <span class=o>(</span>eg, section<span class=o>)</span> <span class=o>[]</span>:szervezeti egység neve
Common Name <span class=o>(</span>eg, YOUR name<span class=o>)</span> <span class=o>[]</span>:általános név <span class=o>(</span>hálózati név!<span class=o>)</span>
Email Address <span class=o>[]</span>:e-mail cím

Please enter the following <span class=s1>&#39;extra&#39;</span> attributes
to be sent with your certificate request
A challenge password <span class=o>[]</span>:VALAMILYEN JELSZÓ
An optional company name <span class=o>[]</span>:egy másik szervezet neve</code></pre></div></div><div class=paragraph><p>Az adatok bekérésére elõtt megjelenõ figyelmeztetõ üzenet fordítása:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>Itt a tanúsítvány igénylésével kapcsolatos információkat kell
megadnunk. Itt egy ún. <span class=s2>&#34;ismertetőnevet&#34;</span> <span class=o>(</span>Distinguished
Name, DN<span class=o>)</span> kell megadnunk. Ezen kívül van még néhány más mező is, de
ezeket akár üresen is hagyhatjuk. Néhány mezőnek van alapértelmezett
értéke, de ha oda egy pontot írunk, akkor kitöröljük.</code></pre></div></div><div class=paragraph><p>A "Common Name" mezõnél ellenõrzési okokból egy hálózati nevet, tehát a szerverünk nevét kell megadnunk. Ha nem így járunk el, akkor lényegében egy használhatatlan tanúsítványt kapunk. További opciók is elérhetõek, mint például a lejárati idõ (expire time) megadása, a titkosítási algoritmus megváltoztatása stb. Ezek teljes listája megtalálható az <a href="https://man.freebsd.org/cgi/man.cgi?query=openssl&amp;sektion=1&amp;format=html">openssl(1)</a> man oldalon.</p></div><div class=paragraph><p>Az elõbbi parancs kiadása után két állománynak kell létrejönnie az aktuális könyvtárban. A tanúsítványkérést, vagyis az <span class=filename>req.pem</span> állományt kell eljuttatnunk a tanúsítványok hitelesítésével foglakozó szervhez, aki majd érvényesíti az imént megadott adatainkat. A második, <span class=filename>cert.pem</span> nevû állomány a tanúsítványhoz tartozó privát kulcs, amit semmilyen körülmények között sem szabad kiadnunk. Ha ez mások kezébe kerül, akkor el tudnak játszani bennünket (vagy a szerverünket).</p></div><div class=paragraph><p>Amikor a hitelesítõ szerv aláírása nem feltétlenül szükséges, akkor készíthetünk egy saját magunk által aláírt tanúsítványt is. Ehhez elõször is generálnunk kell egy RSA-kulcsot:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># openssl dsaparam -rand -genkey -out saját_RSA.kulcs 1024</span></code></pre></div></div><div class=paragraph><p>Most pedig készítsünk el a hitelesítõ szerv kulcsát is:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># openssl gendsa -des3 -out hitelesítõ.kulcs saját_RSA.kulcs</span></code></pre></div></div><div class=paragraph><p>Ezzel a kulccsal most gyártsunk le egy tanúsítványt:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># openssl req -new -x509 -days 365 -key hitelesítõ.kulcs -out új.tanúsítvány</span></code></pre></div></div><div class=paragraph><p>Ekkor két új állomány keletkezik a könyvtárunkban: a hitelesítõ szerv aláírása, a <span class=filename>hitelesítõ.kulcs</span> és maga a tanúsítvány, az <span class=filename>új.tanúsítvány</span> állomány. Ezeket tegyük az <span class=filename>/etc</span> könyvtáron belül egy olyan könyvtárba, amelyet csak a <code>root</code> tud olvasni. A <code>chmod</code> paranccsal állítsunk be rá 0700-as kódú engedélyeket.</p></div></div><div class=sect3><h4 id=_példa_a_tanúsítványok_használatára>14.9.2. Példa a tanúsítványok használatára<a class=anchor href=#_példa_a_tanúsítványok_használatára></a></h4><div class=paragraph><p>Mire is jók ezek az állományok? Például kitûnõen alkalmazhatóak a Sendmail levelezõ szerverhez beérkezõ kapcsolatot titkosítására. Így lényegében felszámoljuk minden olyan felhasználó titkosítatlan módon zajló hitelesítését, aki a helyi levelezõ szerveren keresztül küldi a leveleit.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Ez általában nem a legjobb megoldás, mivel egyes levelezõ kliensek hibát jeleneznek a felhasználónak, ha nem rendelkezik a tanúsítvánnyal. A tanúsítványok telepítésével kapcsolatban olvassuk el a szoftverhez adott leírást.</p></div></td></tr></tbody></table></div><div class=paragraph><p>A helyi <span class=filename>.mc</span> állományba ezeket a sorokat kell beletenni:</p></div><div class="literalblock programlisting"><div class=content><pre>dnl SSL Options
define(`confCACERT_PATH&#39;,`/etc/certs&#39;)dnl
define(`confCACERT&#39;,`/etc/certs/új.tanúsítvány&#39;)dnl
define(`confSERVER_CERT&#39;,`/etc/certs/új.tanúsítvány&#39;)dnl
define(`confSERVER_KEY&#39;,`/etc/certs/hitelesítõ.kulcs&#39;)dnl
define(`confTLS_SRV_OPTIONS&#39;, `V&#39;)dnl</pre></div></div><div class=paragraph><p>Itt a <span class=filename>/etc/certs/</span> az a könyvtár, amit tanúsítványok és kulcsok helyi tárolására használunk. Végezetül még újra kell generálnunk a helyi <span class=filename>.cf</span> állományokat. Ezt a <span class=filename>/etc/mail</span> könyvtárban a <code>make install</code> parancs kiadásával könnyen elvégezhetjük. Miután ez megtörtént, akkor Sendmailhoz tartozó démont a <code>make restart</code> paraméterével indíthatjuk újra.</p></div><div class=paragraph><p>Ha minden jól ment, akkor a <span class=filename>/var/log/maillog</span> állományban nem találunk egyetlen hibaüzenetet sem, és a Sendmail is megjelenik a futó programok között.</p></div><div class=paragraph><p>A <a href="https://man.freebsd.org/cgi/man.cgi?query=telnet&amp;sektion=1&amp;format=html">telnet(1)</a> segédprogrammal így probálhatjuk ki a levelezõ szervert:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># telnet example.com 25</span>
Trying 192.0.34.166...
Connected to example.com.
Escape character is <span class=s1>&#39;^]&#39;</span><span class=nb>.</span>
220 example.com ESMTP Sendmail 8.12.10/8.12.10<span class=p>;</span> Tue, 31 Aug 2004 03:41:22 <span class=nt>-0400</span> <span class=o>(</span>EDT<span class=o>)</span>
ehlo example.com
250-example.com Hello example.com <span class=o>[</span>192.0.34.166], pleased to meet you
250-ENHANCEDSTATUSCODES
250-PIPELINING
250-8BITMIME
250-SIZE
250-DSN
250-ETRN
250-AUTH LOGIN PLAIN
250-STARTTLS
250-DELIVERBY
250 HELP
quit
221 2.0.0 example.com closing connection
Connection closed by foreign host.</code></pre></div></div><div class=paragraph><p>Ha itt megjelenik a "STARTTLS" sor, akkor mindent sikerült beállítanunk.</p></div></div></div><div class=sect2><h3 id=ipsec>14.10. VPN IPsec felett<a class=anchor href=#ipsec></a></h3><div class=paragraph><p>VPN létrehozása FreeBSD átjárók használatával két olyan hálózat között, amelyeket egymástól az internet választ el.</p></div><div class=sect3><h4 id=_az_ipsec_bemutatása>14.10.1. Az IPsec bemutatása<a class=anchor href=#_az_ipsec_bemutatása></a></h4><div class=paragraph><p>Ebben a szakaszban az IPsec beállításának folyamatát vázoljuk fel. Az IPsec beállításához elengedhetetlen, hogy tisztában legyünk egy saját rendszermag fordításának alapjaival (lásd <a href=./#kernelconfig>A FreeBSD rendszermag testreszabása</a>).</p></div><div class=paragraph><p>Az <em>IPsec</em> egy olyan protokoll, amely az Internet Protocol (IP) rétegére épül. Segítségével két vagy több számítógép képes biztonságos módon tartani egymással a kapcsolatot (innen ered a neve). A FreeBSD IPsec "hálózati protokollkészlete" a <a href=http://www.kame.net>KAME</a> implementációjára épül, mely egyaránt támogatja az IPv4 és IPv6 protokollcsaládokat.</p></div><div class=paragraph><p>Az IPsec két alprotokollból tevõdik össze:</p></div><div class=ulist><ul><li><p><em>A hasznos adat biztonságos becsomagolása (Encapsulated Security Payload, ESP)</em> során egy szimmetrikus kriptográfiai algoritmussal (mint például Blowfish, 3DES) titkosítjuk az IP-csomagok tartalmát, ezáltal megvédjük ezeket az illetéktelenektõl.</p></li><li><p>A <em>Hitelesítési fejléc (Authentication Header, AH)</em> használatával megakadályozzuk, hogy az illetéktelenek meghamisítsák az IP csomagok fejlécét. Ezt úgy érjük el, hogy kiszámolunk egy kriptográfiai ellenõrzõ összeget és az IP-csomagok fejlécének mezõire egy biztonságos függvénnyel generálunk valamilyen ujjlenyomatot. Az ez után következõ kiegészítõ fejléc tartalmazza ezt az ujjlenyomatot, amellyel a csomag hitelesíthetõ.</p></li></ul></div><div class=paragraph><p>Az ESP és az AH az alkalmazástól függõen használható együtt vagy külön-külön.</p></div><div class=paragraph><p>Az IPsec akár közvetlenül is használható két számítógép forgalmának titkosítására (ezt <em>Szállítási módnak (Transport Mode)</em> nevezik), vagy két alhálózat között építhetünk ki vele "virtuális tunneleket", ami remekül alkalmas két vállalati hálózat kommunikációjának bebiztosítására (ez a <em>Tunnel mód (Tunnel Mode)</em>). Ez utóbbit egyszerûen csak <em>Virtuális magánhálózatként (Virtual Private Network, VPN)</em> emlegetik. A FreeBSD IPsec alrendszerérõl az <a href="https://man.freebsd.org/cgi/man.cgi?query=ipsec&amp;sektion=4&amp;format=html">ipsec(4)</a> man oldalon találhatunk további információkat.</p></div><div class=paragraph><p>A rendszermag IPsec támogatásának aktiválásához a következõ paramétereket kell beletennünk a konfigurációs állományba:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>options   IPSEC        <span class=c># IP biztonság</span>
device    crypto</code></pre></div></div><div class=paragraph><p>Ha szükségünk van a IPsec nyomkövetésére, a következõ beállítást is hozzátehetjük:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>options   IPSEC_DEBUG  <span class=c># az IP biztonság nyomkövetése</span></code></pre></div></div></div><div class=sect3><h4 id=_a_probléma>14.10.2. A probléma<a class=anchor href=#_a_probléma></a></h4><div class=paragraph><p>Semmilyen szabvány nem fogalmazza meg mi is számít VPN-nek. A virtuális magánhálózatok tucatnyi különbözõ technológiával valósíthatóak meg, de mindegyiknek megvan a maga erõssége és gyengesége. Ebben a szakaszban körvonalazunk egy ilyen helyzetet, valamint a benne felépített VPN megvalósításához alkalmazott stratégiákat.</p></div></div><div class=sect3><h4 id=_a_forgatókönyv_adott_egy_otthoni_és_egy_vállalati_hálózat_amelyek_külön_külön_csatlakoznak_az_internetre_és_vpn_használatával_ezeket_egyetlen_hálózatként_szeretnénk_használni>14.10.3. A forgatókönyv: adott egy otthoni és egy vállalati hálózat, amelyek külön-külön csatlakoznak az internetre, és VPN használatával ezeket egyetlen hálózatként szeretnénk használni<a class=anchor href=#_a_forgatókönyv_adott_egy_otthoni_és_egy_vállalati_hálózat_amelyek_külön_külön_csatlakoznak_az_internetre_és_vpn_használatával_ezeket_egyetlen_hálózatként_szeretnénk_használni></a></h4><div class=paragraph><p>Elõfeltételezéseink a következõek:</p></div><div class=ulist><ul><li><p>legalább két hálózatunk van;</p></li><li><p>magán belül mind a két hálózat IP-t használ;</p></li><li><p>mind a két hálózat egy FreeBSD átjárón keresztül csatlakozik az internethez;</p></li><li><p>a hálózatok átjárói legalább egy publikus IP-címmel rendelkeznek;</p></li><li><p>a hálózatok belsõ címei lehetnek publikus vagy privát IP-címek, nem számít. Fontos viszont, hogy ezek ne ütközzenek, vagyis ne használja egyszerre mind a kettõ a <code>192.168.1.x</code> címtartományt.</p></li></ul></div></div><div class=sect3><h4 id=_az_ipsec_beállítása_freebsd_alatt>14.10.4. Az IPsec beállítása FreeBSD alatt<a class=anchor href=#_az_ipsec_beállítása_freebsd_alatt></a></h4><div class=paragraph><p>Kezdésképpen a Portgyûjteménybõl telepítenünk kell a <a class=package href=https://cgit.freebsd.org/ports/tree/security/ipsec-tools/>security/ipsec-tools</a> portot. Ez a programcsomag rengeteg olyan alkalmazást tartalmaz, amely segítségünkre lehet a beállítások elvégzése során.</p></div><div class=paragraph><p>A következõ lépésben létre kell hoznunk két <a href="https://man.freebsd.org/cgi/man.cgi?query=gif&amp;sektion=4&amp;format=html">gif(4)</a> típusú pszeudoeszközt, melyeken keresztül a két hálózat között egy tunnel segítségével ki tudjuk építeni a szükséges kapcsolatot. Ehhez <code>root</code> felhasználóként futtassuk a következõ parancsokat (a <em>belsõ</em> és <em>külsõ</em> megnevezésû paramétereket cseréljük ki a valós belsõ és külsõ átjárók címeire):</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># ifconfig gif0 create</span></code></pre></div></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># ifconfig gif0 belsõ1 belsõ2</span></code></pre></div></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># ifconfig gif0 tunnel külsõ1 külsõ2</span></code></pre></div></div><div class=paragraph><p>Tekintsük például, hogy a vállalati LAN publikus IP-címe <code>172.16.5.4</code>, valamint a privát IP-címe <code>10.246.38.1</code>. Az otthoni LAN publikus IP-címe legyen most <code>192.168.1.12</code>, valamint a belsõ privát IP-címe pedig <code>10.0.0.5</code>.</p></div><div class=paragraph><p>Elsõre ez talán még nem teljesen érthetõ, ezért az <a href="https://man.freebsd.org/cgi/man.cgi?query=ifconfig&amp;sektion=8&amp;format=html">ifconfig(8)</a> parancs használatával is nézzük meg a példában szereplõ hálózatok konfigurációját:</p></div><div class="literalblock programlisting"><div class=content><pre>Az elsõ átjáró:

gif0: flags=8051 mtu 1280
tunnel inet 172.16.5.4 --&gt; 192.168.1.12
inet6 fe80::2e0::81ff:fe02:5881%gif0 prefixlen 64 scopeid 0x6
inet 10.246.38.1 --&gt; 10.0.0.5 netmask 0xffffff00

A második átjáró:

gif0: flags=8051 mtu 1280
tunnel inet 192.168.1.12 --&gt; 172.16.5.4
inet 10.0.0.5 --&gt; 10.246.38.1 netmask 0xffffff00
inet6 fe80::250:bfff:fe3a:c1f%gif0 prefixlen 64 scopeid 0x4</pre></div></div><div class=paragraph><p>Miután elvégeztük az iménti beállításokat, a <a href="https://man.freebsd.org/cgi/man.cgi?query=ping&amp;sektion=8&amp;format=html">ping(8)</a> paranccsal már mind a két privát IP-tartománynak elérhetõnek kell lennie, ahogy azt az alábbi példa is érzékeltetni kívánja:</p></div><div class="literalblock programlisting"><div class=content><pre>otthoni-halo# ping 10.0.0.5
PING 10.0.0.5 (10.0.0.5): 56 data bytes
64 bytes from 10.0.0.5: icmp_seq=0 ttl=64 time=42.786 ms
64 bytes from 10.0.0.5: icmp_seq=1 ttl=64 time=19.255 ms
64 bytes from 10.0.0.5: icmp_seq=2 ttl=64 time=20.440 ms
64 bytes from 10.0.0.5: icmp_seq=3 ttl=64 time=21.036 ms
--- 10.0.0.5 ping statistics ---
4 packets transmitted, 4 packets received, 0% packet loss
round-trip min/avg/max/stddev = 19.255/25.879/42.786/9.782 ms

vallalati-halo# ping 10.246.38.1
PING 10.246.38.1 (10.246.38.1): 56 data bytes
64 bytes from 10.246.38.1: icmp_seq=0 ttl=64 time=28.106 ms
64 bytes from 10.246.38.1: icmp_seq=1 ttl=64 time=42.917 ms
64 bytes from 10.246.38.1: icmp_seq=2 ttl=64 time=127.525 ms
64 bytes from 10.246.38.1: icmp_seq=3 ttl=64 time=119.896 ms
64 bytes from 10.246.38.1: icmp_seq=4 ttl=64 time=154.524 ms
--- 10.246.38.1 ping statistics ---
5 packets transmitted, 5 packets received, 0% packet loss
round-trip min/avg/max/stddev = 28.106/94.594/154.524/49.814 ms</pre></div></div><div class=paragraph><p>Az elvárásainknak megfelelõen tehát a privát címeken mind a két oldalnak képesnek kell lennie ICMP csomagokat küldenie és fogadnia. A következõ lépésben meg kell mondanunk az átjáróknak hogyan irányítsák a csomagokat a két hálózat közti forgalom megfelelõ áramlásához. Ezt az alábbi paranccsal elérhetjük el:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># vallalati-halo# route add 10.0.0.0 10.0.0.5 255.255.255.0</span></code></pre></div></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># vallalati-halo# route add net 10.0.0.0: gateway 10.0.0.5</span></code></pre></div></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># otthoni-halo# route add 10.246.38.0 10.246.38.1 255.255.255.0</span></code></pre></div></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># otthoni-halo# route add host 10.246.38.0: gateway 10.246.38.1</span></code></pre></div></div><div class=paragraph><p>Itt már a belsõ gépeket az átjárókról és az átjárók mögül egyaránt el tudjuk érni. A következõ példa alapján errõl könnyedén meg is tudunk gyõzõdni:</p></div><div class="literalblock programlisting"><div class=content><pre>vallalati-halo# ping 10.0.0.8
PING 10.0.0.8 (10.0.0.8): 56 data bytes
64 bytes from 10.0.0.8: icmp_seq=0 ttl=63 time=92.391 ms
64 bytes from 10.0.0.8: icmp_seq=1 ttl=63 time=21.870 ms
64 bytes from 10.0.0.8: icmp_seq=2 ttl=63 time=198.022 ms
64 bytes from 10.0.0.8: icmp_seq=3 ttl=63 time=22.241 ms
64 bytes from 10.0.0.8: icmp_seq=4 ttl=63 time=174.705 ms
--- 10.0.0.8 ping statistics ---
5 packets transmitted, 5 packets received, 0% packet loss
round-trip min/avg/max/stddev = 21.870/101.846/198.022/74.001 ms

otthoni-halo# ping 10.246.38.107
PING 10.246.38.1 (10.246.38.107): 56 data bytes
64 bytes from 10.246.38.107: icmp_seq=0 ttl=64 time=53.491 ms
64 bytes from 10.246.38.107: icmp_seq=1 ttl=64 time=23.395 ms
64 bytes from 10.246.38.107: icmp_seq=2 ttl=64 time=23.865 ms
64 bytes from 10.246.38.107: icmp_seq=3 ttl=64 time=21.145 ms
64 bytes from 10.246.38.107: icmp_seq=4 ttl=64 time=36.708 ms
--- 10.246.38.107 ping statistics ---
5 packets transmitted, 5 packets received, 0% packet loss
round-trip min/avg/max/stddev = 21.145/31.721/53.491/12.179 ms</pre></div></div><div class=paragraph><p>A tunnelek beállítása volt igazából a könnyebb rész, egy biztonságos összeköttetés kialakítása azonban már valamivel komolyabb folyamatot rejt magában. A most következõ konfigurációban erre "elõre ismert" (vagyis pre-shared, PSK) RSA-kulcsokat fogunk használni. A konkrét IP-címektõl eltekintve az átjárókon a <span class=filename>/usr/local/etc/racoon/racoon.conf</span> állományok hasonlóan fognak kinézni, nagyjából valahogy így:</p></div><div class="literalblock programlisting"><div class=content><pre>path    pre_shared_key &#34;/usr/local/etc/racoon/psk.txt&#34;; # az ismert kulcsot tartalmazó állomány helye
log     debug;	# a naplózás részletességének beállítása: ha végeztünk a teszteléssel és a hibakereséssel, akkor állítsuk át a &#39;notify&#39; értékre

padding  # ezeket ne nagyon változtassuk meg
{
        maximum_length  20;
        randomize       off;
        strict_check    off;
        exclusive_tail  off;
}

timer	# idõzítési beállítások, állítsuk be igény szerint
{
        counter         5;
        interval        20 sec;
        persend         1;
#       natt_keepalive  15 sec;
        phase1          30 sec;
        phase2          15 sec;
}

listen	# cím [port], ahol a racoon majd válaszolni fog
{
        isakmp          172.16.5.4 [500];
        isakmp_natt     172.16.5.4 [4500];
}

remote  192.168.1.12 [500]
{
        exchange_mode   main,aggressive;
        doi             ipsec_doi;
        situation       identity_only;
        my_identifier   address 172.16.5.4;
        peers_identifier        address 192.168.1.12;
        lifetime        time 8 hour;
        passive         off;
        proposal_check  obey;
#       nat_traversal   off;
        generate_policy off;

                        proposal {
                                encryption_algorithm    blowfish;
                                hash_algorithm          md5;
                                authentication_method   pre_shared_key;
                                lifetime time           30 sec;
                                dh_group                1;
                        }
}

sainfo  (address 10.246.38.0/24 any address 10.0.0.0/24 any) # address $hálózat/$hálózati_maszk $típus address $hálózat/$hálózati_maszk $típus
 		  # (a $típus lehet &#34;any&#34; vagy &#34;esp&#34;)
{		  # a $hálózat a két összekapcsolni kívánt belsõ hálózat legyen
        pfs_group       1;
        lifetime        time    36000 sec;
        encryption_algorithm    blowfish,3des,des;
        authentication_algorithm        hmac_md5,hmac_sha1;
        compression_algorithm   deflate;
}</pre></div></div><div class=paragraph><p>A példában szereplõ összes opció részletes kifejtése jóval meghaladná ezen leírás kereteit, ezért a bõvebb információkkal kapcsolatban inkább a racoon beállításaihoz tartozó man oldal elolvasását javasoljuk.</p></div><div class=paragraph><p>A gépek közti hálózati forgalom titkosításához be kell még állítanunk egy SPD házirendet is, így a FreeBSD és a racoon képes kódolni és dekódolni a csomagokat.</p></div><div class=paragraph><p>Ezt a most következõ, a vállalati átjárón találhatóhoz hasonló egyszerû shell szkripttel tudjuk elvégezni. Ezt az állományt a rendszer indításakor fogjuk felhasználni, melyet <span class=filename>/usr/local/etc/racoon/setkey.conf</span> néven mentsünk el:</p></div><div class="literalblock programlisting"><div class=content><pre>flush;
spdflush;
# Az otthoni hálózati felé
spdadd 10.246.38.0/24 10.0.0.0/24 any -P out ipsec esp/tunnel/172.16.5.4-192.168.1.12/use;
spdadd 10.0.0.0/24 10.246.38.0/24 any -P in ipsec esp/tunnel/192.168.1.12-172.16.5.4/use;</pre></div></div><div class=paragraph><p>Ahogy ezzel megvagyunk, a racoon az egyes átjárókon a következõ paranccsal indítható el:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># /usr/local/sbin/racoon -F -f /usr/local/etc/racoon/racoon.conf -l /var/log/racoon.log</span></code></pre></div></div><div class=paragraph><p>A parancs eredménye ennek megfelelõen nagyjából a következõ lesz:</p></div><div class="literalblock programlisting"><div class=content><pre>vallalati-halo# /usr/local/sbin/racoon -F -f /usr/local/etc/racoon/racoon.conf
Foreground mode.
2006-01-30 01:35:47: INFO: begin Identity Protection mode.
2006-01-30 01:35:48: INFO: received Vendor ID: KAME/racoon
2006-01-30 01:35:55: INFO: received Vendor ID: KAME/racoon
2006-01-30 01:36:04: INFO: ISAKMP-SA established 72.16.5.4[500]-192.168.1.12[500] spi:623b9b3bd2492452:7deab82d54ff704a
2006-01-30 01:36:05: INFO: initiate new phase 2 negotiation: 72.16.5.4[0]192.168.1.12[0]
2006-01-30 01:36:09: INFO: IPsec-SA established: ESP/Tunnel 92.168.1.12[0]-&gt;172.16.5.4[0] spi=28496098(0x1b2d0e2)
2006-01-30 01:36:09: INFO: IPsec-SA established: ESP/Tunnel 172.16.5.4[0]-&gt;192.168.1.12[0] spi=47784998(0x2d92426)
2006-01-30 01:36:13: INFO: respond new phase 2 negotiation: 172.16.5.4[0]192.168.1.12[0]
2006-01-30 01:36:18: INFO: IPsec-SA established: ESP/Tunnel 192.168.1.12[0]-&gt;172.16.5.4[0] spi=124397467(0x76a279b)
2006-01-30 01:36:18: INFO: IPsec-SA established: ESP/Tunnel 172.16.5.4[0]-&gt;192.168.1.12[0] spi=175852902(0xa7b4d66)</pre></div></div><div class=paragraph><p>A tunnel megfelelõ mûködését úgy tudjuk ellenõrizni, ha átváltunk egy másik konzolra és a <a href="https://man.freebsd.org/cgi/man.cgi?query=tcpdump&amp;sektion=1&amp;format=html">tcpdump(1)</a> program segítségével figyeljük a hálózati forgalmat. A példában szereplõ <code>em0</code> interfészt természetesen ne felejtsük el kicserélni a megfelelõ eszköz nevére.</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># tcpdump -i em0 host 172.16.5.4 and dst 192.168.1.12</span></code></pre></div></div><div class=paragraph><p>Ennek hatására az alábbiakhoz hasonló adatoknak kellene megjelennie a konzolon. Amennyiben nem ez történik, valamilyen hiba történt, ezért meg kell keresnünk azt a visszakapott adatok alapján.</p></div><div class="literalblock programlisting"><div class=content><pre>01:47:32.021683 IP vallalatihalozat.com &gt; 192.168.1.12.otthonihalozat.com: ESP(spi=0x02acbf9f,seq=0xa)
01:47:33.022442 IP vallalatihalozat.com &gt; 192.168.1.12.otthonihalozat.com: ESP(spi=0x02acbf9f,seq=0xb)
01:47:34.024218 IP vallalatihalozat.com &gt; 192.168.1.12.otthonihalozat.com: ESP(spi=0x02acbf9f,seq=0xc)</pre></div></div><div class=paragraph><p>Itt már mind a két hálózatnak elérhetõnek kell lennie és egyként kell látszódnia. A hálózatokat ezen felül még érdemes külön védeni egy tûzfallal is. Ilyenkor a csomagok két hálózati közti zavartalan oda-vissza vándorlásához további szabályokat kell még felvennünk a tûzfal szabályrendszerébe. A <a href="https://man.freebsd.org/cgi/man.cgi?query=ipfw&amp;sektion=8&amp;format=html">ipfw(8)</a> tûzfal esetén ez a következõ sorok hozzáadását jelenti a tûzfal konfigurációs állományához:</p></div><div class="literalblock programlisting"><div class=content><pre>ipfw add 00201 allow log esp from any to any
ipfw add 00202 allow log ah from any to any
ipfw add 00203 allow log ipencap from any to any
ipfw add 00204 allow log udp from any 500 to any</pre></div></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>A szabályok számozását mindig az adott gép aktuális beállításainak megfelelõen kell módosítani.</p></div></td></tr></tbody></table></div><div class=paragraph><p>A <a href="https://man.freebsd.org/cgi/man.cgi?query=pf&amp;sektion=4&amp;format=html">pf(4)</a> és <a href="https://man.freebsd.org/cgi/man.cgi?query=ipf&amp;sektion=8&amp;format=html">ipf(8)</a> felhasználók számára ehhez a következõ parancsot javasoljuk:</p></div><div class="literalblock programlisting"><div class=content><pre>pass in quick proto esp from any to any
pass in quick proto ah from any to any
pass in quick proto ipencap from any to any
pass in quick proto udp from any port = 500 to any port = 500
pass in quick on gif0 from any to any
pass out quick proto esp from any to any
pass out quick proto ah from any to any
pass out quick proto ipencap from any to any
pass out quick proto udp from any port = 500 to any port = 500
pass out quick on gif0 from any to any</pre></div></div><div class=paragraph><p>Végezetül a következõ sor hozzáadásával engedélyezzük az <span class=filename>/etc/rc.conf</span> állományban a VPN indítását a rendszer indítása során:</p></div><div class="literalblock programlisting"><div class=content><pre>ipsec_enable=&#34;YES&#34;
ipsec_program=&#34;/usr/local/sbin/setkey&#34;
ipsec_file=&#34;/usr/local/etc/racoon/setkey.conf&#34; # engedélyezzük az spd házirend beállítását a rendszer indításakor
racoon_enable=&#34;yes&#34;</pre></div></div></div></div><div class=sect2><h3 id=openssh>14.11. OpenSSH<a class=anchor href=#openssh></a></h3><div class=paragraph><p>Az OpenSSH olyan hálózati kapcsolódási eszközök összessége, amivel biztonságos módon érhetünk el távoli számítógépeket. Az <code>rlogin</code>, <code>rsh</code>, <code>rcp</code> és a <code>telnet</code> direkt kiváltására használható. Emellett SSH-n keresztül TCP/IP kapcsolatok is biztonságosan bújtathatóak vagy küldhetõek tovább.</p></div><div class=paragraph><p>Az OpenSSH-t az OpenBSD projekt tartja karban, és az SSH 1.2.12 verziójára épül hibajavításokkal és frissítésekkel egyetemben. Az SSH 1 és 2 protokollokkal egyaránt kompatibilis.</p></div><div class=sect3><h4 id=_az_openssh_használatának_elõnyei>14.11.1. Az OpenSSH használatának elõnyei<a class=anchor href=#_az_openssh_használatának_elõnyei></a></h4><div class=paragraph><p>A hétköznapi esetben, vagyis amikor a <a href="https://man.freebsd.org/cgi/man.cgi?query=telnet&amp;sektion=1&amp;format=html">telnet(1)</a> vagy <a href="https://man.freebsd.org/cgi/man.cgi?query=rlogin&amp;sektion=1&amp;format=html">rlogin(1)</a> alkalmazásokat használjuk, az adatok titkosítatlan formában közlekednek a hálózaton. A szerver és a kliens közé bárhova becsatlakozó hálózati kíváncsiskodók így könnyedén el tudják lopni a felhasználói nevünket és jelszavunkat, vagy lényegében bármilyen adatot, ami az adott munkamenetben megfordul. Az OpenSSH ennek kivédésére kínál fel különféle hitelesítési és titkosítási eszközöket.</p></div></div><div class=sect3><h4 id=_az_sshd_engedélyezése>14.11.2. Az sshd engedélyezése<a class=anchor href=#_az_sshd_engedélyezése></a></h4><div class=paragraph><p>Az sshd a FreeBSD telepítésekor jelentkezõ <code>Standard</code> lehetõségek egyike. Az sshd engedélyezését úgy tudjuk kideríteni, ha az <span class=filename>rc.conf</span> állományban megkeressük a következõ sort:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=nv>sshd_enable</span><span class=o>=</span><span class=s2>&#34;YES&#34;</span></code></pre></div></div><div class=paragraph><p>Ez tölti be a rendszer indításakor az <a href="https://man.freebsd.org/cgi/man.cgi?query=sshd&amp;sektion=8&amp;format=html">sshd(8)</a>-t, az OpenSSH démonát. Vagy az <span class=filename>/etc/rc.d/sshd</span> <a href="https://man.freebsd.org/cgi/man.cgi?query=rc&amp;sektion=8&amp;format=html">rc(8)</a> szkript segítségével is elindíthatjuk az OpenSSH-t:</p></div><div class="literalblock programlisting"><div class=content><pre>/etc/rc.d/sshd start</pre></div></div></div><div class=sect3><h4 id=_az_ssh_kliens>14.11.3. Az SSH kliens<a class=anchor href=#_az_ssh_kliens></a></h4><div class=paragraph><p>Az <a href="https://man.freebsd.org/cgi/man.cgi?query=ssh&amp;sektion=1&amp;format=html">ssh(1)</a> segédprogram az <a href="https://man.freebsd.org/cgi/man.cgi?query=rlogin&amp;sektion=1&amp;format=html">rlogin(1)</a> programhoz hasonlóan mûködik.</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># ssh felhasználó@gép.hu</span>
Host key not found from the list of known hosts.  Are you sure you
want to <span class=k>continue </span>connecting <span class=o>(</span><span class=nb>yes</span>/no<span class=o>)</span>?  <span class=nb>yes </span>Host
<span class=s1>&#39;gép.hu&#39;</span> added to the list of known hosts.
felhasználó@gép.hu<span class=s1>&#39;s password:
*******</span></code></pre></div></div><div class=paragraph><p>Az üzenetek fordítása:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>Nem találtam meg a gépet az ismert gépek között.  Biztosan csatlakozni
akarunk hozzá <span class=o>(</span>igen/nem<span class=o>)</span>?  igen A <span class=s1>&#39;gép.hu&#39;</span>
felkerült az ismert gépek közé.
Adja meg a felhasználó@gép.hu jelszavát:</code></pre></div></div><div class=paragraph><p>Bejelentkezés után minden ugyanolyan, mintha az <code>rlogin</code> vagy a <code>telnet</code> programokat használtuk volna. Az SSH egy kulcs segítségével próbálja azonosítani a számítógépeket, ezzel ellenõrzi a szerver hitelességét a kliensek csatlakozásakor. A felhasználónak ilyenkor elõször mindig <code>yes</code> választ kell adnia. A késõbbi bejelentkezési kísérletek pedig majd mindig az így kapott kulccsal történnek. Ha eltérne a kulcs, akkor az SSH kliens erre figyelmeztetni fog minket. A kulcsok a <span class=filename>~/.ssh/known_hosts</span> vagy az SSH v2 protokoll esetén a <span class=filename>~/.ssh/known_hosts2</span> állományba kerülnek elmentésre.</p></div><div class=paragraph><p>Alapértelmezés szerint az OpenSSH szerverek csak SSH v2 kapcsolatokat fogadnak el. Lehetõség szerint a kliens is ezt a változatot fogja használni, de ha nem sikerül, akkor megpróbálkozik a v1-el. A kliensnek a <code>-1</code> vagy <code>-2</code> opciók segítségével elõ is lehet írni, hogy az elsõ vagy a második változatot használja. A kliensben az elsõ változat támogatását csupán a régebbi verziók kompatibilitása miatt tartják karban.</p></div></div><div class=sect3><h4 id=_biztonságos_másolás>14.11.4. Biztonságos másolás<a class=anchor href=#_biztonságos_másolás></a></h4><div class=paragraph><p>Az <a href="https://man.freebsd.org/cgi/man.cgi?query=scp&amp;sektion=1&amp;format=html">scp(1)</a> parancs az <a href="https://man.freebsd.org/cgi/man.cgi?query=rcp&amp;sektion=1&amp;format=html">rcp(1)</a> parancshoz hasonlóan mûködik: egyik géprõl másol a másikra, biztonságosan.</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c>#  scp felhasználó@gép.hu:/COPYRIGHT COPYRIGHT</span>
felhasználó@gép.hu<span class=s1>&#39;s password: *******
COPYRIGHT            100% |*****************************|  4735
00:00
#</span></code></pre></div></div><div class=paragraph><p>Mivel a kulcsot már ismerjük ehhez a távoli géphez (az elõbbi példából), ezért az <a href="https://man.freebsd.org/cgi/man.cgi?query=scp&amp;sektion=1&amp;format=html">scp(1)</a> használatakor már ezzel hitelesítünk.</p></div><div class=paragraph><p>Az <a href="https://man.freebsd.org/cgi/man.cgi?query=scp&amp;sektion=1&amp;format=html">scp(1)</a> paraméterei hasonlóak a <a href="https://man.freebsd.org/cgi/man.cgi?query=cp&amp;sektion=1&amp;format=html">cp(1)</a> parancséhoz: elsõ helyen az állomány vagy állományok neveit adjuk meg, a másodikon pedig a célt. Mivel az állományokat a hálózaton SSH-n keresztül küldik át, ezért az állományok neveit <code><em>felhasználó@gép</em>:_elérési_út_</code> formában kell megadni.</p></div></div><div class=sect3><h4 id=_beállítások>14.11.5. Beállítások<a class=anchor href=#_beállítások></a></h4><div class=paragraph><p>Az OpenSSH démon és kliens rendszerszintû konfigurációs állományai az <span class=filename>/etc/ssh</span> könyvtárban találhatóak.</p></div><div class=paragraph><p>Az <span class=filename>ssh_config</span> tartalmazza a kliens beállításait, miközben az <span class=filename>sshd_config</span> tartalmazza a démonét.</p></div><div class=paragraph><p>Emellett az <span class=filename>rc.conf</span> állományban megadható <code>sshd_program</code> (ez alapból a <span class=filename>/usr/sbin/sshd</span>) és <code>sshd_flags</code> opciókkal további beállítási szinteket nyújtanak.</p></div></div><div class=sect3><h4 id=security-ssh-keygen>14.11.6. ssh-keygen<a class=anchor href=#security-ssh-keygen></a></h4><div class=paragraph><p>Jelszavak helyett az <a href="https://man.freebsd.org/cgi/man.cgi?query=ssh-keygen&amp;sektion=1&amp;format=html">ssh-keygen(1)</a> programmal a felhasználók azonosítására DSA- vagy RSA-kulcsokat tudunk készíteni:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>% ssh-keygen <span class=nt>-t</span> dsa
Generating public/private dsa key pair.
Enter file <span class=k>in </span>which to save the key <span class=o>(</span>/home/felhasználó/.ssh/id_dsa<span class=o>)</span>:
Created directory <span class=s1>&#39;/home/felhasználó/.ssh&#39;</span><span class=nb>.</span>
Enter passphrase <span class=o>(</span>empty <span class=k>for </span>no passphrase<span class=o>)</span>:
Enter same passphrase again:
Your identification has been saved <span class=k>in</span> /home/felhasználó/.ssh/id_dsa.
Your public key has been saved <span class=k>in</span> /home/felhasználó/.ssh/id_dsa.pub.
The key fingerprint is:
bb:48:db:f2:93:57:80:b6:aa:bc:f5:d5:ba:8f:79:17 felhasználó@gép.hu</code></pre></div></div><div class=paragraph><p>Az <a href="https://man.freebsd.org/cgi/man.cgi?query=ssh-keygen&amp;sektion=1&amp;format=html">ssh-keygen(1)</a> ekkor a hitelesítésre létrehoz egy publikus és egy privát kulcsból álló párt. A privát kulcs a <span class=filename>~/.ssh/id_dsa</span> vagy <span class=filename>~/.ssh/id_rsa</span> állományba kerül, miközben a publikus kulcs a <span class=filename>~/.ssh/id_dsa.pub</span> vagy <span class=filename>~/.ssh/id_rsa.pub</span> lesz attól függõen, hogy DSA vagy RSA a kulcs típusa. A módszer mûködéséhez a publikus DSA- vagy RSA-kulcsot a távoli számítógép <span class=filename>~/.ssh/authorized_keys</span> állományába kell bemásolni.</p></div><div class=paragraph><p>Így tehát a távoli számítógépre jelszavak alkalmazása helyett SSH-kulccsal tudunk belépni.</p></div><div class=paragraph><p>Ha az <a href="https://man.freebsd.org/cgi/man.cgi?query=ssh-keygen&amp;sektion=1&amp;format=html">ssh-keygen(1)</a> parancsnak megadunk egy jelmondatot is, akkor a felhasználó a privát kulcsát csak ennek megadásával tudja használni. A hosszú jelmondatok állandó beirogatásától a <a href=#security-ssh-agent>Az ssh-agent és az ssh-add</a> szakaszban hamarosan bemutatásra került <a href="https://man.freebsd.org/cgi/man.cgi?query=ssh-agent&amp;sektion=1&amp;format=html">ssh-agent(1)</a> igyekszik megkímélni minket.</p></div><div class="admonitionblock warning"><table><tbody><tr><td class=icon><i class="fa icon-warning" title=Warning></i></td><td class=content><div class=paragraph><p>A különbözõ opciók és állományok eltérhetnek a számítógépünkre telepített OpenSSH verziójától függõen. Ilyen esetben javasolt felkeresni az <a href="https://man.freebsd.org/cgi/man.cgi?query=ssh-keygen&amp;sektion=1&amp;format=html">ssh-keygen(1)</a> man oldalát.</p></div></td></tr></tbody></table></div></div><div class=sect3><h4 id=security-ssh-agent>14.11.7. Az ssh-agent és az ssh-add<a class=anchor href=#security-ssh-agent></a></h4><div class=paragraph><p>Az <a href="https://man.freebsd.org/cgi/man.cgi?query=ssh-agent&amp;sektion=1&amp;format=html">ssh-agent(1)</a> és <a href="https://man.freebsd.org/cgi/man.cgi?query=ssh-add&amp;sektion=1&amp;format=html">ssh-add(1)</a> segédprogramokkal be tudjuk tölteni az SSH-kulcsokat a memóriába, amivel elkerülhetjük a jelmondat állandó begépelését.</p></div><div class=paragraph><p>A hitelesítést az <a href="https://man.freebsd.org/cgi/man.cgi?query=ssh-agent&amp;sektion=1&amp;format=html">ssh-agent(1)</a> program kezeli a betöltött privát kulcsok alapján. Az <a href="https://man.freebsd.org/cgi/man.cgi?query=ssh-agent&amp;sektion=1&amp;format=html">ssh-agent(1)</a> használatával egy másik programot is elindhatunk, egy parancsértelmezõtõl kezdve egy ablakkezelõig szinte bármit.</p></div><div class=paragraph><p>Az <a href="https://man.freebsd.org/cgi/man.cgi?query=ssh-agent&amp;sektion=1&amp;format=html">ssh-agent(1)</a> programot úgy tudjuk egy parancsértelmezõben használni, hogy elõször is elindítjuk vele az adott parancsértelmezõt. Ezután az <a href="https://man.freebsd.org/cgi/man.cgi?query=ssh-add&amp;sektion=1&amp;format=html">ssh-add(1)</a> lefuttatásával hozzá kell adnunk egy identitást, annak jelmondatának megadásával. Miután ezeket megtettük, a felhasználó bármelyik olyan távoli gépre be tud jelentkezni, ahol a publikus kulcsát ismerik. Például:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>% ssh-agent csh
% ssh-add
Enter passphrase <span class=k>for</span> /home/felhasználó/.ssh/id_dsa:
Identity added: /home/felhasználó/.ssh/id_dsa <span class=o>(</span>/home/felhasználó/.ssh/id_dsa<span class=o>)</span>
%</code></pre></div></div><div class=paragraph><p>Az <a href="https://man.freebsd.org/cgi/man.cgi?query=ssh-agent&amp;sektion=1&amp;format=html">ssh-agent(1)</a> programot X11-el úgy tudjuk használni, ha az <span class=filename>~/.xinitrc</span> állományba tesszük bele. Ezzel az <a href="https://man.freebsd.org/cgi/man.cgi?query=ssh-agent&amp;sektion=1&amp;format=html">ssh-agent(1)</a> az összes X11-ben indított program számára rendelkezésre áll. Példának vegyük ezt az <span class=filename>~/.xinitrc</span> állományt:</p></div><div class="literalblock programlisting"><div class=content><pre>exec ssh-agent startxfce4</pre></div></div><div class=paragraph><p>Így az X11 indulásakor mindig elindul az <a href="https://man.freebsd.org/cgi/man.cgi?query=ssh-agent&amp;sektion=1&amp;format=html">ssh-agent(1)</a>, amely pedig elindítja az XFCE alkalmazást. Miután átírtuk a saját állományunkat, a rendszer életbeléptetéséhez indítsuk újra az X11-et, az <a href="https://man.freebsd.org/cgi/man.cgi?query=ssh-add&amp;sektion=1&amp;format=html">ssh-add(1)</a> futtatásával pedig töltsük be az összes SSH-kulcsunkat.</p></div></div><div class=sect3><h4 id=security-ssh-tunneling>14.11.8. Tunnelezés SSH-val<a class=anchor href=#security-ssh-tunneling></a></h4><div class=paragraph><p>Az OpenSSH-val létre tudunk hozni egy tunnelt, amellyel egy másik protokoll adatait tudjuk titkosított módon becsomagolni.</p></div><div class=paragraph><p>Az alábbi parancs arra utasítja az <a href="https://man.freebsd.org/cgi/man.cgi?query=ssh&amp;sektion=1&amp;format=html">ssh(1)</a> programot, hogy hozzon létre egy tunnelt a telnet használatához:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>% ssh <span class=nt>-2</span> <span class=nt>-N</span> <span class=nt>-f</span> <span class=nt>-L</span> 5023:localhost:23 felhasználó@izé.mizé.hu
%</code></pre></div></div><div class=paragraph><p>Az <code>ssh</code> parancsnak a következõ kapcsolókat adtuk meg:</p></div><div class=dlist><dl><dt class=hdlist1><code>-2</code></dt><dd><p>Az <code>ssh</code> parancs a protokoll második változatát használja. (Ne adjuk meg, ha régi SSH szerverekkel dolgozunk.)</p></dd><dt class=hdlist1><code>-N</code></dt><dd><p>Tunnel létrehozása. Ha nem adjuk meg, akkor az <code>ssh</code> egy hagyományos munkamenet felépítését kezdi meg.</p></dd><dt class=hdlist1><code>-f</code></dt><dd><p>Az <code>ssh</code> a háttérben fusson.</p></dd><dt class=hdlist1><code>-L</code></dt><dd><p>Egy helyi tunnel a <em>helyiport:távoligép:távoliport</em> felírásban.</p></dd><dt class=hdlist1><code>felhasználó@izé.mizé.hu</code></dt><dd><p>A távoli SSH szerver.</p></dd></dl></div><div class=paragraph><p>Az SSH által létrehozott járatok úgy mûködnek, hogy létrehozunk egy csatlakozást a <code>localhost</code> (a helyi gép) megadott portján. Ezután minden olyan kapcsolatot, ami a helyi gép adott portjára érkezik, SSH-n keresztül átirányítunk a távoli gép portjára.</p></div><div class=paragraph><p>Ebben a példában a helyi gép <em>5023</em> portját átirányítjuk a helyi gép <em>23</em> portjára. Mivel a <em>23</em> a telnet portja, ezért az így definiált SSH járattal egy biztonságos telnet munkamenetet hozunk létre.</p></div><div class=paragraph><p>Ezen a módon tetszõleges nem biztonságos TCP protokollt, például SMTP-t, POP3-at, FTP-t stb. be tudunk csomagolni.</p></div><div class=exampleblock><div class=title>Példa 20. Biztonságos tunnel létrehozása SSH-val SMTP-hez</div><div class=content><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>% ssh <span class=nt>-2</span> <span class=nt>-N</span> <span class=nt>-f</span> <span class=nt>-L</span> 5025:localhost:25 felhasználó@levelező.szerver.hu
felhasználó@levelező.szerver.hu<span class=s1>&#39;s password: *****
% telnet localhost 5025
Trying 127.0.0.1...
Connected to localhost.
Escape character is &#39;</span>^]<span class=s1>&#39;.
220 levelező.szerver.hu ESMTP</span></code></pre></div></div><div class=paragraph><p>Az <a href="https://man.freebsd.org/cgi/man.cgi?query=ssh-keygen&amp;sektion=1&amp;format=html">ssh-keygen(1)</a> és további felhasználói hozzáférések alkalmazásával ezen a módon ki tudunk alakítani egy minden további problémától és zûrtõl mentes SSH tunnelezési környezetet. A jelszavak helyett kulcsokat használunk és minden tunnel külön felhasználóként is futtatható.</p></div></div></div><div class=sect4><h5 id=_gyakorlati_példák_a_tunnelek_használatára>14.11.8.1. Gyakorlati példák a tunnelek használatára<a class=anchor href=#_gyakorlati_példák_a_tunnelek_használatára></a></h5><div class=sect5><h6 id=_egy_pop3_szerver_biztonságos_elérése>14.11.8.1.1. Egy POP3 szerver biztonságos elérése<a class=anchor href=#_egy_pop3_szerver_biztonságos_elérése></a></h6><div class=paragraph><p>Tegyük fel, hogy a munkahelyünkön van egy SSH szerver, amire kívülrõl lehet csatlakozni, illetve vele egy hálózatban van egy POP3 levelezõ szerver is. A munkahelyünk és az otthonunk között levõ hálózati útvonalat részben vagy teljesen nem tartjuk megbízhatónak. Ezért az e-mailjeinket valamilyen biztonságos módon szeretnénk elérni. Ezt úgy tudjuk megvalósítani, ha otthonról csatlakozunk a munkahelyen levõ SSH szerverre és ezen keresztül érjük a levelezõ szervert.</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>% ssh <span class=nt>-2</span> <span class=nt>-N</span> <span class=nt>-f</span> <span class=nt>-L</span> 2110:levél.gép.hu:110 felhasználó@ssh-szerver.gép.hu
felhasználó@ssh-szerver.gép.hu<span class=s1>&#39;s password: ******</span></code></pre></div></div><div class=paragraph><p>Miután a tunnel létrejött és mûködõképes, állítsuk be a levelezõ kliensünkben, hogy a POP3 kéréseket a <code>localhost</code> 2110 portjára küldje. Innen pedig biztonságos módon megy tovább a <code>levél.gép.hu</code> címre.</p></div></div><div class=sect5><h6 id=_egy_szigorú_tûzfal_megkerülése>14.11.8.1.2. Egy szigorú tûzfal megkerülése<a class=anchor href=#_egy_szigorú_tûzfal_megkerülése></a></h6><div class=paragraph><p>Egyes hálózati adminisztrátorok túlságosan szigorú szabályokat adnak meg a tûzfalban, és nem csak a bejövõ kapcsolatokat szûrik, hanem a kimenõket is. A távoli gépekhez csak a 22 (SSH) és 80 (böngészés) portjaikon tudunk csatlakozni.</p></div><div class=paragraph><p>Mi viszont szeretnénk más (nem egészen a munkánkkal kapcsolatos) szolgáltatásokat is elérni, például egy Ogg Vorbis szerverrõl zenét hallgatni. Ehhez a szerverhez viszont csak akkor tudnánk csatlakozni, ha a 22 vagy 80 portokon üzemelne.</p></div><div class=paragraph><p>Ezt a problémát úgy oldhatjuk meg, ha felépítünk egy SSH kapcsolatot a hálózatunk tûzfalán kívül levõ számítógéppel és segítségével átbújunk az Ogg Vorbis szerverhez.</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>% ssh <span class=nt>-2</span> <span class=nt>-N</span> <span class=nt>-f</span> <span class=nt>-L</span> 8888:zene.gép.hu:8000 felhasználó@tűzfalazatlan-rendszer.gép.org
felhasználó@tűzfalazatlan-rendszer.gép.org<span class=s1>&#39;s password: *******</span></code></pre></div></div><div class=paragraph><p>A zenelejátszó kliensüknek adjuk meg a <code>localhost</code> 8888 portját, amely pedig a tûzfal sikeres kijátszásával továbbítódik a <code>zene.gép.hu</code> 8000-res portjára.</p></div></div></div></div><div class=sect3><h4 id=_az_allowusers_felhasználói_beállítás>14.11.9. Az <code>AllowUsers</code> felhasználói beállítás<a class=anchor href=#_az_allowusers_felhasználói_beállítás></a></h4><div class=paragraph><p>Gyakran nem árt korlátozni a felhasználók bejelentkezését. Az <code>AllowUsers</code> erre tökéletesen megfelel. Például, ha csak <code>192.168.1.32</code> címrõl engedjük bejelentkezni a <code>root</code> felhasználót, akkor ehhez valami ilyesmit kell beírnunk az <span class=filename>/etc/ssh/sshd_config</span> állományba:</p></div><div class="literalblock programlisting"><div class=content><pre>AllowUsers root@192.168.1.32</pre></div></div><div class=paragraph><p>Ezzel pedig csupán nevének megadásával engedélyezzük az <code>admin</code> felhasználó bejelentkezését (bárhonnan):</p></div><div class="literalblock programlisting"><div class=content><pre>AllowUsers admin</pre></div></div><div class=paragraph><p>Egy sorban több felhasználó is megadható, mint például:</p></div><div class="literalblock programlisting"><div class=content><pre>AllowUsers root@192.168.1.32 admin</pre></div></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Ilyenkor ne felejtsük el megadni az összes bejelentkezésre (valamilyen formában) jogosult felhasználót megadni, máskülönben kizárjuk ezeket.</p></div></td></tr></tbody></table></div><div class=paragraph><p>Miután elvégeztük a szükséges változtatásokat az <span class=filename>/etc/ssh/sshd_config</span> állományban, utasítsuk az <a href="https://man.freebsd.org/cgi/man.cgi?query=sshd&amp;sektion=8&amp;format=html">sshd(8)</a> démont a konfigurációs állományok újraolvasására:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># /etc/rc.d/sshd reload</span></code></pre></div></div></div><div class=sect3><h4 id=_ajánlott_olvasnivalók_angolul>14.11.10. Ajánlott olvasnivalók (angolul)<a class=anchor href=#_ajánlott_olvasnivalók_angolul></a></h4><div class=paragraph><p><a href=http://www.openssh.com/>OpenSSH</a></p></div><div class=paragraph><p><a href="https://man.freebsd.org/cgi/man.cgi?query=ssh&amp;sektion=1&amp;format=html">ssh(1)</a> <a href="https://man.freebsd.org/cgi/man.cgi?query=scp&amp;sektion=1&amp;format=html">scp(1)</a> <a href="https://man.freebsd.org/cgi/man.cgi?query=ssh-keygen&amp;sektion=1&amp;format=html">ssh-keygen(1)</a> <a href="https://man.freebsd.org/cgi/man.cgi?query=ssh-agent&amp;sektion=1&amp;format=html">ssh-agent(1)</a> <a href="https://man.freebsd.org/cgi/man.cgi?query=ssh-add&amp;sektion=1&amp;format=html">ssh-add(1)</a> <a href="https://man.freebsd.org/cgi/man.cgi?query=ssh_config&amp;sektion=5&amp;format=html">ssh_config(5)</a></p></div><div class=paragraph><p><a href="https://man.freebsd.org/cgi/man.cgi?query=sshd&amp;sektion=8&amp;format=html">sshd(8)</a> <a href="https://man.freebsd.org/cgi/man.cgi?query=sftp-server&amp;sektion=8&amp;format=html">sftp-server(8)</a> <a href="https://man.freebsd.org/cgi/man.cgi?query=sshd_config&amp;sektion=5&amp;format=html">sshd_config(5)</a></p></div></div></div><div class=sect2><h3 id=fs-acl>14.12. Az állományrendszerek hozzáféréseit vezérlõ listák<a class=anchor href=#fs-acl></a></h3><div class=paragraph><p>A FreeBSD 5.0 és késõbbi változatai különbözõ fejlesztéseket hoztak az állományrendszerekben, például a pillanatképek készítése vagy a hozzáférés-vezérlési listák (Access Control List, ACL-ek) támogatása.</p></div><div class=paragraph><p>A hozzáférés-vezérlési listák a szabványos UNIX®-os engedély modellt bõvítik ki egy igen kompatibilis (POSIX®.1e) módon. Használatával a rendszergazdák egy sokkal kifinomultabb biztonsági modellt tudhatnak a kezük ügyében.</p></div><div class=paragraph><p>Az UFS állományrendszerek ACL támogatását úgy tudjuk engedélyezni, ha a rendszermagot az</p></div><div class="literalblock programlisting"><div class=content><pre>options UFS_ACL</pre></div></div><div class=paragraph><p>paraméterrel fordítjuk le. Amennyiben ezt nem fordítottuk bele, akkor az ACL támogatással rendelkezõ állományrendszerek csatlakoztatása során egy figyelmeztetést kapunk. Ez az opció a <span class=filename>GENERIC</span> rendszermag része. Az ACL az állományrendszeren engedélyezett kiterjesztett tulajdonságokra támaszkodik. Ezeket a kiterjesztett tulajdonságokat a következõ generációs UNIX® állományrendszer, az UFS2 már alapból ismeri.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>UFS1 típusú állományrendszereken sokkal nagyobb a kiterjesztett tulajdonságok kezelésének költsége, mint az UFS2 esetében. Az UFS2 jóval nagyobb teljesítménnyel képes dolgozni a kiterjesztett tulajdonságokkal. Emiatt a hozzáférés-vezérlési listák használatához az UFS2 sokkal inkább ajánlott, mint az UFS1.</p></div></td></tr></tbody></table></div><div class=paragraph><p>Az ACL használatát a csatlakoztatáskor megadott <code>acls</code> beállítással engedélyezhetjük, amelyet érdemes felvennünk az <span class=filename>/etc/fstab</span> állományba. Ha a <a href="https://man.freebsd.org/cgi/man.cgi?query=tunefs&amp;sektion=8&amp;format=html">tunefs(8)</a> segédprogrammal az állományrendszer fejlécében levõ szuperblokk ACL kapcsolóját átírjuk, akkor ez a beállítás automatikussá tehetõ. A szuperblokk használata több okból is ajánlatos:</p></div><div class=ulist><ul><li><p>A csatlakoztatáskor megadott ACL beállítás nem változtatható egy egyszerû újracsatlakoztatással (<a href="https://man.freebsd.org/cgi/man.cgi?query=mount&amp;sektion=8&amp;format=html">mount(8)</a> <code>-u</code>), csak egy teljes leválasztással (<a href="https://man.freebsd.org/cgi/man.cgi?query=umount&amp;sektion=8&amp;format=html">umount(8)</a>) és egy friss csatlakoztatással (<a href="https://man.freebsd.org/cgi/man.cgi?query=mount&amp;sektion=8&amp;format=html">mount(8)</a>). Ennek értelmében az ACL-ek a rendszerindító állományrendszeren a rendszer indulása után nem engedélyezhetõek. Ám ez azt is jelenti, hogy egy már használatban levõ állományrendszer beállításai sem változtathatóak meg.</p></li><li><p>Ha a kapcsolót a szuperblokkban állítjuk be, akkor az állományrendszert még akkor is ACL támogatással csatlakoztatja a rendszer, ha azt nem adtuk meg az <span class=filename>fstab</span> állományban vagy az eszközeink átrendezõdtek. Így az állományrendszereket még véletlenül sem tudjuk ACL használata nélkül csatlakoztatni, ami egyébként így komoly biztonsági problémákat okozhatna.</p></li></ul></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Beállíthatjuk úgy is ACL kezelését, hogy egy friss csatlakoztatás nélkül is bekapcsolható legyen, azonban az ilyen állományrendszerek ACL nélküli csatlakoztatását nem ajánljuk senkinek, mivel ha egyszer már engedélyeztük a használatukat, majd kikapcsoljuk ezeket és végül a kiterjesztett tulajdonságok törlése nélkül újra engedélyezzük, akkor nagyon könnyen pórul járhatunk. Ha elkezdtük használni az ACL-eket egy állományrendszeren, akkor ne tiltsuk le ezeket, mert az így keletkezõ állományvédelem nem feltétlenül lesz kompatibilis a felhasználók által beállítottakkal, és az ACL újraengedélyezése a változásaik elõtti korábbi ACL engedélyeket fogja visszaállítani az állományokra, aminek hatása kiszámíthatatlan.</p></div></td></tr></tbody></table></div><div class=paragraph><p>A hozzáférés-vezérlési listákat használó állományrendszerek esetén egy <code>+</code> (plusz) jellel ábrázolják a kiterjesztett engedélyeket. Például:</p></div><div class="literalblock programlisting"><div class=content><pre>drwx------  2 robert  robert  512 Dec 27 11:54 private
drwxrwx---+ 2 robert  robert  512 Dec 23 10:57 könyvtár1
drwxrwx---+ 2 robert  robert  512 Dec 22 10:20 könyvtár2
drwxrwx---+ 2 robert  robert  512 Dec 27 11:57 könyvtár3
drwxr-xr-x  2 robert  robert  512 Nov 10 11:54 public_html</pre></div></div><div class=paragraph><p>Láthatjuk, hogy a <span class=filename>könyvtár1</span>, <span class=filename>könyvtár2</span> és <span class=filename>könyvtár3</span> könyvtárakhoz tartoznak ACL típusú engedélyek, míg a <span class=filename>public_html</span> könyvtárhoz nem.</p></div><div class=sect3><h4 id=_az_acl_ek_használata>14.12.1. Az ACL-ek használata<a class=anchor href=#_az_acl_ek_használata></a></h4><div class=paragraph><p>Az állományrendszerben található ACL engedélyeket a <a href="https://man.freebsd.org/cgi/man.cgi?query=getfacl&amp;sektion=1&amp;format=html">getfacl(1)</a> segédprogrammal nézhetjük meg. Például a <span class=filename>próba</span> állomány ACL engedélyeit a következõ paranccsal tudjuk megnézni:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>% getfacl próba
	<span class=c>#file:próba</span>
	<span class=c>#owner:1001</span>
	<span class=c>#group:1001</span>
	user::rw-
	group::r--
	other::r--</code></pre></div></div><div class=paragraph><p>Egy állomány ACL engedélyeit a <a href="https://man.freebsd.org/cgi/man.cgi?query=setfacl&amp;sektion=1&amp;format=html">setfacl(1)</a> segédprogrammal tudjuk megváltoztatni. Figyeljük meg:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>% setfacl <span class=nt>-k</span> próba</code></pre></div></div><div class=paragraph><p>A <code>-k</code> opció törli az összes ACL alapú engedélyt egy állományról vagy állományrendszerrõl. Ennél viszont sokkal hasznosabb a <code>-b</code> opció használata, mivel az meghagyja az ACL mûködéséhez szükséges alapvetõ mezõket.</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>% setfacl <span class=nt>-m</span> u:trhodes:rwx,group:web:r--,o::--- próba</code></pre></div></div><div class=paragraph><p>Ebben a fenti parancsban a <code>-m</code> opciót pedig arra használtuk, hogy módosítsuk az alapértelmezett ACL bejegyzéseket. Mivel az ezt megelõzõ parancsban teljesen töröltük még az elõredefiniált bejegyzéseket is, ez a parancs a megadott paraméterekkel kiegészítve ezeket vissza fogja állítani. Ügyeljünk arra, hogy ha olyan felhasználót vagy csoportot adunk meg, ami nem létezik a rendszerben, akkor a szabvány kimenetre egy <code>Invalid argument</code> hibaüzenetet kapunk.</p></div></div></div><div class=sect2><h3 id=security-portaudit>14.13. A külsõ programok biztonsági problémáinak figyelése<a class=anchor href=#security-portaudit></a></h3><div class=paragraph><p>Az utóbbi években a biztonsági kérdésekkel foglalkozó világban számos fejlesztésre került sor a sebezhetõségi figyelmeztetések feldolgozásában. Manapság tulajdonképpen bármilyen operációs rendszer fokozott veszélynek teszik ki magát a külsõ programok telepítésével és használatával.</p></div><div class=paragraph><p>A sebezhetõségekrõl beszámoló értesítések a biztonság egyik alapköve, azonban a FreeBSD projekt nem tud ilyen jelentéseket kiadni a FreeBSD alaprendszerén kívül minden egyes külsõ alkalmazáshoz. Azonban lehetõségünk van enyhíteni a külsõ csomagok sebezhetõségén és figyelmeztetni a rendszergazdákat az ismert biztonsági problémákra. A FreeBSD-nek van egy Portaudit nevû segédprogramja, amit kizárólag erre a célra hoztak létre.</p></div><div class=paragraph><p>A <a class=package href=https://cgit.freebsd.org/ports/tree/ports-mgmt/portaudit/>ports-mgmt/portaudit</a> port egy adatbázist használ, ahol a FreeBSD biztonsági csapata és a portok fejlesztõi tartják karban az ismert biztonsági problémákat.</p></div><div class=paragraph><p>A Portaudit használatának megkezdéséhez telepítsük a Portgyûjteménybõl:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># cd /usr/ports/ports-mgmt/portaudit &amp;&amp; make install clean</span></code></pre></div></div><div class=paragraph><p>A telepítési folyamat során a <a href="https://man.freebsd.org/cgi/man.cgi?query=periodic&amp;sektion=8&amp;format=html">periodic(8)</a> konfigurációs állományai is frissítõdnek, így a Portaudit is lefut a napi biztonsági ellenõrzések folyamán. Gondoskodjunk róla, hogy a <code>root</code> felhasználónak levélben elküldött a napi biztonsági értesítéseket rendesen elolvassuk. Nincs szükségünk további beállításokra.</p></div><div class=paragraph><p>A telepítés után a rendszergazda a következõ paranccsal tudja frissíteni a saját adatbázispéldányát és megnézni a pillanatnyilag telepített csomagok ismert sebezhetõségeit:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># portaudit -Fda</span></code></pre></div></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Ez az adatbázis a <a href="https://man.freebsd.org/cgi/man.cgi?query=periodic&amp;sektion=8&amp;format=html">periodic(8)</a> minden egy futásakor magától frissül, ezért ez a parancs lényegében elhagyható. Egyedül a soronkövetkezõ példákhoz kell kiadni.</p></div></td></tr></tbody></table></div><div class=paragraph><p>A Portgyûjteménybõl telepített külsõ alkalmazások megbízhatóságának ellenõrzését az alábbi parancs kiadásával bármikor elvégezhetjük:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># portaudit -a</span></code></pre></div></div><div class=paragraph><p>A Portaudit ennek hatására valahogy így fogja megjeleníteni a sebezhetõ csomagokat:</p></div><div class="literalblock programlisting"><div class=content><pre>Affected package: cups-base-1.1.22.0_1
Type of problem: cups-base -- HPGL buffer overflow vulnerability.
Reference: &lt;http://www.FreeBSD.org/ports/portaudit/40a3bca2-6809-11d9-a9e7-0001020eed82.html&gt;

1 problem(s) in your installed packages found.

You are advised to update or deinstall the affected package(s) immediately.</pre></div></div><div class=paragraph><p>Fordítása:</p></div><div class="literalblock programlisting"><div class=content><pre>Érintett csomag: cups-base-1.1.22.0_1
A probléma jellege: cups-base -- HPGL puffer túlcsordulási sebezhetõség.
Link: &lt;http://www.FreeBSD.org/ports/portaudit/40a3bca2-6809-11d9-a9e7-0001020eed82.html&gt;

A telepített csomagokkal kapcsolatban 1 problemát találtam.

Javasoljuk, hogy az érintett csomagokat azonnal frissítse vagy távolítsa el.</pre></div></div><div class=paragraph><p>Ha a böngészõnket az itt megadott címre irányítjuk, akkor megismerhetjük a kérdéses sebezhetõség pontosabb részleteit. Ezen az oldalon megtalálhatjuk a hiba által érintett verziókat a FreeBSD portok verziója szerint, illetve más olyan honlapokat, ahol biztonsági figyelmeztetéseket találhatunk.</p></div><div class=paragraph><p>Röviden összefoglalva, a Portaudit egy komoly segédeszköz és hitetlenül hasznos kiegészítõje a Portupgrade portnak.</p></div></div><div class=sect2><h3 id=security-advisories>14.14. A FreeBSD biztonsági figyelmeztetései<a class=anchor href=#security-advisories></a></h3><div class=paragraph><p>A FreeBSD több más kereskedelmi minõségû operációs rendszerhez hasonlóan "Biztonsági figyelmeztéseket" (Security Advisory) ad ki. Ezek a figyelmeztetések általában megjelennek a biztonsággal foglalkozó levelezési listákon és a hivatkozott hibák kijavítása után a megfelelõ kiadások hibajegyzékében is. Ebben a szakaszban megismerjük és értelmezzük ezeket a figyelmeztetéseket, valamint megtudhatjuk, milyen lépéseket kell megtennünk a rendszerünk kijavításához.</p></div><div class=sect3><h4 id=_hogyan_épül_fel_egy_figyelmeztetés>14.14.1. Hogyan épül fel egy figyelmeztetés?<a class=anchor href=#_hogyan_épül_fel_egy_figyelmeztetés></a></h4><div class=paragraph><p>A FreeBSD biztonsági figyelmeztetései az alább látható formában jelennek meg, amit mi most a <a href=https://lists.FreeBSD.org/subscription/freebsd-security-notifications>FreeBSD security notifications levelezési lista</a> levelezési listáról kölcsönöztünk.</p></div><div class="literalblock programlisting"><div class=content><pre>=============================================================================
FreeBSD-SA-XX:XX.UTIL                                     Security Advisory
                                                          The FreeBSD Project

Topic:          denial of service due to some problem<i class=conum data-value=1></i><b>(1)</b>

Category:       core<i class=conum data-value=2></i><b>(2)</b>
Module:         sys<i class=conum data-value=3></i><b>(3)</b>
Announced:      2003-09-23<i class=conum data-value=4></i><b>(4)</b>
Credits:        Person@EMAIL-ADDRESS<i class=conum data-value=5></i><b>(5)</b>
Affects:        All releases of FreeBSD<i class=conum data-value=6></i><b>(6)</b>
                FreeBSD 4-STABLE prior to the correction date
Corrected:      2003-09-23 16:42:59 UTC (RELENG_4, 4.9-PRERELEASE)
                2003-09-23 20:08:42 UTC (RELENG_5_1, 5.1-RELEASE-p6)
                2003-09-23 20:07:06 UTC (RELENG_5_0, 5.0-RELEASE-p15)
                2003-09-23 16:44:58 UTC (RELENG_4_8, 4.8-RELEASE-p8)
                2003-09-23 16:47:34 UTC (RELENG_4_7, 4.7-RELEASE-p18)
                2003-09-23 16:49:46 UTC (RELENG_4_6, 4.6-RELEASE-p21)
                2003-09-23 16:51:24 UTC (RELENG_4_5, 4.5-RELEASE-p33)
                2003-09-23 16:52:45 UTC (RELENG_4_4, 4.4-RELEASE-p43)
                2003-09-23 16:54:39 UTC (RELENG_4_3, 4.3-RELEASE-p39)<i class=conum data-value=7></i><b>(7)</b>
CVE Name:	CVE-XXXX-XXXX<i class=conum data-value=8></i><b>(8)</b>

For general information regarding FreeBSD Security Advisories,
including descriptions of the fields above, security branches, and the
following sections, please visit
http://www.FreeBSD.org/security/.

I.   Background<i class=conum data-value=9></i><b>(9)</b>

II.  Problem Description<i class=conum data-value=10></i><b>(10)</b>

III. Impact<i class=conum data-value=11></i><b>(11)</b>

IV.  Workaround<i class=conum data-value=12></i><b>(12)</b>

V.   Solution<i class=conum data-value=13></i><b>(13)</b>

VI.  Correction details<i class=conum data-value=14></i><b>(14)</b>

VII. References<i class=conum data-value=15></i><b>(15)</b></pre></div></div><div class="colist arabic"><table><tbody><tr><td><i class=conum data-value=1></i><b>1</b></td><td>A <code>Topic</code> mezõben olvashatjuk pontosan mi is maga a probléma. Alapvetõen bemutatja az érintett biztonsági figyelmeztetést és megemlíti a sebezhetõ segédprogramot.</td></tr><tr><td><i class=conum data-value=2></i><b>2</b></td><td>A <code>Category</code> mezõ hivatkozik a rendszer azon részére, amelyre a hiba kihatással lehet. Értéke lehet <code>core</code>, <code>contrib</code> vagy <code>ports</code>. A <code>core</code> kategória azt jelzi, hogy a sebezhetõség a FreeBSD legfontosabb komponenseit érinti. A <code>contrib</code> kategória a FreeBSD projekt számára felajánlott szoftverek, mint például a sendmail sebezhetõségére utal. Végezetül a <code>ports</code> kategória jelzi, hogy a sebezhetõség valamelyik, a Portgyûjteményben szereplõ szoftverre érvényes.</td></tr><tr><td><i class=conum data-value=3></i><b>3</b></td><td>A <code>Module</code> mezõ a sebezhetõ komponens helyét nevezi meg, például <code>sys</code>. Ebben a példában azt láthatjuk, hogy a <code>sys</code> modul a hibás. Ezért a sebezhetõség egy rendszermagban használt komponenst érint.</td></tr><tr><td><i class=conum data-value=4></i><b>4</b></td><td>Az <code>Announced</code> mezõ a biztonsági figyelmeztetés kiadásának vagy széleskörû kihirdetésének dátumát rögzíti. Ez azt jelenti, hogy a biztonsági csapat meggyõzõdött a probléma létezésérõl és a hibát orvosoló javítás már felkerült a FreeBSD forráskódjába.</td></tr><tr><td><i class=conum data-value=5></i><b>5</b></td><td>A <code>Credits</code> mezõ azokat az egyéneket vagy szervezeteket említi meg, akik észlelték a sebezhetõséget és jelentették.</td></tr><tr><td><i class=conum data-value=6></i><b>6</b></td><td>Az <code>Affects</code> mezõben megadják, hogy a FreeBSD melyik kiadásaira van hatással a sebezhetõség. Ha a rendszermag esetén lefuttatjuk az <code>ident</code> parancsot az érintett állományokra, akkor megtudhatjuk a pontos revíziójukat. A portoknál a verziószám a port neve után szerepel a <span class=filename>/var/db/pkg</span> könyvtárban. Ha a rendszerünket nem frissítettük CVS-rõl és fordítottuk újra, akkor nagy a valószínûsége, hogy a sebezhetõség minket is érint.</td></tr><tr><td><i class=conum data-value=7></i><b>7</b></td><td>A <code>Corrected</code> mezõ tartalmazza a a kijavítás dátumát, idejét, idõzónáját és az ezt tartalmazó kiadást.</td></tr><tr><td><i class=conum data-value=8></i><b>8</b></td><td>Az ismert sebezhetõségek adatbázisában (Common Vulnerabilities Database, CVD) használt azonosítási információk alapján végzett keresések számára fenntartott.</td></tr><tr><td><i class=conum data-value=9></i><b>9</b></td><td>A <code>Background</code> mezõ adja meg részleteiben a sebezhetõ programmal kapcsolatos tudnivalókat. Az esetek többségében itt írják le, hogy miért jött létre az adott eszköz a FreeBSD-ben, mire használják és hogyan keletkezett.</td></tr><tr><td><i class=conum data-value=10></i><b>10</b></td><td>A <code>Problem Description</code> mezõ a biztonsági rést részletezi. Ebben a részben szerepelhet a hibás kódrészlet vagy akár még az is, hogy miként kell vele elõidézni a hibát.</td></tr><tr><td><i class=conum data-value=11></i><b>11</b></td><td>Az <code>Impact</code> mezõ a probléma lehetséges hatásait írja körül a rendszerben. Ez például lehet egy DoS támadás, speciális engedélyek ellopása vagy akár a rendszeradminisztrátori jogok megszerzése.</td></tr><tr><td><i class=conum data-value=12></i><b>12</b></td><td>A <code>Workaround</code> mezõ igyekszik elfogadható megoldást nyújtani a rendszerük frissítésére képtelen rendszergazdák számára. Ennek oka lehet az idõ rövidsége, a hálózati elérhetõség vagy más okokból fakadó elcsúszás. Ennek ellenére a biztonsági kérdéseket sosem szabad félvállról venni, ezért a sebezhetõ rendszereket vagy ki kell javítani vagy valamilyen módon meg kell kerülni a biztonsági rés kialakulását.</td></tr><tr><td><i class=conum data-value=13></i><b>13</b></td><td>A <code>Solution</code> mezõ utasításokkal segít a rendszer kijavítását. Ez egy lépésrõl lépésre tesztelt és ellenõrzött módszer, amellyel a rendszerünket megfelelõen ki tudjuk javítani és biztonságossá tenni.</td></tr><tr><td><i class=conum data-value=14></i><b>14</b></td><td>A <code>Correction Details</code> mezõ mutatja a CVS-ág vagy kiadás nevét, amelyben a pontokat aláhúzásra cserélték. Ezenkívül még az egyes ágakban az érintett állományok revízióját is mutatja.</td></tr><tr><td><i class=conum data-value=15></i><b>15</b></td><td>A <code>References</code> mezõ általában a témával kapcsolatos további forrásokat kínálja fel URL, könyv, levelezési lista vagy hírcsoport formájában.</td></tr></tbody></table></div></div></div><div class=sect2><h3 id=security-accounting>14.15. A futó programok nyilvántartása<a class=anchor href=#security-accounting></a></h3><div class=paragraph><p>A futó programok nyilvántartása olyan biztonsági módszer, ahol a rendszergazda figyelemmel kíséri a rendszer használatban levõ erõforrásait, a felhasználók közti megoszlását, gondoskodik a rendszer felügyeletérõl és valamennyire nyomon követi a felhasználók parancsait.</p></div><div class=paragraph><p>Ennek a módszernek egyaránt megvannak a maga elõnyei és hátrányai. Az egyik elõnye, hogy a használatával a behatolás egészen a betörés pontjáig visszakövethetõ. Hátranya viszont, hogy a futó programok nyilvántartása rengeteg mennyiségû naplót generál és ehhez sok lemezterületre lesz szükségünk. Ebben a szakaszban végigjárjuk a programok nyilvántartásának alapjait.</p></div><div class=sect3><h4 id=_a_futó_programok_nyilvántartásának_engedélyezése_és_használata>14.15.1. A futó programok nyilvántartásának engedélyezése és használata<a class=anchor href=#_a_futó_programok_nyilvántartásának_engedélyezése_és_használata></a></h4><div class=paragraph><p>A futó programok nyilvántartását elõször engedélyeznünk kell. Ehhez a következõ parancsokat kell kiadnunk:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># touch /var/account/acct</span>

<span class=c># accton /var/account/acct</span>

<span class=c># echo &#39;accounting_enable=&#34;YES&#34;&#39; &gt;&gt; /etc/rc.conf</span></code></pre></div></div><div class=paragraph><p>Miután aktiváltuk, a nyilvántartást elkezdi számbavenni a processzor kihasználtságát, a parancsokat stb. A nyilvántartás emberek számára nem olvasható formátumban készül, ezért csak az <a href="https://man.freebsd.org/cgi/man.cgi?query=sa&amp;sektion=8&amp;format=html">sa(8)</a> segédprogrammal tudjuk megnézni. Ha nem adunk meg neki semmilyen opciót, akkor az <code>sa</code> kilistázza a felhasználónkénti hívásokat, az összes eltelt idõt percben, a teljes processzor- és felhasználói idõt percben, az I/O mûveletek átlagos számát stb.</p></div><div class=paragraph><p>A kiadott parancsokról a <a href="https://man.freebsd.org/cgi/man.cgi?query=lastcomm&amp;sektion=1&amp;format=html">lastcomm(1)</a> programmal tudunk tájékozódni. A <code>lastcomm</code> segítségével ki tudjuk íratni a felhasználók adott terminálon kiadott parancsait is, mint például:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># lastcomm ls</span>
	trhodes ttyp1</code></pre></div></div><div class=paragraph><p>Ezzel megjelenik a <code>trhodes</code> nevû felhasználó <code>ttyp1</code> terminálon kiadott összes ismert <code>ls</code> parancsa.</p></div><div class=paragraph><p>Számos hasznos beállítást és hozzájuk tartozó leírást találhatunk még a <a href="https://man.freebsd.org/cgi/man.cgi?query=lastcomm&amp;sektion=1&amp;format=html">lastcomm(1)</a>, <a href="https://man.freebsd.org/cgi/man.cgi?query=acct&amp;sektion=5&amp;format=html">acct(5)</a> és <a href="https://man.freebsd.org/cgi/man.cgi?query=sa&amp;sektion=8&amp;format=html">sa(8)</a> man oldalakon.</p></div></div></div></div></div><div class=sect1><h2 id=jails>Chapter 15. A jail alrendszer<a class=anchor href=#jails></a></h2><div class=sectionbody><div class=sect2><h3 id=jails-synopsis>15.1. Áttekintés<a class=anchor href=#jails-synopsis></a></h3><div class=paragraph><p>Ez a fejezet a FreeBSD-ben található jail alrendszert, valamint annak használatát mutatja be közelebbrõl. Az jail, melyet gyakran csak úgy emlegetnek, mint a <em>chroot környezetek</em> továbbfejlesztését, a rendszergazdák számára ajánlott, nagyon sokoldalú eszköz, de a haladó felhasználók is hasznosnak találhatják.</p></div><div class=paragraph><p>A fejezet elolvasása során megismerjük:</p></div><div class=ulist><ul><li><p>mi is az a jail, milyen célra használható a FreeBSD-ben;</p></li><li><p>hogyan hozzunk létre, indítsunk el és állítsunk le jaileket;</p></li><li><p>a létrehozott jailek karbantartásainak alapjait, a jailek belülrõl és kívülrõl egyaránt.</p></li></ul></div><div class=paragraph><p>A jail alrendszerrõl még több hasznos információt a következõ helyekrõl tudhatunk meg:</p></div><div class=ulist><ul><li><p>A <a href="https://man.freebsd.org/cgi/man.cgi?query=jail&amp;sektion=8&amp;format=html">jail(8)</a> man oldal. Ez tartalmazza a <code>jail</code> segédprogram teljes referenciáját - ez az a karbantartásra használható eszköz, amellyel el tudjuk indítani, le tudjuk állítani és vezérelni tudjuk a jaileket a FreeBSD-ben.</p></li><li><p>A levelezési listák és azok archívumai. A <a href=https://lists.FreeBSD.org/subscription/freebsd-questions>FreeBSD general questions levelezési lista</a> archívuma és a <a href=https://lists.freebsd.org>FreeBSD lista szerver</a>en található többi levelezési lista rengeteg olvasnivalót tartogat a jailekkel kapcsolatban. Mindig érdemes keresni ezekben az archívumokban, vagy beküldeni a kérdésünket a <a href=https://lists.FreeBSD.org/subscription/freebsd-questions>freebsd-questions</a> levelezési listára.</p></li></ul></div></div><div class=sect2><h3 id=jails-terms>15.2. A jail alrendszerhez kapcsolódó fogalmak<a class=anchor href=#jails-terms></a></h3><div class=paragraph><p>A fejezet további részében a következõ fogalmakat fogjuk használni, hogy a FreeBSD jailekhez tartozó egyes részeit és azok belsõ mûködését, valamint kapcsolatukat a rendszer többi részével még inkább érthetõvé tegyük:</p></div><div class=dlist><dl><dt class=hdlist1><a href="https://man.freebsd.org/cgi/man.cgi?query=chroot&amp;sektion=8&amp;format=html">chroot(8)</a> (parancs)</dt><dd><p>Egy segédprogram, amely a FreeBSD <a href="https://man.freebsd.org/cgi/man.cgi?query=chroot&amp;sektion=2&amp;format=html">chroot(2)</a> rendszerhívásán keresztül egy program és annak leszármazottjainak futtatásához megváltoztatja a rendszer gyökérkönyvtárát (change root).</p></dd><dt class=hdlist1><a href="https://man.freebsd.org/cgi/man.cgi?query=chroot&amp;sektion=2&amp;format=html">chroot(2)</a> (környezet)</dt><dd><p>A "chroot" módban futó programok környezete. Olyan erõforrásokat foglal magában, mint mondjuk az állományrendszer látható része, az elérhetõ felhasználói és csoport azonosítók, hálózati csatolók és egyéb folyamatok közti kommunikációs mechanizmusok stb.</p></dd><dt class=hdlist1><a href="https://man.freebsd.org/cgi/man.cgi?query=jail&amp;sektion=8&amp;format=html">jail(8)</a> (parancs)</dt><dd><p>Az a rendszerkarbantartó segédprogram, amely lehetõvé teszi program elindítását elzárt környezetben.</p></dd><dt class=hdlist1>befogadó (rendszer, program, felhasználó stb.)</dt><dd><p>Az elzárt környezetet irányító rendszer. A befogadó rendszer hozzá tud férni az összes elérhetõ hardveres erõforráshoz, képes az elzárt környezeten kívül és belül futó programokat vezérelni. Az egyik legfontosabb különbség a befogadó és az elzárt rendszer között, hogy azok a korlátozások, amelyek az elzárt környezetben rendszeradminisztrátori jogokkal futó programokra vonatkoznak, nem feltétlenül érvényesek a befogadó rendszerben futóakra.</p></dd><dt class=hdlist1>befogadott (rendszer, program, felhasználó stb.)</dt><dd><p>Olyan program, felhasználó vagy más egyéb egyed, amely csak egy jailen keresztül, korlátozottan tud hozzáférni az erõforrásokhoz.</p></dd></dl></div></div><div class=sect2><h3 id=jails-intro>15.3. Bevezetés<a class=anchor href=#jails-intro></a></h3><div class=paragraph><p>Mivel a rendszeradminisztráció egy nehéz és zavarba ejtõ feladat, rengeteg komoly eszköz jött létre a rendszergazdák életének megkönnyítésére. Ezek az eszközök többnyire a rendszerek telepítését, beállítását és karbantartását igyekeznek valamilyen módon jobbá tenni. A rendszergazdák egyik feladata úgy gondoskodni a biztonságról, hogy közben a rendszer képes legyen ellátni eredeti feladatát.</p></div><div class=paragraph><p>A FreeBSD rendszerek biztonságosságának növelését hivatott egyik ilyen eszköz a <em>jails</em>. Elõször a FreeBSD 4.X verziójában bukkant fel, de jelentõs fejlõdésen ment keresztül a FreeBSD 5.X verziókban, aminek köszönhetõen sokkal erõteljesebb és rugalmasabb alrendszerré vált. A fejlesztése természetesen most is folytatódik tovább, állandóan fejlõdik a használhatósága, teljesítménye, megbízhatósága és biztonságossága.</p></div><div class=sect3><h4 id=jails-what>15.3.1. Mi is az a jail?<a class=anchor href=#jails-what></a></h4><div class=paragraph><p>A BSD-szerû operációs rendszerekben már a 4.2BSD óta megtalálható volt a <a href="https://man.freebsd.org/cgi/man.cgi?query=chroot&amp;sektion=2&amp;format=html">chroot(2)</a>. A <a href="https://man.freebsd.org/cgi/man.cgi?query=chroot&amp;sektion=8&amp;format=html">chroot(8)</a> segédprogrammal meg tudjuk megváltoztatni adott programok számára a gyökérkönyvtárat, és ezzel egy biztonságos környezetet teremteni, távol a rendszer többi részétõl. A chroot-tal kialakított környezetben elinduló programok nem tudnak hozzáférni a rajta kívül található állományokhoz és erõforrásokhoz. Ennek okán, ha egy ilyen környezetben futó szolgáltatást megtámadnak, az önmagában még nem teszi lehetõvé a támadó számára, hogy elérhesse az egész rendszert. A <a href="https://man.freebsd.org/cgi/man.cgi?query=chroot&amp;sektion=8&amp;format=html">chroot(8)</a> remekül használható olyan egyszerûbb feladatok megoldására, amelyek nem igényelnek túlságosan sok rugalmasságot vagy bonyolult és fejlett támogatást. A chroot ötletének felmerülése óta azonban számos kiskaput találtak már az általa létrehozott környezetekben, és habár ezek mindegyikét javították a FreeBSD újabb változataiban, teljesen egyértelmûvé vált, hogy a <a href="https://man.freebsd.org/cgi/man.cgi?query=chroot&amp;sektion=2&amp;format=html">chroot(2)</a> nem biztosít járható utat a szolgáltatások biztonságossá tételéhez. Erre a feladatra egy új alrendszert kellett kiépíteni.</p></div><div class=paragraph><p>Ez az egyik oka annak, amiért az <em>jaileket</em> kifejlesztették.</p></div><div class=paragraph><p>A jailek által képviselt elzárás ötlete több szempontból is a hagyományos <a href="https://man.freebsd.org/cgi/man.cgi?query=chroot&amp;sektion=2&amp;format=html">chroot(2)</a> környezet elvén alapszik. Egy hagyományos <a href="https://man.freebsd.org/cgi/man.cgi?query=chroot&amp;sektion=2&amp;format=html">chroot(2)</a> környezetben futó programok korlátozása csupán abban merül ki, hogy az állományrendszer melyik részét láthatják. A rendszer többi erõforrása (mint mondjuk a felhasználók, futó programok vagy a hálózati alrendszer) azonban továbbra is megosztva marad a chroot környezetben és a befogadó rendszerben futó programok között. A jailek által alkalmazott megoldás kibõvíti ezt a modellt, és nem csak az állományrendszerre vonatkozó hozzáférést virtualizálja, hanem több más dolog mellett kiterjeszti ezt a felhasználókra és a FreeBSD hálózati alrendszerére is. Az elzárt környezetek beállításaihoz elérhetõ finomhangolási lehetõségekrõl bõvebben a <a href=#jails-tuning>Finomhangolás és karbantartás</a>ban esik szó.</p></div><div class=paragraph><p>A jaileket az alább négy elem írja le:</p></div><div class=ulist><ul><li><p>A könyvtárszerkezet egy részfája - attól a résztõl indulva, ahonnan a jail kezdõdik. A jailen belül futó programok nem léphetnek ki ebbõl a részfából. Az eredeti <a href="https://man.freebsd.org/cgi/man.cgi?query=chroot&amp;sektion=2&amp;format=html">chroot(2)</a> kialakításában merengõ biztonsági hibák lehetõségei nem veszélyeztetik a többi FreeBSD jailt.</p></li><li><p>A rendszer neve - a név, amelyet a jailen belül használunk. Mivel a jaileket elsõsorban hálózati szolgáltatások kordában tartására használjuk, a jailekhez tartozó beszédes rendszernevek sokat tudnak segíteni a rendszergazdák munkájában.</p></li><li><p>Egy IP-cím - a jailhez tartozik és nem változtatható meg a mûködése során. Egy jail IP-címe általában egy már létezõ hálózati csatoló másik címe, de ez nem szükségszerûen igaz minden esetben.</p></li><li><p>Egy parancs - annak a programnak az elérési útja, amelyet elzártan kívánunk futtatni. Az elzárt környezet gyökerétõl mérve relatívan adjuk meg, és az adott környezet típusától függõen eltérõ lehet.</p></li></ul></div><div class=paragraph><p>Ezektõl eltekintve a jailek rendelkezhetnek saját felhasználókkal és lehetnek saját <code>root</code> felhasználóik is. Természetesen a <code>root</code> hatásköre csak az elzárt környezetre korlátozódik, és a befogadó rendszer szemszögébõl az elzárt <code>root</code> nem mindenható. Ráadásul az elzárt <code>root</code> felhasználó nem hajthat végre semmilyen kritikus mûveletet a saját <a href="https://man.freebsd.org/cgi/man.cgi?query=jail&amp;sektion=8&amp;format=html">jail(8)</a> környezetén kívül. A <code>root</code> további képességeirõl és korlátozásairól lentiekben bõvebben is említést teszünk a <a href=#jails-tuning>Finomhangolás és karbantartás</a>ban.</p></div></div></div><div class=sect2><h3 id=jails-build>15.4. A jailek létrehozása és vezérlése<a class=anchor href=#jails-build></a></h3><div class=paragraph><p>Egyes rendszergazdák a jaileket a következõ két típusba sorolják: "teljes" jail, mely egy valódi FreeBSD rendszerre emlékeztet, és a "szolgáltatás" jail, mely egyetlen, feltehetõen kiemelt jogokkal futó alkalmazás vagy szolgáltatás számára van elõkészítve. Ez a besorolás csupán fogalmi szintû, a jail felépítésének módját nem befolyásolja. A <a href="https://man.freebsd.org/cgi/man.cgi?query=jail&amp;sektion=8&amp;format=html">jail(8)</a> man oldal részletesen ismerteti a jailek létrehozását:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># setenv D /itt/lesz/a/jail</span>
<span class=c># mkdir -p $D </span><i class=conum data-value=1></i><b>(1)</b>
<span class=c># cd /usr/src</span>
<span class=c># make buildworld </span><i class=conum data-value=2></i><b>(2)</b>
<span class=c># make installworld DESTDIR=$D </span><i class=conum data-value=3></i><b>(3)</b>
<span class=c># make distribution DESTDIR=$D </span><i class=conum data-value=4></i><b>(4)</b>
<span class=c># mount -t devfs devfs $D/dev </span><i class=conum data-value=5></i><b>(5)</b></code></pre></div></div><div class="colist arabic"><table><tbody><tr><td><i class=conum data-value=1></i><b>1</b></td><td>Érdemes elõször a jail helyét megválasztani. Itt fog fizikailag helyet foglalni a befogadó rendszer állományrendszerén belül a jail. Jó választás lehet erre a <span class=filename>/usr/jail/jailnév</span>, ahol a <em>jailnév</em> a jailt azonosító rendszernév. A <span class=filename>/usr/</span> állományrendszeren általában elegendõ hely jut a jail állományrendszerének, ami egy "teljes" jail esetén lényegében a FreeBSD alaprendszer alapértelmezett telepítésében megtalálható összes állomány másolatát tartalmazza.</td></tr><tr><td><i class=conum data-value=2></i><b>2</b></td><td>Ha korábban már a <code>make world</code> vagy a <code>make buildworld</code> parancs segítségével újrafordítottuk az alaprendszert, akkor ezt a lépést ki is hagyhatjuk és telepítsük az új alaprendszert közvetlenül az új jailbe.</td></tr><tr><td><i class=conum data-value=3></i><b>3</b></td><td>Ez a parancs fogja felmásolni a jail fizikai helyének választott könyvtár-részfába a mûködéshez szükséges programokat, függvénykönyvtárakat, man oldalakat és így tovább.</td></tr><tr><td><i class=conum data-value=4></i><b>4</b></td><td>A make paramétereként megadott <code>distribution</code> cél gondoskodik az összes szükséges konfigurációs állomány felmásolásáról. Magyarán szólva, átmásolja az összes telepíhetõ állományt a <span class=filename>/usr/src/etc/</span> könyvtárból a jail <span class=filename>/etc</span> alkönyvtárába, vagyis a <span class=filename>$D/etc/</span> könyvtárba.</td></tr><tr><td><i class=conum data-value=5></i><b>5</b></td><td>A jaileken belül a <a href="https://man.freebsd.org/cgi/man.cgi?query=devfs&amp;sektion=8&amp;format=html">devfs(8)</a> csatlakoztatása nem kötelezõ. Másrészt azonban majdnem mindegyik alkalmazás, a feladatától függõen, legalább egy eszközhöz hozzá akar férni. Nagyon fontos, hogy a kezünkbe vegyük a eszközök hozzáférésének irányítását a jaileken belül, mivel a helytelen beállítások révén a támadók csúnya dolgokat tudnak majd mûvelni. A <a href="https://man.freebsd.org/cgi/man.cgi?query=devfs&amp;sektion=8&amp;format=html">devfs(8)</a> mûködését a <a href="https://man.freebsd.org/cgi/man.cgi?query=devfs&amp;sektion=8&amp;format=html">devfs(8)</a> és <a href="https://man.freebsd.org/cgi/man.cgi?query=devfs.conf&amp;sektion=5&amp;format=html">devfs.conf(5)</a> man oldalakon is ismertetett szabályrendszerek irányítják.</td></tr></tbody></table></div><div class=paragraph><p>Ahogy a jailt telepítettük, a <a href="https://man.freebsd.org/cgi/man.cgi?query=jail&amp;sektion=8&amp;format=html">jail(8)</a> segédprogrammal tudjuk elindítani. A <a href="https://man.freebsd.org/cgi/man.cgi?query=jail&amp;sektion=8&amp;format=html">jail(8)</a> négy kötelezõ paramétert vár, melyekre a <a href=#jails-what>Mi is az a jail?</a>ban ki is térünk. Más paramétereket is megadhatunk, például azt, hogy az elzárt program egy adott felhasználó jogaival fusson. A <code><em>command</em></code> paraméter használata a jail típusától függ: egy <em>virtuális rendszer</em> esetében a <span class=filename>/etc/rc</span> jó választásnak bizonyulhat, mivel ennek segítségével egy valódi FreeBSD rendszerindítási folyamatát játszhatjuk le. Amennyiben elzárt <em>szolgáltatás</em>ról van szól, az adott szolgáltatástól vagy alkalmazástól függ.</p></div><div class=paragraph><p>A jaileket gyakran már a rendszerindítás során elindítják, amit a FreeBSD <span class=filename>rc</span> mechanizmusa nagyban meg is könnyít.</p></div><div class="exampleblock procedure"><div class=content><div class="olist arabic"><ol class=arabic><li><p>A rendszer indítása során aktiválandó jailek listáját vegyük hozzá a <a href="https://man.freebsd.org/cgi/man.cgi?query=rc.conf&amp;sektion=5&amp;format=html">rc.conf(5)</a> állományhoz:</p><div class="literalblock programlisting"><div class=content><pre>jail_enable=&#34;YES&#34;   # Ide NO-t írjunk, ha ki akarjuk kapcsolni
jail_list=&#34;www&#34;     # Szóközzel elválasztva soroljuk fel a jaileket</pre></div></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>A <code>jail_list</code> értékeként felsorolt jailek nevei csak betûket és számjegyeket tartalmazhatnak.</p></div></td></tr></tbody></table></div></li><li><p>A <code>jail_list</code>-ben szereplõ összes jailt meg kell adnunk az ezeket leíró <a href="https://man.freebsd.org/cgi/man.cgi?query=rc.conf&amp;sektion=5&amp;format=html">rc.conf(5)</a>-beli beállításokat:</p><div class="literalblock programlisting"><div class=content><pre>jail_www_rootdir=&#34;/usr/jail/www&#34;     # a jail gyökérkönyvtára
jail_www_hostname=&#34;www.example.org&#34;  # a jail neve
jail_www_ip=&#34;192.168.0.10&#34;           # a jail IP-címe
jail_www_devfs_enable=&#34;YES&#34;          # legyen-e devfs a jailen belül
jail_www_devfs_ruleset=&#34;www_ruleset&#34; # az alkalmazott devfs szabályrendszer</pre></div></div><div class=paragraph><p>Az <a href="https://man.freebsd.org/cgi/man.cgi?query=rc.conf&amp;sektion=5&amp;format=html">rc.conf(5)</a> állományban szereplõ jailek esetén a <span class=filename>/etc/rc</span> szkript fut le, tehát feltételezi, hogy az így megadott jail egy teljes virtuális rendszer. A szolgáltatások jailbe foglalásához meg kell változtatnunk a jail alapértelmezett parancsát is. Ezt a <code>jail<em>jailnév</em>exec_start</code> opció megfelelõ beállításával tudjuk megtenni.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Az összes itt elérhetõ opciót a <a href="https://man.freebsd.org/cgi/man.cgi?query=rc.conf&amp;sektion=5&amp;format=html">rc.conf(5)</a> man oldalon találhatjuk meg.</p></div></td></tr></tbody></table></div></li></ol></div></div></div><div class=paragraph><p>Ha léteznek a megfelelõ bejegyzések az <span class=filename>rc.conf</span> állományban, akkor az <span class=filename>/etc/rc.d/jail</span> szkript is használható arra, hogy a jaileket kézzel indítsuk el vagy állítsuk le:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># /etc/rc.d/jail start www</span>
<span class=c># /etc/rc.d/jail stop www</span></code></pre></div></div><div class=paragraph><p>A <a href="https://man.freebsd.org/cgi/man.cgi?query=jail&amp;sektion=8&amp;format=html">jail(8)</a> leállítására jelen pillanatban még nem érhetõ el szabályos módszer. Ez azért van, mert a szabályos rendszerleállítást elvégzõ parancsok nem használhatóak a jailen belül. Emiatt a jaileket a legtisztábban úgy tudjuk leállítani, ha kiadjuk az alábbi parancsot magában a jailben vagy pedig a <a href="https://man.freebsd.org/cgi/man.cgi?query=jexec&amp;sektion=8&amp;format=html">jexec(8)</a> segédprogrammal a jailen kívülrõl:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># sh /etc/rc.shutdown</span></code></pre></div></div><div class=paragraph><p>Errõl a témáról többet a <a href="https://man.freebsd.org/cgi/man.cgi?query=jail&amp;sektion=8&amp;format=html">jail(8)</a> man oldalon olvashatunk.</p></div></div><div class=sect2><h3 id=jails-tuning>15.5. Finomhangolás és karbantartás<a class=anchor href=#jails-tuning></a></h3><div class=paragraph><p>Számos opció állítható be a jaileknél, és sokféle módon vegyíthetjük a befogadó FreeBSD rendszerünket a jailekkel, ami által magasabb szintû alkalmazásokat hozhatunk létre. Ebben a részben bemutatunk:</p></div><div class=ulist><ul><li><p>Néhány olyan beállítást, amellyel finomhangolhatjuk a telepített jailek által megvalósított biztonsági megszorítások viselkedését.</p></li><li><p>A jailek kezelésére alkalmas néhány olyan magasabb szintû alkalmazást, amelyek elérhetõek a FreeBSD Portgyûjteményén keresztül, és általános jail alapú megoldások kialakításához használhatóak.</p></li></ul></div><div class=sect3><h4 id=jails-tuning-utilities>15.5.1. A FreeBSD-ben található finomhangoló eszközök<a class=anchor href=#jails-tuning-utilities></a></h4><div class=paragraph><p>A jailek beállításainak finomhangolását túlnyomórészt <a href="https://man.freebsd.org/cgi/man.cgi?query=sysctl&amp;sektion=8&amp;format=html">sysctl(8)</a> változókkal végezhetjük el. A sysctl-en belül egy speciális részfában találhatunk erre alkalmas beállításokat: ez a a FreeBSD rendszermag opciói között megtalálható <code>security.jail.*</code>. Itt közüljük a jailekre vonatkozó fontosabb sysctl változók listáját, az alapértelmezett értékeikkel együtt. A nevek minden bizonnyal sokat elárulnak, de ha többet szeretnénk tudni róluk, lapozzuk fel a <a href="https://man.freebsd.org/cgi/man.cgi?query=jail&amp;sektion=8&amp;format=html">jail(8)</a> és <a href="https://man.freebsd.org/cgi/man.cgi?query=sysctl&amp;sektion=8&amp;format=html">sysctl(8)</a> man oldalakat.</p></div><div class=ulist><ul><li><p><code>security.jail.set_hostname_allowed: 1</code></p></li><li><p><code>security.jail.socket_unixiproute_only: 1</code></p></li><li><p><code>security.jail.sysvipc_allowed: 0</code></p></li><li><p><code>security.jail.enforce_statfs: 2</code></p></li><li><p><code>security.jail.allow_raw_sockets: 0</code></p></li><li><p><code>security.jail.chflags_allowed: 0</code></p></li><li><p><code>security.jail.jailed: 0</code></p></li></ul></div><div class=paragraph><p>Ezekkel a változókkal a <em>befogadó rendszer</em> rendszergazdája tud hozzátenni vagy elvenni a <code>root</code> felhasználó alapértelmezett határaihoz. Vegyük azonban észre, hogy egyes korlátozások azonban semmiképpen sem szüntethetõek meg. A <code>root</code> nem csatlakoztathat és választhat le állományrendszereket a <a href="https://man.freebsd.org/cgi/man.cgi?query=jail&amp;sektion=8&amp;format=html">jail(8)</a> környezetben. Az elzárt <code>root</code> nem tölthet be és törölhet <a href="https://man.freebsd.org/cgi/man.cgi?query=devfs&amp;sektion=8&amp;format=html">devfs(8)</a> szabályrendszereket, tûzfal szabályokat sem, ill. nem végezhet semmilyen olyan bármilyen más karbantartási feladatot, amely a rendszermag adataiban módosítást vonna maga után, például nem állíthatja a rendszermag <code>securelevel</code> (biztonsági szintjének) értékét.</p></div><div class=paragraph><p>A FreeBSD alaprendszere tartalmazza azokat a segédeszközöket, amelyekkel a rendszerben aktív jailek információt tudjuk megjeleníteni, vagy csatlakozni tudunk hozzájuk. A <a href="https://man.freebsd.org/cgi/man.cgi?query=jls&amp;sektion=8&amp;format=html">jls(8)</a> és <a href="https://man.freebsd.org/cgi/man.cgi?query=jexec&amp;sektion=8&amp;format=html">jexec(8)</a> parancsok részei az alap FreeBSD rendszernek, segítségükkel elvégezhetõek az alábbi egyszerû feladatokat:</p></div><div class=ulist><ul><li><p>Ki tudjuk íratni az aktív jailek és hozzájuk tartozó azonosítókat (JID-eket), IP-címeket, neveket és útvonalakat.</p></li><li><p>A befogadó rendszerbõl hozzá tudunk csatlakozni egy futó jailhez, és parancsokat tudunk futtatni a jailen belül vagy karbantartási feladatokat tudunk elvégezni magán a jailen belül. Ez különösen hasznosnak bizonyulhat, amikor a <code>root</code> felhasználó szabályosan le akarja állítani a jailt. A <a href="https://man.freebsd.org/cgi/man.cgi?query=jexec&amp;sektion=8&amp;format=html">jexec(8)</a> segédprogrammal el tudunk indítani egy parancsértelmezõt a jailen belül, amibõl aztán irányíthatjuk. Példa:</p><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># jexec 1 tcsh</span></code></pre></div></div></li></ul></div></div><div class=sect3><h4 id=jails-tuning-admintools>15.5.2. Magasszintû karbantartó eszközök a FreeBSD Portgyûjteményében<a class=anchor href=#jails-tuning-admintools></a></h4><div class=paragraph><p>A sok külsõ karbantartó eszköz közül az egyik legteljesebb és leghasznosabb a <a class=package href=https://cgit.freebsd.org/ports/tree/sysutils/jailutils/>sysutils/jailutils</a>. Sok kisebb alkalmazást tartalmaz, melyek kibõvítik a <a href="https://man.freebsd.org/cgi/man.cgi?query=jail&amp;sektion=8&amp;format=html">jail(8)</a> irányíthatóságát. Bõvebb információkért kérjük, látogassa meg a hozzá tartozó honlapot.</p></div></div></div><div class=sect2><h3 id=jails-application>15.6. A jailek alkalmazása<a class=anchor href=#jails-application></a></h3><div class=sect3><h4 id=jails-service-jails>15.6.1. Szolgáltatások jailbe foglalása<a class=anchor href=#jails-service-jails></a></h4><div class=paragraph><p>Ez a rész eredetileg Simon L. B. Nielsen &lt;<a href=mailto:simon@FreeBSD.org>simon@FreeBSD.org</a>> <a href=http://simon.nitro.dk/service-jails.html>http://simon.nitro.dk/service-jails.html</a> oldalon található írásán, valamint Ken Tom (<a href=mailto:locals@gmail.com>locals@gmail.com</a>) átdolgozott cikkén alapul. Itt megismerhetjük, hogyan állítsunk be a FreeBSD rendszerünkben egy biztonsági réteget a <a href="https://man.freebsd.org/cgi/man.cgi?query=jail&amp;sektion=8&amp;format=html">jail(8)</a> felhasználásával. Továbbá feltételezzük, hogy ez a rendszer legalább RELENG_6_0 verziójú és a fejezetben korábban tárgyaltakat az olvasó teljes mértékben megértette.</p></div><div class=sect4><h5 id=jails-service-jails-design>15.6.1.1. A kialakítás<a class=anchor href=#jails-service-jails-design></a></h5><div class=paragraph><p>A jailek egyik legnagyobb gondja a frissítés folyamatának lebonyolítása. Azért jelent ez egyre inkább gondot, mert minden egyes jailt újra fel kell építenünk a frissítése során. Ez többnyire nem okoz gondot egyetlen jail használata során, mivel maga a frissítési folyamat meglehetõsen egyszerû, azonban igen idõigényessé és fárasztóvá tud válni több jail esetében.</p></div><div class="admonitionblock warning"><table><tbody><tr><td class=icon><i class="fa icon-warning" title=Warning></i></td><td class=content><div class=paragraph><p>Ez a példa a FreeBSD képességeinek haladó szintû ismeretét követeli meg. Amennyiben az itt bemutatott lépesek túlságosan is bonyolultnak tûnnének, érdemes olyan egyszerûbb rendszerek után nézni, mint mondjuk a <a class=package href=https://cgit.freebsd.org/ports/tree/sysutils/ezjail/>sysutils/ezjail</a>, amely egy egyszerûbb módszert kínál fel a FreeBSD-ben használt jailek karbantartására, és nem is annyira bonyolult, mint ez a példa.</p></div></td></tr></tbody></table></div><div class=paragraph><p>A bemutatandó példa célja, hogy feloldja az ilyen jellegû problémákat, és ezért igyekszik a jailek között mindent megosztani, ami csak lehetséges. Mindezt biztonságosan éri el - írásvédett <a href="https://man.freebsd.org/cgi/man.cgi?query=mount_nullfs&amp;sektion=8&amp;format=html">mount_nullfs(8)</a> állományrendszer használatával, aminek köszönhetõen a frissítés maga egyszerûbbé, az egyes szolgáltatások különzárása pedig vonzóbbá válik. Ráadásul egyúttal egy nagyon egyszerû módszert mutat az új jailek hozzáadására és a régi törlésére ugyanúgy, mint a frissítésükre.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Például ilyen szolgáltatásokat kívánunk szabályozni: egy HTTP szervert, egy DNS szervert, egy SMTP szervert és így tovább.</p></div></td></tr></tbody></table></div><div class=paragraph><p>Az itt szereplõ beállítás céljai:</p></div><div class=ulist><ul><li><p>Készítsünk egy egyszerûen és könnyen átlátható jailkezelési rendszert. Ebbõl tehát következik, hogy <em>ne</em> kelljen lefuttatni a teljes rendszer telepítését minden egyes jailre.</p></li><li><p>Könnyítsük meg az új jailek hozzáadását és a régiek eltávolítását.</p></li><li><p>Könnyítsük meg a már létezõ jailek frissítését és cseréjét.</p></li><li><p>Tegyük lehetõvé saját FreeBSD ágak futtatását.</p></li><li><p>Legyünk különösen körültekintõek a biztonság tekintetében, és igyekezzünk minél jobban csökkenteni veszély kockázatát.</p></li><li><p>Takarékoskodjunk a tárhellyel és az állományrendszerrel, amennyire csak lehet.</p></li></ul></div><div class=paragraph><p>Ahogy azt már korábban is említettük, ez a kialakítás nagyban építkezik egyetlen fõ sablonra, amely írásvédetten kerül csatlakoztatásra (nullfsen keresztül) az egyes jailekben, valamint jailenként egy-egy írható-olvasható eszközre. Ez az eszköz lehet egy külön fizikai lemez, egy partíció vagy egy vnode alapú <a href="https://man.freebsd.org/cgi/man.cgi?query=md&amp;sektion=4&amp;format=html">md(4)</a> eszköz. Ebben a példában írható-olvasható nullfs csatlakozásokat használunk.</p></div><div class=paragraph><p>Az állományrendszer kiosztása a most következõ listában szerepel:</p></div><div class=ulist><ul><li><p>Minden jailt a <span class=filename>/home/j</span> könyvtárban csatlakoztatunk.</p></li><li><p>A <span class=filename>/home/j/mroot</span> lesz az összes jail sablonja és mindegyikük számára írásvédett.</p></li><li><p>Minden jailnek létrehozunk egy üres alkönyvtárat a <span class=filename>/home/j</span> könyvtárban.</p></li><li><p>Minden jailnek lesz egy <span class=filename>/s</span> alkönyvtára, amelyet a rendszer írható-olvasható részére irányítunk.</p></li><li><p>Minden jailnek lesz egy saját írható-olvasható része, amely a <span class=filename>/home/j/skel</span> könyvtáron alapszik.</p></li><li><p>Mindegyik elzárt terület (a jailek írható-olvasható része) a <span class=filename>/home/js</span> könyvtárban jön létre.</p></li></ul></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Ez a kiosztás feltételezi, hogy a jaileket a <span class=filename>/home</span> partíción hozzuk létre. Ez természetesen bármi másra megváltoztatható, de akkor figyelnünk kell erre minden egyes parancs kiadása elõtt.</p></div></td></tr></tbody></table></div></div><div class=sect4><h5 id=jails-service-jails-template>15.6.1.2. A sablon létrehozása<a class=anchor href=#jails-service-jails-template></a></h5><div class=paragraph><p>Ez a rész leírja a fõ sablon létrehozásához szükséges lépéseket. Ez a jailek számára írásvédett lesz.</p></div><div class=paragraph><p>Érdemes mindig frissíteni a FreeBSD rendszerünket a legújabb -RELEASE ágra. Ehhez olvassuk el az ide tartozó <a href=./#makeworld>fejezetet</a> a kézikönyvbõl. Abban az esetben, ha a frissítés nem lenne megoldható, egy <code>make buildworld</code> parancsot mindenképpen le kell tudnunk futtatni. Ezenfelül a <a class=package href=https://cgit.freebsd.org/ports/tree/sysutils/cpdup/>sysutils/cpdup</a> csomagra is szükségünk van. Használni fogjuk a <a href="https://man.freebsd.org/cgi/man.cgi?query=portsnap&amp;sektion=8&amp;format=html">portsnap(8)</a> segédprogramot is a FreeBSD Portgyûjtemény letöltéséhez. Akik nem ismernék, a kézikönyv <a href=./#portsnap>errõl szóló fejezetében</a> olvashatnak róla.</p></div><div class="exampleblock procedure"><div class=content><div class="olist arabic"><ol class=arabic><li><p>Elõször is, készítsük el az írásvédett állományrendszer könyvtárszerkezetét, amely majd tartalmazni fogja a jailek által használt FreeBSD-s programokat. Ezután lépjünk be a FreeBSD forrásfájának könyvtárába és telepítsük fel az írásvédett állományrendszert a sablonba:</p><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># mkdir /home/j /home/j/mroot</span>
<span class=c># cd /usr/src</span>
<span class=c># make installworld DESTDIR=/home/j/mroot</span></code></pre></div></div></li><li><p>Ezt követõen készítsük elõ a jailek számára a FreeBSD Portgyûjteményt és FreeBSD forrásfát, melyek kellenek a mergemaster használatához:</p><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># cd /home/j/mroot</span>
<span class=c># mkdir usr/ports</span>
<span class=c># portsnap -p /home/j/mroot/usr/ports fetch extract</span>
<span class=c># cpdup /usr/src /home/j/mroot/usr/src</span></code></pre></div></div></li><li><p>Hozzuk létre a rendszer írásvédett részének vázát:</p><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># mkdir /home/j/skel /home/j/skel/home /home/j/skel/usr-X11R6 /home/j/skel/distfiles</span>
<span class=c># mv etc /home/j/skel</span>
<span class=c># mv usr/local /home/j/skel/usr-local</span>
<span class=c># mv tmp /home/j/skel</span>
<span class=c># mv var /home/j/skel</span>
<span class=c># mv root /home/j/skel</span></code></pre></div></div></li><li><p>Használjuk a mergemastert a hiányzó konfigurációs állományok telepítésére. Szabaduljunk meg a mergemaster által készített felesleges könyvtáraktól:</p><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># mergemaster -t /home/j/skel/var/tmp/temproot -D /home/j/skel -i</span>
<span class=c># cd /home/j/skel</span>
<span class=c># rm -R bin boot lib libexec mnt proc rescue sbin sys usr dev</span></code></pre></div></div></li><li><p>Most pedig szimbolikusan linkeljük az írható-olvasható állományrendszert az írásvédett állományrendszerre. Ellenõrizzük, hogy a szimbolikus linkek a megfelelõ <span class=filename>s/</span> könyvtárakban jöttek létre. Valós vagy rossz helyen létrehozott könyvtárak használata esetén a telepítés nem fog sikerülni.</p><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># cd /home/j/mroot</span>
<span class=c># mkdir s</span>
<span class=c># ln -s s/etc etc</span>
<span class=c># ln -s s/home home</span>
<span class=c># ln -s s/root root</span>
<span class=c># ln -s ../s/usr-local usr/local</span>
<span class=c># ln -s ../s/usr-X11R6 usr/X11R6</span>
<span class=c># ln -s ../../s/distfiles usr/ports/distfiles</span>
<span class=c># ln -s s/tmp tmp</span>
<span class=c># ln -s s/var var</span></code></pre></div></div></li><li><p>Utolsó lépésként hozzunk létre egy <span class=filename>/home/j/skel/etc/make.conf</span> állományt az alábbi tartalommal:</p><div class="literalblock programlisting"><div class=content><pre>WRKDIRPREFIX?=  /s/portbuild</pre></div></div><div class=paragraph><p>A <code>WRKDIRPREFIX</code> beállításával lehetõvé válik a FreeBSD portok jaileken belüli fordítása. Ne felejtsük el, hogy a portokat tartalmazó könyvtár az írásvédett rendszer része! Az átállított <code>WRKDIRPREFIX</code> azonban megengedi, hogy a fordítások az egyes jailek írható-olvasható részeiben történjenek.</p></div></li></ol></div></div></div></div><div class=sect4><h5 id=jails-service-jails-creating>15.6.1.3. A jailek létrehozása<a class=anchor href=#jails-service-jails-creating></a></h5><div class=paragraph><p>Most, miután teljesen elkészült a FreeBSD jailek sablonja, be is tudjuk állítani és hozzá is tudjuk venni ezeket az <span class=filename>/etc/rc.conf</span> állományhoz. Ebben a példában 3 jail létrehozását láthatjuk: "NS", "MAIL" és "WWW".</p></div><div class="exampleblock procedure"><div class=content><div class="olist arabic"><ol class=arabic><li><p>Írjuk bele a következõ sorokat az <span class=filename>/etc/fstab</span> állományba, aminek köszönhetõen az egyes jailek számára elérhetõvé válik az írásvédett sablon és a hozzájuk tartozó írható-olvasható területek:</p><div class="literalblock programlisting"><div class=content><pre>/home/j/mroot   /home/j/ns     nullfs  ro  0   0
/home/j/mroot   /home/j/mail   nullfs  ro  0   0
/home/j/mroot   /home/j/www    nullfs  ro  0   0
/home/js/ns     /home/j/ns/s   nullfs  rw  0   0
/home/js/mail   /home/j/mail/s nullfs  rw  0   0
/home/js/www    /home/j/www/s  nullfs  rw  0   0</pre></div></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Az elsõ helyen nullával jelölt partíciókat a <a href="https://man.freebsd.org/cgi/man.cgi?query=fsck&amp;sektion=8&amp;format=html">fsck(8)</a> nem fogja ellenõrizni a rendszer indulása során, a második helyen nullával jelölt partíciókat pedig nem fogja menteni a <a href="https://man.freebsd.org/cgi/man.cgi?query=dump&amp;sektion=8&amp;format=html">dump(8)</a>. Mi egyáltalán nem akarjuk, hogy az fsck ellenõrizze vagy a dump lementse a jailjeinkhez tartozó írásvédett nullfs-partícióinkat. Ezért szerepel végig "0 0" a fentebb szereplõ <span class=filename>fstab</span>-bejegyzések utolsó két oszlopában.</p></div></td></tr></tbody></table></div></li><li><p>Állítsuk be a jaileket az <span class=filename>/etc/rc.conf</span>-ban:</p><div class="literalblock programlisting"><div class=content><pre>jail_enable=&#34;YES&#34;
jail_set_hostname_allow=&#34;NO&#34;
jail_list=&#34;ns mail www&#34;
jail_ns_hostname=&#34;ns.example.org&#34;
jail_ns_ip=&#34;192.168.3.17&#34;
jail_ns_rootdir=&#34;/usr/home/j/ns&#34;
jail_ns_devfs_enable=&#34;YES&#34;
jail_mail_hostname=&#34;mail.example.org&#34;
jail_mail_ip=&#34;192.168.3.18&#34;
jail_mail_rootdir=&#34;/usr/home/j/mail&#34;
jail_mail_devfs_enable=&#34;YES&#34;
jail_www_hostname=&#34;www.example.org&#34;
jail_www_ip=&#34;62.123.43.14&#34;
jail_www_rootdir=&#34;/usr/home/j/www&#34;
jail_www_devfs_enable=&#34;YES&#34;</pre></div></div><div class="admonitionblock warning"><table><tbody><tr><td class=icon><i class="fa icon-warning" title=Warning></i></td><td class=content><div class=paragraph><p>Azért állítottuk a <code>jail<em>név</em>rootdir</code> változó értékét a <span class=filename>/usr/home</span> könyvtárra a <span class=filename>/home</span> könyvtár helyett, mert a FreeBSD alaptelepítésében a <span class=filename>/home</span> könyvtár fizikailag a <span class=filename>/usr/home</span> könyvtárral egyezik meg. A <code>jail<em>név</em>rootdir</code> változó értékeként megadott könyvtár <em>nem</em> tartalmazhat szimbolikus linket, máskülönben a jailek nem lesznek hajlandóak létrejönni. Ennek megállapításában a <a href="https://man.freebsd.org/cgi/man.cgi?query=realpath&amp;sektion=1&amp;format=html">realpath(1)</a> segédprogram lehet segítségünkre. A korlátozás részleteirõl a FreeBSD-SA-07:01.jail biztonsági figyelmeztetésben olvashatunk.</p></div></td></tr></tbody></table></div></li><li><p>Hozzuk létre az egyes jailek írásvédett állományrendszereihez szükséges csatlakozási pontokat:</p><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># mkdir /home/j/ns /home/j/mail /home/j/www</span></code></pre></div></div></li><li><p>Telepítsük az írható-olvasható sablont az egyes jailekbe. Figyeljük meg a <a class=package href=https://cgit.freebsd.org/ports/tree/sysutils/cpdup/>sysutils/cpdup</a> használatát, amellyel az egyes könyvtárak pontos másolatait hozhatjuk létre:</p><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># mkdir /home/js</span>
<span class=c># cpdup /home/j/skel /home/js/ns</span>
<span class=c># cpdup /home/j/skel /home/js/mail</span>
<span class=c># cpdup /home/j/skel /home/js/www</span></code></pre></div></div></li><li><p>Ebben a fázisban a jailek már elkészültek és készen állnak a futásra. Elõször csatlakoztassuk az egyes jailekhez szükséges állományrendszereket, majd indítsuk el ezeket a <span class=filename>/etc/rc.d/jail</span> szkripttel:</p><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># mount -a</span>
<span class=c># /etc/rc.d/jail start</span></code></pre></div></div></li></ol></div></div></div><div class=paragraph><p>A jailek most már futnak. Az elindulásuk ellenõrzéséhez használjuk a <a href="https://man.freebsd.org/cgi/man.cgi?query=jls&amp;sektion=8&amp;format=html">jls(8)</a> parancsot. Valami ilyesmit láthatunk a kiadása után:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># jls</span>
   JID  IP Address      Hostname                      Path
     3  192.168.3.17    ns.example.org                /home/j/ns
     2  192.168.3.18    mail.example.org              /home/j/mail
     1  62.123.43.14    www.example.org               /home/j/www</code></pre></div></div><div class=paragraph><p>Itt már be tudunk jelentkezni az egyes jailekbe, új felhasználókat tudunk készíteni vagy démonokat tudunk beállítani. A <code>JID</code> oszlop mutatja az egyes jailek azonosítási számát. A 3-as <code>JID</code> számú jailben az alábbi parancs használatával karbantartási feladatokat elvégezni:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># jexec 3 tcsh</span></code></pre></div></div></div><div class=sect4><h5 id=jails-service-jails-upgrading>15.6.1.4. Frissítés<a class=anchor href=#jails-service-jails-upgrading></a></h5><div class=paragraph><p>Idõrõl idõre adódhat, hogy frissítenünk kell a rendszert a FreeBSD egy újabb változatára, vagy egy biztonsági hiba javítása miatt, vagy pedig a már meglevõ jailek számára hasznos újítások bevezetése miatt. Ez a kialakítás megkönnyíti a korábban létrehozott jailjeink frissítését. Továbbá igyekszik minimalizálni a kiesésüket is, mivel a jaileket csak a legutolsó pillanatban fogjuk leállítani. Sõt, még az is lehetõvé válik, hogy visszaállítsuk a korábbi verziót, ha véletlenül valami rosszul sülne el menetközben.</p></div><div class="exampleblock procedure"><div class=content><div class="olist arabic"><ol class=arabic><li><p>Elsõ lépéseként frissítsük magát a befogadó rendszert a megszokott módon. Ezután hozzunk létre egy új írásvédett sablont a <span class=filename>/home/j/mroot2</span> könyvtárban.</p><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># mkdir /home/j/mroot2</span>
<span class=c># cd /usr/src</span>
<span class=c># make installworld DESTDIR=/home/j/mroot2</span>
<span class=c># cd /home/j/mroot2</span>
<span class=c># cpdup /usr/src usr/src</span>
<span class=c># mkdir s</span></code></pre></div></div><div class=paragraph><p>A <code>installworld</code> lefuttatása létrehoz néhány felesleges könyvtárat, melyeket takarítsunk is el:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># chflags -R 0 var</span>
<span class=c># rm -R etc var root usr/local tmp</span></code></pre></div></div></li><li><p>Hozzuk újra létre az írható-olvasható szimbolikus linkjeinket a fõ állományrendszerre:</p><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># ln -s s/etc etc</span>
<span class=c># ln -s s/root root</span>
<span class=c># ln -s s/home home</span>
<span class=c># ln -s ../s/usr-local usr/local</span>
<span class=c># ln -s ../s/usr-X11R6 usr/X11R6</span>
<span class=c># ln -s s/tmp tmp</span>
<span class=c># ln -s s/var var</span></code></pre></div></div></li><li><p>Most érkezett el az idõ, hogy leállítsuk a jaileket:</p><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># /etc/rc.d/jail stop</span></code></pre></div></div></li><li><p>Válasszuk le az eredeti állományrendszereket:</p><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># umount /home/j/ns/s</span>
<span class=c># umount /home/j/ns</span>
<span class=c># umount /home/j/mail/s</span>
<span class=c># umount /home/j/mail</span>
<span class=c># umount /home/j/www/s</span>
<span class=c># umount /home/j/www</span></code></pre></div></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Az írható-olvasható állományrendszerek hozzá vannak kapcsolva az írásvédett állományrendszerhez (<span class=filename>/s</span>), ezért azokat elõször le kell választani.</p></div></td></tr></tbody></table></div></li><li><p>Mozgassuk el az útból a régi írásvédett állományrendszerünket és váltsuk fel az újjal. Így biztonsági mentésként és a régi írásvédett rendszer archívumaként továbbra is rendelkezésre áll, ha valami baj történne. Az itt használt elnevezés az újonnan létrehozott írásvédett állományrendszer dátumából ered. Mozgassuk át az eredeti FreeBSD Portgyûjteményt az új állományrendszerre, hogy megtakarítsunk némi tárhelyet és állományleírót:</p><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># cd /home/j</span>
<span class=c># mv mroot mroot.20060601</span>
<span class=c># mv mroot2 mroot</span>
<span class=c># mv mroot.20060601/usr/ports mroot/usr</span></code></pre></div></div></li><li><p>Most már készen áll az új írásvédett sablon, így már csak az állományrendszerek újracsatlakoztatása és a jailek újraindítása maradt:</p><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># mount -a</span>
<span class=c># /etc/rc.d/jail start</span></code></pre></div></div></li></ol></div></div></div><div class=paragraph><p>A <a href="https://man.freebsd.org/cgi/man.cgi?query=jls&amp;sektion=8&amp;format=html">jls(8)</a> használatával ellenõrizzük, hogy a jailek rendesen elindultak. Ne felejtsük el jailenként lefuttatni a mergemastert sem. A konfigurációs állományokat és az rc.d szkripteket is frissítenünk kell majd.</p></div></div></div></div></div></div><div class=sect1><h2 id=mac>Chapter 16. Kötelező hozzáférés-vezérlés (MAC)<a class=anchor href=#mac></a></h2><div class=sectionbody><div class=sect2><h3 id=mac-synopsis>16.1. Áttekintés<a class=anchor href=#mac-synopsis></a></h3><div class=paragraph><p>A FreeBSD 5.X változata új biztonsági bõvítéseket vett át a TrustedBSD projektbõl a POSIX®.1e nyomán. A két legjelentõsebb új biztonsági mechanizmus az állományrendszerekben megtalálható hozzáférés-vezérlési listák (Access Control List, ACL) és a kötelezõ hozzáférés-vezérlés (Mandatory Access Control, MAC). A kötelezõ hozzáférés-vezérlés segítségével olyan új hozzáférés-vezérlési modulok tölthetõek be, amelyek új biztonsági házirendeket implementálnak. Némelyek közülük védelmet nyújtanak a rendszer egy szûk részének, amivel így egy adott szolgáltatást bástyáznak alá. Mások minden részletre kiterjedõ címkézett biztonságot szolgáltatnak alanyokon és objektumokon keresztül. A meghatározás "kötelezõ" része onnan fakad, hogy a szabályok betartatását a rendszergazdák és a rendszer végzik, és nem bízzák a felhasználókra, ahogy azt a System V típusú rendszerekben a szabványos állományokra és IPC-re érvényes engedélyeken keresztül a tetszés szerinti hozzáférés-vezérlés (Discretionary Access Control, DAC) teszi.</p></div><div class=paragraph><p>Ebben a fejezetben a kötelezõ hozzáférés-vezérlést övezõ keretrendszerre (MAC Framework) és a különbözõ biztonsági házirendeket megvalósító, beilleszthetõ modulokra fogunk összpontosítani.</p></div><div class=paragraph><p>A fejezet elolvasása során megismerjük:</p></div><div class=ulist><ul><li><p>hogy a FreeBSD jelen pillanatban milyen modulokat tartalmaz a MAC rendszeren belül és milyen mechanizmusok tartoznak hozzájuk;</p></li><li><p>hogy a MAC biztonsági házirendjeit képezõ modulok miket valósítanak meg, valamint mi a különbség a címkézett és címkézetlen házirendek között;</p></li><li><p>hogyan kell hatékonyan beállítani és használni rendszerünkben a MAC rendszert;</p></li><li><p>hogyan állítsuk be a MAC rendszerben található különféle biztonsági házirendeket képezõ modulokat;</p></li><li><p>hogyan hozzunk létre a MAC rendszer segítségével egy biztonságosabb környezetet, amire példákat is mutatunk;</p></li><li><p>hogyan teszteljük le a MAC rendszer beállításait és bizonyosodjunk meg mûködésének helyességérõl.</p></li></ul></div><div class=paragraph><p>A fejezet elolvasásához ajánlott:</p></div><div class=ulist><ul><li><p>a UNIX® és a FreeBSD alapjainak ismerete (<a href=./#basics>A UNIX alapjai</a>)</p></li><li><p>a rendszermag beállításának és lefordításának ismerete (<a href=./#kernelconfig>A FreeBSD rendszermag testreszabása</a>)</p></li><li><p>tisztában lenni az alapvetõ biztonsági kérdésekkel és azok hatásával a FreeBSD-n belül (<a href=./#security>Biztonság</a>)</p></li></ul></div><div class="admonitionblock warning"><table><tbody><tr><td class=icon><i class="fa icon-warning" title=Warning></i></td><td class=content><div class=paragraph><p>Az itt ismertetésre kerülõ információk helytelen alkalmazása a rendszer hozzáférhetõségének teljes elvesztését, a felhasználók bosszantását vagy az X11 által felkínált lehetõségek kirekesztését eredményezheti. Ami viszont ennél is fontosabb, hogy a MAC rendszerre nem úgy kell tekinteni, mint amitõl a rendszerünk tökéletesen biztonságossá válik. A MAC segítségével csupán a meglevõ biztonsági házirendeket gyarapítjuk. A szilárd biztonsági rutin és a rendszeres ellenõrzések elvégzése nélkül a rendszerünk valójában sosem lesz teljesen biztonságos.</p></div><div class=paragraph><p>Hozzá kell tennünk, hogy a fejezetben bemutatott példák tényleg csak példák. Senkinek sem tanácsoljuk, hogy az itt említett beállításokat egy éles rendszerre is kiterjessze. A különbözõ biztonsági modulok felépítése rengeteg gondolkodást és próbálgatást igényel. Aki nem érti meg az egész mûködését, könnyen azon kaphatja magát, hogy újra végig kell mennie a rendszeren és egyenként be kell állítania minden könyvtárat és állományt.</p></div></td></tr></tbody></table></div><div class=sect3><h4 id=_amivel_itt_nem_foglalkozunk>16.1.1. Amivel itt nem foglalkozunk<a class=anchor href=#_amivel_itt_nem_foglalkozunk></a></h4><div class=paragraph><p>Ebben a fejezetben a MAC rendszerrel kapcsolatban rengeteg biztonsági kérdéssel foglalkozni fogunk. Az új MAC biztonsági modulok kifejlesztését azonban már nem érintjük. Számos olyan biztonsági modul található a MAC rendszerben, amelyek rendelkeznek az új modulok kialakításához és teszteléséhez szükséges jellemzõkkel. Ilyenek többek közt a <a href="https://man.freebsd.org/cgi/man.cgi?query=mac_test&amp;sektion=4&amp;format=html">mac_test(4)</a>, <a href="https://man.freebsd.org/cgi/man.cgi?query=mac_stub&amp;sektion=4&amp;format=html">mac_stub(4)</a> és a <a href="https://man.freebsd.org/cgi/man.cgi?query=mac_none&amp;sektion=4&amp;format=html">mac_none(4)</a>. Ezekrõl a biztonsági modulokról és az általuk szolgáltatott mechnanizmusokról a man oldalaik tudnak bõvebb tájékoztatást adni.</p></div></div></div><div class=sect2><h3 id=mac-inline-glossary>16.2. A fejezet fontosabb fogalmai<a class=anchor href=#mac-inline-glossary></a></h3><div class=paragraph><p>A fejezet tartalmának kifejtéséhez szükségünk lesz néhány fontosabb alapfogalom tisztázására. Segítségükkel vélhetõen sikerül eloszlatni a téma feldolgozása során felmerülõ félreértéseket, illetve elkerülni az új fogalmak és információk váratlan felbukkanását.</p></div><div class=ulist><ul><li><p><em>alany</em>: Alanynak tekintünk a rendszerben minden olyan aktív egyedet, amely információt áramoltat az <em>objektumok</em>, tehát a felhasználók, a processzorok, a rendszerben futó programok stb. között. A FreeBSD-ben majdnem minden esetben a felhasználók egy szálon keresztül vezérlik a futó programokat.</p></li><li><p><em>címke</em>: A címke egy olyan biztonsági tulajdonság, ami vonatkozhat állományokra, könyvtárakra vagy a rendszer más elemeire. Egy címke tekinthetõ a bizalmasságot jelzõ pecsétnek is: ha egy állományra címkét teszünk, akkor benne megadjuk a rá vonatkozó biztonsági jellemzõket, és csak a hozzá hasonló biztonsági beállításokkal rendelkezõ állományok, felhasználók, erõforrások stb. érhetik el. A címkék jelentését és értelmezését a házirendek beállítása határozza meg: míg egyes házirendek a címkéket egy objektum sértetlenségének vagy titkosságának tekintik, addig mások a hozzáféréssel kapcsolatos szabályokat rögzítik bennük.</p></li><li><p><em>egycímkés</em>: Egycímkés esetrõl akkor beszélünk, amikor az adat áramlásának szabályozására az egész állományrendszer egyetlen címkét alkalmaz. Ha ezt beállítjuk egy állományrendszernél, de nem adjuk meg vele együtt a <code>multilabel</code> opciót, akkor az összes állományra ugyanaz a címke érvényes.</p></li><li><p><em>erõs vízjel</em>: Az erõs vízjel házirendje szerint a biztonsági szint akkor növelhetõ, ha magasabb szintû információkhoz akarunk hozzájutni. A legtöbb esetben a folyamatok befejezõdése után visszaállítódik az eredeti szint. A FreeBSD MAC rendszere pillanatnyilag ehhez nem tartalmaz házirendet, de a teljesség kedvéért megadtuk ennek a definícióját is.</p></li><li><p><em>gyenge vízjel</em>: A gyenge vízjel házirendje szerint a biztonsági szint csökkenthetõ az alacsonyabb szintû információk elérése érdekében. A legtöbb esetben a folyamatok befejezõdése után visszaállítódik az eredeti szint. A FreeBSD-ben ezt a házirendet egyedül a <a href="https://man.freebsd.org/cgi/man.cgi?query=mac_lomac&amp;sektion=4&amp;format=html">mac_lomac(4)</a> alkalmazza.</p></li><li><p><em>házirend</em>: Szabályok olyan gyûjteménye, amely megadja, hogy miként kell a célokat teljesíteni. Egy <em>házirend</em> általában az egyes elemek kezelését rögzíti. Ebben a fejezetben a <em>házirend</em> kifejezés alatt a <em>biztonsági házirendet</em> értjük, tehát olyan szabályok gyûjteményét, amelyek az adatok és az információ áramlását határozzák meg, továbbá megadják, hogy közülük ki mihez férhet hozzá.</p></li><li><p><em>kényesség</em>: Általában az MLS tárgyalásakor kerül elõ. Az kényesség szintjével az adatok fontosságát vagy titkosságát szokták jelölni. A kényességi szint növekedésével növekszik az adat titkosságának vagy bizalmasságának szintje.</p></li><li><p><em>objektum</em>: Objektum vagy rendszerobjektum minden olyan egyed, amelyen információ folyik keresztül az <em>alanyok</em> irányításával. Ezek lehetnek többek közt könyvtárak, állományok, mezõk, képernyõk, billentyûzetek, a memória, mágneses tárolóeszközök, nyomtatók vagy bármilyen más adattároló/hordozó eszköz. Az objektumok alapvetõen adattárolók vagy a rendszer erõforrásai. Egy <em>objektum</em> elérésén gyakorlatilag az adatok elérését értjük.</p></li><li><p><em>rekesz</em>: Egy rekeszbe soroljuk az elrekeszteni vagy elkülöníteni kívánt programok és adatok összeségét, ahol a felhasználók explicit módon képesek hozzáférni a rendszer bizonyos komponenseihez. Emellett a rekesz utalhat egy tetszõleges csoportosításra is, például munkacsoportra, osztályra, projektre vagy témára. A rekeszek használata elengedhetetlen a biztonsági házirendek kialakításához.</p></li><li><p><em>sértetlenség</em>: A sértetlenség, mint kulcsfogalom, az adatok megbízhatóságának szintje. Minél sértetlenebb az adat, annál inkább tekinthetjük megbízhatónak.</p></li><li><p><em>szint</em>: Egy biztonsági tulajdonság megnövelt vagy lecsökkentett beállítása. A szint növekedésével együtt a biztonság mértéke is növekszik.</p></li><li><p><em>többcímkés</em>: A <code>multilabel</code> vagyis többcímkés jellemzõ az állományrendszerek esetén fordulhat elõ, és a <a href="https://man.freebsd.org/cgi/man.cgi?query=tunefs&amp;sektion=8&amp;format=html">tunefs(8)</a> segédprogrammal állítható be egyfelhasználós módban vagy a rendszer indítása során az <a href="https://man.freebsd.org/cgi/man.cgi?query=fstab&amp;sektion=5&amp;format=html">fstab(5)</a> állományon keresztül, esetleg egy új állományrendszer létrehozásakor. Ezzel a beállítással a rendszergazda különféle MAC címkéket rendelhet különbözõ objektumokhoz. Ez a beállítás természetesen csak olyan biztonsági modulok esetén él, amelyek tudnak címkézni.</p></li></ul></div></div><div class=sect2><h3 id=mac-initial>16.3. A MAC ismertetése<a class=anchor href=#mac-initial></a></h3><div class=paragraph><p>Az imént definiált új fogalmak tükrében most nézzük meg, hogy a MAC rendszer alkalmazásával miként javíthatunk rendszerünk biztonságán. A MAC rendszerhez készített különbözõ biztonsági modulok alkalmasak a hálózat és az állományrendszerek védelmére, valamint segítségükkel megakadályozhatjuk, hogy a felhasználók elérhessenek bizonyos portokat és socketeket stb. A házirendeket formázó modulokat talán együttesen tudjuk a leghatékonyabban alkalmazni, és ha egyszerre több modul betöltésével egy többrétegû védelmi rendszert alakítunk ki. Ez nem ugyanaz, mint a rendszer megerõsítése, ahol a rendszer összetevõit jellemzõ módon csak bizonyos célok tekintetében edzzük meg. A módszer egyedüli hátulütõi a többszörös állományrendszeri címkékkel, a felhasználónként beállítandó hálózati eléréssel stb. járó adminisztrációs költségek.</p></div><div class=paragraph><p>Ezek a hátrányok azonban eltörpülnek a létrehozott rendszer tartósságával szemben. Például, ha képesek vagyunk megmondani, hogy az adott konfigurációban milyen házirendek alkalmazására van szükség, akkor ezzel az adminisztrációs költségek visszaszoríthatóak. A szükségtelen házirendek eltávolításával még növelhetjük is a rendszer összteljesítményét, valamint az így felkínált rugalmasságot. Egy jó kialakításban figyelembe kell venni az összes biztonsági elõírást, és hatékonyan megvalósítani ezeket a rendszer által felajánlott különféle biztonsági modulokkal.</p></div><div class=paragraph><p>Ezért tehát a MAC lehetõségeit kihasználó rendszerekben legalább annyit meg kell tudni oldani, hogy a felhasználók ne változtathassák kedvükre a biztonsági tulajdonságokat. Az összes felhasználói segédprogramnak, programnak és szkriptnek a kiválasztott biztonsági modulokban szereplõ hozzáférési szabályokkal kifeszített kereten belül kell mozognia. A MAC totális irányítása pedig a rendszergazda kezében van.</p></div><div class=paragraph><p>A rendszergazda így egyedül csak a megfelelõ biztonsági modulok gondos összeválogatásáért felelõs. Bizonyos környezetekben szükséges lehet a hálózaton keresztüli hozzáférések korlátozása is. Ilyen esetekben a <a href="https://man.freebsd.org/cgi/man.cgi?query=mac_portacl&amp;sektion=4&amp;format=html">mac_portacl(4)</a>, <a href="https://man.freebsd.org/cgi/man.cgi?query=mac_ifoff&amp;sektion=4&amp;format=html">mac_ifoff(4)</a> vagy a <a href="https://man.freebsd.org/cgi/man.cgi?query=mac_biba&amp;sektion=4&amp;format=html">mac_biba(4)</a> moduloktól érdemes elindulnunk. Más esetekben az állományrendszerek objektumainak bizalmasságát kell csupán megõriznünk. Erre a célra a <a href="https://man.freebsd.org/cgi/man.cgi?query=mac_bsdextended&amp;sektion=4&amp;format=html">mac_bsdextended(4)</a> és <a href="https://man.freebsd.org/cgi/man.cgi?query=mac_mls&amp;sektion=4&amp;format=html">mac_mls(4)</a> modulok a legalkalmasabbak.</p></div><div class=paragraph><p>A házirendekhez kapcsolódó döntések a hálózati beállítások alapján is meghozhatóak. Elképzelhetõ, hogy csak bizonyos felhasználók férhetnek hozzá az <a href="https://man.freebsd.org/cgi/man.cgi?query=ssh&amp;sektion=1&amp;format=html">ssh(1)</a> szolgáltatásain keresztül a hálózathoz vagy az internethez. A <a href="https://man.freebsd.org/cgi/man.cgi?query=mac_portacl&amp;sektion=4&amp;format=html">mac_portacl(4)</a> pontosan ilyen helyzetekben tud a segítségünkre sietni. Mit tegyünk viszont az állományrendszerek esetén? Vágjunk el adott felhasználókat vagy csoportokat bizonyos könyvtáraktól? Vagy korlátozzuk a felhasználók vagy segédprogramok hozzáférését adott állományokhoz bizonyos objektumok bizalmassá tételével?</p></div><div class=paragraph><p>Az állományrendszerek esetében az objektumokat néhány felhasználó elérheti, mások pedig nem. Például egy nagyobb fejlesztõcsapat kisebb csoportokra bontható. Az A projektben résztvevõ fejlesztõk nem férhetnek hozzá a B projektben dolgozó fejlesztõk munkájához. Ellenben szükségük lehet a C projekten munkálkodó fejlesztõk által létrehozott objektumokra. Ez egy igen érdekes helyzet. A MAC rendszer által felkínált különbözõ biztonsági modulokra építkezve azonban könnyedén csoportokba tudjuk szervezni a felhasználókat, és a megfelelõ területekhez az információ kiszivárgása nélkül hozzá tudjuk õket engedni.</p></div><div class=paragraph><p>Ennek következtében minden egyes biztonsági modul a maga módján gondoskodik az egész rendszer biztonságáról. A céljainknak megfelelõ modulokat egy jól átgondolt biztonsági házirend alapján válasszuk ki. Sok esetben az egész házirendet át kell tekinteni és újra kell alkalmazni a rendszerben. A MAC által felajánlott különbözõ biztonsági modulok megértése segít a rendszergazdáknak megválasztani az adott helyzetben legjobban alkalmazható házirendeket.</p></div><div class=paragraph><p>A FreeBSD rendszermagja alapból nem tartalmazza a MAC rendszert. Ezért a fejezetben szereplõ példák vagy az itt leírtak kipróbálásához az alábbi beállítást kell hozzátennünk a rendszermag beállításait tartalmazó állományhoz:</p></div><div class="literalblock programlisting"><div class=content><pre>options	MAC</pre></div></div><div class=paragraph><p>Majd fordítsuk és telepítsük újra a rendszermagot.</p></div><div class="admonitionblock caution"><table><tbody><tr><td class=icon><i class="fa icon-caution" title=Caution></i></td><td class=content><div class=paragraph><p>Miközben a MAC rendszerhez készült különbözõ modulok a saját man oldalaik szerint igénylik a beépítésüket, vigyázzunk velük, mert ezzel a rendszerüket pillanatok alatt ki tudjuk zárni a hálózatból és így tovább. A MAC alapú védelem felépítése leginkább egy tûzfal összeállításához hasonlítható, ahol ugyanígy számolni kell azzal, hogy egy óvatlan paranccsal kizárhatjuk magunkat a rendszerbõl. Valamilyen módon mindig próbáljunk gondoskodni a rendszer elõzõ állapotának visszaállíthatóságáról, és a MAC távoli adminisztrációját mindig nagyfokú körültekintéssel végezzük.</p></div></td></tr></tbody></table></div></div><div class=sect2><h3 id=mac-understandlabel>16.4. Bõvebben a MAC címkéirõl<a class=anchor href=#mac-understandlabel></a></h3><div class=paragraph><p>A MAC-címke egy olyan biztonsági tulajdonság, amelyet a rendszerben található alanyokhoz és objektumokhoz rendelhetünk.</p></div><div class=paragraph><p>Egy címke beállításához a felhasználónak pontosan ismernie kell, hogy ilyenkor mi történik. Az objektumokhoz tartozó tulajdonságok a betöltött moduloktól függenek, és az egyes modulok eltérõ módon értelmezik ezeket a tulajdonságokat. Ha a precíz megértésük hiányában helytelenül állítjuk be ezeket, vagy nem vagyunk képesek tisztázni a velük járó következményeket, akkor az a rendszerünk kiszámíthatatlan és valószínûleg kedvezõtlen viselkedését eredményezi.</p></div><div class=paragraph><p>A házirendek az objektumhoz rendelt biztonsági címkéket a hozzáféréssel kapcsolatos döntések meghozásában használják fel. Bizonyos házirendek esetében már maga a címke elegendõ információt tartalmaz a döntés megformálásához. Máshol viszont a címkék egy nagyobb szabályrendszer részeként dolgozódnak fel stb.</p></div><div class=paragraph><p>Például, ha egy állományra beállítjuk a <code>biba/low</code> címkét, akkor az arra fog utalni, hogy a címkét a Biba nevû biztonsági modul kezeli és értéke "low".</p></div><div class=paragraph><p>Az a néhány modul, amely a FreeBSD-ben támogatja a címkézés lehetõségét, három speciális címkét definiál elõre. Ezek rendre a "low" (alacsony), "high" (magas) és "equal" (egyezõ) címkék. Habár az egyes modulok esetén eltérõ módon képesek vezérelni a hozzáférést, azt mindig biztosra vehetjük, hogy a "low" a legalacsonyabb érték, az "equal" címke hatására az adott alanyt vagy objektumot érintetlenül hagyják, és a "high" értékû címke a Biba és MLS modulok esetében a legmagasabb beállítást jelenti.</p></div><div class=paragraph><p>Az egycímkés állományrendszerek használata során az egyes objektumonkhoz csak egyetlen címkét rendelhetünk hozzá. Ezzel az egész rendszerben csak egyfajta engedélyt alkalmazunk, ami sok esetben pontosan elegendõ. Létezik néhány különleges eset, amikor az állományrendszerben levõ alanyokhoz vagy objektumokhoz egyszerre több címkét is hozzá kell rendelnünk. Ilyenkor a <code>multilabel</code> opciót kell átadnunk a <a href="https://man.freebsd.org/cgi/man.cgi?query=tunefs&amp;sektion=8&amp;format=html">tunefs(8)</a> segédprogramnak.</p></div><div class=paragraph><p>A Biba és az MLS esetében elõfordulhat, hogy egy numerikus címkével fogjuk jelölni a hierarchikus irányítás pontos szintjét. A numerikus szintek használatával tudjuk az információt különbözõ csoportokba szétosztani vagy elrendezni, például úgy, hogy csak az adott szintû vagy a felette álló csoportok számára engedélyezzük a hozzáférést.</p></div><div class=paragraph><p>Az esetek többségében a rendszergazdának csak egyetlen címkét kell beállítania az egész állományrendszerre.</p></div><div class=paragraph><p><em>Hé, álljunk csak meg! Akkor ez viszont pont olyan, mint a DAC! Én azt hittem, hogy a MAC szigorúan a rendszergazda kezébe adja az irányítást.</em> Ez az állítás továbbra is fennáll, mivel bizonyos értelemben a <code>root</code> lesz az, aki beállítja a házirendeket, tehát õ mondja meg, hogy a felhasználók milyen kategóriákba vagy hozzáférési szintekbe sorolódnak. Sajnos, sok biztonsági modul még magát a <code>root</code> felhasználót is korlátozza. Az objektumok feletti irányítás ilyenkor a csoportra száll, de a <code>root</code> bármikor visszavonhatja vagy módosíthatja a beállításokat. Ezzel a hierarchikus/engedély alapú modellel a Biba és az MLS nevû házirendek foglalkoznak.</p></div><div class=sect3><h4 id=_a_címkék_beállítása>16.4.1. A címkék beállítása<a class=anchor href=#_a_címkék_beállítása></a></h4><div class=paragraph><p>A címkézéshez kapcsolódó összes beállítást gyakorlatilag az alapvetõ rendszerprogramokkal végezhetjük el. Ezek a parancsok az objektumok és az alanyok szabályozásához, valamint a konfiguráció módosításához és ellenõrzéséhez adnak egy egyszerû kezelõfelületet.</p></div><div class=paragraph><p>Az összes konfigurációs beállítást a <a href="https://man.freebsd.org/cgi/man.cgi?query=setfmac&amp;sektion=8&amp;format=html">setfmac(8)</a> és <a href="https://man.freebsd.org/cgi/man.cgi?query=setpmac&amp;sektion=8&amp;format=html">setpmac(8)</a> segédprogramokkal végezhetjük el. A <code>setfmac</code> segítségével a rendszerszintû objektumokhoz tudunk hozzárendelni a MAC-címkéket, míg a <code>setpmac</code> paranccsal a rendszerben levõ alanyokhoz tudunk címkéket rendelni. Vegyük például ezt:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># setfmac biba/high próba</span></code></pre></div></div><div class=paragraph><p>Amennyiben az iménti parancs hibátlanul lefutott, visszakapjuk a paranccsort. Ezek a parancsok csak olyankor maradnak nyugodtan, amikor semmilyen hiba nem történt. Mûködésük hasonló a <a href="https://man.freebsd.org/cgi/man.cgi?query=chmod&amp;sektion=1&amp;format=html">chmod(1)</a> és <a href="https://man.freebsd.org/cgi/man.cgi?query=chown&amp;sektion=8&amp;format=html">chown(8)</a> parancsokéhoz. Bizonyos esetekben <code>Permission denied</code> (<code>A hozzáférés nem engedélyezett</code>) hibát kapunk, ami általában akkor bukkan fel, ha egy korlátozott objektummal kapcsolatban próbálunk meg címkét beállítani vagy módosítani . A rendszergazda a következõ paranccsal tudja feloldani az ilyen helyzeteket:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># setfmac biba/high próba</span>
Permission denied
<span class=c># setpmac biba/low setfmac biba/high próba</span>
<span class=c># getfmac próba</span>
próba: biba/high</code></pre></div></div><div class=paragraph><p>Ahogy az itt tetten is érhetõ, a <code>setpmac</code> használható a modul beállításainak felülbírálására úgy, hogy a meghívott programban egy másik címkét állít be. A <code>getpmac</code> segédprogram általában a sendmailhez hasonló háttérben futó programok esetében alkalmazható: ilyenkor a konkrét parancs helyett a futó program azonosítóját kell megadnunk, de mûködése ugyanaz. Ha a felhasználók a hatókörükön túl levõ állományokat próbálnak meg módosítani, akkor a betöltött modulok szabályainak megfelelõen a <code>mac_set_link</code> függvény <code>Operation not permitted</code> (<code>A mûvelet nem engedélyezett</code>) hibát fog adni.</p></div><div class=sect4><h5 id=_gyakori_címketípusok>16.4.1.1. Gyakori címketípusok<a class=anchor href=#_gyakori_címketípusok></a></h5><div class=paragraph><p>A <a href="https://man.freebsd.org/cgi/man.cgi?query=mac_biba&amp;sektion=4&amp;format=html">mac_biba(4)</a>, <a href="https://man.freebsd.org/cgi/man.cgi?query=mac_mls&amp;sektion=4&amp;format=html">mac_mls(4)</a> és <a href="https://man.freebsd.org/cgi/man.cgi?query=mac_lomac&amp;sektion=4&amp;format=html">mac_lomac(4)</a> moduloknál használhatunk címkéket. Értékük lehet "high", "equal" vagy "low", melyek rövid magyarázata a következõ:</p></div><div class=ulist><ul><li><p>A <code>low</code> címke az objektumra vagy alanyra érvényes leggyengébb beállítást jelenti. Az ilyen címkéjû objektumok vagy alanyok nem érhetik el a "high" címkéjûeket.</p></li><li><p>Az <code>equal</code> címke használható minden olyan objektum vagy alany esetében, amelyeket ki akarunk vonni az adott házirend hatálya alól.</p></li><li><p>A <code>high</code> címke adja az objektumhoz vagy alanyhoz tartozó legerõsebb beállítást.</p></li></ul></div><div class=paragraph><p>Az egyes moduloktól függõen ezek az értékek az információ áramoltatásának különbözõ irányait írhatják le. A megfelelõ man oldalak elolvasásával még jobban megismerhetjük az egyes címketípusok beállításának jellegzetességeit.</p></div><div class=sect5><h6 id=_a_címkék_beállításáról_részletesebben>16.4.1.1.1. A címkék beállításáról részletesebben<a class=anchor href=#_a_címkék_beállításáról_részletesebben></a></h6><div class=paragraph><p>A numerikus osztályozó címkék <code>összehasonlítás:rekesz+rekesz</code> alakban használatosak, tehát a</p></div><div class="literalblock programlisting"><div class=content><pre>biba/10:2+3+6(5:2+3-20:2+3+4+5+6)</pre></div></div><div class=paragraph><p>kifejezés így értelmezhetõ:</p></div><div class=paragraph><p>"A Biba házirend címkéje"/"10 osztály" :"2, 3 és 6 rekeszek": ("5 osztály…​")</p></div><div class=paragraph><p>Ebben a példában az elsõ osztály tekinthetõ "valódi osztálynak", amely a "valódi rekeszeket" jelenti, a második osztály egy alacsonyabb besorolás, míg az utolsó egy magasabb szintû. A legtöbb konfigurációban nem lesz szükségünk ennyire összetett beállításokra, noha képesek vagyunk felírni ezeket.</p></div><div class=paragraph><p>Ha ezt kivetítjük a rendszer objektumaira, akkor a rendszerben levõ alanyokat illetõen csupán az aktuális osztály/rekeszek számítanak, mivel a rendszerben és hálózati csatolófelületeken elérhetõ hozzáférés-vezérlési jogokat tükrözi.</p></div><div class=paragraph><p>Az alany-objektum párokban megadott osztályzatok és rekeszek használhatóak fel egy olyan kapcsolat kiépítésére, amit "dominanciának" nevezünk. Ilyenkor egy alany ural egy objektumot, vagy egy objektum ural egy alanyt, vagy egyikük sem uralja a másikat, esetleg mind a kettõ uralja egymást. A "kettõs dominancia" esete akkor forog fenn, amikor a két címke megegyezik. A Biba információáramoltatási sajátosságaiból adódóan jogunk van rekeszeket létrehozni, "tudunk kell", hogy ezek projekteknek feleltethetõek meg, de az objektumok is rendelkezhetnek rekeszekkel. A felhasználók ilyenkor csak úgy tudnak elérni egyes objektumokat, ha az <code>su</code> vagy a <code>setpmac</code> használatával leszûkítik a jogaikat egy olyan rekeszre, ahol már nem érvényesülnek rájuk korlátozások.</p></div></div></div><div class=sect4><h5 id=_a_felhasználók_és_címkék_kapcsolata>16.4.1.2. A felhasználók és címkék kapcsolata<a class=anchor href=#_a_felhasználók_és_címkék_kapcsolata></a></h5><div class=paragraph><p>Maguknak a felhasználóknak is szükségük van címkékre, mivel csak ezek segítségével tudnak az állományaik és programjaik megfelelõ módon együttmûködni a rendszerben érvényes biztonsági házirenddel. Ezt a <span class=filename>login.conf</span> állományban megadható bejelentkezési osztályokkal állíthatjuk be. Minden címkéket használó modulban a felhasználóknak is van címkéjük.</p></div><div class=paragraph><p>Lentebb látható egy ilyen minta bejegyzés, amely minden modulhoz tartalmaz beállítást:</p></div><div class="literalblock programlisting"><div class=content><pre>default:\
	:copyright=/etc/COPYRIGHT:\
	:welcome=/etc/motd:\
	:setenv=MAIL=/var/mail/$,BLOCKSIZE=K:\
	:path=~/bin:/sbin:/bin:/usr/sbin:/usr/bin:/usr/local/sbin:/usr/local/bin:\
	:manpath=/usr/shared/man /usr/local/man:\
	:nologin=/usr/sbin/nologin:\
	:cputime=1h30m:\
	:datasize=8M:\
	:vmemoryuse=100M:\
	:stacksize=2M:\
	:memorylocked=4M:\
	:memoryuse=8M:\
	:filesize=8M:\
	:coredumpsize=8M:\
	:openfiles=24:\
	:maxproc=32:\
	:priority=0:\
	:requirehome:\
	:passwordtime=91d:\
	:umask=022:\
	:ignoretime@:\
	:label=partition/13,mls/5,biba/10(5-15),lomac/10[2]:</pre></div></div><div class=paragraph><p>Itt a <code>label</code> opciót használtuk a felhasználói osztályhoz tartozó alapértelmezett címkék beállításához, amit majd a MAC betartat. A felhasználók nem módosíthatják ezt az értéket, ezért ez a felhasználók számára nem tekinthetõ tetszõlegesen elhagyható beállításnak. Egy valós konfigurációban azonban a rendszergazda valószínûleg nem akarja majd egyszerre az összes modult használni. Javasoljuk, hogy mielõtt egy ilyen jellegû konfigurációt adnánk meg, olvassuk el az egész fejezetet.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>A felhasználók ezt a címkét meg tudják változtatni az elsõ bejelentkezés után, de csak a házirend keretein belül. A fenti példában úgy állítjuk be a Biba házirendet, hogy a futó programok sértetlenségi foka legalább 5, legfeljebb 15 lehet, de az alapértéke 10. Tehát a programok egészen addig 10-es szinten futnak, amíg a programok a Biba bejelentkezéskor megadott tartományában meg nem változtatják ezt a címkét, feltehetõen a <code>setpmac</code> parancs hatására.</p></div></td></tr></tbody></table></div><div class=paragraph><p>Mindig, amikor megváltozatjuk a <span class=filename>login.conf</span> beállításait, a <code>cap_mkdb</code> paranccsal újra kell generálni a bejelentkezési osztályokhoz tartozó adatbázist, amire a késõbbi példákban vagy részekben igyekszünk is mindig felhívni a figyelmet.</p></div><div class=paragraph><p>Nem árt hozzátennünk, hogy sok rendszerben kifejezetten sok felhasználót kell kezelnünk, amihez több különbözõ bejelentkezési osztályra is szükségünk lehet. Mivel késõbb már csak egyre jobban bonyolódni fog a felhasználók kezelése, ezért soha ne felejtsünk el komolyan elõre tervezni.</p></div><div class=paragraph><p>A FreeBSD következõ változataiban meg fognak jelenni más módszerek is a felhasználók és címkék közti kapcsolatok kezelésére. A FreeBSD 5.3 elõtt azonban ez még semmiképpen sem várható.</p></div></div><div class=sect4><h5 id=_a_hálózati_csatolófelületek_és_a_címkék_kapcsolata>16.4.1.3. A hálózati csatolófelületek és a címkék kapcsolata<a class=anchor href=#_a_hálózati_csatolófelületek_és_a_címkék_kapcsolata></a></h5><div class=paragraph><p>A hálózati csatlakozások esetében is állíthatunk be címkéket, melyek a hálózaton keresztül folyó adatok áramlását határozzák meg. Minden esetben ugyanúgy mûködnek, mint ahogy a házirendek az objektumokra. Például a <code>biba</code> esetében a magas beállításokkal rendelkezõ felhasználók nem férhetnek hozzá az alacsonyabb címkéjû hálózati csatolófelületekhez.</p></div><div class=paragraph><p>Ha MAC-címkéket akarunk rendelni egy hálózati felülethez, akkor az <code>ifconfig</code> parancsnak adjuk meg a <code>maclabel</code> paramétert. Például a</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># ifconfig bge0 maclabel biba/equal</span></code></pre></div></div><div class=paragraph><p>parancs beállítja a <code>biba/equal</code> MAC-címkét a <a href="https://man.freebsd.org/cgi/man.cgi?query=bge&amp;sektion=4&amp;format=html">bge(4)</a> felületre. A <code>biba/high(low-high)</code> alakú címkéket átadásukhoz idézõjelek közé kell tenni, különben hibát kapunk.</p></div><div class=paragraph><p>Minden címkézést támogató modulhoz tartoznak futási idõben állítható paraméterek, amelyekkel akár le is tudjuk tiltani a MAC-címkéket a hálózati csatolófelületeken. Ugyanezt jelenti egyébként, ha <code>equal</code> értéket adunk meg a címkének. Ezt behatóbban úgy ismerhetjük meg, ha kielemezzük a <code>sysctl</code> parancs kimenetét, a megfelelõ modul man oldalát vagy a fejezetben további részében található, erre vonatkozó információkat.</p></div></div></div><div class=sect3><h4 id=_egy_címke_vagy_több_címke>16.4.2. Egy címke vagy több címke?<a class=anchor href=#_egy_címke_vagy_több_címke></a></h4><div class=paragraph><p>Alapértelmezés szerint a rendszer a <code>singlelabel</code> beállítást használja. Ez vajon mit tartogat a rendszergazda számára? Számos olyan eltérést, aminek megvannak a saját elõnyei és hátrányai a rendszer védelmi modelljének rugalmassága szempontjából.</p></div><div class=paragraph><p>A <code>singlelabel</code> beállítás minden alany vagy objektum esetében csupán egyetlen címke, például a <code>biba/high</code> használatát engedi. Kevesebb adminisztrációs költséggel jár, azonban csökkenteni a címkézést támogató modulok testreszabhatóságát. Ezért sok rendszergazda inkább a <code>multilabel</code> beállítást választja a biztonsági házirend kialakítása során.</p></div><div class=paragraph><p>A <code>multilabel</code> beállítás lehetõvé teszi, hogy mindegyik alanyhoz és objektumhoz a szabványos <code>singlelabel</code> beállítás lehetõségeivel szemben egymástól függetlenül külön-külön rendelhessünk címkéket a partíciókon. Az egy- és többcímkés opciónak csak olyan modulok esetében van értelme, amelyek támogatják a címkézést, mint például a Biba, Lomac, MLS és a SEBSD házirendek.</p></div><div class=paragraph><p>Sokszor egyáltalán nincs is szükségünk a <code>multilabel</code> használatára. Tekintsük például a következõ helyzetet és biztonsági modellt:</p></div><div class=ulist><ul><li><p>Adott egy FreeBSD webszerver, ahol a MAC rendszert több biztonsági házirenddel alkalmazzuk.</p></li><li><p>A gépen egyedül csak a <code>biba/high</code> címkére van szükségünk mindenhez a rendszerben. Itt egyszerûen csak nem adjuk meg az állományrendszernek a <code>multilabel</code> beállítást, mivel az egycímkés rendszer mindig rendelkezésünkre áll.</p></li><li><p>Mivel azonban erre a gépre telepíteni akarunk egy webszervert is, ilyenkor a <code>biba/low</code> címke használatával igyekszünk korlátozni a szerver feldolgozási képességeit. A Biba házirendrõl és annak mûködésérõl csak a késõbbiekben fogunk írni, ezért ha az elõbbi megjegyzést még nem teljesen értjük, akkor egyszerûen csak olvassunk tovább és térjünk vissza ide. A szerver futása alatt, vagy legalább is idejének nagy részében egy külön partíciót használhatna, amire a <code>biba/low</code> címkét állítanánk be. Természetesen ez a példa korántsem teljes, hiszen hiányoznak belõle az adatokra érvényes korlátozások, a konfigurációs és felhasználói beállítások. Ez csupán az iménti gondolatmenet gyors illusztrációja.</p></li></ul></div><div class=paragraph><p>Amennyiben címkézést nem támogató modulokat alkalmazunk, a <code>multilabel</code> beállításra szinte sosem lesz szükségünk. Ilyenek például a <code>seeotheruids</code>, <code>portacl</code> és <code>partition</code> házirendek.</p></div><div class=paragraph><p>A <code>multilabel</code> opció használata és így speciális, többcímkés védelmi modell létrehozása képes elbonyolítani a rendszer karbantartását, mert ilyenkor az állományrendszerben mindennek lennie kell címkéjének: könyvtáraknak, állományok és még az eszközleíróknak is.</p></div><div class=paragraph><p>A most következõ paranccsal beállítjuk az állományrendszerre a <code>multilabel</code> opciót. Ez csak egyfelhasználós módban tehetõ meg:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># tunefs -l enable /</span></code></pre></div></div><div class=paragraph><p>A lapozópartíció esetében erre nincs szükség.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Elõfordulhat, hogy néhány felhasználónak nem sikerül a <code>multilabel</code> opciót beállítania a rendszerindító partícióra. Ha ez történne, akkor olvassuk el a fejezet <a href=#mac-troubleshoot>A hibák elhárítása a MAC rendszerben</a>át.</p></div></td></tr></tbody></table></div></div></div><div class=sect2><h3 id=mac-planning>16.5. A védelem megtervezése<a class=anchor href=#mac-planning></a></h3><div class=paragraph><p>Mindig hasznos idõt szánni a tervezésre, amikor nekilátunk egy új technológia alkalmazásához. A tervezés közben a rendszergazdának "egyben kell látnia a képet", lehetõleg az alábbiak figyelembevételével:</p></div><div class=ulist><ul><li><p>Elvárások a modell felé</p></li><li><p>A modell célkitûzései</p></li></ul></div><div class=paragraph><p>Továbbá a MAC használata esetén:</p></div><div class=ulist><ul><li><p>Miként osztályozzuk a célrendszeren rendelkezésre álló információt és erõforrásokat</p></li><li><p>Milyen információt vagy erõforrást kell korlátoznunk és milyen típusú korlátozást alkalmazzunk rájuk</p></li><li><p>A MAC melyik moduljain keresztül tudjuk elérni céljainkat</p></li></ul></div><div class=paragraph><p>Habár mindig módunkban áll megváltoztatni és újra konfigurálni a rendszerben található erõforrásokat és biztonsági beállításokat, sokszor azért igen kényelmetlen utánanézni a rendszerben és állítgatni az állományok, illetve felhasználói hozzáférések paramétereit. A beállításainkat valamint azok konfigurációját <em>elõször</em> külön próbáljuk ki, mielõtt a MAC alapú megvalósításunkat egy éles rendszeren kezdjük el használni. Ennek elhagyása szinte biztosan kudarcra ítél minket.</p></div><div class=paragraph><p>A különbözõ környezetek igényei és elvárásai eltérnek. Egy alaposan és minden részletében átgondolt védelmi profil megalapozása csökkenti a rendszer üzembehelyezése után elvégzendõ módosítások számát. Mint olyanokra, a következõ szakaszokban kitérünk a rendszergazdák számára elérhetõ modulokra, bemutatjuk a használatukat és beállításukat és egyes esetekben betekintést is adunk olyan helyzetekbe, ahol a legjobban kiaknázhatóak a képességeik. Például egy webszerver esetén hasznos lehet a <a href="https://man.freebsd.org/cgi/man.cgi?query=mac_biba&amp;sektion=4&amp;format=html">mac_biba(4)</a> és <a href="https://man.freebsd.org/cgi/man.cgi?query=mac_bsdextended&amp;sektion=4&amp;format=html">mac_bsdextended(4)</a> házirendek alkalmazása. Más esetekben, például egy kevés felhasználóval mûködõ számítógépen, a <a href="https://man.freebsd.org/cgi/man.cgi?query=mac_partition&amp;sektion=4&amp;format=html">mac_partition(4)</a> modul lehet jó választás.</p></div></div><div class=sect2><h3 id=mac-modules>16.6. A modulok beállítása<a class=anchor href=#mac-modules></a></h3><div class=paragraph><p>A MAC rendszerben megtalálható összes modul a korábban leírtak szerint beépíthetõ a rendszermagba vagy menet közben is betölthetõ modulként. A használni kívánt modulokat a <span class=filename>/boot/loader.conf</span> állományba javasolt felvenni, így azok be tudnak töltõdni a rendszer indítása folyamán.</p></div><div class=paragraph><p>A soron következõ szakaszokban a különbözõ MAC-modulokat dolgozzuk fel és foglaljuk össze a lehetõségeiket. Továbbá a fejezet szeretne szólni ezek alkalmazásáról speciális helyzetekben is. Egyes modulokkal címkézni is tudunk, aminek révén a hozzáféréseket címkékkel szabályozzuk, például úgy, hogy megmondjuk "mit szabad és mit nem". A címkék beállításait tartalmazó állomány vezérli az állományok elérését, a hálózati kommunikációt és még sok minden mást. Az elõzõ szakaszban már megismerhettük, hogy a <code>multilabel</code> opció segítségével hogyan állíthatjuk be az állományonkénti vagy partíciónkénti hozzáférés-vezérlést.</p></div><div class=paragraph><p>Az egycímkés konfigurációban az egész rendszerben csupán egyetlen címke használatára nyílik mód, ezért is hívják a <code>tunefs</code> beállítását <code>multilabel</code>nek.</p></div></div><div class=sect2><h3 id=mac-seeotheruids>16.7. A seeotheruids MAC-modul<a class=anchor href=#mac-seeotheruids></a></h3><div class=paragraph><p>A modul neve: <span class=filename>mac_seeotheruids.ko</span></p></div><div class=paragraph><p>A rendszermag konfigurációs beállítása: <code>options MAC_SEEOTHERUIDS</code></p></div><div class=paragraph><p>Rendszerindítási beállítás: <code>mac_seeotheruids_load="YES"</code></p></div><div class=paragraph><p>A <a href="https://man.freebsd.org/cgi/man.cgi?query=mac_seeotheruids&amp;sektion=4&amp;format=html">mac_seeotheruids(4)</a> modul a <code>security.bsd.see_other_uids</code> és <code>security.bsd.see_other_gids sysctl</code>-változókat utánozza és terjeszti ki. A használatához semmilyen címkét nem kell beállítani és transzparens módon képes együttmûködni a többi modullal.</p></div><div class=paragraph><p>A modult betöltése után az alábbi <code>sysctl</code>-változókkal tudjuk vezérelni:</p></div><div class=ulist><ul><li><p>A <code>security.mac.seeotheruids.enabled</code> engedélyezi a modult és az alapértelmezett beállításokat használja. Alapértelmezés szerint egyik felhasználó sem láthatja a többiek futó programjait és csatlakozásait.</p></li><li><p>A <code>security.mac.seeotheruids.specificgid_enabled</code> egy adott csoportot mentesít a házirend szabályozásai alól. Tehát ki akarunk vonni egy csoportot a házirend alkalmazásából, akkor állítsuk be a <code>security.mac.seeotheruids.specificgid=XXX sysctl</code>-változót, ahol az <em>XXX</em> a mentesíteni kívánt csoport numerikus azonosítója.</p></li><li><p>A <code>security.mac.seeotheruids.primarygroup_enabled</code> segítségével adott elsõdleges csoportokat vonhatunk ki a házirend hatálya alól. Ezt a változót nem használhatjuk a <code>security.mac.seeotheruids.specificgid_enabled</code> változóval együtt.</p></li></ul></div></div><div class=sect2><h3 id=mac-bsdextended>16.8. A bsdextended MAC-modul<a class=anchor href=#mac-bsdextended></a></h3><div class=paragraph><p>A modul neve: <span class=filename>mac_bsdextended.ko</span></p></div><div class=paragraph><p>A rendszermag konfigurációs beállítása: <code>options MAC_BSDEXTENDED</code></p></div><div class=paragraph><p>Rendszerindítási beállítás: <code>mac_bsdextended_load="YES"</code></p></div><div class=paragraph><p>A <a href="https://man.freebsd.org/cgi/man.cgi?query=mac_bsdextended&amp;sektion=4&amp;format=html">mac_bsdextended(4)</a> modul segítségével egy állományrendszer szintjén mûködõ tûzfalat tudunk kialakítani. Ez a modul a szabványos állományrendszeri engedély alapú modelljét bõvíti ki, lehetõvé téve, hogy a rendszergazda tûzfalszerû szabályokkal nyújtson védelmet a könyvtárszerkezetben található állományoknak, segédprogramoknak és könyvtáraknak. Amikor egy állományrendszerbeli objektumhoz próbálunk meg hozzáférni, a modul illeszti ezt egy szabályrendszerre, amiben vagy talál egy hozzá tartozó szabályt vagy kifut belõle. Ez a viselkedés a <code>security.mac.bsdextended.firstmatch_enabled</code> <a href="https://man.freebsd.org/cgi/man.cgi?query=sysctl&amp;sektion=8&amp;format=html">sysctl(8)</a> paraméter segítségével változtatható meg. Hasonlóan a FreeBSD-ben található többi tûzfalmodulhoz, az állományok elérését definiáló szabályok a rendszerindítás során egy <a href="https://man.freebsd.org/cgi/man.cgi?query=rc.conf&amp;sektion=5&amp;format=html">rc.conf(5)</a> változóból olvasódnak be.</p></div><div class=paragraph><p>A szabályokat a <a href="https://man.freebsd.org/cgi/man.cgi?query=ugidfw&amp;sektion=8&amp;format=html">ugidfw(8)</a> segédprogrammal adhatjuk meg, amelynek a formai szabályai hasonlóak az <a href="https://man.freebsd.org/cgi/man.cgi?query=ipfw&amp;sektion=8&amp;format=html">ipfw(8)</a> programéhoz. A <a href="https://man.freebsd.org/cgi/man.cgi?query=libugidfw&amp;sektion=3&amp;format=html">libugidfw(3)</a> függvénykönyvtár felhasználásával azonban további segédprogramok is írhatóak hozzá.</p></div><div class=paragraph><p>A modul használata során igyekezzünk minél jobban odafigyelni, mert helytelen alkalmazásával el tudjuk vágni magunkat az állományrendszer bizonyos részeitõl.</p></div><div class=sect3><h4 id=_példák>16.8.1. Példák<a class=anchor href=#_példák></a></h4><div class=paragraph><p>Miután sikerült betölteni a <a href="https://man.freebsd.org/cgi/man.cgi?query=mac_bsdextended&amp;sektion=4&amp;format=html">mac_bsdextended(4)</a> modult, a következõ paranccsal tudjuk lekérdezni a jelenleg érvényes szabályokat:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># ugidfw list</span>
0 slots, 0 rules</code></pre></div></div><div class=paragraph><p>Ahogy az várható is volt, pillanatnyilag még egyetlen szabályt sem adtunk meg. Ennek értelmében tehát mindent el tudunk érni. A következõ paranccsal tudunk olyan szabályt létrehozni, ahol a <code>root</code> kivételével elutasítjuk az összes felhasználó hozzáférését:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># ugidfw add subject not uid root new object not uid root mode n</span></code></pre></div></div><div class=paragraph><p>Ez egyébként egy nagyon buta ötlet, mivel így a felhasználók még a legegyszerûbb parancsokat, mint például az <code>ls</code>-t, sem tudják rájuk kiadni. Ennél sokkal humánusabb lesz, ha:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># ugidfw set 2 subject uid felhasználó1 object uid felhasználó2 mode n</span>
<span class=c># ugidfw set 3 subject uid felhasználó1 object gid felhasználó2 mode n</span></code></pre></div></div><div class=paragraph><p>Ilyenkor a <code>felhasználó1</code> nevû felhasználótól megvonjuk a <code><em>felhasználó2</em></code> felhasználói könyvtárának összes hozzáférését, beleértve a listázhatóságot is.</p></div><div class=paragraph><p>A <code>felhasználó1</code> helyett megadhatjuk a <code>not uid <em>felhasználó2</em></code> opciót is. Ebben az esetben egy felhasználó helyett az összes felhasználóra ugyanaz a korlátozás fog érvényesülni.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>A <code>root</code> felhasználóra ezek a beállítások nem vonatkoznak.</p></div></td></tr></tbody></table></div><div class=paragraph><p>Ezzel felvázoltuk, miként lehet a <a href="https://man.freebsd.org/cgi/man.cgi?query=mac_bsdextended&amp;sektion=4&amp;format=html">mac_bsdextended(4)</a> modult felhasználni az állományrendszerek megerõsítésére. Részletesebb információkért járuljunk a <a href="https://man.freebsd.org/cgi/man.cgi?query=mac_bsdextended&amp;sektion=4&amp;format=html">mac_bsdextended(4)</a> és <a href="https://man.freebsd.org/cgi/man.cgi?query=ugidfw&amp;sektion=8&amp;format=html">ugidfw(8)</a> man oldalakhoz.</p></div></div></div><div class=sect2><h3 id=mac-ifoff>16.9. Az ifoff MAC-modul<a class=anchor href=#mac-ifoff></a></h3><div class=paragraph><p>A modul neve: <span class=filename>mac_ifoff.ko</span></p></div><div class=paragraph><p>A rendszermag konfigurációs beállítása: <code>options MAC_IFOFF</code></p></div><div class=paragraph><p>Rendszerindítási beállítás: <code>mac_ifoff_load="YES"</code></p></div><div class=paragraph><p>A <a href="https://man.freebsd.org/cgi/man.cgi?query=mac_ifoff&amp;sektion=4&amp;format=html">mac_ifoff(4)</a> modul kizárólag abból a célból készült, hogy segítségével menet közben le tudjuk tiltani bizonyos hálózati csatolófelületek beállítását a rendszerindítás közben. Sem címkékre, sem pedig a többi MAC-modulra nincs szükségünk a használatához.</p></div><div class=paragraph><p>A vezérlést nagyrészt az alábbi <code>sysctl</code>-változókkal tudjuk megoldani.</p></div><div class=ulist><ul><li><p>A <code>security.mac.ifoff.lo_enabled</code> engedélyezi vagy letiltja a (<a href="https://man.freebsd.org/cgi/man.cgi?query=lo&amp;sektion=4&amp;format=html">lo(4)</a>) helyi loopback felületen az összes forgalmat.</p></li><li><p>A <code>security.mac.ifoff.bpfrecv_enabled</code> engedélyezi vagy letiltja a Berkeley csomagszûrõ (BPF, Berkeley Packet Filter) felületén az összes forgalmat.</p></li><li><p>A <code>security.mac.ifoff.other_enabled</code> engedélyezi vagy letiltja az összes többi csatolófelületen az összes forgalmat.</p></li></ul></div><div class=paragraph><p>A <a href="https://man.freebsd.org/cgi/man.cgi?query=mac_ifoff&amp;sektion=4&amp;format=html">mac_ifoff(4)</a> modult általában olyan környezetek monitorozásakor szokták használni, ahol a rendszer indítása során még nem szabad hálózati forgalomnak keletkeznie. Vagy például a <a class=package href=https://cgit.freebsd.org/ports/tree/security/aide/>security/aide</a> porttal együtt használva automatikusan el tudjuk zárni a rendszerünket, ha a védett könyvtárakban új állományok keletkeznek vagy megváltoznak a régiek.</p></div></div><div class=sect2><h3 id=mac-portacl>16.10. A portacl MAC-modul<a class=anchor href=#mac-portacl></a></h3><div class=paragraph><p>A modul neve: <span class=filename>mac_portacl.ko</span></p></div><div class=paragraph><p>A rendszermag konfigurációs beállítása: <code>MAC_PORTACL</code></p></div><div class=paragraph><p>Rendszerindítási beállítás: <code>mac_portacl_load="YES"</code></p></div><div class=paragraph><p>A <a href="https://man.freebsd.org/cgi/man.cgi?query=mac_portacl&amp;sektion=4&amp;format=html">mac_portacl(4)</a> modul a helyi TCP és UDP portok kiosztásának korlátozását teszi lehetõvé különféle <code>sysctl</code>-változókon keresztül. A <a href="https://man.freebsd.org/cgi/man.cgi?query=mac_portacl&amp;sektion=4&amp;format=html">mac_portacl(4)</a> segítségével lényegében a nem-<code>root</code> felhasználók is használhatnak privilegizált, tehát 1024 alatti portokat.</p></div><div class=paragraph><p>Miután betöltöttük, a modul az összes csatlakozásra alkalmazza a MAC-házirendet. Ezután az alábbi változókkal hangolhatjuk a viselkedését:</p></div><div class=ulist><ul><li><p>A <code>security.mac.portacl.enabled</code> totálisan engedélyezi vagy letiltja a házirend használatát.</p></li><li><p>A <code>security.mac.portacl.port_high</code> megadja azt a legmagasabb portot, amelyre még kiterjed a <a href="https://man.freebsd.org/cgi/man.cgi?query=mac_portacl&amp;sektion=4&amp;format=html">mac_portacl(4)</a> védelme.</p></li><li><p>Ha a <code>security.mac.portacl.suser_exempt</code> változónak nem nulla értéket adunk meg, akkor azzal a <code>root</code> felhasználót kivonjuk a szabályozások alól.</p></li><li><p>A <code>security.mac.portacl.rules</code> az érvényes mac_portacl házirendet adja meg, lásd lentebb.</p></li></ul></div><div class=paragraph><p>A <code>security.mac.portacl.rules</code> változó által megadott aktuális <code>mac_portacl</code> házirend formátuma a következõ: <code>szabály[,szabály,…​]</code>, ahol ezen a módon tetszõleges számú szabályt adhatunk meg. Az egyes szabályok pedig így írhatóak fel: <code>azonosítótípus: azonosító: protokoll: port</code>. Az <span class=parameter>azonosítótípus</span> értéke <code>uid</code> vagy <code>gid</code> lehet, amivel megadjuk, hogy az <span class=parameter>azonosító</span> paraméter felhasználóra vagy csoportra hivatkozik. A <span class=parameter>protokoll</span> paraméter adja meg, hogy a szabályt TCP vagy UDP típusú kapcsolatra értjük, és ennek megfelelõen az értéke is <code>tcp</code> vagy <code>udp</code> lehet. A sort végül a <span class=parameter>port</span> paraméter zárja, ahol annak a portnak számát adjuk meg, amelyhez az adott felhasználót vagy csoportot akarjuk kötni.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Mivel a szabályokat közvetlenül maga a rendszermag dolgozza fel, ezért a felhasználók illetve csoportok azonosítója, valamint a port értéke kizárólag numerikus érték lehet. Tehát a szabályokban név szerint nem hivatkozhatunk felhasználókra, csoportokra vagy szolgáltatásokra.</p></div></td></tr></tbody></table></div><div class=paragraph><p>A UNIX®-szerû rendszereken alapértelmezés szerint az 1024 alatti portokat csak privilegizált programok kaphatják meg és használhatják, tehát a <code>root</code> felhasználó neve alatt kell futniuk. A <a href="https://man.freebsd.org/cgi/man.cgi?query=mac_portacl&amp;sektion=4&amp;format=html">mac_portacl(4)</a> azonban a nem privilegizált programok számára is lehetõvé teszi, hogy elfoglalhassanak 1024 alatti portokat, amihez viszont elõször le kell tiltani ezt a szabvány UNIX®-os korlátozást. Ezt úgy érhetjük el, ha a <code>net.inet.ip.portrange.reservedlow</code> és <code>net.inet.ip.portrange.reservedhigh</code> változókat egyaránt nullára állítjuk.</p></div><div class=paragraph><p>A <a href="https://man.freebsd.org/cgi/man.cgi?query=mac_portacl&amp;sektion=4&amp;format=html">mac_portacl(4)</a> mûködésének részleteirõl a példákon keresztül vagy a megfelelõ man oldalakból tudhatunk meg többet.</p></div><div class=sect3><h4 id=_példák_2>16.10.1. Példák<a class=anchor href=#_példák_2></a></h4><div class=paragraph><p>A következõ példák az iméntieket igyekeznek jobban megvilágítani:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># sysctl security.mac.portacl.port_high=1023</span>
<span class=c># sysctl net.inet.ip.portrange.reservedlow=0 net.inet.ip.portrange.reservedhigh=0</span></code></pre></div></div><div class=paragraph><p>Elsõként beállítjuk, hogy a <a href="https://man.freebsd.org/cgi/man.cgi?query=mac_portacl&amp;sektion=4&amp;format=html">mac_portacl(4)</a> vegye át a szabványos privilegizált portok vezérlését és letiltjuk a normál UNIX®-os korlátozásokat.</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># sysctl security.mac.portacl.suser_exempt=1</span></code></pre></div></div><div class=paragraph><p>A <code>root</code> felhasználót azonban nem akarjuk kitenni a házirendnek, ezért a <code>security.mac.portacl.suser_exempt</code> változónak egy nem nulla értéket adunk meg. A <a href="https://man.freebsd.org/cgi/man.cgi?query=mac_portacl&amp;sektion=4&amp;format=html">mac_portacl(4)</a> modul most pontosan ugyanúgy mûködik, mint a UNIX®-szerû rendszerek alapértelmezés szerint.</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># sysctl security.mac.portacl.rules=uid:80:tcp:80</span></code></pre></div></div><div class=paragraph><p>A 80-as azonosítóval rendelkezõ felhasználó (aki általában a <code>www</code>) számára engedélyezzük a 80-as port használatát. Így a <code>www</code> felhasználó anélkül képes webszervert futtatni, hogy szüksége lenne a <code>root</code> jogosultságaira.</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># sysctl security.mac.portacl.rules=uid:1001:tcp:110,uid:1001:tcp:995</span></code></pre></div></div><div class=paragraph><p>Az 1001-es azonosítóval rendelkezõ felhasználónak megengedjük, hogy elfoglalhassa a 110-es ("pop3") és 995-ös ("pop3s") portokat. Ennek köszönhetõen az adott felhasználó el tud indítani egy szervert, amihez a 110-es és 995-ös portokon lehet kapcsolódni.</p></div></div></div><div class=sect2><h3 id=mac-partition>16.11. A partition MAC-modul<a class=anchor href=#mac-partition></a></h3><div class=paragraph><p>A modul neve: <span class=filename>mac_partition.ko</span></p></div><div class=paragraph><p>A rendszermag konfigurációs beállítása: <code>options MAC_PARTITION</code></p></div><div class=paragraph><p>Rendszerindítási beállítás: <code>mac_partition_load="YES"</code></p></div><div class=paragraph><p>A <a href="https://man.freebsd.org/cgi/man.cgi?query=mac_partition&amp;sektion=4&amp;format=html">mac_partition(4)</a> házirend a futó programokat címkéjük szerint adott "partíciókra" osztja szét. Ezt leginkább egy speciális <a href="https://man.freebsd.org/cgi/man.cgi?query=jail&amp;sektion=8&amp;format=html">jail(8)</a> megoldásként tudjuk elképzelni, noha teljesen felesleges összehasonlítani a kettõt.</p></div><div class=paragraph><p>Ez egy olyan modul, amelyet a <a href="https://man.freebsd.org/cgi/man.cgi?query=loader.conf&amp;sektion=5&amp;format=html">loader.conf(5)</a> állományba kell felvenni, hogy a rendszerindítása közben be tudjon töltõdni.</p></div><div class=paragraph><p>Ezt a házirendet többségében a <a href="https://man.freebsd.org/cgi/man.cgi?query=setpmac&amp;sektion=8&amp;format=html">setpmac(8)</a> segédprogrammal tudjuk állítgatni, ahogy az majd lentebb látható lesz. A következõ <code>sysctl</code>-változó tartozik még a modulhoz:</p></div><div class=ulist><ul><li><p>A <code>security.mac.partition.enabled</code> engedélyezi a futó programok MAC rendszeren keresztüli felosztását.</p></li></ul></div><div class=paragraph><p>A házirend engedélyezésével a felhasználók csak a saját programjaikat láthatják, illetve mindazokat, amelyek az övékével egy partícióba tartoznak, de a rajta kívül levõ programokkal már nem dolgozhatnak. Például, ha egy felhasználó az <code>insecure</code> ("nem biztonságos") osztály tagja, akkor ne engedjük, hogy hozzáférhessen a <code>top</code> vagy bármilyen más olyan parancshoz, amely további futó programokat hoz létre.</p></div><div class=paragraph><p>A <code>setpmac</code> használatával tudunk címkéket készíteni a partíciókhoz és programokat rendelni hozzájuk:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># setpmac partition/13 top</span></code></pre></div></div><div class=paragraph><p>Így a <code>top</code> parancsot hozzáadjuk az <code>insecure</code> osztályban levõ felhasználókhoz rendelt címkéhez. Vegyük észre, hogy az <code>insecure</code> osztályba tartozó felhasználók által elindított összes program a <code>partition/13</code> címkét fogja használni.</p></div><div class=sect3><h4 id=_példák_3>16.11.1. Példák<a class=anchor href=#_példák_3></a></h4><div class=paragraph><p>A következõ parancs megmutatja a partíciók címkéit és a futó programok listáját:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># ps Zax</span></code></pre></div></div><div class=paragraph><p>Ezzel paranccsal pedig megnézhetjük egy másik felhasználó programjainak címkéit és a felhasználó által futtatott programokat:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># ps -ZU trhodes</span></code></pre></div></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>A felhasználók látják a <code>root</code> címkéjével futó programokat is, hacsak be nem töltjük a <a href="https://man.freebsd.org/cgi/man.cgi?query=mac_seeotheruids&amp;sektion=4&amp;format=html">mac_seeotheruids(4)</a> házirendet.</p></div></td></tr></tbody></table></div><div class=paragraph><p>Ezt a megoldást úgy tudnánk igazán ravaszul felhasználni, ha például az <span class=filename>/etc/rc.conf</span> állományban letiltanánk az összes szolgáltatást és egy olyan szkripttel indítanánk el ezeket, amely futtatásuk elõtt beállítja hozzájuk a megfelelõ címkét.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>A most következõ házirendek a három alapértelmezett címkeérték helyett egész számokat használnak. Ezekrõl, valamint a rájuk vonatkozó korlátozásokról a megfelelõ modulok man oldalain ismerhetünk meg többet.</p></div></td></tr></tbody></table></div></div></div><div class=sect2><h3 id=mac-mls>16.12. A többszintû biztonsági MAC-modul<a class=anchor href=#mac-mls></a></h3><div class=paragraph><p>A modul neve: <span class=filename>mac_mls.ko</span></p></div><div class=paragraph><p>A rendszermag konfigurációs beállítása: <code>options MAC_MLS</code></p></div><div class=paragraph><p>Rendszerindítási beállítás: <code>mac_mls_load="YES"</code></p></div><div class=paragraph><p>A <a href="https://man.freebsd.org/cgi/man.cgi?query=mac_mls&amp;sektion=4&amp;format=html">mac_mls(4)</a> (MLS, Multi-Level Security) házirend az információ szigorú áramoltatásával vezérli a rendszerben található alanyok és objektumok közti elérést.</p></div><div class=paragraph><p>A MLS megoldását alkalmazó környezetekben a rekeszek mellett minden alanyra és objektumra be kell még állítanunk egy adott szintû "engedélyt" is. Mivel az engedélyek avagy az érzékenység szintje akár a hatezret is meghaladhatja, egy rendszergazda számára valódi rémálommá válthat az egyes alanyok és objektumok precíz beállítása. Szerencsére a házirend erre a célra tartalmaz három elõre definiált "instant" címkét.</p></div><div class=paragraph><p>Ezek az <code>mls/low</code>, <code>mls/equal</code> és <code>mls/high</code>. Mivel a man oldal elég részletesen kifejti ezeket, ezért itt csak érintõlegesen foglalkozunk velük:</p></div><div class=ulist><ul><li><p>Az <code>mls/low</code> címke egy olyan alacsony szintû beállítást képvisel, amely lehetõvé teszi, hogy az összes többi objektum uralja. Tehát bárminek is adjuk az <code>mls/low</code> címkét, alacsony szintû engedéllyel fog rendelkezni és nem lesz képes elérni a magasabb szinten levõ információt. Ráadásul a címke a magasabb szintû objektumok számára se fogja engedni, hogy információt közöljön vagy adjon át az alacsonyabb szintek felé.</p></li><li><p>Az <code>mls/equal</code> címke olyan objektumok esetében ajánlott, amelyeket ki akarunk hagyni a házirend szabályozásaiból.</p></li><li><p>Az <code>mls/high</code> címke az elérhetõ legmagasabb szintû engedélyt ábrázolja. Az ilyen címkével ellátott objektumok a rendszer összes többi objektuma felett uralommal rendelkeznek, habár az alacsonyabb szintû objektumok felé nem képesek információt közvetíteni.</p></li></ul></div><div class=paragraph><p>Az MLS:</p></div><div class=ulist><ul><li><p>Egy hierarchikus védelmi szinteket épít fel nem hierarchikus kategóriákkal.</p></li><li><p>Szabályai rögzítettek: a felsõbb szintek olvasása és az alsóbb szintek írása egyaránt tiltott (az alanyok csak a saját vagy az alatta levõ szinteken levõ objektumokat képesek olvasni, de a felette állókat már nem. Ehhez hasonlóan az alanyok a velük egyezõ vagy a felsõbb szinteket tudják írni, de az alattuk levõket már nem).</p></li><li><p>Megõrzi a titkokat (megakadályozza az adatok alkalmatlan közzétételét).</p></li><li><p>Megadja mindazt az alapot, ami szükséges ahhoz, hogy az adatokat több kényességi szinten, párhuzamosan is kezelni tudjuk (anélkül, hogy titkos és bizalmas információkat szivárogtatnánk ki).</p></li></ul></div><div class=paragraph><p>A speciális szolgáltatások és felületek beállításához az alábbi <code>sysctl</code>-változók használhatóak:</p></div><div class=ulist><ul><li><p>A <code>security.mac.mls.enabled</code> engedélyezi vagy tiltja le az MLS házirend alkalmazását.</p></li><li><p>A <code>security.mac.mls.ptys_equal</code> hatására látja el <code>mls/equal</code> címkével az összes <a href="https://man.freebsd.org/cgi/man.cgi?query=pty&amp;sektion=4&amp;format=html">pty(4)</a> eszközt létrehozásuk során.</p></li><li><p>A <code>security.mac.mls.revocation_enabled</code> használható az alacsonyabb szintre minõsített objektumok hozzáférésének megvonására.</p></li><li><p>A <code>security.mac.mls.max_compartments</code> segítségével adható meg az objektumok által használt rekeszek szintjének maximális száma. Lényegében a rekeszek rendszerben engedélyezett maximuma.</p></li></ul></div><div class=paragraph><p>Az MLS címkéit a <a href="https://man.freebsd.org/cgi/man.cgi?query=setfmac&amp;sektion=8&amp;format=html">setfmac(8)</a> paranccsal tudjuk módosítani. Egy ehhez hasonló paranccsal tudunk egy objektumhoz címkét rendelni:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># setfmac mls/5 próba</span></code></pre></div></div><div class=paragraph><p>A <span class=filename>próba</span> állomány MLS-címkéjét az alábbi paranccsal kérhetjük le:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># getfmac próba</span></code></pre></div></div><div class=paragraph><p>Ezzel össze is foglaltuk az MLS házirend lehetõségeit. Az eddigiket úgy is megoldhatjuk, hogy létrehozunk egy központi házirendet az <span class=filename>/etc</span> könyvtárban, amelyben megadjuk az MLS házirendhez tartozó információkat, majd átadjuk a <code>setfmac</code> parancsnak. Erre a módszerre majd a házirendek bemutatása után kerül sor.</p></div><div class=sect3><h4 id=_a_kényesség_megállapítása>16.12.1. A kényesség megállapítása<a class=anchor href=#_a_kényesség_megállapítása></a></h4><div class=paragraph><p>A többszintû biztonsági házirend használatával a rendszergazda a kényes információk áramlásának irányát tudja befolyásolni. A megoldás "felfele nem lehet olvasni, lefele nem lehet írni" jellege folytán alapból mindent a legalacsonyabb szintre helyez. Így tehát kezdetben minden elérhetõ, és a rendszergazdának lassanként ebbõl az állapotból elindulva kell behangolnia az erre alapozó védelmi rendszert az információ bizalmasságának megfelelõen.</p></div><div class=paragraph><p>A fentebb említett három alapvetõ címke mellett a rendszergazdának valószínûleg szüksége lesz a felhasználók csoportosítására és a csoportok közti információáramlás szabályozására. A információ bizalmasságának szintjeit minden bizonnyal könnyebb szavakkal beazonosítani, például <code>Confidential</code> (bizalmas), <code>Secret</code> (titkos) vagy <code>Top Secret</code> (szigorúan bizalmas). Bizonyos helyzetekben elég csak a futó projekteknek megfelelõen kialakítani csoportokat. Az osztályozás konkrét módszerétõl függetlenül azonban mindig elmondható, hogy elõzetes tervezés nélkül sose állítsunk össze ilyen fajsúlyú házirendet.</p></div><div class=paragraph><p>Ezt a biztonsági modult például webes üzletek esetén érdemes használnunk, ahol egy állományszerver tárolja a cég fontos adatait és pénzügyi információit. Viszont egy két vagy három felhasználóval üzemelõ munkaállomás esetében szinte teljesen felesleges gondolkodni rajta.</p></div></div></div><div class=sect2><h3 id=mac-biba>16.13. A Biba MAC-modul<a class=anchor href=#mac-biba></a></h3><div class=paragraph><p>A modul neve: <span class=filename>mac_biba.ko</span></p></div><div class=paragraph><p>A rendszermag konfigurációs beállítása: <code>options MAC_BIBA</code></p></div><div class=paragraph><p>Rendszerindítási beállítás: <code>mac_biba_load="YES"</code></p></div><div class=paragraph><p>A <a href="https://man.freebsd.org/cgi/man.cgi?query=mac_biba&amp;sektion=4&amp;format=html">mac_biba(4)</a> modul a MAC Biba elnevezésû házirendjét tölti be. Ez leginkább az MLS házirendhez hasonlít, azzal a kivétellel, hogy az információ áramoltatására vonatkozó szabályok némileg visszafelé mûködnek. Tehát míg az MLS házirend a kényes információ áramlását felfelé nem engedi, addig ez a lefelé irányuló áramlást állítja meg. Emiatt ez a szakasz tulajdonképpen mind a két házirendre érvényesül.</p></div><div class=paragraph><p>A Biba alkalmazása során minden alany és objektum egy "sértetlenséget" jelképezõ címkét visel. Ezek a címkék hierarchikus osztályokból, nem peidg hiearchikus összetevõkbõl származnak. Egy objektum vagy alany sértetlensége a besorolásával növekszik.</p></div><div class=paragraph><p>A modul a <code>biba/low</code>, <code>biba/equal</code> és <code>biba/high</code> címkéket ismeri, vagyis bõvebben:</p></div><div class=ulist><ul><li><p>A <code>biba/low</code> címke tekinthetõ az alanyok és objektumok legkisebb sértetlenségének. Ha beállítjuk egy objektumra vagy alanyra, akkor ezzel megakadályozzuk, hogy nagyobb sértetlenségû objektumokat vagy alanyokat tudjanak írni. Ettõl függetlenül azonban még képesek olvasni ezeket.</p></li><li><p>A <code>biba/equal</code> címke használata kizárólag olyan objektumok esetében javasolt, amelyeket ki akarunk vonni a házirend alól.</p></li><li><p>A <code>biba/high</code> címke megengedi az alacsonyabb szinteken levõ objektumokat írását, de az olvasását viszont már nem. Ezt a címkét olyan objektumra érdemes ragasztani, amelyek hatással vannak az egész rendszer sértetlenségére.</p></li></ul></div><div class=paragraph><p>A Biba:</p></div><div class=ulist><ul><li><p>Hierarchikus sértetlenségi szinteket épít fel nem hiearchikus sértetlenségi kategóriákkal kiegészítve.</p></li><li><p>Szabályai rögzítettek: az felsõbb szintek írása és az alsóbb szintek olvasása egyaránt tilos (pontosan az MLS ellentéte). Egy alany csak a saját vagy az alatta álló szinteken szereplõ objektumokat tudja írni. Ehhez hasonló módon egy alany csak a saját vagy az afeletti szinten található objektumokat képes olvasni.</p></li><li><p>Az adatok sértetlenségét biztosítja (megakadályozza az alkalmatlan módosításukat)</p></li><li><p>Sértetlenségi szinteket határoz meg (szemben az MLS kényességi szintjeivel).</p></li></ul></div><div class=paragraph><p>Az alábbi <code>sysctl</code>-változókkal vezérlhetjük a Biba házirend mûködését:</p></div><div class=ulist><ul><li><p>A <code>security.mac.biba.enabled</code> használható a célrendszeren a Biba házirend engedélyezére vagy letiltására.</p></li><li><p>A <code>security.mac.biba.ptys_equal</code> segítségével kapcsolhatjuk ki a Biba házirend alkalmazását a <a href="https://man.freebsd.org/cgi/man.cgi?query=pty&amp;sektion=4&amp;format=html">pty(4)</a> eszközökön.</p></li><li><p>A <code>security.mac.biba.revocation_enabled</code> hatására visszavonódik az objektumok hozzáférése, ha az rájuk vonatkozó címke megváltozik.</p></li></ul></div><div class=paragraph><p>A rendszer objektumain a Biba házirendet a <code>setfmac</code> és <code>getfmac</code> paranccsal állíthatjuk be:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># setfmac biba/low próba</span>
<span class=c># getfmac próba</span>
próba: biba/low</code></pre></div></div><div class=sect3><h4 id=_a_sértetlenség_megállapítása>16.13.1. A sértetlenség megállapítása<a class=anchor href=#_a_sértetlenség_megállapítása></a></h4><div class=paragraph><p>A sértetlenség a kényességtõl eltérõen azt igyekszik szavatolni, hogy az információt illetéktelenek nem módosítják. Ez egyaránt vonatkozik az alanyok, objektumok és a kettõ között átadott adatokra. Gondoskodik róla, hogy a felhasználók csak olyan információkat változtathathassanak meg, sõt csak olyat érhessenek el, amire ténylegesen szükségük van.</p></div><div class=paragraph><p>A <a href="https://man.freebsd.org/cgi/man.cgi?query=mac_biba&amp;sektion=4&amp;format=html">mac_biba(4)</a> biztonsági modul megengedi a rendszergazda számára, hogy megmondja milyen állományokat és programokat láthat vagy hívhat meg a felhasználó vagy felhasználók egy csoportja, miközben biztosítja, hogy az állományok és a programok nincsenek kitéve semmilyen fenyegetésnek, és a rendszer az adott felhasználóban vagy felhasználói csoportban megbízik.</p></div><div class=paragraph><p>A kezdeti tervezési fázis során a rendszergazdának fel kell készülnie arra, hogy a felhasználókat osztályokra, szintekre és területekre kell osztania. A felhasználók nem csak adatokhoz, hanem programokhoz és segédprogramokhoz sem lesznek képesek hozzáférni, mind az indításuk elõtt és után. A modul aktiválás után a rendszer alapból rögtön a legmagasabb címkét kapja meg, és teljesen a rendszergazdára hárul, hogy a felhasználókhoz beállítsa a különféle osztályokat és szinteket. A fentebb leírt engedélyszintek helyett akár témák alapján is tervezhetünk. Például kizárólag csak a fejlesztõk számára engedjük meg a forráskód módosítását, a forráskód lefordítását és a többi fejlesztõeszköz használatát. Eközben a többi felhasználót felosztjuk további csoportokba, például tesztelõkre és tervezõkre, vagy meghagyjuk ezeket átlagos felhasználóknak, akik csak olvasási joggal rendelkeznek.</p></div><div class=paragraph><p>A megvalósított biztonsági modell természetébõl fakadóan egy kevésbé sértetlenebb alany nem írhatja a sokkal sértetlenebb alanyokat, a sokkal sértetlenebb alanyok pedig nem érhetik el vagy olvashatják a kevésbé sértetlen objektumokat. A lehetõ legkisebb osztályú címke beállításával gyakorlatilag elérhetetlenné teszük az alanyok számára. A modult valószínûleg egy korlátozott webszerver, fejlesztõi- és tesztgépek vagy forráskód tárolására szánt környezetben érdemes bevetni. Annál esélytelenebb a használata viszont egy munkaállomás, útválasztó vagy hálózati tûzfal esetében.</p></div></div></div><div class=sect2><h3 id=mac-lomac>16.14. A LOMAC MAC-modul<a class=anchor href=#mac-lomac></a></h3><div class=paragraph><p>A modul neve: <span class=filename>mac_lomac.ko</span></p></div><div class=paragraph><p>A rendszermag konfigurációs beállítása: <code>options MAC_LOMAC</code></p></div><div class=paragraph><p>Rendszerindítás beállítás: <code>mac_lomac_load="YES"</code></p></div><div class=paragraph><p>Eltérõen a MAC Biba házirendjétõl, a <a href="https://man.freebsd.org/cgi/man.cgi?query=mac_lomac&amp;sektion=4&amp;format=html">mac_lomac(4)</a> egyedül csak azután engedi elérni az kevésbé sértetlenebb objektumokat, miután csökkentjük a sértetlenség szintjét és ezzel betartjuk a sértetlenségre vonatkozó szabályokat.</p></div><div class=paragraph><p>A gyenge vízjeles sértetlenségi házirend MAC alapú változatát nem szabad összetéveszteni a korábbi <a href="https://man.freebsd.org/cgi/man.cgi?query=lomac&amp;sektion=4&amp;format=html">lomac(4)</a> implementációval, amely majdnem ugyanúgy mûködik, mint a Biba, azzal az a kivétellel, hogy a lebegõ címkékkel támogatjuk az alanyok lefokozását egy kisegítõ osztály rekeszén keresztül. Ez a másodlagos rekesz <code>[kisegítõ_osztály]</code> alakú. Tehát amikor egy kisegítõ osztállyal adjuk meg a lomac házirendet, valahogy így néz ki: <code>lomac/10[2]</code>, ahol a kettes (2) szám ez a kisegítésre használt osztály.</p></div><div class=paragraph><p>A MAC LOMAC házirendje az összes rendszerszintû objektum esetében jelenlevõ sértetlenségi címkézésen alapszik, megengedve az alanyok számára, hogy az kevésbé sértetlen objektumokat olvasni tudják, majd a címke leminõsítésével az alany meg tudja akadályozni a sokkal sértetlenebbnek ítélt objektumok jövõbeni írását. Ez az a fentebb tárgyalt <code>[kisegítõ_osztály]</code> opció, ezért ez a modul a Bibáénál több kompatibilitást és kevesebb kezdeti beállítást igényel.</p></div><div class=sect3><h4 id=_példák_4>16.14.1. Példák<a class=anchor href=#_példák_4></a></h4><div class=paragraph><p>Hasonlóan a Biba és MLS házirendeknél megszokottakhoz, a <code>setfmac</code> és <code>setpmac</code> segédprogramok használhatóak a címkék hozzárendeléséhez:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># setfmac /usr/home/trhodes lomac/high[low]</span>
<span class=c># getfmac /usr/home/trhodes lomac/high[low]</span></code></pre></div></div><div class=paragraph><p>Itt a kisegítõ osztály a <code>low</code>. Ezt csak a LOMAC MAC-házirendnél adhatjuk meg.</p></div></div></div><div class=sect2><h3 id=mac-implementing>16.15. A Nagios elzárása a MAC rendszerrel<a class=anchor href=#mac-implementing></a></h3><div class=paragraph><p>A most következõ bemutatóban a MAC moduljainak és a megfelelõen beállított házirendek használatával fogunk kialakítani egy biztonságos környezetet. Ne feledjük azonban, hogy ez csupán egy ártatlan próba és nem pedig a mindenki biztonsági aggályait kielégítõ legvégsõ megoldás. Ha egy házirendet vakon építünk fel és nem értjük meg a mûködését, az soha nem válik hasznunkra, és egy éles helyzetben katasztrofális hatással járhat.</p></div><div class=paragraph><p>A folyamat megkezdése elõtt be kell állítanunk a <code>multilabel</code> opciót mindegyik állományrendszerre, a fejezet elején leírtaknak megfelelõen. Ha ezt a lépést kihagyjuk, akkor hibákat kapunk. Továbbá még az elõkészület részeként ne felejtsünk el gondoskodni a <a class=package href=https://cgit.freebsd.org/ports/tree/net-mngt/nagios-plugins/>net-mngt/nagios-plugins</a>, <a class=package href=https://cgit.freebsd.org/ports/tree/net-mngt/nagios/>net-mngt/nagios</a> és <a class=package href=https://cgit.freebsd.org/ports/tree/www/apache13/>www/apache13</a> portok telepítésérõl, beállításáról és megfelelõ mûködésérõl sem.</p></div><div class=sect3><h4 id=_a_nem_megbízható_felhasználók_osztályának_létrehozása>16.15.1. A nem megbízható felhasználók osztályának létrehozása<a class=anchor href=#_a_nem_megbízható_felhasználók_osztályának_létrehozása></a></h4><div class=paragraph><p>Az eljárást kezdjük az alábbi (insecure) felhasználói osztály hozzáadásával az <span class=filename>/etc/login.conf</span> állományban:</p></div><div class="literalblock programlisting"><div class=content><pre>insecure:\
:copyright=/etc/COPYRIGHT:\
:welcome=/etc/motd:\
:setenv=MAIL=/var/mail/$,BLOCKSIZE=K:\
:path=~/bin:/sbin:/bin:/usr/sbin:/usr/bin:/usr/local/sbin:/usr/local/bin
:manpath=/usr/shared/man /usr/local/man:\
:nologin=/usr/sbin/nologin:\
:cputime=1h30m:\
:datasize=8M:\
:vmemoryuse=100M:\
:stacksize=2M:\
:memorylocked=4M:\
:memoryuse=8M:\
:filesize=8M:\
:coredumpsize=8M:\
:openfiles=24:\
:maxproc=32:\
:priority=0:\
:requirehome:\
:passwordtime=91d:\
:umask=022:\
:ignoretime@:\
:label=biba/10(10-10):</pre></div></div><div class=paragraph><p>Valamint egészítsük ki az alapértelmezett (default) felhasználói osztályt a következõ sorral:</p></div><div class="literalblock programlisting"><div class=content><pre>:label=biba/high:</pre></div></div><div class=paragraph><p>Ahogy ezzel elkészültünk, az hozzá tartozó adatbázis újbóli legyártásához a következõ parancsot kell kiadnunk:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># cap_mkdb /etc/login.conf</span></code></pre></div></div></div><div class=sect3><h4 id=_a_rendszerindítással_kapcsolatos_beállítások>16.15.2. A rendszerindítással kapcsolatos beállítások<a class=anchor href=#_a_rendszerindítással_kapcsolatos_beállítások></a></h4><div class=paragraph><p>Még ne indítsuk újra a számítógépet, csupán a szükséges modulok betöltéséhez bõvítsük ki a <span class=filename>/boot/loader.conf</span> állományt az alábbi sorokkal:</p></div><div class="literalblock programlisting"><div class=content><pre>mac_biba_load=&#34;YES&#34;
mac_seeotheruids_load=&#34;YES&#34;</pre></div></div></div><div class=sect3><h4 id=_a_felhasználók_beállítása>16.15.3. A felhasználók beállítása<a class=anchor href=#_a_felhasználók_beállítása></a></h4><div class=paragraph><p>Soroljuk be a <code>root</code> felhasználót a <code>default</code> osztályba:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># pw usermod root -L default</span></code></pre></div></div><div class=paragraph><p>Az összes <code>root</code> felhasználón kívüli hozzáférésnek vagy rendszerfelhasználónak most kelleni fog egy bejelentkezési osztály. A bejelentkezési osztályra egyébként is szükség lesz, mert ennek hiányában a felhasználók még az olyan egyszerû parancsokat sem tudják kiadni, mint például a <a href="https://man.freebsd.org/cgi/man.cgi?query=vi&amp;sektion=1&amp;format=html">vi(1)</a>. A következõ <code>sh</code> szkript nekünk erre pontosan megfelel:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># for x in `awk -F: &#39;($3 &gt;= 1001) &amp;&amp; ($3 != 65534) { print $1 }&#39; \</span>
	/etc/passwd<span class=sb>`</span><span class=p>;</span> <span class=k>do </span>pw usermod <span class=nv>$x</span> <span class=nt>-L</span> default<span class=p>;</span> <span class=k>done</span><span class=p>;</span></code></pre></div></div><div class=paragraph><p>Helyezzük át a <code>nagios</code> és <code>www</code> felhasználókat az insecure osztályba:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># pw usermod nagios -L insecure</span></code></pre></div></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># pw usermod www -L insecure</span></code></pre></div></div></div><div class=sect3><h4 id=_a_contexts_állomány_létrehozása>16.15.4. A <span class=filename>contexts</span> állomány létrehozása<a class=anchor href=#_a_contexts_állomány_létrehozása></a></h4><div class=paragraph><p>Most csinálnunk kell egy <span class=filename>contexts</span> állományt. Ebben példában az <span class=filename>/etc/policy.contexts</span> állományt használjuk.</p></div><div class="literalblock programlisting"><div class=content><pre># Ez a rendszer alapértelmezett BIBA házirendje.

# Rendszer:
/var/run                        biba/equal
/var/run/*                      biba/equal

/dev                            biba/equal
/dev/*                          biba/equal

/var				biba/equal
/var/spool                      biba/equal
/var/spool/*                    biba/equal

/var/log                        biba/equal
/var/log/*                      biba/equal

/tmp				biba/equal
/tmp/*				biba/equal
/var/tmp			biba/equal
/var/tmp/*			biba/equal

/var/spool/mqueue		biba/equal
/var/spool/clientmqueue		biba/equal

# Nagios:
/usr/local/etc/nagios
/usr/local/etc/nagios/*         biba/10

/var/spool/nagios               biba/10
/var/spool/nagios/*             biba/10

# Apache:
/usr/local/etc/apache           biba/10
/usr/local/etc/apache/*         biba/10</pre></div></div><div class=paragraph><p>Ezzel a házirenddel az információ áramlását szabályozzuk. Ebben a konkrét konfigurációban a felhasználók, a <code>root</code> és társai, nem férhetnek hozzá a Nagioshoz. A Nagios beállításait tároló állományok és a neve alatt futó programok így teljesen különválnak vagyis elzáródnak a rendszer többi részétõl.</p></div><div class=paragraph><p>Ez az iménti állomány a következõ parancs hatására kerül be a rendszerünkbe:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># setfsmac -ef /etc/policy.contexts /</span>
<span class=c># setfsmac -ef /etc/policy.contexts /</span></code></pre></div></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>A fenti állományrendszer felépítése a környezettõl függõen eltérhet, habár ezt minden egyes állományrendszeren le kell futtatni.</p></div></td></tr></tbody></table></div><div class=paragraph><p>Az <span class=filename>/etc/mac.conf</span> állományt törzsét a következõképpen kell még átírnunk:</p></div><div class="literalblock programlisting"><div class=content><pre>default_labels file ?biba
default_labels ifnet ?biba
default_labels process ?biba
default_labels socket ?biba</pre></div></div></div><div class=sect3><h4 id=_a_hálózat_engedélyezése>16.15.5. A hálózat engedélyezése<a class=anchor href=#_a_hálózat_engedélyezése></a></h4><div class=paragraph><p>Tegyük hozzá a következõ sort az <span class=filename>/boot/loader.conf</span> állományhoz:</p></div><div class="literalblock programlisting"><div class=content><pre>security.mac.biba.trust_all_interfaces=1</pre></div></div><div class=paragraph><p>Ezt az alábbi beállítást pedig szúrjuk be az <span class=filename>rc.conf</span> állományba a hálózati kártya konfigurációjához. Amennyiben az internetet DHCP segítségével érjük el, ezt a beállítást manuálisan kell megtenni minden rendszerindítás alkalmával:</p></div><div class="literalblock programlisting"><div class=content><pre>maclabel biba/equal</pre></div></div></div><div class=sect3><h4 id=_a_konfiguráció_kipróbálása>16.15.6. A konfiguráció kipróbálása<a class=anchor href=#_a_konfiguráció_kipróbálása></a></h4><div class=paragraph><p>Gondoskodjunk róla, hogy a webszerver és a Nagios nem fog elindulni a rendszer indításakor, majd indítsuk újra a gépet. Ezenkívül még ellenõrizzük, hogy a <code>root</code> ne tudjon hozzáférni a Nagios beállításait tartalmazó könyvtárhoz. Ha a <code>root</code> képes kiadni egy <a href="https://man.freebsd.org/cgi/man.cgi?query=ls&amp;sektion=1&amp;format=html">ls(1)</a> parancsot a <span class=filename>/var/spool/nagios</span> könyvtárra, akkor valamit elronthattunk. Normális esetben egy <code>permission denied</code> üzenetet kell kapnunk.</p></div><div class=paragraph><p>Ha minden jónak tûnik, akkor a Nagios, Apache és Sendmail most már elindítható a biztonsági házirend szabályozásai szerint. Ezt a következõ parancsokkal tehetjük meg:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># cd /etc/mail &amp;&amp; make stop &amp;&amp; \</span>
setpmac biba/equal make start <span class=o>&amp;&amp;</span> setpmac biba/10<span class=se>\(</span>10-10<span class=se>\)</span> apachectl start <span class=o>&amp;&amp;</span> <span class=se>\</span>
setpmac biba/10<span class=se>\(</span>10-10<span class=se>\)</span> /usr/local/etc/rc.d/nagios.sh forcestart</code></pre></div></div><div class=paragraph><p>Kétszer is ellenõrizzük, hogy minden a megfelelõ módon viselkedik-e. Ha valamilyen furcsaságot tapasztalunk, akkor nézzük át a naplókat vagy a hibaüzeneteket. A <a href="https://man.freebsd.org/cgi/man.cgi?query=sysctl&amp;sektion=8&amp;format=html">sysctl(8)</a> használatával tiltsuk le a <a href="https://man.freebsd.org/cgi/man.cgi?query=mac_biba&amp;sektion=4&amp;format=html">mac_biba(4)</a> biztonsági modult és próbáljunk meg mindent a szokott módon újraindítani.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>A <code>root</code> felhasználó különösebb aggodalom nélkül képes megváltoztatni a biztonsági rend betartatását és átírni a konfigurációs állományokat. Egy frissen indított parancsértelmezõ számára ezzel a paranccsal tudjuk csökkenteni a biztonsági besorolást:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># setpmac biba/10 csh</span></code></pre></div></div><div class=paragraph><p>Ennek kivédésére a felhasználókat a <a href="https://man.freebsd.org/cgi/man.cgi?query=login.conf&amp;sektion=5&amp;format=html">login.conf(5)</a> beállításaival le kell korlátozni. Ha a <a href="https://man.freebsd.org/cgi/man.cgi?query=setpmac&amp;sektion=8&amp;format=html">setpmac(8)</a> megpróbál a rekesz határain túl futtatni egy parancsot, akkor hibát ad vissza és a parancs nem fut le. Ebben az esetben a <code>root</code> felhasználót tegyük a <code>biba/high(high-high)</code> értékek közé.</p></div></td></tr></tbody></table></div></div></div><div class=sect2><h3 id=mac-userlocked>16.16. A felhasználók korlátozása<a class=anchor href=#mac-userlocked></a></h3><div class=paragraph><p>Ebben a példában egy viszonylag kicsi, nagyjából mindössze ötven felhasználós, adattárolásra használatos rendszert veszünk alapul. A felhasználók rendelkezhetnek bizonyos bejelentkezési tulajdonságokkal, és nem csak adatokat tudnak tárolni, hanem az erõforrásokhoz is hozzá tudnak férni.</p></div><div class=paragraph><p>Itt most a <a href="https://man.freebsd.org/cgi/man.cgi?query=mac_bsdextended&amp;sektion=4&amp;format=html">mac_bsdextended(4)</a> és a <a href="https://man.freebsd.org/cgi/man.cgi?query=mac_seeotheruids&amp;sektion=4&amp;format=html">mac_seeotheruids(4)</a> modulokat vetjük be együttesen, és nem csak a rendszer objektumainak elérését tudjuk megakadályozni, hanem az egyes felhasználók futó programjait is elrejtjük.</p></div><div class=paragraph><p>A mûveletet kezdjük azzal, hogy a <span class=filename>/boot/loader.conf</span> állományt kibõvítjük a következõ módon:</p></div><div class="literalblock programlisting"><div class=content><pre>mac_seeotheruids_load=&#34;YES&#34;</pre></div></div><div class=paragraph><p>A <a href="https://man.freebsd.org/cgi/man.cgi?query=mac_bsdextended&amp;sektion=4&amp;format=html">mac_bsdextended(4)</a> biztonsági modul az alábbi <span class=filename>rc.conf</span>-változóval hozható mûködésbe:</p></div><div class="literalblock programlisting"><div class=content><pre>ugidfw_enable=&#34;YES&#34;</pre></div></div><div class=paragraph><p>A hozzá tartozó alapértelmezett szabálykészlet az <span class=filename>/etc/rc.bsdextended</span> állományban tárolódik, amely pedig a rendszer indítása során töltõdik be. Ezeket némileg módosítanunk kell majd. Mivel a példában szereplõ számítógép csak a felhasználók kiszolgálását hivatott ellátni, az utolsó kettõ kivételével mindent hagyhatunk megjegyzésben. Így kikényszerítjük felhasználók által birtokolt rendszerobjektumok alapértelmezés szerinti betöltését.</p></div><div class=paragraph><p>Vegyük fel a szükséges felhasználókat a számítógépre és indítsuk újra. Tesztelési célból próbáljunk meg különbözõ felhasználókként bejelentkezni két konzolon. Futassuk le a <code>ps aux</code> parancsot, és így meg tudjuk figyelni, hogy mennyire látjuk a többi felhasználót. Amikor megpróbáljuk kiadni a <a href="https://man.freebsd.org/cgi/man.cgi?query=ls&amp;sektion=1&amp;format=html">ls(1)</a> parancsot a többiek felhasználói könyvtáraira, akkor hibát kell kapnunk.</p></div><div class=paragraph><p>Ne próbálgassunk a <code>root</code> felhasználóval, hacsak a megfelelõ <code>sysctl</code> változókban be nem állítottuk az õ hozzáférésének blokkolását is.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Amikor felveszük egy felhasználót a rendszerbe, a hozzá tartozó <a href="https://man.freebsd.org/cgi/man.cgi?query=mac_bsdextended&amp;sektion=4&amp;format=html">mac_bsdextended(4)</a> szabály nem fog szerepelni a szabályrendszerben. A szabályrendszer gyors frissítését úgy tudjuk megoldani, ha a <a href="https://man.freebsd.org/cgi/man.cgi?query=kldunload&amp;sektion=8&amp;format=html">kldunload(8)</a> használatával egyszerûen eltávolítjuk a biztonsági modult a memóriából és újratöltjük a <a href="https://man.freebsd.org/cgi/man.cgi?query=kldload&amp;sektion=8&amp;format=html">kldload(8)</a> paranccsal.</p></div></td></tr></tbody></table></div></div><div class=sect2><h3 id=mac-troubleshoot>16.17. A hibák elhárítása a MAC rendszerben<a class=anchor href=#mac-troubleshoot></a></h3><div class=paragraph><p>A fejlesztés fázisában bizonyos normál konfigurációval rendelkezõ felhasználók gondokat jeleztek. Ezeket foglaljuk most itt össze:</p></div><div class=sect3><h4 id=_a_multilabel_beállítás_nem_adható_meg_a_állományrendszerre>16.17.1. A <code>multilabel</code> beállítás nem adható meg a <span class=filename>/</span> állományrendszerre<a class=anchor href=#_a_multilabel_beállítás_nem_adható_meg_a_állományrendszerre></a></h4><div class=paragraph><p>A <code>multilabel</code> beállítás nem marad meg a rendszerindító (<span class=filename>/</span>) partíciómon!</p></div><div class=paragraph><p>A tapasztalatok szerint körülbelül minden ötvenedik felhasználó szembesül ezzel a problémával, és mi is találkozunk vele a kezdeti konfigurációk kialakítása során. Ennek az úgynevezett "hibának" a behatóbb tanulmányozása során arra jutottunk, hogy ez többnyire vagy a hibás dokumentálásból vagy a dokumentáció félreértelmezésébõl ered. Független attól, hogy ez mitõl is következett be, a következõ lépések megtételével orvosolhatjuk:</p></div><div class="exampleblock procedure"><div class=content><div class="olist arabic"><ol class=arabic><li><p>Nyissuk meg az <span class=filename>/etc/fstab</span> állományt és adjuk meg a rendszerindító partíciónak az <code>ro</code>, vagyis az írásvédett (read-only) beállítást.</p></li><li><p>Indítsuk újra a gépet egyfelhasználós módban.</p></li><li><p>A <code>tunefs -l enable</code> parancsot futtassuk le a <span class=filename>/</span> állományrendszeren.</p></li><li><p>Indítsuk újra a rendszert normál módban.</p></li><li><p>Adjuk ki a <code>mount -urw</code><span class=filename>/</span> parancsot, majd az <span class=filename>/etc/fstab</span> állományban írjuk át a <code>ro</code> beállítást az <code>rw</code> értékre és megint indítsuk újra a rendszert.</p></li><li><p>Alaposan nézzük át a <code>mount</code> parancs kimenetét és gyõzödjünk meg róla, hogy a <code>multilabel</code> opció valóban beállítódott a rendszerindító állományrendszerre.</p></li></ol></div></div></div></div><div class=sect3><h4 id=_a_mac_után_nem_lehet_indítani_az_x11_szervert>16.17.2. A MAC után nem lehet indítani az X11 szervert<a class=anchor href=#_a_mac_után_nem_lehet_indítani_az_x11_szervert></a></h4><div class=paragraph><p>Nem indul az X, miután MAC-kel kialakítottunk egy biztonságos környezetet!</p></div><div class=paragraph><p>Ezt vagy a MAC <code>partition</code> házirendje okozza, vagy az egyik címkékeket használó házirend helytelen beállítása. A következõ módon deríthetjük ki az okát:</p></div><div class="exampleblock procedure"><div class=content><div class="olist arabic"><ol class=arabic><li><p>Figyelmesen olvassuk el a hibaüzenetet: ha a felhasználó az <code>insecure</code> osztály tagja, akkor a <code>partition</code> házirend lesz a bûnös. Próbáljuk meg a felhasználót visszatenni a <code>default</code> osztályba és a <code>cap_mkdb</code> paranccsal újragenerálni az adatbázist. Ha ez nem segít a problémán, akkor haladjunk tovább.</p></li><li><p>Alaposan ellenõrizzük a címkékhez tartozó házirendeket. Vizsgáljuk meg, hogy a kérdeses felhasználó esetében a házirendet és az X11 alkalmazást, valamint a <span class=filename>/dev</span> eszközöket tényleg jól állítottuk be.</p></li><li><p>Ha az iméntiek egyik sem oldja meg gondunkat, küldjük el a hibaüzenetet és a környezetünk rövid leírását a a <a href=http://www.TrustedBSD.org>TrustedBSD</a> honlapjáról elérhetõ TrustedBSD levelezési lista vagy a <a href=https://lists.FreeBSD.org/subscription/freebsd-questions>FreeBSD general questions levelezési lista</a> címére.</p></li></ol></div></div></div></div><div class=sect3><h4 id=_hiba_secure_path3_cannot_stat_login_conf>16.17.3. Hiba: <a href="https://man.freebsd.org/cgi/man.cgi?query=_secure_path&amp;sektion=3&amp;format=html">_secure_path(3)</a> cannot stat <span class=filename>.login_conf</span><a class=anchor href=#_hiba_secure_path3_cannot_stat_login_conf></a></h4><div class=paragraph><p>Amikor a rendszerben megpróbálok a <code>root</code> felhasználóról átváltani egy másik felhasználóra, a <code>_secure_path: unable to state .login_conf</code> hibaüzenet jelenik meg.</p></div><div class=paragraph><p>Ez az üzenet általában akkor látható, amikor a felhasználó nagyobb értékû címkével rendelkezik annál, mint akivé válni akar. Például vegyük a <code>joska</code> nevû felhasználót a rendszerben, aki az alap <code>biba/low</code> címkével rendelkezik. A <code>root</code> felhasználó, akinek <code>biba/high</code> címkéje van, nem láthatja <code>joska</code> felhasználói könyvtárát. Ez attól függetlenül megtörténik, hogy a <code>root</code> a <code>su</code> paranccsal váltott át a <code>joska</code> nevû felhasználóra vagy sem. Egy ilyen helyzetben a Biba sértetlenségi modellje nem fogja engedni a <code>root</code> felhasználóra számára, hogy láthassa a kevésbé sértetlen objektumokat.</p></div></div><div class=sect3><h4 id=_a_root_felhasználó_nem_megy>16.17.4. A <code>root</code> felhasználó nem megy!<a class=anchor href=#_a_root_felhasználó_nem_megy></a></h4><div class=paragraph><p>A rendszer normál vagy egyfelhasználós módban sem ismeri fel a <code>root</code> felhasználót. A <code>whoami</code> parancs 0 (nullát) ad vissza és a <code>su</code> parancs pedig annyit mond: <code>who are you?</code> (<code>ki vagy?</code>). Mi történhetett?</p></div><div class=paragraph><p>Ez csak olyankor történhet, ha a címkézési házirendet nem engedélyezzük, vagy a <a href="https://man.freebsd.org/cgi/man.cgi?query=sysctl&amp;sektion=8&amp;format=html">sysctl(8)</a> használatával, vagy pedig a modul eltávolításával. Ha a házirendet letiltjuk vagy ideiglenesen letiltódik, akkor a bejelentkezési tulajdonságokat tároló adatbázist a <code>label</code> beállítás eltávolításával kell újrakonfigurálni. A <span class=filename>login.conf</span> állományból ne felejtsük el kivenni az összes <code>label</code> beállítást és a <code>cap_mkdb</code> paranccsal újragenerálni az adatbázist.</p></div><div class=paragraph><p>Ilyen akkor is elõfordulhat, amikor a házirend valamilyen módon korlátozza a <span class=filename>master.passwd</span> állomány vagy adatbázis elérhetõségét. Ezt általában az okozza, hogy a rendszergazda az állományt olyan címke alatt módosítja, amely ütközik a rendszerben alkalmazott általános házirenddel. Ebben az esetekben a rendszer próbálja meg beolvasni a felhasználók adatait, azonban mivel közben az állomány új címkét örökölt, nem fér hozzá. Ha a <a href="https://man.freebsd.org/cgi/man.cgi?query=sysctl&amp;sektion=8&amp;format=html">sysctl(8)</a> paranccsal letiltjuk a házirendet, minden vissza fog térni a rendes kerékvágásba.</p></div></div></div></div></div><div class=sect1><h2 id=audit>Chapter 17. Biztonsági események vizsgálata<a class=anchor href=#audit></a></h2><div class=sectionbody><div class=sect2><h3 id=audit-synopsis>17.1. Áttekintés<a class=anchor href=#audit-synopsis></a></h3><div class=paragraph><p>A FreeBSD támogatja a biztonsági események aprólékos vizsgálatát. Ezzel egy megbízható, részletes és jól konfigurálható naplózási rendszert nyújtanak a rendszerben található biztonságot igénylõ események széles köréhez, beleértve a bejelentkezéseket, a konfigurációs állományokban bekövetkezõ változásokat, állomány- és hálózati hozzáféréseket. Az így létrehozott naplóbejegyzések felbecsülhetetlen értékûnek bizonyulhatnak egy élõ rendszer felügyelete során, vagy egy hálózati támadás észleléséhez, esetleg egy összeomlás okainak kielemezéséhez. A FreeBSD ehhez a Sun™ által kifejlesztett BSM technológia API-ját és állományformátumát valósítja meg, és így képes együttmûködni a Sun™ Solaris™ valamint az Apple® Mac OS® X bizonsági rendszereivel egyaránt.</p></div><div class=paragraph><p>Ebben a fejezetben a biztonsági események vizsgálatának telepítéséhez és beállításához szükséges ismeretek tekintjük át. Ennek keretében szó esik a vizsgálati házirendekrõl, valamint mutatunk egy példát a vizsgálatok beállítására.</p></div><div class=paragraph><p>A fejezet elolvasása során megismerjük:</p></div><div class=ulist><ul><li><p>mit jelent az események vizsgálata és hogyan mûködik;</p></li><li><p>hogyan kell beállítani az események vizsgálatát FreeBSD-n a különbözõ felhasználók és programok esetén;</p></li><li><p>hogyan értelmezzük a vizsgálati nyomokat a vizsgálatot szûkítõ és -elemzõ segédprogramok segítségével.</p></li></ul></div><div class=paragraph><p>A fejezet elolvasásához ajánlott:</p></div><div class=ulist><ul><li><p>alapvetõ UNIX®-os és FreeBSD-s ismeretek (<a href=./#basics>A UNIX alapjai</a>);</p></li><li><p>a rendszermag konfigurálásával és fordításával kapcsolatos tudnivalók alapszintû ismerete (<a href=./#kernelconfig>A FreeBSD rendszermag testreszabása</a>);</p></li><li><p>az informatikai biztonság alapfogalmainak és annak a FreeBSD-re vonatkozó részleteinek minimális ismerete (<a href=./#security>Biztonság</a>).</p></li></ul></div><div class="admonitionblock warning"><table><tbody><tr><td class=icon><i class="fa icon-warning" title=Warning></i></td><td class=content><div class=paragraph><p>Az események vizsgálatával kapcsolatos ismert korlátozások: nem mindegyik biztonságot érintõ esemény vizsgálható, mint például az egyes bejelentkezési típusok, mivel azok nem megfelelõen hitelesítik a belépõ felhasználókat. Ilyenek például az X11-alapú felületek és az egyéb, erre a célra alkalmas, más által fejlesztett démonok.</p></div><div class=paragraph><p>A biztonsági események vizsgálata során a rendszer képes nagyon részletes naplókat készíteni az érintett tevékenységekrõl. Így egy kellõen forgalmas rendszeren az állománymozgások alapos nyomonkövetése bizonyos konfigurációkon akár gigabyte-okat is kitehet hetente. A rendszergazdáknak ezért mindig javasolt számolniuk a nagy forgalmú események biztonsági vizsgálatának tárigényével. Például, emiatt érdemes lehet egy egész állományrendszert szánni erre a feladatra a <span class=filename>/var/audit</span> könyvtárban, és így a többi állományrendszer nem látja kárát, ha véletlenül betelne ez a terület.</p></div></td></tr></tbody></table></div></div><div class=sect2><h3 id=audit-inline-glossary>17.2. A fejezet fontosabb fogalmai<a class=anchor href=#audit-inline-glossary></a></h3><div class=paragraph><p>A fejezet elolvasása elõtt meg kell ismernünk néhány fontos alapfogalmat:</p></div><div class=ulist><ul><li><p><em>esemény:</em> Vizsgálható eseménynek azt az eseményt nevezzük, amely egy vizsgálati alrendszerben naplózható. Biztonsági események lehetnek például: egy állomány létrehozása, egy hálózati kapcsolat felépítése, vagy egy felhasználó bejelentkezése. Egy esemény "jellegzetes", ha visszakövethetõ valamelyik hitelesített felhasználóhoz, vagy "nem jellegzetes", ha ez nem lehetséges. Nem jellegzetes esemény lehet minden olyan esemény, amely egy bejelentkezési folyamat hitelesítési lépése elõtt történik, például egy belépési kísérlet hibás jelszóval.</p></li><li><p><em>osztály:</em> Eseményosztálynak az összefüggõ események névvel ellátott halmazát tekintjük, és szûrési feltételekben használjuk ezeket. Általában alkalmazott osztályok: "file creation" (fc, állománylétrehozás), "exec" (ex, programindítás), és "login_logout" (lo, ki- és bejelentkezés).</p></li><li><p><em>rekord:</em> Rekordnak nevezzük a biztonsági eseményeket leíró biztonsági naplóbejegyzéseket. A rekordok tartalmazhatják a feljegyzett esemény típusát, az eseményt kiváltó tevékenységet (felhasználót), a dátumot és az idõt, tetszõleges objektum vagy paraméter értékét, feltételek teljesülését vagy meghiúsulását.</p></li><li><p><em>nyom:</em> Vizsgálati nyomnak vagy naplóállománynak nevezzük a különféle biztonsági eseményeket leíró vizsgálati rekordok sorozatát. A nyomok többnyire nagyjából az események bekövetkezése szerinti idõrendben következnek. Csak és kizárólag az erre felhatalmazott programok hozhatnak létre rekordokat a vizsgálati nyomban.</p></li><li><p><em>szûrési feltétel:</em> Szûrési feltételnek nevezünk egy olyan karakterláncot, amelyet események szûrésére használunk, és módosítókat valamint eseményosztályok neveit tartalmazza.</p></li><li><p><em>elõválogatás:</em> Elõválogatásnak nevezzük a folyamatot, amelynek során a rendszer beazonosítja azokat az eseményeket, amelyek a rendszergazda számára fontosak. Ezáltal elkerülhetjük olyan vizsgálati rekordok generálását, amelyek számunkra érdektelen eseményekrõl számolnak be. Az elõválogatás szûrési feltételek sorát használja az adott felhasználókhoz tartozó adott biztonsági események vizsgálatának beállításához, akárcsak a hitelesített és a nem hitelesített programokat értintõ globális beállítások meghatározásához.</p></li><li><p><em>leszûkítés:</em> Leszûkítésnek nevezzük a folyamatot, amelynek során a már meglevõ biztonsági rekordokból válogatunk le tárolásra, nyomtatásra vagy elemzésre. Hasonlóan ez a folyamat, ahol a szükségtelen rekordokat eltávolítjuk a vizsgálatai nyomból. A leszûkítés segítségével a rendszergazdák a vizsgálati adatok eltárolására alakíthatnak ki házirendet. Például a részletesebb vizsgálati nyomokat érdemes egy hónapig megtartani, ennek lejártával viszont már inkább ajánlott leszûkíteni ezeket és archiválásra csak a bejelentkezési információkat megtartani.</p></li></ul></div></div><div class=sect2><h3 id=audit-install>17.3. A vizsgálat támogatásának telepítése<a class=anchor href=#audit-install></a></h3><div class=paragraph><p>A eseményvizsgálathoz szükséges felhasználói programok a FreeBSD alaprendszer részét képezik. Az eseményvizsgálat támogatása alapértelmezés szerint megtalálható a rendszermagban, azonban egy saját rendszermag esetén már külön be kell kapcsolnunk a megfelelõ támogatást, mégpedig a rendszermag konfigurációs állományában az alábbi sor hozzáadásával:</p></div><div class="literalblock programlisting"><div class=content><pre>options	AUDIT</pre></div></div><div class=paragraph><p>Fordítsuk és telepítsük újra a rendszermagot az <a href=./#kernelconfig>A FreeBSD rendszermag testreszabása</a>ben ismertetett folyamat szerint.</p></div><div class=paragraph><p>Ahogy a rendszermagot a bekapcsolt eseményvizsgálati támogatással sikerült lefordítanunk és telepítenünk, valamint a rendszerünk is újraindult, indítsuk el a vizsgáló démont a következõ sor hozzáadásával az <a href="https://man.freebsd.org/cgi/man.cgi?query=rc.conf&amp;sektion=5&amp;format=html">rc.conf(5)</a> állományban:</p></div><div class="literalblock programlisting"><div class=content><pre>auditd_enable=&#34;YES&#34;</pre></div></div><div class=paragraph><p>A vizsgálatot innentõl ténylegesen egy ismételt újraindítással vagy pedig az elõbb említett démon manuális elindításával aktiválhatjuk:</p></div><div class="literalblock programlisting"><div class=content><pre>/etc/rc.d/auditd start</pre></div></div></div><div class=sect2><h3 id=audit-config>17.4. A vizsgálat beállítása<a class=anchor href=#audit-config></a></h3><div class=paragraph><p>A vizsgálatok beállításához szükséges összes konfigurációs állomány a <span class=filename>/etc/security</span> könyvtárban található. A következõ állományok vannak itt a démon indítása elõtt:</p></div><div class=ulist><ul><li><p><span class=filename>audit_class</span> - a vizsgálati osztályok definícióit tartalmazza.</p></li><li><p><span class=filename>audit_control</span> - a vizsgálati alrendszer különbözõ területeit vezérli, többek közt az alapértelmezett vizsgálati osztályokat, az vizsgálati adatok tárhelyén fenntartandó minimális lemezterületet, a vizsgálati nyom maximális méretét, stb.</p></li><li><p><span class=filename>audit_event</span> - a rendszerben jelenlevõ vizsgálati események szöveges megnevezése és leírása, valamint a lista, hogy melyikük mely osztályban található.</p></li><li><p><span class=filename>audit_user</span> - felhasználónként változó vizsgálati elvárások, kombinálva a bejelentkezéskor érvényes globálisan alapértelmezett beállításokkal.</p></li><li><p><span class=filename>audit_warn</span> - az auditd által használt testreszabható shell szkript, aminek segítségével a szélsõséges helyzetekben figyelmeztetõ üzeneteket tudunk generálni, mint például amikor a rekordok számára fenntartott hely hamarosan elfogy, vagy amikor a nyomokat tartalmazó állományt archiváltuk.</p></li></ul></div><div class="admonitionblock warning"><table><tbody><tr><td class=icon><i class="fa icon-warning" title=Warning></i></td><td class=content><div class=paragraph><p>Az eseményvizsgálat konfigurációs állományait alapos körültekintés mellett szabad szerkeszteni és karbantartani, mivel a bennük keletkezõ hibák az események helytelen naplózását eredményezhetik.</p></div></td></tr></tbody></table></div><div class=sect3><h4 id=_eseményszûrési_feltételek>17.4.1. Eseményszûrési feltételek<a class=anchor href=#_eseményszûrési_feltételek></a></h4><div class=paragraph><p>Az eseményvizsgálati beállítások során számtalan helyen felbukkanak a vizsgálni kívánt eseményeket meghatározó szûrési feltételek. Ezen feltételek eseményosztályok felsorolását tartalmazzák, mindegyiküket egy módosító vezeti be, ezzel jelezve, hogy az adott eseményosztályba tartozó rekordokat tartsuk meg vagy vessük el. Esetleg utalhatnak arra is, hogy vagy csak a sikerességet jelzõ rekordokat, vagy csak a sikertelenséget jelzõ rekordokat szûrjük ki. A szûrési feltételek balról jobbra értékelõdnek ki, és két kifejezés összefûzéssel kombinálható.</p></div><div class=paragraph><p>A most következõ lista tartalmazza a <span class=filename>audit_class</span> állományban található alapértelmezett eseményvizsgálati osztályokat:</p></div><div class=ulist><ul><li><p><code>all</code> - <em>all (mind)</em> - Minden eseményosztályra vonatkozik.</p></li><li><p><code>ad</code> - <em>administrive (adminisztrációs)</em> - olyan adminisztrációs tevékenységek, amelyek egyben az egész rendszeren végrehajtódnak.</p></li><li><p><code>ap</code> - <em>application (alkalmazás)</em> - az alkalmazások által meghatározott tevékenység.</p></li><li><p><code>cl</code> - <em>file close (állomány lezárása)</em> - a <code>close</code> rendszerhívás meghívásának vizsgálata.</p></li><li><p><code>ex</code> - <em>exec (programindítás)</em> - egy program indításának vizsgálata. A parancssorban átadott paraméterek és a környezeti változók vizsgálatát az <a href="https://man.freebsd.org/cgi/man.cgi?query=audit_control&amp;sektion=5&amp;format=html">audit_control(5)</a> vezérli a <code>policy</code> beállításhoz tartozó <code>argv</code> és <code>envv</code> paraméterek segítségével.</p></li><li><p><code>fa</code> - <em>file attribute access (állományjellemzõk hozzáférése)</em> - a rendszerbeli objektumok jellemzõinek hozzáférésnek vizsgálata, mint például a <a href="https://man.freebsd.org/cgi/man.cgi?query=stat&amp;sektion=1&amp;format=html">stat(1)</a>, <a href="https://man.freebsd.org/cgi/man.cgi?query=pathconf&amp;sektion=2&amp;format=html">pathconf(2)</a> és ehhez hasonló események.</p></li><li><p><code>fc</code> - <em>file create (állomány létrehozása)</em> - állományt eredményezõ események vizsgálata.</p></li><li><p><code>fd</code> - <em>file delete (állomány törlése)</em> - állományt törlõ események vizsgálata.</p></li><li><p><code>fm</code> - <em>file attribute modify (állományjellemzõk módosítása)</em> - állományok jellemzõit megváltoztató események vizsgálata, mint például a <a href="https://man.freebsd.org/cgi/man.cgi?query=chown&amp;sektion=8&amp;format=html">chown(8)</a>, <a href="https://man.freebsd.org/cgi/man.cgi?query=chflags&amp;sektion=1&amp;format=html">chflags(1)</a>, <a href="https://man.freebsd.org/cgi/man.cgi?query=flock&amp;sektion=2&amp;format=html">flock(2)</a>, stb.</p></li><li><p><code>fr</code> - <em>file read (állományolvasás)</em> - állományok megnyitásával olvasásra, olvasásával, stb. kapcsolatos események vizsgálata.</p></li><li><p><code>fw</code> - <em>file write (állományírás)</em> - állományok megnyitásával írásra, írásával, módosításával, stb. kapcsolatos események vizsgálata.</p></li><li><p><code>io</code> - <em>ioctl</em> - az <a href="https://man.freebsd.org/cgi/man.cgi?query=ioctl&amp;sektion=2&amp;format=html">ioctl(2)</a> rendszerhívást használó események vizsgálata.</p></li><li><p><code>ip</code> - <em>ipc</em> - a folyamatok közti kommunikáció különféle formáinak, beleértve a POSIX csövek és System V IPC mûveleteinek vizsgálata.</p></li><li><p><code>lo</code> - <em>login_logout (ki- és bejelentkezés)</em> - a rendszerben megjelenõ <a href="https://man.freebsd.org/cgi/man.cgi?query=login&amp;sektion=1&amp;format=html">login(1)</a> és <a href="https://man.freebsd.org/cgi/man.cgi?query=logout&amp;sektion=1&amp;format=html">logout(1)</a> események vizsgálata.</p></li><li><p><code>na</code> - <em>non attributable (nem jellegzetes)</em> - a nem jellegzetes események vizsgálata.</p></li><li><p><code>no</code> - <em>invalid class (érvénytelen osztály)</em> - egyetlen biztonsági eseményt sem tartalmaz.</p></li><li><p><code>nt</code> - <em>network (hálózat)</em> - a hálózathoz tartozó események vizsgálata, mint például a <a href="https://man.freebsd.org/cgi/man.cgi?query=connect&amp;sektion=2&amp;format=html">connect(2)</a> és az <a href="https://man.freebsd.org/cgi/man.cgi?query=accept&amp;sektion=2&amp;format=html">accept(2)</a>.</p></li><li><p><code>ot</code> - <em>other (egyéb)</em> - más egyéb események vizsgálata.</p></li><li><p><code>pc</code> - <em>process (folyamat)</em> - a folyamatokkal kapcsolatos mûveletek, mint például az <a href="https://man.freebsd.org/cgi/man.cgi?query=exec&amp;sektion=3&amp;format=html">exec(3)</a> és az <a href="https://man.freebsd.org/cgi/man.cgi?query=exit&amp;sektion=3&amp;format=html">exit(3)</a> vizsgálata.</p></li></ul></div><div class=paragraph><p>Az imént felsorolt eseményosztályok az <span class=filename>audit_class</span> és az <span class=filename>audit_event</span> állományok módosításával igény szerint testreszabhatóak.</p></div><div class=paragraph><p>A listában szereplõ minden egyes eseményosztályhoz tartozik még egy módosító is, amely jelzi, hogy a sikeres vagy a sikertelen mûveleteket kell-e szûrnünk, valamint hogy a bejegyzés az adott típust vagy osztályt hozzáadja vagy elveszi az adott szûrésbõl.</p></div><div class=ulist><ul><li><p>(üres) az adott típusból mind a sikereseket és mind a sikerteleneket feljegyzi.</p></li><li><p><code>+</code> az eseményosztályba tartozó sikeres eseményeket vizsgálja csak.</p></li><li><p><code>-</code> az eseményosztályba tartozó sikertelen eseményeket vizsgálja csak.</p></li><li><p><code>^</code> az eseményosztályból sem a sikereseket, sem pedig a sikerteleneket nem vizsgálja.</p></li><li><p><code>^+</code> az eseményosztályból nem vizsgálja a sikeres eseményeket.</p></li><li><p><code>^-</code> az eseményosztályból nem vizsgálja a sikertelen eseményeket.</p></li></ul></div><div class=paragraph><p>Az alábbi példa egy olyan szûrési feltételt mutat be, amely a ki- és bejelentkezések közül megadja a sikereset és a sikerteleneket, viszont a programindítások közül csak a sikereseket:</p></div><div class="literalblock programlisting"><div class=content><pre>lo,+ex</pre></div></div></div><div class=sect3><h4 id=_a_konfigurációs_állományok>17.4.2. A konfigurációs állományok<a class=anchor href=#_a_konfigurációs_állományok></a></h4><div class=paragraph><p>A vizsgálati rendszer beállításához az esetek túlnyomó részében a rendszergazdáknak csupán két állományt kell módosítaniuk: ezek az <span class=filename>audit_control</span> és az <span class=filename>audit_user</span>. Az elõbbi felelõs a rendszerszintû vizsgálati jellemzõkért és házirendekért, míg az utóbbi az igények felhasználókénti finomhangolásához használható.</p></div><div class=sect4><h5 id=audit-auditcontrol>17.4.2.1. Az <span class=filename>audit_control</span> állomány<a class=anchor href=#audit-auditcontrol></a></h5><div class=paragraph><p>Az <span class=filename>audit_control</span> állomány határozza meg a vizsgálati alrendszer alapértelmezéseit. Ezt az állományt megnyitva a következõket láthatjuk:</p></div><div class="literalblock programlisting"><div class=content><pre>dir:/var/audit
flags:lo
minfree:20
naflags:lo
policy:cnt
filesz:0</pre></div></div><div class=paragraph><p>A <code>dir</code> opciót használjuk a vizsgálati naplók tárolására szolgáló egy vagy több könyvtár megadására. Ha egynél több könyvtárra vonatkozó bejegyzés található az állományban, akkor azok a megadás sorrendjében kerülnek feltöltésre. Nagyon gyakori az a beállítás, ahol a vizsgálati naplókat egy erre a célra külön kialakított állományrendszeren tárolják, megelõzve ezzel az állományrendszer betelésekor keletkezõ problémákat a többi alrendszerben.</p></div><div class=paragraph><p>A <code>flags</code> mezõ egy rendszerszintû alapértelmezett elõválogatási maszkot határoz meg a jellegzetes események számára. A fenti példában a sikeres és sikertelen ki- és bejelentkezéseket mindegyik felhasználó esetén vizsgáljuk.</p></div><div class=paragraph><p>A <code>minfree</code> opció megszabja a vizsgálati nyom tárolására szánt állományrendszeren a minimális szabad helyet, a teljes kapacitás százalékában. Amint ezt a küszöböt túllépjük, egy figyelmeztetés fog generálódni. A fenti példa a minimálisan szükséges rendelkezésre álló helyet húsz százalékra állítja.</p></div><div class=paragraph><p>A <code>naflags</code> opció megadja azokat az eseményosztályokat, amelyeket vizsgálni kell a nem jellegzetes események, mind például a bejelentkezési folyamatok vagy rendszerdémonok esetén.</p></div><div class=paragraph><p>A <code>policy</code> opció a vizsgálat különbözõ szempontjait irányító házirendbeli beállítások vesszõvel elválasztott listáját tartalmazza. Az alapértelmezett <code>cnt</code> beállítás azt adja meg, hogy a rendszer a felmerülõ vizsgálati hibák ellenére is folytassa tovább a mûködését (erõsen javasolt a használata). A másik gyakorta alkalmazott beállítás az <code>argv</code>, amellyel a rendszer a parancsvégrehajtás részeként az <a href="https://man.freebsd.org/cgi/man.cgi?query=execve&amp;sektion=2&amp;format=html">execve(2)</a> rendszerhívás parancssori paramétereit is megvizsgálja.</p></div><div class=paragraph><p>A <code>filesz</code> opció határozza meg a vizsgálati nyom automatikus szétvágása és archiválása elõtti maximális méretét, byte-ban. Az alapértelmezett értéke a 0, amely kikapcsolja ezt az archiválást. Ha az itt megadott állományméret nem nulla és a minimálisan elvárt 512 KB alatt van, akkor a rendszer figyelmen kívül hagyja és errõl egy figyelmeztetést ad.</p></div></div><div class=sect4><h5 id=audit-audituser>17.4.2.2. Az <span class=filename>audit_user</span> állomány<a class=anchor href=#audit-audituser></a></h5><div class=paragraph><p>Az <span class=filename>audit_user</span> állomány lehetõvé teszi a rendszergazda számára, hogy az egyes felhasználók számára további vizsgálati szigorításokat határozzon meg. Minden sor egy-egy felhasználó vizsgálatának pontosítását adja meg két mezõ segítségével: az elsõ közülük az <code>alwaysaudit</code> mezõ, mely felsorolja azokat az eseményeket, amelyeket minden esetben vizsgáni kell az adott felhasználó esetén, valamint a második a <code>neveraudit</code> mezõ, mely az adott felhasználó esetén a nem vizsgálandó eseményeket adja meg.</p></div><div class=paragraph><p>A most következõ <span class=filename>audit_user</span> példában vizsgáljuk a <code>root</code> felhasználó ki- és bejelentkezéseit és sikeres programindításait, valamint a <code>www</code> felhasználó állománylétrehozásait és sikeres programindításait. Ha a korábban bemutatott <span class=filename>audit_control</span> példával együtt használjuk, akkor észrevehetjük, hogy a <code>lo</code> bejegyzés a <code>root</code> felhasználó esetén redundáns, illetve ilyenkor a ki/bejelentkezést a <code>www</code> felhasználó esetén is vizsgáljuk.</p></div><div class="literalblock programlisting"><div class=content><pre>root:lo,+ex:no
www:fc,+ex:no</pre></div></div></div></div></div><div class=sect2><h3 id=audit-administration>17.5. A vizsgálati alrendszer használata<a class=anchor href=#audit-administration></a></h3><div class=sect3><h4 id=_a_vizsgálati_nyomok_megtekintése>17.5.1. A vizsgálati nyomok megtekintése<a class=anchor href=#_a_vizsgálati_nyomok_megtekintése></a></h4><div class=paragraph><p>A vizsgálati nyomok a BSM bináris formátumban tárolódnak, ezért a tartalmának konvertálásához és módosításához külön segédprogramokra van szükség. A <a href="https://man.freebsd.org/cgi/man.cgi?query=praudit&amp;sektion=1&amp;format=html">praudit(1)</a> parancs a nyomállományokat egyszerû szöveges formátumra alakítja, az <a href="https://man.freebsd.org/cgi/man.cgi?query=auditreduce&amp;sektion=1&amp;format=html">auditreduce(1)</a> parancs pedig a nyomok elemzéséhez, archiválásához vagy nyomtatásához szükséges leszûkítéséket végzi el. Az <code>auditreduce</code> a szûrési feltételek paramétereinek széles skáláját kezeli, beleértve az eseménytípusokat, -osztályokat, felhasználókat, események dátumát vagy idõpontját, állományok elérési útvonalát vagy az általuk érintett objektumokat.</p></div><div class=paragraph><p>Például a <code>praudit</code> segédprogram képes kilistázni szövegesen egy adott vizsgálati napló teljes tartalmát:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># praudit /var/audit/AUDITFILE</span></code></pre></div></div><div class=paragraph><p>ahol az <span class=filename>AUDITFILE</span> a kiírandó vizsgálati napló.</p></div><div class=paragraph><p>A vizsgálati nyomok tokenekbõl összeállított vizsgálati rekordok, amelyeket a <code>praudit</code> egymás után soronként megjelenít. Minden token adott típusú, például a <code>header</code> egy vizsgálati rekord fejlécét tartalmazza, vagy a <code>path</code>, amely a névfeloldásból származó elérési utat tartalmaz. A következõ példa egy <code>execve</code> eseményt mutat be:</p></div><div class="literalblock programlisting"><div class=content><pre>header,133,10,execve(2),0,Mon Sep 25 15:58:03 2006, + 384 msec
exec arg,finger,doug
path,/usr/bin/finger
attribute,555,root,wheel,90,24918,104944
subject,robert,root,wheel,root,wheel,38439,38032,42086,128.232.9.100
return,success,0
trailer,133</pre></div></div><div class=paragraph><p>Ez a vizsgálat egy sikeres <code>execve</code> hívást rögzít, ahol a <code>finger doug</code> parancs futott le. A paramétereket tartalmazó token magában foglalja a shell által a rendszermag felé jelzett parancsot és annak paraméterét egyaránt. A <code>path</code> token tárolja a végrehajtott állomány rendszermag által feloldott elérési útját. A <code>attribute</code> token errõl a binárisról ad további információkat, különösen az állomány módjáról, amely segít megállapítani, hogy az adott alkalmazásnál be volt-e állítva a setuid bit. A <code>subject</code> token leírja az érintett folyamatot és rendre megjegyzi a vizsgált felhasználó azonosítóját, az aktuálisan érvényben levõ felhasználó és csoport azonosítóját, a valós felhasználói és csoport azonosítót, a folyamat azonosítóját, a munkamenet azonosítóját, a port azonosítóját és a bejelentkezéshez használt hálózati címet. Vegyük észre, hogy a vizsgált felhasználó azonosítója és a valódi azonosítója eltér egymástól: a <code>robert</code> nevû felhasználó a <code>root</code> accountjára váltott a parancs futattása elõtt, de az eredetileg hitelesített felhasználójaként lett vizsgálva. Végezetül a <code>return</code> token jelzi a sikeres végrehajtást, és a <code>trailer</code> pedig zárja a rekordot.</p></div></div><div class=sect3><h4 id=_a_vizsgálati_nyomok_leszûkítése>17.5.2. A vizsgálati nyomok leszûkítése<a class=anchor href=#_a_vizsgálati_nyomok_leszûkítése></a></h4><div class=paragraph><p>Mivel a vizsgálatokhoz tartozó naplók akár egészen nagyok is lehetnek, ezért a rendszergazdának minden bizonnyal szüksége lehet a számára fontos, például egy adott felhasználóhoz tartozó rekordok kiválogatására:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># auditreduce -u trhodes /var/audit/AUDITFILE | praudit</span></code></pre></div></div><div class=paragraph><p>Ezzel ki tudjuk szûrni a <code>trhodes</code> nevû felhasználóhoz tartozó összes vizsgálati rekordot az <span class=filename>AUDITFILE</span> állományból.</p></div></div><div class=sect3><h4 id=_a_naplók_megtekintéséhez_szükséges_jogok_továbbadása>17.5.3. A naplók megtekintéséhez szükséges jogok továbbadása<a class=anchor href=#_a_naplók_megtekintéséhez_szükséges_jogok_továbbadása></a></h4><div class=paragraph><p>Az <code>audit</code> csoport tagjai olvashatják a <span class=filename>/var/audit</span> könyvtárban található vizsgálati nyomokat. Alapértelmezés szerint ez a csoport üres, ezért csak a <code>root</code> képes ekkor vizsgálni a nyomokat. A többi felhasználó számára úgy tudunk olvasási jogot biztosítani, ha felvesszük õket az <code>audit</code> csoportba. Mivel a vizsgálati naplók tartalmának figyelése jelentõs rálátást adhat a rendszerben jelenlevõ felhasználók és folyamatok viselkedésére, ajánlott körültekintõen kiosztani az olvasási jogokat.</p></div></div><div class=sect3><h4 id=_élõ_rendszerfelügyelet_a_vizsgálati_csövekkel>17.5.4. Élõ rendszerfelügyelet a vizsgálati csövekkel<a class=anchor href=#_élõ_rendszerfelügyelet_a_vizsgálati_csövekkel></a></h4><div class=paragraph><p>A vizsgálati csövek az eszközök állományabsztrakcióit klónozzák le, és ezzel teszik lehetõvé az alkalmazások számára, hogy menet közben megcsapolhassák a megfigyelt eszközök adatait. Ez az elsõdleges célja a különbözõ betörésfigyelõ és rendszerfelügyeleti eszközök készítõinek. A rendszergazda számára azonban a vizsgálati csövek megkönnyítik az élõ megfigyelést, mert itt nem merülnek fel a nyomok jogosultságaiból vagy az archiválás miatt megszakadó eseményfolyamokból adódó problémák. Az élõ eseményfolyamra az alábbi parancs kiadásával lehet rácsatlakozni:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># praudit /dev/auditpipe</span></code></pre></div></div><div class=paragraph><p>Alapértelmezés szerint a vizsgálati csõhöz tartozó csomópontok kizárólag csak a <code>root</code> felhasználó részére érhetõek el. Az <code>audit</code> csoport tagjai úgy tudnak majd hozzáférni, ha felvesszük a következõ <code>devfs</code> szabályt a <span class=filename>devfs.rules</span> állományba:</p></div><div class="literalblock programlisting"><div class=content><pre>add path &#39;auditpipe*&#39; mode 0440 group audit</pre></div></div><div class=paragraph><p>A devfs állományrendszer beállításárõl bõvebben lásd a <a href="https://man.freebsd.org/cgi/man.cgi?query=devfs.rules&amp;sektion=5&amp;format=html">devfs.rules(5)</a> oldalt.</p></div><div class="admonitionblock warning"><table><tbody><tr><td class=icon><i class="fa icon-warning" title=Warning></i></td><td class=content><div class=paragraph><p>Könnyen gerjedést lehet elõidézni a vizsgált események megfigyelésével, amikor is az egyes események megtekintése újabb vizsgálandó események sorozatát indítják el. Például, ha az összes hálózati forgalmat egyszerre vizsgáljuk és a <a href="https://man.freebsd.org/cgi/man.cgi?query=praudit&amp;sektion=1&amp;format=html">praudit(1)</a> egy SSH-munkameneten keresztül fut, akkor a vizsgálati események töméntelen áradata indul meg, mivel minden kiírandó esemény egy újabb eseményt indukál. Ennek elkerülése érdekében ajánlott a <code>praudit</code> parancsot részletes forgalmat nem figyelõ vizsgálati csõvel ellátott munkameneten keresztül elindítani.</p></div></td></tr></tbody></table></div></div><div class=sect3><h4 id=_a_vizsgálati_nyomok_archiválása>17.5.5. A vizsgálati nyomok archiválása<a class=anchor href=#_a_vizsgálati_nyomok_archiválása></a></h4><div class=paragraph><p>A vizsgálati nyomokat egyedül a rendszermag képes írni, illetve csak a vizsgálati démon, az auditd képes felügyelni. A rendszergazdáknak ebben az esetben tehát nem szabad használniuk a <a href="https://man.freebsd.org/cgi/man.cgi?query=newsyslog.conf&amp;sektion=5&amp;format=html">newsyslog.conf(5)</a> vagy a hozzá hasonló eszközök használatát a vizsgálati naplók archiválásához. Helyettük a <code>audit</code> segédprogramot javasolt használni a vizsgálatok leállítására, a vizsgálati rendszer újrakonfigurálására vagy a napló archiválásának elvégzésére. Az alábbi parancs utasítja a vizsgálati démont, hogy hozzon létre egy új vizsgálati naplót és jelzi a rendszermagnak, hogy váltson erre az új naplóra. Az eddig használt naplót lezárja és átnevezi, ami ezután a rendszergazda által tetszõlegesen feldolgozható.</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># audit -n</span></code></pre></div></div><div class="admonitionblock warning"><table><tbody><tr><td class=icon><i class="fa icon-warning" title=Warning></i></td><td class=content><div class=paragraph><p>Ha az auditd démon a parancs kiadásánák pillanatában nem futna, akkor hiba történik és errõl hibaüzenetet kapunk.</p></div></td></tr></tbody></table></div><div class=paragraph><p>A <a href="https://man.freebsd.org/cgi/man.cgi?query=cron&amp;sektion=8&amp;format=html">cron(8)</a> segítségével tizenként óránként kikényszeríthetjük a naplók váltását, ha felvesszük a <span class=filename>/etc/crontab</span> állományba az alábbi sort:</p></div><div class="literalblock programlisting"><div class=content><pre>0     */12       *       *       *       root    /usr/sbin/audit -n</pre></div></div><div class=paragraph><p>Ez a változtatás akkor fog érvénybe lépni, ha elmentjük az új <span class=filename>/etc/crontab</span> állományt.</p></div><div class=paragraph><p>A vizsgálati nyomok mérete szerinti automatikus váltás is megvalósítható az <a href="https://man.freebsd.org/cgi/man.cgi?query=audit_control&amp;sektion=5&amp;format=html">audit_control(5)</a> állományban szereplõ <code>filesz</code> opció beállításával, amit meg is találhatunk ebben a fejezetben, a konfigurációs állományok beállításánál.</p></div></div><div class=sect3><h4 id=_a_vizsgálati_nyomok_tömörítése>17.5.6. A vizsgálati nyomok tömörítése<a class=anchor href=#_a_vizsgálati_nyomok_tömörítése></a></h4><div class=paragraph><p>Mivel a vizsgálati nyomok óriásira is megnõhetnek, sokszor felmerül az igény, hogy lehessen õket tömöríteni vagy más egyéb módon archiválni a vizsgálati démon által lezárt nyomokat. Az <span class=filename>audit_warn</span> szkript használható a különbözõ vizsgálatokhoz kapcsolódó események esetén elvégzendõ mûveletek megadásához, beleértve ebbe a vizsgálati nyomok váltásakor elvégzett szabályos lezárását. Például a következõket kell beleírnunk az <span class=filename>audit_warn</span> szkriptbe a nyomok lezárását követõ tömörítéséhez:</p></div><div class="literalblock programlisting"><div class=content><pre>#
# Lezáráskor tömöríti a vizsgálati nyomot.
#
if [ &#34;$1&#34; = closefile ]; then
        gzip -9 $2
fi</pre></div></div><div class=paragraph><p>Egyéb archiválási tevékenységek lehetnek még: a nyomok felmásolása egy központi szerverre, a régebbi nyomok törlése, vagy a meglevõ nyomok leszûkítése csak a fontos információkra. A szkript csak akkor fog lefutni, ha a vizsgálati nyomot sikerült szabályosan lezárni, így tehát a szabálytalan leálláskor megmaradó nyomok esetén nem.</p></div><div class=paragraph><p>A FreeBSD 6.3 és késõbbi verzióiban, a <code>praudit</code> XML kimeneti formátumot is támogat, amely az <code>-x</code> kapcsolóval érhetõ el.</p></div></div></div></div></div><div class=sect1><h2 id=disks>Chapter 18. Háttértárak<a class=anchor href=#disks></a></h2><div class=sectionbody><div class=sect2><h3 id=disks-synopsis>18.1. Áttekintés<a class=anchor href=#disks-synopsis></a></h3><div class=paragraph><p>Ez a fejezet arról szól, hogy miként használjuk a lemezeinket a FreeBSD-vel. Itt többek közt szó esik a memória (alapú) lemezekrõl, a hálózaton keresztül csatlakoztatott meghajtókról, a szabványos SCSI/IDE tárolóeszközökrõl és az USB felületet használó eszközökrõl.</p></div><div class=paragraph><p>A fejezet elolvasása során megismerjük:</p></div><div class=ulist><ul><li><p>a FreeBSD által alkalmazott terminológiát, amivel a fizikai lemezeken elhelyezkedõ adatokat írja le (partíciók és slice-ok);</p></li><li><p>hogyan bõvítsük rendszerünket további merevlemezekkel;</p></li><li><p>hogyan állítsuk be a FreeBSD-t USB tárolóeszközök használatára;</p></li><li><p>hogyan állítsunk be virtuális állományrendszereket, például memórialemezeket;</p></li><li><p>hogyan használjuk a kvótákat a lemezterület használatának korlátozására;</p></li><li><p>hogyan védjüket meg lemezeinket titkosítással az illetéktelenektõl;</p></li><li><p>FreeBSD alatt hogyan készítsünk és írjuk CD-ket, DVD-ket;</p></li><li><p>a biztonsági mentések készítésének különbözõ lehetõségeit;</p></li><li><p>hogyan használjuk a FreeBSD alatt rendelkezésünkre álló, biztonsági mentést készítõ programokat;</p></li><li><p>hogyan mentsünk floppy lemezekre;</p></li><li><p>mik az állományrendszerek pillanatképei és hogyan kell ezeket hatékonyan használni.</p></li></ul></div><div class=paragraph><p>A fejezet elolvasásához ajánlott:</p></div><div class=ulist><ul><li><p>a FreeBSD rendszermag beállításának és telepítésének ismerete (<a href=./#kernelconfig>A FreeBSD rendszermag testreszabása</a>)</p></li></ul></div></div><div class=sect2><h3 id=disks-naming>18.2. Az eszközök elnevezései<a class=anchor href=#disks-naming></a></h3><div class=paragraph><p>A most következõ listában felsoroljuk a FreeBSD által ismert fizikai tárolóeszközöket és a hozzájuk tartozó elnevezéseket.</p></div><table id=disk-naming-physical-table class="tableblock frame-none grid-all stretch"><caption class=title>Táblázat 6. A fizikai lemezek elnevezésének szabályai</caption><col style=width:50%><col style=width:50%><thead><tr><th class="tableblock halign-left valign-top">A meghajtó típusa</th><th class="tableblock halign-left valign-top">A meghajtóeszköz neve</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class=tableblock>IDE merevlemezek</p></td><td class="tableblock halign-left valign-top"><p class=tableblock><code>ad</code></p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>IDE CD-meghajtók</p></td><td class="tableblock halign-left valign-top"><p class=tableblock><code>acd</code></p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>SCSI merevlemezek és USB tárolóeszközök</p></td><td class="tableblock halign-left valign-top"><p class=tableblock><code>da</code></p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>SCSI CD-meghajtók</p></td><td class="tableblock halign-left valign-top"><p class=tableblock><code>cd</code></p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>Különbözõ nem szabványos CD-meghajtók</p></td><td class="tableblock halign-left valign-top"><p class=tableblock><code>mcd</code> (Mitsumi CD-ROM) és <code>scd</code> (Sony CD-ROM)</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>Floppy meghajtók</p></td><td class="tableblock halign-left valign-top"><p class=tableblock><code>fd</code></p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>SCSI szalagos meghajtók</p></td><td class="tableblock halign-left valign-top"><p class=tableblock><code>sa</code></p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>IDE szalagos meghajtók</p></td><td class="tableblock halign-left valign-top"><p class=tableblock><code>ast</code></p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>Flash meghajtó</p></td><td class="tableblock halign-left valign-top"><p class=tableblock><code>fla</code> (DiskOnChip® Flash eszköz)</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>RAID meghajtók</p></td><td class="tableblock halign-left valign-top"><p class=tableblock><code>aacd</code> (Adaptec® AdvancedRAID), <code>mlxd</code> és <code>mlyd</code> (Mylex®), <code>amrd</code> (AMI MegaRAID®), <code>idad</code> (Compaq Smart RAID), <code>twed</code> (3ware® RAID).</p></td></tr></tbody></table></div><div class=sect2><h3 id=disks-adding>18.3. Lemezek hozzáadása<a class=anchor href=#disks-adding></a></h3><div class=paragraph><p>Ebben a szakaszban arról lesz szó, hogy a jelenleg egyetlen meghajtót tartalmazó rendszerünket hogyan tudjuk bõvíteni egy új SCSI-lemez hozzáadásával. Ehhez elsõként kapcsoljuk ki a számítógépünket és szereljük be a helyére az új meghajtót a számítógép, a lemezvezérlõ és a meghajtó gyártójának utasításai alapján. Mivel ezt a mûveletet rengeteg módon lehet elvégezni, ezért ennek pontos részleteivel ez a leírás most nem foglalkozik.</p></div><div class=paragraph><p>Jelentkezzünk be <code>root</code> felhasználóként. Miután beszereltük a meghajtót, a <span class=filename>/var/run/dmesg.boot</span> állomány végignézésével bizonyosodjuk meg róla, hogy a rendszer valóban megtalálta a lemezt. A példánk szerint ez a meghajtó tehát a <span class=filename>da1</span> nevet fogja viselni, amelyet a <span class=filename>/1</span> könyvtárba akarunk csatlakoztatni (ha IDE-meghajtót telepítünk, akkor a hozzá tartozó eszköz neve <span class=filename>ad1</span> lesz).</p></div><div class=paragraph><p>Mivel a FreeBSD IBM PC kompatibilis számítógépeken fut, ezért nem szabad figyelmen kívül hagynunk a PC BIOS partícióit is. Ezek eltérnek a hagyományos BSD partícióktól. Egy PC-s lemeznek négy BIOS-os partícióbejegyzése lehet. Ha egy lemezt tényleg csak a FreeBSD-nek szánunk, akkor használhatjuk az ún. <em>dedikált</em> módot. Minden más esetben a FreeBSD-nek egy PC BIOS partícióban kell elhelyezkednie. A FreeBSD a PC BIOS partícióit <em>slice</em>-nak nevezi, ezzel különbözteti ezeket a hagyományos BSD partícióktól. Dedikált esetekben is használhatjuk, de elsõsorban akkor kap fontosabb szerepet, amikor a FreeBSD-nek más operációs rendszerekkel kell megosztani a helyet. Ezzel el tudjuk kerülni, hogy a más operációs rendszerekben megtalálható, nem FreeBSD alapú <code>fdisk</code> parancs megzavarodjon.</p></div><div class=paragraph><p>A slice-ok használatakor a meghajtó <span class=filename>/dev/da1s1e</span> néven kerül hozzáadásra. Így kell olvasni: egyes SCSI lemezes egység (második SCSI lemez), elsõ slice (elsõ PC BIOS partíció) és <span class=filename>e</span> BSD partíció. A dedikált esetben a meghajtó neve viszont egyszerûen csak <span class=filename>/dev/da1e</span>.</p></div><div class=paragraph><p>Mivel a <a href="https://man.freebsd.org/cgi/man.cgi?query=bsdlabel&amp;sektion=8&amp;format=html">bsdlabel(8)</a> 32 bites egész számokat használ a szektorok számának tárolására, ezért lemezenként csak 2^32-1 szektort tud ábrázolni, ami az esetek többségében 2 TB méretû címezhetõ területet jelent. Az <a href="https://man.freebsd.org/cgi/man.cgi?query=fdisk&amp;sektion=8&amp;format=html">fdisk(8)</a> formátuma szerint sem a kezdõszektor, sem a hossz nem lehet 2^32-1-nél több, amivel így a partíciókat 2 TB, a lemezeket pedig 4 TB méretûre korlátozza. A <a href="https://man.freebsd.org/cgi/man.cgi?query=sunlabel&amp;sektion=8&amp;format=html">sunlabel(8)</a> formátuma partíciónként 2^32-1 szektort enged meg és összesen 8 partíciót, amely ezáltal 16 TB terület lefedését teszi lehetõvé. Nagyobb lemezekhez <a href="https://man.freebsd.org/cgi/man.cgi?query=gpt&amp;sektion=8&amp;format=html">gpt(8)</a> partíciók használatosak.</p></div><div class=sect3><h4 id=_a_sysinstall8_használatával>18.3.1. A <a href="https://man.freebsd.org/cgi/man.cgi?query=sysinstall&amp;sektion=8&amp;format=html">sysinstall(8)</a> használatával<a class=anchor href=#_a_sysinstall8_használatával></a></h4><div class="exampleblock procedure"><div class=content><div class="olist arabic"><ol class=arabic><li><p>Közlekedés a sysinstall programban</p><div class=paragraph><p>A <code>sysinstall</code> könnyen használható menüinek segítségével az új lemezen pillanatok alatt létre tudunk hozni partíciókat és megcímkézni ezeket. Ehhez vagy <code>root</code> felhasználóként jelentkezzünk be a rendszerbe, vagy adjuk ki a <code>su</code> parancsot. A <code>sysinstall</code> parancs kiadása után lépjünk be a <code>Configure</code> (Beállítások) menübe. A <code>FreeBSD Configuration Menu</code> menüben ezután keressük meg és válasszuk ki az <code>Fdisk</code> menüpontot.</p></div></li><li><p>Az fdisk partíciószerkesztõ</p><div class=paragraph><p>Miután eljutottunk az fdisk alkalmazáshoz, az <kbd>A</kbd> lenyomásával felajánlhatjuk az egész lemezt a FreeBSD számára. Amikor elõkerül a kérdés, hogy "remain cooperative with any future possible operating systems" ("mûködõképes maradjon-e a késõbbiekben telepítendõ operációs rendszerekkel"), akkor válaszoljuk rá <code>YES</code>-szel (tehát igen). A <kbd>W</kbd> gomb lenyomásával írjuk a lemezre a most elvégzett változtatásokat. Ezután már a <kbd>Q</kbd> használatával ki is léphetünk az FDISK szerkesztõbõl. A következõ lépésben a "Master Boot Record"-ról fognak minket megkérdezni. Mivel most egy már mûködõ rendszert bõvítünk, ezért a válaszunk erre <code>None</code> lesz.</p></div></li><li><p>A lemezcímkék szerkesztése</p><div class=paragraph><p>Most lépjünk ki a sysinstall alkalmazásból és indítsuk el újra. Kövessük az iménti útmutatásokat, de ezúttal a <code>Label</code> menüpontot válasszuk ki. Ezzel a <code>Disk Label Editor</code>-ba vagyis a lemezcímkék szerkesztõjéhez jutunk. Itt fogjuk létrehozni a hagyományos BSD partíciókat. Egy lemezen nyolc ilyen partíció lehet, <code>a</code>-tól <code>h</code>-ig. Közülük néhány partíció címkéjét megkülönböztetjük. Az <code>a</code> partíció jelöli a rendszer indításához használt partíciót, a gyökérpartíciót (<span class=filename>/</span>). Tehát <code>a</code> partíció csak a rendszerlemezünkön szerepelhet (tehát ahonnan indul a rendszer). A <code>b</code> partíció a lapozáshoz használt partíciókat jelöli és több lemezen is szerepelhet. A <code>c</code> partíción keresztül lehet elérni az egészt lemezt dedikált módban vagy az egész FreeBSD slice-ot slice módban. A többi partíció tetszõlegesen felhasználható.</p></div><div class=paragraph><p>A sysinstall címkeszerkesztõje az <code>e</code> betûvel szereti megjelölni a sem nem rendszerindító, sem nem lapozó partíciókat. A címkeszerkesztõben egyetlen állományrendszert a <kbd>C</kbd> lenyomásával lehet készíteni. Amikor erre válaszul megkérdezi a típusát (FS (állományrendszer) vagy swap (lapozóterület) legyen), akkor válasszuk az <code>FS</code> beállítást és adjuk meg a csatlakozási pontját (például <span class=filename>/mnt</span>). Amikor a lemezt telepítés után (post-install) adjuk hozzá, akkor a sysinstall valójában nem hoz létre hozzá bejegyzéseket az <span class=filename>/etc/fstab</span> állományban, ezért a csatlakozási pont megadása nem is feltétlenül fontos.</p></div><div class=paragraph><p>Most már készen állunk arra, hogy rögzítsük az új címkét a lemezre és létrehozzunk vele egy állományrendszert. Ehhez nyomjuk le a <kbd>W</kbd> gombot. Ne foglalkozzunk vele, ha a sysinstall nem képes csatlakoztatni az új partíciót. Ha ezzel megvagyunk, akkor lépjünk ki a címkeszerkesztõbõl és a sysinstallból is.</p></div></li><li><p>Befejezés</p><div class=paragraph><p>Most már csak annyi teendõnk maradt, hogy felvegyük az <span class=filename>/etc/fstab</span> állományba az új lemezhez tartozó bejegyzést.</p></div></li></ol></div></div></div></div><div class=sect3><h4 id=_parancssoros_eszközök_használatával>18.3.2. Parancssoros eszközök használatával<a class=anchor href=#_parancssoros_eszközök_használatával></a></h4><div class=sect4><h5 id=_slice_módban>18.3.2.1. Slice módban<a class=anchor href=#_slice_módban></a></h5><div class=paragraph><p>Ezzel a beállítással a lemezünkre késõbb más operációs rendszereket is telepíthetünk, és nem okoz gondot a saját <code>fdisk</code> segédprogramjaik mûködésében. Az új lemezek telepítésénél ezt a módszer ajánlatos követni. A dedikált módot viszont csak abban az esetben használjuk, ha erre nyomós okunk van!</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># dd if=/dev/zero of=/dev/da1 bs=1k count=1</span>
<span class=c># fdisk -BI da1 # inicializáljuk az új lemezt</span>
<span class=c># bsdlabel -B -w da1s1 auto # címkézzük meg</span>
<span class=c># bsdlabel -e da1s1 # szerkeszzük át a frissen létrehozott címkét és vegyünk fel egy új partíciót</span>
<span class=c># mkdir -p /1</span>
<span class=c># newfs /dev/da1s1e # ismételjük meg minden létrehozott partícióhoz</span>
<span class=c># mount /dev/da1s1e /1 # csatlakoztassuk a partíció(ka)t</span>
<span class=c># vi /etc/fstab # vegyük fel a megfelelő bejegyzés(eke)t az /etc/fstab állományba</span></code></pre></div></div><div class=paragraph><p>IDE-lemezek esetén az<span class=filename>ad</span> eszközt a <span class=filename>da</span> eszközzel helyettesítsük.</p></div></div><div class=sect4><h5 id=_dedikált_módban>18.3.2.2. Dedikált módban<a class=anchor href=#_dedikált_módban></a></h5><div class=paragraph><p>Amennyiben az új meghajtót nem akarjuk megosztani egyetlen más operációs rendszerrel sem, használhatjuk a <code>dedicated</code> (dedikált) módot. Ne felejtsük el azonban, hogy ez képes összezavarni a Microsoft operációs rendszereit, habár ebbõl semmilyen kárunk nem fog származni. Az IBM OS/2® operációs rendszere azonban "kisajátít" minden olyan partíciót, amelyet nem tud olvasni.</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># dd if=/dev/zero of=/dev/da1 bs=1k count=1</span>
<span class=c># bsdlabel -Bw da1 auto</span>
<span class=c># bsdlabel -e da1				# létrehozzuk az `e&#39; partíciót</span>
<span class=c># newfs /dev/da1e</span>
<span class=c># mkdir -p /1</span>
<span class=c># vi /etc/fstab				# felvesszük a /dev/da1e partíciót</span>
<span class=c># mount /1</span></code></pre></div></div><div class=paragraph><p>Egy másik megoldás:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># dd if=/dev/zero of=/dev/da1 count=2</span>
<span class=c># bsdlabel /dev/da1 | bsdlabel -BR da1 /dev/stdin</span>
<span class=c># newfs /dev/da1e</span>
<span class=c># mkdir -p /1</span>
<span class=c># vi /etc/fstab					# felvesszük a /dev/da1e partíciót</span>
<span class=c># mount /1</span></code></pre></div></div></div></div></div><div class=sect2><h3 id=raid>18.4. RAID<a class=anchor href=#raid></a></h3><div class=sect3><h4 id=raid-soft>18.4.1. Szoftveres RAID<a class=anchor href=#raid-soft></a></h4><div class=sect4><h5 id=ccd>18.4.1.1. Összefûzött lemezek beállítása<a class=anchor href=#ccd></a></h5><div class=paragraph><p>A nagyobb méretû háttértárolók kiválasztásánál a legfontosabb tényezõk a sebesség, megbízhatóság és a költség. Nagyon ritkán lehet csak ezt a hármat egyensúlyba hozni: általában a gyors és megbízható tárolóeszközök sok pénzbe kerülnek, valamint a költségek megtakarításához vagy a sebességet vagy pedig a megbízhatóságot kell feláldoznunk.</p></div><div class=paragraph><p>A továbbiakban egy olyan rendszert mutatunk be, ahol a elsõsorban a költségek, majd csak ezután a sebesség és megbízhatóság kerültek elõtérben. A rendszer adatátviteli sebességét a hálózat korlátozza. Habár emellett a megbízhatóság is nagyon fontos, a tárgyalt összefûzött meghajtó (Concenated Disk, CCD) csak adatokat szolgáltat és a teljes tartalma bármikor visszaállítható, mivel rendelkezésre áll CD-n.</p></div><div class=paragraph><p>A feladat elvégzésére alkalmas háttértároló kiválasztásában elsõként a saját elvárásainkat kell tudnunk megfogalmazni. Ha nekünk jobban számít az árnál a sebesség vagy a megbízhatóság, akkor a mostaniaktól némileg eltérõ konfigurációt kell majd építenünk.</p></div><div class=sect5><h6 id=ccd-installhw>18.4.1.1.1. A hardver telepítése<a class=anchor href=#ccd-installhw></a></h6><div class=paragraph><p>A rendszert tartalmazó IDE-lemez mellett három darab, egyenként 30 GB-os 5400-as percenkénti fordulatszámú Western Digital gyártmányú merevlemez alkotja majd a létrehozni kívánt, kb. 90 GB összméretû összefûzött lemezt. Ideális esetben minden IDE-lemez saját külön vezérlõn és kábelen van, de a költségek csökkentése miatt nem használtunk további IDE-vezérlõket. Ehelyett inkább jumperekkel úgy állítottuk be a lemezeket, hogy minden vezérlõre egy mester (master) és egy szolga (slave) módú merevlemez kapcsolódjon.</p></div><div class=paragraph><p>A beszerelés után beállítottuk a rendszer BIOS-át, hogy automatikusan felismerje a csatlakoztatott lemezeket. De ami még fontosabb, hogy a FreeBSD is észlelte ezeket az indítás során:</p></div><div class="literalblock programlisting"><div class=content><pre>ad0: 19574MB &lt;WDC WD205BA&gt; [39770/16/63] at ata0-master UDMA33
ad1: 29333MB &lt;WDC WD307AA&gt; [59598/16/63] at ata0-slave UDMA33
ad2: 29333MB &lt;WDC WD307AA&gt; [59598/16/63] at ata1-master UDMA33
ad3: 29333MB &lt;WDC WD307AA&gt; [59598/16/63] at ata1-slave UDMA33</pre></div></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Ha a FreeBSD nem látná az összes lemezt, akkor ellenõrizzük a jumperek helyes beállítását. Napjainkban a legtöbb IDE-meghajtón találunk egy "Cable Select" jumpert is. Ezzel <em>nem</em> a mester/szolga módot állítjuk be! A megfelelõ jumper beazonosításához olvassuk el a meghajtóhoz tartozó dokumentációt.</p></div></td></tr></tbody></table></div><div class=paragraph><p>A következõ lépésben azt vesszük nagyító alá, hogyan lehet ezeket az állományrendszer részévé tenni. Ezzel kapcsolatban a <a href="https://man.freebsd.org/cgi/man.cgi?query=vinum&amp;sektion=8&amp;format=html">vinum(8)</a> (<a href=./#vinum-vinum>A Vinum kötetkezelő</a>) és a <a href="https://man.freebsd.org/cgi/man.cgi?query=ccd&amp;sektion=4&amp;format=html">ccd(4)</a> elolvasása ajánlatos. Erre a célra itt most a <a href="https://man.freebsd.org/cgi/man.cgi?query=ccd&amp;sektion=4&amp;format=html">ccd(4)</a> használatát választottuk.</p></div></div><div class=sect5><h6 id=ccd-setup>18.4.1.1.2. A CCD beállítása<a class=anchor href=#ccd-setup></a></h6><div class=paragraph><p>A <a href="https://man.freebsd.org/cgi/man.cgi?query=ccd&amp;sektion=4&amp;format=html">ccd(4)</a> meghajtó segítségével több ugyanolyan lemezt tudunk összefûzni egyetlen logikai állományrendszerré. A <a href="https://man.freebsd.org/cgi/man.cgi?query=ccd&amp;sektion=4&amp;format=html">ccd(4)</a> használatához arra is szükségünk van, hogy a <a href="https://man.freebsd.org/cgi/man.cgi?query=ccd&amp;sektion=4&amp;format=html">ccd(4)</a> támogatása jelen legyen a rendszermagban. A következõ sor tegyük bele a rendszermag konfigurációs állományába, fordítsuk újra és telepítsük a rendszermagot:</p></div><div class="literalblock programlisting"><div class=content><pre>device   ccd</pre></div></div><div class=paragraph><p>A <a href="https://man.freebsd.org/cgi/man.cgi?query=ccd&amp;sektion=4&amp;format=html">ccd(4)</a> támogatása modulként is betölthetõ.</p></div><div class=paragraph><p>A <a href="https://man.freebsd.org/cgi/man.cgi?query=ccd&amp;sektion=4&amp;format=html">ccd(4)</a> beállításához elõször a <a href="https://man.freebsd.org/cgi/man.cgi?query=bsdlabel&amp;sektion=8&amp;format=html">bsdlabel(8)</a> programmal meg fel kell címkéznünk a lemezeket:</p></div><div class="literalblock programlisting"><div class=content><pre>bsdlabel -w ad1 auto
bsdlabel -w ad2 auto
bsdlabel -w ad3 auto</pre></div></div><div class=paragraph><p>Így létrejön egy-egy BSD típusú címke a <span class=filename>ad1c</span>, <span class=filename>ad2c</span> és <span class=filename>ad3c</span> eszközökre, amely így lefedi a lemez egész területét.</p></div><div class=paragraph><p>Most pedig változtassuk meg a lemezcímke típusát. Ehhez használjuk ismét a <a href="https://man.freebsd.org/cgi/man.cgi?query=bsdlabel&amp;sektion=8&amp;format=html">bsdlabel(8)</a> programot:</p></div><div class="literalblock programlisting"><div class=content><pre>bsdlabel -e ad1
bsdlabel -e ad2
bsdlabel -e ad3</pre></div></div><div class=paragraph><p>Az <code>EDITOR</code> környezeti változóban megadott szövegszerkesztõvel (ez általában a <a href="https://man.freebsd.org/cgi/man.cgi?query=vi&amp;sektion=1&amp;format=html">vi(1)</a>) megnyílik minden egyes lemezhez a jelenlegi lemezcímke.</p></div><div class=paragraph><p>Egy módosítatlan lemezcímke valahogy így néz ki:</p></div><div class="literalblock programlisting"><div class=content><pre>8 partitions:
#        size   offset    fstype   [fsize bsize bps/cpg]
  c: 60074784        0    unused        0     0     0   # (Cyl.    0 - 59597)</pre></div></div><div class=paragraph><p>A <a href="https://man.freebsd.org/cgi/man.cgi?query=ccd&amp;sektion=4&amp;format=html">ccd(4)</a> számára hozzunk létre egy új <code>e</code> partíciót. Ezt lényegében a <code>c</code> partíció lemásolásával keletkezik, de nála az <code>fstype</code> (az állományrendszer típusa) oszlopban mindenképpen <code>4.2BSD</code> szerepeljen! A lemezcímke most már valahogy így fog kinézni:</p></div><div class="literalblock programlisting"><div class=content><pre>8 partitions:
#        size   offset    fstype   [fsize bsize bps/cpg]
  c: 60074784        0    unused        0     0     0   # (Cyl.    0 - 59597)
  e: 60074784        0    4.2BSD        0     0     0   # (Cyl.    0 - 59597)</pre></div></div></div><div class=sect5><h6 id=ccd-buildingfs>18.4.1.1.3. Az állományrendszer kiépítése<a class=anchor href=#ccd-buildingfs></a></h6><div class=paragraph><p>Most, miután felcímkéztük az összes lemezünket, lássunk neki a <a href="https://man.freebsd.org/cgi/man.cgi?query=ccd&amp;sektion=4&amp;format=html">ccd(4)</a> kiépítésének. Ezt a <a href="https://man.freebsd.org/cgi/man.cgi?query=ccdconfig&amp;sektion=8&amp;format=html">ccdconfig(8)</a> meghívásával és az alábbihoz hasonló paraméterek átadásával tehetjük meg:</p></div><div class="literalblock programlisting"><div class=content><pre>ccdconfig ccd0 32 0 /dev/ad1e /dev/ad2e /dev/ad3e</pre></div></div><div class=paragraph><p>A paraméterek rövid leírása és használata:
* Az elsõ paraméter a létrehozandó eszköz, ami jelen esetünkben a <span class=filename>/dev/ccd0c</span>. A <span class=filename>/dev/</span> részt nem kötelezõ megadni.
* A kihagyás nagysága az állományrendszerben. A kihagyás határozza meg a lemezblokkban alkalmazott csíkozás (striping) vastagságát, ami általában 512 byte. Ennek megfelelõen a 32-es kihagyás 16 384 byte-os csíkokat ad meg.
* A <a href="https://man.freebsd.org/cgi/man.cgi?query=ccdconfig&amp;sektion=8&amp;format=html">ccdconfig(8)</a> beállításai. Ha engedélyezni akarjuk a lemezek tükrözését, akkor itt megadhatjuk. Mivel ez a konfiguráció most nem nyújt tükrözést a <a href="https://man.freebsd.org/cgi/man.cgi?query=ccd&amp;sektion=4&amp;format=html">ccd(4)</a> számára, ezért állítsuk nullára (0).
* A <a href="https://man.freebsd.org/cgi/man.cgi?query=ccdconfig&amp;sektion=8&amp;format=html">ccdconfig(8)</a> parancsnak utolsóként azokat az eszközöket kell felsorolni, amelyeket tömbbe akarunk fûzni. Minden eszközt teljes elérési úttal adjuk meg.</p></div><div class=paragraph><p>A <a href="https://man.freebsd.org/cgi/man.cgi?query=ccdconfig&amp;sektion=8&amp;format=html">ccdconfig(8)</a> futtatása után a <a href="https://man.freebsd.org/cgi/man.cgi?query=ccd&amp;sektion=4&amp;format=html">ccd(4)</a> beállítódik. Most már állományrendszert is rakhatunk rá. A <a href="https://man.freebsd.org/cgi/man.cgi?query=newfs&amp;sektion=8&amp;format=html">newfs(8)</a> man oldalról szedjük össze a szükséges paraméterezést, vagy egyszerûen csak gépeljünk be ennyit:</p></div><div class="literalblock programlisting"><div class=content><pre>newfs /dev/ccd0c</pre></div></div></div><div class=sect5><h6 id=ccd-auto>18.4.1.1.4. Az egész önmûködõvé tétele<a class=anchor href=#ccd-auto></a></h6><div class=paragraph><p>A <a href="https://man.freebsd.org/cgi/man.cgi?query=ccd&amp;sektion=4&amp;format=html">ccd(4)</a> eszközt általában minden egyes indítás után használni akarjuk. Ennek eléréséhez elõször ezt be kell állítanunk. Az alábbi parancs kiadásával írassuk be a jelenlegi beállítasainkat tükrözõ <span class=filename>/etc/ccd.conf</span> állományt:</p></div><div class="literalblock programlisting"><div class=content><pre>ccdconfig -g &gt; /etc/ccd.conf</pre></div></div><div class=paragraph><p>Az újraindítás során az <code>/etc/rc</code> parancs futtatja le a <code>ccdconfig -C</code> parancsot, ha az <span class=filename>/etc/ccd.conf</span> állomány létezik. Ez automatikusan beállítja a <a href="https://man.freebsd.org/cgi/man.cgi?query=ccd&amp;sektion=4&amp;format=html">ccd(4)</a> eszközöket, így ilyenkor tudjuk csatlakoztatni is ezeket.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Ha egyfelhasználós módban indítjuk a rendszert, mielõtt még a <a href="https://man.freebsd.org/cgi/man.cgi?query=mount&amp;sektion=8&amp;format=html">mount(8)</a> paranccsal csatlakoztatni tudnánk a <a href="https://man.freebsd.org/cgi/man.cgi?query=ccd&amp;sektion=4&amp;format=html">ccd(4)</a> eszközt, a tömb beállításához meg kell hívnunk a következõ parancsot:</p></div><div class="literalblock programlisting"><div class=content><pre>ccdconfig -C</pre></div></div></td></tr></tbody></table></div><div class=paragraph><p>Ha a rendszerindításkor automatikusan csatlakoztatni akarjuk a <a href="https://man.freebsd.org/cgi/man.cgi?query=ccd&amp;sektion=4&amp;format=html">ccd(4)</a> eszközt, akkor az <span class=filename>/etc/fstab</span> állományba helyezzünk el egy hozzá tartozó bejegyzést:</p></div><div class="literalblock programlisting"><div class=content><pre>/dev/ccd0c              /media       ufs     rw      2       2</pre></div></div></div></div><div class=sect4><h5 id=vinum>18.4.1.2. A Vinum kötetkezelõ<a class=anchor href=#vinum></a></h5><div class=paragraph><p>A Vinum kötetkezelõ egy blokkos eszközmeghajtó, ami virtuális lemezes meghajtókat valósít meg. Elkülöníti a lemezes hardvereszközöket a blokkos eszközmeghajtók felületétõl és a kettõ között úgy képezi le az adatokat, hogy a hagyományos lemezes tárolással szemben megnövekedett rugalmasságot, teljesítményt és megbízhatóságot kapunk. A <a href="https://man.freebsd.org/cgi/man.cgi?query=vinum&amp;sektion=8&amp;format=html">vinum(8)</a> ismeri a RAID-0, RAID-1 és RAID-5 modelleket egyaránt, melyeket önmagukban és együttesen kombinálva is használhatunk.</p></div><div class=paragraph><p>A <a href=./#vinum-vinum>A Vinum kötetkezelő</a> bõvebben ismerteti a <a href="https://man.freebsd.org/cgi/man.cgi?query=vinum&amp;sektion=8&amp;format=html">vinum(8)</a> rendszerét.</p></div></div></div><div class=sect3><h4 id=raid-hard>18.4.2. Hardveres RAID<a class=anchor href=#raid-hard></a></h4><div class=paragraph><p>A FreeBSD rengeteg különbözõ típusú hardveres RAID-vezérlõt ismer. Ezek az eszközök a FreeBSD külön erre a célra szánt támogatása nélkül képesek vezérelni a RAID-alrendszert.</p></div><div class=paragraph><p>A rajta levõ BIOS segítségével a kártya a legtöbb lemezmûveletet egyedül kezeli. A következõkben egy Promise IDERAID vezérlõt alkalmazó rendszert fogunk beállítani. Miután telepítettük a kártyát és indítjuk a rendszert, bekéri a szükséges információkat. Kövessük az utasításokat és lépjünk be a kártya beállító képernyõjére. Itt tudjuk kombinálni az összes csatlakoztatott meghajtónkat. Amikor ezzel a végeztünk, a lemezek egyetlen lemezként fognak a FreeBSD számára viselkedni. A többi RAID-szint is ehhez hasonlóan állítható be.</p></div></div><div class=sect3><h4 id=_az_ata_raid_1_tömbök_újraszervezése>18.4.3. Az ATA RAID-1 tömbök újraszervezése<a class=anchor href=#_az_ata_raid_1_tömbök_újraszervezése></a></h4><div class=paragraph><p>A FreeBSD lehetõséget a tömbben levõ meghibásodott eszközök menet közben elvégezhetõ cseréjére. Ehhez arra van szükségünk, hogy még újraindítás elõtt elcsípjük a hibát.</p></div><div class=paragraph><p>Hiba esetén valami hasonlót fogunk látni a <span class=filename>/var/log/messages</span> állományban vagy a <a href="https://man.freebsd.org/cgi/man.cgi?query=dmesg&amp;sektion=8&amp;format=html">dmesg(8)</a> kimenetében:</p></div><div class="literalblock programlisting"><div class=content><pre>ad6 on monster1 suffered a hard error.
ad6: READ command timeout tag=0 serv=0 - resetting
ad6: trying fallback to PIO mode
ata3: resetting devices .. done
ad6: hard error reading fsbn 1116119 of 0-7 (ad6 bn 1116119; cn 1107 tn 4 sn 11)\\
status=59 error=40
ar0: WARNING - mirror lost</pre></div></div><div class=paragraph><p>További információkat az <a href="https://man.freebsd.org/cgi/man.cgi?query=atacontrol&amp;sektion=8&amp;format=html">atacontrol(8)</a> programtól szerezhetünk:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># atacontrol list</span>
ATA channel 0:
	Master:      no device present
	Slave:   acd0 &lt;HL-DT-ST CD-ROM GCR-8520B/1.00&gt; ATA/ATAPI rev 0

ATA channel 1:
	Master:      no device present
	Slave:       no device present

ATA channel 2:
	Master:  ad4 &lt;MAXTOR 6L080J4/A93.0500&gt; ATA/ATAPI rev 5
	Slave:       no device present

ATA channel 3:
	Master:  ad6 &lt;MAXTOR 6L080J4/A93.0500&gt; ATA/ATAPI rev 5
	Slave:       no device present

<span class=c># atacontrol status ar0</span>
ar0: ATA RAID1 subdisks: ad4 ad6 status: DEGRADED</code></pre></div></div><div class="exampleblock procedure"><div class=content><div class="olist arabic"><ol class=arabic><li><p>A lemez biztonságos eltávolításához elõször válasszuk le (detach) a meghibásodott lemezhez tartozó csatornát:</p><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># atacontrol detach ata3</span></code></pre></div></div></li><li><p>Cseréljük ki a lemezt.</p></li><li><p>Csatlakoztassuk újra (attach) az ATA csatornát:</p><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># atacontrol attach ata3</span>
Master:  ad6 &lt;MAXTOR 6L080J4/A93.0500&gt; ATA/ATAPI rev 5
Slave:   no device present</code></pre></div></div></li><li><p>Tartalékként (spare) adjuk hozzá az új lemezt a tömbhöz:</p><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># atacontrol addspare ar0 ad6</span></code></pre></div></div></li><li><p>Szervezzük újra (rebuild) a tömböt:</p><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># atacontrol rebuild ar0</span></code></pre></div></div></li><li><p>A folyamat elõrehaladását a következõ parancs begépelésével tudjuk figyelni:</p><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># dmesg | tail -10</span>
<span class=o>[</span>a kimenet többi része]
ad6: removed from configuration
ad6: deleted from ar0 disk1
ad6: inserted into ar0 disk1 as spare

<span class=c># atacontrol status ar0</span>
ar0: ATA RAID1 subdisks: ad4 ad6 status: REBUILDING 0% completed</code></pre></div></div></li><li><p>Várjunk a mûvelet befejezõdéséig.</p></li></ol></div></div></div></div></div><div class=sect2><h3 id=usb-disks>18.5. USB tárolóeszközök<a class=anchor href=#usb-disks></a></h3><div class=paragraph><p>Manapság már számos külsõ tárolóeszköz az USB (Universal Serial Bus) közvetítésével csatlakozik a számítógéphez: merevlemezek, pen drive-ok, CD-írók stb. A FreeBSD ezeket az eszközöket is ismeri.</p></div><div class=sect3><h4 id=_beállítás>18.5.1. Beállítás<a class=anchor href=#_beállítás></a></h4><div class=paragraph><p>A USB tárolóeszközöket kezelõ meghajtó, az <a href="https://man.freebsd.org/cgi/man.cgi?query=umass&amp;sektion=4&amp;format=html">umass(4)</a> felelõs az USB alapú tárolóeszközök támogatásáért. Ha a <span class=filename>GENERIC</span> rendszermagot használjuk, akkor semmit sem kell változtatnunk. Ha saját rendszermagunk van, akkor gondoskodjunk róla, hogy a következõ sorokat beraktuk a rendszermag beállításait tartalmazó állományba:</p></div><div class="literalblock programlisting"><div class=content><pre>device scbus
device da
device pass
device uhci
device ehci
device usb
device umass</pre></div></div><div class=paragraph><p>Az <a href="https://man.freebsd.org/cgi/man.cgi?query=umass&amp;sektion=4&amp;format=html">umass(4)</a> meghajtó a SCSI alrendszeren keresztül éri el az USB tárolóeszközöket, tehát az USB eszközeinket a rendszer SCSI eszközként látja. Az alaplapon található USB chipkészlet típusától függõen vagy csak a <code>device uhci</code>, vagy USB 1.<em>X</em> esetén pedig a <code>device ohci</code> bejegyzésre lesz szükségünk. De abból sem származik kárunk, ha mind a kettõt meghagyjuk. Az USB 2.0 szabványú vezérlõket a <a href="https://man.freebsd.org/cgi/man.cgi?query=ehci&amp;sektion=4&amp;format=html">ehci(4)</a> meghajtó (<code>device ehci</code>) támogatja. Ha módosítani kellett a konfigurációs állományt, akkor ne felejtsük el újrafordítani és telepíteni sem a rendszermagot.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Ha az USB eszközünk egy CD- vagy DVD-író, akkor a következõ sorral a SCSI CD-meghajtók meghajtóját, a <a href="https://man.freebsd.org/cgi/man.cgi?query=cd&amp;sektion=4&amp;format=html">cd(4)</a> eszközt kell beépítenünk a rendszermagba:</p></div><div class="literalblock programlisting"><div class=content><pre>device cd</pre></div></div><div class=paragraph><p>Mivel az író is SCSI eszközként látszik, ezért az <a href="https://man.freebsd.org/cgi/man.cgi?query=atapicam&amp;sektion=4&amp;format=html">atapicam(4)</a> nem szerepelhet a rendszermag beállításai között.</p></div></td></tr></tbody></table></div></div><div class=sect3><h4 id=_a_beállítások_kipróbálása>18.5.2. A beállítások kipróbálása<a class=anchor href=#_a_beállítások_kipróbálása></a></h4><div class=paragraph><p>A beállításaink készen állnak a kipróbálásra: csatlakoztassuk a számítógéphez az USB eszközünket és a rendszerüzeneteket tároló pufferben (<a href="https://man.freebsd.org/cgi/man.cgi?query=dmesg&amp;sektion=8&amp;format=html">dmesg(8)</a>) hamarosan meg is jelenik a hozzá tartozó meghajtó:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>umass0: USB Solid state disk, rev 1.10/1.00, addr 2
GEOM: create disk da0 <span class=nv>dp</span><span class=o>=</span>0xc2d74850
da0 at umass-sim0 bus 0 target 0 lun 0
da0: &lt;Generic Traveling Disk 1.11&gt; Removable Direct Access SCSI-2 device
da0: 1.000MB/s transfers
da0: 126MB <span class=o>(</span>258048 512 byte sectors: 64H 32S/T 126C<span class=o>)</span></code></pre></div></div><div class=paragraph><p>Természetesen a gyártóra, márkára, az eszköz leírójára (<span class=filename>da0</span>) és egyebekre vonatkozó részletek eltérhetnek.</p></div><div class=paragraph><p>Mivel az USB eszköz SCSI eszközként látszik, ezért a <code>camcontrol</code> parancs használható a rendszerhez csatlakoztatott USB tárolóeszközök listázásához:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># camcontrol devlist</span>
&lt;Generic Traveling Disk 1.11&gt;      at scbus0 target 0 lun 0 <span class=o>(</span>da0,pass0<span class=o>)</span></code></pre></div></div><div class=paragraph><p>Ha a meghajtón állományrendszer is található, akkor képesek vagyunk csatlakoztatni. A <a href=#disks-adding>Lemezek hozzáadása</a> elolvasása segíthet az USB meghajtón partíciókat kialakítani és formázni, amennyiben szükséges.</p></div><div class="admonitionblock warning"><table><tbody><tr><td class=icon><i class="fa icon-warning" title=Warning></i></td><td class=content><div class=paragraph><p>A rendszer biztonsága szempontjából nem tekinthetõ megbízhatónak, ha olyan felhasználók számára is engedélyezzük tetszõleges meghajtók csatlakoztatását (például a <code>vfs.usermount</code> engedelyézesével), amelyekben nem bízunk meg. A FreeBSD által támogatott állományrendszerek döntõ többsége nem nyújt védelmet a káros szándékkal telepített eszközök ellen.</p></div></td></tr></tbody></table></div><div class=paragraph><p>Ha az eszközt normál felhasználókkal is csatlakoztathatóvá akarjuk tenni, akkor további lépések megtételére is szükségünk lesz. Elõször is a felhasználóknak valahogy el kell tudniuk érniük az USB tárolóeszköz csatlakoztatásakor keletkezõ eszközöket. Ezt úgy tudjuk megoldani, ha az érintett felhasználókat felvesszük az <code>operator</code> csoportba. Ebben a <a href="https://man.freebsd.org/cgi/man.cgi?query=pw&amp;sektion=8&amp;format=html">pw(8)</a> lehet a segítségünkre. Másodsorban amikor ezek az eszközök létrejönnek, az <code>operator</code> csoportnak tudniuk kell ezeket olvasniuk és írniuk. Ezt úgy tudjuk megvalósítani, ha felvesszük a következõ sorokat az <span class=filename>/etc/devfs.rules</span> állományba:</p></div><div class="literalblock programlisting"><div class=content><pre>[localrules=5]
add path &#39;da*&#39; mode 0660 group operator</pre></div></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Ha viszont vannak SCSI lemezeink is rendszerben, akkor a helyzet egy kicsit megváltozik. Tehát például a rendszerben már eleve vannak <span class=filename>da0</span>, <span class=filename>da1</span> és <span class=filename>da2</span> néven lemezek, akkor a második sort ennek megfelelõen változtassuk meg:</p></div><div class="literalblock programlisting"><div class=content><pre>add path &#39;da[3-9]*&#39; mode 0660 group operator</pre></div></div><div class=paragraph><p>Ezzel kizárunk minden, korábban már létezõ lemezt az <code>operator</code> csoportból.</p></div></td></tr></tbody></table></div><div class=paragraph><p>Emellett még az <span class=filename>/etc/rc.conf</span> állományban engedélyeznünk kell a saját <a href="https://man.freebsd.org/cgi/man.cgi?query=devfs.rules&amp;sektion=5&amp;format=html">devfs.rules(5)</a> szabályrendszerünket is:</p></div><div class="literalblock programlisting"><div class=content><pre>devfs_system_ruleset=&#34;usb_rules&#34;</pre></div></div><div class=paragraph><p>Ezt követõen be kell állítanunk a rendszermagban, hogy a hagyományos felhasználók képesek legyenek állományrendszereket csatlakoztatni. Ezt a legkönnyebb úgy tudjuk megtenni, ha az <span class=filename>/etc/sysctl.conf</span> állományba felvesszük a következõ sort:</p></div><div class="literalblock programlisting"><div class=content><pre>vfs.usermount=1</pre></div></div><div class=paragraph><p>Azonban ne felejtsük el, hogy ez csak a rendszer következõ indításától él. De a <a href="https://man.freebsd.org/cgi/man.cgi?query=sysctl&amp;sektion=8&amp;format=html">sysctl(8)</a> parancs használatával is beállíthatjuk ezt az értéket.</p></div><div class=paragraph><p>Az utolsó lépésben hozzunk létre egy könyvtárat az állományrendszer csatlakoztatásához. Ezt a könyvtárat az a felhasználó fogja birtokolni, aki az állományrendszert csatlakoztatnia akarja. Ez például <code>root</code> felhasználóként úgy tudjuk megtenni, ha a felhasználónak létrehozunk egy könyvtárat <span class=filename>/mnt/felhasználó</span> néven (ahol a <em>felhasználó</em> nevet cseréljük a tényleges felhasználó nevére, a <em>csoport</em> nevet pedig a felhasználóhoz tartozó elsõdleges csoport nevére):</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># mkdir /mnt/felhasználó</span>
<span class=c># chown felhasználó:csoport /mnt/felhasználó</span></code></pre></div></div><div class=paragraph><p>Most tegyük fel, hogy csatlakoztatnuk egy USB pen drive-ot és ennek megfelelõen megjelenik a <span class=filename>/dev/da0s1</span> eszköz. Mivel az ilyen eszközökre általában gyárilag FAT állományrendszert tesznek, ezért így kell ezeket csatlakoztatni a <a href="https://man.freebsd.org/cgi/man.cgi?query=mount&amp;sektion=8&amp;format=html">mount(8)</a> paranccsal:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>% mount <span class=nt>-t</span> msdosfs <span class=nt>-o</span> <span class=nt>-m</span><span class=o>=</span>644,-M<span class=o>=</span>755 /dev/da0s1 /mnt/felhasználó</code></pre></div></div><div class=paragraph><p>Ha leválasztjuk az eszközt (miután kiadtuk a <a href="https://man.freebsd.org/cgi/man.cgi?query=umount&amp;sektion=8&amp;format=html">umount(8)</a> parancsot), akkor a rendszerüzenetek között valami ilyesmit fogunk látni:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>umass0: at uhub0 port 1 <span class=o>(</span>addr 2<span class=o>)</span> disconnected
<span class=o>(</span>da0:umass-sim0:0:0:0<span class=o>)</span>: lost device
<span class=o>(</span>da0:umass-sim0:0:0:0<span class=o>)</span>: removing device entry
GEOM: destroy disk da0 <span class=nv>dp</span><span class=o>=</span>0xc2d74850
umass0: detached</code></pre></div></div></div><div class=sect3><h4 id=_a_témáról_bõvebben>18.5.3. A témáról bõvebben<a class=anchor href=#_a_témáról_bõvebben></a></h4><div class=paragraph><p>A <a href=#disks-adding>Lemezek hozzáadása</a> és az <a href=./#mount-unmount>Állományrendszerek csatlakoztatása és leválasztása</a> címû szakaszok elolvasása mellett a következõ man oldalakat is ajánljuk: <a href="https://man.freebsd.org/cgi/man.cgi?query=umass&amp;sektion=4&amp;format=html">umass(4)</a>, <a href="https://man.freebsd.org/cgi/man.cgi?query=camcontrol&amp;sektion=8&amp;format=html">camcontrol(8)</a> és <a href="https://man.freebsd.org/cgi/man.cgi?query=usbconfig&amp;sektion=8&amp;format=html">usbconfig(8)</a> FreeBSD 8.<em>X</em> esetében, vagy <a href="https://man.freebsd.org/cgi/man.cgi?query=usbdevs&amp;sektion=8&amp;format=html">usbdevs(8)</a> a FreeBSD korábbi változatainál.</p></div></div></div><div class=sect2><h3 id=creating-cds>18.6. Lézeres tárolóeszközök (CD-k) létrehozása és használata<a class=anchor href=#creating-cds></a></h3><div class=sect3><h4 id=_bevezetés_3>18.6.1. Bevezetés<a class=anchor href=#_bevezetés_3></a></h4><div class=paragraph><p>A CD-k számos lehetõségünkben eltérnek a hagyományos lemezektõl. Kezdetben a felhasználók nem is voltak képesek írni ezeket. Olyannak tervezték, hogy a fejek sávok közti mozgásából fakadó késleltetés nélkül lehessen folyamatosan olvasni. A szállítása a maga idejében sokkal könnyebb volt minden vele egyforma méretû eszköznél.</p></div><div class=paragraph><p>A CD-ken is találhatunk sávokat, azonban ez csak a folyamatosan olvasható adat egy szakaszát jelenti, nem pedig a lemez fizikai tulajdonságát. Ha FreeBSD-n akarunk CD-t készíteni, akkor ehhez elõször össze kell állítanunk a CD egyes sávjaira kerülõ adatokat és ezután rögzíteni ezeket a sávokat a CD-n.</p></div><div class=paragraph><p>Az ISO 9660 állományrendszert úgy tervezték, hogy megbirkózzon ezekkel az eltérésekkel. Sajnos ezzel együtt kõbe vésték az állományrendszerek akkoriban érvényes korlátozásait is. Szerencsére lehetõséget ad bõvítésre, ezáltal a helyesen megírt CD-k képesek úgy átlépni ezeket a határokat, hogy közben az általuk alkalmazott kiterjesztéseket nem ismerõ rendszerekkel is együtt tudnak mûködni.</p></div><div class=paragraph><p>A <a class=package href=https://cgit.freebsd.org/ports/tree/sysutils/cdrtools/>sysutils/cdrtools</a> port tartalmaz egy <a href="https://man.freebsd.org/cgi/man.cgi?query=mkisofs&amp;sektion=8&amp;format=html">mkisofs(8)</a> nevû programot, amellyel létre tudunk hozni ISO 9660 típusú állományrendszert tartalmazó adatállományt. Többféle kiterjesztést is ismer, amit majd a lentebb ismertett opciókkal érhetünk el.</p></div><div class=paragraph><p>A CD írásához használt konkrét segédeszköz attól függ, hogy ATAPI vagy esetleg másmilyen írónk van. Az ATAPI CD-írók az alaprendszer részeként elérhetõ <code>burncd</code> programon keresztül használhatóak. A SCSI és USB CD-írók esetén pedig a <a class=package href=https://cgit.freebsd.org/ports/tree/sysutils/cdrtools/>sysutils/cdrtools</a> portban megtalálható <code>cdrecord</code> programot használhatjuk. Az <a href=#atapicam>ATAPI/CAM modul</a> segítségével a <code>cdrecord</code> és más SCSI-írókra készült programokat is tudunk használni ATAPI hardvereken.</p></div><div class=paragraph><p>Ha a CD-író szoftverünket grafikus felhasználói felületen keresztül szeretnénk használni, akkor az X-CD-Roast vagy a K3b alkalmazásokat érdemes szemügyre vennünk. Ezek az eszközök elérhetõek csomagként vagy a <a class=package href=https://cgit.freebsd.org/ports/tree/sysutils/xcdroast/>sysutils/xcdroast</a> és <a class=package href=https://cgit.freebsd.org/ports/tree/sysutils/k3b/>sysutils/k3b</a> portokból. ATAPI hardver esetén az X-CD-Roast és a K3b alkalmazások használatához szükségünk lesz az <a href=#atapicam>ATAPI/CAM modul</a>ra.</p></div></div><div class=sect3><h4 id=mkisofs>18.6.2. mkisofs<a class=anchor href=#mkisofs></a></h4><div class=paragraph><p>A <a class=package href=https://cgit.freebsd.org/ports/tree/sysutils/cdrtools/>sysutils/cdrtools</a> port részeként elérhetõ <a href="https://man.freebsd.org/cgi/man.cgi?query=mkisofs&amp;sektion=8&amp;format=html">mkisofs(8)</a> program képes a UNIX® típusú állományrendszer könyvtárszerkezete alapján egy ISO 9660 típusú állományrendszert tartalmazó image-et készíteni. Legegyszerûbb módon így használhatjuk:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># mkisofs -o image.iso /az/elérési/út</span></code></pre></div></div><div class=paragraph><p>Ezzel a paranccsal egy olyan <em>image.iso</em> nevû állományt hozunk létre, amely <em>/az/elérési/út</em> által megadott helyen található könyvtárszerkezetet mintázza ISO 9660 állományrendszer formájában. A folyamat során minden olyan állományt leképez szabványos ISO 9660 állományrendszerbeli névre, amely megfelel a szabvány elvárásainak, és kihagy minden olyan állományt, amely nem jellemzõ az ISO állományrendszerekre.</p></div><div class=paragraph><p>Számos opció lehet segítségünkre az ilyenkor felbukkanó akadályok leküzdésében. Ezek közül különösen fontos az <code>-R</code>, amely a UNIX® rendszerek számára megszokott Rock Ridge kiterjesztéseket, valamint a <code>-J</code>, amely a Microsoft rendszerekben használt Joliet kiterjesztéseit, és végül a <code>-hfs</code>, amely a Mac OS® alatt létrehozott HFS állományrendszerek kiterjesztéseit engedélyezi.</p></div><div class=paragraph><p>A kizárólag csak FreeBSD rendszereken használt CD-k esetében a <code>-U</code> megadásával kapcsolhatjuk ki az állománynevek mindenféle korlátozását. Az <code>-R</code> beállítás használatával olyan állományrendszer képét hozzuk létre, amely teljesen megegyezik a parancsban megadott könyvtárból induló fa tartalmával, habár több módon is sérti az ISO 9660 szabvány elõírásait.</p></div><div class=paragraph><p>Az utolsó általános jelleggel használható beállítás a <code>-b</code>. Ezzel lehet megadni az "El Torito" szabványnak megfelelõ rendszerindító CD készítéséhez szükséges rendszerindító image elérését. Ennél a beállításnál tehát meg kell adni a rendszerindításhoz használt lemez image-ét, amely a CD tartalmát magában foglaló könyvtárszerkezetben található valahol. A <a href="https://man.freebsd.org/cgi/man.cgi?query=mkisofs&amp;sektion=8&amp;format=html">mkisofs(8)</a> alapértelmezés szerint egy ún. "floppy emulációs" módban hozza létre az ISO image-et, ezért a rendszerindításhoz használatos lemez image-ének pontosan 1200, 1440 vagy 2880 KB méretûnek kell lennie. Egyes rendszerbetöltõk, mint amilyen például a FreeBSD terjesztéséhez használt lemezeken található, nem használják ezt az emulációt. Ilyen helyzetekben a <code>-no-emul-boot</code> kapcsolót kell megadni. Tehát ha a <span class=filename>/tmp/sajátboot</span> könyvtárban van egy indítható FreeBSD rendszerünk, amelyben a <span class=filename>/tmp/sajátboot/boot/cdboot</span> a rendszerindító lemez image-e, akkor egy <span class=filename>/tmp/indítható.iso</span> nevû ISO 9660 formátumú állományrendszert tartalmazó image-et például így tudunk elkészíteni:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># mkisofs -R -no-emul-boot -b boot/cdboot -o /tmp/indítható.iso /tmp/sajátboot</span></code></pre></div></div><div class=paragraph><p>Miután ezt megtettük, és a rendszermagunkban benne van az <span class=filename>md</span> eszköz támogatása, csatlakoztathatjuk is az állományrendszert:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># mdconfig -a -t vnode -f /tmp/indítható.iso -u 0</span>
<span class=c># mount -t cd9660 /dev/md0 /mnt</span></code></pre></div></div><div class=paragraph><p>Ezután már össze tudjuk vetni az <span class=filename>/mnt</span> és <span class=filename>/tmp/sajátboot</span> könyvtárak egyezõségét.</p></div><div class=paragraph><p>A <a href="https://man.freebsd.org/cgi/man.cgi?query=mkisofs&amp;sektion=8&amp;format=html">mkisofs(8)</a> viselkedését több más opcióval tudjuk finomhangolni, mint például az ISO 9660 kiosztás módosítása vagy a Joliet és HFS lemezek készítése. A <a href="https://man.freebsd.org/cgi/man.cgi?query=mkisofs&amp;sektion=8&amp;format=html">mkisofs(8)</a> man oldalon mindezekrõl bõvebben olvashatunk.</p></div></div><div class=sect3><h4 id=burncd>18.6.3. burncd<a class=anchor href=#burncd></a></h4><div class=paragraph><p>Ha ATAPI CD-írónk van, akkor a <code>burncd</code> paranccsal írhatjuk az ISO image-et a lemezre. A <code>burncd</code> az alaprendszer része, és <span class=filename>/usr/sbin/burncd</span> néven érhetõ el. A használata igen egyszerû, csupán pár paramétere van:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># burncd -f eszköz data image.iso fixate</span></code></pre></div></div><div class=paragraph><p>Ezzel a paranccsal rámásoljuk az <em>image.iso</em> állományt az <em>eszköz</em> eszközre. Az alapértelmezett eszköz a <span class=filename>/dev/acd0</span>. A <a href="https://man.freebsd.org/cgi/man.cgi?query=burncd&amp;sektion=8&amp;format=html">burncd(8)</a> man oldalán találjuk meg az írási sebességgel, a CD írás utáni kiadásával és az audio lemezek írásával kapcsolatos beállításokat.</p></div></div><div class=sect3><h4 id=cdrecord>18.6.4. cdrecord<a class=anchor href=#cdrecord></a></h4><div class=paragraph><p>Ha nincs ATAPI CD-írónk, akkor az íráshoz a <code>cdrecord</code> parancsot kell használnunk. A <code>cdrecord</code> nem az alaprendszer része: vagy a <a class=package href=https://cgit.freebsd.org/ports/tree/sysutils/cdrtools/>sysutils/cdrtools</a> portból vagy a neki megfelelõ csomagból kell telepítenünk. Az alaprendszerben végbemenõ változások miatt a program bináris változatai hibázhatnak, aminek következtében csak "poháralátéteket" fogunk tudni gyártani. Ezért a rendszerrel együtt érdemes frissíteni ezt a portot is. Vagy ha a <a href=./#stable>-STABLE verziót használjuk</a>, akkor mindig érdemes a port elérhetõ legújabb verziójára frissíteni.</p></div><div class=paragraph><p>Miközben a <code>cdrecord</code> számos paraméterrel rendelkezik, az alapvetõ használata mégis egyszerûbb a <code>burncd</code> parancsénál. Egy ISO 9660 formátumú image-et ugyanis a következõ módon tudunk felírni lemezre:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># cdrecord dev=eszköz image.iso</span></code></pre></div></div><div class=paragraph><p>A <code>cdrecord</code> használatának trükkös része a megfelelõ eszköz megtalálása, tehát a <code>dev</code> beállítás helyes megadása. Ehhez használjuk a <code>cdrecord-scanbus</code> paraméterét, amely az alábbihoz hasonló eredményt fog produkálni:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># cdrecord -scanbus</span>
Cdrecord-Clone 2.01 <span class=o>(</span>i386-unknown-freebsd7.0<span class=o>)</span> Copyright <span class=o>(</span>C<span class=o>)</span> 1995-2004 Jörg Schilling
Using libscg version <span class=s1>&#39;schily-0.1&#39;</span>
scsibus0:
        0,0,0     0<span class=o>)</span> <span class=s1>&#39;SEAGATE &#39;</span> <span class=s1>&#39;ST39236LW       &#39;</span> <span class=s1>&#39;0004&#39;</span> Disk
        0,1,0     1<span class=o>)</span> <span class=s1>&#39;SEAGATE &#39;</span> <span class=s1>&#39;ST39173W        &#39;</span> <span class=s1>&#39;5958&#39;</span> Disk
        0,2,0     2<span class=o>)</span> <span class=k>*</span>
        0,3,0     3<span class=o>)</span> <span class=s1>&#39;iomega  &#39;</span> <span class=s1>&#39;jaz 1GB         &#39;</span> <span class=s1>&#39;J.86&#39;</span> Removable Disk
        0,4,0     4<span class=o>)</span> <span class=s1>&#39;NEC     &#39;</span> <span class=s1>&#39;CD-ROM DRIVE:466&#39;</span> <span class=s1>&#39;1.26&#39;</span> Removable CD-ROM
        0,5,0     5<span class=o>)</span> <span class=k>*</span>
        0,6,0     6<span class=o>)</span> <span class=k>*</span>
        0,7,0     7<span class=o>)</span> <span class=k>*</span>
scsibus1:
        1,0,0   100<span class=o>)</span> <span class=k>*</span>
        1,1,0   101<span class=o>)</span> <span class=k>*</span>
        1,2,0   102<span class=o>)</span> <span class=k>*</span>
        1,3,0   103<span class=o>)</span> <span class=k>*</span>
        1,4,0   104<span class=o>)</span> <span class=k>*</span>
        1,5,0   105<span class=o>)</span> <span class=s1>&#39;YAMAHA  &#39;</span> <span class=s1>&#39;CRW4260         &#39;</span> <span class=s1>&#39;1.0q&#39;</span> Removable CD-ROM
        1,6,0   106<span class=o>)</span> <span class=s1>&#39;ARTEC   &#39;</span> <span class=s1>&#39;AM12S           &#39;</span> <span class=s1>&#39;1.06&#39;</span> Scanner
        1,7,0   107<span class=o>)</span> <span class=k>*</span></code></pre></div></div><div class=paragraph><p>Itt felsorolásra kerülnek a <code>dev</code> beállítás értékeként felhasználható eszközök. Keressük meg köztük a CD írónkat és a <code>dev</code> értékének a három vesszõvel elválasztott számot adjuk meg. Ebben az esetben a CD-író eszköz most az 1,5,0 lesz, tehát itt a helyes paraméterezés <code>dev=1,5,0</code>. Ezt az értékét könnyebben is meg lehet adni. Ennek részleteirõl a <a href="https://man.freebsd.org/cgi/man.cgi?query=cdrecord&amp;sektion=1&amp;format=html">cdrecord(1)</a> man oldalán olvashatunk. Abban az esetben is érdemes fellapoznunk, ha az audio sávok írásáról, az írási sebesség korlátozásáról vagy más hasonló dolgokról akarunk olvasni.</p></div></div><div class=sect3><h4 id=duplicating-audiocds>18.6.5. Audio CD-k másolása<a class=anchor href=#duplicating-audiocds></a></h4><div class=paragraph><p>Audio CD-t úgy tudunk másolni, ha elõször állományok sorozatába mentjük a lemez tartalmát, majd ezeket az állományokat egy üres CD-re írjuk. Ennek konkrét folyamata azonban némileg eltér az ATAPI- és SCSI-meghajtók használata során.</p></div><div class="exampleblock procedure"><div class=content><div class=paragraph><p><strong>Procedure: SCSI-meghajtók esetén</strong></p></div><div class="olist arabic"><ol class=arabic><li><p>A <code>cdda2wav</code> programmal mentsük le a lemez tartalmát.</p><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>% cdda2wav <span class=nt>-vall</span> <span class=nt>-D2</span>,0 <span class=nt>-B</span> <span class=nt>-Owav</span></code></pre></div></div></li><li><p>A <code>cdrecord</code> paranccsal írjuk fel a <span class=filename>.wav</span> kiterjesztésû állományokat.</p><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>% cdrecord <span class=nt>-v</span> <span class=nv>dev</span><span class=o>=</span>2,0 <span class=nt>-dao</span> <span class=nt>-useinfo</span>  <span class=k>*</span>.wav</code></pre></div></div><div class=paragraph><p>Gondoskodjunk róla, hogy a <em>2,0</em> értéket a <a href=#cdrecord>cdrecord</a>nak megfelelõen helyesen állítottuk be.</p></div></li></ol></div></div></div><div class="exampleblock procedure"><div class=content><div class=paragraph><p><strong>Procedure: ATAPI-meghajtók esetén</strong></p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Az <a href=#atapicam>ATAPI/CAM modul</a> segítségével a <code>cdda2wav</code> parancs ATAPI meghajtókkal is használható. Ez a megoldás általában kedvezõbb (a hibák és bytesorrend ügyesebb kezelése, stb.) a legtöbb felhasználó számára, mint az itt ismertetett.</p></div></td></tr></tbody></table></div><div class="olist arabic"><ol class=arabic><li><p>Az ATAPI CD meghajtója az egyes sávokat <span class=filename>/dev/acddtnn</span> néven teszi elérhetõvé, ahol a <em>d</em> a meghajtó sorszáma, a <em>nn</em> a sáv két számjeggyel kiírt sorszáma, amelyet szükség szerint balról nullával egészítenek ki. Így tehát az elsõ meghajtó elsõ sávja a <span class=filename>/dev/acd0t01</span>, a második a <span class=filename>/dev/acd0t02</span>, a harmadik a <span class=filename>/dev/acd0t03</span> és így tovább.</p><div class=paragraph><p>Ellenõrizzük, hogy ezek az eszközök jelen vannak a <span class=filename>/dev</span> könyvtárban. Amennyiben hiányoznának, kényszerítsük ki a lemez újbóli beolvasását:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># dd if=/dev/acd0 of=/dev/null count=1</span></code></pre></div></div></li><li><p>Szedjük le az egyes sávokat a <a href="https://man.freebsd.org/cgi/man.cgi?query=dd&amp;sektion=1&amp;format=html">dd(1)</a> használatával. A parancs kiadásakor meg kell adnunk egy blokkméretet is:</p><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># dd if=/dev/acd0t01 of=track1.cdr bs=2352</span>
<span class=c># dd if=/dev/acd0t02 of=track2.cdr bs=2352</span>
...</code></pre></div></div></li><li><p>A <code>burncd</code> használatával írjuk fel a lemezre az imént lementett állományokat. Meg kell adnunk, hogy ezek audio állományok, és hogy a <code>burncd</code> a munka befejeztével zárja le (fixate) a lemezt.</p><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># burncd -f /dev/acd0 audio track1.cdr track2.cdr ... fixate</span></code></pre></div></div></li></ol></div></div></div></div><div class=sect3><h4 id=imaging-cd>18.6.6. Adat CD-k másolása<a class=anchor href=#imaging-cd></a></h4><div class=paragraph><p>Az adatot tartalmazó CD-ket le tudjuk másolni egy olyan image-be, amely funkcionálisan megegyezik egy <a href="https://man.freebsd.org/cgi/man.cgi?query=mkisofs&amp;sektion=8&amp;format=html">mkisofs(8)</a> által létrehozott image-dzsel és amivel le tudunk másolni bármilyen adat CD-t. Az itt megadott példa azt feltételezi, hogy a CD-meghajtónk neve <span class=filename>acd0</span>. Helyére a saját CD-meghajtónk nevét kell behelyettesíteni.</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># dd if=/dev/acd0 of=állomány.iso bs=2048</span></code></pre></div></div><div class=paragraph><p>Most miután lementettük az image-et, írjuk fel CD-re a fentiek szerint.</p></div></div><div class=sect3><h4 id=mounting-cd>18.6.7. Adat CD-k használata<a class=anchor href=#mounting-cd></a></h4><div class=paragraph><p>Most, hogy már készítettünk egy szabványos adat CD-t, valószínûleg szeretnénk is valamilyen csatlakoztatni és elérni a rajta levõ adatokat. Alapértelmezés szerint a <a href="https://man.freebsd.org/cgi/man.cgi?query=mount&amp;sektion=8&amp;format=html">mount(8)</a> mindig azt feltételezi, hogy az állományrendszerek <code>ufs</code> típusúak. Ezért ha valami ilyesmivel próbálkozunk:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># mount /dev/cd0 /mnt</span></code></pre></div></div><div class=paragraph><p>akkor egy <code>Incorrect super block</code> szövegû hibaüzenetet lesz a jutalmunk, és természetesen nem tudjuk csatlakoztatni a CD-t. Mivel a CD nem <code>UFS</code> állományrendszert tartalmaz, ezért az ilyen jellegû kísérleteink mind kudarcba fognak fulladni. Valahogy fel kell világosítanunk a <a href="https://man.freebsd.org/cgi/man.cgi?query=mount&amp;sektion=8&amp;format=html">mount(8)</a> parancsot arról, hogy itt most egy <code>ISO9660</code> típusú állományrendszert akarunk csatlakoztatni, és akkor minden a helyére kerül. Ezt úgy tudjuk megtenni, ha a <a href="https://man.freebsd.org/cgi/man.cgi?query=mount&amp;sektion=8&amp;format=html">mount(8)</a> parancsnak megadjuk a <code>-t cd9660</code> paramétert. Például, ha a <span class=filename>/dev/acd0</span> néven elérhetõ CD-meghajtóban levõ lemezt akarjuk a <span class=filename>/mnt</span> könyvtárba csatlakoztatni, akkor ezt kell begépelnünk:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># mount -t cd9660 /dev/cd0 /mnt</span></code></pre></div></div><div class=paragraph><p>Vegyük észre, hogy az eszköz neve (ez ebben a példában most <span class=filename>/dev/cd0</span>) lehet más is attól függõen, hogy milyen csatolófelületet használ a CD-meghajtónk. Sõt, a <code>-t cd9660</code> valójában csak a <a href="https://man.freebsd.org/cgi/man.cgi?query=mount_cd9660&amp;sektion=8&amp;format=html">mount_cd9660(8)</a> parancsot indítja el. Ennek tükrében tehát az elõbbi példát így rövidíthetjük le:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># mount_cd9660 /dev/cd0 /mnt</span></code></pre></div></div><div class=paragraph><p>Ezen a módon bármilyen gyártmányú adat CD-t képesek vagyunk csatlakoztatni. Egyes ISO 9660 kiterjesztéseket használó lemezek azonban esetleg furcsán mûködhetnek. Például Joliet lemezek az összes állomány nevét kétbyte-os Unicode karakterben tárolják. A FreeBSD rendszermagja ugyan nem beszéli a Unicode-ot, de a FreeBSD CD9660 meghajtója képes menetközben átkonvertálni a Unicode karaktereket. Ha bizonyos nem angol karakterek kérdõjelekként jelennének meg, akkor a <code>-C</code> beállítás használatával még egy helyi kódlapot is meg kell adnunk. Ezzel kapcsolatban bõvebb tájékoztatásért forduljunk a <a href="https://man.freebsd.org/cgi/man.cgi?query=mount_cd9660&amp;sektion=8&amp;format=html">mount_cd9660(8)</a> man oldalhoz.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>A <code>-C</code> beállítás segítségével csak akkor lesz képes a rendszermag elvégezni ezt az átalakítást, ha elõtte betöltjük a <span class=filename>cd9660_iconv.ko</span> modult. Ezt megtehetjük úgy, hogy ha felvesszük a következõ sort a <span class=filename>loader.conf</span> állományba:</p></div><div class="literalblock programlisting"><div class=content><pre>cd9660_iconv_load=&#34;YES&#34;</pre></div></div><div class=paragraph><p>Indítsuk újra a számítógépünket, vagy közvetlenül töltsük be a modult a <a href="https://man.freebsd.org/cgi/man.cgi?query=kldload&amp;sektion=8&amp;format=html">kldload(8)</a> használatával.</p></div></td></tr></tbody></table></div><div class=paragraph><p>Estenként elõfordulhat, hogy kapunk egy <code>Device not configured</code> hibaüzenetet a CD-k csatlakoztatásakor. Ez általában arra utal, hogy a CD-meghajtó nem érzékeli a berakott lemezt, vagy éppen a meghajtó nem látható a buszon. A CD-meghajtók esetében pár másodpercig eltarthat, amíg felismeri a berakott lemezt, ilyenkor mindig legyünk türelemmel.</p></div><div class=paragraph><p>Néha a SCSI CD-meghajtó nem látható, mert nem volt elég ideje válaszolni busz újraindítása elõtt. Ha SCSI CD-meghajtónk van, akkor a következõ beállítást tegyük hozzá a rendszermagunk konfigurációjához és <a href=./#kernelconfig-building>fordítsuk újra a rendszermagukat</a>.</p></div><div class="literalblock programlisting"><div class=content><pre>options SCSI_DELAY=15000</pre></div></div><div class=paragraph><p>Ezzel utasítjuk a SCSI buszunkat egy 15 másodperces várakozásra a rendszer indítása során, és így ezzel elég esélyt adunk arra, hogy a CD-meghajtó válaszolni tudjon a busz újraindítása elõtt.</p></div></div><div class=sect3><h4 id=rawdata-cd>18.6.8. Nyers adat CD-k írása<a class=anchor href=#rawdata-cd></a></h4><div class=paragraph><p>Írhatunk közvetlenül is állományokat a CD-re, ISO 9660 formátumú állományrendszer használata nélkül. Sokan így oldják meg a mentést. Ezt sokkal gyorsabban lebonyolítható egy szabványos CD esetében:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># burncd -f /dev/acd1 -s 12 data archive.tar.gz fixate</span></code></pre></div></div><div class=paragraph><p>Az ezen a módon megírt CD-ket szintén nyers módon kell olvasnunk:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># tar xzvf /dev/acd1</span></code></pre></div></div><div class=paragraph><p>Az ilyen lemezeket nem tudjuk a normális CD-khez hasonlóan csatlakoztatni. Sõt, az ilyen CD-ket csak FreeBSD alatt tudjuk olvasni. Ha csatlakoztathatóvá akarjuk tenni a lemezt, vagy más operációs rendszerek alól is szeretnénk olvasni, akkor erre a célra a fentebb bemutatott <a href="https://man.freebsd.org/cgi/man.cgi?query=mkisofs&amp;sektion=8&amp;format=html">mkisofs(8)</a> parancsot kell használnunk.</p></div></div><div class=sect3><h4 id=atapicam>18.6.9. Az ATAPI/CAM meghajtó használata<a class=anchor href=#atapicam></a></h4><div class=paragraph><p>Ez a meghajtó lehetõvé teszi az ATAPI eszközök (CD-ROM, CD-RW, DVD meghajtók stb…​) számára, hogy a SCSI alrendszeren keresztül legyenek elérhetõek, így esetünkben is használhatóvá válnak olyan alkalmazások, mint például <a class=package href=https://cgit.freebsd.org/ports/tree/sysutils/cdrdao/>sysutils/cdrdao</a> vagy a <a href="https://man.freebsd.org/cgi/man.cgi?query=cdrecord&amp;sektion=1&amp;format=html">cdrecord(1)</a>.</p></div><div class=paragraph><p>A meghajtó használatához a következõ sort kell a <span class=filename>/boot/loader.conf</span> állományba illeszteni:</p></div><div class="literalblock programlisting"><div class=content><pre>atapicam_load=&#34;YES&#34;</pre></div></div><div class=paragraph><p>Indítsuk újra a számítógépet.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Amennyiben a rendszermagban az <a href="https://man.freebsd.org/cgi/man.cgi?query=atapicam&amp;sektion=4&amp;format=html">atapicam(4)</a> statikus támogatását szeretnénk használni, úgy a következõ sort kell a rendszermag konfigurációs állományába felvenni:</p></div><div class="literalblock programlisting"><div class=content><pre>device atapicam</pre></div></div><div class=paragraph><p>Továbbá a következõ sorokra lesz még szükségünk:</p></div><div class="literalblock programlisting"><div class=content><pre>device ata
device scbus
device cd
device pass</pre></div></div><div class=paragraph><p>Ezeknek már eleve ott kell szerepelnie. Ezután fordítsuk újra és telepítsük a rendszermagot, majd indítsuk újra a számítógépet.</p></div></td></tr></tbody></table></div><div class=paragraph><p>A rendszer indulásakor az írónak ehhez hasonló módon kell megjelennie:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>acd0: CD-RW &lt;MATSHITA CD-RW/DVD-ROM UJDA740&gt; at ata1-master PIO4
cd0 at ata1 bus 0 target 0 lun 0
cd0: &lt;MATSHITA CDRW/DVD UJDA740 1.00&gt; Removable CD-ROM SCSI-0 device
cd0: 16.000MB/s transfers
cd0: Attempt to query device size failed: NOT READY, Medium not present - tray closed</code></pre></div></div><div class=paragraph><p>A meghajtó most már elérhetõ a <span class=filename>/dev/cd0</span> eszközön keresztül, és például ennyi begépelésével csatlakoztatni tudunk róla egy CD-t a <span class=filename>/mnt</span> könyvtárba:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># mount -t cd9660 /dev/cd0 /mnt</span></code></pre></div></div><div class=paragraph><p><code>root</code> felhasználóként a következõ paranccsal tudjuk lekérdezi az író SCSI címét:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># camcontrol devlist</span>
&lt;MATSHITA CDRW/DVD UJDA740 1.00&gt;   at scbus1 target 0 lun 0 <span class=o>(</span>pass0,cd0<span class=o>)</span></code></pre></div></div><div class=paragraph><p>Eszerint a <code>1,0,0</code> lesz az eszköz SCSI címe, amelyet a <a href="https://man.freebsd.org/cgi/man.cgi?query=cdrecord&amp;sektion=1&amp;format=html">cdrecord(1)</a> és más SCSI alkalmazások esetén adunk meg.</p></div><div class=paragraph><p>Az ATAPI/CAM és SCSI rendszerek tekintetében olvassuk el az <a href="https://man.freebsd.org/cgi/man.cgi?query=atapicam&amp;sektion=4&amp;format=html">atapicam(4)</a> és <a href="https://man.freebsd.org/cgi/man.cgi?query=cam&amp;sektion=4&amp;format=html">cam(4)</a> man oldalakat.</p></div></div></div><div class=sect2><h3 id=creating-dvds>18.7. Lézeres tárolóeszközök (DVD-k) létrehozása és használata<a class=anchor href=#creating-dvds></a></h3><div class=sect3><h4 id=_bevezetés_4>18.7.1. Bevezetés<a class=anchor href=#_bevezetés_4></a></h4><div class=paragraph><p>A DVD a CD-hez képest a lézeres tárolóeszközök technológiájának újabb generációját képviseli. A DVD bármelyik CD-nél több adatot képes tárolni és napjaink ez a videók kiadásának szabványa.</p></div><div class=paragraph><p>Öt fizikailag írható formátummal határozhatjuk meg az írható DVD fogalmát:</p></div><div class=ulist><ul><li><p>DVD-R: Ez volt az elsõ elérhetõ írható DVD formátum. A DVD-R szabványát a <a href=http://www.dvdforum.com/forum.shtml>DVD Fórum</a> fektette le. Ez a formátum csak egyszer írható.</p></li><li><p>DVD-RW: Ez a DVD-R szabvány újraírható változata. A DVD-RW körülbelül 1000 alkalommal írható újra.</p></li><li><p>DVD-RAM: Ez is a DVD Fórum által támogatott újraírható formátum. A DVD-RAM cserélhetõ merevlemeznek látzsik. Azonban ez típusú adathordozó nem kompatibilis legtöbb DVD-ROM hajtóval és DVD-Video lejátszóval. Csupán csak néhány DVD-író ismeri a DVD-RAM formátumot. A DVD-RAM használatáról a <a href=#creating-dvd-ram>A DVD-RAM használata</a>ban találunk bõvebben információkat.</p></li><li><p>DVD+RW: Ezt az újraírható formátumot a <a href=http://www.dvdrw.com/>DVD+RW szövetség</a> alkotta meg. A DVD+RW lemezek nagyjából 1000 alkalommal írhatóak újra.</p></li><li><p>DVD+R: Ez a formátum a DVD+RW formátum egyszer írható változata.</p></li></ul></div><div class=paragraph><p>Az egyrétegû írható DVD-k összesen 4 700 000 000 byte-ot képesek rögzíteni, ami 4,38 GB vagy 4 485 MB (1 kilobyte itt 1024 byte).</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Meg kell különböztetnünk fizikai tárolóeszközt és az alkalmazást. Például a DVD-Video állományok olyan jellegû elrendezését írja elõ, ami bármelyik írható fizikai DVD eszközön megjelenhet: DVD-R, DVD+R, DVD-RW stb. Mielõtt kiválasztanánk az eszköz típusát, biztosnak kell lennünk benne, hogy az író és a DVD-Video lejátszó (ez lehet egy önálló lejátszó vagy egy számítógép DVD-ROM meghajtója) kompatibilis a szóbanforgó lemezzel.</p></div></td></tr></tbody></table></div></div><div class=sect3><h4 id=_beállítás_2>18.7.2. Beállítás<a class=anchor href=#_beállítás_2></a></h4><div class=paragraph><p>A <a href="https://man.freebsd.org/cgi/man.cgi?query=growisofs&amp;sektion=1&amp;format=html">growisofs(1)</a> programot fogjuk a DVD rögzítésére használni. Ez a program a dvd+rw-tools segédprogramok (<a class=package href=https://cgit.freebsd.org/ports/tree/sysutils/dvd+rw-tools/>sysutils/dvd+rw-tools</a>) gyûjteményének része. A dvd+rw-tools az összes DVD médium típusát ismeri.</p></div><div class=paragraph><p>Ezek a segédprogramok a SCSI alrendszeren keresztül érik az eszközöket, ezért a használhatukhoz a rendszermagban szükségünk lesz az <a href=#atapicam>ATAPI/CAM támogatásra</a>. Ha az írónk USB felületen csatlakozik, akkor mindez szükségtelen, és ehelyett a <a href=#usb-disks>USB tárolóeszközök</a>t kell elolvasnunk az USB eszközök beállításához.</p></div><div class=paragraph><p>Engedélyeznünk kell az ATAPI eszközök DMA hozzáférését is, amit a <span class=filename>/boot/loader.conf</span> állományban a következõ sor hozzáadásával tudunk megtenni:</p></div><div class="literalblock programlisting"><div class=content><pre>hw.ata.atapi_dma=&#34;1&#34;</pre></div></div><div class=paragraph><p>A dvd+rw-tools használatának megkezdése elõtt a DVD-írónkkal kapcsolatban érdemes átolvasnunk a <a href=http://fy.chalmers.se/~appro/linux/DVD+RW/hcn.html>dvd+rw-tools hardverkompatibilitási jegyzeteit (angolul)</a>.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Ha grafikus felületet szeretnénk használni, akkor érdemes egy pillanatást vetnünk a K3bre (<a class=package href=https://cgit.freebsd.org/ports/tree/sysutils/k3b/>sysutils/k3b</a>), amely egy felhasználóbarát felületet ad a <a href="https://man.freebsd.org/cgi/man.cgi?query=growisofs&amp;sektion=1&amp;format=html">growisofs(1)</a> és sok más íróprogram felé.</p></div></td></tr></tbody></table></div></div><div class=sect3><h4 id=_adat_dvd_k_írása>18.7.3. Adat DVD-k írása<a class=anchor href=#_adat_dvd_k_írása></a></h4><div class=paragraph><p>A <a href="https://man.freebsd.org/cgi/man.cgi?query=growisofs&amp;sektion=1&amp;format=html">growisofs(1)</a> a <a href=#mkisofs>mkisofs</a> parancs elõlapja, tehát az állományrendszer létrehozásához a <a href="https://man.freebsd.org/cgi/man.cgi?query=mkisofs&amp;sektion=8&amp;format=html">mkisofs(8)</a> programot fogja meghívni és ezt írja fel a DVD-re. Ez azt jelenti, hogy az írási folyamat megkezdése elõtt nem kell semmilyen image-et létrehoznunk.</p></div><div class=paragraph><p>A <span class=filename>/az/elérési/út</span> könyvtárból a következõ paranccsal tudjuk kiírni az adatokat DVD+R vagy DVD-R lemezre:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># growisofs -dvd-compat -Z /dev/cd0 -J -R /az/elérési/út</span></code></pre></div></div><div class=paragraph><p>A <code>-J -R</code> beállítások a <a href="https://man.freebsd.org/cgi/man.cgi?query=mkisofs&amp;sektion=8&amp;format=html">mkisofs(8)</a> programhoz kerülnek át az állományrendszer létrehozásakor (itt most egy ISO 9660 állományrendszert hozunk létre, Joliet és Rock Ridge kiterjesztésekkel), használatának részleteit lásd <a href="https://man.freebsd.org/cgi/man.cgi?query=mkisofs&amp;sektion=8&amp;format=html">mkisofs(8)</a>.</p></div><div class=paragraph><p>A <code>-Z</code> beállítást a kezdõmenetek létrehozásakor használjuk: több menetben akarjuk írni a lemezt vagy sem. A DVD eszközt, amely itt most a <em>/dev/cd0</em>, a saját konfigurációnknak megfelelõen kell megadni. A <code>-dvd-compat</code> paraméterrel lezárjuk a lemezt, így ezután további írás már nem lehetséges. Ezért cserébe jobb kompatibilitást kapunk a DVD-ROM meghajtókkal.</p></div><div class=paragraph><p>Elõre legyártott image-dzsel is dolgozhatunk, tehát például, ha az <em>image.iso</em> állományt akarjuk kiírni, akkor ezt kell lefuttatnunk:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># growisofs -dvd-compat -Z /dev/cd0=image.iso</span></code></pre></div></div><div class=paragraph><p>Az írási sebességet magától beállítja a lemez és meghajtó képességeinek megfelelõen. Az írási sebesség felülbírálásához használjuk a <code>-speed=</code> paramétert. A paraméterek lehetõségeirõl a <a href="https://man.freebsd.org/cgi/man.cgi?query=growisofs&amp;sektion=1&amp;format=html">growisofs(1)</a> man oldaláról tudhatunk meg többet.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>4,38 GB-nál több adat írásához egy hibrid UDF/ISO-9660 típusú állományrendszert kell létrehoznunk. Ezt úgy tudjuk elérni, ha <a href="https://man.freebsd.org/cgi/man.cgi?query=mkisofs&amp;sektion=8&amp;format=html">mkisofs(8)</a> és a többi hasonló program (például <a href="https://man.freebsd.org/cgi/man.cgi?query=growisofs&amp;sektion=1&amp;format=html">growisofs(1)</a>) hívásakor még hozzátesszük az <code>-udf -iso-level 3</code> paramétereket. Ezekre csak lemezképek készítésekor vagy az állományok közvetlen lemezre írásakor van szükségünk. Az így létrehozott lemezeket a <a href="https://man.freebsd.org/cgi/man.cgi?query=mount_udf&amp;sektion=8&amp;format=html">mount_udf(8)</a> segédprogram segítségével UDF állományrendszerként tudjuk csatlakoztatni. Ezért csak olyan operációs rendszereken használható, amelyek ismerik ezt a formátumot, ellenkezõ esetben csak hibás állományokat fogunk látni a lemezen.</p></div><div class=paragraph><p>Példa ilyen lemezkép létrehozására:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># growisofs -dvd-compat -udf -iso-level 3 -Z /dev/cd0 -J -R /az/új/adat/helye</span></code></pre></div></div><div class=paragraph><p>Ha a lemezkép már eleve nagyobb méretû állományokat tartalmaz, a lemez írásakor a <a href="https://man.freebsd.org/cgi/man.cgi?query=growisofs&amp;sektion=1&amp;format=html">growisofs(1)</a> programnak már nem kell további paramétereket átadnunk.</p></div><div class=paragraph><p>Lehetõleg mindig a <a class=package href=https://cgit.freebsd.org/ports/tree/sysutils/cdrtools/>sysutils/cdrtools</a> legfrissebb verzióját használjuk (amely a <a href="https://man.freebsd.org/cgi/man.cgi?query=mkisofs&amp;sektion=8&amp;format=html">mkisofs(8)</a> programot is tartalmazza), mivel a régebbi verziók nem támogatják a nagyobb méretû állományokat. Ha problémák adódnak a programok használata során, akkor próbálkozzunk a fejlesztõi változattal (<a class=package href=https://cgit.freebsd.org/ports/tree/sysutils/cdrtools-devel/>sysutils/cdrtools-devel</a>) és olvassuk el a <a href="https://man.freebsd.org/cgi/man.cgi?query=mkisofs&amp;sektion=8&amp;format=html">mkisofs(8)</a> man oldalát.</p></div></td></tr></tbody></table></div></div><div class=sect3><h4 id=_dvd_video_írása>18.7.4. DVD-Video írása<a class=anchor href=#_dvd_video_írása></a></h4><div class=paragraph><p>A DVD-Video az állományok speciális szervezésére utal, amely az ISO 9660 és az mikró UDF (M-UDF) specifikációkon alapszik. A DVD-Video emellett egy adott adatszerkezeti hierarchiát is takar, ezért kell egy külön programmal, például a <a class=package href=https://cgit.freebsd.org/ports/tree/multimedia/dvdauthor/>multimedia/dvdauthor</a> segítségével összeállítani egy DVD-t.</p></div><div class=paragraph><p>Ha már a birtokunkban van egy DVD-Video állományrendszer képe, akkor az eddigiek szerint egyszerûen csak írjuk fel egy lemezre, ahogy azt az elõzõ szakaszban is láthattuk. Ha összeállítottuk a DVD anyagát és például a <span class=filename>/a/videó/elérési/útja</span> könyvtárba raktuk, akkor a következõ paranccsal írathatjuk ki a DVD-Video formátumú lemezt:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># growisofs -Z /dev/cd0 -dvd-video /a/videó/elérési/útja</span></code></pre></div></div><div class=paragraph><p>A <code>-dvd-video</code> paramétert kell átadni a <a href="https://man.freebsd.org/cgi/man.cgi?query=mkisofs&amp;sektion=8&amp;format=html">mkisofs(8)</a> programnak, amelynek hatására létrehoz egy DVD-Video formátumú állományrendszert. Emellett a <code>-dvd-video</code> beállítás maga után vonja a <a href="https://man.freebsd.org/cgi/man.cgi?query=growisofs&amp;sektion=1&amp;format=html">growisofs(1)</a> <code>-dvd-compat</code> beállítását is.</p></div></div><div class=sect3><h4 id=_a_dvdrw_használata>18.7.5. A DVD+RW használata<a class=anchor href=#_a_dvdrw_használata></a></h4><div class=paragraph><p>Eltérõen a CD-RW-tõl, egy érintetlen DVD+RW-t az elsõ használat elõtt meg kell formázni. A <a href="https://man.freebsd.org/cgi/man.cgi?query=growisofs&amp;sektion=1&amp;format=html">growisofs(1)</a> program errõl az elsõ adandó alkalommal gondoskodik, és ez az <em>ajánlott</em>. Azonban a DVD+RW formázására használhatjuk a <code>dvd+rw-format</code> parancsot is:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># dvd+rw-format /dev/cd0</span></code></pre></div></div><div class=paragraph><p>Ezt a mûveletet csak egyszer kell elvégezni, hiszen ne feledjük, hogy csak a szûz DVD+RW lemezeket kell megformázni. Ezután a DVD+RW-t a korábbi szakaszoknak megfelelõen tudjuk írni.</p></div><div class=paragraph><p>Ha a DVD+RW-re új adatot akarunk írni (egy teljesen új állományrendszert, nem pedig adatokat hozzáfûzni), akkor nem kell üressé tenni a lemezt, egyszerûen csak elegendõ felülírni az elõzõeket (egy új kezdõmenet létrehozásával) valahogy így:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># growisofs -Z /dev/cd0 -J -R /az/új/adat/helye</span></code></pre></div></div><div class=paragraph><p>A DVD+RW formátum felajánlja annak lehetõségét is, hogy könnyedén hozzá lehessen fûzni adatokat az elõzõ íráshoz. A mûvelet során az új menetet összefûzi a meglévõvel, tehát ez nem egy többmenetes írás, hanem a <a href="https://man.freebsd.org/cgi/man.cgi?query=growisofs&amp;sektion=1&amp;format=html">growisofs(1)</a> <em>megnöveli</em> a lemezen található ISO 9660 állományrendszert.</p></div><div class=paragraph><p>Például, ha egy korábban megírt DVD+RW lemezen levõ adatokhoz akarunk hozzáírni, akkor a következõ parancsot kell kiadnunk:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># growisofs -M /dev/cd0 -J -R /az/új/adat/helye</span></code></pre></div></div><div class=paragraph><p>A <a href="https://man.freebsd.org/cgi/man.cgi?query=mkisofs&amp;sektion=8&amp;format=html">mkisofs(8)</a> beállításainál a kezõmenetnél megadottakat érdemes ismét megadni.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Ha kompatibilisek akarunk maradni a többi DVD-meghajtóval, akkor adjuk meg <code>-dvd-compat</code> paramétert. Ez a DVD+RW esetében annyit jelent, hogy nem tudunk további adatokat hozzáfûzni.</p></div></td></tr></tbody></table></div><div class=paragraph><p>Ha valamilyen okból mégis üressé szeretnénk tenni a lemez, akkor ír járhatunk el:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># growisofs -Z /dev/cd0=/dev/zero</span></code></pre></div></div></div><div class=sect3><h4 id=_a_dvd_rw_használata>18.7.6. A DVD-RW használata<a class=anchor href=#_a_dvd_rw_használata></a></h4><div class=paragraph><p>A DVD-RW két lemezformátumot fogad el: a inkrementális soros hozzáférést és a korlátozott felülírást. Alapértelmezés szerint a DVD-RW lemezek soros elérésûek.</p></div><div class=paragraph><p>A még fel nem használt DVD-RW lemezek közvetlenül írhatóak külön formázás nélkül, habár a korábban már soros formátumban használt DVD-RW lemezeket egy új kezdõmenet létrehozása elõtt üressé kell tenni.</p></div><div class=paragraph><p>Soros módban így kell letörölni egy DVD-RW lemezt:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># dvd+rw-format -blank=full /dev/cd0</span></code></pre></div></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>A teljes törlés (<code>-blank=full</code>) egy 1x média esetén körülbelül egy órát vesz igénybe. A <code>-blank</code> beállítással egy gyorsított törlés zajlik le, amennyiben a DVD-RW lemezt Disk-At-Once (DAO) módban írjuk. A DVD-RW lemezeket az alábbi paranccsal tudjuk DAO módban írni:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># growisofs -use-the-force-luke=dao -Z /dev/cd0=image.iso</span></code></pre></div></div><div class=paragraph><p>A <code>-use-the-force-luke=dao</code> beállítást nem kötelezõ megadni, mivel a <a href="https://man.freebsd.org/cgi/man.cgi?query=growisofs&amp;sektion=1&amp;format=html">growisofs(1)</a> igyekszik a lehetõ leggyorsabban törölni a lemezt és megkezdeni a DAO módú írást.</p></div><div class=paragraph><p>A DVD-RW esetében valójában a korlátozott felülírást lenne érdemes használnunk, mivel ez a formátum sokkal rugalmasabb az alapértelmezés szerint felkínált inkrementális soros elérésnél.</p></div></td></tr></tbody></table></div><div class=paragraph><p>A soros DVD-RW lemezekre ugyanúgy tudunk adatokat rögzíteni, mint az összes többi formátum esetében:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># growisofs -Z /dev/cd0 -J -R /az/adat/helye</span></code></pre></div></div><div class=paragraph><p>Ha az elõzõ íráshoz akarunk még hozzáfûzni adatokat, akkor ehhez a <a href="https://man.freebsd.org/cgi/man.cgi?query=growisofs&amp;sektion=1&amp;format=html">growisofs(1)</a> <code>-M</code> beállítását kell használnunk. Azonban ha a DVD-RW lemezhet inkrementális soros módban adunk hozzá adatot, akkor ezzel egy új menetet hozunk létre a lemezen és így egy többmenetes lemezt kapunk.</p></div><div class=paragraph><p>A korlátozott felülírású DVD-RW formátum használata esetén nem kell mindegyik kezdõmenet elõtt törölni a lemezt, egyszerûen csak felül kell írni a <code>-Z</code> beállítással, hasonlóan a DVD+RW esetéhez. A DVD+RW <code>-M</code> beállításához hasonlóan lehetõségünk van a lemezen található ISO 9660 formátumú állományrendszer növelésére. Ennek az eredménye egy egymenetes DVD.</p></div><div class=paragraph><p>A következõ paranccsal tudjuk a DVD-RW lemezt korlátozott felülírású módba tenni:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># dvd+rw-format /dev/cd0</span></code></pre></div></div><div class=paragraph><p>Így tudunk visszaváltani a soros formátum használatára:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># dvd+rw-format -blank=full /dev/cd0</span></code></pre></div></div></div><div class=sect3><h4 id=_több_menet_használata>18.7.7. Több menet használata<a class=anchor href=#_több_menet_használata></a></h4><div class=paragraph><p>Nagyon kevés DVD-ROM meghajtó ismeri a többmenetes DVD-ket, és legtöbbször is csak általában az elsõ menetet olvassák. A DVD+R, DVD-R és DVD-RW formátumok soros formátumban képesek több mentetet is befogadni, viszont a DVD+RW és DVD-RW korlátozott felülírású formátuma esetén nem létezik több menet.</p></div><div class=paragraph><p>Az alábbi parancs egy újabb menetet ad hozzá egy megkezdett (le nem zárt) DVD+R, DVD-R vagy DVD-RW soros formátumú lemezhez:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># growisofs -M /dev/cd0 -J -R /az/új/adat/helye</span></code></pre></div></div><div class=paragraph><p>Ha ezt a parancsot egy korlátozott felülírású DVD+RW vagy DVD-RW lemez esetén adjuk ki, akkor az új adatokat úgy fûzi hozzá, hogy egy új menetet összefésüli a meglévõvel. Ezzel egy egymenetes lemez keletkezik. Ilyenkor így bõvítik a megkezdett lemezeket.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>A menetek kezdése és befejezése általában felhasznál valamennyi helyet a lemezen. Ezért úgy tudjuk optimalizálni a lemez helykihasználtságát, hogy kevés menetben sok adatot viszünk fel rá. A DVD+R esetén 154, a DVD-R-nél körülbelül 2000, és a dupla rétegû DVD+R lemezeknél 127 menetet tudunk létrehozni.</p></div></td></tr></tbody></table></div></div><div class=sect3><h4 id=_további_olvasnivalók>18.7.8. További olvasnivalók<a class=anchor href=#_további_olvasnivalók></a></h4><div class=paragraph><p>A DVD lemezrõl részletesebb információkat a <code>dvd+rw-mediainfo /dev/cd0</code> parancs kiadásával tudunk lekérdezni.</p></div><div class=paragraph><p>A dvd+rw-tools használatáról a <a href="https://man.freebsd.org/cgi/man.cgi?query=growisofs&amp;sektion=1&amp;format=html">growisofs(1)</a> man oldalon találunk információt, valamint a <a href=http://fy.chalmers.se/~appro/linux/DVD+RW/>dvd+rw-tools honlapján (angolul)</a> és a <a href=http://lists.debian.org/cdwrite/>cdwrite levelezési lista</a> archívumaiban (angolul).</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Futassuk <code>dvd+rw-mediainfo</code> parancsot minden olyan esetben, amikor gondunk akad valamilyen lemez írásával. A kimenete nélkül szinte lehetetlen segítenünk bárkinek is.</p></div></td></tr></tbody></table></div></div><div class=sect3><h4 id=creating-dvd-ram>18.7.9. A DVD-RAM használata<a class=anchor href=#creating-dvd-ram></a></h4><div class=sect4><h5 id=_beállítás_3>18.7.9.1. Beállítás<a class=anchor href=#_beállítás_3></a></h5><div class=paragraph><p>A DVD-RAM írók SCSI vagy ATAPI csatolófelülettel rendelkeznek. Az ATAPI eszközök esetén engedélyezni kell a DMA elérését, amit a <span class=filename>/boot/loader.conf</span> állományban az alábbi sor hozzáadásával tudunk megtenni:</p></div><div class="literalblock programlisting"><div class=content><pre>hw.ata.atapi_dma=&#34;1&#34;</pre></div></div></div><div class=sect4><h5 id=_a_lemez_elõkészítése>18.7.9.2. A lemez elõkészítése<a class=anchor href=#_a_lemez_elõkészítése></a></h5><div class=paragraph><p>Ahogy arra már korábban utaltunk a fejezet bevezetésében, a DVD-RAM úgy látható, mint egy cserélhetõ merevlemez. A hagyományos merevlemezekhez hasonlóan a DVD-RAM-ot is "elõ kell készíteni" az elsõ használatához. Ebben a példában a lemez teljes területét egy szabványos UFS2 állományrendszerrel töltjük fel:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># dd if=/dev/zero of=/dev/acd0 bs=2k count=1</span>
<span class=c># bsdlabel -Bw acd0</span>
<span class=c># newfs /dev/acd0</span></code></pre></div></div><div class=paragraph><p>A DVD eszköz nevét, vagyis az <span class=filename>acd0</span> eszközt a saját rendszerünknek megfelelõen kell módosítani.</p></div></div><div class=sect4><h5 id=_a_lemez_használata>18.7.9.3. A lemez használata<a class=anchor href=#_a_lemez_használata></a></h5><div class=paragraph><p>Miután az elõbbi mûveletet elvégeztük a DVD-RAM lemezen, már tudjuk is normális merevlemezként csatlakoztatni:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># mount /dev/acd0 /mnt</span></code></pre></div></div><div class=paragraph><p>Ezt követõen a DVD-RAM egyaránt olvasható és írható.</p></div></div></div></div><div class=sect2><h3 id=floppies>18.8. Hajlékonylemezek létrehozása és használata<a class=anchor href=#floppies></a></h3><div class=paragraph><p>Néha hasznos lehet, ha az adatokat floppy lemezeken tároljuk, például olyankor, amikor más cserélhetõ tárolóeszköz már nem jöhet számításba, vagy amikor kis mennyiségû adatot kell átvinnünk az egyik számítógéprõl a másikra.</p></div><div class=paragraph><p>Ebben a szakaszban bemutatjuk hogyan kell FreeBSD alatt floppy lemezeket használni. Elsõsorban a 3,5 colos DOS lemezek formázásával és használatával foglalkozik, de ezek fogalmak a többi hajlékonylemezes formátum esetében is hasonlóak.</p></div><div class=sect3><h4 id=_a_hajlékonylemezek_formázása>18.8.1. A hajlékonylemezek formázása<a class=anchor href=#_a_hajlékonylemezek_formázása></a></h4><div class=sect4><h5 id=_az_eszköz>18.8.1.1. Az eszköz<a class=anchor href=#_az_eszköz></a></h5><div class=paragraph><p>A floppy lemezek a többi eszközhöz hasonlóan a <span class=filename>/dev</span> könyvtárban érhetõek el. A nyers floppy lemezek eléréséhez egyszerûen csak használjuk a <span class=filename>/dev/fdN</span> hivatkozást.</p></div></div><div class=sect4><h5 id=_a_formázás>18.8.1.2. A formázás<a class=anchor href=#_a_formázás></a></h5><div class=paragraph><p>Használat elõtt a floppy lemezeket alacsony szinten meg kell formázni. Ezt általában maga a gyártó végzi el, de a formázás gyakran hasznos lehet a lemez sértetlenségének ellenõrzésére. A legtöbb floppy lemez hivatalos kapacitása 1440 KB, de használhatjuk nagyobb (és kisebb) méretekben is.</p></div><div class=paragraph><p>A floppy lemezek alacsony szintû formázására az <a href="https://man.freebsd.org/cgi/man.cgi?query=fdformat&amp;sektion=1&amp;format=html">fdformat(1)</a> parancsot használhatjuk. Ez a segédprogram paraméterként az eszköz nevét várja.</p></div><div class=paragraph><p>Figyeljünk a menetközben megjelenõ hibaüzenetekre, mivel ezek segítik eldönteni, hogy a lemez használható vagy sem.</p></div><div class=sect5><h6 id=_a_hajlékonylemezek_formázása_2>18.8.1.2.1. A hajlékonylemezek formázása<a class=anchor href=#_a_hajlékonylemezek_formázása_2></a></h6><div class=paragraph><p>A <span class=filename>/dev/fdN</span> eszközök segítségével tudunk megformázni egy floppy lemezt. Tegyünk be egy 3,5 colos floppy lemezt a meghajtóba, majd adjuk ki a következõ parancsot:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># /usr/sbin/fdformat -f 1440 /dev/fd0</span></code></pre></div></div></div></div></div><div class=sect3><h4 id=_a_lemez_címkézése>18.8.2. A lemez címkézése<a class=anchor href=#_a_lemez_címkézése></a></h4><div class=paragraph><p>Miután alacsony szinten formáztuk a lemezt, tennünk kell rá egy lemezcímkét is. Ez a lemezcímke késõbb meg fog semmisülni, de a rendszernek szüksége van rá, hogy pontosan meg tudja állapítani a lemez méretét és geometriáját.</p></div><div class=paragraph><p>Az új lemezcímke lefedi az egész lemezt, és tartalmazni fogja az összes információt a floppy geometriájáról. A lemezcímkék geometriaértékeit az <span class=filename>/etc/disktab</span> állományban találjuk meg felsorolva.</p></div><div class=paragraph><p>Most már futtathatjuk is a <a href="https://man.freebsd.org/cgi/man.cgi?query=bsdlabel&amp;sektion=8&amp;format=html">bsdlabel(8)</a> parancsot:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># /sbin/bsdlabel -B -w /dev/fd0 fd1440</span></code></pre></div></div></div><div class=sect3><h4 id=_az_állományrendszer>18.8.3. Az állományrendszer<a class=anchor href=#_az_állományrendszer></a></h4><div class=paragraph><p>A hajlékonylemez most már készen áll a magas szintû formázásra. Ennek során egy új állományrendszert teszünk rá, amelyet a FreeBSD képes írni és olvasni. Miután létrejött ez az új állományrendszer, a lemezcímke megsemmisül, így tehát ha újra meg akarjuk formázni a lemezt, akkor újra létre kell majd hoznunk a lemezcímkét.</p></div><div class=paragraph><p>A floppy állományrendszere lehet UFS vagy FAT. A FAT általánosságban véve jobb választás a floppy lemezek számára.</p></div><div class=paragraph><p>Az alábbi módon tudunk új állományrendszert tenni a floppyra:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># /sbin/newfs_msdos /dev/fd0</span></code></pre></div></div><div class=paragraph><p>A lemez most már készen áll a használatra.</p></div></div><div class=sect3><h4 id=_a_hajlékonylemezek_használata>18.8.4. A hajlékonylemezek használata<a class=anchor href=#_a_hajlékonylemezek_használata></a></h4><div class=paragraph><p>A floppy lemezt használatához a <a href="https://man.freebsd.org/cgi/man.cgi?query=mount_msdosfs&amp;sektion=8&amp;format=html">mount_msdosfs(8)</a> paranccsal kell csatlakoztatnunk. Ugyanerre a célra használhatjuk a Portgyûjteménybõl elérhetõ <a class=package href=https://cgit.freebsd.org/ports/tree/emulators/mtools/>emulators/mtools</a> portot is.</p></div></div></div><div class=sect2><h3 id=backups-tapebackups>18.9. Szalagok létrehozása és használata<a class=anchor href=#backups-tapebackups></a></h3><div class=paragraph><p>A legfontosabb szalagos adathordozók a 4 mm-es, 8 mm-es, QIC, a minikazettás és a DLT.</p></div><div class=sect3><h4 id=backups-tapebackups-4mm>18.9.1. 4 mm-es (Digitális adattároló, avagy DDS: Digital Data Storage)<a class=anchor href=#backups-tapebackups-4mm></a></h4><div class=paragraph><p>A 4 mm-es szalagok a QIC-szalagokat váltják fel a munkaállomások biztonsági mentésének eszközeként. Ez a tendencia csak tovább növekedett, ahogy a Conner felvásárolta az Archive-ot, a QIC típusú meghajtók legnagyobb gyártóját, majd leállított a QIC-meghajtók gyártását. A 4 mm-es meghajtók mérete kicsi és csendben is dolgoznak, de a megbízhatóság terén nem tudhatják maguknak mindazt a sikert, amit a 8 mm-es társaiknál könyvelhettünk el. A kazetták is sokkal olcsóbbak és kisebbek (3 x 2 x 0,5 col, ami 76 x 51 x 12 mm) a 8 mm-es kiadásénál. A 4 mm-es feje, hasonlóan a 8 mm-eséhez, valamilyen okból szintén viszonylag rövid ideig bírja, és mind a kettõ spirális pásztázást használ.</p></div><div class=paragraph><p>Ezeknél a meghajtóknál az adatátvitel nagyjából 150 KB/mp-nél kezdõdik és 500 KB/mp-nél végzõdik. Az adattárolási képességük 1,3 GB-tól indul és 2,0 GB-ig tart. A hardveres tömörítés, ami a legtöbb ilyen típusú meghajtónál elérhetõ, közel megduplázza a kapacitást. A többmeghajtós szalagos könyvtár egységek egyetlen szekrényben 6 meghajtót képes befogadni, a szalagok automatikus cserélgetésével. Az ilyen könyvtárak kapacitása a 240 GB-ot is elérheti.</p></div><div class=paragraph><p>A DDS-3 szabvány most már akár 12 GB (vagy tömörítve 24 GB) kapacitást is elérhetõvé tesz.</p></div><div class=paragraph><p>A 4 mm-es meghajtók, hasonlóan a 8 mm-es meghajtókhoz, spirális pásztázást alkalmaznak. A spirális pásztázás összes elõnye és hátránya ezért egyaránt él a 4 mm-es és 8 mm-es meghajtók esetén.</p></div><div class=paragraph><p>A szalagok 2 000 menet vagy 100 teljes mentes után kopnak el.</p></div></div><div class=sect3><h4 id=backups-tapebackups-8mm>18.9.2. 8 mm-es (Exabyte)<a class=anchor href=#backups-tapebackups-8mm></a></h4><div class=paragraph><p>A 8 mm-es szalagok a legelterjedtebb szalagos SCSI-meghajtók. A szalagok használatára ez a legjobb választás. Szinte mindegyik rendszerben egy 2 GB-os 8 mm-es Exabyte szalagos meghajtót használnak. A 8 mm-es meghajtók megbízhatóak, kényelmesek és csendesek. A kazetták olcsók és kicsik (4,8 x 3,3 x 0,6 col, azaz 122 x 84 x 15 mm). A 8 mm-es szalagok feje viszonylag csak rövid ideig bírja a szalag nagy mértékû oda-vissza mozgása miatt.</p></div><div class=paragraph><p>Az adatátvitel sebessége 250 KB/mp-tõl 500 KB/mp-ig terjed, valamint a 300 MB-tól egészen 7 GB-os méretig találkozhatunk velük. A meghajtókban elérhetõ hardveres tömörítés képes közel megduplázni a kapacitást. Ezek a meghajtók önálló egységként is beszerezhetõek vagy egy 6 egységbõl álló és 120 szalagos szalagos könyvtár részeként. Ezek az egységek önállóan váltják a szalagokat. Az ilyen könyvtárak kapacitása eléri a közel 840 GB-ot.</p></div><div class=paragraph><p>Az Exabyte "Mammoth" modellje szalagonként 12 GB (tömörítéssel pedig 24 GB) adatot képes tárolni, viszont a hagyományos szalagos meghajtóknál nagyjából kétszer többe kerül.</p></div><div class=paragraph><p>Az adatok spirális pásztázással kerülnek a szalagra, és a fejek adott (nagyjából 6 fokos) szögben állnak a szalag felett. A szalag a fejeket tartó orsó köré tekeredik, körülbelül 270 fokban. Ennek eredményképpen nagyobb adatsûrûség és szorosan zárt sávok jönnek létre, ahogy ebben a szögben a fej eljut a szalag egyik élérõl a másikra.</p></div></div><div class=sect3><h4 id=backups-tapebackups-qic>18.9.3. QIC<a class=anchor href=#backups-tapebackups-qic></a></h4><div class=paragraph><p>A QIC-150 meghajtók és szalagok talán a legelterjedtebb szalagos egységek és adathordozók. A QIC szalagos meghajtók a legolcsóbb "komolynak tekinthetõ" biztonsági mentésre alkalmas meghajtók. Az olcsóság azonban megköveteli a maga árát. A QIC-szalagok a 4 és 8 mm-es szalagokkal szemben akár ötször is drágábbak lehetnek gigabyte-onként. De ha megelégszünk csupán féltucat szalaggal is, akkor a QIC jó vásárnak tûnhet. A QIC a <em>leginkább</em> elterjedtebb szalagos meghajtó. Minden rendszerben biztonsan találunk valamilyen minõségben QIC-meghajtót. A QIC fizikailag hasonló (és gyakran azonos) felépítésû szalagokat gyárt rengeteg különbözõ adatsûrûséggel. Az ilyenkor keletkezõ súrlódások miatt a QIC-meghajtók egyáltalán nem nevezhetõek csendesnek. Az ilyen típusú meghajtók az adatok rögzítése elõtt külön hangjelenség kíséretében keresik meg a megfelelõ pozíciót és tisztán hallható, ahogy olvasnak, írnak és keresnek. A QIC-szalagok mérete 6 x 4 x 0,7 col (avagy 152 x 102 x 17 mm).</p></div><div class=paragraph><p>Az adatátviteli sebesség nagyjából 150 KB/mp-tõl 500 KB/mp-ig terjedhet. A kapacitás szalagonként 40 MB és 15 GB között változhat. A legtöbb újabb QIC-meghajtó támogatja a hardveres tömörítést. QIC-meghajtókat azonban egyre kevésbé találhatunk, helyüket szépen lassan mindenhol átveszik a DAT-meghajtók.</p></div><div class=paragraph><p>A szalagokra sávokban rögzítik az adatokat. Ezek a sávok szalag felületének hosszanti tengelyén futnak az egyik végétõl a másikig. A sávok száma valamint a sávok vastagsága a szalagok kapacitásától függõen változnak. Ha nem is összes legújabb, de a legtöbb meghajtó legalább olvasás szintjén kompatibilis a régebbi típusokkal (de gyakran írásban is). A QIC híresen megbízható az adatbiztonság tekintetében (a mechanikája sokkal egyszerûbb és strapabíróbb a spirális pásztázással mûködõ meghajtókénál).</p></div><div class=paragraph><p>A szalagokat 5000 mentés után érdemes lecserélni.</p></div></div><div class=sect3><h4 id=backups-tapebackups-dlt>18.9.4. DLT<a class=anchor href=#backups-tapebackups-dlt></a></h4><div class=paragraph><p>A DLT rendelkezik a legnagyobb adatátviteli sebességgel az itt összefoglalt mezõnyben. A 1/2 colos (12,5 mm-es) szalag egy egyorsós tokban foglal helyet (mérete 4 x 4 x 1 col, azaz 100 x 100 x 25 mm). A tok egyik oldalán végig egy csúszó kapu található. A meghajtó ezt a kaput nyitja ki és ezen keresztül húzza be a szalagot. A szalag elején található egy ovális lyuk, amibe a meghajtó "bele tud akaszkodni". A feszítõ orsó a szalagos meghajtóban foglal helyet. Az összes többi szalag esetén (kivéve egyedül a 9 sávos szalagokat) mind a segéd- és feszítõ orsók magában a kazettában találhatóak.</p></div><div class=paragraph><p>Az adatátviteli sebessége megközelítõleg 1,5 MB/mp, tehát háromszor nagyobb bármelyik 4 mm-es, 8 mm-es vagy QIC-szalagos egységénél. Az adattároló képessége kazettánként 10 GB-tól 20 GB-ig terjedhet. A meghajtók egyaránt elérhetõek többkazettás, cserélgetõs és többkazettás, többmeghajtós könyvtárakban is, melyek 5 kazettától egészen 900 kazettáig, illetve 1 meghajtótól 20 meghajtóig képesek befogadni, így teljes tárterületük 50 GB-tól 9 TB-ig terjed.</p></div><div class=paragraph><p>A DLT Type V formátum tömörítéssel közel 70 GB-os kapacitást képes elérni.</p></div><div class=paragraph><p>A szalagra az adatok a haladási iránnyal párhuzamosan kerülnek fel (akárcsak a QIC-szalagok esetében). Egyszerre két sávot rögzít. A író/olvasó fejek élettartama viszonylag nagy. Ahogy a szalag megáll, a fej és a szalag között nincs szükség további relatív mozgásra.</p></div></div><div class=sect3><h4 id=_ait>18.9.5. AIT<a class=anchor href=#_ait></a></h4><div class=paragraph><p>Az AIT a Sony új formátuma, ami egészen 50 GB mennyiségû adatot képes tárolni (tömörítéssel) egyetlen szalagon. A szalagokat memóriachipekkel látják el, melyek a szalag tartalmát indexelik. Az indexek felhasználásával aztán a szalagos meghajtó villámgyorsan képes meghatározni a szalagon található állományok helyét, szemben az ilyenkor megszokott többperces mûvelettel. A SAMS:Alexandria és a hozzá hasonló szoftverek negyven vagy több AIT-szalagos könyvtárral is képesek egyszerre dolgozni, és közvetlenül a szalagok memóriájával veszik fel a kapcsolatot a tartalmuk megjelenítéséhez, a mentett állományok rendszerezéséhez, a helyes szalag megkereséséhez, betöltéséhez és visszatöltéséhez.</p></div><div class=paragraph><p>Az ilyen könyvtárak a 20 000 dolláros (kb. 3,5 millió forintos) árkategóriába tartoznak, ami miatt csak egy kicsivel csúsznak ki a hobbi kategóriából.</p></div></div><div class=sect3><h4 id=_az_új_szalagok_elsõ_használata>18.9.6. Az új szalagok elsõ használata<a class=anchor href=#_az_új_szalagok_elsõ_használata></a></h4><div class=paragraph><p>Amikor az elsõ alkalommal akarunk beolvasni vagy írni egy új, teljesen üres szalagot, hibára fogunk futni. Egy ehhez hasonló konzolüzenet fog megjelenni:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>sa0<span class=o>(</span>ncr1:4:0<span class=o>)</span>: NOT READY asc:4,1
sa0<span class=o>(</span>ncr1:4:0<span class=o>)</span>:  Logical unit is <span class=k>in </span>process of becoming ready</code></pre></div></div><div class=paragraph><p>A szalag nem tartalmaz azonosító blokkot (Identifier Block) a nulladik blokkban. A QIC-525 szabvány átvétele óta mindegyik QIC szalagos meghajtó létrehozza ezt az azonosító blokkot. Tehát két megoldás létezik:</p></div><div class=ulist><ul><li><p>Az <code>mt fsf 1</code> paranccsal felírunk egy ilyen azonosító blokkot a szalagra.</p></li><li><p>A meghajtó elõlapján található gomb segítségével dobassuk ki a szalagot.</p><div class=paragraph><p>Rakjuk vissza a szalagot és hajtsunk végre rajta egy <code>dump</code> parancsot.</p></div><div class=paragraph><p>A <code>dump</code> parancs erre egy <code>DUMP: End of tape detected</code> ("szalag vége") hibaüzenetet ad, majd a következõ jelenik meg a konzolon: <code>HARDWARE FAILURE info:280 asc:80,96</code>.</p></div><div class=paragraph><p>Tekertessük vissza a szalagot az <code>mt rewind</code> paranccsal.</p></div><div class=paragraph><p>A szalag következõ mûvelete most már sikeres lesz.</p></div></li></ul></div></div></div><div class=sect2><h3 id=backups-floppybackups>18.10. Biztonsági mentés hajlékonylemezekre<a class=anchor href=#backups-floppybackups></a></h3><div class=sect3><h4 id=floppies-using>18.10.1. Hajlékonylemezre is lehet biztonsági mentést készíteni?<a class=anchor href=#floppies-using></a></h4><div class=paragraph><p>A floppy lemezek nem igazán felelnek meg biztonsági mentés készítésére, mivel:</p></div><div class=ulist><ul><li><p>Nem megbízható adathordozók, különösen hosszabb idõre.</p></li><li><p>Esetükben a mentés és visszaállítás nagyon lassú.</p></li><li><p>Kapacitásuk erõsen korlátozott (annak már régen elmúlt az ideje, amikor egész merevlemezeket tudtunk lementeni egy tucat floppyra).</p></li></ul></div><div class=paragraph><p>Habár ha máshogy nem tudunk biztonsági mentést készíteni, akkor a floppy lemezekkel még mindig jobban járunk, mint nélkülük.</p></div><div class=paragraph><p>Ha már mindenképpen floppy lemezeket kell használnunk, akkor igyekezzünk minél jobb minõségûeket beszerezni. Tehát az olyan floppyk, amik már évek óta kavarognak az irodában, erre a célra nem éppen bizonyulnak a legjobb választásnak. Ideális esetben egy megbízható gyártótól származó új floppykat használunk.</p></div></div><div class=sect3><h4 id=floppies-creating>18.10.2. Tehát akkor hogyan mentsük az adatokat hajlékonylemezre?<a class=anchor href=#floppies-creating></a></h4><div class=paragraph><p>Legegyszerûbban a <a href="https://man.freebsd.org/cgi/man.cgi?query=tar&amp;sektion=1&amp;format=html">tar(1)</a> <code>-M</code> (többkötetes) opciójával tudunk floppy lemezre menteni, aminek használatával több floppyra kiterjedõ mentéseket is készíthetünk.</p></div><div class=paragraph><p>Az aktuális könyvtár és a benne levõ alkönyvtárak tartalmát (<code>root</code>) felhasználóként a következõ paranccsal tudjuk lementeni:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># tar Mcvf /dev/fd0 *</span></code></pre></div></div><div class=paragraph><p>Amikor az elsõ floppy megtelik, a <a href="https://man.freebsd.org/cgi/man.cgi?query=tar&amp;sektion=1&amp;format=html">tar(1)</a> kérni fogja a következõ kötetet (volume) (mivel a <a href="https://man.freebsd.org/cgi/man.cgi?query=tar&amp;sektion=1&amp;format=html">tar(1)</a> adathordozótól független módon hivatkozik a kötetekre, tehát ebben a környezetben a kötet egy floppy lemezt jelent):</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>Prepare volume <span class=c>#2 for /dev/fd0 and hit return:</span></code></pre></div></div><div class=paragraph><p>Az üzenet fordítása:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>Készítse elő a 2. kötetet a /dev/fd0 eszközön és nyomja le a
<span class=k>return </span>billentyűt</code></pre></div></div><div class=paragraph><p>A folyamat egészen addig ismétlõdik (a kötetek számának növekedésével), amíg az összes állomány lementésre nem kerül.</p></div></div><div class=sect3><h4 id=floppies-compress>18.10.3. Lehet tömöríteni a mentéseket?<a class=anchor href=#floppies-compress></a></h4><div class=paragraph><p>Sajnos a <a href="https://man.freebsd.org/cgi/man.cgi?query=tar&amp;sektion=1&amp;format=html">tar(1)</a> többkötetes mentések esetén nem engedi a <code>-z</code> beállítás használatát. Természetesen ettõl függetlenül a <a href="https://man.freebsd.org/cgi/man.cgi?query=gzip&amp;sektion=1&amp;format=html">gzip(1)</a> segítségével még be tudjuk tömöríteni az összes állományt, a <a href="https://man.freebsd.org/cgi/man.cgi?query=tar&amp;sektion=1&amp;format=html">tar(1)</a> paranccsal floppyra menteni ezeket, majd a <a href="https://man.freebsd.org/cgi/man.cgi?query=gunzip&amp;sektion=1&amp;format=html">gunzip(1)</a> paranccsal kitömöríteni.</p></div></div><div class=sect3><h4 id=floppies-restoring>18.10.4. Hogyan állítsuk vissza a biztonsági mentéseket?<a class=anchor href=#floppies-restoring></a></h4><div class=paragraph><p>Az egész mentés visszaállításához adjuk ki a következõ parancsot:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># tar Mxvf /dev/fd0</span></code></pre></div></div><div class=paragraph><p>Két módon tudunk csak bizonyos állományokat visszaállítani. Elõször is, tegyük be a mentés elsõ lemezét és adjuk ki a következõ parancsot:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># tar Mxvf /dev/fd0 állomány</span></code></pre></div></div><div class=paragraph><p>A <a href="https://man.freebsd.org/cgi/man.cgi?query=tar&amp;sektion=1&amp;format=html">tar(1)</a> segédprogram ezután sorban kérni fogja a többi lemezt egészen addig, amíg meg nem találja a keresett állományt.</p></div><div class=paragraph><p>Vagy ha pontosan tudjuk, hogy melyik lemezen található a keresett állomány, akkor az iménti parancs használatát azzal a lemezzel kezdjük. Vigyázzunk, mert ha a lemezen található elsõ állomány az elõzõ lemezen kezdõdik, akkor a <a href="https://man.freebsd.org/cgi/man.cgi?query=tar&amp;sektion=1&amp;format=html">tar(1)</a> figyelmeztetni fog minket, hogy nem állítja vissza még akkor sem, ha erre nem is kértük!</p></div></div></div><div class=sect2><h3 id=backup-strategies>18.11. Mentési stratégiák<a class=anchor href=#backup-strategies></a></h3><div class=paragraph><p>Egy biztonsági mentés kidolgozása során az elsõ követelmény gondoskodnunk az alábbi problémákról:</p></div><div class=ulist><ul><li><p>Lemezhiba</p></li><li><p>Az állományok véletlen törlése</p></li><li><p>Az állományok véletlenszerû károsodása</p></li><li><p>Számítógépek teljes megsemmisülése (például tûz által), belértve a közelében tárolt összes biztonsági mentést</p></li></ul></div><div class=paragraph><p>Tökéletesen megoldható, hogy egyes rendszerek a fentebb felsorolt problémák mindegyikét teljesen eltérõ technikával oldják meg. A nagyon személyes rendszerektõl és a nagyon értéktelen adatoktól eltekintve szinte egyértelmûen kizárt, hogy egyetlen technika képes lefedni az összes problémát.</p></div><div class=paragraph><p>Kelléktárunk néhány alapvetõ eszköze:</p></div><div class=ulist><ul><li><p>Az egész rendszer mentése, amit egy megbízható helyre elzárt, tartós adattárolóra készítünk. Ez tulajdonképpen védelmet biztosít a fentebb megemlített összes probléma esetében, de lassú és kényelmetlen róla visszaállítani az adatokat. A közelben és/vagy neten is tarthatunk errõl másolatokat, de még így is kényelmetlen az állományok visszaállítása, különösen az egyszerû felhasználók számára.</p></li><li><p>Pillanatképek készítése az állományrendszerrõl. Ez valójában csak olyan esetekben lehet a segítségünkre, amikor véletlenül töröltünk állományokat, ám ilyenkor <em>határozottan</em> jól jön, mivel igen gyorsan és könnyen lehet vele dolgozni.</p></li><li><p>Az egész állományrendszer és/vagy az összes lemez másolata (például az <a href="https://man.freebsd.org/cgi/man.cgi?query=rsync&amp;sektion=1&amp;format=html">rsync(1)</a> idõszakos alkalmazása a komplett gépre). Az általában az egyedi igényekkel bíró hálózatok esetében eshet a kezünkre. A lemezhiba ellen védelemben ez a megoldás általában a RAID alatt áll. A véletlenül törölt állományok visszaállításának tekintetében az UFS pillanatképeivel mérhetõ össze, de ez leginkább a saját igényeinktõl függ.</p></li><li><p>RAID alkalmazása. A lemezek meghibásodása esetén segíti minimalizálni vagy elkerülni a kiesést, ugyan gyakori lemezhibák árán (mivel ilyenkor több lemezt használunk) de kisebb sürgõsséggel.</p></li><li><p>Az állományok ujjlenyomatának ellenõrzése. Az <a href="https://man.freebsd.org/cgi/man.cgi?query=mtree&amp;sektion=8&amp;format=html">mtree(8)</a> segédprogram nagyon hasznos tud lenni ebben az esetben. Habár ez nem egy mentési technika, mégis segít megállapítani, hogy mikor kell nyugdíjba küldenünk a biztonsági mentéseinket. Ez különösen az aktív nem használt mentésekre vonatkozik, ezeket bizonyos idõ elteltével mindig érdemes ellenõrizni.</p></li></ul></div><div class=paragraph><p>Nagyon könnyû lenne további technikákat is felsorolni, melyek legtöbbje az iméntiek valamilyen kombinációja lenne. A speciális igények általában speciális technikákat eredményeznek (például egy éles adatbázis biztonsági mentése általában az adott adatbáziskezelõ rendszer közremûködését is elvárja). Mindig fontos tudni, hogy milyen veszélyek ellen védekezünk és hogyan kezeljük le ezeket.</p></div></div><div class=sect2><h3 id=backup-basics>18.12. Alapvetõ tudnivalók a biztonsági mentésrõl<a class=anchor href=#backup-basics></a></h3><div class=paragraph><p>A <a href="https://man.freebsd.org/cgi/man.cgi?query=dump&amp;sektion=8&amp;format=html">dump(8)</a>, <a href="https://man.freebsd.org/cgi/man.cgi?query=tar&amp;sektion=1&amp;format=html">tar(1)</a> és <a href="https://man.freebsd.org/cgi/man.cgi?query=cpio&amp;sektion=1&amp;format=html">cpio(1)</a> a három legfontosabb biztonsági mentésekkel kapcsolatos program.</p></div><div class=sect3><h4 id=_mentés_és_helyreállítás>18.12.1. Mentés és helyreállítás<a class=anchor href=#_mentés_és_helyreállítás></a></h4><div class=paragraph><p>A UNIX® típusú rendszerekben a biztonsági mentést hagyományosan a <code>dump</code> és <code>restore</code> programok végzik. A meghajtókat lemezblokkok összeségeként kezelik, az állományrendszerek által létrehozott állományok, linkek és könyvtárak szintje alatt. Eltérõen más, biztonsági mentést végzõ szoftverektõl, a <code>dump</code> az adott eszközön egy egész állományrendszert képes lementeni. Nem képes csak az állományrendszer vagy egy több állományrendszerre kiterjedõ könyvtárszerkezet egy részét lementeni. A <code>dump</code> nem állományokat és könyvtárakat ír a szalagra, hanem nyers adatblokkokat, amelyek állományokat és könyvtárakat formáznak. A <code>restore</code> parancs az adatokat alapértelmezés szerint a <span class=filename>/tmp</span> könyvtárba tömöríti ki. Ha nem lenne elegendõ helyünk a <span class=filename>/tmp</span> könyvtárban, akkor a <code>TMPDIR</code> környezeti változó átállításával ehelyett megadhatunk egy olyat, ahol már kellõ mennyiségû terület áll rendelkezésre a <code>restore</code> akadálytalan lefutásához.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Ha a <code>dump</code> parancsot a gyökér könyvtárban adjuk ki, akkor nem fogja lementeni a <span class=filename>/home</span> vagy <span class=filename>/usr</span> vagy bármilyen más könyvtárat, mivel ezek jellemzõ módon más állományrendszerek csatlakozási pontja vagy más állományrendszerekre mutató szimbolikus linkek.</p></div></td></tr></tbody></table></div><div class=paragraph><p>A <code>dump</code> parancsnak vannak olyan rigolyái, amelyek még az AT&amp;T UNIX 6. verziójából (1975 környékérõl) maradtak vissza. Az alapértelmezett paraméterezése 9 sávos szalagokat feltételezi (6250 bpi), nem pedig a napjainkban elterjedt nagy írássûrûsségû (egészen 62 182 ftpi-s) adathordozókat. Ezek az alapértelmezések természetesen paranccsorból felülbírálhatóak, és így a manapság alkalmazott szalagos meghajtók teljes kapacitása is kihasználható vele.</p></div><div class=paragraph><p>Emellett az <code>rdump</code> és <code>rrestore</code> programok segítségével hálózaton keresztül is le tudjuk menteni az adatainkat egy másik számítógépre csatlakoztatott szalagos egységre. Mind a két program az <a href="https://man.freebsd.org/cgi/man.cgi?query=rcmd&amp;sektion=3&amp;format=html">rcmd(3)</a> és a <a href="https://man.freebsd.org/cgi/man.cgi?query=ruserok&amp;sektion=3&amp;format=html">ruserok(3)</a> parancsokat használja a távoli szalagos meghajtó eléréséhez. Az <code>rdump</code> és <code>rrestore</code> paramétereinek a távoli számítógép használatához kell illeszkedniük. Amikor egy FreeBSD rendszerû számítógépet az <code>rdump</code> paranccsal egy Sun rendszerû, <code>komodo</code> nevû számítógépre mentünk, amelyhez egy Exabyte szalagos meghajtó csatlakozik, akkor ezt a írjuk be:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># /sbin/rdump 0dsbfu 54000 13000 126 komodo:/dev/nsa8 /dev/da0a 2&gt;&amp;1</span></code></pre></div></div><div class=paragraph><p>Figyelem: az <span class=filename>.rhosts</span> állományon keresztül hitelesítésnek megvannak a maga biztonsági kockázatai. Ne felejtsük el felmérni ezt a saját környezetünkben sem.</p></div><div class=paragraph><p>A <code>dump</code> és <code>restore</code> parancsokat az <code>ssh</code> használatával még biztonságosabbá tehetjük.</p></div><div class=exampleblock><div class=title>Példa 21. A <code>dump</code> használata az ssh alkalmazással</div><div class=content><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># /sbin/dump -0uan -f - /usr | gzip -2 | ssh -c blowfish \</span>
          célfelhasználó@cél.gép.hu <span class=nb>dd </span><span class=nv>of</span><span class=o>=</span>/nagyállományok/dump-usr-l0.gz</code></pre></div></div></div></div><div class=paragraph><p>Vagy az <code>RSH</code> környezeti változó megfelelõ beállításával használhatjuk a <code>dump</code> beépített módszerét:</p></div><div class=exampleblock><div class=title>Példa 22. A <code>dump</code> használata az ssh alkalmazással, az <code>RSH</code> környezeti változó beállításával</div><div class=content><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># RSH=/usr/bin/ssh /sbin/dump -0uan -f célfelhasználó@cél.gép.hu:/dev/sa0 /usr</span></code></pre></div></div></div></div></div><div class=sect3><h4 id=_tar>18.12.2. <code>tar</code><a class=anchor href=#_tar></a></h4><div class=paragraph><p>A <a href="https://man.freebsd.org/cgi/man.cgi?query=tar&amp;sektion=1&amp;format=html">tar(1)</a> is az AT&amp;T UNIX 6. verziójáig nyúlik vissza (tehát nagyjából 1975-ig). A <code>tar</code> az állományrendszerrel szoros együttmûködésben dolgozik, állományokat és könyvtárakat ír a szalagra. A <code>tar</code> ugyan nem ismeri a <a href="https://man.freebsd.org/cgi/man.cgi?query=cpio&amp;sektion=1&amp;format=html">cpio(1)</a> által felkínált összes lehetõséget, de nincs is szüksége olyan szokatlan paranccsoros összekapcsolásokra, mint a <code>cpio</code> parancsnak.</p></div><div class=paragraph><p>A FreeBSD 5.3 vagy késõbbi változataiban a GNU <code>tar</code> és az alapértelmezés szerinti <code>bsdtar</code> egyaránt elérhetõ. A GNU változat a <code>gtar</code> paranccsal hívható meg. Az <code>rdump</code> parancshoz hasonló felírásban képes kezelni a távoli eszközöket. Tehát így tudjuk használni a <code>tar</code> parancsot a <code>komodo</code> nevû Sun számítógép Exabíte szalagos meghajtójának elérésére:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># /usr/bin/gtar cf komodo:/dev/nsa8 . 2&gt;&amp;1</span></code></pre></div></div><div class=paragraph><p>Ugyanez eltérhetõ a <code>bsdtar</code> használatával is, amikor az <code>rsh</code> programmal összekapcsolva küldünk át a távoli szalagos egységre.</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># tar cf - . | rsh hálózati-név dd of=szalagos-eszköz obs=20b</span></code></pre></div></div><div class=paragraph><p>Ha a hálózaton keresztül mentés során fontos számunkra a biztonság, akkor az <code>rsh</code> parancs helyett az <code>ssh</code> parancsot használjuk.</p></div></div><div class=sect3><h4 id=_cpio>18.12.3. <code>cpio</code><a class=anchor href=#_cpio></a></h4><div class=paragraph><p>A <a href="https://man.freebsd.org/cgi/man.cgi?query=cpio&amp;sektion=1&amp;format=html">cpio(1)</a> eredetileg a UNIX® szalagos programjai és szalagos egységei között közvetített. A <code>cpio</code> parancs (többek közt) képes a byte-ok sorrendjének felcserélésére, több különbözõ archívum formátuma szerint írni és adatokat közvetíteni más programok felé. Ez utóbbi lehetõsége miatt a <code>cpio</code> kíválóan alkalmas a telepítõeszközök számára. A <code>cpio</code> nem képes bejárni a könyvtárszerkezetet, és az állományok listáját a szabványos bemeneten keresztül kell megadni neki.</p></div><div class=paragraph><p>A <code>cpio</code> nem támogatja a biztonsági mentés átküldését a hálózaton. Programok összekapcsolásával és az <code>rsh</code> használatával tudunk adatokat küldeni távoli szalagos meghajtókra.</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># for f in könyvtár_lista; do</span>
find <span class=nv>$f</span> <span class=o>&gt;&gt;</span> mentési.lista
<span class=k>done</span>
<span class=c># cpio -v -o --format=newc &lt; backup.list | ssh felhasználó@gép &#34;cat &gt; mentőeszköz&#34;</span></code></pre></div></div><div class=paragraph><p>Ahol a <em>könyvtár_lista</em> a menteni kívánt könyvtárak listája, a <em>felhasználó</em>@<em>gép</em> a mentést végzõ gép felhasználójának és hálózati nevének együttese, valamint a <em>mentõeszköz</em>, ahova a mentés kerül (például <span class=filename>/dev/nsa0</span>).</p></div></div><div class=sect3><h4 id=_pax>18.12.4. <code>pax</code><a class=anchor href=#_pax></a></h4><div class=paragraph><p>A <a href="https://man.freebsd.org/cgi/man.cgi?query=pax&amp;sektion=1&amp;format=html">pax(1)</a> az IEEE/POSIX® válasza a <code>tar</code> és <code>cpio</code> programokra. Az évek során a <code>tar</code> és a <code>cpio</code> különbözõ változatai egy kissé inkompatibilissé váltak. Ezért a szabványosításuk kiharcolása helyett inkább a POSIX® létrehozott egy új archiváló segédprogramot. A <code>pax</code> megpróbálja írni és olvasni a <code>cpio</code> és <code>tar</code> formátumok legtöbb változatát, valamint emellett további saját formátumokat is kezel. A parancskészlete inkább a <code>cpio</code> parancséra emlékeztet, mintsem a <code>tar</code> parancséra.</p></div></div><div class=sect3><h4 id=backups-programs-amanda>18.12.5. Amanda<a class=anchor href=#backups-programs-amanda></a></h4><div class=paragraph><p>Az Amanda (Advanced Maryland Network Disk Archiver) egy kliens-szerver alapú mentési rendszer, nem pedig egy önálló program. Az Amanda szerver menti tetszõleges számú számítógép adatát egyetlen szalagra, melyek az Amanda klienst futtatják és hálózaton keresztül hozzá csatlakoznak. A nagy mennyiségû és nagy kapacitású lemezekkel rendelkezõ rendszerekben közvetlenül a mentéshez szükséges idõ nem áll rendelkezésre a feladat elvégzéséhez. Az Amanda viszont képes megoldani ezt a problémát. Az Amanda képes egy "saját lemez" használatával egyszerre több állományrendszerrõl is biztonsági mentést készíteni. Az Amanda"archívumkészleteket" hoz létre: az Amanda konfigurációs állományában megadott állományrendszerekrõl készít teljes mentést egy adott idõ alatt egy adott mennyiségû szalagra. Az "archívumkészlet" ezenkívül még tartalmaz egy napi inkrementális (vagy különbözeti) mentést is minden egyes állományrendszerrõl. A sérült állományrendszerek visszaállításához mindig a legújabb teljes biztonsági mentésre és a hozzá tartozó inkrementális mentésekre van szükségünk.</p></div><div class=paragraph><p>A konfigurációs állomány segítségével precíz irányítást gyakorolhatunk a létrehozott mentések és az Amanda által keltett hálózati forgalom felett. Az Amanda a fentiek közül bármelyik programmal képes az adatokat szalagra rögzíteni. Az Amanda portként vagy csomagként is elérhetõ, alapértelmezés szerint nem települ.</p></div></div><div class=sect3><h4 id=_ne_csináljunk_semmit>18.12.6. Ne csináljunk semmit<a class=anchor href=#_ne_csináljunk_semmit></a></h4><div class=paragraph><p>A "Ne csináljunk semmit" nem egy újabb számítógépes program, hanem egy igen gyakran alkalmazott mentési stratégia. Nem kell beruházni. Nem kell semmilyen biztonsági mentési rendet követni. Egyszerûen semmit se csinálunk. Ha véletlenül valami történne az adatainkkal, akkor csak mosolyogjunk és törõdjünk bele!</p></div><div class=paragraph><p>Amennyiben az idõnk és adataink keveset vagy éppen semmit se érnek, akkor a "Ne csináljunk semmit" az elérhetõ legjobb biztonsági mentési megoldás számítógépünk számára. De legyünk óvatosak, mert a UNIX® egy igen hasznos eszköz, és fél éven belül könnyen úgy találhatjuk magunkat, hogy mégis csak vannak értékes adataink.</p></div><div class=paragraph><p>A "Ne csináljunk semmit" tökéletesen megfelelõ mentési módszer a <span class=filename>/usr/obj</span> és a hozzá hasonló módon a számítógépen automatikusan generált könyvtárak és állományok esetében. Ugyanilyen példa lehetne a kézikönyv HTML vagy PostScript® változata. Ezek a formátumok ugyanis az SGML források alapján keletkeznek, így a HTML vagy PostScript® állományok mentése nem életbevágó. Az SGML állományokat viszont már annál inkább mentsük!</p></div></div><div class=sect3><h4 id=_melyik_a_legjobb>18.12.7. Melyik a legjobb?<a class=anchor href=#_melyik_a_legjobb></a></h4><div class=paragraph><p><a href="https://man.freebsd.org/cgi/man.cgi?query=dump&amp;sektion=8&amp;format=html">dump(8)</a> <em>Pont.</em> Elizabeth D. Zwicky komolyan letesztelte az itt felsorolt összes programot. A UNIX® állományrendszerek jellegzetességeinek és rajtuk az összes adatunk megõrzésének egyértelmûen a <code>dump</code> felel meg a legjobban. Elizabeth a minden egyes program tesztjéhez olyan állományrendszereket hozott létre, amelyek rengeteg különféle szokatlan helyzetet tartalmaztak (valamint néhány nem annyira szokatlant). Az érintett jellegzetességek: lyukas állományok, lyukas állományok és egy halom nulla, állományok érdekes karakterekkel a nevükben, olvashatatlan és írhatatlan állományok, eszközök, a mentés közben méretüket változtató állományok, a mentés közben keletkezõ és megszûnõ állományok és még sok minden más. Az eredményeit a LISA V-ben jelentette meg 1991 októberében. Lásd <a href=http://www.coredumps.de/doc/dump/zwicky/testdump.doc.html>A biztonsági mentéshez és archiváláshoz használt programok tesztje (angolul)</a>.</p></div></div><div class=sect3><h4 id=_az_adatok_helyreállítása_vészhelyzetben>18.12.8. Az adatok helyreállítása vészhelyzetben<a class=anchor href=#_az_adatok_helyreállítása_vészhelyzetben></a></h4><div class=sect4><h5 id=_a_katasztrófa_elõtt>18.12.8.1. A katasztrófa elõtt<a class=anchor href=#_a_katasztrófa_elõtt></a></h5><div class=paragraph><p>Csupán négy lépést kell megtennünk az esetleges katasztrófák bekövetkezésének esetére.</p></div><div class=paragraph><p>Elõször is két példányban nyomtassuk ki az egyes lemezek lemezcímkéjét (például a <code>bsdlabel da0 | lpr</code> paranccsal) valamint az állományrendszerek táblázatát (az <span class=filename>/etc/fstab</span> állományt) és az összes rendszerindításkor megjelenõ üzenetet.</p></div><div class=paragraph><p>A második lépésben készítenünk kell egy "élõ" rendszerrel rendelkezõ CD-lemezt. Ezen a lemezen megtalálható minden, ami el tudunk indítani egy helyreállításhoz elegendõ rendszert. Ekkor a felhasználó futtatni tudja például a <a href="https://man.freebsd.org/cgi/man.cgi?query=dump&amp;sektion=8&amp;format=html">dump(8)</a>, <a href="https://man.freebsd.org/cgi/man.cgi?query=restore&amp;sektion=8&amp;format=html">restore(8)</a>, <a href="https://man.freebsd.org/cgi/man.cgi?query=fdisk&amp;sektion=8&amp;format=html">fdisk(8)</a>, <a href="https://man.freebsd.org/cgi/man.cgi?query=bsdlabel&amp;sektion=8&amp;format=html">bsdlabel(8)</a>, <a href="https://man.freebsd.org/cgi/man.cgi?query=newfs&amp;sektion=8&amp;format=html">newfs(8)</a>, <a href="https://man.freebsd.org/cgi/man.cgi?query=mount&amp;sektion=8&amp;format=html">mount(8)</a> és a többi segédprogramot. Ez az image a FreeBSD/i386 12.0-RELEASE kiadáshoz az <a href=ftp://ftp.FreeBSD.org/pub/FreeBSD/releases/i386/ISO-IMAGES/12.0/FreeBSD-12.0-RELEASE-i386-livefs.iso>ftp://ftp.FreeBSD.org/pub/FreeBSD/releases/i386/ISO-IMAGES/12.0/FreeBSD-12.0-RELEASE-i386-livefs.iso</a> címrõl tölthetõ le.</p></div><div class=paragraph><p>A harmadik lépésben igyekezzünk minél gyakrabban szalagra menteni. Mindig gondoljuk arra, hogy a legutolsó mentés óta létrehozott változatásaink teljesen el fognak veszni. A mentéseket tartalmazó szalagokat tegyük írásvédetté.</p></div><div class=paragraph><p>A negyedik lépésben ellenõrizzük a a második lépésben készített helyreállító lemezünket és a biztonsági mentéseket tartalmazó szalagokat. Jegyezzük le az eljárást. Ezeket a jegyzeteket is rakjuk el rendszerindító lemezzel, a kinyomtatott adatokkal és a mentéseket tartalmazó szalagokkal együtt. Ezek a jegyzetek megvédenek minket attól, hogy a helyreállítás közbeni kétségbeesésünkben nehogy véletlenül tönkretegyük a biztonsági mentéseinket. (Hogy miként is? Például ha a <code>tar xvf /dev/sa0</code> parancs helyett izgalmunkban a <code>tar cvf /dev/sa0</code> parancsot gépeljük be, akkor azzal felülírjuk a biztonsági mentéseinket).</p></div><div class=paragraph><p>A fokozott biztonság kedvéért minden alkalommal készítsünk rendszerindító lemezt és legalább két mentést. Az egyiket valamilyen távoli helyen tároljuk. Ez a távoli hely NE ugyanannak az épületnek az alagsora legyen! Számos cég alaposan megtanulta ezt a szabályt a Világkereskedelmi központ tragédiája kapcsán. Ez a távoli hely számítógépeinkbõl és merevlemezes meghajtóinkól is fizikailag jól elkülöníthetõ, jelentõs távolságban legyen.</p></div></div><div class=sect4><h5 id=_a_katasztrófa_után>18.12.8.2. A katasztrófa után<a class=anchor href=#_a_katasztrófa_után></a></h5><div class=paragraph><p>Az alapvetõ kérdés: a hardver túlélte? Ha rendszeresen készítettünk biztonsági mentéseket, akkor a szoftverek miatt egyáltalán nem kell aggódnunk.</p></div><div class=paragraph><p>Ha a hardver megsérült, akkor a számítógép használatának újból megkezdése elõtt javasolt cserélni a meghibásodott alkatrészeket.</p></div><div class=paragraph><p>Ha a hardverrel minden rendben találtunk, akkor helyzezzük be a helyreállításhoz használatos "élõ" rendszert tartalmazó lemezt a CD-meghajtóba, és indítsuk el vele a számítógépet. Ezután nemsokára a telepítési menü jelenik meg. Itt a megfelelõ ország után a <span class=guimenuitem>Fixit — Repair mode with CDROM/DVD/floppy or start a shell</span> ("Helyreállítás CD/DVD/floppy használatával, vagy parancssor indítása"), majd a <span class=guimenuitem>CDROM/DVD — Use the live filesystem CDROM/DVD</span> ("A CD/DVD-n található élõ rendszer használata") menüpontokat válasszuk. A <code>restore</code> és a többi segédprogram a <span class=filename>/mnt2/rescue</span> könyvtárban lesznek elérhetõek.</p></div><div class=paragraph><p>Egyenként állítsuk vissza az egyes állományrendszereket.</p></div><div class=paragraph><p>A <code>mount</code> paranccsal próbáljuk meg csatlakoztatni az elsõ lemezünk rendszerindító partícióját (például <code>mount /dev/da0a /mt</code>). Ha a lemezcímke megsérült, akkor <code>bsdlabel</code> alkalmazásával partícionáljuk újra a lemezt és címkézzük meg a korábban kinyomtatott címke adatainak megfelelõen. A <code>newfs</code> segítségével újra hozzuk létre az állományrendszereket. Írható-olvasható módban csatlakoztassuk újra a lemez rendszerinító partícióját (<code>mount -u -o rw /mnt</code>). A biztonság mentést végzõ program és a biztonsági mentést tartalmazó szalagok használatával állítsuk helyre az állományrendszer tartalmát (például <code>restore vrf /dev/sa0</code>). Válasszuk le az állományrendszert (például <code>umount /mnt</code>). Mindegyik sérült állományrendszerre ismételjük a folyamatot.</p></div><div class=paragraph><p>Ahogy mûködõképessé vált a rendszerünk, mentsük az adatainkat új szalagokra. Akármi is okozta a rendszer összeomlását vagy az adatvesztést, ismét lecsaphat. Ha most áldozunk erre még egy órát, akkor azzal a késõbbiekben számos kellemetlenségtõl óvhatjuk meg magunkat.</p></div></div></div></div><div class=sect2><h3 id=disks-virtual>18.13. Hálózat, memória és állomány alapú állományrendszerek<a class=anchor href=#disks-virtual></a></h3><div class=paragraph><p>A számítógépünkben létezõ fizikai lemezek, például floppyk, CD-k, merevlemezek és egyebek mellett a lemezek egy másik formáját is képes megérteni a FreeBSD - a <em>virtuális lemezeket</em>.</p></div><div class=paragraph><p>A virtuális lemeznek tekinthetõek többek közt az olyan hálózati állományrendszerek, mint például a <a href=./#network-nfs>Hálózati állományrendszer</a> (Network File System, NFS) és a Coda, valamint a memóriában és állományokban létrehozott állományrendszerek.</p></div><div class=paragraph><p>Attól függõen, hogy a FreeBSD melyik változatát használjuk, az állomány és memória alapú állományrendszerek létrehozásához, illetve használatához különbözõ segédprogramokra lesz szükségünk.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>A <a href="https://man.freebsd.org/cgi/man.cgi?query=devfs&amp;sektion=5&amp;format=html">devfs(5)</a> a felhasználó számára láthatatlan módon hozza létre az eszközök leíróit.</p></div></td></tr></tbody></table></div><div class=sect3><h4 id=disks-mdconfig>18.13.1. Állomány alapú állományrendszerek<a class=anchor href=#disks-mdconfig></a></h4><div class=paragraph><p>FreeBSD alatt az <a href="https://man.freebsd.org/cgi/man.cgi?query=mdconfig&amp;sektion=8&amp;format=html">mdconfig(8)</a> segédprogram segítségével tudunk memórialemezeket (<a href="https://man.freebsd.org/cgi/man.cgi?query=md&amp;sektion=4&amp;format=html">md(4)</a>) beállítani és engedélyezni. Az <a href="https://man.freebsd.org/cgi/man.cgi?query=mdconfig&amp;sektion=8&amp;format=html">mdconfig(8)</a> használatához be kell töltenünk az <a href="https://man.freebsd.org/cgi/man.cgi?query=md&amp;sektion=4&amp;format=html">md(4)</a> modult vagy hozzá kell tennünk a rendszermagunk beállításait tartalmazó állományhoz:</p></div><div class="literalblock programlisting"><div class=content><pre>device md</pre></div></div><div class=paragraph><p>Az <a href="https://man.freebsd.org/cgi/man.cgi?query=mdconfig&amp;sektion=8&amp;format=html">mdconfig(8)</a> parancs háromféle memória alapú virtuális lemezt ismer: a <a href="https://man.freebsd.org/cgi/man.cgi?query=malloc&amp;sektion=9&amp;format=html">malloc(9)</a>, állományok vagy lapozóterület használatával létrehozott memórialemezeket. Így lehet például csatlakoztatni a floppyk vagy CD-k állományokban tárolt image-eit.</p></div><div class=paragraph><p>Egy meglevõ állományrendszer image-ének csatlakoztatása:</p></div><div class=exampleblock><div class=title>Példa 23. Egy meglevõ állományrendszer image-ének csatlakoztatása az <code>mdconfig</code> paranccsal</div><div class=content><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># mdconfig -a -t vnode -f image -u 0</span>
<span class=c># mount /dev/md0 /mnt</span></code></pre></div></div></div></div><div class=paragraph><p>Új állományrendszer létrehozása az <a href="https://man.freebsd.org/cgi/man.cgi?query=mdconfig&amp;sektion=8&amp;format=html">mdconfig(8)</a> használatával:</p></div><div class=exampleblock><div class=title>Példa 24. Új állomány alapú lemez létrehozása az <code>mdconfig</code> paranccsal</div><div class=content><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># dd if=/dev/zero of=új-image bs=1k count=5k</span>
5120+0 records <span class=k>in
</span>5120+0 records out
<span class=c># mdconfig -a -t vnode -f új-image -u 0</span>
<span class=c># bsdlabel -w md0 auto</span>
<span class=c># newfs md0a</span>
/dev/md0a: 5.0MB <span class=o>(</span>10224 sectors<span class=o>)</span> block size 16384, fragment size 2048
        using 4 cylinder <span class=nb>groups </span>of 1.25MB, 80 blks, 192 inodes.
super-block backups <span class=o>(</span><span class=k>for </span>fsck <span class=nt>-b</span> <span class=c>#) at:</span>
 160, 2720, 5280, 7840
<span class=c># mount /dev/md0a /mnt</span>
<span class=c># df /mnt</span>
Filesystem 1K-blocks Used Avail Capacity  Mounted on
/dev/md0a       4710    4  4330     0%    /mnt</code></pre></div></div></div></div><div class=paragraph><p>Ha az <code>-u</code> beállítással nem adjuk meg az egység számát, akkor az <a href="https://man.freebsd.org/cgi/man.cgi?query=mdconfig&amp;sektion=8&amp;format=html">mdconfig(8)</a> az <a href="https://man.freebsd.org/cgi/man.cgi?query=md&amp;sektion=4&amp;format=html">md(4)</a> automatikus kiosztásán keresztül fog egy használatban még nem levõ eszközt kiválasztani. Az így kiosztott egység neve az <span class=filename>md4</span> névhez hasonlóan jelenik meg a szabványos kimeneten. Az <a href="https://man.freebsd.org/cgi/man.cgi?query=mdconfig&amp;sektion=8&amp;format=html">mdconfig(8)</a> használatának részleteirõl olvassuk el a hozzá tartozó man oldalt.</p></div><div class=paragraph><p>Az <a href="https://man.freebsd.org/cgi/man.cgi?query=mdconfig&amp;sektion=8&amp;format=html">mdconfig(8)</a> egy nagyon sokoldalú segédeszköz, habár használatakor viszonylag sok parancsot kell kiadni egy állomány alapú állományrendszer létrehozásához. A FreeBSD azonban alapból tartalmaz még egy <a href="https://man.freebsd.org/cgi/man.cgi?query=mdmfs&amp;sektion=8&amp;format=html">mdmfs(8)</a> nevû segédprogramot is, ami az <a href="https://man.freebsd.org/cgi/man.cgi?query=md&amp;sektion=4&amp;format=html">md(4)</a> lemezeket az <a href="https://man.freebsd.org/cgi/man.cgi?query=mdconfig&amp;sektion=8&amp;format=html">mdconfig(8)</a> segítségével állítja be, létrehoz rajtuk egy UFS típusú állományrendszert a <a href="https://man.freebsd.org/cgi/man.cgi?query=newfs&amp;sektion=8&amp;format=html">newfs(8)</a> segítségével és csatlakoztatja a <a href="https://man.freebsd.org/cgi/man.cgi?query=mount&amp;sektion=8&amp;format=html">mount(8)</a> paranccsal. Így például, ha az iménti állományrendszert akarjuk létrehozni és csatlakoztatni, akkor egyszerûen csak gépeljünk be ennyit:</p></div><div class=exampleblock><div class=title>Példa 25. Állomány alapú lemezek beállítása és csatlakoztatása az <code>mdmfs</code> paranccsal</div><div class=content><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># dd if=/dev/zero of=új-image bs=1k count=5k</span>
5120+0 records <span class=k>in
</span>5120+0 records out
<span class=c># mdmfs -F új-image -s 5m md0 /mnt</span>
<span class=c># df /mnt</span>
Filesystem 1K-blocks Used Avail Capacity  Mounted on
/dev/md0        4718    4  4338     0%    /mnt</code></pre></div></div></div></div><div class=paragraph><p>Ha az <code>md</code> paramétert az egység száma nélkül adjuk meg, akkor <a href="https://man.freebsd.org/cgi/man.cgi?query=mdmfs&amp;sektion=8&amp;format=html">mdmfs(8)</a> az <a href="https://man.freebsd.org/cgi/man.cgi?query=md&amp;sektion=4&amp;format=html">md(4)</a> automatikus kiosztására támaszkodva fog egy addig még nem használt eszközt kiválasztani. A <a href="https://man.freebsd.org/cgi/man.cgi?query=mdmfs&amp;sektion=8&amp;format=html">mdmfs(8)</a> használatának pontos részleteivel kapcsolatban lásd a hozzá tartozó man oldalt.</p></div></div><div class=sect3><h4 id=disks-md-freebsd5>18.13.2. Memória alapú állományrendszerek<a class=anchor href=#disks-md-freebsd5></a></h4><div class=paragraph><p>A memória alapú állományrendszerek esetében általában a "lapozóállomány alapú" megközelítést alkalmazzák. A lapozóállomány alapúság nem arra utal, hogy a memórialemezt alapból kilapozzák lemezre, hanem inkább arra, hogy a memórialemez olyan területen jön létre, amelyet szükség esetén lemezre lehet lapozni. Memória alapú lemezeket a (rendszermag szintû) <a href="https://man.freebsd.org/cgi/man.cgi?query=malloc&amp;sektion=9&amp;format=html">malloc(9)</a> használatával is létre lehet hozni, de a malloc alapú memórialemezeknél, különösen a nagyon nagyok esetében, a rendszer könnyen össze tud omlani, ha kifut a rendelkezésére álló memóriából.</p></div><div class=exampleblock><div class=title>Példa 26. Új memória alapú lemez létrehozása az <code>mdconfig</code> paranccsal</div><div class=content><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># mdconfig -a -t swap -s 5m -u 1</span>
<span class=c># newfs -U md1</span>
/dev/md1: 5.0MB <span class=o>(</span>10240 sectors<span class=o>)</span> block size 16384, fragment size 2048
        using 4 cylinder <span class=nb>groups </span>of 1.27MB, 81 blks, 192 inodes.
        with soft updates
super-block backups <span class=o>(</span><span class=k>for </span>fsck <span class=nt>-b</span> <span class=c>#) at:</span>
 160, 2752, 5344, 7936
<span class=c># mount /dev/md1 /mnt</span>
<span class=c># df /mnt</span>
Filesystem 1K-blocks Used Avail Capacity  Mounted on
/dev/md1        4718    4  4338     0%    /mnt</code></pre></div></div></div></div><div class=exampleblock><div class=title>Példa 27. Új memória alapú lemez létrehozása az <code>mdmfs</code> paranccsal</div><div class=content><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># mdmfs -s 5m md2 /mnt</span>
<span class=c># df /mnt</span>
Filesystem 1K-blocks Used Avail Capacity  Mounted on
/dev/md2        4846    2  4458     0%    /mnt</code></pre></div></div></div></div></div><div class=sect3><h4 id=_memórialemezek_leválasztása_a_rendszerrõl>18.13.3. Memórialemezek leválasztása a rendszerrõl<a class=anchor href=#_memórialemezek_leválasztása_a_rendszerrõl></a></h4><div class=paragraph><p>Amikor már nem akarunk tovább használni egy memória vagy állomány alapú állományrendszert, érdemes visszaadnunk az általuk felhasznált erõforrásokat a rendszernek. Elsõként válasszuk le magát az állományrendszert, majd az <a href="https://man.freebsd.org/cgi/man.cgi?query=mdconfig&amp;sektion=8&amp;format=html">mdconfig(8)</a> segítségével kapcsoljuk le a lemezt a rendszerrõl és szabadítsuk fel az általa felhasznált erõforrásokat.</p></div><div class=paragraph><p>Például az <span class=filename>/dev/md4</span> eszközt így lehet lekapcsolni és felszabadítani:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># mdconfig -d -u 4</span></code></pre></div></div><div class=paragraph><p>A beállított <a href="https://man.freebsd.org/cgi/man.cgi?query=md&amp;sektion=4&amp;format=html">md(4)</a> eszközökkel kapcsolatos többi információt az <code>mdconfig -l</code> paranccsal tudjuk lekérdezni.</p></div></div></div><div class=sect2><h3 id=snapshots>18.14. Az állományrendszerek pillanatképei<a class=anchor href=#snapshots></a></h3><div class=paragraph><p>A FreeBSD a <a href=./#soft-updates>Soft Updates</a> mellett felkínál egy másik lehetõséget: az állományrendszerekrõl készíthetõ pillanatfelvételeket.</p></div><div class=paragraph><p>Ezek a pillanatképek lehetõvé teszik a felhasználók számára, hogy adott állományrendszerekrõl képeket hozzanak létre és azt állományként kezeljék. A pillanatképeket az adott állományrendszerben kell létrehozni, és a felhasználók állományrendszerenként húsznál többet nem hozhatnak belõlük létre. Az aktív pillanatképek a szuperblokkban kerülnek rögzítésre, ezért az állományrendszerek leválasztása és újracsatlakoztatása esetén is megmaradnak, még újraindítás után is. Amikor egy pillanatképre már nincs tovább szükségünk, egy szimpla <a href="https://man.freebsd.org/cgi/man.cgi?query=rm&amp;sektion=1&amp;format=html">rm(1)</a> paranccsal eltávolítható. A pillanatképek tetszõleges sorrendben eltávolíthatóak, habár ilyenkor az összes általuk lefoglalt hely nem szabadul fel, mivel más pillanatképeknek még szüksége lehet bizonyos blokkjaira.</p></div><div class=paragraph><p>Miután az <a href="https://man.freebsd.org/cgi/man.cgi?query=mksnap_ffs&amp;sektion=8&amp;format=html">mksnap_ffs(8)</a> paranccsal létrehoztunk egy pillanatképet tartalmazó állományt, beállítódik rá a módosíthatatlanságot jelentõ <code>snapshot</code> állományjelzõ. Egyedül az <a href="https://man.freebsd.org/cgi/man.cgi?query=unlink&amp;sektion=1&amp;format=html">unlink(1)</a> parancs képez ez alól kivételt, mivel segítségével a pillanatképek eltávolíthatóak.</p></div><div class=paragraph><p>A pillanatképek a <a href="https://man.freebsd.org/cgi/man.cgi?query=mount&amp;sektion=8&amp;format=html">mount(8)</a> paranccsal hozhatóak létre. A következõ módon tudjuk a <span class=filename>/var</span> egy pillanatképét elkészíteni a <span class=filename>/var/snapshot/snap</span> állományban:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># mount -u -o snapshot /var/snapshot/snap /var</span></code></pre></div></div><div class=paragraph><p>Vagy a <a href="https://man.freebsd.org/cgi/man.cgi?query=mksnap_ffs&amp;sektion=8&amp;format=html">mksnap_ffs(8)</a> meghívásával is készíthetünk pillanatképeket:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># mksnap_ffs /var /var/snapshot/snap</span></code></pre></div></div><div class=paragraph><p>Az állományrendszeren (például <span class=filename>/var</span>) a pillanatképeket tartalmazó állományokat a <a href="https://man.freebsd.org/cgi/man.cgi?query=find&amp;sektion=1&amp;format=html">find(1)</a> paranccsal kereshetjük meg:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># find /var -flags snapshot</span></code></pre></div></div><div class=paragraph><p>Ahogy elkészítettünk egy pillanatképet, több mindenre is felhasználhatjuk:</p></div><div class=ulist><ul><li><p>Egyes rendszergazdák a pillanatképeket biztonsági mentésekhez használják, mivel ezek gond nélkül áttehetõek CD-re vagy szalagra.</p></li><li><p>Az állományrendszerek sértetlenségét ellenõrzõ program, az <a href="https://man.freebsd.org/cgi/man.cgi?query=fsck&amp;sektion=8&amp;format=html">fsck(8)</a> is lefuttatható egy ilyen pillanatképen. Feltéve, hogy az állományrendszer csatlakoztatásakor tiszta volt, mindig egy tiszta (és változásokat nem tartalmazó) eredményt kell kapnunk. Ennek megléte elengedhetetlen a háttérben futtatható <a href="https://man.freebsd.org/cgi/man.cgi?query=fsck&amp;sektion=8&amp;format=html">fsck(8)</a> mûködéséhez.</p></li><li><p>Futassuk le a <a href="https://man.freebsd.org/cgi/man.cgi?query=dump&amp;sektion=8&amp;format=html">dump(8)</a> segédprogramot a pillanatképen. Az így létrehozott mentés megegyezik az állományrendszer adott pillanatban felvett állapotával. Az <code>-L</code> beállítás megadásával maga a <a href="https://man.freebsd.org/cgi/man.cgi?query=dump&amp;sektion=8&amp;format=html">dump(8)</a> is képes egyetlen parancsban pillanatfelvételt készíteni, ebbõl létrehozni a mentést, majd eltávolítani.</p></li><li><p>A pillanatképet képesek vagyunk a <a href="https://man.freebsd.org/cgi/man.cgi?query=mount&amp;sektion=8&amp;format=html">mount(8)</a> paranccsal az állományrendszer befagyasztott változataként csatlakoztatni:</p><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># mdconfig -a -t vnode -f /var/snapshot/snap -u 4</span>
<span class=c># mount -r /dev/md4 /mnt</span></code></pre></div></div></li></ul></div><div class=paragraph><p>Így már a <span class=filename>/mnt</span> könyvtárba csatlakoztatva be tudjuk járni a befagyasztott <span class=filename>/var</span> állományrendszert. Minden a pillanatfelvétel készítésének idõpontjának megfelelõ állapotban fog maradni. Az egyetlen kivétel talán annyi, hogy korábbi pillanatképek nulla méretû állományként fognak megjelenni. Mikor befejeztük a pillanatképek használatát, a <a href="https://man.freebsd.org/cgi/man.cgi?query=umount&amp;sektion=8&amp;format=html">umount(8)</a> paranccsal le tudjuk választani:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># umount /mnt</span>
<span class=c># mdconfig -d -u 4</span></code></pre></div></div><div class=paragraph><p>A <code>softupdates</code> és az állományrendszerek pillanatképeinek használatával, illetve mûszaki leírásukkal kapcsolatban látogassuk meg Marshall Kirk McKusick honlapját a <a href=http://www.mckusick.com/>http://www.mckusick.com/</a> címen (angolul).</p></div></div><div class=sect2><h3 id=quotas>18.15. Az állományrendszerek kvótái<a class=anchor href=#quotas></a></h3><div class=paragraph><p>A kvóták használata az operációs rendszerben egy olyan választható lehetõség, aminek segítségével állományrendszerenként korlátozni tudjuk az egyes felhasználók vagy csoporttagok által elhasznált lemezterület és/vagy állományok mennyiségét. Ezt leggyakrabban olyan idõosztásos rendszerekben használják ki, ahol szükség lehet az egyes felhasználókra vagy csoportokra esõ erõforrások mennyiségének szabályozására. Ezzel tudjuk megakadályozni, hogy a felhasználók vagy csoportok elfogyasszák az összes rendelkezésre álló lemezterületet.</p></div><div class=sect3><h4 id=_a_kvóták_használatának_beállítása>18.15.1. A kvóták használatának beállítása<a class=anchor href=#_a_kvóták_használatának_beállítása></a></h4><div class=paragraph><p>Mielõtt nekilátnánk a kvóták használatának, meg kell gyõzõdnünk róla, hogy a rendszermagunkban megvan hozzá a szükséges támogatás. A kvótákat a következõ sorral lehet engedélyezni a rendszermag beállításait tartalmazó állományban:</p></div><div class="literalblock programlisting"><div class=content><pre>options QUOTA</pre></div></div><div class=paragraph><p>A gyári <span class=filename>GENERIC</span> rendszermag ezt alapból nem engedélyezi, ezért ehhez mindenképpen be kell állítani, le kell fordítani és telepíteni egy kell saját rendszermagot. A saját rendszermag létrehozásához kövessük a <a href=./#kernelconfig>A FreeBSD rendszermag testreszabása</a> utasításait.</p></div><div class=paragraph><p>Ha ezzel megvagyunk, akkor a következõ sorral bõvítsük ki az <span class=filename>/etc/rc.conf</span> állományt:</p></div><div class="literalblock programlisting"><div class=content><pre>enable_quotas=&#34;YES&#34;</pre></div></div><div class=paragraph><p>A kvótákat kezelõ rendszer indításának finomabb szabályozására létezik még egy további beállítási lehetõség is. A rendszer indítása során általában az egyes állományrendszerek kvótáját a <a href="https://man.freebsd.org/cgi/man.cgi?query=quotacheck&amp;sektion=8&amp;format=html">quotacheck(8)</a> program ellenõrzi. A <a href="https://man.freebsd.org/cgi/man.cgi?query=quotacheck&amp;sektion=8&amp;format=html">quotacheck(8)</a> gondoskodik róla, hogy a kvótákat tároló adatbázis ténylegesen az állományrendszeren található adatokat tükrözi. Ez egy nagyon idõigényes folyamat, ami rányomja bélyegét a rendszer elindulásához szükséges idõ mennyiségére is. Amennyiben szeretnénk megtakarítani ezt a lépést, tegyük bele az <span class=filename>/etc/rc.conf</span> állományba a direkt erre a célra kialakított beállítást:</p></div><div class="literalblock programlisting"><div class=content><pre>check_quotas=&#34;NO&#34;</pre></div></div><div class=paragraph><p>Végezetül az állományrendszereken az <span class=filename>/etc/fstab</span> megfelelõ módosításával tudjuk egyenként engedélyezni a lemezkvóták használatát. Itt lehet bekapcsolni az állományrendszerek felhasználókra vagy csoportokra, esetleg mind a kettõjükre vonatkozó kvótáikat.</p></div><div class=paragraph><p>Ha felhasználói szintû kvótákat akarunk engedélyezni egy állományrendszeren, akkor az <span class=filename>/etc/fstab</span> állományban az állományrendszer beállításai közé vegyük fel a <code>userquota</code> opciót. Például így:</p></div><div class="literalblock programlisting"><div class=content><pre>/dev/da1s2g   /home    ufs rw,userquota 1 2</pre></div></div><div class=paragraph><p>Ehhez hasonlóan tudjuk engedélyezni a <code>userquota</code> helyett a <code>groupquota</code> opció használatával a csoportszintû kvótákat is. A felhasználói- és csoportszintû kvóták együttes engedélyezéséhez így kell átírni az állományrendszer bejegyzését:</p></div><div class="literalblock programlisting"><div class=content><pre>/dev/da1s2g    /home    ufs rw,userquota,groupquota 1 2</pre></div></div><div class=paragraph><p>Alapértelmezés szerint az állományrendszerekhez tartozó kvóták a gyökerükben található <span class=filename>quota.user</span> valamint <span class=filename>quota.group</span> állományokban tárolódnak. Errõl részletesebben az <a href="https://man.freebsd.org/cgi/man.cgi?query=fstab&amp;sektion=5&amp;format=html">fstab(5)</a> man oldalon olvashatunk. Noha még az <a href="https://man.freebsd.org/cgi/man.cgi?query=fstab&amp;sektion=5&amp;format=html">fstab(5)</a> man oldala szerint is megadható más elérési út a kvótákat tároló állományokhoz, semmiképpen sem javasoljuk ezt, mert úgy tûnik, hogy a kvótákat kezelõ különbözõ segédprogramok ezzel nem képesek rendesen megbirkózni.</p></div><div class=paragraph><p>Most kell újraindítani a rendszerünket az új rendszermaggal. Az <span class=filename>/etc/rc</span> magától le fogja futtatni a kezdeti kvótaállományok létrehozásához szükséges parancsokat az <span class=filename>/etc/fstab</span> állományban megadott állományrendszereken. Ennek megfelelõen tehát nem nekünk kell kézzel létrehoznunk ezeket az állományokat.</p></div><div class=paragraph><p>Hétköznapi esetben egyáltalán nem kell manuális futtatnunk a <a href="https://man.freebsd.org/cgi/man.cgi?query=quotacheck&amp;sektion=8&amp;format=html">quotacheck(8)</a>, <a href="https://man.freebsd.org/cgi/man.cgi?query=quotaon&amp;sektion=8&amp;format=html">quotaon(8)</a> vagy <a href="https://man.freebsd.org/cgi/man.cgi?query=quotaoff&amp;sektion=8&amp;format=html">quotaoff(8)</a> parancsokat. Habár ha tisztában szeretnénk lenni a pontos mûködésükkel, akkor mindenképpen lapozzuk fel a hozzájuk tartozó man oldalakat.</p></div></div><div class=sect3><h4 id=_a_kvóták_beállítása>18.15.2. A kvóták beállítása<a class=anchor href=#_a_kvóták_beállítása></a></h4><div class=paragraph><p>Ahogy sikerült beállítani a kvóták használatát, egybõl ellenõrizzük is a mûködõképességüket. Ezt legegyszerûbben a következõ paranccsal tehetjük meg:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># quota -v</span></code></pre></div></div><div class=paragraph><p>Itt egy sorban összefoglalva láthatjuk a jelenlegi lemezhasználatot és az egyes állományrendszereken engedélyezett kvóták korlátait.</p></div><div class=paragraph><p>Most már készenállunk arra, hogy az <a href="https://man.freebsd.org/cgi/man.cgi?query=edquota&amp;sektion=8&amp;format=html">edquota(8)</a> paranccsal végre korlátokat is beállítsunk a kvótákhoz.</p></div><div class=paragraph><p>Számos beállítás áll rendelkezésünkre a felhasználók vagy csoportok által lefoglalható lemezterület vagy a létrehozható állományok számának korlátozását illetõen. A helyfoglalást szabályozhatjuk lemezterület alapján (blokk kvóta) vagy az állományok száma szerint (állományleíró kvóta), esetleg a kettõ kombinációjával. A korlátok további két kategóriára bonthatóak: erõsre és gyengére.</p></div><div class=paragraph><p>Az erõs korlátot (hard limit) nem lehet túllépni. Ahogy a felhasználó eléri a számára kiszabott erõs korlátot, semmilyen további területet nem használhat fel a kérdéses állományrendszeren. Például, ha a felhasználónak az állományrendszeren 500 kilobyte-os erõs korlátot állítottunk be, és éppen 490 kilobyte-nál tart, akkor a felhasználó innen már csak 10 kilobyte-nyi helyet foglalhat le. 11 kilobyte lefoglalása már nem fog sikerrel járni.</p></div><div class=paragraph><p>Ezzel szemben a gyenge korlátok (soft limit) egy adott ideig átléphetõek. Ezt az idõt türelmi idõnek (grace period) nevezik, ami alapértelmezés szerint egy hét. Ha a felhasználó a gyenge korláton felül marad a türelmi idõ után is, akkor ezt a gyenge korlát erõssé válik és semmilyen további helyfoglalásra nem lesz lehetõsége. Amikor a felhasználók újra a gyenge korlát alá kerül, a türelmi idõ is visszaáll a beállított értékére.</p></div><div class=paragraph><p>A most következõ példában az <a href="https://man.freebsd.org/cgi/man.cgi?query=edquota&amp;sektion=8&amp;format=html">edquota(8)</a> parancsot mutatjuk be. Amikor meghívjuk az <a href="https://man.freebsd.org/cgi/man.cgi?query=edquota&amp;sektion=8&amp;format=html">edquota(8)</a> parancsot, akkor elindul az <code>EDITOR</code> környezeti változónak megfelelõ szövegszerkesztõ, illetve ennek hiányában a vi, és lehetõségünk nyílik a kvóta korlátainak módosítására.</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># edquota -u teszt</span></code></pre></div></div><div class="literalblock programlisting"><div class=content><pre>Quotas for user teszt:
/usr: kbytes in use: 65, limits (soft = 50, hard = 75)
        inodes in use: 7, limits (soft = 50, hard = 60)
/usr/var: kbytes in use: 0, limits (soft = 50, hard = 75)
        inodes in use: 0, limits (soft = 50, hard = 60)</pre></div></div><div class=paragraph><p>Normális esetben minden kvótával rendelkezõ állományrendszerhez két sort kapunk. Közülük az egyik sorban szerepelnek a blokkok korlátai, a másikban az állományleírók korlátai. Ha valamelyiküket meg akarjuk változtatni, akkor egyszerûen csak át kell írnunk az adott korlát értékét. Például növeljük meg a felhasználók 50-es gyenge és 75-ös erõs blokk korlátját 500-as gyenge és 600-as erõs korlátra. Ehhez szerkesszük át a</p></div><div class="literalblock programlisting"><div class=content><pre>/usr: kbytes in use: 65, limits (soft = 50, hard = 75)</pre></div></div><div class=paragraph><p>sort erre:</p></div><div class="literalblock programlisting"><div class=content><pre>/usr: kbytes in use: 65, limits (soft = 500, hard = 600)</pre></div></div><div class=paragraph><p>Az új korlátok akkor fognak érvénybe lépni, miután kiléptünk a szövegszerkesztõbõl.</p></div><div class=paragraph><p>Néha hasznos lehet a korlátokat adott felhasználói azonosítókhoz beállítani. Ezt az <a href="https://man.freebsd.org/cgi/man.cgi?query=edquota&amp;sektion=8&amp;format=html">edquota(8)</a> parancs <code>-p</code> paraméterével tudjuk elvégezni. Elõször is állítsuk be egy felhasználónak a beállítani kívánt korlátokat, majd futtassuk le az <code>edquota -p teszt kezdõuid-véguid</code> parancsot. Például ha a <code>teszt</code> nevû felhasználónak állítottuk be a számunkra megfelelõ korlátokat, akkor a következõ paranccsal lehet a rá vonatkozó korlátokat kiterjeszteni a 10 000 és 19 999 közötti azonosítójú felhasználókra:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># edquota -p teszt 10000-19999</span></code></pre></div></div><div class=paragraph><p>Errõl bõvebben az <a href="https://man.freebsd.org/cgi/man.cgi?query=edquota&amp;sektion=8&amp;format=html">edquota(8)</a> man oldalán kaphatunk felvilágosítást.</p></div></div><div class=sect3><h4 id=_a_kvóták_korlátainak_és_a_lemezhasználat_ellenõrzése>18.15.3. A kvóták korlátainak és a lemezhasználat ellenõrzése<a class=anchor href=#_a_kvóták_korlátainak_és_a_lemezhasználat_ellenõrzése></a></h4><div class=paragraph><p>A kvóták korlátait és a lemez jelenlegi kihasználtságát a <a href="https://man.freebsd.org/cgi/man.cgi?query=quota&amp;sektion=1&amp;format=html">quota(1)</a> vagy <a href="https://man.freebsd.org/cgi/man.cgi?query=repquota&amp;sektion=8&amp;format=html">repquota(8)</a> parancsokkal is ellenõrizhetjük. A <a href="https://man.freebsd.org/cgi/man.cgi?query=quota&amp;sektion=1&amp;format=html">quota(1)</a> parancs segítségével ellenõrizhetõ az egyes felhasználók vagy csoportok kvótája és lemezhasználata. A felhasználók csak a saját adataikhoz férhetnek hozzá, illetve mindazon csoportokéhoz, aminek tagjai. Egyedül a rendszeradminisztrátor képes látni az összes felhasználó és csoport kvótáját. A <a href="https://man.freebsd.org/cgi/man.cgi?query=repquota&amp;sektion=8&amp;format=html">repquota(8)</a> paranccsal kérdezhetõ le az összes kvóta és lemezhasználat rövid kimutatása minden olyan állományrendszeren, ahol azok engedélyezettek.</p></div><div class=paragraph><p>A következõ kimenet a <code>quota -v</code> parancstól származik, ahol a felhasználónak két állományrendszeren is vannak kvótái:</p></div><div class="literalblock programlisting"><div class=content><pre>Disk quotas for user teszt (uid 1002):
     Filesystem  usage    quota   limit   grace   files   quota   limit   grace
           /usr      65*     50      75   5days       7      50      60
       /usr/var       0      50      75               0      50      60</pre></div></div><div class=paragraph><p>A fenti példában látható, hogy a felhasználó a <span class=filename>/usr</span> állományrendszeren pillanatnyilag 15 kilobyte-tal van az 50 kilobyte-os gyenge korlátja felett és 5 napja van hátra a türelmi idõbõl. Vegyük észre a szám mellett levõ csillagot (<code>*</code>), amivel a rendszer jelzi, hogy a felhasználó túllépte a korlátját.</p></div><div class=paragraph><p>A <a href="https://man.freebsd.org/cgi/man.cgi?query=quota&amp;sektion=1&amp;format=html">quota(1)</a> parancs kimenetében általában nem jelennek meg azok az állományrendszerek, amelyeken a felhasználónak ugyan vannak kvótái, de nem foglal rajtuk lemezterületet. A <code>-v</code> beállítás megadásával ezek az állományrendszerek is láthatóvá válnak, mint ahogy azt a fenti példában is megfigyelhettük a <span class=filename>/usr/var</span> esetében.</p></div></div><div class=sect3><h4 id=_kvóták_nfs_en_keresztül>18.15.4. Kvóták NFS-en keresztül<a class=anchor href=#_kvóták_nfs_en_keresztül></a></h4><div class=paragraph><p>A kvóták az NFS szerver kvótákért felelõs alrendszerében is engedélyezhetõek. Az <a href="https://man.freebsd.org/cgi/man.cgi?query=rpc.rquotad&amp;sektion=8&amp;format=html">rpc.rquotad(8)</a> démon teszi az NFS klienseken futtatott <a href="https://man.freebsd.org/cgi/man.cgi?query=quota&amp;sektion=1&amp;format=html">quota(1)</a> parancsok számára elérhetõvé a kvótákkal kapcsolatos információkat, aminek köszönhetõen a felhasználók távolról is képesek lekérdezni a kvótáikat.</p></div><div class=paragraph><p>Az <code>rpc.rquotad</code> aktivilásához a következõt kell beállítani az <span class=filename>/etc/inetd.conf</span> állományban:</p></div><div class="literalblock programlisting"><div class=content><pre>rquotad/1      dgram rpc/udp wait root /usr/libexec/rpc.rquotad rpc.rquotad</pre></div></div><div class=paragraph><p>Majd ne felejtsük el újraindítani az <code>inetd</code> démont sem:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># /etc/rc.d/inetd restart</span></code></pre></div></div></div></div><div class=sect2><h3 id=disks-encrypting>18.16. A lemezpartíciók titkosítása<a class=anchor href=#disks-encrypting></a></h3><div class=paragraph><p>A FreeBSD kitûnõ futásközbeni védelmet ajánl fel az adatok illetéktelen hozzáférése ellen. Az állományok engedélyei és a kötelezõ hozzáférés-vezérlés (Mandatory Access Control, MAC, lásd <a href=./#mac>Kötelező hozzáférés-vezérlés (MAC)</a>) segítenek megvédeni érzékeny adatainkat az illéktelenek ellen az operációs rendszer futása és a számítógép mûködése során. Azonban az operációs rendszerben kezelt engedélyek teljesen hatástalanok abban az esetben, ha a támadó fizikailag is képes hozzáférni a számítógépünkhöz, eltávolítani a merevlemezt és egy másik operációs rendszer segítségével kielemezni a rajta található fontos adatainkat.</p></div><div class=paragraph><p>Függetlenül attól, hogy a támadó valójában miként is férkõzött hozzá a merevlemezünkhöz, vagy miként kapcsolta le a számítógépünket, a FreeBSD megtalálható GEOM alapú lemeztitkosítás (gbde) és a <code>geli</code> titkosítási alrendszer egyaránt képes védelmet nyújtani a számítógépen található állományrendszerek számára az értékes adatok után kutató igen motivált betörõk ellen. A csupán egyes állományokra kiterjedõ körmönfont titkosítási módszerekkel szemben a <code>gbde</code> és a <code>geli</code> az egész állományrendszert észrevétlen módon titkosítja. Titkosítatlan adat nem is kerül a merevlemezre.</p></div><div class=sect3><h4 id=_a_lemez_titkosítása_a_gbde_használatával>18.16.1. A lemez titkosítása a gbde használatával<a class=anchor href=#_a_lemez_titkosítása_a_gbde_használatával></a></h4><div class="exampleblock procedure"><div class=content><div class="olist arabic"><ol class=arabic><li><p>Váljunk <code>root</code> felhasználóvá</p><div class=paragraph><p>A gbde beállításához rendszeradminisztrátori jogosultságokra lesz szükségünk.</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>% su -
Password:</code></pre></div></div></li><li><p>Adjuk hozzá a <a href="https://man.freebsd.org/cgi/man.cgi?query=gbde&amp;sektion=4&amp;format=html">gbde(4)</a> támogatását a rendszermag konfigurációs állományához</p><div class=paragraph><p>Tegyük a következõ sort a rendszermag beállításait tartalmazó állományba:</p></div><div class=paragraph><p><code>options GEOM_BDE</code></p></div><div class=paragraph><p>Fordítsuk újra a rendszermagot a <a href=./#kernelconfig>A FreeBSD rendszermag testreszabása</a>ben leírtak szerint.</p></div><div class=paragraph><p>Indítsuk el a számítógépet az új rendszermaggal.</p></div></li><li><p>A rendszermag újrafordítása helyett a <code>kldload</code> paranccsal is betölthetjük a <a href="https://man.freebsd.org/cgi/man.cgi?query=gbde&amp;sektion=4&amp;format=html">gbde(4)</a> modulját:</p><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># kldload geom_bde</span></code></pre></div></div></li></ol></div></div></div><div class=sect4><h5 id=_a_titkosított_merevlemez_elõkészítése>18.16.1.1. A titkosított merevlemez elõkészítése<a class=anchor href=#_a_titkosított_merevlemez_elõkészítése></a></h5><div class=paragraph><p>A következõ példa azt feltételezi, hogy a rendszerünkhöz egy új merevlemezt adunk hozzá, amin egyetlen titkosított partíció foglal helyet. Ezt a partíciót a <span class=filename>/private</span> könyvtárba fogjuk csatlakoztatni. A gbde használható a <span class=filename>/home</span> és a <span class=filename>/var/mail</span> titkosítására is, de ennek megvalósítása olyan bonyolult utasításokat igényel, amelyek meghaladják ennek a bevezetésnek a kereteit.</p></div><div class="exampleblock procedure"><div class=content><div class="olist arabic"><ol class=arabic><li><p>Az új merevlemez hozzáadása</p><div class=paragraph><p>A <a href=#disks-adding>Lemezek hozzáadása</a>ban bemutatottak szerint adjuk hozzá a rendszerünkhöz az új merevlemezt. A példában az új lemez partícióját a <span class=filename>/dev/ad4s1c</span> néven fogjuk tudni elérni. A <span class=filename>/dev/ad0s1*</span> eszközök a példában szereplõ FreeBSD rendszer szabványos partícióit jelölik.</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># ls /dev/ad*</span>
/dev/ad0        /dev/ad0s1b     /dev/ad0s1e     /dev/ad4s1
/dev/ad0s1      /dev/ad0s1c     /dev/ad0s1f     /dev/ad4s1c
/dev/ad0s1a     /dev/ad0s1d     /dev/ad4</code></pre></div></div></li><li><p>Hozzunk létre egy könyvtárat a gbde zárolásainak tárolásához</p><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># mkdir /etc/gbde</span></code></pre></div></div><div class=paragraph><p>A gbdenek azért van szüksége a zárolásokat rögzítõ állományokra, hogy hozzá tudjon férni a titkosított partíciókhoz. Amennyiben ezt nem tudja megtenni, a gbde anélkül nem lesz képes visszafejteni a titkosított partíciókon tárolt adatokat, hogy az ezeket elérni akaró szoftvereknek ne kelljen jelentõsebb mértékben manuálisan beavatkoznia. Mindegyik titkosított partíció külön zároló állományt használ.</p></div></li><li><p>A gbde partíció inicializálása</p><div class=paragraph><p>A gbde által használt partíciókat használatuk elõtt inicializálni kell. Ezt a mûveletet azonban csak egyszer kell elvégezni:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># gbde init /dev/ad4s1c -i -L /etc/gbde/ad4s1c.lock</span></code></pre></div></div><div class=paragraph><p>A <a href="https://man.freebsd.org/cgi/man.cgi?query=gbde&amp;sektion=8&amp;format=html">gbde(8)</a> ekkor elindít egy szövegszerkesztõt és benne egy sablon segítségével be tudjuk állítani a különbözõ konfigurációs értékeket. Az UFS1 vagy UFS2 használata esetén állítsuk a szektorméretet 2048-ra:</p></div><div class="literalblock programlisting"><div class=content><pre>$FreeBSD: src/sbin/gbde/template.txt,v 1.1 2002/10/20 11:16:13 phk Exp $
#
# Sector size is the smallest unit of data which can be read or written.
# Making it too small decreases performance and decreases available space.
# Making it too large may prevent filesystems from working.  512 is the
# minimum and always safe.  For UFS, use the fragment size
#
sector_size     =       2048
[...]</pre></div></div><div class=paragraph><p>A megjegyzés fordítása:</p></div><div class="literalblock programlisting"><div class=content><pre>A szektorméret az adatok írásának és olvasásának legkisebb egysége.  Ha
túlságosan kicsire választjuk meg, akkor csökken a teljesítmény és csökken a
rendelkezésre álló hely.  Ha viszont túlságosan nagyra hagyjuk, akkor azzal
akadályozzuk az állományrendszerek munkáját.  512 a legkisebb érték, amely mindig
megbízható.  Az UFS esetén használjuk a fragmensek méretét.</pre></div></div><div class=paragraph><p>A <a href="https://man.freebsd.org/cgi/man.cgi?query=gbde&amp;sektion=8&amp;format=html">gbde(8)</a> kétszer is rá fog kérdeni az adatok titkosítására használt jelmondatra. A jelmondatnak természetesen mind a kétszer ugyanannak kell lennie. A gbde védelmének hatékonysága teljesen mértékben az általunk választott jelmondat minõségétõl függ .</p></div><div class=paragraph><p>A <code>gbde init</code> parancs létrehoz egy zároló állományt a gbde partícióhoz, amely ebben a példában az <span class=filename>/etc/gbde/ad4s1c.lock</span> néven keletkezett. A gbde zároló állományainak ".lock" névre kell végzõdniük, mivel az <span class=filename>/etc/rc.d/gbde</span> indítószkript csak ebben az esetben észleli rendesen.</p></div><div class="admonitionblock caution"><table><tbody><tr><td class=icon><i class="fa icon-caution" title=Caution></i></td><td class=content><div class=paragraph><p>A gbde zároló állományait a titkosított partíciók tartalmával együtt <em>kell</em> lementeni. Miközben a zároló állomány törlése nem tudja megakadályozni, hogy az elszánt támadó visszafejtse a gbde által titkosított partíciót, addig a zároló állomány nélkül a jogos tulajdonos órási mennyiségû munka befektetése nélkül képtelen lesz hozzáférni a rajta levõ adatokhoz. Ez utóbbitól egyébként a <a href="https://man.freebsd.org/cgi/man.cgi?query=gbde&amp;sektion=8&amp;format=html">gbde(8)</a> és a rendszer tervezõje is totálisan elhatárolja magát.</p></div></td></tr></tbody></table></div></li><li><p>A titkosított partíció illesztése a rendszermaghoz</p><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># gbde attach /dev/ad4s1c -l /etc/gbde/ad4s1c.lock</span></code></pre></div></div><div class=paragraph><p>Ekkor a titkosított partíció illesztéséhez a rendszer kérni fogja az inicializálás során választott jelmondatot. Ezután az új titkosított eszköz megjelenik a <span class=filename>/dev</span> könyvtárban <span class=filename>/dev/eszköznév.bde</span> néven:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># ls /dev/ad*</span>
/dev/ad0        /dev/ad0s1b     /dev/ad0s1e     /dev/ad4s1
/dev/ad0s1      /dev/ad0s1c     /dev/ad0s1f     /dev/ad4s1c
/dev/ad0s1a     /dev/ad0s1d     /dev/ad4        /dev/ad4s1c.bde</code></pre></div></div></li><li><p>Állományrendszer kialakítása egy titkosított eszközön</p><div class=paragraph><p>Ahogy sikerült a titkosított eszközt illeszteni a rendszermaghoz, létre is tudunk hozni egy állományrendszert rajta. Erre a célra a <a href="https://man.freebsd.org/cgi/man.cgi?query=newfs&amp;sektion=8&amp;format=html">newfs(8)</a> remekül használható. Mivel egy új UFS2 állományrendszerek inicializálása sokkal gyorsabb a régi UFS1 állományrendszerek inicializálásánál, ezért a <a href="https://man.freebsd.org/cgi/man.cgi?query=newfs&amp;sektion=8&amp;format=html">newfs(8)</a> használata esetén az <code>-O2</code> beállítás megadása ajánlott.</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># newfs -U -O2 /dev/ad4s1c.bde</span></code></pre></div></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>A <a href="https://man.freebsd.org/cgi/man.cgi?query=newfs&amp;sektion=8&amp;format=html">newfs(8)</a> parancsot egy illesztett gbde partíción kell végrehajtani, amit onnan ismerhetünk meg, hogy az eszköz nevében szerepel a <span class=filename>*.bde</span> kiterjesztés.</p></div></td></tr></tbody></table></div></li><li><p>A titkosított partíció csatlakoztatása</p><div class=paragraph><p>Hozzunk létre egy csatlakozási pontot a titkosított állományrendszer számára.</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># mkdir /privát</span></code></pre></div></div><div class=paragraph><p>Csatlakoztassuk a titkosított állományrendszert.</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># mount /dev/ad4s1c.bde /privát</span></code></pre></div></div></li><li><p>Ellenõrizzük a titkosított állományrendszer mûködõképességét</p><div class=paragraph><p>A titkosított állományrendszert most már látja a <a href="https://man.freebsd.org/cgi/man.cgi?query=df&amp;sektion=1&amp;format=html">df(1)</a> program és készen áll a használatra.</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>% <span class=nb>df</span> <span class=nt>-H</span>
Filesystem        Size   Used  Avail Capacity  Mounted on
/dev/ad0s1a      1037M    72M   883M     8%    /
/devfs            1.0K   1.0K     0B   100%    /dev
/dev/ad0s1f       8.1G    55K   7.5G     0%    /home
/dev/ad0s1e      1037M   1.1M   953M     0%    /tmp
/dev/ad0s1d       6.1G   1.9G   3.7G    35%    /usr
/dev/ad4s1c.bde   150G   4.1K   138G     0%    /private</code></pre></div></div></li></ol></div></div></div></div><div class=sect4><h5 id=_létezõ_titkosított_állományrendszerek_csatlakoztatása>18.16.1.2. Létezõ titkosított állományrendszerek csatlakoztatása<a class=anchor href=#_létezõ_titkosított_állományrendszerek_csatlakoztatása></a></h5><div class=paragraph><p>A rendszer minden egyes indítása után az összes titkosított állományrendszert tényleges használata elõtt újra illeszteni kell a rendszermaghoz, ellenõrizni az épségét és csatlakoztatni. Az ehhez szükséges parancsokat <code>root</code> felhasználóként kell kiadni.</p></div><div class="exampleblock procedure"><div class=content><div class="olist arabic"><ol class=arabic><li><p>A gbde partíció illesztése a rendszermaghoz</p><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># gbde attach /dev/ad4s1c -l /etc/gbde/ad4s1c.lock</span></code></pre></div></div><div class=paragraph><p>A gbde partíció inicializálása során megadott jelmondatot kell megadnunk a mûvelet elvégzéséhez.</p></div></li><li><p>Az állományrendszer épségének ellenõrzése</p><div class=paragraph><p>Mivel a titkosított állományrendszerek az automatikus csatlakoztatáshoz még nem szerepeltethetõek az <span class=filename>/etc/fstab</span> állományban, ezért az ilyen állományrendszereket csatlakoztatásuk elõtt manuálisan ellenõriztetni kell a <a href="https://man.freebsd.org/cgi/man.cgi?query=fsck&amp;sektion=8&amp;format=html">fsck(8)</a> lefuttatásával.</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># fsck -p -t ffs /dev/ad4s1c.bde</span></code></pre></div></div></li><li><p>A titkosított állományrendszer csatlakoztatása</p><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># mount /dev/ad4s1c.bde /privát</span></code></pre></div></div><div class=paragraph><p>A titkosított állományrendszer most már készen áll a használatra.</p></div></li></ol></div></div></div><div class=sect5><h6 id=_a_titkosított_partíciók_önálló_csatlakoztatása>18.16.1.2.1. A titkosított partíciók önálló csatlakoztatása<a class=anchor href=#_a_titkosított_partíciók_önálló_csatlakoztatása></a></h6><div class=paragraph><p>Lehet írni olyan szkriptet, amely a titkosított partíciókat magától illeszti, ellenõrzi és csatlakoztatja, de biztonsági megfontolásokból semmi esetben sem szabad tartalmaznia a <a href="https://man.freebsd.org/cgi/man.cgi?query=gbde&amp;sektion=8&amp;format=html">gbde(8)</a> jelszavát. Ehelyett azt javasoljuk, hogy az ilyen szkripteknek külön meg kelljen adni a jelszót konzolon vagy az <a href="https://man.freebsd.org/cgi/man.cgi?query=ssh&amp;sektion=1&amp;format=html">ssh(1)</a> használatán keresztül.</p></div><div class=paragraph><p>De használhatjuk a mellékelt <span class=filename>rc.d</span> szkriptet is. A szkript paramétereit az <a href="https://man.freebsd.org/cgi/man.cgi?query=rc.conf&amp;sektion=5&amp;format=html">rc.conf(5)</a> állományon keresztül adhatjuk meg, például:</p></div><div class="literalblock programlisting"><div class=content><pre>gbde_autoattach_all=&#34;YES&#34;
gbde_devices=&#34;ad4s1c&#34;
gbde_lockdir=&#34;/etc/gbde&#34;</pre></div></div><div class=paragraph><p>Ilyenkor a gbde által használt jelmondatot a rendszer indításakor kell megadni. Miután begépeltük a megfelelõ jelmondatot, a titkosított gbde partíció magától csatlakoztatásra kerül. Ez akkor lehet hasznos, ha a gbde megoldását hordozható számítógépeken alkalmazzuk.</p></div></div></div><div class=sect4><h5 id=_a_gbde_által_alkalmazott_titkosítási_módszerek>18.16.1.3. A gbde által alkalmazott titkosítási módszerek<a class=anchor href=#_a_gbde_által_alkalmazott_titkosítási_módszerek></a></h5><div class=paragraph><p>A <a href="https://man.freebsd.org/cgi/man.cgi?query=gbde&amp;sektion=8&amp;format=html">gbde(8)</a> a szektorok tartalmát 128 bites AES használatával CBC módban titkosítja. A lemezen található minden egyes szektort eltérõ AES kulccsal kódolja. A gbde kriptográfiai felépítését, valamint mindazt, hogy az egyes szektorok kulcsai miként származtathatóak a felhasználó által megadott jelmondatból, a <a href="https://man.freebsd.org/cgi/man.cgi?query=gbde&amp;sektion=4&amp;format=html">gbde(4)</a> man oldalán olvashatjuk.</p></div></div><div class=sect4><h5 id=_kompatibilitási_problémák>18.16.1.4. Kompatibilitási problémák<a class=anchor href=#_kompatibilitási_problémák></a></h5><div class=paragraph><p>A <a href="https://man.freebsd.org/cgi/man.cgi?query=sysinstall&amp;sektion=8&amp;format=html">sysinstall(8)</a> nem kompatibilis a gbde által titkosított eszközökkel. A <a href="https://man.freebsd.org/cgi/man.cgi?query=sysinstall&amp;sektion=8&amp;format=html">sysinstall(8)</a> indítása elõtt minden <span class=filename>*.bde</span> eszközt ki kell iktatni a rendszermagból, különben az eszközök keresése során össze fog omlani. A példánkban használt titkosított eszközt a következõ paranccsal kell lekapcsolni:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># gbde detach /dev/ad4s1c</span></code></pre></div></div><div class=paragraph><p>Továbbá megjegyezzük azt is, hogy a <a href="https://man.freebsd.org/cgi/man.cgi?query=vinum&amp;sektion=4&amp;format=html">vinum(4)</a> nem használja a <a href="https://man.freebsd.org/cgi/man.cgi?query=geom&amp;sektion=4&amp;format=html">geom(4)</a> alrendszert, ezért a gbde alkalmazása során nem használhatunk Vinum-köteteket.</p></div></div></div><div class=sect3><h4 id=_a_lemezek_titkosítása_a_geli_használatával>18.16.2. A lemezek titkosítása a <code>geli</code> használatával<a class=anchor href=#_a_lemezek_titkosítása_a_geli_használatával></a></h4><div class=paragraph><p>A FreeBSD 6.0 változatától kezdve egy új kriptográfiai GEOM osztály is a rendelkezésünkre áll, melyet pillanatnyilag Paweł Jakub Dawidek &lt;<a href=mailto:pjd@FreeBSD.org>pjd@FreeBSD.org</a>> fejleszt. A <code>geli</code> segédprogram némileg különbözõ a <code>gbde</code> megoldásától - más lehetõségeket kínál fel és a titkosítást is egy eltérõ séma mentén valósítja meg.</p></div><div class=paragraph><p>A <a href="https://man.freebsd.org/cgi/man.cgi?query=geli&amp;sektion=8&amp;format=html">geli(8)</a> legfontosabb jellemzõi a következõk:</p></div><div class=ulist><ul><li><p>A <a href="https://man.freebsd.org/cgi/man.cgi?query=crypto&amp;sektion=9&amp;format=html">crypto(9)</a> keretrendszerét használja - tehát ha rendelkezünk kriptográfiai hardverrel, akkor a <code>geli</code> automatikusan használni fogja.</p></li><li><p>Több kriptográfiai algoritmust is ismer (melyek jelenleg az AES, Blowfish és a 3DES).</p></li><li><p>Segítségével a rendszerindításhoz használt (gyökér) partíció is titkosítható. Ilyenkor a szükséges jelmondatot a rendszer indításakor kell megadni.</p></li><li><p>Két független kulcsot (például egy "kulcsot" és egy "céges kulcsot") is használhatunk vele.</p></li><li><p>A <code>geli</code> gyors - egyszerûen csak szektorról szektorra titkosít.</p></li><li><p>Lehetõvé teszi a mesterkulcsok mentését is visszaállítását. Ha a felhasználó véletlenül megsemmisítené a kulcsát, akkor a biztonsági mentésbõl helyreállított kulcsok segítségével vissza tudjuk szerezni az adatainkat is.</p></li><li><p>Segítségével a lemezeket véletlenszerû, egyszeri jelszavakkal is illeszthetjük - ez különösen fontos lapozóterületek és ideiglenes állományrendszerek esetében.</p></li></ul></div><div class=paragraph><p>A <code>geli</code> által felkínált lehetõségekrõl a <a href="https://man.freebsd.org/cgi/man.cgi?query=geli&amp;sektion=8&amp;format=html">geli(8)</a> man oldalán találhatunk többet.</p></div><div class=paragraph><p>A következõ lépések bemutatják, hogyan lehet a FreeBSD rendszermagjában engedélyezni a <code>geli</code> támogatását, és hogyan lehet létrehozni és használni egy <code>geli</code> titkosítással rendelkezõ adathordozót.</p></div><div class=paragraph><p>A <code>geli</code> alkalmazásához legalább a FreeBSD 6.0-RELEASE vagy késõbbi változatára van szükségünk. Mivel a rendszermagot is módosítanunk kell, ezért rendszeradminisztrátori jogosultságok kellenek a mûveletek elvégzéséhez.</p></div><div class="exampleblock procedure"><div class=content><div class="olist arabic"><ol class=arabic><li><p>A <code>geli</code> támogatásának hozzáadása a rendszermaghoz</p><div class=paragraph><p>Vegyük hozzá a következõ sorokat a rendszermag beállításait tartalmazó állományhoz:</p></div><div class="literalblock programlisting"><div class=content><pre>options GEOM_ELI
device crypto</pre></div></div><div class=paragraph><p>Fordítsuk újra a rendszermagot a <a href=./#kernelconfig>A FreeBSD rendszermag testreszabása</a>ben leírtak szerint.</p></div><div class=paragraph><p>Betölthetjük a <code>geli</code> modulját is a rendszer indításakor. Ehhez a következõ sort kell betenni a <span class=filename>/boot/loader.conf</span> állományba:</p></div><div class="literalblock programlisting"><div class=content><pre>geom_eli_load=&#34;YES&#34;</pre></div></div><div class=paragraph><p>A <a href="https://man.freebsd.org/cgi/man.cgi?query=geli&amp;sektion=8&amp;format=html">geli(8)</a> most már használható a rendszermagban.</p></div></li><li><p>A mesterkulcs legenerálása</p><div class=paragraph><p>A most következõ példában egy kulcsot tartalmazó állomány létrehozását illusztráljuk, amit a <span class=filename>/privát</span> könyvtárba csatlakoztatott titkosított adathordozó mesterkulcsához fogunk használni. A kulcs állomány a mesterkulcs titkosításához felhasznált véletlenszerû adatot fogja tartalmazni, valamint rajta kívül még a mesterkulcsot egy jelmondattal is védjük. Az adathordozó szektormérete 4 kilobyte-os lesz. Emellett még bemutatjuk, hogyan kell illeszteni egy <code>geli</code>-adathordozót, állományrendszert létrehozni rajta, csatlakoztatni, dolgozni vele és lekapcsolni.</p></div><div class=paragraph><p>A nagyobb teljesítmény érdekében javasolt nagyobb szektorméretet választani (mint például 4 kilobyte).</p></div><div class=paragraph><p>A mesterkulcsot egy jelmondattal fogjuk védeni és a kulcsok készítéséhez használt adatforrás a <span class=filename>/dev/random</span> lesz. A <span class=filename>/dev/da2.eli</span>, amelyet mit csak adathordozónak fogunk csak hívni, szektorainak mérete 4 kilobyte lesz.</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># dd if=/dev/random of=/root/da2.key bs=64 count=1</span>
<span class=c># geli init -s 4096 -K /root/da2.key /dev/da2</span>
Enter new passphrase:
Reenter new passphrase:</code></pre></div></div><div class=paragraph><p>Nem kötelezõ egyszerre használni a jelmondatot és a kulcs állományt. A mesterkulcs elzárásának bebiztosítására bármelyik módszer alkalmas.</p></div><div class=paragraph><p>Ha a kulcs állomány a "-" paraméterrel adjuk meg, akkor a szabványos bemenetrõl olvassa be a program. Ez a példa több kulcs használatát mutatja be.</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># cat kulcs1 kulcs2 kulcs3 | geli init -K - /dev/da2</span></code></pre></div></div></li><li><p>Az adathordozó illesztése a generált kulccsal</p><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># geli attach -k /root/da2.key /dev/da2</span>
Enter passphrase:</code></pre></div></div><div class=paragraph><p>Az új titkosítatlan eszköz neve <span class=filename>/dev/da2.eli</span> lesz.</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># ls /dev/da2*</span>
/dev/da2  /dev/da2.eli</code></pre></div></div></li><li><p>Az új állományrendszer kialakítása</p><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># dd if=/dev/random of=/dev/da2.eli bs=1m</span>
<span class=c># newfs /dev/da2.eli</span>
<span class=c># mount /dev/da2.eli /privát</span></code></pre></div></div><div class=paragraph><p>A titkosított állományrendszer most már <a href="https://man.freebsd.org/cgi/man.cgi?query=df&amp;sektion=1&amp;format=html">df(1)</a> számára is látszik és használható:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># df -H</span>
Filesystem     Size   Used  Avail Capacity  Mounted on
/dev/ad0s1a    248M    89M   139M    38%    /
/devfs         1.0K   1.0K     0B   100%    /dev
/dev/ad0s1f    7.7G   2.3G   4.9G    32%    /usr
/dev/ad0s1d    989M   1.5M   909M     0%    /tmp
/dev/ad0s1e    3.9G   1.3G   2.3G    35%    /var
/dev/da2.eli   150G   4.1K   138G     0%    /private</code></pre></div></div></li><li><p>Az adathordozó leválasztása és lekapcsolása</p><div class=paragraph><p>Miután befejeztük a munkát a titkosított partíción, és a <span class=filename>/privát</span> partícióra már nincs tovább szükségünk, érdemes leválasztanunk és kiiktatnunk a <code>geli</code> titkosítású partíciót a rendszermagból.</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># umount /privát</span>
<span class=c># geli detach da2.eli</span></code></pre></div></div></li></ol></div></div></div><div class=paragraph><p>A <a href="https://man.freebsd.org/cgi/man.cgi?query=geli&amp;sektion=8&amp;format=html">geli(8)</a> használatáról bõvebben a saját man oldalán tájékozódhatunk.</p></div><div class=sect4><h5 id=_a_geli_rc_d_szkriptjének_használata>18.16.2.1. A <span class=filename>geli</span> <span class=filename>rc.d</span> szkriptjének használata<a class=anchor href=#_a_geli_rc_d_szkriptjének_használata></a></h5><div class=paragraph><p>A <code>geli</code> mellett találhatunk egy saját <span class=filename>rc.d</span> szkriptet, amely jelentõsen leegyszerûsíti a <code>geli</code> használatát. A <code>geli</code> például így paraméterezhetõ az <a href="https://man.freebsd.org/cgi/man.cgi?query=rc.conf&amp;sektion=5&amp;format=html">rc.conf(5)</a> állományon keresztül:</p></div><div class="literalblock programlisting"><div class=content><pre>geli_devices=&#34;da2&#34;
geli_da2_flags=&#34;-p -k /root/da2.key&#34;</pre></div></div><div class=paragraph><p>Ennek segítségével a <span class=filename>/dev/da2</span> eszközt <code>geli</code> adathordozóként állítjuk be a <span class=filename>/root/da2.key</span> állományban található mesterkulcs felhasználásával, de az illesztéskor a <code>geli</code> nem kér jelmondatot (ezt csak akkor fogja tenni, ha a <code>geli init</code> parancs kiadásához hozzátesszük a <code>-P</code> beállítást). A rendszer leállítása elõtt pedig a <code>geli</code> adathordozó így automatikusan leválasztásra kerül.</p></div><div class=paragraph><p>Az <span class=filename>rc.d</span> beállításával kapcsolatos tudnivalókat a kézikönyv <a href=./#configtuning-rcd>rc.d</a> szkriptekrõl szóló szakaszában ismerhetjük meg.</p></div></div></div></div><div class=sect2><h3 id=swap-encrypting>18.17. A lapozóterület titkosítása<a class=anchor href=#swap-encrypting></a></h3><div class=paragraph><p>A FreeBSD-ben a lapozóterület titkosítása nagyon könnyen beállítható és már a FreeBSD 5.3-RELEASE változata óta elérhetõ. Attól függõen, hogy konkrétan a FreeBSD melyik verzióját használjuk, a konfigurációhoz kapcsolódó beállítások némileg eltérhetnek. A FreeBSD 6.0-RELEASE változatától kezdõdõen a <a href="https://man.freebsd.org/cgi/man.cgi?query=gbde&amp;sektion=8&amp;format=html">gbde(8)</a> és a <a href="https://man.freebsd.org/cgi/man.cgi?query=geli&amp;sektion=8&amp;format=html">geli(8)</a> alrendszerek is használhatóak a lapozóterület titkosítására. A korábbi verziókban egyedül csak a <a href="https://man.freebsd.org/cgi/man.cgi?query=gbde&amp;sektion=8&amp;format=html">gbde(8)</a> érhetõ el. Mind a két rendszer az <span class=filename>encswap</span> <a href=./#configtuning-rcd>rc.d</a> szkriptet használja.</p></div><div class=paragraph><p>Az elõzõ szakaszban, vagyis a <a href=#disks-encrypting>A lemezpartíciók titkosításá</a>ban már röviden összefoglaltuk a különbözõ titkosítással foglalkozó alrendszereket.</p></div><div class=sect3><h4 id=_miért_kellene_titkosítanunk_a_lapozóterületet>18.17.1. Miért kellene titkosítanunk a lapozóterületet?<a class=anchor href=#_miért_kellene_titkosítanunk_a_lapozóterületet></a></h4><div class=paragraph><p>Hasonlóan a lemezpartíciók titkosításához, a lapozóterület titkosításának is az a célja, hogy védjük az érzékeny információkat. Képzeljük el, hogy egy olyan alkalmazással dolgozunk, amely jelszavakat kezel. Amíg ezek a jelszavak a memóriában maradnak, addig minden a legnagyobb rendben van. Azonban amikor az operációs rendszer nekilát a fizikai memória felszabadításához kilapozni ezeket az adatokat, a jelszavak titkosítatlanul kerülnek a lemez felületére és egy támadó számára könnyû prédává válnak. Ilyen helyzetekben csak lapozóterület titkosítása jelenthet megoldást.</p></div></div><div class=sect3><h4 id=_elõkészületek>18.17.2. Elõkészületek<a class=anchor href=#_elõkészületek></a></h4><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>A szakasz további részében a <span class=filename>ad0s1b</span> lesz a lapozásra használt partíció.</p></div></td></tr></tbody></table></div><div class=paragraph><p>Egészen mostanáig nem titkosítottuk a lapozóterületet. Így elképzelhetõ, hogy a lemezre már titkosítatlanul kikerültek jelszavak vagy bármilyen más érzékeny adatok. A csorba kiköszörülésére a lapozóterületen található összes adatot írjuk felül véletlenszerûen generált szeméttel:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># dd if=/dev/random of=/dev/ad0s1b bs=1m</span></code></pre></div></div></div><div class=sect3><h4 id=_a_lapozóterület_titkosítása_a_gbde8_használatával>18.17.3. A lapozóterület titkosítása a <a href="https://man.freebsd.org/cgi/man.cgi?query=gbde&amp;sektion=8&amp;format=html">gbde(8)</a> használatával<a class=anchor href=#_a_lapozóterület_titkosítása_a_gbde8_használatával></a></h4><div class=paragraph><p>Ha a FreeBSD 6.0-RELEASE vagy újabb változatát használjuk, akkor az <span class=filename>/etc/fstab</span> állományban tegyük hozzá a <code>.bde</code> utótagot az a lapozóterülethez tartozó eszköz nevéhez.</p></div><div class="literalblock programlisting"><div class=content><pre># Device                Mountpoint      FStype  Options         Dump    Pass#
/dev/ad0s1b.bde         none            swap    sw              0       0</pre></div></div><div class=paragraph><p>A FreeBSD 6.0-RELEASE elõtti kiadások esetében a következõ sort is hozzá kell tennünk az <span class=filename>/etc/rc.conf</span> állományhoz:</p></div><div class="literalblock programlisting"><div class=content><pre>gbde_swap_enable=&#34;YES&#34;</pre></div></div></div><div class=sect3><h4 id=_a_lapozóterület_titkosítása_a_geli8_használatával>18.17.4. A lapozóterület titkosítása a <a href="https://man.freebsd.org/cgi/man.cgi?query=geli&amp;sektion=8&amp;format=html">geli(8)</a> használatával<a class=anchor href=#_a_lapozóterület_titkosítása_a_geli8_használatával></a></h4><div class=paragraph><p>A <a href="https://man.freebsd.org/cgi/man.cgi?query=gbde&amp;sektion=8&amp;format=html">gbde(8)</a> használatához hasonlóan a <a href="https://man.freebsd.org/cgi/man.cgi?query=geli&amp;sektion=8&amp;format=html">geli(8)</a> által felajánlott titkosítást is alkalmazhatjuk a lapozóterület védelmére. Ilyenkor az <span class=filename>/etc/fstab</span> állományban az <code>.eli</code> utótagot kell hozzátenni a lapozóterülethez tartozó eszköz névhez.</p></div><div class="literalblock programlisting"><div class=content><pre># Device                Mountpoint      FStype  Options         Dump    Pass#
/dev/ad0s1b.eli         none            swap    sw              0       0</pre></div></div><div class=paragraph><p>Az <a href="https://man.freebsd.org/cgi/man.cgi?query=geli&amp;sektion=8&amp;format=html">geli(8)</a> az AES algoritmust alapértelmezés szerint 256 bites kulccsal használja.</p></div><div class=paragraph><p>Ezek az alapértelmezések megváltoztathatóak az <span class=filename>/etc/rc.conf</span> állományban a <code>geli_swap_flags</code> beállítás használatával. A következõ sor arra utasítja az <span class=filename>encswap</span> rc.d szkriptet, hogy a <a href="https://man.freebsd.org/cgi/man.cgi?query=geli&amp;sektion=8&amp;format=html">geli(8)</a> és a Blowfish algoritmus használatával hozzon létre egy lapozópartíciót 128 bites kulccsal, 4 kilobyte-os szektormérettel és a "detach on last close" ("lekapcsolás használat után") beállítással:</p></div><div class="literalblock programlisting"><div class=content><pre>geli_swap_flags=&#34;-e blowfish -l 128 -s 4096 -d&#34;</pre></div></div><div class=paragraph><p>A FreeBSD 6.2-RELEASE verzió elõtti rendszerekben a következõ sort kell használni:</p></div><div class="literalblock programlisting"><div class=content><pre>geli_swap_flags=&#34;-a blowfish -l 128 -s 4096 -d&#34;</pre></div></div><div class=paragraph><p>A többi beállításhoz a <a href="https://man.freebsd.org/cgi/man.cgi?query=geli&amp;sektion=8&amp;format=html">geli(8)</a> man oldalán a <code>onetime</code> parancs leírását érdemes áttanulmányozni.</p></div></div><div class=sect3><h4 id=_ellenõrizzük_a_mûködését>18.17.5. Ellenõrizzük a mûködését<a class=anchor href=#_ellenõrizzük_a_mûködését></a></h4><div class=paragraph><p>Miután újraindítottuk a rendszert, a titkosított lapozóterület helyes mûködését a <code>swapinfo</code> paranccsal ellenõrizhetjük le.</p></div><div class=paragraph><p>A <a href="https://man.freebsd.org/cgi/man.cgi?query=gbde&amp;sektion=8&amp;format=html">gbde(8)</a> esetében:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>% swapinfo
Device          1K-blocks     Used    Avail Capacity
/dev/ad0s1b.bde    542720        0   542720     0%</code></pre></div></div><div class=paragraph><p>Valamint a <a href="https://man.freebsd.org/cgi/man.cgi?query=geli&amp;sektion=8&amp;format=html">geli(8)</a> esetében:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>% swapinfo
Device          1K-blocks     Used    Avail Capacity
/dev/ad0s1b.eli    542720        0   542720     0%</code></pre></div></div></div></div></div></div><div class=sect1><h2 id=geom>Chapter 19. GEOM: A moduláris lemezszervező rendszer<a class=anchor href=#geom></a></h2><div class=sectionbody><div class=sect2><h3 id=GEOM-synopsis>19.1. Áttekintés<a class=anchor href=#GEOM-synopsis></a></h3><div class=paragraph><p>Ez a fejezet a FreeBSD-ben található GEOM rendszert mutatja be. Ez a rendszer tömöríti az általa is alkalmazott fontosabb RAID-vezérlõ segédprogramokat. A fejezet nem részletezi, hogy a GEOM konkrétan milyen módon kezeli és vezérli az I/O-t, ahogy azt sem, hogyan mûködik az alapjául szolgáló alrendszer vagy hogy néz ki annak forráskódja. Az ilyen jellegû információk a <a href="https://man.freebsd.org/cgi/man.cgi?query=geom&amp;sektion=4&amp;format=html">geom(4)</a> man oldalon, valamint az ott felsorolt helyeken találhatóak meg. Továbbá, ez a fejezet magukról a RAID-konfigurációkról sem ad pontos tájékoztatást. Kizárólag csak a GEOM által is támogatott RAID-besorolásokról esik szó.</p></div><div class=paragraph><p>A fejezet elolvasása során megismerjük:</p></div><div class=ulist><ul><li><p>a GEOM segítségével milyen fajtájú RAID támogatást érhetünk el;</p></li><li><p>hogyan kell használni a rendszer által nyújtott alapvetõ segédeszközöket a különféle RAID-szintek konfigurálásához, karbantartásához és kezeléséhez;</p></li><li><p>hogyan kell a GEOM-on keresztül tükrözni, csíkozni, titkosítani és távolról összekapcsolni lemezes eszközöket;</p></li><li><p>hogyan kell a GEOM rendszerben összekapcsolt lemezeknél felmerülõ hibákat felderíteni.</p></li></ul></div><div class=paragraph><p>A fejezet elolvasásához ajánlott:</p></div><div class=ulist><ul><li><p>megérteni, hogyan kezeli a FreeBSD a lemezes eszközöket (<a href=./#disks>Háttértárak</a>);</p></li><li><p>ismerni, hogyan konfiguráljunk és telepítsünk egy új FreeBSD rendszermagot (<a href=./#kernelconfig>A FreeBSD rendszermag testreszabása</a>).</p></li></ul></div></div><div class=sect2><h3 id=GEOM-intro>19.2. A GEOM bemutatása<a class=anchor href=#GEOM-intro></a></h3><div class=paragraph><p>A GEOM rendszer adatszolgáltatókon vagy speciális <span class=filename>/dev</span>-állományokon keresztül hozzáférést és vezérlést tesz lehetõvé bizonyos osztályokhoz - Master Boot Recordokhoz, BSD-címkékhez stb. Számos szoftveres RAID konfiguráció támogatásával a GEOM transzparens elérést tesz lehetõvé mind az operációs rendszer, mind pedig az általa felkínált segédprogramok számára.</p></div></div><div class=sect2><h3 id=GEOM-striping>19.3. RAID0 - Csíkozás<a class=anchor href=#GEOM-striping></a></h3><div class=paragraph><p>A csíkozás módszerét használjuk abban az esetben, amikor több lemezmeghajtót akarunk egyetlen kötetté összevonni. A GEOM lemezalrendszer szoftveres támogatást nyújt a RAID0, más néven a lemezcsíkozás megvalósításához.</p></div><div class=paragraph><p>Egy RAID0 rendszerben az adatokat blokkokra bontva írjuk fel a tömbben található lemezek között szétosztva. Így ahelyett, hogy meg kellene várnunk 256 kb-nyi adat egyetlen lemezre írását, egy RAID0 rendszerben egyszerre íródik 64 kb-nyi adat négy különbözõ lemezre, és ezáltal gyorsabb elérést szolgáltat. Ez a gyorsaság további lemezvezérlõk használatával még jobban fokozható.</p></div><div class=paragraph><p>Az egy RAID0-csíkozásban résztvevõ lemezek mindegyikének azonos méretûnek kell lennie, mivel az írásra és olvasásra irányuló I/O-kérések a párhuzamos kiszolgálás érdekében összefésülõdnek.</p></div><div class=imageblock><div class=content><img src=../../../../images/books/handbook/geom/striping.png alt="Példa lemezcsíkozásra"></div></div><div class="exampleblock procedure"><div class=content><div class=paragraph><p><strong>Procedure: Csíkozás kialakítása formázatlan ATA-lemezekkel</strong></p></div><div class="olist arabic"><ol class=arabic><li><p>Töltsük be a <span class=filename>geom_stripe.ko</span> modult:</p><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># kldload geom_stripe</span></code></pre></div></div></li><li><p>Bizonyosodjuk meg róla, hogy a rendszerünkben található egy szabad csatlakozási pont. Ha majd ezt a kötetet szánjuk rendszerünk gyökérpartíciójának, használjunk erre a célra egy másik könyvtárat, például a <span class=filename>/mnt</span>-ot:</p><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># mkdir /mnt</span></code></pre></div></div></li><li><p>Keressük meg a csíkozásra felhasználni kívánt lemezek eszközneveit, és hozzunk létre belõlük egy új csíkozott eszközt. Például, ha két használatban nem levõ, particionálatlan ATA-lemezt, név szerint a <span class=filename>/dev/ad2</span> és <span class=filename>/dev/ad3</span> eszközöket akarjunk csíkozni:</p><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># gstripe label -v st0 /dev/ad2 /dev/ad3</span>
Metadata value stored on /dev/ad2.
Metadata value stored on /dev/ad3.
Done.</code></pre></div></div></li><li><p>Az így létrejött új köteten most hozzunk létre egy általános címkét, vagy más néven egy partíciós táblát, és telepítsük fel rá a rendszer alapértelmezett rendszerindító programját:</p><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># bsdlabel -wB /dev/stripe/st0</span></code></pre></div></div></li><li><p>Ezzel meg kellett jelennie további másik két eszköznek is a <span class=filename>/dev/stripe</span> könyvtárban, a <span class=filename>st0</span> eszköz mellett. Ezek többek közt az <span class=filename>st0a</span> és az <span class=filename>st0c</span>. Itt már ki is tudunk alakítani egy állományrendszert az <span class=filename>st0a</span> eszközön a <code>newfs</code> használatával:</p><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># newfs -U /dev/stripe/st0a</span></code></pre></div></div><div class=paragraph><p>Sok-sok számot fogunk látni cikázni a képernyõn, majd néhány másodperc múlva befejezõdik a folyamat. Létrehoztuk a kötetet, ami most már készen áll a becsatolásra.</p></div></li></ol></div></div></div><div class=paragraph><p>A kialakított lemezcsíkozást így tudjuk kézzel csatlakoztatni:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># mount /dev/stripe/st0a /mnt</span></code></pre></div></div><div class=paragraph><p>A csíkozott állományrendszert a rendszerindítás folyamán automatikusan becsatlakoztathatjuk, ha elhelyezzük az alábbi kötetinformációkat az <span class=filename>/etc/fstab</span> állományba. Erre a célra <span class=filename>stripe</span> néven létrehozunk egy állandó csatlakozási pontot:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># mkdir /stripe</span>
<span class=c># echo &#34;/dev/stripe/st0a /stripe ufs rw 2 2&#34; \</span>
      <span class=o>&gt;&gt;</span> /etc/fstab</code></pre></div></div><div class=paragraph><p>A <span class=filename>geom_stripe.ko</span> modult is automatikusan be kell tölteni a rendszerindítás során. Ehhez a következõ sort kell hozzáadni a <span class=filename>/boot/loader.conf</span> állományhoz:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># echo &#39;geom_stripe_load=&#34;YES&#34;&#39; &gt;&gt; /boot/loader.conf</span></code></pre></div></div></div><div class=sect2><h3 id=GEOM-mirror>19.4. RAID1 - Tükrözés<a class=anchor href=#GEOM-mirror></a></h3><div class=paragraph><p>A tükrözés számos vállalatnál és háztartásban alkalmazott technológia, amely az adatok megszakítás nélküli lementésére használatos. Amikor tükrözést használunk, az egyszerûen csak arra utal, hogy a B lemez ugyanazokat az adatokat tartalmazza, mint az A lemez. Vagy amikor a C és D lemez tartalma egyezik meg az A és B lemezekével. Függetlenül a lemezek kiosztásától, itt az a lényeg, hogy az egyik lemez teljes területe vagy az egyik partíciója le van másolva. Késõbb az ezen a módon lementett adatok könnyen visszaállíthatóak anélkül, hogy ez a szolgáltatásban vagy az elérhetõségben bármilyen kimaradást okozna, és akár még fizikailag is biztonságosan tárolhatóak.</p></div><div class=paragraph><p>Elõször is szereznünk kell két egyforma méretû lemezt, valamint a példák feltételezik, hogy ezek a lemezek közvetlen elérésû (<a href="https://man.freebsd.org/cgi/man.cgi?query=da&amp;sektion=4&amp;format=html">da(4)</a>) SCSI-lemezek.</p></div><div class=sect3><h4 id=_az_elsõdleges_lemezek_tükrözése>19.4.1. Az elsõdleges lemezek tükrözése<a class=anchor href=#_az_elsõdleges_lemezek_tükrözése></a></h4><div class=paragraph><p>Tegyük fel, hogy a FreeBSD az elsõ, <span class=filename>da0</span> nevû lemezmeghajtón található, és a <a href="https://man.freebsd.org/cgi/man.cgi?query=gmirror&amp;sektion=8&amp;format=html">gmirror(8)</a> számára ezt szeretnénk megadni az elsõdleges adatok tárolásához.</p></div><div class=paragraph><p>A tükrözés létrehozásának megkezdése elõtt a <code>kern.geom.debugflags</code> <a href="https://man.freebsd.org/cgi/man.cgi?query=sysctl&amp;sektion=8&amp;format=html">sysctl(8)</a> változó megfelelõ beállításával engedélyezzünk további nyomkövetési információkat és hozzáférést az eszközhöz:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># sysctl kern.geom.debugflags=17</span></code></pre></div></div><div class=paragraph><p>Most építsük fel a tükrözést. Kezdjük az egészet a metaadatok elhelyezésével az elsõdleges lemezmeghajtón, tehát tulajdonképpen az alábbi parancs segítségével hozzuk létre a <span class=filename>/dev/mirror/gm</span> eszközt:</p></div><div class="admonitionblock warning"><table><tbody><tr><td class=icon><i class="fa icon-warning" title=Warning></i></td><td class=content><div class=paragraph><p>A rendszerindító meghajtóról készített tükrözés adatvesztést okozhat a lemez utolsó szektorában. Ennek kockázata csökkenthetõ, ha közvetlenül a FreeBSD friss telepítése után állítjuk be a tükrözést.</p></div></td></tr></tbody></table></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># gmirror label -vb round-robin gm0 /dev/da0</span></code></pre></div></div><div class=paragraph><p>Erre a rendszernek a következõ módon kell reagálnia:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>Metadata value stored on /dev/da0.
Done.</code></pre></div></div><div class=paragraph><p>A GEOM inicializálásához szükségünk lesz a <span class=filename>/boot/kernel/geom_mirror.ko</span> modul betöltésére:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># gmirror load</span></code></pre></div></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>A parancs sikeres lefutása után a <span class=filename>/dev/mirror</span> könyvtárban létrehoz egy <span class=filename>gm0</span> eszközleírót.</p></div></td></tr></tbody></table></div><div class=paragraph><p>A <span class=filename>geom_mirror.ko</span> modul betöltését így tudjuk engedélyezni a rendszer indításakor:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># echo &#39;geom_mirror_load=&#34;YES&#34;&#39; &gt;&gt; /boot/loader.conf</span></code></pre></div></div><div class=paragraph><p>Nyissuk meg az <span class=filename>/etc/fstab</span> állományt, és cseréljük le benne az összes korábbi <span class=filename>da0</span> hivatkozást az újonnan kialakított <span class=filename>gm0</span> tükrözés eszközleírójával.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Ha <a href="https://man.freebsd.org/cgi/man.cgi?query=vi&amp;sektion=1&amp;format=html">vi(1)</a> szövegszerkesztõt használjuk, akkor a következõ módon tudjuk ezt egyszerûen megtenni:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># vi /etc/fstab</span></code></pre></div></div><div class=paragraph><p>A <a href="https://man.freebsd.org/cgi/man.cgi?query=vi&amp;sektion=1&amp;format=html">vi(1)</a> indítása után a <code>:w /etc/fstab.bak</code> kiadásával készítsünk az <span class=filename>fstab</span> állomány jelenlegi tartalmáról másolatot. Ezután a <code>:%s/da/mirror\/gm/g</code> parancs használatával cseréljük ki az összes <span class=filename>da0</span> hivatkozást a <span class=filename>gm0</span> eszköz nevére.</p></div></td></tr></tbody></table></div><div class=paragraph><p>Az így keletkezõ <span class=filename>fstab</span> állomány nagyjából következõ módon fog kinézni. Most teljesen független, hogy SCSI vagy ATA meghajtókkal dolgozunk, a RAID eszköz neve mindig <span class=filename>gm</span> lesz:</p></div><div class="literalblock programlisting"><div class=content><pre># Eszköz                Csatlakozási pont   Típus   Beállítások  Dump   Menet
/dev/mirror/gm0s1b      none                swap    sw           0      0
/dev/mirror/gm0s1a      /                   ufs     rw           1      1
/dev/mirror/gm0s1d      /usr                ufs     rw           0      0
/dev/mirror/gm0s1f      /home               ufs     rw           2      2
#/dev/mirror/gm0s2d     /store              ufs     rw           2      2
/dev/mirror/gm0s1e      /var                ufs     rw           2      2
/dev/acd0               /cdrom              cd9660  ro,noauto    0      0</pre></div></div><div class=paragraph><p>Indítsuk újra a rendszert:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># shutdown -r now</span></code></pre></div></div><div class=paragraph><p>Ennek megfelelõen a rendszer indítása közben a <span class=filename>da0</span> eszköz helyett a <span class=filename>gm0</span> eszközt fogjuk használni. Miután sikeresen befejezõdött a rendszerindítás, a <code>mount</code> parancs kiadásával a saját szemünkkel is meggyõzõdhetünk az eredményrõl:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># mount</span>
Filesystem         1K-blocks    Used    Avail Capacity  Mounted on
/dev/mirror/gm0s1a   1012974  224604   707334    24%    /
devfs                      1       1        0   100%    /dev
/dev/mirror/gm0s1f  45970182   28596 42263972     0%    /home
/dev/mirror/gm0s1d   6090094 1348356  4254532    24%    /usr
/dev/mirror/gm0s1e   3045006 2241420   559986    80%    /var
devfs                      1       1        0   100%    /var/named/dev</code></pre></div></div><div class=paragraph><p>A parancs kimenete az elvárásainknak megfelelõen remekül néz ki. Zárásképpen a szinkronizálás megkezdéséhez a következõ paranccsal illesszük be a <span class=filename>da1</span> eszközt a tükrözésbe:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># gmirror insert gm0 /dev/da1</span></code></pre></div></div><div class=paragraph><p>A tükrözés állapota a létrejöttét követõen az alábbi paranccsal ellenõrizhetõ:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># gmirror status</span></code></pre></div></div><div class=paragraph><p>Az iménti parancs eredményének nagyjából a következõnek kell lennie miután a felépítettük a tükrözést és szinkronizáltuk az adatokat:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>      Name    Status  Components
mirror/gm0  COMPLETE  da0
                      da1</code></pre></div></div><div class=paragraph><p>Hiba esetén a tükrözés továbbra is folytatódik, azonban ilyenkor a példában szereplõ <code>COMPLETE</code> helyett a <code>DEGRADED</code> jelzést fogjuk látni.</p></div></div><div class=sect3><h4 id=_hibakeresés_2>19.4.2. Hibakeresés<a class=anchor href=#_hibakeresés_2></a></h4><div class=sect4><h5 id=_a_rendszer_nem_hajlandó_elindulni>19.4.2.1. A rendszer nem hajlandó elindulni<a class=anchor href=#_a_rendszer_nem_hajlandó_elindulni></a></h5><div class=paragraph><p>Ha a rendszerünk ehhez hasonló módon indul:</p></div><div class="literalblock programlisting"><div class=content><pre>ffs_mountroot: can&#39;t find rootvp
Root mount failed: 6
mountroot&gt;</pre></div></div><div class=paragraph><p>Indítsuk újra a gépünket a kikapcsoló gomb vagy a reset segítségével. A rendszerindító menüben válasszuk a hatodik opciót (6). Ennek eredményeképpen megkapjuk a <a href="https://man.freebsd.org/cgi/man.cgi?query=loader&amp;sektion=8&amp;format=html">loader(8)</a> parancssorát. Töltsük be a modult manuálisan:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>OK? load geom_mirror
OK? boot</code></pre></div></div><div class=paragraph><p>Ha ez beválik, akkor valamiért a modult nem sikerült rendesen betölteni. Ellenõrizzük, hogy a <span class=filename>/boot/loader.conf</span> állományban a neki szereplõ megfelelõ bejegyzés helyesen szerepel. Amennyiben a probléma továbbra is fennáll, helyezzük el a következõ sort a rendszermag konfigurációs állományába, majd fordítsuk újra és telepítsük:</p></div><div class="literalblock programlisting"><div class=content><pre>options	GEOM_MIRROR</pre></div></div><div class=paragraph><p>Ezzel várhatóan orvosoltuk a problémát.</p></div></div></div><div class=sect3><h4 id=_a_meghibásodott_lemezek_cseréje>19.4.3. A meghibásodott lemezek cseréje<a class=anchor href=#_a_meghibásodott_lemezek_cseréje></a></h4><div class=paragraph><p>A lemezek tükrözésének egyik legcsodálatosabb elõnye, hogy a menet közben meghibásodott meghajtókat gond, és így feltehetõen adatvesztés nélkül ki tudjuk cserélni.</p></div><div class=paragraph><p>Vegyük az iménti RAID-1 konfigurációt, és tételezzük fel, hogy a <span class=filename>da1</span> eszköz felmondta a szolgáltatot és cserére szorul. A meghajtó leváltásához keressük meg a hibás eszközt, majd állítsuk le a rendszert. Tegyük be a helyére az újat és indítsuk újra a rendszerünket. Miután elindult az operációs rendszer, a következõ parancsok kiadásával tudjuk logikailag is lecserélni a meghibásodott lemezt:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># gmirror forget gm0</span>
<span class=c># gmirror insert gm0 /dev/da1</span></code></pre></div></div><div class=paragraph><p>Innen a <code>gmirror status</code> parancsával kísérhetjük figyelemmel a tükrözés újraszervezésének menetét. Csupán ennyi az egész.</p></div></div></div><div class=sect2><h3 id=geom-ggate>19.5. Eszközök hálózati illesztése a GEOM-ban<a class=anchor href=#geom-ggate></a></h3><div class=paragraph><p>A GEOM távoli eszközök, például lemezek, CD-meghajtók stb. használatát is támogatja a hálózati illesztést szolgáló segédprogramjaival, hasonlóan az NFS-hez.</p></div><div class=paragraph><p>Kezdésként létre kell hozni a megosztást elõsegítõ állományt. Ez az állomány határozza meg, ki és milyen szinten jogosult használni a megosztott erõforrásokat. Például ha megosztjuk az elsõ SCSI-lemezen a negyedik slice-ot, az alábbi <span class=filename>/etc/gg.exports</span> állomány tökéletesen megfelel:</p></div><div class="literalblock programlisting"><div class=content><pre>192.168.1.0/24 RW /dev/da0s4d</pre></div></div><div class=paragraph><p>Ezzel a belsõ hálózaton levõ összes számítógép képes lesz elérni a <span class=filename>da0s4d</span> partíción található állományrendszert.</p></div><div class=paragraph><p>Az eszköz megosztásához elõször gondoskodnunk kell róla, hogy ne legyen csatlakoztatva, majd ezután indítsuk el a <a href="https://man.freebsd.org/cgi/man.cgi?query=ggated&amp;sektion=8&amp;format=html">ggated(8)</a> szerver démonját:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># ggated</span></code></pre></div></div><div class=paragraph><p>Ezt követõen a <code>mount</code> felhasználásával csatoljuk az eszközt a kliensen, az alábbi parancs kiadásával:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># ggatec create -o rw 192.168.1.1 /dev/da0s4d</span>
ggate0
<span class=c># mount /dev/ggate0 /mnt</span></code></pre></div></div><div class=paragraph><p>Innentõl kezdve az eszköz elérhetõ lesz a <span class=filename>/mnt</span> csatlakozási ponton keresztül.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Fontos kiemelnünk, hogy ez a mûvelet eredménytelen, ha az adott eszközt vagy maga a szerver, vagy pedig valamelyik másik kliens már korábban csatolta.</p></div></td></tr></tbody></table></div><div class=paragraph><p>Amikor az eszközre már nincs tovább szükségünk, biztonságosan le tudjuk választani az <a href="https://man.freebsd.org/cgi/man.cgi?query=umount&amp;sektion=8&amp;format=html">umount(8)</a> paranccsal, hasonlóan bármelyik más lemezes eszközhöz.</p></div></div><div class=sect2><h3 id=geom-glabel>19.6. A lemezes eszközök címkézése<a class=anchor href=#geom-glabel></a></h3><div class=paragraph><p>A rendszer indítása közben a FreeBSD rendszermagja a talált eszközöknek megfelelõen mindegyiknek létrehoz egy-egy eszközleírót. Ezzel a próbálgatásos módszerrel együtt jár néhány gond, például mi történik akkor, ha az új lemezes eszközt USB-n keresztül adjuk a rendszerhez? Nagyon valószínû, hogy ez az eszköz megkapja a <span class=filename>da0</span> nevet és ezzel az eredeti <span class=filename>da0</span> eszköz eltolódik a <span class=filename>da1</span> névhez. Ennek köszönhetõen az <span class=filename>/etc/fstab</span> állományban felsorolt állományrendszerek csatolása veszélybe kerül, aminek következtében akár meghiúsulhat a rendszerindulás is.</p></div><div class=paragraph><p>Az egyik lehetséges megoldása a problémának, ha sorbafûzzük a SCSI eszközeinket, és így a SCSI-kártyához kapcsolt újabb eszköz egy addig nem használt számot fog birtokba venni. Mi helyzet azonban az USB-s eszközökkel, amelyek kiüthetik az elsõdleges SCSI-lemezeinket? Ez egyébként azért történhet meg, mert az USB-s eszközöket általában hamarabb keresi a rendszer, mint a SCSI kártyán levõ eszközöket. Megoldhatjuk úgy ezt a gondot, hogy csak azután csatlakoztatjuk az említett eszközöket, miután a rendszer elindult. Megoldhatjuk viszont úgy is, hogy csak egyetlen ATA-meghajtót használunk és soha nem soroljuk fel a SCSI eszközöket az <span class=filename>/etc/fstab</span> állományban.</p></div><div class=paragraph><p>Ezeknél kínálkozik azonban egy jobb megoldás! A <code>glabel</code> nevû segédprogrammal a rendszergazda vagy a felhasználó úgy tudja címkézni a lemezmeghajtókat, hogy azok a <span class=filename>/etc/fstab</span> állományban szereplõ címkéket használják. Mivel a <code>glabel</code> a címkét az adott szolgáltató utolsó szektorában tárolja el, ez a címke megmarad az újraindítás után is. Ha ezt a címkét eszközként használjuk, az állományrendszerek mindig ugyanarról a meghajtóról fognak csatolódni, függetlenül attól, hogy milyen eszközleírón keresztül érjük el ezeket.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Egyáltalán nem állítottuk, hogy egy címke csak állandó lehet. A <code>glabel</code> segítségével egyaránt létre lehet hozni állandó és átmeneti címkéket, de csak az állandó címke képes az újraindítás után is megmaradni. A két címketípus közti különbségeket a <a href="https://man.freebsd.org/cgi/man.cgi?query=glabel&amp;sektion=8&amp;format=html">glabel(8)</a> man oldal tárgyalja részletesebben.</p></div></td></tr></tbody></table></div><div class=sect3><h4 id=_címketípusok_és_példák>19.6.1. Címketípusok és példák<a class=anchor href=#_címketípusok_és_példák></a></h4><div class=paragraph><p>A címkéknek két típusa létezik, az általános címke és az állományrendszer-címke. A címkék lehetnek állandóak vagy ideiglenesek. Az állandó címkék a <a href="https://man.freebsd.org/cgi/man.cgi?query=tunefs&amp;sektion=8&amp;format=html">tunefs(8)</a> vagy <a href="https://man.freebsd.org/cgi/man.cgi?query=newfs&amp;sektion=8&amp;format=html">newfs(8)</a> parancsokkal hozhatóak létre. Ezek a címkék az adott állományrendszer típusa alapján elnevezett alkönyvtárakban jönnek létre a <span class=filename>/dev</span> könyvtáron belül. Például az UFS2 állományrendszer-címkék a <span class=filename>/dev/ufs</span> könyvtárban keletkeznek. Állandó címkék a <code>glabel label</code> paranccsal hozhatóak létre. Az ilyen címkék nem függenek az állományrendszerek típusától, a <span class=filename>/dev/label</span> könyvtárban jönnek létre.</p></div><div class=paragraph><p>Az ideiglenes címkék a következõ induláskor elvesznek. Ezek a címkék a <span class=filename>/dev/label</span> könyvtárban keletkeznek, és ideálisak a kísérletezgetésre. Ideiglenes címkéket a <code>glabel create</code> paranccsal hozhatunk létre. Ezzel kapcsolatosan részletesebb felvilágosítást a <a href="https://man.freebsd.org/cgi/man.cgi?query=glabel&amp;sektion=8&amp;format=html">glabel(8)</a> man oldalon találhatunk.</p></div><div class=paragraph><p>Ha egy UFS2 állományrendszerre szeretnénk tenni egy állandó címkét az adataink megsemmisítése nélkül, adjuk ki a következõ parancsot:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># tunefs -L home /dev/da3</span></code></pre></div></div><div class="admonitionblock warning"><table><tbody><tr><td class=icon><i class="fa icon-warning" title=Warning></i></td><td class=content><div class=paragraph><p>Ha az érintett állományrendszeren nincs üres hely, ennek a parancsnak a használata adatvesztéshez vezethet. Ilyen esetben inkább a felesleges állományok eltávolításával kellene törõdnünk, nem pedig címkék hozzáadásával.</p></div></td></tr></tbody></table></div><div class=paragraph><p>Ezután egy címkének kell megjelennie a <span class=filename>/dev/ufs</span> könyvtárban, amelyet vegyünk is fel az <span class=filename>/etc/fstab</span> állományba:</p></div><div class="literalblock programlisting"><div class=content><pre>/dev/ufs/home		/home            ufs     rw              2      2</pre></div></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Az állományrendszert tilos csatolni a <code>tunefs</code> futtatása alatt!</p></div></td></tr></tbody></table></div><div class=paragraph><p>Most már a megszokott módon csatolhatjuk az állományrendszert:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># mount /home</span></code></pre></div></div><div class=paragraph><p>Ettõl a ponttól kezdve, amíg a <span class=filename>geom_label.ko</span> modul betöltõdik a rendszerindítás során a <span class=filename>/boot/loader.conf</span> állományon keresztül, vagy a <code>GEOM_LABEL</code> opció megtalálható a rendszermag konfigurációs állományában, az eszközleíró a rendszerre nézve minden komolyabb következmény nélkül megváltozhat.</p></div><div class=paragraph><p>Állományrendszereket létrehozhatunk alapértelmezett címkével is a <code>newfs -L</code> paraméterével. Errõl részletesebben a <a href="https://man.freebsd.org/cgi/man.cgi?query=newfs&amp;sektion=8&amp;format=html">newfs(8)</a> man oldalon olvashatunk.</p></div><div class=paragraph><p>Az alábbi paranccsal tudjuk törölni a címkét:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># glabel destroy home</span></code></pre></div></div><div class=paragraph><p>A következõ példában azt láthatjuk, hogyan címkézzük fel a rendszerindító lemezünk partícióit.</p></div><div class=exampleblock><div class=title>Példa 28. Partíciók címkézése a rendszerindító lemezen</div><div class=content><div class=paragraph><p>A rendszerindításra használt lemezen levõ partíciók felcímkézésével a rendszer képes lesz akkor is minden probléma nélkül elindulni, amikor áthelyezzük egy másik vezérlõre vagy átrakjuk egy másik számítógépbe. Például most tegyük fel, hogy van egy ATA csatolós lemezünk, amelyet a rendszer <span class=filename>ad0</span> néven ismert fel. Továbbá azt is feltételezzük, hogy a FreeBSD telepítése esetén megszokott partícionálási sémát választottuk, ahol <span class=filename>/</span>, <span class=filename>/var</span>, <span class=filename>/usr</span> és <span class=filename>/tmp</span> állományrendszereink, valamint egy lapozóterületünk van.</p></div><div class=paragraph><p>Indítsuk újra a rendszerünket és a <a href="https://man.freebsd.org/cgi/man.cgi?query=loader&amp;sektion=8&amp;format=html">loader(8)</a> menüjében a <kbd>4</kbd> billentyû lenyomásával válasszuk az egyfelhasználós módot. Ezt követõen adjuk ki a következõ parancsokat:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># glabel label rootfs /dev/ad0s1a</span>
GEOM_LABEL: Label <span class=k>for </span>provider /dev/ad0s1a is label/rootfs
<span class=c># glabel label var /dev/ad0s1d</span>
GEOM_LABEL: Label <span class=k>for </span>provider /dev/ad0s1d is label/var
<span class=c># glabel label usr /dev/ad0s1f</span>
GEOM_LABEL: Label <span class=k>for </span>provider /dev/ad0s1f is label/usr
<span class=c># glabel label tmp /dev/ad0s1e</span>
GEOM_LABEL: Label <span class=k>for </span>provider /dev/ad0s1e is label/tmp
<span class=c># glabel label swap /dev/ad0s1b</span>
GEOM_LABEL: Label <span class=k>for </span>provider /dev/ad0s1b is label/swap
<span class=c># exit</span></code></pre></div></div><div class=paragraph><p>A rendszer indítása ezután többfelhasználós módban folytatódik. A rendszerindítás befejezõdése után nyissuk meg az <span class=filename>/etc/fstab</span> állományt és írjuk át a hagyományos eszközneveket a hozzájuk tartozó címkékre. Az <span class=filename>/etc/fstab</span> végleges változata ennek megfelelõen körülbelül így fog kinézni:</p></div><div class="literalblock programlisting"><div class=content><pre># Eszköz                 Csatlakozási pont  Típus   Beállítások     Dump    Menet
/dev/label/swap          none               swap    sw              0        0
/dev/label/rootfs        /                  ufs     rw              1        1
/dev/label/tmp           /tmp               ufs     rw              2        2
/dev/label/usr           /usr               ufs     rw              2        2
/dev/label/var           /var               ufs     rw              2        2</pre></div></div><div class=paragraph><p>A rendszer most már újraindítható. Ha mindent jól csináltunk, akkor a rendszer indítása problémáktól mentesen fog zajlani és a <code>mount</code> parancs eredménye a következõ lesz:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># mount</span>
/dev/label/rootfs on / <span class=o>(</span>ufs, <span class=nb>local</span><span class=o>)</span>
devfs on /dev <span class=o>(</span>devfs, <span class=nb>local</span><span class=o>)</span>
/dev/label/tmp on /tmp <span class=o>(</span>ufs, <span class=nb>local</span>, soft-updates<span class=o>)</span>
/dev/label/usr on /usr <span class=o>(</span>ufs, <span class=nb>local</span>, soft-updates<span class=o>)</span>
/dev/label/var on /var <span class=o>(</span>ufs, <span class=nb>local</span>, soft-updates<span class=o>)</span></code></pre></div></div></div></div><div class=paragraph><p>A FreeBSD 7.2 kiadásától kezdõdõen a <a href="https://man.freebsd.org/cgi/man.cgi?query=glabel&amp;sektion=8&amp;format=html">glabel(8)</a> osztály az UFS esetén támogatja az <code>ufsid</code>, az állományrendszer egyedi rendszerszintû azonosítójából származtatott új címketípus használatát. Ezek a címkék a rendszer indítása során a <span class=filename>/dev/ufsid</span> könyvtárban jönnek automatikusan létre. Az <code>ufsid</code> címkéken keresztül tudunk az <span class=filename>/etc/fstab</span> állományban állományrendszereket csatlakoztatni. A jelenleg aktív állományrendszereket és azok <code>ufsid</code> azonosítóit a <code>glabel status</code> paranccsal tudjuk lekérdezni:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>% glabel status
                  Name  Status  Components
ufsid/486b6fc38d330916     N/A  ad4s1d
ufsid/486b6fc16926168e     N/A  ad4s1f</code></pre></div></div><div class=paragraph><p>Ebben a példában az <span class=filename>ad4s1d</span> képviseli a <span class=filename>/var</span> állományrendszert, míg a <span class=filename>ad4s1f</span> a <span class=filename>/usr</span> állományrendszert. Az adott <code>ufsid</code> értékek megadásával az <span class=filename>/etc/fstab</span> állományban a következõképpen tudjuk csatlakoztatni ezeket az állományrendszereket:</p></div><div class="literalblock programlisting"><div class=content><pre>/dev/ufsid/486b6fc38d330916        /var        ufs        rw        2      2
/dev/ufsid/486b6fc16926168e        /usr        ufs        rw        2      2</pre></div></div><div class=paragraph><p>Minden <code>ufsid</code> címkével rendelkezõ partíció csatlakoztatható ezen a módon. Ekkor nem kell manuálisan létrehoznunk a számunkra állandó címkéket, így automatikusan élvethezhetjük az eszköznévtõl független csatlakoztatás elõnyeit.</p></div></div></div><div class=sect2><h3 id=geom-gjournal>19.7. Naplózó UFS GEOM-on keresztül<a class=anchor href=#geom-gjournal></a></h3><div class=paragraph><p>A FreeBSD 7.0-ás verziójának megjelenésével egy rég várt kiegészítés, a naplózás vált végre elérhetõvé vált. Maga az implementáció a GEOM alrendszeren keresztül érhetõ el, és a <a href="https://man.freebsd.org/cgi/man.cgi?query=gjournal&amp;sektion=8&amp;format=html">gjournal(8)</a> segédprogram segítségével könnyedén beállítható.</p></div><div class=paragraph><p>Mit is jelent a naplózás? A naplózás támogatásával a rendszer egy naplót vezet az állományrendszert érintõ tranzakciókról - például az olyan változtatásokról, amelyek egy komplett írási mûveletet eredményeznek - mielõtt még a metaadatok és lemezírási mûveletek szabályosan befejezõdnének. Ez a könyvelés késõbb visszajátszható az állományrendszerben lezajlott tranzakciók reprodukálásához, és ezzel megelõzhetõek az állományrendszerben keletkezõ esetleges ellentmondások.</p></div><div class=paragraph><p>Ez egy újabb módszer az adatvesztés és az állományrendszerben elõforduló ellentmondások elkerülésére. Eltérõen a Soft Updates módszertõl, ahol a metaadatok frissítését biztosítják és követik nyomon, vagy a Snapshots módszertõl, ahol pillanatképeket tárolunk az állományrendszerrõl, itt egy konkrét naplót tárolunk a lemez erre a célra fenntartott részén, amely bizonyos esetekben akár egy teljes külön merevlemez is lehet.</p></div><div class=paragraph><p>Ellentétben a többi naplózó állományrendszertõl, a <code>gjournal</code> módszere blokk alapú és nem az állományrendszer részeként került implementálásra - csupán a GEOM egyik bõvítménye.</p></div><div class=paragraph><p>A <code>gjournal</code> támogatásához a FreeBSD rendszermag konfigurációs állományában be kell állítani a következõ opciót - amely a 7.0 és késõbbi rendszereken alapbeállítás:</p></div><div class="literalblock programlisting"><div class=content><pre>options	UFS_GJOURNAL</pre></div></div><div class=paragraph><p>Amennyiben naplózással rendelkezõ köteteket szeretnénk a rendszerindítás során csatlakoztatni, a <span class=filename>/boot/loader.conf</span> állományban következõ sor hozzáadásával töltessük be a <span class=filename>geom_journal.ko</span> modult:</p></div><div class="literalblock programlisting"><div class=content><pre>geom_journal_load=&#34;YES&#34;</pre></div></div><div class=paragraph><p>Szükség esetén ezt a funkciót akár a rendszermagba is beépíthetjük, ha felvesszük a következõ sort a rendszermag konfigurációs állományába:</p></div><div class="literalblock programlisting"><div class=content><pre>options	GEOM_JOURNAL</pre></div></div><div class=paragraph><p>Ha ezt aktiváltuk, egy szabad állományrendszeren az alábbi lépéseken keresztül tudunk létrehozni egy naplót, feltéve, hogy a <span class=filename>da4</span> egy új SCSI-meghajtó:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># gjournal load</span>
<span class=c># gjournal label /dev/ad4</span></code></pre></div></div><div class=paragraph><p>Ennél a pontnál lennie kell egy <span class=filename>/dev/da4</span> és egy <span class=filename>/dev/da4.journal</span> eszközleírónak. Hozzunk létre egy állományrendszert ezen az eszközön:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># newfs -O 2 -J /dev/da4.journal</span></code></pre></div></div><div class=paragraph><p>Ez a parancs létrehoz egy UFS2 állományrendszert a naplóval rendelkezõ eszközön.</p></div><div class=paragraph><p>Csatoljuk is be a <code>mount</code> segítségével az eszközt kívánt csatlakozási pontra:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># mount /dev/da4.journal /mnt</span></code></pre></div></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Ha több slice-unk is van, akkor a napló mindegyik slice-hoz külön létrejön. Például, ha az <span class=filename>ad4s1</span> és <span class=filename>ad4s2</span> egyaránt slice-ok, akkor a <code>gjournal</code> legyártja az <span class=filename>ad4s1.journal</span> és <span class=filename>ad4s2.journal</span> eszközleírókat.</p></div></td></tr></tbody></table></div><div class=paragraph><p>A jobb teljesítmény elérése érdekében kívánatos lehet a naplót egy másik lemezen tartani. Ilyen esetekben a naplózás bekapcsolásához a naplót biztosító szolgáltatót vagy tárolóeszközt a naplózni kívánt eszköz után kell szerepeltetni. A naplózás akár az aktuálisan használt állományrendszeren is aktiválható a <code>tunefs</code> használatával. Az állományrendszer módosításakor viszont mindig érdemes biztonsági másolatot készíteni! Az esetek többségében a <code>gjournal</code> hibát fog jelezni, mivel nem tudja létrehozni a naplót, azonban ez nem védi meg az adatainkat a <code>tunefs</code> helytelen használata által okozott sérülésektõl.</p></div><div class=paragraph><p>A rendszerindító lemezen is lehet naplózást használni. Ennek részleit a <a href=https://docs.freebsd.org/hu/articles/gjournal-desktop/>Naplózó UFS használata asztali számítógépeken</a> címû cikkbõl ismerhetjük meg.</p></div></div></div></div><div class=sect1><h2 id=filesystems>Chapter 20. Támogatott állományrendszerek<a class=anchor href=#filesystems></a></h2><div class=sectionbody><div class=sect2><h3 id=filesystems-synopsis>20.1. Áttekintés<a class=anchor href=#filesystems-synopsis></a></h3><div class=paragraph><p>Az állományrendszerek szerves részét képezik napjaink operációs rendszereinek. Segítségükkel a felhasználók adatokat tölthetnek fel és tárolhatnak a számítógépen, szabályozhatják a hozzáférésüket, és természetesen mûködtethetik a merevlemezeiket. A különféle operációs rendszerekben általában azért annyi közös, hogy mindannyiukhoz tartozik egy natív, vagyis általuk alapból ismert állományrendszer. A FreeBSD esetében ezt konkrétan a Fast File System vagy röviden FFS, amely az eredeti Unix™ File System, vagy más néven UFS megoldásain alapszik. A FreeBSD tehát a merevlemezeken ebben a natív állományrendszerben tárol adatokat.</p></div><div class=paragraph><p>A FreeBSD természetesen ezen kívül még ismer számos egyéb állományrendszert, ezáltal képes adatokat olvasni más operációs rendszerek részérõl is kezelhetõ partíciókról, például helyi USB-eszközökrõl, flashkártyákról és merevlemezekrõl. Továbbá ismeri néhány más operációs rendszer natív állományrendszerét, mint például a Linux® Extended File System (EXT) vagy éppen a Sun™ Z File System (ZFS).</p></div><div class=paragraph><p>FreeBSD alatt az egyes állományrendszerek ismerete változó. Bizonyos esetekben elegendõ csupán egy megfelelõ modul betöltése, máskor viszont egy komplett eszközkészlet segítségével tudunk velük dolgozni. Ez a fejezet igyekszik a Sun™-féle Z állományrendszerrel kezdõdõen bemutatni a FreeBSD felhasználói számára más állományrendszerek használatát.</p></div><div class=paragraph><p>A fejezet elolvasása során megismerjük:</p></div><div class=ulist><ul><li><p>a natív és támogatott állományrendszerek közti különbségeket;</p></li><li><p>a FreeBSD által ismert állományrendszereket;</p></li><li><p>hogyan engedélyezzünk, állítsunk be és érjünk el nem natív állományrendszereket.</p></li></ul></div><div class=paragraph><p>A fejezet elolvasásához ajánlott:</p></div><div class=ulist><ul><li><p>a UNIX® és FreeBSD alapjainak ismerete (<a href=./#basics>A UNIX alapjai</a>);</p></li><li><p>a rendszermag konfigurációjának és fordításának alapvetõ fogásainak ismerete (<a href=./#kernelconfig>A FreeBSD rendszermag testreszabása</a>);</p></li><li><p>a különbözõ külsõ fejlesztésû szoftverek telepítésének ismerete (<a href=./#ports>Alkalmazások telepítése. csomagok és portok</a>);</p></li><li><p>a lemezek és egyéb tárolóeszközök, valamint a FreeBSD alatt az eszközök elnevezésének minimális ismerete (<a href=./#disks>Háttértárak</a>).</p></li></ul></div></div><div class=sect2><h3 id=filesystems-zfs>20.2. A Z állományrendszer (ZFS)<a class=anchor href=#filesystems-zfs></a></h3><div class=paragraph><p>A Sun™ Z állományrendszere egy új, közös tárolási módszeren nyugvó technológia. Ez annyit jelent a gyakorlatban, hogy mindig csak annyi helyet foglal, amennyire az adatoknak közvetlenül szüksége van. Emellett úgy alakították ki, hogy az adatok épségét minél inkább védje, ezért például megtalálhatjuk benne a pillanatképek készítését, a másolatok létrehozását és az adatok sértetlenségének ellenõrzését. Továbbá egy RAID-Z néven bemutatott új replikációs modellt is támogat. A RAID-Z alapvetõen a RAID-5 megoldásához hasonlít, azonban írás során keletkezõ hibák ellen igyekszik védelmet nyújtani.</p></div><div class=sect3><h4 id=_a_zfs_finomhangolása>20.2.1. A ZFS finomhangolása<a class=anchor href=#_a_zfs_finomhangolása></a></h4><div class=paragraph><p>A ZFS funkcióit megvalósító alrendszer alapértelmezés szerint meglehetõsen sok erõforrást kíván, ezért nem árt a legjobb hatékonyságra behangolnunk a mindennapokban felmerülõ igények mentén. Mivel ez még egy fejlesztés és tesztelés alatt álló része a FreeBSD-nek, elképzelhetõ, hogy ez a jövõben változik, viszont jelen pillanatban a következõ lépéseket javasoljuk.</p></div><div class=sect4><h5 id=_memória>20.2.1.1. Memória<a class=anchor href=#_memória></a></h5><div class=paragraph><p>Hasznos, ha a rendszerünkben legalább 1 GB memória található, de inkább 2 vagy több az ajánlott. Az itt szereplõ példákban ehelyett azonban mindenhol csupán 1 GB-ot feltételezünk.</p></div><div class=paragraph><p>Néhányaknak sikerült 1 GB-nál kevesebb központi memóriával is használni ezt az állományrendszert, azonban ilyenkor nagyon könnyen elõfordulhat, hogy komolyabb terhelés esetén a FreeBSD a memória elfogyása miatt egyszerûen összeomlik.</p></div></div><div class=sect4><h5 id=_a_rendszermag_beállításai>20.2.1.2. A rendszermag beállításai<a class=anchor href=#_a_rendszermag_beállításai></a></h5><div class=paragraph><p>A rendszermag konfigurációs állományából javasolt eltávolítani az összes nem használt meghajtót és funkciót. A legtöbb meghajtó egyébként is elérhetõ modul formájában, és a <span class=filename>/boot/loader.conf</span> állományon keresztül minden gond nélkül betölthetõek.</p></div><div class=paragraph><p>Az i386™ architektúránál szükségünk lesz az alábbi konfigurációs beállítás megadására, majd a rendszermag újrafordítására, végül a rendszer újraindítására:</p></div><div class="literalblock programlisting"><div class=content><pre>options 	KVA_PAGES=512</pre></div></div><div class=paragraph><p>Ezzel az opcióval a rendszermag címterét növeljük meg, aminek eredményeképpen a <code>vm.kvm_size</code> változót immáron az eredetileg 1 GB-os (PAE használata esetén pedig 2 GB-os) határ felé tudjuk állítani. Az itt megadandó értéket úgy tudjuk meghatározni, ha a beállítani kívánt méret MB-okban számolt értékét elosztjuk néggyel. A példában tehát az <code>512</code> egy 2 GB nagyságú címteret ad meg.</p></div></div><div class=sect4><h5 id=_a_rendszertöltõ_beállításai>20.2.1.3. A rendszertöltõ beállításai<a class=anchor href=#_a_rendszertöltõ_beállításai></a></h5><div class=paragraph><p>A <span class=filename>kmem</span> címterét az összes FreeBSD által ismert architektúra esetében érdemes megnövelnünk. A teszteléshez használt rendszeren 1 GB fizikai memória állt rendelkezésre, itt a <span class=filename>/boot/loader.conf</span> állományban a következõ értékek megadásával minden remekül mûködött:</p></div><div class="literalblock programlisting"><div class=content><pre>vm.kmem_size=&#34;330M&#34;
vm.kmem_size_max=&#34;330M&#34;
vfs.zfs.arc_max=&#34;40M&#34;
vfs.zfs.vdev.cache.size=&#34;5M&#34;</pre></div></div><div class=paragraph><p>A ZFS finomhangolásával kapcsolatos további javasolatokat a <a href=http://wiki.freebsd.org/ZFSTuningGuide>http://wiki.freebsd.org/ZFSTuningGuide</a> címen olvashatunk.</p></div></div></div><div class=sect3><h4 id=_a_zfs_használata>20.2.2. A ZFS használata<a class=anchor href=#_a_zfs_használata></a></h4><div class=paragraph><p>A Z állományrendszerhez létezik egy olyan mechanizmus, amelyen keresztül már a FreeBSD indítása során el tudjuk végezni a közös tárolók csatlakoztatását:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># echo &#39;zfs_enable=&#34;YES&#34;&#39; &gt;&gt; /etc/rc.conf</span>
<span class=c># /etc/rc.d/zfs start</span></code></pre></div></div><div class=paragraph><p>A leírás fennmaradó részében feltételezzük, hogy három SCSI-lemezünk van, amelyeket rendre a <span class=filename>da0</span>, <span class=filename>da1</span> és <span class=filename>da2</span> eszközök formájában tudunk elérni. Az IDE lemezek tulajdonosainak értelemszerûen itt majd az <span class=filename>ad</span> eszközneveket kell használniuk a SCSI-eszközök hivatkozásai helyett.</p></div><div class=sect4><h5 id=_egyetlen_közös_tároló_használata>20.2.2.1. Egyetlen közös tároló használata<a class=anchor href=#_egyetlen_közös_tároló_használata></a></h5><div class=paragraph><p>A <code>zpool</code> kiadásával egyetlen lemezen is létre tudunk hozni egy egyszerû, nem redundáns ZFS partíciót:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># zpool create minta /dev/da0</span></code></pre></div></div><div class=paragraph><p>Az új közös tárterület a <code>df</code> parancs felhasználásával rögtön láthatóvá válik:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># df</span>
Filesystem  1K-blocks    Used    Avail Capacity  Mounted on
/dev/ad0s1a   2026030  235230  1628718    13%    /
devfs               1       1        0   100%    /dev
/dev/ad0s1d  54098308 1032846 48737598     2%    /usr
minta        17547136       0 17547136     0%    /minta</code></pre></div></div><div class=paragraph><p>A parancs kimenetében tisztán láthatjuk, hogy a <code>minta</code> nevû tároló nem csak egyszerûen elkészült, hanem egyúttal <em>csatolódott</em>. Innentõl már a többi állományrendszerhez hasonlóan tetszõlegesen elérhetõ, az alábbi példához hasonlóan állományok hozhatóak rajta létre vagy listázható a tartalma:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># cd /minta</span>
<span class=c># ls</span>
<span class=c># touch proba</span>
<span class=c># ls -al</span>
total 4
drwxr-xr-x   2 root  wheel    3 Aug 29 23:15 <span class=nb>.</span>
drwxr-xr-x  21 root  wheel  512 Aug 29 23:12 ..
<span class=nt>-rw-r--r--</span>   1 root  wheel    0 Aug 29 23:15 proba</code></pre></div></div><div class=paragraph><p>Sajnos azonban ez a tároló még ki sem használja a ZFS által felkínált lehetõségeket. Ezért most hozzunk létre egy állományrendszert ezen a tárolón belül és engedélyezzük rajta a tömörítést:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># zfs create minta/tomoritett</span>
<span class=c># zfs set compression=gzip minta/tomoritett</span></code></pre></div></div><div class=paragraph><p>A <code>minta/tomoritett</code> most már egy tömörített Z állományrendszer. Próbáljuk ki mit tud, és másoljunk néhány nagyobb méretû állományt a <span class=filename>/minta/tomoritett</span> könyvtárba.</p></div><div class=paragraph><p>Ezután a tömörítés akár ki is kapcsolható:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># zfs set compression=off minta/tomoritett</span></code></pre></div></div><div class=paragraph><p>Az állományrendszer leválasztásához adjuk ki a lenti parancsot, majd ellenõrizzük az eredményét a <code>df</code> használatával:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># zfs umount minta/tomoritett</span>
<span class=c># df</span>
Filesystem  1K-blocks    Used    Avail Capacity  Mounted on
/dev/ad0s1a   2026030  235232  1628716    13%    /
devfs               1       1        0   100%    /dev
/dev/ad0s1d  54098308 1032864 48737580     2%    /usr
minta        17547008       0 17547008     0%    /minta</code></pre></div></div><div class=paragraph><p>Tegyük ismét elérhetõvé és csatlakoztassuk újra az állományrendszert, majd nézzük meg az eredményt a <code>df</code> paranccsal:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># zfs mount minta/tomoritett</span>
<span class=c># df</span>
Filesystem         1K-blocks    Used    Avail Capacity  Mounted on
/dev/ad0s1a          2026030  235234  1628714    13%    /
devfs                      1       1        0   100%    /dev
/dev/ad0s1d         54098308 1032864 48737580     2%    /usr
minta               17547008       0 17547008     0%    /minta
minta/tomoritett    17547008       0 17547008     0%    /minta/tomoritett</code></pre></div></div><div class=paragraph><p>A közös terület és az állományrendszer mellesleg a <code>mount</code> parancs kimenetébõl is megfigyelhetõ:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># mount</span>
/dev/ad0s1a on / <span class=o>(</span>ufs, <span class=nb>local</span><span class=o>)</span>
devfs on /dev <span class=o>(</span>devfs, <span class=nb>local</span><span class=o>)</span>
/dev/ad0s1d on /usr <span class=o>(</span>ufs, <span class=nb>local</span>, soft-updates<span class=o>)</span>
minta on /minta <span class=o>(</span>zfs, <span class=nb>local</span><span class=o>)</span>
minta/tomoritett on /minta/tomoritett <span class=o>(</span>zfs, <span class=nb>local</span><span class=o>)</span></code></pre></div></div><div class=paragraph><p>Látható, hogy a létrehozásuk után a Z állományrendszerek teljesen hétköznapi módon viselkednek, de természetesen további lehetõségek is elérhetõek hozzájuk. A következõ példában <code>adat</code> néven készítünk egy új állományrendszert. Mivel ide majd nagyon fontos állományokat akarunk elhelyezni, állítsuk be, hogy minden adatblokkból két példány legyen:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># zfs create minta/adat</span>
<span class=c># zfs set copies=2 minta/adat</span></code></pre></div></div><div class=paragraph><p>A <code>df</code> újbóli kiadásával most már látható is ez az állományrendszer és annak tárfoglalása:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># df</span>
Filesystem         1K-blocks    Used    Avail Capacity  Mounted on
/dev/ad0s1a          2026030  235234  1628714    13%    /
devfs                      1       1        0   100%    /dev
/dev/ad0s1d         54098308 1032864 48737580     2%    /usr
minta               17547008       0 17547008     0%    /minta
minta/tomoritett    17547008       0 17547008     0%    /minta/tomoritett
minta/adat          17547008       0 17547008     0%    /minta/adat</code></pre></div></div><div class=paragraph><p>Vegyük észre, hogy a közös területen levõ állományrendszerek mindegyikén ugyanannyi szabad terület van. A <code>df</code> segítségével a késõbbiekben remekül megfigyelhetõ lesz, hogy az egyes állományrendszerek mindig csak annyi területet foglalnak el a közös területbõl, amennyire abban a pillanatban ténylegesen szükségünk van. A Z állományrendszerek esetén megszûnik a partíciók és kötetek fogalma, és több állományrendszer tárolódik egyazon közös területen. Ha már nem akarjuk használni, egyszerûen csak töröljük le az állományrendszereket és ezt a közös tárolót:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># zfs destroy minta/tomoritett</span>
<span class=c># zfs destroy minta/adat</span>
<span class=c># zpool destroy minta</span></code></pre></div></div><div class=paragraph><p>Nyilván tapasztalhattunk már, hogy a lemezeink olykor menthetetlenül meghibásodnak. Amikor egy lemezes meghajtó tönkremegy, a rajta tárolt adatok általában elvesznek. Az ilyen jellegû kellemetlenségek elkerülésének egyik módja az ún. RAID-tömbök építése. A következõ szakaszban bemutatjuk, hogy a Z állományrendszerek esetén hogyan tudunk ilyen tömböket készíteni.</p></div></div><div class=sect4><h5 id=_raid_z_tömbök>20.2.2.2. RAID-Z tömbök<a class=anchor href=#_raid_z_tömbök></a></h5><div class=paragraph><p>Korábban már utaltunk rá, hogy ebben a szakaszban három SCSI-lemez, vagyis a <span class=filename>da0</span>, <span class=filename>da1</span> és <span class=filename>da2</span> eszközök használatát feltételezzük (vagy természetesen <span class=filename>ad0</span> és így tovább, ha IDE-lemezeket használunk). Egy RAID-Z formátumú közös tároló készítéséhez a következõ parancsot kell kiadni:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># zpool create tarolo raidz da0 da1 da2</span></code></pre></div></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>A Sun™ ajánlása szerint egy RAID-Z konfigurációban legalább három, legfeljebb kilenc lemezt javasolt alkalmazni. Ha egyetlen közös tárolóban esetleg tíznél több lemezt szeretnénk felhasználni, akkor érdemes inkább kisebb RAID-Z csoportokra felosztani ezeket. Ha viszont csak két lemezünk van, de továbbra is redundanciára lenne szükségünk, hozzunk helyette létre egy ZFS tükrözést. Ezzel kapcsolatban részletesebben a <a href="https://man.freebsd.org/cgi/man.cgi?query=zpool&amp;sektion=8&amp;format=html">zpool(8)</a> man oldalon keresztül tájékozódhatunk.</p></div></td></tr></tbody></table></div><div class=paragraph><p>Ennek hatására tehát keletkezik egy <code>tarolo</code> nevû Z-tároló. Ez a korábbiakhoz hasonló módon ellenõrizhetõ is a <a href="https://man.freebsd.org/cgi/man.cgi?query=mount&amp;sektion=8&amp;format=html">mount(8)</a> és <a href="https://man.freebsd.org/cgi/man.cgi?query=df&amp;sektion=1&amp;format=html">df(1)</a> parancsokon keresztül. Természetesen az iménti listába további lemezeszközök tetszõlegesen felvehetõek. Most hozzunk létre ezen a közös területen egy <code>felhasznalok</code> nevû állományrendszert, ahová majd a felhasználók adatait fogjuk tenni:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># zfs create tarolo/felhasznalok</span></code></pre></div></div><div class=paragraph><p>Miután ezzel megvagyunk, az imént létrehozott állományrendszerre nyugodtan beállíthatunk tömörítést és biztonsági másolatokat. Ebben az alábbi parancsok lesznek a segítségünkre:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># zfs set copies=2 tarolo/felhasznalok</span>
<span class=c># zfs set compression=gzip tarolo/felhasznalok</span></code></pre></div></div><div class=paragraph><p>Ezt követõen költöztessük át a felhasználókat, vagyis másoljuk át az adataikat ide és hozzuk létre a megfelelõ szimbolikus linkeket:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># cp -rp /home/* /tarolo/felhasznalok</span>
<span class=c># rm -rf /home /usr/home</span>
<span class=c># ln -s /tarolo/felhasznalok /home</span>
<span class=c># ln -s /tarolo/felhasznalok /usr/home</span></code></pre></div></div><div class=paragraph><p>A felhasználók adatai immáron a frissen létrehozott <span class=filename>/tarolo/felhasznalok</span> állományrendszeren tárolódnak. Próbáljuk ki, hozzunk létre egy új felhasználót és jelentkezzünk be vele.</p></div><div class=paragraph><p>Készítsünk most egy pillanatképet is, amelyet aztán késõbb szükség esetén vissza tudunk állítani:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># zfs snapshot tarolo/felhasznalok@08-08-30</span></code></pre></div></div><div class=paragraph><p>A <code>snapshot</code> csak valós állományrendszerekkel mûködik, könyvtárakra vagy állományokra nem. A nevében a <code>@</code> karakter választja el egymástól a hozzá tartozó címkét az állományrendszer vagy kötet nevétõl. Ha netalán a felhasználói könyvtárak valamiért megsérültek volna, a következõ paranccsal állíthatóak vissza:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># zfs rollback tarolo/felhasznalok@08-08-30</span></code></pre></div></div><div class=paragraph><p>Az adott idõpontban aktív pillanatképeket az adott állományrendszer <span class=filename>.zfs/snapshot</span> könyvtárában találhatjuk meg. Például az elõbb készített pillanatkép az alábbi paranccsal nézhetõ meg:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># ls /tarolo/felhasznalok/.zfs/snapshot</span></code></pre></div></div><div class=paragraph><p>Ha ebbõl elindulunk, akkor pillanatok alatt írható egy olyan szkript, amely a felhasználók adatairól havonta készít egy pillanatképet. Ilyenkor azonban fontos számításba vennünk, hogy az idõvel felgyülemlõ pillanatképek rengeteg helyet el tudnak foglalni. A korábbi pillanatkép így távolítható el:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># zfs destroy tarolo/felhasznalok@08-08-30</span></code></pre></div></div><div class=paragraph><p>Miután alaposan kipróbáltuk a <span class=filename>/tarolo/felhasznalok</span> néven létrehozott állományrendszerünket, állítsuk be véglegesen ez eddigi <span class=filename>/home</span> állományrendszer helyére:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># zfs set mountpoint=/home tarolo/felhasznalok</span></code></pre></div></div><div class=paragraph><p>Ekkor a <code>df</code> és <code>mount</code> parancsok használatával meggyõzõdhetünk róla, hogy ezt az állományrendszert innentõl már valóban a <span class=filename>/home</span> könyvtárnak tekintjük:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># mount</span>
/dev/ad0s1a on / <span class=o>(</span>ufs, <span class=nb>local</span><span class=o>)</span>
devfs on /dev <span class=o>(</span>devfs, <span class=nb>local</span><span class=o>)</span>
/dev/ad0s1d on /usr <span class=o>(</span>ufs, <span class=nb>local</span>, soft-updates<span class=o>)</span>
tarolo on /tarolo <span class=o>(</span>zfs, <span class=nb>local</span><span class=o>)</span>
tarolo/felhasznalok on /home <span class=o>(</span>zfs, <span class=nb>local</span><span class=o>)</span>
<span class=c># df</span>
Filesystem          1K-blocks    Used    Avail Capacity  Mounted on
/dev/ad0s1a           2026030  235240  1628708    13%    /
devfs                       1       1        0   100%    /dev
/dev/ad0s1d          54098308 1032826 48737618     2%    /usr
tarolo               26320512       0 26320512     0%    /tarolo
tarolo/felhasznalok  26320512       0 26320512     0%    /home</code></pre></div></div><div class=paragraph><p>Ezzel lényegében befejeztük a RAID-Z tömb konfigurációját. Az állományrendszerek állapotára vonatkozóan a <a href="https://man.freebsd.org/cgi/man.cgi?query=periodic&amp;sektion=8&amp;format=html">periodic(8)</a> alkalmazásával akár naponta kérhetünk ellenõrzést:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># echo &#39;daily_status_zfs_enable=&#34;YES&#34;&#39; &gt;&gt; /etc/periodic.conf</span></code></pre></div></div></div><div class=sect4><h5 id=_a_raid_z_helyreállítása>20.2.2.3. A RAID-Z helyreállítása<a class=anchor href=#_a_raid_z_helyreállítása></a></h5><div class=paragraph><p>Minden szoftveres RAID implementáció kínál valamilyen megoldást az állapotának ellenõrzésére, ez alól tulajdonképpen a ZFS sem kivétel. A RAID-Z eszközök állapota a következõ paranccsal kérdezhetõ le:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># zpool status -x</span></code></pre></div></div><div class=paragraph><p>Ezt az üzenetet láthatjuk, amikor minden tároló kifogástalanul mûködik és semmilyen probléma sincs:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>all pools are healthy</code></pre></div></div><div class=paragraph><p>Ha viszont valamilyen gond lenne valamelyik lemezzel, például leállt, akkor az elõbbi parancs eredménye ehhez lesz hasonló:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>  pool: tarolo
 state: DEGRADED
status: One or more devices has been taken offline by the administrator.
	Sufficient replicas exist <span class=k>for </span>the pool to <span class=k>continue </span>functioning <span class=k>in </span>a
	degraded state.
action: Online the device using <span class=s1>&#39;zpool online&#39;</span> or replace the device with
	<span class=s1>&#39;zpool replace&#39;</span><span class=nb>.</span>
 scrub: none requested
config:

	NAME        STATE     READ WRITE CKSUM
	tarolo      DEGRADED     0     0     0
	  raidz1    DEGRADED     0     0     0
	    da0     ONLINE       0     0     0
	    da1     OFFLINE      0     0     0
	    da2     ONLINE       0     0     0

errors: No known data errors</code></pre></div></div><div class=paragraph><p>A válasz szerint az eszközt az adminisztrátor állította le. Ez ennél a példánál valóban igaz. Lemezeket a következõ módon lehet leállítani:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># zpool offline tarolo da1</span></code></pre></div></div><div class=paragraph><p>Így miután leállítottuk a rendszert, a <span class=filename>da1</span> eszköz cserélhetõ. A rendszer soron következõ indításakor ezzel a paranccsal tudjuk jelezni logikailag is a lemez cseréjét:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># zpool replace tarolo da1</span></code></pre></div></div><div class=paragraph><p>Nézzük meg újra a tömb állapotát, de ezúttal a <code>-x</code> kapcsoló megadása nélkül, mivel csak így fogjuk látni:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># zpool status tarolo</span>
 pool: tarolo
 state: ONLINE
 scrub: resilver completed with 0 errors on Sat Aug 30 19:44:11 2008
config:

	NAME        STATE     READ WRITE CKSUM
	tarolo      ONLINE       0     0     0
	  raidz1    ONLINE       0     0     0
	    da0     ONLINE       0     0     0
	    da1     ONLINE       0     0     0
	    da2     ONLINE       0     0     0

errors: No known data errors</code></pre></div></div><div class=paragraph><p>A példa szerint minden megfelelõen mûködik.</p></div></div><div class=sect4><h5 id=_az_adatok_ellenõrzése>20.2.2.4. Az adatok ellenõrzése<a class=anchor href=#_az_adatok_ellenõrzése></a></h5><div class=paragraph><p>Elõzetesen már szó esett róla, hogy a ZFS képes a tárolt adatok sértetlenségének ellenõrzésére. Az új állományrendszerek létrehozásánál ez a lehetõség automatikusan aktiválódik, de tetszés szerint letiltható:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># zfs set checksum=off tarolo/felhasznalok</span></code></pre></div></div><div class=paragraph><p>Ez a lépés viszont nem feltétlenül jó döntés, mivel az adatintegritás megtartásához felhasznált ellenõrzõ összegek nagyon kevés helyet foglalnak és meglehetõsen hasznosak. Emellett semmilyen észlelhetõ lassulást nem okoznak az állományrendszer használata során. Ha engedélyezzük, a ZFS ilyen ellenõrzõ összegek segítségével folyamatosan figyelni tudja az adatok épségét. Ezt az ellenõrzést a <code>scrub</code> paranccsal válthatjuk ki. Nézzük meg például a <code>tarolo</code> esetében:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># zpool scrub tarolo</span></code></pre></div></div><div class=paragraph><p>Ez a vizsgálat a tárolt adatok mennyiségétõl függõen nagyon sokáig is eltarthat, illetve rengeteg lemezmûveletet foglal magában, ezért egyszerre csak egy ilyen futtatása javasolt. Miután befejezõdött, a tároló állapota az eredményének megfelelõen frissül, amelyet közvetlenül utána le is kérdezhetünk:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># zpool status tarolo</span>
 pool: tarolo
 state: ONLINE
 scrub: scrub completed with 0 errors on Sat Aug 30 19:57:37 2008
config:

	NAME        STATE     READ WRITE CKSUM
	tarolo      ONLINE       0     0     0
	  raidz1    ONLINE       0     0     0
	    da0     ONLINE       0     0     0
	    da1     ONLINE       0     0     0
	    da2     ONLINE       0     0     0

errors: No known data errors</code></pre></div></div><div class=paragraph><p>A példában látható az utolsó ellenõrzés ideje. Ezen lehetõség használatával hosszú idõn keresztül szavatolni tudjuk az adataink épségét.</p></div><div class=paragraph><p>A Z állományrendszerrel kapcsolatos további beállítási lehetõségekrõl a <a href="https://man.freebsd.org/cgi/man.cgi?query=zfs&amp;sektion=8&amp;format=html">zfs(8)</a> és <a href="https://man.freebsd.org/cgi/man.cgi?query=zpool&amp;sektion=8&amp;format=html">zpool(8)</a> man oldalakon olvashatunk.</p></div></div></div></div></div></div><div class=sect1><h2 id=vinum-vinum>Chapter 21. A Vinum kötetkezelő<a class=anchor href=#vinum-vinum></a></h2><div class=sectionbody><div class=sect2><h3 id=vinum-synopsis>21.1. Áttekintés<a class=anchor href=#vinum-synopsis></a></h3><div class=paragraph><p>Nem számít, milyen lemezeink is vannak, ugyanis mindig adódnak velük kapcsolatban gondjaink:</p></div><div class=ulist><ul><li><p>Kicsik.</p></li><li><p>Lassúk.</p></li><li><p>Nem elég megbízhatóak.</p></li></ul></div><div class=paragraph><p>Ezekre a problémákra javasoltak és meg is valósítottak számos megoldást. A felhasználók egy része általában úgy védekezik ellenük, hogy több, gyakran redundánsan tároló lemezt használ. A különféle kártyák és hardveres RAID-vezérlõk támogatása mellett a FreeBSD alaprendszerében megtalálható egy blokkos eszközmeghajtóként a Vinum kötetkezelõ is, amellyel virtuális lemezmeghajtókat lehet létrehozni. Tehát a <em>Vinum</em> egy olyan ún. <em>kötetkezelõ</em>, vagyis virtuális lemezkezelõ, ami az említett három problémára próbál megoldást adni. A Vinum a hagyományos lemezes tárolásnál jóval nagyobb rugalmasságot, teljesítményt és megbízhatóságot biztosít, valamint ismeri a RAID-0, RAID-1 és RAID-5 modelleket külön-külön és kombinálva is.</p></div><div class=paragraph><p>Ebben a fejezetben összefoglaljuk a hagyományos lemezes tárolás jellegzetes problémáit és bemutatjuk a Vinum kötetkezelõt.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>A FreeBSD 5-ös verziójától kezdve a Vinumot újraírták a GEOM-nak megfelelõen (<a href=./#geom>GEOM. a moduláris lemezszervező rendszer</a>), megtartva az eredeti elgondolásokat, elnevezéseket és a lemezen tárolt metaadatok formátumát. Ezt az újraírt változatot nevezik <em>gvinum</em>nak (<em>GEOM vinum</em>). A szövegben a <em>Vinum</em>ra kizárólag csak általánosságban hivatkozunk, függetlenül az implementációjától. Most már az összes parancsot a <code>gvinum</code> használatával kell kiadni, illetve a hozzá tartozó modul neve <span class=filename>vinum.ko</span>-ról <span class=filename>geom_vinum.ko</span>-ra változott és a megfelelõ eszközleírók a <span class=filename>/dev/vinum</span> könyvtár helyett a <span class=filename>/dev/gvinum</span> könyvtárban találhatóak. A FreeBSD 6. verziójától pedig a régi Vinum implementáció többé már nem is része az alaprendszernek.</p></div></td></tr></tbody></table></div></div><div class=sect2><h3 id=vinum-intro>21.2. Kicsik a lemezeink<a class=anchor href=#vinum-intro></a></h3><div class=paragraph><p>A lemezek kapacitása ugyan növekszik, de velük együtt a tárigények is. Ezért gyakran érezzük úgy, hogy a rendelkezésünkre álló lemezek tárkapacitását meghaladó állományrendszerre lenne szükségünk. Kétségtelen, hogy ez a probléma messze nem akkora jelentõségû, mint például tíz évvel ezelõtt, de még mindig fennáll. Egyes rendszerek ezt úgy hidalták át, hogy létrehoztak egy olyan absztrakt eszközt, amely az adatokat több lemezen tárolja el.</p></div></div><div class=sect2><h3 id=vinum-access-bottlenecks>21.3. A hozzáférési idõk szûk keresztmetszetei<a class=anchor href=#vinum-access-bottlenecks></a></h3><div class=paragraph><p>Napjaink rendszerei szinte állandóan egyszerre több adathoz is hozzá akarnak férni. Például egy nagy forgalmú FTP vagy HTTP szerver több 100 Mbit/s sebességû kapcsolattal is csatlakozhat a világhálóhoz, amelyeken keresztül párhuzamosan többezernyi tranzakciót is folytathat, ami jelentõsen meghaladja a legtöbb lemez átlagos átviteli sebességét.</p></div><div class=paragraph><p>A jelenleg kapható lemezek soros adatátviteli sebessége egészen 70 MB/s-ig is terjedhet, de ennek az értéknek kevés a jelentõsége olyan környezetekben, ahol több, egymástól függetlenül futó program próbál egyszerre hozzáférni, hiszen ilyen esetekben csak a töredékét képesek elérni. Ilyenkor sokkal érdekesebb a lemezt kezelõ alrendszer szempontjából nézni a problémát: így az egyes adatátviteli kérések terhelése lesz a meghatározó paraméter, vagyis az az idõ, amit a kérés teljesítésében érintett meghajtók eltöltenek a feldolgozással.</p></div><div class=paragraph><p>Bármelyik kérést is vesszük, a kiszolgáláshoz a meghajtónak elõször a megfelelõ helyre kell mozgatnia az író/olvasó fejeket, meg kell várni a fej alatt elhaladó elsõ szektort, majd végrehajtani a megfelelõ mûveletet. Ezek a mûveletek szétválaszthatatlanok: semmi értelme nincs megszakítani ezeket.</p></div><div class=paragraph><p><a id=vinum-latency></a>Tekintsünk egy átlagosnak mondható, nagyjából 10 kB méretû adatátvitelt: a legújabb nagyteljesítményû lemezek átlagosan 3,5 ms alatt képesek pozicionálni a fejeket. A leggyorsabb lemezek 15 000 fordulatot tesznek meg percenként (RPM), így az átlagos forgási késleltetés (egy fél fordulat ideje) 2 ms. 70 MB/s-os sebesség mellett az átvitel maga megközelítõleg 150 μs, ami szinte elhanyagolható a pozicionálás idejéhez képest. Ilyen esetekben a tényleges adatátviteli sebesség 1 MB/s-nél alig valamivel többre esik vissza, és tisztán látszik, hogy erõsen függ az átvitt adat mennyiségétõl.</p></div><div class=paragraph><p>A hagyományos és kézenfekvõ megoldása ennek a problémának "még több cséve" használata: egyetlen nagy lemez helyett alkalmazzunk több kisebb, de azonos tárkapacitású lemezt. Mindegyik lemez képes egymástól függetlenül mozgatni a fejeiket és az adatokat, aminek köszönhetõen a tényleges adatátvitel mértéke nagyjából a lemezek számával arányosan növekszik.</p></div><div class=paragraph><p>Az adatátvitelben bekövetkezõ javulás pontos aránya természetesen kisebb, mint a lemezek száma: habár az egyes meghajtók képesek párhuzamosan mozgatni az adatokat, semmilyen módon garantálhatjuk, hogy a kérések egyenletesen oszlanak el köztük. Emiatt szinte elkerülhetetlen, hogy az egyik meghajtót nagyobb terhelés érje, mint a másikat.</p></div><div class=paragraph><p>A lemezekre esõ terhelés egyenletessége erõsen függ attól, hogyan osztjuk el az adatokat a meghajtók között. Az itt használt példában a lemezen tárolt adatokat egy könyv oldalaiként érdemes elképzelni, vagyis rengeteg szám szerint címezhetõ adatszektorként. A virtuális lemezt ennek megfelelõen a legegyszerûbben úgy tudjuk felosztani az egymás után következõ független fizikai lemezek mérete szerint és így használni, mintha egy nagy könyvet kisebb részekre téptünk volna. Ezt a módszert nevezik <em>összefûzésnek</em>, és elõnye, hogy a résztvevõ lemezeknek nem kell azonos méretûeknek lenniük. Ez a megoldás remekül mûködik abban az esetben, amikor a virtuális lemez hozzáférései egyenletesen oszlanak el annak teljes területén. Amikor viszont az elérés csak egy kisebb területre korlátozódik, kevesebb javulás tapasztalható. A <a href=#vinum-concat>Az összefûzött szervezési mód</a> mutatja be lemezek egy ilyen összefûzött konfigurációját.</p></div><div id=vinum-concat class=imageblock><div class=content><img src=../../../../images/books/handbook/vinum/vinum-concat.png alt="vinum concat"></div><div class=title>Ábra 59. Az összefûzött szervezési mód</div></div><div class=paragraph><p>Feloszthatjuk a virtuális lemezünket kisebb azonos méretû darabokra is, melyeket különbözõ eszközökön sorosan tárolunk el. Például az elsõ 256 szektort eltároljuk az elsõ lemezen, majd a következõ 256 szektort a következõ lemezen és így tovább. Az utolsó lemez kitöltése után az egész folyamat ismétlõdik, egészen az összes lemez megtöltéséig. Ezt a leképezést <em>csíkozás</em>nak ("striping") vagy RAID-0-nak nevezzük . A csíkozás használata során valamivel bonyolultabbá válik az adatok megtalálása és többletmunkát is jelenthet olyan esetekben, amikor az adatátvitel több lemezt is érint, de ezzel egyidõben sokkal jobban szétosztja a terhelést a lemezek között. A <a href=#vinum-striped>A csíkozott szervezési mód</a> mutatja be a lemezek csíkozott szervezését.</p></div><div id=vinum-striped class=imageblock><div class=content><img src=../../../../images/books/handbook/vinum/vinum-striped.png alt="vinum striped"></div><div class=title>Ábra 60. A csíkozott szervezési mód</div></div></div><div class=sect2><h3 id=vinum-data-integrity>21.4. Adatintegritás<a class=anchor href=#vinum-data-integrity></a></h3><div class=paragraph><p>A modern lemezhajtók utolsó fontos problémája, hogy nem eléggé megbízhatóak. Annak ellenére, hogy a lemezek ezen a téren meglehetõsen sokat fejlõdtek az utóbbi pár évben, egy szervernek még mindig ezek azok a központi részei, amelyek a leginkább hajlamosak a meghibásodásra. Amikor ez bekövetkezik, a hatása akár egy katasztrófával is felérhet: a sérült lemezmeghajtók cseréje és az adatok visszaállítása napokat is igénybe vehet.</p></div><div class=paragraph><p>Ennek a problémának a hagyományos megközelítése lenne a <em>tükrözés</em> ("mirroring"), vagyis amikor ugyanarról az adatról tartunk két példányt két eltérõ fizikai hardveren. A RAID-szintek beköszöntével ezt a technikát RAID level 1-nak vagy RAID-1-nek is nevezik. Amikor írunk a kötetre, mindenhova írunk, az olvasás pedig bármelyik eszközrõl elvégezhetõ. Így ha az egyik meghajtó tönkremenne, egy másikon még mindig megtalálható az összes adat.</p></div><div class=paragraph><p>A tükrözés két problémát vet fel:</p></div><div class=ulist><ul><li><p>Ár. Legalább kétszer annyiba kerül, mint a nem redundánsan tároló megoldások.</p></li><li><p>Teljesítménycsökkenés. Mivel az írást minden meghajtón végre kell hajtani, legalább kétszer annyi sávszélességet is felémeszt, mint a nem tükrözött kötetek esetén. Az olvasás viszont nem veszít a sebességébõl: sõt, még gyorsabbnak is tûnhet.</p></li></ul></div><div class=paragraph><p>Az adatintegritás megõrzésére egy másik megoldás a <em>paritás</em> használata, melyet a 2, 3, 4 és 5 RAID-szintek valósítanak meg. Ezek közül talán a RAID-5 a legérdekesebb. A Vinumban egy olyan csíkozott szervezési módként valósították meg, ahol minden csíkból egy blokk az összes többi paritási információját tartalmazza. A RAID-5 által megvalósított szervezés hasonlít a csíkozáshoz, azonban a RAID-5-ben mindegyik csík tartalmaz egy paritási információt is. Tehát a Vinumban, ahogy azt RAID-5 a megköveteli, a paritást tároló blokkok helye az egyik csíkról a másikra változik. Az adatblokkokban található számok relatív blokkszámokat jelölnek.</p></div><div id=vinum-raid5-org class=imageblock><div class=content><img src=../../../../images/books/handbook/vinum/vinum-raid5-org.png alt="vinum raid5 org"></div><div class=title>Ábra 61. A RAID-5 szervezési mód</div></div><div class=paragraph><p>A RAID-5-nek a tükrözéshez képest megvan az az elõnye, hogy jelentõsen kevesebb tárhelyet igényel. Az olvasás hasonló a csíkozott szervezésekéhez, azonban az írás jóval lassabb, közel 25%-a az olvasás sebességének. Az egyik meghajtó meghibásodása esetén a tömb csökkentett módban még képes folytatni a mûködést: a fennmaradó meghajtókról továbbra is a megszokott módon lehet olvasni, viszont a sérült meghajtóról olvasott adatokat folyamatosan javítani kell a többirõl származó segédinformációk szerint.</p></div></div><div class=sect2><h3 id=vinum-objects>21.5. A Vinum objektumai<a class=anchor href=#vinum-objects></a></h3><div class=paragraph><p>A tárgyalt problémák orvoslására a Vinumban egy négyszintû objektumhierarchiát alakítottak ki:</p></div><div class=ulist><ul><li><p>A legjobban észlelhetõ objektum a virtuális lemez, amelyet <em>kötet</em>nek (volume) nevezünk. Ez a kötet lényegében ugyanazokkal a tulajdonságokkal rendelkezik, mint egy UNIX®-os lemezmeghajtó, habár akadnak finomabb különbségek. Mérete korlátlan lehet.</p></li><li><p>A kötetek <em>erek</em>bõl (plex) állnak, melyek a kötet teljes területét képviselik. Ennélfogva a hierarchia ezen szintje nyújtja a redundanciát. Az ereket legegyszerûbben a tükrözött tömbben helyet foglaló lemezekként tudjuk elképzelni, melyek ugyanazt az adatot tartalmazzák.</p></li><li><p>Mivel a Vinum a UNIX® lemezes tárolást megvalósító alrendszerében helyezkedik el, a többlemezes erek felépítéséhez használhatnánk a UNIX®-os partíciókat, azonban ehhez a feladathoz nem eléggé rugalmasak, mivel a UNIX®-os lemezek csak korlátozott számú partíciót tartalmazhatnak. A Vinum ehelyett <em>allemez</em>nek (subdisk) nevezett folytonos területekre osztja fel az egyes UNIX®-os partíciókat (a <em>meghajtó</em>kat), melyeket aztán az erek létrehozására használ fel.</p></li><li><p>A Vinum által létrehozott <em>meghajtó</em>kon (drive) levõ allemezek lesznek valódi UNIX®-os partíciók. A Vinum-meghajtók tetszõleges számú allemezt tartalmazhatnak. Eltekintve a meghajtó elején található apró területtõl, melyen a beállításokra és az állapotra vonatkozó információk tárolódnak, az egész meghajtó felhasználható adatok tárolására.</p></li></ul></div><div class=paragraph><p>A most következõ szakaszokban ismertetjük, hogy ezek az objektumok milyen módon szolgáltatják a Vinum részérõl elvárt funkciókat.</p></div><div class=sect3><h4 id=_a_kötetek_mérete>21.5.1. A kötetek mérete<a class=anchor href=#_a_kötetek_mérete></a></h4><div class=paragraph><p>Az erek képesek a Vinum konfigurációjában található több különbözõ meghajtón elhelyezkedõ allemezeket is nyalábba kötni. Ennek következményeképpen az egyes meghajtók mérete nem korlátozza az erek méretét, emiatt a kötetét sem.</p></div></div><div class=sect3><h4 id=_redundáns_adattárolás>21.5.2. Redundáns adattárolás<a class=anchor href=#_redundáns_adattárolás></a></h4><div class=paragraph><p>A Vinum a tükrözést több ér egyetlen kötetté olvasztásával hozza létre. Az erek mindegyike a köteten található adatokat képviseli. Egy kötet legalább egy, legfeljebb nyolc eret tartalmazhat.</p></div><div class=paragraph><p>Habár egy ér egy kötet teljes adatát ábrázolja, elõfordulhat olyan eset, hogy bizonyos részei hiányoznak fizikai, kialakítási (nem társítottunk allemezeket hozzájuk) okokból adódóan vagy véletlenül (a hozzá tartozó lemezterületek sérültek). Amíg legalább egy ér képes a kötet teljes tartalmát szolgáltatni, addig a kötet teljesen épnek tekinthetõ.</p></div></div><div class=sect3><h4 id=_teljesítmény>21.5.3. Teljesítmény<a class=anchor href=#_teljesítmény></a></h4><div class=paragraph><p>A Vinum az összefûzést és a csíkozást is egyaránt megvalósítja az erek szintjén:</p></div><div class=ulist><ul><li><p>Az <em>összefûzött ér</em> allemezek területeibõl építkezik.</p></li><li><p>A <em>csíkozott ér</em> felosztja az adatokat az allemezek között. Az allemezek mindegyikének ugyanakkorának kell lennie, és legalább két allemeznek lennie kell, hogy eltérjen az összefûzött értõl.</p></li></ul></div></div><div class=sect3><h4 id=_hogyan_szervezzük_az_ereket>21.5.4. Hogyan szervezzük az ereket?<a class=anchor href=#_hogyan_szervezzük_az_ereket></a></h4><div class=paragraph><p>A FreeBSD 12.0 verziójában két fajta erezési megoldást találhatunk:</p></div><div class=ulist><ul><li><p>Az összefûzött erek a legrugalmasabbak: tetszõleges számú allemezt tartalmazhatnak, az allemezek mérete pedig eltérhet. Az ér újabb allemezek hozzáadásával tovább bõvíthetõ. Kevesebb processzoridõt igényel, mint egy csíkozott ér, habár a kettõ többletköltsége közti eltérés nem mérhetõ. Másrészrõl azonban nagyon érzékenyek a forgalmasabb pontokra, vagyis amikor az egyik lemez folyamatosan használatban van, miközben a többi üresen jár.</p></li><li><p>A csíkozott (RAID-0) erek legnagyobb elõnye, hogy csökkentik a forgalmasabb pontok kialakulását: a megfelelõ méretû csíkszélesség (ami kb. 256 kB) választásával el tudjuk egyengetni a tömbben dolgozó meghajtók terhelését. Ennek a megközelítésnek a hátránya (részben) a sokkal összetettebb kód, valamint az allemezekre vonatkozó megszorítás, amely szerint meg kell egyezniük a méretüknek, illetve az érhez annyira bonyolult újabb allemezeket kapcsolni, hogy a Vinum jelenleg nem is képes rá. Ezeken kívü a Vinum még támaszt egy triviális igényt is: a csíkozott érben legalább két allemeznek lennie kell, mivel másképp nem tér el egy összefûzött értõl.</p></li></ul></div><div class=paragraph><p>A <a href=#vinum-comparison>Vinum erezések</a> foglalja össze az egyes erezések elõnyeit és hátrányait.</p></div><table id=vinum-comparison class="tableblock frame-none grid-all stretch"><caption class=title>Táblázat 7. Vinum erezések</caption><col style=width:20%><col style=width:20%><col style=width:20%><col style=width:20%><col style=width:20%><thead><tr><th class="tableblock halign-left valign-top">Erezés típusa</th><th class="tableblock halign-left valign-top">Legkevesebb allemez</th><th class="tableblock halign-left valign-top">Bõvíthetõ</th><th class="tableblock halign-left valign-top">Megegyezõ méret</th><th class="tableblock halign-left valign-top">Alkalmazás</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class=tableblock>összefûzött</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>1</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>igen</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>nem</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Sok adat tárolása, ahol a hangsúly a rugalmasságon és a mérsékelt teljesítményen van.</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>csíkozott</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>2</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>nem</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>igen</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Nagy teljesítmény, nagy mennyiségû egyidejû hozzáférés mellett</p></td></tr></tbody></table></div></div><div class=sect2><h3 id=vinum-examples>21.6. Példák<a class=anchor href=#vinum-examples></a></h3><div class=paragraph><p>A Vinum a rendszerben ismert objektumokkal kapcsolatos információkat egy <em>konfigurációs adatbázis</em>ban tartja fenn. Kezdetben a felhasználó egy vagy több konfigurációs állomány segítségével hozza létre ezt az adatbázist a <a href="https://man.freebsd.org/cgi/man.cgi?query=gvinum&amp;sektion=8&amp;format=html">gvinum(8)</a> segédprogrammal. A Vinum ezt a konfigurációs adatbázist bemásolja mindegyik irányítása alatt álló slice-ba (melyek a Vinum <em>eszköz</em>nek hív). Az adatbázis minden egyes állapotváltás folyamán frissül, így egy újraindítás után minden egyes Vinum-objektum állapota pontosan helyreállítódik.</p></div><div class=sect3><h4 id=_a_konfigurációs_állomány>21.6.1. A konfigurációs állomány<a class=anchor href=#_a_konfigurációs_állomány></a></h4><div class=paragraph><p>A konfigurációs állomány írja le az egyes objektumokat. Egy egyszerûbb kötet definíciója így nézhet ki:</p></div><div class="literalblock programlisting"><div class=content><pre>    drive a device /dev/da3h
    volume myvol
      plex org concat
        sd length 512m drive a</pre></div></div><div class=paragraph><p>Ez az állomány négy Vinum-objektumot definiál:</p></div><div class=ulist><ul><li><p>A <em>drive</em> kezdetû sor adja meg a lemez partícióját (<em>meghajtó</em>ját) és a hardveren levõ elhelyezkedését. Az <em>a</em> szimbolikus nevet kapta. A szimbolikus és a konkrét eszköznevek szétválasztásával lehetõvé válik, hogy a lemezek félreértések nélkül átkerülhessek egyik helyrõl a másikra.</p></li><li><p>A <em>volume</em> kezdetû sor adja meg a kötetet. Itt az egyetlen szükséges jellemzõ a név, ami ebben az esetben a <em>myvol</em>.</p></li><li><p>A <em>plex</em> kezdetû sor adja meg az eret. Itt az egyetlen szükséges paraméter a szervezési mód, ami ebben az esetben a <em>concat</em> (összefûzött). Nevet nem kell megadnunk, mivel a rendszer automatikusan létrehoz egy nevet a kötet nevébõl a <em>.px</em> utótag hozzáadásával, ahol az <em>x</em> az ér száma lesz a köteten belül. Emiatt a most definiált ér neve <em>myvol.p0</em> lesz.</p></li><li><p>Az <em>sd</em> kezdetû sor adja meg az allemezt. Itt legalább meg kell adnunk a meghajtónak a nevét, ahol tárolni akarjuk, ill. a méretét. Ahogy már említettük az ereknél is, nevet nem kötelezõ megadnunk, mivel a rendszer magától rendel hozzá nevet, amit a hozzá tartozó ér nevébõl származtat, hozzáadja a <em>.sx</em> utótagot, ahol az <em>x</em> az allemez éren belüli sorszáma lesz. Ennek következtében a Vinum ennek az allemeznek a <em>myvol.p0.s0</em> nevet adja.</p></li></ul></div><div class=paragraph><p>Miután a <a href="https://man.freebsd.org/cgi/man.cgi?query=gvinum&amp;sektion=8&amp;format=html">gvinum(8)</a> feldolgozta ezt az állományt, az alábbi kimenetet fogja adni:</p></div><div class="literalblock programlisting"><div class=content><pre>      #  gvinum -&gt; create config1
      Configuration summary
      Drives:         1 (4 configured)
      Volumes:        1 (4 configured)
      Plexes:         1 (8 configured)
      Subdisks:       1 (16 configured)

	D a                     State: up       Device /dev/da3h        Avail: 2061/2573 MB (80%)

	V myvol                 State: up       Plexes:       1 Size:        512 MB

	P myvol.p0            C State: up       Subdisks:     1 Size:        512 MB

	S myvol.p0.s0           State: up       PO:        0  B Size:        512 MB</pre></div></div><div class=paragraph><p>Ez a kimenet a <a href="https://man.freebsd.org/cgi/man.cgi?query=gvinum&amp;sektion=8&amp;format=html">gvinum(8)</a> egyszerû listázási formátumát mutatja. Grafikusan a <a href=#vinum-simple-vol>Egyszerû Vinum-kötet</a> mutatja be.</p></div><div id=vinum-simple-vol class=imageblock><div class=content><img src=../../../../images/books/handbook/vinum/vinum-simple-vol.png alt="vinum simple vol"></div><div class=title>Ábra 62. Egyszerû Vinum-kötet</div></div><div class=paragraph><p>Ezen és az ezt követõ ábrán egy kötetet láthatunk, amely ereket tartalmaz, amelyek pedig allemezeket. Ebben az alapvetõ példában a kötet egyetlen eret tartalmaz, amiben pedig egyetlen allemez van.</p></div><div class=paragraph><p>Az itt bemutatott kötetnek nincs semmilyen elõnye a hagyományos lemezpartícionáláshoz képest. Egyetlen eret tartalmaz, tehát nem is redundáns. Az ér egyetlen allemezt tartalmaz, tehát nem tér el a megszokott lemezpartíciók helyfoglalásától sem. A következõ szakaszokban sokkal érdekesebb konfigurációs módszereket is illusztrálunk.</p></div></div><div class=sect3><h4 id=_megnövelt_rugalmasság_tükrözés>21.6.2. Megnövelt rugalmasság: tükrözés<a class=anchor href=#_megnövelt_rugalmasság_tükrözés></a></h4><div class=paragraph><p>A kötetek rugalmassága tükrözéssel növelhetõ. Egy tükrözött kötet kiosztása során feltétlenül gondoskodnunk kell arról, hogy az egyes erekhez tartozó allemezek eltérõ meghajtókon találhatóak, így az esetleges meghibásodások nem károsítják mind a két eret. Az alábbi konfigurációban egy kötetet tükrözünk:</p></div><div class="literalblock programlisting"><div class=content><pre>	drive b device /dev/da4h
	volume mirror
      plex org concat
        sd length 512m drive a
	  plex org concat
	    sd length 512m drive b</pre></div></div><div class=paragraph><p>Ebben a példában már nem kellett újra megadnunk az <em>a</em> meghajtót, mivel a Vinum figyelemmel kíséri az összes objektumot a saját konfigurációs adatbázisában. A definíció feldolgozása után a konfiguráció így fog kinézni:</p></div><div class="literalblock programlisting"><div class=content><pre>	Drives:         2 (4 configured)
	Volumes:        2 (4 configured)
	Plexes:         3 (8 configured)
	Subdisks:       3 (16 configured)

	D a                     State: up       Device /dev/da3h        Avail: 1549/2573 MB (60%)
	D b                     State: up       Device /dev/da4h        Avail: 2061/2573 MB (80%)

    V myvol                 State: up       Plexes:       1 Size:        512 MB
    V mirror                State: up       Plexes:       2 Size:        512 MB

    P myvol.p0            C State: up       Subdisks:     1 Size:        512 MB
    P mirror.p0           C State: up       Subdisks:     1 Size:        512 MB
    P mirror.p1           C State: initializing     Subdisks:     1 Size:        512 MB

    S myvol.p0.s0           State: up       PO:        0  B Size:        512 MB
	S mirror.p0.s0          State: up       PO:        0  B Size:        512 MB
	S mirror.p1.s0          State: empty    PO:        0  B Size:        512 MB</pre></div></div><div class=paragraph><p>A <a href=#vinum-mirrored-vol>Tükrözött Vinum-kötet</a> ugyanezt a szerkezetet grafikusan is.</p></div><div id=vinum-mirrored-vol class=imageblock><div class=content><img src=../../../../images/books/handbook/vinum/vinum-mirrored-vol.png alt="vinum mirrored vol"></div><div class=title>Ábra 63. Tükrözött Vinum-kötet</div></div><div class=paragraph><p>Ebben a példában minden ér tartalmazza a teljes 512 MB-os területet. Ahogy a korábbi példa esetén, itt is mindegyik ér csak egyetlen allemezt tartalmaz.</p></div></div><div class=sect3><h4 id=_a_teljesítmény_javítása>21.6.3. A teljesítmény javítása<a class=anchor href=#_a_teljesítmény_javítása></a></h4><div class=paragraph><p>Az elõbbi példában szereplõ tükrözött kötet egy tükrözetlen kötetnél már jobban ellenáll a hibáknak, azonban a teljesítménye is kisebb. A köteten minden egyes írás mind a két meghajtóra érvényesül, ezáltal a lemezek teljes sávszélességét nagyobb arányban használja. A teljesítményre vonatkozó megfontolásaink egy másik megközelítést kívánnak meg: a tükrözés helyett inkább csíkozzuk szét az adatot a lehetõ legtöbb lemezen. Az alábbi konfiguráció egy olyan kötetet mutat be, ahol egy eret négy lemezmeghajtóan keresztül csíkozunk:</p></div><div class="literalblock programlisting"><div class=content><pre>	drive c device /dev/da5h
	drive d device /dev/da6h
	volume stripe
	plex org striped 512k
	  sd length 128m drive a
	  sd length 128m drive b
	  sd length 128m drive c
	  sd length 128m drive d</pre></div></div><div class=paragraph><p>Mint ahogy azt már korábban is említettük, nem szükséges még egyszer megadni azokat a meghajtókat, amiket a Vinum már ismer. A definíció feldolgozása után a konfigurációnk nagyjából így néz ki:</p></div><div class="literalblock programlisting"><div class=content><pre>	Drives:         4 (4 configured)
	Volumes:        3 (4 configured)
	Plexes:         4 (8 configured)
	Subdisks:       7 (16 configured)

    D a                     State: up       Device /dev/da3h        Avail: 1421/2573 MB (55%)
    D b                     State: up       Device /dev/da4h        Avail: 1933/2573 MB (75%)
    D c                     State: up       Device /dev/da5h        Avail: 2445/2573 MB (95%)
    D d                     State: up       Device /dev/da6h        Avail: 2445/2573 MB (95%)

    V myvol                 State: up       Plexes:       1 Size:        512 MB
    V mirror                State: up       Plexes:       2 Size:        512 MB
    V striped               State: up       Plexes:       1 Size:        512 MB

    P myvol.p0            C State: up       Subdisks:     1 Size:        512 MB
    P mirror.p0           C State: up       Subdisks:     1 Size:        512 MB
    P mirror.p1           C State: initializing     Subdisks:     1 Size:        512 MB
    P striped.p1            State: up       Subdisks:     1 Size:        512 MB

    S myvol.p0.s0           State: up       PO:        0  B Size:        512 MB
    S mirror.p0.s0          State: up       PO:        0  B Size:        512 MB
    S mirror.p1.s0          State: empty    PO:        0  B Size:        512 MB
    S striped.p0.s0         State: up       PO:        0  B Size:        128 MB
    S striped.p0.s1         State: up       PO:      512 kB Size:        128 MB
    S striped.p0.s2         State: up       PO:     1024 kB Size:        128 MB
    S striped.p0.s3         State: up       PO:     1536 kB Size:        128 MB</pre></div></div><div id=vinum-striped-vol class=imageblock><div class=content><img src=../../../../images/books/handbook/vinum/vinum-striped-vol.png alt="vinum striped vol"></div><div class=title>Ábra 64. Csíkozott Vinum-kötet</div></div><div class=paragraph><p>Ez a kötet a <a href=#vinum-striped-vol>Csíkozott Vinum-kötet</a>ban látható. A csíkok sötétedése jelzi a helyüket az ér területében: a világosabbak elöl, a sötétebbek hátul szerepelnek.</p></div></div><div class=sect3><h4 id=_rugalmasság_és_teljesítmény>21.6.4. Rugalmasság és teljesítmény<a class=anchor href=#_rugalmasság_és_teljesítmény></a></h4><div class=paragraph><p><a id=vinum-resilience></a>Megfelelõ hardver birtokában lehet olyan köteteket is építeni, amelyek mind megnövelt rugalmasságot, mind pedig megnövelt teljesítményt mutatnak a szabványos UNIX®-os partíciókhoz képest. Ennek a konfigurációs állománya így nézne ki:</p></div><div class="literalblock programlisting"><div class=content><pre>	volume raid10
      plex org striped 512k
        sd length 102480k drive a
        sd length 102480k drive b
        sd length 102480k drive c
        sd length 102480k drive d
        sd length 102480k drive e
      plex org striped 512k
        sd length 102480k drive c
        sd length 102480k drive d
        sd length 102480k drive e
        sd length 102480k drive a
        sd length 102480k drive b</pre></div></div><div class=paragraph><p>A második ér allemezei el vannak tolva az elsõ ér allemezeitõl két meghajtónyival. Ez segít megelõzni, hogy az írási mûveletek ne ugyanarra az allemezre vonatkozznak, még akkor is, ha az adatátvitel két meghajtón is keresztülível.</p></div><div class=paragraph><p>A <a href=#vinum-raid10-vol>Tükrözött, csíkozott Vinum-kötet</a> illusztrálja ennek a kötetnek a szerkezetét.</p></div><div id=vinum-raid10-vol class=imageblock><div class=content><img src=../../../../images/books/handbook/vinum/vinum-raid10-vol.png alt="vinum raid10 vol"></div><div class=title>Ábra 65. Tükrözött, csíkozott Vinum-kötet</div></div></div></div><div class=sect2><h3 id=vinum-object-naming>21.7. Az objektumok elnevezése<a class=anchor href=#vinum-object-naming></a></h3><div class=paragraph><p>Korábban már megismerhettük, hogy a Vinum alapértelmezett neveket társít az erekhez és az allemezekhez, habár ezek a nevek felülbírálhatóak. Ez viszont egyáltalán nem ajánlott, mivel már a VERITAS kötetkezelõ, ahol tetszõleges neveket rendelhetünk az objektumokhoz, használata során kiderült, hogy akkora mértékû rugalmasságot nem kínál fel, mint amennyi zavart képes okozni.</p></div><div class=paragraph><p>A nevek tartalmazhatnak bármilyen nem üres karaktert, azonban érdemes inkább csak betûket, számjegyeket és az aláhúzást használni. A kötetek, erek és allemezek nevei akár 64 karakteresek is lehetnek, a meghajtók nevei pedig 32 karakteresek.</p></div><div class=paragraph><p>A Vinum objektumai a <span class=filename>/dev/gvinum</span> könyvtáron belüli hierarchiában helyezkednek el eszközleírókként. Az imént említett példakonfiguráció hatására a következõ eszközleírók jönnek létre:</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Ez a rész csak a Vinum korábbi, elavult implementációjára vonatkozik.</p></div></td></tr></tbody></table></div><div class=paragraph><p>A <span class=filename>/dev/vinum/control</span> és <span class=filename>/dev/vinum/controld</span> nevû vezérlõeszközök, melyeket a <a href="https://man.freebsd.org/cgi/man.cgi?query=gvinum&amp;sektion=8&amp;format=html">gvinum(8)</a> és a Vinum démon használ.
* Mindegyik kötethez egy eszközleíró tartozik. Ezek a Vinum számára a központi eszközök, ezért az elõbbi konfiguráció révén megjelennek a <span class=filename>/dev/gvinum/myvol</span>, <span class=filename>/dev/gvinum/mirror</span>, <span class=filename>/dev/gvinum/striped</span>, <span class=filename>/dev/gvinum/raid5</span> és <span class=filename>/dev/gvinum/raid10</span> eszközök.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Ez a rész csak a Vinum korábbi, elavult implementációjára vonatkozik.</p></div></td></tr></tbody></table></div><div class=paragraph><p>Az egyes meghajtókhoz tartozó leírók a <span class=filename>/dev/vinum/drive</span> könyvtárban találhatóak. Ezek valójában szimbolikus linkek a megfelelõ lemezes eszközökre.
* Minden kötethez közvetlen leírók tartoznak <span class=filename>/dev/gvinum</span> könyvtárban.
* Az egyes erek és allemezek eszközleírói a <span class=filename>/dev/gvinum/plex</span> és <span class=filename>/dev/gvinum/sd</span> könyvtárakban jelennek meg.</p></div><div class=paragraph><p>Például tekintsük most az alábbi konfigurációs állományt:</p></div><div class="literalblock programlisting"><div class=content><pre>	drive drive1 device /dev/sd1h
	drive drive2 device /dev/sd2h
	drive drive3 device /dev/sd3h
	drive drive4 device /dev/sd4h
    volume s64 setupstate
      plex org striped 64k
        sd length 100m drive drive1
        sd length 100m drive drive2
        sd length 100m drive drive3
        sd length 100m drive drive4</pre></div></div><div class=paragraph><p>Az állomány feldolgozása után az eszközleírókat a <a href="https://man.freebsd.org/cgi/man.cgi?query=gvinum&amp;sektion=8&amp;format=html">gvinum(8)</a> az alábbi módon szervezi a <span class=filename>/dev/gvinum</span> könyvtárban:</p></div><div class="literalblock programlisting"><div class=content><pre>	drwxr-xr-x  2 root  wheel       512 Apr 13 16:46 plex
	crwxr-xr--  1 root  wheel   91,   2 Apr 13 16:46 s64
	drwxr-xr-x  2 root  wheel       512 Apr 13 16:46 sd

    /dev/vinum/plex:
    total 0
    crwxr-xr--  1 root  wheel   25, 0x10000002 Apr 13 16:46 s64.p0

    /dev/vinum/sd:
    total 0
    crwxr-xr--  1 root  wheel   91, 0x20000002 Apr 13 16:46 s64.p0.s0
    crwxr-xr--  1 root  wheel   91, 0x20100002 Apr 13 16:46 s64.p0.s1
    crwxr-xr--  1 root  wheel   91, 0x20200002 Apr 13 16:46 s64.p0.s2
    crwxr-xr--  1 root  wheel   91, 0x20300002 Apr 13 16:46 s64.p0.s3</pre></div></div><div class=paragraph><p>Jóllehet, az ereket és allemezeket nem ajánlott külön-külön elnevezni, a Vinum meghajtóknak nevet kell adni. Ezzel megoldhatóvá válik, hogy az egyes meghajtók automatikusan felismerhetõek legyenek abban az esetben is, amikor fizikailag áthelyezzük ezeket. A meghajtók nevei legfeljebb 32 karakteresek lehetnek.</p></div><div class=sect3><h4 id=_állományrendszerek_létrehozása>21.7.1. Állományrendszerek létrehozása<a class=anchor href=#_állományrendszerek_létrehozása></a></h4><div class=paragraph><p>A kötetek egyetlen kivétellel teljesen azonosak a lemezekkel a rendszer számára. Ugyanis a UNIX®-os meghajtóktól eltérõen a Vinum nem particionálja a köteteket, és ezért nem is tárolnak partíciós táblát. Ez megkövetelte néhány lemezkezelõ segédprogram, leginkább a <a href="https://man.freebsd.org/cgi/man.cgi?query=newfs&amp;sektion=8&amp;format=html">newfs(8)</a> módosítását, mivel azok korábban megpróbálták a Vinum-kötetek nevének utolsó betûit egy partíció azonosítójaként értelmezni. Például egy lemezes meghajtó neve <span class=filename>/dev/ad0a</span> vagy <span class=filename>/dev/da2h</span> alakú. Az elõbbi az elsõ (0) IDE lemez elsõ (<span class=filename>a</span>) partícióját, míg az utóbbi a harmadik (2) SCSI lemez nyolcadik (<span class=filename>h</span>) partícióját jelöli. Ezzel szemben azonban a Vinum-kötetek neve <span class=filename>/dev/gvinum/concat</span> alakú lesz, ahol a név semmilyen kapcsolatban nem áll a partíció nevével.</p></div><div class=paragraph><p>Hétköznapi esetben a <a href="https://man.freebsd.org/cgi/man.cgi?query=newfs&amp;sektion=8&amp;format=html">newfs(8)</a> megpróbálja a lemez nevét értelmezni, és panaszkodik, ha nem sikerül. Például:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># newfs /dev/gvinum/concat</span>
newfs: /dev/gvinum/concat: can<span class=s1>&#39;t figure out file system partition</span></code></pre></div></div><div class=paragraph><p>A köteten a <a href="https://man.freebsd.org/cgi/man.cgi?query=newfs&amp;sektion=8&amp;format=html">newfs(8)</a> parancs kiadásával tudunk állományrendszert létrehozni:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># newfs /dev/gvinum/concat</span></code></pre></div></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>A FreeBSD 5.0 elõtt verzióiban a <a href="https://man.freebsd.org/cgi/man.cgi?query=newfs&amp;sektion=8&amp;format=html">newfs(8)</a> parancsnak a régi elnevezési séma használata mellett még át kell adni egy -v kapcsolót is:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># newfs -v /dev/vinum/concat</span></code></pre></div></div></td></tr></tbody></table></div></div></div><div class=sect2><h3 id=vinum-config>21.8. A Vinum beállítása<a class=anchor href=#vinum-config></a></h3><div class=paragraph><p>A <span class=filename>GENERIC</span> rendszermag nem tartalmazza a Vinumot. Habár készíteni lehet olyan rendszermagot, amelyik támogatja a Vinumot, mégsem ajánlott. A Vinumot a szabványos módon modulként (kld) indíthatjuk el. Még a <a href="https://man.freebsd.org/cgi/man.cgi?query=kldload&amp;sektion=8&amp;format=html">kldload(8)</a> használatára sincs szükség, mivel a <a href="https://man.freebsd.org/cgi/man.cgi?query=gvinum&amp;sektion=8&amp;format=html">gvinum(8)</a> indulása során ellenõrzi a modul jelenlétét és betölti, ha még nem lenne jelen.</p></div><div class=sect3><h4 id=_indítás>21.8.1. Indítás<a class=anchor href=#_indítás></a></h4><div class=paragraph><p>A Vinum alapvetõen ugyanúgy tárolja a konfigurációkat a slice-okban, mint maguk a konfigurációs állományok. A konfigurációs adatbázis beolvasása során a Vinum felismeri azokat a kulcsszavakat, amelyeknek nem szabad elõfordulniuk az állományokban. Például a lemezek beállítása tartalmazhatja a következõ szöveget:</p></div><div class="literalblock programlisting"><div class=content><pre>volume myvol state up
volume bigraid state down
plex name myvol.p0 state up org concat vol myvol
plex name myvol.p1 state up org concat vol myvol
plex name myvol.p2 state init org striped 512b vol myvol
plex name bigraid.p0 state initializing org raid5 512b vol bigraid
sd name myvol.p0.s0 drive a plex myvol.p0 state up len 1048576b driveoffset 265b plexoffset 0b
sd name myvol.p0.s1 drive b plex myvol.p0 state up len 1048576b driveoffset 265b plexoffset 1048576b
sd name myvol.p1.s0 drive c plex myvol.p1 state up len 1048576b driveoffset 265b plexoffset 0b
sd name myvol.p1.s1 drive d plex myvol.p1 state up len 1048576b driveoffset 265b plexoffset 1048576b
sd name myvol.p2.s0 drive a plex myvol.p2 state init len 524288b driveoffset 1048841b plexoffset 0b
sd name myvol.p2.s1 drive b plex myvol.p2 state init len 524288b driveoffset 1048841b plexoffset 524288b
sd name myvol.p2.s2 drive c plex myvol.p2 state init len 524288b driveoffset 1048841b plexoffset 1048576b
sd name myvol.p2.s3 drive d plex myvol.p2 state init len 524288b driveoffset 1048841b plexoffset 1572864b
sd name bigraid.p0.s0 drive a plex bigraid.p0 state initializing len 4194304b driveoff set 1573129b plexoffset 0b
sd name bigraid.p0.s1 drive b plex bigraid.p0 state initializing len 4194304b driveoff set 1573129b plexoffset 4194304b
sd name bigraid.p0.s2 drive c plex bigraid.p0 state initializing len 4194304b driveoff set 1573129b plexoffset 8388608b
sd name bigraid.p0.s3 drive d plex bigraid.p0 state initializing len 4194304b driveoff set 1573129b plexoffset 12582912b
sd name bigraid.p0.s4 drive e plex bigraid.p0 state initializing len 4194304b driveoff set 1573129b plexoffset 16777216b</pre></div></div><div class=paragraph><p>Az elõbbiektõl nyilvánvalóan eltér abban, hogy itt már megjelennek a konkrét pozíciókra és elnevezésekre vonatkozó információk (melyeket a felhasználó is megadhat, azonban ezt nem tanácsoljuk), valamint az állapotok (ezeket nem láthatja a felhasználó). A Vinum a konfigurációban nem tárolja a meghajtókat, helyette a beállított lemezes meghajtók partícióin fog Vinum-címkéket keresni. Ennek köszönhetõen a Vinum még akkor is képes pontosan megtalálni a meghajtókat, amikor megváltoznak a hozzá tartozó UNIX®-os meghajtók azonosítói.</p></div><div class=sect4><h5 id=vinum-rc-startup>21.8.1.1. Automatikus indítás<a class=anchor href=#vinum-rc-startup></a></h5><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Ez a rész csak a Vinum elavult implementációjára vonatkozik. A <a href="https://man.freebsd.org/cgi/man.cgi?query=loader.conf&amp;sektion=5&amp;format=html">loader.conf(5)</a> közvetítésével a <em>Gvinum</em> mindig automatikusan elindul a hozzá tartozó modul betöltésével együtt. Ha a rendszerindításkor be akarjuk tölteni a <em>Gvinum</em> modult, akkor a <span class=filename>/boot/loader.conf</span> állományba vegyük fel a <code>geom_vinum_load="YES"</code> sort.</p></div></td></tr></tbody></table></div><div class=paragraph><p>Az alábbi sort mindenképpen hozzá kell adnunk az <span class=filename>/etc/rc.conf</span> állományhoz, hogy a Vinum a rendszerindítás során automatikusan elinduljon:</p></div><div class="literalblock programlisting"><div class=content><pre>start_vinum=&#34;YES&#34;		# állítsuk YES-re az indításhoz</pre></div></div><div class=paragraph><p>Hozzuk létre és írjuk bele, ha nem lenne <span class=filename>/etc/rc.conf</span> nevû állományunk. Ennek hatására a rendszer az indulás során betölti a Vinum kld modult, és a konfigurációban szereplõ objektumokat elindítja. Ez még az állományrendszerek csatlakoztatása elõtt történik meg, aminek révén a Vinum-köteteken található állományrendszereket a rendszer automatikusan át tudja vizsgálni az <a href="https://man.freebsd.org/cgi/man.cgi?query=fsck&amp;sektion=8&amp;format=html">fsck(8)</a> segítségével, majd csatlakoztatja ezeket.</p></div><div class=paragraph><p>Amikor a Vinumot a <code>vinum start</code> paranccsal indítjuk el, a Vinum beolvassa a konfigurációs adatbázist a Vinum-meghajtók egyikérõl. Normál körülmények között mindegyik meghajtón megtalálható a konfigurációs adatbázis egy példánya, ezért szinte teljesen mindegy, melyik meghajtót is olvassa. Egy rendszer-összeomlás után azonban a Vinumnak meg kell tudnia állapítania, melyik meghajtón található meg az adatbázis legfrissebb példánya, és ezt kell beolvasnia. Ezután a lemaradt meghajtókon található adatbázispéldányokat szinkronizálja ehhez a változathoz.</p></div></div></div></div><div class=sect2><h3 id=vinum-root>21.9. Rendszerindítás Vinum-kötetrõl<a class=anchor href=#vinum-root></a></h3><div class=paragraph><p>Olyan számítógépeknél, ahol a teljesen tükrözött Vinum-alapú állományrendszereket használunk, kívánatos lehet magát a rendszerindításhoz használt állományrendszert is tükrözni. Egy ilyen konfiguráció összeállítása már messze nem annyira egyszerû, mint egy tetszõleges állományrendszer esetén, mivel:</p></div><div class=ulist><ul><li><p>Az indításhoz használt állományrendszernek már a folyamat nagyon korai szakaszában rendelkezésre kell állnia, ezért a Vinumnak már itt elérhetõnek kell lennie.</p></li><li><p>A rendszerindító állományrendszert tartalmazó köteten még ott kell lennie a rendszerindító kódnak és a rendszermagnak is, melyeket a rendszer saját eszközein (például ilyen a BIOS a PC-knél) keresztül kell tudnunk beolvasni, amiket viszont nem tudunk felkészíteni a Vinumra.</p></li></ul></div><div class=paragraph><p>A soronkövetkezõ szakaszokban "rendszerindító kötetként" (root volume) fogunk általánosságban véve hivatkozni a rendszerindításhoz használt állományrendszert tartalmazó Vinum-kötetre. Ennek megfelelõen valószínûleg jó ötlet a <code>"root"</code> névvel azonosítani ezt a kötetet, habár technikai szempontból ezt semmi nem követeli meg. Az itt felsorakozó példákban azonban ezt a nevet fogjuk használni.</p></div><div class=sect3><h4 id=_a_vinum_kellõen_korai_indítása>21.9.1. A Vinum kellõen korai indítása<a class=anchor href=#_a_vinum_kellõen_korai_indítása></a></h4><div class=paragraph><p>Ennek kiváltásához számos lépést kell megtennünk:</p></div><div class=ulist><ul><li><p>A rendszermagnak már el kell érnie a Vinumot a rendszerindítás során. Emiatt a <a href=#vinum-rc-startup>Automatikus indítás</a>ban leírt automatikus indítási módszer nem alkalmazható erre a feladatra, és a <code>start_vinum</code> paramétert <em>nem</em> is szabad használni a most ismertetendõ konfigurációban. A Vinumot statikusan bele is építhetjük a rendszermagba és így állandóan elérhetõ, de ez általában nem kielégítõ megoldás. Megoldhatjuk úgy is, ha a <span class=filename>/boot/loader</span>-re (<a href=./#boot-loader>A harmadik fokozat (/boot/loader)</a>) bízzuk a vinum modul betöltését, még a rendszermag elõtt. Ezt az alábbi sorral válthatjuk ki a <span class=filename>/boot/loader.conf</span> állományban:</p><div class="literalblock programlisting"><div class=content><pre>geom_vinum_load=&#34;YES&#34;</pre></div></div></li></ul></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>A <em>Gvinum</em> használata során az összes többi beállítás automatikusan végrehajtódik, amint a modul betöltõdik, ezért ilyenkor csak a fentebb leírt eljárásra van szükség. Az itt felsoroltak csak az elavult Vinum implementációra vonatkoznak, csupán a régebbi típusú rendszerek kedvéért említjük meg.</p></div></td></tr></tbody></table></div><div class=paragraph><p>A Vinumot nagyon korán életre kell keltenünk, hiszen a rendszerindításhoz használt állományrendszert tartalmazó kötetet kell élesítenünk. Alapértelmezés szerint a Vinum rendszerszinten futó része nem keres addig semmilyen Vinum-kötetinformációval rendelkezõ meghajtót, amíg a rendszergazda (vagy valamelyik rendszerindító szkript) ki nem adja a <code>vinum start</code> parancsot.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>A most következõ bekezdések mutatják be a szükséges lépéseket.</p></div></td></tr></tbody></table></div><div class=paragraph><p>Ha hozzáadjuk a következõ sort a <span class=filename>/boot/loader.conf</span> állományhoz, akkor azzal utasíthatjuk a Vinumot, hogy a rendszermag indítása során vizsgálja át az összes meghajtót:</p></div><div class="literalblock programlisting"><div class=content><pre>vinum.autostart=&#34;YES&#34;</pre></div></div><div class=paragraph><p>Nem szükséges megmondani a rendszermagnak, merre keresse a rendszerindításhoz használt állományrendszert. A <span class=filename>/boot/loader</span> megkeresi a hozzá tartozó eszközt a <span class=filename>/etc/fstab</span> állományban és átadja ezt az információt a rendszermagnak. Amikor a csatlakoztatására kerül sor, a rendszermag az eszköz nevébõl meg tudja állapítani, melyik eszközmeghajtót kérje meg a belsõ (fõ- és al)eszközazonosító leképzéséhez.</p></div></div><div class=sect3><h4 id=_a_vinum_alapú_rendszerindító_kötet_elérése_a_rendszertöltés_során>21.9.2. A Vinum-alapú rendszerindító kötet elérése a rendszertöltés során<a class=anchor href=#_a_vinum_alapú_rendszerindító_kötet_elérése_a_rendszertöltés_során></a></h4><div class=paragraph><p>Mivel a jelenlegi FreeBSD rendszertöltõ csak 7,5 KB méretû és egyébként is csak az UFS állományrendszerrõl tud állományokat beolvasni (mint például a <span class=filename>/boot/loader</span>t), teljesen lehetetlen még a Vinum belsõ szerkezetére is megtanítani, tehát a Vinum-konfigurációk értelmezésére és magának a rendszerindító kötet elemeinek kielemzésére. Ezért be kell vetnünk néhány trükköt ahhoz, hogy a rendszerindító kód számára a rendszerindításhoz használható szabványos <code>"a"</code> partíció képzetét keltsük.</p></div><div class=paragraph><p>Mindez csak akkor válik elérhetõvé, ha az alábbi követelményeket teljesíti a rendszerindító kötet:</p></div><div class=ulist><ul><li><p>Nem lehet csíkozott vagy RAID-5 típusú.</p></li><li><p>Erenként nem tartalmazhat egynél több összefûzött allemezt.</p></li></ul></div><div class=paragraph><p>Láthatjuk, hogy hasznos és lehetséges is több eret használni, melyek mindegyike a rendszerindító állományrendszer egy-egy másolatát tartalmazza. Az indulás folyamán azonban ezen példányok közül csak az egyiken fogja keresni a rendszer a rendszertöltõt és a többi állományt egészen addig, amíg a rendszermag magát az állományrendszert nem csatlakoztatja. A látszat kedvéért az ereken belül található allemezek mindegyikének lennie kell egy saját <code>"a"</code> partíciójának, amivel lényegében alkalmassá válik a rendszerindításra. Ezeknek a hamis <code>"a"</code> partícióknak nem kell feltétlenül a többiekkel megegyezõ pozíciókon elhelyezkedniük, azonban a tévedések elkerülése érdekében valószínûleg hasznos olyan Vinum-köteteket létrehozni, ahol a keletkezõ tükrözött eszközök szimmetrikusak.</p></div><div class=paragraph><p>A rendszerindító kötet egyes eszközökön található <code>"a"</code> partícióit az alábbiak segítségével állíthatjuk be:</p></div><div class="exampleblock procedure"><div class=content><div class="olist arabic"><ol class=arabic><li><p>A rendszerindító kötet részeként megjelenõ eszközön található allemez helyét (az eszköz elejétõl számított eltolását) és méretét ellenõrizni kell az alábbi parancs segítségével:</p><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># gvinum l -rv root</span></code></pre></div></div><div class=paragraph><p>Ne felejtsük el, hogy a Vinum az eltolásokat és méreteket byte-okban méri. Ezekbõl tehát úgy nyerünk a <code>bsdlabel</code> használatához szükséges blokkszámokat, ha ezeket elosztjuk 512-vel.</p></div></li><li><p>Futassuk le a</p><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># bsdlabel -e eszköznév</span></code></pre></div></div><div class=paragraph><p>parancsot minden olyan eszközön, amelyik részt vesz a rendszerindító kötet kialakításában. Az <em>eszköznév</em> legyen a slice (fdisk)-táblát nem tartalmazó lemezek esetén a lemez neve (mint például <span class=filename>da0</span>), vagy ellenkezõ esetben a slice neve (például <span class=filename>ad0s1</span>).</p></div><div class=paragraph><p>Ha már lenne egy <code>"a"</code> partíció az eszközön (valószínûleg egy Vinum elõtti rendszeríndító állományrendszert tartalmaz), nevezzük át valami másra és így továbbra is elérhetõ marad (biztos, ami biztos), viszont többé már nem lesz a rendszer számára alapértelmezett rendszerindító eszköz. Az aktív partíciók (mint például az éppen csatlakoztatott rendszerindító állományrendszer) nem nevezhetõek át, ezért ezt a lépést csak akkor tudjuk megtenni, ha a rendszerünket egy "Fixit" (Helyreállító) eszközrõl indítjuk, vagy egy olyan kétlépéses folyamat során, ahol (tükrözés esetén) a lemezrõl még nem indítottuk el a rendszert.</p></div><div class=paragraph><p>Ezt követõen az eszközön található Vinum-partíciót (amennyiben létezik) az eszközön levõ allemez eltolásához kell helyezni. Ennek eredménye lesz az új <code>"a"</code> partíció <code>"offset"</code> értéke. A partíció <code>"size"</code> (méret) értéke szó szerint átemelhetõ a fenti számításból. Az <code>"fstype"</code> legyen <code>4.2BSD</code>. Az <code>"fsize"</code>, <code>"bsize"</code> és <code>"cpg"</code> értékeket a jelenlegi állományrendszerhez mérten ajánlott megválasztani, azonban itt most egyáltalán nem bírnak jelentõséggel.</p></div><div class=paragraph><p>Ezzel a módszerrel létesítettünk egy olyan új <code>"a"</code> partíciót, amely lefedi az eszközön található Vinum-partíciót. Jegyezzük meg, hogy a <code>bsdlabel</code> kizárolag csak abban az esetben fogja megengedi ezt az átfedést, ha a Vinum-partíciónk <code>"vinum"</code> típussal van megjelölve.</p></div></li><li><p>Készen is vagyunk! Most már van minden eszközön egy hamisított <code>"a"</code> partíciónk, amelyeken megtalálható a rendszerindító kötet egy-egy másolata. Határozottan ajánlott még egyszer ellenõrizni a munkánkat az alábbi parancs kiadásával:</p><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># fsck -n /dev/eszköznéva</span></code></pre></div></div></li></ol></div></div></div><div class=paragraph><p>Figyeljünk arra, hogy az összes vezérlési információt tartalmazó állománynak a Vinum-köteten található rendszerindító állományrendszerre kell vonatkoznia, ami viszont egy új Vinum rendszerindító kötet beállítása után nem feltétlenül egyezik meg a jelenlegi aktív állományrendszerrel. Különösen az <span class=filename>/etc/fstab</span> és <span class=filename>/boot/loader.conf</span> állományokat kell ilyen szempontból ellenõriznünk.</p></div><div class=paragraph><p>A következõ indítás során a rendszertöltõ már az új Vinum-alapú rendszerindító állományrendszerrõl fogja összeszedni a mûködéséhez szükséges adatokat és ezeknek megfelelõen cselekedni. Végül, a rendszermag inicializálója után, mikor az összes eszközt felismerte, egy ehhez hasonló feltûnõ üzenet fogja jelezni a beállítás sikerességét:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>Mounting root from ufs:/dev/gvinum/root</code></pre></div></div></div><div class=sect3><h4 id=_egy_vinum_alapú_rendszerindító_állományrendszer_példája>21.9.3. Egy Vinum-alapú rendszerindító állományrendszer példája<a class=anchor href=#_egy_vinum_alapú_rendszerindító_állományrendszer_példája></a></h4><div class=paragraph><p>Miután sikeresen konfiguráltuk a rendszerindító Vinum-kötetet, a <code>gvinum l -rv root</code> kimenete nagyjából így fog kinézni:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>...
Subdisk root.p0.s0:
		Size:        125829120 bytes <span class=o>(</span>120 MB<span class=o>)</span>
		State: up
		Plex root.p0 at offset 0 <span class=o>(</span>0  B<span class=o>)</span>
		Drive disk0 <span class=o>(</span>/dev/da0h<span class=o>)</span> at offset 135680 <span class=o>(</span>132 kB<span class=o>)</span>

Subdisk root.p1.s0:
		Size:        125829120 bytes <span class=o>(</span>120 MB<span class=o>)</span>
		State: up
		Plex root.p1 at offset 0 <span class=o>(</span>0  B<span class=o>)</span>
		Drive disk1 <span class=o>(</span>/dev/da1h<span class=o>)</span> at offset 135680 <span class=o>(</span>132 kB<span class=o>)</span></code></pre></div></div><div class=paragraph><p>Itt (a <span class=filename>/dev/da0h</span> partícióhoz képesti) <code>135680</code>-as eltoltás értékekre kell figyelnünk. Ez képzõdik le a <code>bsdlabel</code> fogalmi rendszerében aztán 265 darab 512 byte-os blokkra a lemezen. Ehhez hasonlóan a rendszerindító kötet mérete 245 760 darab 512 byte-os blokk lesz. A rendszerindító kötet másodpéldányát tartalmazó <span class=filename>/dev/da1h</span> ugyanilyen beállításokkal rendelkezik.</p></div><div class=paragraph><p>Az említett eszközök valahogy így jelennek meg a <code>bsdlabel</code> szerint:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>...
8 partitions:
<span class=c>#        size   offset    fstype   [fsize bsize bps/cpg]</span>
  a:   245760      281    4.2BSD     2048 16384     0   <span class=c># (Cyl.    0*- 15*)</span>
  c: 71771688        0    unused        0     0         <span class=c># (Cyl.    0 - 4467*)</span>
  h: 71771672       16     vinum                        <span class=c># (Cyl.    0*- 4467*)</span></code></pre></div></div><div class=paragraph><p>Megfigyelhetõ, hogy a hamis <code>"a"</code> partíció <code>"size"</code> paraméter értéke megegyezik a fentebb becsült értékkel, miközben az <code>"offset"</code> paraméter értéke egyenlõ lesz a <code>"h"</code> Vinum-partíción belüli eltolás és az eszközön (vagy slice-on) belüli eltolás összegével. Ez jellemzõen egy olyan beállítás, amivel szükségszerûen el tudjuk kerülni a <a href=#vinum-root-panic>Semmi sem indul, a rendszertöltõ hibákat ír</a>ban leírt hibajelenséget. Látható továbbá az is, hogy az egész <code>"a"</code> partíció végig az eszköz összes Vinum adatát tartalmazó <code>"h"</code> partíciójában foglal helyet.</p></div><div class=paragraph><p>A példával kapcsolatban megjegyezzük, hogy itt az egész eszközt a Vinum felügyelete alá bocsátottuk, tehát nem marad hátra semmilyen Vinum elõtt használt rendszerindító partíció, hiszen ez egy olyan lemez, amelyet eleve egy Vinum-konfigurációba szántunk.</p></div></div><div class=sect3><h4 id=_hibakeresés_3>21.9.4. Hibakeresés<a class=anchor href=#_hibakeresés_3></a></h4><div class=paragraph><p>Fontos tudunk, hogy probléma esetén hogyan tudjuk helyreállítani a rendszerünket. A következõ felsorolásban bemutatunk néhány ismert buktatót és a megoldásaikat.</p></div><div class=sect4><h5 id=_a_rendszertöltõ_elindul_de_a_rendszer_viszont_már_nem>21.9.4.1. A rendszertöltõ elindul, de a rendszer viszont már nem<a class=anchor href=#_a_rendszertöltõ_elindul_de_a_rendszer_viszont_már_nem></a></h5><div class=paragraph><p>Ha valamilyen okból a rendszer nem indulna el, a 10 másodpercig tartó visszaszámlálás során a rendszertöltõt még meg tudjuk állítani a <kbd>szóköz</kbd> lenyomásával. Ekkor a betöltõ által használt változók (mint például a <code>vinum.autostart</code>) a <code>show</code> segítségével megvizsgálhatóak és a <code>set</code> vagy <code>unset</code> parancsokkal módosíthatóak.</p></div><div class=paragraph><p>Ha mindössze az volt a probléma, hogy a Vinum modulja nem szerepelt az automatikusan betöltendõ modulok között, a <code>load geom_vinum</code> parancs kiadásával betölthetjük azt.</p></div><div class=paragraph><p>Miután végeztünk, a rendszerindítás folyamata a <code>boot -as</code> paranccsal folytatható. A <code>-as</code> kapcsolók jelzik a rendszermag számára, hogy kérdezzen rá a rendszerindító állományrendszerre a csatlakoztatása elõtt (<code>-a</code>) és csak egyfelhasználós módban indítsa a rendszert (<code>-s</code>), ahol a rendszerindító állományrendszer írásvédett. Így, ha csak egyetlen eret csatlakoztattunk egy többeres kötetbõl, az erek még véletlenül sem tudnak egymásnak ellentmondó állapotba kerülni.</p></div><div class=paragraph><p>Amikor megjelenik a csatlakoztatandó rendszerindító állományrendszert bekérése, bármelyik érvényes rendszerindításra alkalmas állományrendszer megadható. Amennyiben az <span class=filename>/etc/fstab</span> állományt jól beállítottuk, az alapértelmezett érték egy <code>ufs:/dev/gvinum/root</code> értékhez hasonló alakú lesz. Itt általában egy <code>ufs:da0d</code> formátumú értéket láthatunk, amely feltehetõen egy Vinum használata elõtti rendszerindító állományrendszert tartalmazó partíció. Legyünk óvatosak, ha itt egy olyan <code>"a"</code> partíciót adunk meg, amely valójában egy rendszerindító Vinum-eszköz allemezeire hivatkozik, mivel egy tükrözött konfiguráció esetén csak az eszköz egyik részét fogjuk csatlakoztatni. Ha a késõbbiekben ezt az állományrendszert már nem csak írásvédett módban csatlakoztatjuk, mindenképpen el kell távolítanunk a rendszerindító Vinum-kötetbõl a többi eret, mivel máskülönben nagy valószínûséggel eltérõ adatokat fognak tartalmazni.</p></div></div><div class=sect4><h5 id=_csak_az_elsõdleges_rendszertöltõ_indul_el>21.9.4.2. Csak az elsõdleges rendszertöltõ indul el<a class=anchor href=#_csak_az_elsõdleges_rendszertöltõ_indul_el></a></h5><div class=paragraph><p>Amikor az elsõdleges rendszertöltõ még elindul, viszont a <span class=filename>/boot/loader</span> már nem tud betöltõdni (ezt rendszerindítás megkezdése után bal oldalt rögtön megjelenõ forgó vonalból vehetjük észre), a <kbd>szóköz</kbd> lenyomásával itt még tehetünk egy kísérletet a betöltés megszakítására. Ennek hatására a rendszertöltés megáll a második fázisban, lásd <a href=./#boot-boot1>Az első fokozat (/boot/boot1) és a második fokozat (/boot/boot2)</a>. Itt a rendszerindításhoz megpróbálhatunk megadni egy másik partíciót, például egy olyat, amely a korábbi rendszerindító állományrendszert tartalmazza és amelyet az elõbb átneveztünk az <code>"a"</code>-ról.</p></div></div><div class=sect4><h5 id=vinum-root-panic>21.9.4.3. Semmi sem indul, a rendszertöltõ hibákat ír<a class=anchor href=#vinum-root-panic></a></h5><div class=paragraph><p>Ez a helyzet akkor állhat elõ, ha a Vinum telepítése során tönkretettük volna a rendszertöltõt. Sajnos a Vinum minden esetben 4 KB helyet hagy szabadon a partíció elején, a saját fejléc információjának rögzítése elõtt. Az ide kerülõ elsõ és második fázisú rendszertöltõk, illetve a bsdlabel adatai azonban jelenleg 8 KB helyet kívánnak meg. Így ha a Vinum-partíció egy rendszerindításra szánt slice vagy lemez 0. eltolásánál kezdõdik, a Vinum beállításai felül fogják írni a rendszertöltõt.</p></div><div class=paragraph><p>A rendszertöltõ is ugyanígy felülírja a Vinum fejlécét és akkor a Vinum nem találja a lemezeit, ha a fenti problémát orvosolva, például egy "Fixit" (Helyreállító) lemez segítségével, újratelepítjük a rendszertöltõt a <a href=./#boot-boot1>Az első fokozat (/boot/boot1) és a második fokozat (/boot/boot2)</a>ban bemutatott <code>bsdlabel -B</code> parancs segítségével. Noha a Vinum egyetlen konkrét konfigurációs beállítása vagy a kötetekben tárolt adat sem sérül meg és vissza tudjuk állítani az összes elveszett információt ugyannak a Vinum-konfigurációnak az újbóli megadásával, a helyzetet magát nehéz megoldani. A Vinum-fejléc és a rendszertöltõ ütközésének megszüntetéséhez ugyanis legalább 4 KB-tal arrébb kell mozgatnunk az egész Vinum-partíciót.</p></div></div></div></div></div></div><div class=sect1><h2 id=virtualization>Chapter 22. Virtualizáció<a class=anchor href=#virtualization></a></h2><div class=sectionbody><div class=sect2><h3 id=virtualization-synopsis>22.1. Áttekintés<a class=anchor href=#virtualization-synopsis></a></h3><div class=paragraph><p>A virtualizációs szoftverek lehetõvé teszik, hogy ugyanazon a számítógépen egyszerre több operációs rendszert is futassunk. Ezeknek a programcsomagoknak gyakorta részük egy gazda operációs rendszer is, amely a virtualizációs szoftvert futattja és ismer bizonyos vendég operációs rendszereket.</p></div><div class=paragraph><p>A fejezet elolvasása során megismerjük:</p></div><div class=ulist><ul><li><p>a gazda- és a vendég operációs rendszerek közti különbségeket;</p></li><li><p>hogyan telepítsünk FreeBSD-t egy Intel®-alapú Apple® Macintosh® számítógépre;</p></li><li><p>hogyan telepítsünk a Virtual PC használatával FreeBSD-t Microsoft® Windows®-ra;</p></li><li><p>hogyan hozzuk ki a legtöbbet FreeBSD rendszerünkbõl virtualizáció alatt.</p></li></ul></div><div class=paragraph><p>A fejezet elolvasásához ajánlott:</p></div><div class=ulist><ul><li><p>alapvetõ UNIX®-os és FreeBSD-s ismeretek (<a href=./#basics>A UNIX alapjai</a>);</p></li><li><p>a FreeBSD telepítésének ismerete (<a href=./#install>A FreeBSD telepítése</a>);</p></li><li><p>a hálózati kapcsolatok beállításának ismerete (<a href=./#advanced-networking>Egyéb haladó hálózati témák</a>);</p></li><li><p>külsõs alkalmazások telepítésének ismerete (<a href=./#ports>Alkalmazások telepítése. csomagok és portok</a>).</p></li></ul></div></div><div class=sect2><h3 id=virtualization-guest>22.2. A FreeBSD mint vendég<a class=anchor href=#virtualization-guest></a></h3><div class=sect3><h4 id=virtualization-guest-parallels>22.2.1. Parallelsszel Mac OS®-en<a class=anchor href=#virtualization-guest-parallels></a></h4><div class=paragraph><p>A Parallels Desktop a Mac OS® 10.4.6, vagy afeletti verzióját futattó, Intel®-alapú Apple® Mac® személyi számítógépekre fejlesztett kereskedelmi alkalmazás. A FreeBSD-t teljes mértékben támogatja vendégként. Miután telepítettük a Parallels-t a Mac OS® X-re, be kell állítanunk egy virtuális gépet, majd erre felraknunk a kívánt vendég operációs rendszert.</p></div><div class=sect4><h5 id=virtualization-guest-parallels-install>22.2.1.1. A FreeBSD telepítése Mac OS® X/Parallelsre<a class=anchor href=#virtualization-guest-parallels-install></a></h5><div class=paragraph><p>A FreeBSD Mac OS® X/Parallels párosra telepítéséhez elsõ lépésként készítenünk kell egy új virtuális számítógépet. A létrehozás során válasszuk a <b class=menuref>Guest OS Type</b>-nak (a vendég operációs rendszer típusának) a <span class=guimenuitem>FreeBSD</span>-t:</p></div><div class=imageblock><div class=content><img src=../../../../images/books/handbook/virtualization/parallels-freebsd1.png alt="parallels freebsd1"></div></div><div class=paragraph><p>Ezután adjunk meg egy nagyjából elfogadható méretet a virtuális merevlemezünknek, valamint annyi memóriát, amennyire szükségünk lehet a virtuális FreeBSD-nk használata során. Egy 4 GB-os lemez és 512 MB rendszermemória a legtöbb esetben jó választásnak bizonyulhat a FreeBSD Parallels alatti használata során:</p></div><div class=imageblock><div class=content><img src=../../../../images/books/handbook/virtualization/parallels-freebsd2.png alt="parallels freebsd2"></div></div><div class=imageblock><div class=content><img src=../../../../images/books/handbook/virtualization/parallels-freebsd3.png alt="parallels freebsd3"></div></div><div class=imageblock><div class=content><img src=../../../../images/books/handbook/virtualization/parallels-freebsd4.png alt="parallels freebsd4"></div></div><div class=imageblock><div class=content><img src=../../../../images/books/handbook/virtualization/parallels-freebsd5.png alt="parallels freebsd5"></div></div><div class=paragraph><p>Válasszuk ki a hálózatkezelés típusát és a hálózati csatolót.</p></div><div class=imageblock><div class=content><img src=../../../../images/books/handbook/virtualization/parallels-freebsd6.png alt="parallels freebsd6"></div></div><div class=imageblock><div class=content><img src=../../../../images/books/handbook/virtualization/parallels-freebsd7.png alt="parallels freebsd7"></div></div><div class=paragraph><p>Mentsük el és fejezzük be a konfigurálást.</p></div><div class=imageblock><div class=content><img src=../../../../images/books/handbook/virtualization/parallels-freebsd8.png alt="parallels freebsd8"></div></div><div class=imageblock><div class=content><img src=../../../../images/books/handbook/virtualization/parallels-freebsd9.png alt="parallels freebsd9"></div></div><div class=paragraph><p>Miután a FreeBSD-s virtuális gépünk elkészült, telepítenünk kell rá magát az operációs rendszert is. Ezt a legegyszerûbben a hivatalosan FreeBSD telepítõ CD-rõl, vagy a hivatalos FTP oldalról letölthetõ CD-képpel tehetjük meg. Ha lemásoltuk a megfelelõ CD-képet a Mac® helyi állományrendszerére, vagy behelyeztük a telepítõ CD-t a CD-meghajtóba, kattintsunk a FreeBSD-s Parallels ablakunk jobb alsó sarkában található lemez ikonjára. Ekkor feljön egy párbeszédablak, ahol összerendelhetjük a virtuális gépünk CD-meghajtóját egy lemezen található képpel, vagy éppen a valódi CD-meghajtónkkal.</p></div><div class=imageblock><div class=content><img src=../../../../images/books/handbook/virtualization/parallels-freebsd11.png alt="parallels freebsd11"></div></div><div class=paragraph><p>Ahogy megtettük az imént említett összerendelést, indítsuk is újra a FreeBSD-s virtuális gépünket a megszokott módon, az újraindítás ikonjára kattintva.</p></div><div class=imageblock><div class=content><img src=../../../../images/books/handbook/virtualization/parallels-freebsd10.png alt="parallels freebsd10"></div></div><div class=paragraph><p>Ekkor a rendszer megtalálja a FreeBSD telepítõlemezt és a sysinstall segítségével megkezdi a telepítést a <a href=./#install>A FreeBSD telepítése</a>ben leírtak szerint. Ha szükségünk van rá, telepíthetjük az X11-et is, de egyelõre még ne próbáljuk beállítani.</p></div><div class=imageblock><div class=content><img src=../../../../images/books/handbook/virtualization/parallels-freebsd12.png alt="parallels freebsd12"></div></div><div class=paragraph><p>A telepítés befejezését követõen indítsuk újra a frissen telepített FreeBSD-s virtuális gépünket.</p></div><div class=imageblock><div class=content><img src=../../../../images/books/handbook/virtualization/parallels-freebsd13.png alt="parallels freebsd13"></div></div></div><div class=sect4><h5 id=virtualization-guest-parallels-configure>22.2.1.2. A FreeBSD beállítása Mac OS® X/Parallelsen<a class=anchor href=#virtualization-guest-parallels-configure></a></h5><div class=paragraph><p>Miután telepítettük a FreeBSD-t Mac OS® X/Parallels-re, még vár ránk néhány konfigurációs lépés a rendszer virtuálizált mûködésének optimalizálása érdekében.</p></div><div class="exampleblock procedure"><div class=content><div class="olist arabic"><ol class=arabic><li><p>A rendszerbetöltõ változóinak beállítása</p><div class=paragraph><p>A legfontosabb lépés a <code>kern.hz</code> változó értékének csökkentése, amivel így a FreeBSD processzor-kihasználtságát is csökkentjük a Parallels alatt. Ezt a következõ sor hozzadásával tehetjük meg a <span class=filename>/boot/loader.conf</span> állományban:</p></div><div class="literalblock programlisting"><div class=content><pre>kern.hz=100</pre></div></div><div class=paragraph><p>Enélkül egy üresjáratban levõ FreeBSD Parallels-vendég az iMac® egy processzorának durván 15%-át foglalja le. A változtatás életbe léptetése után azonban ez megközelítõen 5%-ra redukálható.</p></div></li><li><p>Egy új konfigurációs állomány létrehozása a rendszermaghoz</p><div class=paragraph><p>Nyugodtan eltávolíthatjuk az összes SCSI, FireWire és USB eszközmeghajtót. A Parallels által felkínált virtuális hálózati csatolót az <a href="https://man.freebsd.org/cgi/man.cgi?query=ed&amp;sektion=4&amp;format=html">ed(4)</a> meghajtón keresztül tudjuk elérni, ezért az <a href="https://man.freebsd.org/cgi/man.cgi?query=ed&amp;sektion=4&amp;format=html">ed(4)</a> és <a href="https://man.freebsd.org/cgi/man.cgi?query=miibus&amp;sektion=4&amp;format=html">miibus(4)</a> meghajtókon kívül az összes többi elhagyható.</p></div></li><li><p>A hálózati kapcsolat beállítása</p><div class=paragraph><p>Az alapvetõ hálózati beállítás a virtuális gépünkön a DHCP aktiválása, aminek segítségével csatlakozni tudunk arra a helyi hálózatra, amelyen maga a gazda Mac® is megtalálható. Ezt az alábbi sor felvételével tudjuk megoldani az <span class=filename>/etc/rc.conf</span> állományba: <code>ifconfig_ed0="DHCP"</code>. Bõvebb információkért járuljunk a <a href=./#advanced-networking>Egyéb haladó hálózati témák</a> fejezethez.</p></div></li></ol></div></div></div></div></div><div class=sect3><h4 id=virtualization-guest-virtualpc>22.2.2. Virtual PC-vel Windows®-on<a class=anchor href=#virtualization-guest-virtualpc></a></h4><div class=paragraph><p>A Windows®-ra fejlesztett Virtual PC a Microsoft® egyik szabadon letölthetõ szoftverterméke. A rendszerkövetelményeit bõvebben lásd a <a href=http://www.microsoft.com/windows/downloads/virtualpc/sysreq.mspx>http://www.microsoft.com/windows/downloads/virtualpc/sysreq.mspx</a> linken. Miután telepítettük a Microsoft® Windows®-ra a Virtual PC alkalmazást, be kell állítanunk egy virtuális gépet, majd telepítenünk kell rá a kívánt vendég operációs rendszert.</p></div><div class=sect4><h5 id=virtualization-guest-virtualpc-install>22.2.2.1. A FreeBSD telepítése Virtual PC/Microsoft® Windows®-ra<a class=anchor href=#virtualization-guest-virtualpc-install></a></h5><div class=paragraph><p>Amikor a FreeBSD-t a Microsoft® Windows® és Virtual PC párosra akarjuk telepíteni, akkor kezdjünk egy egy új virtuális gép létrehozásával. Ehhez válasszuk ki a menübõl a <span class=guimenuitem>Create a virtual machine</span> (Virtuális gép létrehozása) pontot.</p></div><div class=imageblock><div class=content><img src=../../../../images/books/handbook/virtualization/virtualpc-freebsd1.png alt="virtualpc freebsd1"></div></div><div class=imageblock><div class=content><img src=../../../../images/books/handbook/virtualization/virtualpc-freebsd2.png alt="virtualpc freebsd2"></div></div><div class=paragraph><p>Majd válasszuk az <span class=guimenuitem>Operating system</span> (Operációs rendszer) beállításánál az <span class=guimenuitem>Other</span> (Egyéb) opciót.</p></div><div class=imageblock><div class=content><img src=../../../../images/books/handbook/virtualization/virtualpc-freebsd3.png alt="virtualpc freebsd3"></div></div><div class=paragraph><p>Ezután válasszuk ki a szándékainknak megfelelõen a telepítendõ FreeBSD példányhoz mért memória és lemezterület mennyiségét. Ahhoz, hogy a FreeBSD fusson Virtual PC alatt, 4 GB-nyi lemezterület és 512 MB RAM beállítása a legtöbb esetben kiválóan megfelelõ.</p></div><div class=imageblock><div class=content><img src=../../../../images/books/handbook/virtualization/virtualpc-freebsd4.png alt="virtualpc freebsd4"></div></div><div class=imageblock><div class=content><img src=../../../../images/books/handbook/virtualization/virtualpc-freebsd5.png alt="virtualpc freebsd5"></div></div><div class=paragraph><p>Mentsük el és fejezzük be a konfigurációt.</p></div><div class=imageblock><div class=content><img src=../../../../images/books/handbook/virtualization/virtualpc-freebsd6.png alt="virtualpc freebsd6"></div></div><div class=paragraph><p>Válasszuk ki a FreeBSD-s virtuális gépünket, majd kattintsunk a <b class=menuref>Settings</b> (Beállítások) menüre és állítsuk be hálózati csatoló és hálózatkezelés típusát.</p></div><div class=imageblock><div class=content><img src=../../../../images/books/handbook/virtualization/virtualpc-freebsd7.png alt="virtualpc freebsd7"></div></div><div class=imageblock><div class=content><img src=../../../../images/books/handbook/virtualization/virtualpc-freebsd8.png alt="virtualpc freebsd8"></div></div><div class=paragraph><p>A FreeBSD-nek otthont adó virtuális gépünk létrehozása után telepítenünk is kell rá a rendszert. Ez legegyszerûbben a hivatalos FreeBSD telepítõ CD-vel vagy a hivatalos FTP oldalról letölthetõ CD-képpel tehetjük meg. Amikor letöltöttük a megfelelõ CD-képet a helyi Windows®-os állományrendszerünkre vagy behelyeztük a telepítéshez használható CD-t a CD-meghajtónkba, a FreeBSD-s virtuális gépünk elindításához kattintsunk rá duplán. Ezt követõen a Virtual PC ablakában kattintsunk a <b class=menuref>CD</b> menüre és válasszuk ki belõle a <b class=menuref>Capture ISO Image…​</b> (Lemezkép használata…​) pontot. Ennek hatására megjelenik egy ablak, amiben a virtuális gépünk CD-meghajtóihoz tudunk csatlakoztatni lemezképeket vagy akár létezõ CD-meghajtókat.</p></div><div class=imageblock><div class=content><img src=../../../../images/books/handbook/virtualization/virtualpc-freebsd9.png alt="virtualpc freebsd9"></div></div><div class=imageblock><div class=content><img src=../../../../images/books/handbook/virtualization/virtualpc-freebsd10.png alt="virtualpc freebsd10"></div></div><div class=paragraph><p>Miután sikeresen beállítottuk a telepítõ CD forrását, indítsuk újra a virtuális gépet az <b class=menuref>Action</b> (Mûvelet) menün belül a <b class=menuref>Reset</b> (Újraindítás) pont kiválasztásával. Így a Virtual PC újraindítja a virtuális rendszert egy olyan speciális BIOS használatával, amely a normális BIOS-hoz hasonlóan elõször megkeresi az elérhetõ CD-meghajtókat.</p></div><div class=imageblock><div class=content><img src=../../../../images/books/handbook/virtualization/virtualpc-freebsd11.png alt="virtualpc freebsd11"></div></div><div class=paragraph><p>Ebben az esetben a FreeBSD telepítõeszközét fogja megtalálni és megkezdi a <a href=./#install>A FreeBSD telepítése</a>ben ismertetett szokásos, sysinstall programra alapuló telepítési eljárást. Ennek során az X11-et is feltelepíthetjük, habár egyelõre még ne állítsuk be.</p></div><div class=imageblock><div class=content><img src=../../../../images/books/handbook/virtualization/virtualpc-freebsd12.png alt="virtualpc freebsd12"></div></div><div class=paragraph><p>Ne felejtsük el kivenni a meghajtóból a telepítéshez használt CD-t vagy elengedni a megfelelõ lemezképet, amikor befejezõdõtt a telepítés. Végezetül indítsuk ismét újra a frissen telepített FreeBSD-s virtuális gépünket.</p></div><div class=imageblock><div class=content><img src=../../../../images/books/handbook/virtualization/virtualpc-freebsd13.png alt="virtualpc freebsd13"></div></div></div><div class=sect4><h5 id=virtualization-guest-virtualpc-configure>22.2.2.2. A FreeBSD beállítása a Microsoft® Windows®/Virtual PC-n<a class=anchor href=#virtualization-guest-virtualpc-configure></a></h5><div class=paragraph><p>Miután a FreeBSD-t minden gond nélkül telepítettük a Microsoft® Windows®-on futó Virtual PC-re, még további beállítási lépéseket is meg kell tennünk a rendszer virtualizált mûködésének finomhangolásához.</p></div><div class="exampleblock procedure"><div class=content><div class="olist arabic"><ol class=arabic><li><p>A rendszertöltõ változóinak beállítása</p><div class=paragraph><p>A legfontosabb teendõnk csökkenteni a <code>kern.hz</code> konfigurációs beállítás értéket, aminek köszönhetõen vissza tudjuk fogni a Virtual PC alatt futó FreeBSD processzorhasználatát. Ezt úgy tudjuk megtenni, ha a <span class=filename>/boot/loader.conf</span> állományba felvesszük a következõ sort:</p></div><div class="literalblock programlisting"><div class=content><pre>kern.hz=100</pre></div></div><div class=paragraph><p>Enélkül a Virtual PC alatt üresjáratban futó FreeBSD vendég operációs rendszer egy egyprocesszoros számítógép idejének durván 40%-át foglalja le. A változtatás után azonban ez az érték pusztán közel 3%-ra csökken le.</p></div></li><li><p>Új konfigurációs állomány létrehozása a rendszermaghoz</p><div class=paragraph><p>Nyugodtan eltávolíthatjuk a SCSI, FireWire és USB eszközmeghajtókat. A Virtual PC által felajánlott virtuális hálózati csatolót a <a href="https://man.freebsd.org/cgi/man.cgi?query=de&amp;sektion=4&amp;format=html">de(4)</a> meghajtón keresztül tudjuk használni, ezért a <a href="https://man.freebsd.org/cgi/man.cgi?query=de&amp;sektion=4&amp;format=html">de(4)</a> és <a href="https://man.freebsd.org/cgi/man.cgi?query=miibus&amp;sektion=4&amp;format=html">miibus(4)</a> eszközön kívül az összes többi hálózati eszköz támogatása kiszedhetõ a rendszermagból.</p></div></li><li><p>A hálózati kapcsolat beállítása</p><div class=paragraph><p>A legalapvetõbb hálózati beállítás csupán annyiból áll, hogy DHCP-n keresztül csatlakoztatjuk a virtuális gépünket ugyanahhoz a helyi hálózathoz, amiben a gazda Microsoft® Windows®-os gépünk is megtalálható. Ezt úgy tudjuk elérni, ha a <span class=filename>/etc/rc.conf</span> állományba megadjuk a <code>ifconfig_de0="DHCP"</code> sort. A komolyabb hálózati beállításokat a <a href=./#advanced-networking>Egyéb haladó hálózati témák</a>ben találhatjuk.</p></div></li></ol></div></div></div></div></div><div class=sect3><h4 id=virtualization-guest-vmware>22.2.3. VMWare-rel MacOS-en<a class=anchor href=#virtualization-guest-vmware></a></h4><div class=paragraph><p>A Mac®-ek számára fejlesztett VMWare Fusion egy olyan kereskedelmi termék, amit az Intel® alapú Apple® Mac® gépekre tudunk telepíteni a Mac OS® 10.4.9 és késõbbi változatain. A FreeBSD itt egy teljesen támogatott vendég operációs rendszer. Miután a VMWare Fusion felkerült a Mac OS® X rendszerünkre, be kell állítanunk a virtuális gépet és telepítenünk rá a vendég operációs rendszert.</p></div><div class=sect4><h5 id=virtualization-guest-vmware-install>22.2.3.1. A FreeBSD telepítése a Mac OS® X/VMWare-re<a class=anchor href=#virtualization-guest-vmware-install></a></h5><div class=paragraph><p>Elõször indítsuk el a VMWare Fusion-t, aminek eredményeképpen betöltõdik a Virtual Machine Library. Egy új virtuális gépre létrehozásához kattintsunk a "New" gombra:</p></div><div class=imageblock><div class=content><img src=../../../../images/books/handbook/virtualization/vmware-freebsd01.png alt="vmware freebsd01"></div></div><div class=paragraph><p>Ekkor bejön az új gép összeállítását segítõ New Virtual Machine Assistant, ahol a továbblépéshez kattintsunk a Continue gombra:</p></div><div class=imageblock><div class=content><img src=../../../../images/books/handbook/virtualization/vmware-freebsd02.png alt="vmware freebsd02"></div></div><div class=paragraph><p>Az operációs rendszerek (<span class=guimenuitem>Operating System</span>) közül válasszuk az "egyéb" (<span class=guimenuitem>Other</span>) kategóriát, majd a <span class=guimenuitem>Version</span> fülön a <span class=guimenuitem>FreeBSD</span> vagy a <span class=guimenuitem>FreeBSD 64-bit</span> változatot attól függõen, hogy 32 bites vagy 64 bites támogatásra van szükségünk:</p></div><div class=imageblock><div class=content><img src=../../../../images/books/handbook/virtualization/vmware-freebsd03.png alt="vmware freebsd03"></div></div><div class=paragraph><p>Adjuk meg a virtuális gép képének nevét és a könyvtárat, ahova el akarjuk menteni:</p></div><div class=imageblock><div class=content><img src=../../../../images/books/handbook/virtualization/vmware-freebsd04.png alt="vmware freebsd04"></div></div><div class=paragraph><p>Válasszuk meg a virtuális géphez tartozó virtuális merevlemez méretét is:</p></div><div class=imageblock><div class=content><img src=../../../../images/books/handbook/virtualization/vmware-freebsd05.png alt="vmware freebsd05"></div></div><div class=paragraph><p>Mondjuk meg, hogy milyen módon szeretnénk telepíteni a virtuális gépre, ISO formátumú lemezképrõl vagy CD-rõl:</p></div><div class=imageblock><div class=content><img src=../../../../images/books/handbook/virtualization/vmware-freebsd06.png alt="vmware freebsd06"></div></div><div class=paragraph><p>Ahogy a Finish feliratú gombra kattintunk, a virtuális gép máris elindul:</p></div><div class=imageblock><div class=content><img src=../../../../images/books/handbook/virtualization/vmware-freebsd07.png alt="vmware freebsd07"></div></div><div class=paragraph><p>Telepítsük fel a FreeBSD-t a megszokott módon vagy a <a href=./#install>A FreeBSD telepítése</a> utasításai mentén:</p></div><div class=imageblock><div class=content><img src=../../../../images/books/handbook/virtualization/vmware-freebsd08.png alt="vmware freebsd08"></div></div><div class=paragraph><p>Miután befejezõdött a telepítés, módosítsuk a virtuális gép beállításait, például a memória mennyiségét:</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>A virtuális gép hardveres beállításai a futása alatt nem változtathatóak meg.</p></div></td></tr></tbody></table></div><div class=imageblock><div class=content><img src=../../../../images/books/handbook/virtualization/vmware-freebsd09.png alt="vmware freebsd09"></div></div><div class=paragraph><p>A virtuális gép által használható processzorok számát:</p></div><div class=imageblock><div class=content><img src=../../../../images/books/handbook/virtualization/vmware-freebsd10.png alt="vmware freebsd10"></div></div><div class=paragraph><p>A CD-meghajtó állapotát. Általában lehetõségünk van a virtuális gépet leválasztani a CD-meghajtóról vagy ISO lemezképrõl, ha már nem használjuk.</p></div><div class=imageblock><div class=content><img src=../../../../images/books/handbook/virtualization/vmware-freebsd11.png alt="vmware freebsd11"></div></div><div class=paragraph><p>A hálózati csatlakozás a virtuális géppel kapcsolatban utolsóként beállítandó tényezõ. Ha a befogadó gépen kívül még más gépeket is el akarunk érni a virtuális géprõl, akkor ehhez mindenképpen a <span class=guimenuitem>Connect directly to the physical network (Bridged)</span> opciót válasszuk. Minden más esetben a <span class=guimenuitem>Share the host’s internet connection (NAT)</span> az ajánlott, mivel így a virtuális gép eléri az internetet, de a hálózatról nem lehet azt elérni.</p></div><div class=imageblock><div class=content><img src=../../../../images/books/handbook/virtualization/vmware-freebsd12.png alt="vmware freebsd12"></div></div><div class=paragraph><p>Miután befejeztük a beállítások finomhangolását, indítsuk is el a frissen telepített FreeBSD-s virtuális gépünket.</p></div></div><div class=sect4><h5 id=virtualization-guest-vmware-configure>22.2.3.2. A FreeBSD beállítása a Mac OS® X/VMWare-en<a class=anchor href=#virtualization-guest-vmware-configure></a></h5><div class=paragraph><p>Ahogy a FreeBSD-t sikeresen telepítettük a Mac OS® X alatt futó VMWare-re, néhány konfigurációs lépést még meg kell tennünk a virtualizált rendszer teljesítmények optimalizálása érdekében.</p></div><div class="exampleblock procedure"><div class=content><div class="olist arabic"><ol class=arabic><li><p>A rendszertöltõ változóinak beállítása</p><div class=paragraph><p>A legfontosabb lépés talán a <code>kern.hz</code> változó értékének csökkentése, amivel a VMWare alatt futó FreeBSD processzorhasználatát szoríthatjuk vissza. Ezt a következõ sor hozzáadásával érhetjük el a <span class=filename>/boot/loader.conf</span> állományban:</p></div><div class="literalblock programlisting"><div class=content><pre>kern.hz=100</pre></div></div><div class=paragraph><p>Enélkül az üresjáratban zakatoló FreeBSD-s VMWare vendég nagyjából az iMac® egyik processzorának 15%-át emészti fel. Ezzel a módosítással azonban ez lenyomható közel 5%-ra.</p></div></li><li><p>Új konfigurációs állomány létrehozása a rendszermaghoz</p><div class=paragraph><p>Nyugodtan törölhetjük az összes FireWire és USB eszköz meghajtóját. A VMWare egy <a href="https://man.freebsd.org/cgi/man.cgi?query=em&amp;sektion=4&amp;format=html">em(4)</a> meghajtón keresztül elérhetõ virtuális hálózati kártyát biztosít, így az <a href="https://man.freebsd.org/cgi/man.cgi?query=em&amp;sektion=4&amp;format=html">em(4)</a> kivételével az összes hálózati eszköz meghajtóját kivehetjük a rendszermagból.</p></div></li><li><p>A hálózat beállítása</p><div class=paragraph><p>A legegyszerûbb hálózati beállítás mindösszesen a DHCP használatát igényli, aminek révén a virtuális gépünk a befogadó Mac®-kel egy helyi hálózatra kerül. Ezt úgy tudjuk engedélyezni, ha az <span class=filename>/etc/rc.conf</span> állományba felvesszük az <code>ifconfig_em0="DHCP"</code> sort. Ha ennél komolyabb hálózati beállítások is érdekelnek minket, akkor olvassuk el a <a href=./#advanced-networking>Egyéb haladó hálózati témák</a>et.</p></div></li></ol></div></div></div></div></div></div><div class=sect2><h3 id=virtualization-host>22.3. A FreeBSD mint gazda<a class=anchor href=#virtualization-host></a></h3><div class=paragraph><p>Gazda operációs rendszerként a FreeBSD évekig nem kapott hivatalosan támogatást egyetlen elterjedtebb virtualizációs megoldás részérõl sem. Sokan erre a célra eddig a VMWare korábbi és inkább már elavult, a Linux® kompatibilitási rétegre épülõ változatait (mint például <a class=package href=https://cgit.freebsd.org/ports/tree/emulators/vmware3/>emulators/vmware3</a>) használták. Nem sokkal azonban a FreeBSD 7.2 megjelenése után a Sun VirtualBox™OSE (Open Source Edition) natív FreeBSD alkalmazásként bukkant fel a Portgyûjteményben.</p></div><div class=paragraph><p>A VirtualBox™ egy folyamatos fejlesztés alatt álló, komplett virtualizációs csomag, amely immáron elérhetõ a legtöbb népszerû operációs rendszerre, mint a Windows®, Mac OS®, Linux® és a FreeBSD. Egyaránt képes Windows® és UNIX® fajtájú vendégrendszerek futattására. Nyílt- és zárt forráskódú változatban is elérhetõ. A felhasználók szempontjából a kettõ közti talán legfontosabb eltérés, hogy a nyílt forráskódú változat nem tartalmaz USB támogatást. A különbségek teljes listája megtalálható a VirtualBox™ wiki "Editions" oldalán, a <a href=http://www.virtualbox.org/wiki/Editions>http://www.virtualbox.org/wiki/Editions</a> címen. FreeBSD alatt jelenleg csak a nyílt forráskódú változat érhetõ el.</p></div><div class=sect3><h4 id=virtualization-virtualbox-install>22.3.1. A VirtualBox™ telepítése<a class=anchor href=#virtualization-virtualbox-install></a></h4><div class=paragraph><p>A VirtualBox™ a <a class=package href=https://cgit.freebsd.org/ports/tree/emulators/virtualbox-ose/>emulators/virtualbox-ose</a> könyvtárból érhetõ el portként, és onnan a következõ parancsokkal telepíthetõ:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># cd /usr/ports/emulators/virtualbox-ose</span>
<span class=c># make install clean</span></code></pre></div></div><div class=paragraph><p>A beállítások közt az egyik leghasznosabb a <code>GuestAdditions</code> nevû programcsomag telepítése. A benne található programokon keresztül a vendégként futó operációs rendszer számos hasznos szolgáltatását el tudjuk érni, úgy mint az egérmutató integrációját (ekkor az egérkurzor zökkenõmentesen használható a gazda és a vendég rendszerben is) vagy a videomemória gyorsabb elérését (különösen Windows® esetében). A vendégekhez telepíthetõ ilyen jellegû kiegészítések az adott rendszer telepítése után a <b class=menuref>Devices</b> menübõl érhetõek el.</p></div><div class=paragraph><p>A VirtualBox™ elsõ indítása elõtt el kell még végeznünk néhány további beállítást. Fontos tudnunk, hogy a port a telepítés során a <span class=filename>/boot/modules</span> könyvtárba tesz még egy rendszermagmodult is, amelyet még külön be kell töltenünk:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># kldload vboxdrv</span></code></pre></div></div><div class=paragraph><p>Ehhez még vegyük fel a következõ sort a <span class=filename>/boot/loader.conf</span> állományba, így a modul a rendszer minden egyes indításakor magától betöltõdik:</p></div><div class="literalblock programlisting"><div class=content><pre>vboxdrv_load=&#34;YES&#34;</pre></div></div><div class=paragraph><p>A VirtualBox™ 3.1.2 elõtti változatai ezenkívül még igénylik a <span class=filename>proc</span> állományrendszer csatlakoztatását is. Az újabb változatokban erre már nincs szükség, mivel ezekben helyette már a <a href="https://man.freebsd.org/cgi/man.cgi?query=sysctl&amp;sektion=3&amp;format=html">sysctl(3)</a> könyvtár függvényeit használják.</p></div><div class=paragraph><p>Ha viszont a port valamelyik korábbi változatát használjuk, akkor kövessük a lentebb szereplõ utasításokat és csatlakoztassuk a <span class=filename>proc</span> állományrendszert:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># mount -t procfs proc /proc</span></code></pre></div></div><div class=paragraph><p>Ha hozzáadjuk az alábbi sort a <span class=filename>/etc/fstab</span> állományhoz, akkor ez a beállítás is megmarad a rendszer újraindítása után:</p></div><div class="literalblock programlisting"><div class=content><pre>proc     /proc   procfs  rw        0       0</pre></div></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Nagyon valószínû, hogy <span class=filename>proc</span> állományrendszerrel van gondunk, amikor a következõ hibaüzenetet kapjuk a VirtualBox™ indításakor:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>VirtualBox: supR3HardenedExecDir: couldn<span class=s1>&#39;t read &#34;&#34;, errno=2 cchLink=-1</span></code></pre></div></div><div class=paragraph><p>Ilyenkor a <code>mount</code> parancs kiadásával ellenõrizzük az állományrendszer sikeres csatlakoztatását.</p></div></td></tr></tbody></table></div><div class=paragraph><p>A VirtualBox™ telepítése során keletkezik még egy <code>vboxusers</code> nevû csoport. Ide azokat a felhasználókat vegyük fel, akik részére szeretnénk engedélyezni a VirtualBox™ használatát. A csoportba új tagokat például a <code>pw</code> paranccsal tudunk felvenni:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># pw groupmod vboxusers -m felhasználónév</span></code></pre></div></div><div class=paragraph><p>Ezek után a VirtualBox™ indításához válasszuk a grafikus környezetünk menüjében található <span class=guimenuitem>Sun VirtualBox</span> menüpontot, vagy egy terminálban gépeljük be ezt a parancsot:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>% VirtualBox</code></pre></div></div><div class=paragraph><p>A VirtualBox™ beállításának további lehetõségeirõl a <a href=http://www.virtualbox.org/>http://www.virtualbox.org/</a> címen elérhetõ hivatalos holnapon olvashatunk. Tekintettel arra, hogy a FreeBSD port még viszonylag friss és folyamatos fejlesztés alatt áll, ehhez még érdemes átolvasnunk a FreeBSD wikiben szereplõ <a href=http://wiki.FreeBSD.org/VirtualBox/>http://wiki.FreeBSD.org/VirtualBox/</a> oldalt is, ahol a vele kapcsolatos legfrissebb információkat és egyéb tudnivalókat találhatjuk.</p></div></div></div></div></div><div class=sect1><h2 id=l10n>Chapter 23. Honosítás - Az I18N/L10N használata és beállítása<a class=anchor href=#l10n></a></h2><div class=sectionbody><div class=sect2><h3 id=l10n-synopsis>23.1. Áttekintés<a class=anchor href=#l10n-synopsis></a></h3><div class=paragraph><p>A FreeBSD felhasználói földrajzi elhelyezkedésüket tekintve mindenhol megtalálhatóak a világon. Ebben a fejezetben ismertetjük a FreeBSD honosításához és idegennyelvre fordításához alkalmazható eszközöket, amelyek segítségével az angolt nem, vagy csak kevésbé ismerõ felhasználók is képesek lesznek komolyabban használni. Az i18n megvalósítása rengeteg szemszögbõl megközelíthetõ rendszer és alkalmazás szintjén egyaránt, ezért ahol szükséges, hivatkozni fogunk az odaillõ forrásokra.</p></div><div class=paragraph><p>A fejezet elolvasása során megismerjük:</p></div><div class=ulist><ul><li><p>milyen nyelveket és nyelvi beállításokat találhatunk napjaink operációs rendszereiben;</p></li><li><p>hogyan használjuk a nyelvi beállításokat a saját parancsértelmezõnkben;</p></li><li><p>hogyan állítsuk be a konzolt az angolon kívül más nyelvekhez;</p></li><li><p>hogyan használjuk ténylegesen az X Window Systemet a különbözõ nyelvekkel;</p></li><li><p>hol olvashatunk többet az I18N-kompatibilis alkalmazások fejlesztésérõl.</p></li></ul></div><div class=paragraph><p>A fejezet elolvasásához ajánlott:</p></div><div class=ulist><ul><li><p>külsõ alkalmazáok telepítésének ismerete (<a href=./#ports>Alkalmazások telepítése. csomagok és portok</a>).</p></li></ul></div></div><div class=sect2><h3 id=l10n-basics>23.2. Az alapok<a class=anchor href=#l10n-basics></a></h3><div class=sect3><h4 id=_mi_az_i18nl10n>23.2.1. Mi az I18N/L10N?<a class=anchor href=#_mi_az_i18nl10n></a></h4><div class=paragraph><p>A fejlesztõk az I18N elnevezést az angol "internationalization" (idegennyelvûség) szóból származtatják, amiben a szám az elsõ és utolsó betû (az "I" és "N") közt állók mennyiségére utal. Ehhez hasonlóan keletkezett az L10N a "localization" (honosítás) kifejezésbõl. Ezek házasságából jöttek létre az I18N/L10N módszerei, protokolljai és mindazon alkalmazásai, melyekkel a felhasználók a választott nyelvüket használni tudják.</p></div><div class=paragraph><p>Az I18N alkalmazások céljak eléréséhez függvénykönyvtárakban implementált I18N készleteket használnak. Ezzel lehetõvé válik a fejlesztõik számára, hogy összegyûjtsék a programukban megjelenõ összes szöveget egyetlen állományba, majd azt külön lefordítsák a különbözõ nyelvekre. Mi is ezen konvenció követésére szeretnénk bíztatni minden programozót.</p></div></div><div class=sect3><h4 id=_miért_használjuk_az_i18nl10n_t>23.2.2. Miért használjuk az I18N/L10N-t?<a class=anchor href=#_miért_használjuk_az_i18nl10n_t></a></h4><div class=paragraph><p>Az I18N/L10N mindenhol jól jöhet, ahol idegennyelvû adatot akarunk megjeleníteni, bekérni vagy feldolgozni.</p></div></div><div class=sect3><h4 id=_milyen_nyelveket_támogat_az_i18n>23.2.3. Milyen nyelveket támogat az I18N?<a class=anchor href=#_milyen_nyelveket_támogat_az_i18n></a></h4><div class=paragraph><p>Az I18N és L10N nem korlátozódik a FreeBSD tudására. Jelenleg a világban beszélt legelterjedtebb nyelvek mindegyikét használhatjuk bennük. Csak hogy néhányat említsünk közülük: kínai, német, japán, koreai, francia, orosz, vietnámi és még sok más.</p></div></div></div><div class=sect2><h3 id=using-localization>23.3. A honosítás használata<a class=anchor href=#using-localization></a></h3><div class=paragraph><p>Az I18N minden adottságával együtt független a FreeBSD-tõl, egy egyezményes rendszer. Mindenkit bátorítunk arra, hogy segítse a FreeBSD-t ennek az egyezménynek a betartásában.</p></div><div class=paragraph><p>A honosítás beállításai három fõbb részre tagolhatóak: a nyelv kódja, az ország kódja és a kódolás. A nyelvi beállítások nevei is ezekbõl állnak össze, az alábbi séma szerint:</p></div><div class="literalblock programlisting"><div class=content><pre>NyelviKód_OrszágKód.Kódolás</pre></div></div><div class=sect3><h4 id=_a_nyelv_és_az_ország_kódja>23.3.1. A nyelv és az ország kódja<a class=anchor href=#_a_nyelv_és_az_ország_kódja></a></h4><div class=paragraph><p>Ha a FreeBSD (vagy bármilyen más, az I18N-t ismerõ) rendszert honosítani akarunk az adott nyelvre, akkor a felhasználónak ismernie kell az adott országra és nyelvre vonatkozó kódokat (az országkód fogja elárulni az alkalmazásnak, hogy a nyelv melyik változatát használja). Ezenkívül a böngészõk, SMTP/POP szerverek és webszerverek stb. is ennek alapján fognak döntéseket hozni. Íme néhány nyelv/ország kódja:</p></div><table class="tableblock frame-none grid-all stretch informaltable"><col style=width:50%><col style=width:50%><thead><tr><th class="tableblock halign-left valign-top">Nyelv/ország kódja</th><th class="tableblock halign-left valign-top">Leírás</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class=tableblock>en_US</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Angol - Egyesült Államok</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>ru_RU</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Orosz - Oroszország</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>zh_TW</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Hagyományos kínai - Tajvan</p></td></tr></tbody></table></div><div class=sect3><h4 id=_kódolások>23.3.2. Kódolások<a class=anchor href=#_kódolások></a></h4><div class=paragraph><p>Bizonyos nyelvek 8 bites, széles vagy több byte-os, nem ASCII kódolású karaktereket használnak, melyekrõl a <a href="https://man.freebsd.org/cgi/man.cgi?query=multibyte&amp;sektion=3&amp;format=html">multibyte(3)</a> man oldalán olvashatunk részletesebben. Ezeket régebbi alkalmazások egyáltalán nem ismerik fel, és hibásan vezérlõkaraktereknek tulajdonítják. Az újabbak általában már felismerik a 8 bites karaktereket. A felhasználóknak az alkalmazásokat a széles vagy a több byte-os karakterek használatához vagy újra kell fordítaniuk, vagy pedig megfelelõen be kell állítaniuk, az implementációtól függõen. A széles vagy több byte-os karakterek beolvasásához és feldolgozásához a <a href=https://www.FreeBSD.org/ports/>FreeBSD Portgyûjtemény</a> nyelvenként tartalmaz különféle programokat. A konkrét részletek megértéséhez olvassuk el az érintett FreeBSD portok I18N dokumentációját.</p></div><div class=paragraph><p>Vagyis a felhasználóknak át kell nézniük az alkalmazáshoz tartozó dokumentációt, mivel ebbõl tudhatják meg, hogyan állítsák be ezeket megfelelõen vagy milyen értékeket adjanak át a configure/Makefile/fordító hármasnak.</p></div><div class=paragraph><p>Amiket esetleg érdemes lehet ezzel kapcsolatban észben tartanunk:</p></div><div class=ulist><ul><li><p>A nyelvfüggõ egyszerû karakteres készletek (lásd <a href="https://man.freebsd.org/cgi/man.cgi?query=multibyte&amp;sektion=3&amp;format=html">multibyte(3)</a>), például ISO8859-1, ISO8859-15, KOI8-R, CP437.</p></li><li><p>A széles vagy több byte-os kódolások, például az EUC, Big5.</p></li></ul></div><div class=paragraph><p>A karakterkészletek jelenleg elérhetõ listáját meg tudjuk tekinteni az <a href=http://www.iana.org/assignments/characters-sets>IANA adatbázisában</a>.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>A FreeBSD helyettük X11-kompatibilis nyelvi kódolásokat használ.</p></div></td></tr></tbody></table></div></div><div class=sect3><h4 id=_i18n_alkalmazások>23.3.3. I18N alkalmazások<a class=anchor href=#_i18n_alkalmazások></a></h4><div class=paragraph><p>A FreeBSD port- és csomagrendszerében az I18N alkalmazások a könnyebb felismerhetõség érdekében a nevükben tartalmazzák az <code>I18N</code> megnevezést. Nem minden esetben támogatják a szükséges nyelvet.</p></div></div><div class=sect3><h4 id=setting-locale>23.3.4. A nyelvi beállítások megadása<a class=anchor href=#setting-locale></a></h4><div class=paragraph><p>Általában elegendõ annyi, hogy a kívánt nyelvi beállítás nevét exportáljuk az általunk használt parancsértelmezõ <code>LANG</code> környezeti változójába. Ez megtehetõ a felhasználói könyvtárunkban található <span class=filename>~/.login_conf</span>, vagy a felhasználói parancsértelmezõ indító állományában (<span class=filename>~/.profile</span>, <span class=filename>~/.bashrc</span>, <span class=filename>~/.cshrc</span>). Nem szükséges a nyelvi beállítások részleteit, mint például az <code>LC_CTYPE</code>, <code>LC_CTIME</code> változókat, megadni. A pontosabb részleteket a FreeBSD adott nyelvre vonatkozó dokumentációjában találjuk meg.</p></div><div class=paragraph><p>A következõ két környezeti változót kell megadnunk az említett konfigurációs állományokban:</p></div><div class=ulist><ul><li><p>A <code>LANG</code> változót a POSIX® <a href="https://man.freebsd.org/cgi/man.cgi?query=setlocale&amp;sektion=3&amp;format=html">setlocale(3)</a> családjának</p></li><li><p>A <code>MM_CHARSET</code> változót az alkalmazás MIME karakterkészletéhez</p></li></ul></div><div class=paragraph><p>Ez magában foglalja a felhasználói parancsértelmezõ, az adott alkalmazás és az X11 beállítását.</p></div><div class=sect4><h5 id=_a_nyelvi_beállítások_megadásának_módszerei>23.3.4.1. A nyelvi beállítások megadásának módszerei<a class=anchor href=#_a_nyelvi_beállítások_megadásának_módszerei></a></h5><div class=paragraph><p>Két módszer létezik a nyelvi beállítások megadására, ezen kettõrõl fogunk a továbbiakban beszélni. Az elsõ (és egyben ajánlott) ezek közül a <a href=#login-class>bejelentkezési osztály</a>ban levõ környezeti változók beállítása, a második pedig környezeti változók hozzáadása a parancsértelmezõ rendszerszintû <a href=#startup-file>indító állományá</a>hoz.</p></div><div class=sect5><h6 id=login-class>23.3.4.1.1. Beállítás a bejelentkezési osztályokkal<a class=anchor href=#login-class></a></h6><div class=paragraph><p>Ezzel a módszerrel a nyelvi beállítás nevéhez és a MIME karakterkészlethez kötõdõ környezeti változókat az összes létezõ parancsértelmezõ számára csak egyszer kell megadnunk ahelyett, hogy külön mindegyikük indítóállományában szerepeltetnénk. A felhasználó a <a href=#usr-setup>saját részét</a> maga is elvégezheti, míg a <a href=#adm-setup>rendszer szintjén</a> adminisztrátori jogosultságokat igényel.</p></div><div class=sect6><h7 id=usr-setup>23.3.4.1.1.1. Felhasználói szintû beállítás<a class=anchor href=#usr-setup></a></h7><div class=paragraph><p>Íme példa gyanánt a felhasználó könyvtárában egy egyszerû <span class=filename>.login_conf</span> állomány, amiben mind a két változót Latin-1 kódolásra állítottuk:</p></div><div class="literalblock programlisting"><div class=content><pre>me:\
	:charset=ISO-8859-1:\
	:lang=de_DE.ISO8859-1:</pre></div></div><div class=paragraph><p>Ebben a <span class=filename>.login_conf</span> példában a változókat BIG-5 kódolású hagyomános kínai nyelvre állítjuk. Észrevehetjük, hogy itt sokkal több változó beállítására van szükségünk, mivel egyes szoftverek nem kezelik megfelelõen a nyelvi beállításokat kínai, japán és koreai nyelvek esetén.</p></div><div class="literalblock programlisting"><div class=content><pre># Azok a felhasználók, akik nem kívánnak tajvani pénz- vagy idõ formátumot
# használni, egyenként írják át a változókat
me:\
	:lang=zh_TW.Big5:\
	:setenv=LC_ALL=zh_TW.Big5:\
	:setenv=LC_COLLATE=zh_TW.Big5:\
	:setenv=LC_CTYPE=zh_TW.Big5:\
	:setenv=LC_MESSAGES=zh_TW.Big5:\
	:setenv=LC_MONETARY=zh_TW.Big5:\
	:setenv=LC_NUMERIC=zh_TW.Big5:\
	:setenv=LC_TIME=zh_TW.Big5:\
	:charset=big5:\
	:xmodifiers=&#34;@im=gcin&#34;: # a gcin beállítása XIM szerverként</pre></div></div><div class=paragraph><p>A többit lásd a <a href=#adm-setup>Rendszergazdai szintû beállítások</a> résznél és a <a href="https://man.freebsd.org/cgi/man.cgi?query=login.conf&amp;sektion=5&amp;format=html">login.conf(5)</a> man oldalon.</p></div></div></div><div class=sect5><h6 id=adm-setup>23.3.4.1.2. Rendszergazdai szintû beállítás<a class=anchor href=#adm-setup></a></h6><div class=paragraph><p>Ellenõrizzük, hogy a felhasználó <span class=filename>/etc/login.conf</span> állományban szereplõ bejelentkezési osztálya a megfelelõ nyelvet állítja be. Gyõzõdjünk meg róla, hogy az alábbi beállítások helyet kapnak az <span class=filename>/etc/login.conf</span> állományban:</p></div><div class="literalblock programlisting"><div class=content><pre>nyelv_neve|A hozzáférés típusának leírása:\
	:charset=MIME_karakterkészlet:\
	:lang=nyelvi_beállítás_neve:\
	:tc=default:</pre></div></div><div class=paragraph><p>Folytassuk tovább az elõbbi Latin-1-es példánk szerint:</p></div><div class="literalblock programlisting"><div class=content><pre>nemet|Nemet felhasznalok hozzaferesei:\
	:charset=ISO-8859-1:\
	:lang=de_DE.ISO8859-1:\
	:tc=default:</pre></div></div><div class=paragraph><p>Mielõtt megváltoztatnánk a felhasználók bejelentkezési osztályait, adjuk ki a következõ parancsot:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># cap_mkdb /etc/login.conf</span></code></pre></div></div><div class=paragraph><p>Ezzel a <span class=filename>/etc/login.conf</span> új tartalma láthatóvá válik a rendszer számára.</p></div></div><div class=sect5><h6 id=_a_bejelentkezési_osztály_megváltoztatása_a_vipw8_programmal>23.3.4.1.3. A bejelentkezési osztály megváltoztatása a <a href="https://man.freebsd.org/cgi/man.cgi?query=vipw&amp;sektion=8&amp;format=html">vipw(8)</a> programmal<a class=anchor href=#_a_bejelentkezési_osztály_megváltoztatása_a_vipw8_programmal></a></h6><div class=paragraph><p>A <code>vipw</code> segédprogramot új felhasználók hozzáadására használjuk, aminek eredményeképpen egy ehhez hasonló bejegyzést tudunk létrehozni:</p></div><div class="literalblock programlisting"><div class=content><pre>felhasznalo:jelszo:1111:11:nyelv:0:0:Felhasznalo neve:/home/felhasznalo:/bin/sh</pre></div></div></div><div class=sect5><h6 id=_a_bejelentkezési_osztály_megváltoztatása_az_adduser8_rel>23.3.4.1.4. A bejelentkezési osztály megváltoztatása az <a href="https://man.freebsd.org/cgi/man.cgi?query=adduser&amp;sektion=8&amp;format=html">adduser(8)</a>-rel<a class=anchor href=#_a_bejelentkezési_osztály_megváltoztatása_az_adduser8_rel></a></h6><div class=paragraph><p>Az <code>adduser</code>-rel az alábbiak szerint tudunk új felhasználókat felvenni a rendszerbe:</p></div><div class=ulist><ul><li><p>Adjuk hozzá a <code>defaultclass = nyelv</code> sort az <span class=filename>/etc/adduser.conf</span>-hoz. Ne felejtsük el, hogy ezután minden olyan felhasználónál a <code>default</code> bejelentkezési osztályt meg kell adni, akik nem ezt a nyelvet használják.</p></li><li><p>Egy másik megoldás lehet, hogy a <a href="https://man.freebsd.org/cgi/man.cgi?query=adduser&amp;sektion=8&amp;format=html">adduser(8)</a> használata során minden felhasználó esetén külön megadjuk a nyelvet az</p><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>Enter login class: default <span class=o>[]</span>:</code></pre></div></div><div class=paragraph><p>rész megjelenésekor.</p></div></li><li><p>Vagy használhatjuk az alábbit az egyes eltérõ nyelvû felhasználók hozzáadásánál:</p><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># adduser -class nyelv</span></code></pre></div></div></li></ul></div></div><div class=sect5><h6 id=_a_bejelentkezési_osztály_megváltoztatása_a_pw8_vel>23.3.4.1.5. A bejelentkezési osztály megváltoztatása a <a href="https://man.freebsd.org/cgi/man.cgi?query=pw&amp;sektion=8&amp;format=html">pw(8)</a>-vel<a class=anchor href=#_a_bejelentkezési_osztály_megváltoztatása_a_pw8_vel></a></h6><div class=paragraph><p>Amennyiben a <a href="https://man.freebsd.org/cgi/man.cgi?query=pw&amp;sektion=8&amp;format=html">pw(8)</a>-t használjuk új felhasználók hozzáadására, így érdemes meghívnunk:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># pw useradd felhasználó_neve -L nyelv</span></code></pre></div></div></div><div class=sect5><h6 id=startup-file>23.3.4.1.6. Beállítás a parancsértelmezõ indító állományával<a class=anchor href=#startup-file></a></h6><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Ezt a módszert nem javasoljuk, mivel parancsértelmezõnként eltérõ beállítást kíván. Használjuk helyette a <a href=#login-class>bejelentkezési osztályokkal megvalósított</a> módszert.</p></div></td></tr></tbody></table></div><div class=paragraph><p>A nyelvi beállítás nevének és a MIME karakterkészlet beállításához egyszerûen csak adjuk meg a lenti <span class=filename>/etc/profile</span> és/vagy <span class=filename>/etc/csh.login</span> parancsértelmezõ indító állományokban bemutatott környezeti változót. Továbbra is a német nyelvet használjuk a példánkban:</p></div><div class=paragraph><p>Az <span class=filename>/etc/profile</span> esetén:</p></div><div class="literalblock programlisting"><div class=content><pre>LANG=de_DE.ISO8859-1; export LANG
MM_CHARSET=ISO-8859-1; export MM_CHARSET</pre></div></div><div class=paragraph><p>Vagy a <span class=filename>/etc/csh.login</span> esetén:</p></div><div class="literalblock programlisting"><div class=content><pre>setenv LANG de_DE.ISO8859-1
setenv MM_CHARSET ISO-8859-1</pre></div></div><div class=paragraph><p>Úgy is megoldhatjuk ezt a feladatot, ha fenti utasításokat a <span class=filename>/usr/shared/skel/dot.profile</span> (hasonló a fentebb említett <span class=filename>/etc/profile</span> állományhoz) vagy <span class=filename>/usr/shared/skel/dot.login</span> (hasonló a fentebb említett <span class=filename>/etc/csh.login</span> állományhoz) esetén hajtjuk végre.</p></div><div class=paragraph><p>X11 esetén:</p></div><div class=paragraph><p>Adjuk meg a <span class=filename>$HOME/.xinitrc</span> állományban:</p></div><div class="literalblock programlisting"><div class=content><pre>LANG=de_DE.ISO8859-1; export LANG</pre></div></div><div class=paragraph><p>Vagy:</p></div><div class="literalblock programlisting"><div class=content><pre>setenv LANG de_DE.ISO8859-1</pre></div></div><div class=paragraph><p>Attól függõen, milyen parancsértelmezõt használunk (lásd fentebb).</p></div></div></div></div><div class=sect3><h4 id=setting-console>23.3.5. A konzol beállítása<a class=anchor href=#setting-console></a></h4><div class=paragraph><p>Az összes egyszerû karakteres készlet esetén a kérdéses nyelvhez megfelelõ konzolos betûtípust az <span class=filename>/etc/rc.conf</span> állományban tudjuk beállítani:</p></div><div class="literalblock programlisting"><div class=content><pre>font8x16=betûtípus_neve
font8x14=betûtípus_neve
font8x8=betûtípus_neve</pre></div></div><div class=paragraph><p>Itt a <em>betûtípus_neve</em> az <span class=filename>.fnt</span> kiterjesztés elhagyásával a <span class=filename>/usr/shared/syscons/fonts</span> könyvtárban található állományok nevébõl adható meg.</p></div><div class=paragraph><p>Ha szükséges állítsuk még be a megfelelõ billentyû- és betûkiosztást is a <code>sysinstall</code> segítségével. Ahogy sikerült elindítanunk a sysinstallt, válasszuk a <span class=guimenuitem>Configure</span> (Beállítások) pontot, majd a <span class=guimenuitem>Console</span> (Konzol)-t! Vagy ehelyett beírhatjuk az alábbi sorokat a <span class=filename>/etc/rc.conf</span> állományba:</p></div><div class="literalblock programlisting"><div class=content><pre>scrnmap=betûkiosztás_neve
keymap=billentyûkiosztás_neve
keychange=&#34;funkcióbillentyû_sorszáma szekvencia&#34;</pre></div></div><div class=paragraph><p>Itt a <em>betûkiosztás_neve</em> a <span class=filename>/usr/shared/syscons/scrnmaps</span> könyvtárban található állományok nevébõl származtatható az <span class=filename>.scm</span> kiterjesztés elhagyásával. A betûkiosztásokat általában a 9 bites karaktermátrixszal rendelkezõ VGA megjelenítõk problémáinak megoldására lehet használni, mivel így az eredetileg 8 bittel ábrázolt betûket ki lehet tolni az ilyen típusú kártyák pszeudografikus területérõl.</p></div><div class=paragraph><p>Ha aktiváltuk a moused egérkezelõ démont az <span class=filename>/etc/rc.conf</span> állományban az alábbi sor megadásával:</p></div><div class="literalblock programlisting"><div class=content><pre>moused_enable=&#34;YES&#34;</pre></div></div><div class=paragraph><p>akkor a következõ bekezdésben rá is térhetünk az egérmutató adatainak vizsgálatára.</p></div><div class=paragraph><p>A <a href="https://man.freebsd.org/cgi/man.cgi?query=syscons&amp;sektion=4&amp;format=html">syscons(4)</a> meghajtóban található egérmutató alapértelmezés szerint a 0xd0 - 0xd3 karaktereket foglalja el a karakterkészletben. Ha a nyelv ezeket használja, arrébb kell költöztetnünk ezt az egérmutató által elfoglalt sávot. A FreeBSD-ben az <span class=filename>/etc/rc.conf</span> állományon keresztül érhetjük el:</p></div><div class="literalblock programlisting"><div class=content><pre>mousechar_start=3</pre></div></div><div class=paragraph><p>A <em>billentyûkiosztás_neve</em> a <span class=filename>/usr/shared/syscons/keymaps</span> könyvtárból, a <span class=filename>.kbd</span> kiterjesztés elhagyásával keletkezik. Ha nem vagyunk benne biztosak, melyik kiosztást is kellene használnunk, a <a href="https://man.freebsd.org/cgi/man.cgi?query=kbdmap&amp;sektion=1&amp;format=html">kbdmap(1)</a> segítségével a rendszer újraindítása nélkül kipróbálhatjuk a rendelkezésre álló billentyûkiosztásokat.</p></div><div class=paragraph><p>A <code>keychange</code> használatára többnyire a funkcióbillentyûk adott termináltípushoz egyeztetéséhez van szükség, mert a funkcióbillentyûk szekvenciái nem adhatóak meg a billentyûkiosztásban.</p></div><div class=paragraph><p>Ezeken felül érdemes megbizonyosodnunk róla, hogy a <span class=filename>/etc/ttys</span> állományban jól állítjuk be a terminál típusát minden <code>ttyv*</code> bejegyzés esetén. Az aktuálisan elõre beállított kapcsolatok a következõk:</p></div><table class="tableblock frame-none grid-all stretch informaltable"><col style=width:50%><col style=width:50%><thead><tr><th class="tableblock halign-left valign-top">Karakterkészlet</th><th class="tableblock halign-left valign-top">Termináltípus</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class=tableblock>ISO8859-1 vagy ISO8859-15</p></td><td class="tableblock halign-left valign-top"><p class=tableblock><code>cons25l1</code></p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>ISO8859-2</p></td><td class="tableblock halign-left valign-top"><p class=tableblock><code>cons25l2</code></p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>ISO8859-7</p></td><td class="tableblock halign-left valign-top"><p class=tableblock><code>cons25l7</code></p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>KOI8-R</p></td><td class="tableblock halign-left valign-top"><p class=tableblock><code>cons25r</code></p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>KOI8-U</p></td><td class="tableblock halign-left valign-top"><p class=tableblock><code>cons25u</code></p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>CP437 (alapértelmezett VGA)</p></td><td class="tableblock halign-left valign-top"><p class=tableblock><code>cons25</code></p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>US-ASCII</p></td><td class="tableblock halign-left valign-top"><p class=tableblock><code>cons25w</code></p></td></tr></tbody></table><div class=paragraph><p>A széles és több byte-os karaktereket használó nyelvek esetén használjuk a <span class=filename>/usr/ports/nyelv</span> könyvtárban megfelelõ FreeBSD portot. Egyes portok konzolosként jelennek meg, miközben a rendszer soros virtuális terminálként látja ezeket, ezért fenn kell tartanunk elegendõ virtuális terminált mind az X11, mind pedig pszeudo-soros konzol számára. Itt látható a konzolon más nyelvet használó alkalmazások részleges listája:</p></div><table class="tableblock frame-none grid-all stretch informaltable"><col style=width:50%><col style=width:50%><thead><tr><th class="tableblock halign-left valign-top">Nyelv</th><th class="tableblock halign-left valign-top">Hely</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class=tableblock>Hagyományos kínai (BIG-5)</p></td><td class="tableblock halign-left valign-top"><p class=tableblock><a class=package href=https://cgit.freebsd.org/ports/tree/chinese/big5con/>chinese/big5con</a></p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>Japán</p></td><td class="tableblock halign-left valign-top"><p class=tableblock><a class=package href=https://cgit.freebsd.org/ports/tree/japanese/kon2-16dot/>japanese/kon2-16dot</a> vagy <a class=package href=https://cgit.freebsd.org/ports/tree/japanese/mule-freewnn/>japanese/mule-freewnn</a></p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>Koreai</p></td><td class="tableblock halign-left valign-top"><p class=tableblock><a class=package href=https://cgit.freebsd.org/ports/tree/korean/han/>korean/han</a></p></td></tr></tbody></table></div><div class=sect3><h4 id=_az_x11_beállítása_2>23.3.6. Az X11 beállítása<a class=anchor href=#_az_x11_beállítása_2></a></h4><div class=paragraph><p>Habár az X11 nem része a FreeBSD projektnek, megemlítünk vele kapcsolatban néhány hasznos információt a FreeBSD felhasználók számára is. Még több részletet a <a href=http://www.x.org/>Xorg honlapjáról</a> vagy az általunk használt X11 szerver dokumentációjából tudhatunk meg.</p></div><div class=paragraph><p>Az <span class=filename>~/.Xresources</span> állományban további I18N beállításokat finomíthatunk alkalmazásonként (például betûtípusok, menük stb.).</p></div><div class=sect4><h5 id=_betûtípusok_megjelenítése>23.3.6.1. Betûtípusok megjelenítése<a class=anchor href=#_betûtípusok_megjelenítése></a></h5><div class=paragraph><p>Telepítsük fel az Xorg (<a class=package href=https://cgit.freebsd.org/ports/tree/x11-servers/xorg-server/>x11-servers/xorg-server</a>) vagy az XFree86™ (<a class=package href=https://cgit.freebsd.org/ports/tree/x11-servers/XFree86-4-Server/>x11-servers/XFree86-4-Server</a>) szerverek valamelyikét, majd telepítsük a nyelvhez tartozó TrueType® betûtípusokat. Ezután a megfelelõ nyelvi beállítása megadása révén már látni fogjuk a kiválasztott nyelven megjelenõ menüket és egyéb szövegeket.</p></div></div><div class=sect4><h5 id=_idegennyelvû_karakterek_bevitele>23.3.6.2. Idegennyelvû karakterek bevitele<a class=anchor href=#_idegennyelvû_karakterek_bevitele></a></h5><div class=paragraph><p>Az X11 beviteli módszerének (X11 Input Method, XIM) protokollja egy új szabvány az összes X11 klienshez. Minden X11 alkalmazást olyan XIM-kliensként kell elkészíteni, amelyek a bemenõ adatokat az XIM beviteli szerverektõl kapják. Különbözõ XIM szerverek érhetõek el az eltérõ nyelvekhez.</p></div></div></div><div class=sect3><h4 id=_nyomtatók_beállítása>23.3.7. Nyomtatók beállítása<a class=anchor href=#_nyomtatók_beállítása></a></h4><div class=paragraph><p>Egyes egyszerû karakteres készletek általában hardveresen beépítve megtalálhatóak a nyomtatókban. A széles és több byte-os karakterkészletek azonban külön beállítást igényelnek, amire az apsfilter használatát javasoljuk. A megfelelõ nyelvhez szabott eszközökkel át is lehet konvertálni PostScript® vagy PDF formátumba a nyomtatni kívánt dokumentumot.</p></div></div><div class=sect3><h4 id=_a_rendszermag_és_az_állományrendszerek>23.3.8. A rendszermag és az állományrendszerek<a class=anchor href=#_a_rendszermag_és_az_állományrendszerek></a></h4><div class=paragraph><p>A FreeBSD gyors állományrendszere (Fast File System, FFS) szabályosan kezeli a 8 bites karaktereket, tehát tetszõleges egyszerû karakteres készlet (lásd <a href="https://man.freebsd.org/cgi/man.cgi?query=multibyte&amp;sektion=3&amp;format=html">multibyte(3)</a>) használható vele, viszont a karakterkészlet nevét nem tárolja el az állományrendszerben. Emiatt a neveket nyersen kezeli, semmit sem tud a kódolásukról. Az FFS hivatalosan még nem támogat semmilyen fajta széles vagy több byte-os karakterkészletet. Léteznek azonban független javítások az FFS-hez, amelyek lehetõvé teszik ilyen széles vagy több byte-os karakterek használatát. Ezek csak átmeneti és nem hordozható megoldások, olyan módosítások, amelyekrõl úgy döntöttünk, nem vesszük fel ezeket a forrásfába. Az érintett nyelvek honlapjain elérhetjük ezeket a javításokat és többet megtudhatunk róluk.</p></div><div class=paragraph><p>A FreeBSD MS-DOS® állományrendszere konfigurálható úgy, hogy képes legyen konvertálni az MS-DOS® Unicode és a kiválasztott FreeBSD állományrendszerének karakterkészlete között. Errõl bõvebben a <a href="https://man.freebsd.org/cgi/man.cgi?query=mount_msdosfs&amp;sektion=8&amp;format=html">mount_msdosfs(8)</a> man oldalon olvashatunk.</p></div></div></div><div class=sect2><h3 id=l10n-compiling>23.4. I18N programok fordítása<a class=anchor href=#l10n-compiling></a></h3><div class=paragraph><p>Számos FreeBSD port rendelkezik I18N támogatással. Ezek egy részének nevében szerepel az -I18N jelzés. Az ilyen és sok más hasonló program beépítetten ismeri az I18N-t, így nem igényelnek külön beállításokat.</p></div><div class=paragraph><p>Néhány alkalmazás azonban, mint például a MySQL, esetén az adott karakterkészletnek megfelelõ módon kell beállítani a <span class=filename>Makefile</span> állományt. Ezt általában magában a <span class=filename>Makefile</span> állományban tudjuk megtenni, vagy pedig a configure megfelelõ paraméterezésével.</p></div></div><div class=sect2><h3 id=lang-setup>23.5. A FreeBSD honosítása adott nyelvekre<a class=anchor href=#lang-setup></a></h3><div class=sect3><h4 id=ru-localize>23.5.1. Az orosz nyelv (KOI8-R kódolás)<a class=anchor href=#ru-localize></a></h4><div class=paragraph><p>A KOI8-R kódolásról bõvebben a <a href=http://koi8.pp.ru>KOI8-R oldalán (orosz hálózati karakterkészlet)</a> tájékozódhatunk.</p></div><div class=sect4><h5 id=_a_nyelvi_beállítások_megadása>23.5.1.1. A nyelvi beállítások megadása<a class=anchor href=#_a_nyelvi_beállítások_megadása></a></h5><div class=paragraph><p>Írjuk a következõ sorokat a <span class=filename>~/.login_conf</span> állományunkba:</p></div><div class="literalblock programlisting"><div class=content><pre>me:Az en hozzaferesem:\
	:charset=KOI8-R:\
	:lang=ru_RU.KOI8-R:</pre></div></div><div class=paragraph><p>Valamint lásd a fejezet korábbi részeiben említett példákat a <a href=#setting-locale>nyelvi beállítások</a> megadására.</p></div></div><div class=sect4><h5 id=_a_konzol_beállítása>23.5.1.2. A konzol beállítása<a class=anchor href=#_a_konzol_beállítása></a></h5><div class=ulist><ul><li><p>Tegyük hozzá a következõ sort az <span class=filename>/etc/rc.conf</span> állományunkhoz:</p><div class="literalblock programlisting"><div class=content><pre>mousechar_start=3</pre></div></div></li><li><p>Illetve használjuk az <span class=filename>/etc/rc.conf</span> állományban még a következõ beállításokat is:</p><div class="literalblock programlisting"><div class=content><pre>keymap=&#34;ru.utf-8&#34;
scrnmap=&#34;utf-82cp866&#34;
font8x16=&#34;cp866b-8x16&#34;
font8x14=&#34;cp866-8x14&#34;
font8x8=&#34;cp866-8x8&#34;</pre></div></div></li><li><p>A <span class=filename>/etc/ttys</span> állományban szereplõ mindegyik <code>ttyv*</code> bejegyzésnél adjuk meg termináltípusnak a <code>cons25r</code>-t.</p></li></ul></div><div class=paragraph><p>Valamint lásd a fejezet korábbi részében bemutatott példákat a <a href=#setting-console>konzol</a> beállítására.</p></div></div><div class=sect4><h5 id=_a_nyomtatás_beállítása>23.5.1.3. A nyomtatás beállítása<a class=anchor href=#_a_nyomtatás_beállítása></a></h5><div class=paragraph><p>Mivel a legtöbb nyomtató hardveresen tartalmazza a CP866 kódlapot az orosz karakterek támogatásához, használnunk kell egy kimeneti szûrõt a KOI8-R kódolású karakterek CP866 kódolásúra konvertálásához. Egy ilyen szûrõ alapértelmezés szerint telepítésre kerül a <span class=filename>/usr/libexec/lpr/ru/koi2alt</span> állományba. Az orosz nyomtatóhoz tartozó bejegyzés valahogy így néz ki az <span class=filename>/etc/printcap</span> állományban:</p></div><div class="literalblock programlisting"><div class=content><pre>lp|Orosz helyi sornyomtato:\
	:sh:of=/usr/libexec/lpr/ru/koi2alt:\
	:lp=/dev/lpt0:sd=/var/spool/output/lpd:lf=/var/log/lpd-errs:</pre></div></div><div class=paragraph><p>A bõvebben magyarázathoz lásd a <a href="https://man.freebsd.org/cgi/man.cgi?query=printcap&amp;sektion=5&amp;format=html">printcap(5)</a> man oldalt.</p></div></div><div class=sect4><h5 id=_az_ms_dos_állományrendszere_és_az_orosz_állománynevek>23.5.1.4. Az MS-DOS® állományrendszere és az orosz állománynevek<a class=anchor href=#_az_ms_dos_állományrendszere_és_az_orosz_állománynevek></a></h5><div class=paragraph><p>A most következõ példa <a href="https://man.freebsd.org/cgi/man.cgi?query=fstab&amp;sektion=5&amp;format=html">fstab(5)</a> bejegyzés azt mutatja meg, hogy lehet bekapcsolni az orosz állománynevek támogatását a csatlakoztatandó MS-DOS® állományrendszereken:</p></div><div class="literalblock programlisting"><div class=content><pre>/dev/ad0s2      /dos/c  msdos   rw,-Wkoi2dos,-Lru_RU.KOI8-R 0 0</pre></div></div><div class=paragraph><p>Az <code>-L</code> kapcsolóval kiválasztjuk a használni kívánt nyelvi beállítás nevét, és a <code>-W</code> kapcsolóval megadjuk a karakterek átváltásához szükséges táblázatot. A <code>-W</code> kapcsoló használata során mindenképpen csatlakoztassuk a <span class=filename>/usr</span> állományrendszert még az MS-DOS® partíció elõtt, mivel az átváltáshoz használt táblázatok a <span class=filename>/usr/libdata/msdosfs</span> könyvtárban találhatóak meg! A részleteket a <a href="https://man.freebsd.org/cgi/man.cgi?query=mount_msdosfs&amp;sektion=8&amp;format=html">mount_msdosfs(8)</a> man oldalon találhatjuk meg.</p></div></div><div class=sect4><h5 id=_az_x11_beállítása_3>23.5.1.5. Az X11 beállítása<a class=anchor href=#_az_x11_beállítása_3></a></h5><div class="olist arabic"><ol class=arabic><li><p>Adjuk meg elõször a leírtak szerint a <a href=#setting-locale>nem X-es nyelvi beállításokat</a>.</p></li><li><p>Ha Xorg-ot használunk, telepítsük a <a class=package href=https://cgit.freebsd.org/ports/tree/x11-fonts/xorg-fonts-cyrillic/>x11-fonts/xorg-fonts-cyrillic</a> csomagot.</p><div class=paragraph><p>Ellenõrizzük a <span class=filename>/etc/X11/xorg.conf</span> állományban a <code>"Files"</code> szakaszt. Az alábbi sort mindegyik más <code>FontPath</code> bejegyzés <em>elõtt</em> kell szerepeltetnünk:</p></div><div class="literalblock programlisting"><div class=content><pre>FontPath  &#34;/usr/X11R6/lib/X11/fonts/cyrillic&#34;</pre></div></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>A portok között találhatunk még további cirill betûtípusokat.</p></div></td></tr></tbody></table></div></li><li><p>Az orosz billentyûzet életre keltéséhez írjuk be a következõket az <span class=filename>xorg.conf</span> állomány <code>"Keyboard"</code> szakaszába:</p><div class="literalblock programlisting"><div class=content><pre>Option &#34;XkbLayout&#34;   &#34;us,ru&#34;
Option &#34;XkbOptions&#34;  &#34;grp:toggle&#34;</pre></div></div><div class=paragraph><p>Ellenõrizzük, hogy a <code>XkbDisable</code> ki van kapcsolva (ki van kommentezve) ebben a szakaszban.</p></div><div class=paragraph><p>A <code>grp:toggle</code> beállítás esetén az orosz/latin (RUS/LAT) átkapcsolás gombja a <kbd>jobb Alt</kbd> lesz, míg a <code>grp:ctrl_shift_toggle</code> beállításnál a <span class=keyseq><kbd>Ctrl</kbd>+<kbd>Shift</kbd></span>. A <code>grp:caps_toggle</code> esetén az orosz/latin váltás a <kbd>CapsLock</kbd> billentyûvel történik. Ilyenkor (de csak latin módban) a megszokott <kbd>CapsLock</kbd> funkció továbbra is elérhetõ a <span class=keyseq><kbd>Shift</kbd>+<kbd>CapsLock</kbd></span> kombinációval. A <code>grp:caps_toggle</code> valamiért nem mûködik az Xorgban.</p></div><div class=paragraph><p>Ha van "Windows®" billentyûnk a billentyûzeten és azt tapasztaljuk, hogy egyes nem-alfabetikus billentyûk rosszul kerülnek kiosztásra orosz módban, adjuk hozzá a következõ sort az <span class=filename>xorg.conf</span> állományhoz:</p></div><div class="literalblock programlisting"><div class=content><pre>Option &#34;XkbVariant&#34; &#34;,winkeys&#34;</pre></div></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Az orosz XKB billentyûzet egyes nem honosított alkalmazások esetén nem mûködik.</p></div></td></tr></tbody></table></div></li></ol></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>A kis mértékben honosított alkalmazások esetén javasolt meghívni a <code>XtSetLanuageProc(NULL, NULL, NULL);</code> függvényt valahol a program elején.</p></div><div class=paragraph><p>Az X11 alkalmazások honosításához további útmutatásokat a <a href=http://koi8.pp.ru/xwin.html>KOI8-R X Window-ra</a> címû leírásban találhatunk.</p></div></td></tr></tbody></table></div></div></div><div class=sect3><h4 id=_hagyományos_kínai_honosítás_tajvaniak_számára>23.5.2. Hagyományos kínai honosítás tajvaniak számára<a class=anchor href=#_hagyományos_kínai_honosítás_tajvaniak_számára></a></h4><div class=paragraph><p>A FreeBSD-Taiwan projekt készített a FreeBSD-hez egy kínainak szóló hogyant, amely elérhetõ a <a href=http://netlab.cse.yzu.edu.tw/~statue/freebsd/zh-tut/>http://netlab.cse.yzu.edu.tw/~statue/freebsd/zh-tut/</a> címen és számos kínai portot használ. A <code>FreeBSD kínai hogyan</code> jelenlegi szerkesztõje Shen Chuan-Hsing (<a href=mailto:statue@freebsd.sinica.edu.tw>statue@freebsd.sinica.edu.tw</a>).</p></div><div class=paragraph><p>Chuan-Hsing Shen (<a href=mailto:statue@freebsd.sinica.edu.tw>statue@freebsd.sinica.edu.tw</a>) létrehozta a <a href=http://netlab.cse.yzu.edu.tw/\~statue/cfc/>Kínai FreeBSD gyûjteményt (Chinese FreeBSD Collection, CFC)</a> a FreeBSD-Taiwan <code>zh-L10N-tut</code> munkáját felhasználva. A hozzá tartozó csomagok és szkriptek elérhetõek a <a href=ftp://freebsd.csie.nctu.edu.tw/pub/taiwan/CFC/>ftp://freebsd.csie.nctu.edu.tw/pub/taiwan/CFC/</a> címen.</p></div></div><div class=sect3><h4 id=_honosítás_német_és_minden_más_iso_8859_1_kódolású_nyelvre>23.5.3. Honosítás német (és minden más ISO 8859-1 kódolású) nyelvre<a class=anchor href=#_honosítás_német_és_minden_más_iso_8859_1_kódolású_nyelvre></a></h4><div class=paragraph><p>Slaven Rezic (<a href=mailto:eserte@cs.tu-berlin.de>eserte@cs.tu-berlin.de</a>) készített egy írást, amely elmagyarázza, hogyan használjunk német nemzeti karaktereket a FreeBSD alatt. Ez a leírás németül készült és a <a href=http://user.cs.tu-berlin.de/~eserte/FreeBSD/doc/umlaute/umlaute.html>http://user.cs.tu-berlin.de/~eserte/FreeBSD/doc/umlaute/umlaute.html</a> címen érhetõ el.</p></div></div><div class=sect3><h4 id=_honosítás_görög_nyelvre>23.5.4. Honosítás görög nyelvre<a class=anchor href=#_honosítás_görög_nyelvre></a></h4><div class=paragraph><p>Nikos Kokkalis <a href=mailto:nickkokkalis@gmail.com>nickkokkalis@gmail.com</a> egy teljes cikket írt a FreeBSD görög nyelvi támogatásáról. Ez elérhetõ a FreeBSD hivatalos görög nyelvû dokumentációjában, a <a href=https://www.FreeBSD.org/doc/el/articles/greek-language-support/>https://www.FreeBSD.org/doc/el/articles/greek-language-support/</a> címen. Felhívjuk a figyelmet, hogy az <em>csak</em> görög nyelven érhetõ el.</p></div></div><div class=sect3><h4 id=_honosítás_japán_és_koreai_nyelvekre>23.5.5. Honosítás japán és koreai nyelvekre<a class=anchor href=#_honosítás_japán_és_koreai_nyelvekre></a></h4><div class=paragraph><p>A japán honosításhoz lásd <a href=http://www.jp.FreeBSD.org/>http://www.jp.FreeBSD.org/</a>, a koreaihoz pedig lásd <a href=http://www.kr.FreeBSD.org/>http://www.kr.FreeBSD.org/</a>.</p></div></div><div class=sect3><h4 id=_idegennyelvû_freebsd_dokumentáció>23.5.6. Idegennyelvû FreeBSD dokumentáció<a class=anchor href=#_idegennyelvû_freebsd_dokumentáció></a></h4><div class=paragraph><p>Néhány FreeBSD felhasználó lefordította a FreeBSD dokumentációjának egyes részeit más nyelvekre is. Munkájuk elérhetõ a <a href=https://www.FreeBSD.org/>fõoldalon</a> található linkeken keresztül vagy a <span class=filename>/usr/shared/doc</span> könyvtárban.</p></div></div></div></div></div><div class=sect1><h2 id=updating-upgrading>Chapter 24. A FreeBSD frissítése és frissen tartása<a class=anchor href=#updating-upgrading></a></h2><div class=sectionbody><div class=sect2><h3 id=updating-upgrading-synopsis>24.1. Áttekintés<a class=anchor href=#updating-upgrading-synopsis></a></h3><div class=paragraph><p>A FreeBSD a kiadások közt is állandó fejlõdésben van. Vannak felhasználók, akik a hivatalosan kiadott változatokat használják, és vannak, akik szeretik folyamatosan nyomonkövetni a fejlesztéseket. Emellett viszont a hivatalos kiadások esetében szükség lehet bizonyos biztonsági frissítések és kritikus javítások alkalmazására. Függetlenül a pillanatnyilag használt változattól, a FreeBSD alaprendszerében megtalálható minden olyan eszköz, amellyel könnyedén frissíteni tudunk a különbözõ verziók között. Ebben a fejezetben segítünk dönteni a fejlesztõi változat és a kiadások használata között. Továbbá megismerhetjük a rendszer frissítéséhez használható alapvetõ eszközöket.</p></div><div class=paragraph><p>A fejezet elolvasása során megismerjük:</p></div><div class=ulist><ul><li><p>milyen segédprogramokkal tudjuk frissíteni az alaprendszert és a Portgyûjteményt;</p></li><li><p>hogyan tartsuk naprakészen rendszerünket a freebsd-update, CVSup, CVS vagy CTM használatával;</p></li><li><p>hogyan vessük össze a telepített rendszerünk aktuális állapotát egy ismert eredeti változattal;</p></li><li><p>hogyan frissítsük a dokumentációt CVSup vagy dokumentációs portok segítségével.</p></li><li><p>a két fejlesztõi ág, a FreeBSD-STABLE és a FreeBSD-CURRENT közti különbséget;</p></li><li><p>a <code>make buildworld</code> (stb.) segítségével hogyan fordítsuk és telepítsük újra az egész alaprendszert.</p></li></ul></div><div class=paragraph><p>A fejezet elolvasásához ajánlott:</p></div><div class=ulist><ul><li><p>a hálózati kapcsolatunk helyes beállítása (<a href=./#advanced-networking>Egyéb haladó hálózati témák</a>);</p></li><li><p>a külsõ szoftverek telepítésének ismerete (<a href=./#ports>Alkalmazások telepítése. csomagok és portok</a>).</p></li></ul></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>A fejezetben a FreeBSD forrásainak frissítését a <code>cvsup</code> parancs segítségével fogjuk elvégezni. Ehhez telepítsük a <a class=package href=https://cgit.freebsd.org/ports/tree/net/cvsup/>net/cvsup</a> portot vagy csomagot (ha a <code>cvsup</code> parancsot nem akarjuk grafikus felületen keresztül használni, akkor elegendõ csak a <span class=filename>net/cvsup-without-gui</span> portot). Ha a FreeBSD 6.2-RELEASE vagy késõbbi változatával rendelkezünk, akkor elegendõ csak az alaprendszer részeként elérhetõ <a href="https://man.freebsd.org/cgi/man.cgi?query=csup&amp;sektion=1&amp;format=html">csup(1)</a> programot használnunk.</p></div></td></tr></tbody></table></div></div><div class=sect2><h3 id=updating-upgrading-freebsdupdate>24.2. A FreeBSD frissítése<a class=anchor href=#updating-upgrading-freebsdupdate></a></h3><div class=paragraph><p>A biztonsági javítások telepítése minden számítógépes szoftver, különösen az operációs rendszerek számára lényeges mozzanat. Nagyon hosszú ideig ez a FreeBSD esetében nem volt könnyen megoldható: a javításokat közvetlenül a forráskódon kellett elvégezni, ezekbõl újrafordítani a rendszert, majd telepíteni.</p></div><div class=paragraph><p>Ez a nehézség mostanra viszont már elhárult, mivel a FreeBSD legfrissebb verziói már tartalmaznak egy <code>freebsd-update</code> nevû segédprogramot, amellyel mindez leegyszerûsödik. Ez a program két külön funkciót lát el. Elõször is, lehetõvé teszi, hogy a FreeBSD alaprendszer újrafordítása és -telepítése nélkül javítsunk biztonsági és egyéb apró hibákat, valamint másodsorban támogatja a kisebb és nagyobb verziójú kiadások közti váltást.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Ezek a bináris frissítések azonban csak a FreeBSD biztonsági csapata által is felügyelt architektúrák és kiadások esetén érhetõek el. Emellett bizonyos lehetõségek használatához, például a FreeBSD verziói közti átállás támogatásához a <a href="https://man.freebsd.org/cgi/man.cgi?query=freebsd-update&amp;sektion=8&amp;format=html">freebsd-update(8)</a> legújabb változata szükségeltetik. Ezért ne felejtsük el alaposan átolvasni a legújabb kiadásokról szóló bejelentéseket mielõtt frissítenénk rájuk, mivel ezzel kapcsolatban fontos információkat tartalmazhatnak. Az említett bejelentések a <a href=http://www.FreeBSD.org/releases/>http://www.FreeBSD.org/releases/</a> címen érhetõek el.</p></div></td></tr></tbody></table></div><div class=paragraph><p>Ha a <code>crontab</code> már hivatkozik a <code>freebsd-update</code> programra, akkor a most következõ mûvelet elkezdése elõtt tiltsuk le.</p></div><div class=sect3><h4 id=freebsdupdate-config-file>24.2.1. A konfigurációs állományok<a class=anchor href=#freebsdupdate-config-file></a></h4><div class=paragraph><p>Ha változtatnénk szeretnénk a frissítési folyamaton, ekkor a programhoz tartozó, <span class=filename>/etc/freebsd-update.conf</span> nevû konfigurációs állományt kell módosítanunk. Az opciók részletes ismertetéssel rendelkeznek, habár némelyiknél még további magyarázat kellhet:</p></div><div class="literalblock programlisting"><div class=content><pre># Az alaprendszerben frissíteni kívánt komponensek
Components src world kernel</pre></div></div><div class=paragraph><p>Ezzel a paraméterrel határozhatjuk meg, hogy a FreeBSD mely részei kerüljenek frissítésre. Alapértelmezés szerint a program frissíti a forrásokat, a teljes alaprendszert és a rendszermagot. Komponensként a telepítésnél választható elemeket adhatjuk meg, például "world/games" hozzáadásakor a games kategória elemei is folyamatosan frissülni fognak. Az "src/bin" megadásakor pedig az <span class=filename>src/bin</span> könyvtár tartalma frissül.</p></div><div class=paragraph><p>Ezt a beállítást a legjobb meghagyni az alapértelmezett értéken, mivel a további elemek megadásánál egyenként fel kell sorolni a frissítendõ komponenseket. Ha itt viszont kifelejtünk valamit, akkor könnyen megeshet, hogy a források és a binárisok verziója elcsúszik egymástól.</p></div><div class="literalblock programlisting"><div class=content><pre># Az IgnorePaths beállítás után megadott szövegre illeszkedõ összes
# bejegyzés frissítése kimarad
IgnorePaths</pre></div></div><div class=paragraph><p>Ennél a beállításnál azokat a könyvtárakat kell megadnunk, amelyeket (és tartalmukat) ki szeretnénk hagyni a frissítés során. Ezek lehetnek például a <span class=filename>/bin</span> vagy az <span class=filename>/sbin</span>. Így meg tudjuk akadályozni, hogy <code>freebsd-update</code> esetleg felülírjon valamilyen helyi változtatást a rendszerünkben.</p></div><div class="literalblock programlisting"><div class=content><pre># Az UpdateIfUnmodified beállítás után megadott elérési útvonalakon csak
# a felhasználó által még nem módosított állományok fognak frissülni
# (hacsak a módosításokat össze nem fésüljük, lásd lentebb)
UpdateIfUnmodified /etc/ /var/ /root/ /.cshrc /.profile</pre></div></div><div class=paragraph><p>A megadott könyvtárakban csak azokat a konfigurációs állományokat fogja frissíteni, amelyeket nem változtattuk meg. Amennyiben bármelyikük eltér az eredetileg frissítendõ változattól, azt a program nem módosítja. Létezik egy másik hasonló beállítás, a <code>KeepModifiedMetadata</code>, amely hatására a <code>freebsd-update</code> az összefésülés során elmenti a változtatásokat.</p></div><div class="literalblock programlisting"><div class=content><pre># A MergeChanges beállításnál szereplõ állományok helyi módosításait
# automatikusan összefésüljük a FreeBSD újabb verziójára frissítése közben
MergeChanges /etc/ /var/named/etc/</pre></div></div><div class=paragraph><p>Itt azokat a könyvtárakat adhatjuk meg, amelyekben a <code>freebsd-update</code> számára engedélyezzük a konfigurációs állományok új verziójának összefésülését a jelenlegi állapottal. Az összefésülés lényegében a <a href="https://man.freebsd.org/cgi/man.cgi?query=mergemaster&amp;sektion=8&amp;format=html">mergemaster(8)</a> használatánál már megszokott módon, <a href="https://man.freebsd.org/cgi/man.cgi?query=diff&amp;sektion=1&amp;format=html">diff(1)</a> formátumban érkezõ módosítások sorozata alapján történik. Ekkor egy szövegszerkesztõ segítségével felügyelhetjük az összefésülés menetét vagy megállíthatjuk a <code>freebsd-update</code> futását. Ha kétségeink adódnak, akkor egyszerûen mentsük le az <span class=filename>/etc</span> könyvtárat és fogadjuk el mindegyik összefésülés eredményét. A <code>mergemaster</code> mûködésérõl a <a href=#mergemaster>A <code>mergemaster</code></a> ad részletesebb tájékoztatást.</p></div><div class="literalblock programlisting"><div class=content><pre># A FreeBSD frissítésekor ezt a könyvtárat fogja a program használni a
# letöltött módosítások és az egyéb ideiglenes állományok tárolására
# WorkDir /var/db/freebsd-update</pre></div></div><div class=paragraph><p>Az itt megadott könyvtárba fognak kerülni az elvégzendõ módosítások és az egyéb ideiglenesen keletkezõ állományok. A verziók közti váltás során ebben a könyvtárban ajánlott legalább 1 GB szabad tárterületnek lennie.</p></div><div class="literalblock programlisting"><div class=content><pre># A kiadások közti váltás során a Components beállításnál megadott
# elemek kerüljenek csak frissítésre (StrictComponents yes), vagy a
# program próbálja meg magától kitalálni, hogy milyen komponesek
# *lehetnek* fenn a rendszeren és azokat frissítse (StrictComponents
# no)?
# StrictComponents no</pre></div></div><div class=paragraph><p>Ha ennél a beállításnál a <code>yes</code> értéket adjuk meg, akkor a <code>freebsd-update</code> feltételezni fogja, hogy a <code>Components</code> opciónál felsoroltunk minden frissítendõ komponenst és nem próbál meg mást is megváltoztatni. Ilyenkor tehát a <code>freebsd-update</code> tulajdonképpen egyedül csak a <code>Components</code> által meghatározott elemekhez tartozó állományokat fogja frissíteni.</p></div></div><div class=sect3><h4 id=freebsdupdate-security-patches>24.2.2. Biztonsági javítások<a class=anchor href=#freebsdupdate-security-patches></a></h4><div class=paragraph><p>A biztonsági javítások mindig egy távoli gépen tárolódnak, a következõ parancsok használatával tölthetõek le és telepíthetõek:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># freebsd-update fetch</span>
<span class=c># freebsd-update install</span></code></pre></div></div><div class=paragraph><p>Amennyiben a rendszermagot is érintik javítások, úgy a rendszert a mûvelet befejezõdésével újra kell indítanunk. Ha minden a megfelelõ módon történt, akkor a rendszerünk már tartalmazni fogja a korábban letöltött és telepített javításokat, és a <code>freebsd-update</code> akár beállítható egy naponta végrehajtandó <a href="https://man.freebsd.org/cgi/man.cgi?query=cron&amp;sektion=8&amp;format=html">cron(8)</a> feladatnak. Ehhez mindössze a következõ bejegyzést kell elhelyeznünk az <span class=filename>/etc/crontab</span> állományban:</p></div><div class="literalblock programlisting"><div class=content><pre>@daily                                  root    freebsd-update cron</pre></div></div><div class=paragraph><p>A bejegyzés szerint naponta egyszer le fog futni a <code>freebsd-update</code>. Ilyenkor, vagyis a <code>cron</code> paraméter megadásakor a <code>freebsd-update</code> csak ellenõrzi, hogy vannak-e telepítendõ frissítések. Ha talál, akkor automatikusan letölti ezeket a lemezre, de nem telepíti. Helyette levélben értesíti a <code>root</code> felhasználót, aki ezután bármikor manuálisan kérheti a telepítést.</p></div><div class=paragraph><p>Probléma esetén az alábbi paranccsal megkérhetjük a <code>freebsd-update</code> programot a legutóbb telepített módosítások visszavonására:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># freebsd-update rollback</span></code></pre></div></div><div class=paragraph><p>Ha ez a visszavonás a rendszermagra vagy annak moduljaira is vonatkozott, akkor a rendszert újra kell indítanunk a parancs futásának befejezõdésével. A FreeBSD csak ilyenkor képes betölteni az új binárisokat betölteni a memóriába.</p></div><div class=paragraph><p>A <code>freebsd-update</code> önmagától csak a <code>GENERIC</code> típusú rendszermagokat képes frissíteni. Ha saját rendszermagot használunk, akkor azt a rendszer többi komponensének frissítését követõen újra kell fordítanunk és telepítenünk. A <code>freebsd-update</code> azonban még akkor is érzekelni és frissíteni fogja a <code>GENERIC</code> rendszermagot (amennyiben az létezik), ha az éppen nem az aktuális(an futó) rendszermag.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Mindig érdemes tartani egy másolatot a <code>GENERIC</code> rendszermagról a <span class=filename>/boot/GENERIC</span> könyvtárban. Rengeteg különbözõ probléma felderítésében tud segíteni, illetve ez a <a href=#freebsdupdate-upgrade>Váltás kisebb és nagyobb verziók között</a> szakaszban leírt <code>freebsd-update</code> programmal végzett frissítéseknél is hasznos lehet.</p></div></td></tr></tbody></table></div><div class=paragraph><p>Hacsak nem változtatjuk meg az <span class=filename>/etc/freebsd-update.conf</span> állományt, a <code>freebsd-update</code> a rendszermag forrásait is frissíti a többivel együtt. A saját rendszermag újrafordítása és telepítése ezután a már a megszokott módon elvégezhetõ.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>A <code>freebsd-update</code> által terjesztett frissítések nem mindig érintik a rendszermagot. Ha a rendszermag forrásai nem változnak egy <code>freebsd-update install</code> parancs kiadása során, akkor nem kötelezõ újrafordítani a saját rendszermagot. A <code>freebsd-update</code> viszont mindig módosítani fogja a <span class=filename>/usr/src/sys/conf/newvers.sh</span> állományt. Itt az aktuális hibajavítás sorszáma szerepel (amelyet a <code>-p</code> (mint "patch level" elõtaggal kapcsolnak a rendszer verziójához, és a <code>uname -r</code> paranccsal lehet lekérdezni). Ennek megfelelõen tehát a saját rendszermag újrafordítása után, még ha semmi más nem is változott, a <a href="https://man.freebsd.org/cgi/man.cgi?query=uname&amp;sektion=1&amp;format=html">uname(1)</a> képes pontosan jelezni a rendszerhez készült hibajavítás sorszámát. Ez különösen fontos több rendszer karbantartása során, mivel így könnyen és gyorsan tájékozódhatunk azok naprakészségérõl.</p></div></td></tr></tbody></table></div></div><div class=sect3><h4 id=freebsdupdate-upgrade>24.2.3. Váltás kisebb és nagyobb verziók között<a class=anchor href=#freebsdupdate-upgrade></a></h4><div class=paragraph><p>Verziók közti váltás során a külsõ alkalmazások mûkõdését akadályozó régi tárgykódok és függvénykönyvtárak törlõdni fognak. Ezért javasoljuk, hogy vagy töröljük le az összes portot és telepítsük újra, vagy az alaprendszer frissítése után hozzuk ezeket is naprakész állapotba a <a class=package href=https://cgit.freebsd.org/ports/tree/ports-mgmt/portupgrade/>ports-mgmt/portupgrade</a> segédprogram segítségével. Elõször minden bizonnyal szeretnék kipróbálni a frissítést, ezt a következõ paranccsal tehetjük meg:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># portupgrade -af</span></code></pre></div></div><div class=paragraph><p>Ezzel gondoskodunk róla, hogy a minden a megfelelõen telepítõdjön újra. Ha a <code>BATCH</code> környezeti változót a <code>yes</code> értékre állítjuk, akkor a folyamat során megjelenõ összes kérdésre automatikusan a <code>yes</code> választ adjuk, ezáltal önállósítani tudjuk.</p></div><div class=paragraph><p>Ha saját rendszermagot használunk, akkor ennél valamivel azért több feladatunk van. Szükségünk lesz a <code>GENERIC</code> rendszermagot egy példányára, amelyet másoljunk a <span class=filename>/boot/GENERIC</span> könyvtárba. Amennyiben nincs <code>GENERIC</code> típusú rendszermag a rendszerünkön, a következõ módok valamelyikén keresztül tudunk szerezni:</p></div><div class=ulist><ul><li><p>Ha a saját rendszermagot még csak egyszer fordítottuk, akkor a <span class=filename>/boot/kernel.old</span> könyvtárban még megtalálható a <code>GENERIC</code>. Ezt nevezzük át egyszerûen <span class=filename>/boot/GENERIC</span> könyvtárra.</p></li><li><p>Ha fizikailag hozzá tudunk férni az érintett géphez, akkor a <code>GENERIC</code> egy példányát akár CD-rõl is átmásolhatjuk. Helyezzük be a telepítõlemezt és adjuk ki a következõ parancsokat:</p><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># mount /cdrom</span>
<span class=c># cd /cdrom/X.Y-RELEASE/kernels</span>
<span class=c># ./install.sh GENERIC</span></code></pre></div></div><div class=paragraph><p>Itt a <span class=filename>X.Y-RELEASE</span> könyvtár nevében értelemszerûen helyettesítsük be az általunk használt változatot. A <code>GENERIC</code> rendszermag ekkor alapértelmezés szerint a <span class=filename>/boot/GENERIC</span> könyvtárba kerül.</p></div></li><li><p>Ha az elõbbiek közül egyik sem lehetséges, akkor a <code>GENERIC</code> rendszermagot közvetlenül akár forrásból is lefordíthatjuk és telepíthetjük:</p><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># cd /usr/src</span>
<span class=c># env DESTDIR=/boot/GENERIC make kernel</span>
<span class=c># mv /boot/GENERIC/boot/kernel/* /boot/GENERIC</span>
<span class=c># rm -rf /boot/GENERIC/boot</span></code></pre></div></div><div class=paragraph><p>A <code>freebsd-update</code> akkor fogja ezt <code>GENERIC</code> rendszermagként felismerni, ha a hozzá tartozó konfigurációs állományt nem módosítjuk. Továbbá javasoljuk, hogy semmilyen speciális beállítást ne alkalmazzunk a fordítás során (érdemes üresen hagyni ehhez az <span class=filename>/etc/make.conf</span> állományt).</p></div></li></ul></div><div class=paragraph><p>Nem kötelezõ újraindítani a rendszert a <code>GENERIC</code> rendszermaggal.</p></div><div class=paragraph><p>A <code>freebsd-update</code> képes frissíteni rendszerünket egy adott kiadásra. Például a következõ paraméterek megadásával válthatunk a FreeBSD 6.4 használatára:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># freebsd-update -r 6.4-RELEASE upgrade</span></code></pre></div></div><div class=paragraph><p>A parancs elindulása után nem sokkal, a váltáshoz szükséges információk összegyûjtéséhez a <code>freebsd-update</code> elemzi a konfigurációs állományában megadott beállításokat és a rendszer jelenleg használt verzióját. A képernyõn ekkor sorban megjelennek a program részérõl érzékelt és nem érzékelt komponensek. Mint például ahogy itt látható:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>Looking up update.FreeBSD.org mirrors... 1 mirrors found.
Fetching metadata signature <span class=k>for </span>6.3-RELEASE from update1.FreeBSD.org... <span class=k>done</span><span class=nb>.</span>
Fetching metadata index... <span class=k>done</span><span class=nb>.</span>
Inspecting system... <span class=k>done</span><span class=nb>.</span>

The following components of FreeBSD seem to be installed:
kernel/smp src/base src/bin src/contrib src/crypto src/etc src/games
src/gnu src/include src/krb5 src/lib src/libexec src/release src/rescue
src/sbin src/secure src/share src/sys src/tools src/ubin src/usbin
world/base world/info world/lib32 world/manpages

The following components of FreeBSD <span class=k>do </span>not seem to be installed:
kernel/generic world/catpages world/dict world/doc world/games
world/proflibs

Does this look reasonable <span class=o>(</span>y/n<span class=o>)</span>? y</code></pre></div></div><div class=paragraph><p>Ekkor a <code>freebsd-update</code> megpróbálja letölteni a verziók közti váltáshoz szükséges összes állományt. Bizonyos esetekben kérdésekkel fordul a felhasználó felé arra vonatkozóan, hogy miket telepítsen fel vagy mit csináljon.</p></div><div class=paragraph><p>A saját rendszermag használatakor az iménti lépés valamilyen ehhez hasonló figyelmeztetést fog adni:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>WARNING: This system is running a <span class=s2>&#34;SAJÁT RENDSZERMAG&#34;</span> kernel, which is not a
kernel configuration distributed as part of FreeBSD 6.3-RELEASE.
This kernel will not be updated: you MUST update the kernel manually
before running <span class=s2>&#34;/usr/sbin/freebsd-update install&#34;</span></code></pre></div></div><div class=paragraph><p>Ez a figyelmeztetés most nyugodtan figyelmen kívül hagyható. A folyamat során a frissített <code>GENERIC</code> rendszermagot fogjuk használni.</p></div><div class=paragraph><p>A javítások letöltését követõen megkezdõdik a telepítésük. A váltás ezen lépése az adott gép aktuális terhelésétõl és sebességétõl függõen változó hosszúságú lehet. Ezután a konfigurációs állományok összefésülése zajlik le - itt általában a emberi felügyeletre is szükség van az állományok összefésülésének irányításához, amelynek folyamatosan láthatóak az eredményei. A meghiúsult vagy kihagyott összefésülések a teljes frissítési folyamat leállását vonják maguk után. Az <span class=filename>/etc</span> könyvtárban tárolt fontosabb állományokról, mint például a <span class=filename>master.passwd</span> vagy <span class=filename>group</span> javasolt elõzetesen biztonsági mentést készíteni és késõbb kézzel hozzájuk adni a változtatásaikat.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>A rendszerben ekkor még nem lesz jelen semmilyen konkrét változás, az összes említett javítás és összefésülés egy külön könyvtárban történik. A telepített javításokat és az összefésült konfigurációs állományokat a folyamat végén magának a felhasználónak kell véglegesíteni.</p></div></td></tr></tbody></table></div><div class=paragraph><p>A frissítési eljárás végén a következõ parancs kiadásával tudjuk ténylegesen érvényesíteni az eddig elvégzett módosításokat:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># freebsd-update install</span></code></pre></div></div><div class=paragraph><p>Elõször mindig a rendszermag és a hozzá tartozó modulok cserélõdnek le. Ahogy ez végrehajtódott, újra kell indítanunk a rendszert. Ha saját rendszermagot használunk, akkor a <a href="https://man.freebsd.org/cgi/man.cgi?query=nextboot&amp;sektion=8&amp;format=html">nextboot(8)</a> parancs segítségével állítsuk be a következõ rendszerindítás során betöltendõ rendszermagot a <span class=filename>/boot/GENERIC</span> könyvtárban levõre (ezt frissítettük):</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># nextboot -k GENERIC</span></code></pre></div></div><div class="admonitionblock warning"><table><tbody><tr><td class=icon><i class="fa icon-warning" title=Warning></i></td><td class=content><div class=paragraph><p>Mielõtt újraindítanánk a gépünket a <code>GENERIC</code> rendszermaggal, gyõzõdjünk meg róla, hogy szerepel benne minden olyan meghajtó, amely elengedhetetlen a rendszer hiánytalan indításához (és képes lesz újra csatlakozni a hálózathoz, ha éppen távolról adminisztráljuk). Ez különösen olyan esetben fontos, amikor a saját rendszermagunkban beépítetten szerepeltek bizonyos modulok. Ilyenkor a <code>GENERIC</code> rendszermag használatakor ezeket a <span class=filename>/boot/loader.conf</span> állományon keresztül töltethetjük be ideiglenesen. A frissítés befejezéséig érdemes viszont minden nem létfontosságú szolgáltatást leállítani, leválasztani lemezeket és hálózati megosztásokat stb.</p></div></td></tr></tbody></table></div><div class=paragraph><p>A rendszerünk most már újraindítható a frissített rendszermaggal:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># shutdown -r now</span></code></pre></div></div><div class=paragraph><p>A rendszer sikeres újraindulása után ismét el kell indítanunk a <code>freebsd-update</code> programot, amely korábban már elmentette a frissítés állapotát, emiatt a legutóbbi pontról fog folytatódni, illetve törli az osztott könyvtárak és tárgykódok régebbi változatait. Innen az alábbi paranccsal léphetünk tovább:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># freebsd-update install</span></code></pre></div></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>A függvénykönyvtárak verziói közti eltérések mértékétõl függõen elképzelhetõ, hogy a telepítés az említett három fázis helyett kettõben történik.</p></div></td></tr></tbody></table></div><div class=paragraph><p>Most pedig újra kell fordítanunk vagy telepítenünk az összes általunk korábban használt külsõ alkalmazást. Erre azért van szükségünk, mert bizonyos alkalmazások a verziók közti váltás során törölt programkönyvtáraktól függtek. Ennek automatizálásában a <a class=package href=https://cgit.freebsd.org/ports/tree/ports-mgmt/portupgrade/>ports-mgmt/portupgrade</a> lesz segítségünkre. Az alkalmazások frissítésének elindításához a következõ parancsokat használjuk:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># portupgrade -f ruby</span>
<span class=c># rm /var/db/pkg/pkgdb.db</span>
<span class=c># portupgrade -f ruby18-bdb</span>
<span class=c># rm /var/db/pkg/pkgdb.db /usr/ports/INDEX-*.db</span>
<span class=c># portupgrade -af</span></code></pre></div></div><div class=paragraph><p>A parancsok lefutását követõen a <code>freebsd-update</code> utolsó hívásával zárjuk le a frissítést. Ezzel a paranccsal tudunk tehát pontot tenni a frissítési procedúra végére:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># freebsd-update install</span></code></pre></div></div><div class=paragraph><p>Ha a <code>GENERIC</code> rendszermagot csak átmenetileg használtuk, akkor most már a megszokott módon fordíthatunk és telepíthetünk magunk egy saját rendszermagot.</p></div><div class=paragraph><p>Indítsuk újra a rendszert a FreeBSD frissített változatával. A folyamat ezzel véget ért.</p></div></div><div class=sect3><h4 id=freebsdupdate-system-comparison>24.2.4. Rendszerek állapotainak összehasonlítása<a class=anchor href=#freebsdupdate-system-comparison></a></h4><div class=paragraph><p>A <code>freebsd-update</code> ragyogóan felhasználható a FreeBSD egy telepített változatának és egy általunk garantáltan megbízható példányának összevetésére. Ilyenkor a rendszerhez tartozó segédprogramokat, programkönyvtárakat és konfigurációs állományokat ellenõriztethetjük le. Az összehasonlítást ezzel a paranccsal kezdhetjük meg:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># freebsd-update IDS &gt;&gt; eredmeny.idk</span></code></pre></div></div><div class="admonitionblock warning"><table><tbody><tr><td class=icon><i class="fa icon-warning" title=Warning></i></td><td class=content><div class=paragraph><p>Habár a parancs neve IDS (intrusion detection system), nem helyettesít semmilyen olyan behatolásjelzõ megoldást, mint amilyen például a <a class=package href=https://cgit.freebsd.org/ports/tree/security/snort/>security/snort</a>. Mivel a <code>freebsd-update</code> adatokat tárol a lemezen, teljesen kézenfekvõ a hamisítás lehetõsége. Míg ennek eshetõsége adott mértékben visszaszorítható a <code>kern.securelevel</code> csökkentésével és a <code>freebsd-update</code> által használt adatok írásvédett állományrendszerre helyezésével, erre a problémára az ideális megoldást mégis egy teljes biztonságban tudható referencia rendszer jelentheti. Ennek tárolására alkalmas lehet például egy DVD vagy egy külsõ USB-egység.</p></div></td></tr></tbody></table></div><div class=paragraph><p>A parancs kiadása után megkezdõdik a rendszer vizsgálata, és az ellenõrzés során folyamatosan jelennek meg az átvizsgált állományok a hozzájuk tartozó ismert és kiszámított <a href="https://man.freebsd.org/cgi/man.cgi?query=sha256&amp;sektion=1&amp;format=html">sha256(1)</a>-kódjukkal együtt. Mivel a képernyõn túlságosan gyorsan elúsznának az eredmények, ezért ezeket egy <span class=filename>eredmeny.idk</span> nevû állományba mentjük a késõbbi elemzésekhez.</p></div><div class=paragraph><p>Az így keletkezõ állomány sorai ugyan meglehetõsen hosszúak, de szerencsére viszonylag könnyen értelmezhetõek. Például az adott kiadásban szereplõ állományoktól eltérõeket ezzel a paranccsal kérdezhetjük le:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># cat eredmeny.idk | awk &#39;{ print $1 }&#39; | more</span>
/etc/master.passwd
/etc/motd
/etc/passwd
/etc/pf.conf</code></pre></div></div><div class=paragraph><p>A példában most csak az elsõ néhány állományt hagytuk meg, gyakran tapasztalhatunk viszont ennél többet. Ezek közül bizonyos állományok értelemszerûen eltérnek, mint itt például az <span class=filename>/etc/passwd</span>, mert idõközben új felhasználókat adtunk a rendszerhez. Máskor egyéb állományok, például modulok nevei is felbukkanhatnak, mert tegyük fel, hogy a <code>freebsd-update</code> már frissítette ezeket. Ha ki szeretnénk zárni valamilyen állományokat vagy könyvtárakat az ellenõrzésbõl, egyszerûen csak soroljuk fel ezeket az <span class=filename>/etc/freebsd-update.conf</span> állományban megjelenõ <code>IDSIgnorePaths</code> beállításnál.</p></div><div class=paragraph><p>A korábban tárgyaltaktól függetlenül ez a rendszer alkalmas bonyolultabb frissítési folyamatok kisegítésére is.</p></div></div></div><div class=sect2><h3 id=updating-upgrading-portsnap>24.3. A Portgyûjtemény frissítése a Portsnap használatával<a class=anchor href=#updating-upgrading-portsnap></a></h3><div class=paragraph><p>A FreeBSD alaprendszer a Portgyûjtemény frissítéséhez is tartalmaz egy <a href="https://man.freebsd.org/cgi/man.cgi?query=portsnap&amp;sektion=8&amp;format=html">portsnap(8)</a> elnevezésû segédprogramot. Ez a program elindítása után csatlakozik egy távoli géphez, ellenõrzi a biztonsági kulcsát és letölti a portok legfrissebb változatait. A biztonsági kulcs feladata a frissítés közben letöltött állományok sértetlenségének szavatolása, ezzel gondoskodik róla, hogy az adatok átvitelük közben nem változtak meg. A Portgyûjtemény legújabb változatát így érhetjük el:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># portsnap fetch</span>
Looking up portsnap.FreeBSD.org mirrors... 3 mirrors found.
Fetching snapshot tag from portsnap1.FreeBSD.org... <span class=k>done</span><span class=nb>.</span>
Fetching snapshot metadata... <span class=k>done</span><span class=nb>.</span>
Updating from Wed Aug  6 18:00:22 EDT 2008 to Sat Aug 30 20:24:11 EDT 2008.
Fetching 3 metadata patches.. <span class=k>done</span><span class=nb>.</span>
Applying metadata patches... <span class=k>done</span><span class=nb>.</span>
Fetching 3 metadata files... <span class=k>done</span><span class=nb>.</span>
Fetching 90 patches.....10....20....30....40....50....60....70....80....90. <span class=k>done</span><span class=nb>.</span>
Applying patches... <span class=k>done</span><span class=nb>.</span>
Fetching 133 new ports or files... <span class=k>done</span>.</code></pre></div></div><div class=paragraph><p>A példában látható, hogy a <a href="https://man.freebsd.org/cgi/man.cgi?query=portsnap&amp;sektion=8&amp;format=html">portsnap(8)</a> eltéréseket talált a helyi és a távoli rendszerekben fellelhetõ portok között, majd azokat ellenõrizte. Emellett az is megfigyelhetõ, hogy korábban már futtatuk a programot, mivel ha most indítottuk volna az elsõ alkalommal, akkor egyszerûen letöltötte volna a teljes Portgyûjteményt.</p></div><div class=paragraph><p>Ahogy a <a href="https://man.freebsd.org/cgi/man.cgi?query=portsnap&amp;sektion=8&amp;format=html">portsnap(8)</a> sikeresen befejezi az imént kiadott <code>fetch</code> mûvelet végrehajtását, a helyi rendszeren már telepítésre készen fognak várakozni a Portgyûjtemény és az hozzá tartozó ellenõrzött módosítások. A <code>portsnap</code> elsõ használatakor az <code>extract</code> parancs segítségével telepíthetjük a frissített állományokat:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># portsnap extract</span>
/usr/ports/.cvsignore
/usr/ports/CHANGES
/usr/ports/COPYRIGHT
/usr/ports/GIDs
/usr/ports/KNOBS
/usr/ports/LEGAL
/usr/ports/MOVED
/usr/ports/Makefile
/usr/ports/Mk/bsd.apache.mk
/usr/ports/Mk/bsd.autotools.mk
/usr/ports/Mk/bsd.cmake.mk
...</code></pre></div></div><div class=paragraph><p>Egy korábban már telepített Portgyûjteményt a <code>portsnap update</code> paranccsal tudunk frissíteni:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># portsnap update</span></code></pre></div></div><div class=paragraph><p>Ezzel lezárult a portok frissítése, innentõl már az aktualizált Portgyûjtemény felhasználásával tetszõlegesen telepíthetõek vagy frissíthetõek az alkalmazások.</p></div><div class=paragraph><p>A <code>fetch</code>, <code>extract</code> vagy <code>update</code> mûveletek egyetlen parancsba is összefûzhetõek, ahogy ezt az alábbi példában is láthatjuk:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># portsnap fetch update</span></code></pre></div></div><div class=paragraph><p>Ez a parancs letölti a Portgyûjtemény legfrissebb változatát, majd kitömöríti azt a helyi <span class=filename>/usr/ports</span> könyvtárba.</p></div></div><div class=sect2><h3 id=updating-upgrading-documentation>24.4. A dokumentáció frissítése<a class=anchor href=#updating-upgrading-documentation></a></h3><div class=paragraph><p>Az alaprendszer és a Portgyûjtemény mellett a dokumentáció is a FreeBSD operációs rendszer szerves részét képezi. Noha a FreeBSD dokumentációjának legfrissebb változata folyamatosan elérhetõ a <a href=http://www.freebsd.org/doc>FreeBSD honlapjáról</a>, egyes felhasználók ezt csak lassan vagy nem képesek folyamatosan elérni. Szerencsére egy helyi másolat megfelelõ karbantartásával az egyes kiadásokhoz tartozó dokumentáció is frissíthetõ.</p></div><div class=sect3><h4 id=csup-doc>24.4.1. A dokumentáció frissítése CVSup használatával<a class=anchor href=#csup-doc></a></h4><div class=paragraph><p>A FreeBSD telepített dokumentációjának forrásai az alaprendszeréhez hasonlóan (lásd <a href=#makeworld>Az alaprendszer újrafordítása</a>) a CVSup segítségével frissíthetõek. Ebben a szakaszban megismerhetjük:</p></div><div class=ulist><ul><li><p>hogyan telepítsük a dokumentáció elõállításához szükséges eszközöket, amelyekkel a forrásokból újra tudjuk generálni a FreeBSD dokumentációját;</p></li><li><p>hogyan töltsük le a dokumentáció forrását CVSup segítségével a <span class=filename>/usr/doc</span> könyvtárba;</p></li><li><p>a dokumentáció elõállításához alkalmazott rendszer milyen beállításokkal rendelkezik, vagyis hogyan korlátozzuk a generálást bizonyos nyelvekre vagy formátumokra.</p></li></ul></div></div><div class=sect3><h4 id=installing-documentation-toolchain>24.4.2. A CVSup és a dokumentációs eszközök telepítése<a class=anchor href=#installing-documentation-toolchain></a></h4><div class=paragraph><p>Viszonylag sokféle eszközre lesz szükségünk, ha a FreeBSD dokumentációját a forrásokból akarjuk elõállítani. Ezek az segédprogramok nem részei a FreeBSD alaprendszerének, mivel alapvetõen nagyon sok helyet foglalnak el, és leginkább olyan FreeBSD felhasználók számára fontosak, akik folyamatosan a dokumentációval dolgoznak vagy gyakran frissítik azt forrásból.</p></div><div class=paragraph><p>A feladathoz szükséges összes eszköz elérhetõ a Portgyûjteménybõl. Ebben a FreeBSD Dokumentációs Projekt összeállított egy <a class=package href=https://cgit.freebsd.org/ports/tree/textproc/docproj/>textproc/docproj</a> nevû portot, amellyel az említett programok telepítését és frissítését igyekezték megkönnyíteni.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Ha nem tartunk igényt a dokumentáció PostScript® vagy PDF változatára, akkor ehelyett inkább érdemes megfontolnunk a <a class=package href=https://cgit.freebsd.org/ports/tree/textproc/docproj-nojadetex/>textproc/docproj-nojadetex</a> port telepítését. Ebben a változatban a teTeX betûszedõ rendszer kivételével az összes segédprogram megtalálható. Mivel a teTeX önmagában nagyon sok segédeszköz telepítését jelenti, ezért amennyiben a PDF változat ténylegesen nem szükséges, érdemes eltekinteni a telepítésétõl.</p></div></td></tr></tbody></table></div><div class=paragraph><p>A CVSup telepítésével kapcsolatban pedig részletesebb információkat a <a href=./#cvsup>CVSup használatával</a> foglalkozó szakaszban olvashatunk.</p></div></div><div class=sect3><h4 id=updating-documentation-sources>24.4.3. A dokumentáció forrásának frissítése<a class=anchor href=#updating-documentation-sources></a></h4><div class=paragraph><p>A <span class=filename>/usr/shared/examples/cvsup/doc-supfile</span> konfigurációs állomány segítségével a CVSup képes letölteni a dokumentáció forrásállományainak legfrissebb példányait. Itt a frissítést alapértelmezés szerint egy nem létezõ géptõl fogjuk kérni (mivel ezt kötelezõ kitölteni), azonban a <a href="https://man.freebsd.org/cgi/man.cgi?query=cvsup&amp;sektion=1&amp;format=html">cvsup(1)</a> programnak egy parancssori paraméter segítségével megadhatjuk melyik CVSup szerverrõl töltse le a forrásokat:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># cvsup -h cvsup.FreeBSD.org -g -L 2 /usr/shared/examples/cvsup/doc-supfile</span></code></pre></div></div><div class=paragraph><p>Ne felejtsük el a <em>cvsup.FreeBSD.org</em> helyére beírni a hozzánk földrajzilag legközelebb elhelyezkedõ CVSup szervert. Ezek teljes listáját a <a href=./#cvsup-mirrors>CVSup oldalak</a> tartalmazza.</p></div><div class=paragraph><p>Egy ideig eltarthat, amíg elõször letöltjük a forrásokat. Várjuk meg türelmesen, amíg befejezõdik a mûvelet.</p></div><div class=paragraph><p>Késõbb a forrásokat ugyanezzel a paranccsal tudjuk frissíteni. A CVSup ugyanis mindig csak a legutóbbi futtatása óta történt változásokat tölti le, ezért késõbb már ez a lépés jelentõsen felgyorsulhat.</p></div><div class=paragraph><p>A források letöltése után a dokumentációt például az ekkor keletkezett <span class=filename>/usr/doc</span> könyvtárban található <span class=filename>Makefile</span> használatával állíthatjuk elõ. Tehát miután az <span class=filename>/etc/make.conf</span> állományban beállítottuk a <code>SUP_UPDATE</code>, <code>SUPHOST</code> és <code>DOCSUPFILE</code> változókat, le tudjuk futtatni a következõ parancsot:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># cd /usr/doc</span>
<span class=c># make update</span></code></pre></div></div><div class=paragraph><p>Az elõbb említett <a href="https://man.freebsd.org/cgi/man.cgi?query=make&amp;sektion=1&amp;format=html">make(1)</a> változók jellemzõ értékei:</p></div><div class="literalblock programlisting"><div class=content><pre>SUP_UPDATE= yes
SUPHOST?= cvsup.freebsd.org
DOCSUPFILE?= /usr/shared/examples/cvsup/doc-supfile</pre></div></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Mivel a <code>SUPHOST</code> és a <code>DOCSUPFILE</code> változók értékét a <code>?=</code> szimbólummal állítottuk be, lehetõségünk van a parancssorból ezeknek más értékeket adni. Az <span class=filename>/etc/make.conf</span> állományba általában így érdemes felvenni a változókat, így nem kell minden alkalommal módosítani, amikor valamilyen új beállítást akarunk kipróbálni.</p></div></td></tr></tbody></table></div></div><div class=sect3><h4 id=updating-documentation-options>24.4.4. A dokumentáció különbözõ beállításai<a class=anchor href=#updating-documentation-options></a></h4><div class=paragraph><p>A FreeBSD dokumentációjához tartozó, frissítést és elõállítást végzõ rendszernek van néhány olyan beállítása, amelyekkel kérhetjük kizárólag csak a dokumentáció egyes részeinek frissítését vagy bizonyos kimeneti formátumok használatát. Ezek vagy globálisan az <span class=filename>/etc/make.conf</span> állományban, vagy pedig a parancssorból, a <a href="https://man.freebsd.org/cgi/man.cgi?query=make&amp;sektion=1&amp;format=html">make(1)</a> program paramétereként adhatóak meg.</p></div><div class=paragraph><p>Ízelítõül néhány közülük:</p></div><div class=dlist><dl><dt class=hdlist1><code>DOC_LANG</code></dt><dd><p>Az elõállítandó és telepítendõ nyelvû dokumentáció felsorolása, tehát például csak az angol dokumentáció esetén ez <code>en_US.ISO8859-1</code>.</p></dd><dt class=hdlist1><code>FORMATS</code></dt><dd><p>Az elõállítandó dokumentáció kimeneti formátumainak felsorolása. Itt pillanatnyilag értékként a <code>html</code>, <code>html-split</code>, <code>txt</code>, <code>ps</code>, <code>pdf</code> és <code>rtf</code> jelenhet meg.</p></dd><dt class=hdlist1><code>SUPHOST</code></dt><dd><p>A frissítéshez használt CVSup szerver hálózati neve.</p></dd><dt class=hdlist1><code>DOCDIR</code></dt><dd><p>Az elkészült dokumentáció telepítésének helye. Ez alapértelmezés szerint a <span class=filename>/usr/shared/doc</span>.</p></dd></dl></div><div class=paragraph><p>A folyamathoz kapcsolódóan további rendszerszintû <a href="https://man.freebsd.org/cgi/man.cgi?query=make&amp;sektion=1&amp;format=html">make(1)</a> változókról a <a href="https://man.freebsd.org/cgi/man.cgi?query=make.conf&amp;sektion=5&amp;format=html">make.conf(5)</a> man oldalon olvashatunk.</p></div><div class=paragraph><p>A FreeBSD dokumentációjának elõállításáért felelõs rendszerben használható <a href="https://man.freebsd.org/cgi/man.cgi?query=make&amp;sektion=1&amp;format=html">make(1)</a> további változók bemutatásával kapcsolatban pedig olvassuk el az <a href=https://docs.freebsd.org/en/books/fdp-primer/>A FreeBSD Dokumentációs Projekt irányelvei kezdõknek</a> címû könyvet.</p></div></div><div class=sect3><h4 id=updating-installed-documentation>24.4.5. A FreeBSD dokumentációjának telepítése forrásból<a class=anchor href=#updating-installed-documentation></a></h4><div class=paragraph><p>Miután sikerült letöltenünk a <span class=filename>/usr/doc</span> könyvtárba a dokumentáció legfrissebb forrásait, készen állunk a rendszerünkön telepített példány frissítésére.</p></div><div class=paragraph><p>A <code>DOCLANG</code> értékeként megadott nyelven készült dokumentációkat a következõ paranccsal tudjuk frissíteni:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># cd /usr/doc</span>
<span class=c># make install clean</span></code></pre></div></div><div class=paragraph><p>Ha a <span class=filename>make.conf</span> állományban korábban már megadtuk a <code>DOCSUPFILE</code>, <code>SUPHOST</code> és <code>SUP_UPDATE</code> változók értékeit, akkor a telepítés fázisa könnyedén össze is vonatható a források frissítésével:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># cd /usr/doc</span>
<span class=c># make update install clean</span></code></pre></div></div><div class=paragraph><p>Ha pedig csak bizonyos nyelvekhez tartozó dokumentációt szeretnénk frissíteni, akkor a <a href="https://man.freebsd.org/cgi/man.cgi?query=make&amp;sektion=1&amp;format=html">make(1)</a> akár a <span class=filename>/usr/doc</span> könyvtáron belül az egyes nyelvekhez tartozó alkönyvtárakon belül is meghívható, például:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># cd /usr/doc/en_US.ISO8859-1</span>
<span class=c># make update install clean</span></code></pre></div></div><div class=paragraph><p>A dokumentáció formátumát a <code>FORMATS</code> változó felhasználásával tudjuk meghatározni:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># cd /usr/doc</span>
<span class=c># make FORMATS=&#39;html html-split&#39; install clean</span></code></pre></div></div></div><div class=sect3><h4 id=doc-ports>24.4.6. A dokumentációs portok használata<a class=anchor href=#doc-ports></a></h4><div class=paragraph><p>Ez elõzõ szakaszban megmutattuk hogyan lehet a FreeBSD dokumentációját a források felhasználásával frissíteni. A források használatával végzett frissítés azonban nem minden FreeBSD rendszer esetében lehetséges vagy hatékony. Ha ugyanis a dokumentációs forrásból akarjuk elõállítani, viszonylag sok eszköz és segédprogram, az ún. <em>dokumentációs eszközök</em> használatával kell tisztában lennünk, valamint bizonyos mértékig ismernünk kell a CVS használatát, tudunk kell kikérni a legfrissebb változatot és elõállítatattnunk belõle a végleges változatot. Ezért ebben a szakaszban most szót ejtünk egy olyan módszerrõl, ahol a FreeBSD dokumentációját a Portgyûjteményen keresztül tudjuk frissíteni, ezáltal:</p></div><div class=ulist><ul><li><p>anélkül le tudjuk tölteni és telepíteni a dokumentáció adott pillanatban generált változatát, hogy a rendszerünkön bármi további teendõre szükség lenne (ennek köszönhetõen nem kell telepítenünk a dokumentációs eszközöket);</p></li><li><p>letölthetjük a dokumentáció forrását és a Portgyûjtemény eszközeivel elõállíthatjuk belõle a megfelelõ változatot (ez a források beszerzésében és feldolgozásában segít valamelyest).</p></li></ul></div><div class=paragraph><p>A FreeBSD dokumentáció frissítésének fentebb említett módjait támogatják tehát a <em>dokumentációs portok</em>, amelyeket a Documentation Engineering Team &lt;<a href=mailto:doceng@FreeBSD.org>doceng@FreeBSD.org</a>> havi rendszerességgel tart karban. Ezek a portok a FreeBSD Portgyûjteményén belül a <a href=http://www.freshports.org/docs/>docs</a> nevû virtuális kategóriában találhatóak meg.</p></div><div class=sect4><h5 id=doc-ports-install-make>24.4.6.1. A dokumentációs portok fordítása és telepítése<a class=anchor href=#doc-ports-install-make></a></h5><div class=paragraph><p>A dokumentáció könnyebb elõállításához a dokumentációs portok a Portgyûjtemény lehetõségeit veszik igénybe. Segítségükkel automatikussá teszik a dokumentáció forrásának letöltését, a <a href="https://man.freebsd.org/cgi/man.cgi?query=make&amp;sektion=1&amp;format=html">make(1)</a> parancs meghívását a megfelelõ környezetben, beállításokkal és parancssori paraméterekkel. Rajtuk keresztül a dokumentáció eltávolítása ugyanolyan egyszerûen megtehetõ, mint akármelyik másik FreeBSD port vagy csomag esetében.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Továbbá, amikor a dokumentációs portokat a saját rendszerünkön fordítjuk, a <em>dokumentációs eszközök</em> függõségként automatikusan települni fognak.</p></div></td></tr></tbody></table></div><div class=paragraph><p>A dokumentációs portok a következõ módon szervezõdnek:</p></div><div class=ulist><ul><li><p>Létezik egy ún. "fõport", a <a class=package href=https://cgit.freebsd.org/ports/tree/misc/freebsd-doc-en/>misc/freebsd-doc-en</a>, ahol az összes fontosabb állomány megtalálható. Ez lényegében a dokumentációs portok közös õse. Alapértelmezés szerint kizárólag csak az angol nyelvû dokumentációt állítja elõ.</p></li><li><p>Létezik egy "mindenes port", a <a class=package href=https://cgit.freebsd.org/ports/tree/misc/freebsd-doc-all/>misc/freebsd-doc-all</a>, amely az összes elérhetõ nyelven és formátumban elõállítja a dokumentációt.</p></li><li><p>Végezetül minden nyelvhez létezik egy-egy "alport", ilyen például a magyar dokumentáció esetén a <a class=package href=https://cgit.freebsd.org/ports/tree/misc/freebsd-doc-hu/>misc/freebsd-doc-hu</a> port. Mindegyikük a fõporttól függ és az adott nyelvû dokumentációt telepítik.</p></li></ul></div><div class=paragraph><p>Az eddigi összefoglaltaknak megfelelõen a dokumentációs portokat forrásból a következõ paranccsal lehet telepíteni (<code>root</code> felhasználóként):</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># cd /usr/ports/misc/freebsd-doc-en</span>
<span class=c># make install clean</span></code></pre></div></div><div class=paragraph><p>Ennek hatására elõáll és telepítõdik a <span class=filename>/usr/local/shared/doc/freebsd</span> könyvtárba az angol nyelvû dokumentáció állományokra bontott HTML formátumban (hasonlóan a <a href=http://www.FreeBSD.org>http://www.FreeBSD.org</a> tartalmához).</p></div><div class=sect5><h6 id=doc-ports-options>24.4.6.1.1. Gyakori beállítások<a class=anchor href=#doc-ports-options></a></h6><div class=paragraph><p>A dokumentációs portok alapértelmezett viselkedése több különbözõ opció segítségével is befolyásolható. Ezek közül most összefoglalunk néhányat:</p></div><div class=dlist><dl><dt class=hdlist1><code>WITH_HTML</code></dt><dd><p>Minden dokumentum egyetlen HTML állományba kerüljön. A végeredmény ekkor az adott dokumentum típusának megfelelõen <span class=filename>article.html</span> (cikk) vagy <span class=filename>book.html</span> (könyv) néven keletkezik (képekkel együtt).</p></dd><dt class=hdlist1><code>WITH_PDF</code></dt><dd><p>Minden dokumentum Adobe® Portable Document Format típusú állományban jön létre. Ezek az állományok a Ghostscript vagy más egyéb PDF nézegetõkkel nyithatóak meg. Ekkor a dokumentáció konkrét típusától függõen az állományok <span class=filename>article.pdf</span> (cikk) vagy <span class=filename>book.pdf</span> (könyv) néven állítódnak elõ.</p></dd><dt class=hdlist1><code>DOCBASE</code></dt><dd><p>A dokumentáció telepítésének helye. Alapértelmezés szerint ez a <span class=filename>/usr/local/shared/doc/freebsd</span> könyvtár.</p><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Ügyeljünk arra, hogy a telepítés alapértelmezett célkönyvtára eltér a CVSup módszerétõl. Ugyanis mivel ilyenkor egy portot telepítünk, a tartalma alapértelmezés szerint a <span class=filename>/usr/local</span> könyvtáron belülre kerül. Ez azonban a <code>PREFIX</code> változó átállításával tetszõleges megváltoztatható.</p></div></td></tr></tbody></table></div></dd></dl></div><div class=paragraph><p>Az elõbbieket most egy rövid példán keresztül összefoglaljuk. A következõ paranccsal tudjuk tehát a magyar nyelvû dokumentáció Portable Document Format változatát telepíteni:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># cd /usr/ports/misc/freebsd-doc-hu</span>
<span class=c># make -DWITH_PDF DOCBASE=share/doc/freebsd/hu install clean</span></code></pre></div></div></div></div><div class=sect4><h5 id=doc-ports-install-package>24.4.6.2. A dokumentációs csomagok használata<a class=anchor href=#doc-ports-install-package></a></h5><div class=paragraph><p>A dokumentációs portok elõzõ szakaszban bemutatott forrásból telepítésével kapcsolatban már említettük, hogy szükséges hozzá a dokumentációs eszközök telepítése, valamint némi szabad tárterület. Ha a dokumentációs eszközök telepítéséhez nem elengedõek a rendelkezésre álló erõforrásaink vagy a források feldolgozása túlságosan sokat foglalna a rendszerünkön, akkor lehetõségünk van a dokumentációs portok elõre lefordított, csomagolt változatát használni.</p></div><div class=paragraph><p>A Documentation Engineering Team &lt;<a href=mailto:doceng@FreeBSD.org>doceng@FreeBSD.org</a>> minden hónapban elõkészíti a FreeBSD dokumentációs csomagok legfrissebb változatát. Az így karbantartott bináris csomagok azután tetszõlegesen használhatóak a szabványos csomagkezelõ eszközökkel, mint amilyen például a <a href="https://man.freebsd.org/cgi/man.cgi?query=pkg_add&amp;sektion=1&amp;format=html">pkg_add(1)</a>, <a href="https://man.freebsd.org/cgi/man.cgi?query=pkg_delete&amp;sektion=1&amp;format=html">pkg_delete(1)</a> és így tovább.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>A bináris csomagok használata esetén a FreeBSD dokumentációja az adott nyelvhez az <em>összes</em> elérhetõ formátumban telepítésre kerül.</p></div></td></tr></tbody></table></div><div class=paragraph><p>Például az alábbi paranccsal a magyar nyelvû dokumentációhoz tartozó legfrissebb bináris csomagot tudjuk telepíteni:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># pkg_add -r hu-freebsd-doc</span></code></pre></div></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>A csomagok elnevezése eltér a hozzá tartozó port nevétõl. Alakja a következõ: <code>nyelv-freebsd-doc</code>, ahol a <em>nyelv</em> az adott nyelv rövid kódja, vagyis a magyar esetén a <code>hu</code>, illetve az egyszerûsített kínai esetén a <code>zh_ch</code>.</p></div></td></tr></tbody></table></div></div><div class=sect4><h5 id=doc-ports-update>24.4.6.3. A dokumentációs portok frissítése<a class=anchor href=#doc-ports-update></a></h5><div class=paragraph><p>Az elõzetesen telepített dokumentációs portok bármilyen portok frissítésére alkalmas eszközzel frissíthetõek. Például a telepített magyar nyelvû dokumentáció a <a class=package href=https://cgit.freebsd.org/ports/tree/ports-mgmt/portupgrade/>ports-mgmt/portupgrade</a> eszközön keresztül így frissíthetõ csomagok használatával:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># portupgrade -PP hu-freebsd-doc</span></code></pre></div></div></div></div></div><div class=sect2><h3 id=current-stable>24.5. A fejlesztõi ág követése<a class=anchor href=#current-stable></a></h3><div class=paragraph><p>A FreeBSD-nek két fejlesztési ága van: a FreeBSD.current és a FreeBSD-STABLE. Ebben a szakaszban mindegyikükrõl monduk pár szót, és megmutatjuk, miként lehet az adott ághoz igazítani a rendszerünk frissítését. Elõször a FreeBSD-CURRENT, majd a FreeBSD-STABLE változata kerül tárgyalásra.</p></div><div class=sect3><h4 id=current>24.5.1. A FreeBSD friss változatának használata<a class=anchor href=#current></a></h4><div class=paragraph><p>Ahogy arról már az imént is szó esett, nem szabad elfelejtenünk, hogy a FreeBSD-CURRENT a FreeBSD fejlesztésének "frontvonala". Emiatt a FreeBSD-CURRENT használóinak szakmailag jólképzetteknek kell lenniük, és sosem szabad visszariadniuk a használat közben felmerülõ rendszerszintû problémák önálló megoldásától. Ha korábban még nem foglalkoztunk FreeBSD-vel, kétszer is gondoljuk meg a telepítését!</p></div><div class=sect4><h5 id=_mi_a_freebsd_current>24.5.1.1. Mi a FreeBSD-CURRENT?<a class=anchor href=#_mi_a_freebsd_current></a></h5><div class=paragraph><p>A FreeBSD-CURRENT a FreeBSD mögött álló legfrissebb forráskódot képviseli. Itt találkozhatunk különféle olyan fejlesztés alatt álló részekkel, kísérletezésekkel és átmeneti megoldásokkal, amelyek nem feltétlenül kerülnek bele a szoftver következõ hivatalos kiadásába. Noha a FreeBSD fejlesztõi a FreeBSD-CURRENT forráskódját naponta fordítják, adódhatnak olyan idõszakok, amikor a források mégsem használhatóak maradéktalanul. Az ilyen gondokat általában a lehetõ leggyorsabban igyekeznek megoldani, azonban attól függõen, hogy éppen a forráskód melyik verzióját sikerült kifogni, a FreeBSD-CURRENT használata kész katasztrófa vagy akár a fejlõdésben igazi továbblépés is lehet.</p></div></div><div class=sect4><h5 id=_kinek_van_szüksége_a_freebsd_current_re>24.5.1.2. Kinek van szüksége a FreeBSD-CURRENT-re?<a class=anchor href=#_kinek_van_szüksége_a_freebsd_current_re></a></h5><div class=paragraph><p>A FreeBSD-CURRENT használata elsõsorban az alábbi 3 csoportot érinti:</p></div><div class="olist arabic"><ol class=arabic><li><p>A FreeBSD közösség azon tagjait, akik aktívan dolgoznak a forrásfa valamelyik részén, és mindazokat, akik számára a "legfrissebb" verzió használata feltétlen elvárás.</p></li><li><p>A FreeBSD közösség azon tagjait, akik aktívan tesztelnek, és a FreeBSD-CURRENT kordában tartásához hajlandóak idõt áldozni a menet közben felbukkanó problémák megoldására. Vannak olyanok is, akik a FreeBSD változásaival és fejlesztési irányával kapcsolatban kívánnak javaslatokat tenni, melyeket javítások és módosítások formájában tesznek közzé.</p></li><li><p>Mindazokat, akik pusztán kíváncsiak a fejlesztésben zajló eseményekre, vagy hivatkozási szándékkal töltik le a legfrissebb forrásokat (például csak <em>nézegetik</em>, de nem futtatják). Az ilyen emberek esetenként megjegyzéseket fûznek a fejlesztéshez vagy kódot küldenek be.</p></li></ol></div></div><div class=sect4><h5 id=_mi_nem_a_freebsd_current>24.5.1.3. Mi <em>nem</em> a FreeBSD-CURRENT?<a class=anchor href=#_mi_nem_a_freebsd_current></a></h5><div class="olist arabic"><ol class=arabic><li><p>Az olyan kiadás elõtt álló funkciók kipróbálásának egyszerû módja, amelyekrõl hallottunk, hogy milyen remek újdonságokat hoznak és mi akarunk lenni az elsõk, akik ezt használni is fogják. Ne feledjük azonban, hogy amikor mindenki elõtt kezdünk el használni egy újítást, mi leszünk egyben az elsõk is, akik szembesülnek a benne rejlõ hibákkal.</p></li><li><p>A gyors hibajavítások eszköze. A FreeBSD-CURRENT szinte bármelyik változata pontosan ugyanakkora valószínûséggel hoz magával új hibákat, mint ahogy eltünteti a régieket.</p></li><li><p>Akármilyen értelemben is "hivatalosan támogatott". Képességeinktõl függõen õszintén igyekszünk a lehetõ legtöbbet megtenni a 3 "törvényes" FreeBSD-CURRENT csoportba tartozó emberekért, azonban egyszerûen <em>nincs idõnk</em> komolyabb segítségnyújtást adni. Ez viszont nem azt jelenti, hogy komisz és fukar emberek vagyunk, akik utálnak segíteni a másiknak (de máskülönben nem tudna fejlõdni a FreeBSD). Csupán a FreeBSD fejlesztése <em>közben</em> fizikailag képtelenek vagyunk a naponta érkezõ ezernyi üzenetet rendre megválaszolni! A FreeBSD elõremozdítása és a kísérleti stádiumban álló kóddal kapcsolatos kérdések megválaszolása közül a fejlesztõk általában az elsõt részesítik elõnyben.</p></li></ol></div></div><div class=sect4><h5 id=_a_freebsd_current_használata>24.5.1.4. A FreeBSD-CURRENT használata<a class=anchor href=#_a_freebsd_current_használata></a></h5><div class="olist arabic"><ol class=arabic><li><p>Iratkozzunk fel az <a href=https://lists.FreeBSD.org/subscription/freebsd-current>FreeBSD-CURRENT levelezési lista</a> és <a href=https://lists.FreeBSD.org/subscription/svn-src-head>Az src fa head/-current ágának SVN commit üzenetei</a> listákra. Ez nem egyszerûen hasznos, hanem <em>elengedhetetlen</em>. Ha nem vagyunk a <em><a href=https://lists.FreeBSD.org/subscription/freebsd-current>FreeBSD-CURRENT levelezési lista</a></em> listán, akkor nem fogjuk látni a rendszer aktuális állapotára vonatkozó megjegyzéseket, és így esetleg feleslegesen öljük az idõnket olyan problémák megoldásába, amelyeket mások már korábban megoldottak. Ami viszont ennél is fontosabb, hogy így elszalasztjuk a rendszerünk folyamatos életbentartására vonatkozó létfontosságú bejelentéseket.</p><div class=paragraph><p>Az <a href=https://lists.FreeBSD.org/subscription/svn-src-head>Az src fa head/-current ágának SVN commit üzenetei</a> listán láthatjuk az a forráskód egyes változtatásaihoz tartozó naplóbejegyzéseket, a hozzájuk tartozó esetleges mellékhatások ismertetésével együtt.</p></div><div class=paragraph><p>A listákra vagy a <a href=https://lists.freebsd.org class=bare>https://lists.freebsd.org</a> oldalon található többi lista valamelyikére úgy tudunk feliratkozni, ha rákattintunk a nevére. A további lépésekrõl ezt követõen itt kapunk értesítést. Amennyiben a teljes forrásfa változásai érdekelnek minket, javasoljuk az <a href=https://lists.FreeBSD.org/subscription/svn-src-all>A teljes src fa SVN commit üzenetei (kivéve "user" és "projects")</a> lista olvasását.</p></div></li><li><p>A <a href=./#mirrors>tükrözések</a> egyikérõl töltsük le a FreeBSD forrását. Erre két mód is kínálkozik:</p><div class="olist loweralpha"><ol class=loweralpha type=a><li><p>Használjuk a <a href=./#cvsup>cvsup</a> programot a <span class=filename>/usr/shared/examples/cvsup</span> könyvtárban található <span class=filename>standard-supfile</span> állománnyal. Ez a leginkább ajánlott módszer, hiszen így csak egyszer kell letölteni az egész gyûjteményt, majd ezután már csak a változásokat. Sokan a <code>cvsup</code> parancsot a <code>cron</code> parancson keresztül adják ki, és ezzel mindig automatikusan frissítik a forrásaikat. A <a href=./#cvsup>cvsup</a> mûködését a fentebb említett minta <span class=filename>supfile</span> állomány megfelelõ módosításával tudjuk a saját környezetünkhöz igazítani.</p><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Az említett <span class=filename>standard-supfile</span> állomány eredetileg nem a FreeBSD-CURRENT, hanem inkább a FreeBSD biztonsági problémáit érintõ javítások követésére használatos. A FreeBSD-CURRENT forrásainak eléréséhez a következõ sort kell kicserélnünk ebben az állományban:</p></div><div class="literalblock programlisting"><div class=content><pre>*default release=cvs tag=RELENG_X_Y</pre></div></div><div class=paragraph><p>Erre:</p></div><div class="literalblock programlisting"><div class=content><pre>*default release=cvs tag=.</pre></div></div><div class=paragraph><p>A <code>tag</code> paramétereként megadható egyéb címkékrõl a kézikönyv <a href=./#cvs-tags>CVS címkék</a> szakaszában olvashatunk.</p></div></td></tr></tbody></table></div></li><li><p>Használjuk a CTM alkalmazás nyújtotta lehetõségeket. Amennyiben nagyon rossz netkapcsolattal rendelkezünk (drága vagy csak levelezésre használható) a CTM megoldást jelenthet számunkra. Legyünk azonban tekintettel arra, hogy helyenként zûrös lehet a használata és néha hibás állományokat gyárt. Emiatt viszont csak ritkán használják, így elõfordulhat, hogy hosszabb ideig nem is mûködik. A 9600 bps vagy annál nagyobb sebességû kapcsolatok esetén ezért inkább a CVSup használatát javasoljuk.</p></li></ol></div></li><li><p>Ha nem csak böngészésre, hanem fordításra is szedjük a forrásokat, mindig töltsük le a FreeBSD-CURRENT <em>egészét</em>, ne csak egyes részeit. Ez azzal magyarázandó, hogy a forráskód bizonyos részei más helyeken található részektõl is függenek, és ezért az önálló fordításuk szinte garantáltan gondot fog okozni.</p><div class=paragraph><p>A FreeBSD-CURRENT lefordítása elõtt figyelmesen olvassuk át a <span class=filename>/usr/src</span> könyvtárban található <span class=filename>Makefile</span> állományt. A frissítési folyamat részeként elõször mindenképpen érdemes <a href=#makeworld>telepíteni egy új rendszermagot és újrafordítani az alaprendszert</a>. Olvassuk el a <a href=https://lists.FreeBSD.org/subscription/freebsd-current>FreeBSD-CURRENT levelezési lista</a> üzeneteit és a <span class=filename>/usr/src/UPDATING</span> állományt, ahol megtalálhatjuk az ezzel kapcsolatos legújabb információkat, melyek egy-egy újabb kiadás közeledtével egyre fontosabbá válnak.</p></div></li><li><p>Foglalkozzunk vele! Ha már a FreeBSD-CURRENT változatát használjuk, ne legyünk restek véleményt formálni róla, különösen abban az esetben, ha továbbfejlesztésekrõl vagy hibákra van szó. Leginkább a forráskóddal együtt érkezõ javaslatoknak szoktak örülni a fejlesztõk!</p></li></ol></div></div></div><div class=sect3><h4 id=stable>24.5.2. A FreeBSD stabil változatának használata<a class=anchor href=#stable></a></h4><div class=sect4><h5 id=_mi_a_freebsd_stable>24.5.2.1. Mi a FreeBSD-STABLE?<a class=anchor href=#_mi_a_freebsd_stable></a></h5><div class=paragraph><p>A FreeBSD-STABLE az a fejlesztési ág, ahonnan az egyes kiadások származnak. Ebbe az ágba már más ütemben kerülnek a változások, mivel általánosan elfogadott, hogy ide a korábban már kipróbált módosítások vándorolnak át a FreeBSD-CURRENT ágból. Ez azonban <em>még mindig</em> csak egy fejlesztési ág, ami arra utal, hogy a FreeBSD-STABLE által adott pillanatban képviselt források nem feltétlenül felelnek meg bizonyos célokra. Ez csupán egy újabb fejlesztési nyomvonal, nem pedig a végfelhasználók kenyere.</p></div></div><div class=sect4><h5 id=_kinek_van_szüksége_a_freebsd_stable_re>24.5.2.2. Kinek van szüksége a FreeBSD-STABLE-re?<a class=anchor href=#_kinek_van_szüksége_a_freebsd_stable_re></a></h5><div class=paragraph><p>Ha szeretnénk figyelemmel kísérni vagy valamilyen módon kiegészíteni a FreeBSD fejlesztési folyamatát, különösen a FreeBSD következõ "nagyobb" kiadását illetõen, akkor érdemes követnünk a FreeBSD-STABLE forrásait.</p></div><div class=paragraph><p>Habár a FreeBSD-STABLE ágba is bekerülnek a biztonsági jellegû javítások, ettõl még nem kell feltétlenül ezt követnünk. A FreeBSD-hez kiadott biztonsági figyelmeztetések mindig leírják, hogyan kell javítani a hibát az érintett kiadásokban , azonban az egész fejlesztési ágat felesleges csak biztonsági okból kifolyólag követni, mivel így olyan változások is kerülhetnek a rendszerbe, amire nincs szükségünk.</p></div><div class=paragraph><p>Habár igyekszünk gondoskodni a FreeBSD-STABLE ágban található források lefordíthatóságáról és mûködõképességérõl, nem minden esetben szavatolható. Ráadásul mivel a FreeBSD-STABLE ágba kerülõ kódokat elõször a FreeBSD-CURRENT ágban fejlesztik ki, és mivel a FreeBSD-STABLE felhasználói többen vannak a FreeBSD-CURRENT változaténál, ezért szinte elkerülhetetlen, hogy ilyenkor a FreeBSD-STABLE változatban bizonyos hibák és szélsõséges esetek be ne következzenek, amelyek a FreeBSD-CURRENT használata során még nem buktak ki.</p></div><div class=paragraph><p>Ezért a FreeBSD-STABLE ág vakon követését senkinek <em>sem</em> ajánljuk, és különösen fontos, hogy éles szervereken elõzetes kimerítõ tesztelések nélkül ne futassunk FreeBSD-STABLE rendszert.</p></div><div class=paragraph><p>Ha ehhez nem rendelkezünk elegendõ erõforrással, akkor egyszerûen használjuk a FreeBSD legfrissebb kiadását, és az egyes kiadások között pedig bináris frissítéssel közlekedjünk.</p></div></div><div class=sect4><h5 id=_a_freebsd_stable_használata>24.5.2.3. A FreeBSD-STABLE használata<a class=anchor href=#_a_freebsd_stable_használata></a></h5><div class="olist arabic"><ol class=arabic><li><p>Iratkozzunk fel a <a href=https://lists.FreeBSD.org/subscription/freebsd-stable>FreeBSD-STABLE; levelezési lista</a> listára. Ezen keresztül értesülhetünk a FreeBSD-STABLE használata során felmerülõ fordítási függõségekrõl vagy más, külön figyelmet igénylõ problémákról. Gyakran ezen a levelezési listán elmélkednek a fejlesztõk a vitatott javításokról vagy frissítésekrõl, amibe a felhasználók is beleszólhatnak, ha a szóbanforgó változtatással kapcsolatban bármilyen problémájuk vagy ötletünk van.</p><div class=paragraph><p>Iratkozzunk fel a követni kívánt ághoz tartozó SVN levelezési listára. Például ha a 7-STABLE ág változásait követjük, akkor az <a href=https://lists.FreeBSD.org/subscription/svn-src-stable-7>svn-src-stable-7</a> listára érdemes feliratkoznunk. Ennek segítségével elolvashatjuk az egyes változtatásokhoz tartozó naplóbejegyzéseket, a rájuk vonatkozó esetleges mellékhatások ismertetésével együtt.</p></div><div class=paragraph><p>Ezekre, valamint a <a href=https://lists.freebsd.org class=bare>https://lists.freebsd.org</a> címen elérhetõ listák valamelyikére úgy tudunk feliratkozni, ha a nevükre kattintunk. A további teendõk ezután itt jelennek meg.</p></div></li><li><p>Amennyiben egy új rendszert akarunk telepíteni és a FreeBSD-STABLE havonta készült pillanatképeit akarjuk rajta futtatni, akkor errõl bõvebb felvilágosítást a <a href=https://www.FreeBSD.org/snapshots/>Pillanatképek</a> honlapján találhatunk (angolul). Emellett a legfrissebb FreeBSD-STABLE kiadást telepíthetjük a <a href=./#mirrors>tükrözések</a> valamelyikérõl is, majd innen a lentebb található utasítások szerint tudunk hozzáférni a FreeBSD-STABLE forráskódjának legfrissebb változatához.</p><div class=paragraph><p>Ha már fut a gépünkön a FreeBSD egy korábbi kiadása, és ezt akarjuk forráson keresztül frissíteni, akkor ezt a FreeBSD <a href=./#mirrors>tükrözéseivel</a> könnyedén megtehetjük. Két módon is:
.. Használjuk a <a href=./#cvsup>cvsup</a> programot a <span class=filename>/usr/shared/examples/cvsup</span> könyvtárból származó <span class=filename>stable-supfile</span> állománnyal. Ez a leginkább ajánlott módszer, mivel így csak egyszer kell letölteni a teljes gyûjteményt, utána már csak a hozzá tartozó változtatásokra van szükségünk. A <code>cvsup</code> parancsot sokan a <code>cron</code> segítségével futtatják, és ezzel automatikusan frissülnek a forrásainak. A <a href=./#cvsup>cvsup</a> mûködését környezetünkhöz az elõbb említett minta <span class=filename>supfile</span> megfelelõ módosításával tudjuk behangolni.
.. Használjuk a CTM programot. Ha nincs olcsó vagy gyors internetkapcsolatunk, akkor érdemes ezt a módszert választani.</p></div></li><li><p>Alapvetõen azonban ha gyorsan szeretnénk hozzájutni a forrásokhoz és a sávszélesség nem meghatározó tényezõ, akkor helyette válasszuk a <code>cvsup</code> vagy az <code>ftp</code> használatát, és csak minden más esetben CTM-et.</p></li><li><p>Mielõtt lefordítanánk a FreeBSD-STABLE változatát, figyelmesen olvassuk át a <span class=filename>/usr/src</span> könyvtárban levõ <span class=filename>Makefile</span> állományt. Az átállási folyamat részeként elõször minden bizonnyal <a href=#makeworld>telepítenünk kell egy új rendszermagot és újra kell fordítanunk az alaprendszert</a>. A <a href=https://lists.FreeBSD.org/subscription/freebsd-stable>FreeBSD-STABLE; levelezési lista</a> valamint a <span class=filename>/usr/src/UPDATING</span> elolvasásából értesülhetünk azokról az egyéb, gyakran nagyon fontos változásokról, melyek elengedhetetlenek lesznek a következõ kiadás használatához.</p></li></ol></div></div></div></div><div class=sect2><h3 id=synching>24.6. A forrás szinkronizálása<a class=anchor href=#synching></a></h3><div class=paragraph><p>Az internet (vagy elektronikus levelek) használatán keresztül számos mód kínálkozik az FreeBSD Projekthez tartozó források frissen tartásához egy adott, vagy éppen az összes területen attól függõen, hogy mik érdekelnek minket. Ehhez elsõsorban az <a href=./#anoncvs>Anonim CVS</a>, <a href=./#cvsup>CVSup</a> és <a href=./#ctm>CTM</a> szolgáltatásokat ajánljuk fel.</p></div><div class="admonitionblock warning"><table><tbody><tr><td class=icon><i class="fa icon-warning" title=Warning></i></td><td class=content><div class=paragraph><p>Habár lehetséges csupán a forrásfa egyes részeit letölteni, a támogatott frissítési eljárás során azonban szükségünk lesz az egész fa szinkronizálására és a rendszerhez tartozó felhasználói programok (vagyis minden olyan program, amely a felhasználói térben fut, ilyeneket találhatunk többek közt a <span class=filename>/bin</span> és <span class=filename>/sbin</span> könyvtárakban) valamint rendszermag újrafordítására is. Ha csak a felhasználói programok forrásait, vagy csak a rendszermagot, esetleg csupán a forrásfa egyes részeit frissítjük, akkor az gondokat okozhat. Az itt elõforduló problémák fordítási hibáktól kezdve rendszerösszeomlásokon keresztül akár adatvesztésbe is torkollhatnak.</p></div></td></tr></tbody></table></div><div class=paragraph><p>Az Anonim CVS és a CVSup alkalmazások ún. <em>lehúzással</em> frissítik a forrásokat. A CVSup használatakor a felhasználó (vagy a <code>cron</code> szkript) meghívja a <code>cvsup</code> programot, amely az állományok aktualizálásához felveszi a kapcsolatot egy máshol megtalálható <code>cvsupd</code> szerverrel. Az így nyert frissítések az adott pillanatig visszemenõleg érkeznek meg, de csak akkor, ha igényeljük ezeket. A frissítést könnyedén le tudjuk szabályozni a számunkra érdekes egyes állományokra és könyvtárakra. A frissítéseket a szerver hozza létre menet közben annak megfelelõen, hogy milyen verziókkal rendelkezünk, és mihez akarunk szinkronizálni. Az Anonim CVS a CVSupnál valamivel egyszerûbb abban a tekintetben, hogy ez a CVS-nek egy olyan kiterjesztése, amely lehetõvé teszi a változtatások közvetlen lehúzását egy távoli CVS tárházból. Miközben a CVSup mindezt sokkal hatékonnyabb valósítja meg, addig az Anonim CVS jóval könnyebben használható.</p></div><div class=paragraph><p>Velük szemben a CTM nem hasonlítja össze interaktívan a saját és a központi szerveren tárolt forrásokat és nem is húzza át ezeket. Ehelyett egy olyan szkriptõl van szó, amely naponta többször megvizsgálja a központi CTM szerveren tárolt állományok a legutóbbi futtatás óta keletkezett változtatásait, majd az észlelt módosulásokat betömöríti, felcímkézi egy sorozatszámmal és (nyomtatható ASCII formátumban) elõkészíti ezeket az e-mailen keresztüli küldésre. Az így létrehozott "CTM delták" megérkezésük után a <a href="https://man.freebsd.org/cgi/man.cgi?query=ctm_rmail&amp;sektion=1&amp;format=html">ctm_rmail(1)</a> segédprogrammal kerülnek feldolgozásra, amely magától visszaalakítja, ellenõrzi és alkalmazza a változtatásokat a forrásfa felhasználó birtokában levõ másolatára. Ez a megoldás hatékonyabb a CVSup használatánál, mert kisebb terhelést jelent a szerverek számára, hiszen a frissítéshez nem a <em>lehúzást</em>, hanem a <em>küldést</em> alkalmazzák.</p></div><div class=paragraph><p>Természetesen minden említett eljárásnak megvannak a maga kompromisszumai. Ha véletlenül kitöröljük a forrásfánk egyes részeit, a CVSup képes ezt észrevenni és helyreállítani a sérült részeket. A CTM ezzel szemben ezt nem végzi el, szóval ha (biztonsági mentés nélkül) letöröljük a forrásainkat, akkor az egész szinkronizálást az elejérõl kell kezdenünk (pontosabban a legfrissebb CVS-es "alapdeltától") és a CTM-mel újraépíteni az egészet, esetleg a Anonim CVS-sel letörölni a hibás adatokat és újraszinkronizálni.</p></div></div><div class=sect2><h3 id=makeworld>24.7. Az alaprendszer újrafordítása<a class=anchor href=#makeworld></a></h3><div class=paragraph><p>Miután sikerült a helyi forrásfánkat a FreeBSD egy nekünk szimpatikus (FreeBSD-STABLE, FreeBSD-CURRENT és így tovább) változatához igazítanunk, elérkezett az idõ, hogy a segítségével újrafordítsuk az egész rendszert.</p></div><div class="admonitionblock warning"><table><tbody><tr><td class=icon><i class="fa icon-warning" title=Warning></i></td><td class=content><div class=title>Készítsünk biztonsági mentést</div><div class=paragraph><p>Nem tudjuk eléggé nyomatékosítani, hogy <em>mielõtt</em> nekikezdenénk, készítsünk egy biztonsági mentést a rendszerünkrõl. Míg az alaprendszer újrafordítása nem túlságosan bonyolult feladat (egészen addig, amíg a megadott utasításokat követjük), saját magunk vagy mások hibájából fakadóan kialakulhatnak olyan helyzetek, amikor a rendszer nem lesz képes elindulni.</p></div><div class=paragraph><p>Mindenképpen gyõzödjünk meg róla, hogy tisztességesen elvégeztük a mentést és akad a kezünk ügyében egy javításra felhasználható rendszerindító floppy vagy CD. Valószínûleg soha nem lesz ténylegesen szükségünk rájuk, azonban jobb félni, mint megijedni!</p></div></td></tr></tbody></table></div><div class="admonitionblock warning"><table><tbody><tr><td class=icon><i class="fa icon-warning" title=Warning></i></td><td class=content><div class=title>Iratkozzunk fel a megfelelõ levelezési listákra</div><div class=paragraph><p>A FreeBSD-STABLE és FreeBSD-CURRENT ágak természetüknél fogva <em>fejlesztés alatt állnak</em>. A FreeBSD fejlesztését is emberek végzik, ezért elõfordulhatnak benne tévedések.</p></div><div class=paragraph><p>Ezek a tévedések gyakran csak ártalmatlan apróságok, amelyek hatására kapunk például egy ismeretlen diagnosztikai hibát. De ezzel szemben létrejöhetnek pusztító erejû hibák is, amelyek hatására a rendszerünk nem lesz képes elindulni, károsodnak az állományrendszerek (vagy még rosszabb).</p></div><div class=paragraph><p>Ha ilyen történik, akkor egy "felszólítást" (egy "heads up" témájú üzenetet) küldenek az érintett változatokhoz tartozó listákra, amelyben igyekeznek kifejteni a probléma természetét és a rendszerre mért hatását. Miután "minden rendbejött", a probléma megoldásáról is küldenek egy értesítést.</p></div><div class=paragraph><p>Ha a <a href=https://lists.FreeBSD.org/subscription/freebsd-stable>FreeBSD-STABLE; levelezési lista</a> vagy a <a href=https://lists.FreeBSD.org/subscription/freebsd-current>FreeBSD-CURRENT levelezési lista</a> olvasása nélkül próbáljuk meg használni a FreeBSD-STABLE és FreeBSD-CURRENT verziókat, akkor csak magunknak keressük a bajt.</p></div></td></tr></tbody></table></div><div class="admonitionblock warning"><table><tbody><tr><td class=icon><i class="fa icon-warning" title=Warning></i></td><td class=content><div class=title>Ne használjuk a <code>make world</code> parancsot</div><div class=paragraph><p>Rengeteg régebben készült dokumentáció erre a feladatra a <code>make world</code> parancs kiadását javasolja. Ennek használatával azonban átlépünk olyan fontos lépéseket, amelyek valójában csak akkor lennének kihagyhatóak, ha pontosan tudjuk mit csinálunk. Ezért az esetek döntõ többségében nem a <code>make world</code> használatára van szükségünk, hanem a most bemutatandó eljárásra.</p></div></td></tr></tbody></table></div><div class=sect3><h4 id=canonical-build>24.7.1. A rendszer frissítése dióhéjban<a class=anchor href=#canonical-build></a></h4><div class=paragraph><p>A frissítés megkezdése elõtt érdemes elolvasnunk a <span class=filename>/usr/src/UPDATING</span> állományt, ahol a letöltött források használatához elvégzendõ elõzetes intézkedésekrõl kaphatunk hírt. Ezután kövessük az alábbiakban körvonalazott módszer egyes lépéseit.</p></div><div class=paragraph><p>Ezek a lépések feltételezik, hogy egy korábbi FreeBSD verziót használunk, tehát a fordító, a rendszermag, az alaprendszer és a konfigurációs állományok valamelyik régebbi változatát. Alaprendszer alatt, amelyet sokszor csak a "world" néven hivatkozunk, a rendszer számára alapvetõ fontosságú binárisokat, programkönyvtárakat és programfejlesztéshez szükséges egyéb állományokat értjük. Maga a fordítóprogram is része ennek, azonban tartalmaz néhány speciális megszorítást.</p></div><div class=paragraph><p>Mindezek mellett továbbá feltételezzük, hogy elõzetesen már valamilyen módon letöltöttük a friss forrásokat. Ha rendszerünkön ezt még nem tettük volna meg, akkor a <a href=#synching>A forrás szinkronizálása</a> segítségével tájékozódhatunk részletesen arról, hogyan tölthetjük le a legfrissebb verziót.</p></div><div class=paragraph><p>A rendszer forráskódon keresztüli frissítése egy kicsivel körülményesebb, mint amennyire elsõre látszik. A FreeBSD fejlesztõk az évek során fontosnak találták, hogy a folyamatosan felszínre bukkanó, elkerülhetetlen függõségek tükrében meglehetõsen drámai módon megváltoztassák az erre javasolt módszert. Ezért a szakasz további részében a pillanatnyilag javasolt frissítési megoldás nyomán fogunk haladni.</p></div><div class=paragraph><p>A sikeres frissítések során az alábbi akadályokkal kell mindenképpen szembenéznünk:</p></div><div class=ulist><ul><li><p>A fordító régebbi változata nem feltétlenül lesz képes lefordítani az új rendszermagot. (Illetve a régebbi fordítóprogramok tartalmazhatnak hibákat.) Ezért az új rendszermagot már a fordító új változatával kell elõállítanunk. Ebbõl következik, hogy az új rendszermag elkészítéséhez elõször a fordítóprogram újabb változatát kell lefordítanunk. Ez viszont nem feltétlenül jelenti azt, hogy az új rendszermag fordítása elõtt az új fordítóprogramot <em>telepítenünk</em> is kellene.</p></li><li><p>Az új alaprendszer esetenként bizonyos új funkciókat igényelhet a rendszermagtól. Ezért a frissebb alaprendszer telepítése elõtt telepítenünk kell a frissebb rendszermagot.</p></li><li><p>Ez az elõbb említett két akadály képzi az okát a következõ bekezdésekben bemutatott <code>buildworld</code>, <code>buildkernel</code>, <code>installkernel</code>, <code>installworld</code> sorozatnak. Természetesen léteznek további egyéb indokok is, amiért még érdemes az itt leírtak szerint frissíteni a rendszerünket. Ezek közül most vegyünk néhány kevésbé nyilvánvalóbbat:</p><div class=ulist><ul><li><p>A régebbi alaprendszer nem minden esetben fog problémamentesen együttmûködni az új rendszermaggal, ezért az alaprendszer újabb változatát szinte azonnal az új rendszermagot követõen kell telepítenünk.</p></li><li><p>Vannak olyan konfigurációs változtatások, amelyeket még az új alaprendszer telepítése elõtt el kell végeznünk, a többi viszont veszélyes lehet a korábbi alaprendszerre. Ezért a konfigurációs állományokat általában két külön lépésben kell frissíteni.</p></li><li><p>A frissítés során nagyrészt csak állományok cserélõdnek el és újabbak érkeznek, a korábbiak nem törlõdnek. Ez bizonyos esetekben azonban gondokat okozhat. Ennek eredményeképpen a frissítés során idõnként elõfordulhat, hogy magunknak kell manuálisan némely megadott állományokat törölnünk. Elképzelhetõ, hogy ezt a jövõben még majd automatizálni fogják.</p></li></ul></div><div class=paragraph><p>Ezek a megfontolások vezettek tehát az ismertetendõ eljárás kialakításához. Ettõl függetlenül adódhatnak olyan helyzetek, amikor további lépéseket is be kell iktatnunk, viszont az itt bemutatott folyamat egy ideje már viszonylag elfogadottnak tekinthetõ:</p></div><div class="olist loweralpha"><ol class=loweralpha type=a><li><p><code>make buildworld</code></p><div class=paragraph><p>Elõször lefordítja az új fordítóprogramot és néhány hozzá tartozó eszközt, majd ennek felhasználásával elkészíti az alaprendszer többi részét. Az eredmény a <span class=filename>/usr/obj</span> könyvtárban keletkezik.</p></div></li><li><p><code>make buildkernel</code></p><div class=paragraph><p>Eltérõen a <a href="https://man.freebsd.org/cgi/man.cgi?query=config&amp;sektion=8&amp;format=html">config(8)</a> és <a href="https://man.freebsd.org/cgi/man.cgi?query=make&amp;sektion=1&amp;format=html">make(1)</a> programok korábban javasolt alkalmazásától, ezzel a paranccsal már a <span class=filename>/usr/obj</span> könyvtárban létrehozott <em>új</em> fordítót használjuk. Ez védelmet nyújt a fordító és rendszermag változatai közti eltérésekbõl fakadó problémák ellen.</p></div></li><li><p><code>make installkernel</code></p><div class=paragraph><p>Telepíti a lemezre az új rendszermagot és a hozzá tartozó modulokat, ezáltal lehetõvé válik a frissített rendszermag betöltése.</p></div></li><li><p>Átváltás egyfelhasználós módba.</p><div class=paragraph><p>Egyfelhasználós módban a minimálisra csökkenthetjük a futó szoftverek frissítésébõl adódó bonyodalmakat. Ezzel együtt minimálissá válik a régi alaprendszer és az új rendszermag eltéréseibõl eredõ problémák elõfordulása is.</p></div></li><li><p><code>mergemaster -p</code></p><div class=paragraph><p>Az új alaprendszer telepítéséhez elvégzi a konfigurációs állományok részérõl szükséges frissítéseket. Például felvesz még nem létezõ csoportokat vagy felhasználókat. Ez gyakran elengedhetetlennek bizonyulhat, mivel ha a rendszer legutóbbi frissítése óta újabb csoportok vagy felhasználók kerültek be az alaprendszerbe, a <code>installworld</code> csak akkor tud hibamentesen lefutni, ha ezek már a futásakor is elérhetõek.</p></div></li><li><p><code>make installworld</code></p><div class=paragraph><p>Átmásolja a <span class=filename>/usr/obj</span> könyvtárból a korábban elkészített új alaprendszert. Lefutása után már mind az új rendszermag és az új alaprendszer a megfelelõ helyén található.</p></div></li><li><p><code>mergemaster</code></p><div class=paragraph><p>Feldolgozzuk a korábbi fázisból fennmaradó konfigurációs állományok frissítését, mivel most már elérhetõ az új alaprendszer.</p></div></li><li><p>A rendszer újraindítása.</p><div class=paragraph><p>Az új rendszermag és az új konfigurációs állományokkal futó alaprendszer használatához teljesen újra kell indítanunk a számítógépünket.</p></div><div class=paragraph><p>Ha a FreeBSD ugyanazon fejlesztési ágán belül frissítjük a rendszerünket, például a 7.0 kiadásról a 7.1 kiadásra, akkor értelemszerûen nem kell az iménti eljárás minden lépését szorosan követni, hiszen nagyon valószínûtlen, hogy komoly eltérések lennének a fordítóprogram, a rendszermag, az alaprendszer és a konfigurációs állományok között. Ilyenkor akár nyugodtan kiadhatjuk a <code>make world</code> parancsot, majd kérhetjük a rendszermag fordítását és telepítését.</p></div><div class=paragraph><p>A fejlesztési ágak közti váltás során azonban könnyen érhetnek minket meglepetések, ha nem a megadottak szerint járunk el.</p></div><div class=paragraph><p>Egyes váltásokhoz (például 4.<em>X</em> és 5.0 között) további lépések megtétele is szükséges lehet (például adott állományok törlése vagy átnevezése még az <code>installworld</code> elõtt). Ilyenkor mindig figyelmesen olvassuk át a <span class=filename>/usr/src/UPDATING</span> állományt, különös tekintettel a végére, mivel gyakran ott adják meg a konkrét verzióváltáshoz szükséges teendõket.</p></div><div class=paragraph><p>A szakaszban összefoglalt lépések egyfajta evolúciós folyamat eredményei, melynek során a fejlesztõk felismerték, hogy nem tökéletesen kivédeni az összes frissítéssel járó problémát. A javasolt eljárás remélhetõleg viszont még sokáig érvényes marad.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>A FreeBSD 3.<em>X</em> vagy annál is korábbi változatok frissítése még ennél is több ügyességet kíván. Ha ilyen verziót akarunk frissíteni, akkor feltétlenül olvassuk el az <span class=filename>UPDATING</span> állományt!</p></div></td></tr></tbody></table></div><div class=paragraph><p>Röviden tehát a FreeBSD forráskódon keresztüli frissítését így foglalhatjuk össze:</p></div></li></ol></div></li></ul></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># cd /usr/src</span>
<span class=c># make buildworld</span>
<span class=c># make buildkernel</span>
<span class=c># make installkernel</span>
<span class=c># shutdown -r now</span></code></pre></div></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Néhány ritka esetben a <code>buildworld</code> lépés elõtt szükségünk lehet a <code>mergemaster -p</code> parancs lefuttatására is. Errõl az <span class=filename>UPDATING</span> állományból tudakozódhatunk. Általában azonban nyugodt szívvel kihagyhatjuk ezt a lépést, kivéve, ha nem egy vagy több fõbb FreeBSD változatot átívelõ frissítést végzünk.</p></div></td></tr></tbody></table></div><div class=paragraph><p>Miután az <code>installkernel</code> sikeresen befejezte a munkáját, indítsuk újra a számítógépet egyfelhasználós módban (a betöltõ parancssorában adjuk ki <code>boot -s</code> parancsot). Itt futtassuk a következõket:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># adjkerntz -i</span>
<span class=c># mount -a -t ufs</span>
<span class=c># mergemaster -p</span>
<span class=c># cd /usr/src</span>
<span class=c># make installworld</span>
<span class=c># mergemaster</span>
<span class=c># reboot</span></code></pre></div></div><div class="admonitionblock warning"><table><tbody><tr><td class=icon><i class="fa icon-warning" title=Warning></i></td><td class=content><div class=title>Olvassuk el a magyarázatokat</div><div class=paragraph><p>Az iménti leírt folyamat csupán rövid összefoglalás, amivel némi gyorstalpalást igyekeztünk adni. Az egyes lépések megértéséhez azonban javasolt átolvasni a most következõ szakaszokat is, különösen abban az esetben, ha saját rendszermagot akarunk használni.</p></div></td></tr></tbody></table></div></div><div class=sect3><h4 id=src-updating>24.7.2. Nézzük meg a <span class=filename>/usr/src/UPDATING</span> állományt<a class=anchor href=#src-updating></a></h4><div class=paragraph><p>Mielõtt bármihez is nekifognánk, keressük meg a <span class=filename>/usr/src/UPDATING</span> (vagy hasonló, a forráskód másolatunk tényleges helyétõl függõ) állományt. Ebben adják hírül az esetlegesen felmerülõ problémákra vonatkozó fontosabb információkat, vagy határozzák meg az egyes lefuttatandó parancsok pontos sorrendjét. Amennyiben az <span class=filename>UPDATING</span> ellentmondana az itt olvasottaknak, az <span class=filename>UPDATING</span> tartalma a mérvadó.</p></div><div class="admonitionblock important"><table><tbody><tr><td class=icon><i class="fa icon-important" title=Important></i></td><td class=content><div class=paragraph><p>A korábban tárgyaltak szerint az <span class=filename>UPDATING</span> elolvasása nem helyettesíti a megfelelõ levelezési listák figyelemmel kísérését. Ez a két elvárás nem kizárja, hanem kiegészíti egymást.</p></div></td></tr></tbody></table></div></div><div class=sect3><h4 id=make-conf>24.7.3. Ellenõrizzük az <span class=filename>/etc/make.conf</span> állományt<a class=anchor href=#make-conf></a></h4><div class=paragraph><p>Vizsgáljuk át a <span class=filename>/usr/shared/examples/etc/make.conf</span> és az <span class=filename>/etc/make.conf</span> állományokat. Az elõbbi tartalmaz néhány alapértelmezett beállítást - ezek javarészét megjegyzésbe rakták. Ha használni akarjuk a rendszer lefordítása során, tegyük bele ezeket az <span class=filename>/etc/make.conf</span> állományba. Ne felejtsük el azonban, hogy minden, amit megadunk az <span class=filename>/etc/make.conf</span> állományba, a <code>make</code> minden egyes elindításakor felhasználásra kerül. Éppen ezért olyanokat érdemes itt beállítani, amik az egész rendszerünket érintik.</p></div><div class=paragraph><p>A legtöbb felhasználó számára az <span class=filename>/etc/make.conf</span> állományhoz a <span class=filename>/usr/shared/examples/etc/make.conf</span> állományban található <code>CFLAGS</code> és <code>NO_PROFILE</code> sorokra lesz szüksége, melyeket kivehetünk a megjegyzésbõl.</p></div><div class=paragraph><p>A többi definíció (<code>COPTFLAGS</code>, <code>NOPORTDOCS</code> és így tovább) használatáról már mindenki maga dönt.</p></div></div><div class=sect3><h4 id=updating-etc>24.7.4. Frissítsük az <span class=filename>/etc</span> tartalmát<a class=anchor href=#updating-etc></a></h4><div class=paragraph><p>Az <span class=filename>/etc</span> könyvtár tartalmazza a rendszer beállításaival kapcsolatos információk jelentõs részét, valamint a rendszer indítása során lefutó szkripteket. Egyes szkriptek a FreeBSD verzióiról verzióira változnak.</p></div><div class=paragraph><p>Némely konfigurációs állományok a rendszer hétköznapi mûködésében is szerepet játszanak. Ilyen például az <span class=filename>/etc/group</span>.</p></div><div class=paragraph><p>Alkalmanként a <code>make installworld</code> parancs futása során igényt tart adott nevû felhasználókra és csoportokra. A frissítéskor azonban ezek a felhasználók vagy csoportok nem feltétlenül állnak rendelkezésre, ami gondokat okozhat. Ezért bizonyos esetekben a <code>make buildworld</code> elõzetesen ellenõrzi az igényelt felhasználók és csoportok meglétét.</p></div><div class=paragraph><p>Erre például szolgálhat a <code>smmsp</code> felhasználó esete. Nélküle a felhasználók nem tudták telepíteni az új rendszert, mert hiányában az <a href="https://man.freebsd.org/cgi/man.cgi?query=mtree&amp;sektion=8&amp;format=html">mtree(8)</a> nem volt képes létrehozni a <span class=filename>/var/spool/clientmqueue</span> könyvtárat.</p></div><div class=paragraph><p>Ezt úgy lehetett megoldani, hogy még az alaprendszer lefordítása (a <code>buildworld</code>) elõtt meg kellett hívni a <a href="https://man.freebsd.org/cgi/man.cgi?query=mergemaster&amp;sektion=8&amp;format=html">mergemaster(8)</a> parancsot a <code>-p</code> paraméterrel. Így csak azokat az állományokat fogja összehasonlítani, amelyek feltétlenül szükségesek a <code>buildworld</code> vagy az <code>installworld</code> sikeres mûködéséhez. Amennyiben a <code>mergemaster</code> egy olyan verziójával rendelkezünk, amely nem ismeri a <code>-p</code> paramétert, akkor az elsõ indításakor használjuk a forrásfában található újabb verzióját:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># cd /usr/src/usr.sbin/mergemaster</span>
<span class=c># ./mergemaster.sh -p</span></code></pre></div></div><div class="admonitionblock tip"><table><tbody><tr><td class=icon><i class="fa icon-tip" title=Tip></i></td><td class=content><div class=paragraph><p>Ha különösen paranoiásak vagyunk, akkor a csoport törlése vagy átnevezése elõtt az alábbi paranccsal ellenõrizni tudjuk az általa birtokolt állományokat:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># find / -group GID -print</span></code></pre></div></div><div class=paragraph><p>Ez megmutatja <em>GID</em> (mely megadható numerikus vagy név formájában is) jelzésû csoporthoz tartozó összes állományt a rendszerünkben.</p></div></td></tr></tbody></table></div></div><div class=sect3><h4 id=makeworld-singleuser>24.7.5. Váltsunk egyfelhasználós módba<a class=anchor href=#makeworld-singleuser></a></h4><div class=paragraph><p>A rendszert egyfelhasználós módban érdemes lefordítani. A nyilvánvalóan érezhetõ gyorsaság elõnyei mellett azért is jobban járunk, mert az új rendszer telepítése során számos rendszerszintû állomány is módosításra kerül, beleértve a szabványos rendszerszintû binárisokat, függvénykönyvtárakat, include állományokat és így tovább. Ha üzemelõ rendszeren végezzük el mindezen változtatásokat (különösen amikor rajtunk kívül még további felhasználók is tartózkodnak a rendszerben), az csak a bajt hozza ránk.</p></div><div class=paragraph><p>Másik lehetõség gyanánt a rendszert magát lefordíthatjuk többfelhasználós módban is, majd ezután csak a telepítést hajtjuk végre egyfelhasználós üzemmódban. Ha eszerint cselekszünk, egyszerûen várjunk addig, amíg az összes fordítás be nem fejezõdik, és az egyfelhasználósra váltást halasszuk a <code>installkernel</code> vagy <code>installworld</code> idejére.</p></div><div class=paragraph><p>Egy mûködõ rendszerben rendszeradminisztrátorként az alábbi parancs kiadásával válthatunk át egyfelhasználós módba:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># shutdown now</span></code></pre></div></div><div class=paragraph><p>Ezt elérhetjük úgy is, ha újraindítjuk a rendszert és a rendszer indításakor a "single user" pontot választjuk a menübõl. Ekkor a rendszer egyfelhasználós módban indul el. Miután ez megtörtént, adjuk ki a következõ parancsokat:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># fsck -p</span>
<span class=c># mount -u /</span>
<span class=c># mount -a -t ufs</span>
<span class=c># swapon -a</span></code></pre></div></div><div class=paragraph><p>Ezekkel a parancsokkal elõször ellenõrizzük az állományrendszereket, ezután újracsatlakoztatjuk a <span class=filename>/</span> állományrendszert írható módban, csatlakoztatjuk az <span class=filename>/etc/fstab</span> állományban megadott összes többi UFS típusú állományrendszert, majd bekapcsoljuk a lapozóállomány használatát.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Ha a gépünk óráját nem a greenwich-i, hanem a helyi idõ szerint állítottuk be (ez akkor áll fenn, ha a <a href="https://man.freebsd.org/cgi/man.cgi?query=date&amp;sektion=1&amp;format=html">date(1)</a> parancs nem a helyes idõt és idõzónát jelzi ki), akkor még erre is szükségünk lehet:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># adjkerntz -i</span></code></pre></div></div><div class=paragraph><p>Ezzel a helyi idõzóna beállításait tudjuk jól beállítani - nélküle késõbb még gondjaink akadhatnak.</p></div></td></tr></tbody></table></div></div><div class=sect3><h4 id=cleaning-usr-obj>24.7.6. Töröljük a <span class=filename>/usr/obj</span> könyvtárat<a class=anchor href=#cleaning-usr-obj></a></h4><div class=paragraph><p>A rendszer egyes részei fordításuk során a <span class=filename>/usr/obj</span> könyvtáron belülre kerülnek (alapértelmezés szerint). Az itt található könyvtárak a <span class=filename>/usr/src</span> könyvtárszerkezetét követik.</p></div><div class=paragraph><p>Ha mindenestõl töröljük ezt a könyvtárat, akkor növeli tudjuk a <code>make buildworld</code> folyamat sebességét és megmenekülünk néhány függõségekkel kapcsolatos fejfájástól is.</p></div><div class=paragraph><p>Egyes <span class=filename>/usr/obj</span> könyvtáron belüli állományoknál szerepelhet a "megváltoztathatatlan" (immutable) állományjelzõ (lásd <a href="https://man.freebsd.org/cgi/man.cgi?query=chflags&amp;sektion=1&amp;format=html">chflags(1)</a>), amelyet a mûvelet elvégzéséhez elõször el kell távolítanunk.</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># cd /usr/obj</span>
<span class=c># chflags -R noschg *</span>
<span class=c># rm -rf *</span></code></pre></div></div></div><div class=sect3><h4 id=updating-upgrading-compilebase>24.7.7. Fordítsuk újra az alaprendszert<a class=anchor href=#updating-upgrading-compilebase></a></h4><div class=sect4><h5 id=_a_kimenet_elmentése>24.7.7.1. A kimenet elmentése<a class=anchor href=#_a_kimenet_elmentése></a></h5><div class=paragraph><p>Jól járunk azzal, ha a <a href="https://man.freebsd.org/cgi/man.cgi?query=make&amp;sektion=1&amp;format=html">make(1)</a> futásának kimenetét elmentjük egy állományba, mivel így a hibák esetén lesz egy másolatunk a hibaüzenetrõl. Ha konkrétan nekünk nem is feltétlenül segít megtalálni a hiba tényleges okát, mások viszont többet tudnak róla mondani, ha beküldjük ezt a FreeBSD egyik levelezési listájára.</p></div><div class=paragraph><p>Ezt egyébként a legegyszerûbben a <a href="https://man.freebsd.org/cgi/man.cgi?query=script&amp;sektion=1&amp;format=html">script(1)</a> parancs segítségével oldhatjuk meg, amelynek paraméteréül azt az állományt kell megadni, ahova menteni akarjuk a kimenetet. Ezt közvetlenül a rendszer újrafordítása elõtt kell kiadnunk, majd miután megállt, a <code>exit</code> paranccsal kiléphetünk belõle.</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># script /var/tmp/mw.out</span>
Script started, output file is /var/tmp/mw.out
<span class=c># make TARGET</span>
... fordít, fordít, fordít ...
<span class=c># exit</span>
Script <span class=k>done</span>, ...</code></pre></div></div><div class=paragraph><p>Ilyenkor <em>soha ne</em> a <span class=filename>/tmp</span> könyvtárba mentsük a kimenetet, mert ennek a tartalma a következõ indítás során magától törlõdik. Sokkal jobban tesszük, ha a <span class=filename>/var/tmp</span> könyvtárba (ahogy tettük azt az elõbbi példában is) vagy a <code>root</code> felhasználó könyvtárába mentünk.</p></div></div><div class=sect4><h5 id=make-buildworld>24.7.7.2. Az alaprendszer fordítása<a class=anchor href=#make-buildworld></a></h5><div class=paragraph><p>A <span class=filename>/usr/src</span> könyvtárban kell állnunk:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># cd /usr/src</span></code></pre></div></div><div class=paragraph><p>(kivéve természetesen, ha máshol van a forráskód, akkor abba a könyvtárba menjünk).</p></div><div class=paragraph><p>Az alaprendszert a <a href="https://man.freebsd.org/cgi/man.cgi?query=make&amp;sektion=1&amp;format=html">make(1)</a> paranccsal fordíthatjuk újra. Ez a <span class=filename>Makefile</span> nevû állományból olvassa be a FreeBSD programjainak újrafordítását leíró utasításokat, a fordításuk sorrendjét és így tovább.</p></div><div class=paragraph><p>A begépelendõ paranccsor általános alakja tehát a következõképpen néz ki:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># make -x -DVÁLTOZÓ target</span></code></pre></div></div><div class=paragraph><p>A fenti példában a <code>-<em>x</em></code> egy olyan a paraméter, amelyet a <a href="https://man.freebsd.org/cgi/man.cgi?query=make&amp;sektion=1&amp;format=html">make(1)</a> programnak adunk át. A <a href="https://man.freebsd.org/cgi/man.cgi?query=make&amp;sektion=1&amp;format=html">make(1)</a> man oldalán megtalálhatjuk az összes neki átadható ilyen beállítást.</p></div><div class=paragraph><p>A <code>-D_VÁLTOZÓ_</code> alakú paraméterek közvetlenül a <span class=filename>Makefile</span> állománynak adnak át olyan változókat, amelyek segítségével vezérelhetõ a viselkedése. Ezek ugyanazok a változók, mint amelyek az <span class=filename>/etc/make.conf</span> állományban is szerepelnek, és itt a beállításuk egy másik módját kapjuk. Így a</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># make -DNO_PROFILE target</span></code></pre></div></div><div class=paragraph><p>paranccsal is megadhatjuk, hogy ne profilozott függkönyvtárak jöjjenek létre, ami pontosan megfelel a</p></div><div class="literalblock programlisting"><div class=content><pre>NO_PROFILE=    true 	#    Avoid compiling profiled libraries</pre></div></div><div class=paragraph><p>sornak az <span class=filename>/etc/make.conf</span> állományban.</p></div><div class=paragraph><p>A <em>target</em> árulja el a <a href="https://man.freebsd.org/cgi/man.cgi?query=make&amp;sektion=1&amp;format=html">make(1)</a> programnak, hogy mi a teendõje. Minden egyes <span class=filename>Makefile</span> különbözõ "targeteket" definiál, és a kiválasztott target mondja meg, pontosan mi is fog történni.</p></div><div class=paragraph><p>Egyes targetek ugyan megjelennek a <span class=filename>Makefile</span> állományban, azonban nem feltétlenül hivatkozhatunk rájuk közvetlenül. Ehelyett csupán arra valók, hogy a fordítás folyamatának lépéseit felbontsák még kisebb allépésekre.</p></div><div class=paragraph><p>A legtöbb esetben azonban semmilyen paramétert nem kell átadnunk a <a href="https://man.freebsd.org/cgi/man.cgi?query=make&amp;sektion=1&amp;format=html">make(1)</a> parancsnak, ezért a teljes formája így fog kinézni:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># make target</span></code></pre></div></div><div class=paragraph><p>ahol a <em>target</em> az egyik fordítási lehetõséget képviseli. Az elsõ ilyen targetnek mindig a <code>buildworld</code>-nek kell lennie.</p></div><div class=paragraph><p>Ahogy a neve is mutatja, a <code>buildworld</code> lefordítja az összes forrást a <span class=filename>/usr/obj</span> könyvtárba, majd a <code>installworld</code> mint másik target, telepíti az így létrehozott elemeket a számítógépre.</p></div><div class=paragraph><p>A targetek szétválasztása két okból is elõnyös. Elõször is lehetõvé teszi, hogy az új rendszert biztonságban lefordíthassuk, miközben az a jelenleg futó rendszert nem zavarja. A rendszer tehát képes "saját magát újrafordítani". Emiatt a <code>buildworld</code> target akár többfelhasználós módban is mindenféle nem kívánatos hatás nélkül használható. Ennek ellenére azonban továbbra is azt javasoljuk, hogy a <code>installworld</code> részt egyfelhasználós módban futtassuk le.</p></div><div class=paragraph><p>Másodrészt ezzel lehetõségünk nyílik NFS állományrendszer alkalmazásával több számítógépre is telepíteni hálózaton keresztül. Ha például három frissítendõ számítógépünk van, az <code>A</code>, <code>B</code> és <code>C</code>, akkor az <code>A</code> gépen elõször adjuk ki a <code>make buildworld</code>, majd a <code>make installworld</code> parancsot. A <code>B</code> és <code>C</code> gépek ezután NFS segítségével csatlakoztatják az <code>A</code><span class=filename>/usr/src</span> és <span class=filename>/usr/obj</span> könyvtárait, amelyet követõen a <code>make installworld</code> paranccsal telepíteni tudjuk a fordítás eredményét a <code>B</code> és <code>C</code> gépekre.</p></div><div class=paragraph><p>Noha a <code>world</code> mint target még mindig létezik, használata határozottan ellenjavalt.</p></div><div class=paragraph><p>A</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># make buildworld</span></code></pre></div></div><div class=paragraph><p>parancs kiadásakor a <code>make</code> parancsnak megadható egy <code>-j</code> paraméter is, amellyel párhuzamosíthatjuk a folyamat egyes részeit. Ez általában többprocesszoros számítógépeken nyer értelmet, azonban mivel a fordítás folyamatának haladását inkább az állománymûveletek mintsem a processzor sebessége korlátozza, ezért alkalmazható akár egyprocesszoros gépeken is.</p></div><div class=paragraph><p>Tehát egy átlagos egyprocesszoros gépen így adható ki a parancs:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># make -j4 buildworld</span></code></pre></div></div><div class=paragraph><p>Ennek hatására <a href="https://man.freebsd.org/cgi/man.cgi?query=make&amp;sektion=1&amp;format=html">make(1)</a> egyszerre 4 szálon igyekszik mûködni. A levelezési listákra beküldött tapasztalati jellegû bizonyítékok azt igazolják, hogy általában ez a beállítás adja a legjobb teljesítményt.</p></div><div class=paragraph><p>Ha többprocesszoros géppel rendelkezünk és rajta SMP támogatású rendszermagot indítottunk el, akkor érdemes 6 és 10 közötti értékekkel kísérleteznünk.</p></div></div><div class=sect4><h5 id=_idõigény>24.7.7.3. Idõigény<a class=anchor href=#_idõigény></a></h5><div class=paragraph><p>Számos tényezõ befolyásolja a fordítás tényleges idõbeli hosszát, de a FreeBSD-STABLE fa lefordítása mindenféle trükkök és rövidítések nélkül a legtöbb számítógépen olyan egy vagy két órára taksálható. A FreeBSD-CURRENT fához ennél valamivel több idõre lesz szükségünk.</p></div></div></div><div class=sect3><h4 id=new-kernel>24.7.8. Fordítsunk és telepítsünk egy új rendszermagot<a class=anchor href=#new-kernel></a></h4><div class=paragraph><p>Az újdonsült rendszerünket csak akkor tudjuk igazán kihasználni, ha egy új rendszermagot is készítünk hozzá. Ez gyakorlati szinten tulajdonképpen elvárás, mivel könnyen elõfordulhat, hogy bizonyos memóriabeli adatszerkezetek felépítése megváltozott, ezért némely programok, mint például a <a href="https://man.freebsd.org/cgi/man.cgi?query=ps&amp;sektion=1&amp;format=html">ps(1)</a> és <a href="https://man.freebsd.org/cgi/man.cgi?query=top&amp;sektion=1&amp;format=html">top(1)</a>, egészen addig nem lesznek képesek normálisan mûködni, amíg a rendszer és a rendszermag forráskódja nem illeszkedik egymáshoz.</p></div><div class=paragraph><p>Ennek legegyszerûbb és egyben legbiztonságosabb módja, ha a <span class=filename>GENERIC</span> beállításai alapján gyártunk és telepítünk egy rendszermagot. Még ha a <span class=filename>GENERIC</span> beállításai nem is tartalmazzák a rendszerünkben fellelhetõ összes eszközt, minden megtalálható bennük ahhoz, hogy a rendszert sikeresen elindíthassuk legalább egyfelhasználós módban. Ez mellesleg remek próbája az új rendszer életképességének. Miután elindítottuk a rendszert a <span class=filename>GENERIC</span> típusú rendszermaggal és meggyõzõdtünk róla, hogy a rendszer tényleg mûködõképes, a megszokott rendszermagunk konfigurációs állománya alapján nyugodtan elkészíthetjük ezután azt is.</p></div><div class=paragraph><p>FreeBSD alatt egy új rendszermag építése elõtt fontos <a href=#make-buildworld>újrafordítani az alaprendszert</a>.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Ha saját beállításaink szerint akarunk rendszermagot létrehozni és már van is ehhez egy konfigurációs állományunk, akkor erre használhatjuk a <code>KERNCONF=SAJÁTMAG</code> paramétert is, valahogy így:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># cd /usr/src</span>
<span class=c># make buildkernel KERNCONF=SAJÁTMAG</span>
<span class=c># make installkernel KERNCONF=SAJÁTMAG</span></code></pre></div></div></td></tr></tbody></table></div><div class=paragraph><p>Hozzátennénk, hogy ha a <code>kern.securelevel</code> rendszerváltozó értékét 1 felé állítottuk <em>és</em> a rendszermag állományának beállítottunk <code>noschg</code> vagy hozzá hasonló állományjelzõt, akkor az <code>installkernel</code> lefuttatásához mindenképpen egyfelhasználós módba kell váltanunk. Minden más esetben további bonyodalmak nélkül ki tudjuk adni az említett parancsokat. A <code>kern.securelevel</code> részleteirõl az <a href="https://man.freebsd.org/cgi/man.cgi?query=init&amp;sektion=8&amp;format=html">init(8)</a> oldalán, a különbözõ állományjelzõkrõl pedig a <a href="https://man.freebsd.org/cgi/man.cgi?query=chflags&amp;sektion=1&amp;format=html">chflags(1)</a> oldalán olvashatunk.</p></div></div><div class=sect3><h4 id=new-kernel-singleuser>24.7.9. Indítsuk újra a rendszert egyfelhasználós módban<a class=anchor href=#new-kernel-singleuser></a></h4><div class=paragraph><p>Az új rendszermag mûködésének leteszteléséhez indítsuk újra a rendszert egyfelhasználós módban. Ennek pontos részleteit lásd <a href=#makeworld-singleuser>Váltsunk egyfelhasználós módba</a>.</p></div></div><div class=sect3><h4 id=make-installworld>24.7.10. Telepítsük az új rendszer binárisait<a class=anchor href=#make-installworld></a></h4><div class=paragraph><p>Ha a FreeBSD friss változatát nemrég fordítottuk le a <code>make buildworld</code> paranccsal, akkor utána az <code>installworld</code> segítségével tudjuk telepíteni a keletkezett programokat.</p></div><div class=paragraph><p>Tehát írjuk be ezeket:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># cd /usr/src</span>
<span class=c># make installworld</span></code></pre></div></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Amennyiben a paranccsorban a <code>make buildworld</code> használata során adtunk meg változókat, akkor ne felejtsük el ugyanazokat megadni a <code>make installworld</code> kiadása során sem. Ez viszont a többi paraméterre már nem feltétlenül érvényes. Például a <code>-j</code> beállítást szigorúan tilos az <code>installworld</code> targettel együtt használni.</p></div><div class=paragraph><p>Ennek megfelelõen tehát ha korábban ezt írtuk be:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># make -DNO_PROFILE buildworld</span></code></pre></div></div><div class=paragraph><p>akkor így telepítsünk:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># make -DNO_PROFILE installworld</span></code></pre></div></div><div class=paragraph><p>Máskülönben azokat a profilozott függvénykönyvtárakat próbáljuk meg telepíteni, amelyek a <code>make buildworld</code> futása során nem jöttek létre.</p></div></td></tr></tbody></table></div></div><div class=sect3><h4 id=post-installworld-updates>24.7.11. Frissítsük a <code>make installworld</code> által kihagyott állományokat<a class=anchor href=#post-installworld-updates></a></h4><div class=paragraph><p>Az alaprendszer újrafordítása nem regisztrálja az új vagy megváltozott állományokat bizonyos könyvtárakban (különösen értendõ ez az <span class=filename>/etc</span>, <span class=filename>/var</span> és <span class=filename>/usr</span> esetén).</p></div><div class=paragraph><p>Az ilyen állományokat a legegyszerûbben a <a href="https://man.freebsd.org/cgi/man.cgi?query=mergemaster&amp;sektion=8&amp;format=html">mergemaster(8)</a> használatával tarthatjuk karban, de igény szerint akár kézzel is elvégezhetjük a szükséges aktualizálásokat. Függetlenül attól, hogy mit is választunk, mindenképpen készítsünk biztonsági mentést az <span class=filename>/etc</span> könyvtárról arra az esetre, ha bármilyen szörnyûség történne.</p></div><div class=sect4><h5 id=mergemaster>24.7.11.1. A <code>mergemaster</code><a class=anchor href=#mergemaster></a></h5><div class=paragraph><p>A <a href="https://man.freebsd.org/cgi/man.cgi?query=mergemaster&amp;sektion=8&amp;format=html">mergemaster(8)</a> segédprogram valójában egy Bourne szkript, amely segít az <span class=filename>/etc</span> könyvtárunkban és a forrásfában levõ <span class=filename>/usr/src/etc</span> könyvtárban elhelyezkedõ konfigurációs állományok közti eltérések megállapításában. Ezt a módszert ajánljuk arra, hogy összevessük a konfigurációs állományainkat a forrásfában található változataikkal.</p></div><div class=paragraph><p>A használatának megkezdéséhez egyszerûen írjuk be, hogy <code>mergemaster</code>, majd várjunk egy kicsit, amíg a <code>mergemaster</code> létrehoz magának egy átmeneti környezetet a <span class=filename>/</span> könyvtárból elindulva és megtölti azt a különbözõ rendszerszintû beállításokat tartalmazó állományokkal. Ezeket az állományokat aztán összehasonlítja a jelenleg érvényben levõ változataikkal. Ilyenkor a köztük talált eltéréseket a <a href="https://man.freebsd.org/cgi/man.cgi?query=diff&amp;sektion=1&amp;format=html">diff(1)</a> formátumának megfelelõen módon mutatja meg, ahol a <code>+</code> jelöli a hozzáadott vagy módosított sorokat, a <code>-</code> pedig a teljesen eltávolítandó vagy cserélendõ sorokat. Errõl a formátumról bõvebben a <a href="https://man.freebsd.org/cgi/man.cgi?query=diff&amp;sektion=1&amp;format=html">diff(1)</a> man oldalán találhatunk felvilágosítást.</p></div><div class=paragraph><p>A <a href="https://man.freebsd.org/cgi/man.cgi?query=mergemaster&amp;sektion=8&amp;format=html">mergemaster(8)</a> ezt követõen megmutatja az összes olyan állományt, ahol eltérést tapasztalt, és ezen a ponton van lehetõségünk letörölni (delete) az új állományokat (amelyekre itt most ideiglenes állományként hivatkozik), telepíteni (install) a módosítatlan ideiglenes (új) állományt, valamint összefésülni (merge) az ideiglenes (új) és a jelenlegi állományokat, vagy ismét átnézni (view) a <a href="https://man.freebsd.org/cgi/man.cgi?query=diff&amp;sektion=1&amp;format=html">diff(1)</a> által jelzett különbségeket.</p></div><div class=paragraph><p>Ha az ideiglenes állomány törlését választjuk, akkor a <a href="https://man.freebsd.org/cgi/man.cgi?query=mergemaster&amp;sektion=8&amp;format=html">mergemaster(8)</a> ezt úgy értelmezi, hogy változatlanul meg akarjuk tartani a jelenlegi változatot és törölni az újat. Ezt alapvetõen nem javasoljuk, hacsak tényleg nem látunk valamilyen okot erre. A <a href="https://man.freebsd.org/cgi/man.cgi?query=mergemaster&amp;sektion=8&amp;format=html">mergemaster(8)</a> parancssorában a <kbd>?</kbd> begépelésével bármikor kérhetünk segítséget. Ha az állomány kihagyását (skip) választjuk, akkor majd ismét felajánlja, amikor végeztünk az összes többivel.</p></div><div class=paragraph><p>A módosítatlan ideiglenes állomány telepítésének választásával lecseréljük a jelenleg verziót az újra. Ha az aktuális verziót sem változtattuk meg, akkor számunkra ez a legjobb megoldás.</p></div><div class=paragraph><p>Az állományok összefésülésének kiválasztásakor kapunk egy szövegszerkesztõt, benne a két állomány tartalmával. Ilyenkor tudjuk a képernyõn soronként egyeztetni a két állományt, majd a belõlük a megfelelõ részek összeválogatásával kialakítani az eredményt. Ebben a feldolgozási módban az <kbd>l</kbd> (mint left, vagyis bal) billentyû lenyomására a bal oldalon látható részt, az <kbd>r</kbd> (mint right, vagyis jobb) lenyomására pedig a jobb oldalon látható részt választjuk ki. Az így keletkezõ eredményt ezután egy állományba kerül, amelyet telepíteni tudunk. Ez a megoldás olyan állományok esetében használható, amikor a felhasználó módosított az alapértelmezett beállításokat.</p></div><div class=paragraph><p>Ha a <a href="https://man.freebsd.org/cgi/man.cgi?query=diff&amp;sektion=1&amp;format=html">diff(1)</a> szerinti alakban akarjuk átnézni a különbségeket, akkor a <a href="https://man.freebsd.org/cgi/man.cgi?query=mergemaster&amp;sektion=8&amp;format=html">mergemaster(8)</a> ugyanúgy megmutatja ezeket, mint a paranccsor megjelenítése elõtt.</p></div><div class=paragraph><p>Miután a <a href="https://man.freebsd.org/cgi/man.cgi?query=mergemaster&amp;sektion=8&amp;format=html">mergemaster(8)</a> végigment a rendszerszintû állományokon, további opciókat mutat. Megkérdezheti, hogy újra létre akarjuk-e hozni a jelszavakat tároló állományt (rebuild), illetve a folyamat végén a megmaradt ideiglenes állományok törlésére (remove) vár választ.</p></div></div><div class=sect4><h5 id=_az_állományok_aktualizálása_kézzel>24.7.11.2. Az állományok aktualizálása kézzel<a class=anchor href=#_az_állományok_aktualizálása_kézzel></a></h5><div class=paragraph><p>Ha inkább manuálisan szeretnénk frissíteni, akkor nem másolhatjuk csak egyszerûen át az állományokat a <span class=filename>/usr/src/etc</span> könyvtárból a <span class=filename>/etc</span> könyvtárba és nem hagyhatjuk ezeket sorsukra. Egyes állományokat elõször "telepíteni" kell. Ez azért van így, mert a <span class=filename>/usr/src/etc</span> könyvtár <em>nem pusztán</em> az <span class=filename>/etc</span> könyvtár egyszerû másolata. Ráadásul az <span class=filename>/etc</span> könyvtárban vannak olyan állományok, amelyek a <span class=filename>/usr/src/etc</span> könyvtárban nem is találhatóak meg.</p></div><div class=paragraph><p>Ha (az ajánlottak szerint) a <a href="https://man.freebsd.org/cgi/man.cgi?query=mergemaster&amp;sektion=8&amp;format=html">mergemaster(8)</a> segítségével dolgozunk, nyugodtan átléphetünk a <a href=#updating-upgrading-rebooting>következõ szakaszra</a>.</p></div><div class=paragraph><p>Saját magunk a legegyszerûbben ezt úgy tudjuk megoldani, ha telepítjük az állományokat egy új könyvtárba és ezután nekiállunk változásokat keresni.</p></div><div class="admonitionblock warning"><table><tbody><tr><td class=icon><i class="fa icon-warning" title=Warning></i></td><td class=content><div class=title>Az <span class=filename>/etc</span> meglevõ tartalmának mentése</div><div class=paragraph><p>Habár elméletileg magától semmi sem fogja bántani ezt a könyvtárat, azért ettõl függetlenül mindig érdemes biztosra menni. Ezért másoljuk az <span class=filename>/etc</span> könyvtár tartalmát egy megbízható helyre. Például:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># cp -Rp /etc /etc.old</span></code></pre></div></div><div class=paragraph><p>Az <code>-R</code> itt a rekurzív másolást jelenti, a <code>-p</code> pedig a dátumok, az állományok és egyebek tulajdoni viszonyainak megõrzését.</p></div></td></tr></tbody></table></div><div class=paragraph><p>Az <span class=filename>/etc</span> új változatának telepítéséhez szükségünk lesz még további könyvtárakra is. Erre a feladatra a <span class=filename>/var/tmp/root</span> tökéletesen megfelel, ahol még létre kell hoznunk néhány alkönyvtárat.</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># mkdir /var/tmp/root</span>
<span class=c># cd /usr/src/etc</span>
<span class=c># make DESTDIR=/var/tmp/root distrib-dirs distribution</span></code></pre></div></div><div class=paragraph><p>Ezzel létrejön a szükséges könyvtárszerkezet és települnek az állományok. Sok üres alkönyvtár is keletkezik a <span class=filename>/var/tmp/root</span> könyvtáron belül, ezeket töröljük. Ezt a legkönnyebben így tehetjük meg:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># cd /var/tmp/root</span>
<span class=c># find -d . -type d | xargs rmdir 2/dev/null</span></code></pre></div></div><div class=paragraph><p>Ezzel törlõdnek az üres könyvtárak. (A szabvány hibakimenetet átirányítottuk a <span class=filename>/dev/null</span> eszközre, és ezzel elnyomtuk a nem üres könyvtárak esetén keletkezõ hibaüzeneteket.)</p></div><div class=paragraph><p>A <span class=filename>/var/tmp/root</span> most már tartalmazza az összes olyan állományt, amelyek normális esetben a <span class=filename>/</span> könyvtáron belül foglalnak helyet. Ezt követõen nincs más dolgunk, csak végigmenni az itt található állományokon és megállapítani, miben térnek a meglévõektõl.</p></div><div class=paragraph><p>Vegyük észre, hogy a <span class=filename>/var/tmp/root</span> könyvtárba telepített állományok némelyikének neve "."-tal kezdõdik. Az írás pillanatában ezek csak a <span class=filename>/var/tmp/root/</span> és <span class=filename>/var/tmp/root/root/</span> könyvtárakban található parancsértelmezõhöz tartozó indító állományok lehetnek, habár adódhatnak még ilyenek (attól függõen, mikor olvassuk ezt). Ezért a feldolgozásukhoz ne felejtsük el a <code>ls -a</code> parancsot használni.</p></div><div class=paragraph><p>A <a href="https://man.freebsd.org/cgi/man.cgi?query=diff&amp;sektion=1&amp;format=html">diff(1)</a> alkalmazásával legegyszerûbben így tudunk összehasonlítani két állományt:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># diff /etc/shells /var/tmp/root/etc/shells</span></code></pre></div></div><div class=paragraph><p>Ennek hatására megjelennek az <span class=filename>/etc/shells</span> és az új <span class=filename>/var/tmp/root/etc/shells</span> állományok közti különbségek. A segítségével gyorsan el tudjuk dönteni, hogy összefésüljük-e a két állományt, vagy csak egyszerûen írjuk felül a régebbi verziót az újjal.</p></div><div class="admonitionblock tip"><table><tbody><tr><td class=icon><i class="fa icon-tip" title=Tip></i></td><td class=content><div class=title>Az új könyvtár (<span class=filename>/var/tmp/root</span>) nevébe írjuk bele a dátumot is, így könnyedén össze tudunk hasonlítani több verziót is</div><div class=paragraph><p>A rendszer gyakori újrafordítása az <span class=filename>/etc</span> szintén gyakori aktualizálását is maga után vonja, ami viszont fárasztó lehet.</p></div><div class=paragraph><p>Az iménti folyamatot fel tudjuk gyorsítani, hogy ha az <span class=filename>/etc</span> legutoljára összefésült változatát megtartjuk. A most következõ eljárás ennek mikéntjét vázolja fel.</p></div><div class="exampleblock procedure"><div class=content><div class="olist arabic"><ol class=arabic><li><p>A megszokottak szerint fordítsuk le a rendszert. Majd amikor az <span class=filename>/etc</span> könyvtárat és a többit is frissíteni akarjuk, a célként megadott könyvtár nevében adjuk meg a dátumot. Ha tehát például 1998. február 14. van, akkor írjuk ezt:</p><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># mkdir /var/tmp/root-19980214</span>
<span class=c># cd /usr/src/etc</span>
<span class=c># make DESTDIR=/var/tmp/root-19980214 \</span>
    distrib-dirs distribution</code></pre></div></div></li><li><p>Fésüljük össze a könyvtárban található az állományokat a fentiekben körvonalazottak szerint.</p><div class=paragraph><p>Befejezés után <em>õrizzük meg</em> a <span class=filename>/var/tmp/root-19980214</span> könyvtárat.</p></div></li><li><p>Mikor újra letöltjük a legfrissebb forrásokat és megismételjük az elõbbi lépéseket, haladjunk megint az elsõ lépés szerint. Ekkor tehát létrejön egy újabb könyvtár, amelynek a neve ezúttal már <span class=filename>/var/tmp/root-19980221</span> lesz (ha például hetente frissítünk).</p></li><li><p>Most már meg tudjuk vizsgálni a közbeesõ héten született eltéréseket, ha a két könyvtárra kiadunk egy rekurzív <a href="https://man.freebsd.org/cgi/man.cgi?query=diff&amp;sektion=1&amp;format=html">diff(1)</a> hívást:</p><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># cd /var/tmp</span>
<span class=c># diff -r root-19980214 root-19980221</span></code></pre></div></div><div class=paragraph><p>Általában így kevesebb eltérést kapunk, mint amennyi például a <span class=filename>/var/tmp/root-19980221/etc/</span> és az <span class=filename>/etc</span> összehasonlítása során elkerült volna. Mivel kisebb a keletkezett különbségek száma, ezért könnyebb lesz átvinnünk az <span class=filename>/etc</span> könyvtárunkba is a módosításokat.</p></div></li><li><p>Ezután törölhetjük a régebbi <span class=filename>/var/tmp/root-*</span> könyvtárat:</p><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># rm -rf /var/tmp/root-19980214</span></code></pre></div></div></li><li><p>Az <span class=filename>/etc</span> összefésülésekor mindig ismételjük meg ezeket a lépéseket.</p></li></ol></div></div></div><div class=paragraph><p>A <a href="https://man.freebsd.org/cgi/man.cgi?query=date&amp;sektion=1&amp;format=html">date(1)</a> meghívásával akár automatikussá is tehetjük a könyvtárak névadását:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># mkdir /var/tmp/root-`date &#34;+%Y%m%d&#34;`</span></code></pre></div></div></td></tr></tbody></table></div></div></div><div class=sect3><h4 id=updating-upgrading-rebooting>24.7.12. Újraindítás<a class=anchor href=#updating-upgrading-rebooting></a></h4><div class=paragraph><p>Ezzel készen is vagyunk. Miután ellenõriztük, hogy minden a megfelelõ helyére került, indítsuk újra a rendszert. Ehhez egy egyszerû <a href="https://man.freebsd.org/cgi/man.cgi?query=shutdown&amp;sektion=8&amp;format=html">shutdown(8)</a> is elegendõ:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># shutdown -r now</span></code></pre></div></div></div><div class=sect3><h4 id=_befejeztük>24.7.13. Befejeztük!<a class=anchor href=#_befejeztük></a></h4><div class=paragraph><p>Gratulálunk, sikerült frissítenünk a FreeBSD rendszerünket.</p></div><div class=paragraph><p>Ha mégis valami balul ütne ki, könnyen újra tudjuk fordítani a rendszer egyes részeit. Például, ha véletlenül letöröltük az <span class=filename>/etc/magic</span> állományt az <span class=filename>/etc</span> frissítése vagy összefésülése során, a <a href="https://man.freebsd.org/cgi/man.cgi?query=file&amp;sektion=1&amp;format=html">file(1)</a> parancs nem fog tudni rendesen mûködni. Ilyenkor a következõket kell tennünk a hiba kijavításához:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># cd /usr/src/usr.bin/file</span>
<span class=c># make all install</span></code></pre></div></div></div><div class=sect3><h4 id=updating-questions>24.7.14. Kérdések<a class=anchor href=#updating-questions></a></h4><div class=sect4><h5 id=_minden_egyes_változtatásnál_újra_kell_fordítani_a_rendszert>24.7.14.1. Minden egyes változtatásnál újra kell fordítani a rendszert?<a class=anchor href=#_minden_egyes_változtatásnál_újra_kell_fordítani_a_rendszert></a></h5><div class=paragraph><p>Nem könnyû választ adni erre a kérdésre, mivel ez alapvetõen a változtatás jellegétõl függ. Például, ha elindítjuk a CVSup programot és csak az alábbi állományok frissülnek:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>src/games/cribbage/instr.c
src/games/sail/pl_main.c
src/release/sysinstall/config.c
src/release/sysinstall/media.c
src/shared/mk/bsd.port.mk</code></pre></div></div><div class=paragraph><p>Ekkor valószínûleg nem éri meg újrafordítani a teljes rendszert. Elegendõ csupán belépni az érintett állományokat tartalmazó alkönyvtárakba és ott rendre kiadni a <code>make all install</code> parancsot. Ha viszont már valami komolyabb, például az <span class=filename>src/lib/libc/stdlib</span> változott meg, akkor vagy az egész rendszert, vagy legalább azon részeit fordítsuk újra, amely statikusan linkeltek (és minden más idõközben még hozzáadott statikusan linkelt dolgot).</p></div><div class=paragraph><p>Hogy melyik megoldást választjuk, teljesen rajtunk áll. Újrafordíthatjuk az egész rendszert kéthetente, mondván, hadd gyüljenek fel szépen a módosítások, vagy a függõségek pontos kielemzésével csak azokat az elemeket fordítjuk újra, amelyek tényleg meg is változtak.</p></div><div class=paragraph><p>Természetesen az egész attól függ, hogy milyen gyakran és melyik rendszert, a FreeBSD-STABLE-t vagy a FreeBSD-CURRENT-et frissítjük.</p></div></div><div class=sect4><h5 id=_a_fordító_rengeteg_11_es_jelzést_signal_11signal_11_vagy_másfajta_jelzéseket_dob_hibával_mi_történhetett>24.7.14.2. A fordító rengeteg 11-es jelzést (signal 11)signal 11 (vagy másfajta jelzéseket) dob hibával. Mi történhetett?<a class=anchor href=#_a_fordító_rengeteg_11_es_jelzést_signal_11signal_11_vagy_másfajta_jelzéseket_dob_hibával_mi_történhetett></a></h5><div class=paragraph><p>Ez általában hardveres meghibásodásra utal. A rendszer újrafordítása alapjaiban véve egy remek módszer számítógépünk alkatrészeinek terhelésére, ezért gyakorta elõhozza a memória már meglevõ hibáit. Ezek többnyire abban fogalmazódnak meg, hogy a fordító rejtélyes módon leáll mindenféle furcsa jelzések hatására.</p></div><div class=paragraph><p>Errõl biztosan úgy tudunk meggyõzõdni, ha újraindítjuk a make programot és az a folyamat egy teljesen másik pontján vérzik el.</p></div><div class=paragraph><p>Ilyenkor nem tudunk mást tenni, mint egymás után kicserélgetjük, kivesszük az alkatrészeket és így próbáljuk megállapítani, pontosan melyikük is okozza a gondokat.</p></div></div><div class=sect4><h5 id=_a_fordítása_befejezése_után_törölhetem_a_usrobj_könyvtárat>24.7.14.3. A fordítása befejezése után törölhetem a /usr/obj könyvtárat?<a class=anchor href=#_a_fordítása_befejezése_után_törölhetem_a_usrobj_könyvtárat></a></h5><div class=paragraph><p>Röviden: Igen.</p></div><div class=paragraph><p>A <span class=filename>/usr/obj</span> tartalmazza a fordítás folyamata során keletkezõ összes tárgykódot. Ennek törlése általában a <code>make buildworld</code> elsõ lépései között szerepel. Ezért tulajdonképpen a <span class=filename>/usr/obj</span> megtartásának nincs túlságosan sok értelme, viszont elég sok (jelenleg úgy kb. 340 MB) helyet fel tudunk így szabadítani.</p></div><div class=paragraph><p>Ha azonban értjük a dolgunkat, akkor megadhatjuk a <code>make buildworld</code> parancsnak, hogy hagyja ki ezt a lépést. Ennek hatására a fordítás sokkal hamarabb véget ér, mivel a legtöbb forrást így nem kell újrafordítani. Üröm az örömben, hogy ha netalán aprócska függõségi problémák merülnének fel, akkor az egész fordítás megfeneklik mindenfelé különös módokon. Emiatt gyakran írnak feleslegesen leveleket a FreeBSD levelezési listáira, melyek a rendszer sikertelen újrafordításáról panaszkodnak, miközben kiderül, hogy az maguk az érintettek akarták lerövidíteni a folyamatot.</p></div></div><div class=sect4><h5 id=_lehetséges_a_megszakadt_fordítás_folytatása>24.7.14.4. Lehetséges a megszakadt fordítás folytatása?<a class=anchor href=#_lehetséges_a_megszakadt_fordítás_folytatása></a></h5><div class=paragraph><p>Ez attól függ, hogy a probléma bekövetkezése elõtt mennyire sikerült eljutni a fordításban.</p></div><div class=paragraph><p><em>Általában</em> (tehát nem feltétlenül minden esetben) a <code>make buildworld</code> lefordítja a fordításhoz szükséges eszközök (például a <a href="https://man.freebsd.org/cgi/man.cgi?query=gcc&amp;sektion=1&amp;format=html">gcc(1)</a> és <a href="https://man.freebsd.org/cgi/man.cgi?query=make&amp;sektion=1&amp;format=html">make(1)</a>) újabb változatait és a rendszer függvénykönyvtárait, majd ezeket telepíti. Ezután ezekkel az új eszközökkel lefordítattja saját magukat és ismét telepíti. Ezt követõen fordítja újra az új rendszerállományokkal az egész rendszert (így ezúttal már az olyan szokásos felhasználói programokat is, mint például az <a href="https://man.freebsd.org/cgi/man.cgi?query=ls&amp;sektion=1&amp;format=html">ls(1)</a> és a <a href="https://man.freebsd.org/cgi/man.cgi?query=grep&amp;sektion=1&amp;format=html">grep(1)</a>).</p></div><div class=paragraph><p>Ha tudjuk, hogy az utolsó fázisban álltunk le (mivel megnéztük a fordításhoz tartozó kimenetet), akkor (minden további nélkül) elég ennyi:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>kijavítjuk a hibát ...
<span class=c># cd /usr/src</span>
<span class=c># make -DNO_CLEAN all</span></code></pre></div></div><div class=paragraph><p>Ezzel megmarad a korábbi <code>make buildworld</code> munkájának eredménye.</p></div><div class=paragraph><p>Ha ezt az üzenetet látjuk a <code>make buildworld</code> kimenetében:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=nt>--------------------------------------------------------------</span>
Building everything..
<span class=nt>--------------------------------------------------------------</span></code></pre></div></div><div class=paragraph><p>akkor különösebb gond nélkül megcsinálhatjuk.</p></div><div class=paragraph><p>Amennyiben viszont nem látunk ilyen üzenetet, vagy nem vagyunk benne biztosak, akkor még mindig jobb elõvigyázatosnak lenni, ezért kénytelenek leszünk teljesen elölrõl kezdeni a fordítást.</p></div></div><div class=sect4><h5 id=_hogyan_tudjuk_felgyorsítani_a_fordítást>24.7.14.5. Hogyan tudjuk felgyorsítani a fordítást?<a class=anchor href=#_hogyan_tudjuk_felgyorsítani_a_fordítást></a></h5><div class=ulist><ul><li><p>Futtassuk egyfelhasználós módban.</p></li><li><p>Tegyük a <span class=filename>/usr/src</span> és <span class=filename>/usr/obj</span> könyvtárakat külön állományrendszerekre, külön lemezekre. Sõt, ha lehetséges, akkor ezeket a lemezeket tegyük külön lemezvezérlõkre.</p></li><li><p>Még mindig jobb, ha ezeket az állományrendszereket a <a href="https://man.freebsd.org/cgi/man.cgi?query=ccd&amp;sektion=4&amp;format=html">ccd(4)</a> (lemezek összefûzését vezérlõ meghajtó) segítségével kiterjesztjük több lemezes eszközre.</p></li><li><p>Kapcsoljuk ki a profilozást (az <span class=filename>/etc/make.conf</span> állományban a "NO_PROFILE=true" megadásával). Többnyire úgy sem lesz rá szükségünk.</p></li><li><p>Az <span class=filename>/etc/make.conf</span> állományban a <code>CFLAGS</code> változót állítsuk az <code>-O -pipe</code> értékre. Az <code>-O2</code> gyakran sokkal lassabb, az <code>-O</code> és <code>-O2</code> alig tér el az optimalizálás mértékében. A <code>-pipe</code> paraméter hatására pedig a fordítóprogram átmeneti állományok helyett csöveket használ a kommunikációra, és így megtakarít némi lemezhasználatot (a memóriahasználat terhére).</p></li><li><p>Ha a <a href="https://man.freebsd.org/cgi/man.cgi?query=make&amp;sektion=1&amp;format=html">make(1)</a> parancsnak átadjuk a <code>-j_n_</code> paramétert, akkor képes több mindent párhuzamosan futtatni. Ez sok esetben segít attól függetlenül, hogy egy- vagy többprocesszoros gépünk van.</p></li><li><p>A <span class=filename>/usr/src</span> könyvtárat tartalmazó állományrendszert csatlakoztathatjuk (vagy újracsatlakoztathatjuk) a <code>noatime</code> beállítással. Ilyenkor az állományrendszer nem rögzíti a hozzáférés idejét. Erre az információra sincs igazából szükségünk.</p><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># mount -u -o noatime /usr/src</span></code></pre></div></div><div class="admonitionblock warning"><table><tbody><tr><td class=icon><i class="fa icon-warning" title=Warning></i></td><td class=content><div class=paragraph><p>A fenti példa azt feltételezi, hogy a <span class=filename>/usr/src</span> könyvtárnak saját állományrendszere van. Ha ez nem így lenne (tehát például a <span class=filename>/usr</span> része), akkor itt azt kell megadnunk, nem pedig a <span class=filename>/usr/src</span> nevét.</p></div></td></tr></tbody></table></div></li><li><p>A <span class=filename>/usr/obj</span> könyvtárat tartalmazó állományrendszert csatlakoztathatjuk (vagy újracsatlakoztathatjuk) az <code>async</code> beállítással. Ennek hatására a lemez írása aszinkron módon történik. Magyarul az írási mûveletek azonnal befejezõdnek, miközben az adat ténylegesen csak pár másodperccel késõbb kerül ki a lemezre. Ezzel az írási kérelmek gyönyörûen összegyûjthetõek, ami nagymértékû növekedést eredményez a teljesítményben.</p><div class="admonitionblock warning"><table><tbody><tr><td class=icon><i class="fa icon-warning" title=Warning></i></td><td class=content><div class=paragraph><p>Ne felejtsük el azonban, hogy ezzel együtt az állományrendszerünk is sérülékenyebbé válik. Ezen beállítás használatával megnõ annak az esélye, hogy egy áramkimaradást követõ indításnál az állományrendszer helyreállíthatatlan állapotba kerül.</p></div><div class=paragraph><p>Ha egyedül csak a <span class=filename>/usr/obj</span> található ezen az állományrendszeren, akkor ez nem jelent akkora veszélyt. Amikor viszont rajta kívül még értékes adat is található az állományrendszeren, a beállítás érvényesítése elõtt mindenképpen készítsünk róla friss mentéseket.</p></div></td></tr></tbody></table></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># mount -u -o async /usr/obj</span></code></pre></div></div><div class="admonitionblock warning"><table><tbody><tr><td class=icon><i class="fa icon-warning" title=Warning></i></td><td class=content><div class=paragraph><p>Ahogy arról az elõbb is szó esett, ha a <span class=filename>/usr/obj</span> nem egy különálló állományrendszeren található, akkor a példában szereplõ csatlakozási pontot cseréljük ki a megfelelõre.</p></div></td></tr></tbody></table></div></li></ul></div></div><div class=sect4><h5 id=_mi_tegyünk_ha_valami_nem_megy_rendesen>24.7.14.6. Mi tegyünk, ha valami nem megy rendesen?<a class=anchor href=#_mi_tegyünk_ha_valami_nem_megy_rendesen></a></h5><div class=paragraph><p>Egyértelmûen bizonyosodjunk meg róla, hogy a korábbi fordításokból nem maradtak vissza semmiféle kóbor állományok. Ennyi sokszor pontosan elég.</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># chflags -R noschg /usr/obj/usr</span>
<span class=c># rm -rf /usr/obj/usr</span>
<span class=c># cd /usr/src</span>
<span class=c># make cleandir</span>
<span class=c># make cleandir</span></code></pre></div></div><div class=paragraph><p>Igen, a <code>make cleandir</code> parancsot tényleg kétszer kell kiadni.</p></div><div class=paragraph><p>Ezután a <code>make buildworld</code> parancstól indulva kezdjük újra a fordítást.</p></div><div class=paragraph><p>Ha még ezek után is fennáll a probléma, küldjük el a hibát tartalmazó kimenetet és a <code>uname -a</code> parancs eredményét a <a href=https://lists.FreeBSD.org/subscription/freebsd-questions>FreeBSD general questions levelezési lista</a> címére. Ne lepõdjünk meg, ha a beállításainkra vonatkozóan még kapunk további kérdéseket is!</p></div></div></div></div><div class=sect2><h3 id=small-lan>24.8. A források követése több géppel<a class=anchor href=#small-lan></a></h3><div class=paragraph><p>Ha egyszerre több számítógéppel is szeretnénk követni ugyanannak a forrásfának a változásait és ezért mindegyikre letöltjük a forrásokat majd újrafordítjuk ezeket, akkor sok erõforrást, de leginkább lemezterületet, hálózati sávszélességet és processzoridõt, feleslegesen használunk. Ezekkel úgy tudunk spórolni, ha valójában csak egyetlen géppel végeztetjük el a munka legtöbb részét, miközben a többi NFS használatával dolgozik. Ez a szakasz ezt a módszert foglalja össze.</p></div><div class=sect3><h4 id=small-lan-preliminaries>24.8.1. Elõkészületek<a class=anchor href=#small-lan-preliminaries></a></h4><div class=paragraph><p>Elõször is szedjük össze az egyezõ binárisokat futtató gépeket, melyekre a továbbiakban csak <em>fordítási csoport</em> néven hivatkozunk. Minden gépnek lehet saját rendszermagja, viszont a felhasználói programok mindegyikõjük esetében ugyanazok. Ebbõl a csoportból válasszuk ki egy <em>fordító gépet</em>. Ez lesz az a gép, amelyen a rendszer és a rendszermag lefordításra kerül. Ideális esetben ez a leggyorsabb gép, amelynek elegendõ a processzorkapacitása arra, hogy lefuttassa a <code>make buildworld</code> és <code>make buildkernel</code> parancsokat. Érdemes még rajta kívül kiválasztanunk egy <em>tesztelõ gépet</em> is, ahol a véglegesítés elõtt kipróbálhatjuk a szoftverfrissítéseket. Ennek egy olyan gépnek <em>kell</em> lennie, amely akár hosszabb ideig is nélkülözhetõ a csoportból. Lehet akár maga a fordítást végzõ gép is, de nem elvárás.</p></div><div class=paragraph><p>A fordítási csoportban levõ összes gépnek ugyanarról a géprõl és ugyanarra a pontra kell csatlakoztatnia a <span class=filename>/usr/obj</span> és <span class=filename>/usr/src</span> könyvtárakat. Ezek optimális esetben a fordítással foglalkozó gép két külön lemezmeghajtóján vannak, melyek egyaránt elérhetõek NFS-en keresztül. Ha több fordítási csoportunk is van, akkor az <span class=filename>/usr/src</span> könyvtárnak elegendõ csak egyetlen fordító gépen meglennie, a többi pedig csatlakoztassa NFS-en keresztül.</p></div><div class=paragraph><p>Végül gyõzödjünk meg róla, hogy az <span class=filename>/etc/make.conf</span> és a <span class=filename>/etc/src.conf</span> állományok tartalma a fordítási csoport mindegyik gépénél megegyezik a fordító gépével. Ez azt jelenti, hogy a fordító gépnek az alaprendszer ugyanazon részeit és ugyanúgy kell létrehozni, mint amelyet a fordítási csoport akármelyik gépére telepíteni is akarunk. Ezenkívül még a fordítási csoportban levõ minden egyes gép <span class=filename>/etc/make.conf</span> állományában a <code>KERNCONF</code> értékének a saját rendszermagjára vonatkozó konfigurációt kell megadni, illetve a fordítással foglakozó gép <code>KERNCONF</code> változójánál pedig az együtt összeset, a sajátjával kezdve. Ennek megfelelõen a fordító gépnek a rendszermagok lefordításához rendelkeznie kell az egyes gépek <span class=filename>/usr/src/sys/arch/conf</span> könyvtárában meglevõ állományaival.</p></div></div><div class=sect3><h4 id=small-lan-base-system>24.8.2. Az alaprendszer<a class=anchor href=#small-lan-base-system></a></h4><div class=paragraph><p>Most, miután mindent megfelelõen elõkészítettünk, készen állunk a munkára. A <a href=#make-buildworld>Az alaprendszer fordítása</a>ban leírtak szerint fordítsuk le a rendszermagokat és az alaprendszert a fordító gépen, de utána még nem telepítsünk semmit se. Ha befejezõdött a fordítás, lépjünk be a tesztelõ gépre és telepítsük a frissen fordított rendszermagot. Ha ez a gép NFS-en keresztül éri a <span class=filename>/usr/src</span> és <span class=filename>/usr/obj</span> könyvtárakat, akkor az egyfelhasználós módban aktiválni kell a hálózatot, majd csatlakoztatni ezeket. Ezt legkönnyebben úgy tudjuk megcsinálni, ha a gépet elõször elindítjuk többfelhasználós módban, majd a <code>shutdown now</code> paranccsal egyfelhasználós módba váltunk. Ha eljuttunk ide, telepítsünk az új rendszermagot és rendszert, illetve a megszokott módon futtassuk a <code>mergemaster</code> parancsot. Amikor ezt befejeztük, ezen a gépen térjünk vissza a hétköznapi többfelhasználós mûködési módba.</p></div><div class=paragraph><p>Miután a tesztelésre szánt gépen ellenõriztük, hogy minden a megfelelõ módon mûködik, az elõbb tárgyalt eljárással telepítsük fel a fordítási csoportban levõ összes többi gépre is az új szoftvereket.</p></div></div><div class=sect3><h4 id=small-lan-ports>24.8.3. Portok<a class=anchor href=#small-lan-ports></a></h4><div class=paragraph><p>Ugyanezt a gondolatmenet alkalmazható a portfa esetében is. Az elsõ és egyben legfontosabb lépés a <span class=filename>/usr/ports</span> csatlakoztatása ugyanarról a géprõl a fordítási csoport minden gépére. Az <span class=filename>/etc/make.conf</span> megfelelõ beállításával még a terjesztési állományokat is meg tudjuk osztani. A <code>DISTDIR</code> értékét egy olyan közösen használt könyvtárra állítsuk, amely írható az NFS-en keresztül megosztott állományrendszerünkben a <code>root</code> felhasználóként tevékenykedõk számára. A <code>WRKDIRPREFIX</code> változót minden gépen egy helyi fordítási könyvtárra állítsuk. Zárásképpen még hozzátesszük, hogy ha csomagokat akarunk készíteni és mások számára is elérhetõvé tenni, akkor ne felejtsük el a <code>PACKAGES</code> változót a <code>DISTDIR</code> változóhoz hasonlóan beállítani.</p></div></div></div></div></div><div class=sect1><h2 id=dtrace>Chapter 25. DTrace<a class=anchor href=#dtrace></a></h2><div class=sectionbody><div class=sect2><h3 id=dtrace-synopsis>25.1. Áttekintés<a class=anchor href=#dtrace-synopsis></a></h3><div class=paragraph><p>A DTrace, vagy más néven Dynamic Tracing technológiát a Sun™ dolgozta ki szerverek teljesítményében jelentkezõ szûk keresztmetszetek felderítésének megkönnyítésére. Ez nem egy nyomkövetésre szolgáló megoldást takar, hanem inkább a rendszer valós idejû elemzését és teljesítményének vizsgálatát elõsegítõ eszközt.</p></div><div class=paragraph><p>A DTrace figyelemre méltó elemzõeszköz, rengeteg rendkívül hasznos képességgel rendelkezik a rendszerben felbukkanó problémák diagnosztizálására. Elõre programozott szkriptek segítségével pedig ezen képességek további elõnyeit tudjuk kihasználni, ugyanis a DTrace programozható egy ún. D nyelven, amelynek révén a különbözõ vizsgálatokat könnyen a saját igényeink szerint tudjuk alakítani.</p></div><div class=paragraph><p>A fejezet elolvasása során megismerjük:</p></div><div class=ulist><ul><li><p>mi is az a DTrace és milyen lehetõségei vannak;</p></li><li><p>a Solaris™ és FreeBSD operációs rendszereken megtalálható DTrace implementációk közti eltéréseket;</p></li><li><p>a DTrace FreeBSD alatt hogyan engedélyezhetõ és használható.</p></li></ul></div><div class=paragraph><p>A fejezet elolvasásához ajánlott:</p></div><div class=ulist><ul><li><p>a UNIX® és FreeBSD alapvetõ ismerete (<a href=./#basics>A UNIX alapjai</a>);</p></li><li><p>a rendszermag konfigurációjának és fordításának alapvetõ ismerete (<a href=./#kernelconfig>A FreeBSD rendszermag testreszabása</a>);</p></li><li><p>az operációs rendszerek és azon belül a FreeBSD biztonsági fogalmainak minimális ismerete (<a href=./#security>Biztonság</a>);</p></li><li><p>a FreeBSD forrásainak megszerzésének és azok lefordításának ismerete (<a href=./#updating-upgrading>A FreeBSD frissítése és frissen tartása</a>).</p></li></ul></div><div class="admonitionblock warning"><table><tbody><tr><td class=icon><i class="fa icon-warning" title=Warning></i></td><td class=content><div class=paragraph><p>Ez a funkció még folyamatos tesztelés alatt áll. Bizonyos részei még egyáltalán nem, vagy csak korlátozottan érhetõek el. A dokumentáció annak megfelelõen fog majd változni, hogy ezek az elemek fokozatosan elérik az éles felhasználáshoz szükséges szintet.</p></div></td></tr></tbody></table></div></div><div class=sect2><h3 id=dtrace-implementation>25.2. Eltérések az implementációban<a class=anchor href=#dtrace-implementation></a></h3><div class=paragraph><p>Noha a FreeBSD alatt megtalálható DTrace implementáció nagyon hasonló az eredeti, Solaris™ alatt futó változathoz, tartalmaz bizonyos különbségeket, amelyeket a továbblépés elõtt mindenképpen érdemes megemlítenünk. Az egyik legfontosabb ilyen szembetûnõ különbség, hogy a FreeBSD esetén a DTrace használatát külön engedélyezni kell. A DTrace megfelelõ mûködéséhez tehát a rendszermag konfigurációs állományában meg kell adnunk bizonyos beállításokat és modulokat kell betöltenünk. Ezekrõl hamarosan szó lesz.</p></div><div class=paragraph><p>A rendszermag konfigurációs állományában a <code>DDB_CTF</code> opció segítségével tudjuk engedélyezni ún. CTF adatok betöltését mind a rendszermag moduljaiból, mind pedig magából a rendszermagból egyaránt. A CTF a Solaris™ "Compact Type Format" elnevezésû formátumára utal, amellyel például a DWARF megoldásához hasonló módon tárolhatunk tömörített alakban különbözõ típusú nyomkövetési információkat. Ilyen CTF adatok többek közt a <code>ctfconvert</code> és a <code>ctfmerge</code> használatával rendelhetõek hozzá bináris állományokhoz. A <code>ctfconvert</code> segédprogram a fordítóprogram által az ELF állományokban szereplõ DWARF típusú szakaszokban tárolt információkat képes beolvasni, és a <code>ctfmerge</code> a tárgykódban található CTF típusú ELF szakaszokat tudja végrehajtható állományokká vagy osztott könyvtárakka összefûzni. Röviden beszélni fogunk arról, hogyan lehet mindezeket a FreeBSD alaprendszerébe és rendszermagjába is beépíteni.</p></div><div class=paragraph><p>FreeBSD és Solaris™ esetén elõfordulhat, hogy más fajta providerek állnak rendelkezésünkre. Ezek közül talán a legfontosabb a <code>dtmalloc</code>, amely a FreeBSD rendszermagjában típus szerint teszi lehetõvé a <code>malloc()</code> függvény követését.</p></div><div class=paragraph><p>FreeBSD alatt kizárólag csak a <code>root</code> tudja használni a DTrace-t. Ennek oka a két operációs rendszer biztonsági megoldásai közti különbségekben keresendõ, mivel a Solaris™ esetén létezik néhány olyan alacsonyszintû ellenõrzés, amely a FreeBSD-nél még nincs. Ezért például a <span class=filename>/dev/dtrace/dtrace</span> eszköz szigorúan csak a <code>root</code> számára érhetõ el.</p></div><div class=paragraph><p>Végezetül megemlítjük, hogy a DTrace felhasználására a Sun™ CDDL licence vonatkozik. A <code>Common Development and Distribution License</code> FreeBSD a <span class=filename>/usr/src/cddl/contrib/opensolaris/OPENSOLARIS.LICENSE</span> állományban található, vagy interneten keresztül a <a href=http://www.opensolaris.org/os/licensing>http://www.opensolaris.org/os/licensing</a> címen.</p></div><div class=paragraph><p>Ezen licenc értelmében a DTrace támogatással készített FreeBSD rendszermagok továbbra is BSD licencûek maradnak, azonban a rendszerrel terjesztett binárisok futtatásakor vagy a modulok betöltésekor már a CDDL érvényesül.</p></div></div><div class=sect2><h3 id=dtrace-enable>25.3. A DTrace támogatásának engedélyezése<a class=anchor href=#dtrace-enable></a></h3><div class=paragraph><p>A DTrace által felkínált lehetõségeket a következõ sorok hozzáadásával tudjuk engedélyezni a rendszermag konfigurációs állományában:</p></div><div class="literalblock programlisting"><div class=content><pre>options         KDTRACE_HOOKS
options         DDB_CTF</pre></div></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>AMD64 architektúrán ezeken kívül még az alábbi sor is kelleni fog:</p></div><div class="literalblock programlisting"><div class=content><pre>options         KDTRACE_FRAME</pre></div></div><div class=paragraph><p>Ezzel a beállítással az FBT ("function boundary tracing") részére nyújtunk támogatást. A DTrace ugyan enélkül is képes lesz mûködni, de akkor csak korlátozott mértékben tudunk ilyen típusú vizsgálatokat végezni.</p></div></td></tr></tbody></table></div><div class=paragraph><p>Az egész rendszert újra kell fordítanunk a CTF használatával. Ennek elvégzéséhez a következõ parancsokat kell kiadnunk:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># cd /usr/src</span>
<span class=c># make WITH_CTF=1 kernel</span></code></pre></div></div><div class=paragraph><p>A fordítás befejezõdése után indítsuk újra a rendszerünket.</p></div><div class=paragraph><p>A rendszer újraindulása és az új rendszermag betöltõdése után szükségünk lesz egy Korn-féle parancsértelmezõre is, mivel a DTrace eszköztárában rengeteg, a <code>ksh</code> programra épülõ eszközt fogunk találni. Ezért tehát telepítsük a <a class=package href=https://cgit.freebsd.org/ports/tree/shells/ksh93/>shells/ksh93</a> csomagot, de megjegyezzük, hogy ugyanezen eszközök számára a <a class=package href=https://cgit.freebsd.org/ports/tree/shells/pdksh/>shells/pdksh</a> vagy <a class=package href=https://cgit.freebsd.org/ports/tree/shells/mksh/>shells/mksh</a> csomagok is megfelelnek.</p></div><div class=paragraph><p>Végül töltsük le a DTrace eszköztárának legfrissebb változatát. Az aktuális verzió a <a href=http://www.opensolaris.org/os/community/dtrace/dtracetoolkit/>http://www.opensolaris.org/os/community/dtrace/dtracetoolkit/</a> címen érhetõ el. Képes önmagát telepíteni, de a benne található eszközök használatához nem kötelezõ ezt elvégezni.</p></div></div><div class=sect2><h3 id=dtrace-using>25.4. A DTrace használata<a class=anchor href=#dtrace-using></a></h3><div class=paragraph><p>A DTrace funkcióinak alkalmazásához léteznie kell egy DTrace eszköznek. Ennek létrehozásához be kell töltenünk a megfelelõ modult:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># kldload dtraceall</span></code></pre></div></div><div class=paragraph><p>Innentõl már mûködésre kész a DTrace. Rendszeradminisztrátorként a következõ módon kérdezhetjük le a rendelkezésre álló vizsgálatokat:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># dtrace -l | more</span></code></pre></div></div><div class=paragraph><p>Mivel lekérdezés eredménye pillanatok alatt betöltené az egész képernyõt, ezért az egészet még átirányítjuk a <code>more</code> parancshoz. Ha ez rendesen lefut, akkor a DTrace ténylegesen használhatónak tekinthetõ. Ezt követõen tekintsük át a hozzá tartozó eszközkészletet.</p></div><div class=paragraph><p>Ez a mellékelt eszközkészlet lényegében a rendszerrel kapcsolatos információk összegyûjtésére alkalmas szkripteket tartalmaz. Vannak szkriptek, amelyekkel a megnyitott állományokat, a memóriát, a processzorhasználatot és még sok minden mást kérdezhetünk le. A szkriptek a következõ parancs segítségével tömöríthetõek ki:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># gunzip -c DTraceToolkit* | tar xvf -</span></code></pre></div></div><div class=paragraph><p>A <code>cd</code> parancs segítségével lépjünk be az így keletkezõ könyvtárba, és a kisbetûs névvel rendelkezõ állományok engedélyeit állítsuk be a <code>755</code> módra.</p></div><div class=paragraph><p>Mindegyik szkriptben el kell végeznünk némi módosítást: a <span class=filename>/usr/bin/ksh</span> hivatkozásokat írjuk át mindenhol a <span class=filename>/usr/local/bin/ksh</span> névre, illetve a <span class=filename>/usr/bin/sh</span> hivatkozásokat <span class=filename>/bin/sh</span> névre, majd végezetül pedig a <span class=filename>/usr/bin/perl</span> hivatkozásokat a <span class=filename>/usr/local/bin/perl</span> névre.</p></div><div class="admonitionblock important"><table><tbody><tr><td class=icon><i class="fa icon-important" title=Important></i></td><td class=content><div class=paragraph><p>Itt még egyszer kiemelnénk, hogy a FreeBSD-ben jelenleg megtalálható DTrace támogatás <em>még nem teljes</em> és <em>kísérleti jelleggel</em> szerepel. Ezért bizonyos szkriptek nem fognak mûködni, vagy azért, mert túlságosan Solaris™ lehetõségeihez igazodnak, vagy pedig azért, mert a jelenlegi implementáció által még nem ismert vizsgálatokra támaszkodnak.</p></div></td></tr></tbody></table></div><div class=paragraph><p>Jelenlegi ismereteink szerint a FreeBSD egyelõre csak két szkriptet támogat teljes mértékben, ezek a <span class=filename>hotkernel</span> és a <span class=filename>procsystime</span>. A szakasz további részében ezzel a kettõvel fogunk részletesebben foglalkozni.</p></div><div class=paragraph><p>A <span class=filename>hotkernel</span> feladata segíteni beazonosítani azokat a függvényeket, amelyek a legtöbb idõt veszik igénybe a rendszermagon belül. A szkript futtatásakor nagyjából a következõt csinálja:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># ./hotkernel</span>
Sampling... Hit Ctrl-C to end.</code></pre></div></div><div class=paragraph><p>A folyamat <span class=keyseq><kbd>Ctrl</kbd>+<kbd>C</kbd></span> billentyûkombináció hatására állítható meg. A szkript futásának befejezõdésekor különbözõ rendszermagbeli függvények és a hozzájuk tartozó idõk jelennek meg, az utóbbi szerint növekvõ sorrendben:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>kernel<span class=sb>`</span>_thread_lock_flags                                   2   0.0%
0xc1097063                                                  2   0.0%
kernel<span class=sb>`</span>sched_userret                                        2   0.0%
kernel<span class=sb>`</span>kern_select                                          2   0.0%
kernel<span class=sb>`</span>generic_copyin                                       3   0.0%
kernel<span class=sb>`</span>_mtx_assert                                          3   0.0%
kernel<span class=sb>`</span>vm_fault                                             3   0.0%
kernel<span class=sb>`</span>sopoll_generic                                       3   0.0%
kernel<span class=sb>`</span>fixup_filename                                       4   0.0%
kernel<span class=sb>`</span>_isitmyx                                             4   0.0%
kernel<span class=sb>`</span>find_instance                                        4   0.0%
kernel<span class=sb>`</span>_mtx_unlock_flags                                    5   0.0%
kernel<span class=sb>`</span>syscall                                              5   0.0%
kernel<span class=sb>`</span>DELAY                                                5   0.0%
0xc108a253                                                  6   0.0%
kernel<span class=sb>`</span>witness_lock                                         7   0.0%
kernel<span class=sb>`</span>read_aux_data_no_wait                                7   0.0%
kernel<span class=sb>`</span>Xint0x80_syscall                                     7   0.0%
kernel<span class=sb>`</span>witness_checkorder                                   7   0.0%
kernel<span class=sb>`</span>sse2_pagezero                                        8   0.0%
kernel<span class=sb>`</span>strncmp                                              9   0.0%
kernel<span class=sb>`</span>spinlock_exit                                       10   0.0%
kernel<span class=sb>`</span>_mtx_lock_flags                                     11   0.0%
kernel<span class=sb>`</span>witness_unlock                                      15   0.0%
kernel<span class=sb>`</span>sched_idletd                                       137   0.3%
0xc10981a5                                              42139  99.3%</code></pre></div></div><div class=paragraph><p>Ez a szkript modulok esetén is alkalmazható. Ezt a módját a <code>-m</code> kapcsoló megadásával aktiválhatjuk:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># ./hotkernel -m</span>
Sampling... Hit Ctrl-C to end.
^C
MODULE                                                  COUNT   PCNT
0xc107882e                                                  1   0.0%
0xc10e6aa4                                                  1   0.0%
0xc1076983                                                  1   0.0%
0xc109708a                                                  1   0.0%
0xc1075a5d                                                  1   0.0%
0xc1077325                                                  1   0.0%
0xc108a245                                                  1   0.0%
0xc107730d                                                  1   0.0%
0xc1097063                                                  2   0.0%
0xc108a253                                                 73   0.0%
kernel                                                    874   0.4%
0xc10981a5                                             213781  99.6%</code></pre></div></div><div class=paragraph><p>A <span class=filename>procsystime</span> szkript egy adott azonosítóval vagy névvel rendelkezõ programhoz tudja megadni az általa kezdeményezett rendszerhívások által felhasznált idõt. A most következõ példában elindítjuk a <span class=filename>/bin/csh</span> egy újabb példányát. A <span class=filename>procsystime</span> elindul, majd megvárja, amíg kiadunk néhány parancsot a <code>csh</code> frissen indított másolatában. A teszt eredményei tehát a következõk lesznek:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># ./procsystime -n csh</span>
Tracing... Hit Ctrl-C to end...
^C

Elapsed Times <span class=k>for </span>processes csh,

         SYSCALL          TIME <span class=o>(</span>ns<span class=o>)</span>
          getpid               6131
       sigreturn               8121
           close              19127
           fcntl              19959
             dup              26955
         setpgid              28070
            <span class=nb>stat              </span>31899
       setitimer              40938
           wait4              62717
       sigaction              67372
     sigprocmask             119091
    gettimeofday             183710
           write             263242
          execve             492547
           ioctl             770073
           vfork            3258923
      sigsuspend            6985124
            <span class=nb>read         </span>3988049784</code></pre></div></div><div class=paragraph><p>Jól megfigyelhetõ, hogy (nanomásodpercekben mérve) a legtöbb idõt a <code>read()</code>, a legkevesebb idõt pedig a <code>getpid()</code> rendszerhívás vette igénybe.</p></div></div><div class=sect2><h3 id=dtrace-language>25.5. A D nyelv<a class=anchor href=#dtrace-language></a></h3><div class=paragraph><p>A DTrace eszköztárában megtalálható számos szkript a DTrace saját programozási nyelvén íródott. Ezt a nyelvet nevezik a Sun™ implementációjában "a D nyelvnek". Ennek ismertetésére itt most külön nem térünk ki, azonban a <a href=http://wikis.sun.com/display/DTrace/Documentation>http://wikis.sun.com/display/DTrace/Documentation</a> címen igen részletesen olvashatunk róla.</p></div></div></div></div><h1 id=network-communication class=sect0>Part IV: Hálózati kommunikáció<a class=anchor href=#network-communication></a></h1><div class="openblock partintro"><div class=content><div class=paragraph><p>A FreeBSD az egyik legelterjedtebb operációs rendszer a legnagyobb hálózati teljesítményt nyújtó kiszolgálók körében. Az itt található fejezetek témái:</p></div><div class=ulist><ul><li><p>Soros kommunikáció</p></li><li><p>PPP és PPP Etherneten keresztül (PPPoE)</p></li><li><p>Elektronikus levelezés</p></li><li><p>Hálózati kiszolgálók futattása</p></li><li><p>Tûzfalak</p></li><li><p>Egyéb haladó hálózati témák</p></li></ul></div><div class=paragraph><p>Ezek a fejezetek nem állnak egymással szoros kapcsolatban, csupán egy adott témáról adnak ismereteket. Ennélfogva nem kötelezõ ezeket sorrendben elolvasni, valamint egyáltalán nem is kell mindegyikõjüket átolvasni ahhoz, hogy a FreeBSD-t hálózati környezetben is használni tudjuk.</p></div></div></div><div class=sect1><h2 id=serialcomms>Chapter 26. Soros vonali kommunikáció<a class=anchor href=#serialcomms></a></h2><div class=sectionbody><div class=sect2><h3 id=serial-synopsis>26.1. Áttekintés<a class=anchor href=#serial-synopsis></a></h3><div class=paragraph><p>A UNIX® mindig is támogatta a soros vonali kommunikációt. Tulajdonképpen az elsõ UNIX®-os gépek is soros vonalon kapták a felhasználóktól a bemenetet és ugyanígy küldték vissza a kimenetet. Az idõk azóta már sokat változtak, hogy egy átlagos "terminál" mindössze egy 10 karakter per másodperc sebességû soros nyomtatóból és egy billentyûzetbõl állt. Ebben a fejezetben ismertetünk néhány olyan megoldást, amellyel a FreeBSD képes soros vonalon keresztül kommunikálni.</p></div><div class=paragraph><p>A fejezet elolvasása során megismerjük:</p></div><div class=ulist><ul><li><p>hogyan kapcsoljunk terminálokat a FreeBSD rendszerünkre;</p></li><li><p>hogyan tárcsázzunk modem segítségével távoli számítógépeket;</p></li><li><p>hogyan tegyük lehetõvé gépünkre a bejelentkezést távoli felhasználók számára;</p></li><li><p>hogyan indítsuk a rendszerünket soros konzolról.</p></li></ul></div><div class=paragraph><p>A fejezet elolvasásához ajánlott:</p></div><div class=ulist><ul><li><p>egy új rendszermag beállításának és telepítésének ismerete (<a href=./#kernelconfig>A FreeBSD rendszermag testreszabása</a>);</p></li><li><p>a UNIX®-os engedélyek és a UNIX® alatt futtatott programok mûködtetésének megértése (<a href=./#basics>A UNIX alapjai</a>);</p></li><li><p>annak a soros vonali hardvernek (modemnek vagy többportos kártyának a) kézikönyve, amelyet a FreeBSD-vel használni szeretnénk</p></li></ul></div></div><div class=sect2><h3 id=serial>26.2. Bevezetés<a class=anchor href=#serial></a></h3><div class=sect3><h4 id=serial-terminology>26.2.1. Alapfogalmak<a class=anchor href=#serial-terminology></a></h4><div class=dlist><dl><dt class=hdlist1>bps</dt><dd><p>Bit per másodperc - az adatátvitel sebessége</p></dd><dt class=hdlist1>DTE</dt><dd><p>Adatterminál eszköz (Data Terminal Equipment) - ez például a számítógépünk</p></dd><dt class=hdlist1>DCE</dt><dd><p>Adatkommunikációs eszköz (Data Communications Equipment) - ez a modem</p></dd><dt class=hdlist1>RS-232</dt><dd><p>a hardveres soros vonali kommunikációhoz szükséges EIA szabványú kábel</p></dd></dl></div><div class=paragraph><p>Amikor ebben a fejezetben az adatátvitel sebességérõl beszélünk, akkor szándékosan nem használjuk a "baud" fogalmát. A baud ugyanis a kommunikációs eszközben adott idõ alatt lezajló jelváltások mennyiségét jelöli, miközben itt a "bps" (bit per másodperc) kifejezés használata a <em>helyes</em> (vagy legalább is a szõrszálhasogatók egyelõre megnyugodhatnak).</p></div></div><div class=sect3><h4 id=serial-cables-ports>26.2.2. Kábelek és portok<a class=anchor href=#serial-cables-ports></a></h4><div class=paragraph><p>Ha a FreeBSD rendszerünkhöz egy modemet vagy egy terminált akarunk csatlakoztatni, akkor ahhoz a számítógépünkben szükség lesz egy szabad soros portra és egy megfelelõ típusú kábelre. Ha már tisztában vagyunk a rendelkezésre álló hardverrel és a hozzá tartozó kábellel, akkor nyugodtan átléphetjük ezt a részt.</p></div><div class=sect4><h5 id=term-cables>26.2.2.1. A kábelek fajtái<a class=anchor href=#term-cables></a></h5><div class=paragraph><p>A soros kábeleknek több különbözõ típusa van. Közülük a céljainknak leginkább megfelelõ két legismertebb változatuk az ún. null-modem és a szabványos ("egyenes") RS-232-es soros kábelek. A hardverhez tartozó dokumentációban megtaláljuk, hogy pontosan melyik típus tartozik hozzá.</p></div><div class=sect5><h6 id=term-cables-null>26.2.2.1.1. A null-modem kábelek<a class=anchor href=#term-cables-null></a></h6><div class=paragraph><p>Egy null-modem kábel bizonyos jeleket, többek közt a "földet" (Signal Ground, SG), egyenesen küldi, másokat viszont felcserélten. Például az "átküldött adat" (Transmitted Data, TD) jelzésû tû a kábel másik végén a "fogadott adat" (Received Data, RD) tûhöz fut be.</p></div><div class=paragraph><p>A terminálokhoz akár saját magunk is le tudunk gyártani egy null-modem kábelt (például ha a boltiakkal nem lennénk megelégedve). A következõ táblázatban az RS-232C <a href=#serialcomms-signal-names>jeleit</a> és érintkezõinek számozását láthatjuk egy DB-25-ös csatlakozó esetében. A szabvány a kábel két 1-es tûjét összekapcsoló vonalat <em>védõföldnek</em> (Protective Ground, PD) nevezi, de ezt gyakran el is hagyják. Némely terminál remekül mûködik mindössze a 2-es, 3-as és 7-es tûk használatával, miközben mások az iménti példától eltérõ kiosztást igényelnek.</p></div><table class="tableblock frame-none grid-all stretch"><caption class=title>Táblázat 8. A DB-25 DB-25 közti null-modem kábel</caption><col style=width:20%><col style=width:20%><col style=width:20%><col style=width:20%><col style=width:20%><thead><tr><th class="tableblock halign-left valign-top">Jel</th><th class="tableblock halign-left valign-top">Tû</th><th class="tableblock halign-left valign-top"></th><th class="tableblock halign-left valign-top">Tû</th><th class="tableblock halign-left valign-top">Jel</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class=tableblock>SG</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>7</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>párja:</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>7</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>SG</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>TD</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>2</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>párja:</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>3</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>RD</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>RD</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>3</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>párja:</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>2</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>TD</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>RTS</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>4</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>párja:</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>5</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>CTS</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>CTS</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>5</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>párja:</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>4</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>RTS</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>DTR</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>20</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>párja:</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>6</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>DSR</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>DTR</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>20</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>párja:</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>8</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>DCD</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>DSR</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>6</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>párja:</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>20</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>DTR</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>DCD</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>8</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>párja:</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>20</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>DTR</p></td></tr></tbody></table><div class=paragraph><p>Íme a mostanság elterjedt másik két séma.</p></div><table class="tableblock frame-none grid-all stretch"><caption class=title>Táblázat 9. A DB-9 DB-9 közti null-modem kábel</caption><col style=width:20%><col style=width:20%><col style=width:20%><col style=width:20%><col style=width:20%><thead><tr><th class="tableblock halign-left valign-top">Jel</th><th class="tableblock halign-left valign-top">Tû</th><th class="tableblock halign-left valign-top"></th><th class="tableblock halign-left valign-top">Tû</th><th class="tableblock halign-left valign-top">Jel</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class=tableblock>RD</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>2</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>párja:</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>3</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>TD</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>TD</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>3</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>párja:</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>2</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>RD</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>DTR</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>4</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>párja:</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>6</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>DSR</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>DTR</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>4</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>párja:</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>1</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>DCD</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>SG</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>5</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>párja:</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>5</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>SG</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>DSR</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>6</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>párja:</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>4</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>DTR</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>DCD</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>1</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>párja:</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>4</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>DTR</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>RTS</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>7</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>párja:</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>8</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>CTS</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>CTS</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>8</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>párja:</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>7</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>RTS</p></td></tr></tbody></table><table class="tableblock frame-none grid-all stretch"><caption class=title>Táblázat 10. DB-9 DB-25 közti null-modem kábel</caption><col style=width:20%><col style=width:20%><col style=width:20%><col style=width:20%><col style=width:20%><thead><tr><th class="tableblock halign-left valign-top">Jel</th><th class="tableblock halign-left valign-top">Tû</th><th class="tableblock halign-left valign-top"></th><th class="tableblock halign-left valign-top">Tû</th><th class="tableblock halign-left valign-top">Jel</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class=tableblock>RD</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>2</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>párja:</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>2</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>TD</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>TD</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>3</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>párja:</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>3</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>RD</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>DTR</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>4</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>párja:</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>6</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>DSR</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>DTR</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>4</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>párja:</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>8</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>DCD</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>SG</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>5</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>párja:</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>7</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>SG</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>DSR</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>6</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>párja:</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>20</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>DTR</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>DCD</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>1</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>párja:</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>20</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>DTR</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>RTS</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>7</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>párja:</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>5</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>CTS</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>CTS</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>8</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>párja:</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>4</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>RTS</p></td></tr></tbody></table><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Amikor egy tû az átellenes oldalon két másik tûhöz csatlakozik, akkor azt általában úgy valósítják meg, hogy a két tût a saját oldalukon összekötik, majd ezt kapcsolják hozzá a harmadik tûhöz.</p></div></td></tr></tbody></table></div><div class=paragraph><p>Ezek a megoldások a legnépszerûbbek. Természetesen a tûk összekötésének több más variációja is létezik (ezekrõl az <em>RS-232 Made Easy</em> c. könyvben olvashatunk bõvebben), ahol az SG párja az SG, a TD párja az RD, az RTS és a CTS párja az DCD, a DTR párja a DSR és ugyanezek fordítva.</p></div></div><div class=sect5><h6 id=term-cables-std>26.2.2.1.2. Szabványos RS-232C kábelek<a class=anchor href=#term-cables-std></a></h6><div class=paragraph><p>A szabványos soros kábel az összes RS-232C jelet közvetlenül átküldi. Vagyis a kábel egyik végén levõ "átküldött adat" tû a másik végén is az "átküldött adat" tûhöz csatlakozik. Az ilyen típusú kábeleket többnyire a számítógépek és a modemek között alkalmazzák, de egyes termináltípusok esetében is szükségünk lehet rá.</p></div></div></div><div class=sect4><h5 id=term-ports>26.2.2.2. A portok<a class=anchor href=#term-ports></a></h5><div class=paragraph><p>A soros port olyan eszköz, amelyen keresztül a FreeBSD-s gép és a terminál között adatokat tudunk közvetíteni. Ebben a szakaszban az ilyen portok különféle típusait és ezek használatát ismertetjük FreeBSD alatt.</p></div><div class=sect5><h6 id=term-portkinds>26.2.2.2.1. A portok típusai<a class=anchor href=#term-portkinds></a></h6><div class=paragraph><p>A soros portoknak több típusa létezik. Mielõtt vásárolnánk egy készítenénk egy soros kábelt, mindenképpen gyõzödjünk meg róla, hogy csatlakoztatni tudjuk majd a FreeBSD-s rendszerünkhöz és a terminálhoz egyaránt.</p></div><div class=paragraph><p>A legtöbb terminálon DB-25-ös portot találunk. A személyi számítógépek, köztük azok, amelyeken FreeBSD fut, DB-25-ös és DB-9es portokkal rendelkeznek. Ha a gépünkben egy többportos soros kártya van, akkor ezeken kívül még RJ-12-es és RJ-45-ös portjaink is lehetnek.</p></div><div class=paragraph><p>A hardverhez tartozó dokumentációból tudjuk kideríteni az adott port konkrét fajtáját, de gyakran a port vizuális vizsgálata is segíthet eldönteni a kérdést.</p></div></div><div class=sect5><h6 id=term-portnames>26.2.2.2.2. A portok nevei<a class=anchor href=#term-portnames></a></h6><div class=paragraph><p>FreeBSD alatt az egyes soros portokat a <span class=filename>/dev</span> könyvtárban található eszközleírókon keresztül tudjuk elérni. Ezeknek két típusa van:</p></div><div class=ulist><ul><li><p>A behíváshoz használt portok nevei <span class=filename>/dev/ttydN</span> alakúak, ahol az <em>N</em> a port sorszáma, ami nullától indul. A behívó portok alapvetõen a terminál esetében használatosak. A behívó portok használatához a soros vonalon az "vonal észlelése" (Data Carrier Detect, DCD) jelnek kell megbízhatóan mûködnie.</p></li><li><p>A híváshoz használt portok nevei <span class=filename>/dev/cuadN</span> alakúak. A hívó portokat terminálok esetében ritkán alkalmazzák, helyettük inkább csak modemekhez használják. A hívó portokat akkor érdemes használni, ha a soros kábel vagy a terminál nem ismeri a DCD jelet.</p></li></ul></div><div class=paragraph><p>Ha a terminált az elsõ soros portra (ami MS-DOS®-ban a <span class=filename>COM1</span>) csatlakoztattuk, akkor a <span class=filename>/dev/ttyd0</span> segítségével fogunk rá hivatkozni. Ha viszont a második soros porton (más néven <span class=filename>COM2</span>) található, akkor a <span class=filename>/dev/ttyd1</span> eszközt használjuk, és így tovább.</p></div></div></div></div><div class=sect3><h4 id=_a_rendszermag_beállítása_2>26.2.3. A rendszermag beállítása<a class=anchor href=#_a_rendszermag_beállítása_2></a></h4><div class=paragraph><p>A FreeBSD alapból négy soros portot támogat. Az MS-DOS® világban ezeket rendre <span class=filename>COM1</span>, <span class=filename>COM2</span>, <span class=filename>COM3</span> és <span class=filename>COM4</span> portoknak nevezik. A FreeBSD jelen pillanatban ismeri még a "butább" többportos soros csatolókártyákat is, például a BocaBoard 1008 és 2016 típusokat, valamint több intelligensebb többportos kártyát, például a Digiboard és a Stallion Technologies gyártmányait. Az alap rendszermag azonban csak a szabványos COM portokat keresi.</p></div><div class=paragraph><p>Ha ellenõrizni akarjuk, hogy a rendszermag rendben megtalálta a soros portokat, akkor figyelmesen olvassuk el a rendszerindítás során megjelenõ üzeneteket, vagy az <code>/sbin/dmesg</code> parancs kiadásával kérdezzük vissza a rendszermag üzeneteit. Különösen a <code>sio</code> kezdetû sorokra kell figyelnünk.</p></div><div class="admonitionblock tip"><table><tbody><tr><td class=icon><i class="fa icon-tip" title=Tip></i></td><td class=content><div class=paragraph><p>Az alábbi paranccsal tudjuk leszûrni a <code>sio</code> szövegrészt tartalmazó sorokat:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># /sbin/dmesg | grep &#39;sio&#39;</span></code></pre></div></div></td></tr></tbody></table></div><div class=paragraph><p>Például, ha négy soros port található a rendszerünkben, akkor a rájuk vonatkozó rendszerüzenetek a következõk lesznek:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>sio0 at 0x3f8-0x3ff irq 4 on isa
sio0: <span class=nb>type </span>16550A
sio1 at 0x2f8-0x2ff irq 3 on isa
sio1: <span class=nb>type </span>16550A
sio2 at 0x3e8-0x3ef irq 5 on isa
sio2: <span class=nb>type </span>16550A
sio3 at 0x2e8-0x2ef irq 9 on isa
sio3: <span class=nb>type </span>16550A</code></pre></div></div><div class=paragraph><p>Ha a rendszermagunk nem ismerte volna fel az összes soros portot, akkor valószínûleg a <span class=filename>/boot/device.hints</span> állományt kell módosítanunk. Tegyük megjegyzésbe vagy akár teljesen távolítsuk is el azokat az eszközöket, amelyekkel nem rendelkezünk.</p></div><div class=paragraph><p>A soros portok és a többportos kártyák beállításával kapcsolatban a <a href="https://man.freebsd.org/cgi/man.cgi?query=sio&amp;sektion=4&amp;format=html">sio(4)</a> man oldalát olvassuk el. Óvatosan bánjunk a FreeBSD megelõzõ változataiból származó konfigurációs állományokkal, mert az eszközök vonatkozó beállításokat és azok formátuma megváltozhatott azóta.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Az <code>port IO_COM1</code> a <code>port 0x3f8</code>, az <code>IO_COM2</code> a <code>0x2f8</code>, az <code>IO_COM3</code> a <code>0x3e8</code> és az <code>IO_COM4</code> a <code>0x2e8</code> beállítást helyettesíti. Ezek az adott porthoz tartozó gyakori címeket képviselik. A 4-es, 3-as, 5-ös és 9 megszakítások is igen általánosak ezeknél. A hagyományos soros portok viszont az ISA buszos PC-k esetében <em>nem képesek</em> a megszakításokon osztozni. (A többportos kártyák azonban lehetõvé teszik az 16550A számára, hogy mindössze egy vagy két megszakítást használjon.)</p></div></td></tr></tbody></table></div></div><div class=sect3><h4 id=_speciális_eszközállományok>26.2.4. Speciális eszközállományok<a class=anchor href=#_speciális_eszközállományok></a></h4><div class=paragraph><p>A rendszermagban található legtöbb eszköz az ún. "speciális eszközállományokon" keresztül érhetõ el, melyek a <span class=filename>/dev</span> könyvtárban találhatóak. A <span class=filename>sio</span> eszközök a <span class=filename>/dev/ttydN</span> (behívó portok) és <span class=filename>/dev/cuadN</span> (hívó portok) állományok használatával érhetõek el. A FreeBSD ezenkívül még külön eszközállományokat biztosít az inicializációhoz (<span class=filename>/dev/cuadN.init</span>) és a zároláshoz (<span class=filename>/dev/cuadN.lock</span>). Az inicializációs állományok a port megnyitásakor használhatóak a hozzá tartozó paraméterek beállítására, például így tudjuk elküldeni a <code>crtscts</code> utasítást az olyan modemeknek, amelyek a forgalom irányítását <code>RTS/CTS</code> jelzéseken keresztül valósítják meg. A zároló állományokkal a portokra vonatkozó zárolásokat állíthatjuk be, így a felhasználók vagy a programok nem lesznek képesek bizonyos paramétereket megváltoztatni. A <a href="https://man.freebsd.org/cgi/man.cgi?query=termios&amp;sektion=4&amp;format=html">termios(4)</a>, <a href="https://man.freebsd.org/cgi/man.cgi?query=sio&amp;sektion=4&amp;format=html">sio(4)</a> és <a href="https://man.freebsd.org/cgi/man.cgi?query=stty&amp;sektion=1&amp;format=html">stty(1)</a> man oldalakon olvashatunk részletesebben a terminálok beállításairól, valamint az eszközök zárolásáról és inicializálásáról.</p></div></div><div class=sect3><h4 id=serial-hw-config>26.2.5. A soros port beállítása<a class=anchor href=#serial-hw-config></a></h4><div class=paragraph><p>A <span class=filename>ttydN</span> (vagy <span class=filename>cuadN</span>) lesz az az eszköz, amit majd az alkalmazásainkból el akarunk érni. Amikor egy futó program megnyit egy ilyen eszközt, mindig tartoznak hozzá alapértelmezett terminál I/O beállítások. Ezeket a következõ paranccsal tudjuk lekérdezni:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># stty -a -f /dev/ttyd1</span></code></pre></div></div><div class=paragraph><p>Ha megváltoztatjuk az eszköz beállításait, akkor azok egészen addig érvényben is maradnak, amíg le nem zárjuk. Ha tehát ezután újra megnyitjuk, akkor minden visszaáll az alapértelmezett állapotra. Az alapértelmezett beállítások megváltoztatásához a "kezdeti állapotot" szimbolizáló eszközt kell megnyitnunk és átállítanunk. Például, ha alapból engedélyezni akarjuk a <code>CLOCAL</code> módot, a 8 bites kommunikációt és a <code>XON/XOFF</code> típusú forgalomirányítást a <span class=filename>ttyd5</span> eszközön, akkor a következõt gépeljük be:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># stty -f /dev/ttyd5.init clocal cs8 ixon ixoff</span></code></pre></div></div><div class=paragraph><p>A soros eszközök rendszerszintû inicializálását az <span class=filename>/etc/rc.d/serial</span> állomány vezérli. Lényegében ez határozza meg az összes soros eszköz alapértelmezett beállítását.</p></div><div class=paragraph><p>Ha bizonyos beállítások megváltoztatását tiltani szeretnénk az alkalmazások felé, akkor azt a "zárolt állapotot" tartalmazó eszközben kell rögzítenünk. Például, ha a <span class=filename>ttyd5</span> eszköz sebességét fixen 57600 bps-ra akarjuk beállítani, akkor írjuk be ezt:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># stty -f /dev/ttyd5.lock 57600</span></code></pre></div></div><div class=paragraph><p>Ezután ha egy alkalmazás megnyitja a <span class=filename>ttyd5</span> eszközt és megpróbálja a port sebességét átállítani, akkor az továbbra is 57600 bps marad.</p></div><div class=paragraph><p>A kezdeti és a zárolt állapotot képezõ eszközöket általában csak a <code>root</code> felhasználó számára szabad írhatóvá tenni.</p></div></div></div><div class=sect2><h3 id=term>26.3. Terminálok<a class=anchor href=#term></a></h3><div class=paragraph><p>A terminálok olyankor kínálnak kényelmes és költséghatékony hozzáférést a FreeBSD rendszerünkhöz, amikor sem a gép konzolját, sem pedig a hozzá tartozó hálózatot nem érjük el. Ebben a szakaszban olvashatjuk, miként kell terminálokat használni FreeBSD alatt.</p></div><div class=sect3><h4 id=term-uses>26.3.1. A terminálok alkalmazásai és típusai<a class=anchor href=#term-uses></a></h4><div class=paragraph><p>Az eredeti UNIX® rendszereknek nem voltak konzoljaik. Ehelyett az emberek a soros portokra csatlakoztatott terminálokon keresztül jelentkeztek be és így futtattak rajtuk programokat. Ez nagyon hasonlít ahhoz, mint amikor egy modem és egy terminálprogram felhasználásával betárcsázunk egy távoli gépre és vele szöveges módban dolgozunk.</p></div><div class=paragraph><p>Napjaink személyi számítógépein azonban találhatunk már akár nagy felbontású megjelenítéssel megáldott konzolokat is, habár a soros porton keresztüli bejelentkezés lehetõsége még mind a mai napig elérhetõ a legtöbb UNIX®-alapú rendszerben. Ez alól a FreeBSD sem kivétel. Ha rákötünk egy terminált a gépünk egyik üres soros portjára, akkor a megszokott módon képesek vagyunk bejelentkezni a rendszerbe és futtatni bármilyen szöveges programot, hasonlóan ahhoz, ahogy azt a konzolban vagy az X Window Systemben egy <code>xterm</code> ablakban megtehetjük.</p></div><div class=paragraph><p>Ha egy irodában vagyunk, akkor egy FreeBSD rendszerre több terminált is kapcsolhatunk, melyek az alkalmazottak asztalain foglalnak helyet. Otthoni használat esetén egy kiöregedett számítógép, például egy régi IBM PC vagy egy Macintosh® is ráköthetõ egy gyorsabb FreeBSD rendszerre. Ennek segítségével az egyébként egyfelhasználós számítógépünket egy valódi többfelhasználós rendszerré alakíthatjuk.</p></div><div class=paragraph><p>A FreeBSD esetén háromféle terminálról beszélhetünk:</p></div><div class=ulist><ul><li><p><a href=#term-dumb>A buta (dumb) terminálok</a></p></li><li><p><a href=#term-pcs>A terminálként funkcionáló személyi számítógépek</a></p></li><li><p><a href=#term-x>Az X terminálok</a></p></li></ul></div><div class=paragraph><p>A most következõ alszakaszokban ezeket fejtjük ki részletesebben.</p></div><div class=sect4><h5 id=term-dumb>26.3.1.1. A buta terminálok<a class=anchor href=#term-dumb></a></h5><div class=paragraph><p>A buta terminál alatt olyan speciálizált eszközt értünk, amellyel soros vonalon keresztül csatlakozunk számítógépekhez. Azért nevezik ezeket "butának", mert csupán annyi számítási teljesítményt zsúfoltak beléjük, hogy szöveget legyenek képesek küldeni, fogadni és megjeleníteni. Semmilyen program nem képes rajtuk futni. Helyette az a számítógép fogja a szövegszerkesztõt, fordítóprogramot, levelezõ klienst, játékot és a többit futtatni, amelyre vele kapcsolódtunk.</p></div><div class=paragraph><p>A buta termináloknak többszáz, különbözõ gyártmányú fajtája létezik. Ilyenek például a Digital Equipment VT-100 vagy a Wyse WY-75 típusú termináljai. A FreeBSD szinte mindegyiküket ismeri. Egyes drágább terminálok még grafikus megjelenítésre is képesek, de ezeket a lehetõségeket csak bizonyos szoftverek tudják ténylegesen kihasználni.</p></div><div class=paragraph><p>A buta terminálok leginkább olyan munkahelyeken terjedtek el, ahol az alkalmazottaknak nincs szükségük grafikus alkalmazások, tehát például az X Window System használatára.</p></div></div><div class=sect4><h5 id=term-pcs>26.3.1.2. Személyi számítógépek mint terminálok<a class=anchor href=#term-pcs></a></h5><div class=paragraph><p>Ha egy <a href=#term-dumb>buta terminál</a> csupán szöveg küldésére, fogadására és megjelenítésére képes, akkor bármelyik személyi számítógép utána tudja mindezt csinálni. Ehhez mindössze egy megfelelõ kábelre és az adott gépen futó <em>terminál emulációs</em> szoftverre van szükségünk.</p></div><div class=paragraph><p>Az ilyen fajta megoldás nagyon elterjedt az otthoni használat esetén. Például, ha valamelyik családtagunk éppen szorgalmasan dolgozik a FreeBSD rendszerkonzolján, akkor a rákapcsolt terminálon keresztül még mi magunk is el tudunk végezni valamennyi szöveges felületet igénylõ munkát.</p></div><div class=paragraph><p>Az alap FreeBSD rendszerben legalább két segédprogram használható a soros vonali kapcsolaton keresztüli munkára: a <a href="https://man.freebsd.org/cgi/man.cgi?query=cu&amp;sektion=1&amp;format=html">cu(1)</a> és a <a href="https://man.freebsd.org/cgi/man.cgi?query=tip&amp;sektion=1&amp;format=html">tip(1)</a>.</p></div><div class=paragraph><p>Egy FreeBSD rendszerû kliensrõl így tudunk csatlakozni egy másik rendszerre:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># cu -l soros-vonali-eszköz</span></code></pre></div></div><div class=paragraph><p>Ahol a "soros-vonali-eszköz" a rendszerünkben a soros portot jelölõ speciális eszköz neve. Az ilyen eszközök neve <span class=filename>/dev/cuadN</span>.</p></div><div class=paragraph><p>Az eszköz nevében az "N"-es rész a soros port sorszámát adja meg.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>A FreeBSD-ben az eszközök sorszámozása nullától kezdõdik, nem pedig egytõl (ellentétben tehát azzal, ahogy azt az MS-DOS® rendszerekben és leszármazottaikban már megszokhattuk). Ez azt jelenti, hogy amit az MS-DOS® alapú rendszerekben <span class=filename>COM1</span>-nek hívnak, az a FreeBSD-ben általában a <span class=filename>/dev/cuad0</span>.</p></div></td></tr></tbody></table></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Egyes emberek más, többnyire a Portgyûjteménybõl is elérhetõ programokat szeretnek inkább használni. A portok között találhatunk elég sok olyan szoftvert, amely a <a href="https://man.freebsd.org/cgi/man.cgi?query=cu&amp;sektion=1&amp;format=html">cu(1)</a> és a <a href="https://man.freebsd.org/cgi/man.cgi?query=tip&amp;sektion=1&amp;format=html">tip(1)</a> programokhoz hasonlóan mûködik. Ilyen például a <a class=package href=https://cgit.freebsd.org/ports/tree/comms/minicom/>comms/minicom</a>.</p></div></td></tr></tbody></table></div></div><div class=sect4><h5 id=term-x>26.3.1.3. Az X terminálok<a class=anchor href=#term-x></a></h5><div class=paragraph><p>Az X terminálok a terminálok közül a legfejlettebbek. Általában nem is soros porton, hanem hálózaton, például Etherneten keresztül csatlakoznak. Természetesen nem csak szöveges alkalmazásokat, hanem lényegében bármilyen X alkalmazást képesek megjeleníteni.</p></div><div class=paragraph><p>Az X terminálokról itt most csak a teljesség kedvéért szólunk, de ebben a fejezetben <em>nem</em> szándékozunk tárgyalni az X terminálok csatlakoztatását, beállítását és használatát.</p></div></div></div><div class=sect3><h4 id=term-config>26.3.2. Beállítás<a class=anchor href=#term-config></a></h4><div class=paragraph><p>Ebben a fejezetben ismertetjük mindazt, ami ahhoz kell, hogy a FreeBSD rendszerünkön engedélyezni tudjuk a terminálon keresztüli bejelentkezéseket. Feltételezzük, hogy a rendszermagunk támogatja a terminálok által használt soros portokat, illetve, hogy ezeket már csatlakoztattuk is.</p></div><div class=paragraph><p>Ha visszagondolunk a <a href=./#boot>A FreeBSD rendszerindítási folyamata</a>re, akkor eszünkbe juthat, hogy a rendszer indításakor az <code>init</code> nevû program felelõs az összes futó program irányításáért és inicializálódásáért. Az <code>init</code> egyik feladata, hogy beolvassa az <span class=filename>/etc/ttys</span> állományt és neki megfelelõen az elérhetõ terminálokon elindítsa a <code>getty</code> programot. A <code>getty</code> felelõs a bejelentkezéshez szükséges azonosító beolvasásáért és a <code>login</code> program elindításáért.</p></div><div class=paragraph><p>Ennek megfelelõen tehát, ha a FreeBSD rendszerünkön terminálokat akarunk beállítani, akkor ehhez a következõ lépéseket kell megtennünk <code>root</code> felhasználóként:</p></div><div class="exampleblock procedure"><div class=content><div class="olist arabic"><ol class=arabic><li><p>Az <span class=filename>/etc/ttys</span> állományba vegyünk fel egy bejegyzést a soros porthoz tartozó <span class=filename>/dev</span> könyvtárbeli eszközhöz, ha még nem szerepelne benne.</p></li><li><p>A porthoz adjuk meg a <code>/usr/libexec/getty</code> programot, majd hozzá az <span class=filename>/etc/gettytab</span> állományból válasszuk ki a megfelelõ <em>getty</em> típust.</p></li><li><p>Adjuk meg a terminál alapértelmezett típusát.</p></li><li><p>Állítsuk a portot "on" (bekapcsolt) állapotúra.</p></li><li><p>Adjuk meg, hogy a port "secure" (biztonságos) legyen-e.</p></li><li><p>Mondjuk meg az <code>init</code> programnak, hogy olvassa újra az <span class=filename>/etc/ttys</span> állományt.</p></li></ol></div></div></div><div class=paragraph><p>A másik lépés kiegészítõ lépéseként az <span class=filename>/etc/gettytab</span> állományban mi magunk is létrehozhatunk egy saját <em>getty</em> típust. A fejezetben ehhez ugyan nem adunk segítséget, de ha érdekel minket a téma, akkor ezzel kapcsolatban a <a href="https://man.freebsd.org/cgi/man.cgi?query=gettytab&amp;sektion=5&amp;format=html">gettytab(5)</a> és <a href="https://man.freebsd.org/cgi/man.cgi?query=getty&amp;sektion=8&amp;format=html">getty(8)</a> man oldalakat érdemes elolvasni.</p></div><div class=sect4><h5 id=term-etcttys>26.3.2.1. Egy bejegyzés felvétele az <span class=filename>/etc/ttys</span> állományba<a class=anchor href=#term-etcttys></a></h5><div class=paragraph><p>Az <span class=filename>/etc/ttys</span> állományban találhatjuk meg az összes portot, ahonnan a FreeBSD rendszerünk engedélyezi a bejelentkezést. Például a <span class=filename>ttyv0</span>, az elsõ virtuális konzol is szerepel benne. Ezen a bejegyzésen keresztül tudunk bejelentkezni a konzolra. Ebben az állományban találjuk meg még a többi virtuális konzol, soros port és pszeudoterminál bejegyzéseit is. A rögzített terminálok esetén egyszerûen csak adjuk meg a soros porthoz tartozó <span class=filename>/dev</span> könyvtárbeli eszközt a <span class=filename>/dev</span> elõtag nélkül (így például a <span class=filename>/dev/ttyv0</span> <span class=filename>ttyv0</span> néven fog megjelenni).</p></div><div class=paragraph><p>Az alap FreeBSD telepítésben egy olyan <span class=filename>/etc/ttys</span> állomány található, amely tartalmazza az elsõ négy soros portot, a <span class=filename>ttyd0</span> eszköztõl kezdve a <span class=filename>ttyd3</span> eszközig. Ha tehát ezekre a portokra csatlakoztatnunk egy terminált, akkor már nem kell egy újabb bejegyzést felvennünk hozzájuk.</p></div><div id=ex-etc-ttys class=exampleblock><div class=title>Példa 29. Terminálok felvétele az <span class=filename>/etc/ttys</span> állományba</div><div class=content><div class=paragraph><p>Tegyük fel, hogy két eszközt szeretnénk a rendszerünkhöz csatlakoztatni: egy Wyse-50-es terminált és egy régi 286-os IBM PC-t, amelyen a Procomm terminálszoftverrel emulálunk egy VT-100-as terminált. A Wyse terminált a második soros portunkra kötjük, míg a 286-ost a hatodik soros portra (például egy többportos soros vonali kártyán). A nekik megfelelõ <span class=filename>/etc/ttys</span> állománybeli bejegyzések így fognak kinézni:</p></div><div class="literalblock programlisting"><div class=content><pre>ttyd1  &#34;/usr/libexec/getty std.38400&#34;  wy50  on  insecure
ttyd5   &#34;/usr/libexec/getty std.19200&#34;  vt100  on  insecure</pre></div></div><div class=ulist><ul><li><p>Az elsõ mezõben általában a terminálhoz tartozó eszközt nevezzük meg, amely a <span class=filename>/dev</span> könyvtárban található.</p></li><li><p>A második mezõ a vonalhoz tartozó végrehajtandó parancs, ami általában a <a href="https://man.freebsd.org/cgi/man.cgi?query=getty&amp;sektion=8&amp;format=html">getty(8)</a>. A <code>getty</code> mûködésbe helyezi és megnyitja a vonalat, beállítja a sebességét, bekéri a felhasználó nevét, majd elindítja a <a href="https://man.freebsd.org/cgi/man.cgi?query=login&amp;sektion=1&amp;format=html">login(1)</a> programot.A <code>getty</code> program egy (opcionális) paramétert fogad el a parancssorában, ami a <em>getty</em> típusa. Egy ilyen <em>getty</em> típus szabja meg a terminálhoz tartozó vonal jellemzõit, például az adatátviteli sebességet és a paritást. A <code>getty</code> ezeket a jellemzõket az <span class=filename>/etc/gettytab</span> állományból olvassa be.A <span class=filename>/etc/gettytab</span> egyaránt tartalmaz bejegyzéseket a régi és új típusú terminálokhoz. Az <code>std</code> szöveggel kezdõdõ bejegyzések szinte majdnem minden esetben mûködnek a hardveres terminálokkal. Az ilyen bejegyzések figyelmen kívül hagyják a paritást. 110 és 115 200 bps között minden adatátviteli sebességhez tartozik egy-egy <code>std</code> bejegyzés. Természetesen ebbe az állományba akár a saját bejegyzéseinket is elkészíthetjük. A <a href="https://man.freebsd.org/cgi/man.cgi?query=gettytab&amp;sektion=5&amp;format=html">gettytab(5)</a> man oldal nyújt ehhez átfogó segítséget.Amikor az<span class=filename>/etc/ttys</span> állományban megadjuk a <em>getty</em> típusát, akkor ellenõrizzük, hogy a beállításai megfelelnek a terminálénak.A példánknál maradva: a Wyse-50 nem használ paritást és 38 400 bps-en üzemel. A 286-os gép szintén nem dolgozik paritással és 19200 bps-sel kapcsolódik.</p></li><li><p>A harmadik mezõben adjuk meg általában a vonalra csatlakozó terminál típusát. Ez a betárcsázós portok esetében többnyire az <code>unknown</code> vagy a <code>dialup</code>, mivel ezeken keresztül a felhasználók gyakorlatilag szinte bármilyen típusú terminállal vagy szoftverrel be tudnak jelentkezni. A hardveres termináloknál a terminál típusa azonban nem változik, ezért a <a href="https://man.freebsd.org/cgi/man.cgi?query=termcap&amp;sektion=5&amp;format=html">termcap(5)</a> adatbázisban keressük ki a nekik megfelelõt és adjuk meg ebben a mezõben.A példánkban a Wyse-50 egy valós termináltípust használ, miközben a 286-oson futó Procomm egy VT-100-as típusú terminált emulál.</p></li><li><p>A negyedik mezõ azt mondja meg, hogy a port engedélyezett-e vagy sem. Ha itt a <code>on</code> értéket adjuk meg, akkor az <code>init</code> elindítja a második mezõben szereplõ <code>getty</code> programot. Ha viszont itt az <code>off</code> szerepel, akkor a <code>getty</code> nem fog elindulni, így ezen a porton be sem fogunk tudni jelentkezni.</p></li><li><p>Az utolsó mezõben a port megbízhatóságát kell megjelölnünk. Ha biztonságosnak (<code>secure</code>) állítjuk be a portot, akkor rajta keresztül a <code>root</code> (vagy bármelyik nullás felhasználói azonosítóval rendelkezõ) felhasználó be tud jelentkezni. Amikor viszont nem biztonságos (<code>insecure</code>), akkor elõször egy normál felhasználóval kell bejelentkeznünk, majd a <a href="https://man.freebsd.org/cgi/man.cgi?query=su&amp;sektion=1&amp;format=html">su(1)</a> programmal vagy egy hozzá hasonló megoldással kell rendszeradminisztrátorrá válnunk.Leginkább az <code>insecure</code> beállítást javasoljuk, még hét lakat alatt õrzött terminálok esetében is. Valójában sokkal egyszerûbb bejelentkezni, majd kiadni egy <code>su</code> parancsot, ha netalán rendszeradminisztrátori jogosultságokra lenne szükségünk.</p></li></ul></div></div></div></div><div class=sect4><h5 id=term-hup>26.3.2.2. A <code>init</code> utasítása az <span class=filename>/etc/ttys</span> újraolvasására<a class=anchor href=#term-hup></a></h5><div class=paragraph><p>Miután az <span class=filename>/etc/ttys</span> állományban elvégeztük a megfelelõ módosításokat, a konfigurációs állomány újraolvasásához küldjünk egy SIGHUP (bontás) jelzést az <code>init</code> programnak. Mint például:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># kill -HUP 1</span></code></pre></div></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Mivel mindig az <code>init</code> indul el elsõként a rendszerben, ezért a hozzá tartozó azonosító az 1 lesz.</p></div></td></tr></tbody></table></div><div class=paragraph><p>Ha mindent jól állítottunk be, a kábelek is a helyükön vannak és a terminálokat is bekapcsoltuk, akkor minden terminálhoz elindul egy <code>getty</code> program, és mindegyikõjükön megjelenik a bejelentkezõ képernyõ.</p></div></div></div><div class=sect3><h4 id=term-debug>26.3.3. A terminálokkal kapcsolatos hibajelenségek<a class=anchor href=#term-debug></a></h4><div class=paragraph><p>Olykor hiába igyekszünk a lehetõ legaprólékosabban ügyelni minden apró részletre, könnyen elõfordulhat, hogy valamiért a terminál mégsem mûködik rendesen. Következzen most egy lista néhány ismert tünetrõl és azok javasolt gyógymódjairól.</p></div><div class=sect4><h5 id=_nem_jelenik_meg_a_bejelentkezõ_képernyõ>26.3.3.1. Nem jelenik meg a bejelentkezõ képernyõ<a class=anchor href=#_nem_jelenik_meg_a_bejelentkezõ_képernyõ></a></h5><div class=paragraph><p>Ellenõrizzük, hogy a terminált rendesen csatlakoztattuk és áram alá helyeztük. Amikor egy személyi számítógépet használunk terminálnak, akkor nézzük meg, hogy a terminál emulációs program a megfelelõ soros porton fut.</p></div><div class=paragraph><p>Vizsgáljuk meg, hogy a kábel mind a két vége pontosan illeszkedik a portokba. Gyõzõdjünk meg róla, hogy valóban a megfelelõ típusú kábelt használjuk.</p></div><div class=paragraph><p>Nézzük meg, hogy a terminál és a FreeBSD is ugyanazon az adatátviteli sebességen és paritási beállítással megy. Ha képernyõvel rendelkezõ terminálunk van, akkor a kontrasztot és fényerõsséget is ellenõrizzük. Ha nyomtatós terminálunk van, akkor vizsgáljuk meg a papír és a tinta állapotát.</p></div><div class=paragraph><p>Gyõzõdjünk meg róla, hogy a <code>getty</code> valóban fut és rendesen kiszolgálja a terminált. Például a <code>ps</code> paranccsal listázzuk ki az összes jelenleg futó programot és keressük meg köztük a <code>getty</code> programot:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># ps -axww|grep getty</span></code></pre></div></div><div class=paragraph><p>Ekkor látnunk kell a terminálhoz tartozó bejegyzést. Például, ha a <code>getty</code> második soros portot jelképezõ <span class=filename>ttyd1</span> eszközön fut, és az <span class=filename>/etc/gettytab</span> állományból az <code>std.38400</code> nevû bejegyzést használja, akkor ez jelenik meg:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>22189  d1  Is+    0:00.03 /usr/libexec/getty std.38400 ttyd1</code></pre></div></div><div class=paragraph><p>Amennyiben semmilyen <code>getty</code> nem fut, akkor ellenõrizzük, hogy valóban engedélyeztük-e a portot az <span class=filename>/etc/ttys</span> állományban. A <span class=filename>ttys</span> állomány átírása után ne felejtsük el kiadni a <code>kill -HUP 1</code> parancsot sem.</p></div><div class=paragraph><p>Ha a <code>getty</code> fut, de a terminálon továbbra sem látjuk a bejelentkezõ képernyõt, vagy megjelenik, de nem tudunk gépelni, akkor elõfordulhat, hogy a terminál vagy kábel nem támogatja a hardveres kézfogást (handshaking). Próbáljuk meg az <span class=filename>/etc/ttys</span> állományban levõ <code>std.38400</code> bejegyzést az <code>3wire.38400</code> bejegyzésre kicserélni (de utána ne felejtsük el kiadni a <code>kill -HUP 1</code> parancsot). A <code>3wire</code> nagyon hasonlít az <code>std</code> bejegyzéshez, de elhagyja a hardveres kézfogást. A <code>3wire</code> alkalmazásakor viszont a puffer telítõdésének megelõzése érdekében próbálkozzunk az adatátviteli sebesség csökkentésével vagy engedélyezzük a szoftveres forgalomirányítást.</p></div></div><div class=sect4><h5 id=_amikor_mindenféle_szemét_jelenik_meg_a_képernyõn>26.3.3.2. Amikor mindenféle szemét jelenik meg a képernyõn<a class=anchor href=#_amikor_mindenféle_szemét_jelenik_meg_a_képernyõn></a></h5><div class=paragraph><p>Ellenõrizzük, hogy a FreeBSD és a terminál ugyanazt az adatátviteli sebességet és paritási beállítást használja. Nézzük meg a futó <code>getty</code> programokat, és hogy a megfelelõ <em>getty</em> típussal mennek-e. Ha nem, módosítsuk az <span class=filename>/etc/ttys</span> állományt és adjuk ki a <code>kill -HUP 1</code> parancsot.</p></div></div><div class=sect4><h5 id=_a_karakterek_duplán_jelennek_meg_a_jelszó_begépelésekor_látható>26.3.3.3. A karakterek duplán jelennek meg, a jelszó begépelésekor látható<a class=anchor href=#_a_karakterek_duplán_jelennek_meg_a_jelszó_begépelésekor_látható></a></h5><div class=paragraph><p>Állítsuk át a terminált (vagy a terminál emulációs szofvert) "half duplex" vagy "local echo" módról "full duplex" módra.</p></div></div></div></div><div class=sect2><h3 id=dialup>26.4. Betárcsázós szolgáltatások<a class=anchor href=#dialup></a></h3><div class=paragraph><p>Amikor egy FreeBSD rendszert akarunk betárcsázós szolgáltatásokhoz beállítani, akkor az nagyon hasonlít a terminálok csatlakoztatásához, azzal a eltéréssel, hogy ilyenkor a terminálok helyett modemekkel kell dolgoznunk.</p></div><div class=sect3><h4 id=_külsõ_kontra_belsõ_modemek>26.4.1. Külsõ kontra belsõ modemek<a class=anchor href=#_külsõ_kontra_belsõ_modemek></a></h4><div class=paragraph><p>A külsõ modemek sokkal kényelmesebbnek tûnnek betárcsázás szempontjából, mivel az ilyenek gyakran a statikus memóriájukban tárolt paraméterek révén tulajdonképpen félig elõre be vannak állítva és sok esetben a fontosabb RS-232 jeleket külön lámpácskákkal mutatják. A villogó lámpák könnyen elkápráztatják a laikusokat, de emellett igen fontosak a modem mûködõképességének megállapításában is.</p></div><div class=paragraph><p>Ezzel szemben a belsõ modemeken nem található statikus memória, ezért a paramétereik csak DIP kapcsolókkal módosíthatóak. Még ha egy belsõ modemem látunk is lámpákat, akkor sem könnyû figyelni rájuk, mert a gépünk burkolata úgyis eltakarja ezeket.</p></div><div class=sect4><h5 id=_modemek_és_kábelek>26.4.1.1. Modemek és kábelek<a class=anchor href=#_modemek_és_kábelek></a></h5><div class=paragraph><p>Ha külsõ modemet használunk, akkor mindenképpen szükségünk lesz hozzá még egy megfelelõ kábelre is. Egy szabványos RS-232-es soros kábel erre tökéletesen megfelel egészen addig, amíg a normál jeleket így kötötték be rajta:</p></div><table id=serialcomms-signal-names class="tableblock frame-none grid-all stretch"><caption class=title>Táblázat 11. A jelek neve</caption><col style=width:50%><col style=width:50%><thead><tr><th class="tableblock halign-left valign-top">Rövidítés</th><th class="tableblock halign-left valign-top">Elnevezés</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class=tableblock>RD</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Received Data (fogadott adat)</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>TD</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Transmitted Data (küldött adat)</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>DTR</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Data Terminal Ready (adatterminál kész)</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>DSR</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Data Set Ready (adatbeállítás kész)</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>DCD</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Data Carrier Detect (vonal észlése - az RS-232 fogadást érzékelõ vonala)</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>SG</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Signal Ground (föld)</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>RTS</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Request to Send (küldés kérése)</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>CTS</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Clear to Send (küldés engedélyezése)</p></td></tr></tbody></table><div class=paragraph><p>A FreeBSD-nek 2400 bps felett a forgalom irányításához az RTS és CTS jelekre van szüksége. A CD jellel állapítja meg, hogy a hívás létrejött vagy a bontották a vonalat, és a DTR jel hozza alapállapotba a modemet a munkamenet befejezése után. Egyes kábelekben nem mindegyik jelet vezették át, így ha például gondjaink akadnak a bejelentkezõ képernyõvel amikor a vonalat bontjuk, akkor érdemes átnéznünk a kábelt.</p></div><div class=paragraph><p>A többi UNIX®-szerû operációs rendszerhez hasonlóan a FreeBSD is hardveres jelek segítségével igyekszik kideríteni, hogy a hívás megvalósult vagy bontották a vonalat, valamint a hívás befejezése után így bontja a vonalat és állítja vissza a modemet. A FreeBSD igyekszik elkerülni a parancsok küldését a modem felé, vagy a modem állapotának folyamatos ellenõrzését. Ha már van némi tapasztalatunk a PC-alapú BBS-ek modemes elérését illetõen, akkor valószínûleg értjük ezek okait.</p></div></div></div><div class=sect3><h4 id=_a_soros_vonali_felülettel_kapcsolatos_megfontolások>26.4.2. A soros vonali felülettel kapcsolatos megfontolások<a class=anchor href=#_a_soros_vonali_felülettel_kapcsolatos_megfontolások></a></h4><div class=paragraph><p>A FreeBSD ismeri az NS8250-, NS16450-, NS16550- és NS16550A alapú EIA RS-232C (CCITT V.24) szabványú kommunikációs felületeket. A 8250-es és a 16450-es eszközök egykarakteres pufferrel rendelkeznek. A 16550-es eszközök 16 karakteres puffert tartalmaznak, amellyel jobb teljesítmény érhetõ el. (A sima 16550-esben levõ hibák miatt azonban ez a 16 karakteres puffer nem használható ki rendesen, ezért lehetõleg a 16550A verziót használjuk). Mivel az operációs rendszer részérõl az egykarakteres eszközök jóval több törõdést igényelnek, mint a 16 karakteres eszközök, ezért inkább a 16550A alapú soros felületi kártyákat ajánljuk. Amikor a rendszer egyszerre több soros portot is kezel, vagy erõs terhelés alatt áll, akkor a 16550A alapú kártyákról általában az is elmondható, hogy kisebb hibával dolgoznak.</p></div></div><div class=sect3><h4 id=_egy_gyors_áttekintés>26.4.3. Egy gyors áttekintés<a class=anchor href=#_egy_gyors_áttekintés></a></h4><div class=paragraph><p>Ahogy arról már a terminálok esetében szó esett, az <code>init</code> az összes betárcsázós kapcsolathoz tartozó soros porthoz elindít egy <code>getty</code> programot. Például, ha a modemet a <span class=filename>/dev/ttyd0</span> eszközre kapcsoltuk, akkor a <code>ps ax</code> parancs kimenetében ezt láthatjuk:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>4850 ??  I      0:00.09 /usr/libexec/getty V19200 ttyd0</code></pre></div></div><div class=paragraph><p>Amikor egy felhasználó felhívja a modemet és az kapcsolódik, akkor a modem egy CD (Carrier Detect) jelet küld. A rendszermag ekkor tudomásul veszi a vonal észlelését és a <code>getty</code> segítségével megindítja a kommunikációt. A <code>getty</code> egy <code>login:</code> szöveget küld át a vonalhoz megadott sebességgel. A <code>getty</code> elkezdi figyelni, hogy a értelmes karakterek érkeznek-e vissza, és egy átlagos konfigurációban, ha ezt szemétnek találja (mert például a modem nem a <code>getty</code> számára beállított sebességgel csatlakozott), akkor megpróbálja egészen addig hangolni a vonal sebességét, amíg feldolgozásra alkalmas karaktereket nem kap.</p></div><div class=paragraph><p>Miután a felhasználó megadta a felhasználói nevét, a <code>getty</code> elindítja a <span class=filename>/usr/bin/login</span> programot, amely befejezi a beléptetést a felhasználó jelszavának bekérésével és annak elfogadása esetén a hozzá tartozó parancsértelmezõ elindításával.</p></div></div><div class=sect3><h4 id=_a_konfigurációs_állományok_2>26.4.4. A konfigurációs állományok<a class=anchor href=#_a_konfigurációs_állományok_2></a></h4><div class=paragraph><p>FreeBSD rendszerünkben a betárcsázós kapcsolatok engedélyezéséhez az <span class=filename>/etc</span> könyvtárban három állomány módosítására lesz szükségünk. Közülük az elsõ, az <span class=filename>/etc/gettytab</span> a <span class=filename>/usr/libexec/getty</span> démon beállításait tartalmazza. A második, az <span class=filename>/etc/ttys</span> az <span class=filename>/sbin/init</span> számára mondja meg, hogy melyik <span class=filename>tty</span> eszközökhöz tartozik <code>getty</code>. Végezetül a portok inicializálásához kötõdõ beállításokat az <span class=filename>/etc/rc.d/serial</span> szkriptben kell megadnunk.</p></div><div class=paragraph><p>Két "iskola" jött létre aszerint, hogy UNIX® alatt hogyan használják a betárcsázós modemeket. Az egyik csoport úgy szereti beállítani a modemeit és rendszerit, hogy a távoli felhasználó által választott sebességtõl függetlenül a számítógép és a modem közti RS-232 felület egy fix sebességen fut. Ennek a beállításnak megvan az az elõnye, hogy a távoli felhasználó ilyenkor szinte azonnal megkapja a bejelentkezõ képernyõt. A hátránya viszont, hogy ebben az esetben a rendszer nem ismeri a felhasználó valódi adatátviteli sebességét, ezért az olyan teljes képernyõs alkalmazások, mint például az Emacs, nem lesznek képesek a lassabb kapcsolatokhoz szabni a megjelenítésüket.</p></div><div class=paragraph><p>A másik csoport a modemek RS-232-es felületét a távoli felhasználó kapcsolódási sebessége szerint állítja be. Így például egy V.32bis (14,4 Kbps) kapcsolat esetén a modemhez tartozó RS-232 felület 19,2 Kbps-on fog menni, miközben a 2400 bps sebességû kapcsolatokhoz egy vele azonos sebességû RS-232-es felület fog tartozni. Mivel a <code>getty</code> nem képes kommunikálni a modemek által lejelentett csatlakozási sebességen, ezért úgy próbálja azt megállapítani, hogy elküldi a <code>login:</code> szöveget az alap sebességgel, majd figyeli a válaszul érkezõ karaktereket. Ha a felhasználó ilyenkor szemetet lát, akkor feltételezik, hogy addig fogja nyomkodni az <kbd>Enter</kbd> billentyût, amíg valami értelmes szöveget meg nem lát. Amikor az adatátviteli sebesség eltér, akkor a <code>getty</code> ebbõl csupán csak annyit vesz észre, hogy a felhasználó "szemetet" küld, ezért egy újabb sebességgel megpróbálja megint elküldeni a <code>login:</code> szöveget. Hivatalosan ez a folyamat ismétlõdik orrvérzésig, de általában csak egy-két billentyût kell leütni a megfelelõ beállításokhoz. Nyilvánvaló, hogy ilyenkor a bejelentkezés messze nem olyan zavartalan, mint a "rögzített sebességû" esetben, de így a lassabb kapcsolattal rendelkezõ felhasználók is jobb használatóságot kapnak a teljes képernyõs programokkal.</p></div><div class=paragraph><p>Ebben a szakaszban egy valamennyire kiegyensúlyozott beállítást igyekszünk bemutatni, de részben elfogunk hajlani abban az irányba, amikor a modem a kapcsolat sebességét követi.</p></div><div class=sect4><h5 id=_etcgettytab>26.4.4.1. <span class=filename>/etc/gettytab</span><a class=anchor href=#_etcgettytab></a></h5><div class=paragraph><p>A <span class=filename>/etc/gettytab</span> egy <a href="https://man.freebsd.org/cgi/man.cgi?query=termcap&amp;sektion=5&amp;format=html">termcap(5)</a>-szerû állomány, amely a <a href="https://man.freebsd.org/cgi/man.cgi?query=getty&amp;sektion=8&amp;format=html">getty(8)</a> beállításait tartalmazza. A <a href="https://man.freebsd.org/cgi/man.cgi?query=gettytab&amp;sektion=5&amp;format=html">gettytab(5)</a> man oldalon olvashatunk az állomány pontos felépítésérõl és benne felsorolt beállításokról.</p></div><div class=sect5><h6 id=_a_rögzített_sebességû_beállítás>26.4.4.1.1. A rögzített sebességû beállítás<a class=anchor href=#_a_rögzített_sebességû_beállítás></a></h6><div class=paragraph><p>Ha a modem kommunikációs sebességét rögzíteni akarjuk, akkor ehhez többnyire semmit sem kell megváltoztatnunk az <span class=filename>/etc/gettytab</span> állományban.</p></div></div><div class=sect5><h6 id=_az_alkalmazkodó_sebességû_beállítás>26.4.4.1.2. Az alkalmazkodó sebességû beállítás<a class=anchor href=#_az_alkalmazkodó_sebességû_beállítás></a></h6><div class=paragraph><p>Az <span class=filename>/etc/gettytab</span> állományban létre kell hoznunk egy olyan bejegyzést, amelyen keresztül a <code>getty</code> tudni fogja, hogy milyen sebességeken akarjuk használni a modemet. Ha egy 2400 bps sebességû modemünk van, akkor hozzá a már meglevõ <code>D2400</code>-as bejegyzést kell használnunk.</p></div><div class="literalblock programlisting"><div class=content><pre>#
# A gyors betárcsázós terminálokhoz íme egy 2400/1200/300-as váltás
# (bárhonnan kezdõdhet):
#
D2400|d2400|Fast-Dial-2400:\
        :nx=D1200:tc=2400-baud:
3|D1200|Fast-Dial-1200:\
        :nx=D300:tc=1200-baud:
5|D300|Fast-Dial-300:\
        :nx=D2400:tc=300-baud:</pre></div></div><div class=paragraph><p>Ha ennél gyorsabb modemünk van, akkor már mindenképpen fel kell vennünk hozzá egy új bejegyzést az <span class=filename>/etc/gettytab</span> állományba. Ezzel a beállítással egy 14,4 Kbps sebességû modemet tudunk legfeljebb 19,2 Kbps-en használni:</p></div><div class="literalblock programlisting"><div class=content><pre>#
# Kiegészítések egy V.32bis modemhez:
#
um|V300|High Speed Modem at 300,8-bit:\
        :nx=V19200:tc=std.300:
un|V1200|High Speed Modem at 1200,8-bit:\
        :nx=V300:tc=std.1200:
uo|V2400|High Speed Modem at 2400,8-bit:\
        :nx=V1200:tc=std.2400:
up|V9600|High Speed Modem at 9600,8-bit:\
        :nx=V2400:tc=std.9600:
uq|V19200|High Speed Modem at 19200,8-bit:\
        :nx=V9600:tc=std.19200:</pre></div></div><div class=paragraph><p>Ennek eredménye egy 8 bites, paritásmentes kapcsolat lesz.</p></div><div class=paragraph><p>A fenti példában a kommunikációt 19,2 Kbps-en (V.32bis kapcsolaton) kezdjük, majd utána haladunk végig a 9600 bps (V.32), 2400 , 1200 bps és 300 bps sebességû kapcsolatokon, majd vissza ismét a 19,2 Kbps-re. Az adatátviteli sebesség ilyen típusú váltogatását az <code>nx=</code> ("next table", azaz "következõ táblázat") tulajdonság segítségével valósítják meg. Minden sorban látható még egy <code>tc=</code> ("table continuation", vagyis "a táblázat folytatása") bejegyzés is, amivel az adott adatátviteli sebesség "szabványos" beállításait adjuk meg.</p></div><div class=paragraph><p>Ha egy 28,8 Kbps sebességû modemünk van és/vagy egy 14,4 Kbps sebességû modemen akarunk tömörítést használni, akkor a 19,2 Kbps-nél nagyobb kommunikációs sebességet kell használnunk. Íme egy olyan <span class=filename>gettytab</span>. ami 57,6 Kbps-rõl indít:</p></div><div class="literalblock programlisting"><div class=content><pre>#
# A V.32bis vagy V.34 modemekhez kiegészítés,
# 57,6 Kbps-rõl indulunk:
#
vm|VH300|Very High Speed Modem at 300,8-bit:\
        :nx=VH57600:tc=std.300:
vn|VH1200|Very High Speed Modem at 1200,8-bit:\
        :nx=VH300:tc=std.1200:
vo|VH2400|Very High Speed Modem at 2400,8-bit:\
        :nx=VH1200:tc=std.2400:
vp|VH9600|Very High Speed Modem at 9600,8-bit:\
        :nx=VH2400:tc=std.9600:
vq|VH57600|Very High Speed Modem at 57600,8-bit:\
        :nx=VH9600:tc=std.57600:</pre></div></div><div class=paragraph><p>Ha lassú a processzorunk, vagy a rendszerünk túlságosan terhelt és nincs 16550A típusú soros portunk, akkor 57,6 Kbps-en <code>sio</code>"silo" hibák keletkezhetnek.</p></div></div></div><div class=sect4><h5 id=dialup-ttys>26.4.4.2. <span class=filename>/etc/ttys</span><a class=anchor href=#dialup-ttys></a></h5><div class=paragraph><p>Az <span class=filename>/etc/ttys</span> állomány beállításáról már a <a href=#ex-etc-ttys>Terminálok felvétele az <span class=filename>/etc/ttys</span> állományba</a> adott képet. Ez a modemek esetében sem tér el különösebben, habár a <code>getty</code> programnak más termináltípust és -beállításokat kell átadnunk. Akár rögzített, akár alkalmazkodó sebességet akarunk beállítani, ennek általános alakja az alábbi:</p></div><div class="literalblock programlisting"><div class=content><pre>ttyd0   &#34;/usr/libexec/getty xxx&#34;   dialup on</pre></div></div><div class=paragraph><p>A sorban látható elsõ elem a megfelelõ speciális eszköz neve - jelen esetben ez a <span class=filename>ttyd0</span>, amely a <span class=filename>/dev/ttyd0</span> eszközre vonatkozik és ezt fogja a <code>getty</code> figyelni. A második elem, vagyis a <code>"/usr/libexec/getty xxx"</code> (ahol a <em>xxx</em> helyére kell beírni a megfelelõ <span class=filename>gettytab</span> állománybeli bejegyzést nevét) lesz az a parancs, amelyet az <code>init</code> meghív. A harmadik elem, a <code>dialup</code> a terminálok alapértelmezett típusa. A negyedik paraméter, az <code>on</code> jelzi az <code>init</code> programnak, hogy aktiválja a vonalat. A sorban megjelenhetne továbbá még egy ötödik paraméter is, a <code>secure</code>, de ezt csak olyan terminálok esetében érdemes megadni, amelyek fizikailag megbízhatóak (például a rendszerkonzol).</p></div><div class=paragraph><p>Az alapértelmezett termináltípus (vagyis a fenti példában a <code>dialup</code>) a helyi beállításoktól függ. A betárcsázós vonalak esetében hagyományosan a <code>dialup</code> a terminál alapértelmezett típusa, amit aztán a felhasználók a bejelentkezéskor lefutó szkriptjeiken keresztül a automatikusan át tudnak állítani a nekik megfelelõ terminálra. A szerzõ saját rendszerében azonban inkább a <code>vt102</code> termináltípust volt érdemes megadni alapértelmezettként, mivel ott a felhasználók csak ilyen típusú terminálokat használnak.</p></div><div class=paragraph><p>Miután az <span class=filename>/etc/ttys</span> állományban elvégeztük a szükséges módosításokat, egy HUP jelzéssel figyelmeztessük az <code>init</code> programot az újbóli beolvasására. Ehhez a következõ parancs ajánlott:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># kill -HUP 1</span></code></pre></div></div><div class=paragraph><p>Ha még csak állítjuk be elõször a rendszerünket, akkor az <code>init</code> figyelmeztetése elõtt legyünk türelmesek, és várjuk meg, amíg a modemek befejezik az inicializálást és kapcsolódnak a vonalakra.</p></div><div class=sect5><h6 id=_a_rögzített_sebességû_beállítás_2>26.4.4.2.1. A rögzített sebességû beállítás<a class=anchor href=#_a_rögzített_sebességû_beállítás_2></a></h6><div class=paragraph><p>A rögzített sebesség beállításánál a <span class=filename>ttys</span> állományban a <code>getty</code> paramétereként egy szintén rögzített sebességû bejegyzést kell megadnunk. Például az olyan modemeknél, ahol a sebességet 19,2 Kbps-re rögzítjük, a <span class=filename>ttys</span> így fog kinézni:</p></div><div class="literalblock programlisting"><div class=content><pre>ttyd0   &#34;/usr/libexec/getty std.19200&#34;   dialup on</pre></div></div><div class=paragraph><p>Amennyiben a modemünk nem ezen a sebességen üzemelne, akkor az <code>std.sebesség</code> paramétert használjuk az <code>std.19200</code> helyett. Elõtte azonban ne felejtsük el ellenõrizni, hogy a megadott típus szerepel-e az <span class=filename>/etc/gettytab</span> állományban.</p></div></div><div class=sect5><h6 id=_az_alkalmazkodó_sebességû_beállítás_2>26.4.4.2.2. Az alkalmazkodó sebességû beállítás<a class=anchor href=#_az_alkalmazkodó_sebességû_beállítás_2></a></h6><div class=paragraph><p>Az alkalmazkodó sebességû beállításnál a <span class=filename>ttys</span> állományban az <span class=filename>/etc/gettytab</span> állományból a megfelelõ "auto-baud" (sic) kell megadnunk. Például, ha modemünk kezdõsebessége 19,2 Kbps (és a <span class=filename>gettytab</span> ehhez tartalmaz egy <code>V19200</code> nevû bejegyzést), akkor a <span class=filename>ttys</span> így fog kinézni:</p></div><div class="literalblock programlisting"><div class=content><pre>ttyd0   &#34;/usr/libexec/getty V19200&#34;   dialup on</pre></div></div></div></div><div class=sect4><h5 id=_etcrc_dserial>26.4.4.3. <span class=filename>/etc/rc.d/serial</span><a class=anchor href=#_etcrc_dserial></a></h5><div class=paragraph><p>A gyorsabb, mint például a V.32, V.32bis és V.34 modemeknél meg kell adnunk a hardveres forgalomirányítás (<code>RTS/CTS</code>) használatát is. Az <span class=filename>/etc/rc.d/serial</span> állományban tudjuk megadni a FreeBSD rendszermagban a vonal használatához szükséges vezérlési beállításokra vonatkozó <code>stty</code> parancsokat.</p></div><div class=paragraph><p>Például állítsuk be az 1-es sorszámú (vagyis a <span class=filename>COM2</span>) soros porton a <code>crtscts termios</code> beállítást a behíváshoz és a híváshoz használt eszközök inicializálásakor. Ehhez a következõ sorokat kell felvennünk az <span class=filename>/etc/rc.d/serial</span> állományba:</p></div><div class="literalblock programlisting"><div class=content><pre># A soros portok kezdeti beállításai:
stty -f /dev/ttyd1.init crtscts
stty -f /dev/cuad1.init crtscts</pre></div></div></div></div><div class=sect3><h4 id=_a_modemek_beállításai>26.4.5. A modemek beállításai<a class=anchor href=#_a_modemek_beállításai></a></h4><div class=paragraph><p>Ha olyan modemeink vannak, amelyek paramétereit egy statikus memóriában tárolták le, akkor ezek beállításához egy terminálprogramot kell használnunk (amilyen például MS-DOS® alatt a Telix vagy FreeBSD alatt a <code>tip</code>). A modemet a <code>getty</code> programnak megadott kezdeti sebességen csatlakoztassuk és az alábbi elvárások alapján állítsuk be a paramétereit:</p></div><div class=ulist><ul><li><p>Kapcsolódáskor CD jelzése.</p></li><li><p>Mûködéskor DTR jelzése. A DTR küldésekor bontsa a vonalat és hozza alapállapotba a modemet.</p></li><li><p>CTS vezérlésû kimenõ adatforgalom.</p></li><li><p>A XON/XOFF forgalomvezérlés tiltása.</p></li><li><p>RTS vezérlésû bejövõ adatforgalom.</p></li><li><p>Csendes mód (ne adjon értesítést az eredményekrõl).</p></li><li><p>A parancsokat ne írja vissza.</p></li></ul></div><div class=paragraph><p>A modemhez tartozó dokumentációban kell utánajárnunk, hogy milyen parancsok és/vagy DIP kapcsolók átállításával lehet mindezeket elérni.</p></div><div class=paragraph><p>Például, ha a fenti paramétereket egy U.S. Robotics® Sportster® 14400-as külsõ modem esetében a következõ neki kiküldött paranccsal lehet beállítani:</p></div><div class="literalblock programlisting"><div class=content><pre>ATZ
AT&amp;C1&amp;D2&amp;H1&amp;I0&amp;R2&amp;W</pre></div></div><div class=paragraph><p>Ilyenkor még akár más egyéb paramétereket is beállíthatunk, például a V.42bis és/vagy az MNP5 tömörítést.</p></div><div class=paragraph><p>Az U.S. Robotics® Sportster® 14400 külsõ modemen ezenkívül még találunk néhány DIP kapcsolót is. Az ilyen modemek esetében például ezeket a beállításokat tudjuk használni:</p></div><div class=ulist><ul><li><p>1. kapcsoló: FEL - normális DTR</p></li><li><p>2. kapcsoló: N/A (verbális/numerikus eredményjelzõ kódok)</p></li><li><p>3. kapcsoló: FEL - az eredményjelzõ kódok küldésének tiltása</p></li><li><p>4. kapcsoló: LE - nem küldi vissza a parancsokat</p></li><li><p>5. kapcsoló: FEL - automatikus válasz</p></li><li><p>6. kapcsoló: FEL - normális Carrier Detect</p></li><li><p>7. kapcsoló: FEL - a memóriában tárolt alapértelmezések betöltése</p></li><li><p>8. kapcsoló: N/A (intelligens/buta mód)</p></li></ul></div><div class=paragraph><p>A modemeknél az eredményjelzõ kódok kikapcsolása/letiltása ezért fontos, mert így el tudunk kerülni az olyan problémákat, hogy a <code>getty</code> tévesen egy <code>login:</code> promptot küld a parancs módban levõ modemnek, amikor az visszaküldi a parancsot és az eredmény kódját. Ennek eredménye egy hosszúra nyúló, zavaros társalgás lesz a <code>getty</code> és a modem között.</p></div><div class=sect4><h5 id=_a_rögzített_sebességû_beállítás_3>26.4.5.1. A rögzített sebességû beállítás<a class=anchor href=#_a_rögzített_sebességû_beállítás_3></a></h5><div class=paragraph><p>A rögzített sebességû konfiguráció használata esetén úgy kell beállítanunk a modemet, hogy a konkrét adatátviteli sebsségtõl függetlenül is egy állandó sebességû kapcsolat álljon fenn a számítógép és a modem között. A U.S. Robotics® Sportster® 14400-as külsõ modem esetében a most következõ parancsokkal tudjuk rögzíteni a kapcsolat sebességét:</p></div><div class="literalblock programlisting"><div class=content><pre>ATZ
AT&amp;B1&amp;W</pre></div></div></div><div class=sect4><h5 id=_az_alkalmazkodó_sebességû_beállítás_3>26.4.5.2. Az alkalmazkodó sebességû beállítás<a class=anchor href=#_az_alkalmazkodó_sebességû_beállítás_3></a></h5><div class=paragraph><p>Amikor változó sebességû konfigurációval dolgozunk, akkor a modemet úgy kell beállítani, hogy a bejövõ hívásnak megfelelõ adatátviteli sebességre váltson a soros portján. A U.S. Robotics® Sportster® 14400-as külsõ modem esetében az alábbi parancsokkal rögzítjük a modemnek küldött hibamentesített parancsok sebességét, miközben engedélyezzük, hogy a soros port sebessége változhasson a nem hibamentesített kapcsolatoknál:</p></div><div class="literalblock programlisting"><div class=content><pre>ATZ
AT&amp;B2&amp;W</pre></div></div></div><div class=sect4><h5 id=_a_modem_beállításainak_ellenõrzése>26.4.5.3. A modem beállításainak ellenõrzése<a class=anchor href=#_a_modem_beállításainak_ellenõrzése></a></h5><div class=paragraph><p>A legtöbb nagysebességû modem biztosít valamilyen lehetõséget arra, hogy emberi formában is le tudjuk kérdezni a belsõ mûködésének paramétereit. A U.S. Robotics® Sportster® 14400-as külsõ modem esetében az <code>ATI5</code> parancs a statikus memóriában tárolt beállításokat mutatja meg. A modem valós mûködési paramétereit (amit ugyebár befolyásolnak a DIP kapcsolók állásai is) viszont az <code>ATZ</code> majd <code>ATI4</code> parancsok küldésével tudjuk lekérni.</p></div><div class=paragraph><p>Ha azonban másmilyen márkájú modemünk lenne, akkor a modem leírásában próbáljunk tájékozódni arról, miként tudjuk a modem beállításait ellenõrizni.</p></div></div></div><div class=sect3><h4 id=_hibaelhárítás>26.4.6. Hibaelhárítás<a class=anchor href=#_hibaelhárítás></a></h4><div class=paragraph><p>Ebben a szakaszban bemutatunk néhány lépést, amelyeken keresztül ellenõrizhetjük a rendszerünkhöz csatlakoztatott modemet.</p></div><div class=sect4><h5 id=_a_freebsd_rendszer_ellenõrzése>26.4.6.1. A FreeBSD rendszer ellenõrzése<a class=anchor href=#_a_freebsd_rendszer_ellenõrzése></a></h5><div class=paragraph><p>Csatlakoztassuk a modemet a FreeBSD rendszerre, indítsuk be a gépet, majd ezután figyeljük a modemünk állapotát jelzõ lámpákat, hogy közülük a DTR világít-e, amikor a <code>login:</code> felirat megjelenik a rendszerkonzolon. Amennyiben erre a válasz igen, akkor az arra utal, hogy a FreeBSD a hozzá tartozó kommunikációs porton elindította a megfelelõ <code>getty</code> programot és a modem várja a hívásokat.</p></div><div class=paragraph><p>Amikor viszont a DTR lámpa nem világít, a konzolon keresztül jelentkezzünk be a FreeBSD rendszerbe és adjuk ki egy <code>ps ax</code> parancsot, amivel így ellenõrizni tudjuk, hogy a porthoz tartozó <code>getty</code> elindult. A futó programok között tehát valami ilyesmit kell majd látnunk:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>  114 ??  I      0:00.10 /usr/libexec/getty V19200 ttyd0
  115 ??  I      0:00.10 /usr/libexec/getty V19200 ttyd1</code></pre></div></div><div class=paragraph><p>Ha viszont például ezt látjuk:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>  114 d0  I      0:00.10 /usr/libexec/getty V19200 ttyd0</code></pre></div></div><div class=paragraph><p>és modem még nem fogadott hívást, akkor ez azt jelenit, hogy a <code>getty</code> megnyitotta a kommunikációs csatornát. Ez utalhat egyaránt egy hibás kábelre vagy a modem helytelen beállítására, mivel a <code>getty</code> egészen addig nem lesz képes megnyitni az adott portot, amíg a modem vissza nem küld neki egy CD (Carrier Detect) jelet.</p></div><div class=paragraph><p>Ha a listában az adott <span class=filename>ttydN</span> eszközhöz semmilyen <code>getty</code> programot nem találunk, akkor újra nézzük át az <span class=filename>/etc/ttys</span> állományban szereplõ bejegyzéseket, mert elõfordulhat, hogy azokban vétettünk valamilyen hibát. Emellett még a <span class=filename>/var/log/messages</span> naplóban is érdemes utánanézni, hátha az <code>init</code> vagy a <code>getty</code> küldött valamilyen hibáról értesítést. Ha még ezek után sem találunk semmit, akkor megint kezdjük el keresni hibákat, hiányzó bejegyzéseket vagy eszközöket az <span class=filename>/etc/ttys</span>, <span class=filename>/etc/gettytab</span> és a megfelelõ <span class=filename>/dev/ttydN</span> állományokban.</p></div></div><div class=sect4><h5 id=_a_betárcsázás_kipróbálása>26.4.6.2. A betárcsázás kipróbálása<a class=anchor href=#_a_betárcsázás_kipróbálása></a></h5><div class=paragraph><p>Próbáljunk meg bejutni a rendszerünkbe. Ehhez a távoli rendszeren ne felejtsük el beállítani a 8 bites adatátvitelt és az 1 stopbitet, illetve a paritást kikapcsolni. Ha erre közvetlenül nem kapunk egy bejelentkezési képernyõt vagy csak szemét jelenik meg, akkor kb. másodpercenként egyszer nyomjuk le az <kbd>Enter</kbd> billentyût. Ha még ezután sem látjuk a bejelentkezési képernyõt felbukkani, akkor próbáljunk kiküldeni egy <code>BREAK</code> parancsot. Ha a híváshoz nagysebességû modemet használunk, akkor próbáljuk meg a modem sebességét rögzíteni és úgy tárcsázni (ezt például a U.S. Robotics® Sportster® modemnél az <code>AT&amp;B1</code> paranccsal tudjuk elérni):</p></div><div class=paragraph><p>Ha viszont még ezek után sem kapjuk meg a bejelentkezõ képernyõt, akkor a <span class=filename>/etc/gettytab</span> állományban megint nézzük át az összes beállítást:</p></div><div class=ulist><ul><li><p>Az <span class=filename>/etc/ttys</span> állományban megadott alaptulajdonság neve egyezik az <span class=filename>/etc/gettytab</span> állományban találhatóval.</p></li><li><p>Mindegyik <code>nx=</code> bejegyzés után egy másik <span class=filename>gettytab</span> tulajdonság neve jön.</p></li><li><p>Mindegyik <code>tc=</code> bejegyzés után egy másik <span class=filename>gettytab</span> tulajdonság neve következik.</p></li></ul></div><div class=paragraph><p>Ha hívunk, de a FreeBSD rendszerünkre kapcsolt modem továbbra sem veszi fel, akkor a modem beállításai között ellenõrizzük, hogy a DTR jel küldésekor a modem fogadja-e a hívást. Ha úgy tûnik, hogy a modem minden ezzel kapcsolatos beállítása stimmel, akkor nézzük meg, hogy a modem lámpái közül a DTR világít-e (már ha van ilyen).</p></div><div class=paragraph><p>Ha mindent többször is végignéztünk és még mindig nem leljük a megoldást, akkor tartsunk egy kis szünetet és térjünk vissza a problémához késõbb. Ha még ezután sem tudjuk mûködésre bírni, akkor küldjünk egy levelet a <a href=https://lists.FreeBSD.org/subscription/freebsd-questions>FreeBSD general questions levelezési lista</a> címére, amelyben leírjuk a modemünket és a vele kapcsolatos problémát, és a lista tagjai majd megpróbálnak nekünk segíteni.</p></div></div></div></div><div class=sect2><h3 id=dialout>26.5. A betárcsázós szolgáltatások használata<a class=anchor href=#dialout></a></h3><div class=paragraph><p>A következõkben arra vonatkozóan igyekszünk tanácsokat adni, amikor mi magunk akarunk modemmel csatlakozni valamilyen számítógéphez. Ezek tehát olyan esetekben hasznosak, amikor egy távoli géppel akarunk terminálkapcsolatot létesíteni.</p></div><div class=paragraph><p>A BBS-ek használatára is érvényes.</p></div><div class=paragraph><p>Ez ilyen típusú kapcsolatok kifejezetten hasznosak tudnak lenni olyan esetekben, amikor az interneten el akarunk érni egy állományt, de gondjaink akadtak a PPP használatával. Ha például egy állományt akarunk letölteni, de a PPP valamiért nem mûködik, akkor ezt a terminál alapú kapcsolaton keresztül is meg tudjuk tenni. Ilyenkor egy zmodem segítségével tudjuk áttölteni a számítógépünkre.</p></div><div class=sect3><h4 id=hayes-unsupported>26.5.1. A gyári Hayes-modem erre nem alkalmas, mihez tudunk vele kezdeni?<a class=anchor href=#hayes-unsupported></a></h4><div class=paragraph><p>A <code>tip</code> man oldala valójában már nem is teljesen aktuális, ugyanis tartalmaz egy beépített Hayes-tárcsázót. Úgy tudjuk engedélyezni, ha az <span class=filename>/etc/remote</span> állományban megadjuk az <code>at=hayes</code> beállítást.</p></div><div class=paragraph><p>A Hayes-eszközök meghajtója nem elég ügyes ahhoz, hogy felismerje az újabb modemek által felkínált fejlettebb lehetõségeket - például a <code>BUSY</code>, <code>NO DIALTONE</code> vagy a <code>CONNECT 115200</code> üzenetek csak megzavarják. Ezért a <code>tip</code> használata során kapcsoljuk ki ezeket az üzeneteket (az <code>ATXO&amp;W</code> paranccsal).</p></div><div class=paragraph><p>Emellett még érdemes tudni, hogy a <code>tip</code> a híváskor 60 másodpercig vár. A modemünkön ennél kisebb idõt kell beállítanunk, máskülönben a <code>tip</code> azt hiszi, hogy valamilyen kommunikációs probléma merült fel. Ehhez próbálkozzunk az <code>ATS7=45&amp;W</code> paranccsal.</p></div></div><div class=sect3><h4 id=direct-at>26.5.2. Hogyan adjuk meg ezeket az AT parancsokat?<a class=anchor href=#direct-at></a></h4><div class=paragraph><p>Az <span class=filename>/etc/remote</span> állományban hozzunk létre egy "direct" bejegyzést. Például, ha a modemünk az elsõ soros porton, vagyis a <span class=filename>/dev/cuad0</span> eszközön tanyázik, akkor a következõ sort kell beleírnunk:</p></div><div class="literalblock programlisting"><div class=content><pre>cuad0:dv=/dev/cuad0:br#19200:pa=none</pre></div></div><div class=paragraph><p>A <code>br</code> tulajdonságnál a modem által ismert legnagyobb adatátviteli sebességet adjuk meg. Ezután gépeljük be a <code>tip cuad0</code> parancsot és már kapcsolódunk is a modemhez.</p></div><div class=paragraph><p>Vagy <code>root</code> felhasználóként a <code>cu</code> parancsot is használhatjuk:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># cu -lvonal -ssebesség</span></code></pre></div></div><div class=paragraph><p>Itt a <em>vonal</em> a soros port (például <span class=filename>/dev/cuad0</span>) és a <em>sebesség</em> annak sebessége (például <code>57600</code>) lesz. Miután befejeztük az AT parancsok kiadását, az <code>~.</code> begépelésével tudunk kilépni.</p></div></div><div class=sect3><h4 id=gt-failure>26.5.3. A pn tulajdonságnál a <code>@</code> jel nem használható!<a class=anchor href=#gt-failure></a></h4><div class=paragraph><p>A pn ("phone number") tulajdonság értékében szereplõ <code>@</code> jel segítségével az <span class=filename>/etc/phones</span> állományban tudunk hivatkozni egy telefonszámra. A <code>@</code> a tulajdonságokat tároló állományok azonban, így például az <span class=filename>/etc/remote</span> állomány esetén is megkülönböztetett jelentéssel bírnak. Ezért itt csak egy visszaper jellel tudjuk beírni:</p></div><div class="literalblock programlisting"><div class=content><pre>pn=\@</pre></div></div></div><div class=sect3><h4 id=dial-command-line>26.5.4. Hogyan hívjunk fel egy számot parancssorból?<a class=anchor href=#dial-command-line></a></h4><div class=paragraph><p>Tegyünk egy "általános" bejegyzést az <span class=filename>/etc/remote</span> állományunkba. Például egy ilyet:</p></div><div class="literalblock programlisting"><div class=content><pre>tip115200|Dial any phone number at 115200 bps:\
        :dv=/dev/cuad0:br#115200:at=hayes:pa=none:du:
tip57600|Dial any phone number at 57600 bps:\
        :dv=/dev/cuad0:br#57600:at=hayes:pa=none:du:</pre></div></div><div class=paragraph><p>Ezután már ilyet is tudni fogunk:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># tip -115200 5551234</span></code></pre></div></div><div class=paragraph><p>Ha viszont a <code>tip</code> helyett inkább a <code>cu</code> programot használnánk szívesen, akkor ehhez készítsünk egy általános bejegyzést:</p></div><div class="literalblock programlisting"><div class=content><pre>cu115200|Use cu to dial any number at 115200bps:\
        :dv=/dev/cuad1:br#57600:at=hayes:pa=none:du:</pre></div></div><div class=paragraph><p>Majd gépeljük be ezt:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># cu 5551234 -s 115200</span></code></pre></div></div></div><div class=sect3><h4 id=set-bps>26.5.5. Ehhez minden adandó alkalommal meg kell adnom a sebességet is?<a class=anchor href=#set-bps></a></h4><div class=paragraph><p>Hozzunk létre egy <code>tip1200</code> vagy <code>cu1200</code> nevû bejegyzést, de a <code>br</code> tulajdonságnál adjuk meg a használni kívánt sebességet. Mivel a <code>tip</code> szerint az 1200 bps egy megfelelõ alapértelmezés, ezért alapból a <code>tip1200</code> bejegyzést fogja keresni. Ez természetesen nem jelenti azt, hogy ilyen sebsséggel is akarunk dolgozni.</p></div></div><div class=sect3><h4 id=terminal-server>26.5.6. A terminálszerveren keresztül több más gépet is elérek<a class=anchor href=#terminal-server></a></h4><div class=paragraph><p>Ahelyett, hogy minden alkalommal megvárnánk a kapcsolódás befejezést és begépelnénk a <code>CONNECT gép</code> parancsot, használjuk a <code>cm</code> tulajdonságát. Például nézzük meg ilyen bejegyzést az <span class=filename>/etc/remote</span> állományban:</p></div><div class="literalblock programlisting"><div class=content><pre>pain|pain.deep13.com|Forrester&#39;s machine:\
        :cm=CONNECT pain\n:tc=deep13:
muffin|muffin.deep13.com|Frank&#39;s machine:\
        :cm=CONNECT muffin\n:tc=deep13:
deep13:Gizmonics Institute terminal server:\
        :dv=/dev/cuad2:br#38400:at=hayes:du:pa=none:pn=5551234:</pre></div></div><div class=paragraph><p>Ennek hatására elég csak annyit megadnunk, hogy <code>tip pain</code> vagy <code>tip muffin</code>, és már kapcsolódunk is a <code>pain</code> vagy <code>muffin</code> gépekhez. A <code>tip deep13</code> paranccsal pedig egyenesen a terminálszerverhez jutunk el.</p></div></div><div class=sect3><h4 id=tip-multiline>26.5.7. Több vonalon is lehet egy géphez csatlakozni?<a class=anchor href=#tip-multiline></a></h4><div class=paragraph><p>Ez gyakran okoz gondot olyan esetekben, amikor egy egyetemnek több betárcsázó vonala van, és azokon keresztül többezer hallgató próbál meg dolgozni.</p></div><div class=paragraph><p>Vegyük fel az egyetemet az <span class=filename>/etc/remote</span> állományba és használjuk a <code>pn</code> tulajdonság megadásánál a <code>@</code> jelet:</p></div><div class="literalblock programlisting"><div class=content><pre>nagy-egyetem:\
        :pn=\@:tc=dialout
dialout:\
        :dv=/dev/cuad3:br#9600:at=courier:du:pa=none:</pre></div></div><div class=paragraph><p>Ezután adjuk hozzá az <span class=filename>/etc/phones</span> állományhoz az egyetem telefonszámait:</p></div><div class="literalblock programlisting"><div class=content><pre>nagy-egyetem 5551111
nagy-egyetem 5551112
nagy-egyetem 5551113
nagy-egyetem 5551114</pre></div></div><div class=paragraph><p>A <code>tip</code> mindegyik telefonszámot az adott sorrendben próbálja tárcsázni és végén feladja a próbálkozást. Ha folyamatosan akarjuk ezeket a számokat hívni, akkor <code>tip</code> parancsot tegyük egy ciklusba.</p></div></div><div class=sect3><h4 id=multi-controlp>26.5.8. Miért kell kétszer lenyomni a <span class=keyseq><kbd>Ctrl</kbd>+<kbd>P</kbd></span> gombokat, hogy egyszer elküldje a <span class=keyseq><kbd>Ctrl</kbd>+<kbd>P</kbd></span> kombinációt?<a class=anchor href=#multi-controlp></a></h4><div class=paragraph><p>A <span class=keyseq><kbd>Ctrl</kbd>+<kbd>P</kbd></span> billentyûkombináció alapértelmezés szerint a "kikényszerítést" jelenti, amivel a <code>tip</code> programnak tudunk szólni, hogy a következõ adat szó szerint értendõ. A <code>~s</code> szekvenciával bármelyik másik karakternek át tudjuk adni ezt a szerepet, ami egy változó beállítását jelenti ("set a variable").</p></div><div class=paragraph><p>Gépeljük be, hogy <code>~sforce=egyetlen-karakter</code> és zárjuk le egy újsorral. Az <em>egyetlen-karakter</em> helyére tetszõleges, egykarakteres szimbólumot megadhatunk. Ha itt nem adunk meg semmit, akkor a kikényszerítõ karakter a <code>nul</code> lesz, amit a <span class=keyseq><kbd>Ctrl</kbd>+<kbd>2</kbd></span> vagy a <span class=keyseq><kbd>Ctrl</kbd>+<kbd>Szóköz</kbd></span> lenyomásával tudunk elõhozni. Az <em>egyetlen-karakter</em> szerepére például tökéletes a <span class=keyseq><kbd>Shift</kbd>+<kbd>Ctrl</kbd>+<kbd>6</kbd></span>, amit csak nagyon kevés terminálszerver alkalmaz.</p></div><div class=paragraph><p>A kikényszerítést végzõ karaktert az <span class=filename>$HOME/.tiprc</span> állományban tetszõleges karakterre át tudjuk állítani:</p></div><div class="literalblock programlisting"><div class=content><pre>force=egyetlen-karakter</pre></div></div></div><div class=sect3><h4 id=uppercase>26.5.9. Miért lett hirtelen minden begépelt betû nagybetûs??<a class=anchor href=#uppercase></a></h4><div class=paragraph><p>Valószínûleg sikerült lenyomnunk a <span class=keyseq><kbd>Ctrl</kbd>+<kbd>A</kbd></span> gombkombinációt, ami a <code>tip</code> "betûmód váltás" funkciójának felel meg. Ezt olyanok számára dolgozták ki, akiknél nem mûködik a <kbd>CapsLock</kbd> billentyû. Az elõbb bemutatott <code>~s</code> használatával állítsuk át a <code>raisechar</code> változót valami másra. Tulajdonképpen akár ugyanarra is állíthatjuk, mint a kikényszerítõ karaktert, ha nem áll szándékunkban használni.</p></div><div class=paragraph><p>Ebben a példában egy olyan <span class=filename>.tiprc</span> állomány szerepel, amely tökéletesen megfelel azon Emacs felhasználók számára, akik sokat használják a <span class=keyseq><kbd>Ctrl</kbd>+<kbd>2</kbd></span> és <span class=keyseq><kbd>Ctrl</kbd>+<kbd>A</kbd></span> kombinációkat:</p></div><div class="literalblock programlisting"><div class=content><pre>force=^^
raisechar=^^</pre></div></div><div class=paragraph><p>A <code>^^</code> a <span class=keyseq><kbd>Shift</kbd>+<kbd>Ctrl</kbd>+<kbd>6</kbd></span> billentyûkombinációt jelenti.</p></div></div><div class=sect3><h4 id=tip-filetransfer>26.5.10. Hogyan mozgassunk állományokat a <code>tip</code> használatával?<a class=anchor href=#tip-filetransfer></a></h4><div class=paragraph><p>Amikor más UNIX® rendszerekkel vesszük fel a kapcsolatot, akkor állományokat a <code>~p</code> (mint put, vagyis adni) és <code>~t</code> (mint take, vagyis venni) használatával tudunk mozgatni. Ezek a parancsok a távoli rendszeren a <code>cat</code> és az <code>echo</code> felhasználásával fogadnak és küldenek állományokat. Alakjuk a következõ:</p></div><div class=paragraph><p><code>~p</code> helyi-állomány [ távoli-állomány ]</p></div><div class=paragraph><p><code>~t</code> távoli-állomány [ helyi-állomány ]</p></div><div class=paragraph><p>Ilyenkor nincs hibaellenõrzés, ezért inkább egy másik protokollt, például zmodemet érdemes használnunk.</p></div></div><div class=sect3><h4 id=zmodem-tip>26.5.11. Hogyan lehet zmodemet használni a <code>tip</code> programban?<a class=anchor href=#zmodem-tip></a></h4><div class=paragraph><p>Állományokat úgy tudunk fogadni, ha elõtte a kapcsolat távolabbi végén elindítjuk a küldést végzõ programot. Ezután a <code>~C rz</code> parancs kiadásával kezdhetjük meg helyben a fogadását.</p></div><div class=paragraph><p>Állományokat úgy tudunk küldeni, ha elõtte a kapcsolat másik végén elindítjuk a fogadó programot. Ezután a <code>~C sz állományok</code> parancs kiadásával tudjuk megkezdeni a küldést.</p></div></div></div><div class=sect2><h3 id=serialconsole-setup>26.6. A soros vonali konzol beállítása<a class=anchor href=#serialconsole-setup></a></h3><div class=sect3><h4 id=serialconsole-intro>26.6.1. Bevezetés<a class=anchor href=#serialconsole-intro></a></h4><div class=paragraph><p>A FreeBSD képes úgy is elindulni, ha konzolként mindössze egy buta terminált kapcsolunk rá soros porton keresztül. Az ilyen típusú konfigurációs alapvetõen két típus számára bizonyul hasznosnak: azon rendszergazdák számára, akik billentyûzettel és monitorral nem rendelkezõ gépekre akarnak FreeBSD-t telepíteni, és olyan fejlesztõk számára, akik a rendszermag vagy különbözõ eszközmeghajtók mûködését akarják nyomon követni.</p></div><div class=paragraph><p>Ahogy arról már a <a href=./#boot>A FreeBSD rendszerindítási folyamata</a>ben is szó esett, a FreeBSD három indítási fokozattal rendelkezik. Az elsõ két fokozat a rendszerindító blokk kódjában foglal helyet, amely pedig a lemezen található FreeBSD slice elején. A rendszer indulásakor ez a blokk betöltõdik és lefuttatja a harmadik fokozatot képviselõ rendszertöltõt (a <span class=filename>/boot/loader</span> állományt).</p></div><div class=paragraph><p>Ha soros vonali konzol beállításához tehát be kell állítanunk a rendszerindító blokkot, a rendszertöltõt és a rendszermagot.</p></div></div><div class=sect3><h4 id=serialconsole-howto-fast>26.6.2. A soros konzol beállítása, rövidített változat<a class=anchor href=#serialconsole-howto-fast></a></h4><div class=paragraph><p>Ebben a szakaszban azt feltételezzük, hogy az alap beállításokkal dolgozunk és csupán egy gyors áttekintésre van szükségünk a soros vonali konzolról.</p></div><div class="exampleblock procedure"><div class=content><div class="olist arabic"><ol class=arabic><li><p>Csatlakoztassunk egy soros kábelt a <span class=filename>COM1</span> portra és a terminálra.</p></li><li><p>Rendszeradminisztrátorként a következõ parancs kell kiadnunk ahhoz, hogy a soros konzolon láthassuk az összes rendszerindításhoz tartozó üzenetet:</p><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># echo &#39;console=&#34;comconsole&#34;&#39; &gt;&gt; /boot/loader.conf</span></code></pre></div></div></li><li><p>Nyissuk meg az <span class=filename>/etc/ttys</span> állományt, és a <span class=filename>ttyd0</span> eszközhöz tartozó sorban írjuk át az <code>off</code> paramétert az <code>on</code> értékre és a <code>dialup</code> paramétert a <code>vt100</code> értékre. Ha nem ezeket állítjuk be, akkor a soros konzol keresztül jelszó megadása nélkül is be tudunk jelentkezni, ami viszont egy biztonsági rés veszélyével fenyeget.</p></li><li><p>A változtatások érvényesítéséhez indítsuk újra a rendszerünket.</p></li></ol></div></div></div><div class=paragraph><p>Ha ettõl eltérõ beállításokra lenne szükségünk, akkor a folyamat egyes lépéseibe a <a href=#serialconsole-howto>A soros vonali konzol beállítása</a>ban kaphatunk mélyebb betekintést.</p></div></div><div class=sect3><h4 id=serialconsole-howto>26.6.3. A soros vonali konzol beállítása<a class=anchor href=#serialconsole-howto></a></h4><div class="exampleblock procedure"><div class=content><div class="olist arabic"><ol class=arabic><li><p>Készítsük elõ a soros kábelt.</p><div class=paragraph><p>Vagy a null-modem kábelre vagy pedig egy szabványos soros kábelre és egy null-modem átalakítóra lesz szükségünk. A soros kábelekkel kapcsolatosan a <a href=#serial-cables-ports>Kábelek és portok</a>t érdemes elolvasni.</p></div></li><li><p>Húzzuk ki a billentyûzetet.</p><div class=paragraph><p>A legtöbb személyi számítógép az indítása (vagyis a Power-On Self-Test, POST) során hibát jelez, ha nem érzékel billentyûzetet. Egyes gépek hangosan panaszolják a billentyûzet hiányát, és nem is hajlandóak egészen addig elindulni, amíg nem csatlakoztatunk egyet.</p></div><div class=paragraph><p>Ha a számítógépünk hibát küld, de ennek ellenére mégis elindul, akkor semmit nem kell csinálnunk. (Némelyik Phonix BIOS-os gépen ilyenkor megjelenik a <code>Keyboard failed</code> hibaüzenet, de ettõl még rendesen elindul a gép.)</p></div><div class=paragraph><p>Amennyiben a számítógépünk nem hajlandó billentyûzet nélkül elindulni, állítsuk be a BIOS-ban a "hiba" figyelmen kívül hagyását (már ha ez lehetséges). Az alaplap leírásában találhatjuk meg ennek pontos részleit.</p></div><div class="admonitionblock tip"><table><tbody><tr><td class=icon><i class="fa icon-tip" title=Tip></i></td><td class=content><div class=paragraph><p>A BIOS paraméterei között a billentyûzetet állítsuk "Not installed" állapotúra. Ilyenkor még továbbra is használható a billentyûzet, ezzel mindössze csak a BIOS számára tiltjuk le az indításkori ellenõrzést, ezért nem fog panaszkodni a hiánya miatt. Tehát a billentyûzetet még a "Not installed" beállítása esetén is nyugodtan csatlakoztatjuk, mert mûködni fog.</p></div></td></tr></tbody></table></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Ha a rendszerünkön PS/2®-es egér is található, akkor jó eséllyel a billentyûzettel együtt az egeret is ki tudjuk húzni. Mivel a PS/2®-es egér osztozik a billentyûzettel bizonyos hardvereken, ezért ha nem húzzuk ki az egeret is, akkor az alaplap még továbbra is képes azt gondolni, hogy a billentyûzet ott van. Például az AMI BIOS-os Gateway 2000-as 90 MHz-es Pentium rendszer pontosan így mûködik. Általában véve azonban ez nem szokott gondot okozni, mivel az egér billentyûzet nélkül úgy sem ér túlságosan sokat.</p></div></td></tr></tbody></table></div></li><li><p>Csatlakoztassunk egy buta terminált a <span class=filename>COM1</span> (<span class=filename>sio0</span>) portra.</p><div class=paragraph><p>Ha nem rendelkezünk buta terminállal, akkor erre célra ugyanúgy alkalmas egy régi XT-s PC valamilyen modemprogrammal vagy egy soros porton csatlakozó másik UNIX®-os gép. Ha nincs <span class=filename>COM1</span> (<span class=filename>sio0</span>) portunk, akkor szerezzünk egyet. Jelen pillanatban a rendszerindító blokk újrafordítása nélkül a <span class=filename>COM1</span> porton kívül nem tudunk másikat választani. Ha a <span class=filename>COM1</span> portra már raktunk valamilyen másik eszközt, akkor azt ideiglenesen húzzuk le, majd a FreeBSD telepítése és elindítása után tegyünk fel egy másik rendszerindító blokkot. (Egyébként feltételezzük, hogy a <span class=filename>COM1</span> elérhetõ egy állomány/számító/terminálszerveren - ha valóban valamilyen másik célra szükségünk lenne a <span class=filename>COM1</span> portra (és semmiképpen sem tudjuk átrakni a <span class=filename>COM2</span> (<span class=filename>sio1</span>) portra), akkor valószínûleg nem is ezzel kellene elsõként foglalkoznunk.)</p></div></li><li><p>Gondoskodjunk róla, hogy a rendszermag beállításait tartalmazó állományban a <span class=filename>COM1</span> (<span class=filename>sio0</span>) eszközhöz megadtuk a megfelelõ paramétereket.</p><div class=paragraph><p>Ezek az alábbiak:</p></div><div class=dlist><dl><dt class=hdlist1><code>0x10</code></dt><dd><p>A konzolos mûködési mód engedélyezése az adott egységhez. Ha megadjuk ezt a paramétert, akkor a többit a rendszer figyelmen kívül hagyja. Pillanatnyilag legfeljebb egy egység birtokolhatja ezt a beállítást. Ha több ilyet adtunk volna meg, akkor (a felírás sorrendje szerint) az elsõ kap ilyen szerepet. Ez a beállítás önmagában még nem teszi a soros portot konzollá. Ehhez még szükségünk van a következõ beállításra, vagy a <code>-h</code> megadására is.</p></dd><dt class=hdlist1><code>0x20</code></dt><dd><p>Az egység konzollá nyilvánítása (hacsak nincs egy tõle nagyobb prioritású konzol), függetlenül a lentebb ismertetendõ <code>-h</code> opciótól. A <code>0x20</code> értéket a <code>0x10</code> értékkel együtt kell megadni.</p></dd><dt class=hdlist1><code>0x40</code></dt><dd><p>(A <code>0x10</code> értékkel együtt) az egységet kivonja a normális elérés alól. Ezt a beállítást ne használjuk, ha soros vonali konzolt akarunk üzemeltetni az adott porton. Ezzel az egységet csak a rendszermag távoli nyomkövetéséhez tudjuk használni. A távoli nyomkövetésrõl a <a href=https://docs.freebsd.org/en/books/developers-handbook/>fejlesztõk kézikönyvében</a> olvastunk bõvebben.</p><div class=paragraph><p>Példa:</p></div><div class="literalblock programlisting"><div class=content><pre>device sio0 at isa? port IO_COM1 flags 0x10 irq 4</pre></div></div><div class=paragraph><p>A további részletekrõl a <a href="https://man.freebsd.org/cgi/man.cgi?query=sio&amp;sektion=4&amp;format=html">sio(4)</a> man oldal tud felvilágosítást nyújtani.</p></div><div class=paragraph><p>Ha nem állítottuk be a megfelelõ paramétereket, akkor (egy másik konzolon) futtassuk a UserConfig programot vagy fordítsuk újra a rendszermagot.</p></div></dd></dl></div></li><li><p>Hozzunk létre egy <span class=filename>boot.config</span> állományt a rendszer indításához használt meghajtó <code>a</code> partíciójának gyökerében.</p><div class=paragraph><p>Ez az állomány mondja meg a rendszerindító blokkban található kódnak, hogy miként akarjuk indítani a rendszerünket. A soros vonali konzol életrekeltéséhez a most következõ opciók közül kell megadnunk egyet vagy többet - amennyiben többet akarunk megadni, akkor mindegyiket egyetlen sorban szerepeltessük:</p></div><div class=dlist><dl><dt class=hdlist1><code>-h</code></dt><dd><p>A belsõ és a soros vonali konzolok közti átkapcsolás. Ezzel tudunk a konzolos eszközök között váltani. Például, ha egy belsõ (video) konzolról indítjuk a rendszert, akkor a rendszertöltõnek és a rendszermagnak átadott <code>-h</code> paraméterrel arra tudjuk ezeket utasítani, hogy konzolként a soros portot használják. Vagy ha soros porton keresztül indítjuk a rendszert, akkor <code>-h</code> megadásával megkérhetjük a rendszertöltõt és a rendszermagot, hogy ezután már a videokártyát használja konzolként.</p></dd><dt class=hdlist1><code>-D</code></dt><dd><p>Az egy- és kétkonzolos beállítások közti váltás. Az egykonzolos konfigurációban a konzol lehet belsõ (video) vagy soros vonali, attól függõen, hogy miként használtuk a fenti <code>-h</code> opciót. A kétkonzolos konfigurációban azonban a videokártyán és a soros vonalon keresztül is egyszerre megjelenik a konzol, függetlenül a <code>-h</code> hatásától. Ilyenkor viszont vegyük figyelembe, hogy ez a kétkonzolos konfiguráció csak a rendszerindító blokk futása alatt él. Amint a rendszerindító megkapja a vezérlést, a <code>-h</code> által megadott konzol válik az egyedülivé.</p></dd><dt class=hdlist1><code>-P</code></dt><dd><p>A rendszerindító blokk megpróbálja megkeresni a billentyûzetet. Ha nem találja, akkor magától beállítja a <code>-D</code> és <code>-h</code> opciókat.</p><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Tárbeli korlátozások miatt a rendszerindító blokk jelenlegi változata a <code>-P</code> paraméterrel csak a kiterjesztett billentyûzeteket képes kezelni. A 101 gombnál kevesebbel (tehát F11 és F12 gombokkal nem) rendelkezõ billentyûzeteket ezért nem feltétlenül fogja észlelni. Ugyanezen korlátozás miatt egyes laptopokon sem minden esetben sikerül érzékelni a billentyûzetet. Ha ez a rendszerünkön problémához vezetne, akkor egyszerûbb lesz elhagyni a <code>-P</code> használatát. Sajnos, jelenleg semmilyen megoldás nincs erre.</p></div></td></tr></tbody></table></div><div class=paragraph><p>Vagy a <code>-P</code> opcióval állítassuk be automatikusan a konzolt, vagy pedig a <code>-h</code> opcióval engedélyezzük a soros vonali konzolt.</p></div><div class=paragraph><p>Természetesen itt a <a href="https://man.freebsd.org/cgi/man.cgi?query=boot&amp;sektion=8&amp;format=html">boot(8)</a> man oldalon szereplõ összes többi paramétert is megadhatjuk.</p></div><div class=paragraph><p>A <code>-P</code> kivételével az összes opció a rendszertöltõnek (<span class=filename>/boot/loader</span>) kerül átadásra. A rendszertöltõ egyedül a <code>-h</code> állapotából dönti el, hogy mely belsõ videoeszközön vagy soros porton legyen a konzol. Ez azt jelenti, hogy a <span class=filename>/boot.config</span> állományban ha megadjuk a <code>-D</code> opciót, de mellette nem szerepel a <code>-h</code>, akkor a soros vonali konzolt csak a rendszerindító blokk futása alatt tudjuk elérni - a rendszertöltõ ugyanis alapból a videokártyát használja konzolként.</p></div></dd></dl></div></li><li><p>Kapcsoljuk be a számítógépünket.</p><div class=paragraph><p>Amikor elindítjuk a FreeBSD-s gépünket, a rendszerindító blokk kiírja a <span class=filename>/boot.config</span> tartalmát a konzolra. Például így:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>/boot.config: <span class=nt>-P</span>
Keyboard: no</code></pre></div></div><div class=paragraph><p>A második sor csak olyankor jelenik meg, ha a <span class=filename>/boot.config</span> állományban a <code>-P</code> beállítás is szerepel, és a billentyûzet jelenlétét (yes) vagy hiányát (no) jelzi. A <span class=filename>/boot.config</span> tartalmától függõen ezek az üzenetek vagy a soros vonali vagy a belsõ konzolon jelennek meg, esetleg mind a kettõn.</p></div><table class="tableblock frame-none grid-all stretch informaltable"><col style=width:50%><col style=width:50%><thead><tr><th class="tableblock halign-left valign-top">Beállítás</th><th class="tableblock halign-left valign-top">Ahol megjelenik</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class=tableblock>nincs</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>belsõ konzol</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>-h</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>soros vonali konzol</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>-D</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>soros vonali és belsõ konzol</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>-Dh</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>soros vonali és belsõ konzol</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>-P</code>, van billentyûzet</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>belsõ konzol</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>-P</code>, nincs billentyûzet</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>soros vonali konzol</p></td></tr></tbody></table><div class=paragraph><p>Az iménti üzenetek felbukkanása után a további konzolos üzenetek küldésében egy rövid szünet következik, amíg a rendszerindító blokk a rendszertöltõ betöltésével folytatja a rendszer indítását. Normális körülmények között ezt a folyamatot nem kell megszakítanunk, de esetleg olyankor mégis érdemes lehet, ha le akarjuk ellenõrizni a beállításainkat.</p></div><div class=paragraph><p>A rendszerindítási folyamat félbeszakításához az <kbd>Enter</kbd> billentyûn kívül nyomjuk le valamelyik másikat. Ekkor a rendszerindító blokk megáll és várja a további parancsokat. Ekkor valami ilyesmit láthatunk:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=o>&gt;&gt;</span> FreeBSD/i386 BOOT
Default: 0:ad<span class=o>(</span>0,a<span class=o>)</span>/boot/loader
boot:</code></pre></div></div><div class=paragraph><p>Nézzük meg, hogy <span class=filename>/boot.config</span> beállításainak megfelelõen a fenti üzenet a soros vonali konzolon vagy a belsõ konzolon, illetve mind a kettõn megjelenik-e. Ha az üzenet a megfelelõ konzolon megjelenik, akkor az <kbd>Enter</kbd> lenyomásával folytathatjuk a rendszer indítását.</p></div><div class=paragraph><p>Ha nekünk a soros vonali konzolra lenne szükségünk, de semmi nem jelenik meg a soros terminálon, akkor valamit valószínûleg nem jól állítottunk be. A rendszerindító blokktól kapott parancssorban a <code>-h</code> begépelésével és az <kbd>Enter</kbd> vagy <kbd>Return</kbd> lenyomásával (ha lehetséges) jelezzük neki (és így a rendszertöltõnek és a rendszermagnak is) a soros vonali konzol kiválasztását. Miután befejezõdött a rendszer indítása, menjünk vissza és ellenõrizzük a megfelelõ paramétereket.</p></div></li></ol></div></div></div><div class=paragraph><p>Ahogy sikerült elindítani a rendszertöltõt és a rendszerindítás harmadik fokozatába léptünk, a rendszertöltõ megfelelõ környezeti változóin keresztül még mindig van lehetõségünk váltani a soros vonali és a belsõ konzol között, lásd <a href=#serialconsole-loader>A konzol megváltoztatása a rendszertöltõbõl</a>.</p></div></div><div class=sect3><h4 id=serialconsole-summary>26.6.4. Összefoglalás<a class=anchor href=#serialconsole-summary></a></h4><div class=paragraph><p>Itt most röviden összefoglaljuk az eddig tárgyalt különbözõ beállításokat és ténylegesen kiválasztott konzolt.</p></div><div class=sect4><h5 id=_1_eset_a_sio0_eszköznél_a_0x10_beállítást_adjuk_meg>26.6.4.1. 1. eset: a <span class=filename>sio0</span> eszköznél a 0x10 beállítást adjuk meg<a class=anchor href=#_1_eset_a_sio0_eszköznél_a_0x10_beállítást_adjuk_meg></a></h5><div class="literalblock programlisting"><div class=content><pre>device sio0 at isa? port IO_COM1 flags 0x10 irq 4</pre></div></div><table class="tableblock frame-none grid-all stretch informaltable"><col style=width:25%><col style=width:25%><col style=width:25%><col style=width:25%><thead><tr><th class="tableblock halign-left valign-top">A /boot.config beállításai</th><th class="tableblock halign-left valign-top">Konzol a rendszerindító blokk alatt</th><th class="tableblock halign-left valign-top">Konzol a rendszertöltõ alatt</th><th class="tableblock halign-left valign-top">Konzol a rendszermagban</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class=tableblock>nincsenek</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>belsõ</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>belsõ</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>belsõ</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>-h</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>soros vonali</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>soros vonali</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>soros vonali</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>-D</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>soros vonali és belsõ</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>belsõ</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>belsõ</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>-Dh</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>soros vonali és belsõ</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>soros vonali</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>soros vonali</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>-P</code>, van billentyûzet</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>belsõ</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>belsõ</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>belsõ</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>-P</code>, nincs billentyûzet</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>soros vonali és belsõ</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>soros vonali</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>soros vonali</p></td></tr></tbody></table></div><div class=sect4><h5 id=_2_eset_a_sio0_eszköznél_0x30_beállítása>26.6.4.2. 2. eset: a <span class=filename>sio0</span> eszköznél 0x30 beállítása<a class=anchor href=#_2_eset_a_sio0_eszköznél_0x30_beállítása></a></h5><div class="literalblock programlisting"><div class=content><pre>device sio0 at isa? port IO_COM1 flags 0x30 irq 4</pre></div></div><table class="tableblock frame-none grid-all stretch informaltable"><col style=width:25%><col style=width:25%><col style=width:25%><col style=width:25%><thead><tr><th class="tableblock halign-left valign-top">A /boot.config beállításai</th><th class="tableblock halign-left valign-top">Konzol a rendszerindító blokk alatt</th><th class="tableblock halign-left valign-top">Konzol a rendszertöltõ alatt</th><th class="tableblock halign-left valign-top">Konzol a rendszermagban</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class=tableblock>nincsenek</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>belsõ</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>belsõ</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>soros vonali</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>-h</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>soros vonali</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>soros vonali</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>soros vonali</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>-D</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>soros vonali és belsõ</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>belsõ</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>soros vonali</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>-Dh</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>soros vonali és belsõ</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>soros vonali</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>soros vonali</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>-P</code>, van billentyûzet</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>belsõ</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>belsõ</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>soros vonali</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>-P</code>, nincs billentyûzet</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>soros vonali és belsõ</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>soros vonali</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>soros vonali</p></td></tr></tbody></table></div></div><div class=sect3><h4 id=serialconsole-tips>26.6.5. Tanácsok a soros vonali konzol használatához<a class=anchor href=#serialconsole-tips></a></h4><div class=sect4><h5 id=_nagyobb_soros_vonali_sebesség_beállítása>26.6.5.1. Nagyobb soros vonali sebesség beállítása<a class=anchor href=#_nagyobb_soros_vonali_sebesség_beállítása></a></h5><div class=paragraph><p>A soros port alapértelmezései a következõk: 9600 baud, 8 bites átvitel, paritás nincs és 1 stopbit. Ha a konzol alapsebességét meg akarjuk változtatni, akkor ahhoz a következõket kell tennünk:</p></div><div class=ulist><ul><li><p>Fordítsuk újra a rendszerindító blokkokat úgy, hogy a <code>BOOT_COMCONSOLE_SPEED</code> változóban a konzolnak egy másik sebességet adunk meg. Az új rendszerindító blokkok fordításáról és telepítésérõl a <a href=#serialconsole-com2>Soros vonali konzol a <span class=filename>sio0</span> porton kívül máshol</a>ban kapunk részletes leírást.</p><div class=paragraph><p>Ha a soros vonali konzolt nem a <code>-h</code> opcióval állítottuk be, vagy ha a rendszermag a rendszerindító blokkoktól eltérõ módon éri el a soros vonali konzolt, akkor a rendszermag beállításai közé még az alábbit is fel kell vennünk, majd újra kell fordítanunk:</p></div><div class="literalblock programlisting"><div class=content><pre>options CONSPEED=19200</pre></div></div></li><li><p>A rendszermagnak adjuk át a <code>-S</code> rendszerindítási paramétert. A <code>-S</code> parancssori opció a <span class=filename>/boot.config</span> állományban is megadható. A <a href="https://man.freebsd.org/cgi/man.cgi?query=boot&amp;sektion=8&amp;format=html">boot(8)</a> man oldalon tudhatjuk meg, hogy a <span class=filename>/boot.config</span> beállításai közé hogyan tudjuk felvenni és ott milyen további lehetõségeink vannak még.</p></li><li><p>A <span class=filename>/boot/loader.conf</span> állományban engedélyezzük a <code>comconsole_speed</code> beállítást.</p><div class=paragraph><p>Ez a beállítás a szintén a <span class=filename>/boot/loader.conf</span> állományban megadható <code>console</code>, <code>boot_serial</code> és <code>boot_multicons</code> változóktól függ. A soros vonali konzol sebességét tehát például így tudjuk megváltoztatni a <code>comconsole_speed</code> megadásával:</p></div><div class="literalblock programlisting"><div class=content><pre>boot_multicons=&#34;YES&#34;
boot_serial=&#34;YES&#34;
comconsole_speed=&#34;115200&#34;
console=&#34;comconsole,vidconsole&#34;</pre></div></div></li></ul></div></div><div class=sect4><h5 id=serialconsole-com2>26.6.5.2. Soros vonali konzol a <span class=filename>sio0</span> porton kívül máshol<a class=anchor href=#serialconsole-com2></a></h5><div class=paragraph><p>Ha valamilyen okból kifolyólag nem a <span class=filename>sio0</span> porton keresztül akarjuk használni a konzolt, akkor ahhoz a rendszerindító blokkok, a rendszertöltõ és a rendszermag forrásait újra kell fordítanunk az alábbiak szerint:</p></div><div class="exampleblock procedure"><div class=content><div class="olist arabic"><ol class=arabic><li><p>Szerezzük be a rendszermag forrását. (Lásd <a href=./#updating-upgrading>A FreeBSD frissítése és frissen tartása</a>)</p></li><li><p>Írjuk át a <span class=filename>/etc/make.conf</span> állományban a <code>BOOT_COMCONSOLE_PORT</code> címét az általunk használt porthoz tartozóéra (0x3F8, 0x2F8, 0x3E8 vagy 0x2E8). Itt csak a <span class=filename>sio0</span> és <span class=filename>sio3</span> (<span class=filename>COM1</span> és <span class=filename>COM4</span>) közti portok használhatóak - a töbportos soros kártyák címei nem adhatóak meg. A megszakításokat nem kell beállítanunk.</p></li><li><p>Készítsünk egy saját rendszermag beállításait tartalmazó állományt, és vegyük fel bele a használni kívánt soros port megfelelõ paramétereit. Például, ha a <span class=filename>sio1</span> (<span class=filename>COM2</span>) eszközt akarjuk konzolként használni:</p><div class="literalblock programlisting"><div class=content><pre>device sio1 at isa? port IO_COM2 flags 0x10 irq 3</pre></div></div><div class=paragraph><p>vagy</p></div><div class="literalblock programlisting"><div class=content><pre>device sio1 at isa? port IO_COM2 flags 0x30 irq 3</pre></div></div><div class=paragraph><p>A konzolra vonatkozó beállításokat a többi soros portnál ne adjuk meg.</p></div></li><li><p>Fordítsuk újra és telepítsük a rendszerindító blokkot és a rendszertöltõt:</p><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># cd /sys/boot</span>
<span class=c># make clean</span>
<span class=c># make</span>
<span class=c># make install</span></code></pre></div></div></li><li><p>Fordítsuk és telepítsük újra a rendszermagot.</p></li><li><p>A <a href="https://man.freebsd.org/cgi/man.cgi?query=bsdlabel&amp;sektion=8&amp;format=html">bsdlabel(8)</a> segítségével másoljuk az új rendszerindító blokkot a rendszer indítását végzõ lemezre és töltsük be az új rendszermagot.</p></li></ol></div></div></div></div><div class=sect4><h5 id=serialconsole-ddb>26.6.5.3. A DDB elérése a soros vonalról<a class=anchor href=#serialconsole-ddb></a></h5><div class=paragraph><p>Ha a soros vonali konzolról akarjuk használni a rendszermagba épített nyomkövetõt (ami hasznos lehet távoli vizsgálódáskor, de egyben veszélyes is, ha a soros porton tévesen kiküldünk egy BREAK jelzést!), akkor a rendszermagot a következõ beállításokkal kell fordítanunk:</p></div><div class="literalblock programlisting"><div class=content><pre>options BREAK_TO_DEBUGGER
options DDB</pre></div></div></div><div class=sect4><h5 id=_a_bejelentkezõ_képernyõ_elérése_a_soros_vonali_konzolról>26.6.5.4. A bejelentkezõ képernyõ elérése a soros vonali konzolról<a class=anchor href=#_a_bejelentkezõ_képernyõ_elérése_a_soros_vonali_konzolról></a></h5><div class=paragraph><p>Habár erre nincs feltétlenül szükségünk, a rendszer üzeneteinek és a rendszermag nyomkövetõjének elérése után akár <em>be is tudunk jelentkezni</em> a soros vonalon keresztül. Íme!</p></div><div class=paragraph><p>Nyissuk meg az <span class=filename>/etc/ttys</span> állományt a kedvenc szövegszerkesztõnkkel és keressük meg a következõ sorokat:</p></div><div class="literalblock programlisting"><div class=content><pre>ttyd0 &#34;/usr/libexec/getty std.9600&#34; unknown off secure
ttyd1 &#34;/usr/libexec/getty std.9600&#34; unknown off secure
ttyd2 &#34;/usr/libexec/getty std.9600&#34; unknown off secure
ttyd3 &#34;/usr/libexec/getty std.9600&#34; unknown off secure</pre></div></div><div class=paragraph><p>A <span class=filename>ttyd0</span> és <span class=filename>ttyd3</span> közti sorok pontosan a <span class=filename>COM1</span> és <span class=filename>COM4</span> közti portoknak felelnek meg. A használni kívánt port sorában szereplõ <code>off</code> paramétert írjuk át az <code>on</code> értékre. Ha a soros port sebességét is megváltoztattuk, minden bizonnyal a <code>std.9600</code> helyett is az adott sebességhez illeszkedõ paramétert kell megadnunk, például az <code>std.19200</code> értékkel.</p></div><div class=paragraph><p>Érdemes továbbá még az <code>unknown</code> helyett megadni az adott terminál típusát.</p></div><div class=paragraph><p>Az állomány módosítását követõen a változatások érvényesítéséhez ki kell adnunk a <code>kill -HUP 1</code> parancsot is.</p></div></div></div><div class=sect3><h4 id=serialconsole-loader>26.6.6. A konzol megváltoztatása a rendszertöltõbõl<a class=anchor href=#serialconsole-loader></a></h4><div class=paragraph><p>A korábbi szakaszokban arról beszéltünk, hogy miként állítsuk be a soros vonali konzolt a rendszerindító blokk megpiszkálásával. Ebben a szakaszban viszont azt mutatjuk meg, hogy különbözõ parancsokon és környezeti változókon keresztül miként tudjuk megadni a konzolt a rendszertöltõben. Mivel a rendszertöltõre a rendszerindítás harmadik fokozatában kerül sor, az ott megadott értékekkel felül tudjuk bírálni a rendszerindító blokk beállításait.</p></div><div class=sect4><h5 id=_a_soros_vonali_konzol_beállítása>26.6.6.1. A soros vonali konzol beállítása<a class=anchor href=#_a_soros_vonali_konzol_beállítása></a></h5><div class=paragraph><p>A rendszertöltõ és a rendszermag az <span class=filename>/boot/loader.conf</span> állományon keresztül elég könnyen rávehetõ a soros vonali konzol használatára:</p></div><div class="literalblock programlisting"><div class=content><pre>set console=&#34;comconsole&#34;</pre></div></div><div class=paragraph><p>Ez a rendszerindító blokk elõzõ szakaszban tárgyalt beállításaitól függetlenül érvényesül.</p></div><div class=paragraph><p>A fenti sort a <span class=filename>/boot/loader.conf</span> állomány elejére érdemes tennünk, így a soros vonali konzolon már a lehetõ leghamarabb megjelennek a rendszer üzenetei.</p></div><div class=paragraph><p>Ehhez hasonló módon a belsõ konzolt is megadhatjuk:</p></div><div class="literalblock programlisting"><div class=content><pre>set console=&#34;vidconsole&#34;</pre></div></div><div class=paragraph><p>Ha a rendszertöltõben nem adjuk meg a <code>console</code> környezeti változó értékét, akkor a rendszertöltõ, és így a rendszermag is, a rendszerindító blokkban a <code>-h</code> opció által meghatározott konzolt fogja használni.</p></div><div class=paragraph><p>A konzol a <span class=filename>/boot/loader.conf.local</span> vagy a <span class=filename>/boot/loader.conf</span> állományokban adható meg.</p></div><div class=paragraph><p>A részletekkel kapcsolatban lásd a <a href="https://man.freebsd.org/cgi/man.cgi?query=loader.conf&amp;sektion=5&amp;format=html">loader.conf(5)</a> man oldalt.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Jelen pillanatban a rendszertöltõnek nincs a <code>-P</code> paraméterrel ekvivalens értékû beállítása, ezért a billentyûzet jelenléte alapján nem képes magától választani a belsõ és a soros vonali konzol között.</p></div></td></tr></tbody></table></div></div><div class=sect4><h5 id=_soros_vonali_konzol_a_sio0_porton_kívül_máshol>26.6.6.2. Soros vonali konzol a <span class=filename>sio0</span> porton kívül máshol<a class=anchor href=#_soros_vonali_konzol_a_sio0_porton_kívül_máshol></a></h5><div class=paragraph><p>A rendszertöltõt ne a <span class=filename>sio0</span> eszközzel fordítsuk újra a soros vonali konzolhoz. Ehhez kövessük a <a href=#serialconsole-com2>Soros vonali konzol a <span class=filename>sio0</span> porton kívül máshol</a>ban leírt eljárás lépéseit.</p></div></div></div><div class=sect3><h4 id=serialconsole-caveats>26.6.7. Figyelmeztetések<a class=anchor href=#serialconsole-caveats></a></h4><div class=paragraph><p>A szakaszban szereplõ ötletek alapján sokan így most már könnyen be tudnak állítani egy billentyûzet és grafikus hardver nélküli dedikált szervert. Sajnos azonban a legtöbb rendszer nem engedi a billentyûzet nélküli indítást, és akad néhány olyan is, amely pedig a grafikus kártya hiányában nem is indul el. Az AMI BIOS-os gépeknél a grafikus kártya nélküli indításhoz elegendõ csupán a beállítások között a grafikus kártyát ("graphics adapter") "Not installed" (nem telepített) állapotúra állítani. Ha ilyen opció nem található a BIOS-ban, akkor helyette keressük a "Halt on Error" (leállás hiba esetén) változatot. Ha ezt a "All but Keyboard" (a billentyûzet kivételével minden) vagy akár a "No Error" (soha) értékre állítjuk, az elõbbi eredményt kapjuk.</p></div><div class=paragraph><p>Ennek ellenére elõfordulhat azonban, hogy egyes gépeken egyáltalán nem találunk ilyen lehetõséget és videokártya nélkül nem indulnak el. Ezekben az esetekben tegyünk a gépbe valamilyen kártyát (ehhez elég egy egyszerû típus is), de monitort már ne kössünk rá. Esetleg megpróbálkozhatunk még AMI BIOS telepítésével is.</p></div></div></div></div></div><div class=sect1><h2 id=ppp-and-slip>Chapter 27. A PPP és a SLIP<a class=anchor href=#ppp-and-slip></a></h2><div class=sectionbody><div class=sect2><h3 id=ppp-and-slip-synopsis>27.1. Áttekintés<a class=anchor href=#ppp-and-slip-synopsis></a></h3><div class=paragraph><p>A FreeBSD számos módon képes összekötni két számítógépet. Ha betárcsázós modemmel akarunk hálózati vagy internetes kapcsolatot felépíteni, esetleg azt szeretnénk, hogy mások képesek legyenek minket ilyen módon elérni, akkor ahhoz PPP-t, illetve SLIP-et kell használnunk. Ebben a fejezetben a modemes kommunikáció beállításait mutatjuk be részletesebben.</p></div><div class=paragraph><p>A fejezet elolvasása során megismerjük:</p></div><div class=ulist><ul><li><p>hogyan állítsunk be felhasználói PPP-t;</p></li><li><p>hogyan állítsunk be rendszerszintû PPP-t (csak FreeBSD 7.<em>X</em>);</p></li><li><p>hogyan állítsunk be egy PPPoE (PPP over Ethernet, vagyis "PPP Ethernet felett") kapcsolatot;</p></li><li><p>hogyan állítsunk be egy PPPoA (PPP over ATM, vagyis "PPP ATM felett") kapcsolatot;</p></li><li><p>hogyan állítsunk be SLIP klienst és szervert (csak FreeBSD 7.<em>X</em>).</p></li></ul></div><div class=paragraph><p>A fejezet elolvasásához ajánlott:</p></div><div class=ulist><ul><li><p>az alapvetõ hálózati technológiák ismerete;</p></li><li><p>a betárcsázós kapcsolatok, a PPP és/vagy SLIP alapjainak és céljainak megértése.</p></li></ul></div><div class=paragraph><p>Talán érdekli a kedves olvasót, hogy mi az alapvetõ különbség a felhasználói és a rendszerszintû PPP között. A válasz egyszerû: a felhasználói PPP a beérkezõ és kimenõ adatokat nem a rendszermagban, hanem a felhasználói szinten dolgozza fel. Ez költséges abból a szempontból, hogy emiatt adatokat kell másolgatni a rendszer és a felhasználói szint között, azonban egy sokkal többet tudó PPP implementációnak ad ezzel utat. A felhasználói PPP a <span class=filename>tun</span> eszközön keresztül kommunikál a külvilággal, miközben a rendszermagban található PPP mindezt a <span class=filename>ppp</span> eszközzel valósítja meg.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>A fejezetben a felhasználói PPP-t egyszerûen csak ppp néven fogjuk hivatkozni, hacsak nem lesz szükséges különbséget tennünk közte és más PPP szoftverek, mint például a pppd között. Ha mást nem mondunk, akkor a fejezetben ismertetett összes parancsot <code>root</code> felhasználóként kell kiadni.</p></div></td></tr></tbody></table></div></div><div class=sect2><h3 id=userppp>27.2. A felhasználói PPP alkalmazása<a class=anchor href=#userppp></a></h3><div class="admonitionblock warning"><table><tbody><tr><td class=icon><i class="fa icon-warning" title=Warning></i></td><td class=content><div class=paragraph><p>A FreeBSD 8.0 változatától kezdõdõen a soros portokhoz tartozó eszközök nevei <span class=filename>/dev/cuadN</span> helyett <span class=filename>/dev/cuauN</span>, illetve <span class=filename>/dev/ttydN</span> helyett <span class=filename>/dev/ttyuN</span> lettek. A FreeBSD 7.<em>X</em> felhasználóknak ezeknek a változásoknak megfelelõen kell olvasniuk az itt szereplõ dokumentációt.</p></div></td></tr></tbody></table></div><div class=sect3><h4 id=_a_felhasználói_ppp>27.2.1. A felhasználói PPP<a class=anchor href=#_a_felhasználói_ppp></a></h4><div class=sect4><h5 id=_elõfeltételek>27.2.1.1. Elõfeltételek<a class=anchor href=#_elõfeltételek></a></h5><div class=paragraph><p>A leírás feltételezi, hogy rendelkezünk a következõkkel:</p></div><div class=ulist><ul><li><p>Olyan internet-elõfizetés, ahol PPP-n keresztül csatlakozunk</p></li><li><p>Egy modem vagy más olyan rendszerünkhöz csatlakozó eszköz, amelyen keresztül el tudjuk érni az internet-szolgáltatónkat</p></li><li><p>Az internet-elõfizetés betárcsázásához szükséges telefonszámok</p></li><li><p>A bejelentkezési nevünk és jelszavunk. (Vagy a megszokott UNIX®-os felhasználói név és jelszó páros, vagy egy PAP esetleg CHAP bejelentkezési név és jelszó.)</p></li><li><p>Egy vagy több névszerver IP-címe. Ehhez az internet-szolgáltatók általában két IP-címet adnak meg. Ha egyet sem kaptunk, akkor a <span class=filename>ppp.conf</span> állományban erre a célra használhatjuk az <code>enable dns</code> parancsot, és ekkor a ppp majd automatikusan be fogja állítani nekünk a névszervereket. Ezt a lehetõséget az befolyásolja, hogy az internet-szolgáltató oldalán mûködõ PPP implementáció támogatja-e a névfeloldás egyeztetését (DNS negotiation).</p></li></ul></div><div class=paragraph><p>A következõ információkat is megkaphatjuk az internet-elõfizetésünkhöz, de nem feltétlenül szükségesek:</p></div><div class=ulist><ul><li><p>Az internet-szolgáltató átjárójának IP-címe. Az átjáró az a gép, amelyen keresztül a gépünk csatlakozik és számára ez lesz az <em>alapértelmezett átjáró</em>. Ha nem rendelkezünk ezzel az információval, akkor csak állítsunk be valamit, és majd a csatlakozáskor a szolgáltató PPP szervere felülírja a megfelelõ beállításokkal.</p><div class=paragraph><p>Erre a címre a ppp <code>HISADDR</code> néven hivatkozik.</p></div></li><li><p>A használandó hálózati maszk. Amennyiben a szolgáltató ezt nem adta meg, nyugodtan használjuk erre a <code>255.255.255.255</code> értéket.</p></li><li><p>Ha a szolgáltatónk statikus IP-címet és rögzített hálózati nevet is biztosít nekünk, ezt is megadhatjuk. Minden más esetben egyszerûen csak hagyjuk, hogy a rendszer automatikusan válasszon nekünk egyet.</p></li></ul></div><div class=paragraph><p>Ha a szükséges információknak nem vagyunk birtokában, akkor vegyük fel a kapcsolatot az internet-szolgáltatókkal.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Ebben a szakaszban a példákban szereplõ konfigurációs állományok sorait számozva láthatjuk. Ezek a sorszámok a bemutatás és a tárgyalás megkönnyítése érdekében szerepelnek, és nem az eredeti állományok részei. Mindezek mellett a tabulátorok és szóközök megfelelõ használata is fontos.</p></div></td></tr></tbody></table></div></div><div class=sect4><h5 id=_a_ppp_automatikus_beállítása>27.2.1.2. A PPP automatikus beállítása<a class=anchor href=#_a_ppp_automatikus_beállítása></a></h5><div class=paragraph><p>A <code>ppp</code> és a <code>pppd</code> (a PPP rendszerszintû megvalósítása) egyaránt az <span class=filename>/etc/ppp</span> könyvtárban található konfigurációs állományokat használja. A felhasználói PPP-hez ezenkívül még a <span class=filename>/usr/shared/examples/ppp/</span> könyvtárban vannak példák.</p></div><div class=paragraph><p>A <code>ppp</code> parancs beállítása az igényeinktõl függõen számos állomány módosítását igényelheti. A tartalmukat nagyban befolyásolja, hogy a szolgáltatónk részérõl a címeket kiosztása statikus (vagyis egy adott címet kapunk és folyamatosan azt használjuk) esetleg dinamikus (vagyis az IP-címünk minden egyes kapcsolódáskor más és más).</p></div><div class=sect5><h6 id=userppp-staticIP>27.2.1.2.1. PPP statikus IP-címmel<a class=anchor href=#userppp-staticIP></a></h6><div class=paragraph><p>Ebben az esetben az <span class=filename>/etc/ppp/ppp.conf</span> konfigurációs állományt kell átszerkesztenünk. Tartalma az alábbi példához hasonlítható.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>A <code>:</code> karakterrel végzõdõ sorok mindig az elsõ oszlopban kezdõdnek (tehát a sor elején), míg az összes többi sort tabulátorok vagy szóközök használatával bentebb kell raknunk.</p></div></td></tr></tbody></table></div><div class="literalblock programlisting"><div class=content><pre>1     default:
2       set log Phase Chat LCP IPCP CCP tun command
3       ident user-ppp VERSION (built COMPILATIONDATE)
4       set device /dev/cuau0
5       set speed 115200
6       set dial &#34;ABORT BUSY ABORT NO\\sCARRIER TIMEOUT 5 \
7                 \&#34;\&#34; AT OK-AT-OK ATE1Q0 OK \\dATDT\\T TIMEOUT 40 CONNECT&#34;
8       set timeout 180
9       enable dns
10
11    szolgaltato:
12      set phone &#34;(123) 456 7890&#34;
13      set authname ize
14      set authkey mize
15      set login &#34;TIMEOUT 10 \&#34;\&#34; \&#34;\&#34; gin:--gin: \\U word: \\P col: ppp&#34;
16      set timeout 300
17      set ifaddr x.x.x.x y.y.y.y 255.255.255.255 0.0.0.0
18      add default HISADDR</pre></div></div><div class=dlist><dl><dt class=hdlist1>1- sor</dt><dd><p>Ez azonosítja be az alapértelmezett bejegyzést. Az itt szereplõ parancsok a <code>ppp</code> minden egyes futásakor magukból végrehajtódnak.</p></dd><dt class=hdlist1>2- sor</dt><dd><p>Beállítja a naplózás paramétereit. Amikor a beállításaink már kifogástalanul mûködnek, akkor ezt a sort érdemes átírni a következõre:</p><div class="literalblock programlisting"><div class=content><pre>set log phase tun</pre></div></div><div class=paragraph><p>Ezzel jelentõs mértékben vissza tudjuk fogni a naplózás mértékét.</p></div></dd><dt class=hdlist1>3- sor</dt><dd><p>Ezzel mondjuk meg a PPP-nek, hogy a többiek felé miként azonosítsa magát. A PPP akkor azonosítja magát a társak felé, ha valamilyen gondja akad az egyeztetésekkel és a kapcsolat beállításával. Az így továbbított információk a másik oldal rendszergazdái számára nyújthatnak segítséget az ilyen jellegû problémák felderítésében.</p></dd><dt class=hdlist1>4- sor</dt><dd><p>Itt adjuk meg az eszközt, amelyre a modem csatlakozik. A <span class=filename>COM1</span> neve <span class=filename>/dev/cuau0</span>, a <span class=filename>COM2</span> neve pedig <span class=filename>/dev/cuau1</span>.</p></dd><dt class=hdlist1>5- sor</dt><dd><p>A csatlakozás sebességét adjuk meg. Ha a 115 200-as érték itt nem mûködne (ez egyébként minden újabb gyártmányú modem esetében elfogadható), akkor helyette használjuk a 38400-as beállítást.</p></dd><dt class=hdlist1>6- és 7- sorok</dt><dd><p>A híváshoz használt karakterlánc. A felhasználói PPP a <a href="https://man.freebsd.org/cgi/man.cgi?query=chat&amp;sektion=8&amp;format=html">chat(8)</a> programhoz hasonló "küldök-várok" típusú szerkesztést alkalmaz. A kihasználható lehetõségekrõl a man oldalán olvashatunk részletesebben.</p><div class=paragraph><p>Az olvashatóság kedvéért a parancs a következõ sorban folytatódik. A <span class=filename>ppp.conf</span> állományban bármelyik parancs, ahol a <code>\</code> karakterrel zárjuk a sort, az ugyanígy folytatható a következõben.</p></div></dd><dt class=hdlist1>8- sor</dt><dd><p>A kapcsolathoz tartozó üresjárati idõt állítja be. Ennek értéke alapból 180 másodperc, így ez a sor pusztán csak az érthetõséget szolgálja.</p></dd><dt class=hdlist1>9- sor</dt><dd><p>Arra utasítja a PPP-t, hogy a többiektõl kérdezze le a helyi névfeloldó beállításait. Ha saját névszervert futtatunk, akkor ezt a sort tegyük inkább megjegyzésbe vagy töröljük ki.</p></dd><dt class=hdlist1>10- sor</dt><dd><p>Ez az üres sor az átláthatóság kedvéért került bele. A PPP az összes üres sort figyelmen kívül hagyja.</p></dd><dt class=hdlist1>11- sor</dt><dd><p>Itt kezdõdik a "szolgaltato" nevû szolgáltatóhoz tartozó bejegyzés. Ezt késõbb akár ki is cserélhetjük az internet-szolgáltatónk nevére, így a <code>load <em>szolgáltató</em></code> beállítással tudjuk majd beindítani a kapcsolatot.</p></dd><dt class=hdlist1>12- sor</dt><dd><p>Beállítjuk a szolgáltatóhoz tartozó telefonszámot. A kettõspont (<code>:</code>) vagy a csõvezeték (<code>|</code>) karakterekkel elválasztva több telefonszámot is meg tudunk adni. A <a href="https://man.freebsd.org/cgi/man.cgi?query=ppp&amp;sektion=8&amp;format=html">ppp(8)</a> oldalon olvashatunk a két elválasztó közti különbségekrõl. Röviden ezeket úgy foglalhatnánk össze, hogy ha váltogatni akarunk a számok között, akkor használjuk a kettõspontot. Ha mindig az elsõként megadott számot akarjuk hívni és a többit csak akkor, ha ez nem mûködik, akkor a csõvezeték karakterre lesz szükségünk. Ahogy a példa is mutatja, az összes telefonszámot tegyük mindig idézõjelek közé.</p><div class=paragraph><p>Ha a telefonszámban egyébként is szerepelnek szóközök, akkor is idézõjelek (<code>"</code>) közé kell tennünk. Ennek elhagyásával egy egyszerû, ámde kényes hibát ejtünk.</p></div></dd><dt class=hdlist1>13- és 14- sor</dt><dd><p>A felhasználói nevet és jelszót tartalmazza. Amikor egy UNIX® fajtájú bejelentkezést kapunk, akkor ezekre az értékekre a <code>set login</code> parancsban \U és \P változókkal tudunk hivatkozni. Ha PAP vagy CHAP használatával jelentkezünk be, akkor ezek az értékek a hitelesítéskor kerülnek felhasználásra.</p></dd><dt class=hdlist1>15- sor</dt><dd><p>Ha a PAP vagy CHAP protokollok valamelyikét használjuk, akkor nem lesz szükségünk a login változóra, ezért ezt megjegyzésbe is tehetjük, vagy akár ki is törölhetjük. A <a href=#userppp-PAPnCHAP>PAP és CHAP hitelesítésrõl</a> szóló részben olvashatjuk ennek további részleteit.</p><div class=paragraph><p>A bejelentkezéshez használt karakterlánc hasonlít a behíváshoz használt, chat-szerû felépítéssel rendelkezõ karakterlánchoz. A példában látható karakterlánc egy olyan szolgáltatáshoz illeszkedik, ahol a bejelentkezés valahogy így néz ki:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>A Világ Legjobb Szolgáltatója
login: izé
password: mizé
protocol: ppp</code></pre></div></div><div class=paragraph><p>Ezt a szkriptet alakítsuk a saját igényeinkhez. Ha elõször próbálkozunk ilyen szkript írásával, akkor lehetõleg kapcsoljuk be a rendszerek között lezajló "beszélgetés" naplózását, hogy ellenõrizni tudjuk minden a megfelelõen módon történik-e.</p></div></dd><dt class=hdlist1>16- sor</dt><dd><p>Beállítjuk a kapcsolathoz tartozó alapértelmezett idõkorlátot (másodpercben). Itt a kapcsolat automatikusan lezárul 300 másodperc tétlenséget követõen. Ha nem akarunk ilyen korlátot szabni, akkor ezt az értéket állítsuk nullára vagy használjuk a <code>-ddial</code> paranccsori kapcsolót.</p></dd><dt class=hdlist1>17- sor</dt><dd><p>A felülethez tartozó címeket állítja be. A <em>x.x.x.x</em> helyére a szolgáltató által kiosztott IP-címet kell beírnunk. A <em>y.y.y.y</em> helyett pedig a szolgáltató átjárója kerül be (lényegében az a gép, amelyhez csatlakozunk). Amennyiben az internet-szolgáltatónk nem adott meg semmilyen átjárót, erre a célra a <code>10.0.0.2/0</code> címet is használhatjuk. Amikor "nekünk kell kitalálnunk" ezeket a címeket, akkor ne felejtsünk el létrehozni hozzájuk egy bejegyzést az <span class=filename>/etc/ppp/ppp.linkup</span> állományban a <a href=#userppp-dynamicIP>PPP dinamikus IP-címmel </a>szakaszban szereplõek szerint. Ha nem adjuk meg ezt a sort, akkor a <code>ppp</code> parancs nem képes <code>-auto</code> módban mûködni.</p></dd><dt class=hdlist1>18- sor</dt><dd><p>A szolgáltató átjárójához felvesz egy alapértelmezett útvonalat. A <code>HISADDR</code> kulcsszót a 17. sorban megadott átjáró címével helyettesítjük. Ezért fontos, hogy ez a 17. sor után szerepeljen, különben a <code>HISADDR</code> nem lesz képes inicializálódni.</p><div class=paragraph><p>Ha a <code>ppp</code> parancsot nem akarjuk <code>-auto</code> módban futtatni, akkor ezt a sort a <span class=filename>ppp.linkup</span> állományba is átrakhatjuk.</p></div></dd></dl></div><div class=paragraph><p>Ha statikus IP-címmel rendelkezünk és a <code>ppp -auto</code> módban fut, akkor a <span class=filename>ppp.linkup</span> állományba egészen addig nem kell semmit sem írnunk, amíg a csatlakozás elõtt az útválasztási táblázatokban a megfelelõ adatok találhatóak. Olyankor is jól jöhet, amikor a csatlakozást követõen meg akarunk hívni bizonyos programokat. Ezt majd a sendmailes példában fogjuk bõvebben kifejteni.</p></div><div class=paragraph><p>Erre példákat a <span class=filename>/usr/shared/examples/ppp/</span> könyvtárban találhatunk.</p></div></div><div class=sect5><h6 id=userppp-dynamicIP>27.2.1.2.2. PPP dinamikus IP-címmel<a class=anchor href=#userppp-dynamicIP></a></h6><div class=paragraph><p>Ha az internet-szolgáltatónktól nem kaptunk statikus IP-címet, akkor a <code>ppp</code> paranccsal is be tudjuk állítani a helyi és távoli címeket. Ez az IP-címek "kitalálásával" történik, valamint úgy, hogy a <code>ppp</code> számára a csatlakozás után lehetõvé tesszük az IP konfigurációs protocol (IP Configuration Protocol, IPCP) használatát. A <span class=filename>ppp.conf</span> tartalma szinte teljesen megegyezik a <a href=#userppp-staticIP>PPP statikus IP-címmel</a> részben szereplõvel, egyetlen apró különbséggel:</p></div><div class="literalblock programlisting"><div class=content><pre>17      set ifaddr 10.0.0.1/0 10.0.0.2/0 255.255.255.255</pre></div></div><div class=paragraph><p>Ismét szeretnénk elmondani, hogy a sorszámot ne írjuk bele, hiszen az csak hivatkozási céllal szerepel. Legalább egy szóközzel kezdjünk bentebb.</p></div><div class=dlist><dl><dt class=hdlist1>17- sor</dt><dd><p>A <code>/</code> után megjelenõ szám azoknak a biteknek a számát adja meg, amire a ppp támaszkodik. A környezetünknek jobban megfelelõ IP-címeket is megadhatunk, de a fenti példa minden esetben mûködni fog.</p><div class=paragraph><p>Az utolsó paraméterrel (<code>0.0.0.0</code>) azt mondjuk a PPP-nek, hogy az egyeztetést ne a <code>10.0.0.1</code>, hanem a <code>0.0.0.0</code> címmel kezdje meg, amire egyes szolgáltatók esetén szükségünk is lesz. A <code>set ifaddr</code> elsõ paramétereként azonban soha ne adjuk meg a <code>0.0.0.0</code> címet, mivel ezzel a PPP <code>-auto</code> módban nem tudja beállítani a kezdeti útvonalat.</p></div></dd></dl></div><div class=paragraph><p>Ha nem <code>-auto</code> módban indítjuk, akkor az <span class=filename>/etc/ppp/ppp.linkup</span> állományban meg kell adnunk még egy bejegyzést is. A <span class=filename>ppp.linkup</span> állományt a kapcsolat létrejötte után dolgozzuk fel. Itt már a <code>ppp</code> megkapta a felülethez tartozó címeket, így az útválasztási táblázatba fel tudjuk venni hozzájuk a megfelelõ bejegyzéseket:</p></div><div class="literalblock programlisting"><div class=content><pre>1     szolgaltato:
2      add default HISADDR</pre></div></div><div class=dlist><dl><dt class=hdlist1>1- sor</dt><dd><p>A kapcsolat felépítése során a <code>ppp</code> a <span class=filename>ppp.linkup</span> állományban a következõ szabályok szerint fogja keresni a bejegyzéseket: elõször a <span class=filename>ppp.conf</span> állományban megadott címkét próbálja megtalálni. Ha ez nem sikerül, akkor az átjárónknak megfelelõ bejegyzést kezdi el keresni. Ez egy négy byte-ból álló, felírásában az IP-címekhez hasonlító címke. Ha még ez a címke sem található, akkor a <code>MYADDR</code> bejegyzést keresi.</p></dd><dt class=hdlist1>2- sor</dt><dd><p>Ez a sor mondja meg a <code>ppp</code> programnak, hogy vegyen fel egy <code>HISADDR</code> címre vonatkozó alapértelmezett útvonalat. A <code>HISADDR</code> címet az IPCP által egyeztetett átjáró IP-címére cseréljük ki.</p></dd></dl></div><div class=paragraph><p>Ha erre a részletesebb példát akarunk látni, akkor a <span class=filename>/usr/shared/examples/ppp/ppp.conf.sample</span> és <span class=filename>/usr/shared/examples/ppp/ppp.linkup.sample</span> állományokban a <code>pmdemand</code> bejegyzést nézzük meg.</p></div></div><div class=sect5><h6 id=_a_bejövõ_hívások_fogadása>27.2.1.2.3. A bejövõ hívások fogadása<a class=anchor href=#_a_bejövõ_hívások_fogadása></a></h6><div class=paragraph><p>Amikor egy helyi hálózathoz csatlakozó gépen akarjuk a ppp programot beállítani a bejövõ hívások fogadására, akkor azt is el kell döntenünk, hogy engedélyezzük-e a csomagok továbbküldését a belsõ hálózat felé. Amennyiben igen, akkor a becsatlakozó gépenek a belsõ hálózatunkon ki kell osztani egy külön címet és az <span class=filename>/etc/ppp/ppp.conf</span> állományban, és meg kell adnunk az <code>enable proxy</code> parancsot. Emellett még az <span class=filename>/etc/rc.conf</span> állományban se feleljtsük el megadni a következõ sort:</p></div><div class="literalblock programlisting"><div class=content><pre>gateway_enable=&#34;YES&#34;</pre></div></div></div><div class=sect5><h6 id=_melyik_getty>27.2.1.2.4. Melyik getty?<a class=anchor href=#_melyik_getty></a></h6><div class=paragraph><p><a href=#dialup>A FreeBSD beállítása betárcsázós kapcsolatokhoz</a> nagyon jól bemutatja a betárcsázós szolgáltatások beállítását a <a href="https://man.freebsd.org/cgi/man.cgi?query=getty&amp;sektion=8&amp;format=html">getty(8)</a> segítségével.</p></div><div class=paragraph><p>A <code>getty</code> helyett egyébként az <a href=http://mgetty.greenie.net/>mgetty</a>, a <code>getty</code> egy ügyesebb változata is használható (a <a class=package href=https://cgit.freebsd.org/ports/tree/comms/mgetty+sendfax/>comms/mgetty+sendfax</a> portból), amely kifejezetten a betárcsázós vonalakhoz készült.</p></div><div class=paragraph><p>A <code>mgetty</code> használatának többek közt az egyik elõnye, hogy <em>aktívan tartja a kapcsolatot</em> a modemekkel, tehát hogy ha az <span class=filename>/etc/ttys</span> állományban letiltjuk a modemet, akkor nem is fog válaszolni a hívásokra.</p></div><div class=paragraph><p>Emellett az <code>mgetty</code> késõbbi változatai (a 0.99 beta változatától kezdve) még a PPP folyamok automatikus észlelését is támogatják, ezáltal a kliensek szkriptek nélkül is képesek elérni a szerverünket.</p></div><div class=paragraph><p>Ha errõl többet akarunk megtudni, akkor az <code>mgetty</code> paranccsal kapcsolatban olvassuk el <a href=#userppp-mgetty>Az mgetty és az AutoPPP</a> címû szakaszt.</p></div></div><div class=sect5><h6 id=_a_ppp_engedélyei>27.2.1.2.5. A PPP engedélyei<a class=anchor href=#_a_ppp_engedélyei></a></h6><div class=paragraph><p>A <code>ppp</code> parancsot általában <code>root</code> felhasználóként kell futtatni. Ha viszont a <code>ppp</code> parancsot tetszõleges felhasználóval akarjuk szerver módban futtatni az iméntiek szerint, akkor ahhoz fel kell vennünk az <span class=filename>/etc/group</span> állományban szereplõ <code>network</code> csoportba.</p></div><div class=paragraph><p>Ezeken kívül még az <code>allow</code> paranccsal is engedélyeznünk kell konfigurációs állomány egy vagy több részének elérését is:</p></div><div class="literalblock programlisting"><div class=content><pre>allow users fred mary</pre></div></div><div class=paragraph><p>Ha ezt a parancsot a <code>default</code> bejegyzésnél adjuk meg, akkor az így megadott felhasználók mindenhez hozzá tudnak férni.</p></div></div><div class=sect5><h6 id=_ppp_shellek_a_dinamikus_ip_címek_használóinak>27.2.1.2.6. PPP shellek a dinamikus IP-címek használóinak<a class=anchor href=#_ppp_shellek_a_dinamikus_ip_címek_használóinak></a></h6><div class=paragraph><p>Hozzunk létre egy <span class=filename>/etc/ppp/ppp-shell</span> nevû állományt, amelyben a következõk szerepelnek:</p></div><div class="literalblock programlisting"><div class=content><pre>#!/bin/sh
IDENT=`echo $0 | sed -e &#39;s/^.*-\(.*\)$/\1/&#39;`
CALLEDAS=&#34;$IDENT&#34;
TTY=`tty`

if [ x$IDENT = xdialup ]; then
        IDENT=`basename $TTY`
fi

echo &#34;PPP for $CALLEDAS on $TTY&#34;
echo &#34;Starting PPP for $IDENT&#34;

exec /usr/sbin/ppp -direct $IDENT</pre></div></div><div class=paragraph><p>Ez a szkript legyen végrehajtható. Ezután az alábbi paranccsal <span class=filename>ppp-dialup</span> néven készítsünk egy szimbolikus linket erre a szkriptre:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># ln -s ppp-shell /etc/ppp/ppp-dialup</span></code></pre></div></div><div class=paragraph><p>Ez a szkript lesz az összes betárcsázó felhasználónk <em>shellje</em>. A most következõ példa az <span class=filename>/etc/passwd</span> állományban szereplõ, <code>pchilds</code> nevû PPP felhasználó bejegyzését mutatja be (ne felejtsük el, hogy soha ne közvetlenül szerkesszük a jelszavakat tároló állományt, hanem a <a href="https://man.freebsd.org/cgi/man.cgi?query=vipw&amp;sektion=8&amp;format=html">vipw(8)</a> segítségével).</p></div><div class="literalblock programlisting"><div class=content><pre>pchilds:*:1011:300:Peter Childs PPP:/home/ppp:/etc/ppp/ppp-dialup</pre></div></div><div class=paragraph><p>Hozzunk létre egy <span class=filename>/home/ppp</span> nevû könyvtárat a következõ bárki által olvasható 0 byte-os állományokkal:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=nt>-r--r--r--</span>   1 root     wheel           0 May 27 02:23 .hushlogin
<span class=nt>-r--r--r--</span>   1 root     wheel           0 May 27 02:22 .rhosts</code></pre></div></div><div class=paragraph><p>Ezek hatására az <span class=filename>/etc/motd</span> állomány tartalma nem jelenik meg.</p></div></div><div class=sect5><h6 id=_ppp_shellek_a_statikus_ip_címek_használóinak>27.2.1.2.7. PPP shellek a statikus IP-címek használóinak<a class=anchor href=#_ppp_shellek_a_statikus_ip_címek_használóinak></a></h6><div class=paragraph><p>Az iméntiekhez hasonló módon készítsük el a <span class=filename>ppp-shell</span> állományt, és mindegyik statikus IP-vel rendelkezõ hozzáféréshez csináljunk egy szimbolikus linket a <span class=filename>ppp-shell</span> szkriptre.</p></div><div class=paragraph><p>Például, ha három betárcsázós ügyfelünk van, <code>fred</code>, <code>sam</code> és <code>mary</code>, feléjük 24 bites CIDR hálózatokat közvetítünk, akkor a következõket kell begépelnünk:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># ln -s /etc/ppp/ppp-shell /etc/ppp/ppp-fred</span>
<span class=c># ln -s /etc/ppp/ppp-shell /etc/ppp/ppp-sam</span>
<span class=c># ln -s /etc/ppp/ppp-shell /etc/ppp/ppp-mary</span></code></pre></div></div><div class=paragraph><p>A fentebb szereplõ betárcsázós felhasználók eléréseihez tartozó shelleket állítsuk be az itt létrehozott szimbolikus linkekre (így tehát <code>mary</code> shellje az <span class=filename>/etc/ppp/ppp-mary</span> lesz).</p></div></div><div class=sect5><h6 id=_a_ppp_conf_beállítása_a_dinamikus_ip_címek_használóinak>27.2.1.2.8. A <span class=filename>ppp.conf</span> beállítása a dinamikus IP-címek használóinak<a class=anchor href=#_a_ppp_conf_beállítása_a_dinamikus_ip_címek_használóinak></a></h6><div class=paragraph><p>Az <span class=filename>/etc/ppp/ppp.conf</span> állományban a következõ sorok valamelyikének kellene szerepelnie:</p></div><div class="literalblock programlisting"><div class=content><pre>default:
  set debug phase lcp chat
  set timeout 0

ttyu0:
  set ifaddr 203.14.100.1 203.14.100.20 255.255.255.255
  enable proxy

ttyu1:
  set ifaddr 203.14.100.1 203.14.100.21 255.255.255.255
  enable proxy</pre></div></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>A bentebb kezdett sorokat mi is kezdjünk bentebb.</p></div></td></tr></tbody></table></div><div class=paragraph><p>A <code>default:</code> szakasz minden kapcsolat esetén betöltõdik. Az <span class=filename>/etc/ttys</span> állományban engedélyezett mindegyik betárcsázós vonal létrehoz a fenti <code>ttyu0:</code> szakaszhoz hasonló bejegyzést. Minden vonal kap egy egyedi IP-címet a dinamikus felhasználók számára szánt címtartományból.</p></div></div><div class=sect5><h6 id=_a_ppp_conf_beállítása_a_statikus_ip_vel_rendelkezõk_számára>27.2.1.2.9. A <span class=filename>ppp.conf</span> beállítása a statikus IP-vel rendelkezõk számára<a class=anchor href=#_a_ppp_conf_beállítása_a_statikus_ip_vel_rendelkezõk_számára></a></h6><div class=paragraph><p>A <span class=filename>/usr/shared/examples/ppp/ppp.conf</span> állományban szereplõ tartalom mellett az összes statikus kiosztású IP-címmel rendelkezõ betárcsázó felhasználóhoz még hozzá kell tennünk egy szakaszt. A példánkban ezek továbbra is <code>fred</code>, <code>sam</code> és <code>mary</code>.</p></div><div class="literalblock programlisting"><div class=content><pre>fred:
  set ifaddr 203.14.100.1 203.14.101.1 255.255.255.255

sam:
  set ifaddr 203.14.100.1 203.14.102.1 255.255.255.255

mary:
  set ifaddr 203.14.100.1 203.14.103.1 255.255.255.255</pre></div></div><div class=paragraph><p>Amennyiben szükséges, az <span class=filename>/etc/ppp/ppp.linkup</span> tartalmazhat további útválasztási információkat is az egyes statikus IP-címmel rendelkezõ felhasználókhoz. A lentebb bemutatott sor a kliens ppp összekötettésén keresztül vesz fel egy útvonalat a <code>203.14.101.0/24</code> hálózat felé.</p></div><div class="literalblock programlisting"><div class=content><pre>fred:
  add 203.14.101.0 netmask 255.255.255.0 HISADDR

sam:
  add 203.14.102.0 netmask 255.255.255.0 HISADDR

mary:
  add 203.14.103.0 netmask 255.255.255.0 HISADDR</pre></div></div></div><div class=sect5><h6 id=userppp-mgetty>27.2.1.2.10. Az <code>mgetty</code> és az AutoPPP<a class=anchor href=#userppp-mgetty></a></h6><div class=paragraph><p>Az <a class=package href=https://cgit.freebsd.org/ports/tree/comms/mgetty+sendfax/>comms/mgetty+sendfax</a> port alapértelmezés szerint az <code>AUTO_PPP</code> beállítással érkezik, amely lehetõvé teszi, hogy az <code>mgetty</code> képessé legyen a PPP kapcsolatok LCP fázisát észlelni és magától létrehozni hozzá egy ppp shellt. Mivel az alapértelmezett név/jelszó páros azonban ilyenkor nem jelenik meg, a felhasználókat a PAP vagy a CHAP protokollon keresztül lehet hitelesíteni.</p></div><div class=paragraph><p>Ez a szakasz most feltételezi, hogy a sikeresen beállítottuk, lefordítottuk és telepítettük az <a class=package href=https://cgit.freebsd.org/ports/tree/comms/mgetty+sendfax/>comms/mgetty+sendfax</a> portot.</p></div><div class=paragraph><p>Az <span class=filename>/usr/local/etc/mgetty+sendfax/login.config</span> állományban ne felejtsük ellenõrizni, hogy szerepel a következõ:</p></div><div class="literalblock programlisting"><div class=content><pre>/AutoPPP/ -     -		      /etc/ppp/ppp-pap-dialup</pre></div></div><div class=paragraph><p>Ezzel utasítjuk az <code>mgetty</code> programot arra, hogy az észlelt PPP kapcsolatokhoz futtassa le a <span class=filename>ppp-pap-dialup</span> szkriptet.</p></div><div class=paragraph><p>Hozzunk létre az <span class=filename>/etc/ppp/ppp-pap-dialup</span> nevû állományt, amelyben majd a következõk fognak szerepelni (az állomány legyen végrehajtható):</p></div><div class="literalblock programlisting"><div class=content><pre>#!/bin/sh
exec /usr/sbin/ppp -direct pap$IDENT</pre></div></div><div class=paragraph><p>Az <span class=filename>/etc/ttys</span> állományban engedélyezett összes betárcsázós vonalhoz készítsük el a megfelelõ bejegyzést az <span class=filename>/etc/ppp/ppp.conf</span> állományban. Ezek remekül meg fognak férni az imént készített definíciókkal.</p></div><div class="literalblock programlisting"><div class=content><pre>pap:
  enable pap
  set ifaddr 203.14.100.1 203.14.100.20-203.14.100.40
  enable proxy</pre></div></div><div class=paragraph><p>Minden olyan felhasználónak, aki ezzel a módszerrel jelentkezik be, szüksége lesz egy név/jelszó kombinációra az <span class=filename>/etc/ppp/ppp.secret</span> állományban, vagy az alábbi beállítás megadásával választhatjuk azt is, hogy a felhasználókat az <span class=filename>/etc/passwd</span> állományon keresztül a PAP protokoll segítségével azonosítjuk.</p></div><div class="literalblock programlisting"><div class=content><pre>enable passwdauth</pre></div></div><div class=paragraph><p>Ha statikus IP-címet akarunk kiosztani némely felhasználóknak, akkor az <span class=filename>/etc/ppp/ppp.secret</span> állományban ezt megadhatjuk a harmadik paraméternek. Errõl bõvebben a <span class=filename>/usr/shared/examples/ppp/ppp.secret.sample</span> állományban láthatunk példát.</p></div></div><div class=sect5><h6 id=_a_microsoft_kiterjesztései>27.2.1.2.11. A Microsoft kiterjesztései<a class=anchor href=#_a_microsoft_kiterjesztései></a></h6><div class=paragraph><p>A PPP úgy is beállítható, hogy kérésre DNS és NetBIOS típusú névfeloldáshoz is szolgáltasson információkat.</p></div><div class=paragraph><p>A PPP 1.x változatával úgy lehet engedélyezni ezeket a kiterjesztéseket, ha az <span class=filename>/etc/ppp/ppp.conf</span> állomány megfelelõ részeibe felvesszük a következõ sorokat:</p></div><div class="literalblock programlisting"><div class=content><pre>enable msext
set ns 203.14.100.1 203.14.100.2
set nbns 203.14.100.5</pre></div></div><div class=paragraph><p>A PPP második és késõbbi változataiban pedig:</p></div><div class="literalblock programlisting"><div class=content><pre>accept dns
set dns 203.14.100.1 203.14.100.2
set nbns 203.14.100.5</pre></div></div><div class=paragraph><p>Ezzel a kliens megkapja az elsõdleges és másodlagos névszerverek címeit, valamint a NetBIOS névszervert.</p></div><div class=paragraph><p>Ha a második és az azt követõ verziókban a <code>set dns</code> sort elhagyjuk, akkor a PPP az <span class=filename>/etc/resolv.conf</span> állományban található értékeket fogja használni.</p></div></div><div class=sect5><h6 id=userppp-PAPnCHAP>27.2.1.2.12. A PAP és CHAP hitelesítés<a class=anchor href=#userppp-PAPnCHAP></a></h6><div class=paragraph><p>Egyes internet-szolgáltatók úgy állítják be a rendszerüket, hogy a kapcsolat felépítése során a hitelesítés a PAP vagy CHAP mechanizmusok valamelyikével történik. Ilyenkor a szolgáltató nem egy <code>login:</code> sorral fogja bekérni a szükséges adatokat, hanem közvetlenül a PPP kapcsolatot kezdi el használni.</p></div><div class=paragraph><p>A PAP nem olyan biztonságos, mint a CHAP, de itt a biztonság nem is annyira fontos, mivel a jelszavak, amelyeket ugyan a PAP titkosítatlan formában küld tovább, csak egy soros vonalon haladnak át. A rossz indulatú támadók itt nem sok mindent tudnak "lehallgatni".</p></div><div class=paragraph><p>A <a href=#userppp-staticIP>PPP statikus IP-címmel</a> és a <a href=#userppp-dynamicIP>PPP dinamikus IP címmel</a> címû szakaszokhoz képest a következõ módosításokat kell elvégeznünk:</p></div><div class="literalblock programlisting"><div class=content><pre>13      set authname AFelhasználóiNevem
14      set authkey AJelszavam
15      set login</pre></div></div><div class=dlist><dl><dt class=hdlist1>13- sor</dt><dd><p>Ebben a sorban adjuk meg a PAP/CHAP felhasználói nevünket, amelyet <em>AFelhasználóiNevem</em> helyett kell beírni.</p></dd><dt class=hdlist1>14- sor</dt><dd><p>Ebben a sorban adjuk meg a PAP/CHAP jelszavunkat, <em>AJelszavam</em> helyett. Szándénkunk egyértelmûsítése érdekében ezek mellett még egy további sort is érdemes felvennünk, tehát:</p><div class="literalblock programlisting"><div class=content><pre>16      accept PAP</pre></div></div><div class=paragraph><p>vagy</p></div><div class="literalblock programlisting"><div class=content><pre>16      accept CHAP</pre></div></div><div class=paragraph><p>Alapértelmezés szerint a PAP és CHAP is egyaránt elfogadott.</p></div></dd><dt class=hdlist1>15- sor</dt><dd><p>A PAP és CHAP alkalmazásakor általában nem is kell bejelentkeznünk a szolgáltató szerverére. Ezért a "set login" parancsnál használt karakterláncot le is kell tiltanunk.</p></dd></dl></div></div><div class=sect5><h6 id=_a_ppp_beállításainak_megváltoztatása_menet_közben>27.2.1.2.13. A <code>ppp</code> beállításainak megváltoztatása menet közben<a class=anchor href=#_a_ppp_beállításainak_megváltoztatása_menet_közben></a></h6><div class=paragraph><p>A háttérben futó <code>ppp</code> programhoz menet közben is tudunk beszélni, de csak olyankor, amikor az ehhez szükséges portot megadtuk. Ezt úgy tudjuk megtenni, ha beállítások közé felvesszük az alábbit:</p></div><div class="literalblock programlisting"><div class=content><pre>set server /var/run/ppp-tun%d DiagnosticPassword 0177</pre></div></div><div class=paragraph><p>Így a PPP az elõre megadott UNIX® tartománybeli socketen keresztül fogja várni a kapcsolódásunkat, és a konkrét hozzáféréshez jelszót kér. A névben szereplõ <code>%d</code> a használatban levõ <span class=filename>tun</span> eszköz sorszámát jelöli.</p></div><div class=paragraph><p>Miután a csatlakozás beállítódott, a szkriptekben a <a href="https://man.freebsd.org/cgi/man.cgi?query=pppctl&amp;sektion=8&amp;format=html">pppctl(8)</a> program használható a futó program vezérléséhez.</p></div></div></div><div class=sect4><h5 id=userppp-nat>27.2.1.3. A PPP hálózati címfordítási képességének kihasználása<a class=anchor href=#userppp-nat></a></h5><div class=paragraph><p>A PPP képes a rendszermag rásegítése nélkül képes hálózati címfordítást végezni. Ezt a lehetõséget a következõ sor hozzáadásával tudjuk aktiválni az <span class=filename>/etc/ppp/ppp.conf</span> állományban:</p></div><div class="literalblock programlisting"><div class=content><pre>nat enable yes</pre></div></div><div class=paragraph><p>A PPP-be épített hálózati címfordítás a <code>-nat</code> parancssori paraméterrel is bekapcsolható. Az <span class=filename>/etc/rc.conf</span> állományban is található hozzá egy <code>ppp_nat</code> változó, amely alapértelmezés szerint engedélyezett.</p></div><div class=paragraph><p>Amikor használjuk ezt a lehetõséget, az <span class=filename>/etc/ppp/ppp.conf</span> állományban a következõ opciókkal engedélyezhetjük a bejövõ kapcsolatok továbbítását:</p></div><div class="literalblock programlisting"><div class=content><pre>nat port tcp 10.0.0.2:ftp ftp
nat port tcp 10.0.0.2:http http</pre></div></div><div class=paragraph><p>vagy egyáltalán ne bízzunk meg a külvilágban:</p></div><div class="literalblock programlisting"><div class=content><pre>nat deny_incoming yes</pre></div></div></div><div class=sect4><h5 id=userppp-final>27.2.1.4. A rendszer végsõ beállítása<a class=anchor href=#userppp-final></a></h5><div class=paragraph><p>Mostanra ugyan már beállítottuk a <code>ppp</code> programot, azonban még néhány dolgot be kell állítanunk, mielõtt ténylegesen nekilátnánk használni. Ezek mindegyike az <span class=filename>/etc/rc.conf</span> állomány módosítását igényli.</p></div><div class=paragraph><p>Az állományt fentrõl lefelé fogjuk feldolgozni, de elõtte ne felejtsünk el értéket adni a <code>hostname=</code> változónak, például:</p></div><div class="literalblock programlisting"><div class=content><pre>hostname=&#34;ize.minta.com&#34;</pre></div></div><div class=paragraph><p>Amennyiben a szolgáltatónk statikus IP-címet és nevet biztosít számunkra, az lesz a legjobb, ha itt a tõle kapott nevet adjuk meg.</p></div><div class=paragraph><p>Keressük meg a <code>network_interfaces</code> változót. Ha a rendszerünkben kérésre akarjuk tárcsázni a szolgáltatónkat, akkor a <span class=filename>tun0</span> eszközt mindenképpen vegyük fel az értékébe, minden más esetben pedig távolítsuk el.</p></div><div class="literalblock programlisting"><div class=content><pre>network_interfaces=&#34;lo0 tun0&#34;
ifconfig_tun0=</pre></div></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Az <code>ifconfig_tun0</code> változónak üres értéket kell megadnunk, és létre kell hoznunk egy <span class=filename>/etc/start_if.tun0</span> nevû állományt. Ebben a következõ sornak kell szerepelnie:</p></div><div class="literalblock programlisting"><div class=content><pre>ppp -auto arendszerem</pre></div></div><div class=paragraph><p>Ez a szkript a hálózat beállításakor fut le, és a ppp démont automatikus módban indítja el. Ha az adott gép egy helyi hálózat átjárója is egyben, akkor az <code>-alias</code> kapcsolót is érdemes megadnunk mellette. A pontosabb részletek tekintetében olvassuk el a megfelelõ man oldalt.</p></div></td></tr></tbody></table></div><div class=paragraph><p>Az <span class=filename>/etc/rc.conf</span> állományban a <code>NO</code> érték megadásával tiltsuk le az útválasztást végzõ program használatát:</p></div><div class="literalblock programlisting"><div class=content><pre>router_enable=&#34;NO&#34;</pre></div></div><div class=paragraph><p>Fontos, hogy a <code>routed</code> démon ne induljon el, mivel <code>routed</code> hajlamos törölni a <code>ppp</code> által létrehozott alapértelmezett útválasztási bejegyzéseket.</p></div><div class=paragraph><p>Ezenkívül még a <code>sendmail_flags</code> változóról szóló sorból is érdemes kivenni a <code>-q</code> opciót, máskülönben a <code>sendmail</code> minden mûvelet megkezdése elõtt nekiáll felderíteni a hálózatot, és ezzel megindítja a tárcsázást. Próbáljuk meg így átírni az értékét:</p></div><div class="literalblock programlisting"><div class=content><pre>sendmail_flags=&#34;-bd&#34;</pre></div></div><div class=paragraph><p>Ezért cserébe viszont a <code>sendmail</code> programot a ppp kapcsolat létrejöttekor mindig utasítanunk kell, hogy újból ellenõrizze a levelezési sort. Ezt a következõk begépelésével érhetjük el:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># /usr/sbin/sendmail -q</span></code></pre></div></div><div class=paragraph><p>Ugyanezt automatikusan is meg tudjuk tenni a <code>!bg</code> paranccsal a <span class=filename>ppp.linkup</span> állományban:</p></div><div class="literalblock programlisting"><div class=content><pre>1     szolgaltato:
2       delete ALL
3       add 0 0 HISADDR
4       !bg sendmail -bd -q30m</pre></div></div><div class=paragraph><p>Ha nem felelne meg ez a megoldás, akkor egy "dfilter" is beállítható az SMTP forgalom szûrésére. A példák között megtaláljuk ennek pontos minkéntjét.</p></div><div class=paragraph><p>Ezután már csak a gépünk újraindítása maradt hátra. Az újraindítás után már be is gépelhetjük:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># ppp</span></code></pre></div></div><div class=paragraph><p>ahol a <code>dial szolgaltato</code> parancs kiadásával meg tudjuk kezdeni a PPP kapcsolat felépítését, vagy a <code>ppp</code> programot megkérhetjük arra, hogy automatikusan kezdje el, amint van kimenõ forgalom (és nem készítettük el a <span class=filename>start_if.tun0</span> szkriptet). Ekkor gépeljük be ezt:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># ppp -auto szolgaltato</span></code></pre></div></div></div><div class=sect4><h5 id=_összefoglalás_2>27.2.1.5. Összefoglalás<a class=anchor href=#_összefoglalás_2></a></h5><div class=paragraph><p>Gyorsan foglaljuk össze, hogy az ppp beállításához milyen lépések megtétele szükséges az elsõ alkalommal:</p></div><div class=paragraph><p>A kliens oldalán:</p></div><div class="exampleblock procedure"><div class=content><div class="olist arabic"><ol class=arabic><li><p>Gyõzõdjünk meg róla, hogy a <span class=filename>tun</span> eszköz benne van a rendszermagban.</p></li><li><p>Ellenõrizzük, hogy a <span class=filename>tunN</span> eszközhöz tartozó állomány rendelkezésre áll a <span class=filename>/dev</span> könyvtárban.</p></li><li><p>Hozzunk létre egy bejegyzést az <span class=filename>/etc/ppp/ppp.conf</span> állományban. A <span class=filename>pmdemand</span> példából a legtöbb szolgáltató esetében ki tudunk indulni.</p></li><li><p>Ha dinamikus IP-címet kapunk, akkor az <span class=filename>/etc/ppp/ppp.linkup</span> állományba is vegyünk fel egy bejegyzést.</p></li><li><p>Frissítsük az <span class=filename>/etc/rc.conf</span> állományunkat.</p></li><li><p>Ha igény szerint akarunk tárcsázni, akkor hozzunk létre <span class=filename>start_if.tun0</span> néven egy szkriptet.</p></li></ol></div></div></div><div class=paragraph><p>A szerver oldalán:</p></div><div class="exampleblock procedure"><div class=content><div class="olist arabic"><ol class=arabic><li><p>Gondoskodjunk róla, hogy a <span class=filename>tun</span> eszköz támogatása szerepel rendszermagban.</p></li><li><p>Gyõzõdjünk meg róla, hogy a <span class=filename>tunN</span> eszköz megtalálható a <span class=filename>/dev</span> könyvtárban.</p></li><li><p>Az <span class=filename>/etc/passwd</span> állományban (a <a href="https://man.freebsd.org/cgi/man.cgi?query=vipw&amp;sektion=8&amp;format=html">vipw(8)</a> program használatával) hozzunk létre bejegyzéseket.</p></li><li><p>A felhasználók könyvtáraiban hozzunk létre egy olyan profilt, amely <code>ppp -direct direct-server</code> vagy egy ehhez hasonló parancsot futtat le.</p></li><li><p>Az <span class=filename>/etc/ppp/ppp.conf</span> állományban adjuk meg egy bejegyzést. A <span class=filename>direct-server</span> példa ehhez egy remek alapot biztosít.</p></li><li><p>Az <span class=filename>/etc/ppp/ppp.linkup</span> állományban hozzunk létre egy bejegyzést.</p></li><li><p>Frissítsük az <span class=filename>/etc/rc.conf</span> állományunkat.</p></li></ol></div></div></div></div></div></div><div class=sect2><h3 id=ppp>27.3. A rendszerszintû PPP alkalmazása<a class=anchor href=#ppp></a></h3><div class="admonitionblock warning"><table><tbody><tr><td class=icon><i class="fa icon-warning" title=Warning></i></td><td class=content><div class=paragraph><p>Ez a szakasz csak FreeBSD 7.<em>X</em> esetén érvényes.</p></div></td></tr></tbody></table></div><div class=sect3><h4 id=_a_rendszerszintû_ppp_beállítása>27.3.1. A rendszerszintû PPP beállítása<a class=anchor href=#_a_rendszerszintû_ppp_beállítása></a></h4><div class=paragraph><p>Mielõtt a gépünkön nekikezdünk a PPP beállításának, ellenõrizzük, hogy a <code>pppd</code> megtalálható a <span class=filename>/usr/sbin</span> könyvtárban és az <span class=filename>/etc/ppp</span> könyvtár létezik.</p></div><div class=paragraph><p>A <code>pppd</code> két módban képes mûködni:</p></div><div class="olist arabic"><ol class=arabic><li><p>"kliensként" - a gépünket soros vonali vagy modemes PPP kapcsolaton keresztül csatlakoztatjuk a külvilághoz</p></li><li><p>"szerverként" - a számítógépünk egy hálózat része, ahol a többieket a PPP használatával kapcsoljuk össze</p></li></ol></div><div class=paragraph><p>Mind a két esetben egy konfigurációs állomány tartalmát kell összeállítanunk (ez az <span class=filename>/etc/ppp/options</span> vagy a <span class=filename>~/.ppprc</span>, ha a gépünkön több felhasználó is PPP-t akar használni).</p></div><div class=paragraph><p>Egy modemes vagy soros vonali szoftverre is szükségünk lesz (ez többnyire a <a class=package href=https://cgit.freebsd.org/ports/tree/comms/kermit/>comms/kermit</a>), amellyel távoli gépeket tudunk felhívni és feléjük kapcsolatot felépíteni.</p></div></div><div class=sect3><h4 id=_a_pppd_mint_kliens>27.3.2. A <code>pppd</code> mint kliens<a class=anchor href=#_a_pppd_mint_kliens></a></h4><div class=paragraph><p>A most következõ <span class=filename>/etc/ppp/options</span> állománnyal egy Cisco terminál szerverhez tudunk kapcsolódni egy PPP vonalon keresztül.</p></div><div class="literalblock programlisting"><div class=content><pre>crtscts         # a hardveres forgalomirányítás engedélyezése
modem           # modem vezérlõvonal
noipdefault     # a távoli PPP szervernek kell IP-címet adnia
                # ha az IPCP alapú egyeztetés során a távoli gép nem küld
                # nekünk IP-címet, akkor vegyük ki ezt a beállítást
passive         # LCP csomagokat várunk
domain ppp.ize.com      # ide írjuk be a hálózati nevünket

:távoli_ip    # ide kell írni a távoli PPP szerver IP-címét
                # a PPP kapcsolaton keresztül erre fogjuk továbbküldeni a csomagokat
                # ha nem adtuk meg &#34;noipdefault&#34; beállítást, akkor ezt a sort
                # írjuk át helyi_ip:távoli_ip alakúra

defaultroute    # adjuk meg ezt a sort is, ha a PPP szerverünket egyben az
                # alapértelmezett átjárónak is be akarjuk állítani</pre></div></div><div class=paragraph><p>Így kapcsolódunk:</p></div><div class="exampleblock procedure"><div class=content><div class="olist arabic"><ol class=arabic><li><p>Tárcsázzuk a távoli gépet a Kermit (vagy bármilyen más modemes program) elindításával, majd adjuk meg a felhasználói nevünket és jelszavunkat (vagy bármi mást, amivel a távoli gépen engedélyezni tudjuk a PPP használatát).</p></li><li><p>Lépjünk ki a Kermit programból (anélkül, hogy bontanánk a vonalat).</p></li><li><p>Írjuk be a következõket:</p><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># /usr/sbin/pppd /dev/tty01 19200</span></code></pre></div></div><div class=paragraph><p>Ne felejtsük el megadni a megfelelõ sebességet és eszközt.</p></div></li></ol></div></div></div><div class=paragraph><p>A számítógépünk most már PPP-n keresztül csatlakozik. Ha valamilyen okból nem sikerülne felépíteni a kapcsolatot, akkor vegyük fel a <code>debug</code> beállítást is az <span class=filename>/etc/ppp/options</span> állományba, majd a konzolra érkezõ üzenetek segítségével próbáljuk meg felderíteni a probléma okát.</p></div><div class=paragraph><p>Az alábbi <span class=filename>/etc/ppp/pppup</span> szkript mind a három fázist automatikussá teszi:</p></div><div class="literalblock programlisting"><div class=content><pre>#!/bin/sh
pgrep -l pppd
pid=`pgrep pppd`
if [ &#34;X${pid}&#34; != &#34;X&#34; ] ; then
        echo &#39;killing pppd, PID=&#39; ${pid}
        kill ${pid}
fi
pgrep -l kermit
pid=`pgrep kermit`
if [ &#34;X${pid}&#34; != &#34;X&#34; ] ; then
        echo &#39;killing kermit, PID=&#39; ${pid}
        kill -9 ${pid}
fi

ifconfig ppp0 down
ifconfig ppp0 delete

kermit -y /etc/ppp/kermit.dial
pppd /dev/tty01 19200</pre></div></div><div class=paragraph><p>Az <span class=filename>/etc/ppp/kermit.dial</span> egy olyan Kermit szkript, amivel tárcsázni tudunk és a távoli gépen elvégezni az összes szükséges hitelesítést (a leírás végén találhatunk is egy ilyen szkriptet példaként).</p></div><div class=paragraph><p>Az alábbi <span class=filename>/etc/ppp/pppdown</span> szkripttel tudjuk bontani a PPP vonalat:</p></div><div class="literalblock programlisting"><div class=content><pre>#!/bin/sh
pid=`pgrep pppd`
if [ X${pid} != &#34;X&#34; ] ; then
        echo &#39;killing pppd, PID=&#39; ${pid}
        kill -TERM ${pid}
fi

pgrep -l kermit
pid=`pgrep kermit`
if [ &#34;X${pid}&#34; != &#34;X&#34; ] ; then
        echo &#39;killing kermit, PID=&#39; ${pid}
        kill -9 ${pid}
fi

/sbin/ifconfig ppp0 down
/sbin/ifconfig ppp0 delete
kermit -y /etc/ppp/kermit.hup
/etc/ppp/ppptest</pre></div></div><div class=paragraph><p>A <span class=filename>/usr/etc/ppp/ppptest</span> elindításával ellenõrizni tudjuk, hogy a <code>pppd</code> még mindig fut. Ez valahogy így néz ki:</p></div><div class="literalblock programlisting"><div class=content><pre>#!/bin/sh
pid=`pgrep pppd`
if [ X${pid} != &#34;X&#34; ] ; then
        echo &#39;pppd running: PID=&#39; ${pid-NONE}
else
        echo &#39;No pppd running.&#39;
fi
set -x
netstat -n -I ppp0
ifconfig ppp0</pre></div></div><div class=paragraph><p>A vonal bontásához az <span class=filename>/etc/ppp/kermit.hup</span> szkriptet kell elindítanunk, amiben a következõ szerepelnek:</p></div><div class="literalblock programlisting"><div class=content><pre>set line /dev/tty01	; ide írjuk be a saját modemünket
set speed 19200
set file type binary
set file names literal
set win 8
set rec pack 1024
set send pack 1024
set block 3
set term bytesize 8
set command bytesize 8
set flow none

pau 1
out +++
inp 5 OK
out ATH0\13
echo \13
exit</pre></div></div><div class=paragraph><p>A <code>kermit</code> helyett a <code>chat</code> programot is használhatjuk:</p></div><div class=paragraph><p>A következõ két állomány már elég egy kapcsolat létrehozásához <code>pppd</code> használatával:</p></div><div class=paragraph><p><span class=filename>/etc/ppp/options</span>:</p></div><div class="literalblock programlisting"><div class=content><pre>/dev/cuad1 115200

crtscts		# a hardveres forgalomirányítás engedélyezése
modem		# modemes vezérlõvonal
connect &#34;/usr/bin/chat -f /etc/ppp/login.chat.script&#34;
noipdefault	# a távoli PPP kiszolgálónak adnia kell egy IP-címet
	        # ha a távoli gép nem küldi az IP-címünk az IPCP alapú egyeztetés során
                # akkor távolítsuk el ezt a beállítást
passive         # LCP csomagokat várunk
domain sajat.tartomany	# ide írjuk be a saját tartománynevünket

:		# a távoli PPP kiszolgáló IP-címét tegyük ide
	        # ezen keresztül fogjuk továbbküldeni a PPP kapcsolaton áthaladó csomagokat
                # nem adtuk meg a &#34;noipdefault&#34; beállítást, akkor ezt
                # sort írjuk át helyi_ip:távoli_ip alakúra

defaultroute	# ez a sor akkor kell, ha a PPP szerver lesz az
	        # alapértelmezett átjárónk is</pre></div></div><div class=paragraph><p><span class=filename>/etc/ppp/login.chat.script</span>:</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>A most következõt egyetlen sorba kell írnunk.</p></div></td></tr></tbody></table></div><div class="literalblock programlisting"><div class=content><pre>ABORT BUSY ABORT &#39;NO CARRIER&#39; &#34;&#34; AT OK ATDTtelefon.szám
  CONNECT &#34;&#34; TIMEOUT 10 ogin:-\\r-ogin: bejelentkezési-azonosító
  TIMEOUT 5 sword: jelszó</pre></div></div><div class=paragraph><p>Miután ezeket telepítettük és a megfelelõképpen módosítottuk, már csak a <code>pppd</code> parancsot kell kiadnunk, valahogy így:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># pppd</span></code></pre></div></div></div><div class=sect3><h4 id=_a_pppd_mint_szerver>27.3.3. A <code>pppd</code> mint szerver<a class=anchor href=#_a_pppd_mint_szerver></a></h4><div class=paragraph><p>Az <span class=filename>/etc/ppp/options</span> állományban nagyjából a következõknek kell szerepelnie:</p></div><div class="literalblock programlisting"><div class=content><pre>crtscts                         # hardveres forgalomirányítás
netmask 255.255.255.0           # hálózati maszk (nem kötelezõ)
192.114.208.20:192.114.208.165  # a helyi és távoli gépek IP-címei
                                # a helyi IP-nek el kell térnie az Ethernet
                                # (vagy más egyéb) felülethez tartozó címtõl.
                                # a távoli IP a távoli géphez rendelt IP-cím
domain ppp.ize.com              # a saját tartományunk
passive                         # az LCP csomagok várása
modem                           # modemes vonal</pre></div></div><div class=paragraph><p>Az alábbi <span class=filename>/etc/ppp/pppserv</span> szkript a pppd démont szervernek állítja be:</p></div><div class="literalblock programlisting"><div class=content><pre>#!/bin/sh
pgrep -l pppd
pid=`pgrep pppd`
if [ &#34;X${pid}&#34; != &#34;X&#34; ] ; then
        echo &#39;killing pppd, PID=&#39; ${pid}
        kill ${pid}
fi
pgrep -l kermit
pid=`pgrep kermit`
if [ &#34;X${pid}&#34; != &#34;X&#34; ] ; then
        echo &#39;killing kermit, PID=&#39; ${pid}
        kill -9 ${pid}
fi

# reset ppp interface
ifconfig ppp0 down
ifconfig ppp0 delete

# enable autoanswer mode
kermit -y /etc/ppp/kermit.ans

# run ppp
pppd /dev/tty01 19200</pre></div></div><div class=paragraph><p>A szerver leállítására a következõ <span class=filename>/etc/ppp/pppservdown</span> szkriptet kell használnunk:</p></div><div class="literalblock programlisting"><div class=content><pre>#!/bin/sh
pgrep -l pppd
pid=`pgrep pppd`
if [ &#34;X${pid}&#34; != &#34;X&#34; ] ; then
        echo &#39;killing pppd, PID=&#39; ${pid}
        kill ${pid}
fi
pgrep -l kermit
pid=`pgrep kermit`
if [ &#34;X${pid}&#34; != &#34;X&#34; ] ; then
        echo &#39;killing kermit, PID=&#39; ${pid}
        kill -9 ${pid}
fi
ifconfig ppp0 down
ifconfig ppp0 delete

kermit -y /etc/ppp/kermit.noans</pre></div></div><div class=paragraph><p>A következõ Kermit szkript (<span class=filename>/etc/ppp/kermit.ans</span>) engedélyezi vagy tiltja le a modem automatikus válaszadását. Körülbelül így épül fel:</p></div><div class="literalblock programlisting"><div class=content><pre>set line /dev/tty01
set speed 19200
set file type binary
set file names literal
set win 8
set rec pack 1024
set send pack 1024
set block 3
set term bytesize 8
set command bytesize 8
set flow none

pau 1
out +++
inp 5 OK
out ATH0\13
inp 5 OK
echo \13
out ATS0=1\13   ; &#34;ATS0=0\13&#34;-ra írjuk át, ha le akarjuk tiltani az
                ; automatikus válaszadást
inp 5 OK
echo \13
exit</pre></div></div><div class=paragraph><p>Az <span class=filename>/etc/ppp/kermit.dial</span> elnevezésû szkriptet használhatjuk arra, hogy tárcsázzunk távoli gépeket és hitelesítsük magunkat rajtuk. Írjuk át az igényeinknek megfelelõen, tegyük bele a bejelentkezéshez szükséges azonosítót és jelszót, illetve a modemünk és a távoli gép válaszai szerint módosítsuk az <code>input</code> utasításokat.</p></div><div class="literalblock programlisting"><div class=content><pre>;
; írjuk ide azt a com vonalat, amire a modemünk csatlakozik:
;
set line /dev/tty01
;
; ide kerül a modem sebessége:
;
set speed 19200
set file type binary            ; teljes 8 bites állomány-átvitel
set file names literal
set win 8
set rec pack 1024
set send pack 1024
set block 3
set term bytesize 8
set command bytesize 8
set flow none
set modem hayes
set dial hangup off
set carrier auto                ; adjuk meg a SET CARRIER utasítást is, ha kell
set dial display on             ; adjuk meg a SET DIAL utasítást is, ha kell
set input echo on
set input timeout proceed
set input case ignore
def \%x 0                       ; a bejelentkezés számlálója
goto slhup

:slcmd                          ; tegyük a modemet parancs módba
echo Tegyuk a modemet parancs modba.
clear                           ; töröljük a be nem olvasott karaktereket a bemeneti pufferbõl
pause 1
output +++                      ; a Hayes-féle helyettesítési szekvenciák használata
input 1 OK\13\10                ; várjuk meg az OK jelzést
if success goto slhup
output \13
pause 1
output at\13
input 1 OK\13\10
if fail goto slcmd              ; ha a modem nem válaszol OK-val, akkor próbálkozzunk újra

:slhup                          ; bontsuk a vonalat
clear                           ; töröljük ki a be nem olvasott karaktereket a bemeneti pufferbõl
pause 1
echo A vonal bontasa.
output ath0\13                  ; a kapcsolat létrejöttét jelzõ Hayes-parancs
input 2 OK\13\10
if fail goto slcmd              ; ha nincs OK válasz, akkor tegyük a modemet parancs módba

:sldial                         ; tárcsázzuk a számot
pause 1
echo Dialing.
output atdt9,550311\13\10       ; ide írjuk a telefonszámot
assign \%x 0                    ; nullázzuk le az idõzítõt

:look
clear                           ; töröljük az olvasatlan karaktereket a bemeneti pufferbõl
increment \%x                   ; számoljuk a másodperceket
input 1 {CONNECT }
if success goto sllogin
reinput 1 {NO CARRIER\13\10}
if success goto sldial
reinput 1 {NO DIALTONE\13\10}
if success goto slnodial
reinput 1 {\255}
if success goto slhup
reinput 1 {\127}
if success goto slhup
if &lt; \%x 60 goto look
else goto slhup

:sllogin                        ; bejelentkezés
assign \%x 0                    ; nullázzuk le az idõzítõt
pause 1
echo A bejelentkezes keresese.

:slloop
increment \%x                   ; számoljuk a másodperceket
clear                           ; töröljük az olvasatlan karaktereket a bemeneti pufferbõl
output \13
;
; ide írjuk be a várható bejelentkezési sablont:
;
input 1 {Felhasznaloi nev: }
if success goto sluid
reinput 1 {\255}
if success goto slhup
reinput 1 {\127}
if success goto slhup
if &lt; \%x 10 goto slloop      ; tízszer próbálkozzunk a bejelentkezéssel
else goto slhup                 ; 10 sikertelen próbálkozás után bontsuk a vonalat és kezdjük újra

:sluid
;
; ide írjuk be a felhasználói azonosítónkat:
;
output ppp-login\13
input 1 {Jelszo: }
;
; ide tegyük a hozzá tartozó jelszót:
;
output ppp-password\13
input 1 {Atvaltas SLIP modba.}
echo
quit

:slnodial
echo \7Nincs vonal.  Ellenorizzuk a telefonvonalat!\7
exit 1

; local variables:
; mode: csh
; comment-start: &#34;; &#34;
; comment-start-skip: &#34;; &#34;
; end:</pre></div></div></div></div><div class=sect2><h3 id=ppp-troubleshoot>27.4. PPP kapcsolatok hibaelhárítása<a class=anchor href=#ppp-troubleshoot></a></h3><div class="admonitionblock warning"><table><tbody><tr><td class=icon><i class="fa icon-warning" title=Warning></i></td><td class=content><div class=paragraph><p>A FreeBSD 8.0 kiadásától kezdõdõen a <a href="https://man.freebsd.org/cgi/man.cgi?query=sio&amp;sektion=4&amp;format=html">sio(4)</a> meghajtó szerepét a <a href="https://man.freebsd.org/cgi/man.cgi?query=uart&amp;sektion=4&amp;format=html">uart(4)</a> veszi át. Emiatt a soros vonali eszközöket <span class=filename>/dev/cuadN</span> és <span class=filename>/dev/cuauN</span> helyett <span class=filename>/dev/ttydN</span> és <span class=filename>/dev/ttyuN</span> néven lehet elérni. A FreeBSD 7.<em>X</em> változatok felhasználóinak ennek megfelelõen kell olvasniuk ezt a leírást.</p></div></td></tr></tbody></table></div><div class=paragraph><p>Ebben a szakaszban összefoglalunk néhány olyan problémát, ami a PPP modemen keresztüli használata során keletkezhet. Például pontosan tisztában kell lennünk azzal, hogy a tárcsázott rendszer milyen adatokat és hogyan fog tõlünk bekérni. Egyes szolgáltatók egy <code>ssword</code> promptot, míg mások egy <code>password</code> promptot adnak. Ha a <code>ppp</code> szkript nem illeszkedik ezekhez az elvárásokhoz, akkor nem tudunk bejelentkezni. A <code>ppp</code> csatlakozások nyomonkövetésének egyik leggyakoribb módja a manuális kapcsolódás. A következõkben ezért a manuális csatlakozásokra vonatkozó legszükségesebb ismereteket mutatjuk be lépésrõl lépésre.</p></div><div class=sect3><h4 id=_az_eszközleírók_ellenõrzése>27.4.1. Az eszközleírók ellenõrzése<a class=anchor href=#_az_eszközleírók_ellenõrzése></a></h4><div class=paragraph><p>Ha saját rendszermagot használunk, ne felejtsük el felvenni a következõ sort a konfigurációs állományba:</p></div><div class="literalblock programlisting"><div class=content><pre>device   uart</pre></div></div><div class=paragraph><p>A <code>GENERIC</code> rendszermag az <span class=filename>uart</span> eszközt már alapértelmezés szerint tartalmazza, ezért ilyenkor már nincs több teendõnk. Egyszerûen csak a <code>dmesg</code> parancs kimenetében keressük meg a modemes eszközhöz tartozó adatokat:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># dmesg | grep uart</span></code></pre></div></div><div class=paragraph><p>Ennek eredményeképpen kapunk egy rövid összefoglalást a <span class=filename>uart</span> típusú eszközökrõl. Ezek lesznek a számunkra fontos COM portok. Amennyiben a modemünk egy szabványos soros portként mûködik, akkor a <span class=filename>uart1</span> vagy <span class=filename>COM2</span> néven kell keresnünk. Ha megtaláltuk, akkor nem kell új rendszermagot fordítanunk. Amikor a soros vonali modemünk a <span class=filename>uart1</span> vagy <span class=filename>COM2</span> porton csatlakozik DOS-ban, akkor itt a neki megfelelõ eszköz a <span class=filename>/dev/cuau1</span> lesz.</p></div></div><div class=sect3><h4 id=_kapcsolódás_manuálisan>27.4.2. Kapcsolódás manuálisan<a class=anchor href=#_kapcsolódás_manuálisan></a></h4><div class=paragraph><p>A <code>ppp</code> kézi irányításával gyorsan, egyszerûen és minden fájdalomtól mentesen tudunk csatlakozni az internethez, de olyankor is hasznos, ha ki akarjuk deríteni, hogy az internet-szolgáltatónk milyen módon kezeli a kliensek <code>ppp</code> csatlakozásait. Nos, akkor ehhez indítsuk is el a PPP alkalmazást a paranccsorból. Az alábbi példákban rendre a <em>pelda</em> névvel hivatkozunk a PPP-t mûködtetõ gépre. A <code>ppp</code> tehát a <code>ppp</code> parancs begépelésével indítható:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># ppp</span></code></pre></div></div><div class=paragraph><p>Ezzel elindítottuk a <code>ppp</code> programot.</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>ppp ON pelda&gt; <span class=nb>set </span>device /dev/cuau1</code></pre></div></div><div class=paragraph><p>Beállítjuk a modemünket, ami ebben az esetben a <span class=filename>cuau1</span>.</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>ppp ON pelda&gt; <span class=nb>set </span>speed 115200</code></pre></div></div><div class=paragraph><p>Beállítjuk a csatlakozás sebességét, ami ebben az esetben 115 200 kbit/mp.</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>ppp ON pelda&gt; <span class=nb>enable </span>dns</code></pre></div></div><div class=paragraph><p>Azt mondjuk a <code>ppp</code> programnak, hogy állítsa be a névfeloldót és az <span class=filename>/etc/resolv.conf</span> állományt egészítse ki a megfelelõ névszerverekkel. Ha a <code>ppp</code> nem képes megállapítani a gépünk nevét, akkor késõbb ezt még kézzel is be tudjuk állítani.</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>ppp ON pelda&gt; term</code></pre></div></div><div class=paragraph><p>Váltsunk "terminál" módba, így mi irányítjuk a modemet.</p></div><div class="literalblock programlisting"><div class=content><pre>deflink: Entering terminal mode on /dev/cuau1
type &#39;~h&#39; for help</pre></div></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>at
OK
atdt123456789</code></pre></div></div><div class=paragraph><p>Az <code>at</code> paranccsal hozzuk alaphelyzetbe a modemet, majd a <code>atdt</code> paranccsal és egy telefonszám megadásával megkezdjük a szolgáltató tárcsázását.</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>CONNECT</code></pre></div></div><div class=paragraph><p>Ezzel jelez vissza a kapcsolódás megkezdésérõl. Ha itt bármilyen hardvertõl független csatlakozási probléma merülne fel, akkor ezen a ponton tudunk ellene tenni valamit.</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>ISP Login:felhasznalonev</code></pre></div></div><div class=paragraph><p>Itt kell megadnunk a felhasználói nevünket, ami megegyezik a szolgáltató által adott azonosítónkkal.</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>ISP Pass:jelszo</code></pre></div></div><div class=paragraph><p>Ezúttal a jelszavunkat kell megadni, amit szintén a szolgáltató bocsátott rendelkezésünkre az azonosító mellett. Akárcsak amikor bejelentkezünk a FreeBSD-be, itt sem fog látszódni a jelszavunk.</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>Shell or PPP:ppp</code></pre></div></div><div class=paragraph><p>Szolgáltatótól függõen elõfordulhat, hogy ez a sor soha nem is jelenik meg. Itt kérdezik meg, hogy a szolgáltatónál egy shellt akarunk használni, vagy csak elindítani egy <code>ppp</code> kapcsolatot. Ebben a példában természetesen a <code>ppp</code> opciót választjuk, mivel egy internet-elõfizetés birtokosai vagyunk.</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>Ppp ON pelda&gt;</code></pre></div></div><div class=paragraph><p>Figyeljük meg, hogy az elsõ <code>p</code> nagybetûssé vált. Ezzel jelzi a program, hogy sikeresen csatlakoztunk a szolgáltatónkhoz.</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>PPp ON pelda&gt;</code></pre></div></div><div class=paragraph><p>Sikeresen azonosítottuk magunkat a szolgáltató felé és várjuk az IP-címünket.</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>PPP ON pelda&gt;</code></pre></div></div><div class=paragraph><p>Megkaptuk az IP-címünket és ezzel sikeresen felépült a kapcsolat.</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>PPP ON pelda&gt;add default HISADDR</code></pre></div></div><div class=paragraph><p>Itt adjuk hozzá az alapértelmezett útvonalat, amire mindenképpen szükségünk van ahhoz, hogy a külvilággal is kapcsolatban tudjunk lépni, mivel jelenleg csak a vonal másik végén lévõ gépet érjük el. Ha ezt bizonyos, már meglevõ útvonalak miatt nem sikerül felvenni, akkor az <code>add</code> elé tegyünk egy <code>!</code> jelet. Ezt viszont a kapcsolat felépítése elõtt is megtehetjük, így menet közben az új útvonalat felveszi a többi közé.</p></div><div class=paragraph><p>Ha eddig minden remekül ment, akkor ezen ponton már egy élõ internet-kapcsolattal rendelkezünk, és a programot a <span class=keyseq><kbd>CTRL</kbd>+<kbd>z</kbd></span> lenyomásával a háttérbe is tehetjük. Ha a <code>PPP</code> felirat ismét a <code>ppp</code> feliratra váltana, akkor az arra utal, hogy elvesztettük a kapcsolatot. Erre nem árt figyelni, mivel ezzel jelzi az aktuális kapcsolat állapotát. A nagybetûs P-k jelölik, hogy az adott szinten megvan a kapcsolat a szolgáltató felé, a kisbetûs p-k pedig arra utalnak, hogy azon a szinten a kapcsolat valamiért megszûnt. A <code>ppp</code> csak ezt a két állapotot ismeri.</p></div><div class=sect4><h5 id=_nyomkövetés>27.4.2.1. Nyomkövetés<a class=anchor href=#_nyomkövetés></a></h5><div class=paragraph><p>Ha közvetlen vonalunk van és mégsem sikerül kapcsolatot létesíteni, akkor tiltsuk le a hardveres CTS/RTS forgalomirányítást a <code>set ctsrts off</code> paranccsal. Ez leginkább akkor fordul elõ, ha csatlakoztunk egy olyan terminálszerverhez, amely valamennyire képes kezelni a PPP kapcsolatokat, de a PPP megáll, mikor adatot próbál írni a kommunikációs csatornára, mivel arra a CTS (Clear To Send - "lehet küldeni") jelzésre vár, amely soha nem fog megérkezni. Ha mégis ezt a beállítást akarjuk használni, akkor a <code>set accmap</code> beállításra is szükségünk lesz, mivel ez kell bizonyos karakterek hardverfüggõ átküldésének felülbírálásához, legtöbb esetben a XON/XOFF miatt. A <a href="https://man.freebsd.org/cgi/man.cgi?query=ppp&amp;sektion=8&amp;format=html">ppp(8)</a> man oldalon találhatunk errõl és ennek használatáról részletesebb leírást.</p></div><div class=paragraph><p>Ha egy régebbi gyártmányú modemünk van, akkor a <code>set parity even</code> beállítás alkalmazása is javasolt. Alapértelmezés szerint ugyanis nincs paritás, de a régebbi modemek és (a forgalom növekedésével) egyes szolgáltatók még használják hibaellenõrzésre. Ha Compuserve elõfizetésünk van, mindenképpen kapcsoljuk be.</p></div><div class=paragraph><p>Amikor a PPP nem tér vissza parancs módba, akkor gyaníthatóan az egyeztetésben lesz valahol probléma, mivel a szolgáltató a kliensüktõl várja a kezdeményezését. Ezen a ponton a <code>~p</code> paranccsal utasíthatjuk a ppp programot a konfigurációs információk átküldésének megkezdésére.</p></div><div class=paragraph><p>Ha egyáltalán nem kapunk promptot a bejelentkezéshez, akkor nagy a alószínûsége, hogy az iménti UNIX® stílusú hitelesítés helyett PAP vagy CHAP protokollt kell használnunk. A PAP vagy CHAP használatához mindössze a következõ beállításokat kell megadnunk PPP programnak a terminál mód aktiválása elõtt:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>ppp ON pelda&gt;set authname felhasznalonev</code></pre></div></div><div class=paragraph><p>ahol a <em>felhasznalonev</em> helyett a szolgáltatótól kapott azonosítót kell beírnunk.</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>ppp ON pelda&gt;set authkey jelszo</code></pre></div></div><div class=paragraph><p>ahol a <em>jelszo</em> helyett a szolgáltatótól kapott jelszót kell megadnunk.</p></div><div class=paragraph><p>Ha sikeresen csatlakoztunk, de még nem találunk semmilyen tartománynevet, akkor a <a href="https://man.freebsd.org/cgi/man.cgi?query=ping&amp;sektion=8&amp;format=html">ping(8)</a> és IP-cím segítségével tudjuk megvizsgálni, hogy mûködõképes-e a kapcsolat. Ha 100 százalékos (100%) csomagvesztést (packet loss) tapasztalunk, akkor szinte biztos, hogy nincs meg az alapértelmezett útvonal. Nézzük meg újra, hogy az <code>add default HISADDR</code> beállítást megadtuk-e a kapcsolat felépítésekor. Ha viszont már el tudunk érni egy távoli IP-címet, akkor nagyon valószínû, hogy az <span class=filename>/etc/resolv.conf</span> állományba nem került bele a megfelelõ névfeloldó címe. Az említett állománynak valahogy így kellene kinéznie:</p></div><div class="literalblock programlisting"><div class=content><pre>domain minta.com
nameserver x.x.x.x
nameserver y.y.y.y</pre></div></div><div class=paragraph><p>Ahol az <em>x.x.x.x</em> és <em>y.y.y.y</em> címeket a szolgáltatónk névszervereinek címével kell behelyettesíteni. Ez nem minden esetben található meg az elõfizetõi szerzõdésben, de ha felhívjuk a szolgáltatónkat, akkor minden bizonnyal elárulják ezeket a címeket.</p></div><div class=paragraph><p>A <a href="https://man.freebsd.org/cgi/man.cgi?query=syslog&amp;sektion=3&amp;format=html">syslog(3)</a> is alkalmas a PPP kapcsolatok naplózására. Ehhez csupán ennyit kell megadnunk az <span class=filename>/etc/syslog.conf</span> állományban:</p></div><div class="literalblock programlisting"><div class=content><pre>!ppp
*.*     /var/log/ppp.log</pre></div></div><div class=paragraph><p>A legtöbb esetben ez a lehetõség már eleve adott.</p></div></div></div></div><div class=sect2><h3 id=pppoe>27.5. A PPP használata Ethernet felett (PPPoE)<a class=anchor href=#pppoe></a></h3><div class=paragraph><p>Ebben a szakaszban azt ismertetjük, hogyan állítsuk be a PPP-t Ethernet felett (PPP over Ethernet, PPPoE).</p></div><div class=sect3><h4 id=_a_rendszermag_beállítása_3>27.5.1. A rendszermag beállítása<a class=anchor href=#_a_rendszermag_beállítása_3></a></h4><div class=paragraph><p>A PPPoE mûködéséhez most már semmilyen módosításra nincs szükség a rendszermag beállításaiban. Amennyiben a hozzá szükséges Netgraph támogatás nem található a rendszermagban, akkor azt a ppp önmûködõen betölti.</p></div></div><div class=sect3><h4 id=_a_ppp_conf_beállítása>27.5.2. A <span class=filename>ppp.conf</span> beállítása<a class=anchor href=#_a_ppp_conf_beállítása></a></h4><div class=paragraph><p>Íme egy mûködõ <span class=filename>ppp.conf</span> állomány:</p></div><div class="literalblock programlisting"><div class=content><pre>default:
  set log Phase tun command # itt akár egy részletesebb naplózást is be tudunk állítani
  set ifaddr 10.0.0.1/0 10.0.0.2/0

a_szolgaltato_neve:
  set device PPPoE:xl1 # az xl1 helyére írjuk be a saját Ethernet eszközünket
  set authname FELHASZNALONEV
  set authkey JELSZO
  set dial
  set login
  add default HISADDR</pre></div></div></div><div class=sect3><h4 id=_a_ppp_futtatása>27.5.3. A ppp futtatása<a class=anchor href=#_a_ppp_futtatása></a></h4><div class=paragraph><p><code>root</code> felhasználóként adjuk ki az alábbi parancsot:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># ppp -ddial a_szolgaltato_neve</span></code></pre></div></div></div><div class=sect3><h4 id=_a_ppp_indítása_a_rendszerindítás_során>27.5.4. A ppp indítása a rendszerindítás során<a class=anchor href=#_a_ppp_indítása_a_rendszerindítás_során></a></h4><div class=paragraph><p>Az <span class=filename>/etc/rc.conf</span> állományba vegyük fel a következõket:</p></div><div class="literalblock programlisting"><div class=content><pre>ppp_enable=&#34;YES&#34;
ppp_mode=&#34;ddial&#34;
ppp_nat=&#34;YES&#34;	# csak akkor, ha címfordítás kell a helyi hálózaton, máskülönben &#34;NO&#34;
ppp_profile=&#34;a_szolgaltato_neve&#34;</pre></div></div></div><div class=sect3><h4 id=_a_szolgáltatási_címkék_használata>27.5.5. A szolgáltatási címkék használata<a class=anchor href=#_a_szolgáltatási_címkék_használata></a></h4><div class=paragraph><p>Bizonyos esetekben szolgáltatási címkét (service tag) is használnunk kell a kapcsolat létrehozásához. A szolgáltatási címkék segítségével tudjuk megkülönböztetni az adott hálózaton elérhetõ különbözõ PPPoE szervereket.</p></div><div class=paragraph><p>A szolgáltatótól kapott dokumentációban szerepelnie kell minden ehhez kapcsolódó információnak. Amennyiben nem találjuk, érdeklõdjünk a szolgáltatónál.</p></div><div class=paragraph><p>Utolsó reményként megpróbálhatjuk a <a href=./#ports>Portgyûjteményben</a> található <a href=http://www.roaringpenguin.com/pppoe/>Roaring Penguin PPPoE</a> nevû program által javasolt módszert. Ennél vegyük azonban számításba, hogy félre tudja programozni a modemünket, amitõl akár használhatatlanná is válhat, ezért kétszer is gondoljuk meg, mielõtt használni kezdjük. Egyszerûen csak tegyük fel a szolgáltatótól a modemünk mellé kapott szoftvert. Ezután lépjünk be a program <b class=menuref>System</b> menüjébe. Itt kell lennie a megfelelõ profilnak, ami általában az <em>ISP</em>.</p></div><div class=paragraph><p>A profil neve (a szolgáltatás címkéje) a <span class=filename>ppp.conf</span> állományban a PPPoE bejegyzés részeként jelenik meg a <code>set device</code> parancsban (ennek pontos részleteit lásd a <a href="https://man.freebsd.org/cgi/man.cgi?query=ppp&amp;sektion=8&amp;format=html">ppp(8)</a> man oldalon). Tehát nagyjából így néz ki:</p></div><div class="literalblock programlisting"><div class=content><pre>set device PPPoE:xl1:ISP</pre></div></div><div class=paragraph><p>Az <em>xl1</em> eszköz nevét ne felejtsük el a megfelelõ Ethernet kártyához tartozó eszköz nevére kicserélni.</p></div><div class=paragraph><p>Az <em>ISP</em> helyett pedig írjuk be az imént kiderített profil nevét.</p></div><div class=paragraph><p>A témával kapcsolatban az alábbi helyeken találhatunk további információkat:</p></div><div class=ulist><ul><li><p><a href=http://renaud.waldura.com/doc/freebsd/pppoe/>Cheaper Broadband with FreeBSD on DSL</a>, írta: Renaud Waldura (angolul).</p></li><li><p><a href=http://www.ruhr.de/home/nathan/FreeBSD/tdsl-freebsd.html>Nutzung von T-DSL und T-Online mit FreeBSD</a>, írta: Udo Erdelhoff (németül).</p></li></ul></div></div><div class=sect3><h4 id=ppp-3com>27.5.6. PPPoE és a 3Com® HomeConnect™ ADSL Modem Dual Link<a class=anchor href=#ppp-3com></a></h4><div class=paragraph><p>Ez a modem nem felel meg az <a href=http://www.faqs.org/rfcs/rfc2516.html>RFC 2516</a> elõírásainak (<em>A Method for transmitting PPP over Ethernet (PPPoE)</em>, írta: L. Mamakos, K. Lidl, J. Evarts, D. Carrel, D. Simone és R. Wheeler). Helyette az Ethernet keretekben eltérõ csomagtípus kódokat használ. A <a href=http://www.3com.com/>3Com-nál</a> panaszkodjunk, ha szerintünk is be kellene tartaniuk a PPPoE specifikációját.</p></div><div class=paragraph><p>A FreeBSD is csak akkor lesz képes együttmûködni ezzel az eszközzel, ha beállítjuk a megfelelõ sysctl változót. Ezt a rendszerindítás során automatikusan meg tudjuk tenni az <span class=filename>/etc/sysctl.conf</span> módosításával:</p></div><div class="literalblock programlisting"><div class=content><pre>net.graph.nonstandard_pppoe=1</pre></div></div><div class=paragraph><p>vagy közvetlenül az alábbi paranccsal:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># sysctl net.graph.nonstandard_pppoe=1</span></code></pre></div></div><div class=paragraph><p>Sajnos, mivel ez egy rendszerszintû beállítás, ezért a 3Com® HomeConnect™ ADSL Modem és más normális PPPoE kliens vagy szerver egyszerre nem használható.</p></div></div></div><div class=sect2><h3 id=pppoa>27.6. PPP ATM felett (PPPoA)<a class=anchor href=#pppoa></a></h3><div class=paragraph><p>Most a PPP ATM feletti (PPP over ATM, PPPoA) beállítását fogjuk bemutatni. A PPPoA az európai DSL szolgáltatók körében igen nagy népszerûségnek örvend.</p></div><div class=sect3><h4 id=_pppoa_használata_az_alcatel_speedtouch_usb_vel>27.6.1. PPPoA használata az Alcatel SpeedTouch™ USB-vel<a class=anchor href=#_pppoa_használata_az_alcatel_speedtouch_usb_vel></a></h4><div class=paragraph><p>Az ilyen eszközökhöz tartozó PPPoA támogatás a FreeBSD-ben portként áll rendelkezésre, mivel az ehhez szükséges firmware csak az <a href=http://www.speedtouchdsl.com/disclaimer_lx.htm>Alcatel licencelési feltételei szerint</a> terjeszthetõ, ezért nem lehet része az alap FreeBSD rendszernek.</p></div><div class=paragraph><p>A szoftver telepítéséhez ezért a <a href=./#ports>Portgyûjteményt</a> kell használnunk. Telepítsük a <a class=package href=https://cgit.freebsd.org/ports/tree/net/pppoa/>net/pppoa</a> portot és kövessük a mellékelt utasításokat.</p></div><div class=paragraph><p>Sok más USB-s eszközhöz hasonlóan az Alcatel SpeedTouch™ USB-nek a gépünkrõl kell letöltenie a mûködéséhez szükséges firmware-t. Ez a folyamat FreeBSD alatt automatizálható, tehát ez a másolás minden esetben megtörténik, amikor az eszközt az USB portra csatlakoztatjuk. Ehhez az <span class=filename>/etc/usbd.conf</span> állományba a következõ adatokat kell beletennünk. Az állományt <code>root</code> felhasználóként tudjuk csak szerkeszteni.</p></div><div class="literalblock programlisting"><div class=content><pre>device &#34;Alcatel SpeedTouch USB&#34;
    devname &#34;ugen[0-9]+&#34;
    vendor 0x06b9
    product 0x4061
    attach &#34;/usr/local/sbin/modem_run -f /usr/local/libdata/mgmt.o&#34;</pre></div></div><div class=paragraph><p>Az usbd, vagyis az USB démon engedélyezéséhez az <span class=filename>/etc/rc.conf</span> állományba tegyük bele az alábbit:</p></div><div class="literalblock programlisting"><div class=content><pre>usbd_enable=&#34;YES&#34;</pre></div></div><div class=paragraph><p>Emellett még a ppp kapcsolatot is be tudjuk állítani az indítás során. Ehhez mindössze a következõ sort kell megadnunk az <span class=filename>/etc/rc.conf</span> állományban. Ismét megemlítjük, hogy ezt a mûveletet csak a <code>root</code> felhasználóval tudjuk végrehajtani.</p></div><div class="literalblock programlisting"><div class=content><pre>ppp_enable=&#34;YES&#34;
ppp_mode=&#34;ddial&#34;
ppp_profile=&#34;adsl&#34;</pre></div></div><div class=paragraph><p>Ezután úgy tudjuk szóra bírni a kapcsolatot, ha a <a class=package href=https://cgit.freebsd.org/ports/tree/net/pppoa/>net/pppoa</a> porthoz mellékelt <span class=filename>ppp.conf</span> állományt használjuk fel kiindulásként.</p></div></div><div class=sect3><h4 id=_az_mpd_használata>27.6.2. Az mpd használata<a class=anchor href=#_az_mpd_használata></a></h4><div class=paragraph><p>Az mpd segítségével többféle szolgáltatáshoz, köztük a PPTP-hez hozzá tudunk férni. Az mpd a Portgyûjteményben <a class=package href=https://cgit.freebsd.org/ports/tree/net/mpd/>net/mpd</a> néven található meg. Sok ADSL modemnek szüksége van egy PPTP tunnelre közte és gép között. Ilyen modem például az Alcatel SpeedTouch™ Home is.</p></div><div class=paragraph><p>Elõször magát a portot kell telepítenünk, majd ezután már be tudjuk állítani az mpd-t a saját és a szolgáltatónk igényei szerint. A port a rengeteg leírással megtûzdelt minta konfigurációs állományait a <span class=filename>PREFIX/etc/mpd/</span> könyvtárba teszi. Itt a <em>PREFIX</em> azt a könyvtárat jelöli, ahova a portok kerülnek. Ez alapból a <span class=filename>/usr/local/</span>. Az mpd beállításáról szóló teljes dokumentáció a telepítés után elérhetõ HTML formátumban a <span class=filename>PREFIX/shared/doc/mpd/</span> könyvtárban. Íme egy példa az mpd beállítására ADSL kapcsolatok esetében. Az ezzel kapcsolatos beállításaink két állományra bomlanak, melyek közül az elsõ az <span class=filename>mpd.conf</span>:</p></div><div class="literalblock programlisting"><div class=content><pre>default:
    load adsl

adsl:
    new -i ng0 adsl adsl
    set bundle authname felhasználónév <i class=conum data-value=1></i><b>(1)</b>
    set bundle password jelszó <i class=conum data-value=2></i><b>(2)</b>
    set bundle disable multilink

    set link no pap acfcomp protocomp
    set link disable chap
    set link accept chap
    set link keep-alive 30 10

    set ipcp no vjcomp
    set ipcp ranges 0.0.0.0/0 0.0.0.0/0

    set iface route default
    set iface disable on-demand
    set iface enable proxy-arp
    set iface idle 0

    open</pre></div></div><div class="colist arabic"><table><tbody><tr><td><i class=conum data-value=1></i><b>1</b></td><td>A felhasználói azonosító, amellyel a szolgáltató felé hitelesítjük magunkat.</td></tr><tr><td><i class=conum data-value=2></i><b>2</b></td><td>Az azonosítóhoz tartozó jelszó, amelyet szintén a szolgáltatól kaptunk.</td></tr></tbody></table></div><div class=paragraph><p>Az <span class=filename>mpd.links</span> állomány tartalmazza a felépítendõ kapcsolatra vagy kapcsolatokra vonatkozó információkat. Például az elõbbiekhez tartozó <span class=filename>mpd.links</span> tartalma ez:</p></div><div class="literalblock programlisting"><div class=content><pre>adsl:
    set link type pptp
    set pptp mode active
    set pptp enable originate outcall
    set pptp self 10.0.0.1 <i class=conum data-value=1></i><b>(1)</b>
    set pptp peer 10.0.0.138 <i class=conum data-value=2></i><b>(2)</b></pre></div></div><div class="colist arabic"><table><tbody><tr><td><i class=conum data-value=1></i><b>1</b></td><td>A FreeBSD-s számítógépünk címe, ahonnan az mpd indul.</td></tr><tr><td><i class=conum data-value=2></i><b>2</b></td><td>Az ADSL modemünk IP-címe. Az Alcatel SpeedTouch™ Home esetén ez a cím alapértelmezés szerint a <code>10.0.0.138</code>.</td></tr></tbody></table></div><div class=paragraph><p>A kapcsolat ezek után pillanatok alatt felépíthetõ, ha a <code>root</code> felhasználóval kiadjuk a következõ parancsot:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># mpd -b adsl</span></code></pre></div></div><div class=paragraph><p>A kapcsolat állapotát a következõ paranccsal tudjuk ezután ellenõrizni:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>% ifconfig ng0
ng0: <span class=nv>flags</span><span class=o>=</span>88d1&lt;UP,POINTOPOINT,RUNNING,NOARP,SIMPLEX,MULTICAST&gt; mtu 1500
     inet 216.136.204.117 <span class=nt>--</span><span class=o>&gt;</span> 204.152.186.171 netmask 0xffffffff</code></pre></div></div><div class=paragraph><p>FreeBSD alatt az mpd használata ajánlott az ADSL szolgáltatások eléréséhez.</p></div></div><div class=sect3><h4 id=_a_pptpclient_használata>27.6.3. A pptpclient használata<a class=anchor href=#_a_pptpclient_használata></a></h4><div class=paragraph><p>FreeBSD alatt a <a class=package href=https://cgit.freebsd.org/ports/tree/net/pptpclient/>net/pptpclient</a> segítségével is tudunk PPPoA típusú szolgáltatásokhoz kapcsolódni.</p></div><div class=paragraph><p>A <a class=package href=https://cgit.freebsd.org/ports/tree/net/pptpclient/>net/pptpclient</a> felhasználásával úgy tudunk DSL szolgáltatásokat elérni, ha feltelepítjük a hozzá tartozó portot vagy csomagot, majd módosítjuk az <span class=filename>/etc/ppp/ppp.conf</span> állományt. Mind a két mûveletet csak <code>root</code> felhasználóként tudjuk lebonyolítani. Ehhez egy <span class=filename>ppp.conf</span> állományt lentebb adtunk meg. A <span class=filename>ppp.conf</span> állományban található további beállítási lehetõségekrõl a <a href="https://man.freebsd.org/cgi/man.cgi?query=ppp&amp;sektion=8&amp;format=html">ppp(8)</a> man oldalon olvashatunk.</p></div><div class="literalblock programlisting"><div class=content><pre>adsl:
 set log phase chat lcp ipcp ccp tun command
 set timeout 0
 enable dns
 set authname felhasználónév <i class=conum data-value=1></i><b>(1)</b>
 set authkey jelszó <i class=conum data-value=2></i><b>(2)</b>
 set ifaddr 0 0
 add default HISADDR</pre></div></div><div class="colist arabic"><table><tbody><tr><td><i class=conum data-value=1></i><b>1</b></td><td>A DSL szolgáltatónktól kapott felhasználói név.</td></tr><tr><td><i class=conum data-value=2></i><b>2</b></td><td>Az elõfizetéshez tartozó jelszó.</td></tr></tbody></table></div><div class="admonitionblock warning"><table><tbody><tr><td class=icon><i class="fa icon-warning" title=Warning></i></td><td class=content><div class=paragraph><p>Mivel az elõfizetéshez tartozó jelszót a <span class=filename>ppp.conf</span> állományba titkosítatlan formában kell szerepeltetnünk, ezért gondoskodjunk róla, hogy senki sem képes olvasni a tartalmát. A most következõ parancsokkal beállítjuk, hogy ez az állomány csak a <code>root</code> felhasználó számára legyen olvasható. A részletekért lásd a <a href="https://man.freebsd.org/cgi/man.cgi?query=chmod&amp;sektion=1&amp;format=html">chmod(1)</a> és <a href="https://man.freebsd.org/cgi/man.cgi?query=chown&amp;sektion=8&amp;format=html">chown(8)</a> man oldalakat.</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># chown root:wheel /etc/ppp/ppp.conf</span>
<span class=c># chmod 600 /etc/ppp/ppp.conf</span></code></pre></div></div></td></tr></tbody></table></div><div class=paragraph><p>Ezzel a paranccsal a DSL útválasztónk felé nyitunk egy tunnelt a PPP kapcsolathoz. Az Ethernetes DSL modemek általában egy elõre beállított helyi hálózati IP-címmel rendelkeznek, amelyhez tudunk csatlakozni. Az Alcatel SpeedTouch™ Home esetében ez a cím a <code>10.0.0.138</code>. Az útválasztóhoz adott dokumentációban keressük meg, hogy az eszközünkhöz konkrétan milyen cím tartozik. A tunnel megnyitásához és a PPP kapcsolat megindításához a következõ parancsot kell kiadnunk:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># pptp cím adsl</span></code></pre></div></div><div class="admonitionblock tip"><table><tbody><tr><td class=icon><i class="fa icon-tip" title=Tip></i></td><td class=content><div class=paragraph><p>Az iménti parancs végére még érdemes odatenni az "et" jelet ("&") is, mivel így a pptp mûködését a háttérben folytatja.</p></div></td></tr></tbody></table></div><div class=paragraph><p>A parancs hatására a virtuális tunnelt megtestesítõ <span class=filename>tun</span> eszköz jön létre a pptp és ppp programok között. Miután visszakaptuk a parancssort, vagy a pptp program megerõsítette a kapcsolódás sikerességét, a keletkezett járatot így tudjuk ellenõrizni:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>% ifconfig tun0
tun0: <span class=nv>flags</span><span class=o>=</span>8051&lt;UP,POINTOPOINT,RUNNING,MULTICAST&gt; mtu 1500
        inet 216.136.204.21 <span class=nt>--</span><span class=o>&gt;</span> 204.152.186.171 netmask 0xffffff00
        Opened by PID 918</code></pre></div></div><div class=paragraph><p>Ha nem tudnánk valamiért csatlakozni, akkor elõször nézzük meg az útválasztónk beállításait, ami általában a telnet vagy egy böngészõ segítségével elérhetõ. Ha még mindig nem vagyunk képesek csatlakozni, akkor a <code>pptp</code> parancs kimenetében és ppp <span class=filename>/var/log/ppp.log</span> néven elérhetõ naplójában kereshetünk árulkodó nyomokat.</p></div></div></div><div class=sect2><h3 id=slip>27.7. A SLIP használata<a class=anchor href=#slip></a></h3><div class="admonitionblock warning"><table><tbody><tr><td class=icon><i class="fa icon-warning" title=Warning></i></td><td class=content><div class=paragraph><p>Ez a szakasz csak FreeBSD 7.<em>X</em> rendszerekre érvényes.</p></div></td></tr></tbody></table></div><div class=sect3><h4 id=slipc>27.7.1. A SLIP kliensek beállítása<a class=anchor href=#slipc></a></h4><div class=paragraph><p>A következõkben azt mutatjuk be, hogy egy FreeBSD-s gépet miként tudunk egy hálózaton statikus névvel beállítani a SLIP használatával. A dinamikus hálózati nevek használatakor (vagyis amikor a címünk minden egyes tárcsázáskor megváltozhat) egy valamivel bonyolultabb beállításra van szükségünk.</p></div><div class=paragraph><p>Elõször is állapítsuk meg, hogy a modemünk melyik soros portra csatlakozik. Sokan <span class=filename>/dev/modem</span> néven egy szimbolikus linket hoznak létre a valódi eszközre, például a <span class=filename>/dev/cuadN</span> leíróra. Ennek köszönhetõen az eszköz tényleges névetõl el tudunk vonatkoztatni és soha nem kell módosítanunk semmit, ha a modemet például egy másik portra kell átraknunk. Ugyanis könnyedén kacifántossá tud válni a helyzet, amikor egyszerre kell megváltoztatnunk egy rakat dolgot az <span class=filename>/etc</span> könyvtárban és módosítanunk az összes <span class=filename>.kermrc</span> állományt!</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>A <span class=filename>/dev/cuad0</span> a <span class=filename>COM1</span> port, a <span class=filename>/dev/cuad1</span> a <span class=filename>COM2</span> és így tovább.</p></div></td></tr></tbody></table></div><div class=paragraph><p>A rendszermag beállításait tartalmazó állományban a következõnek mindenképpen szerepelnie kell:</p></div><div class="literalblock programlisting"><div class=content><pre>device   sl</pre></div></div><div class=paragraph><p>Mivel ez általában a <span class=filename>GENERIC</span> rendszermagban megtalálható, így ez nem okoz semmilyen gondot, kivéve, hogy ha korábban már kitöröltük.</p></div><div class=sect4><h5 id=_amit_csak_egyszer_kell_megtenni>27.7.1.1. Amit csak egyszer kell megtenni<a class=anchor href=#_amit_csak_egyszer_kell_megtenni></a></h5><div class="exampleblock procedure"><div class=content><div class="olist arabic"><ol class=arabic><li><p>Vegyük fel az otthoni gépünket, az átjárónkat és a névszervereket az <span class=filename>/etc/hosts</span> állományba. Erre álljon itt egy konkrét példa:</p><div class="literalblock programlisting"><div class=content><pre>127.0.0.1               localhost loghost
136.152.64.181          water.CS.Example.EDU water.CS water
136.152.64.1            inr-3.CS.Example.EDU inr-3 slip-gateway
128.32.136.9            ns1.Example.EDU ns1
128.32.136.12           ns2.Example.EDU ns2</pre></div></div></li><li><p>Figyeljünk oda, hogy az <span class=filename>/etc/nsswitch.conf</span> állományban szereplõ <code>hosts</code> szakaszban a <code>dns</code> szó elõtt a <code>files</code> szónak kell megjelennie. Ezek nélkül mókás dolgok tudnak történni rendszerünkben.</p></li><li><p>Szerkesszük át az <span class=filename>/etc/rc.conf</span> állományt.</p><div class="olist loweralpha"><ol class=loweralpha type=a><li><p>A hálózati nevünket a következõ sorban tudjuk megadni:</p><div class="literalblock programlisting"><div class=content><pre>hostname=&#34;az.en.nevem&#34;</pre></div></div><div class=paragraph><p>Ide a gépünk teljes internetes hálózati nevét kell beírnunk.</p></div></li><li><p>Az alapértelmezett átjárót az alábbi sor módosításával tudjuk beállítani úgy, hogy a</p><div class="literalblock programlisting"><div class=content><pre>defaultrouter=&#34;NO&#34;</pre></div></div><div class=paragraph><p>változó értékét átírjuk:</p></div><div class="literalblock programlisting"><div class=content><pre>defaultrouter=&#34;slip-gateway&#34;</pre></div></div></li></ol></div></li><li><p>Készítsük el az <span class=filename>/etc/resolv.conf</span> állományt, amelyben majd a következõk legyenek:</p><div class="literalblock programlisting"><div class=content><pre>domain CS.Example.EDU
nameserver 128.32.136.9
nameserver 128.32.136.12</pre></div></div><div class=paragraph><p>Látható, hogy ezek a névfeloldásért felelõs szerverek címei. Természetesen a ténylegesen beírandó tartomány (domain) neve és a névszerverek címei mindig az adott környezetünktõl függenek.</p></div></li><li><p>Állítsuk be egy jelszót a <code>root</code> és <code>toor</code> felhasználóknak (és mindenki másnak, akinek még nem lenne).</p></li><li><p>Indítsuk újra a számítógépünket és utána gyõzõdjünk meg róla, hogy a megfelelõ hálózati névvel rendelkezik.</p></li></ol></div></div></div></div><div class=sect4><h5 id=_a_slip_kapcsolatok_felépítése>27.7.1.2. A SLIP kapcsolatok felépítése<a class=anchor href=#_a_slip_kapcsolatok_felépítése></a></h5><div class="exampleblock procedure"><div class=content><div class="olist arabic"><ol class=arabic><li><p>Tárcsázzunk és gépeljük be a <code>slip</code> parancsot, majd ezt követõen a gépünk nevét és a jelszót. Ez leginkább a konkrét környezettõl függ. Ha a Kermit nevû programot használjuk, akkor egy ilyen szkripttel is próbálkozhatunk:</p><div class="literalblock programlisting"><div class=content><pre># a kermit beállítása
set modem hayes
set line /dev/modem
set speed 115200
set parity none
set flow rts/cts
set terminal bytesize 8
set file type binary
# a következõ makró felelõs a tárcsázásért és a bejelentkezésért
define slip dial 643-9600, input 10 =&gt;, if failure stop, -
output slip\x0d, input 10 Azonosito:, if failure stop, -
output silvia\x0d, input 10 Jelszo:, if failure stop, -
output ***\x0d, echo \x0aCONNECTED\x0a</pre></div></div><div class=paragraph><p>Természetesen a felhasználói nevet és a jelszót a sajátunkra kell benne kicserélnünk. Miután ezzel is megvagyunk, a Kermit paranccsorában a csatlakozáshoz egyszerûen csak írjuk be, hogy <code>slip</code>.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p><em>Nem</em> javasoljuk, hogy az állományrendszeren a jelszavakat titkosítatlan formában tároljuk. Mindeki csak a saját felelõsségére tegyen ilyet.</p></div></td></tr></tbody></table></div></li><li><p>Hagyjuk el a Kermit programot (a <span class=keyseq><kbd>Ctrl</kbd>+<kbd>z</kbd></span> billentyûkombinációval bármikor fel tudjuk függeszteni a futását) és <code>root</code> felhasználóként írjuk be a következõt:</p><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># slattach -h -c -s 115200 /dev/modem</span></code></pre></div></div><div class=paragraph><p>Ha ezután már képesek vagyunk a <code>ping</code> paranccsal elérni az útválasztó másik oldalán található gépet, akkor az azt jelenti, hogy sikerült csatlakoznunk! Ha viszont itt még nem járnánk sikerrel, akkor az <code>slattach</code> parancsnak ne a <code>-c</code> paramétert adjuk meg, hanem a <code>-a</code> paramétert.</p></div></li></ol></div></div></div></div><div class=sect4><h5 id=_hogyan_bontsunk_egy_kapcsolatot>27.7.1.3. Hogyan bontsunk egy kapcsolatot<a class=anchor href=#_hogyan_bontsunk_egy_kapcsolatot></a></h5><div class=paragraph><p>Tegyük a következõket:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># kill -INT `cat /var/run/slattach.modem.pid`</span></code></pre></div></div><div class=paragraph><p>Ez leállítja az <code>slattach</code> programot. Ne felejtsük el azonban, hogy ezt csak a <code>root</code> felhasználóval tudjuk végrehajtani. Ezután térjünk vissza a <code>kermit</code> programhoz (ha felfüggesztettük volna, akkor ehhez a <code>fg</code> parancsra lesz szükségünk), és lépjünk ki belõle (<kbd>q</kbd>).</p></div><div class=paragraph><p>Az <a href="https://man.freebsd.org/cgi/man.cgi?query=slattach&amp;sektion=8&amp;format=html">slattach(8)</a> man oldala ehhez a <code>ifconfig sl0 down</code> parancsot javasolja, amellyel lényegében leállítjuk a hozzá tartozó felületet. Igazából a kettõ között nincs semmilyen komolyabb eltérés (mivel az (<code>ifconfig sl0</code> is ugyanezt eredményezi.)</p></div><div class=paragraph><p>Néha elõfordulhat, hogy a modem egyszerûen nem hajlandó eldobni a vonalat. Ilyen esetekben indítsuk el a <code>kermit</code> programot és lépjünk ki megint. Másodjára általában már sikerül.</p></div></div><div class=sect4><h5 id=_hibaelhárítás_2>27.7.1.4. Hibaelhárítás<a class=anchor href=#_hibaelhárítás_2></a></h5><div class=paragraph><p>Ha valamiért ez mégsem válna be, akkor csak nyugodtan kérdezõsködjünk a <a href=https://lists.FreeBSD.org/subscription/freebsd-net>freebsd-net</a> levelezési listán. A tapasztalatok szerint az embereknek eddig a következõkkel voltak problémáik:</p></div><div class=ulist><ul><li><p>Az <code>slattach</code> meghívásakor sem a <code>-c</code>, sem pedig a <code>-a</code> paramétert nem adták meg. (Ez ugyan nem végzetes hiba, de egyes felhasználók szerint ez segített megoldani a gondokat.)</p></li><li><p>Az <code>sl0</code> helyett <code>s10</code>-et írtak be (egyes betûtípusoknál könnyen össze lehet téveszteni ezeket).</p></li><li><p>Az <code>ifconfig sl0</code> segítségével ellenõrizhetõ a felület állapota. Például ilyet láthatunk:</p><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># ifconfig sl0</span>
sl0: <span class=nv>flags</span><span class=o>=</span>10&lt;POINTOPOINT&gt;
        inet 136.152.64.181 <span class=nt>--</span><span class=o>&gt;</span> 136.152.64.1 netmask ffffff00</code></pre></div></div></li><li><p>Ha a <a href="https://man.freebsd.org/cgi/man.cgi?query=ping&amp;sektion=8&amp;format=html">ping(8)</a> <code>no route to host</code> hibaüzenetet ad, akkor az útválasztási táblázattal van a gond. A <code>netstat -r</code> paranccsal gyorsan ki tudjuk listázni a rendszerünkben jelenleg nyilvántartott utakat:</p><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># netstat -r</span>
Routing tables
Destination      Gateway            Flags     Refs     Use  IfaceMTU    Rtt    Netmasks:

<span class=o>(</span>root node<span class=o>)</span>
<span class=o>(</span>root node<span class=o>)</span>

Route Tree <span class=k>for </span>Protocol Family inet:
<span class=o>(</span>root node<span class=o>)</span> <span class=o>=&gt;</span>
default          inr-3.Example.EDU  UG          8   224515  sl0 -      -
localhost.Exampl localhost.Example. UH          5    42127  lo0 -       0.438
inr-3.Example.ED water.CS.Example.E UH          1        0  sl0 -      -
water.CS.Example localhost.Example. UGH        34 47641234  lo0 -       0.438
<span class=o>(</span>root node<span class=o>)</span></code></pre></div></div><div class=paragraph><p>Az elõzõ példákat egy viszonylag forgalmas rendszerbõl ragadtuk ki. A rendszerünkön megjelenõ számok a hálózati aktivitás mértékének függvényei.</p></div></li></ul></div></div></div><div class=sect3><h4 id=slips>27.7.2. A SLIP szerverek beállítása<a class=anchor href=#slips></a></h4><div class=paragraph><p>Ebben a leírásban igyekszünk bemutatni hogyan kell egy FreeBSD típusú rendszer alatt SLIP szervert beállítani, ami általában annyit jelent, hogy a rendszerünben a távoli SLIP kliensek csatlakozásakor automatikusan elindítjuk a kapcsolatokat.</p></div><div class=sect4><h5 id=slips-prereqs>27.7.2.1. Elõfeltételek<a class=anchor href=#slips-prereqs></a></h5><div class=paragraph><p>Ez a szakasz igen szakmai jellegû, ezért az olvasó részérõl feltételezünk a témában némi alapismeretet. Ez alatt alapvetõen a TPC/IP hálózati protokollt értjük, különös hangsúllyal a hálózatok és hálózati csomópontok címzéséen, a hálózati maszkokon, alhálózatokon, útválasztáson, az olyan útválasztási protokollokon, mint például a RIP. A SLIP beállítása egy betárcsázós szerveren mindezen fogalmak ismeretét igényli, és ha ezekkel még nem lennénk tisztában, akkor olvassuk el például Craig Hunt <em>TCP/IP Network Administration</em> címû könyvét (O’Reilly & Associates, Inc.; ISBN: 0-937175-82-X) vagy Douglas Comer TCP/IP protokollról szóló könyveit.</p></div><div class=paragraph><p>Mindezek mellett még feltételezzük, hogy már beállítottuk a modem(ek)et és a rajtuk keresztüli bejelentkezéshez szükséges állományokat. Ha még nem készítettük volna fel erre a rendszerünket, akkor a <a href=./#dialup>Betárcsázós szolgáltatások</a> ad részletes tájékoztatást a betárcsázós szolgáltatások beállításáról. A soros vonali eszközmeghajtóval kapcsolatban továbbá érdemes átolvasni a <a href="https://man.freebsd.org/cgi/man.cgi?query=sio&amp;sektion=4&amp;format=html">sio(4)</a> oldalt, valamint a <a href="https://man.freebsd.org/cgi/man.cgi?query=ttys&amp;sektion=5&amp;format=html">ttys(5)</a>, <a href="https://man.freebsd.org/cgi/man.cgi?query=gettytab&amp;sektion=5&amp;format=html">gettytab(5)</a>, <a href="https://man.freebsd.org/cgi/man.cgi?query=getty&amp;sektion=8&amp;format=html">getty(8)</a> és <a href="https://man.freebsd.org/cgi/man.cgi?query=init&amp;sektion=8&amp;format=html">init(8)</a> oldalakat a bejelentkezések modemen keresztüli fogadásáról, illetve talán az <a href="https://man.freebsd.org/cgi/man.cgi?query=stty&amp;sektion=1&amp;format=html">stty(1)</a> oldalt a soros port paramétereinek megfelelõ beállításáról (mint például a <code>clocal</code> a közvetlenül csatlakozó soros felületek esetében).</p></div></div><div class=sect4><h5 id=_gyors_áttekintés>27.7.2.2. Gyors áttekintés<a class=anchor href=#_gyors_áttekintés></a></h5><div class=paragraph><p>A FreeBSD SLIP szerverként általában a következõ módon üzemel: a SLIP felhasználó tárcsázza a FreeBSD-s SLIP szerverünket, majd bejelentkezik egy specális SLIP bejelentkezési azonosító használatával, amely a <span class=filename>/usr/sbin/sliplogin</span> shellt használja. A <code>sliplogin</code> program az <span class=filename>/etc/sliphome/slip.hosts</span> állományban megkeresi a speciális felhasználóhoz tartozó sort, és ha talál egy ilyet, akkor csatlakoztatja a soros vonalat egy rendelkezésre álló SLIP felületre, amelyen aztán a SLIP felültet beállításához lefuttatja az <span class=filename>/etc/sliphome/slip.login</span> shell szkriptet.</p></div><div class=sect5><h6 id=_példa_slip_szerveren_keresztüli_bejelentkezésre>27.7.2.2.1. Példa SLIP szerveren keresztüli bejelentkezésre<a class=anchor href=#_példa_slip_szerveren_keresztüli_bejelentkezésre></a></h6><div class=paragraph><p>Például, ha a SLIP felhasználó azonosítója <code>Shelmerg</code>, akkor az <span class=filename>/etc/master.passwd</span> állományban a hozzá tartozó bejegyzést nagyjából ilyen:</p></div><div class="literalblock programlisting"><div class=content><pre>Shelmerg:password:1964:89::0:0:Guy Helmer - SLIP:/usr/users/Shelmerg:/usr/sbin/sliplogin</pre></div></div><div class=paragraph><p>Amikor <code>Shelmerg</code> bejelentkezik, a <code>sliplogin</code> az <span class=filename>/etc/sliphome/slip.hosts</span> állományban keresni fog egy felhasználó azonosítójához illeszkedõ sort. Például tegyük fel, hogy az <span class=filename>/etc/sliphome/slip.hosts</span> állományban szerepel egy ilyen sor:</p></div><div class="literalblock programlisting"><div class=content><pre>Shelmerg        dc-slip sl-helmer       0xfffffc00		  autocomp</pre></div></div><div class=paragraph><p>A <code>sliplogin</code> ezt a sor fogja megtalálni, majd a soros vonalat a következõ elérhetõ SLIP felülethez kapcsolja, amelyen ezután végrehajtja az <span class=filename>/etc/sliphome/slip.login</span> szkriptet a következõ módon:</p></div><div class="literalblock programlisting"><div class=content><pre>/etc/sliphome/slip.login 0 19200 Shelmerg dc-slip sl-helmer 0xfffffc00 autocomp</pre></div></div><div class=paragraph><p>Ha minden jól megy, akkor az <span class=filename>/etc/sliphome/slip.login</span> kiad egy <code>ifconfig</code> parancsot azon a SLIP felületen, amelyre a <code>sliplogin</code> magát csatlakoztatta (amely a fenti példában a 0. SLIP felület volt, és amelyet meg is adtunk <span class=filename>slip.login</span> elsõ paramétereként), és így beállítja a helyi IP-címet (<code>dc-slip</code>), a távoli IP-címet (<code>sl-helmer</code>), a SLIP felülethez tartozó hálózati maszkot (<code>0xfffffc00</code>) valamint a további opciókat (<code>autocomp</code>). Ha valami rosszul sülne el, akkor a <code>sliplogin</code> ezekrõl általában nagyon jó minõségû, információdús üzeneteket készít, amelyeket a syslogd démon pedig a <span class=filename>/var/log/messages</span> állományba rögzít. (A <a href="https://man.freebsd.org/cgi/man.cgi?query=syslogd&amp;sektion=8&amp;format=html">syslogd(8)</a> és <a href="https://man.freebsd.org/cgi/man.cgi?query=syslog.conf&amp;sektion=5&amp;format=html">syslog.conf(5)</a> man oldalak és talán maga az <span class=filename>/etc/syslog.conf</span> segíthet kideríteni, hogy a syslogd jelenleg naplóz-e, és ha igen, akkor hova.)</p></div></div></div><div class=sect4><h5 id=_a_rendszermag_beállítása_4>27.7.2.3. A rendszermag beállítása<a class=anchor href=#_a_rendszermag_beállítása_4></a></h5><div class=paragraph><p>A FreeBSD alap (vagyis a <span class=filename>GENERIC</span>) rendszermagja támogatja a SLIP (<a href="https://man.freebsd.org/cgi/man.cgi?query=sl&amp;sektion=4&amp;format=html">sl(4)</a>) használatát. Ha viszont saját rendszermagunk van, akkor elõfordulhat, hogy beállítások közé fel kell vennünk a következõ sort is:</p></div><div class="literalblock programlisting"><div class=content><pre>device   sl</pre></div></div><div class=paragraph><p>Alapértelmezés szerint a FreeBSD nem továbbít semmilyen csomagot. Amennyiben a FreeBSD SLIP szerverünket útválasztóként is mûködtetni akarjuk, úgy az <span class=filename>/etc/rc.conf</span> állományban a <code>gateway_enable</code> változót át kell állítanunk a <code>YES</code> értékre. Ennek hatására az újraindítás után is megmarad a csomagok továbbítása.</p></div><div class=paragraph><p>A változtatások azonnali életbeléptetéséhez adjuk ki <code>root</code> felhasználóként a következõ parancsot:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># /etc/rc.d/routing start</span></code></pre></div></div><div class=paragraph><p>Ha a FreeBSD rendszermag beállítása során segítségre szorulnánk, akkor olvassuk el <a href=./#kernelconfig>A FreeBSD rendszermag testreszabása</a>et.</p></div></div><div class=sect4><h5 id=_a_sliplogin_beállítása>27.7.2.4. A sliplogin beállítása<a class=anchor href=#_a_sliplogin_beállítása></a></h5><div class=paragraph><p>Ahogy arra már korábban is utaltunk, az <span class=filename>/etc/sliphome</span> könyvtárban három állomány felelõs a <span class=filename>/usr/sbin/sliplogin</span> beállításáért (lásd <a href="https://man.freebsd.org/cgi/man.cgi?query=sliplogin&amp;sektion=8&amp;format=html">sliplogin(8)</a>): a <span class=filename>slip.hosts</span>, amelyekben a SLIP felhasználókat és a hozzájuk tartozó IP-címeket adjuk meg; a <span class=filename>slip.login</span>, amely általában csak a SLIP felületet állítja be; (az elhagyható) <span class=filename>slip.logout</span>, amely a soros vonal bontásakor a <span class=filename>slip.login</span> hatását igyekszik visszafordítani.</p></div><div class=sect5><h6 id=_a_slip_hosts_beállítása>27.7.2.4.1. A <span class=filename>slip.hosts</span> beállítása<a class=anchor href=#_a_slip_hosts_beállítása></a></h6><div class=paragraph><p>Az <span class=filename>/etc/sliphome/slip.hosts</span> soraiban whitespace karakterekkel tagoltan legalább négy elem szerepel:</p></div><div class=ulist><ul><li><p>a SLIP felhasználó bejelentkezési azonosítója</p></li><li><p>a SLIP kapcsolat helyi címe (a SLIP szerveréhez képest)</p></li><li><p>a SLIP kapcsolat távoli címe</p></li><li><p>hálózati maszk</p></li></ul></div><div class=paragraph><p>A helyi és távoli címek lehetnek hálózati nevek is (amelyeket vagy az <span class=filename>/etc/hosts</span>, vagy pedig az <span class=filename>/etc/nsswitch.conf</span> állományban szereplõ beállítások alapján tudunk feloldani IP-címre), illetve a hálózati maszk is lehet egy olyan név, amelyet az <span class=filename>/etc/networks</span> fel tud oldani. A példaként bemutatott rendszerünkben az <span class=filename>/etc/sliphome/slip.hosts</span> állomány nagyjából így épül fel:</p></div><div class="literalblock programlisting"><div class=content><pre>#
# login helyi-cím       távoli-cím      maszk            opc1    opc2
#                                               (normal,compress,noicmp)
#
Shelmerg  dc-slip       sl-helmerg      0xfffffc00      autocomp</pre></div></div><div class=paragraph><p>A sorok végén az alábbi opciók közül egy vagy több szerepelhet:</p></div><div class=ulist><ul><li><p><code>normal</code> - a fejléceket nem tömörítjük</p></li><li><p><code>compress</code> - a fejlécek tömörítése</p></li><li><p><code>autocomp</code> - ha a távoli végpont engedi, akkor tömörítsük a fejléceket</p></li><li><p><code>noicmp</code> - az ICMP csomagok tiltása (így például a "ping" által generált csomagok is eldobódnak a sávszélesség felemésztese helyett)</p></li></ul></div><div class=paragraph><p>A SLIP kapcsolathoz tartozó helyi és távoli címek megválasztása függ attól, hogy egy külön TCP/IP alhálózatot szentelünk-e neki, vagy a SLIP szerverünkön egy "ARP proxy"-t használunk (amely tulajdonképpen nem egy "valódi" ARP proxy, de ebben a szakaszban így fogunk rá hivatkozni). Ha nem vagyunk biztosak benne, hogy melyik módszert válasszuk vagy hogy miként osszuk ki az IP-címeket, akkor nézzünk utána ezekenek a SLIP használatával kapcsolatos elõfeltételek között megemlített könyvekben (<a href=#slips-prereqs>Elõfeltételek</a>) és/vagy konzultáljunk a hálózatunk karbantartójával.</p></div><div class=paragraph><p>Ha a SLIP klienseknek külön alhálózatokat osztunk ki, akkor a saját IP-címünkbõl kell létrehoznunk és kiadnunk ezeket. Ezután valószínûleg a SLIP szerverünkön keresztül még meg kell adnunk egy statikus útvonalat legközelebbi IP útválasztó felé.</p></div><div class=paragraph><p>Minden más esetben az "ARP proxy" módszert kell alkalmaznunk, ahol a SLIP kliensek IP-címeit a SLIP szerver Ethernet alhálózatából osztjuk ki, és ennek megfelelõen az <span class=filename>/etc/sliphome/slip.login</span> és <span class=filename>/etc/sliphome/slip.logout</span> szkripteket módosítanunk kell úgy, hogy az <a href="https://man.freebsd.org/cgi/man.cgi?query=arp&amp;sektion=8&amp;format=html">arp(8)</a> segítségével képesek legyenek a SLIP szerver ARP táblázatában kezelni a "proxy ARP" bejegyzéseket.</p></div></div><div class=sect5><h6 id=_a_slip_login_beállítása>27.7.2.4.2. A <span class=filename>slip.login</span> beállítása<a class=anchor href=#_a_slip_login_beállítása></a></h6><div class=paragraph><p>Egy átlagos <span class=filename>/etc/sliphome/slip.login</span> állomány körülbelül ilyen:</p></div><div class="literalblock programlisting"><div class=content><pre>#!/bin/sh -
#
#       @(#)slip.login  5.1 (Berkeley) 7/1/90

#
# Egy általános slip vonali bejelentkezési állomány. A sliplogin ezt az alábbi
# paraméterekkel hívja meg:
#      1        2         3        4          5         6     7-n
#   slipegys. ttyseb.  azonosító helyi-cím távoli-cím maszk egyéb-pmek.
#
/sbin/ifconfig sl$1 inet $4 $5 netmask $6</pre></div></div><div class=paragraph><p>Ez a <span class=filename>slip.login</span> állomány az <code>ifconfig</code> segítségével pusztán beállítja a megfelelõ SLIP felülethez tartozó helyi, valamint távoli címet és a hálózati maszkot.</p></div><div class=paragraph><p>Ha ehelyett azonban az "ARP proxy" módszerét választottuk volna (tehát a SLIP kliensekenek nem akarunk egész alhálózatokat kiutalni), akkor az <span class=filename>/etc/sliphome/slip.login</span> állomány eképpen alakul:</p></div><div class="literalblock programlisting"><div class=content><pre>#!/bin/sh -
#
#       @(#)slip.login  5.1 (Berkeley) 7/1/90

#
# Egy általános slip vonali bejelentkezési állomány. A sliplogin ezt az alábbi
# paraméterekkel hívja meg:
#      1        2         3        4          5         6     7-n
#   slipegys. ttyseb.  azonosító helyi-cím távoli-cím maszk egyéb-pmek.
#
/sbin/ifconfig sl$1 inet $4 $5 netmask $6
# A SLIP kliensre vonatkozó ARP kéréseket a mi Ethernet címünkkel
# válaszoljuk meg:
/usr/sbin/arp -s $5 00:11:22:33:44:55 pub</pre></div></div><div class=paragraph><p>Láthatjuk, hogy az elõbbi <span class=filename>slip.login</span> állomány egy <code>arp -s $5 00:11:22:33:44:55 pub</code> paranccsal egészült ki, ami a SLIP szerver ARP táblázatában hoz létre egy ARP bejegyzést. Ez az ARP bejegyzés gondoskodik róla, hogy a SLIP szerver válaszoljon a saját Ethernetes MAC-címével, amikor egy másik IP csomópont a SLIP kliens IP-címe felõl érdeklõdik.</p></div><div class=paragraph><p>Amikor a fenti példából indulunk ki, a benne megadott MAC-címet (<code>00:11:22:33:44:55</code>) feltétlenül cseréljük a rendszerünk Ethernet kártyájának MAC-címével, mert különben az "ARP proxy" egyáltalán nem fog mûködni! A SLIP szerverünk MAC-címét a <code>netstat -i</code> paranccsal deríthetjük ki, amelynek a kimenetében a második sor valahogy így néz ki:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>ed0   1500  &lt;Link&gt;0.2.c1.28.5f.4a         191923	0   129457     0   116</code></pre></div></div><div class=paragraph><p>Ebbõl derül ki, hogy az adott rendszer valódi MAC-címe a <code>00:02:c1:28:5f:4a</code> - az <a href="https://man.freebsd.org/cgi/man.cgi?query=arp&amp;sektion=8&amp;format=html">arp(8)</a> számára azonban a <code>netstat -i</code> kimenetében szereplõ pontokat kettõspontokra kell cserélni, és a tagokat ki kell egészíteni kétkarakteres hexadecimális számokká. Az <a href="https://man.freebsd.org/cgi/man.cgi?query=arp&amp;sektion=8&amp;format=html">arp(8)</a> man oldalán tudhatunk meg ennek részleteirõl többet.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Amikor létrehozzuk az <span class=filename>/etc/sliphome/slip.login</span> és <span class=filename>/etc/sliphome/slip.logout</span> állományokat, akkor ne felejtsük el hozzájuk beállítani a "végrehajtást" engedélyezõ bitet sem (tehát ilyenkor mindig adjuk ki a <code>chmod 755 /etc/sliphome/slip.login /etc/sliphome/slip.logout</code> parancsokat is), különben a <code>sliplogin</code> ezeket nem tudja majd elindítani.</p></div></td></tr></tbody></table></div></div><div class=sect5><h6 id=_a_slip_logout_beállítása>27.7.2.4.3. A <span class=filename>slip.logout</span> beállítása<a class=anchor href=#_a_slip_logout_beállítása></a></h6><div class=paragraph><p>Az <span class=filename>/etc/sliphome/slip.logout</span> állományra nincs feltétlenül szükségünk (hacsak nem egy "ARP proxy"-t akarunk csinálni), de ha valamiért mégis el akarjuk készíteni, akkor ehhez a következõ alapvetõ <span class=filename>slip.logout</span> szkript használható:</p></div><div class="literalblock programlisting"><div class=content><pre>#!/bin/sh -
#
#       slip.logout

#
# Egy logout állomány a slip vonalhoz. A sliplogin ezt a szkriptet a
# következõ paraméterekkel hívja:
#      1        2         3        4          5         6     7-n
#   slipegys. ttyseb.   login helyi-cím  távoli-cím   maszk opc-pmek.
#
/sbin/ifconfig sl$1 down</pre></div></div><div class=paragraph><p>Ha az "ARP proxy" módszert használjuk, és az <span class=filename>/etc/sliphome/slip.logout</span> felhasználásával akarjuk a SLIP klienshez tartozó ARP bejegyzést törölni, akkor ebbõl induljunk ki:</p></div><div class="literalblock programlisting"><div class=content><pre>#!/bin/sh -
#
#       @(#)slip.logout

#
# Egy logout állomány a slip vonalhoz. A sliplogin ezt a szkriptet a
# következõ paraméterekkel hívja:
#      1        2         3        4          5         6     7-n
#   slipegys. ttyseb.   login helyi-cím  távoli-cím   maszk opc-pmek.
#
sbin/ifconfig sl$1 down
# Ne válaszoljunk többet a SLIP kliensre vonatkozó ARP kérésekre
/usr/sbin/arp -d $5</pre></div></div><div class=paragraph><p>Az <code>arp -d $5</code> parancs eltávolítja az "ARP proxy" mûködéséhez bejegyzést, amelyet még a <span class=filename>slip.login</span> szkripttel vettünk fel a SLIP kliens bejelentkezésekor.</p></div><div class=paragraph><p>Talán felesleges ismételgetésnek tûnhet: az <span class=filename>/etc/sliphome/slip.logout</span> állománynak létrehozása után állítsuk be a végrehajtásra szóló bitet (vagyis adjuk ki a <code>chmod 755 /etc/sliphome/slip.logout</code> parancsot).</p></div></div></div><div class=sect4><h5 id=_az_útválasztással_kapcsolatos_megfontolások>27.7.2.5. Az útválasztással kapcsolatos megfontolások<a class=anchor href=#_az_útválasztással_kapcsolatos_megfontolások></a></h5><div class=paragraph><p>Ha a hálózatunk többi része (lényegében az internet) és a SLIP klienseink között nem az "ARP proxy" módszerrel közvetítjük a csomagokat, akkor a legközelebbi alapértelmezett átjárókhoz minden bizonnyal fel kell vennünk statikus útvonalakat, így a SLIP kliensek alhálózatai a SLIP szerverünkön keresztül ki tudnak jutni.</p></div><div class=sect5><h6 id=_statikus_útvonalak>27.7.2.5.1. Statikus útvonalak<a class=anchor href=#_statikus_útvonalak></a></h6><div class=paragraph><p>A legközelebbi alapértelmezett átjárók felé nem minden esetben könnyû felvenni statikus útvonalakat (vagy egyes esetekben pedig egyenesen lehetetlen, mivel nincsenek meg hozzá a jogaink). Ha az intézményünkön belül több átjáró is megtalálható, akkor bizonyos útválasztók, például a Cisco és Proteon gyártmányúak esetében nem csak a SLIP alhálózatok felé kell beállítanunk statikus útvonalakat, hanem azt is meg kell mondanunk, hogy ezekrõl milyen más útválasztók is tudjanak. Pontosan emiatt a statikus útválasztás beüzemeléséhez szükségünk lesz egy kis utánajárásra és próbálgatásra.</p></div></div></div></div></div></div></div><div class=sect1><h2 id=mail>Chapter 28. Elektronikus levelezés<a class=anchor href=#mail></a></h2><div class=sectionbody><div class=sect2><h3 id=mail-synopsis>28.1. Áttekintés<a class=anchor href=#mail-synopsis></a></h3><div class=paragraph><p>Az "elektronikus levelezés", más néven e-mail, a kommunikáció egyik legjobban elterjedt formája. Ebben a fejezetben bemutatjuk, hogyan futtassunk FreeBSD-n levelezõ szervert, illetve hogyan küldjünk és fogadjunk e-maileket a FreeBSD használatával. Ez azonban semmiképpen sem tekinthetõ egy teljes referenciának és tulajdonképpen számos fontos tényezõrõl szót sem ejtünk. A témára úgy kaphatunk egy sokkal átfogóbb rálátást, ha a <a href=./#bibliography>Irodalomjegyzék</a>ben felsorolt remek könyveket is elolvassuk.</p></div><div class=paragraph><p>A fejezet elolvasása során megismerjük:</p></div><div class=ulist><ul><li><p>milyen szoftverkomponensek játszanak szerepet az elektronikus levelek küldésében és fogadásában;</p></li><li><p>FreeBSD-ben hol találhatóak a sendmail konfigurációs állományai;</p></li><li><p>mi a különbség a helyi és távoli postaládák között;</p></li><li><p>hogyan akadályozzuk meg, hogy a levelezõ szerverünk a kéretlen levélszemetet továbbítson;</p></li><li><p>rendszerünkön hogyan telepítsünk és állítsunk be más levelezõ szervereket a sendmail helyett;</p></li><li><p>hogyan oldjuk meg a levelezõ szerverekkel kapcsolatban felmerülõ általános problémákat;</p></li><li><p>hogyan használjuk az SMTP protokollt az UUCP protokollal;</p></li><li><p>hogyan kell rendszerüket csak levélküldésre beállítani;</p></li><li><p>hogyan levelezzünk betárcsázós kapcsolattal;</p></li><li><p>hogyan növeljük rendszerünk védelmét az SMTP hitelesítésének engedélyezésével;</p></li><li><p>hogyan telepítsünk és használjunk a levelek küldésére és fogadására például a mutthoz hasonló levelezõ klienseket;</p></li><li><p>hogyan töltsük le leveleinket egy távoli POP vagy IMAP szerverrõl;</p></li><li><p>hogyan alkalmazzunk automatikusan adott szabályokat vagy szûrõket az érkezõ levelekre.</p></li></ul></div><div class=paragraph><p>A fejezet elolvasása elõtt ajánlott:</p></div><div class=ulist><ul><li><p>az internet-csatlakozásunk megfelelõ beállítása (<a href=./#advanced-networking>Egyéb haladó hálózati témák</a>);</p></li><li><p>a névfeloldás beállítása (<a href=./#network-servers>Hálózati szerverek</a>);</p></li><li><p>a külsõ fejlesztésû alkalmazások telepítésének ismerete (<a href=./#ports>Alkalmazások telepítése. csomagok és portok</a>).</p></li></ul></div></div><div class=sect2><h3 id=mail-using>28.2. Az elektronikus levelezés használata<a class=anchor href=#mail-using></a></h3><div class=paragraph><p>Öt fontosabb részre bonthatjuk a levelezést. Ezek: <a href=#mail-mua>a felhasználói program (mail user agent)</a>, <a href=#mail-mta>a levélküldõ démon (mail transfer agent)</a>, <a href=#mail-dns>a névfeloldás</a>, <a href=#mail-receive>a helyi vagy távoli postaláda</a> és természetesen <a href=#mail-host>maga a levelezõ szerver (mail host)</a>.</p></div><div class=sect3><h4 id=mail-mua>28.2.1. A felhasználói program<a class=anchor href=#mail-mua></a></h4><div class=paragraph><p>Ide soroljuk a különbözõ parancssoros programokat, mint például a mutt, pine, elm és <code>mail</code>, valamint a különféle grafikus alkalmazásokat, mint például a balsa és az xfmail, csak hogy felsoroljuk néhány újabb, egy webböngészõhöz hasonlóan "kifinomult" eszközt is. Ezek a programok egyszerûen átküldik az elektronikus levelekkel kapcsolatos tranzakciókat a helyi <a href=#mail-host>"levelezõ szervernek"</a> vagy meghívják valamelyik <a href=#mail-mta>levélküldõ démont</a>, esetleg közvetlenül a TCP protokollon keresztül kézbesítenek.</p></div></div><div class=sect3><h4 id=mail-mta>28.2.2. A levélküldõ démon<a class=anchor href=#mail-mta></a></h4><div class=paragraph><p>A FreeBSD alapból a sendmail nevû programot ajánlja fel erre a célra, de támogat más levelezõ szervereket is, ezek közül meg is említünk néhányat ízelítõként:</p></div><div class=ulist><ul><li><p>exim</p></li><li><p>postfix</p></li><li><p>qmail</p></li></ul></div><div class=paragraph><p>Ez a démon általában két feladatot lát el - a beérkezõ levelek fogadásáért és a kimenõ levelek elküldéséért felelõs. <em>Nem</em> tartozik azonban a feladatai közé, hogy a POP vagy IMAP protokollokhoz hasonlóan olvashatóvá tegye a leveleinket, illetve csatlakozni engedjen a helyi <span class=filename>mbox</span> vagy Maildir formátumú postaládáinkhoz. Ezekhez a mûveletekhez egy külön <a href=#mail-receive>démon</a> szükségeltetik.</p></div><div class="admonitionblock warning"><table><tbody><tr><td class=icon><i class="fa icon-warning" title=Warning></i></td><td class=content><div class=paragraph><p>A sendmail régebbi változatai tartalmaznak olyan komoly biztonsági hibákat, amelyek kihasználásával az illetéktelen behatolók helyi és/vagy távoli hozzáférést tudnak szerezni a gépünkön. Az ilyen jellegû problémák elkerülése érdekében igyekezzünk mindig a legfrissebb verzióját használni. Vagy a <a href=./#ports>FreeBSD Portgyûjteményébõl</a> telepítsünk fel egy másik levélküldõ démont.</p></div></td></tr></tbody></table></div></div><div class=sect3><h4 id=mail-dns>28.2.3. Az elektronikus levelek és a névfeloldás<a class=anchor href=#mail-dns></a></h4><div class=paragraph><p>A névfeloldás (Domain Name System, DNS) és a hozzá tartozó <code>named</code> démon nagy szerepet játszik az elektronikus levelek továbbításában. A démon a leveleket úgy küldi át az egyik géprõl a másikra, hogy a névfeloldáson keresztül megkeresi azt a távoli gépet, amelynek a leveleket címezték. Ez a folyamat szintén végbemegy, amikor egy távoli géprõl levelet küldenek a mi szerverünkre.</p></div><div class=paragraph><p>A DNS valósítja meg a hálózati nevek és az IP-címek összerendelését valamint ez tárolja el a levélküldésre vonatkozó információkat is, amelyeket MX rekordoknak hívnak. Az MX (Mail eXchanger, "levélváltó") rekord adja meg azt a gépet vagy azokat a gépeket, amelyek az adott névtartományban fogadják a leveleket. Ha a hálózati nevünkhöz vagy tartományunkhoz nem tartozik MX rekord, akkor a levél közvetlenül a gépünkre vándorol feltéve, hogy rendelkezik olyan A rekorddal, amely összerendeli a gépünk nevét az IP-címével.</p></div><div class=paragraph><p>A <a href="https://man.freebsd.org/cgi/man.cgi?query=host&amp;sektion=1&amp;format=html">host(1)</a> parancs használatával az alábbi példához hasonlóan tetszõleges tartomány MX rekordját meg tudjuk nézni:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>% host <span class=nt>-t</span> mx
FreeBSD.org FreeBSD.org mail is handled <span class=o>(</span><span class=nv>pri</span><span class=o>=</span>10<span class=o>)</span> by
mx1.FreeBSD.org</code></pre></div></div></div><div class=sect3><h4 id=mail-receive>28.2.4. Az elektronikus levelek fogadása<a class=anchor href=#mail-receive></a></h4><div class=paragraph><p>A tartományunkhoz tartozó leveleket fogadását a levelezõ szerver végzi. Összegyûjti a tartományunkba küldött összes levelet és ezeket a beállításainktól függõen vagy <span class=filename>mbox</span> (a levelek tárolásának alapértelmezett módja) vagy pedig Maildir formátumban eltárolja. Ahogy eltárolt egy levelet, úgy helyben egybõl el is tudjuk olvasni például a <a href="https://man.freebsd.org/cgi/man.cgi?query=mail&amp;sektion=1&amp;format=html">mail(1)</a> vagy a mutt használatával, illetve távolról a POP vagy IMAP és a hasonló protokollokkal tudjuk elérni és begyûjteni. Ezért tehát ha csak a helyi gépen kívánjuk olvasni a leveleinket, akkor ahhoz egyáltalán nem kell POP vagy IMAP szervert telepítenünk.</p></div><div class=sect4><h5 id=pop-and-imap>28.2.4.1. Távoli postaládák elérése a POP és IMAP használatával<a class=anchor href=#pop-and-imap></a></h5><div class=paragraph><p>A távoli postaládák eléréséhez tudnunk kell csatlakozni egy POP vagy IMAP szerverhez. Ezeken a protokollokon keresztül tudják a felhasználók minden különösebb nehézség nélkül elérni távolról a helyi postaládáikat. Noha a POP és az IMAP segítségével egyaránt el tudjuk így érni a postaládákat, az IMAP használatának mégis több elõnye van, íme néhány közülük:</p></div><div class=ulist><ul><li><p>Az IMAP a levelek leszedése mellett tárolni is képes a távoli szerveren.</p></li><li><p>Az IMAP támogat párhuzamos lekéréseket.</p></li><li><p>Az IMAP hihetetlenül hasznos tud lenni lassabb összeköttetések esetében, mivel lehetõvé teszi a felhasználók számára, hogy csak az üzenetek vázát töltsék le és ne az egészet. Továbbá a szerver és a kliens közti adatmozgás csökkentése érdekében képes bizonyos feladatokat a szerveren elvégezni, például keresni.</p></li></ul></div><div class=paragraph><p>Egy POP vagy IMAP szerver telepítéséhez az alábbi lépések megtétele szükséges:</p></div><div class="exampleblock procedure"><div class=content><div class="olist arabic"><ol class=arabic><li><p>Válasszuk ki az igényeinket legjobban kielégítõ IMAP vagy POP szervert. A következõ POP és IMAP szerverek eléggé elterjedtek és egyben remek példák:</p><div class=ulist><ul><li><p>qpopper</p></li><li><p>teapop</p></li><li><p>imap-uw</p></li><li><p>courier-imap</p></li></ul></div></li><li><p>A Portgyûjteménybõl telepítsük fel a kiválasztott POP vagy IMAP démont.</p></li><li><p>Ha szükséges, akkor a POP vagy IMAP szerver betöltéséhez írjuk át az <span class=filename>/etc/inetd.conf</span> állományt.</p></li></ol></div></div></div><div class="admonitionblock warning"><table><tbody><tr><td class=icon><i class="fa icon-warning" title=Warning></i></td><td class=content><div class=paragraph><p>Meg kell említenünk, hogy mind a POP és az IMAP az összes információt, tehát belértve a felhasználók neveit és jelszavait titkosítatlan formában továbbítja. Ez azt jelenti, hogy ha ezeket a protokollokat biztonságos módon szeretnénk elérni, akkor az <a href="https://man.freebsd.org/cgi/man.cgi?query=ssh&amp;sektion=1&amp;format=html">ssh(1)</a> használatával hozzunk létre hozzá egy tunnelt és azon keresztül használjuk. Errõl részletesebben a <a href=./#security-ssh-tunneling>Tunnelezés SSH-val</a>ban olvashatunk.</p></div></td></tr></tbody></table></div></div><div class=sect4><h5 id=local>28.2.4.2. A helyi postaládák elérése<a class=anchor href=#local></a></h5><div class=paragraph><p>A helyi postaládákat a szerveren levõ levelezõ kliensek közvetlen használatával érhetjük el. Ilyen alkalmazások például a mutt vagy a <a href="https://man.freebsd.org/cgi/man.cgi?query=mail&amp;sektion=1&amp;format=html">mail(1)</a>.</p></div></div></div><div class=sect3><h4 id=mail-host>28.2.5. A levelezõ szerver<a class=anchor href=#mail-host></a></h4><div class=paragraph><p>A levelezõ szerver az a szerver, amely a gépünk vagy akár az egész hálózatunk irányába érkezõ levelek fogadásáért és elküldéséért felelõs.</p></div></div></div><div class=sect2><h3 id=sendmail>28.3. A sendmail beállítása<a class=anchor href=#sendmail></a></h3><div class=paragraph><p>A <a href="https://man.freebsd.org/cgi/man.cgi?query=sendmail&amp;sektion=8&amp;format=html">sendmail(8)</a> a FreeBSD alapértelmezett levéltovábbító ügynöke (Mail Transfer Agent, MTA). A sendmail feladata fogadni a levelezõ kliensektõl (Mail User Agent, MUA) érkezõ leveleket és kézbesíteni azokat a konfigurációs állományában megadott megfelelõ levelezõnek. A sendmail hálózati kapcsolatokat is fogad, képes a helyi postaládákba vagy akár más programoknak is leveleket továbbítani.</p></div><div class=paragraph><p>A sendmail a következõ állományban tárolja beállításait:</p></div><table class="tableblock frame-none grid-all stretch informaltable"><col style=width:50%><col style=width:50%><thead><tr><th class="tableblock halign-left valign-top">Állomány</th><th class="tableblock halign-left valign-top">Szerep</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class=tableblock><span class=filename>/etc/mail/access</span></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>A sendmail által engedélyezett hozzáféréseket tároló adatbázis</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><span class=filename>/etc/mail/aliases</span></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>A postaládák álnevei</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><span class=filename>/etc/mail/local-host-names</span></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Azon nevek felsorolása, amelyek számára a sendmail leveleket fogad</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><span class=filename>/etc/mail/mailer.conf</span></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>A levelezõ programok beállításai</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><span class=filename>/etc/mail/mailertable</span></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>A levelezõ programok kézbesítési táblázata</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><span class=filename>/etc/mail/sendmail.cf</span></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>A sendmail központi beállításait tároló állomány</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><span class=filename>/etc/mail/virtusertable</span></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Virtuális felhasználók és tartományok táblázatai</p></td></tr></tbody></table><div class=sect3><h4 id=_etcmailaccess>28.3.1. <span class=filename>/etc/mail/access</span><a class=anchor href=#_etcmailaccess></a></h4><div class=paragraph><p>Az engedélyezett hozzáféréseket tároló adatbázis tartalmazza milyen hálózati neveken vagy IP-címeken lehet elérni a helyi levelezõ szervert és azok milyen típusú hozzáférést kapnak. A gépek az <code>OK</code> (rendben), <code>REJECT</code> (visszautasít), <code>RELAY</code> (továbbítás) beállításokat alkalmazhatjuk, vagy egyszerûen meghívhatjuk hozzájuk a sendmail hibakezelõ rutinját egy adott kézbesítési hibával. Ha egy gépet az <code>OK</code> beállítással veszük fel a listára, ami egyébként alapértelmezés, akkor ez a gép levelet tud küldeni egészen addig, amíg a végsõ cél a helyi gép marad. A <code>REJECT</code> beállítással felsorolt gépek számára semmiféle levelezés nem engedélyezett. Ha pedig egy gép mellett a <code>RELAY</code> beállítás jelenik meg, akkor a szerveren keresztül tetszõleges címre küldhet.</p></div><div class=exampleblock><div class=title>Példa 30. A sendmail elérését szabályozó adatbázis beállítása</div><div class=content><div class="literalblock programlisting"><div class=content><pre>cyberspammer.com                550 Nem szeretjuk a spammereket
FREE.STEALTH.MAILER@            550 Nem szeretjuk a spammereket
another.source.of.spam          REJECT
okay.cyberspammer.com           OK
128.32                          RELAY</pre></div></div></div></div><div class=paragraph><p>Ebben a példában öt bejegyzést láthatunk. A táblázat bal felének valamelyik sorára illeszkedõ küldõkre a táblázatban a sor jobb felén megjelenõ cselekvés érvényesül. Az elsõ két sorban a sendmail hibakezelõ rutinjának adunk át hibakódokat. A hozzá tartozó üzenet akkor fog megjelenni a távoli gépen, amikor a tõle érkezõ levél illeszkedik a bal oldali szabályra. Az ezeket követõ bejegyzésben visszalökünk minden olyan levelet, amely az internetrõl egy adott számítógéptõl érkezik, például az <code>another.source.of.spam</code> címrõl. A következõ bejegyzésben az <code>okay.cyberspammer.com</code> címrõl elfogadjuk a kapcsolódást, ami viszont sokkal pontosabb megjelölés a fentebb szereplõ <code>cyberspammer.com</code> sornál. A pontosabban kifejtett nevek felülbírálják a kevésbé pontosan megnevezetteket. Végül az utolsó bejegyzésben engedélyezzük a levelek továbbküldését minden olyan gép számára, amelynek címe a <code>128.32</code> elõtaggal kezdõdik. Ezek tehát képesek ezen a levelezõ szerveren keresztül bárhova leveleket küldeni.</p></div><div class=paragraph><p>Az állomány módosítása után az adatbázis frissítéséhez mindig le kell futtatnunk egy <code>make</code> parancsot az <span class=filename>/etc/mail/</span> könyvtárban.</p></div></div><div class=sect3><h4 id=_etcmailaliases>28.3.2. <span class=filename>/etc/mail/aliases</span><a class=anchor href=#_etcmailaliases></a></h4><div class=paragraph><p>Az álneveket tartalmazó adatbázis virtuális postaládákat sorol fel, amelyek más felhasználókra, állományokra, programokra vagy további álnevekre vonatkozhatnak. Íme néhány példa az <span class=filename>/etc/mail/aliases</span> állományban szereplõ bejegyzésekre:</p></div><div class=exampleblock><div class=title>Példa 31. Virtuális postaládák</div><div class=content><div class="literalblock programlisting"><div class=content><pre>root: localuser
ftp-bugs: joe,eric,paul
bit.bucket:  /dev/null
procmail: &#34;|/usr/local/bin/procmail&#34;</pre></div></div></div></div><div class=paragraph><p>A formai szabályok egyszerûek: a kettõspont bal oldalára kell írni azt a postaládát, amely a jobb oldalán levõ célokra bomlik. A példa elsõ sorában egyszerûen megfeleltetjük a <code>root</code> postaládáját a <code>localuser</code> postaládájának, majd ezt a nevet keressük az álnevek adatbázisában. Ha nem találunk már rá illeszkedést, akkor az üzenetet a <code>localuser</code> nevû helyi felhasználónak továbbítjuk. A következõ sorban címek listáját láthatjuk. Ennek megfelelõen a <code>ftp-bugs</code> postaláda címére küldött levelek három további helyi postaládára mennek tovább: ezek név szerint a <code>joe</code>, <code>eric</code> és <code>paul</code> felhasználók postaládái. Itt a távoli postaládák <a href=mailto:felhasználó@példa.hu>felhasználó@példa.hu</a> alakban adhatóak meg. A következõ sor az állományok használatát példázza, ahol konkrétan a <span class=filename>/dev/null</span> állományba irányítjuk át az adott címre érkezõ leveleket. Az utolsó sorban pedig a programok használatára láthatunk példát, ahol ebben az esetben a levél egy UNIX®-os csövön keresztül a <span class=filename>/usr/local/bin/procmail</span> szabványos bemenetére kerül.</p></div><div class=paragraph><p>Ha megváltoztatjuk ezt az állományt, akkor utána az adatbázis frissítéséhez ne felejtsük el meghívni a <code>make</code> parancsot az <span class=filename>/etc/mail/</span> könyvtárban.</p></div></div><div class=sect3><h4 id=_etcmaillocal_host_names>28.3.3. <span class=filename>/etc/mail/local-host-names</span><a class=anchor href=#_etcmaillocal_host_names></a></h4><div class=paragraph><p>Ebben az állományban adhatjuk meg, hogy a <a href="https://man.freebsd.org/cgi/man.cgi?query=sendmail&amp;sektion=8&amp;format=html">sendmail(8)</a> milyen hálózati neveket fogadjon el helyi hálózati névként. Ide kell raknunk azokat a tartományokat vagy címeket, amelyektõl a sendmail leveleket fogad el. Például, ha a levelezõ szerver az <code>minta.com</code> tartományból és a <code>level.minta.com</code> címrõl fogad el leveleket, akkor a <span class=filename>local-host-names</span> valahogy így fog kinézni:</p></div><div class="literalblock programlisting"><div class=content><pre>minta.com
level.minta.com</pre></div></div><div class=paragraph><p>Az állomány módosításakor a <a href="https://man.freebsd.org/cgi/man.cgi?query=sendmail&amp;sektion=8&amp;format=html">sendmail(8)</a> programot újra kell indítani a változások érvényesítéséhez.</p></div></div><div class=sect3><h4 id=_etcmailsendmail_cf>28.3.4. <span class=filename>/etc/mail/sendmail.cf</span><a class=anchor href=#_etcmailsendmail_cf></a></h4><div class=paragraph><p>Ahogy a sendmail központi konfigurációs állománya, a <span class=filename>sendmail.cf</span> irányítja a sendmail átfogó viselkedését, beleértve mindent az e-mail címek átírásától kezdve a távoli szervereknek küldött elutasító üzenetek küldéséig. Mivel ennyire sokfajta szerepet tölt be egyszerre, ezért ez a konfigurációs állomány meglehetõsen összetett és a részletezése meghaladná ennek a leírásnak a határait. Szerencsére az átlagos levelezõ szerverek esetében ezt az állományt nagyon ritkán kell módosítani.</p></div><div class=paragraph><p>A sendmail központi konfigurációs állománya a sendmail lehetõségeit és viselkedését meghatározó <a href="https://man.freebsd.org/cgi/man.cgi?query=m4&amp;sektion=1&amp;format=html">m4(1)</a> makrókból építhetõ fel. A pontosabb részleteket a <span class=filename>/usr/src/contrib/sendmail/cf/README</span> állományban találjuk meg.</p></div><div class=paragraph><p>Az állomány megváltoztatása után a módosítások érvényesítéséhez újra kell indítani a sendmail programot.</p></div></div><div class=sect3><h4 id=_etcmailvirtusertable>28.3.5. <span class=filename>/etc/mail/virtusertable</span><a class=anchor href=#_etcmailvirtusertable></a></h4><div class=paragraph><p>A <span class=filename>virtusertable</span> állomány képezi le a virtuális tartományokhoz tartozó címeket valódi postaládák címeire. Ezek a postaládák lehetnek helyiek, távoliak, az <span class=filename>/etc/mail/aliases</span> állományban megadott álnevek vagy állományok.</p></div><div class=exampleblock><div class=title>Példa 32. Példa a virtuális tartományok leképezésére</div><div class=content><div class="literalblock programlisting"><div class=content><pre>root@minta.com                root
postmaster@minta.com          postmaster@noc.minta.net
@minta.com                    joe</pre></div></div></div></div><div class=paragraph><p>A fenti példában megadtunk egy leképezést a <code>minta.com</code> tartományhoz. Ez az állomány úgy dolgozódik fel, hogy fentrõl lefelé illesztõdnek a címek, egészen az elsõ egyezésig. Az elsõ bejegyzés szerint a <a href=mailto:root@minta.com>root@minta.com</a> a helyi <code>root</code> felhasználó postaládájára képzõdik le. A következõ bejegyzés szerint a <a href=mailto:postmaster@minta.com>postmaster@minta.com</a> a <code>noc.minta.net</code> címen található <code>postmaster</code> nevû felhasználó postaládájára képzõdik le. Végezetül, ha a <code>minta.com</code> címrõl eddig még semmi sem illeszkedett volna, akkor az utolsó leképezés veszi át, amely az <code>minta.com</code> tartományon belül az összes többi címre küldött levelet a helyi <code>joe</code> nevû felhasználó postaládájára képezi le.</p></div></div></div><div class=sect2><h3 id=mail-changingmta>28.4. A levéltovábbító ügynök megváltoztatása<a class=anchor href=#mail-changingmta></a></h3><div class=paragraph><p>Ahogy arról már korábban szó esett, a FreeBSD alapból tartalmazza a sendmail programot mint levéltovábbító ügynököt (MTA, Mail Transfer Agent). Ennélfogva alapértelmezés szerint ez a felelõs a kimenõ és beérkezõ levelek kezeléséért.</p></div><div class=paragraph><p>Számtalan okból eredõen egyes rendszergazdák azonban mégis szeretnék lecserélni a rendszerükhöz tartozó levéltovábbítót. Ennek oka lehet egyszerûen csak annyi, hogy ki akarunk próbálni egy másik programot vagy éppen egy olyan eszközre van szükségünk, amely kizárólag csak máshol található meg. Szerencsére a FreeBSD megkönnyíti ezt a váltást.</p></div><div class=sect3><h4 id=_az_új_levéltovábbító_telepítése>28.4.1. Az új levéltovábbító telepítése<a class=anchor href=#_az_új_levéltovábbító_telepítése></a></h4><div class=paragraph><p>A levéltovábbítók széles köre elérhetõ. A <a href=./#ports>FreeBSD Portgyûjteményébõl</a> elindulva sok ilyen programot találhatunk. Természetesen teljesen mindegy, hogy melyik levéltovábbítót választjuk egészen addig, amíg képesek vagyunk FreeBSD alatt rendesen futtatni.</p></div><div class=paragraph><p>Kezdjük tehát az új levéltovábbító telepítésével. Miután sikerült telepíteni, lehetõségünk van eldönteni, hogy valóban eleget tesz-e az igényeinknek, sõt az új szoftvert még az elõtt be tudjuk állítani, hogy átvenné a sendmail helyét. Vigyázzunk azonban, hogy az új szoftver telepítésekor ne írjon felül olyan rendszerszintû binárisokat, mint például a <span class=filename>/usr/bin/sendmail</span>. Másrészt az új levelezõ szoftvert szolgálatba helyezése elõtt mindenképpen fontos megfelelõen beállítanunk.</p></div><div class=paragraph><p>A kiválasztott levéltovábbító beállításával kapcsolatban olvassuk el a hozzá tartozó dokumentációt.</p></div></div><div class=sect3><h4 id=mail-disable-sendmail>28.4.2. A sendmail letiltása<a class=anchor href=#mail-disable-sendmail></a></h4><div class="admonitionblock warning"><table><tbody><tr><td class=icon><i class="fa icon-warning" title=Warning></i></td><td class=content><div class=paragraph><p>Amikor letiltjuk a sendmail kimenõ levél szolgáltatását, soha ne felejtsük el pótolni valamilyen más levelezõ rendszerrel. Ha nem így cselekszünk, akkor például a <a href="https://man.freebsd.org/cgi/man.cgi?query=periodic&amp;sektion=8&amp;format=html">periodic(8)</a> és a hozzá hasonló programok nem lesznek képesek a tõlük megszokott módon e-mailben elküldeni a futásuk eredményét. A rendszer bizonyos részei ráadásul egy mûködõ, sendmail-kompatibilis rendszert feltételeznek. Ha letiltása után az alkalmazások továbbra is a sendmail segítségével próbálnak levelet küldeni, akkor ez a levél a sendmail inaktív sorába kerülhet, ahonnan soha nem kerül kézbesítésre.</p></div></td></tr></tbody></table></div><div class=paragraph><p>A sendmail teljes leállításához, beleértve a kimenõ levelekhez tartozó szolgáltatást is, a következõket kell megadni az <span class=filename>/etc/rc.conf</span> állományban:</p></div><div class="literalblock programlisting"><div class=content><pre>sendmail_enable=&#34;NO&#34;
sendmail_submit_enable=&#34;NO&#34;
sendmail_outbound_enable=&#34;NO&#34;
sendmail_msp_queue_enable=&#34;NO&#34;</pre></div></div><div class=paragraph><p>Ha csak a sendmail beérkezõ levelekre vonatkozó szolgáltatását akarjuk tiltani, akkor ahhoz az <span class=filename>/etc/rc.conf</span> állományban a következõt állítsuk be:</p></div><div class="literalblock programlisting"><div class=content><pre>sendmail_enable=&#34;NO&#34;</pre></div></div><div class=paragraph><p>A sendmail indításával kapcsolatos további beállításokat az <a href="https://man.freebsd.org/cgi/man.cgi?query=rc.sendmail&amp;sektion=8&amp;format=html">rc.sendmail(8)</a> man oldalon találjuk.</p></div></div><div class=sect3><h4 id=_az_új_levéltovábbító_elindítása_a_rendszerrel_együtt>28.4.3. Az új levéltovábbító elindítása a rendszerrel együtt<a class=anchor href=#_az_új_levéltovábbító_elindítása_a_rendszerrel_együtt></a></h4><div class=paragraph><p>Az új levéltovábbítót úgy tudjuk elindítani a rendszerrel együtt, ha az <span class=filename>/etc/rc.conf</span> állományba felvesszük a következõ sort, például a postfix esetében:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># echo &#39;postfix_enable=&#34;YES&#34;&#39; &gt;&gt; /etc/rc.conf</span></code></pre></div></div><div class=paragraph><p>Az új levéltovábbító így most már magától el fog indulni a rendszer indításakor.</p></div></div><div class=sect3><h4 id=_a_sendmail_mint_a_rendszer_alapértelmezett_levelezõ_eszközének_lecserélése>28.4.4. A sendmail mint a rendszer alapértelmezett levelezõ eszközének lecserélése<a class=anchor href=#_a_sendmail_mint_a_rendszer_alapértelmezett_levelezõ_eszközének_lecserélése></a></h4><div class=paragraph><p>A sendmail annyira elterjedt szabványos szoftver a UNIX® rendszereken, hogy egyes szoftverek egyszerûen feltételezik a jelenlétét. Emiatt sok levéltovábbítóhoz tartozik egy sendmail kompatibilis parancssoros felület is, amellyel igyekeznek megkönnyíteni a sendmail"gyors" lecserélését.</p></div><div class=paragraph><p>Ennek következtében tehát, ha egy másik levelezõ eszközt használunk, akkor valamilyen módon meg kell bizonyosodnunk róla, hogy a szabványos sendmail binárisok, mint például a <span class=filename>/usr/bin/sendmail</span>, valóban a kiválasztott levéltovábbítot fogják aktiválni. Szerencsére a FreeBSD pontosan emiatt tartalmaz egy <a href="https://man.freebsd.org/cgi/man.cgi?query=mailwrapper&amp;sektion=8&amp;format=html">mailwrapper(8)</a> nevû rendszert.</p></div><div class=paragraph><p>Amikor a sendmail telepítése szerint mûködik, valami hasonlót fogunk találni az <span class=filename>/etc/mail/mailer.conf</span> állományban:</p></div><div class="literalblock programlisting"><div class=content><pre>sendmail	/usr/libexec/sendmail/sendmail
send-mail	/usr/libexec/sendmail/sendmail
mailq		/usr/libexec/sendmail/sendmail
newaliases	/usr/libexec/sendmail/sendmail
hoststat	/usr/libexec/sendmail/sendmail
purgestat	/usr/libexec/sendmail/sendmail</pre></div></div><div class=paragraph><p>Ez azt jelenti, hogy amikor az itt felsorolt általános parancsok közül lefuttatjuk valamelyiket (például magát a <span class=filename>sendmail</span> parancsot), akkor a rendszer magától meghívja a <span class=filename>sendmail</span> néven szereplõ wrapper programot, amely pedig a <span class=filename>mailer.conf</span> alapján kideríti, hogy az adott esetben a <span class=filename>/usr/libexec/sendmail/sendmail</span> hívására van szükség. Ez a rendszer megkönnyíti az alapértelmezett <span class=filename>sendmail</span> funkciók helyében lefuttatandó binárisok átállítását.</p></div><div class=paragraph><p>Így tehát, ha a <span class=filename>/usr/local/supermailer/bin/sendmail-compat</span> állományt akarjuk futtatni a megszokott sendmail helyében, akkor az <span class=filename>/etc/mail/mailer.conf</span> állományt a következõképpen kell módosítanunk:</p></div><div class="literalblock programlisting"><div class=content><pre>sendmail	/usr/local/kedvenclevelezõ/bin/sendmail-compat
send-mail	/usr/local/kedvenclevelezõ/bin/sendmail-compat
mailq		/usr/local/kedvenclevelezõ/bin/mailq-compat
newaliases	/usr/local/kedvenclevelezõ/bin/newaliases-compat
hoststat	/usr/local/kedvenclevelezõ/bin/hoststat-compat
purgestat	/usr/local/kedvenclevelezõ/bin/purgestat-compat</pre></div></div></div><div class=sect3><h4 id=_a_mûvelet_befejezése>28.4.5. A mûvelet befejezése<a class=anchor href=#_a_mûvelet_befejezése></a></h4><div class=paragraph><p>Ahogy a céljainknak megfelelõen mindent beállítottunk, akkor vagy egyszerûen leállítjuk a sendmail neve alatt futó programokat és helyettük elindítjuk az új szoftverhez tartozókat, vagy csak újraindítjuk a gépet. Az újraindítással mellesleg ellenõrizhetjük azt is, hogy jól állítottuk be a rendszerünket és az új levélküldõ tényleg elindul a rendszerünkkel együtt.</p></div></div></div><div class=sect2><h3 id=mail-trouble>28.5. A hibák elhárítása<a class=anchor href=#mail-trouble></a></h3><div class=sect3><h4 id=_miért_kell_teljes_hálózati_neveket_megadni_a_gépemen>28.5.1. Miért kell teljes hálózati neveket megadni a gépemen?<a class=anchor href=#_miért_kell_teljes_hálózati_neveket_megadni_a_gépemen></a></h4><div class=paragraph><p>Elõfordulhat, hogy a hivatkozni kívánt gép valójában egy másik tartományban szerepel. Például, ha az <code>ize.mize.edu</code> gépen vagyunk és a <code>vagyis</code> nevû gépet akarjunk innen elérni a <code>mize.edu</code> tartományban, akkor a teljes hálózati nevével, vagyis a <code>vagyis.mize.edu</code> néven kell rá hivatkoznunk, nem pedig egyszerûen csak <code>vagyis</code> néven.</p></div><div class=paragraph><p>Régebben egyébként ezt a BSD-típusú BIND névfeloldók megengedték. A FreeBSD jelenlegi változatai azonban már olyan BIND verziót tartalmaznak, amelyek alapértelmezés szerint már nem engedik a tartományunkon kívüli relatív nevek használatát. Tehát a <code>vagyis</code> vagy a <code>vagyis.ize.mize.edu</code> gép lesz, vagy a legfelsõ, gyökér tartományban keresi a rendszer.</p></div><div class=paragraph><p>Ez eltér a korábbi viselkedéstõl, ahol a keresés folytatódott a <code>vagyis.mize.edu</code> és <code>vagyis.edu</code> tartományokban is. Az RFC 1535 elolvasásából ki fog derülni, hogy miért nem vált be ez a gyakorlat és hogy miért tekinthetõ még akár biztonsági résnek is.</p></div><div class=paragraph><p>Ezt a problémát egyébként megoldhatjuk annyival, hogy az <span class=filename>/etc/resolv.conf</span> állományba a</p></div><div class="literalblock programlisting"><div class=content><pre>search ize.mize.edu mize.edu</pre></div></div><div class=paragraph><p>sor helyett a</p></div><div class="literalblock programlisting"><div class=content><pre>domain ize.mize.edu</pre></div></div><div class=paragraph><p>sort írjuk be. Arra viszont ügyeljünk, hogy a keresési rend ne lépje át a "helyi és nyilvános adminisztráció között meghúzódó határt", ahogy azt az RFC 1535 nevezi.</p></div></div><div class=sect3><h4 id=_a_sendmail_szerint_a_levél_a_saját_farkába_harap>28.5.2. A sendmail szerint a levél a saját farkába harap<a class=anchor href=#_a_sendmail_szerint_a_levél_a_saját_farkába_harap></a></h4><div class=paragraph><p>Ezt a sendmail gyakran ismértelt kérdései között a következõképpen válaszolták meg:</p></div><div class="literalblock programlisting"><div class=content><pre>A következõ hibaüzenetet kapom:

553 MX list for taromány.net points back to felé.tartomány.net
554 felhasználó@tartomány.net... Local configuration error

Hogyan oldható meg ez a probléma?

Azt kértük, hogy a tartományba (például tartomány.net) küldött levél
az MXMX rekord rekord felhasználásával egy adott gépre legyen átirányítva
(ebben az esetben ez a felé.tartomány.net), de a továbbítást végzõ gép
nem ismeri fel magát a tartomány.net címen. Vegyük fel a tartomány.net
tartományt az /etc/mail/local-host-names állományba [melyet a 8.10 elõtti
verziókban /etc/sendmail.cw állománynak hívnak] (ha a
FEATURE(use_cw_file) beállítást használjuk) vagy tegyük hozzá a
Cw tartomány.net sort az /etc/mail/sendmail.cf
állományhoz.</pre></div></div><div class=paragraph><p>A sendmail GYIK a <a href=http://www.sendmail.org/faq/>http://www.sendmail.org/faq/</a> címen található meg (angolul) és mindenképpen javasolt elolvasni, ha "fel szeretnénk piszkálni" a levelezõ rendszerünk beállításait.</p></div></div><div class=sect3><h4 id=_hogyan_tudok_levelezõ_szervert_futtatni_egy_betárcsázós_ppp_kapcsolat_esetében>28.5.3. Hogyan tudok levelezõ szervert futtatni egy betárcsázós PPP kapcsolat esetében?<a class=anchor href=#_hogyan_tudok_levelezõ_szervert_futtatni_egy_betárcsázós_ppp_kapcsolat_esetében></a></h4><div class=paragraph><p>Egy helyi hálózaton levõ FreeBSD-s gépet akarunk tehát az internethez kapcsolni. Ez a FreeBSD-s gép lesz a helyi hálózat leveleket továbbító átjárója. A PPP kapcsolat nem dedikált.</p></div><div class=paragraph><p>Legalább két módon meg tudjuk oldani. Az egyik módszer szerint az UUCP használatára lesz szükségünk.</p></div><div class=paragraph><p>A másik módszer szerint szereznünk kell egy éjjel-nappal üzemelõ internetes szervert, amely majd szolgáltatja a másodlagos MX rekordot a tartományunkhoz. Például, ha a cégünk tartománya a <code><em>cég.hu</em></code> és az internet-szolgáltatónk a <code><em>szolgáltató.net</em></code> névre beállította a tartományunkhoz a másodlagos MX rekordokat:</p></div><div class="literalblock programlisting"><div class=content><pre>cég.hu.          MX        10      cég.hu.
                 MX        20      szolgáltató.net.</pre></div></div><div class=paragraph><p>Végsõ címzettként csak egy gépet kell megadni (az <span class=filename>/etc/mail/sendmail.cf</span> állományba a <code><em>cég.hu</em></code> címhez tegyük hozzá a <code>Cw cég.hu</code> sort).</p></div><div class=paragraph><p>Amikor a leveleket küldeni akaró <code>sendmail</code> megpróbál kézbesíteni, elõször hozzánk (<code><em>cég.hu</em></code>) próbál csatlakozni a modemes összeköttetésen keresztül. Ez valószínûleg idõtúllépéssel befejezõdik, mivel nem vagyunk fenn minden pillanatban a neten. A sendmail ekkor automatikusan a másodlagos MX rekord által megadott címre küldi a levelet, tehát a szolgáltatónkhoz (<code><em>szolgáltató.net</em></code>). Ez a másodlagos MX cím próbálja majd idõlegesen elérni a gépünket és kézbesíteni a leveleket az elsõdleges MX rekord által megadott gépre (<code><em>cég.hu</em></code>).</p></div><div class=paragraph><p>A bejelentkezéskor ezért egy hasonló szkriptet kell lefuttatnunk:</p></div><div class="literalblock programlisting"><div class=content><pre>#!/bin/sh
# Tegyük a /usr/local/bin/pppmyisp állományba:
( sleep 60 ; /usr/sbin/sendmail -q ) &amp;
/usr/sbin/ppp -direct pppmyisp</pre></div></div><div class=paragraph><p>Ha készítünk egy külön bejelentkezõ szkriptet a felhasználók számára, akkor a <code>sendmail -qRcég.hu</code> parancsot is használhatjuk a fenti szkript helyett. Ezzel a <code><em>cég.hu</em></code> sorában található összes levél azonnal feldolgozásra kerül.</p></div><div class=paragraph><p>A helyzetet így lehetne még jobban pontosítani:</p></div><div class=paragraph><p>Az alábbi üzenet a <a href=https://lists.FreeBSD.org/subscription/freebsd-isp>FreeBSD Internet service provider’s levelezési lista</a> archívumából származik.</p></div><div class="literalblock programlisting"><div class=content><pre>&gt; we provide the secondary MX for a customer. The customer connects to
&gt; our services several times a day automatically to get the mails to
&gt; his primary MX (We do not call his site when a mail for his domains
&gt; arrived). Our sendmail sends the mailqueue every 30 minutes. At the
&gt; moment he has to stay 30 minutes online to be sure that all mail is
&gt; gone to the primary MX.
&gt;
&gt; Is there a command that would initiate sendmail to send all the mails
&gt; now? The user has not root-privileges on our machine of course.

In the privacy flags section of sendmail.cf, there is a
definition Opgoaway,restrictqrun

Remove restrictqrun to allow non-root users to start the queue processing.
You might also like to rearrange the MXs. We are the 1st MX for our
customers like this, and we have defined:

# If we are the best MX for a host, try directly instead of generating
# local config error.
OwTrue

That way a remote site will deliver straight to you, without trying
the customer connection.  You then send to your customer.  Only works for
hosts, so you need to get your customer to name their mail
machine customer.com as well as
hostname.customer.com in the DNS.  Just put an A record in
the DNS for customer.com.</pre></div></div><div class=paragraph><p>Az idézet fordítása:</p></div><div class="literalblock programlisting"><div class=content><pre>&gt; Másodlagos MX rekordot biztosítunk az ügyfeleinknek.  Az ügyfelek ezután automatikusan
&gt; csatlakoznak naponta akár többször is a szolgáltatásunkhoz és leszedik az elsõdleges MX
&gt; rekordhoz tartozó leveleket.  (Nem szólunk neki, amikor a tartományához levél
&gt; érkezik.) A sendmail programunk minden 30 percben elküldi a sorban felhalmozódott
&gt; leveleket.  Tehát jelen pillanatban legalább 30 percig fenn kell lennie az ügyfélnek, hogy
&gt; rendben megkapja az elsõdlegesre MX rekordra.
&gt;
&gt; Létezik valamilyen parancs a sendmail programhoz, amellyel azonnal lekérhetjük az összes
&gt; levelünket?  A felhasználómnak természetesen nincsenek rendszergazdai jogosultságai az adott
&gt; gépen.

A sendmail.cf privacy flags beállításai között van egy definíció, az
Opgoaway,restrictqrun.

Vegyük ki innen a restrictqrun beállítást, amivel a nem root felhasználók is megindíthatják a
sor feldolgozását.  Valószínûleg az MX-ek átrendezésére is szükség lesz.  Mi vagyunk az elsõ MX
az ilyen típusú ügyfelek számára, és ezt adtuk meg:

# Ha mi vagyunk a legjobb MX a levél számára, akkor ne generáljunk
# helyi beállítási hibát, hanem próbálkozzunk közvetlenül.
OwTrue

Ezzel már a távoli gép közvetlenül nekünk küld anélkül, hogy próbálkozna az ügyfél kapcsolatával.
Ezt majd továbbküldjünk az ügyfélnek.  Ez csak hálózati nevek esetében mûködik, tehát az ügyfelünknek
el kell neveznie a leveleket fogadó gépét customer.com-nak, valamint a fel kell venni a
hostname.customer.com címet is a DNS-be.  Ehhez egyszerûen csak elegendõ egy A rekordot
betenni a customer.com-hoz.</pre></div></div></div><div class=sect3><h4 id=_miért_kapok_folyton_relaying_denied_hibát_amikor_más_gépekrõl_küldök_levelet>28.5.4. Miért kapok folyton Relaying Denied hibát, amikor más gépekrõl küldök levelet?<a class=anchor href=#_miért_kapok_folyton_relaying_denied_hibát_amikor_más_gépekrõl_küldök_levelet></a></h4><div class=paragraph><p>A FreeBSD alapértelmezett telepítése során a sendmail úgy állítódik be, hogy csak arról a géprõl küldhetünk vele levelet, ahol fut. Például, ha POP szerver is elérhetõ, akkor a felhasználók meg tudják nézni a leveleiket az iskolából, munkából vagy bármilyen más távoli helyrõl, de leveleket onnan továbbra sem tudnak küldeni. Általában pár pillanattal a próbálkozás után a MAILER-DAEMON küldeni fog egy <code>5.7 Relaying Denied</code> (<code>5.7 A továbbítás nem engedélyezett</code>) üzenetet.</p></div><div class=paragraph><p>Több lehetõségünk is van ennek megkerülésére. Az a legegyszerûbb módszer, ha az internet-szolgáltatónk címét felvesszük az <span class=filename>/etc/mail/relay-domains</span> állományba. Például így:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># echo &#34;az.internet.szolgáltató.net&#34; &gt; /etc/mail/relay-domains</span></code></pre></div></div><div class=paragraph><p>Az állomány létrehozása vagy módosítása után újra kell indítanunk a sendmail programot. Ez remekül mûködik abban az esetben, ha rendszergazdák vagyunk és nem akarunk a helyi géprõl levelet küldeni, vagy egy másik gépen vagy akár másik internet-szolgáltatóval akarunk valamilyen kattingatós levelezõ programot használni. Olyankor is nagyon hasznos lehet, amikor csak egy vagy két e-mail hozzáférést állítottunk be. Ha egyszerre több címet is fel szeretnénk venni, akkor nyissuk meg ezt az állományt a kedvenc szövegszerkesztõnkkel és írjuk be a tartományokat, soronként egyet:</p></div><div class="literalblock programlisting"><div class=content><pre>saját.internet.szolgáltató.net
másik.internet.szolgáltató.com
felhasználók-internet.szolgáltató.ja
www.minta.org</pre></div></div><div class=paragraph><p>Innentõl kezdve a listában szereplõ bármelyik géprõl tudunk levelet küldeni (feltéve, hogy az adott felhasználó hozzáfér a gépünkhöz). Ezzel gyönyörûen megoldhatjuk, hogy a felhasználóink képesek legyenek távolról is levelet küldeni a rendszerünkön keresztül anélkül, hogy mások pedig szemetet küldenének át rajtunk.</p></div></div></div><div class=sect2><h3 id=mail-advanced>28.6. Komolyabb témák<a class=anchor href=#mail-advanced></a></h3><div class=paragraph><p>A következõ szakaszban szóba kerülnek olyan komolyabb témák, mint például a levelek konfigurációja és a levelezés beállítása az egész tartomány számára.</p></div><div class=sect3><h4 id=mail-config>28.6.1. Alapvetõ beállítások<a class=anchor href=#mail-config></a></h4><div class=paragraph><p>Alapból képesnek kell lennünk leveleket küldeni külsõ gépekre egészen addig, amíg az <span class=filename>/etc/resolv.conf</span> állomány a megfelelõ beállításokat tartalmazza vagy egy saját névszervert futtatunk. Ha szeretnénk, hogy a gépünkre érkezõ levelek elérjék a FreeBSD-s gépünkön futó levéltovábbító ügynököt (például a sendmail programot), akkor erre két módszer kínálkozik:</p></div><div class=ulist><ul><li><p>Futtassunk saját névszervert és hozzunk létre magunknak egy tartományt. Például <code>FreeBSD.org</code>.</p></li><li><p>Közvetlenül a gépünkre küldessük a leveleket. Ezt úgy tehetjük meg, ha egybõl a gépünkhöz tartozó DNS névre küldetjük a leveleket. Például az <code>enyem.FreeBSD.org</code> címre.</p></li></ul></div><div class=paragraph><p>Függetlenül attól, hogy a fentiek közül melyik megoldást választjuk, a levelek csak akkor tudnak eljutni közvetlenül a gépünkre, ha állandó, statikus IP-címmel rendelkezünk (tehát nem dinamikus címmel, amit általában a betárcsázós PPP kapcsolatokhoz szoktak kiosztani). Ha tûzfal mögött vagyunk, akkor valamilyen módon felénk kell irányítani az SMTP forgalmat is. Ha közvetlenül a gépünkön akarjuk fogadni a leveleket, akkor a következõ kettõ közül az egyik mindenképpen kelleni fog:</p></div><div class=ulist><ul><li><p>Gondoskodjunk róla, hogy a hozzánk tartozó DNS-ben (legkisebb sorszámú) MX rekord a gépünk IP-címére mutat.</p></li><li><p>Gondoskodjunk róla, hogy a hozzánk tartozó DNS-ben nincs semmilyen MX rekord a gépünkhöz.</p></li></ul></div><div class=paragraph><p>A fentiek közül bármelyik elég ahhoz, hogy közvetlenül a gépünkre érkezzen meg a levél.</p></div><div class=paragraph><p>Próbáljuk ki:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># hostname</span>
enyem.FreeBSD.org
<span class=c># host enyem.FreeBSD.org</span>
enyem.FreeBSD.org has address 204.216.27.XX</code></pre></div></div><div class=paragraph><p>Ha ezt látjuk, akkor minden gond nélkül lehet küldeni levelet a <a href=mailto:nevem@enyem.FreeBSD.org>nevem@enyem.FreeBSD.org</a> a címre (feltételezve, hogy a sendmail megfelelõen mûködik az <code>enyem.FreeBSD.org</code> címen).</p></div><div class=paragraph><p>Ha viszont ehhez hasonlót tapasztalunk:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># host enyem.FreeBSD.org</span>
enyem.FreeBSD.org has address 204.216.27.XX
enyem.FreeBSD.org mail is handled <span class=o>(</span><span class=nv>pri</span><span class=o>=</span>10<span class=o>)</span> by kozpont.FreeBSD.org</code></pre></div></div><div class=paragraph><p>A gépünkre (<code>enyem.FreeBSD.org</code>) küldött összes levelet a <code>kozpont</code> szedi össze ugyanazon felhasználói névvel ahelyett, hogy közvetlenül a gépünkre küldeni ezeket.</p></div><div class=paragraph><p>Az iménti adatokat a DNS szerver határozza meg. A levelek továbbításával kapcsolatos információkat az <em>MX</em> mint <em>M</em>ail e<em>X</em>change DNS-rekord tárolja. Ha nincs ilyen MX rekord, akkor az IP-cím alapján közvetlenül az adott géphez kerül a levél.</p></div><div class=paragraph><p>Például a <code>freefall.FreeBSD.org</code> MX rekordja hajdanán így nézett ki:</p></div><div class="literalblock programlisting"><div class=content><pre>freefall		MX	30	mail.crl.net
freefall		MX	40	agora.rdrop.com
freefall		MX	10	freefall.FreeBSD.org
freefall		MX	20	who.cdrom.com</pre></div></div><div class=paragraph><p>Láthatjuk, hogy a <code>freefall</code> esetében több MX bejegyzés is szerepel. A legalacsonyabb MX-számú gép fogja kapni az erre a címre beérkezõ leveleket, amennyiben elérhetõ. Ha valamilyen okból nem érhetõ el, akkor helyette ideiglenesen a többiek (melyeket néha csak "tartalék MX-eknek" neveznek) veszik át a levelet és átadják a legalacsonyabb számúnak, amint az újra elérhetõvé válik.</p></div><div class=paragraph><p>A tartalék jelleggel megadott MX gépek akkor érnek ténylegesen valamit, ha teljesen máshonnan csatlakoznak az internethez. Az internet szolgáltató vagy egy ismerõsünk gépe valószínûleg minden további nélkül segít ennek megoldásában.</p></div></div><div class=sect3><h4 id=mail-domain>28.6.2. Egy egész tartomány leveleinek kezelése<a class=anchor href=#mail-domain></a></h4><div class=paragraph><p>Egy levelezõ szerver beállításához valahogy meg kell tudnunk oldalni, hogy a különbözõ munkaállomásokra küldött levelek közvetlenül hozzá fussanak be. Alapvetõen tehát arról lenne szó, hogy a tartományunkon (ez ebben az esetben a <code>*.FreeBSD.org</code>) belüli gépekre címzett levelekre ez a gép "tart igényt" és így ezek ide irányítódnak át, majd a felhasználók errõl a központi levelezõ szerverrõl kapják meg a leveleiket.</p></div><div class=paragraph><p>Az életünk megkönnyítéséhez minden felhasználónak létrehozzuk a saját <em>felhasználói nevét</em> a levelezõ szerveren is. Ezt az <a href="https://man.freebsd.org/cgi/man.cgi?query=adduser&amp;sektion=8&amp;format=html">adduser(8)</a> paranccsal gyorsan el is végezhetjük.</p></div><div class=paragraph><p>A levelezõ szerver lesz a hálózat összes munkaállomásához kirendelt levélváltó. Ezt a DNS beállításai között így adhatjuk meg:</p></div><div class="literalblock programlisting"><div class=content><pre>enyem.FreeBSD.org	A	204.216.27.XX		; Munkaállomás
			MX	10 kozpont.FreeBSD.org	; Levelezõ szerver</pre></div></div><div class=paragraph><p>Ezzel lényegében az A rekord figyelmen kívül hagyásával átirányítjuk a munkaállomások számára érkezõ összes levelet a levelezõ szerverre. A levelek tehát az MX rekord által mutatott címre mennek ki.</p></div><div class=paragraph><p>Ezt önállóan nem tudjuk elvégezni, hacsak nem futattunk egy saját DNS szervert. Ha nincsen vagy nem is tudunk DNS szervert futtatni, akkor ebben a kérdésben egyeztessünk az internet-szolgáltatónkkal vagy bárkivel, aki a DNS beállításaiért felelõs.</p></div><div class=paragraph><p>Ha virtuális e-mail címket is kezelünk, akkor a most következõ információ még a hasznunkra lehet. A példa kedvéért most feltesszük, hogy a tartományunkban van egy ügyfelünk, jelen esetben az <code>ugyfel1.org</code>, és azt akarjuk, hogy az <code>ugyfel1.org</code> címére küldött levelek a saját levelezõ szerverünkre kerüljenek át, a <code>level.sajat.com</code> címre. A DNS-t ehhez így kell beállítani:</p></div><div class="literalblock programlisting"><div class=content><pre>ugyfel1.org		MX	10	level.sajat.com</pre></div></div><div class=paragraph><p>Ha csak az <code>ugyfel1.org</code> levelezését akarjuk kezelni, akkor ahhoz <em>nem</em> kell külön A rekord.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Vigyázzunk, mert az <code>ugyfel1.org</code> csak akkor pingelhetõ, ha létezik hozzá A rekord.</p></div></td></tr></tbody></table></div><div class=paragraph><p>Befejezésül a levelezõ szerverünkön futó sendmail számára is fel kell tárnunk, hogy milyen tartományokhoz és/vagy hálózati nevekhez fogadjon leveleket. Ezt több módon is elvégezhetjük. A következõk bármelyik megfelel erre a célra:</p></div><div class=ulist><ul><li><p>A <code>FEATURE(use_cw_file)</code> használata esetén vegyük fel a címeket az <span class=filename>/etc/mail/local-host-names</span> állományba. Ha a sendmail 8.10 elõtti változatai esetében ehhez az <span class=filename>/etc/sendmail.cw</span> állományra lesz szükségünk.</p></li><li><p>Tegyük be a <code>Cwsajat.cimunk.com</code> sort az <span class=filename>/etc/sendmail.cf</span> vagy a sendmail 8.10 és késõbbi változatai esetén az <span class=filename>/etc/mail/sendmail.cf</span> állományba.</p></li></ul></div></div></div><div class=sect2><h3 id=SMTP-UUCP>28.7. SMTP és az UUCP<a class=anchor href=#SMTP-UUCP></a></h3><div class=paragraph><p>A FreeBSD-hez tartozó sendmail olyan gépek számára lett kialakítva, amelyek közvetlenül az internethez csatlakoznak. Az UUCP használatával levelezõ rendszerek számára egy másik konfigurációs állományt kell telepíteni a sendmail számára.</p></div><div class=paragraph><p>Az <span class=filename>/etc/mail/sendmail.cf</span> állítása kézzel egyáltalán nem könnyû. A sendmail 8. változata ráadásul a konfigurációs állományokat az <a href="https://man.freebsd.org/cgi/man.cgi?query=m4&amp;sektion=1&amp;format=html">m4(1)</a> elõfeldolgozó segítségével gyártja le, ahol a tényleges beállítások egy magasabb absztrakciós szinten jelennek meg. Az <a href="https://man.freebsd.org/cgi/man.cgi?query=m4&amp;sektion=1&amp;format=html">m4(1)</a> típusú konfigurációs állományok a <span class=filename>/usr/shared/sendmail/cf</span> könyvtárban találhatóak. A <span class=filename>cf</span> alkönyvtárban levõ <span class=filename>README</span> állomány igyekszik a felhasználót bevezetni az <a href="https://man.freebsd.org/cgi/man.cgi?query=m4&amp;sektion=1&amp;format=html">m4(1)</a> alapú beállítások világába.</p></div><div class=paragraph><p>A <code>mailertable</code> nevû lehetõség használatával tudjuk a legjobban támogatni az UUCP protokollon keresztüli kézbesítést. Ezzel felépül egy olyan adatbázis, amelyet a sendmail fel tud használni a továbbítást érintõ döntésekben.</p></div><div class=paragraph><p>Ehhez elsõként hozzuk is létre a saját <span class=filename>.mc</span> állományunkat. Ehhez a <span class=filename>/usr/shared/sendmail/cf/cf</span> könyvtár tartalmaz néhány példát. Hívjuk most ezt az állomnyunkat <span class=filename>ize.mc</span> néven. A következõ módszerrel tudjuk egy valós <span class=filename>sendmail.cf</span> állománnyá alakítani:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># cd /etc/mail</span>
<span class=c># make ize.cf</span>
<span class=c># cp ize.cf /etc/mail/sendmail.cf</span></code></pre></div></div><div class=paragraph><p>Egy átlagos <span class=filename>.mc</span> állomány egyébként valahogy így épül fel:</p></div><div class="literalblock programlisting"><div class=content><pre>VERSIONID(`verziószám&#39;) OSTYPE(bsd4.4)

FEATURE(accept_unresolvable_domains)
FEATURE(nocanonify)
FEATURE(mailertable, `hash -o /etc/mail/mailertable&#39;)

define(`UUCP_RELAY&#39;, sajat.uucp.relay)
define(`UUCP_MAX_SIZE&#39;, 200000)
define(`confDONT_PROBE_INTERFACES&#39;)

MAILER(local)
MAILER(smtp)
MAILER(uucp)

Cw    sajat.al.nev
Cw    azuucpgepneve.UUCP</pre></div></div><div class=paragraph><p>Az <code>accept_unresolvable_domains</code>, <code>nocanonify</code> és <code>confDONT_PROBE_INTERFACES</code> lehetõségekre hivatkozó sorok megakadályozzák, hogy a levél kézbesítésében a DNS is szerepet játsszon. Az <code>UUCP_RELAY</code> az UUCP alapú kézbesítés támogatását engedélyezi. Egyszerûen csak írjunk ide egy internetes hálózati nevet, amely képes feldolgozni az .UUCP áltartomány címeit. Az esetek többségében ide az internet-szolgáltatónk levelek továbbküldéséért felelõs gépe kerül.</p></div><div class=paragraph><p>Miután ezzel végeztünk, szükségünk lesz még az <span class=filename>/etc/mail/mailertable</span> állományra is. Ha a külvilág felé csak egyetlen összeköttetést használunk a levelekhez, akkor az alábbi pontosan megfelel:</p></div><div class="literalblock programlisting"><div class=content><pre>#
# makemap hash /etc/mail/mailertable.db &lt; /etc/mail/mailertable
.                             uucp-dom:sajat.uucp.relay</pre></div></div><div class=paragraph><p>Egy bonyolultabb példa pedig így néz ki:</p></div><div class="literalblock programlisting"><div class=content><pre>#
# makemap hash /etc/mail/mailertable.db &lt; /etc/mail/mailertable
#
horus.interface-business.de   uucp-dom:horus
.interface-business.de        uucp-dom:if-bus
interface-business.de         uucp-dom:if-bus
.heep.sax.de                  smtp8:%1
horus.UUCP                    uucp-dom:horus
if-bus.UUCP                   uucp-dom:if-bus
.                             uucp-dom:</pre></div></div><div class=paragraph><p>Az elsõ három sor azokat a speciális eseteket kezeli, ahol a tartomány felé küldött levelek nem az alapértelmezett úton visszük tovább, hanem valamelyik UUCP szomszéd felé és így "le tudjuk rövidíteni" a kézbesítés útvonalát. Az ezeket követõ sor dolgozza fel a helyi Ethernet tartomány felé STMP protokollal továbbítható leveleket. Végül az UUCP szomszédokat is felsoroljuk az .UUCP áltartomány jelölése szerint, így megengedjük, hogy a <code>uucp-szomszéd! címzett</code> felülbírálja az alapértelmezett szabályokat. Az utolsó sorban mindig egyetlen pont szerepel, ami minden másra illeszkedik, így az UUCP kézbesítés egy olyan UUCP szomszéd felé halad, amely a világ felé egy univerzális levelezõ átjárónak tekinthetõ. A <code>uucp-dom:</code> kulcsszó mögött szereplõ összes csomópont nevének érvényes UUCP szomszédra kell utalnia, amelyet a <code>uuname</code> paranccsal le is tudunk ellenõrizni.</p></div><div class=paragraph><p>A feladatból már csak annyi maradt hátra, hogy használat elõtt ezt az állományt át kell alakítani DBM adatbázis formátumba. Az ehhez szükséges parancsot érdemes <span class=filename>mailertable</span> állomány elejére bejegyzésben felírni. A <span class=filename>mailertable</span> megváltoztatásakor mindig le kell futtatni ezt a parancsot.</p></div><div class=paragraph><p>Utolsó jótanács: ha nem lennénk biztosak valamelyik kézbesítési útvonal mûködésében, ne felejtsük el a sendmail <code>-bt</code> beállítását. Ezzel a sendmail az ún. <em>címtesztelõ módban</em> (address test mode) indul el. Gépeljük be, hogy <code>3,0</code>, majd írjuk be a tesztelni kívánt címet. Az utolsó sorban láthatjuk a felhasznált belsõ levéltovábbító ügynököt, a célgépet, amellyel ezt meghívjuk, és a (valószínûleg az átfordított) címet. Innen a <span class=keyseq><kbd>Ctrl</kbd>+<kbd>D</kbd></span> billentyûkombinációval léphetünk ki.</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>% sendmail <span class=nt>-bt</span>
ADDRESS TEST MODE <span class=o>(</span>ruleset 3 NOT automatically invoked<span class=o>)</span>
Enter &lt;ruleset&gt; &lt;address&gt;
<span class=o>&gt;</span> 3,0 ize@pelda.com
canonify           input: ize @ pelda <span class=nb>.</span> com
...
parse            returns: <span class=nv>$# </span>uucp-dom <span class=nv>$@</span> sajat.uucp.relay <span class=nv>$:</span> ize &lt; @ pelda <span class=nb>.</span> com <span class=nb>.</span> <span class=o>&gt;</span>
<span class=o>&gt;</span> ^D</code></pre></div></div></div><div class=sect2><h3 id=outgoing-only>28.8. Csak küldés beállítása<a class=anchor href=#outgoing-only></a></h3><div class=paragraph><p>Gyakran elõfordulhat, hogy csak leveleket akarunk továbbküldeni. Mint például:</p></div><div class=ulist><ul><li><p>Asztali számítógépünk van, de használni akarunk olyan programokat, mint például a <a href="https://man.freebsd.org/cgi/man.cgi?query=send-pr&amp;sektion=1&amp;format=html">send-pr(1)</a>. Ehhez az internet-szolgáltatón keresztül kell továbbküldeni a levelet.</p></li><li><p>A számítógépünk egy olyan szerver, amely nem helyben kezeli a leveleket, ezért az összeset átküldi feldolgozásra.</p></li></ul></div><div class=paragraph><p>Szinte bármelyik levélküldõ ügynök képes betölteni ezt az ûrt. Sajnos eléggé bonyolult helyesen beállítani úgy egy bármire képes levélküldõt, hogy egyszerûen csak szabaduljon meg a levelektõl. Ilyenkor a sendmail vagy a postfix használatával tulajdonképpen ágyúval lövünk verébre.</p></div><div class=paragraph><p>Továbbá, ha egy átlagos internet-hozzáféréssel rendelkezünk, adódhat, hogy a szerzõdés egyszerûen tiltja a "levelezõ szerver" futtatását.</p></div><div class=paragraph><p>Legegyszerûbben úgy tudjuk kielégíteni az ilyen jellegû igényeket, ha feltelepítjük a <a class=package href=https://cgit.freebsd.org/ports/tree/mail/ssmtp/>mail/ssmtp</a> portot. A <code>root</code> felhasználóval adjuk ki a következõ parancsokat:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># cd /usr/ports/mail/ssmtp</span>
<span class=c># make install replace clean</span></code></pre></div></div><div class=paragraph><p>Telepítése után a <a class=package href=https://cgit.freebsd.org/ports/tree/mail/ssmtp/>mail/ssmtp</a> portot a mindössze négysoros <span class=filename>/usr/local/etc/ssmtp/ssmtp.conf</span> állománnyal állíthatjuk be:</p></div><div class="literalblock programlisting"><div class=content><pre>root=valodiemail@minta.com
mailhub=level.minta.com
rewriteDomain=minta.com
hostname=_GEPNEV_</pre></div></div><div class=paragraph><p>A <code>root</code> felhasználó számára feltétlenül egy valódi e-mail címet adjuk meg. A <code>level.minta.com</code> helyére az internet-szolgáltatónk kimenõ leveleket továbbító szerverét adjuk meg (bizonyos szolgáltatók ezt "kimenõ levelezõ szervernek" vagy "SMTP szervernek" nevezik).</p></div><div class=paragraph><p>Ne felejtsük el sendmail démont sem letiltani, beleértve a kimenõ levelek kezelését. Ennek részleteit lásd a <a href=#mail-disable-sendmail>A sendmail letiltása</a>ban.</p></div><div class=paragraph><p>A <a class=package href=https://cgit.freebsd.org/ports/tree/mail/ssmtp/>mail/ssmtp</a> használatánál még adhatunk meg további beállításokat is. A <span class=filename>/usr/local/etc/ssmtp</span> állományban vagy az ssmtp man oldalán találhatunk példákat és olvashatunk bõvebben a témáról.</p></div><div class=paragraph><p>Az ssmtp ilyen fajta beállításával a számítógépünkön levõ szoftverek is helyesen fognak mûködni, miközben nem sértjük meg az internet-szolgáltató elõírásait és nem tesszük lehetõvé, hogy a számítógépünkrõl levélszemetet küldhessenek.</p></div></div><div class=sect2><h3 id=SMTP-dialup>28.9. Levelezés betárcsázós kapcsolattal<a class=anchor href=#SMTP-dialup></a></h3><div class=paragraph><p>Ha statikus IP-címünk van, akkor az alapértelmezett beállítások tökéletesen megfelelõek számunkra. Csupán a gépünkhöz tartozó internetes címet kell megadnunk a gépünk nevének és a sendmail elvégzi a többit.</p></div><div class=paragraph><p>Ha viszont dinamikusan kiosztott IP-címmel rendelkezünk és betárcsázós PPP kapcsolaton keresztül csatlakozunk az internethez, akkor valószínûleg az internet-szolgáltató levelezõ szerverén van egy postaládánk. Most tegyük fel, hogy a internet-szolgáltató tartománya a <code>szolgaltato.net</code> és a felhasználói név a <code>felhasznalo</code>, a gépünk neve pedig <code>otthoni.bsdm</code>, valamint az internet-szolgáltató részérõl levelezésre a <code>relay.szolgaltato.net</code> gépet használhatjuk.</p></div><div class=paragraph><p>A postaládánkból úgy tudjuk letölteni a leveleket, ha telepítünk hozzá egy programot. Erre a feladatra a fetchmail hibátlanul alkalmas, mivel több különbözõ protokollt ismer. Ez a program csomagként vagy a Portgyûjteménybõl (<a class=package href=https://cgit.freebsd.org/ports/tree/mail/fetchmail/>mail/fetchmail</a>) is elérhetõ. Az internet-szolgáltatók erre általában a POP protokollt ajánlják fel. Ha a felhasználói PPP alkalmazást használjuk, állítsuk be az <span class=filename>/etc/ppp/ppp.linkup</span> állományt a következõ módon és így a csatlakozáskor maguktól letöltõdnek a leveleink:</p></div><div class="literalblock programlisting"><div class=content><pre>MYADDR:
  !bg su felhasznalo -c fetchmail</pre></div></div><div class=paragraph><p>Ha a sendmail segítségével küldjük tovább a leveleket a nem helyi hozzáférések felé (ahogy azt lentebb is láthatjuk), akkor minden bizonnyal a csatlakozáskor arra is szükségünk lesz, hogy a leveleket tároló sor is feldolgozódjon. Ezt úgy oldhatjuk meg, ha az <span class=filename>/etc/ppp/ppp.linkup</span> állományba a <code>fetchmail</code> parancs után a következõt tesszük:</p></div><div class="literalblock programlisting"><div class=content><pre>  !bg su felhasznalo -c &#34;sendmail -q&#34;</pre></div></div><div class=paragraph><p>Ez a példa feltételezi, hogy az <code>otthoni.bsdm</code> gépen van egy <code>felhasznalo</code> nevû felhasználónk. Az <code>otthoni.bsdm</code> gépen a <code>felhasznalo</code> felhasználói könyvtárában hozzunk létre egy <span class=filename>.fetchmailrc</span> állományt:</p></div><div class="literalblock programlisting"><div class=content><pre>poll szolgaltato.net protocol pop3 fetchall pass TitkosJelszo</pre></div></div><div class=paragraph><p>Ezt az állományt csak és kizárólag a <code>felhasznalo</code> olvashatja, mivel szerepel benne a hozzá tartozó <code>TitkosJelszo</code>.</p></div><div class=paragraph><p>Úgy tudunk a megfelelõ <code>from:</code> fejléccel küldeni, ha felvilágosítjuk a sendmail programot, hogy ne az <a href=mailto:felhasznalo@otthoni.bsdm>felhasznalo@otthoni.bsdm</a> címet, hanem a <a href=mailto:felhasznalo@szolgaltato.net>felhasznalo@szolgaltato.net</a> címet használja. Sõt, a gyorsítás kedvéért a sendmail számára érdemes elárulni, hogy a <code>relay.szolgaltato.net</code> címen keresztül küldjön.</p></div><div class=paragraph><p>A munka elvégzéséhez elegendõ az alábbi <span class=filename>.mc</span> állomány:</p></div><div class="literalblock programlisting"><div class=content><pre>VERSIONID(`otthoni.bsdm.mc 1.0&#39;)
OSTYPE(bsd4.4)dnl
FEATURE(nouucp)dnl
MAILER(local)dnl
MAILER(smtp)dnl
Cwlocalhost
Cwotthoni.bsdm
MASQUERADE_AS(`szolgaltato.net&#39;)dnl
FEATURE(allmasquerade)dnl
FEATURE(masquerade_envelope)dnl
FEATURE(nocanonify)dnl
FEATURE(nodns)dnl
define(`SMART_HOST&#39;, `relay.szolgaltato.net&#39;)
Dmotthoni.bsdm
define(`confDOMAIN_NAME&#39;,`otthoni.bsdm&#39;)dnl
define(`confDELIVERY_MODE&#39;,`deferred&#39;)dnl</pre></div></div><div class=paragraph><p>Az elõzõ szakaszban találhatjuk meg annak a módját, hogy miként varázsoljunk ebbõl az <span class=filename>.mc</span> állományból egy <span class=filename>sendmail.cf</span> állományt. A <span class=filename>sendmail.cf</span> frissítése után pedig ne felejtsük el a sendmail újraindítását!</p></div></div><div class=sect2><h3 id=SMTP-Auth>28.10. Az SMTP hitelesítése<a class=anchor href=#SMTP-Auth></a></h3><div class=paragraph><p>Levelezõ szerverünkön az SMTP protokoll hitelesítésének (SMTP Authentication) engedélyezése több szempontból is elõnyökkel bír. Az SMTP hitelesítésének bekapcsolása egy újabb réteget képez a sendmail védelmében, és az olyan állandóan mozgásban levõ felhasználók számára is megoldást nyújt, akik anélkül képesek használni ugyanazt a levelezõ szervert, hogy minden alkalommal újrakonfigurálnák a levelezõ kliensüket.</p></div><div class="exampleblock procedure"><div class=content><div class="olist arabic"><ol class=arabic><li><p>Telepítsük fel a <a class=package href=https://cgit.freebsd.org/ports/tree/security/cyrus-sasl2/>security/cyrus-sasl2</a> portot. A <a class=package href=https://cgit.freebsd.org/ports/tree/security/cyrus-sasl2/>security/cyrus-sasl2</a> port több fordítási idejû beállítást támogat. Itt most az SMTP hitelesítését fogjuk használni, ezért gondoskodjunk a <code>LOGIN</code> opció engedélyezésérõl.</p></li><li><p>A <a class=package href=https://cgit.freebsd.org/ports/tree/security/cyrus-sasl2/>security/cyrus-sasl2</a> telepítés után nyissuk meg szerkesztésre a <span class=filename>/usr/local/lib/sasl2/Sendmail.conf</span> állományt (vagy ha még nem létezne, hozzuk létre), és benne vegyük fel a következõ sort:</p><div class="literalblock programlisting"><div class=content><pre>pwcheck_method: saslauthd</pre></div></div></li><li><p>Ezt követõen telepítsük a <a class=package href=https://cgit.freebsd.org/ports/tree/security/cyrus-sasl2-saslauthd/>security/cyrus-sasl2-saslauthd</a> portot, és tegyük bele az <span class=filename>/etc/rc.conf</span> állományba ezt a sort:</p><div class="literalblock programlisting"><div class=content><pre>saslauthd_enable=&#34;YES&#34;</pre></div></div><div class=paragraph><p>Végezetül indítsuk el a saslauthd démont:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># /usr/local/etc/rc.d/saslauthd start</span></code></pre></div></div><div class=paragraph><p>Ez a démon fog közvetíteni a sendmail és a FreeBSD <span class=filename>passwd</span> adatbázisa közti hitelesítésben. Ezzel elkerülhetjük az új felhasználói nevek és jelszavak felvételét az SMTP hitelesítés használatához, így a hozzáférések és a levelezés jelszava ugyanaz marad.</p></div></li><li><p>Most pedig írjuk hozzá az alábbi sorokat az <span class=filename>/etc/make.conf</span> állományhoz:</p><div class="literalblock programlisting"><div class=content><pre>SENDMAIL_CFLAGS=-I/usr/local/include/sasl -DSASL
SENDMAIL_LDFLAGS=-L/usr/local/lib
SENDMAIL_LDADD=-lsasl2</pre></div></div><div class=paragraph><p>Ezek a sorok állítják be a sendmail számára, hogy fordítás közben a <a class=package href=https://cgit.freebsd.org/ports/tree/cyrus-sasl2/>cyrus-sasl2</a> függvényeit használja. A sendmail újrafordítása elõtt mindenképpen legyen fenn a <a class=package href=https://cgit.freebsd.org/ports/tree/cyrus-sasl2/>cyrus-sasl2</a> port.</p></div></li><li><p>A sendmail újrafordítását a következõ parancsok végrehajtásával intézhetjük el:</p><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># cd /usr/src/lib/libsmutil</span>
<span class=c># make cleandir &amp;&amp; make obj &amp;&amp; make</span>
<span class=c># cd /usr/src/lib/libsm</span>
<span class=c># make cleandir &amp;&amp; make obj &amp;&amp; make</span>
<span class=c># cd /usr/src/usr.sbin/sendmail</span>
<span class=c># make cleandir &amp;&amp; make obj &amp;&amp; make &amp;&amp; make install</span></code></pre></div></div><div class=paragraph><p>A sendmail fordítása esetén semmilyen problémának nem szabadna elõfordulnia, kivéve ha a <span class=filename>/usr/src</span> könyvtárat és a szükséges osztott könyvtárakat nem változtatjuk idõközben túlságosan gyakran.</p></div></li><li><p>A sendmail lefordítása és újratelepítése után szerkesszük át az <span class=filename>/etc/mail/freebsd.mc</span> állományt (vagy azt az <span class=filename>.mc</span> állományt, amelyet éppen használunk). Sok rendszergazda a <a href="https://man.freebsd.org/cgi/man.cgi?query=hostname&amp;sektion=1&amp;format=html">hostname(1)</a> parancs válaszát használja fel az <span class=filename>.mc</span> típusú állományok egyedi elnevezéséhez). Írjuk bele a következõ sorokat:</p><div class="literalblock programlisting"><div class=content><pre>dnl set SASL options
TRUST_AUTH_MECH(`GSSAPI DIGEST-MD5 CRAM-MD5 LOGIN&#39;)dnl
define(`confAUTH_MECHANISMS&#39;, `GSSAPI DIGEST-MD5 CRAM-MD5 LOGIN&#39;)dnl</pre></div></div><div class=paragraph><p>Ezek állítják be a sendmail számára a felhasználók hitelesítésére alkalmas különbözõ módszereket. Ha a pwcheck módszer helyett valami mást akarunk használni, akkor járjunk utána a dokumentációban.</p></div></li><li><p>Zárásul futassuk le a <a href="https://man.freebsd.org/cgi/man.cgi?query=make&amp;sektion=1&amp;format=html">make(1)</a> parancsot az <span class=filename>/etc/mail</span> könyvtárban. Így lefut az új <span class=filename>.mc</span> állományunk és létrejön egy <span class=filename>freebsd.cf</span> (vagy amilyen nevet az <span class=filename>.mc</span> állománynak megadtunk) <span class=filename>.cf</span> állomány. Ezután a <code>make install restart</code> parancs kiadásával másoltassuk át ezt a <span class=filename>sendmail.cf</span> helyére és szabályosan indítassuk újra a sendmail szolgáltatást. A folyamatról részletesebb tájékoztatást az <span class=filename>/etc/mail/Makefile</span> állomány tud nyújtani.</p></li></ol></div></div></div><div class=paragraph><p>Ha eddig minden a legnagyobb rendben történt, akkor most már képesek vagyunk bejelentkezési információt is átadni a levelezõ kliensnek és elküldeni egy tesztüzenetet. A hibák kiszûréséhez állítsuk a sendmail <code>LogLevel</code> opcióját az 13 értékre és figyeljük a <span class=filename>/var/log/maillog</span> állományt.</p></div><div class=paragraph><p>További felvilágosításért olvassuk el a sendmail <a href=http://www.sendmail.org/\~ca/email/auth.html>SMTP hitelesítéssel</a> foglalkozó oldalát (angolul).</p></div></div><div class=sect2><h3 id=mail-agents>28.11. Levelezõ kliensek<a class=anchor href=#mail-agents></a></h3><div class=paragraph><p>A levelezõ kliens (Mail User Agent, MUA) egy olyan alkalmazás, amelyik elektronikus levelek küldésére és fogadására használható. Azonkívül, ahogy az e-mail "fejlõdik" és egyre bonyolultabbá válik, a levelezõ kliensek is egyre inkább erõsebbé válnak abban a tekintetben, ahogy az e-maileket kezelik. Ezzel együtt a felhasználók is egyre több lehetõséget és rugalmasságot kapnak. A FreeBSD számos levelezõ klienst támogat, mindegyikük könnyedén telepíthetõ a <a href=./#ports>FreeBSD Portgyûjteménye</a> segítségével. A felhasználók választhatnak a grafikus kliensek, mint például az evolution vagy a balsa és a konzolos kliensek, például a mutt, pine vagy <code>mail</code> között, esetleg használhatják a nagyobb szervezetek részérõl felkínált webes felületeket is.</p></div><div class=sect3><h4 id=mail-command>28.11.1. mail<a class=anchor href=#mail-command></a></h4><div class=paragraph><p>A <a href="https://man.freebsd.org/cgi/man.cgi?query=mail&amp;sektion=1&amp;format=html">mail(1)</a> a FreeBSD alapértelmezett levelezõ kliense. Egy olyan konzolos alkalmazás, amelyben elérhetjük az e-mailek küldéséhez és fogadásához szükséges összes alapvetõ funkciót, habár a csatolmányokat csak korlátozottan képes kezelni és csak a helyi postaládákat kezeli.</p></div><div class=paragraph><p>Annak ellenére, hogy a <code>mail</code> önmaga nem képes kommunikálni POP vagy IMAP szerverekkel, az ilyen postaládák tartalmát egy fetchmail-szerû alkalmazással (lásd <a href=#mail-fetchmail>A fetchmail használata</a>) le tudjuk tölteni a számára is elérhetõ helyi <span class=filename>mbox</span> állományba.</p></div><div class=paragraph><p>A levelek küldéséhez és fogadásához egyszerûen hívjuk be a <code>mail</code> programot a következõ módon:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>% mail</code></pre></div></div><div class=paragraph><p>Ezután a <span class=filename>/var/mail</span> könyvtárban található felhasználói postaládánk tartalmát automatikusan beolvassa a <code>mail</code> segédprogram. Ha a postaláda üres, akkor a program egybõl befejezi futását és közli, hogy nem talált levelet. Amikor viszont tudott beolvasni leveleket, megjelenik egy felület, ahol a beérkezett üzenetek listáját láthatjuk. Az üzenetek automatikusan sorszámozódnak, ahogy ezt az alábbi példa is szemlélteti:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>Mail version 8.1 6/6/93.  Type ? <span class=k>for </span>help.
<span class=s2>&#34;/var/mail/marcs&#34;</span>: 3 messages 3 new
<span class=o>&gt;</span>N  1 root@localhost        Mon Mar  8 14:05  14/510   <span class=s2>&#34;proba&#34;</span>
 N  2 root@localhost        Mon Mar  8 14:05  14/509   <span class=s2>&#34;felhasznaloi hozzaferes&#34;</span>
 N  3 root@localhost        Mon Mar  8 14:05  14/509   <span class=s2>&#34;minta&#34;</span></code></pre></div></div><div class=paragraph><p>Az üzenetek olvasásának a <kbd>t</kbd> paranccsal kezdhetünk neki, amelyet az elolvasandó üzenet sorszáma követ. Ebben a példában az elsõ e-mailt nyitjuk meg:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>&amp; t 1
Message 1:
From root@localhost  Mon Mar  8 14:05:52 2004
X-Original-To: marcs@localhost
Delivered-To: marcs@localhost
To: marcs@localhost
Subject: proba
Date: Mon,  8 Mar 2004 14:05:52 +0200 <span class=o>(</span>SAST<span class=o>)</span>
From: root@localhost <span class=o>(</span>Charlie Root<span class=o>)</span>

Ezt az uzenetet probabol kuldom, valaszolj ra, ha megkaptad.</code></pre></div></div><div class=paragraph><p>Ahogy az a fenti példából is látszik, a <kbd>t</kbd> billentyû hatására az üzenet a teljes fejlécével együtt jelenik meg. Az üzenetek listáját a <kbd>h</kbd> billentyûvel hozhatjuk vissza.</p></div><div class=paragraph><p>Ha egy levélre válaszolni szeretnénk, akkor ezt a <code>mail</code> paranccsal is megtehetjük, vagy az <kbd>R</kbd> vagy az <kbd>r</kbd> parancsokkal. Az <kbd>R</kbd> arra utasítja a <code>mail</code> programot, hogy csak az üzenet küldõjének válaszoljon, míg az <kbd>r</kbd> hatására nem csupán a küldõ, hanem az üzenet összes címzettje megkapja a válaszunkat. A parancshoz hozzátûzhetjük egy levél sorszámát is, ekkor az adott levélre fogunk válaszolni. Miután kiadtuk a parancsot, írjuk meg a válaszunkat és új sorban kezdve zárjuk le az üzenetet egyetlen <kbd>.</kbd> beírásával. Valahogy így:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>&amp; R 1
To: root@localhost
Subject: Re: proba

Koszonom, megkaptam a leveledet.
<span class=nb>.</span>
EOT</code></pre></div></div><div class=paragraph><p>Új levelet az <kbd>m</kbd> segítségével tudunk küldeni, ami után meg kell adnunk a címzettet. Egyszerre több címzettet is meg tudunk adni, ha a címzett helyén címeiket egy <kbd>,</kbd> karakterrel elválasztva soroljuk fel. Ezután a levél témája is megadható, amit végül a levél szövege követ. Az üzenetet egy új sorban megadott egyetlen <kbd>.</kbd> segítségével zárhatjuk le.</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>&amp; mail root@localhost
Subject: Elsajatitottam a mail hasznalatat

Most mar en is tudok levelet irni es fogadni a mail hasznalataval... :<span class=o>)</span>
<span class=nb>.</span>
EOT</code></pre></div></div><div class=paragraph><p>Amikor a <code>mail</code> segédprogramban vagyunk, a <kbd>?</kbd> használatával bármikor segítséget kérhetünk, valamint a <code>mail</code> mûködésével kapcsolatban a <a href="https://man.freebsd.org/cgi/man.cgi?query=mail&amp;sektion=1&amp;format=html">mail(1)</a> man oldalát érdemes felkeresni.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Ahogy azt már korábban is említettük, a <a href="https://man.freebsd.org/cgi/man.cgi?query=mail&amp;sektion=1&amp;format=html">mail(1)</a> parancsot eredetileg nem készítették fel az csatolt állományok kezelésére, ezért igen gyengén bánik velük. Az újabb levelezõ kliensek, mint például a mutt, a csatolt állományokat sokkal intelligensebb módon kezelik. Ha viszont ragaszkodunk a <code>mail</code> használatához, akkor a <a class=package href=https://cgit.freebsd.org/ports/tree/converters/mpack/>converters/mpack</a> port használatát érdemes megfontolnunk.</p></div></td></tr></tbody></table></div></div><div class=sect3><h4 id=mutt-command>28.11.2. mutt<a class=anchor href=#mutt-command></a></h4><div class=paragraph><p>A mutt apró mérete ellenére egy igen komoly levelezõ kliens és remek lehetõségeket ajánl fel. Íme ízelítésképpen közülük néhány:</p></div><div class=ulist><ul><li><p>Képes az üzeneteket szálakba rendezni</p></li><li><p>Az e-mailek titkosítására és elektronikus aláírására támogatja a PGP használatát</p></li><li><p>MIME támogatás</p></li><li><p>Maildir támogatás</p></li><li><p>Nagyfokú testreszabhatóság</p></li></ul></div><div class=paragraph><p>Ezen lehetõségei révén a mutt ez egyik legfejlettebb levelezõ kliens. A mutt részletesebb bemutatását a <a href=http://www.mutt.org>http://www.mutt.org</a> címen találjuk (angolul).</p></div><div class=paragraph><p>A mutt stabil változata a <a class=package href=https://cgit.freebsd.org/ports/tree/mail/mutt/>mail/mutt</a> port használatával telepíthetõ fel, miközben a fejlesztés alatt levõ változatot a <a class=package href=https://cgit.freebsd.org/ports/tree/mail/mutt-devel/>mail/mutt-devel</a> port telepíti. Miután a portot sikerült felraknunk, a mutt az alábbi parancs begépelésével indítható el:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>% mutt</code></pre></div></div><div class=paragraph><p>A mutt indulása után automatikusan beolvassa a <span class=filename>/var/mail</span> könyvtárban megtalálható felhasználói postaládát és ha lehetséges, akkor megjeleníti a tartalmát. Ha nincsen levél a felhasználó postaládájában, akkor a mutt a felhasználó parancsaira vár. Ezen a képen a mutt üzenetlistája látható:</p></div><div class=imageblock><div class=content><img src=../../../../images/books/handbook/mail/mutt1.png alt=mutt1></div></div><div class=paragraph><p>A levelek elolvasásához egyszerûen csak válasszuk ki a kurzorral és nyomjuk meg az <kbd>Enter</kbd> billentyût. Ezután a mutt így mutatja a levelet:</p></div><div class=imageblock><div class=content><img src=../../../../images/books/handbook/mail/mutt2.png alt=mutt2></div></div><div class=paragraph><p>Ahogy azt már a <a href="https://man.freebsd.org/cgi/man.cgi?query=mail&amp;sektion=1&amp;format=html">mail(1)</a> parancsnál is megszokhattuk, a mutt is lehetõvé teszi, hogy vagy csak a küldõnek, vagy pedig rajta kívül még az összes címzettnek is válaszoljunk. A levél küldõjének az <kbd>r</kbd> lenyomásával tudunk válaszolni. A csoportos válaszadáshoz pedig, ahol tehát a küldõn kívül a címzettek is megkapják a levelünket, a <kbd>g</kbd> billentyût kell használni.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>A mutt az e-mailek létrehozásához és megválaszolásához a <a href="https://man.freebsd.org/cgi/man.cgi?query=vi&amp;sektion=1&amp;format=html">vi(1)</a> szövegszerkesztõt használja. Ezt úgy tudjuk átállítani, ha a könyvtárunkban található <span class=filename>.muttrc</span> állományban átírjuk az <code>editor</code> változót, vagy értéket adunk az <code>EDITOR</code> környezeti változónak. A mutt beállításáról többet a <a href=http://www.mutt.org>http://www.mutt.org</a> címen tudhatunk meg.</p></div></td></tr></tbody></table></div><div class=paragraph><p>Egy új levél megírásához nyomjuk le az <kbd>m</kbd> gombot. Miután elláttuk érvényes témával a levelet, a mutt elindítja a <a href="https://man.freebsd.org/cgi/man.cgi?query=vi&amp;sektion=1&amp;format=html">vi(1)</a> szövegszerkesztõt és nekiláthatunk a levél szövegének. Amint befejeztük, mentsük el és lépjünk ki a <code>vi</code> szerkesztõbõl. Ezután visszakapjuk a mutt felületét, ahol a küldendõ e-mail összefoglalását láthatjuk. A levelet végül az <kbd>y</kbd> lenyomásával küldhetjük el. Erre a következõ képen láthatunk egy példát:</p></div><div class=imageblock><div class=content><img src=../../../../images/books/handbook/mail/mutt3.png alt=mutt3></div></div><div class=paragraph><p>A mutt ezenkívül még rengeteg segítséget is tartalmaz, amelyet a legtöbb menübõl a <kbd>?</kbd> gomb lenyomásával érhetünk el. A felsõ sorban mindig láthatjuk a kiadható parancsok rövid összefoglalását.</p></div></div><div class=sect3><h4 id=pine-command>28.11.3. pine<a class=anchor href=#pine-command></a></h4><div class=paragraph><p>A pine alapvetõen a kezdõ felhasználók számára íródott, de számos komolyabb lehetõséget is támogat.</p></div><div class="admonitionblock warning"><table><tbody><tr><td class=icon><i class="fa icon-warning" title=Warning></i></td><td class=content><div class=paragraph><p>A pine szoftverrel kapcsolatban a múltban már rengeteg távolról kihasználható sebezhetõség látott napvilágot, és ennek köszönhetõen a támadók megfelelõen elõkészített e-mailek segítségével tetszõleges kódot tudnak futtatni a rendszeren levõ helyi felhasználókon keresztül. Noha az összes ilyen <em>ismert</em> hibát javították, de a FreeBSD biztonsági tisztje szerint a pine kódját biztonság szempontjából annyira hanyag módon írták, hogy további, eddig még felfedezetlen sebezhetõségeket is magában rejt. Ennek megfelelõen tehát a pine használata mindenkinek csak saját felelõsségre javasolt.</p></div></td></tr></tbody></table></div><div class=paragraph><p>A pine jelenlegi verziója a <a class=package href=https://cgit.freebsd.org/ports/tree/mail/pine4/>mail/pine4</a> porton keresztül telepíthetõ. A telepítés lezajlása után a pine a következõ paranccsal indítható:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>% pine</code></pre></div></div><div class=paragraph><p>A pine elsõ futtatása során egy üdvözlõ üzenetet és egy rövid bemutatkozást jelenít meg, valamint a pine fejlesztõi arra kérik a felhasználókat, hogy küldjenek nekik egy névtelen üzenetet, amibõl le tudják szûrni mennyien használják a kliensüket. A névtelen üzenet elküldéséhez a <kbd>Enter</kbd> lenyomásával járulhatunk hozzá vagy az <kbd>E</kbd> használatával enélkül tudunk kilépni a képernyõrõl. Ezt az üdvözlõ képernyõt itt láthatjuk:</p></div><div class=imageblock><div class=content><img src=../../../../images/books/handbook/mail/pine1.png alt=pine1></div></div><div class=paragraph><p>A felhasználó ezután a fõmenübe kerül, ahol a kurzorbillentyûkkel minden gond nélkül tudunk mozogni. Ebben a fõmenüben a levelek megírására, a leveleket tároló könyvtárak tallózására vagy éppen a címjegyzék karbantartására gyorsbillentyûket is használhatuk. A fõmenü alatt szerepel az adott menüben végrehajtható feladatokhoz tartozó gyorsbillentyûk rövid felsorolása.</p></div><div class=paragraph><p>A pine alapértelmezés szerint az <span class=filename>inbox</span> könyvtárat nyitja meg. A bennelévõ üzenetek listájának megtekintéséhez nyomjuk a <kbd>I</kbd> gombot vagy válasszuk ki a lentihez hasonló módon a <span class=guimenuitem>MESSAGE INDEX</span> menüpontot:</p></div><div class=imageblock><div class=content><img src=../../../../images/books/handbook/mail/pine2.png alt=pine2></div></div><div class=paragraph><p>Az üzenetek listájában az adott könyvtárban található üzenetek láthatjuk, és köztük a kurzorbillentyûkkel mozoghatunk. A kiemelt üzenet az <kbd>Enter</kbd> lenyomásával olvasható el.</p></div><div class=imageblock><div class=content><img src=../../../../images/books/handbook/mail/pine3.png alt=pine3></div></div><div class=paragraph><p>A lenti képen egy ilyen példa üzenetet láthatunk a pine programban. A rendelkezésünkre álló gyorsbillentyûk ilyenkor is a képernyõ alján megjelennek referenciaként. Ilyen gyorsbillentyû többek közt az <kbd>r</kbd> gomb, amelynek hatására a klienssel megválaszolhatjuk a éppen látható üzenetet.</p></div><div class=imageblock><div class=content><img src=../../../../images/books/handbook/mail/pine4.png alt=pine4></div></div><div class=paragraph><p>A pine kliensen belül a pico szövegszerkesztõ segítségével tudunk megválaszolni egy e-mailt, amely alapból a pine mellé települ. A pico megkönnyíti a navigációt az üzenetekben és sokkal elnézõbb a kezdõ felhasználókkal, mint például a <a href="https://man.freebsd.org/cgi/man.cgi?query=vi&amp;sektion=1&amp;format=html">vi(1)</a> vagy a <a href="https://man.freebsd.org/cgi/man.cgi?query=mail&amp;sektion=1&amp;format=html">mail(1)</a>. Ha befejeztük a választ, az üzenetet a <span class=keyseq><kbd>Ctrl</kbd>+<kbd>X</kbd></span> billentyûkombinációval tudjuk elküldeni. A pine erre megerõsítést fog kérni.</p></div><div class=imageblock><div class=content><img src=../../../../images/books/handbook/mail/pine5.png alt=pine5></div></div><div class=paragraph><p>A pine alkalmazás a fõmenübõl elérhetõ <span class=guimenuitem>SETUP</span> menüpont meghívásával szabható testre. A további részleteket a <a href=http://www.washington.edu/pine>http://www.washington.edu/pine</a> oldalon találhatjuk (angolul).</p></div></div></div><div class=sect2><h3 id=mail-fetchmail>28.12. A fetchmail használata<a class=anchor href=#mail-fetchmail></a></h3><div class=paragraph><p>A fetchmail egy mindentudó IMAP és POP kliens, amely lehetõvé teszi a felhasználók számára, hogy automatikusan töltsenek le leveleket távoli IMAP és POP szerverekrõl és lementsék azokat a helyi postaládáikba. Így a levelek sokkal könnyebben elérhetõek. A fetchmail a <a class=package href=https://cgit.freebsd.org/ports/tree/mail/fetchmail/>mail/fetchmail</a> port segítségével telepíthetõ, és számos lehetõséget ajánl fel, többek közt:</p></div><div class=ulist><ul><li><p>A POP3, APOP, KPOP, IMAP, ETRN és az ODMR protokollok ismerete.</p></li><li><p>Képes SMTP használatával levelet továbbítani, és ennek révén a szûrés, továbbküldés és az álnevek használata a megszokott módon mûködik.</p></li><li><p>Démonként futtatva képes adott idõközönként ellenõrizni a frissen érkezõ üzeneteket.</p></li><li><p>Képes egyszerre több postaládát is kezelni, majd ezek tartalmát a beállításainak megfelelõen továbbküldeni a különbözõ helyi felhasználóknak.</p></li></ul></div><div class=paragraph><p>Noha a fetchmail összes lehetõségének aprólékos bemutatása meghaladná ennek a leírásnak a kereteit, azért szót kerítünk néhány alapvetõ funkciójára. A fetchmail segédprogramnak a megfelelõ mûködéshez egy <span class=filename>.fetchmailrc</span> nevû konfigurációs állományra van szüksége. Ez az állomány tárolja a szerverekre vonatkozó, valamint a bejelentkezéshez szükséges információkat. Az állomány kényes tartalmára tekintettel azt javasoljuk, hogy csak a tulajdonosának engedélyezzük az olvasását:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>% <span class=nb>chmod </span>600 .fetchmailrc</code></pre></div></div><div class=paragraph><p>Az alább ismertetésre kerülõ <span class=filename>.fetchmailrc</span> állományban azt láthatjuk, ahogy egyetlen felhasználó postaládáját érjük el a POP protokoll használatával. Arra utasítja a fetchmail programot, hogy csatlakozzon a <code>levelezes.com</code> címre a <code>joska</code> felhasználóval és az <code>XXX</code> jelszóval. Ebben a példában feltételezzük, hogy a <code>joska</code> nevû felhasználó létezik a rendszerünkben is.</p></div><div class="literalblock programlisting"><div class=content><pre>poll levelezes.com protocol pop3 username &#34;joska&#34; password &#34;XXX&#34;</pre></div></div><div class=paragraph><p>A következõ példában több POP és IMAP szerverhez csatlakozunk és ahol lehet, több helyi felhasználónak irányítjuk át a leveleket:</p></div><div class="literalblock programlisting"><div class=content><pre>poll levelezes.com proto pop3:
user &#34;joska&#34;, with password &#34;XXX&#34;, is &#34;jozsi&#34; here;
user &#34;andrea&#34;, with password &#34;XXXX&#34;;
poll levelezes2.net proto imap:
user &#34;jani&#34;, with password &#34;XXXXX&#34;, is &#34;hardstuff&#34; here;</pre></div></div><div class=paragraph><p>A fetchmail program a <code>-d</code> beállítás megadásával démonként is elindítható, amely után meg kell adni (másodpercekben) azt az idõközt, aminek elteltével a fetchmail lekérdi a <span class=filename>.fetchmailrc</span> állományban felsorolt szervereket. Az alábbi példában a fetchmail 600 másodpercenként kéri el a leveleket:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>% fetchmail <span class=nt>-d</span> 600</code></pre></div></div><div class=paragraph><p>A fetchmail további lehetõségeirõl és mûködésérõl a <a href=http://fetchmail.berlios.de/>http://fetchmail.berlios.de/</a> oldalon olvashatunk (angolul).</p></div></div><div class=sect2><h3 id=mail-procmail>28.13. A procmail használata<a class=anchor href=#mail-procmail></a></h3><div class=paragraph><p>A procmail segédprogram egy hihetetlenül erõs alkalmazás, mellyel a beérkezõ leveleinket tudjuk szûrni. A felhasználók számára olyan "szabályok" megadását teszi lehetõvé, amelyekre aztán a rendszer illeszti a bejövõ leveleket, és az eredménynek megfelelõen elvégez bizonyos feladatokat vagy átirányítja a levelet más postaladákba és/vagy e-mail címekre. A procmail a <a class=package href=https://cgit.freebsd.org/ports/tree/mail/procmail/>mail/procmail</a> porttal telepíthetõ fel. Miután ez sikerült, akár közvetlenül be is építhetjük a legtöbb levelezõ kliensbe. Errõl az adott levelezõ kliens dokumentációjában olvashatunk többet. A procmail úgy is integrálható, ha a felvesszük a következõ sort a procmail szolgáltatára igényt tartó felhasználó könyvtárában található <span class=filename>.forward</span> állományba:</p></div><div class="literalblock programlisting"><div class=content><pre>&#34;|exec /usr/local/bin/procmail || exit 75&#34;</pre></div></div><div class=paragraph><p>A következõ szakaszban láthatjuk a procmail néhány alapvetõ szabályát, valamint ezek rövid leírását. Ezeket a szabályokat a <span class=filename>.procmailrc</span> állományba kell beleírni, amely szintén a felhasználó könyvtárában leledzik.</p></div><div class=paragraph><p>Ezen szabályok többsége a <a href="https://man.freebsd.org/cgi/man.cgi?query=procmailex&amp;sektion=5&amp;format=html">procmailex(5)</a> man oldalon is olvasható.</p></div><div class=paragraph><p>A <a href=mailto:felhasznalo@levelezes.com>felhasznalo@levelezes.com</a> címrõl érkezõ leveleket irányítsuk át a <a href=mailto:jocim@levelezes2.com>jocim@levelezes2.com</a> külsõ címre:</p></div><div class="literalblock programlisting"><div class=content><pre>:0
* ^From.*felhasznalo@levelezes.com
! jocim@levelezes2.com</pre></div></div><div class=paragraph><p>Minden 1000 byte-nál kisebb levelet küldjünk át a <a href=mailto:jocim@levelezes2.com>jocim@levelezes2.com</a> külsõ címre:</p></div><div class="literalblock programlisting"><div class=content><pre>:0
* &lt; 1000
! jocim@levelezes2.com</pre></div></div><div class=paragraph><p>Küldjük át az összes <a href=mailto:masik@levelezes.com>masik@levelezes.com</a> címre küldött levelet a <span class=filename>masik</span> postaládába:</p></div><div class="literalblock programlisting"><div class=content><pre>:0
* ^TOmasik@levelezes.com
masik</pre></div></div><div class=paragraph><p>Küldjük az összes olyan levelet a <span class=filename>/dev/null</span> eszközre, amelyek a témájában szerepel a "Spam" szó:</p></div><div class="literalblock programlisting"><div class=content><pre>:0
^Subject:.*Spam
/dev/null</pre></div></div><div class=paragraph><p>Egy hasznos szabály, amellyel el tudjuk kapni a <code>FreeBSD.org</code> levelezési listáiról érkezõ leveleket és el tudjuk raktározni ezeket a saját postaládájukba:</p></div><div class="literalblock programlisting"><div class=content><pre>:0
* ^Sender:.owner-freebsd-\/[^@]+@FreeBSD.ORG
{
	LISTNAME=${MATCH}
	:0
	* LISTNAME??^\/[^@]+
	FreeBSD-${MATCH}
}</pre></div></div></div></div></div><div class=sect1><h2 id=network-servers>Chapter 29. Hálózati szerverek<a class=anchor href=#network-servers></a></h2><div class=sectionbody><div class=sect2><h3 id=network-servers-synopsis>29.1. Áttekintés<a class=anchor href=#network-servers-synopsis></a></h3><div class=paragraph><p>Ebben a fejezetben a UNIX® típusú rendszerekben leggyakrabban alkalmazott hálózati szolgáltatások közül fogunk néhányat bemutatni. Ennek során megismerjük a hálózati szolgáltatások különbözõ típusainak telepítését, beállítását, tesztelését és karbantartását. A fejezet tartalmát folyamatosan példákkal igyekszünk illusztrálni.</p></div><div class=paragraph><p>A fejezet elolvasása során megismerjük:</p></div><div class=ulist><ul><li><p>hogyan dolgozzunk az inetd démonnal;</p></li><li><p>hogyan állítsuk be a hálózati állományrendszereket;</p></li><li><p>hogyan állítsunk be egy hálózati információs szervert a felhasználói hozzáférések megosztására;</p></li><li><p>hogyan állítsuk be automatikusan a hálózati hozzáférésünket a DHCP használatával;</p></li><li><p>hogyan állítsunk be névfeloldó szervereket;</p></li><li><p>hogyan állítsuk be az Apache webszervert;</p></li><li><p>hogyan állítsuk be az állományok átviteléért felelõs (FTP) szervert;</p></li><li><p>a Samba használatával hogyan állítsunk be Windows®-os kliensek számára állomány- és nyomtatószervert;</p></li><li><p>az NTP protokoll segítségével hogyan egyeztessük az idõt és dátumot, hogyan állítsunk be egy idõszervert;</p></li><li><p>a szabványos naplózó démon, a <code>syslogd</code> beállítását hálózati keresztüli naplózásra.</p></li></ul></div><div class=paragraph><p>A fejezet elolvasásához ajánlott:</p></div><div class=ulist><ul><li><p>az <span class=filename>/etc/rc</span> szkriptek alapjainak ismerete;</p></li><li><p>az alapvetõ hálózati fogalmak ismerete;</p></li><li><p>a külsõ szoftverek telepítésének ismerete (<a href=./#ports>Alkalmazások telepítése. csomagok és portok</a>).</p></li></ul></div></div><div class=sect2><h3 id=network-inetd>29.2. Az inetd"szuperszerver"<a class=anchor href=#network-inetd></a></h3><div class=sect3><h4 id=network-inetd-overview>29.2.1. Áttekintés<a class=anchor href=#network-inetd-overview></a></h4><div class=paragraph><p>Az <a href="https://man.freebsd.org/cgi/man.cgi?query=inetd&amp;sektion=8&amp;format=html">inetd(8)</a> démont gyakran csak "internet szuperszerverként" nevezik, mivel a helyi szolgáltatások kapcsolatainak kezeléséért felelõs. Amikor az inetd fogad egy csatlakozási kérelmet, akkor eldönti róla, hogy ez melyik programhoz tartozik és elindít egy példányt belõle, majd átadja neki a socketet (az így meghívott program a szabvány bemenetéhez, kimenetéhez és hibajelzési csatornájához kapja meg a socket leíróit). Az inetd használatával úgy tudjuk csökkenteni a rendszerünk terhelését, hogy a csak alkalmanként meghívott szolgáltatásokat nem futtatjuk teljesen független önálló módban.</p></div><div class=paragraph><p>Az inetd démont elsõsorban más démonok elindítására használjuk, de néhány triviális protokollt közvetlenül is képes kezelni, mint például a chargen, auth és a daytime.</p></div><div class=paragraph><p>Ebben a fejezetben az inetd beállításának alapjait foglaljuk össze mind parancssoros módban, mind pedig az <span class=filename>/etc/inetd.conf</span> konfigurációs állományon keresztül.</p></div></div><div class=sect3><h4 id=network-inetd-settings>29.2.2. Beállítások<a class=anchor href=#network-inetd-settings></a></h4><div class=paragraph><p>Az inetd mûködése az <a href="https://man.freebsd.org/cgi/man.cgi?query=rc&amp;sektion=8&amp;format=html">rc(8)</a> rendszeren keresztül inicializálható. Az <code>inetd_enable</code> ugyan alapból a <code>NO</code> értéket veszi fel, vagyis tiltott, de a sysinstall használatával már akár a telepítés során bekapcsolható attól függõen, hogy a felhasználó milyen konfigurációt választott. Ha tehát a:</p></div><div class="literalblock programlisting"><div class=content><pre>inetd_enable=&#34;YES&#34;</pre></div></div><div class=paragraph><p>vagy</p></div><div class="literalblock programlisting"><div class=content><pre>inetd_enable=&#34;NO&#34;</pre></div></div><div class=paragraph><p>sort tesszük az <span class=filename>/etc/rc.conf</span> állományba, akkor azzal az inetd démont indíthatjuk el vagy tilthatjuk le a rendszer indítása során. Az</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># /etc/rc.d/inetd rcvar</span></code></pre></div></div><div class=paragraph><p>paranccsal lekérdezhetjük a pillanatnyilag érvényes beállítást.</p></div><div class=paragraph><p>Emellett még az inetd démonnak az <code>inetd_flags</code> változón keresztül különbözõ parancssori paramétereket is át tudunk adni.</p></div></div><div class=sect3><h4 id=network-inetd-cmdline>29.2.3. Parancssori paraméterek<a class=anchor href=#network-inetd-cmdline></a></h4><div class=paragraph><p>Hasonlóan a legtöbb szerverhez, az inetd viselkedését is befolyásolni tudjuk a parancssorban átadható különbözõ paraméterekkel. Ezek teljes listája a következõ:</p></div><div class=paragraph><p><code>inetd [-d] [-l] [-w] [-W] [-c maximum] [-C arány] [-a cím | név] [-p állomány] [-R arány] [-s maximum] [konfigurációs állomány]</code></p></div><div class=paragraph><p>Ezek a paraméterek az <span class=filename>/etc/rc.conf</span> állományban az <code>inetd_flags</code> segítségével adhatóak meg az inetd részére. Alapértelmezés szerint az <code>inetd_flags</code> értéke <code>-wW -C 60</code>, ami az inetd által biztosított szolgáltatások TCP protokollon keresztüli wrappelését kapcsolja be, illetve egy IP-címrõl nem engedi a felkínált szolgáltatások elérését percenként hatvannál többször.</p></div><div class=paragraph><p>A kezdõ felhasználók örömmel nyugtázhatják, hogy ezeket az alapbeállításokat nem szükséges módosítaniuk. A késõbbiekben majd fény derül arra, hogy a kiszolgálás gyakoriságának szabályozása remek védekezést nyújthat túlzottan nagy mennyiségû kapcsolódási kérelem ellen. A megadható paraméterek teljes listája az <a href="https://man.freebsd.org/cgi/man.cgi?query=inetd&amp;sektion=8&amp;format=html">inetd(8)</a> man oldalán olvasható.</p></div><div class=dlist><dl><dt class=hdlist1>-c <em>maximum</em></dt><dd><p>Az egyes szolgáltatásokhoz egyszerre felépíthetõ kapcsolatok alapértelmezett maximális számát adja meg. Alapból ezt a démont nem korlátozza. A <code>max-child</code> beállítással ez akár szolgáltatásonként külön is megadható.</p></dd><dt class=hdlist1>-C <em>arány</em></dt><dd><p>Korlátozza, hogy egyetlen IP-címrõl alapból hányszor hívhatóak meg az egyes szolgáltatások egy percen belül. Ez az érték alapból korlátlan. A <code>max-connections-per-ip-per-minute</code> beállítással ez szolgáltatásonként is definiálható.</p></dd><dt class=hdlist1>-R <em>arány</em></dt><dd><p>Megadja, hogy egy szolgáltatást egy perc alatt mennyiszer lehet meghívni. Ez az érték alapértelmezés szerint 256. A 0 megadásával eltöröljük ezt a típusú korlátozást.</p></dd><dt class=hdlist1>-s <em>maximum</em></dt><dd><p>Annak maximumát adja meg, hogy egyetlen IP-címrõl egyszerre az egyes szolgáltatásokat mennyiszer tudjuk elérni. Alapból ez korlátlan. Szolgáltatásonként ezt a <code>max-child-per-ip</code> paraméterrel tudjuk felülbírálni.</p></dd></dl></div></div><div class=sect3><h4 id=network-inetd-conf>29.2.4. Az <span class=filename>inetd.conf</span> állomány<a class=anchor href=#network-inetd-conf></a></h4><div class=paragraph><p>Az inetd beállítását az <span class=filename>/etc/inetd.conf</span> konfigurációs állományon keresztül végezhetjük el.</p></div><div class=paragraph><p>Amikor az <span class=filename>/etc/inetd.conf</span> állományban módosítunk valamit, az inetd démont a következõ paranccsal meg kell kérnünk, hogy olvassa újra:</p></div><div id=network-inetd-reread class=exampleblock><div class=title>Példa 33. Az inetd konfigurációs állományának újraolvasása</div><div class=content><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># /etc/rc.d/inetd reload</span></code></pre></div></div></div></div><div class=paragraph><p>A konfigurációs állomány minden egyes sora egy-egy démont ír le. A megjegyzéseket egy "#" jel vezeti be. Az <span class=filename>/etc/inetd.conf</span> állomány bejegyzéseinek formátuma az alábbi:</p></div><div class="literalblock programlisting"><div class=content><pre>szolgáltatás-neve
socket-típusa
protokoll
{wait|nowait}[/max-child[/max-connections-per-ip-per-minute[/max-child-per-ip]]]
felhasználó[:csoport][/bejelentkezési-osztály]
szerver-program
szerver-program-paraméterei</pre></div></div><div class=paragraph><p>Az IPv4 protokollt használó <a href="https://man.freebsd.org/cgi/man.cgi?query=ftpd&amp;sektion=8&amp;format=html">ftpd(8)</a> démon bejegyzése például így néz ki:</p></div><div class="literalblock programlisting"><div class=content><pre>ftp     stream  tcp     nowait  root    /usr/libexec/ftpd       ftpd -l</pre></div></div><div class=dlist><dl><dt class=hdlist1>szolgáltatás-neve</dt><dd><p>Ez az adott démon által képviselt szolgáltatást nevezi meg, amelynek szerepelnie kell az <span class=filename>/etc/services</span> állományban. Ez határozza meg, hogy az inetd milyen porton figyelje a beérkezõ kapcsolatokat. Ha egy új szolgáltatást hozunk létre, akkor azt elõször az <span class=filename>/etc/services</span> állományba kell felvennünk.</p></dd><dt class=hdlist1>csatlakozás-típusa</dt><dd><p>Ennek az értéke <code>stream</code>, <code>dgram</code>, <code>raw</code>, vagy <code>seqpacket</code> lehet. A <code>stream</code> típust használja a legtöbb kapcsolat-orientált TCP démon, miközben a <code>dgram</code> típus az UDP szállítási protokollt alkalmazó démonok esetében használatos.</p></dd><dt class=hdlist1>protokoll</dt><dd><p>Valamelyik a következõk közül:</p><table class="tableblock frame-none grid-all stretch informaltable"><col style=width:50%><col style=width:50%><thead><tr><th class="tableblock halign-left valign-top">Protokoll</th><th class="tableblock halign-left valign-top">Magyarázat</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class=tableblock>tcp, tcp4</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>TCP IPv4</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>udp, udp4</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>UDP IPv4</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>tcp6</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>TCP IPv6</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>udp6</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>UDP IPv6</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>tcp46</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>TCP IPv4 és v6</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>udp46</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>UDP IPv4 és v6</p></td></tr></tbody></table></dd><dt class=hdlist1>{wait|nowait}[/max-child[/max-connections-per-ip-per-minute[/max-child-per-ip]]]</dt><dd><p>A <code>wait|nowait</code> beállítás mondja meg, hogy az inetd démonból meghívott démon saját maga képes-e kezelni kapcsolatokat. A <code>dgram</code> típusú kapcsolatok esetében egyértelmûen a <code>wait</code> beállítást kell használni, miközben a <code>stream</code> esetén, ahol általában több szálon dolgozunk, a <code>nowait</code> megadása javasolt. A <code>wait</code> hatására általában egyetlen démonnak adunk át több socketet, míg a <code>nowait</code> minden sockethez egy újabb példányt indít el.</p><div class=paragraph><p>Az inetd által indítható példányokat a <code>max-child</code> megadásával korlátozhatjuk. Ha tehát például az adott démon számára legfeljebb példány létrehozását engedélyezzük, akkor a <code>nowait</code> után <code>/10</code> beállítást kell megadnunk. A <code>/0</code> használatával korlátlan mennyiségû példányt engedélyezhetünk.</p></div><div class=paragraph><p>A <code>max-child</code> mellett még további két másik beállítás jöhet számításba az egyes démonok által kezelhetõ kapcsolatok maximális számának korlátozásában. A <code>max-connections-per-ip-per-minute</code> az egyes IP-címekrõl befutó lekezelhetõ kapcsolatok percenkénti számát szabályozza, így például ha itt a tizes értéket adjuk meg, akkor az adott szolgáltatáshoz egy IP-címrõl percenként csak tízszer férhetünk hozzá. A <code>max-child-per-ip</code> az egyes IP-címekhez egyszerre elindítható példányok számára ír elõ egy korlátot. Ezek a paraméterek segítenek megóvni rendszerünket az erõforrások akaratos vagy akaratlan kimerítésétõl és a DoS (Denial of Service) típusú támadásoktól.</p></div><div class=paragraph><p>Ebben a mezõben a <code>wait</code> vagy <code>nowait</code> valamelyikét kötelezõ megadni. A <code>max-child</code>, <code>max-connections-per-ip-per-minute</code> és <code>max-child-per-ip</code> paraméterek ellenben elhagyhatóak.</p></div><div class=paragraph><p>A <code>stream</code> típusú több szálon futó démonok a <code>max-child</code>, <code>max-connections-per-ip-per-minute</code> vagy <code>max-child-per-ip</code> korlátozása nélkül egyszerûen csak így adhatóak meg: <code>nowait</code>.</p></div><div class=paragraph><p>Ha ugyanezt a démont tíz kapcsolatra lekorlátozzuk, akkor a következõt kell megadnunk: <code>nowait/10</code>.</p></div><div class=paragraph><p>Amikor pedig IP-címenként 20 kapcsolatot engedélyezünk percenként és mindössze 10 példányt, akkor: <code>nowait/10/20</code>.</p></div><div class=paragraph><p>Az iménti beállítások a <a href="https://man.freebsd.org/cgi/man.cgi?query=fingerd&amp;sektion=8&amp;format=html">fingerd(8)</a> démon alapértelmezett paramétereinél is megtalálhatóak:</p></div><div class="literalblock programlisting"><div class=content><pre>finger stream  tcp     nowait/3/10 nobody /usr/libexec/fingerd fingerd -s</pre></div></div><div class=paragraph><p>Végezetül engedélyezzük 100 példányt, melyek közül IP-címenként 5 használható: <code>nowait/100/0/5</code>.</p></div></dd><dt class=hdlist1>felhasználó</dt><dd><p>Ezzel azt a felhasználót adjuk meg, akinek a nevében az adott démon futni fog. Az esetek túlnyomó részében a démonokat a <code>root</code> felhasználó futtatja. Láthatjuk azonban, hogy biztonsági okokból bizonyos démonok a <code>daemon</code> vagy a legkevesebb joggal rendelkezõ <code>nobody</code> felhasználóval futnak.</p></dd><dt class=hdlist1>szerver-program</dt><dd><p>A kapcsolat felépülésekor az itt teljes elérési úttal megadott démon indul el. Ha ezt a szolgáltatást maga az inetd belsõleg valósítja meg, akkor ebben a mezõben az <code>internal</code> értéket adjuk meg.</p></dd><dt class=hdlist1>szerver-program-paraméterei</dt><dd><p>Ez a <code>szerver-program</code> beállítással együtt mûködik, és ebben a mezõben a démon meghívásakor alkalmazandó paramétereket tudjuk rögzíteni, amelyet a démon nevével kezdünk. Ha a démont a parancssorból a <code>sajátdémon -d</code> paranccsal hívnánk meg, akkor a <code>sajátdémon -d</code> lesz <code>szerver-program-paraméterei</code> beállítás helyes értéke is. Természetesen, ha a démon egy belsõleg megvalósított szolgáltatás, akkor ebben a mezõben is az <code>internal</code> fog megjelenni.</p></dd></dl></div></div><div class=sect3><h4 id=network-inetd-security>29.2.5. Védelem<a class=anchor href=#network-inetd-security></a></h4><div class=paragraph><p>Attól függõen, hogy a telepítés során mit választottunk, az inetd által támogatott szolgáltatások egyes része talán alapból engedélyezett is. Amennyiben egy adott démont konkrétan nem használunk, akkor érdemes megfontolni a letiltását. A kérdéses démon sorába tegyünk egy "#" jelet az <span class=filename>/etc/inetd.conf</span> állományba, majd <a href=#network-inetd-reread>olvastassuk újra az inetd beállításait</a>. Egyes démonok, mint például az fingerd használata egyáltalán nem ajánlott, mivel a támadók számára hasznos információkat tudnak kiszivárogtatni.</p></div><div class=paragraph><p>Más démonok nem ügyelnek a védelemre, és a kapcsolatokhoz rendelt lejárati idejük túlságosan hosszú vagy éppen nincs is. Ezzel a támadónak lehetõsége van lassú kapcsolatokkal leterhelni az adott démont, ezáltal kimeríteni a rendszer erõforrásait. Ha úgy találjuk, hogy túlságosan sok az ilyen kapcsolat, akkor jó ötletnek bizonyulhat a démonok számára a <code>max-connections-per-ip-per-minute</code>, <code>max-child</code> vagy <code>max-child-per-ip</code> korlátozások elrendelése.</p></div><div class=paragraph><p>Alapértelmezés szerint a TCP kapcsolatok wrappelése engedélyezett. A <a href="https://man.freebsd.org/cgi/man.cgi?query=hosts_access&amp;sektion=5&amp;format=html">hosts_access(5)</a> man oldalon találhatjuk meg az inetd által meghívható különféle démonok TCP-alapú korlátozásainak lehetõségeit.</p></div></div><div class=sect3><h4 id=network-inetd-misc>29.2.6. Egyéb lehetõségek<a class=anchor href=#network-inetd-misc></a></h4><div class=paragraph><p>A daytime, time, echo, discard, chargen és auth szolgáltatások feladatainak mindegyikét maga az inetd is képes ellátni.</p></div><div class=paragraph><p>Az auth szolgáltatás a hálózati keresztül azonosítást teszi lehetõvé és bizonyos mértékig beállítható. A többit egyszerûen csak kapcsoljuk ki vagy be.</p></div><div class=paragraph><p>A témában az <a href="https://man.freebsd.org/cgi/man.cgi?query=inetd&amp;sektion=8&amp;format=html">inetd(8)</a> man oldalán tudunk még jobban elmerülni.</p></div></div></div><div class=sect2><h3 id=network-nfs>29.3. A hálózati állományrendszer (NFS)<a class=anchor href=#network-nfs></a></h3><div class=paragraph><p>A FreeBSD több állományrendszert ismer, köztük a hálózati állományrendszert (Network File System, NFS) is. Az NFS állományok és könyvtárak megosztását teszi lehetõvé a hálózaton keresztül. Az NFS használatával a felhasználók és a programok képesek majdnem úgy elérni a távoli rendszereken található állományokat, mintha helyben léteznének.</p></div><div class=paragraph><p>Íme az NFS néhány legjelentõsebb elõnye:</p></div><div class=ulist><ul><li><p>A helyi munkaállomások kevesebb tárterületet használnak, mivel a közös adatokat csak egyetlen számítógépen tároljuk és megosztjuk mindenki között.</p></li><li><p>A felhasználóknak nem kell a hálózat minden egyes gépén külön felhasználói könyvtárral rendelkezniük. Ezek ugyanis az NFS segítségével akár egy szerveren is beállíthatóak és elérhetõvé tehetõek a hálózaton keresztül.</p></li><li><p>A különbözõ háttértárak, mint például a floppy lemezek, CD-meghajtók és Zip® meghajtók a hálózaton több számítógép között megoszthatóak. Ezzel csökkenteni tudjuk a hálózatunkban szükséges cserélhetõ lemezes eszközök számát.</p></li></ul></div><div class=sect3><h4 id=_ahogy_az_nfs_mûködik>29.3.1. Ahogy az NFS mûködik<a class=anchor href=#_ahogy_az_nfs_mûködik></a></h4><div class=paragraph><p>Az NFS legalább két fõ részbõl rakható össze: egy szerverbõl és egy vagy több kliensbõl. A kliensek a szerver által megosztott adatokhoz képesek távolról hozzáférni. A megfelelõ mûködéshez mindössze csak néhány programot kell beállítani és futtatni.</p></div><div class=paragraph><p>A szervernek a következõ démonokat kell mûködtetnie:</p></div><table class="tableblock frame-none grid-all stretch informaltable"><col style=width:50%><col style=width:50%><thead><tr><th class="tableblock halign-left valign-top">Démon</th><th class="tableblock halign-left valign-top">Leírás</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class=tableblock>nfsd</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Az NFS démon, amely kiszolgálja az NFS kliensektõl érkezõ kéréseket.</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>mountd</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Az NFS csatlakoztató démonja, amely végrehajtja az <a href="https://man.freebsd.org/cgi/man.cgi?query=nfsd&amp;sektion=8&amp;format=html">nfsd(8)</a> által átküldött kéréseket.</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>rpcbind</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Ez a démon lehetõvé teszi az NFS kliensek számára, hogy fel tudják deríteni az NFS szerver által használt portot.</p></td></tr></tbody></table><div class=paragraph><p>A kliensen is futnia kell egy démonnak, amelynek a neve nfsiod. Az nfsiod démon az NFS szerver felõl érkezõ kéréseket szolgálja ki. A használata teljesen opcionális, csupán a teljesítményt hívatott javítani, de a normális és helyes mûködéshez nincs rá szükségünk. Az <a href="https://man.freebsd.org/cgi/man.cgi?query=nfsiod&amp;sektion=8&amp;format=html">nfsiod(8)</a> man oldalán errõl többet is megtudhatunk.</p></div></div><div class=sect3><h4 id=network-configuring-nfs>29.3.2. Az NFS beállítása<a class=anchor href=#network-configuring-nfs></a></h4><div class=paragraph><p>Az NFS beállítása viszonylag egyértelmûen adja magát. A mûködéséhez szükséges programok automatikus elindítása csupán néhány apró módosítást igényel az <span class=filename>/etc/rc.conf</span> állományban.</p></div><div class=paragraph><p>Az NFS szerveren gondoskodjunk róla, hogy az alábbi beállítások szerepeljenek az <span class=filename>/etc/rc.conf</span> állományban:</p></div><div class="literalblock programlisting"><div class=content><pre>rpcbind_enable=&#34;YES&#34;
nfs_server_enable=&#34;YES&#34;
mountd_flags=&#34;-r&#34;</pre></div></div><div class=paragraph><p>A mountd magától el fog indulni, ha az NFS szervert engedélyezzük.</p></div><div class=paragraph><p>A kliensen a következõ beállítást kell felvennünk az <span class=filename>/etc/rc.conf</span> állományba:</p></div><div class="literalblock programlisting"><div class=content><pre>nfs_client_enable=&#34;YES&#34;</pre></div></div><div class=paragraph><p>Az <span class=filename>/etc/exports</span> állomány adja meg, hogy az NFS milyen állományrendszereket exportáljon (vagy másképpen szólva "osszon meg"). Az <span class=filename>/etc/exports</span> állományban tehát a megosztani kívánt állományrendszereket kell szerepeltetnünk, és azt, hogy melyik számítógépekkel tudjuk ezeket elérni. A gépek megnevezése mellett a hozzáférésre további megszorításokat írhatunk fel. Ezek részletes leírását az <a href="https://man.freebsd.org/cgi/man.cgi?query=exports&amp;sektion=5&amp;format=html">exports(5)</a> man oldalon találjuk meg.</p></div><div class=paragraph><p>Lássunk néhány példát az <span class=filename>/etc/exports</span> állományban megjelenõ bejegyzésekre:</p></div><div class=paragraph><p>A most következõ példákban az állományrendszerek exportálásának finomságait igyekszünk érzékeltetni, noha a konkrét beállítások gyakran a rendszerünktõl és a hálózati konfigurációtól függenek. Például, ha a <span class=filename>/cdrom</span> könytárat akarjuk három gép számára megosztani, akik a szerverrel megegyezõ tartományban találhatóak (ezért nem is kell megadnunk a tartományt) vagy mert egyszerûen megtalálhatók az <span class=filename>/etc/hosts</span> állományunkban. Az <code>-ro</code> beállítás az exportált állományrendszereket írásvédetté teszi. Ezzel a beállítással a távoli rendszerek nem lesznek képesek módosítani az exportált állományrendszer tartalmát.</p></div><div class="literalblock programlisting"><div class=content><pre>/cdrom -ro gép1 gép2 gép3</pre></div></div><div class=paragraph><p>A következõ sorban a <span class=filename>/home</span> könyvtárat három gép számára osztjuk meg, melyeket IP-címekkel adtunk meg. Ez olyan helyi hálózat esetén hasznos, ahol nem állítottunk be névfeloldást. Esetleg a belsõ hálózati neveket az <span class=filename>/etc/hosts</span> állományban is tárolhatjuk. Ezzel utóbbival kapcsolatban a <a href="https://man.freebsd.org/cgi/man.cgi?query=hosts&amp;sektion=5&amp;format=html">hosts(5)</a> man oldalt érdemes fellapoznunk. Az <code>-alldirs</code> beállítás lehetõvé teszi, hogy az alkönyvtárak is csatlakozási pontok lehessenek. Más szóval, nem fogja csatlakoztatni az alkönyvtárakat, de megengedi a kliensek számára, hogy csak azokat a könyvtárakat csatlakoztassák, amelyeket kell vagy amelyekre szükségünk van.</p></div><div class="literalblock programlisting"><div class=content><pre>/home  -alldirs  10.0.0.2 10.0.0.3 10.0.0.4</pre></div></div><div class=paragraph><p>A következõ sorban az <span class=filename>/a</span> könyvtárat úgy exportáljuk, hogy az állományrendszerhez két különbözõ tartományból is hozzá lehessen férni. A <code>-maproot=root</code> beállítás hatására a távoli rendszer <code>root</code> felhasználója az exportált állományrendszeren szintén <code>root</code> felhasználóként fogja írni az adatokat. Amennyiben a <code>-maproot=root</code> beállítást nem adjuk meg, akkor a távoli rendszeren hiába <code>root</code> az adott felhasználó, az exportált állományrendszeren nem lesz képes egyetlen állományt sem módosítani.</p></div><div class="literalblock programlisting"><div class=content><pre>/a  -maproot=root  gep.minta.com doboz.haz.org</pre></div></div><div class=paragraph><p>A kliensek is csak a megfelelõ engedélyek birtokában képesek elérni a megosztott állományrendszereket. Ezért a klienst ne felejtsük el felvenni a szerver <span class=filename>/etc/exports</span> állományába.</p></div><div class=paragraph><p>Az <span class=filename>/etc/exports</span> állományban az egyes sorok az egyes állományrendszerekre és az egyes gépekre vonatkoznak. A távoli gépek állományrendszerenként csak egyszer adhatóak meg, és csak egy alapértelmezett bejegyzésük lehet. Például tegyük fel, hogy a <span class=filename>/usr</span> egy önálló állományrendszer. Ennek megfelelõen az alábbi bejegyzések az <span class=filename>/etc/exports</span> állományban érvénytelenek:</p></div><div class="literalblock programlisting"><div class=content><pre># Nem használható, ha a /usr egy állományrendszer:
/usr/src   kliens
/usr/ports kliens</pre></div></div><div class=paragraph><p>Egy állományrendszerhez, vagyis itt a <span class=filename>/usr</span> partícióhoz, két export sort is megadtunk ugyanahhoz a <code>kliens</code> nevû géphez. Helyesen így kell megoldani az ilyen helyzeteket:</p></div><div class="literalblock programlisting"><div class=content><pre>/usr/src /usr/ports  kliens</pre></div></div><div class=paragraph><p>Az adott géphez tartozó egy állományrendszerre vonatkozó exportoknak mindig egy sorban kell szerepelniük. A kliens nélkül felírt sorok egyetlen géphez tartozónak fognak számítani. Ezzel az állományrendszerek megosztását tudjuk szabályozni, de legtöbbek számára nem jelent gondot.</p></div><div class=paragraph><p>Most egy érvényes exportlista következik, ahol a <span class=filename>/usr</span> és az <span class=filename>/exports</span> mind helyi állományrendszerek:</p></div><div class="literalblock programlisting"><div class=content><pre># Osszuk meg az src és ports könyvtárakat a kliens01 és kliens02 részére, de csak a
# kliens01 férhessen hozzá rendszeradminisztrátori jogokkal:
/usr/src /usr/ports -maproot=root    kliens01
/usr/src /usr/ports               kliens02
# A kliensek az /exports könyvtárban teljes joggal rendelkeznek és azon belül
# bármit tudnak csatlakoztatni. Rajtuk kívül mindenki csak írásvédetten képes
# elérni az /exports/obj könyvtárat:
/exports -alldirs -maproot=root      kliens01 kliens02
/exports/obj -ro</pre></div></div><div class=paragraph><p>A mountd démonnal az <span class=filename>/etc/exports</span> állományt minden egyes módosítása után újra be kell olvastatni, mivel a változtatásaink csak így fognak érvényesülni. Ezt megcsinálhatjuk úgy is, hogy küldünk egy HUP (hangup, avagy felfüggesztés) jelzést a már futó démonnak:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># kill -HUP `cat /var/run/mountd.pid`</span></code></pre></div></div><div class=paragraph><p>vagy meghívjuk a <code>mountd</code> <a href="https://man.freebsd.org/cgi/man.cgi?query=rc&amp;sektion=8&amp;format=html">rc(8)</a> szkriptet a megfelelõ paraméterrel:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># /etc/rc.d/mountd onereload</span></code></pre></div></div><div class=paragraph><p>Az <a href=./#configtuning-rcd>Az rc használata FreeBSD alatt</a>ban tudhatunk meg részleteket az rc szkriptek használatáról.</p></div><div class=paragraph><p>Ezek után akár a FreeBSD újraindításával is aktiválhatjuk a megosztásokat, habár ez nem feltétlenül szükséges. Ha <code>root</code> felhasználónként kiadjuk a következõ parancsokat, akkor azzal minden szükséges programot elindítunk.</p></div><div class=paragraph><p>Az NFS szerveren tehát:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># rpcbind</span>
<span class=c># nfsd -u -t -n 4</span>
<span class=c># mountd -r</span></code></pre></div></div><div class=paragraph><p>Az NFS kliensen pedig:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># nfsiod -n 4</span></code></pre></div></div><div class=paragraph><p>Ezzel most már minden készen áll a távoli állományrendszer csatlakoztatására. A példákban a szerver neve <code>szerver</code> lesz, valamint a kliens neve <code>kliens</code>. Ha csak ideiglenesen akarunk csatlakoztatni egy állományrendszert vagy egyszerûen csak ki akarjuk próbálni a beállításainkat, a kliensen <code>root</code> felhasználóként az alábbi parancsot hajtsuk végre:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># mount szerver:/home /mnt</span></code></pre></div></div><div class=paragraph><p>Ezzel a szerveren található <span class=filename>/home</span> könyvtárat fogjuk a kliens <span class=filename>/mnt</span> könyvtárába csatlakoztatni. Ha mindent jól beállítottunk, akkor a kliensen most már be tudunk lépni az <span class=filename>/mnt</span> könyvtárba és láthatjuk a szerveren található állományokat.</p></div><div class=paragraph><p>Ha a számítógép indításával automatikusan akarunk hálózati állományrendszereket csatlakoztatni, akkor vegyük fel ezeket az <span class=filename>/etc/fstab</span> állományba. Erre íme egy példa:</p></div><div class="literalblock programlisting"><div class=content><pre>szerver:/home	/mnt	nfs	rw	0	0</pre></div></div><div class=paragraph><p>Az <a href="https://man.freebsd.org/cgi/man.cgi?query=fstab&amp;sektion=5&amp;format=html">fstab(5)</a> man megtalálhatjuk az összes többi beállítást.</p></div></div><div class=sect3><h4 id=_zárolások>29.3.3. Zárolások<a class=anchor href=#_zárolások></a></h4><div class=paragraph><p>Bizonyos alkalmazások (például a mutt) csak akkor mûködnek megfelelõen, ha az állományokat a megfelelõ módon zárolják. Az NFS esetében az rpc.lockd használható az ilyen zárolások megvalósítására. Az engedélyezéséhez mind a szerveren és a kliensen vegyük fel a következõ sort az <span class=filename>/etc/rc.conf</span> állományba (itt már feltételezzük, hogy az NFS szervert és klienst korábban beállítottuk):</p></div><div class="literalblock programlisting"><div class=content><pre>rpc_lockd_enable=&#34;YES&#34;
rpc_statd_enable=&#34;YES&#34;</pre></div></div><div class=paragraph><p>A következõ módon indíthatjuk el:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># /etc/rc.d/lockd start</span>
<span class=c># /etc/rc.d/statd start</span></code></pre></div></div><div class=paragraph><p>Ha nincs szükségünk valódi zárolásra az NFS kliensek és az NFS szerver között, akkor megcsinálhatjuk azt is, hogy az NFS kliensen a <a href="https://man.freebsd.org/cgi/man.cgi?query=mount_nfs&amp;sektion=8&amp;format=html">mount_nfs(8)</a> programnak az <code>-L</code> paraméter átadásával csak helyileg végzünk zárolást. Ennek további részleterõl a <a href="https://man.freebsd.org/cgi/man.cgi?query=mount_nfs&amp;sektion=8&amp;format=html">mount_nfs(8)</a> man oldalon kaphatunk felvilágosítást.</p></div></div><div class=sect3><h4 id=_gyakori_felhasználási_módok>29.3.4. Gyakori felhasználási módok<a class=anchor href=#_gyakori_felhasználási_módok></a></h4><div class=paragraph><p>Az NFS megoldását a gyakorlatban rengeteg esetben alkalmazzák. Ezek közül most felsoroljuk a legelterjedtebbeket:</p></div><div class=ulist><ul><li><p>Több gép között megosztunk egy telepítõlemezt vagy más telepítõeszközt. Ez így sokkal olcsóbb és gyakorta kényelmes megoldás abban az esetben, ha egyszerre több gépre akarjuk ugyanazt a szoftvert telepíteni.</p></li><li><p>Nagyobb hálózatokon sokkal kényelmesebb lehet egy központi NFS szerver használata, ahol a felhasználók könyvtárait tároljuk. Ezek a felhasználói könyvtárak aztán megoszthatóak a hálózaton keresztül, így a felhasználók mindig ugyanazt a könyvárat kapják függetlenül attól, hogy milyen munkaállomásról is jelentkeztek be.</p></li><li><p>Több géppel is képes így osztozni az <span class=filename>/usr/ports/distfiles</span> könyvtáron. Ezen a módon sokkal gyorsabban tudunk portokat telepíteni a gépekre, mivel nem kell külön mindegyikre letölteni az ehhez szükséges forrásokat.</p></li></ul></div></div><div class=sect3><h4 id=network-amd>29.3.5. Automatikus csatlakoztatás az amd használatával<a class=anchor href=#network-amd></a></h4><div class=paragraph><p>Az <a href="https://man.freebsd.org/cgi/man.cgi?query=amd&amp;sektion=8&amp;format=html">amd(8)</a> (automatikus csatlakoztató démon, az automatic mounter daemon) önmûködõen csatlakoztatja a távoli állományrendszereket, amikor azokon belül valamelyik állományhoz vagy könyvtárhoz próbálunk hozzáférni. Emellett az amd az egy ideje már inaktív állományrendszereket is automatikusan leválasztja. Az amd használata egy remek alternatívát kínál az általában az <span class=filename>/etc/fstab</span> állományban megjelenõ állandóan csatlakoztatott állományrendszerekkel szemben.</p></div><div class=paragraph><p>Az amd úgy mûködik, hogy kapcsolódik egy NFS szerver <span class=filename>/host</span> és <span class=filename>/net</span> könyvtáraihoz. Amikor egy állományt akarunk elérni ezeken a könyvtárakon belül, az amd kikeresi a megfelelõ távoli csatlakoztatást és magától csatlakoztatja. A <span class=filename>/net</span> segítségével egy IP-címrõl tudunk exportált állományrendszereket csatlakoztatni, miközben a <span class=filename>/host</span> a távoli gép hálózati neve esetében használatos.</p></div><div class=paragraph><p>Ha tehát a <span class=filename>/host/izemize/usr</span> könyvtárban akarunk elérni egy állományt, akkor az amd démonnak ahhoz elõször az <code>izemize</code> nevû géprõl exportált <span class=filename>/usr</span> könyvtárat kell csatlakoztatnia.</p></div><div class=exampleblock><div class=title>Példa 34. Egy exportált állományrendszer csatlakoztatása az amd használatával</div><div class=content><div class=paragraph><p>Egy távoli számítógép által rendelkezésre bocsátott megosztásokat a <code>showmount</code> paranccsal tudjuk lekérdezni. Például az <code>izemize</code> gépen elérhetõ exportált állományrendszereket így láthatjuk:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>% showmount <span class=nt>-e</span> izemize
Exports list on izemize:
/usr                               10.10.10.0
/a                                 10.10.10.0
% <span class=nb>cd</span> /host/izemize/usr</code></pre></div></div></div></div><div class=paragraph><p>Ahogy a példában látjuk is, a <code>showmount</code> parancs a <span class=filename>/usr</span> könyvtárat mutatja megosztásként. Amikor tehát belépünk a <span class=filename>/host/izemize/usr</span> könyvtárba, akkor amd magától megpróbálja feloldani az <code>izemize</code> hálózati nevet és csatlakoztatni az elérni kívánt exportált állományrendszert.</p></div><div class=paragraph><p>Az amd az indító szkripteken keresztül az <span class=filename>/etc/rc.conf</span> alábbi beállításával engedélyezhetõ:</p></div><div class="literalblock programlisting"><div class=content><pre>amd_enable=&#34;YES&#34;</pre></div></div><div class=paragraph><p>Emellett még az <code>amd_flags</code> használatával további paraméterek is átadható az amd felé. Alapértelmezés szerint az <code>amd_flags</code> tartalmaz az alábbi:</p></div><div class="literalblock programlisting"><div class=content><pre>amd_flags=&#34;-a /.amd_mnt -l syslog /host /etc/amd.map /net /etc/amd.map&#34;</pre></div></div><div class=paragraph><p>Az <span class=filename>/etc/amd.map</span> állomány adja meg az exportált állományrendszerek alapértelmezett beállításait. Az <span class=filename>/etc/amd.conf</span> állományban az amd további lehetõségeit konfigurálhatjuk..</p></div><div class=paragraph><p>Ha többet is szeretnénk tudni a témáról, akkor az <a href="https://man.freebsd.org/cgi/man.cgi?query=amd&amp;sektion=8&amp;format=html">amd(8)</a> és az <a href="https://man.freebsd.org/cgi/man.cgi?query=amd.conf&amp;sektion=8&amp;format=html">amd.conf(8)</a> man oldalakat javasolt elolvasnunk.</p></div></div><div class=sect3><h4 id=network-nfs-integration>29.3.6. Problémák más rendszerek használatakor<a class=anchor href=#network-nfs-integration></a></h4><div class=paragraph><p>Némely PC-s ISA buszos Ethernet kártyákra olyan korlátozások érvényesek, melyek komoly hálózati problémák keletkezéséhez vezethetnek, különösen az NFS esetében. Ez a nehézség nem FreeBSD-függõ, de a FreeBSD rendszereket is érinti.</p></div><div class=paragraph><p>Ez gond általában majdnem mindig akkor merül fel, amikor egy (FreeBSD-s) PC egy hálózatba kerül többek közt a Silicon Graphic és a Sun Microsystems által gyártott nagyteljesítményû munkaállomásokkal. Az NFS csatlakoztatása és bizonyos mûveletek még hibátlanul végrehajtódnak, azonban hirtelen a szerver látszólag nem válaszol többet a kliens felé úgy, hogy a többi rendszertõl folyamatosan dolgozza felfele a kéréseket. Ez a kliens rendszeren tapasztalható csak, amikor a kliens FreeBSD vagy egy munkaállomás. Sok rendszeren egyszerûen rendesen le sem lehet állítani a klienst, ha a probléma egyszer már felütötte a fejét. Egyedüli megoldás gyakran csak a kliens újraindítása marad, mivel az NFS-ben kialakult helyzetet máshogy nem lehet megoldani.</p></div><div class=paragraph><p>Noha a "helyes" megoldás az lenne, ha beszereznénk egy nagyobb teljesítményû és kapacitású kártyát a FreeBSD rendszer számára, azonban egy jóval egyszerûbb kerülõút is található a kielégítõ mûködés eléréséhez. Ha a FreeBSD rendszer képviseli a <em>szervert</em>, akkor a kliensnél adjuk meg a <code>-w=1024</code> beállítást is a csatlakoztatásnál. Ha a FreeBSD rendszer a <em>kliens</em> szerepét tölti be, akkor az NFS állományrendszert az <code>-r=1024</code> beállítással csatlakoztassuk róla. Ezek a beállítások az <span class=filename>fstab</span> állomány negyedik mezõjében is megadhatóak az automatikus csatlakoztatáshoz, vagy manuális esetben a <a href="https://man.freebsd.org/cgi/man.cgi?query=mount&amp;sektion=8&amp;format=html">mount(8)</a> parancsnak a <code>-o</code> paraméterrel.</p></div><div class=paragraph><p>Hozzá kell azonban tennünk, hogy létezik egy másik probléma, amit gyakran ezzel tévesztenek össze, amikor az NFS szerverek és kliensek nem ugyanabban a hálózatban találhatóak. Ilyen esetekben mindenképpen <em>gyõzõdjünk meg róla</em>, hogy az útválasztók rendesen továbbküldik a mûködéshez szükséges UDP információkat, különben nem sokat tudunk tenni a megoldás érdekében.</p></div><div class=paragraph><p>A most következõ példákban a <code>gyorsvonat</code> lesz a nagyteljesítményû munkaállomás (felület) neve, illetve a <code>freebsd</code> pedig a gyengébb teljesítményû Ethernet kártyával rendelkezõ FreeBSD rendszer (felület) neve. A szerveren az <span class=filename>/osztott</span> nevû könyvtárat fogjuk NFS állományrendszerként exportálni (lásd <a href="https://man.freebsd.org/cgi/man.cgi?query=exports&amp;sektion=5&amp;format=html">exports(5)</a>), amelyet majd a <span class=filename>/projekt</span> könyvtárba fogunk csatlakoztatni a kliensen. Minden esetben érdemes lehet még megadnunk a <code>hard</code> vagy <code>soft</code>, illetve <code>bg</code> opciókat is.</p></div><div class=paragraph><p>Ebben a példában a FreeBSD rendszer (<code>freebsd</code>) lesz a kliens, és az <span class=filename>/etc/fstab</span> állományában így szerepel az exportált állományrendszer:</p></div><div class="literalblock programlisting"><div class=content><pre>gyorsvonat:/osztott /projekt nfs rw,-r=1024 0 0</pre></div></div><div class=paragraph><p>És így tudjuk manuálisan csatlakoztatni:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># mount -t nfs -o -r=1024 gyorsvonat:/osztott /projekt</span></code></pre></div></div><div class=paragraph><p>Itt a FreeBSD rendszer lesz a szerver, és a <code>gyorsvonat</code><span class=filename>/etc/fstab</span> állománya így fog kinézni:</p></div><div class="literalblock programlisting"><div class=content><pre>freebsd:/osztott /projekt nfs rw,-w=1024 0 0</pre></div></div><div class=paragraph><p>Manuálisan így csatlakoztathatjuk az állományrendszert:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># mount -t nfs -o -w=1024 freebsd:/osztott /projekt</span></code></pre></div></div><div class=paragraph><p>Szinte az összes 16 bites Ethernet kártya képes mûködni a fenti írási vagy olvasási korlátozások nélkül is.</p></div><div class=paragraph><p>A kíváncsibb olvasók számára eláruljuk, hogy pontosan miért is következik be ez a hiba, ami egyben arra is magyarázatot ad, hogy miért nem tudjuk helyrehozni. Az NFS általában 8 kilobyte-os "blokkokkal" dolgozik (habár kisebb méretû darabkákat is tud készíteni). Mivel az Ethernet által kezelt legnagyobb méret nagyjából 1500 byte, ezért az NFS "blokkokat" több Ethernet csomagra kell osztani - még olyankor is, ha ez a program felsõbb rétegeiben osztatlan egységként látszik - ezt aztán fogadni kell, összerakni és <em>nyugtázni</em> mint egységet. A nagyteljesítményû munkaállomások a szabvány által még éppen megengedett szorossággal képesek ontani magukból az egy egységhez tartozó csomagokat, közvetlenül egymás után. A kisebb, gyengébb teljesítményû kártyák esetében azonban az egymáshoz tartozó, késõbb érkezõ csomagok ráfutnak a korábban megkapott csomagokra még pontosan azelõtt, hogy elérnék a gépet, így az egységek nem állíthatóak össze vagy nem nyugtázhatóak. Ennek eredményeképpen a munkaállomás egy adott idõ múlva megint próbálkozik, de ismét az egész 8 kilobyte-os blokkot küldi el, ezért ez a folyamat a végtelenségig ismétlõdik.</p></div><div class=paragraph><p>Ha a küldendõ egységek méretét az Ethernet által kezelt csomagok maximális mérete alá csökkentjük, akkor biztosak lehetünk benne, hogy a teljes Ethernet csomag egyben megérkezik és nyugtázódik, így elkerüljük a holtpontot.</p></div><div class=paragraph><p>A nagyteljesítményû munkaállomások természetesen továbbra is küldhetnek a PC-s rendszerek felé túlfutó csomagokat, de egy jobb kártyával az ilyen túlfutások nem érintik az NFS által használt "egységeket". Amikor egy ilyen túlfutás bekövetkezik, az érintett egységet egyszerûen újra elküldik, amelyet a rákövetkezõ alkalommal nagy valószínûséggel már tudunk rendesen fogadni, összerakni és nyugtázni.</p></div></div></div><div class=sect2><h3 id=network-nis>29.4. Hálózati információs rendszer (NIS/YP)<a class=anchor href=#network-nis></a></h3><div class=sect3><h4 id=_mi_ez>29.4.1. Mi ez?<a class=anchor href=#_mi_ez></a></h4><div class=paragraph><p>A hálózati információs szolgáltatást (Network Information Service, avagy NIS) a Sun Microsystems fejlesztette ki a UNIX® (eredetileg SunOS™) rendszerek központosított karbantartásához. Mostanra már lényegében ipari szabvánnyá nõtte ki magát, hiszen az összes nagyobb UNIX®-szerû rendszer (a Solaris™, HP-UX, AIX®, Linux, NetBSD, OpenBSD, FreeBSD stb.) támogatja a NIS használatát.</p></div><div class=paragraph><p>A NIS régebben sárga oldalak (Yellow Pages) néven volt ismert, de a különbözõ jogi problémák miatt késõbb ezt a Sun megváltoztatta. A régi elnevezést (és a yp rövidítést) azonban még napjainkban is lehet néhol látni.</p></div><div class=paragraph><p>Ez egy RPC alapján mûködõ, kliens/szerver felépítésû rendszer, amely az egy NIS tartomány belül levõ számítógépek számára teszi lehetõvé ugyanazon konfigurációs állományok használatát. Segítségével a rendszergazda a NIS klienseket a lehetõ legkevesebb adat hozzáadásával, eltávolításával vagy módosításával képes egyetlen helyrõl beállítani.</p></div><div class=paragraph><p>Hasonló a Windows NT® tartományaihoz, és habár a belsõ implementációt tekintve már akadnak köztük jelentõs eltérések is, az alapvetõ funkciók szintjén mégis összevethetõek.</p></div></div><div class=sect3><h4 id=_a_témához_tartozó_fogalmak_és_programok>29.4.2. A témához tartozó fogalmak és programok<a class=anchor href=#_a_témához_tartozó_fogalmak_és_programok></a></h4><div class=paragraph><p>A NIS telepítése számos fogalom és fontos felhasználói program kerül elõ FreeBSD-n, akár egy NIS szervert akarunk beállítani, akár csak egy NIS klienst:</p></div><table class="tableblock frame-none grid-all stretch informaltable"><col style=width:50%><col style=width:50%><thead><tr><th class="tableblock halign-left valign-top">Fogalom</th><th class="tableblock halign-left valign-top">Leírás</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class=tableblock>NIS tartománynév</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>A NIS központi szerverei és az összes hozzájuk tartozó kliens (beleértve az alárendelt szervereket) rendelkezik egy NIS tartománynévvel. Hasonló a Windows NT® által használt tartománynevekhez, de a NIS tartománynevei semmilyen kapcsolatban nem állnak a névfeloldással.</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>rpcbind</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Az RPC (Remote Procedure Call, a NIS által használt egyik hálózati protokoll) engedélyezéséhez lesz rá szükségünk. Ha az rpcbind nem fut, akkor sem NIS szervert, sem pedig NIS klienst nem tudunk mûködtetni.</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>ypbind</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>A NIS klienst "köti össze" a hozzá tartozó NIS szerverrel. A NIS tartománynevet a rendszertõl veszi, és az RPC használatával csatlakozik a szerverhez. Az ypbind a NIS környezet kliens és szerver közti kommunikációjának magját alkotja. Ha az ypbind leáll a kliens gépén, akkor nem tudjuk elérni a NIS szervert.</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>ypserv</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Csak a NIS szervereken szabad futnia, mivel ez maga a NIS szerver programja. Ha az <a href="https://man.freebsd.org/cgi/man.cgi?query=ypserv&amp;sektion=8&amp;format=html">ypserv(8)</a> leáll, akkor a szerver nem lesz képes tovább kiszolgálni a NIS kéréseket (szerencsére az alárendelt szerverek képesek átvenni ezeket). A NIS bizonyos változatai (de nem az, amelyik a FreeBSD-ben is megjelenik) nem próbálnak meg más szerverekhez csatlakozni, ha bedöglik az aktuális használt szerver. Ezen gyakran egyedül csak a szervert képviselõ program (vagy akár az egész szerver) újraindítása segíthet, illetve az ypbind újraindítása a kliensen.</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>rpc.yppasswdd</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Ez egy olyan program, amelyet csak a NIS központi szerverein kell csak futtatni. Ez a démon a NIS kliensek számára a NIS jelszavaik megváltoztatását teszi lehetõvé. Ha ez a démon nem fut, akkor a felhasználók csak úgy tudják megváltoztatni a jelszavukat, ha bejelentkeznek a központi NIS szerverre.</p></td></tr></tbody></table></div><div class=sect3><h4 id=_hogyan_mûködik_2>29.4.3. Hogyan mûködik?<a class=anchor href=#_hogyan_mûködik_2></a></h4><div class=paragraph><p>A NIS környezetekben háromféle gép létezik: a központi szerverek, az alárendelt szerverek és a kliensek. A szerverek képezik a gépek konfigurációs információinak központi tárhelyét. A központi szerverek tárolják ezen információk hiteles másolatát, míg ezt az alárendelt szerverek redundánsan tükrözik. A kliensek a szerverekre támaszkodnak ezen információk beszerzéséhez.</p></div><div class=paragraph><p>Sok állomány tartalma megosztható ezen a módon. Például a <span class=filename>master.passwd</span>, a <span class=filename>group</span> és <span class=filename>hosts</span> állományokat meg szokták osztani NFS-en. Amikor a kliensen futó valamelyik programnak olyan információra lenne szüksége, amely általában ezekben az állományokban nála megtalálható lenne, akkor helyette a NIS szerverhez fordul.</p></div><div class=sect4><h5 id=_a_gépek_típusai>29.4.3.1. A gépek típusai<a class=anchor href=#_a_gépek_típusai></a></h5><div class=ulist><ul><li><p>A <em>központi NIS szerver</em>. Ez a szerver, amely leginkább a Windows NT® elsõdleges tartományvezérlõjéhez hasonlítható tartja karban az összes, NIS kliensek által használt állományt. A <span class=filename>passwd</span>, <span class=filename>group</span>, és összes többi ehhez hasonló állomány ezen a központi szerveren található meg.</p><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Egy gép akár több NIS tartományban is lehet központi szerver. Ezzel a lehetõséggel viszont itt most nem foglalkozunk, mivel most csak egy viszonylag kis méretû NIS környezetet feltételezünk.</p></div></td></tr></tbody></table></div></li><li><p>Az <em>alárendelt NIS szerverek</em>. A Windows NT® tartalék tartományvezérlõihez hasonlítanak, és az alárendelt NIS szerverek feladata a központi NIS szerveren tárolt adatok másolatainak karbantartása. Az alárendelt NIS szerverek a redundancia megvalósításában segítenek, aminek leginkább a fontosabb környezetekben van szerepe. Emellett a központi szerver terhelésének kiegyenlítését is elvégzik. A NIS kliensek elsõként mindig ahhoz a NIS szerverhez csatlakoznak, amelytõl elõször választ kapnak, legyen akár az egy alárendelt szerver.</p></li><li><p>A <em>NIS kliensek</em>. A NIS kliensek, hasonlóan a Windows NT® munkaállomásokhoz, a NIS szerveren (amely a Windows NT® munkaállomások esetében a tartományvezérlõ) keresztül jelentkeznek be.</p></li></ul></div></div></div><div class=sect3><h4 id=_a_nisyp_használata>29.4.4. A NIS/YP használata<a class=anchor href=#_a_nisyp_használata></a></h4><div class=paragraph><p>Ebben a szakaszban egy példa NIS környezetet állítunk be.</p></div><div class=sect4><h5 id=_tervezés>29.4.4.1. Tervezés<a class=anchor href=#_tervezés></a></h5><div class=paragraph><p>Tegyük fel, hogy egy aprócska egyetemi labor rendszergazdái vagyunk. A labor, mely 15 FreeBSD-s gépet tudhat magáénak, jelen pillanatban még semmilyen központosított adminisztráció nem létezik. Mindegyik gép saját <span class=filename>/etc/passwd</span> és <span class=filename>/etc/master.passwd</span> állománnyal rendelkezik. Ezeket az állományokat saját kezûleg kell szinkronban tartani. Tehát ha most felveszünk egy felhasználót a laborhoz, akkor az <code>adduser</code> parancsot mind a 15 gépen ki kell adni. Egyértelmû, hogy ez így nem maradhat, ezért úgy döntöttük, hogy a laborban NIS-t fogunk használni, és két gépet kinevezünk szervernek.</p></div><div class=paragraph><p>Az iméntieknek megfelelõen a labor most valahogy így néz ki:</p></div><table class="tableblock frame-none grid-all stretch informaltable"><col style=width:33.3333%><col style=width:33.3333%><col style=width:33.3334%><thead><tr><th class="tableblock halign-left valign-top">A gép neve</th><th class="tableblock halign-left valign-top">IP-cím</th><th class="tableblock halign-left valign-top">A gép szerepe</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>ellington</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock><code>10.0.0.2</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>központi NIS</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>coltrane</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock><code>10.0.0.3</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>alárendelt NIS</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>basie</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock><code>10.0.0.4</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>tanszéki munkaállomás</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>bird</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock><code>10.0.0.5</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>kliensgép</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>cli[1-11]</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock><code>10.0.0.[6-17]</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>a többi kliensgép</p></td></tr></tbody></table><div class=paragraph><p>Ha még nincs tapasztalatunk a NIS rendszerek összeállításában, akkor elõször jó ötlet lehet végiggondolni, miként is akarjuk kialakítani. A hálózatunk méretétõl függetlenül is akadnak olyan döntések, amelyeket mindenképpen meg kell hoznunk.</p></div><div class=sect5><h6 id=_a_nis_tartománynév_megválasztása>29.4.4.1.1. A NIS tartománynév megválasztása<a class=anchor href=#_a_nis_tartománynév_megválasztása></a></h6><div class=paragraph><p>Ez nem az a "tartománynév", amit megszokhattunk. Ennek a pontos neve "NIS tartománynév". Amikor a kliensek kérnek valamilyen információt, akkor megadják annak a NIS tartománynak a nevét is, amelynek részei. Így tud egy hálózaton több szerver arról dönteni, hogy melyikük melyik kérést válaszolja meg. A NIS által használt tartománynévre tehát inkább úgy érdemes gondolni, mint egy valamilyen módon összetartozó gépek közös nevére.</p></div><div class=paragraph><p>Elõfordul, hogy egyes szervezetek az interneten is nyilvántartott tartománynevüket választják NIS tartománynévnek. Ez alapvetõen nem ajánlott, mivel a hálózati problémák felderítése közben félreértéseket szülhet. A NIS tartománynévnek a hálózatunkon belül egyedinek kell lennie, és lehetõleg minél jobban írja le az általa csoportba sorolt gépeket. Például a Kis Kft. üzleti osztályát tegyük a "kis-uzlet" NIS tartományba. Ebben a példában most a <code>proba-tartomany</code> nevet választottuk.</p></div><div class=paragraph><p>A legtöbb operációs rendszer azonban (köztük a SunOS™) a NIS tartománynevet használja internetes tartománynévként is. Ha a hálózatunkon egy vagy több ilyen gép is található, akkor a NIS tartomány nevének az internetes tartománynevet <em>kell</em> megadnunk.</p></div></div><div class=sect5><h6 id=_a_szerverek_fizikai_elvárásai>29.4.4.1.2. A szerverek fizikai elvárásai<a class=anchor href=#_a_szerverek_fizikai_elvárásai></a></h6><div class=paragraph><p>Nem árt néhány dolgot fejben tartani, amikor a NIS szervernek használt gépet kiválasztjuk. Az egyik ilyen szerencsétlen dolog az a szintû függõség, ami a NIS kliensek felõl megfigyelhetõ a szerverek felé. Ha egy kliens nem tudja a NIS tartományon belül felvenni a kapcsolatot valamelyik szerverrel, akkor az a gép könnyen megbízhatatlanná válhat. Felhasználói- és csoportinformációk nélkül a legtöbb rendszer egy idõre le is merevedik. Ennek figyelembevételével tehát olyan gépet kell szervernek választanunk, amelyet nem kell gyakran újraindítani, és nem végzünk rajta semmilyen komoly munkát. A célnak legjobban megfelelõ NIS szerverek valójában olyan gépek, amelyek egyedüli feladata csak a NIS kérések kiszolgálása. Ha a hálózatunk nem annyira leterhelt, akkor még a NIS szerver mellett más programokat is futtathatunk, de ne feledjük, hogy ha a NIS szolgáltatás megszûnik, akkor az az <em>összes</em> NIS kliensen éreztetni fogja kedvezõtlen hatását.</p></div></div></div><div class=sect4><h5 id=_a_nis_szerverek>29.4.4.2. A NIS szerverek<a class=anchor href=#_a_nis_szerverek></a></h5><div class=paragraph><p>A NIS rendszerben tárolt összes információ általános példánya egyetlen gépen található meg, amelyet a központi NIS szervernek hívunk. Az információk tárolására szánt adatbázis pedig NIS táblázatoknak (NIS map) nevezzük. FreeBSD alatt ezek a táblázatok a <span class=filename>/var/yp/tartománynév</span> könyvtárban találhatóak, ahol a <span class=filename>tartománynév</span> a kiszolgált NIS tartományt nevezi meg. Egyetlen NIS szerver egyszerre akár több tartományt is kiszolgálhat, így itt több könyvtár is található, minden támogatott tartományhoz egy. Minden tartomány saját, egymástól független táblázatokkal rendelkezik.</p></div><div class=paragraph><p>A központi és alárendelt NIS szerverek az <code>ypserv</code> démon segítségével dolgozzák fel a NIS kéréseket. Az <code>ypserv</code> felelõs a NIS kliensektõl befutó kérések fogadásáért, és a kért tartomány valamint táblázat nevébõl meghatározza az adatbázisban tárolt állományt, majd innen visszaküldi a hozzá tartozó adatot a kliensnek.</p></div><div class=sect5><h6 id=_a_központi_nis_szerver_beállítása>29.4.4.2.1. A központi NIS szerver beállítása<a class=anchor href=#_a_központi_nis_szerver_beállítása></a></h6><div class=paragraph><p>A központi NIS szerver beállítása viszonylag magától értetõdõ, de a nehézségét az igényeink szabják meg. A FreeBSD alapból támogatja a NIS használatát. Ezért mindössze annyit kell tennünk, hogy a következõ sorokat betesszük az <span class=filename>/etc/rc.conf</span> állományba, és a FreeBSD gondoskodik a többirõl.</p></div><div class="exampleblock procedure"><div class=content><div class="literalblock programlisting"><div class=content><pre>nisdomainname=&#34;proba-tartomany&#34;</pre></div></div><div class="olist arabic"><ol class=arabic><li><p>Ez a sor adja meg a hálózati beállítások (vagy például az újraindítás) során a NIS tartomány nevét, amely a korábbiak szerint itt most a <code>proba-tartomany</code>.</p></li></ol></div><div class="literalblock programlisting"><div class=content><pre>nis_server_enable=&#34;YES&#34;</pre></div></div><div class="olist arabic"><ol class=arabic><li><p>Ezzel utasítjuk a FreeBSD-t, hogy a hálózati alkalmazások következõ indításakor a NIS szervert is aktiválja.</p></li></ol></div><div class="literalblock programlisting"><div class=content><pre>nis_yppasswdd_enable=&#34;YES&#34;</pre></div></div><div class=paragraph><p>Ezzel engedélyezzük az <code>rpc.yppasswdd</code> démont, amely a korábban említettek szerint lehetõvé teszi a felhasználók számára, hogy a közvetlenül a kliensekrõl változtassák meg a NIS jelszavukat.</p></div></div></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>A konkrét NIS beállításainktól függõen további bejegyzések felvételére is szükségünk lehet. Erre késõbb még <a href=#network-nis-server-is-client>"az olyan NIS szervereknél, amelyek egyben NIS kliensek"</a>, vissza fogunk térni.</p></div></td></tr></tbody></table></div><div class=paragraph><p>Miután ezeket beállítottuk, rendszeradminisztrátorként adjuk ki az <code>/etc/netstart</code> parancsot. Az <span class=filename>/etc/rc.conf</span> állományban szereplõ adatok alapján mindent beállít magától. Még mielõtt inicializálnánk a NIS táblázatokat, indítsuk el manuálisan az ypserv démont:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># /etc/rc.d/ypserv start</span></code></pre></div></div></div><div class=sect5><h6 id=_a_nis_táblázatok_inicializálása>29.4.4.2.2. A NIS táblázatok inicializálása<a class=anchor href=#_a_nis_táblázatok_inicializálása></a></h6><div class=paragraph><p>A <em>NIS táblázatok</em> lényegében a <span class=filename>/var/yp</span> könyvtárban tárolt adatbázisok. A központi NIS szerver <span class=filename>/etc</span> könyvtárában található konfigurációs állományokból állítódnak elõ, egyetlen kivétellel: ez az <span class=filename>/etc/master.passwd</span> állomány. Ennek megvan a maga oka, hiszen nem akarjuk a <code>root</code> és az összes többi fontosabb felhasználóhoz tartozó jelszót az egész NIS tartománnyal megosztani. Ennek megfelelõen a NIS táblázatok inicializálásához a következõt kell tennünk:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># cp /etc/master.passwd /var/yp/master.passwd</span>
<span class=c># cd /var/yp</span>
<span class=c># vi master.passwd</span></code></pre></div></div><div class=paragraph><p>El kell távolítanunk az összes rendszerszintû (<code>bin</code>, <code>tty</code>, <code>kmem</code>, <code>games</code>, stb), és minden olyan egyéb hozzáférést, amelyeket nem akarjuk közvetíteni a NIS kliensek felé (például a <code>root</code> és minden más nullás, vagyis rendszeradminisztrátori azonosítóval ellátott hozzáférést).</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Gondoskodjunk róla, hogy az <span class=filename>/var/yp/master.passwd</span> állomány sem a csoport, sem pedig bárki más számára nem olvasható (600-as engedély)! Ennek beállításához használjuk az <code>chmod</code> parancsot, ha szükséges.</p></div></td></tr></tbody></table></div><div class=paragraph><p>Ha végeztünk, akkor már tényleg itt az ideje inicializálni NIS táblázatainkat. A FreeBSD erre egy <code>ypinit</code> nevû szkriptet ajánl fel (errõl a saját man oldalán tudhatunk meg többet). Ez a szkript egyébként a legtöbb UNIX® típusú operációs rendszeren megtalálható, de nem az összesen. A Digital UNIX/Compaq Tru64 UNIX rendszereken ennek a neve <code>ypsetup</code>. Mivel most a központi NIS szerver táblázatait hozzuk létre, azért az <code>ypinit</code> szkriptnek át kell adnunk a <code>-m</code> opciót is. A NIS táblázatok elõállításánál feltételezzük, hogy a fentebb ismertetett lépéseket már megtettük, majd kiadjuk ezt a parancsot:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>ellington# ypinit <span class=nt>-m</span> proba-tartomany
Server Type: MASTER Domain: proba-tartomany
Creating an YP server will require that you answer a few questions.
Questions will all be asked at the beginning of the procedure.
Do you want this procedure to quit on non-fatal errors? <span class=o>[</span>y/n: n] n
Ok, please remember to go back and redo manually whatever fails.
If you don<span class=s1>&#39;t, something might not work.
At this point, we have to construct a list of this domains YP servers.
rod.darktech.org is already known as master server.
Please continue to add any slave servers, one per line. When you are
done with the list, type a &lt;control D&gt;.
master server   :  ellington
next host to add:  coltrane
next host to add:  ^D
The current list of NIS servers looks like this:
ellington
coltrane
Is this correct?  [y/n: y] y

[ .. a táblázatok generálása .. ]

NIS Map update completed.
ellington has been setup as an YP master server without any errors.</span></code></pre></div></div><div class=paragraph><p>Az üzenetek fordítása:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>A szerver típusa: KÖZPONTI, tartomány: proba-tartomany
Az YP szerver létrehozásához meg kell válaszolni néhány kérdést az
eljárás megkezdése előtt.
Szeretnénk, ha az eljárás megszakadna a nem végzetes hibák esetén is? <span class=o>[</span>i/n: n] n
Rendben, akkor ne felejtsük el manuálisan kijavítani a hibát, ha
valamivel gond lenne.  Ha nem tesszük meg, akkor előfordulhat, hogy
valami nem fog rendesen működni.  Most össze kell állítanunk egy listát
a tartomány YP szervereiről.
Jelenleg a rod.darktech.org a központi szerver.
Kérjünk, adjon meg további alárendelt szervereket, soronként egyet.
Amikor ezt befejeztük, a &lt;control D&gt; lenyomásával tudunk
kilépni.
központi szerver : ellington
következő gép    : coltrane
következő gép    : ^D
A NIS szerverek listája jelenleg a következő:
ellington
coltrane
Ez megfelelő?  <span class=o>[</span>i/n: i] i

<span class=o>[</span> .. a táblázatok generálása .. <span class=o>]</span>

A NIS táblázatok sikeressen frissültek.
Az elligon szervert minden hiba nélkül sikerült központi szerverként
beállítani.</code></pre></div></div><div class=paragraph><p>Az <code>ypinit</code> a <span class=filename>/var/yp/Makefile.dist</span> állományból létrehozza a <span class=filename>/var/yp/Makefile</span> állományt. Amennyiben ez létrejött, az állomány feltételezi, hogy csak FreeBSD-s gépek részvételével akarunk kialakítani egy egyszerveres NIS környezetet. Mivel a <code>proba-tartomany</code> még egy alárendelt szervert is tartalmaz, ezért át kell írnunk a <span class=filename>/var/yp/Makefile</span> állományt:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>ellington# vi /var/yp/Makefile</code></pre></div></div><div class=paragraph><p>Ezt a sort kell megjegyzésbe tennünk:</p></div><div class="literalblock programlisting"><div class=content><pre>NOPUSH = &#34;True&#34;</pre></div></div><div class=paragraph><p>(ha még nem lenne úgy).</p></div></div><div class=sect5><h6 id=_az_alárendelt_nis_szerverek_beállítása>29.4.4.2.3. Az alárendelt NIS szerverek beállítása<a class=anchor href=#_az_alárendelt_nis_szerverek_beállítása></a></h6><div class=paragraph><p>Az alárendelt NIS szerverek beállítása még a központinál is egyszerûbb. Jelentkezzünk be az alárendelt szerverre és az eddigieknek megfelelõen írjuk át az <span class=filename>/etc/rc.conf</span> állományt. Az egyetlen különbség ezúttal csupán annyi lesz, hogy az <code>ypinit</code> lefuttatásakor a <code>-s</code> opciót kell megadnunk (mint slave, vagyis alárendelt). A <code>-s</code> opció használatához a központi NIS szerver nevét is át kell adnunk, ezért a konkrét parancs valahogy így fog kinézni:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>coltrane# ypinit <span class=nt>-s</span> ellington proba-tartomany

Server Type: SLAVE Domain: test-domain Master: ellington

Creating an YP server will require that you answer a few questions.
Questions will all be asked at the beginning of the procedure.

Do you want this procedure to quit on non-fatal errors? <span class=o>[</span>y/n: n]  n

Ok, please remember to go back and redo manually whatever fails.
If you don<span class=s1>&#39;t, something might not work.
There will be no further questions. The remainder of the procedure
should take a few minutes, to copy the databases from ellington.
Transferring netgroup...
ypxfr: Exiting: Map successfully transferred
Transferring netgroup.byuser...
ypxfr: Exiting: Map successfully transferred
Transferring netgroup.byhost...
ypxfr: Exiting: Map successfully transferred
Transferring master.passwd.byuid...
ypxfr: Exiting: Map successfully transferred
Transferring passwd.byuid...
ypxfr: Exiting: Map successfully transferred
Transferring passwd.byname...
ypxfr: Exiting: Map successfully transferred
Transferring group.bygid...
ypxfr: Exiting: Map successfully transferred
Transferring group.byname...
ypxfr: Exiting: Map successfully transferred
Transferring services.byname...
ypxfr: Exiting: Map successfully transferred
Transferring rpc.bynumber...
ypxfr: Exiting: Map successfully transferred
Transferring rpc.byname...
ypxfr: Exiting: Map successfully transferred
Transferring protocols.byname...
ypxfr: Exiting: Map successfully transferred
Transferring master.passwd.byname...
ypxfr: Exiting: Map successfully transferred
Transferring networks.byname...
ypxfr: Exiting: Map successfully transferred
Transferring networks.byaddr...
ypxfr: Exiting: Map successfully transferred
Transferring netid.byname...
ypxfr: Exiting: Map successfully transferred
Transferring hosts.byaddr...
ypxfr: Exiting: Map successfully transferred
Transferring protocols.bynumber...
ypxfr: Exiting: Map successfully transferred
Transferring ypservers...
ypxfr: Exiting: Map successfully transferred
Transferring hosts.byname...
ypxfr: Exiting: Map successfully transferred

coltrane has been setup as an YP slave server without any errors.
Don&#39;</span>t forget to update map ypservers on ellington.</code></pre></div></div><div class=paragraph><p>Most már lennie kell egy <span class=filename>/var/yp/proba-tartomany</span> nevû könyvtárunknak is. A központi NIS szerver táblázatainak másolata itt fognak tárolódni. Ezeket soha ne felejtsük el frissen tartani. Az alárendelt szervereken a következõ <span class=filename>/etc/crontab</span> bejegyzések pontosan ezt a feladatot látják el:</p></div><div class="literalblock programlisting"><div class=content><pre>20      *       *       *       *       root   /usr/libexec/ypxfr passwd.byname
21      *       *       *       *       root   /usr/libexec/ypxfr passwd.byuid</pre></div></div><div class=paragraph><p>Ez a két sor gondoskodik róla, hogy az alárendelt szerverek ne felejtsék el egyeztetni a táblázataikat a központi szerver táblázataival. Ezek a bejegyzések nem nélkülözhetetlenek a megfelelõ mûködéshez, mivel a központi szerver automatikusan feltölti az alárendelt szerverekre a létrejött változásokat. Mivel azonban a jelszavak létfontosságúak a szervertõl függõ rendszerek számára, ezért ajánlott explicit módon is elõírni a frissítést. Ez a forgalmasabb hálózatokon nagyobb jelentõséggel bír, mivel ott a táblázatok frissítése nem mindig fejezõdik be rendesen.</p></div><div class=paragraph><p>Most pedig futassuk le a <code>/etc/netstart</code> parancsot az alárendelt szervereken is, amivel így elindul a NIS szerver.</p></div></div></div><div class=sect4><h5 id=_a_nis_kliensek>29.4.4.3. A NIS kliensek<a class=anchor href=#_a_nis_kliensek></a></h5><div class=paragraph><p>A NIS kliens az <code>ypbind</code> démon segítségével egy kötésnek (bind) nevezett kapcsolatot épít ki egy adott NIS szerverrel. Az <code>ypbind</code> ellenõrzi a rendszer alapértelmezett tartományát (ezt a <code>domainname</code> paranccsal állítottunk be), majd RPC kéréseket kezd szórni a helyi hálózaton. Ezek a kérések annak a tartománynak a nevét tartalmazzák, amelyhez az <code>ypbind</code> megpróbál kötést létrehozni. Ha az adott tartomány kiszolgálására beállított szerver észleli ezeket a kéréseket, akkor válaszol az <code>ypbind</code> démonnak, amely pedig feljegyzi a szerver címét. Ha több szerver is elérhetõ (például egy központi és több alárendelt), akkor az <code>ypbind</code> az elsõként válaszoló címét fogja rögzíteni. Innentõl kezdve a kliens közvetlenül ennek a szervernek fogja küldeni a NIS kéréseit. Az <code>ypbind</code> idõnként "megpingeli" a szervert, hogy meggyõzõdjön az elérhetõségérõl. Ha az <code>ypbind</code> egy adott idõn belül nem kap választ a ping kéréseire, akkor megszünteti a kötést a tartományhoz és nekilát keresni egy másik szervert.</p></div><div class=sect5><h6 id=_a_nis_kliensek_beállítása>29.4.4.3.1. A NIS kliensek beállítása<a class=anchor href=#_a_nis_kliensek_beállítása></a></h6><div class=paragraph><p>Egy FreeBSD-s gépet NIS kliensként meglehetõsen egyszerûen lehet beállítani.</p></div><div class="exampleblock procedure"><div class=content><div class="olist arabic"><ol class=arabic><li><p>Nyissuk meg az <span class=filename>/etc/rc.conf</span> állományt és a NIS tartománynév beállításához, valamint az <code>ypbind</code> elindításához a következõket írjuk bele:</p><div class="literalblock programlisting"><div class=content><pre>nisdomainname=&#34;proba-tartomany&#34;
nis_client_enable=&#34;YES&#34;</pre></div></div></li><li><p>A NIS szerveren található jelszavak importálásához távolítsuk el az összes felhasználói hozzáférést az <span class=filename>/etc/master.passwd</span> állományunkból és a <code>vipw</code> segítségével adjuk hozzá az alábbi sort az állomány végéhez:</p><div class="literalblock programlisting"><div class=content><pre>+:::::::::</pre></div></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Ez a sor beenged bárkit a rendszerünkre, akinek a NIS szervereken van érvényes hozzáférése. A NIS klienseket ezzel a sorral sokféle módon tudjuk állítani. A <a href=#network-netgroups>hálózati csoportokról szóló szakaszban</a> találunk majd errõl több információt. A téma mélyebb megismeréséhez az O’Reilly <code>Managing NFS and NIS</code> címû könyvét ajánljuk.</p></div></td></tr></tbody></table></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Legalább helyi hozzáférést (vagyis amit nem NIS-en keresztül importálunk) azonban mindenképpen hagyjunk meg az <span class=filename>/etc/master.passwd</span> állományunkban, és ez a hozzáférés legyen a <code>wheel</code> csoport tagja. Ha valami gond lenne a NIS használatával, akkor ezen a hozzáférésen keresztül tudunk a gépre távolról bejelentkezni, majd innen <code>root</code> felhasználóra váltva megoldani a felmerült problémákat.</p></div></td></tr></tbody></table></div></li><li><p>A NIS szerverrõl az összes lehetséges csoport-bejegyzést az <span class=filename>/etc/group</span> állományban így tudjuk importálni:</p><div class="literalblock programlisting"><div class=content><pre>+:*::</pre></div></div></li></ol></div></div></div><div class=paragraph><p>Miután elvégeztük ezeket a lépéseket, képesek leszünk futtatni az <code>ypcat passwd</code> parancsot, és látni a NIS szerver jelszavakat tartalmazó táblázatát.</p></div></div></div></div><div class=sect3><h4 id=_a_nis_biztonsága>29.4.5. A NIS biztonsága<a class=anchor href=#_a_nis_biztonsága></a></h4><div class=paragraph><p>Általában tetszõleges távoli felhasználó küldhet RPC kéréseket az <a href="https://man.freebsd.org/cgi/man.cgi?query=ypserv&amp;sektion=8&amp;format=html">ypserv(8)</a> számára és kérheti le a NIS táblázatok tartalmát, feltéve, hogy ismeri a tartomány nevét. Az ilyen hitelesítés nélküli mûveletek ellen az <a href="https://man.freebsd.org/cgi/man.cgi?query=ypserv&amp;sektion=8&amp;format=html">ypserv(8)</a> úgy védekezik, hogy tartalmaz egy "securenets" nevû lehetõséget, amellyel az elérhetõségüket tudjuk leszûkíteni gépek egy csoportjára. Az <a href="https://man.freebsd.org/cgi/man.cgi?query=ypserv&amp;sektion=8&amp;format=html">ypserv(8)</a> indításakor ezeket az információkat a <span class=filename>/var/yp/securenets</span> állományból próbálja meg betölteni.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Az elérési útvonala megadható a <code>-p</code> opció használatával. Ez az állomány olyan bejegyzéseket tartalmaz, amelyekben egy hálózati cím és tõle láthatatlan karakterekkel elválasztva egy hálózati maszk szerepel. A "#" karakterrel kezdõdõ sorokat megjegyzésnek nyilvánítjuk. Egy minta securenets állomány valahogy így nézne ki:</p></div></td></tr></tbody></table></div><div class="literalblock programlisting"><div class=content><pre># Engedélyezzük önmagunkról a csatlakozást -- kell!
127.0.0.1     255.255.255.255
# Engedélyezzük a 192.168.128.0 hálózatról érkezõ csatlakozásokat:
192.168.128.0 255.255.255.0
# Engedélyezzük a laborban található 10.0.0.0 és 10.0.15.255 közti
# címekkel rendelkezõ gépek csatlakozását:
10.0.0.0      255.255.240.0</pre></div></div><div class=paragraph><p>Ha az <a href="https://man.freebsd.org/cgi/man.cgi?query=ypserv&amp;sektion=8&amp;format=html">ypserv(8)</a> olyan címrõl kap kérést, amely illeszkedik az elõírt címek valamelyikére, akkor a szokásos módon feldolgozza azt. Ellenkezõ esetben a kérést figyelmen kívül hagyja és egy figyelmeztetést vesz fel hozzá a naplóba. Ha a <span class=filename>/var/yp/securenets</span> állomány nem létezik, akkor az <code>ypserv</code> tetszõleges géprõl engedélyezi a csatlakozást.</p></div><div class=paragraph><p>Az <code>ypserv</code> lehetõséget ad a Wietse Venema által fejlesztett TCP Wrapper csomag használatára is. Ezzel a rendszergazda a <span class=filename>/var/yp/securenets</span> állomány helyett a TCP Wrapper konfigurációs állományai alapján képes szabályozni az elérhetõséget.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Miközben mind a két módszer nyújt valamilyen fajta védelmet, de a privilegizált portok teszteléséhez hasonlóan az "IP álcázásával" (IP spoofing) sebezhetõek. Ezért az összes NIS-hez tartozó forgalmat tûzfallal kell blokkolnunk.</p></div><div class=paragraph><p>Az <span class=filename>/var/yp/securenets</span> állományt használó szerverek nem képesek az elavult TCP/IP implementációkat használó érvényes klienseket rendesen kiszolgálni. Egyes ilyen implementációk a címben a géphez tartozó biteket nullára állítják az üzenetszóráshoz, és/vagy ezért az üzenetszóráshoz használt cím kiszámításakor nem tudja észleli a hálózati maszkot. A legtöbb ilyen probléma megoldható a kliens konfigurációjának megváltoztatásával, míg más problémák megoldása a kérdéses kliensek nyugdíjazását kívánják meg, vagy a <span class=filename>/var/yp/securenets</span> használatának elhagyását.</p></div><div class=paragraph><p>Egy régebbi TCP/IP implementációval üzemelõ szerveren pedig a <span class=filename>/var/yp/securenets</span> állomány használata kifejezetten rossz ötlet, és a hálózatunk nagy részében képes használhatatlanná tenni a NIS funkcióit.</p></div><div class=paragraph><p>A TCP Wrapper csomag alkalmazása a NIS szerverünk válaszadáshoz szükséges idejét is segít csökkenteni. Az ilyenkor jelentkezõ plusz késlekedés mellesleg elég nagy lehet ahhoz, hogy a klienseknél idõtúllépés következzen be, különösen a terheltebb hálózatokon vagy a lassú NIS szerverek esetében. Ha egy vagy több kliensünk is ilyen tüneteket mutat, akkor érdemes a kérdéses kliens rendszereket alárendelt NIS szerverekké alakítani és önmagukhoz rendelni.</p></div></td></tr></tbody></table></div></div><div class=sect3><h4 id=_egyes_felhasználók_bejelentkezésének_megakadályozása>29.4.6. Egyes felhasználók bejelentkezésének megakadályozása<a class=anchor href=#_egyes_felhasználók_bejelentkezésének_megakadályozása></a></h4><div class=paragraph><p>A laborunkban van egy <code>basie</code> nevû gép, amely a tanszék egyetlen munkaállomása. Ezt a gépet nem akarjuk kivenni a NIS tartományból, de a központi NIS szerver <span class=filename>passwd</span> állománya mégis egyaránt tartalmazza a hallgatók és az oktatók eléréseit. Mit lehet ilyenkor tenni?</p></div><div class=paragraph><p>Adott felhasználók esetében le tudjuk tiltani a bejelentkezést a gépen még olyankor is, ha léteznek a NIS adatbázisában. Ehhez mindössze a kliensen az <span class=filename>/etc/master.passwd</span> állomány végére be kell tennünk egy <code>-felhasználónév</code> sort, ahol a <em>felhasználónév</em> annak a felhasználónak a neve, akit nem akarunk beengedni a gépre. Ezt leginkább a <code>vipw</code> használatán keresztül érdemes megtennünk, mivel a <code>vipw</code> az <span class=filename>/etc/master.passwd</span> állomány alapján végez némi ellenõrzést, valamint a szerkesztés befejeztével magától újragenerálja a jelszavakat tároló adatbázist. Például, ha a <code>bill</code> nevû felhasználót ki akarjuk tiltani a <code>basie</code> nevû géprõl, akkor:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>basie# vipw
<span class=o>[</span>vegyük fel a <span class=nt>-bill</span> <span class=nb>sort </span>a végére, majd lépjünk ki]
vipw: rebuilding the database...
vipw: <span class=k>done

</span>basie# <span class=nb>cat</span> /etc/master.passwd

root:[jelszó]:0:0::0:0:The super-user:/root:/bin/csh
toor:[jelszó]:0:0::0:0:The other super-user:/root:/bin/sh
daemon:<span class=k>*</span>:1:1::0:0:Owner of many system processes:/root:/sbin/nologin
operator:<span class=k>*</span>:2:5::0:0:System &amp;:/:/sbin/nologin
bin:<span class=k>*</span>:3:7::0:0:Binaries Commands and Source,,,:/:/sbin/nologin
<span class=nb>tty</span>:<span class=k>*</span>:4:65533::0:0:Tty Sandbox:/:/sbin/nologin
kmem:<span class=k>*</span>:5:65533::0:0:KMem Sandbox:/:/sbin/nologin
games:<span class=k>*</span>:7:13::0:0:Games pseudo-user:/usr/games:/sbin/nologin
news:<span class=k>*</span>:8:8::0:0:News Subsystem:/:/sbin/nologin
man:<span class=k>*</span>:9:9::0:0:Mister Man Pages:/usr/shared/man:/sbin/nologin
<span class=nb>bind</span>:<span class=k>*</span>:53:53::0:0:Bind Sandbox:/:/sbin/nologin
uucp:<span class=k>*</span>:66:66::0:0:UUCP pseudo-user:/var/spool/uucppublic:/usr/libexec/uucp/uucico
xten:<span class=k>*</span>:67:67::0:0:X-10 daemon:/usr/local/xten:/sbin/nologin
pop:<span class=k>*</span>:68:6::0:0:Post Office Owner:/nonexistent:/sbin/nologin
nobody:<span class=k>*</span>:65534:65534::0:0:Unprivileged user:/nonexistent:/sbin/nologin
+:::::::::
<span class=nt>-bill</span>

basie#</code></pre></div></div></div><div class=sect3><h4 id=network-netgroups>29.4.7. A hálózati csoportok alkalmazása<a class=anchor href=#network-netgroups></a></h4><div class=paragraph><p>Az elõzõ szakaszban ismertetett módszer viszonylag jól mûködik olyan esetekben, amikor nagyon kevés felhasználóra és/vagy számítógépre kell alkalmaznunk speciális megszorításokat. A nagyobb hálózatokban szinte <em>biztos</em>, hogy elfelejtünk kizárni egyes felhasználókat az érzékeny gépekrõl, vagy az összes gépen egyenként kell ehhez a megfelelõ beállításokat elvégezni, és ezzel lényegében elvesztjük a NIS legfontosabb elõnyét, vagyis a <em>központosított</em> karbantarthatóságot.</p></div><div class=paragraph><p>A NIS fejlesztõi erre a problémára a <em>hálózati csoportokat</em> létrehozásával válaszoltak. A céljuk és mûködésük szempontjából leginkább a UNIX®-os állományrendszerekben található csoportokhoz mérhetõek. A legnagyobb eltérés a numerikus azonosítók hiányában mutatkozik meg, valamint a hálózati csoportokat a felhasználókon kívül további hálózati csoportok megadásával is ki lehet alakítani.</p></div><div class=paragraph><p>A hálózati csoportok a nagyobb, bonyolultabb, többszáz felhasználós hálózatok számára jöttek létre. Egy részrõl ez nagyon jó dolog, különösen akkor, ha egy ilyen helyzettel kell szembenéznünk. Másrészrõl ez a mértékû bonyolultság szinte teljesen lehetetlenné teszi a hálózati csoportok egyszerû bemutatását. A szakasz további részében használt példa is ezt a problémát igyekszik illusztrálni.</p></div><div class=paragraph><p>Tételezzük fel, hogy laborunkban a NIS sikeres bevezetése felkeltette a fõnökeink figyelmét. Így a következõ feladatunk az lett, hogy terjesszük ki a NIS tartományt az egyetemen található néhány másik gépre is. Az alábbi két táblázatban az új felhasználók és az új számítógép neveit találjuk, valamint a rövid leírásukat.</p></div><table class="tableblock frame-none grid-all stretch informaltable"><col style=width:50%><col style=width:50%><thead><tr><th class="tableblock halign-left valign-top">Felhasználók nevei</th><th class="tableblock halign-left valign-top">Leírás</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>alpha</code>, <code>beta</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>az IT tanszék hétköznapi dolgozói</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>charlie</code>, <code>delta</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>az IT tanszék újdonsült dolgozói</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>echo</code>, <code>foxtrott</code>, <code>golf</code>, …​</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>átlagos dolgozók</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>able</code>, <code>baker</code>, …​</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>ösztöndíjasok</p></td></tr></tbody></table><table class="tableblock frame-none grid-all stretch informaltable"><col style=width:50%><col style=width:50%><thead><tr><th class="tableblock halign-left valign-top">Gépek nevei</th><th class="tableblock halign-left valign-top">Leírás</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>haboru</code>, <code>halal</code>, <code>ehseg</code>, <code>szennyezes</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>A legfontosabb szervereink. Csak az IT tanszék dolgozói férhetnek hozzájuk.</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>buszkeseg</code>, <code>kapzsisag</code>, <code>irigyseg</code>, <code>harag</code>, <code>bujasag</code>, <code>lustasag</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Kevésbé fontos szerverek. Az IT tankszék összes tagja el tudja érni ezeket a gépeket.</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>egy</code>, <code>ketto</code>, <code>harom</code>, <code>negy</code>, …​</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Átlagos munkaállomások. Egyedül csak a <em>valódi</em> dolgozók jelentkezhetnek be ezekre a gépekre.</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>szemetes</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Egy nagyon régi gép, semmi értékes adat nincs rajta. Akár még az öszöndíjasok is nyúzhatják.</p></td></tr></tbody></table><div class=paragraph><p>Ha ezeket az igényeket úgy próbáljuk meg teljesíteni, hogy a felhasználókat egyenként blokkoljuk, akkor minden rendszer <span class=filename>passwd</span> állományába külön fel kell vennünk a <code>-felhasználó</code> sorokat a letiltott felhasználókhoz. Ha csak egyetlen bejegyzést is kihagyunk, akkor könnyen bajunk származhat belõle. Ez a rendszer kezdeti beállítása során még talán nem okoz gondot, de az új felhasználókat <em>biztosan</em> el fogjuk felejteni felvenni a megfelelõ csoportokba. Elvégre Murphy is optimista volt.</p></div><div class=paragraph><p>A hálózati csoportok használata ilyen helyzetekben számos elõnyt rejt. Nem kell az egyes felhasználókat külön felvenni, egy felhasználót felveszünk valamelyik csoportba vagy csoportokba, és a csoportok összes tagjának egyszerre tudjuk tiltani vagy engedélyezni a hozzáféréseket. Ha hozzáadunk egy új gépet a hálózatunkhoz, akkor mindössze a hálózati csoportok bejelentkezési korlátozásait kell beállítani. Ha új felhasználót veszünk fel, akkor a felhasználót kell vennünk egy vagy több hálózati csoportba. Ezek a változtatások függetlenek egymástól, és nincs szükség "minden felhasználó és minden gép összes kombinációjára". Ha a NIS beállításainkat elõzetesen körültekintõen megterveztük, akkor egyetlen központi konfigurációs állományt kell módosítani a gépek elérésének engedélyezéséhez vagy tiltásához.</p></div><div class=paragraph><p>Az elsõ lépés a hálózati csoportokat tartalmazó NIS táblázat inicializálása. A FreeBSD <a href="https://man.freebsd.org/cgi/man.cgi?query=ypinit&amp;sektion=8&amp;format=html">ypinit(8)</a> programja alapértelmezés szerint nem hozza létre ezt a táblázatot, de ha készítünk egy ilyet, akkor a NIS implementációja képes kezelni. Egy ilyen üres táblázat elkészítéséhez ennyit kell begépelni:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>ellington# vi /var/yp/netgroup</code></pre></div></div><div class=paragraph><p>Ezután elkezdhetjük felvenni a tartalmát. A példánk szerint legalább négy hálózati csoportot kell csinálnunk: az IT dolgozóinak, az IT új dolgozóinak, a normál dolgozóknak és az öszöndíjasoknak.</p></div><div class="literalblock programlisting"><div class=content><pre>IT_DOLG       (,alpha,proba-tartomany)    (,beta,proba-tartomany)
IT_UJDOLG     (,charlie,proba-tartomany)  (,delta,proba-tartomany)
FELHASZNALO   (,echo,proba-tartomany)     (,foxtrott,proba-tartomany) \
              (,golf,proba-tartomany)
OSZTONDIJAS   (,able,proba-tartomany)     (,baker,proba-tartomany)</pre></div></div><div class=paragraph><p>Az <code>IT_DOLG</code>, <code>IT_UJDOLG</code> stb. a hálózati csoportok nevei lesznek. Minden egyes zárójelezett csoport egy vagy több felhasználói hozzáférést tartalmaz. A csoportokban szereplõ három mezõ a következõ:</p></div><div class="olist arabic"><ol class=arabic><li><p>Azon gépek neve, amelykre a következõ elemek érvényesek. Ha itt nem adunk meg neveket, akkor a bejegyzés az összes gépre vonatkozik. Ha megadjuk egy gép nevét, akkor jutalmunk a teljes sötétség, a rettegetés és totális megtébolyodás.</p></li><li><p>A csoporthoz tartozó hozzáférés neve.</p></li><li><p>A hozzáféréshez kapcsolódó NIS tartomány. A csoportba más NIS tartományokból is át tudunk hozni hozzáféréseket, ha netalán éppen olyan szerencsétlenek lennénk, hogy több NIS tartományt is felügyelnünk kell.</p></li></ol></div><div class=paragraph><p>A mezõk mindegyike tartalmazhat dzsókerkaraktereket. Errõl részletesebben a <a href="https://man.freebsd.org/cgi/man.cgi?query=netgroup&amp;sektion=5&amp;format=html">netgroup(5)</a> man oldalon olvashatunk.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>A hálózati csoportoknak lehetõleg ne adjunk 8 karakternél hosszabb nevet, különösen abban az esetben, ha a NIS tartományban más operációs rendszereket is használunk. A nevekben eltérnek a kis- és nagybetûk. Ha a hálózati csoportokat nevét nagybetûkkel írjuk, akkor könnyen különbséget tudunk tenni a felhasználók, gépek és hálózati csoportok nevei között.</p></div><div class=paragraph><p>Egyes (nem FreeBSD alapú) NIS kliensek nem képesek kezelni a nagyon sok bejegyzést tartalmazó hálózati csoportokat. Például a SunOS™ néhány korábbi verziója fennakad rajta, ha egy hálózati csoport 15 <em>bejegyzésnél</em> többet tartalmaz. Az ilyen korlátozások alól úgy tudunk kibújni, ha 15 felhasználónként újabb hálózati csoportokat hozunk létre, amelyekkel az eredeti hálózati csoportot építjük fel:</p></div><div class="literalblock programlisting"><div class=content><pre>NAGYCSP1  (,joe1,tartomany)  (,joe2,tartomany)  (,joe3,tartomany) [...]
NAGYCSP2  (,joe16,tartomany)  (,joe17,tartomany) [...]
NAGYCSP3  (,joe31,tartomany)  (,joe32,tartomany)
NAGYCSOPORT  NAGYCSP1 NAGYCSP2 NAGYCSP3</pre></div></div><div class=paragraph><p>Ugyanez a folyamat javasolt olyan esetekben is, ahol 225 felhasználónál többre lenne szükség egyetlen hálózati csoporton belül.</p></div></td></tr></tbody></table></div><div class=paragraph><p>Az így létrehozott új NIS táblázat szétküldése meglehetõsen könnyû feladat:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>ellington# <span class=nb>cd</span> /var/yp
ellington# make</code></pre></div></div><div class=paragraph><p>Ez a parancs létrehoz három NIS táblázatot: <span class=filename>netgroup</span>, <span class=filename>netgroup.byhost</span> és <span class=filename>netgroup.byuser</span>. Az <a href="https://man.freebsd.org/cgi/man.cgi?query=ypcat&amp;sektion=1&amp;format=html">ypcat(1)</a> paranccsal ellenõrizni is tudjuk az új NIS táblázatainkat:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>ellington% ypcat <span class=nt>-k</span> netgroup
ellington% ypcat <span class=nt>-k</span> netgroup.byhost
ellington% ypcat <span class=nt>-k</span> netgroup.byuser</code></pre></div></div><div class=paragraph><p>Az elsõ parancs kimenete a <span class=filename>/var/yp/netgroup</span> állomány tartalmára emlékeztethet minket. A második parancsnak nincs semmilyen kimenete, hacsak nem adtunk meg valamilyen gépfüggõ hálózati csoportot. A harmadik parancs a hálózati csoportokat listázza ki a felhasználókhoz.</p></div><div class=paragraph><p>A kliensek beállítása tehát nagyon egyszerû. A <code>haboru</code> nevû szerver beállításához indítsuk el a <a href="https://man.freebsd.org/cgi/man.cgi?query=vipw&amp;sektion=8&amp;format=html">vipw(8)</a> programot, és cseréljük a</p></div><div class="literalblock programlisting"><div class=content><pre>+:::::::::</pre></div></div><div class=paragraph><p>sort erre:</p></div><div class="literalblock programlisting"><div class=content><pre>+@IT_DOLG:::::::::</pre></div></div><div class=paragraph><p>Innentõl kezdve kizárólag csak az <code>IT_DOLG</code> csoportban található felhasználók fognak bekerülni a <code>haboru</code> jelszó adatbázisába, és csak ezek a felhasználók tudnak ide bejelentkezni.</p></div><div class=paragraph><p>Sajnos ez a korlátozás a parancsértelmezõ <code>~</code> funkciójára és összes olyan rutinra is vonatkozik, amelyet a felhasználói nevek és azok numerikus azonosító között képez le. Más szóval a <code>cd ~felhasználó</code> parancs nem fog mûködni, és az <code>ls -l</code> parancs kimenetében a felhasználói nevek helyett csak numerikus azonosítók jelennek meg, továbbá a <code>find . -user joe -print No such user</code> (<code>Nincs ilyen felhasználó</code>) hibát fog visszaadni. Ez úgy tudjuk megjavítani, ha úgy importáljuk a szerverre az összes felhasználó bejegyzését, hogy <em>közben tiltjuk a hozzáférésüket</em>.</p></div><div class=paragraph><p>Ehhez vegyünk fel egy újabb sort az <span class=filename>/etc/master.passwd</span> állományba. A sor valahogy így fog kinézni:</p></div><div class=paragraph><p><code>+:::::::::/sbin/nologin</code>, amely annyit tesz, hogy "importáljuk az összes bejegyzést, de a hozzájuk tartozó parancsértelmezõ a <span class=filename>/sbin/nologin</span> legyen". A <code>passwd</code> állományban tetszõleges mezõ tartalmát le tudjuk úgy cserélni, ha megadunk neki egy alapértelmezett értéket az <span class=filename>/etc/master.passwd</span> állományban.</p></div><div class="admonitionblock warning"><table><tbody><tr><td class=icon><i class="fa icon-warning" title=Warning></i></td><td class=content><div class=paragraph><p>Vigyázzunk, hogy a <code>:::::::::/sbin/nologin` sort az `@IT_DOLG:::::::::</code> sor után írjuk. Ha nem így teszünk, akkor a NIS-bõl importált összes felhasználói hozzáférés a <span class=filename>/sbin/nologin</span> parancsértelmezõt kapja.</p></div></td></tr></tbody></table></div><div class=paragraph><p>Miután elvégeztük ezt a változtatást, minden újabb dolgozó felvétele után csupán egyetlen táblázatot kell megváltoztatnunk. Ugyanezt a taktikát követhetjük a kevésbé fontosabb szerverek esetében is, hogy ha a helyi <span class=filename>/etc/master.passwd</span> állományukban a korábbi <code>+:::::::::</code> bejegyzést valami ilyesmivel helyettesítjük:</p></div><div class="literalblock programlisting"><div class=content><pre>+@IT_DOLG:::::::::
+@IT_UJDOLG:::::::::
+:::::::::/sbin/nologin</pre></div></div><div class=paragraph><p>Az egyszerû munkaállomások esetében pedig ezekre a sorokra lesz szükségünk:</p></div><div class="literalblock programlisting"><div class=content><pre>+@IT_DOLG:::::::::
+@FELHASZNALOK:::::::::
+:::::::::/sbin/nologin</pre></div></div><div class=paragraph><p>Minden remekül üzemel egészen addig, amíg néhány hét múlva ismét változik a házirend: az IT tanszékre ösztöndíjasok érkeznek. Az IT ösztöndíjasai a munkaállomásokat és a kevésbé fontosabb szervereket tudják használni. Az új IT dolgozók már a központi szerverekre is bejelentkezhetnek. Így tehát létrehozunk egy új hálózati csoportot <code>IT_OSZTONDIJAS</code> néven, majd felvesszük ide az új IT ösztöndíjasokat, és nekilátunk végigzongorázni az összes gép összes konfigurációs állományát…​ Ahogy azonban egy régi mondás is tartja: "A központosított tervezésben ejtett hibák teljes káoszhoz vezetnek".</p></div><div class=paragraph><p>A NIS az ilyen helyzeteket úgy igyekszik elkerülni, hogy megengedi újabb hálózati csoportok létrehozását más hálózati csoportokból. Egyik ilyen lehetõség a szerep alapú hálózati csoportok kialakítása. Például, ha a fontosabb szerverek bejelentkezési korlátozásai számára hozzunk létre egy <code>NAGYSRV</code> nevû csoportot, valamint egy másik hálózati csoportot <code>KISSRV</code> néven a kevésbé fontosabb szerverekhez, végül <code>MUNKA</code> néven egy harmadik hálózati csoportot a munkaállomásokhoz. Mindegyik ilyen hálózati csoport tartalmazza azokat a csoportokat, amelyek engedélyezik a gépek elérését. A hálózati csoportok leírását tartalmazó NIS táblázat most valahogy így fog kinézni:</p></div><div class="literalblock programlisting"><div class=content><pre>NAGYSRV  IT_DOLG IT_UJDOLG
KISSRV   IT_DOLG IT_UJDOLG IT_OSZTONDIJAS
MUNKA    IT_DOLG IT_OSZTONDIJAS FELHASZNALOK</pre></div></div><div class=paragraph><p>A bejelentkezési megszorítások ilyen típusú megadása viszonylag jól mûködik, hogy ha azonos korlátozások alá esõ gépek csoportjait akarjuk felírni. Bánatunk ez a kivétel, és nem a szabály. Az esetek nagy többségében ugyanis a bejelentkezésre vonatkozó korlátozásokat gépenként kell egyesével megadni.</p></div><div class=paragraph><p>A hálózati csoportok gépfüggõ megadása tehát az iménti házirendhez társuló igények kielégítésének egyik módja. Ebben a forgatókönyvben az <span class=filename>/etc/master.passwd</span> állomány minden számítógépen két "+"-os sorral kezdõdik. Közülük az elsõ a gépen engedélyezett hozzáféréseket tartalmazó hálózati csoportra vonatkozik, a második pedig az összes többi hozzáféréshez az <span class=filename>/sbin/nologin</span> parancsértelmezõt kapcsolja hozzá. Itt jó ötlet, ha a gép nevének "VÉGIG-NAGYBETûS" változatát adjuk meg a hozzá tartozó hálózati csoport nevének:</p></div><div class="literalblock programlisting"><div class=content><pre>+@GÉPNÉV:::::::::
+:::::::::/sbin/nologin</pre></div></div><div class=paragraph><p>Miután elvégeztük ezt a feladatot minden egyes gépen, az <span class=filename>/etc/master.passwd</span> állomány helyi változatait soha többé nem kell módosítanunk. Az összes többi változtatást a NIS táblázaton keresztül tudjuk keresztül vinni. Íme a felvázolt forgatókönyvhöz tartozó hálózati csoportok kiépítésének egyik lehetséges változata, egy-két finomsággal kiegészítve:</p></div><div class="literalblock programlisting"><div class=content><pre># Elõször a felhasználók csoportjait adjuk meg:
IT_DOLG         (,alpha,proba-tartomany)    (,beta,proba-tartomany)
IT_UJDOLG       (,charlie,proba-tartomany)  (,delta,proba-tartomany)
TANSZ1          (,echo,proba-tartomany)     (,foxtrott,proba-tartomany)
TANSZ2          (,golf,proba-taromany)      (,hotel,proba-tartomany)
TANSZ3          (,india,proba-taromany)     (,juliet,proba-tartomany)
IT_OSZTONDIJAS  (,kilo,proba-tartomany)     (,lima,proba-tartomany)
D_OSZTONDIJAS   (,able,proba-tartomany)     (,baker,proba-tartomany)
#
# Most pedig hozzunk létre csoportokat szerepek szerint:
FELHASZNALOK     TANSZ1   TANSZ2          TANSZ3
NAGYSRV          IT_DOLG  IT_UJDOLG
KISSRV           IT_DOLG  IT_UJDOLG       IT_OSZTONDIJAS
MUNKA            IT_DOLG  IT_OSZTONDIJAS  FELHASZNALOK
#
# Következzenek a speciális feladatokhoz tartozó csoportok:
# Az echo és a golf tudja elérni a vírusvédelemért felelõs gépet:
VEDELEM          IT_DOLG  (,echo,proba-tartomany)  (,golf,proba-tartomany)
#
# Gép alapú hálózati csoportok
# A fõ szervereink:
HABORU      NAGYSRV
EHSEG       NAGYSRV
# Az india nevû felhasználó hozzá szeretné ehhez férni:
SZENNYEZES  NAGYSRV  (,india,proba-tartomany)
#
# Ez valóban fontos és komolyan szabályoznunk kell:
HALAL       IT_DOLG
#
# Az elõbb említett vírusvédelmi gép:
EGY         VEDELEM
#
# Egyetlen felhasználóra korlátozzuk le ezt a gépet:
KETTO       (,hotel,proba-tartomany)
# [...és itt folytatódik a többi csoporttal]</pre></div></div><div class=paragraph><p>Ha a felhasználói hozzáféréseinket valamilyen adatbázisban tároljuk, akkor a táblázat elsõ részét akár az adatbázis lekérdezésein keresztül is elõ tudjuk állítani. Ezzel a módszerrel az új felhasználók automatikusan hozzáférnek a gépekhez.</p></div><div class=paragraph><p>Legyünk viszont óvatosak: nem mindig javasolt gépeken alapuló hálózati csoportokat készíteni. Ha a hallgatói laborokba egyszerre több tucat vagy akár több száz azonos konfigurációjú gépet telepítünk, akkor a gép alapú csoportok helyett inkább szerep alapú csoportokat építsünk fel, mivel így a NIS táblázatok méretét egy elfogadható méreten tudjuk tartani.</p></div></div><div class=sect3><h4 id=_amit_feltétlenül_észben_kell_tartanunk>29.4.8. Amit feltétlenül észben kell tartanunk<a class=anchor href=#_amit_feltétlenül_észben_kell_tartanunk></a></h4><div class=paragraph><p>Még mindig akad néhány olyan dolog, amit másképpen kell csinálnunk azután, hogy most már NIS környezetben vagyunk.</p></div><div class=ulist><ul><li><p>Amikor egy új felhasználót akarunk felvenni a laborba, akkor <em>csak</em> a központi NIS szerverre kell felvennünk, és <em>újra kell generáltatnunk a NIS táblázatokat</em>. Ha ezt elfelejtjük megtenni, akkor az új felhasználó a központi NIS szerveren kívül sehova sem lesz képes bejelentkezni. Például, ha fel akarjuk venni a <code>jsmith</code> nevû felhasználót a laborba, akkor ezt kell tennünk:</p><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># pw useradd jsmith</span>
<span class=c># cd /var/yp</span>
<span class=c># make proba-tartomany</span></code></pre></div></div><div class=paragraph><p>Vagy a <code>pw useradd jsmith</code> parancs helyett az <code>adduser jsmith</code> parancsot is használhatjuk.</p></div></li><li><p><em>A rendszergazdai szintû hozzáféréseket ne tároljuk a NIS táblázatokban</em>. Olyan gépekre egyáltalán ne is küldjünk olyan karbantartáshoz használt hozzáféréseket, amelynek a felhasználói hivatalosan nem is férhetnének hozzájuk.</p></li><li><p><em>A központi NIS szervert és az alárendelt szervereket óvjuk minél jobban, és igyekezzünk minimalizálni a kieséseiket</em>. Ha valaki feltöri vagy egyszerûen csak kikapcsolja ezeket a gépeket, akkor ezzel lényegében mindenkit megakadályoz abban, hogy be tudjon jelentkezni a laborban.</p><div class=paragraph><p>Ezek a központosított vezérlésû rendszerek legfõbb gyengeségei. Ha nem védjük kellõen a NIS szervereinket, akkor azzal nagyon ellenséget szerezhetünk magunknak!</p></div></li></ul></div></div><div class=sect3><h4 id=_kompatibilitás_a_nis_elsõ_változatával>29.4.9. Kompatibilitás a NIS elsõ változatával<a class=anchor href=#_kompatibilitás_a_nis_elsõ_változatával></a></h4><div class=paragraph><p>A FreeBSD-ben megtalálható ypserv szolgáltatás valamennyire képes ellátni a NIS elsõ változatát használó klienseket is. A FreeBSD NIS implementációja csak a NIS v2 protokollt használja, azonban mivel más implementációk kompatibilisek kívánnak maradni a régebbi rendszerekkel, ismerik a v1 protokollt is. Az ilyen rendszerekhez tartozó ypbind démonok még olyankor is megpróbálnak v1-es NIS szerverekhez kötést létrehozni, amikor valójában nincs is rá szükségük (és gyakran még akkor is ilyet keresnek, amikor az üzenetükre már válaszolt egy v2-es szerver). Hozzátennénk, hogy bár az ypserver ezen változata a normál klienshívásokat képes feldolgozni, a táblázatokat már nem tudja átküldeni a v1-es klienseknek. Ebbõl következik, hogy a központi vagy alárendelt szerverek nem tudnak együttmûködni olyan NIS szerverekkel, amelyek csak a v1-es protokollt beszélik. Szerencsére ilyen szervereket manapság már alig használnak.</p></div></div><div class=sect3><h4 id=network-nis-server-is-client>29.4.10. NIS szerverek, melyek egyben NIS kliensek<a class=anchor href=#network-nis-server-is-client></a></h4><div class=paragraph><p>Óvatosan kell bánnunk az ypserv elindításával olyan többszerveres tartományokban, ahol a szerverek maguk is NIS kliensek. Alapvetõen nincs abban semmi kivetnivaló, ha a szervereket saját magukhoz kötjük ahelyett, hogy engednénk nekik a kötési kérések küldését és így egymáshoz kötnénk ezeket. Különös hibák tudnak származni olyan helyzetekben, amikor az egyik szerver leáll, miközben a többiek pedig függenek tõle. Végül is ilyenkor minden kliens szépen kivárja a szükséges idõt, aztán megpróbál más szerverekhez kötõdni, de az itt fellépõ késlekedés jelentõs mennyiségû lehet, és ez a hibajelenség ismét fennállhat, mivel elõfordulhat, hogy a szerverek megint egymáshoz kapcsolódnak.</p></div><div class=paragraph><p>A klienst úgy tudjuk egy adott szerverhez kötni, ha az <code>ypbind</code> parancsot a <code>-S</code> beállítással indítjuk. Ha mindezt nem akarjuk manuálisan megtenni a NIS szerver minden egyes újraindításakor, akkor vegyük fel a következõ sorokat az <span class=filename>/etc/rc.conf</span> állományba:</p></div><div class="literalblock programlisting"><div class=content><pre>nis_client_enable=&#34;YES&#34;	# elindítjuk a klienst is
nis_client_flags=&#34;-S NIS tartomány,szerver&#34;</pre></div></div><div class=paragraph><p>Részletesebb lásd az <a href="https://man.freebsd.org/cgi/man.cgi?query=ypbind&amp;sektion=8&amp;format=html">ypbind(8)</a> man oldalát.</p></div></div><div class=sect3><h4 id=_a_jelszavak_formátuma>29.4.11. A jelszavak formátuma<a class=anchor href=#_a_jelszavak_formátuma></a></h4><div class=paragraph><p>A NIS rendszerek kiépítése során az emberek leggyakrabban a jelszavak formátumával kapcsolatban tapasztalnak nehézségeket. Ha a szerverünk DES titkosítású jelszavakat használ, akkor csak olyan klienseket fog tudni támogatni, amelyek szintén így kódolják ezeket. Például, ha a hálózaton vannak Solaris™ rendszerû NIS klienseink, akkor szinte biztos, hogy DES titkosítást kell használnunk.</p></div><div class=paragraph><p>A szerverek és a kliensek által használt formátumokat az <span class=filename>/etc/login.conf</span> állományba tekintve deríthetjük ki. Ha a gépek többségén a DES titkosítást látjuk, akkor a <code>default</code> osztálynak egy ilyen bejegyzést kell tartalmaznia:</p></div><div class="literalblock programlisting"><div class=content><pre>default:\
	:passwd_format=des:\
	:copyright=/etc/COPYRIGHT:\
	[a többit most nem mutatjuk]</pre></div></div><div class=paragraph><p>A <code>passwd_format</code> tulajdonság további lehetséges értékei lehetnek a <code>blf</code> és az <code>md5</code> (melyek rendre a Blowfish és MD5 titkosítású jelszavakat adják meg).</p></div><div class=paragraph><p>Ha változtattunk valamit az <span class=filename>/etc/login.conf</span> állományban, akkor a bejelentkezési tulajdonságok adatbázisát is újra kell generálni, melyet <code>root</code> felhasználóként a következõ módon tehetünk meg:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># cap_mkdb /etc/login.conf</span></code></pre></div></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Az <span class=filename>/etc/master.passwd</span> állományban jelenlevõ jelszavak formátuma azonban nem frissítõdik egészen addig, amíg a felhasználók a bejelentkezési adatbázis újragenerálása <em>után</em> meg nem változtatják a jelszavaikat.</p></div></td></tr></tbody></table></div><div class=paragraph><p>Úgy tudjuk még biztosítani, hogy a jelszavak megfelelõ formátumban kódolódjanak, ha az <span class=filename>/etc/auth.conf</span> állományban megkeressük a <code>crypt_default</code> sort, amelyben a választható jelszóformátumok felhasználásái sorrendjét találhatjuk meg. Itt tehát mindössze annyit kell tennünk, hogy a kiszemelt formátumot a lista elejére tesszük. Például, ha a DES titkosítású jelszavakat akarunk használni, akkor ez a bejegyzés így fog kinézni:</p></div><div class="literalblock programlisting"><div class=content><pre>crypt_default	=	des blf md5</pre></div></div><div class=paragraph><p>Ha a fenti lépéseket követjük az összes FreeBSD alapú NIS szervernél és kliensnél, akkor biztosra mehetünk abban, hogy a hálózatunkon belül ugyanazt a jelszóformátumot fogják használni. Ha gondunk akadna a NIS kliensek hitelesítésével, akkor itt érdemes kezdeni a hiba felderítését. Ne felejtsük: ha egy NIS szervert egy heterogén hálózatba akarunk telepíteni, akkor valószínûleg az összes rendszeren a DES titkosítást kell választani, mivel általában ez a közös nevezõ ebben a tekintetben.</p></div></div></div><div class=sect2><h3 id=network-dhcp>29.5. A hálózat automatikus beállítása (DHCP)<a class=anchor href=#network-dhcp></a></h3><div class=sect3><h4 id=_mi_az_a_dhcp>29.5.1. Mi az a DHCP?<a class=anchor href=#_mi_az_a_dhcp></a></h4><div class=paragraph><p>A Dinamikus állomáskonfigurációs protokoll, avagy Dynamic Host Configuration Protocol (DHCP) annak eszközeit írja le, hogy egy rendszer miként tud csatlakozni egy hálózathoz és miként tudja azon belül megszerezni a kommunikációhoz szükséges információkat. A FreeBSD 6.0 elõtti változatai az ISC (Internet Systems Consortium, vagyis az internetes rendszerkonzorcium) által kidolgozott DHCP kliens (<a href="https://man.freebsd.org/cgi/man.cgi?query=dhclient&amp;sektion=8&amp;format=html">dhclient(8)</a>) implementációját tartalmazzák. A késõbbi verziókban pedig az OpenBSD 3.7 verziójából átvett <code>dhclient</code> paranccsal dolgozhatunk. Ebben a szakaszban a <code>dhclient</code> parancsra vonatkozó összes információ egyaránt érvényes az ISC és az OpenBSD által fejlesztett DHCP kliensekre. A DHCP szerver az ISC-tõl származik.</p></div></div><div class=sect3><h4 id=_mivel_foglalkozik_ez_a_szakasz>29.5.2. Mivel foglalkozik ez a szakasz<a class=anchor href=#_mivel_foglalkozik_ez_a_szakasz></a></h4><div class=paragraph><p>Ebben a szakaszban az ISC és az OpenBSD DHCP klienseinek kliens- és szerver oldali komponsenseit mutatjuk be. A kliens oldali program neve a <code>dhclient</code>, amely a FreeBSD részeként érkezik, és a szerver oldali elem pedig a <a class=package href=https://cgit.freebsd.org/ports/tree/net/isc-dhcp31-server/>net/isc-dhcp31-server</a> porton keresztül érhetõ el. A lentebb említett hivatkozások mellett a témában még a <a href="https://man.freebsd.org/cgi/man.cgi?query=dhclient&amp;sektion=8&amp;format=html">dhclient(8)</a>, <a href="https://man.freebsd.org/cgi/man.cgi?query=dhcp-options&amp;sektion=5&amp;format=html">dhcp-options(5)</a> és a <a href="https://man.freebsd.org/cgi/man.cgi?query=dhclient.conf&amp;sektion=5&amp;format=html">dhclient.conf(5)</a> man adhatnak bõvebb felvilágosítást a témában.</p></div></div><div class=sect3><h4 id=_ahogyan_mûködik>29.5.3. Ahogyan mûködik<a class=anchor href=#_ahogyan_mûködik></a></h4><div class=paragraph><p>Amikor a <code>dhclient</code>, vagyis a DHCP kliens elindul egy kliensgépen, akkor a hálózaton üzenetszórással próbálja meg elkérni a konfigurációjához szükséges adatokat. Alapértelmezés szerint ezek a kérések a 68-as UDP porton keresztül mennek. A szerver ezekre a 67-es UDP porton válaszol, ahol visszaad a kliensnek egy IP-címet és a hálózat használatához szükséges további információkat, mint például a hálózati maszkot, az alapértelmezett átjáró és a névfeloldásért felelõs szerverek címét. Az összes ilyen jellegû adat egy DHCP "bérlet" (lease) formájában érkezik meg, amely csak egy adott ideig érvényes (ezt a DHCP szerver karbantartója állítja be). Így a hálózaton a kliens nélküli IP-címeket egy idõ után automatikusan visszanyerjük.</p></div><div class=paragraph><p>A DHCP kliensek rengeteg információt képes elkérni a szervertõl. Ezek teljes listáját a <a href="https://man.freebsd.org/cgi/man.cgi?query=dhcp-options&amp;sektion=5&amp;format=html">dhcp-options(5)</a> man oldalán olvashatjuk el.</p></div></div><div class=sect3><h4 id=_használat_a_freebsd_n_belül>29.5.4. Használat a FreeBSD-n belül<a class=anchor href=#_használat_a_freebsd_n_belül></a></h4><div class=paragraph><p>A FreeBSD teljes egészében tartalmazza az ISC vagy az OpenBSD DHCP kliensét, a <code>dhclient</code> programot (attól függõen, hogy a FreeBSD melyik változatát használjuk). A DHCP kliensek támogatása a telepítõben és az alaprendszerben is megtalálható, és ezzel mentesülünk minden konkrét hálózati beállítás alól a DHCP szervereket alkalmazó hálózatokon. A <code>dhclient</code> a FreeBSD 3.2 változata óta megtalálható a rendszerben.</p></div><div class=paragraph><p>DHCP használatát a sysinstall is lehetõvé teszi. Amikor egy hálózati felületet a sysinstall programon belül állítunk be, akkor a második kérdés mindig ez szokott lenni: "Do you want to try DHCP configuration of the interface?" ("Megpróbáljuk DHCP használatával beállítani a felületet?") Ha erre igennel válaszolunk, akkor azzal lényegében a <code>dhclient</code> parancsot indítjuk el, és ha mindez sikerrel zárul, akkor szinte magától kitöltõdik az összes hálózati beállításunk.</p></div><div class=paragraph><p>A DHCP használatához két dolgot kell beállítanunk a rendszerünkön:</p></div><div class=ulist><ul><li><p>Gondoskodjunk róla, hogy a <span class=filename>bpf</span> eszköz része a rendszermagunknak. Ha még nem lenne benne, akkor a rendszermag beállításait tartalmazó állományba vegyük fel a <code>device bpf</code> sort és fordítsuk újra a rendszermagot. A rendszermagok fordításáról a <a href=./#kernelconfig>A FreeBSD rendszermag testreszabása</a>ben tudhatunk meg többet.</p><div class=paragraph><p>A <span class=filename>bpf</span> eszköz alapból megtalálható a <span class=filename>GENERIC</span> rendszermagokban, így ha ezt használjuk, akkor nem kell saját verziót készítenünk a DHCP használatához.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Azok számára viszont, akik biztonsági szempontból aggódnak a rendszerük miatt, meg kell említenünk, hogy a <span class=filename>bpf</span> egyben az az eszköz, amely a csomagok lehallgatását is lehetõvé teszi (habár az ilyeneket <code>root</code> felhasználóként lehet csak elindítani). A <span class=filename>bpf</span><em>kell</em> a DHCP használatához, azonban ha nagyon fontos nekünk a rendszerünk biztonsága, akkor a <span class=filename>bpf</span> eszközt érdemes kivennünk a rendszermagból, ha még pillanatnyilag nem használunk ilyet.</p></div></td></tr></tbody></table></div></li><li><p>Az <span class=filename>/etc/rc.conf</span> állományunkat az alábbiak szerint kell módosítani:</p><div class="literalblock programlisting"><div class=content><pre>ifconfig_fxp0=&#34;DHCP&#34;</pre></div></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Az <code>fxp0</code> eszközt ne felejtsük el kicserélni arra a felületre, amelyet automatikusan akarunk beállítani. Ennek mikéntje a <a href=./#config-network-setup>A hálózati kártyák beállítása</a>ban olvasható.</p></div></td></tr></tbody></table></div><div class=paragraph><p>Ha a <code>dhclient</code> a rendszerünkben máshol található, vagy egyszerûen csak további beállításokat akarunk átadni a <code>dhclient</code> parancsnak, akkor adjuk meg a következõt is (változtassuk meg igényeink szerint):</p></div><div class="literalblock programlisting"><div class=content><pre>dhclient_program=&#34;/sbin/dhclient&#34;
dhclient_flags=&#34;&#34;</pre></div></div></li></ul></div><div class=paragraph><p>A DHCP szerver, a dhcpd a <a class=package href=https://cgit.freebsd.org/ports/tree/net/isc-dhcp31-server/>net/isc-dhcp31-server</a> port részeként érhetõ el. Az a port tartalmazza az ISC DHCP szerverét és a hozzá tartozó dokumentációt.</p></div></div><div class=sect3><h4 id=_állományok>29.5.5. Állományok<a class=anchor href=#_állományok></a></h4><div class=ulist><ul><li><p><span class=filename>/etc/dhclient.conf</span></p><div class=paragraph><p>A <code>dhclient</code> mûködéséhez szükség lesz egy konfigurációs állományra, aminek a neve <span class=filename>/etc/dhclient.conf</span>. Ez az állomány általában csak megjegyzéseket tartalmaz, mivel az alapértelmezett értékek többnyire megfelelõek. Ezt a konfigurációs állományt a <a href="https://man.freebsd.org/cgi/man.cgi?query=dhclient.conf&amp;sektion=5&amp;format=html">dhclient.conf(5)</a> man oldal írja le.</p></div></li><li><p><span class=filename>/sbin/dhclient</span></p><div class=paragraph><p>A <code>dhclient</code> statikusan linkelt és az <span class=filename>/sbin</span> könyvtárban található. A <a href="https://man.freebsd.org/cgi/man.cgi?query=dhclient&amp;sektion=8&amp;format=html">dhclient(8)</a> man oldal tud róla részletesebb felvilágosítást adni.</p></div></li><li><p><span class=filename>/sbin/dhclient-script</span></p><div class=paragraph><p>A <code>dhclient-script</code> a FreeBSD-ben levõ DHCP kliens konfigurációs szkriptje. Mûködését a <a href="https://man.freebsd.org/cgi/man.cgi?query=dhclient-script&amp;sektion=8&amp;format=html">dhclient-script(8)</a> man oldal írja le, de a felhasználók részérõl semmilyen módosítást nem igényel.</p></div></li><li><p><span class=filename>/var/db/dhclient.leases</span></p><div class=paragraph><p>A DHCP kliens az érvényes bérleteket tartja nyilván ezekben az állományban és naplóként használja. A <a href="https://man.freebsd.org/cgi/man.cgi?query=dhclient.leases&amp;sektion=5&amp;format=html">dhclient.leases(5)</a> man oldal ezt valamivel bõvebben kifejti.</p></div></li></ul></div></div><div class=sect3><h4 id=_további_olvasnivalók_2>29.5.6. További olvasnivalók<a class=anchor href=#_további_olvasnivalók_2></a></h4><div class=paragraph><p>A DHCP protokoll mûködését az <a href=http://www.freesoft.org/CIE/RFC/2131/>RFC 2131</a> mutatja be. A témához kapcsolódóan <a href=http://www.dhcp.org/>itt</a> tudunk még leírásokat találni.</p></div></div><div class=sect3><h4 id=network-dhcp-server>29.5.7. A DHCP szerverek telepítése és beállítása<a class=anchor href=#network-dhcp-server></a></h4><div class=sect4><h5 id=_mirõl_szól_ez_a_szakasz>29.5.7.1. Mirõl szól ez a szakasz<a class=anchor href=#_mirõl_szól_ez_a_szakasz></a></h5><div class=paragraph><p>Ebben a szakaszban arról olvashatunk, hogy miként kell egy FreeBSD típusú rendszert DHCP szervernek beállítani, ha az ISC (internetes rendszerkonzorcium) DHCP szerverét használjuk.</p></div><div class=paragraph><p>Ez a szerver nem része a FreeBSD-nek, ezért a szolgáltatás elindításához elõször fel kell raknunk a <a class=package href=https://cgit.freebsd.org/ports/tree/net/isc-dhcp31-server/>net/isc-dhcp31-server</a> portot. A Portgyûjtemény használatára vonatkozóan a <a href=./#ports>Alkalmazások telepítése. csomagok és portok</a> lehet segítségünkre.</p></div></div><div class=sect4><h5 id=_a_dhcp_szerver_telepítése>29.5.7.2. A DHCP szerver telepítése<a class=anchor href=#_a_dhcp_szerver_telepítése></a></h5><div class=paragraph><p>Ha a FreeBSD rendszerünket DHCP szerverként akarjuk beállítani, akkor ehhez elsõként a <a href="https://man.freebsd.org/cgi/man.cgi?query=bpf&amp;sektion=4&amp;format=html">bpf(4)</a> eszköz jelenlétét kell biztosítani a rendszermagban. Ehhez vegyük fel a <code>device bpf</code> sort a rendszermagunk beállításait tartalmazó állományba, majd fordítsuk újra a rendszermagot. A rendszermag lefordításáról a <a href=./#kernelconfig>A FreeBSD rendszermag testreszabása</a>ben olvashatunk.</p></div><div class=paragraph><p>A <span class=filename>bpf</span> eszköz a FreeBSD-hez alapból adott <span class=filename>GENERIC</span> rendszermag része, ezért a DHCP használatához nem kell feltétlenül újat fordítanunk.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>A biztonsági szempontok miatt aggódó felhasználók részére megjegyezzük, hogy a <span class=filename>bpf</span> eszköz egyben a csomagok lehallgatását is lehetõvé teszi (habár az ilyen témájú programok futtatásához megfelelõ jogokra is szükség van). A <span class=filename>bpf</span> használata <em>kötelezõ</em> a DHCP mûködtetéséhez, de ha nagyon kényesek vagyunk a biztonságot illetõen, akkor minden olyan esetben, amikor nem használjuk ki ezt a lehetõséget, távolítsuk el a rendszermagból.</p></div></td></tr></tbody></table></div><div class=paragraph><p>A következõ lépésben át kell szerkesztenünk a mintaként mellékelt <span class=filename>dhcpd.conf</span> állományt, amelyet a <a class=package href=https://cgit.freebsd.org/ports/tree/net/isc-dhcp31-server/>net/isc-dhcp31-server</a> port rakott fel. Ez alapértelmezés szerint a <span class=filename>/usr/local/etc/dhcpd.conf.sample</span> néven található meg, és mielõtt bármit is változtatnánk rajta, másoljuk le <span class=filename>/usr/local/etc/dhcpd.conf</span> néven.</p></div></div><div class=sect4><h5 id=_a_dhcp_szerver_beállítása>29.5.7.3. A DHCP szerver beállítása<a class=anchor href=#_a_dhcp_szerver_beállítása></a></h5><div class=paragraph><p>A <span class=filename>dhcpd.conf</span> az alhálózatokat illetve a gépeket érintõ deklarációkat tartalmazza, és talán a legkönnyebben a következõ példa alapján mutatható be:</p></div><div class="literalblock programlisting"><div class=content><pre>option domain-name &#34;minta.com&#34;;<i class=conum data-value=1></i><b>(1)</b>
option domain-name-servers 192.168.4.100;<i class=conum data-value=2></i><b>(2)</b>
option subnet-mask 255.255.255.0;<i class=conum data-value=3></i><b>(3)</b>

default-lease-time 3600;<i class=conum data-value=4></i><b>(4)</b>
max-lease-time 86400;<i class=conum data-value=5></i><b>(5)</b>
ddns-update-style none;<i class=conum data-value=6></i><b>(6)</b>

subnet 192.168.4.0 netmask 255.255.255.0 {
  range 192.168.4.129 192.168.4.254;<i class=conum data-value=7></i><b>(7)</b>
  option routers 192.168.4.1;<i class=conum data-value=8></i><b>(8)</b>
}

host mailhost {
  hardware ethernet 02:03:04:05:06:07;<i class=conum data-value=9></i><b>(9)</b>
  fixed-address levelezes.minta.com;<i class=conum data-value=10></i><b>(10)</b>
}</pre></div></div><div class="colist arabic"><table><tbody><tr><td><i class=conum data-value=1></i><b>1</b></td><td>Ez a beállítás adja meg a kliensek számára az alapértelmezett keresési tartományt (search domain). A <a href="https://man.freebsd.org/cgi/man.cgi?query=resolv.conf&amp;sektion=5&amp;format=html">resolv.conf(5)</a> tud ezzel kapcsolatban részletesebb információkat adni.</td></tr><tr><td><i class=conum data-value=2></i><b>2</b></td><td>Ez a beállítás adja meg a kliensek által használt névfeloldó szerverek vesszõvel elválasztott felsorolását.</td></tr><tr><td><i class=conum data-value=3></i><b>3</b></td><td>A kliensekhez tartozó hálózati maszk.</td></tr><tr><td><i class=conum data-value=4></i><b>4</b></td><td>A kliens egy adott idõre kérhet bérleti jogot, egyébként a szerver dönt a bérlet lejárati idejérõl (másodpercekben).</td></tr><tr><td><i class=conum data-value=5></i><b>5</b></td><td>Ez az a maximális idõ, amennyire a szerver hajlandó bérbe adni IP-címet. A kliens ugyan hosszabb idõre is kérheti és meg is kapja, de legfeljebb csak <code>max-lease-time</code> másodpercig lesz érvényes.</td></tr><tr><td><i class=conum data-value=6></i><b>6</b></td><td>Ez a beállítás határozza meg, hogy a DHCP szervernek frissítse-e a névoldási információkat a bérlések elfogadásánál vagy visszamondásánál. Az ISC implementációjánál ez a beállítás <em>kötelezõ</em>.</td></tr><tr><td><i class=conum data-value=7></i><b>7</b></td><td>Ezzel adjuk meg milyen tartományból tudunk IP-címeket kiosztani a kliensek számára. A kezdõ címet is beleértve, innen fogunk kiutalni egyet a klienseknek.</td></tr><tr><td><i class=conum data-value=8></i><b>8</b></td><td>A kliensek felé elküldött alapértelmezett átjáró címe.</td></tr><tr><td><i class=conum data-value=9></i><b>9</b></td><td>A gép hardveres MAC-címe (így a DHCP szerver képes felismerni a kérés küldõjét).</td></tr><tr><td><i class=conum data-value=10></i><b>10</b></td><td>Ennek megadásával a gépek mindig ugyanazt az IP-címet kapják. Itt már megadhatunk egy hálózati nevet, mivel a bérlethez tartozó információk visszaküldése elõtt maga a DHCP szerver fogja feloldani a gép nevét.</td></tr></tbody></table></div><div class=paragraph><p>Miután befejeztük a <span class=filename>dhcpd.conf</span> módosítását, a DHCP szerver az <span class=filename>/etc/rc.conf</span> állományban tudjuk engedélyezni, vagyis tegyük bele a következõt:</p></div><div class="literalblock programlisting"><div class=content><pre>dhcpd_enable=&#34;YES&#34;
dhcpd_ifaces=&#34;dc0&#34;</pre></div></div><div class=paragraph><p>A <code>dc0</code> felület nevét helyettesítsük annak a felületnek (vagy whitespace karakterekkel elválasztott felületeknek) a nevével, amelyen keresztül a DHCP szerver várni fogja a kliensek kéréseit.</p></div><div class=paragraph><p>Ezután a következõ parancs kiadásával indítsuk el a szervert:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># /usr/local/etc/rc.d/isc-dhcpd start</span></code></pre></div></div><div class=paragraph><p>Amikor a jövõben valamit változtatunk a konfigurációs állományon, akkor ezzel kapcsolatban fontos megemlíteni, hogy ha csak egy <code>SIGHUP</code> jelzést küldünk a dhcpd démonnak, akkor az a többi démontól eltérõen önmagában még <em>nem</em> eredményezi a konfigurációs adatok újraolvasását. Helyette a <code>SIGTERM</code> jelzéssel kell leállítani a programot, majd újraindítani a fenti paranccsal.</p></div></div><div class=sect4><h5 id=_állományok_2>29.5.7.4. Állományok<a class=anchor href=#_állományok_2></a></h5><div class=ulist><ul><li><p><span class=filename>/usr/local/sbin/dhcpd</span></p><div class=paragraph><p>A dhcpd statikusan linkelt és a <span class=filename>/usr/local/sbin</span> könyvtárban található. A porttal együtt felkerülõ <a href="https://man.freebsd.org/cgi/man.cgi?query=dhcpd&amp;sektion=8&amp;format=html">dhcpd(8)</a> man oldal ad részletesebb útmutatást dhcpd használatáról.</p></div></li><li><p><span class=filename>/usr/local/etc/dhcpd.conf</span></p><div class=paragraph><p>Mielõtt a dhcpd megkezdhetné mûködését, egy konfigurációs állományra is szükségünk lesz, amely a <span class=filename>/usr/local/etc/dhcpd.conf</span>. Ez az állomány tartalmazza az összes olyan információt, ami kell a kliensek megfelelõ kiszolgálásához valamint a szerver mûködéséhez. Ez a konfigurációs állomány porthoz tartozó <a href="https://man.freebsd.org/cgi/man.cgi?query=dhcpd.conf&amp;sektion=5&amp;format=html">dhcpd.conf(5)</a> man oldalon kerül ismertetésre.</p></div></li><li><p><span class=filename>/var/db/dhcpd.leases</span></p><div class=paragraph><p>A DHCP szerver ebben az állományba tartja nyilván a kiadott bérleteket, egy napló formájában. A porthoz kapcsolódó <a href="https://man.freebsd.org/cgi/man.cgi?query=dhcpd.leases&amp;sektion=5&amp;format=html">dhcpd.leases(5)</a> man oldalon errõl többet is megtudhatunk.</p></div></li><li><p><span class=filename>/usr/local/sbin/dhcrelay</span></p><div class=paragraph><p>A dhcrelay állománynak olyan komolyabb környezetekben van szerepe, ahol a DHCP szerver a kliensektõl érkezõ kéréseket egy másik hálózaton található DHCP szerverhez továbbítja. Ha szükség lenne erre a lehetõségre, akkor telepítsük fel a <a class=package href=https://cgit.freebsd.org/ports/tree/net/isc-dhcp31-relay/>net/isc-dhcp31-relay</a> portot. A porthoz tartozó <a href="https://man.freebsd.org/cgi/man.cgi?query=dhcrelay&amp;sektion=8&amp;format=html">dhcrelay(8)</a> man oldal ennek részleteit taglalja.</p></div></li></ul></div></div></div></div><div class=sect2><h3 id=network-dns>29.6. Névfeloldás (DNS)<a class=anchor href=#network-dns></a></h3><div class=sect3><h4 id=_áttekintés>29.6.1. Áttekintés<a class=anchor href=#_áttekintés></a></h4><div class=paragraph><p>A FreeBSD alapértelmezés szerint a BIND (Berkeley Internet Name Domain) egyik verzióját tartalmazza, amely a névfeloldási (Domain Name System, DNS) protokoll egyik elterjedt implementációja. A DNS protokollon keresztül tudunk az IP-címekhez neveket rendelni és fordítva. Például a <code>www.FreeBSD.org</code> névre a FreeBSD Projekt webszerverének IP-címét kapjuk meg, miközben a <code>ftp.FreeBSD.org</code> pedig a hozzá tartozó FTP szerver IP-címét fogja visszaadni. Ehhez hasonlóan a fordítottja is megtörténhet, vagyis egy IP-címhez is kérhetjük a hálózati név feloldását. A névfeloldási kérések kiszolgálásához nem feltétlenül szükséges névszervert futtatni a rendszerünkön.</p></div><div class=paragraph><p>A FreeBSD jelen pillanatban alapból a BIND9 névszervert tartalmazza. A benne szereplõ változata több biztonsági javítást, új állományrendszeri kiosztást és automatizált <a href="https://man.freebsd.org/cgi/man.cgi?query=chroot&amp;sektion=8&amp;format=html">chroot(8)</a> beállítást is magában foglal.</p></div><div class=paragraph><p>Az interneten keresztüli névfeloldást legfelsõ szintû tartományoknak (Top Level Domain, TLD) nevezett hitelesített tövek némileg bonyolult rendszerén alapszik, valamint más egyéb olyan névszervereken, amelyek további egyéni információkat tárolnak és táraznak.</p></div><div class=paragraph><p>A BIND fejlesztését jelenleg az Internet Systems Consortium (<a href=http://www.isc.org/>http://www.isc.org/</a>) felügyeli.</p></div></div><div class=sect3><h4 id=_alapfogalmak>29.6.2. Alapfogalmak<a class=anchor href=#_alapfogalmak></a></h4><div class=paragraph><p>A leírás megértéséhez be kell mutatnunk néhány névfeloldással kapcsolatos fogalmat.</p></div><table class="tableblock frame-none grid-all stretch informaltable"><col style=width:50%><col style=width:50%><thead><tr><th class="tableblock halign-left valign-top">Fogalom</th><th class="tableblock halign-left valign-top">Meghatározás</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class=tableblock>Közvetlen névfeloldás (forward DNS)</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>A hálózati nevek leképezése IP-címekre.</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>õs (origin)</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Egy adott zóna állományban szereplõ tartományra vonatkozik.</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>named, BIND</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>A FreeBSD-n belüli BIND névszerver különbözõ megnevezései.</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>Névfeloldó (resolver)</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Az a program a rendszerben, amelyhez a hálózaton levõ gépek a zónák adatainak elérésével kapcsolatban fordulnak.</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>Inverz névfeloldás (reverse DNS)</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Az IP-címek leképzése hálózati nevekre.</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>Gyökérzóna (root zone)</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Az interneten található zónák hierarchiájának töve. Minden zóna ebbe a gyökérzónába esik, ahhoz hasonlóan, ahogy egy állományrendszerben az állományok a gyökérkönyvtárba.</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>Zóna (zone)</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Egy különálló tartomány, altartomány vagy a névfeloldás azon része, amelyet egyazon fennhatóság alatt tartanak karban.</p></td></tr></tbody></table><div class=paragraph><p>Példák zónákra:</p></div><div class=ulist><ul><li><p>A gyökérzónára a leírásokban általában <code>.</code> néven szoktak hivatkozni.</p></li><li><p>A <code>org.</code> egy legfelsõ szintû tartomány (TLD) a gyökérzónán belül.</p></li><li><p>A <code>minta.org.</code> a <code>org.</code> TLD tartomány alatti zóna.</p></li><li><p>A <code>1.168.192.in-addr.arpa</code> egy olyan zóna, amelyek a <code>192.168.1.*</code> IP-címtartományban szereplõ összes címet jelöli.</p></li></ul></div><div class=paragraph><p>Mint láthatjuk, a hálózati nevek balról kiegészülve pontosodnak. Tehát például a <code>minta.org.</code> sokkal pontosabb meghatározás, mint a <code>org.</code>, ahogy az <code>org.</code> magánál a gyökérzónánál jelent többet. A hálózati nevek felosztása leginkább egy állományrendszerhez hasonlítható, például a <span class=filename>/dev</span> könyvtár a gyökéren belül található, és így tovább.</p></div></div><div class=sect3><h4 id=_miért_érdemes_névszervert_futtatni>29.6.3. Miért érdemes névszervert futtatni<a class=anchor href=#_miért_érdemes_névszervert_futtatni></a></h4><div class=paragraph><p>A névszerverek általában két alakban jelennek meg. Egyikük a hitelesített névszerver, a másikuk a gyorsítótárazó névszerver.</p></div><div class=paragraph><p>Egy hitelesített névszerverre akkor van szükségünk, ha:</p></div><div class=ulist><ul><li><p>a világ többi része felé akarunk hiteles névfeloldási információkat szolgáltatni;</p></li><li><p>regisztráltunk egy tartományt (például <code>minta.org</code>) és az alatta levõ hálózati nevekhez is szeretnénk IP-címeket rendeltetni;</p></li><li><p>a IP-címtartományunkban szükség van inverz névfeloldási bejegyzésekre (amely IP-címbõl ad meg hálózati nevet) is;</p></li><li><p>a kérések teljesítéséhez egy tartalék avagy második, alárendelt (slave) névszerver kell.</p></li></ul></div><div class=paragraph><p>A gyorsítótárazó névszerverre akkor van szükségünk, ha:</p></div><div class=ulist><ul><li><p>egy helyi névfeloldó szerver felhasználásával fel akarjuk gyorsítani az egyébként a külsõ névszerver felé irányuló kérések kiszolgálását.</p></li></ul></div><div class=paragraph><p>Amikor valaki lekérdezi a <code>www.FreeBSD.org</code> címét, akkor a névfeloldó elõször általában a kapcsolatot rendelkezésre bocsátó internet-szolgáltató névszerverét kérdezi meg és onnan kapja meg a választ. Egy helyi, gyorsítótárazó névszerver használata esetén azonban egy ilyen kérést csak egyszer kell kiadni a külsõ névszervernek. Ezután már minden további ilyen kérés el sem hagyja a belsõ hálózatunkat, mivel a válasz szerepel a gyorsítótárban.</p></div></div><div class=sect3><h4 id=_ahogyan_mûködik_2>29.6.4. Ahogyan mûködik<a class=anchor href=#_ahogyan_mûködik_2></a></h4><div class=paragraph><p>FreeBSD alatt a BIND démon nyilvánvaló okokból named néven érhetõ el.</p></div><table class="tableblock frame-none grid-all stretch informaltable"><col style=width:50%><col style=width:50%><thead><tr><th class="tableblock halign-left valign-top">Állomány</th><th class="tableblock halign-left valign-top">Leírás</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class=tableblock><a href="https://man.freebsd.org/cgi/man.cgi?query=named&amp;sektion=8&amp;format=html">named(8)</a></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>A BIND démon.</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><a href="https://man.freebsd.org/cgi/man.cgi?query=rndc&amp;sektion=8&amp;format=html">rndc(8)</a></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>A névszervert vezérlõ segédprogram.</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><span class=filename>/etc/namedb</span></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>A BIND által kezelt zónák adatait tároló könyvtár.</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><span class=filename>/etc/namedb/named.conf</span></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>A démon konfigurációs állománya.</p></td></tr></tbody></table><div class=paragraph><p>Attól függõen, hogy miként állítjuk be az adott zónát a szerveren, a hozzá tartozó állományok a <span class=filename>/etc/namedb</span> könyvtáron belül a <span class=filename>master</span>, <span class=filename>slave</span> vagy <span class=filename>dynamic</span> alkönyvtárban foglalnak helyet. Az itt tárolt állományokban levõ névfeloldási információk alapján válaszol a névszerver a felé intézett kérésekre.</p></div></div><div class=sect3><h4 id=_a_bind_elindítása>29.6.5. A BIND elindítása<a class=anchor href=#_a_bind_elindítása></a></h4><div class=paragraph><p>Mivel a BIND alapból elérhetõ a rendszerben, viszonylag könnyen be tudjuk állítani.</p></div><div class=paragraph><p>A named alapértelmezett beállítása szerint egy <a href="https://man.freebsd.org/cgi/man.cgi?query=chroot&amp;sektion=8&amp;format=html">chroot(8)</a> környezetben futó egyszerû névfeloldást végzõ szerver, amely a helyi IPv4 interfészen (127.0.0.1) fogadja a kéréseket. Ezzel a beállítással a következõ parancson keresztül tudjuk elindítani:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># /etc/rc.d/named onestart</span></code></pre></div></div><div class=paragraph><p>Ha engedélyezni akarjuk a named démont minden egyes rendszerindításkor, tegyük a következõ sort az <span class=filename>/etc/rc.conf</span> állományba:</p></div><div class="literalblock programlisting"><div class=content><pre>named_enable=&#34;YES&#34;</pre></div></div><div class=paragraph><p>Értelemszerûen az <span class=filename>/etc/namedb/named.conf</span> tele van olyan beállítási lehetõségekkel, amelyek meghaladják ennek a leírásnak a kereteit. Ha viszont kíváncsiak vagyunk a FreeBSD-ben a named indításához használt beállításokra, akkor az <span class=filename>/etc/defaults/rc.conf</span> állományban nézzük meg <code>named_*</code> változókat és olvassuk át az <a href="https://man.freebsd.org/cgi/man.cgi?query=rc.conf&amp;sektion=5&amp;format=html">rc.conf(5)</a> man oldalt. Emellett még a <a href=./#configtuning-rcd>Az rc használata FreeBSD alatt</a>t is hasznos lehet elolvasni.</p></div></div><div class=sect3><h4 id=_a_konfigurációs_állományok_3>29.6.6. A konfigurációs állományok<a class=anchor href=#_a_konfigurációs_állományok_3></a></h4><div class=paragraph><p>A named beállításait tartalmazó állományok pillanatnyilag az <span class=filename>/etc/namedb</span> könyvtárban találhatóak és hacsak nem egy egyszerû névfeloldóra tartunk igényt, akkor a használata elõtt módosítanunk is kell. Itt ejtjük meg a beállítások nagy részét.</p></div><div class=sect4><h5 id=_etcnamedbnamed_conf>29.6.6.1. <span class=filename>/etc/namedb/named.conf</span><a class=anchor href=#_etcnamedbnamed_conf></a></h5><div class="literalblock programlisting"><div class=content><pre>// $FreeBSD$
//
// Részletesebb leírást a named.conf(5) és named(8) man oldalakon, valamint
// a /usr/shared/doc/bind9 könyvtárban találhatunk.
//
// Ha egy hitelesített szervert akarunk beállítani, akkor igyekezzünk
// a névfeloldás összes finom részletével pontosan tisztában lenni.
// Ugyanis még a legkisebb hibákkal is egyrészt elvághatunk gépeket az
// internet-lérésétõl, vagy másrészt felesleges forgalmat tudunk
// generálni
//

options {
	// A chroot könyvtárhoz relatív elérési út, amennyiben létezik
	directory	&#34;/etc/namedb&#34;;
	pid-file	&#34;/var/run/named/pid&#34;;
	dump-file	&#34;/var/dump/named_dump.db&#34;;
	statistics-file	&#34;/var/stats/named.stats&#34;;

// Ha a named démont csak helyi névfeloldóként használjuk, akkor ez
// egy biztonságos alapbeállítás. Ha viszont a named démon az egész
// hálózatunkat is kiszolgálja, akkor ezt a beállítást tegyük
// megjegyzésbe, vagy adjunk meg egy rendes IP-címet, esetleg
// töröljük ki.
	listen-on	{ 127.0.0.1; };

// Ha rendszerünkön engedélyezett az IPv6 használata, akkor a helyi
// névfeloldó használatához ezt a sort vegyük ki a megjegyzésbõl.
// A hálózatunk többi részérõl pedig úgy lehet elérni, ha itt megadunk
// egy IPv6 címet, vagy az &#34;any&#34; kulcsszót.
//	listen-on-v6	{ ::1; };

// Az alábbi zónákat már a lentebb található üres zónák eleve lefedik.
// Ha tehát a lenti üres zónákat kivesszük a konfigurációból, akkor
// ezeket a sorokat is tegyük megjegyzésbe.
	disable-empty-zone &#34;255.255.255.255.IN-ADDR.ARPA&#34;;
	disable-empty-zone &#34;0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.IP6.ARPA&#34;;
	disable-empty-zone &#34;1.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.IP6.ARPA&#34;;

// Ha a szolgáltatónk névszervert is elérhetõvé tett számunkra, akkor
// itt adjuk meg annak az IP-címét és engedélyezzük az alábbi sort.
// Ezzel egyben kihasználjuk a gyorsítótárat is, így mérsékeljük az
// internet felé mozgó névfeloldásokat.
/*
	forwarders {
		127.0.0.1;
	};
*

// Ha a &#39;forwarders&#39; rész nem üres, akkor alapértelmezés szerint a
// &#39;forward first&#39; értékkel rendelkezik.  Ekkor a kérést a helyi szerver
// kapja abban az esetben, amikor a &#39;forwarders&#39; részben megadott
// szerverek nem tudják megválaszolni.  Emellett a névszerverben a
// következõ sor hozzáadásával letilthatjuk, hogy önmagától ne
// kezdeményezzen kéréseket:
//     forward only;

// Ha a kérések továbbítását az /etc/resolv.conf állományban megadott
// bejegyzések mentén szeretnénk automatikusan konfigurálni, akkor vegyük
// ki a megjegyzésbõl az alábbi sort és adjuk hozzá az /etc/rc.conf
// állományhoz a name_auto_forward=yes sort.  Emellett használható még a
// named_auto_forward_only beállítás is (amely fentebb leírt funkciót
// valósítja meg).
//     include &#34;/etc/namedb/auto_forward.conf&#34;;</pre></div></div><div class=paragraph><p>Ahogy arról a megjegyzésekben is szó esik, úgy tudjuk aktiválni a gyorsítótárat, ha megadjuk a <code>forwarders</code> beállítást. Normális körülmények között a névszerver az interneten az egyes névszervereket rekurzívan fogja keresni egészen addig, amíg meg nem találja a keresett választ. Az iménti beállítás engedélyezésével azonban elõször a szolgáltató névszerverét (vagy az általa kijelölt névszervert) fogjuk megkérdezni, a saját gyorsítótárából. Ha a szolgáltató kérdéses névszervere egy gyakran használt, gyors névszerver, akkor ezt érdemes bekapcsolnunk.</p></div><div class="admonitionblock warning"><table><tbody><tr><td class=icon><i class="fa icon-warning" title=Warning></i></td><td class=content><div class=paragraph><p>Itt a <code>127.0.0.1</code> megadása <em>nem</em> mûködik. Mindenképpen írjuk át a szolgáltatónk névszerverének IP-címére.</p></div></td></tr></tbody></table></div><div class="literalblock programlisting"><div class=content><pre>	/*
	   A BIND legújabb változataiban alapértelmezés szerint minden egyes
	   kimenõ kérésnél más, véletlenszerûen választott UDP portot
	   használnak, ezáltal jelentõs mértékben csökkenthetõ a gyorsítótár
	   meghamisíthatóságának (cache poisoning) esélye.  Javasoljuk
	   mindenkinek, hogy használják ki ezt a lehetõséget és eszerint
	   állítsák be a tûzfalakat.

	   Ha nem sikerül a tûzfalat hozzáigazítani ehhez a
	   viselkedéshez AKKOR ÉS CSAK IS AKKOR engedélyezzük a lenti
	   beállítást.  Alkalmazásával sokkal kevésbé lesz ellenálló a
	   névszerver a különbözõ hamisítási kísérletekkel szemben,
	   ezért lehetõség szerint kerüljük el.

	   Az NNNNN helyére egy 49160 és 65530 közti számot kell
	   beírnunk.
	 */
	 // query-source address * port NNNNN;
};

// Ha engedélyezzük a helyi névszervert, akkor az /etc/resolv.conf
// állományban elsõ helyen megadni a 127.0.0.1 címet. Sõt, az
// /etc/rc.conf állományból se felejtsük ki.

// A hagyományos &#34;root-hints&#34; megoldás.  Használjuk ezt VAGY a lentebb
// megadott alárendelt zónákat.
zone &#34;.&#34; { type hint; file &#34;named.root&#34;; };

/*	Több szempontból is elõnyös, ha a következõ zónákat alárendeljük a
	gyökér névfeloldó szervereknek:
	1. A helyi felhasználók kéréseit gyorsabban tudjuk feloldalni.
	2. A gyökérszerverek felé nem megy semmilyen hamis forgalom.
	3. A gyökérszerverek meghibásodása vagy elosztott DoS támadás
	   esetén rugalmasabban tudunk reagálni.

	Másfelöl azonban ez a módszer a &#34;hints&#34; állomány alkalmazásával
	szemben több felügyeletet igényel, mivel figyelnünk kell, nehogy
	egy váratlan meghibásodás mûködésképtelenné tegye a
	szerverünket.  Ez a megoldás leginkább a sok klienst kiszolgáló
	névszerverek esetén bizonyulhat jövedelmezõbbnek.  Óvatosan
	bánjunk vele!

	A módszer alkalmazásához vegyük ki a megjegyzésbõl a következõ
	bejegyzéseket és tegyük megjegyzésbe a fenti hint zónát.
*/

zone &#34;.&#34; {
	type slave;
	file &#34;slave/root.slave&#34;;
	masters {
		192.5.5.241;	// F.ROOT-SERVERS.NET.
	};
	notify no;
};

zone &#34;arpa&#34; {
	type slave;
	file &#34;slave/arpa.slave&#34;;
	masters {
		192.5.5.241;	// F.ROOT-SERVERS.NET.
	};
	notify no;
}

zone &#34;in-addr.arpa&#34; {
	type slave;
	file &#34;slave/in-addr.arpa.slave&#34;;
	masters {
		192.5.5.241;	// F.ROOT-SERVERS.NET.
	};
	notify no;
};
*/

/*	Az alábbi zónák helyi kiszolgálásával meg tudjuk akadályozni, hogy
	a belõlük indított kérések elhagyják a hálózatunkat és a elérjük
	a gyökér névfeloldó szervereket.  Ez a megközelítés két komoly
	elõnnyel rendelkezik:
	1. A helyi felhasználók kéréseit gyorsabban tudjuk
	   megválaszolni.
	2. A gyökérszerverek felé nem továbbítódik semmilyen hamis
	   forgalom.
*/
// RFC 1912
zone &#34;localhost&#34;	{ type master; file &#34;master/localhost-forward.db&#34;; };
zone &#34;127.in-addr.arpa&#34;	{ type master; file &#34;master/localhost-reverse.db&#34;; };
zone &#34;255.in-addr.arpa&#34;	{ type master; file &#34;master/empty.db&#34;; };

// A helyi IPv6 címek részére létrehozott RFC 1912-szerû zóna
zone &#34;0.ip6.arpa&#34;	{ type master; file &#34;master/localhost-reverse.db&#34;; };

// &#34;Ez&#34; a hálózat (RFC 1912 és 3330)
zone &#34;0.in-addr.arpa&#34;		{ type master; file &#34;master/empty.db&#34;; };

// Magáncélú hálózatok (RFC 1918)
zone &#34;10.in-addr.arpa&#34;		{ type master; file &#34;master/empty.db&#34;; };
zone &#34;16.172.in-addr.arpa&#34;	{ type master; file &#34;master/empty.db&#34;; };
zone &#34;17.172.in-addr.arpa&#34;	{ type master; file &#34;master/empty.db&#34;; };
zone &#34;18.172.in-addr.arpa&#34;	{ type master; file &#34;master/empty.db&#34;; };
zone &#34;19.172.in-addr.arpa&#34;	{ type master; file &#34;master/empty.db&#34;; };
zone &#34;20.172.in-addr.arpa&#34;	{ type master; file &#34;master/empty.db&#34;; };
zone &#34;21.172.in-addr.arpa&#34;	{ type master; file &#34;master/empty.db&#34;; };
zone &#34;22.172.in-addr.arpa&#34;	{ type master; file &#34;master/empty.db&#34;; };
zone &#34;23.172.in-addr.arpa&#34;	{ type master; file &#34;master/empty.db&#34;; };
zone &#34;24.172.in-addr.arpa&#34;	{ type master; file &#34;master/empty.db&#34;; };
zone &#34;25.172.in-addr.arpa&#34;	{ type master; file &#34;master/empty.db&#34;; };
zone &#34;26.172.in-addr.arpa&#34;	{ type master; file &#34;master/empty.db&#34;; };
zone &#34;27.172.in-addr.arpa&#34;	{ type master; file &#34;master/empty.db&#34;; };
zone &#34;28.172.in-addr.arpa&#34;	{ type master; file &#34;master/empty.db&#34;; };
zone &#34;29.172.in-addr.arpa&#34;	{ type master; file &#34;master/empty.db&#34;; };
zone &#34;30.172.in-addr.arpa&#34;	{ type master; file &#34;master/empty.db&#34;; };
zone &#34;31.172.in-addr.arpa&#34;	{ type master; file &#34;master/empty.db&#34;; };
zone &#34;168.192.in-addr.arpa&#34;	{ type master; file &#34;master/empty.db&#34;; };

// Helyi link/APIPA (RFC 3330 és 3927)
zone &#34;254.169.in-addr.arpa&#34;	{ type master; file &#34;master/empty.db&#34;; };

// Dokumentációs próbahálózat (RFC 3330)
zone &#34;2.0.192.in-addr.arpa&#34;	{ type master; file &#34;master/empty.db&#34;; };

// Útválasztási teljesítmény tesztelésére (RFC 3330)
zone &#34;18.198.in-addr.arpa&#34;	{ type master; file &#34;master/empty.db&#34;; };
zone &#34;19.198.in-addr.arpa&#34;	{ type master; file &#34;master/empty.db&#34;; };

// Az IANA részére fentartott - a régi E osztályú címtér
zone &#34;240.in-addr.arpa&#34;		{ type master; file &#34;master/empty.db&#34;; };
zone &#34;241.in-addr.arpa&#34;		{ type master; file &#34;master/empty.db&#34;; };
zone &#34;242.in-addr.arpa&#34;		{ type master; file &#34;master/empty.db&#34;; };
zone &#34;243.in-addr.arpa&#34;		{ type master; file &#34;master/empty.db&#34;; };
zone &#34;244.in-addr.arpa&#34;		{ type master; file &#34;master/empty.db&#34;; };
zone &#34;245.in-addr.arpa&#34;		{ type master; file &#34;master/empty.db&#34;; };
zone &#34;246.in-addr.arpa&#34;		{ type master; file &#34;master/empty.db&#34;; };
zone &#34;247.in-addr.arpa&#34;		{ type master; file &#34;master/empty.db&#34;; };
zone &#34;248.in-addr.arpa&#34;		{ type master; file &#34;master/empty.db&#34;; };
zone &#34;249.in-addr.arpa&#34;		{ type master; file &#34;master/empty.db&#34;; };
zone &#34;250.in-addr.arpa&#34;		{ type master; file &#34;master/empty.db&#34;; };
zone &#34;251.in-addr.arpa&#34;		{ type master; file &#34;master/empty.db&#34;; };
zone &#34;252.in-addr.arpa&#34;		{ type master; file &#34;master/empty.db&#34;; };
zone &#34;253.in-addr.arpa&#34;		{ type master; file &#34;master/empty.db&#34;; };
zone &#34;254.in-addr.arpa&#34;		{ type master; file &#34;master/empty.db&#34;; };

// Hozzárendelés nélküli IPv6-címek (RFC 4291)
zone &#34;1.ip6.arpa&#34;		{ type master; file &#34;master/empty.db&#34;; };
zone &#34;3.ip6.arpa&#34;		{ type master; file &#34;master/empty.db&#34;; };
zone &#34;4.ip6.arpa&#34;		{ type master; file &#34;master/empty.db&#34;; };
zone &#34;5.ip6.arpa&#34;		{ type master; file &#34;master/empty.db&#34;; };
zone &#34;6.ip6.arpa&#34;		{ type master; file &#34;master/empty.db&#34;; };
zone &#34;7.ip6.arpa&#34;		{ type master; file &#34;master/empty.db&#34;; };
zone &#34;8.ip6.arpa&#34;		{ type master; file &#34;master/empty.db&#34;; };
zone &#34;9.ip6.arpa&#34;		{ type master; file &#34;master/empty.db&#34;; };
zone &#34;a.ip6.arpa&#34;		{ type master; file &#34;master/empty.db&#34;; };
zone &#34;b.ip6.arpa&#34;		{ type master; file &#34;master/empty.db&#34;; };
zone &#34;c.ip6.arpa&#34;		{ type master; file &#34;master/empty.db&#34;; };
zone &#34;d.ip6.arpa&#34;		{ type master; file &#34;master/empty.db&#34;; };
zone &#34;e.ip6.arpa&#34;		{ type master; file &#34;master/empty.db&#34;; };
zone &#34;0.f.ip6.arpa&#34;		{ type master; file &#34;master/empty.db&#34;; };
zone &#34;1.f.ip6.arpa&#34;		{ type master; file &#34;master/empty.db&#34;; };
zone &#34;2.f.ip6.arpa&#34;		{ type master; file &#34;master/empty.db&#34;; };
zone &#34;3.f.ip6.arpa&#34;		{ type master; file &#34;master/empty.db&#34;; };
zone &#34;4.f.ip6.arpa&#34;		{ type master; file &#34;master/empty.db&#34;; };
zone &#34;5.f.ip6.arpa&#34;		{ type master; file &#34;master/empty.db&#34;; };
zone &#34;6.f.ip6.arpa&#34;		{ type master; file &#34;master/empty.db&#34;; };
zone &#34;7.f.ip6.arpa&#34;		{ type master; file &#34;master/empty.db&#34;; };
zone &#34;8.f.ip6.arpa&#34;		{ type master; file &#34;master/empty.db&#34;; };
zone &#34;9.f.ip6.arpa&#34;		{ type master; file &#34;master/empty.db&#34;; };
zone &#34;a.f.ip6.arpa&#34;		{ type master; file &#34;master/empty.db&#34;; };
zone &#34;b.f.ip6.arpa&#34;		{ type master; file &#34;master/empty.db&#34;; };
zone &#34;0.e.f.ip6.arpa&#34;		{ type master; file &#34;master/empty.db&#34;; };
zone &#34;1.e.f.ip6.arpa&#34;		{ type master; file &#34;master/empty.db&#34;; };
zone &#34;2.e.f.ip6.arpa&#34;		{ type master; file &#34;master/empty.db&#34;; };
zone &#34;3.e.f.ip6.arpa&#34;		{ type master; file &#34;master/empty.db&#34;; };
zone &#34;4.e.f.ip6.arpa&#34;		{ type master; file &#34;master/empty.db&#34;; };
zone &#34;5.e.f.ip6.arpa&#34;		{ type master; file &#34;master/empty.db&#34;; };
zone &#34;6.e.f.ip6.arpa&#34;		{ type master; file &#34;master/empty.db&#34;; };
zone &#34;7.e.f.ip6.arpa&#34;		{ type master; file &#34;master/empty.db&#34;; };

// IPv6 ULA (RFC 4193)
zone &#34;c.f.ip6.arpa&#34;		{ type master; file &#34;master/empty.db&#34;; };
zone &#34;d.f.ip6.arpa&#34;		{ type master; file &#34;master/empty.db&#34;; };

// IPv6 helyi link (RFC 4291)
zone &#34;8.e.f.ip6.arpa&#34;		{ type master; file &#34;master/empty.db&#34;; };
zone &#34;9.e.f.ip6.arpa&#34;		{ type master; file &#34;master/empty.db&#34;; };
zone &#34;a.e.f.ip6.arpa&#34;		{ type master; file &#34;master/empty.db&#34;; };
zone &#34;b.e.f.ip6.arpa&#34;		{ type master; file &#34;master/empty.db&#34;; };

// Elavult IPv6 helyi címek (RFC 3879)
zone &#34;c.e.f.ip6.arpa&#34;		{ type master; file &#34;master/empty.db&#34;; };
zone &#34;d.e.f.ip6.arpa&#34;		{ type master; file &#34;master/empty.db&#34;; };
zone &#34;e.e.f.ip6.arpa&#34;		{ type master; file &#34;master/empty.db&#34;; };
zone &#34;f.e.f.ip6.arpa&#34;		{ type master; file &#34;master/empty.db&#34;; };

// Az IP6.INT már elavult (RFC 4159)
zone &#34;ip6.int&#34;			{ type master; file &#34;master/empty.db&#34;; };

// FONTOS: Ne használjuk ezeket az IP-címeket, mert nem valódiak,
// csupán illusztrációs és dokumentációs célokból adtuk meg!
//
// Az alárendelt zónák beállításaira vonatkozó bejegyzések. Érdemes
// ilyet beállítani legalább ahhoz a zónához, amelyhez a tartományunk is
// tartozik. Az elsõdleges névszerverhez tartozó IP-címet érdeklõdjük meg
// az illetékes hálózati rendszergazdától.
//
// Soha ne felejtsünk el megadni zónát az inverz kereséshez!  A neve az IP-cím
// tagjainak fordított sorrendjébõl // származik, amelyhez hozzátoldunk még egy
// &#34;.IN-ADDR.ARPA&#34; (illetve IPv6 esetén &#34;.IP6.ARPA&#34;) részt.
//
// Mielõtt nekilátnánk egy elsõdleges zóna beállításának, gondoljuk
// végig, hogy tényleg a megfelelõ szinten ismerjük a névfeloldás és
// a BIND mûködését. Gyakran ugyanis egyáltalán nem nyilvánvaló
// csapdákba tudunk esni.  Egy alárendelt zóna beállítása általában sokkal egyszerûbb feladat.
//
// FONTOS: Ne kövessük vakon a most következõ példát :-) Helyette inkább
// valódi neveket és címeket adjunk meg.

/* Példa dinamikus zónára
key &#34;mintaorgkulcs&#34; {
	algorithm hmac-md5;
	secret &#34;sf87HJqjkqh8ac87a02lla==&#34;;
};
zone &#34;minta.org&#34; {
	type master;
	allow-update {
		key &#34;mintaorgkulcs&#34;;
	};
	file &#34;dynamic/minta.org&#34;;
};
*/

/* Példa inverz alárendelt zónákra
zone &#34;1.168.192.in-addr.arpa&#34; {
	type slave;
	file &#34;slave/1.168.192.in-addr.arpa&#34;;
	masters {
		192.168.1.1;
	};
};
*/</pre></div></div><div class=paragraph><p>A <span class=filename>named.conf</span> állományban tehát így adhatunk meg közvetlen és inverz alárendelt zónákat.</p></div><div class=paragraph><p>Minden egyes újabb kiszolgált zónához az egy új bejegyzést kell felvenni a <span class=filename>named.conf</span> állományban.</p></div><div class=paragraph><p>Például a <code>minta.org</code> címhez tartozó legegyszerûbb ilyen bejegyzés így néz ki:</p></div><div class="literalblock programlisting"><div class=content><pre>zone &#34;minta.org&#34; {
	type master;
	file &#34;master/minta.org&#34;;
};</pre></div></div><div class=paragraph><p>Ez egy központi zóna, ahogy arról a <code>type</code> mezõ, vagyis a típusa is árulkodik. Továbbá a <code>file</code> mezõben láthatjuk, hogy a hozzá tartozó információkat az <span class=filename>/etc/namedb/master/minta.org</span> állományban tárolja.</p></div><div class="literalblock programlisting"><div class=content><pre>zone &#34;minta.org&#34; {
	type slave;
	file &#34;slave/minta.org&#34;;
};</pre></div></div><div class=paragraph><p>Az alárendelt esetben a zónához tartozó információkat a zóna központi szerverétõl kapjuk meg és megadott állományban mentjük el. Ha valamiért a központi szerver leáll vagy nem érhetõ el, akkor az alárendelt szerver az átküldött zóna információk alapján képes helyette kiszolgálni a kéréseket.</p></div></div><div class=sect4><h5 id=_a_zóna_állományok>29.6.6.2. A zóna állományok<a class=anchor href=#_a_zóna_állományok></a></h5><div class=paragraph><p>A <code>minta.org</code> címhez tartozó példa központi zóna állomány (amely az <span class=filename>/etc/namedb/master/néven.org</span> érhetõ el) tartalma az alábbi:</p></div><div class="literalblock programlisting"><div class=content><pre>$TTL 3600        ; alapértelmezés szerint 1 óra
minta.org.      IN      SOA      ns1.minta.org. admin.minta.org. (
                                2006051501      ; sorozatszám
                                10800           ; frissítés
                                3600            ; ismétlés
                                604800          ; lejárat
                                300             ; TTL negatív válasz
                        )

; névszerverek
                IN      NS      ns1.minta.org.
                IN      NS      ns2.minta.org.

; MX rekordok
                IN      MX 10   mx.minta.org.
                IN      MX 20   levelezes.minta.org.

                IN      A       192.168.1.1

; a gépek nevei
localhost       IN      A       127.0.0.1
ns1             IN      A       192.168.1.2
ns2             IN      A       192.168.1.3
mx              IN      A       192.168.1.4
levelezes       IN      A       192.168.1.5

; álnevek
www             IN      CNAME   minta.org.</pre></div></div><div class=paragraph><p>A "."-ra végzõdõ hálózati nevek abszolút nevek, míg minden más "." nélküli név az õsére vezehetõ vissza (tehát relatív). Például az <code>ns1</code> névbõl az <code>ns1.minta.org</code> keletkezik.</p></div><div class=paragraph><p>A zóna állományok felépítése a következõ:</p></div><div class="literalblock programlisting"><div class=content><pre>rekordnév      IN rekordtípus   érték</pre></div></div><div class=paragraph><p>A névfeloldásban leggyakrabban alkalmazott rekordok típusai:</p></div><div class=dlist><dl><dt class=hdlist1>SOA</dt><dd><p>a zóna fennhatóságának kezdete</p></dd><dt class=hdlist1>NS</dt><dd><p>egy hitelesített névszerver</p></dd><dt class=hdlist1>A</dt><dd><p>egy gép címe</p></dd><dt class=hdlist1>CNAME</dt><dd><p>egy álnév kanonikus neve</p></dd><dt class=hdlist1>MX</dt><dd><p>levélváltó</p></dd><dt class=hdlist1>PTR</dt><dd><p>mutató a tartománynévre (az inverz feloldás használja)</p></dd></dl></div><div class="literalblock programlisting"><div class=content><pre>minta.org. IN SOA ns1.minta.org. admin.minta.org. (
                        2006051501      ; sorozatszám
                        10800           ; 3 óránként frissítsünk
                        3600            ; 1 óra után próbálkozzunk újra
                        604800          ; 1 hét után jár le
                        300 )           ; TTL negatív válasz</pre></div></div><div class=dlist><dl><dt class=hdlist1><code>minta.org.</code></dt><dd><p>a tartomány neve, amely egyben a zóna õse</p></dd><dt class=hdlist1><code>ns1.minta.org.</code></dt><dd><p>a zóna elsõdleges/hitelesített névszervere</p></dd><dt class=hdlist1><code>admin.minta.org.</code></dt><dd><p>a zónáért felelõs személy neve, akinek az e-mail címét a "@" behelyettesítésével kapjuk meg. (Tehát a <a href=mailto:admin@example.org>admin@example.org</a> címbõl <code>admin.example.org</code> lesz.)</p></dd><dt class=hdlist1><code>2006051501</code></dt><dd><p>az állomány sorozatszáma. Ezt a zóna állomány módosításakor mindig növelnünk kell. Manapság a rendszergazdák a sorozatszámot <code>ééééhhnnvv</code> alakban adják meg. A <code>2006051501</code> tehát azt jelenti, hogy az állományt 2006. május 15-én módosították utoljára, és a <code>01</code> pedig arra utal, hogy aznap elõször. A sorozatszám megadása fontos az alárendelt névszerverek számára, mivel így tudják megállapítani, hogy a zóna mikor változott utoljára.</p></dd></dl></div><div class="literalblock programlisting"><div class=content><pre>                IN NS           ns1.minta.org.</pre></div></div><div class=paragraph><p>Ez egy NS bejegyzés. A zónához tartozó minden hitelesített névszervernek lennie kell legalább egy ilyen bejegyzésének.</p></div><div class="literalblock programlisting"><div class=content><pre>localhost       IN      A       127.0.0.1
ns1             IN      A       192.168.1.2
ns2             IN      A       192.168.1.3
mx              IN      A       192.168.1.4
levelezes       IN      A       192.168.1.5</pre></div></div><div class=paragraph><p>Az A rekord egy gép nevét adja meg. Ahogy a fenti példából is kiderül, az <code>ns1.minta.org</code> név a <code>192.168.1.2</code> címre képzõdik le.</p></div><div class="literalblock programlisting"><div class=content><pre>                IN      A       192.168.1.1</pre></div></div><div class=paragraph><p>Ez a sor <code>192.168.1.1</code> címet rendeli az aktuális õshöz, amely jelen esetünkben az <code>example.org</code>.</p></div><div class="literalblock programlisting"><div class=content><pre>www             IN CNAME        @</pre></div></div><div class=paragraph><p>A kanonikus neveket tároló rekordokat általában egy gép álneveihez használjuk. Ebben a példában a <code>www</code> a "fõgép" egyik álneve, amely itt éppenséggel a <code>minta.org</code> (<code>192.168.1.1</code>) tartományneve. A CNAME rekordok mellé más típusú rekordokat ugyanarra a hálózati névre soha ne adjunk meg.</p></div><div class="literalblock programlisting"><div class=content><pre>                IN MX   10      levelezes.minta.org.</pre></div></div><div class=paragraph><p>Az MX rekord adja meg, hogy milyen levelezõ szerverek felelõsek a zónába érkezõ levelek fogadásáért. A <code>levelezes.minta.org</code> a levelezõ szerver hálózati neve, ahol a 10 az adott levelezõ szerver prioritása.</p></div><div class=paragraph><p>Több levelezõ szerver is megadható 10-es, 20-as stb. prioritásokkal. A <code>minta.org</code> tartományon belül elõször mindig a legnagyobb MX prioritással rendelkezõ levelezõ szervernek próbáljuk meg továbbítani a leveleket (a legkisebb prioritási értékkel rendelkezõ rekord), majd ezután a második legnagyobbnak stb. egészen addig, amíg a levelet tovább nem küldtük.</p></div><div class=paragraph><p>Az in-addr.arpa zóna állományok (inverz DNS) esetén ugyanez a felépítés, kivéve, hogy a PTR típusú bejegyzések szerepelnek az A és CNAME helyett.</p></div><div class="literalblock programlisting"><div class=content><pre>$TTL 3600

1.168.192.in-addr.arpa. IN SOA ns1.minta.org. admin.minta.org. (
                        2006051501      ; sorozatszám
                        10800           ; frissítés
                        3600            ; ismétlés
                        604800          ; lejárat
                        300 )           ; TTL negatív válasz

        IN      NS      ns1.minta.org.
        IN      NS      ns2.minta.org.

1       IN      PTR     minta.org.
2       IN      PTR     ns1.minta.org.
3       IN      PTR     ns2.minta.org.
4       IN      PTR     mx.minta.org.
5       IN      PTR     levelezes.minta.org.</pre></div></div><div class=paragraph><p>Ez az állomány írja le tehát a kitalált tartományunkon belül az IP-címek és hálózati nevek összerendelését.</p></div><div class=paragraph><p>Érdemes megemlíteni, hogy a PTR rekordok jobb oldalán álló nevek mindegyikének teljes hálózati névnek kell lennie (vagyis "." karakterrel kell végzõdnie).</p></div></div></div><div class=sect3><h4 id=_a_gyorsítótárazó_névszerver>29.6.7. A gyorsítótárazó névszerver<a class=anchor href=#_a_gyorsítótárazó_névszerver></a></h4><div class=paragraph><p>A gyorsítótárazó névszerver az a névszerver, amely elsõdleges feladata a rekurzív kérések kiszolgálása. Egyszerûen továbbítja a beérkezõ kéréseket, majd megjegyzi azokat, így késõbb közvetlenül tud válaszolni.</p></div></div><div class=sect3><h4 id=_biztonság>29.6.8. Biztonság<a class=anchor href=#_biztonság></a></h4><div class=paragraph><p>Habár a névfeloldás szempontjából a BIND a legelterjedtebb, a biztonságosságával azért akadnak gondok. Gyakran találnak benne potenciális és kihasználható biztonsági réseket.</p></div><div class=paragraph><p>A FreeBSD azonban a named démont automatikusan egy <a href="https://man.freebsd.org/cgi/man.cgi?query=chroot&amp;sektion=8&amp;format=html">chroot(8)</a> környezetbe helyezi. Emellett még léteznek további más védelmi mechanizmusok is, amelyek segítségével el tudjuk kerülni a névfeloldást célzó esetleges támadásokat.</p></div><div class=paragraph><p>Sosem árt olvasgatni a <a href=http://www.cert.org/>CERT</a> által kiadott biztonsági figyelmeztetéseket és feliratkozni a <a href=https://lists.FreeBSD.org/subscription/freebsd-security-notifications>FreeBSD security notifications levelezési lista</a> címére, hogy folyamatosan értesüljünk az interneten és a FreeBSD-ben talált különbözõ biztonsági hibákról.</p></div><div class="admonitionblock tip"><table><tbody><tr><td class=icon><i class="fa icon-tip" title=Tip></i></td><td class=content><div class=paragraph><p>Ha valamilyen gondunk támadna, akkor esetleg próbálkozzunk meg a forrásaink frissítésével és a named újrafordításával.</p></div></td></tr></tbody></table></div></div><div class=sect3><h4 id=_egyéb_olvasnivalók>29.6.9. Egyéb olvasnivalók<a class=anchor href=#_egyéb_olvasnivalók></a></h4><div class=paragraph><p>A BIND/named man oldalai: <a href="https://man.freebsd.org/cgi/man.cgi?query=rndc&amp;sektion=8&amp;format=html">rndc(8)</a> <a href="https://man.freebsd.org/cgi/man.cgi?query=named&amp;sektion=8&amp;format=html">named(8)</a> <a href="https://man.freebsd.org/cgi/man.cgi?query=named.conf&amp;sektion=8&amp;format=html">named.conf(8)</a></p></div><div class=ulist><ul><li><p><a href=http://www.isc.org/software/bind>Az ISC BIND hivatalos honlapja (angolul)</a></p></li><li><p><a href=http://www.isc.org/software/guild>Az ISC BIND hivatalos fóruma (angolul)</a></p></li><li><p><a href=http://www.oreilly.com/catalog/dns5/>O’Reilly DNS and BIND 5th Edition</a></p></li><li><p><a href=http://www.rfc-editor.org/rfc/rfc1034.txt>RFC1034 - Domain Names - Concepts and Facilities</a></p></li><li><p><a href=http://www.rfc-editor.org/rfc/rfc1035.txt>RFC1035 - Domain Names - Implementation and Specification</a></p></li></ul></div></div></div><div class=sect2><h3 id=network-apache>29.7. Az Apache webszerver<a class=anchor href=#network-apache></a></h3><div class=sect3><h4 id=_áttekintés_2>29.7.1. Áttekintés<a class=anchor href=#_áttekintés_2></a></h4><div class=paragraph><p>A FreeBSD szolgálja ki a legforgalmasabb honlapok nagy részét szerte a világban. A mögöttük álló webszerverek általában az Apache webszervert alkalmazzák. Az Apache használatához szükséges csomagok megtalálhatóak a FreeBSD telepítõlemezén is. Ha a FreeBSD elsõ telepítésekor még nem telepítettük volna az Apache szerverét, akkor a <a class=package href=https://cgit.freebsd.org/ports/tree/www/apache13/>www/apache13</a> vagy <a class=package href=https://cgit.freebsd.org/ports/tree/www/apache12/>www/apache12</a> portból tudjuk feltenni.</p></div><div class=paragraph><p>Az Apache szervert sikeres telepítését követõen be kell állítanunk.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Ebben a szakaszban az Apache webszerver 1.3.X változatát mutatjuk be, mivel ezt használják a legtöbben FreeBSD alatt. Az Apache 2.X rengeteg új technológiát vezetett be, de ezekkel itt most nem foglalkozunk. Az Apache 2.X változatával kapcsolatban keressük fel a <a href=http://httpd.apache.org/>http://httpd.apache.org/</a> oldalt.</p></div></td></tr></tbody></table></div></div><div class=sect3><h4 id=_beállítás_4>29.7.2. Beállítás<a class=anchor href=#_beállítás_4></a></h4><div class=paragraph><p>Az Apache webszerver konfigurációs állománya FreeBSD alatt <span class=filename>/usr/local/etc/apache/httpd.conf</span> néven található. Ez az állomány egy szokványos UNIX®-os szöveges konfigurációs állomány, ahol a megjegyzéseket egy <code>#</code> karakterrel vezetjük be. Az itt használható összes lehetséges beállítási lehetõség átfogó ismertetése meghaladná az egész kézikönyv határait, ezért most csak a leggyakrabban módosított direktívákat fogjuk ismertetni.</p></div><div class=dlist><dl><dt class=hdlist1><code>ServerRoot "/usr/local"</code></dt><dd><p>Ez adja meg az Apache számára az alapértelmezett könyvtárat. A binárisai ezen belül a <span class=filename>bin</span> és <span class=filename>sbin</span> alkönyvtárakban, a konfigurációs állományai pedig az <span class=filename>etc/apache</span> könyvtárban tárolódnak.</p></dd><dt class=hdlist1><code>ServerAdmin <a href=mailto:saját@címünk.az>saját@címünk.az</a>.interneten</code></dt><dd><p>Erre a címre küldhetik nekünk a szerverrel kapcsolatos hibákat. Ez a cím egyes szerver által generált oldalakon jelenik meg, például hibák esetében.</p></dd><dt class=hdlist1><code>ServerName www.minta.com</code></dt><dd><p>A <code>ServerName</code> segítségével meg tudjuk adni, hogy milyen nevet küldjön vissza a szerver a klienseknek olyankor, ha az nem egyezne meg a jelenlegivel (vagyis a <code>www</code> nevet használjuk a gépünk valódi neve helyett).</p></dd><dt class=hdlist1><code>DocumentRoot "/usr/local/www/data"</code></dt><dd><p>A <code>DocumentRoot</code> adja meg azt a könyvtárat, ahonnan kiszolgáljuk a dokumentumokat. Alapértelmezés szerint az összes kérés erre a könyvtárra fog vonatkozni, de a szimbolikus linkek és az álnevek akár más helyekre is mutathatnak.</p></dd></dl></div><div class=paragraph><p>A változtatások végrehajtása elõtt mindig is jó ötlet biztonsági másolatot készíteni az Apache konfigurációs állományairól. Ahogy sikerült összerakni egy számunkra megfelelõ konfigurációt, készen is állunk az Apache futtatására.</p></div></div><div class=sect3><h4 id=_az_apache_futtatása>29.7.3. Az Apache futtatása<a class=anchor href=#_az_apache_futtatása></a></h4><div class=paragraph><p>A többi hálózati szervertõl eltérõen az Apache nem az inetd szuperszerverbõl fut. A kliensektõl érkezõ HTTP kérések minél gyorsabb kiszolgálásának érdekében úgy állítottuk be, hogy önállóan fusson. Ehhez egy szkriptet is mellékeltünk, amellyel igyekeztünk a lehetõ legjobban leegyszerûsíteni a szerver indítását, leállítását és újraindítását. Az Apache elsõ indításához adjuk ki a következõ parancsot:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># /usr/local/sbin/apachectl start</span></code></pre></div></div><div class=paragraph><p>Így pedig a szervert bármikor leállíthatjuk:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># /usr/local/sbin/apachectl stop</span></code></pre></div></div><div class=paragraph><p>Ha valamilyen okból megváltoztattuk volna a szerver beállításait, akkor ezen a módon tudjuk újraindítani:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># /usr/local/sbin/apachectl restart</span></code></pre></div></div><div class=paragraph><p>Ha a jelenleg megnyitott kapcsolatok felbontása nélkül akarjuk újraindítani az Apache szervert, akkor ezt írjuk be:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># /usr/local/sbin/apachectl graceful</span></code></pre></div></div><div class=paragraph><p>Mindezekrõl az <a href="https://man.freebsd.org/cgi/man.cgi?query=apachectl&amp;sektion=8&amp;format=html">apachectl(8)</a> man oldalon találunk bõvebb leírást.</p></div><div class=paragraph><p>Amennyiben szükségünk lenne az Apache elindítására a rendszer indításakor, akkor a következõ sort vegyünk fel az <span class=filename>/etc/rc.conf</span> állományba:</p></div><div class="literalblock programlisting"><div class=content><pre>apache_enable=&#34;YES&#34;</pre></div></div><div class=paragraph><p>Az Apache 2.2 esetében:</p></div><div class="literalblock programlisting"><div class=content><pre>apache22_enable=&#34;YES&#34;</pre></div></div><div class=paragraph><p>Amikor az Apache <code>httpd</code> nevû programjának szeretnénk további paranccsori paramétereket átadni a rendszer indítása során, akkor ezeket így tudjuk megadni az <span class=filename>rc.conf</span> állományban:</p></div><div class="literalblock programlisting"><div class=content><pre>apache_flags=&#34;&#34;</pre></div></div><div class=paragraph><p>Most, miután a webszerverünk mûködik, a böngészõnkkel mindezt ellenõrizni is tudjuk a <code><a href=http://localhost/ class=bare>http://localhost/</a></code> cím beírásával. Ilyenkor az alapértelmezés szerinti <span class=filename>/usr/local/www/data/index.html</span> állomány tartalmát láthatjuk.</p></div></div><div class=sect3><h4 id=_virtuális_nevek>29.7.4. Virtuális nevek<a class=anchor href=#_virtuális_nevek></a></h4><div class=paragraph><p>Az Apache a virtuális nevek használatának két különbözõ módját ismeri. Ezek közül az elsõ módszer a név alapú virtualizáció (Name-based Virtual Hosting). Ilyenkor a kliens HTTP/1.1 fejlécébõl próbálja meg a szerver megállapítani a hivatkozási nevet. Segítségével több tartomány is osztozhat egyetlen IP-címen.</p></div><div class=paragraph><p>Az Apache név alapú virtualizációjának beállításához az alábbi beállítást kell hozzátennünk a <span class=filename>httpd.conf</span> állományhoz:</p></div><div class="literalblock programlisting"><div class=content><pre>NameVirtualHost *</pre></div></div><div class=paragraph><p>Ha a webszerverünk neve <code>www.tartomany.hu</code>, és hozzá egy <code>www.valamilyenmasiktartomany.hu</code> virtuális nevet akarunk megadni, akkor azt a következõképpen tehetjük meg a <span class=filename>httpd.conf</span> állományon belül:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>&lt;VirtualHost <span class=k>*</span><span class=o>&gt;</span>
ServerName www.tartomany.hu
DocumentRoot /www/tartomany.hu
&lt;/VirtualHost&gt;

&lt;VirtualHost <span class=k>*</span><span class=o>&gt;</span>
ServerName www.valamilyenmasiktartomany.hu
DocumentRoot /www/valamilyenmasiktartomany.hu
&lt;/VirtualHost&gt;</code></pre></div></div><div class=paragraph><p>A címek és elérési utak helyére helyettesítsük be a használni kívánt címeket és elérési utakat.</p></div><div class=paragraph><p>A virtuális nevek beállításának további részleteivel kapcsolatosan keressük fel az Apache hivatalos dokumentációját a <a href=http://httpd.apache.org/docs/vhosts/>http://httpd.apache.org/docs/vhosts/</a> címen (angolul).</p></div></div><div class=sect3><h4 id=_apache_modulok>29.7.5. Apache-modulok<a class=anchor href=#_apache_modulok></a></h4><div class=paragraph><p>Az alap szerver képességeinek kiegészítéséhez több különbözõ Apache modul áll rendelkezésünkre. A FreeBSD Portgyûjteménye az Apache telepítése mellett lehetõséget ad a népszerûbb bõvítményeinek telepítésére is.</p></div><div class=sect4><h5 id=_mod_ssl>29.7.5.1. mod_ssl<a class=anchor href=#_mod_ssl></a></h5><div class=paragraph><p>A mod_ssl modul az OpenSSL könyvtár használatával valósít meg erõs titkosítást a biztonságos socket réteg második, illetve harmadik verziójával (Secure Sockets Layer, SSL v2/v3) és a biztonságos szállítási rétegbeli (Transport Layer Security v1) protokoll segítségével. Ez a modul mindent biztosít ahhoz, hogy a megfelelõ hatóságok által aláírt tanúsítványokat tudjunk kérni, és ezáltal egy védett webszervert futtassunk FreeBSD-n.</p></div><div class=paragraph><p>Ha még nem telepítettünk volna fel az Apache szervert, akkor a <a class=package href=https://cgit.freebsd.org/ports/tree/www/apache13-modssl/>www/apache13-modssl</a> porton keresztül a mod_ssl modullal együtt is fel tudjuk rakni az Apache 1.3.X változatát. Az SSL támogatása pedig már az Apache 2.X <a class=package href=https://cgit.freebsd.org/ports/tree/www/apache22/>www/apache22</a> porton keresztül elérhetõ változataiban alapértelmezés szerint engedélyezett.</p></div></div><div class=sect4><h5 id=_kapcsolódás_nyelvekhez>29.7.5.2. Kapcsolódás nyelvekhez<a class=anchor href=#_kapcsolódás_nyelvekhez></a></h5><div class=paragraph><p>Mindegyik nagyobb szkriptnyelvhez létezik egy külön Apache-modul, amelyek segítségével komplett Apache-modulokat tudunk készíteni az adott nyelven. Gyakran a dinamikus honlapok is így próbálják a szerverbe épített belsõ értelmezõn keresztül a külsõ értelmezõ indításából és benne a szkriptek lefuttatásából fakadó költségeket megspórolni, ahogy errõl a következõ szakaszokban olvashatunk.</p></div></div></div><div class=sect3><h4 id=_dinamikus_honlapok>29.7.6. Dinamikus honlapok<a class=anchor href=#_dinamikus_honlapok></a></h4><div class=paragraph><p>Az utóbbi évtizedben egyre több vállalkozás fordult az internet felé bevételeik és részesedéseinek növelésének reményében, amivel egyre jobban megnõtt az igény a dinamikus honlapokra is. Miközben bizonyos cégek, mint például a Microsoft®, a saját fejlesztésû termékeikbe építettek be ehhez támogatást, addig a nyílt forrásokkal foglalkozó közösség sem maradt tétlen és felvette a kesztyût. A dinamikus tartalom létrehozásához többek közt Django, Ruby on Rails, a mod_perl és a mod_php modulok használhatóak.</p></div><div class=sect4><h5 id=_django>29.7.6.1. Django<a class=anchor href=#_django></a></h5><div class=paragraph><p>A Django egy BSD típusú licensszel rendelkezõ keretrendszer, amelynek használatával nagy teljesítményû és elegáns webes alkalmazásokat tudunk gyorsan kifejleszteni. Tartalmaz egy objektum-relációs leképezõt, így az adattípusokat Python-objektumokként tudjuk leírni, és ezekhez az objektumokhoz egy sokrétû, dinamikus adatbázis hozzáférést nyújtó alkalmazásfejlesztõi felületet, így a fejlesztõknek egyetlen SQL utasítást sem kell megírniuk. Találhatunk még benne továbbá egy bõvíthetõ sablonrendszert, amelynek köszönhetõen az alkalmazás belsõ mûködése elválasztható a HTML-beli megjelenésétõl.</p></div><div class=paragraph><p>A Django mûködéséhez a mod_python modulra, az Apache szerverre és egy tetszõlegesen választott SQL alapú adatbázisrendszerre van szükség. A hozzá tartozó FreeBSD port mindezeket automatikusan telepíti a megadott beállítások szerint.</p></div><div id=network-www-django-install class=exampleblock><div class=title>Példa 35. A Django telepítése az Apache, mod_python3 és a PostgreSQL használatával</div><div class=content><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># cd /usr/ports/www/py-django; make all install clean -DWITH_MOD_PYTHON3 -DWITH_POSTGRESQL</span></code></pre></div></div></div></div><div class=paragraph><p>Miután a Django és a hozzá szükséges komponensek felkerültek rendszerünkre, hozzunk létre egy könyvtárat a leendõ Django projektünknek és állítsuk be az Apache szervert, hogy az oldalunk belül a megadott linkekre a saját alkalmazásunkat hívja meg a beágyazott Python-értelmezõn keresztül.</p></div><div id=network-www-django-apache-config class=exampleblock><div class=title>Példa 36. Az Apache beállítása a Django és mod_python használatához</div><div class=content><div class=paragraph><p>A következõ sort kell hozzátennünk a <span class=filename>httpd.conf</span> állományhoz, hogy az Apache bizonyos linkeket a webes alkalmazás felé irányítson át:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>&lt;Location <span class=s2>&#34;/&#34;</span><span class=o>&gt;</span>
    SetHandler python-program
    PythonPath <span class=s2>&#34;[&#39;/a/django/csomagok/helye/&#39;] + sys.path&#34;</span>
    PythonHandler django.core.handlers.modpython
    SetEnv DJANGO_SETTINGS_MODULE azoldalam.beallitasai
    PythonAutoReload On
    PythonDebug On
&lt;/Location&gt;</code></pre></div></div></div></div></div><div class=sect4><h5 id=_ruby_on_rails>29.7.6.2. Ruby on Rails<a class=anchor href=#_ruby_on_rails></a></h5><div class=paragraph><p>A Ruby on Rails egy olyan másik nyílt forráskódú keretrendszer, amivel lényegében egy teljes fejlesztõi készletet kapunk és amelyet kifejezetten arra élezték ki, hogy segítségével a webfejlesztõk sokkal gyorsabban tudjanak haladni és a komolyabb alkalmazások gyorsabb elkészítése se okozzon nekik gondot. A Portrgyûjteménybõl pillanatok alatt telepíthetõ.</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># cd /usr/ports/www/rubygem-rails; make all install clean</span></code></pre></div></div></div><div class=sect4><h5 id=_mod_perl>29.7.6.3. mod_perl<a class=anchor href=#_mod_perl></a></h5><div class=paragraph><p>Az Apache és Perl egyesítésén fáradozó projekt a Perl programozási nyelv és az Apache webszerver erejének összehangolásán dolgozik. A mod_perl modulon keresztül Perlben vagyunk képesek modulokat készíteni az Apache szerverhez. Ráadásul a szerverben egy belsõ állandó értelmezõ is található hozzá, ezzel igyekeznek megspórolni a külsõ értelmezõ és a Perl indításából keletkezõ többletköltségeket.</p></div><div class=paragraph><p>A mod_perl több különbözõ módon állítható munkába. A mod_perl használatához nem szabad elfelejtenünk, hogy a mod_perl 1.0-ás verziója csak az Apache 1.3 változatával mûködik, és a mod_perl 2.0-ás változata pedig csak az Apache 2.X változataival. A mod_perl 1.0 a <a class=package href=https://cgit.freebsd.org/ports/tree/www/mod_perl/>www/mod_perl</a> portból telepíthetõ, valamint a statikusan beépített változata a <a class=package href=https://cgit.freebsd.org/ports/tree/www/apache13-modperl/>www/apache13-modperl</a> portban található. A mod_perl 2.0 a <a class=package href=https://cgit.freebsd.org/ports/tree/www/mod_perl2/>www/mod_perl2</a> portból rakható fel.</p></div></div><div class=sect4><h5 id=_mod_php>29.7.6.4. mod_php<a class=anchor href=#_mod_php></a></h5><div class=paragraph><p>A PHP, vagy másik nevén "PHP, a hipertext feldolgozó" egy általános célú szkriptnyelv, amelyet kifejezetten honlapok fejlesztéséhez hoztak létre. A szabványos HTML ágyazható nyelv felépítésében a C, Java™ és Perl nyelveket ötvözi annak elérése érdekében, hogy ezzel segítse a fejlesztõket a dinamikusan generált oldalak minél gyorsabb megírásában.</p></div><div class=paragraph><p>A PHP5 támogatását úgy tudjuk hozzáadni az Apache webszerverhez, ha telepítjük a <a class=package href=https://cgit.freebsd.org/ports/tree/lang/php5/>lang/php5</a> portot.</p></div><div class=paragraph><p>Ha a <a class=package href=https://cgit.freebsd.org/ports/tree/lang/php5/>lang/php5</a> portot most telepítjük elõször, akkor a vele kapcsolatos beállításokat tartalmazó <code>OPTIONS</code> menü automatikusan megjelenik. Ha ezzel nem találkoznánk, mert például valamikor korábban már felraktuk volna a <a class=package href=https://cgit.freebsd.org/ports/tree/lang/php5/>lang/php5</a> portot, akkor a port könyvtárában következõ parancs kiadásával tudjuk újra visszahozni:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># make config</span></code></pre></div></div><div class=paragraph><p>A beállítások között jelöljük be az <code>APACHE</code> opciót, amelynek eredményeképpen létrejön az Apache webszerverhez használható mod_php5 betölthetõ modul.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>A PHP4 modult még ma is rengeteg szerver használja több különbözõ okból (például kompatibilitási problémák vagy a már korábban kiadott tartalom miatt). Ha tehát a mod_php5 helyett inkább a mod_php4 modulra lenne szükségünk, akkor a <a class=package href=https://cgit.freebsd.org/ports/tree/lang/php4/>lang/php4</a> portot használjuk. A <a class=package href=https://cgit.freebsd.org/ports/tree/lang/php4/>lang/php4</a> portnál is megtalálhatjuk a <a class=package href=https://cgit.freebsd.org/ports/tree/lang/php5/>lang/php5</a> fordítási idejû beállításainak nagy részét.</p></div></td></tr></tbody></table></div><div class=paragraph><p>Az iméntiek révén települnek és beállítódnak a dinamikus PHP alkalmazások támogatásához szükséges mouldok. Az <span class=filename>/usr/local/etc/apache/httpd.conf</span> állományban ellenõrizni is tudjuk, hogy az alábbi részek megjelentek-e:</p></div><div class="literalblock programlisting"><div class=content><pre>LoadModule php5_module        libexec/apache/libphp5.so</pre></div></div><div class="literalblock programlisting"><div class=content><pre>AddModule mod_php5.c
    &lt;IfModule mod_php5.c&gt;
        DirectoryIndex index.php index.html
    &lt;/IfModule&gt;
    &lt;IfModule mod_php5.c&gt;
        AddType application/x-httpd-php .php
        AddType application/x-httpd-php-source .phps
    &lt;/IfModule&gt;</pre></div></div><div class=paragraph><p>Ahogy befejezõdött a mûvelet, a PHP modul betöltéséhez mindösszesen az <code>apachectl</code> paranccsal kell óvatosan újraindítanunk a webszervert:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># apachectl graceful</span></code></pre></div></div><div class=paragraph><p>A PHP jövõbeni frissítéseihez már nem lesz szükségünk a <code>make config</code> parancsra, mivel a korábban kiválasztott <code>OPTIONS</code> menün belüli beállítasainkat a FreeBSD Portgyûjteményéhez tartozó keretrendszer automatikusan elmenti.</p></div><div class=paragraph><p>A PHP FreeBSD-ben megtalálható támogatása kifejezetten moduláris, ezért az alap telepítése igencsak korlátozott. A további elemek hozzáadásához a <a class=package href=https://cgit.freebsd.org/ports/tree/lang/php5-extensions/>lang/php5-extensions</a> portot tudjuk használni. A port egy menüvezérelt felületet nyújt a PHP különbözõ bõvítményeinek telepítéséhez. Az egyes bõvítményeket azonban a megfelelõ portok használatával is fel tudjuk rakni.</p></div><div class=paragraph><p>Például PHP5 modulhoz úgy tudunk támogatást adni a MySQL adatbázis szerverhez, ha telepítjük a <span class=filename>databases/php5-mysql</span> portot.</p></div><div class=paragraph><p>Miután telepítettünk egy bõvítményt, az Apache szerverrel újra be kell töltetnünk a megváltozott beállításokat:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># apachectl graceful</span></code></pre></div></div></div></div></div><div class=sect2><h3 id=network-ftp>29.8. Állományok átvitele (FTP)<a class=anchor href=#network-ftp></a></h3><div class=sect3><h4 id=_áttekintés_3>29.8.1. Áttekintés<a class=anchor href=#_áttekintés_3></a></h4><div class=paragraph><p>Az adatállomány átviteli protokoll (File Transfer Protocol, FTP) a felhasználók számára lehetõséget ad az ún. FTP szerverekre állományokat feltölteni, illetve onnan állományokat letölteni. A FreeBSD alaprendszere is tartalmaz egy ilyen FTP szerverprogramot, ftpd néven. Ezért FreeBSD alatt egy FTP szerver beállítása meglehetõsen egyszerû.</p></div></div><div class=sect3><h4 id=_beállítás_5>29.8.2. Beállítás<a class=anchor href=#_beállítás_5></a></h4><div class=paragraph><p>A beállítás legfontosabb lépése, hogy eldöntsük milyen hozzáféréseken át lehet elérni az FTP szervert. Egy hétköznapi FreeBSD rendszerben rengeteg hozzáférés a különbözõ démonokhoz tartozik, de az ismeretlen felhasználók számára nem kellene megengednünk ezek használatát. Az <span class=filename>/etc/ftpusers</span> állományban szerepelnek azok a felhasználók, akik semmilyen módon nem érhetik el az FTP szolgáltatást. Alapértelmezés szerint itt találhatjuk az elõbb említett rendszerszintû hozzáféréseket is, de ide minden további nélkül felvehetjük azokat a felhasználókat, akiknél nem akarjuk engedni az FTP elérését.</p></div><div class=paragraph><p>Más esetekben elõfordulhat, hogy csak korlátozni akarjuk egyes felhasználók FTP elérését. Ezt az <span class=filename>/etc/ftpchroot</span> állományon keresztül tehetjük meg. Ebben az állományban a lekorlátozni kívánt felhasználókat és csoportokat írhatjuk bele. Az <a href="https://man.freebsd.org/cgi/man.cgi?query=ftpchroot&amp;sektion=5&amp;format=html">ftpchroot(5)</a> man oldalán olvashatjuk el ennek részleteit, ezért ennek pontos részleteit itt most nem tárgyaljuk.</p></div><div class=paragraph><p>Ha az FTP szerverünkhöz névtelen (anonim) hozzáférést is engedélyezni akarunk, akkor ahhoz elõször készítenünk kell egy <code>ftp</code> nevû felhasználót a FreeBSD rendszerünkben. A felhasználók ezután az <code>ftp</code> vagy <code>anonymous</code> nevek, valamint egy tetszõleges jelszó (ez a hagyományok szerint a felhasználó e-mail címe) használatával is képesek lesznek bejelentkezni. Az FTP szerver ezután a névtelen felhasználók esetében meghívja a <a href="https://man.freebsd.org/cgi/man.cgi?query=chroot&amp;sektion=2&amp;format=html">chroot(2)</a> rendszerhívást, és ezzel lekorlátozza hozzáférésüket az <code>ftp</code> felhasználó könyvtárára.</p></div><div class=paragraph><p>Két szöveges állományban adhatunk meg a becsatlakozó FTP kliensek számára üdvözlõ üzeneteket. Az <span class=filename>/etc/ftpwelcome</span> állomány tartalmát még a bejelentkezés elõtt látni fogják a felhasználók, a sikeres bejelentkezést követõen pedig az <span class=filename>/etc/ftpmotd</span> állomány tartalmát látják. Vigyázzunk, mert ennek az állománynak már a bejelentkezési környezethez képest relatív az elérése, ezért a névtelen felhasználók esetében ez konkrétan az <span class=filename>~ftp/etc/ftpmotd</span> állomány lesz.</p></div><div class=paragraph><p>Ahogy beállítottuk az FTP szervert, az <span class=filename>/etc/inetd.conf</span> állományban is engedélyeznünk kell. Itt mindössze annyira lesz szükségünk, hogy eltávolítsuk a megjegyzést jelzõ "#" karaktert a már meglevõ ftpd sor elõl:</p></div><div class="literalblock programlisting"><div class=content><pre>ftp	stream	tcp	nowait	root	/usr/libexec/ftpd	ftpd -l</pre></div></div><div class=paragraph><p>Ahogy arról már a <a href=#network-inetd-reread>Az inetd konfigurációs állományának újraolvasása</a> szót ejtett, az inetd beállításait újra be kell olvastatnunk a konfigurációs állomány megváltoztatása után. A <a href=#network-inetd-settings>Beállítások</a> írja le az inetd engedélyezésének részleteit.</p></div><div class=paragraph><p>Az ftpd önálló szerverként is elindítható. Ehhez mindössze elegendõ csak a megfelelõ változót beállítani az <span class=filename>/etc/rc.conf</span> állományban:</p></div><div class="literalblock programlisting"><div class=content><pre>ftpd_enable=&#34;YES&#34;</pre></div></div><div class=paragraph><p>Miután megadtuk az iménti változót, a szerver el fog indulni a rendszer következõ indítása során. Szükség esetén természetesen <code>root</code> felhasználóként a következõ paranccsal is közvetlenül elindítható:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># /etc/rc.d/ftpd start</span></code></pre></div></div><div class=paragraph><p>Most már be is tudunk jelentkezni az FTP szerverre:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>% ftp localhost</code></pre></div></div></div><div class=sect3><h4 id=_karbantartás>29.8.3. Karbantartás<a class=anchor href=#_karbantartás></a></h4><div class=paragraph><p>Az ftpd démon a <a href="https://man.freebsd.org/cgi/man.cgi?query=syslog&amp;sektion=3&amp;format=html">syslog(3)</a> használatával naplózza az üzeneteket. Alapértelmezés szerint a rendszernaplózó démon az FTP mûködésére vonatkozó üzeneteket az <span class=filename>/var/log/xferlog</span> állományba írja. Az FTP naplóinak helyét az <span class=filename>/etc/syslog.conf</span> állományban tudjuk módosítani:</p></div><div class="literalblock programlisting"><div class=content><pre>ftp.info      /var/log/xferlog</pre></div></div><div class=paragraph><p>Legyünk körültekintõek a névtelen FTP szerverek üzemeltetésekor. Azt pedig kétszer is gondoljuk meg, hogy engedélyezzük-e a névtelen felhasználók számára állományok feltöltését, hiszen könnyen azon kaphatjuk magunkat, hogy az FTP oldalunk illegális állománycserék színterévé válik vagy esetleg valami sokkal rosszabb történik. Ha mindenképpen szükségünk lenne erre a lehetõségre, akkor állítsunk be olyan engedélyeket a feltöltött állományokra, hogy a többi névtelen felhasználó ezeket a tartalmuk tüzetes ellenõrzéséig ne is olvashassa.</p></div></div></div><div class=sect2><h3 id=network-samba>29.9. Állomány- és nyomtatási szolgáltatások Microsoft® Windows® kliensek számára (Samba)<a class=anchor href=#network-samba></a></h3><div class=sect3><h4 id=_áttekintés_4>29.9.1. Áttekintés<a class=anchor href=#_áttekintés_4></a></h4><div class=paragraph><p>A Samba egy olyan elterjedt nyílt forráskódú szoftver, ami Microsoft® Windows® kliensek számára tesz lehetõvé állomány- és nyomtatási szolgáltatásokat. Az ilyen kliensek általa helyi meghajtóként képesek elérni a FreeBSD állományrendszerét, vagy helyi nyomtatóként a FreeBSD általt kezelt nyomtatókat.</p></div><div class=paragraph><p>A Samba csomagja általában megtalálható a FreeBSD telepítõeszközén. Ha a FreeBSD-vel együtt nem raktuk fel a Samba csomagját, akkor ezt késõbb <a class=package href=https://cgit.freebsd.org/ports/tree/net/samba3/>net/samba3</a> port vagy csomag telepítésével pótolhatjuk.</p></div></div><div class=sect3><h4 id=_beállítás_6>29.9.2. Beállítás<a class=anchor href=#_beállítás_6></a></h4><div class=paragraph><p>A Samba konfigurációs állománya a telepítés után <span class=filename>/usr/local/shared/examples/samba/smb.conf.default</span> néven található meg. Ezt kell lemásolnunk <span class=filename>/usr/local/etc/smb.conf</span> néven, amelyet aztán a Samba tényleges használata elõtt módosítanunk kell.</p></div><div class=paragraph><p>Az <span class=filename>smb.conf</span> állomány a Samba futásához használt beállításokat tartalmazza, mint például Windows® kliensek számára felkínált a nyomtatók és "megosztások" adatait. A Samba csomagban ezen kívül találhatunk még egy swat nevû webes eszközt, amellyel egyszerû módon tudjuk az <span class=filename>smb.conf</span> állományt állítgatni.</p></div><div class=sect4><h5 id=_a_samba_webes_adminisztrációs_eszköze_swat>29.9.2.1. A Samba webes adminisztrációs eszköze (SWAT)<a class=anchor href=#_a_samba_webes_adminisztrációs_eszköze_swat></a></h5><div class=paragraph><p>A Samba webes adminisztrációs segédeszköze (Samba Web Administration Tool, SWAT) az inetd démonon keresztül fut démonként. Ennek megfelelõn az <span class=filename>/etc/inetd.conf</span> állományban a következõ sort kell kivennünk megjegyzésbõl, mielõtt a swat segítségével megkezdenénk a Samba beállítását:</p></div><div class="literalblock programlisting"><div class=content><pre>swat   stream  tcp     nowait/400      root    /usr/local/sbin/swat    swat</pre></div></div><div class=paragraph><p>Ahogy azt a <a href=#network-inetd-reread>Az inetd konfigurációs állományának újraolvasása</a> is mutatja, az inetd démont újra kell indítanunk a megváltozott konfigurációs állományának újbóli beolvasásához.</p></div><div class=paragraph><p>Miután az <span class=filename>inetd.conf</span> állományban a swat engedélyezésre került, a böngészõnk segítségével próbáljunk meg a <a href=http://localhost:901>http://localhost:901</a> címre csatlakozni. Elõször a rendszer <code>root</code> hozzáférésével kell bejelentkeznünk.</p></div><div class=paragraph><p>Miután sikeresen bejelentkeztünk a Samba beállításait tárgyaló lapra, el tudjuk olvasni a rendszer dokumentációját, vagy a <b class=menuref>Globals</b> fülre kattintva nekiláthatunk a beállítások elvégzésének. A <b class=menuref>Globals</b> részben található opciók az <span class=filename>/usr/local/etc/smb.conf</span> állomány <code>[global]</code> szekciójában található változókat tükrözik.</p></div></div><div class=sect4><h5 id=_általános_beállítások>29.9.2.2. Általános beállítások<a class=anchor href=#_általános_beállítások></a></h5><div class=paragraph><p>Akár a swat eszközzel, akár a <span class=filename>/usr/local/etc/smb.conf</span> közvetlen módosításával dolgozunk, a Samba beállítása során a következõkkel mindenképpen össze fogunk futni:</p></div><div class=dlist><dl><dt class=hdlist1><code>workgroup</code></dt><dd><p>A szervert elérni kívánó számítógépek által használt NT tartomány vagy munkacsoport neve.</p></dd><dt class=hdlist1><code>netbios name</code></dt><dd><p>A Samba szerver NetBIOS neve. Alapértelmezés szerint ez a név a gép hálózati nevének elsõ tagja.</p></dd><dt class=hdlist1><code>server string</code></dt><dd><p>Ez a szöveg jelenik meg akkor, ha például a <code>net view</code> paranccsal vagy valamilyen más hálózati segédprogrammal kérdezzük le a szerver beszédesebb leírását.</p></dd></dl></div></div><div class=sect4><h5 id=_biztonsági_beállítások>29.9.2.3. Biztonsági beállítások<a class=anchor href=#_biztonsági_beállítások></a></h5><div class=paragraph><p>A <span class=filename>/usr/local/etc/smb.conf</span> állományban a két legfontosabb beállítás a választott biztonsági modell és a kliensek felhasználói jelszavainak tárolásához használt formátum. Az alábbi direktívák vezérlik ezeket:</p></div><div class=dlist><dl><dt class=hdlist1><code>security</code></dt><dd><p>Itt a két leggyakoribb beállítás a <code>security = share</code> és a <code>security = user</code>. Ha a kliensek a FreeBSD gépen található felhasználói neveiket használják, akkor felhasználói szintû védelemre van szükségünk (tehát a user beállításra). Ez az alapértelmezett biztonsági házirend és ilyenkor a klienseknek elõször be kell jelentkezniük a megosztott erõforrások eléréséhez.</p><div class=paragraph><p>A megosztás (share) szintû védelem esetében, a klienseknek nem kell a szerveren érvényes felhasználói névvel és jelszóval rendelkezniük a megosztott erõforrások eléréséhez. Ez volt az alapbeállítás a Samba korábbi változataiban.</p></div></dd><dt class=hdlist1><code>passdb backend</code></dt><dd><p>A Samba számos különbözõ hitelesítési modellt ismer. A klienseket LDAP, NIS+, SQL adatbázis vagy esetleg egy módosított jelszó állománnyal is tudjuk hitelesíteni. Az alapértelmezett hitelesítési módszer a <code>smbpasswd</code>, így itt most ezzel foglalkozunk.</p></dd></dl></div><div class=paragraph><p>Ha feltesszük, hogy az alapértelmezett <code>smbpasswd</code> formátumot választottuk, akkor a Samba úgy fogja tudni hitelesíteni a klienseket, ha elõtte létrehozzuk a <span class=filename>/usr/local/private/smbpasswd</span> állományt. Ha a Windows®-os kliensekkel is el akarjuk érni a UNIX®-os felhasználói hozzáféréseinket, akkor használjuk a következõ parancsot:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># smbpasswd -a felhasználónév</span></code></pre></div></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>A Samba a 3.0.23c verziójától kezdõdõen a hitelesítéshez szükséges állományokat a <span class=filename>/usr/local/etc/samba</span> könyvtárban tárolja. A felhasználói hozzáférések hozzáadására innentõl már a <code>tdbsam</code> parancs használata javasolt:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># pdbedit -a -u felhasználónév</span></code></pre></div></div></td></tr></tbody></table></div><div class=paragraph><p>A <a href=http://www.samba.org/samba/docs/man/Samba-HOWTO-Collection/>hivatalos Samba HOGYAN</a> ezekrõl a beállításokról szolgál további információkkal (angolul). Viszont az itt vázolt alapok viszont már elegendõek a Samba elindításához.</p></div></div></div><div class=sect3><h4 id=_a_samba_elindítása>29.9.3. A Samba elindítása<a class=anchor href=#_a_samba_elindítása></a></h4><div class=paragraph><p>A <a class=package href=https://cgit.freebsd.org/ports/tree/net/samba3/>net/samba3</a> port a Samba irányítására egy új indító szkriptet tartalmaz. A szkript engedélyezéséhez, tehát általa a Samba elindításának, leállításának és újraindításának lehetõvé tételéhez vegyük fel a következõ sort az <span class=filename>/etc/rc.conf</span> állományba:</p></div><div class="literalblock programlisting"><div class=content><pre>samba_enable=&#34;YES&#34;</pre></div></div><div class=paragraph><p>Ha még finomabb irányításra vágyunk:</p></div><div class="literalblock programlisting"><div class=content><pre>nmbd_enable=&#34;YES&#34;</pre></div></div><div class="literalblock programlisting"><div class=content><pre>smbd_enable=&#34;YES&#34;</pre></div></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Ezzel egyben a rendszer indításakor automatikusan be is indítjuk a Samba szolgáltatást.</p></div></td></tr></tbody></table></div><div class=paragraph><p>A Samba a következõkkel bármikor elindítható:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># /usr/local/etc/rc.d/samba start</span>
Starting SAMBA: removing stale tdbs :
Starting nmbd.
Starting smbd.</code></pre></div></div><div class=paragraph><p>Az rc szkriptekkel kapcsolatban a <a href=./#configtuning-rcd>Az rc használata FreeBSD alatt</a>t ajánljuk elolvasásra.</p></div><div class=paragraph><p>A Samba jelen pillanatban három különálló démonból áll. Láthatjuk is, hogy az nmbd és smbd démonokat elindította a <span class=filename>samba</span> szkript. Ha az <span class=filename>smb.conf</span> állományban engedélyeztük a winbind névfeloldási szolgáltatást is, akkor láthatjuk, hogy ilyenkor a winbindd démon is elindul.</p></div><div class=paragraph><p>A Samba így állítható le akármikor:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># /usr/local/etc/rc.d/samba stop</span></code></pre></div></div><div class=paragraph><p>A Samba egy összetett szoftvercsomag, amely a Microsoft® Windows® hálózatokkal kapcsolatos széles körû együttmûködést tesz lehetõvé. Az általa felkínált alapvetõ lehetõségeken túl a többit a <a href=http://www.samba.org>http://www.samba.org</a> honlapon ismerhetjük meg (angolul).</p></div></div></div><div class=sect2><h3 id=network-ntp>29.10. Az órák egyeztetése az NTP használatával<a class=anchor href=#network-ntp></a></h3><div class=sect3><h4 id=_áttekintés_5>29.10.1. Áttekintés<a class=anchor href=#_áttekintés_5></a></h4><div class=paragraph><p>Idõvel a számítógép órája hajlamos elmászni. A hálózati idõ protokoll (Network Time Protocol, NTP) az egyik módja az óránk pontosan tartásának.</p></div><div class=paragraph><p>Rengeteg internetes szolgáltatás elvárja vagy éppen elõnyben részesíti a számítógép órájának pontosságát. Például egy webszervertõl megkérdezhetik, hogy egy állományt adott ideje módosítottak-e. A helyi hálózatban az egyazon állományszerveren megosztott állományok ellentmondásmentes dátumozása érdekében szinte elengedhetetlen az órák szinkronizálása. Az olyan szolgáltatások, mint a <a href="https://man.freebsd.org/cgi/man.cgi?query=cron&amp;sektion=8&amp;format=html">cron(8)</a> is komolyan építkeznek a pontosan járó rendszerórára, amikor egy adott pillanatban kell lefuttatniuk parancsokat.</p></div><div class=paragraph><p>A FreeBSD alapból az <a href="https://man.freebsd.org/cgi/man.cgi?query=ntpd&amp;sektion=8&amp;format=html">ntpd(8)</a> NTP szervert tartalmazza, amellyel más NTP szerverek segítségével tudjuk beállítani gépünk óráját, vagy éppen idõvel kapcsolatos információkat szolgáltatni másoknak.</p></div></div><div class=sect3><h4 id=_a_megfelelõ_ntp_szerverek_kiválasztása>29.10.2. A megfelelõ NTP szerverek kiválasztása<a class=anchor href=#_a_megfelelõ_ntp_szerverek_kiválasztása></a></h4><div class=paragraph><p>Az óránk egyeztetéséhez egy vagy több NTP szerverre lesz szükségünk. Elõfordulhat, hogy a hálózati rendszergazdánk vagy az internet-szolgáltatónk már beállított egy ilyen szervert erre a célra. Ezzel kapcsolatban olvassuk el a megfelelõ leírásokat. A <a href=http://ntp.isc.org/bin/view/Servers/WebHome>nyilvánosan elérhetõ NTP szerverekrõl készült egy lista</a>, ahonnan könnyedén ki tudjuk keresni a számunkra leginkább megfelelõ (hozzánk legközelebbi) szervert. Ne hagyjuk figyelmen kívül a szerverre vonatkozó házirendet és kérjünk engedélyt a használatához, amennyiben ez szükséges.</p></div><div class=paragraph><p>Több, egymással közvetlen kapcsolatban nem álló NTP szerver választásával járunk jól, ha netalán az egyikük váratlanul elérhetetlenné vagy az órája pontatlanná válna. Az <a href="https://man.freebsd.org/cgi/man.cgi?query=ntpd&amp;sektion=8&amp;format=html">ntpd(8)</a> a visszakapott válaszokat intelligensen használja fel, mivel esetükben a megbízható szervereket részesíti elõnyben.</p></div></div><div class=sect3><h4 id=_a_gépünk_beállítása>29.10.3. A gépünk beállítása<a class=anchor href=#_a_gépünk_beállítása></a></h4><div class=sect4><h5 id=_alapvetõ_beállítások>29.10.3.1. Alapvetõ beállítások<a class=anchor href=#_alapvetõ_beállítások></a></h5><div class=paragraph><p>Ha a számítógépünk indításakor akarjuk egyeztetni az óránkat, akkor erre az <a href="https://man.freebsd.org/cgi/man.cgi?query=ntpdate&amp;sektion=8&amp;format=html">ntpdate(8)</a> nevû programot használhatjuk. Ez olyan asztali gépek számára megfelelõ választás, amelyeket gyakran indítanak újra és csak idõnként kell szinkronizálnunk. A legtöbb gépnek viszont az <a href="https://man.freebsd.org/cgi/man.cgi?query=ntpd&amp;sektion=8&amp;format=html">ntpd(8)</a> használatára van szüksége.</p></div><div class=paragraph><p>Az <a href="https://man.freebsd.org/cgi/man.cgi?query=ntpdate&amp;sektion=8&amp;format=html">ntpdate(8)</a> elindítása olyan esetekben is hasznos, ahol az <a href="https://man.freebsd.org/cgi/man.cgi?query=ntpd&amp;sektion=8&amp;format=html">ntpd(8)</a> is fut. Az <a href="https://man.freebsd.org/cgi/man.cgi?query=ntpd&amp;sektion=8&amp;format=html">ntpd(8)</a> az órát fokozatosan állítja, ellenben az <a href="https://man.freebsd.org/cgi/man.cgi?query=ntpdate&amp;sektion=8&amp;format=html">ntpdate(8)</a> az eltérés mértékétõl és irányától függetlenül egyszerûen átállítja a gép óráját a pontos idõre.</p></div><div class=paragraph><p>Az <a href="https://man.freebsd.org/cgi/man.cgi?query=ntpdate&amp;sektion=8&amp;format=html">ntpdate(8)</a> elindítását úgy tudjuk engedélyezni a rendszer indításakor, ha az <span class=filename>/etc/rc.conf</span> állományba berakjuk az <code>ntpdate_enable="YES"</code> sort. Emellett még <code>ntpdate_flags</code> változóban meg kell adnunk az alkalmazott beállítások mellett azokat a szervereket, amelyekkel szinkronizálni akarunk.</p></div></div><div class=sect4><h5 id=_általános_beállítások_2>29.10.3.2. Általános beállítások<a class=anchor href=#_általános_beállítások_2></a></h5><div class=paragraph><p>Az NTP az <span class=filename>/etc/ntp.conf</span> állományon keresztül állítható, amelyek felépítését az <a href="https://man.freebsd.org/cgi/man.cgi?query=ntp.conf&amp;sektion=5&amp;format=html">ntp.conf(5)</a> man oldal tárgyalja. Íme erre egy egyszerû példa:</p></div><div class="literalblock programlisting"><div class=content><pre>server ntplocal.minta.com prefer
server timeserver.minta.org
server ntp2a.minta.net

driftfile /var/db/ntp.drift</pre></div></div><div class=paragraph><p>A <code>server</code> beállítás adja meg az egyeztetéshez használt szervereket, soronként egyet. Ha egy szerver mellett szerepel még a <code>prefer</code> paraméter is, ahogy azt a példában a <code>ntplocal.minta.com</code> mellett láthattuk, akkor a többivel szemben azt a szervert fogjuk elõnyben részesíteni. Az így kiemelt szervertõl érkezõ választ abban az esetben viszont eldobjuk, hogy a többi szervertõl kapott válasz jelentõs mértékben eltér tõle. Minden más esetben a õ válasza lesz a mérvadó. A <code>prefer</code> paramétert általában olyan NTP szerverekhez használják, amelyek közismerten nagy pontosságúak, tehát például külön erre a célra szánt felügyeleti eszközt is tartalmaznak.</p></div><div class=paragraph><p>A <code>driftfile</code> beállítással azt az állományt adjuk meg, amiben a rendszeróra frekvencia eltolódásait tároljuk. Az <a href="https://man.freebsd.org/cgi/man.cgi?query=ntpd&amp;sektion=8&amp;format=html">ntpd(8)</a> program ezzel ellensúlyozza automatikusan az óra természetes elmászását, ezáltal lehetõvé téve, hogy egy viszonylag pontos idõt kapjuk még abban az esetben is, amikor egy kis idõre külsõ idõforrások nélkül maradnánk.</p></div><div class=paragraph><p>A <code>driftfile</code> beállítással egyben azt az állományt jelöljük ki, amely az NTP szervertõl kapott korábbi válaszokat tárolja. Ez az NTP mûködéséhez szükséges belsõ adatokat tartalmaz, ezért semmilyen más programnak nem szabad módosítania.</p></div></div><div class=sect4><h5 id=_a_szerverünk_elérésének_szabályozása>29.10.3.3. A szerverünk elérésének szabályozása<a class=anchor href=#_a_szerverünk_elérésének_szabályozása></a></h5><div class=paragraph><p>Alapértelmezés szerint az NTP szerverünket bárki képes elérni az interneten. Az <span class=filename>/etc/ntp.conf</span> állományban szereplõ <code>restrict</code> beállítás segítségével azonban meg tudjuk mondani, milyen gépek érhetik el a szerverünket.</p></div><div class=paragraph><p>Ha az NTP szerverünk felé mindenféle próbálkozást el akarunk utasítani, akkor az <span class=filename>/etc/ntp.conf</span> állományba a következõ sort kell felvennünk:</p></div><div class="literalblock programlisting"><div class=content><pre>restrict default ignore</pre></div></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Ezzel egyben azonban a helyi beállításainkban szereplõ szerverek elérését is megakadályozzuk. Ha külsõ NTP szerverekkel is szeretnénk szinkronizálni, akkor itt is engedélyezünk kell ezeket. Errõl bõvebben lásd az <a href="https://man.freebsd.org/cgi/man.cgi?query=ntp.conf&amp;sektion=5&amp;format=html">ntp.conf(5)</a> man oldalon.</p></div></td></tr></tbody></table></div><div class=paragraph><p>Ha csak a belsõ hálózatunkban levõ gépek számára szeretnénk elérhetõvé tenni az órák egyeztetését, de sem a szerver állapotának módosítását nem engedélyezzük, sem pedig azt, hogy a vele egyenrangú szerverekkel szinkronizáljon, akkor az iménti helyett a</p></div><div class="literalblock programlisting"><div class=content><pre>restrict 192.168.1.0 mask 255.255.255.0 nomodify notrap</pre></div></div><div class=paragraph><p>sort írjuk bele, ahol a <code>192.168.1.0</code> a belsõ hálózatunk IP-címe és a <code>255.255.255.0</code> a hozzá tartozó hálózati maszk.</p></div><div class=paragraph><p>Az <span class=filename>/etc/ntp.conf</span> több <code>restrict</code> típusú beállítást is tartalmazhat. Ennek részleteirõl az <a href="https://man.freebsd.org/cgi/man.cgi?query=ntp.conf&amp;sektion=5&amp;format=html">ntp.conf(5)</a> man oldalon, az <code>Access Control Support</code> címû szakaszban olvashatunk.</p></div></div></div><div class=sect3><h4 id=_az_ntp_futtatása>29.10.4. Az NTP futtatása<a class=anchor href=#_az_ntp_futtatása></a></h4><div class=paragraph><p>Úgy tudjuk az NTP szervert elindítani a rendszerünkkel együtt, ha az <span class=filename>/etc/rc.conf</span> állományban szerepeltetjük az <code>ntpd_enable="YES"</code> sort. Ha az <a href="https://man.freebsd.org/cgi/man.cgi?query=ntpd&amp;sektion=8&amp;format=html">ntpd(8)</a> számára további beállításokat is át akarunk adni, akkor az <span class=filename>/etc/rc.conf</span> állományban adjuk meg az <code>ntpd_flags</code> paramétert.</p></div><div class=paragraph><p>Ha a gépünk újraindítása nélkül akarjuk elindítani a szerver, akkor az <code>ntpd</code> parancsot adjuk ki az <span class=filename>/etc/rc.conf</span> állományban a <code>ntpd_flags</code> változóhoz megadott paraméterekkel. Mint például:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># ntpd -p /var/run/ntpd.pid</span></code></pre></div></div></div><div class=sect3><h4 id=_az_ntpd_használati_idõleges_internet_csatlakozással>29.10.5. Az ntpd használati idõleges internet csatlakozással<a class=anchor href=#_az_ntpd_használati_idõleges_internet_csatlakozással></a></h4><div class=paragraph><p>Az <a href="https://man.freebsd.org/cgi/man.cgi?query=ntpd&amp;sektion=8&amp;format=html">ntpd(8)</a> program megfelelõ mûködéséhez nem szükséges állandó internet kapcsolat. Ha azonban igény szerinti tárcsázással építjünk fel ideiglenes kapcsolatot, akkor érdemes letiltani az NTP forgalmát, nehogy feleslegesen aktiválja vagy tartsa életben a vonalat. Ha PPP típusú kapcsolatunk van, akkor az <span class=filename>/etc/ppp/ppp.conf</span> állományban a <code>filter</code> direktívával tudjuk ezt leszabályozni. Például:</p></div><div class="literalblock programlisting"><div class=content><pre> set filter dial 0 deny udp src eq 123
 # Nem engedjük az NTP által küldött adatoknak, hogy tárcsázást
 # kezdeményezzenek:
 set filter dial 1 permit 0 0
 set filter alive 0 deny udp src eq 123
 # Nem engedjük az NTP adatainak, hogy fenntartsák a kapcsolatot:
 set filter alive 1 deny udp dst eq 123
 set filter alive 2 permit 0/0 0/0</pre></div></div><div class=paragraph><p>Mindenezekrõl részletesebb felvilágosítást a <a href="https://man.freebsd.org/cgi/man.cgi?query=ppp&amp;sektion=8&amp;format=html">ppp(8)</a> man oldal <code>PACKET FILTERING</code> címû szakaszában és a <span class=filename>/usr/shared/examples/ppp/</span> könyvtárban található példákban kaphatunk.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Egyes internet-szolgáltatók blokkolják az alacsonyabb portokat, ezáltal az NTP nem használható, mivel a válaszok nem fogják elérni a gépünket.</p></div></td></tr></tbody></table></div></div><div class=sect3><h4 id=_további_olvasnivalók_3>29.10.6. További olvasnivalók<a class=anchor href=#_további_olvasnivalók_3></a></h4><div class=paragraph><p>Az NTP szerver dokumentációja HTML formátumban a <span class=filename>/usr/shared/doc/ntp/</span> könyvtárban található.</p></div></div></div><div class=sect2><h3 id=network-syslogd>29.11. Távoli gépek naplózása <code>syslogd</code> használatával<a class=anchor href=#network-syslogd></a></h3><div class=paragraph><p>A rendszernaplókkal kapcsolatos mûveletek egyaránt fontosak a biztonság és a karbantartás szempontjából. Ha közepes vagy nagyobb méretû, esetleg különbözõ típusú hálózatokban adminisztrálunk több gépet, akkor könnyen átláthatatlanná válhat a naplók rendszeres felügyelete. Ilyen helyzetekben a távoli naplózás beállításával az egész folyamatot sokkal kényelmesebbé tehetjük.</p></div><div class=paragraph><p>Némileg képesek vagyunk enyhíteni a naplóállományok kezelésének terhét, ha egyetlen központi szerverre küldjük át az adatokat. Ekkor a FreeBSD alaprendszerében megtalálható alapeszközökkel, mint például a <a href="https://man.freebsd.org/cgi/man.cgi?query=syslogd&amp;sektion=8&amp;format=html">syslogd(8)</a> vagy a <a href="https://man.freebsd.org/cgi/man.cgi?query=newsyslog&amp;sektion=8&amp;format=html">newsyslog(8)</a> felhasználásával egyetlen helyen be tudjuk állítani a naplók összegyûjtését, összefésülését és cseréjét. A most következõ példa konfigurációban az <code>A</code> gép, a <code>naploszerver.minta.com</code> fogja gyûjteni a helyi hálózatról érkezõ naplóinformációkat. A <code>B</code> gép, a <code>naplokliens.minta.com</code> pedig a szervernek küldi a naplózandó adatokat. Éles környezetben mind a két gépnek rendelkeznie kell megfelelõ DNS bejegyzésekkel, vagy legalább szerepelniük kell egymás <span class=filename>/etc/hosts</span> állományaiban. Ha ezt elmulasztjuk, a szerver nem lesz hajlandó adatokat fogadni.</p></div><div class=sect3><h4 id=_a_naplószerver_beállítása>29.11.1. A naplószerver beállítása<a class=anchor href=#_a_naplószerver_beállítása></a></h4><div class=paragraph><p>A naplószerverek olyan gépek, amelyeket úgy állítottunk be, hogy naplózási információkat tudjanak fogadni távoli számítógépekrõl. A legtöbb esetben így egyszerûsíteni tudunk a konfiguráción, vagy olykor egyszerûen csak hasznos, ha ezt a megoldást alkalmazzuk. Függetlenül attól, hogy miért használjuk, a továbblépés elõtt néhány elõkészületet meg kell tennünk.</p></div><div class=paragraph><p>Egy rendesen beállított naplószervernek legalább a következõ követelményeknek kell eleget tennie:</p></div><div class=ulist><ul><li><p>az 514-es UDP portot engedélyezni kell mind a kliensen, mind pedig a szerveren futó tûzfal szabályrendszerében;</p></li><li><p>a <a href="https://man.freebsd.org/cgi/man.cgi?query=syslogd&amp;sektion=8&amp;format=html">syslogd(8)</a> képes legyen a távoli kliens gépekrõl érkezõ üzeneteket fogadni;</p></li><li><p>a <a href="https://man.freebsd.org/cgi/man.cgi?query=syslogd&amp;sektion=8&amp;format=html">syslogd(8)</a> szervernek és az összes kliensnek rendelkeznie kell érvényes DNS (közvetlen és inverz) bejegyzésekkel vagy szerepelnie kell az <span class=filename>/etc/hosts</span> állományban.</p></li></ul></div><div class=paragraph><p>A naplószerver beállításához mindegyik klienst fel kell vennünk az <span class=filename>/etc/syslog.conf</span> állományba, valamint meg kell adnunk a megfelelõ funkciót (facility):</p></div><div class="literalblock programlisting"><div class=content><pre>+naplokliens.minta.com
*.*     /var/log/naplokliens.log</pre></div></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>A <a href="https://man.freebsd.org/cgi/man.cgi?query=syslog.conf&amp;sektion=5&amp;format=html">syslog.conf(5)</a> man oldalán megtalálhatjuk a különbözõ támogatott és elérhetõ <em>funkciókat</em>.</p></div></td></tr></tbody></table></div><div class=paragraph><p>Miután beállítottuk, az összes adott funkcióhoz tartozó üzenet az elõbb megadott állományba (<span class=filename>/var/log/naplokliens.log</span>) fog kerülni.</p></div><div class=paragraph><p>A szerveren továbbá meg kell adnunk a következõ sort az <span class=filename>/etc/rc.conf</span> állományban:</p></div><div class="literalblock programlisting"><div class=content><pre>syslogd_enable=&#34;YES&#34;
syslogd_flags=&#34;-a naplokliens.minta.com -vv&#34;</pre></div></div><div class=paragraph><p>Az elsõ sorral engedélyezzük a <code>syslogd</code> elindítását a rendszerindítás során, majd a második sorral engedélyezzük, hogy a kliens naplózni tudjon a szerverre. Itt még látható a <code>-vv</code> opció, amellyel a naplózott üzenetek részletességét tudjuk növelni. Ennek nagyon fontos a szerepe a naplózási funkciók behangolásakor, mivel így a rendszergazdák pontosan láthatják milyen típusú üzenetek milyen funkcióval kerültek rögzítésre a naplóban.</p></div><div class=paragraph><p>Befejezésképpen hozzuk létre a naplóállományt. Teljesen mindegy, hogy erre milyen megoldást alkalmazunk, például a <a href="https://man.freebsd.org/cgi/man.cgi?query=touch&amp;sektion=1&amp;format=html">touch(1)</a> remekül megfelel:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># touch /var/log/naplokliens.log</span></code></pre></div></div><div class=paragraph><p>Ezután indítsuk újra és ellenõrizzük a <code>syslogd</code> démont:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># /etc/rc.d/syslogd restart</span>
<span class=c># pgrep syslog</span></code></pre></div></div><div class=paragraph><p>Ha válaszul megkapjuk a futó démon azonosítóját, akkor sikerült újraindítanunk, elkezdhetjük a kliens beállítását. Ha valamiért nem indult volna újra a szerver, az <span class=filename>/var/log/messages</span> állományból próbáljuk meg kideríteni az okát.</p></div></div><div class=sect3><h4 id=_a_naplókliens_beállítása>29.11.2. A naplókliens beállítása<a class=anchor href=#_a_naplókliens_beállítása></a></h4><div class=paragraph><p>A naplókliens az a gép, amely egy helyi naplópéldány karbantartása mellett továbbküldni a naplózandó információkat egy naplószervernek.</p></div><div class=paragraph><p>Hasonlóan a naplószerverekhez, a klienseknek is teljesítenie bizonyos alapvetõ elvárásokat:</p></div><div class=ulist><ul><li><p>a <a href="https://man.freebsd.org/cgi/man.cgi?query=syslogd&amp;sektion=8&amp;format=html">syslogd(8)</a> démon küldjön bizonyos típusú üzeneteket a naplószervernek, amely ezeket pedig képes legyen fogadni;</p></li><li><p>a hozzá tartozó tûzfal engedje át a forgalmat az 514-es UDP porton;</p></li><li><p>rendelkezzen mind közvetlen, mind pedig inverz DNS bejegyzéssel, vagy szerepeljenek az <span class=filename>/etc/hosts</span> állományban.</p></li></ul></div><div class=paragraph><p>A kliens beállítása sokkal egyszerûbb a szerverhez képest. A kliensen adjuk hozzá a következõ sorokat az <span class=filename>/etc/rc.conf</span> állományhoz:</p></div><div class="literalblock programlisting"><div class=content><pre>syslogd_enabled=&#34;YES&#34;
syslogd_flags=&#34;-s -vv&#34;</pre></div></div><div class=paragraph><p>A szerver beállításaihoz hasonlóan itt is engedélyezzük a <code>syslogd</code> démont és megnöveljük a naplózott üzenetek részletességét. A <code>-s</code> kapcsolóval pedig megakadályozzuk, hogy a kliens más gépekrõl is hajlandó legyen naplóüzeneteket elfogadni.</p></div><div class=paragraph><p>A funkciók a rendszernek azon részét írják le, amelyhez létrejön az adott üzenet. Tehát például az <code>ftp</code> és <code>ipfw</code> egyaránt ilyen funkciók. Amikor keletkezik egy naplóüzenet valamelyikükhöz, általában megjelenik a nevük. A funkciókhoz tartozik még egy prioritás vagy szint is, amellyel az adott üzenet fontosságát jelzik. Ezek közül a leggyakoribb a <code>warning</code> (mint "figyelmeztetés") és <code>info</code> (mint "információ"). A használható funkciók és a hozzájuk tartozó prioritások teljes listáját a <a href="https://man.freebsd.org/cgi/man.cgi?query=syslog&amp;sektion=3&amp;format=html">syslog(3)</a> man oldalán olvashatjuk.</p></div><div class=paragraph><p>A naplószervert meg kell adnunk a kliens <span class=filename>/etc/syslog.conf</span> állományában. Itt a <code>@</code> szimbólummal jelezzük, hogy az adatokat egy távoli szerverre szeretnénk továbbküldeni, valahogy így:</p></div><div class="literalblock programlisting"><div class=content><pre>*.*               @naploszerver.minta.com</pre></div></div><div class=paragraph><p>Ezután a beállítás érvényesítéséhez újra kell indítanunk a <code>syslogd</code> démont:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># /etc/rc.d/syslogd restart</span></code></pre></div></div><div class=paragraph><p>A <a href="https://man.freebsd.org/cgi/man.cgi?query=logger&amp;sektion=1&amp;format=html">logger(1)</a> használatával próbáljuk ki a kliensrõl a aplóüzenetek hálózaton keresztüli küldését, és küldjünk valamit a <code>syslogd</code> démonnak:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># logger &#34;Udvozlet a naplokliensrol&#34;</span></code></pre></div></div><div class=paragraph><p>A parancs kiadása után az üzenetnek mind a kliens, mind pedig a szerver <span class=filename>/var/log/messages</span> állományában meg kell jelennie.</p></div></div><div class=sect3><h4 id=_hibakeresés_4>29.11.3. Hibakeresés<a class=anchor href=#_hibakeresés_4></a></h4><div class=paragraph><p>Elõfordulhat, hogy a naplószerver valamiért nem kapja meg rendesen az üzeneteket, ezért valamilyen módon meg kell keresnünk a hiba okát. Ez több minden lehet, de általában két leggyakoribb ok valamilyen hálózati kapcsolódási vagy DNS beállítási hiba. Ezek teszteléséhez gondoskodjunk róla, hogy a gépek kölcsönösen elérhetõek egymásról az <span class=filename>/etc/rc.conf</span> állományban megadott hálózati nevük szerint. Ha ezzel látszólag minden rendben van, akkor próbáljuk meg módosítani a <code>syslogd_flags</code> értékét az <span class=filename>/etc/rc.conf</span> állományban.</p></div><div class=paragraph><p>A most következõ példában a <span class=filename>/var/log/naplokliens.log</span> teljesen üres, illetve a <span class=filename>/var/log/messages</span> állomány semmilyen hibára utaló okot nem tartalmaz. A hibakereséshez még több információt a <code>syslogd_flags</code> átírásával tudunk kérni:</p></div><div class="literalblock programlisting"><div class=content><pre>syslogd_flags=&#34;-d -a naploklien.minta.com -vv&#34;</pre></div></div><div class=paragraph><p>Természetesen ne felejtsük el újraindítani a szervert:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># /etc/rc.d/syslogd restart</span></code></pre></div></div><div class=paragraph><p>A démon újraindítása után közvetlenül az alábbiakhoz hasonló üzenetek árasztják el a képernyõt:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>logmsg: pri 56, flags 4, from naploszerver.minta.com, msg syslogd: restart
syslogd: restarted
logmsg: pri 6, flags 4, from naploszerver.minta.com, msg syslogd: kernel boot file is /boot/kernel/kernel
Logging to FILE /var/log/messages
syslogd: kernel boot file is /boot/kernel/kernel
cvthname<span class=o>(</span>192.168.1.10<span class=o>)</span>
validate: dgram from IP 192.168.1.10, port 514, name naplokliens.minta.com<span class=p>;</span>
rejected <span class=k>in </span>rule 0 due to name mismatch.</code></pre></div></div><div class=paragraph><p>A diagnosztikai üzeneteket végigolvasva nyilvánvaló válik, hogy azért dobja el az üzeneteket a szerver, mert nem megfelelõ a gép neve. Miután átnézzük a beállításainkat, felfedezhetünk az <span class=filename>/etc/rc.conf</span> állományban egy apró hibát:</p></div><div class="literalblock programlisting"><div class=content><pre>syslogd_flags=&#34;-d -a naploklien.minta.com -vv&#34;</pre></div></div><div class=paragraph><p>Láthatjuk, hogy ebben a sorban a <code>naplokliens</code> névnek kellene szerepelni, nem pedig a <code>naploklien</code> névnek. Miután elvégeztük a szükséges javításokat, indítsuk újra a szervert és vizsgáljuk meg az eredményt:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># /etc/rc.d/syslogd restart</span>
logmsg: pri 56, flags 4, from naploszerver.minta.com, msg syslogd: restart
syslogd: restarted
logmsg: pri 6, flags 4, from naploszerver.minta.com, msg syslogd: kernel boot file is /boot/kernel/kernel
syslogd: kernel boot file is /boot/kernel/kernel
logmsg: pri 166, flags 17, from naploszerver.minta.com, msg Dec 10 20:55:02 &lt;syslog.err&gt; naploszerver.minta.com syslogd: exiting on signal 2
cvthname<span class=o>(</span>192.168.1.10<span class=o>)</span>
validate: dgram from IP 192.168.1.10, port 514, name naplokliens.minta.com<span class=p>;</span>
accepted <span class=k>in </span>rule 0.
logmsg: pri 15, flags 0, from naplokliens.minta.com, msg Dec 11 02:01:28 pgj: Masodik teszt uzenet
Logging to FILE /var/log/naplokliens.log
Logging to FILE /var/log/messages</code></pre></div></div><div class=paragraph><p>Itt már minden üzenet rendben megérkezett és a megfelelõ állományokba került (a <span class=filename>/var/log/messages</span> a kliensen, és a <span class=filename>/var/log/naplokliens.log</span> a szerveren)).</p></div></div><div class=sect3><h4 id=_biztonsági_megfontolások>29.11.4. Biztonsági megfontolások<a class=anchor href=#_biztonsági_megfontolások></a></h4><div class=paragraph><p>Mint minden hálózati szolgáltatás esetén, ilyenkor is figyelembe kell vennünk bizonyos biztonsági megfontolásokat a tényleges konfiguráció kiépítése elõtt. Olykor elõfordulhat, hogy a naplók különbözõ kényes információkat tartalmaznak, mint például a helyi rendszeren futó szolgáltatások nevei, felhasználói nevek vagy egyéb konfigurációs adatok. A kliens és a szerver között hálózaton utazó adatok viszont se nem titkosítottak, se nem jelszóval védettek. Ha titkosítást szeretnénk használni, akkor javasoljuk például a <a class=package href=https://cgit.freebsd.org/ports/tree/security/stunnel/>security/stunnel</a> portot, amellyel egy titkosított tunnelen keresztül tudunk adatokat küldeni a hálózaton.</p></div><div class=paragraph><p>A helyi rendszer biztonságának szavatolása is fontos lehet. A naplók sem a használat során, sem pedig a lecserélésük után nem kerülnek titkosításra. Emiatt a helyi rendszerhez hozzáférõ felhasználók kedvükre nyerhetnek ki belõlük a rendszerünket érintõ konfigurációs információkat. Ezért ilyenkor nagyon fontos, hogy mindig a megfelelõ engedélyeket állítsuk be a naplókra. A <a href="https://man.freebsd.org/cgi/man.cgi?query=newsyslog&amp;sektion=8&amp;format=html">newsyslog(8)</a> segédprogrammal be tudjuk állítani a frissen létrehozott és a lecserélt naplók engedélyeit. Tehát könnyen megakadályozhatjuk a helyi felhasználók kíváncsiskodását, ha itt a naplók engedélyeit például a <code>600</code> kóddal adjuk meg.</p></div></div></div></div></div><div class=sect1><h2 id=firewalls>Chapter 30. Tűzfalak<a class=anchor href=#firewalls></a></h2><div class=sectionbody><div class=sect2><h3 id=firewalls-intro>30.1. Bevezetés<a class=anchor href=#firewalls-intro></a></h3><div class=paragraph><p>A tûzfalakkal a rendszerünkön keresztülfolyó bejövõ és kimenõ forgalmat tudjuk szûrni. A tûzfalak egy vagy több "szabályrendszer" alapján vizsgálják az éppen érkezõ vagy távozó hálózati csomagokat, és vagy továbbengedik ezeket vagy megállítják. A tûzfalak szabályai a csomagok egy vagy több jellemzõjét veszik szemügyre, amelyek lehetnek például a protokoll típusa, a forrás vagy cél hálózati címe, esetleg a forrás- vagy a célport.</p></div><div class=paragraph><p>A tûzfalak jelentõs mértékben képesek gyarapítani egy gép vagy egy hálózat védelmét. Leginkább a következõkre tudjuk felhasználni:</p></div><div class=ulist><ul><li><p>A belsõ hálózatunkban futó alkalmazások, szolgáltatások, gépek megvédésére és elszigetelésére az internetrõl érkezõ nem kívánt forgalom ellen</p></li><li><p>A belsõ hálózatban levõ gépek elérését tudjuk korlátozni vagy letiltani az interneten elérhetõ szolgáltatások felé</p></li><li><p>A hálózati címfordítás (Network Address Translation, NAT) beállításához, ahol a belsõ hálózatunk privát IP-címeket használnak és egy közös kapcsolaton keresztül érik el az internetet (egyetlen IP-címmel, vagy pedig automatikusan kiosztott publikus címekkel).</p></li></ul></div><div class=paragraph><p>A fejezet elolvasása során megismerjük:</p></div><div class=ulist><ul><li><p>hogyan adjuk meg helyesen a csomagok szûrését leíró szabályokat;</p></li><li><p>a FreeBSD-be épített tûzfalak közti különbségeket;</p></li><li><p>hogyan állítsuk be és használjuk az OpenBSD PF tûzfalát;</p></li><li><p>hogyan állítsuk be és használjuk az IPFILTER tûzfalat;</p></li><li><p>hogyan állítsuk be és használjuk az IPFW tûzfalat.</p></li></ul></div><div class=paragraph><p>A fejezet elolvasása elõtt ajánlott:</p></div><div class=ulist><ul><li><p>a FreeBSD-hez és az internethez kötõdõ alapvetõ fogalmak ismerete.</p></li></ul></div></div><div class=sect2><h3 id=firewalls-concepts>30.2. Röviden a tûzfalakról<a class=anchor href=#firewalls-concepts></a></h3><div class=paragraph><p>A tûzfalak szabályrendszereit alapvetõen kétféleképpen tudjuk összeállítani: "inkluzív", vagyis megengedõ, illetve "exkluzív" vagyis kizáró módon. Az exkluzív tûzfalak minden forgalmat átengednek, amirõl nem rendelkeznek a tûzfal szabályai. Az inkluzív tûzfalak ennek pontosan az ellenkezõjét teszik. Csak azt a forgalmat engedik át, amirõl van szabály és minden mást blokkolnak.</p></div><div class=paragraph><p>Az inkluzív tûzfalak alkalmazásával sokkal jobban kezünkbentudjuk tartani a hálózatunk kimenõ forgalmát, ezért leginkább az internetes szolgáltatásokat futtató rendszerek esetében bizonyulhat jobb választásnak. Emellett az internetrõl a hálózatunk felé irányuló forgalmat is képes szabályozni. Ekkor az egyetlen szabályra sem illeszkedõ csomagokat egyszerûen eldobjuk és naplózzuk. Az inkluzív tûzfalak általában biztonságosabbak az exkluzív típusú társaiknál, mivel esetükben jelentõs mértékben visszaszorul a nem kívánatos átfolyó forgalom.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Hacsak nem emeljük ki külön, a fejezet további részében minden példaként megadott szabályrendszer inkluzív tûzfalat hoz létre.</p></div></td></tr></tbody></table></div><div class=paragraph><p>Ez a típusú védelem még tovább fokozható az "állapottartó tûzfalak" (stateful firewall) használatával. Az ilyen típusú tûzfalak szemmel tartják a rajtuk keresztül megnyitott kapcsolatokat, és vagy csak a már meglevõ kapcsolathoz tartozó forgalmat engedik át vagy nyitnak egy újat. Az állapottartó tûzfalak hátránya, hogy a "Denial of Service" (DoS) típusú támadásokkal szemben sokkal sérülékenyebbek olyan helyzetekben, amikor az új kapcsolatok nagyon gyorsan jönnek létre. A legtöbb tûzfal esetében azonban tudjuk vegyíteni az állapottartó és nem állapottartó viselkedést, és ezzel egy ideális beállítást kialakítani.</p></div></div><div class=sect2><h3 id=firewalls-apps>30.3. Tûzfalak<a class=anchor href=#firewalls-apps></a></h3><div class=paragraph><p>A FreeBSD alaprendszerébe három különbözõ tûzfalat építettek be, melyek a következõk: az <em>IPFILTER</em> (másik nevén IPF), az <em>IPFIREWALL</em> (más néven IPFW) és az <em>OpenBSD csomagszûrõje</em> (Packet Filter, azaz PF). A forgalom szabályozására (vagyis alapvetõen a sávszélesség kihasználtságának vezérlésére) a FreeBSD két beépített csomagot tartalmaz: ez az <a href="https://man.freebsd.org/cgi/man.cgi?query=altq&amp;sektion=4&amp;format=html">altq(4)</a> és a <a href="https://man.freebsd.org/cgi/man.cgi?query=dummynet&amp;sektion=4&amp;format=html">dummynet(4)</a>. Általában a Dummynet az IPFW, míg az ALTQ a PF partnere. Az IPFILTER esetében maga az IPFILTER végzi a címfordítást és a szûrést, a sávszélességet pedig az IPFW a <a href="https://man.freebsd.org/cgi/man.cgi?query=dummynet&amp;sektion=4&amp;format=html">dummynet(4)</a> <em>vagy</em> a PF az ALTQ segítségével. Az IPFW és a PF szabályokkal rendelkezik a rendszerünkbe érkezõ vagy onnan távozó csomagokról, habár megoldásaik teljesen máshogy mûködnek és a szabályok megadási módja is eltér.</p></div><div class=paragraph><p>A FreeBSD azért tartalmaz egyszerre ennyiféle tûzfalat, mert az emberek elvárásai és igényei eltérnek. Egyikük sem tekinthetõ a legjobbnak.</p></div><div class=paragraph><p>A szerzõ egyébként az IPFILTER megoldását részesíti elõnyben, mivel egy hálózati címfordítást alkalmazó környezetben sokkal könnyebb vele megfogalmazni az állapottartó szabályokat, valamint tartalmaz egy beépített FTP proxyt is, amivel így a kimenõ FTP kapcsolatok beállítása még tovább egyszerûsödik.</p></div><div class=paragraph><p>Mivel az összes tûzfal a csomagok fejlécének bizonyos mezõinek alapján dolgozik, ezért a tûzfal szabályrendszerét megalkotó egyénnek teljesen tisztában kell lennie a TCP/IP mûködésével, továbbá azzal, hogy ezekben a mezõkben milyen értékek szerepelhetnek és ezeket hogyan használják egy átlagos kapcsolat alatt. Ebben a témában a <a href=http://www.ipprimer.com/overview.cfm>http://www.ipprimer.com/overview.cfm</a> címen találhatunk egy remek ismertetõt (angolul).</p></div></div><div class=sect2><h3 id=firewalls-pf>30.4. Az OpenBSD csomagszûrõje (PF) és az ALTQ<a class=anchor href=#firewalls-pf></a></h3><div class=paragraph><p>2003 júliusában az OpenBSD PF néven ismert csomagszûrõjét átírták FreeBSD-re és elérhetõvé tették a FreeBSD Portgyûjteményének részeként. A PF programot beépítetten tartalmazó elsõ kiadás pedig 2004 novemberében a FreeBSD 5.3 volt. A PF egy teljes, mindentudó tûzfal, amely támogatja az ún. ALTQ (Alternate Queuing, vagyis a "váltóbesorolás") megoldást. Az ALTQ lehetõvé teszi a sávszélesség korlátozását a szolgáltatás minõsége (Quality of Service, QoS) alapján.</p></div><div class=paragraph><p>Az OpenBSD Projekt kiváló munkát végez a PF <a href=http://www.openbsd.org/faq/pf/>felhasználói útmutatójának</a> karbantartásával. A kézikönyv ezen szakasza ezért elsõsorban azzal foglalkozik, hogyan kell a PF-et FreeBSD alatt használni, miközben igyekszik egy általános összefoglalást adni a témáról. A részletesebb információkkal kapcsolatban azonban feltétlenül nézzük meg a felhasználói útmutatót.</p></div><div class=paragraph><p>A <a href=http://pf4freebsd.love2party.net/>http://pf4freebsd.love2party.net/</a> címen olvashatunk többet arról (angolul), hogy a PF-et hogyan használjunk FreeBSD-n.</p></div><div class=sect3><h4 id=_a_pf_rendszermagmodulok_használata>30.4.1. A PF rendszermagmodulok használata<a class=anchor href=#_a_pf_rendszermagmodulok_használata></a></h4><div class=paragraph><p>A PF modul betöltéséhez a következõ sort kell felvennünk az <span class=filename>/etc/rc.conf</span> állományba:</p></div><div class="literalblock programlisting"><div class=content><pre>pf_enable=&#34;YES&#34;</pre></div></div><div class=paragraph><p>Ezt követõen futtassuk le a hozzá tartozó rendszerindító szkriptet:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># /etc/rc.d/pf start</span></code></pre></div></div><div class=paragraph><p>A PF modul abban az esetben nem fog betöltõdni, ha nem találja a szabályokat tartalmazó konfigurációs állományt. Ez alapértelmezés szerint az <span class=filename>/etc/pf.conf</span> állomány. Ha a szabályok leírása rendszerünkön máshol található, akkor az <span class=filename>/etc/rc.conf</span> állományban a következõ módon adhatjuk meg annak pontos helyét:</p></div><div class="literalblock programlisting"><div class=content><pre>pf_rules=&#34;/elérési/út/pf.conf&#34;</pre></div></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>A FreeBSD 7.0 kiadással a minta <span class=filename>pf.conf</span> állomány az <span class=filename>/etc</span> könyvtárból átkerült a <span class=filename>/usr/shared/examples/pf</span> könyvtárba. A FreeBSD 7.0 elõtti kiadásokban alapértelmezés szerint található egy <span class=filename>pf.conf</span> állomány az <span class=filename>/etc</span> könyvtárban.</p></div></td></tr></tbody></table></div><div class=paragraph><p>A PF modul parancssorból akár kézzel is betölthetõ:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># kldload pf.ko</span></code></pre></div></div><div class=paragraph><p>A PF mûködésének naplózását a <code>pflog.ko</code> teszi lehetõvé, amelyet az alábbi sor hozzáadásával engedélyezhetünk az <span class=filename>/etc/rc.conf</span> állományban:</p></div><div class="literalblock programlisting"><div class=content><pre>pflog_enable=&#34;YES&#34;</pre></div></div><div class=paragraph><p>A modul betöltését a hozzá tartozó rendszerindító szkript segítségével kérhetjük:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># /etc/rc.d/pflog start</span></code></pre></div></div><div class=paragraph><p>Ha a PF többi funkcióját is használni szeretnénk, akkor ehhez egy új rendszermagot kell fordítanunk PF támogatással.</p></div></div><div class=sect3><h4 id=_a_pf_rendszermagbeli_beállításai>30.4.2. A PF rendszermagbeli beállításai<a class=anchor href=#_a_pf_rendszermagbeli_beállításai></a></h4><div class=paragraph><p>Noha egyáltalán nem szükséges beépítenünk a PF támogatását a rendszermagba, abban az esetben mégis szükségünk lehet rá, amikor a PF olyan komolyabb lehetõségeit szeretnénk kiaknázni, amelyek már nem részei a modulnak. Ilyen például a <a href="https://man.freebsd.org/cgi/man.cgi?query=pfsync&amp;sektion=4&amp;format=html">pfsync(4)</a>, amely a PF által használt állapottáblázatok bizonyos változásainak megjelenítésére alkalmas pszeudoeszköz. A <a href="https://man.freebsd.org/cgi/man.cgi?query=carp&amp;sektion=4&amp;format=html">carp(4)</a> megoldásával párosítva így akár hibatûrõ tûzfalak is kialakíthatóak a PF-fel. A CARP megoldásáról a kézikönyvben bõvebb ismertetést a <a href=./#carp>A Közös cím redundancia protokoll (CARP)</a> ad.</p></div><div class=paragraph><p>A PF rendszermag konfigurációs beállításai a <span class=filename>/usr/src/sys/conf/NOTES</span> állományban találhatóak:</p></div><div class="literalblock programlisting"><div class=content><pre>device pf
device pflog
device pfsync</pre></div></div><div class=paragraph><p>A <code>device pf</code> beállítás engedélyezi a csomagszûrõ tûzfalat (<a href="https://man.freebsd.org/cgi/man.cgi?query=pf&amp;sektion=4&amp;format=html">pf(4)</a>).</p></div><div class=paragraph><p>A <code>device pflog</code> megadásával keletkezik egy <a href="https://man.freebsd.org/cgi/man.cgi?query=pflog&amp;sektion=4&amp;format=html">pflog(4)</a> pszeudo hálózati eszköz, amellyel egy <a href="https://man.freebsd.org/cgi/man.cgi?query=bpf&amp;sektion=4&amp;format=html">bpf(4)</a> eszközre érkezõ forgalmat tudunk naplózni. Ezután a <a href="https://man.freebsd.org/cgi/man.cgi?query=pflogd&amp;sektion=8&amp;format=html">pflogd(8)</a> démon használható tõle származó naplózott adatok rögzítésére.</p></div><div class=paragraph><p>A <code>device pfsync</code> engedélyezi a <a href="https://man.freebsd.org/cgi/man.cgi?query=pfsync&amp;sektion=4&amp;format=html">pfsync(4)</a> pszeudo hálózati eszköz létrejöttét, amely az ún. "állapotváltások" megfigyelésére alkalmas.</p></div></div><div class=sect3><h4 id=_az_rc_conf_állományban_elérhetõ_beállítások>30.4.3. Az <span class=filename>rc.conf</span> állományban elérhetõ beállítások<a class=anchor href=#_az_rc_conf_állományban_elérhetõ_beállítások></a></h4><div class=paragraph><p>A következõ <a href="https://man.freebsd.org/cgi/man.cgi?query=rc.conf&amp;sektion=5&amp;format=html">rc.conf(5)</a> beállítások aktiválják a rendszerindítás során a PF és a <a href="https://man.freebsd.org/cgi/man.cgi?query=pflog&amp;sektion=4&amp;format=html">pflog(4)</a> használatát:</p></div><div class="literalblock programlisting"><div class=content><pre>pf_enable=&#34;YES&#34;                 # a PF engedélyezése (a modul betöltése, ha kell)
pf_rules=&#34;/etc/pf.conf&#34;         # a pf szabályait tartalmazó állomány
pf_flags=&#34;&#34;                     # a pfctl indításához szükséges további paraméterek
pflog_enable=&#34;YES&#34;              # a pflogd(8) elindítása
pflog_logfile=&#34;/var/log/pflog&#34;  # hol tartsa a pflogd az naplóit
pflog_flags=&#34;&#34;                  # a pflogd indításához szükséges paraméterek</pre></div></div><div class=paragraph><p>Ha a tûzfalunk mögött egy helyi hálózat is meghúzódik, akkor az ott levõ gépek számára valamilyen módon tudnunk kell továbbítani a csomagokat vagy címfordítást kell végezni, így ez is mindenképpen kelleni fog:</p></div><div class="literalblock programlisting"><div class=content><pre>gateway_enable=&#34;YES&#34;            # az átjáró funkciók engedélyezése</pre></div></div></div><div class=sect3><h4 id=_a_szûrési_szabályok_megfogalmazása>30.4.4. A szûrési szabályok megfogalmazása<a class=anchor href=#_a_szûrési_szabályok_megfogalmazása></a></h4><div class=paragraph><p>A PF a beállításait a <a href="https://man.freebsd.org/cgi/man.cgi?query=pf.conf&amp;sektion=5&amp;format=html">pf.conf(5)</a> állomány tárolja (amely alapértelmezés szerint az <span class=filename>/etc/pf.conf</span> helyen található), és az ebben található szabályok alapján módosítja, dobja el vagy éppen engedi át a csomagokat. A FreeBSD rendszerünkben ehhez találhatunk néhány példát a <span class=filename>/usr/shared/examples/pf/</span> könyvtárban. A PF által használt szabályokról minden részletre kiterjedõen a PF <a href=http://www.openbsd.org/faq/pf/>felhasználói útmutatójában</a> olvashatunk.</p></div><div class="admonitionblock warning"><table><tbody><tr><td class=icon><i class="fa icon-warning" title=Warning></i></td><td class=content><div class=paragraph><p>A PF <a href=http://www.openbsd.org/faq/pf/>felhasználói útmutatójának</a> olvasásakor ne feledkezzünk meg róla, hogy a különbözõ FreeBSD verziók különbözõ PF verziókat tartalmaznak. A FreeBSD 7.<em>X</em> és késõbbi változatok az OpenBSD 4.1 kiadásában szereplõ PF változatot tartalmazzák.</p></div></td></tr></tbody></table></div><div class=paragraph><p>A <a href=https://lists.FreeBSD.org/subscription/freebsd-pf>FreeBSD packet filter levelezési lista</a> remek hely a PF tûzfal beállításával és futtatásával kapcsolatos kérdésekre. A kérdezés elõtt azonban ne felejtsük el alaposan átnézni az archívumot!</p></div></div><div class=sect3><h4 id=_a_pf_használata>30.4.5. A PF használata<a class=anchor href=#_a_pf_használata></a></h4><div class=paragraph><p>A PF a <a href="https://man.freebsd.org/cgi/man.cgi?query=pfctl&amp;sektion=8&amp;format=html">pfctl(8)</a> segítségével vezérelhetõ. Az alábbiakban ezzel kapcsolatban most összefoglalunk néhány hasznos parancsot (de ne felejtsük el megnézni a <a href="https://man.freebsd.org/cgi/man.cgi?query=pfctl&amp;sektion=8&amp;format=html">pfctl(8)</a> man oldalon található többi lehetõséget sem):</p></div><table class="tableblock frame-none grid-all stretch informaltable"><col style=width:50%><col style=width:50%><thead><tr><th class="tableblock halign-left valign-top">Parancs</th><th class="tableblock halign-left valign-top">Leírás</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>pfctl -e</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>A PF engedélyezése</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>pfctl -d</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>A PF tiltása</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>pfctl -F all -f /etc/pf.conf</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Az összes (címfordítási, szûrési, állapottartási stb.) szabály törlése, és az <span class=filename>/etc/pf.conf</span> állomány újratöltése</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>pfctl -s [ rules | nat | state ]</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>A szûrési (<code>rules</code>), címfordítási (<code>nat</code>) és állapottartási (<code>state</code>) információk lekérdezése</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>pfctl -vnf /etc/pf.conf</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Az <span class=filename>/etc/pf.conf</span> állomány ellenõrzése a benne levõ szabályok betöltése nélkül</p></td></tr></tbody></table></div><div class=sect3><h4 id=_az_altq_engedélyezése>30.4.6. Az ALTQ engedélyezése<a class=anchor href=#_az_altq_engedélyezése></a></h4><div class=paragraph><p>Az ALTQ kizárólag csak úgy használható, ha a konfigurációs beállításokon keresztül beépítjük a FreeBSD rendszermagjába. Az ALTQ alkalmazását nem minden hálózati kártya meghajtója támogatja, ezért ezt a <a href="https://man.freebsd.org/cgi/man.cgi?query=altq&amp;sektion=4&amp;format=html">altq(4)</a> man oldalon ellenõrizzük.</p></div><div class=paragraph><p>A következõ rendszermag konfigurációs beállításokkal engedélyezhetjük az ALTQ használatát és bõvíthetjük azt további lehetõségekkel:</p></div><div class="literalblock programlisting"><div class=content><pre>options         ALTQ
options         ALTQ_CBQ        # osztályozás alapú besorolás (Class Bases Queuing, CBQ)
options         ALTQ_RED        # véletlen korai észlelés (Random Early Detection, RED)
options         ALTQ_RIO        # RED befele/kifele
options         ALTQ_HFSC       # hiearchikus csomagütemezõ (Hierarchical Packet Scheduler, HFSC)
options         ALTQ_PRIQ       # prioritásos besorolás (Priority Queuing, PRIQ)
options         ALTQ_NOPCC      # az SMP esetén kell</pre></div></div><div class=paragraph><p>Az <code>options ALTQ</code> az ALTQ rendszert engedélyezi.</p></div><div class=paragraph><p>Az <code>options ALTQ_CBQ</code> engedélyezi a osztályozás alapú besorolást (<em>Class Based Queuing</em>, CBQ). A CBQ használatával a kapcsolatunkhoz tartozó sávszélességet különbözõ osztályokra vagy sorokra tudjuk bontani és a szûrési szabályoknak megfelelõen osztályozni segítségükkel a forgalmat.</p></div><div class=paragraph><p>Az <code>options ALTQ_RED</code> a véletlen korai észlelés (<em>Random Early Detection</em>, RED) használatát engedélyezi. A RED a hálózati forgalomban keletkezõ torlódások elkerülésére alkalmas. A RED ezt a problémát úgy oldja meg, hogy méri a sorok hosszát és összeveti a hozzá tartozó minimális és maximális küszöbértékekkel. Ha a sor hossza meghaladja a számára elõírt maximális értéket, akkor az új csomagokat eldobja. Nevéhez hûen a RED az eldobásra ítélt csomagokat véletlenszerûen választja ki.</p></div><div class=paragraph><p>Az <code>options ALTQ_RIO</code> engedélyezi a RED használatát mind a két irányba, tehát be- és kifelé.</p></div><div class=paragraph><p>Az <code>options ALTQ_HFSC</code> a pártatlan hierachikus szolgáltatási görbe alapú csomagütemezõt (<em>Hierarchical Fair Service Curve Packet Scheduler</em>, HFSC) engedélyezi. Vele kapcsolatban a <a href=http://www-2.cs.cmu.edu/~hzhang/HFSC/main.html>http://www-2.cs.cmu.edu/~hzhang/HFSC/main.html</a> címen találhatunk bõvebben olvasnivalót (angolul).</p></div><div class=paragraph><p>Az <code>options ALTQ_PRIQ</code> a prioritásos besorolást (<em>Priority Queuing</em>, PRIQ) teszi elérhetõvé. A PRIQ mindig elsõként a nagyobb értékû sorban levõ forgalmat továbbítja.</p></div><div class=paragraph><p>Az <code>options ALTQ_NOPCC</code> az ALTQSMP, vagyis többprocesszoros támogatását adja meg. Ilyen típusú rendszerekben ez kötelezõ.</p></div></div></div><div class=sect2><h3 id=firewalls-ipf>30.5. Az IPFILTER (IPF) tûzfal<a class=anchor href=#firewalls-ipf></a></h3><div class=paragraph><p>Az IPFILTER szerzõje Darren Reed. Az IPFILTER nem kötõdik egyik rendszerhez sem: ez egy olyan nyílt forráskódú alkalmazás, amelyet átírtak FreeBSD, NetBSD, OpenBSD, SunOS™, HP/UX és Solaris™ operációs rendszerekre. Az IPFILTER karbantartása és támogatása pillanatnyilag is aktív, folyamatosan jelennek meg újabb változatai.</p></div><div class=paragraph><p>Az IPFILTER egy rendszermag oldalán mûködõ tûzfalazási és egy címfordítási mechanizmusra alapszik, amelyet felhasználói programokkal tudunk felügyelni és vezérelni. A tûzfal szabályai az <a href="https://man.freebsd.org/cgi/man.cgi?query=ipf&amp;sektion=8&amp;format=html">ipf(8)</a> segédprogrammal állíthatóak be vagy törölhetõek. A hálózati címfordításra vonatkozó szabályokat az <a href="https://man.freebsd.org/cgi/man.cgi?query=ipnat&amp;sektion=1&amp;format=html">ipnat(1)</a> segédprogrammal állíthatjuk be vagy törölhetjük. Az <a href="https://man.freebsd.org/cgi/man.cgi?query=ipfstat&amp;sektion=8&amp;format=html">ipfstat(8)</a> segédprogram képes futás közben statisztikákat készíteni az IPFILTER rendszermagban elhelyezkedõ részeinek viselkedésérõl. Az <a href="https://man.freebsd.org/cgi/man.cgi?query=ipmon&amp;sektion=8&amp;format=html">ipmon(8)</a> program pedig az IPFILTER cselekvéseit képes a rendszernaplókba feljegyezni.</p></div><div class=paragraph><p>Az IPF eredetileg olyan szabályfeldolgozási módszer szerint készült, amelyben "az utolsó egyezõ szabály nyer" és csak állapotnélküli szabályokat ismert. Az idõ múlásával az IPF részévé vált a "quick" opció és a "keep state" opción keresztül az állapottartás is, melyek drámai mértékben korszerûsítették a szabályok feldolgozásának elvét. Az IPF hivatalos dokumentációja csak a régi szabályok létrehozását és azok feldolgozásának leírását tartalmazza. A korszerûsített funkciók csak kiegészítésképpen jelennek meg, és az általuk felkínált elõnyök megértése egy sokkal magasabb szintû és biztonságosabb tûzfal megépítését teszik lehetõvé.</p></div><div class=paragraph><p>A szakaszban szereplõ utasításokban olyan szabályok szerepelnek, amelyek kihasználják a "quick" és "keep state" opciókat. Ezek az inkluzív tûzfalszabályok létrehozásának alapjai.</p></div><div class=paragraph><p>A régi típusú szabályokról a <a href=http://www.obfuscation.org/ipf/ipf-howto.html#TOC_1>http://www.obfuscation.org/ipf/ipf-howto.html#TOC_1</a> és <a href=http://coombs.anu.edu.au/~avalon/ip-filter.html>http://coombs.anu.edu.au/~avalon/ip-filter.html</a> címeken olvashatunk (angolul).</p></div><div class=paragraph><p>Az IPF gyakran ismételt kérdései a <a href=http://www.phildev.net/ipf/index.html>http://www.phildev.net/ipf/index.html</a> címen érhetõek el (angolul).</p></div><div class=paragraph><p>A nyílt forrású IPFILTER levelezési lista kereshetõ archívumait a <a href="http://marc.theaimsgroup.com/?l=ipfilter">http://marc.theaimsgroup.com/?l=ipfilter</a> címen találjuk (angolul).</p></div><div class=sect3><h4 id=_az_ipf_engedélyezése>30.5.1. Az IPF engedélyezése<a class=anchor href=#_az_ipf_engedélyezése></a></h4><div class=paragraph><p>Az IPF megtalálható a FreeBSD alaptelepítésében mint menet közben külön betölthetõ modul. Ha az <span class=filename>rc.conf</span> állományba beírjuk a <code>ipfilter_enable="YES"</code> sort, akkor ez a modul dinamikusan betöltõdik. A betölthetõ modul alapból naplóz és a <code>default pass all</code> beállítást tartalmazza. Ha helyette a <code>block all</code> szabályt akarjuk használni, akkor emiatt még nem kell feltétlenül újrafordítanunk a FreeBSD rendszermagját, elég ha egyszerûen csak a szabályrendszerünk végére beszúrjuk.</p></div></div><div class=sect3><h4 id=_a_rendszermag_beállításai_2>30.5.2. A rendszermag beállításai<a class=anchor href=#_a_rendszermag_beállításai_2></a></h4><div class=paragraph><p>Az IPF használatához nem kötelezõ a következõ beállításokkal újrafordítani a FreeBSD rendszermagját, itt csupán háttérinformációként szerepel. Amikor az IPF a rendszermagba kerül, a betölhetõ modulra nem lesz szükség.</p></div><div class=paragraph><p>Az IPF a rendszermag forrásai között található <span class=filename>/usr/src/sys/conf/NOTES</span> állományban megadott beállításai a következõ módon foglalhatóak össze:</p></div><div class="literalblock programlisting"><div class=content><pre>options IPFILTER
options IPFILTER_LOG
options IPFILTER_DEFAULT_BLOCK</pre></div></div><div class=paragraph><p>Az <code>options IPFILTER</code> engedélyezi az "IPFILTER" tûzfal támogatását.</p></div><div class=paragraph><p>Az <code>options IPFILTER_LOG</code> hatására az IPF az <span class=filename>ipl</span> csomagnaplózó pszeudo eszközre jegyzi fel a forgalmat - minden olyan szabály esetén, ahol megjelenik a <code>log</code> kulcsszó.</p></div><div class=paragraph><p>Az <code>options IPFILTER_DEFAULT_BLOCK</code> megváltoztatja az alapértelmezett viselkedést, tehát minden olyan csomag, amely nem illeszkedik a tûzfal valamelyik <code>pass</code> típusú (átengedõ) szabályára, blokkolásra kerül.</p></div><div class=paragraph><p>Ezek a beállítások csak azt követõen érvényesülnek, ha fordítottunk és telepítettünk velük egy új rendszermagot.</p></div></div><div class=sect3><h4 id=_az_rc_conf_állomány_beállításai>30.5.3. Az <span class=filename>rc.conf</span> állomány beállításai<a class=anchor href=#_az_rc_conf_állomány_beállításai></a></h4><div class=paragraph><p>Az <span class=filename>/etc/rc.conf</span> állományban a következõ utasításokra lesz szükségünk az IPF mûködésbe hozására a rendszer indítása során:</p></div><div class="literalblock programlisting"><div class=content><pre>ipfilter_enable=&#34;YES&#34;             # az ipf tûzfal indítása
ipfilter_rules=&#34;/etc/ipf.rules&#34;   # betölti a szabályokat tartalmazó szöveges állományt
ipmon_enable=&#34;YES&#34;                # elindítja az IP monitor naplózását
ipmon_flags=&#34;-Ds&#34;                 # D = indítás démonként
                                  # s = naplózás a syslog használatával
                                  # v = a tcp ablak, ack, seq csomagok naplózása
                                  # n = az IP-címek és portok feloldása</pre></div></div><div class=paragraph><p>Ha olyan helyi hálózat áll meg a tûzfal mögött, amely egy fenntartott privát IP-címtartományt használ, akkor még a következõ utasításokra is szükségünk lesz a címfordítás bekapcsolásához:</p></div><div class="literalblock programlisting"><div class=content><pre>gateway_enable=&#34;YES&#34;              # a helyi hálózat átjárója
ipnat_enable=&#34;YES&#34;                # az ipnat funkció elindítása
ipnat_rules=&#34;/etc/ipnat.rules&#34;    # az ipnat mûködéséhez szükséges definíciók</pre></div></div></div><div class=sect3><h4 id=_ipf>30.5.4. IPF<a class=anchor href=#_ipf></a></h4><div class=paragraph><p>Az <a href="https://man.freebsd.org/cgi/man.cgi?query=ipf&amp;sektion=8&amp;format=html">ipf(8)</a> parancs használható a szabályokat tartalmazó állomány betöltésére. Általában egy állományba írjuk össze a tûzfal szabályait és ezzel a paranccsal cseréljük le egyszerre a tûzfalban levõ jelenlegi szabályokat:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># ipf -Fa -f /etc/ipf.rules</span></code></pre></div></div><div class=paragraph><p>Az <code>-Fa</code> az összes belsõ szabály törlését jelenti.</p></div><div class=paragraph><p>Az <code>-f</code> jelzi, hogy egy állományból kell beolvasni a betöltendõ szabályokat.</p></div><div class=paragraph><p>Ezzel mintegy lehetõségünk van változtatni a korábban összeállított szabályainkon, futtatni a fenti IPF parancsot és ezen keresztül úgy frissíteni a szabályok friss másolatával a már mûködõ tûzfalat, hogy nem is kell újraindítanunk a rendszert. Ez a módszer igen kényelmes az új szabályok kipróbálásához, mivel bármikor tetszõlegesen végrehajtható.</p></div><div class=paragraph><p>Az <a href="https://man.freebsd.org/cgi/man.cgi?query=ipf&amp;sektion=8&amp;format=html">ipf(8)</a> man oldala tartalmazza a parancsnak megadható további beállításokat.</p></div><div class=paragraph><p>Az <a href="https://man.freebsd.org/cgi/man.cgi?query=ipf&amp;sektion=8&amp;format=html">ipf(8)</a> parancs a szabályokat tároló állományt egy szabványos szöveges állománynak tekinti, semmilyen szimbolikus helyettesítést alkalmazó szkriptet nem fogad el.</p></div><div class=paragraph><p>Lehetõségünk van azonban olyan IPF szabályokat készíteni, amelyek kiaknázzák a szkriptek szimbolikus helyettesítésének lehetõségeit. Errõl bõvebben lásd <a href=#firewalls-ipf-rules-script>A szabályok felírása szimbolikus helyettesítéssel</a>.</p></div></div><div class=sect3><h4 id=_az_ipfstat>30.5.5. Az IPFSTAT<a class=anchor href=#_az_ipfstat></a></h4><div class=paragraph><p>Az <a href="https://man.freebsd.org/cgi/man.cgi?query=ipfstat&amp;sektion=8&amp;format=html">ipfstat(8)</a> alapértelmezés szerint a arra használatos, hogy le tudjuk kérdezni és megjeleníteni a tûzfalhoz tartozó számlálók értékeit, amelyek a legutóbbi indítás vagy az <code>ipf -Z</code> parancs által kiadott lenullázásuk óta a bejövõ vagy kimenõ forgalomból a megadott szabályoknak megfelelõ csomagok alapján gyûjtenek össze statisztikákat.</p></div><div class=paragraph><p>A parancs mûködésének részleteit az <a href="https://man.freebsd.org/cgi/man.cgi?query=ipfstat&amp;sektion=8&amp;format=html">ipfstat(8)</a> man oldalon olvashatjuk.</p></div><div class=paragraph><p>Az <a href="https://man.freebsd.org/cgi/man.cgi?query=ipfstat&amp;sektion=8&amp;format=html">ipfstat(8)</a> meghívása alapból így néz ki:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>input packets: blocked 99286 passed 1255609 nomatch 14686 counted 0
 output packets: blocked 4200 passed 1284345 nomatch 14687 counted 0
 input packets logged: blocked 99286 passed 0
 output packets logged: blocked 0 passed 0
 packets logged: input 0 output 0
 log failures: input 3898 output 0
 fragment state<span class=o>(</span><span class=k>in</span><span class=o>)</span>: kept 0 lost 0
 fragment state<span class=o>(</span>out<span class=o>)</span>: kept 0 lost 0
 packet state<span class=o>(</span><span class=k>in</span><span class=o>)</span>: kept 169364 lost 0
 packet state<span class=o>(</span>out<span class=o>)</span>: kept 431395 lost 0
 ICMP replies: 0 TCP RSTs sent: 0
 Result cache hits<span class=o>(</span><span class=k>in</span><span class=o>)</span>: 1215208 <span class=o>(</span>out<span class=o>)</span>: 1098963
 IN Pullups succeeded: 2 failed: 0
 OUT Pullups succeeded: 0 failed: 0
 Fastroute successes: 0 failures: 0
 TCP <span class=nb>cksum </span>fails<span class=o>(</span><span class=k>in</span><span class=o>)</span>: 0 <span class=o>(</span>out<span class=o>)</span>: 0
 Packet log flags <span class=nb>set</span>: <span class=o>(</span>0<span class=o>)</span></code></pre></div></div><div class=paragraph><p>Az <code>-i</code> mint bejövõ (inbound), vagy az <code>-o</code> mint kimenõ (outbound) forgalomra vonatkozó paraméterek megadásával a rendszermagban az adott oldalon jelenleg telepített és alkalmazott szabályokat kérhetjük le és jeleníthetjük meg.</p></div><div class=paragraph><p>Az <code>ipfstat -in</code> parancs így a bejövõ forgalomra vonatkozó belsõ szabályokat mutatja a szabályok számával.</p></div><div class=paragraph><p>Az <code>ipfstat -on</code> parancs a kimenõ forgalmat érintõ belsõ szabályokat mutatja a szabályok számával.</p></div><div class=paragraph><p>Az eredmény körülbelül ilyen lesz:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>@1 pass out on xl0 from any to any
@2 block out on dc0 from any to any
@3 pass out quick on dc0 proto tcp/udp from any to any keep state</code></pre></div></div><div class=paragraph><p>Az <code>ipfstat -ih</code> a bejövõ forgalomhoz tartozó belsõ szabályokat mutatja és mindegyik elé odaírja, hogy eddig mennyi csomag illeszkedett rájuk.</p></div><div class=paragraph><p>Az <code>ipfstat -oh</code> ugyanígy a kimentõ forgalom esetén mutatja a belsõ szabályokat és mindegyik elõtt feltünteti, hogy az adott pillanatig mennyi csomag illeszkedett rájuk.</p></div><div class=paragraph><p>A kimenete nagyjából ilyen lesz:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>2451423 pass out on xl0 from any to any
354727 block out on dc0 from any to any
430918 pass out quick on dc0 proto tcp/udp from any to any keep state</code></pre></div></div><div class=paragraph><p>Az <code>ipfstat</code> parancs talán egyik legfontosabb funkciója a <code>-t</code> kapcsolóval csalható elõ, melynek hatására a rendszerben aktív állapotok táblázatát mutatja meg ugyanúgy, ahogy a <a href="https://man.freebsd.org/cgi/man.cgi?query=top&amp;sektion=1&amp;format=html">top(1)</a> a FreeBSD rendszerben futó programokat. Amikor a tûzfalunk támadás alatt áll, ezzel a funkcióval tudjuk a problémát beazonosítani, leásni a mélyébe és látni a támadótól érkezõ csomagokat. A kiegészítésképpen megadható alkapcsolók megadásával kiválaszthatjuk azt a cél vagy forrás IP-címet, portot vagy protokollt, amelyet valós idõben meg akarunk figyelni. Ennek részleteit az <a href="https://man.freebsd.org/cgi/man.cgi?query=ipfstat&amp;sektion=8&amp;format=html">ipfstat(8)</a> man oldalán láthatjuk.</p></div></div><div class=sect3><h4 id=_az_ipmon>30.5.6. Az IPMON<a class=anchor href=#_az_ipmon></a></h4><div class=paragraph><p>Az <code>ipmon</code> megfelelõ mûködéséhez be kell kapcsolnunk a rendszermag <code>IPFILTER_LOG</code> beállítását. Ez a parancs két különbözõ módban használható. Ha parancsot a <code>-D</code> opció nélkül gépeljük be, akkor ezek közül alapból a natív módot kapjuk meg.</p></div><div class=paragraph><p>A démon mód abban az esetben hasznos, ha folyamatosan naplózni akarjuk a rendszerben zajló eseményeket, majd késõbb ezeket átnézni. Így képes egymással együttmûködni a FreeBSD és az IPFILTER. A FreeBSD beépítve tartalmaz olyan lehetõséget, aminek révén magától cseréli a rendszernaplókat. Ezért ha átküldjük a <a href="https://man.freebsd.org/cgi/man.cgi?query=syslogd&amp;sektion=8&amp;format=html">syslogd(8)</a> démonnak a naplózandó üzeneteket, akkor sokkal jobban járunk, mintha egyszerûen csak mezei állományba naplóznánk. Az <span class=filename>rc.conf</span> alapértelmezései között az <code>ipmon_flags</code> beállítás a <code>-Ds</code> kapcsolókat rögzíti:</p></div><div class="literalblock programlisting"><div class=content><pre>ipmon_flags=&#34;-Ds&#34; # D = indítás démonként
                  # s = naplózás a syslog használatával
                  # v = a tcp ablak, ack, seq csomagok naplózása
                  # n = az IP-címek és portok nevének feloldása</pre></div></div><div class=paragraph><p>Ennek a viselkedésnek az elõnyei minden bizonnyal egyértelmûek. Segítségével képesek vagyunk az esetek megtörténte után átnézni, hogyan milyen csomagokat dobott el a rendszer, azok milyen címekrõl érkeztek és hova szánták. Ez egy komoly fegyver a támadók lenyomozásában.</p></div><div class=paragraph><p>Hiába engedélyezzük a naplózást, az IPF önszántából semmilyen naplózási szabályt nem fog gyártani. A tûzfal gazdájának kell eldöntenie, hogy a szabályokat közül melyiket akarja naplózni, és így neki kell megadnia a <code>log</code> kulcsszót ezekben az esetekben. Normális esetben csak a <code>deny</code> szabályokat naplózzák.</p></div><div class=paragraph><p>Egyáltalán nem ritka, hogy a szabályrendszer végén egy alapértelmezés szerint mindent eldobó szabály áll, amely naplóz. Ezzel lehetõségünk nyílik rögzíteni azokat a csomagokat, amelyek egyetlen szabályra sem illeszkedtek.</p></div></div><div class=sect3><h4 id=_naplózás_az_ipmon_használatával>30.5.7. Naplózás az IPMON használatával<a class=anchor href=#_naplózás_az_ipmon_használatával></a></h4><div class=paragraph><p>A syslogd egy saját módszert alkalmaz a naplózott adatok elkülönítésére. Egy "funkciók" (facility) és "szintek" (level) segítségével kialakított speciális csoportosítást alkalmaz. Az IPMON <code>-Ds</code> módja alapértelmezés szerint a <code>local0</code> "funkciót" használja. Ezen túl a következõ szinteken különíthetjük el igényeinknek megfelelõen a naplózott adatokat:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>LOG_INFO - az átengedés vagy blokkolás helyett a <span class=s2>&#34;log&#34;</span> kulcsszóval ellátott csomagok
LOG_NOTICE - az át is engedett csomagok
LOG_WARNING - a blokkolt csomagok
LOG_ERR - a naplózott csomagok közül azok, amelyek túlságosan kicsik <span class=o>(</span>hibás a fejlécük<span class=o>)</span></code></pre></div></div><div class=paragraph><p>Az IPFILTER csak akkor tud naplózni a <span class=filename>/var/log/ipfilter.log</span> állományba, ha elõtte létrehozzuk. Az alábbi parancs erre tökéletesen megfelelõ:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># touch /var/log/ipfilter.log</span></code></pre></div></div><div class=paragraph><p>A <a href="https://man.freebsd.org/cgi/man.cgi?query=syslogd&amp;sektion=8&amp;format=html">syslogd(8)</a> mûködését az <span class=filename>/etc/syslog.conf</span> állományban szereplõ definíciók vezérlik. A <span class=filename>syslog.conf</span> állomány számottevõ mértékben képes meghatározni azt, ahogy a syslog az IPF és a hozzá hasonló alkalmazásoktól kapott rendszerszintû üzeneteket kezeli.</p></div><div class=paragraph><p>Az <span class=filename>/etc/syslog.conf</span> állományba az alábbi sor kell felvennünk:</p></div><div class="literalblock programlisting"><div class=content><pre>local0.* /var/log/ipfilter.log</pre></div></div><div class=paragraph><p>A <code>local0.*</code> megadásával az összes ilyen típusú üzenet egy elõre rögzített helyre kerül.</p></div><div class=paragraph><p>Az <span class=filename>/etc/syslog.conf</span> állományban elvégzett módosításokat úgy léptethetjük érvénybe, ha újraindítjuk a számítógépet vagy az <code>/etc/rc.d/syslogd reload</code> paranccsal megkérjük a <a href="https://man.freebsd.org/cgi/man.cgi?query=syslogd&amp;sektion=8&amp;format=html">syslogd(8)</a> démont, hogy olvassa újra az <span class=filename>/etc/syslog.conf</span> állományt.</p></div><div class=paragraph><p>Az imént létrehozott naplót ne felejtsük el megadni az <span class=filename>/etc/newsyslog.conf</span> állományban sem, és akkor ezzel a cseréjét is megoldjuk.</p></div></div><div class=sect3><h4 id=_a_naplózott_üzenetek_formátuma>30.5.8. A naplózott üzenetek formátuma<a class=anchor href=#_a_naplózott_üzenetek_formátuma></a></h4><div class=paragraph><p>Az <code>ipmon</code> által létrehozott üzenetek whitespace karakterekkel elválasztott adatmezõkbõl állnak. A következõ mezõk az összes üzenet esetében megjelennek:</p></div><div class="olist arabic"><ol class=arabic><li><p>A csomag megérkezésének dátuma</p></li><li><p>A csomag megérkezésének idõpontja. ÓÓ:PP:MM.E alakban jelennek meg az órák, percek, másodpercek és ezredmásodpercek (ez több számjegy hosszú is lehet) szerint</p></li><li><p>Azon interfész a neve, ahol a csomag feldolgozásra került, például <span class=filename>dc0</span></p></li><li><p>A szabályhoz tartozó csoport és sorszám, például <code>@0:17</code></p></li></ol></div><div class=paragraph><p>Ezek az <code>ipfstat -in</code> paranccsal nézhetõek meg.</p></div><div class="olist arabic"><ol class=arabic><li><p>Cselekvés: a p mint átment (passed), b mint blokkolt (blocked), S mint rövid csomag (short packet), n mint egyik szabályra sem illeszkedett (not match), L mint naplózás (log). A módosítók megjelenítésének sorrendje: S, p, b, n, L. A nagybetûs P és B azt jelzi, hogy a csomagot egy felsõbb szintû beállítás miatt naplózták, nem egy szabály hatására.</p></li><li><p>Címek: ez tulajdonképpen három mezõt takar: a forrás címet és portot (melyet egy vesszõ választ el), a → jelet és cél címet és portot. Például: <code>209.53.17.22,80 → 198.73.220.17,1722</code>.</p></li><li><p>A <code>PR</code> után a protokoll neve vagy száma olvasható, például <code>PR tcp</code>.</p></li><li><p>A <code>len</code> csomaghoz tartozó fejléc és törzsének teljes hosszát jelöli, például <code>len 20 40</code>.</p></li></ol></div><div class=paragraph><p>Amennyiben a csomag TCP, egy kötõjellel kezdõdõen további mezõk is megjelenhetnek a beállított opcióknak megfelelõ betûk képében. A betûket és beállításaikat az <a href="https://man.freebsd.org/cgi/man.cgi?query=ipf&amp;sektion=5&amp;format=html">ipf(5)</a> man oldalán olvashatjuk.</p></div><div class=paragraph><p>Amennyiben a csomag ICMP, a sort két mezõ zárja, melyek közül az elsõ tartalma mindig "ICMP", és ezt egy perjellel elválasztva az ICMP üzenet típusa és altípusa követi. Tehát például az ICMP 3/3 a "nem elérhetõ port" üzenetet hordozza.</p></div></div><div class=sect3><h4 id=firewalls-ipf-rules-script>30.5.9. A szabályok felírása szimbolikus helyettesítéssel<a class=anchor href=#firewalls-ipf-rules-script></a></h4><div class=paragraph><p>Az IPF használatában gyakorlott felhasználók közül néhányan képesek olyan stílusú szabályrendszert készíteni, ahol szimbolikus helyettesítést használnak. Ennek az egyik legnagyobb elõnye az, hogy ilyenkor elég csak a szimbolikus névhez tartozó értéket megváltoztatni és amikor a szkript lefut, akkor az összes rá hivatkozó szabályba ez kerül be. Szkript lévén a szimbolikus helyettesítéssel ki tudjuk emelni a gyakran használt értékeket és behelyettesíteni ezeket több helyre. Ezt a most következõ példában láthatjuk.</p></div><div class=paragraph><p>Az itt alkalmazott felírás kompatibilis az <a href="https://man.freebsd.org/cgi/man.cgi?query=sh&amp;sektion=1&amp;format=html">sh(1)</a>, <a href="https://man.freebsd.org/cgi/man.cgi?query=csh&amp;sektion=1&amp;format=html">csh(1)</a> és <a href="https://man.freebsd.org/cgi/man.cgi?query=tcsh&amp;sektion=1&amp;format=html">tcsh(1)</a> parancsértelmezõkkel.</p></div><div class=paragraph><p>A szimbolikus helyettesítést egy dollárjellel fejezzük ki: <code>$</code>.</p></div><div class=paragraph><p>A szimbolikus mezõkben nem szerepel a $ jelölés.</p></div><div class=paragraph><p>A szimbolikus mezõ tartalmát kettõs idézõjelbe (<code>"</code>) tesszük.</p></div><div class=paragraph><p>Kezdjük így el a szabályok írását:</p></div><div class="literalblock programlisting"><div class=content><pre>######### Az IPF szabályait tartalmazó szkript eleje ###########

oif=&#34;dc0&#34;            # a kimenõ interfész neve
odns=&#34;192.0.2.11&#34;    # az internet szolgáltató névszerverének IP-címe
myip=&#34;192.0.2.7&#34;     # a szolgáltatótól kapott statikus IP-címünk
ks=&#34;keep state&#34;
fks=&#34;flags S keep state&#34;

# Választhatunk, hogy az /etc/ipf.rules állományt ebbõl a szkriptbõl
# hozzuk létre vagy futtathatjuk &#34;magát&#34; a szkriptet.
#
# Egyszerre csak az egyik sort használjuk.
#
# 1) Ezzel gyárhatjuk le az /etc/ipf.rules állományt:
#cat &gt; /etc/ipf.rules &lt;&lt; EOF
#
# 2) Ezzel futtathajuk &#34;magát&#34; a szkriptet:
/sbin/ipf -Fa -f - &lt;&lt; EOF

# Engedélyezzük a szolgáltató névszerverének elérését.
pass out quick on $oif proto tcp from any to $odns port = 53 $fks
pass out quick on $oif proto udp from any to $odns port = 53 $ks

# Engedélyezzük kifelé a titkosítatlan www funkciót.
pass out quick on $oif proto tcp from $myip to any port = 80 $fks

# Engedélyezzük kifelé a TLS SSL felett üzemelõ titkosított www funkciót.
pass out quick on $oif proto tcp from $myip to any port = 443 $fks
EOF
################## Itt az IPF szkript vége ########################</pre></div></div><div class=paragraph><p>Ennyi lenne. A példában szereplõ szabályok most nem annyira lényegesek, a hangsúly most igazából a szimbolikus helyettesítésen és annak használatán van. Ha a fenti példát az <span class=filename>/etc/ipf.rules.script</span> állományba mentjük, akkor ezeket a szabályokat a következõ paranccsal újra tudjuk tölteni:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># sh /etc/ipf.rules.script</span></code></pre></div></div><div class=paragraph><p>Egyetlen aprócska gond van a beágyazott szimbólumokat tartalmazó állományokkal: az IPF maga nem képes megérteni a helyettesítéseket, azért közvetlenül nem olvassa a szkriptet.</p></div><div class=paragraph><p>Ez a szkript két módon hasznosítható:</p></div><div class=ulist><ul><li><p>Vegyük ki megjegyzésbõl a <code>cat</code> paranccsal kezdõdõ sort, és tegyük megjegyzésbe az <code>/sbin/ipf</code> kezdetût. A megszokottak szerint tegyük az <code>ipfilter_enable="YES"</code> sort az <span class=filename>/etc/rc.conf</span> állományba, majd minden egyes módosítása után futtassuk le a szkriptet az <span class=filename>/etc/ipf.rules</span> állomány létrehozásához vagy frissítéséhez.</p></li><li><p>Tiltsuk le az IPFILTER aktiválását a rendszerindításkor, tehát írjuk bele az <code>ipfilter_enable="NO"</code> sort (ami mellesleg az alapértelmezett értéke) az <span class=filename>/etc/rc.conf</span> állományba.</p><div class=paragraph><p>Tegyünk egy, az alábbi szkripthez hasonlót az <span class=filename>/usr/local/etc/rc.d/</span> könyvtárba. A szkriptnek adjuk valamilyen értelmes nevet, például <span class=filename>ipf.loadrules.sh</span>. Az <span class=filename>.sh</span> kiterjesztés használata kötelezõ.</p></div><div class="literalblock programlisting"><div class=content><pre>#!/bin/sh
sh /etc/ipf.rules.script</pre></div></div><div class=paragraph><p>A szkript engedélyeit állítsuk be úgy, hogy a <code>root</code> tulajdonában legyen és képes legyen olvasni, írni valamint végrehajtani.</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># chmod 700 /usr/local/etc/rc.d/ipf.loadrules.sh</span></code></pre></div></div></li></ul></div><div class=paragraph><p>Most miután a rendszer elindult, az IPF szabályai be fognak töltõdni.</p></div></div><div class=sect3><h4 id=_szabályrendszerek_az_ipf_ben>30.5.10. Szabályrendszerek az IPF-ben<a class=anchor href=#_szabályrendszerek_az_ipf_ben></a></h4><div class=paragraph><p>Az IPF esetében a szabályrendszer olyan szabályokból áll, amelyek a csomagokról tartalmuk alapján eldöntik, hogy át kell engedni vagy vissza kell tartani. A gépek közt két irányban áramló csomagok egy munkamenet alapú társalgást képeznek. A tûzfalhoz tartozó szabályrendszer egyaránt feldolgozza a internetrõl a hálózatunk felé igyekvõ csomagokat, illetve a hálózatunk ezekre adott válaszait. Az egyes TCP/IP szolgáltatásokat (mint például telnet, www, levelezés stb.) a hozzájuk tartozó protokol és szabványos (fogadó) portszám írja le. Ezekre a forrásról általában valamilyen nem szabványos (magasabb értékû) portról érkeznek csomagok. Ekkor a kommunikáció összes paramétere (vagyis a portok és címek) bármelyike alapján definiálhatunk blokkolást vagy továbbengedést leíró szabályokat.</p></div><div class=paragraph><p>Az IPF eredetileg úgy íródott, hogy a szabályokat "az utolsó illeszkedõ szabály nyer" stílusban dolgozza fel és csak állapot nélküli szabályokat ismert. Az idõk folyamán az IPF szabályai kiegészültek a "quick" és az állapottartásra vonatkozó "keep state" opciókkal, amelynek köszönhetõen óriási mértékben korszerûsödött a szabályok feldolgozása.</p></div><div class=paragraph><p>A szakaszban szereplõ utasítások olyan szabályokat alkalmaznak, amelyekben egyaránt szerepel a "quick" és az állapottartásért felelõs "keep state" beállítás. Ez az inkluzív tûzfalak létrehozásának egyik alapeszköze.</p></div><div class="admonitionblock warning"><table><tbody><tr><td class=icon><i class="fa icon-warning" title=Warning></i></td><td class=content><div class=paragraph><p>A tûzfal szabályainak összeállítása során <em>nagyon óvatosnak</em> kell lennünk! Bizonyos beállítások hatására akár <em>ki is zárhatjuk magunkat</em> a szerverünkrõl. Az ebbõl fakadó esetleges kellemetlenségek elkerülése érdekében javasoljuk, hogy a tûzfal alapjait elõször helyi konzolról építsük fel, ne pedig távolról, például ssh segítségével.</p></div></td></tr></tbody></table></div></div><div class=sect3><h4 id=_a_szabályok_felépítése>30.5.11. A szabályok felépítése<a class=anchor href=#_a_szabályok_felépítése></a></h4><div class=paragraph><p>A szabályok felépítésének bemutatását itt most leszûkítjük a modern állapottartó szabályokra és az "elsõ illeszkedõ szabály nyer" típusú feldolgozásra. A szabályok felírásának régebbi módjai az <a href="https://man.freebsd.org/cgi/man.cgi?query=ipf&amp;sektion=8&amp;format=html">ipf(8)</a> man oldalon találhatóak.</p></div><div class=paragraph><p>A <code>#</code> karakterrel egy megjegyzés kezdetét jelezzük, és általában a sor végén vagy egy külön sorban bukkan fel. Az üres sorokat a rendszer nem veszi figyelembe.</p></div><div class=paragraph><p>A szabályok kulcsszavakat tartalmaznak. Ezeknek a kulcsszavaknak balról jobbra haladva adott sorrendben kell szerepelniük. A kulcsszavakat kiemeltük. Egyes kulcsszavakhoz további beállítások is tartozhatnak, amelyek maguk is kulcsszavak lehetnek, és még további opciókkal rendelkezhetnek. Az alábbi nyelvtan mindegyik elemét kiemeltük és az alábbiakban egyenként kifejtjük a részleteiket.</p></div><div class=paragraph><p><em>CSELEKVÉS BE-KI OPCIÓK SZûRÉS ÁLLAPOTTARTÓ PROTOKOLL FORRÁS_CÍM,CÉL_CÍM OBJEKTUM PORTSZÁM TCP_BEÁLLÍTÁS ÁLLAPOTTARTÓ</em></p></div><div class=paragraph><p><em>CSELEKVÉS</em> = block | pass</p></div><div class=paragraph><p><em>BE-KI</em> = in | out</p></div><div class=paragraph><p><em>OPCIÓK</em> = log | quick | on <em>interfész</em></p></div><div class=paragraph><p><em>SZûRÉS</em> = proto <em>érték</em> | <em>forrás/cél IP</em> | port = <em>szám</em> | flags <em>beállítás</em></p></div><div class=paragraph><p><em>PROTOKOLL</em> = tcp/udp | udp | tcp | icmp</p></div><div class=paragraph><p><em>FORRÁS_CÍM,CÉL_CÍM</em> = all | from <em>objektum</em> to <em>objektum</em></p></div><div class=paragraph><p><em>OBJEKTUM</em> = <em>IP-cím</em> | any</p></div><div class=paragraph><p><em>PORTSZÁM</em> = <em>portszám</em></p></div><div class=paragraph><p><em>TCP_BEÁLLÍTÁS</em> = S</p></div><div class=paragraph><p><em>ÁLLAPOTTARTÓ</em> = keep state</p></div><div class=sect4><h5 id=_cselekvés>30.5.11.1. CSELEKVÉS<a class=anchor href=#_cselekvés></a></h5><div class=paragraph><p>A cselekvés határozza meg, hogy mit kell tenni azokkal a csomagokkal, amelyek illeszkednek a szabály többi részére. Minden szabályhoz tartoznia <em>kell</em> egy cselekvésnek. A következõ cselekvések közül választhatunk:</p></div><div class=paragraph><p>A <code>block</code> megadásával a szabályban szereplõ szûrési feltételre illeszkedõ csomagot eldobjuk.</p></div><div class=paragraph><p>A <code>pass</code> megadásával a szabályban szereplõ szûrési feltételre illeszkedõ csomagot átengedjük a tûzfalon.</p></div></div><div class=sect4><h5 id=_be_ki>30.5.11.2. BE-KI<a class=anchor href=#_be_ki></a></h5><div class=paragraph><p>Az összes szûrési szabály esetében kötelezõ egyértelmûen nyilatkozunk arról, hogy a bemenõ vagy a kimenõ forgalomra vonatkozik. Ezért a következõ kulcsszó vagy az <code>in</code> vagy pedig az <code>out</code>, de közülük egyszerre csak az egyiket szabad használni, máskülönben a szabály hibásnak minõsül.</p></div><div class=paragraph><p>Az <code>in</code> jelenti, hogy a szabályt az internet felõl az adott interfészen beérkezõ csomagokra kell alkalmazni.</p></div><div class=paragraph><p>Az <code>out</code> jelenti, hogy a szabályt az internet felé az adott interfészen kiküldött csomagokra kell alkalmazni.</p></div></div><div class=sect4><h5 id=_opciók>30.5.11.3. OPCIÓK<a class=anchor href=#_opciók></a></h5><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Ezek az opciók csak a lentebb bemutatott sorrendben használhatók.</p></div></td></tr></tbody></table></div><div class=paragraph><p>A <code>log</code> jelzi, hogy illeszkedés esetén a csomag fejlécét az <span class=filename>ipl</span> eszközön keresztül naplózni kell (lásd a naplózásról szóló szakaszt).</p></div><div class=paragraph><p>A <code>quick</code>jelzi, hogy illeszkedés esetén ez lesz a legutolsónak ellenõrzött szabály és így egy olyan "rövidzárat" tudunk képezni a feldolgozásban, amellyel elkerüljük a csomagra egyébként vonatkozó többi szabály illesztését. Ez az opció a korszerûsített szabályfeldolgozás kihasználásához elengedhetetlen.</p></div><div class=paragraph><p>Az <code>on</code> használatával a szûrés feltételei közé bevonhatjuk a csomaghoz tartozó hálózati interfészt. Itt az interfészek az <a href="https://man.freebsd.org/cgi/man.cgi?query=ifconfig&amp;sektion=8&amp;format=html">ifconfig(8)</a> által megjelenített formában adhatóak meg. Az opció megadásával csak az adott interfészen az adott irányba (befelé/kifelé) közlekedõ csomagokra fog illeszkedni a szabály. Ez az opció a korszerûsített szabályfeldolgozás kihasználásához nélkülözhetetlen.</p></div><div class=paragraph><p>Amikor naplózunk egy csomagot, akkor a hozzá tartozó fejléc az IPL csomagnaplózó pszeudo eszközhöz kerül. A <code>log</code> kulcsszó után közvetlenül a következõ minõsítõk szerepelhetnek (a következõ sorrendben):</p></div><div class=paragraph><p>A <code>body</code> jelzi, hogy a csomag tartalmának elsõ 128 byte-ját még jegyezzük fel a fejléc mellé.</p></div><div class=paragraph><p>A <code>first</code> minõsítõt akkor érdemes használnunk, amikor a <code>log</code> kulcsszót a <code>keep state</code> opcióval együtt alkalmazzuk, mivel ilyenkor csak a szabályt kialakító csomag kerül naplózásra és nem minden olyan, ami illeszkedik az állapottartási feltételekre.</p></div></div><div class=sect4><h5 id=_szûrés>30.5.11.4. SZûRÉS<a class=anchor href=#_szûrés></a></h5><div class=paragraph><p>Ebben a szakaszban olyan kulcsszavak jelenhetnek meg, amelyekkel a csomagok különféle tulajdonságai alapján ítélkezhetünk azok illeszkedésérõl. Itt adott egy kiinduló kulcsszó, amelyhez további kulcsszavak is tartoznak, és amelyek közül csak egyet választhatunk. Az alábbi általános tulajdonságok alapján tudjuk szûrni a csomagokat, ebben a sorrendben:</p></div></div><div class=sect4><h5 id=_protokoll>30.5.11.5. PROTOKOLL<a class=anchor href=#_protokoll></a></h5><div class=paragraph><p>A <code>proto</code> egy olyan kulcsszó, amelyhez hozzá kell rendelnünk még valamelyik opcióját is. Ez az opció segít az adott protokolloknak megfelelõen válogatni a csomagok között. A korszerûsített szabályfeldolgozás lehetõségeinek kihasználásához nélkülözhetetlen.</p></div><div class=paragraph><p>Opcióként a <code>tcp/udp | udp | tcp | icmp</code>, vagy bármelyik, az <span class=filename>/etc/protocols</span> állományban megtalálható kulcsszó felhasználható. A <code>tcp/udp</code> ebbõl a szempontból speciálisnak tekinthetõ, mivel hatására egyszerre illeszthetõek a szabályra a TCP és UDP csomagok, és így a protokolltól eltekintve azonos szabályok felesleges többszörözését kerülhetjük el.</p></div></div><div class=sect4><h5 id=_forrás_címcél_cím>30.5.11.6. FORRÁS_CÍM/CÉL_CÍM<a class=anchor href=#_forrás_címcél_cím></a></h5><div class=paragraph><p>Az <code>all</code> kulcsszó gyakorlatilag a "from any to any" ("bárhonnan bárhova") szinonímája és nem tartozik hozzá paraméter.</p></div><div class=paragraph><p>A <code>from forrás to cél</code> felépítése: a <code>from</code> és <code>to</code> kulcsszavak az IP-címek illesztésére használhatóak. Ilyenkor a szabályokban a forrás <em>és</em> a cél paramétereknek is szerepelniük kell. Az <code>any</code> egy olyan speciális kulcsszó, amely tetszõleges IP-címre illeszkedik. Néhány példa az alkalmazására: <code>from any to any</code> vagy <code>from 0.0.0.0/0 to any</code>, <code>from any to 0.0.0.0/0</code>, <code>from 0.0.0.0/0 to any</code> vagy <code>from any to 0.0.0.0</code>.</p></div><div class=paragraph><p>Az IP-címek megadhatóak pontozott numerikus formában a hálózati maszk bitekben mért hosszával együtt, vagy akár egyetlen pontozott numerikus IP-címként.</p></div><div class=paragraph><p>Nincs lehetõség olyan IP-címtartományok illesztésére, amelyek nem adhatóak meg kényelmesen ponttal elválasztott számok és maszk hosszával. A <a class=package href=https://cgit.freebsd.org/ports/tree/net-mgmt/ipcalc/>net-mgmt/ipcalc</a> port az ilyen számításokat könnyíti meg. A hálózati maszkok hosszának megállapításban segíthet az említett segédprogram (angol nyelvû) honlapja: <a href=http://jodies.de/ipcalc>http://jodies.de/ipcalc</a>.</p></div></div><div class=sect4><h5 id=_port>30.5.11.7. PORT<a class=anchor href=#_port></a></h5><div class=paragraph><p>Amikor portra vonatkozó illeszkedést írunk elõ, megadhatjuk a forrásra és célra, amit aztán vagy csak TCP vagy pedig csak UDP csomagokra alkalmazunk. A portok feltételeinek megfogalmazásánál használhatjuk a portok számát vagy az <span class=filename>/etc/services</span> állományban szereplõ nevüket. Amikor a port egy <code>from</code> típusú objektum leírásában jelenik meg, akkor automatikusan a forrásportot jelenti, míg a <code>to</code> objektum leírásában pedig a célportot. A <code>to</code> objektumoknál a port megadása elengedhetetlen a korszerûsített szabályfeldolgozás elõnyeinek kihasználásához. Példa: <code>from any to any port = 80</code>.</p></div><div class=paragraph><p>Az egyes portokat különbözõ mûveletek segítségével, numerikusan hasonlíthatjuk össze, ahol akár porttartományt is megadhatunk.</p></div><div class=paragraph><p>port "=" | "!=" | "&lt;" | ">" | "⇐" | ">=" | "eq" | "ne" | "lt" | "gt" | "le" | "ge".</p></div><div class=paragraph><p>A porttartományok megadásához használjuk a <code>port</code> "&lt;>" | ">&lt;" felírási módot.</p></div><div class="admonitionblock warning"><table><tbody><tr><td class=icon><i class="fa icon-warning" title=Warning></i></td><td class=content><div class=paragraph><p>A forrásra és célra vonatkozó paraméterek után szereplõ másik két paraméter nélkülözhetetlen a korszerûsített szabályfeldolgozás mûködéséhez.</p></div></td></tr></tbody></table></div></div><div class=sect4><h5 id=_tcp_beállítás>30.5.11.8. TCP_BEÁLLÍTÁS<a class=anchor href=#_tcp_beállítás></a></h5><div class=paragraph><p>A beállítások csak a TCP forgalom szûrésénél érvényesülnek. A betûk jelölik azokat a lehetséges beállításokat, amelyek a TCP csomagok fejlécében megvizsgálhatóak.</p></div><div class=paragraph><p>A korszerûsített szabályfeldolgozás a <code>flags S</code> paraméter segítségével ismeri fel a TCP munkameneteket kezdeményezõ kéréseket.</p></div></div><div class=sect4><h5 id=_állapottartó>30.5.11.9. ÁLLAPOTTARTÓ<a class=anchor href=#_állapottartó></a></h5><div class=paragraph><p>A <code>keep state</code> jelzi, hogy a szabály paramétereinek megfelelõ bármely csomag aktiválja az állapottartó szûrés használatát.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Ez a beállítás feltétlenül szükséges a korszerûsített szabályfeldolgozás megfelelõ kihasználásához.</p></div></td></tr></tbody></table></div></div></div><div class=sect3><h4 id=_állapottartó_csomagszûrés>30.5.12. Állapottartó csomagszûrés<a class=anchor href=#_állapottartó_csomagszûrés></a></h4><div class=paragraph><p>Az állapottartó szûrés a csomagok kétirányú áramlását egy létrejött kapcsolatba sorolja be. Amikor aktiválódik, az állapottartó szabály elõre dinamikusan létrehozza a kétirányú kommunikációban megforduló csomagokhoz a megfelelõ belsõ szabályokat. Olyan vizsgálatokat végez, amelyek segítségével ki tudja deríteni, hogy a csomag küldõje és címzettje között fennálló kétirányú kapcsolat érvényes szabályok szerint zajlik-e. Minden olyan csomagot, amely nem illeszkedik megfelelõen a kapcsolatra vonatkozó sémára, csalásnak tekintjük és automatikusan eldobjuk.</p></div><div class=paragraph><p>Az állapottartás révén lehetõségünk van a TCP vagy UDP kapcsolatokhoz tartozó ICMP csomagokat is átengedni a tûzfalon. Tehát ha kapunk egy 3-as típusú, 4-es kódú ICMP választ valamilyen böngészésre használt állapottartó szabályon keresztül kiküldött kérésre, akkor az automatikusan bejöhet. Amelyik csomagot az IPF egyértelmûen képes besorolni az aktív kapcsolatba, még ha az eltérõ protokollt is használ, beengedi.</p></div><div class=paragraph><p>Ami ilyenkor történik:</p></div><div class=paragraph><p>Az internethez csatlakozó interfészen keresztül kifelé haladó csomagokat elõször egy dinamikus állapottábla alapján illesztjük, és ha a csomag illeszkedik az aktív kapcsolatban következõként várt csomagra, akkor átmegy a tûzfalon és a dinamikus állapottáblában frissül a kapcsolat állapota. Az aktív munkameneten kívül csomagok pedig egyszerûen a kimenõ szabályrendszer szerint kerülnek ellenõrzésre.</p></div><div class=paragraph><p>Hasonlóan az elõzõhöz, az internethez csatlakozó interfészen keresztül befelé haladó csomagokat elõször egy dinamikus állapottábla alapján illesztjük, és ha a csomag illeszkedik az aktív kapcsolatban következõként várt csomagra, akkor átmegy a tûzfalon és a dinamikus állapottáblában frissül a kapcsolat állapota. Az aktív munkamenethez nem tartozó csomagok pedig egyszerûen a bejövõ szabályrendszer szerint kerülnek ellenõrzésre.</p></div><div class=paragraph><p>Amikor egy kapcsolat befejezõdik, automatikusan törlõdik a dinamikus állapottáblából.</p></div><div class=paragraph><p>Az állapottartó csomagszûrés használatával az újonnan keletkezõ kapcsolatok elutasítására vagy engedélyezésére tudunk koncentrálni. Ha engedélyeztük egy új kapcsolat létrejöttét, akkor a rákövetkezõ összes többi csomag automatikusan átmegy a tûzfalon és minden más hamis csomag eldobódik. Ha tiltjuk az új kapcsolatot, akkor egyetlen rákövetkezõ csomag sem juthat át. Az állapottartó szûrés által felkínált fejlett elemzési lehetõségek képesek védelmet nyújtani a behatolók részérõl alkalmazott megannyi különbözõ támadási módszer ellen.</p></div></div><div class=sect3><h4 id=_példa_inkluzív_szabályrendszerre>30.5.13. Példa inkluzív szabályrendszerre<a class=anchor href=#_példa_inkluzív_szabályrendszerre></a></h4><div class=paragraph><p>A most következõ szabályrendszer arra mutat példát, hogyan programozzunk le egy nagyon biztonságos inkluzív tûzfalat. Az inkluzív tûzfalak csak a szabályainak megfelelõ szolgáltatásokat engedik keresztül, és alapértelmezés szerint minden mást blokkolnak. Egy hálózat gépeit védõ tûzfalnak, amelyet gyakran "hálózati tûzfalnak" (network firewall) is neveznek, legalább két hálózati interfésszel kell rendelkeznie. Ezeket az interfészeket általában úgy állítják be, hogy tökéletesen megbíznak az egyik oldalban (a helyi hálózatban), a másikban (az internetben) pedig egyáltalán nem. A tûzfalat egyébként úgy is beállíthatjuk, hogy csak a tûzfalat mûködtetõ gépet védje - ezt "egyrendszeres tûzfalnak" (host based firewall) nevezik. Az ilyen típusú megoldásokat nem biztonságos hálózaton keresztül kommunikáló szervereknél alkalmaznak.</p></div><div class=paragraph><p>Mindegyik UNIX®-típusú rendszert, köztük a FreeBSD-t is úgy alakították ki, hogy az operációs rendszeren belüli kommunikáció az <span class=filename>lo0</span> interfészen és a <code>127.0.0.1</code> IP-címen keresztül történik. A tûzfal szabályai között feltétlenül szerepelniük kell olyanoknak, amelyek lehetõvé teszik ezen a speciális intefészen a csomagok zavartalan mozgását.</p></div><div class=paragraph><p>Az internetre csatlakozó interfészhez kell rendelni a kifelé és befelé haladó forgalom hitelesítését é a hozzáférésének vezérlését. Ez lehet a felhasználói PPP által létrehozott <span class=filename>tun0</span> interfész vagy a DSL-, illetve kábelmodemhez csatlakozó hálózati kártya.</p></div><div class=paragraph><p>Ahol egy vagy több hálózati kártya is csatlakozik több különbözõ helyi hálózathoz, úgy kell beállítani a hozzájuk tartozó interfészeket, hogy egymás felé és az internet felé képesek legyenek küldeni és fogadni.</p></div><div class=paragraph><p>A szabályokat elõször három nagy csoportba kell szerveznünk: elõször jönnek a megbízható interfészek, ezeket követik az internet felé mutató interfészek, végül internet felõl jövõ, nem megbízható interfészeke.</p></div><div class=paragraph><p>Az egyes csoportokban szereplõ szabályokat úgy kell megadni, hogy közülük elõre kerüljenek a leggyakrabban alkalmazottak, és a csoport utolsó szabálya blokkoljon és naplózzon minden csomagot az adott interfészen és irányban.</p></div><div class=paragraph><p>A kimenõ forgalomat vezérlõ szabályrendszer csak <code>pass</code> (tehát átengedõ) szabályokat tartalmazhat, amelyek bentrõl az interneten elérhetõ szolgáltatásokat azonosítják egyértelmûen. Az összes ilyen szabályban meg kell jelenni a <code>quick</code>, <code>on</code>, <code>proto</code>, <code>port</code> és <code>keep state</code> beállításoknak. A <code>proto tcp</code> szabályok esetében meg kell adni a <code>flag</code> opciót is, amivel fel tudjuk ismertetni a kapcsolatok keletkezését és ezen keresztül aktiválni az állapottartást.</p></div><div class=paragraph><p>A bejövõ forgalmat vezérlõ szabályrendszerben elõször az eldobni kívánt csomagokat kell megadni, aminek két eltérõ oka van. Elõször is elõfordulhat, hogy a veszélyes csomagok részleges illeszkedés miatt szabályosnak tûnnek. Az ilyen csomagokat értelemszerûen nem lenne szabad beengedni a szabályok részleges megfelelése alapján. A másodszor az eleve ismerten problémás és értelmetlen csomagokat csendben el kellene vetni, mielõtt a szakaszhoz tartozó utolsó szabály fogná meg és naplózná. Ez az utolsó szabály egyébként szükség esetén felhasználható a támadók elleni bizonyítékok begyûjtésére.</p></div><div class=paragraph><p>A másik, amire még oda kell figyelnünk, hogy a blokkolt csomagok esetében semmilyen válasz nem keletkezzen, egyszerûen csak tûnjenek el. Így a támadó nem fogja tudni, hogy a csomagjai vajon elérték-e a rendszerünket. Minél kevesebb információt tudnak összegyûjteni a rendszerünkrõl a támadók, annál több idõt kell szánniuk csínytevéseik kieszelésére. A <code>log first</code> opciót tartalmazó szabályok csak az illeszkedésnél fogják naplózni a hozzájuk tartozó eseményt. Erre láthatunk példát az <code>nmap OS fingerprint</code> szabálynál. Az <a class=package href=https://cgit.freebsd.org/ports/tree/security/nmap/>security/nmap</a> segédprogramot a támadók gyakran alkalmazzák a megtámadni kívánt szerver operációs rendszerének felderítésére.</p></div><div class=paragraph><p>Minden <code>log first</code> opcióval megadott szabály illeszkedésénél a <code>ipfstat -hio</code> parancs meghatározódik az eddigi illeszkedések aktuális száma. Nagyobb értékek esetében következtethetünk arra, hogy a rendszerünket megtámadták (vagyis csomagokkal árasztják éppen el).</p></div><div class=paragraph><p>Az ismeretlen portszámok felderítésére az <span class=filename>/etc/services</span> állomány, esetleg a <a href=http://www.securitystats.com/tools/portsearch.php>http://www.securitystats.com/tools/portsearch.php</a> (angol nyelvû) honlap használható.</p></div><div class=paragraph><p>Érdemes továbbá megnézni a trójai programok által használt portokat a <a href=http://www.simovits.com/trojans/trojans.html>http://www.simovits.com/trojans/trojans.html</a> címen (angolul).</p></div><div class=paragraph><p>A következõ szabályrendszer egy olyan biztonságos "inkluzív" típusú tûzfal, amelyet éles rendszeren is használnak. Ezt a rendszerünkön nem használt szolgáltatásokra vonatkozó <code>pass</code> szabályok törlésével könnyedén a saját igényeink szerint alakíthatjuk.</p></div><div class=paragraph><p>Ha nem akarunk látni bizonyos üzeneteket, akkor vegyünk fel hozzájuk egy <code>block</code> típusú szabályt a befelé irányuló forgalomhoz tartozó szabályok közé.</p></div><div class=paragraph><p>A szabályokban írjuk át a <span class=filename>dc0</span> interfész nevét annak a hálózati kártyának az interfészére, amelyen keresztül csatlakozunk az internethez. A felhasználói PPP esetében ez a <span class=filename>tun0</span> lesz.</p></div><div class=paragraph><p>Tehát a következõket kell beírni az <span class=filename>/etc/ipf.rules</span> állományba:</p></div><div class="literalblock programlisting"><div class=content><pre>#################################################################
# A helyi hálózatunkon zajló forgalmat ne korlátozzuk.
# Csak akkor kell, ha helyi hálózathoz is csatlakozunk.
#################################################################

#pass out quick on xl0 all
#pass in quick on xl0 all

#################################################################
# A belsõ interfészen szintén ne korlátozzunk semmit.
#################################################################
pass in quick on lo0 all
pass out quick on lo0 all

#################################################################
# Az internet felé forgalmazó interfész (kimenõ kapcsolatok)
# A saját hálózatunkról belülrõl vagy errõl az átjáróról
# kezdeményezett kapcsolatokat vizsgáljuk az internet felé.
#################################################################

# Engedélyezzük az internet szolgáltatók névszerverének elérését,
# az &#34;xxx&#34; helyett a névszervet IP-címét kell megadni.
# Másoljuk le ezeket a sorokat, ha a szolgáltatónknak több
# névszerverét is beakarjuk állítani. A címeiket az /etc/resolv.conf
# állományban találjuk.
pass out quick on dc0 proto tcp from any to xxx port = 53 flags S keep state
pass out quick on dc0 proto udp from any to xxx port = 53 keep state

# DSL vagy kábeles hálózatoknál engedélyezzük a
# szolgáltatónk DHCP szerverének elérését.
# Ez a szabály nem kell, ha &#34;felhasználói PPP&#34;-vel
# kapcsolódunk az internethez, ilyenkor tehát az egész
# csoport törölhetõ.
# Használjuk az alábbi szabályt és keressük meg a naplóban az
# IP-címet. Ha megtaláltuk, akkor tegyük bele a megjegyzésben
# szereplõ szabályba és töröljük az elsõ szabályt.
pass out log quick on dc0 proto udp from any to any port = 67 keep state
#pass out quick on dc0 proto udp from any to z.z.z.z port = 67 keep state

# Kifelé engedélyezzük a szabványos nem biztonságos WWW funkciókat.
pass out quick on dc0 proto tcp from any to any port = 80 flags S keep state

# Kifelé engedélyezzük a biztonságos WWW funkciókat TLS SSL
# protokollal.
pass out quick on dc0 proto tcp from any to any port = 443 flags S keep state

# Kifelé engedélyezzük az e-mailek küldését és fogadását.
pass out quick on dc0 proto tcp from any to any port = 110 flags S keep state
pass out quick on dc0 proto tcp from any to any port = 25 flags S keep state

# Kifelé engedélyezzük az idõ szolgáltatást.
pass out quick on dc0 proto tcp from any to any port = 37 flags S keep state

# Kifelé engedélyezzük az nntp híreket.
pass out quick on dc0 proto tcp from any to any port = 119 flags S keep state

# Kifelé engedélyezzük az átjáróról és a helyi hálózatról a nem
# biztonságos FTP használatát (passzív és akív módokban is). Ez a
# funkció a mûködéséhez a nat szabályokat tartalmazó állományban
# hivatkozott FTP proxyt használja. Amennyiben a pkg_add paranccsal
# csomagokat akarunk telepíteni az átjáróra, erre a szabályra
# mindenképpen szükségünk lesz.
pass out quick on dc0 proto tcp from any to any port = 21 flags S keep state

# Kifelé engedélyezzük az ssh/sftp/scp # (biztonságos telnet/rlogin/FTP)
# szolgáltatások # elérését az SSH (secure shell) használatával.
pass out quick on dc0 proto tcp from any to any port = 22 flags S keep state

# Kifelé engedélyezzük a nem biztonságos telnet elérését.
pass out quick on dc0 proto tcp from any to any port = 23 flags S keep state

# Kifelé engedélyezzük FreeBSD CVSUp funkcióját.
pass out quick on dc0 proto tcp from any to any port = 5999 flags S keep state

# Kifelé engedélyezzük a pinget.
pass out quick on dc0 proto icmp from any to any icmp-type 8 keep state

# Kifelé engedélyezzük a helyi hálózatról érkezõ whois kéréseket.
pass out quick on dc0 proto tcp from any to any port = 43 flags S keep state

# Minden mást eldobunk és naplózzuk az elsõ elõfordulásukat.
# Ez a szabály blokkol alapértelmezés szerint mindent.
block out log first quick on dc0 all

#################################################################
# Az internet felõli interfész (bejövõ kapcsolatok)
# A saját hálózatunk felé vagy erre az átjáróra
# nyitott kapcsolatokat vizsgáljuk az internet felõl.
#################################################################

# Eldobjuk az összes olyan bejövõ forgalmat, amit hivatalosan nem
# lehetne továbbítani vagy fenntartott címterülethez tartozik.
block in quick on dc0 from 192.168.0.0/16 to any    #RFC 1918: privát IP
block in quick on dc0 from 172.16.0.0/12 to any     #RFC 1918: privát IP
block in quick on dc0 from 10.0.0.0/8 to any        #RFC 1918: privát IP
block in quick on dc0 from 127.0.0.0/8 to any       #helyi
block in quick on dc0 from 0.0.0.0/8 to any         #helyi
block in quick on dc0 from 169.254.0.0/16 to any    #DHCP
block in quick on dc0 from 192.0.2.0/24 to any      #dokumentációs célokra fenntartva
block in quick on dc0 from 204.152.64.0/23 to any   #Sun klaszterek összekötésére használt
block in quick on dc0 from 224.0.0.0/3 to any       #D és E osztályú multicast

##### Itt eldobunk egy rakás csúf dolgot ############
# Ezeket nem akarjuk a naplóban látni:

# Eldobjuk a töredékcsomagokat.
block in quick on dc0 all with frags

# Eldobjuk a túlságosan rövid TCP csomagokat.
block in quick on dc0 proto tcp all with short

# Eldobjuk a forrás által közvetített (source routed) csomagokat.
block in quick on dc0 all with opt lsrr
block in quick on dc0 all with opt ssrr

# Elutasítjuk az &#34;OS fingerprint&#34; kéréseket.
# Naplózzuk az elsõ elõfordulást, így nálunk lesz a kíváncsiskodó
# egyén IP-címe.
block in log first quick on dc0 proto tcp from any to any flags FUP

# Eldobunk mindent, aminek speciális beállításai vannak.
block in quick on dc0 all with ipopts

# Elutasítjuk a publikus pinget.
block in quick on dc0 proto icmp all icmp-type 8

# Elutasítjuk az ident kéréseket.
block in quick on dc0 proto tcp from any to any port = 113

# Blokkoljuk az összes Netbios szolgáltatást: 137=név, 138=datagram,
# 139=session. A Netbios az MS Windows megosztását implementálja.
# Blokkoljuk az MS Windows hosts2 névszerver kéréseit is a 81-es
# porton.
block in log first quick on dc0 proto tcp/udp from any to any port = 137
block in log first quick on dc0 proto tcp/udp from any to any port = 138
block in log first quick on dc0 proto tcp/udp from any to any port = 139
block in log first quick on dc0 proto tcp/udp from any to any port = 81

# Engedélyezzük a szolgáltatónk DHCP szerverétõl érkezõ forgalmat.
# Ebben a szabályban meg kell adnunk a szolgáltató DHCP szerverének
# IP-címét, mivel itt csak a hiteles forrásból fogadunk el csomagokat.
# Erre csak DSL- és kábelmodemes kapcsolat esetében van szükség, a
# &#34;felhasználói PPP&#34; alkalmazása során szükségtelen. Ez az IP-cím
# megegyezik a kimenõ kapcsolatoknál megadott címmel.
pass in quick on dc0 proto udp from z.z.z.z to any port = 68 keep state

# Befelé engedélyezzük a szabványos WWW funkciót, mivel webszerverünk
# van.
pass in quick on dc0 proto tcp from any to any port = 80 flags S keep state

# Befelé engedélyezzük az internetrõl érkezõ nem biztonságos telnet
# kapcsolatokat. Azért nem biztonságos, mert az azonosítókat és
# jelszavakat titkosítatlan formában közli az interneten keresztül.
# Töröljük ezt a szabályt, ha nem használunk telnet szervert.
#pass in quick on dc0 proto tcp from any to any port = 23 flags S keep state

# Befelé engedélyezzük az internetrõl # érkezõ ssh/sftp/scp (biztonságos
# telnet/rlogin/FTP) # kapcsolatokat az SSH (secure shell) használatával.
pass in quick on dc0 proto tcp from any to any port = 22 flags S keep state

# Minden mást dobjuk el és naplózzuk az elsõ elõfordulásukat.
# Az elsõ alkalom naplózásával elejét tudjuk venni a &#34;Denial of
# Service&#34; típusú támadásoknak, amivel egyébként lehetséges lenne a
# napló elárasztása.
# Ez a szabály blokkol alapértelmezés szerint mindent.
block in log first quick on dc0 all
################### Itt van a szabályok vége ##############################</pre></div></div></div><div class=sect3><h4 id=_nat>30.5.14. NAT<a class=anchor href=#_nat></a></h4><div class=paragraph><p>A NAT jelentése <em>Network Address Translation</em>, vagyis hálózati címfordítás. A Linux® esetében ezt "IP masqueradingnak", vagyis IP maszkolásnak hívják. A hálózati címfordítás és az IP maszkolás lényegben ugyanazt takarja. Az IPF címfordításért felelõs funkciójának köszönhetõen képesek vagyunk a tûzfal mögött elhelyezkedõ helyi hálózat számára megosztani az internet-szolgáltatól kapott publikus IP-címet.</p></div><div class=paragraph><p>Sokakban felmerülhet a kérdés, hogy erre vajon mi szükségünk lehet. Az internet-szolgáltatók a magánszemélyeknek általában dinamikus IP-címeket osztanak ki. A dinamikus itt arra utal, hogy a címünk minden alkalommal változik, amikor betárcsázunk a szolgáltatóhoz vagy amikor ki- és bekapcsoljuk a modemünket. Ez a dinamikus IP-cím fog azonosítani minket az interneten.</p></div><div class=paragraph><p>Most tegyük fel, hogy öt gépünk van otthon, viszont csak egyetlen elõfizetéssel rendelkezünk. Ebben az esetben öt telefonvonalat kellene használnunk és mindegyik géphez elõfizetni az internetre.</p></div><div class=paragraph><p>A hálózati címfordítás alkalmazásával azonban mindössze egyetlen elõfizetés kell. A gépek közül négyet hozzákötünk egy switch-hez és a switch-et pedig a fennmaradó géphez, amelyen FreeBSD fut. Ez utóbbi lesz az így kialakított helyi hálózatunk átjárója. A tûzfalban mûködõ címfordítás segítségével a helyi hálózaton található gépek IP-címeit észrevétlenül át tudjuk fordítani a hálózatunk publikus IP-címére, ahogy a csomagok elhagyják az átjárót. A beérkezõ csomagok esetében mindez visszafelé történik meg.</p></div><div class=paragraph><p>Az IP-címek közül adott egy tartomány, amit a címfordítást használó helyi hálózatok részére tartanak fenn. Az RFC 1918 szerint az alábbi IP-címtartományok használhatók a helyi hálózatban, mivel ezeken keresztül közvetlenül sosem lehet kijutni az internetre:</p></div><table class="tableblock frame-none grid-all stretch informaltable"><col style=width:33.3333%><col style=width:33.3333%><col style=width:33.3334%><tbody><tr><td class="tableblock halign-left valign-top"><p class=tableblock>Kezdõ IP: <code>10.0.0.0</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>-</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Záró IP: <code>10.255.255.255</code></p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>Kezdõ IP: <code>172.16.0.0</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>-</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Záró IP: <code>172.31.255.255</code></p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>Kezdõ IP: <code>192.168.0.0</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>-</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Záró IP: <code>192.168.255.255</code></p></td></tr></tbody></table></div><div class=sect3><h4 id=_ipnat>30.5.15. IPNAT<a class=anchor href=#_ipnat></a></h4><div class=paragraph><p>A címfordításra vonatkozó szabályokat az <code>ipnat</code> paranccsal tudjuk betölteni. Az ilyen típusú szabályokat általában az <span class=filename>/etc/ipnat.rules</span> állományban találjuk. A részleteket lásd az <a href="https://man.freebsd.org/cgi/man.cgi?query=ipnat&amp;sektion=1&amp;format=html">ipnat(1)</a> man oldalán.</p></div><div class=paragraph><p>Amikor a címfordítás üzembe helyezése után meg akarjuk változtatni a címfordítás szabályait, elõször a címfordítás szabályait tartalmazó állományt módosítsuk, majd a belsõ címfordítási szabályok és a címfordítási táblázatban szereplõ aktív bejegyzések törléséhez futassuk le az <code>ipnat</code> parancsot a <code>-CF</code> beállítással.</p></div><div class=paragraph><p>A címfordítási szabályok újratöltését egy ehhez hasonló paranccsal tudjuk elvégezni:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># ipnat -CF -f /etc/ipnat.szabályok</span></code></pre></div></div><div class=paragraph><p>A címfordításhoz tartozó statisztikákat ezzel a paranccsal tudjuk lekérdezni:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># ipnat -s</span></code></pre></div></div><div class=paragraph><p>A címfordítási táblázatban pillanatnyilag szereplõ összerendeléseket a következõ paranccsal tudjuk listázni:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># ipnat -l</span></code></pre></div></div><div class=paragraph><p>A szabályok feldolgozásával és az aktív szabályokkal/bejegyzésekkel kapcsolatos információk részletezését így engedélyezhetjük:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># ipnat -v</span></code></pre></div></div></div><div class=sect3><h4 id=_a_címfordítási_szabályok>30.5.16. A címfordítási szabályok<a class=anchor href=#_a_címfordítási_szabályok></a></h4><div class=paragraph><p>A címfordítási szabályok nagyon rugalmasak és rengeteg olyan funkciót meg tudunk velük valósítani, ami az üzleti és otthoni felhasználók számára egyaránt hasznos.</p></div><div class=paragraph><p>Itt most a szabályok felépítését csak egyszerûsítve mutatjuk be, leginkább a nem üzleti környezetek tekintetében. A szabályok komplett formai leírását az <a href="https://man.freebsd.org/cgi/man.cgi?query=ipnat&amp;sektion=5&amp;format=html">ipnat(5)</a> man oldalán találjuk.</p></div><div class=paragraph><p>Egy címfordítási szabály tehát valahogy így néz ki:</p></div><div class="literalblock programlisting"><div class=content><pre>map INTERFÉSZ HELYI_IP_TARTOMÁNY -&gt; PUBLIKUS_CÍM</pre></div></div><div class=paragraph><p>A szabályt a <code>map</code> kulcsszó kezdi.</p></div><div class=paragraph><p>A <em>INTERFÉSZ</em> helyére az internet felé mutató külsõ interfész nevét írjuk be.</p></div><div class=paragraph><p>A <em>HELYI_IP_TARTOMÁNY</em> lesz az, amelyben a kliensek címeznek. Ez például a <code>192.168.1.0/24</code>.</p></div><div class=paragraph><p>A <em>PUBLIKUS_CÍM</em> lehet egy külsõ IP-cím vagy a <code>0/32</code> speciális kulcsszó, amellyel a <em>FELÜLET</em>-hez rendelt IP-címre hivatkozunk.</p></div></div><div class=sect3><h4 id=_hogyan_mûködik_a_hálózati_címfordítás>30.5.17. Hogyan mûködik a hálózati címfordítás<a class=anchor href=#_hogyan_mûködik_a_hálózati_címfordítás></a></h4><div class=paragraph><p>A publikus cél felé haladó csomag megérkezik a helyi hálózatról. Miután a kimenõ kapcsolatokra vonatkozó szabályok átengedik, a címfordítás kapja meg a szerepet és fentrõl lefelé haladva nekilát alkalmazni a saját szabályait, ahol az elsõ egyezõ szerint cselekszik. A címfordítás a szabályokat a csomaghoz tartozó interfészre és a forrás IP-címére illeszti. Amikor a csomag interfészének neve illeszkedik egy címfordítási szabályra, akkor ezután a csomag forrás (vagyis a helyi hálózaton belüli) IP-címérõl igyekszik eldönteni, hogy a szabály nyilának bal oldalán szereplõ tartományba esik-e. Ha erre is illeszkedik, akkor a forrás IP-címét átírjuk a <code>0/32</code> kulcsszó alapján felderített publikus IP-címre. A címfordító rutin ezt feljegyzi a saját belsõ táblázatába, így amikor a csomag visszatér az internetrõl, akkor képes lesz visszafordítani az eredeti belsõ IP-címére és feldolgozásra átadni a tûzfal szabályainak.</p></div></div><div class=sect3><h4 id=_a_címfordítás_engedélyezése>30.5.18. A címfordítás engedélyezése<a class=anchor href=#_a_címfordítás_engedélyezése></a></h4><div class=paragraph><p>A címfordítás életre keltéséhez a következõket kell beállítanunk az <span class=filename>/etc/rc.conf</span> állományban.</p></div><div class=paragraph><p>Elõször engedélyezzük a gépünknek, hogy közvetítsen forgalmat az interfészek között:</p></div><div class="literalblock programlisting"><div class=content><pre>gateway_enable=&#34;YES&#34;</pre></div></div><div class=paragraph><p>Minden alkalommal indítsuk el a címfordításért felelõs IPNAT programot:</p></div><div class="literalblock programlisting"><div class=content><pre>ipnat_enable=&#34;YES&#34;</pre></div></div><div class=paragraph><p>Adjuk meg az IPNAT számára a betöltendõ szabályokat:</p></div><div class="literalblock programlisting"><div class=content><pre>ipnat_rules=&#34;/etc/ipnat.rules&#34;</pre></div></div></div><div class=sect3><h4 id=_hálózati_címfordítás_nagyon_nagy_helyi_hálózatok_esetében>30.5.19. Hálózati címfordítás nagyon nagy helyi hálózatok esetében<a class=anchor href=#_hálózati_címfordítás_nagyon_nagy_helyi_hálózatok_esetében></a></h4><div class=paragraph><p>Az olyan helyi hálózatokban, ahol rengeteg PC található vagy több alhálózatot is tartalmaz, az összes privát IP-cím egyetlen publikus IP-címbe tömörítése igen komoly problémává tud dagadni és az azonos portok gyakori használata a helyi hálózatra kötött számítógépek között ütközéseket okoz. Két módon tudunk megoldást nyújtani erre a problémára.</p></div><div class=sect4><h5 id=_a_használható_portok_kiosztása>30.5.19.1. A használható portok kiosztása<a class=anchor href=#_a_használható_portok_kiosztása></a></h5><div class=paragraph><p>Egy normális címfordítási szabály valahogy így nézne ki:</p></div><div class="literalblock programlisting"><div class=content><pre>map dc0 192.168.1.0/24 -&gt; 0/32</pre></div></div><div class=paragraph><p>A fenti szabályban a csomag forrásportját az IPNAT változatlanul a feldolgozás után hagyja. Ha ehhez még hozzátesszük a <code>portmap</code> kulcsszót, akkor ezzel utasítani tudjuk az IPNAT-ot, hogy csak az adott tartományban képezze le a forrásportokat. Például a következõ szabály hatására az IPNAT a forrásportokat egy adott tartományon belül fogja módosítani:</p></div><div class="literalblock programlisting"><div class=content><pre>map dc0 192.168.1.0/24 -&gt; 0/32 portmap tcp/udp 20000:60000</pre></div></div><div class=paragraph><p>Ha viszont még inkább meg akarjuk könnyíteni a dolgunkat, akkor itt egyszerûen csak adjuk meg az <code>auto</code> kulcsszót, amellyel az IPNAT önmagától megállapítja, hogy milyen portokat tud használni:</p></div><div class="literalblock programlisting"><div class=content><pre>map dc0 192.168.1.0/24 -&gt; 0/32 portmap tcp/udp auto</pre></div></div></div><div class=sect4><h5 id=_több_publikus_cím_használata>30.5.19.2. Több publikus cím használata<a class=anchor href=#_több_publikus_cím_használata></a></h5><div class=paragraph><p>Minden nagyobb helyi hálózat esetében elérkezünk ahhoz a ponthoz, ahol már egyetlen publikus cím nem elég. Ha több publikus IP-címmel is rendelkezünk, akkor ezekbõl a címekbõl egy "közös készletet" hozhatunk létre, amibõl majd az IPNAT válogathat miközben a csomagok címeit átírja kifelé menetben.</p></div><div class=paragraph><p>Például ahelyett, hogy a csomagokat egyetlen publikus IP-címre képeznénk le, ahogy itt tesszük:</p></div><div class="literalblock programlisting"><div class=content><pre>map dc0 192.168.1.0/24 -&gt; 204.134.75.1</pre></div></div><div class=paragraph><p>A hálózati maszk segítségével meg tudjuk adni IP-címek egy tartományát is:</p></div><div class="literalblock programlisting"><div class=content><pre>map dc0 192.168.1.0/24 -&gt; 204.134.75.0/255.255.255.0</pre></div></div><div class=paragraph><p>CIDR-jelöléssel:</p></div><div class="literalblock programlisting"><div class=content><pre>map dc0 192.168.1.0/24 -&gt; 204.134.75.0/24</pre></div></div></div></div><div class=sect3><h4 id=_a_portok_átirányítása>30.5.20. A portok átirányítása<a class=anchor href=#_a_portok_átirányítása></a></h4><div class=paragraph><p>Gyakran elõfordul, hogy van webszerverünk, levelezõ szerverünk, adatbázis szerverünk és névszerverünk, melyek a helyi hálózat különbözõ gépein futnak. Ebben az esetben a szerverekhez tartozó forgalmat is fordítanunk kell, illetve valamilyen módon a bejövõ forgalmat is át kell irányítanunk a helyi hálózat megfelelõ gépeihez. Az IPNAT ezt a gondot a hálózati címfordítás átirányítást támogató funkcióival szünteti meg. Tegyük fel, hogy a <code>10.0.10.25</code> belsõ címen van egy webszerverünk, amelyhez a <code>20.20.20.5</code> publikus IP tartozik. Ilyenkor a következõ szabályt adjuk meg:</p></div><div class="literalblock programlisting"><div class=content><pre>rdr dc0 20.20.20.5/32 port 80 -&gt; 10.0.10.25 port 80</pre></div></div><div class=paragraph><p>vagy:</p></div><div class="literalblock programlisting"><div class=content><pre>rdr dc0 0.0.0.0/0 port 80 -&gt; 10.0.10.25 port 80</pre></div></div><div class=paragraph><p>Így tudjuk beállítani a <code>10.0.10.33</code> címmel rendelkezõ névszervert a kintrõl érkezõ névfeloldási kérések fogadására:</p></div><div class="literalblock programlisting"><div class=content><pre>rdr dc0 20.20.20.5/32 port 53 -&gt; 10.0.10.33 port 53 udp</pre></div></div></div><div class=sect3><h4 id=_az_ftp_és_a_címfordítás>30.5.21. Az FTP és a címfordítás<a class=anchor href=#_az_ftp_és_a_címfordítás></a></h4><div class=paragraph><p>Az FTP egy olyan õskövület, amely még az internet egy régi korszakából maradt fenn, amikor az egyetemek között még bérelt vonal létezett és az FTP szolgált a kutatók közt az állományok megosztására. Ez még abban az idõben történt, amikor a biztonság egyáltalán nem volt lényeges szempont. Az évek elõrehaladtával az FTP protokoll beleivódott a feltörekvõ internet gerincébe és a titkosítatlanul küldött azonosítóival és jelszavaival továbbra is ugyanolyan védtelen maradt. Az FTP két változatban, aktív és passzív módban képes mûködni. Az eltérés kettejük között az adatcsatorna megállapításában van. A passzív mód sokkal biztonságosabb, mivel ilyenkor az adatcsatornát az FTP kapcsolatot kezdeményezõ állítja be. Az FTP különbözõ módjainak magyarázatát és a köztük levõ különbséget a <a href=http://www.slacksite.com/other/ftp.html>http://www.slacksite.com/other/ftp.html</a> címen ismerhetjük meg részleteiben (angolul).</p></div><div class=sect4><h5 id=_az_ipnat_szabályai>30.5.21.1. Az IPNAT szabályai<a class=anchor href=#_az_ipnat_szabályai></a></h5><div class=paragraph><p>Az IPNAT egy speciális beépített FTP proxyval rendelkezik, amelyre a hálózati címfordítás leképezései között hivatkozhatunk. Képes figyelni az összes aktív vagy passzív FTP kapcsolathoz tartozó kimenõ kérést és ezekhez dinamikusan létrehozni olyan ideiglenes szûrési szabályokat, amelyek valóban csak az adatcsatornához felhasznált portokat tartalmazzák. Ezzel ki tudjuk küszöbölni az FTP azon káros hatását a tûzfalra nézve, hogy egyszerre túlságosan sok magasabb tartománybeli port legyen nyitva.</p></div><div class=paragraph><p>Ez a szabály a belsõ hálózat összes FTP forgalmát lekezeli:</p></div><div class="literalblock programlisting"><div class=content><pre>map dc0 10.0.10.0/29 -&gt; 0/32 proxy port 21 ftp/tcp</pre></div></div><div class=paragraph><p>Ez a szabály pedig az átjáróról érkezõ FTP forgalommal bírkózik meg:</p></div><div class="literalblock programlisting"><div class=content><pre>map dc0 0.0.0.0/0 -&gt; 0/32 proxy port 21 ftp/tcp</pre></div></div><div class=paragraph><p>Ez a szabály kezeli a belsõ hálózatról érkezõ összes nem FTP típusú forgalmat:</p></div><div class="literalblock programlisting"><div class=content><pre>map dc0 10.0.10.0/29 -&gt; 0/32</pre></div></div><div class=paragraph><p>Az FTP leképzésére vonatkozó szabály a szokásos leképzési szabály elé kerül. Az összes csomag fentrõl haladva az elsõ illeszkedõ szabály alapján kerül feldolgozásra. Elõször az interfész nevét vizsgáljuk, majd a belsõ hálózatbeli forrás IP-t, végül azt, hogy a csomag egy FTP kapcsolat része. Ha minden paraméterében megfelel, akkor az FTP proxy készít egy ideiglenes szûrési szabályt hozzá, amellyel az FTP kapcsolathoz tartozó csomagok mind a két irányba képesek lesznek vándorolni, természetesen a címfordítással együtt. Az összes többi bentrõl érkezõ csomag átlép ezen a szabályon és megáll a harmadiknál, ahol az interfésznek és forrás IP-nek megfelelõen átfordítjuk a címét.</p></div></div><div class=sect4><h5 id=_az_ipnat_szûrési_szabályai_ftp_re>30.5.21.2. Az IPNAT szûrési szabályai FTP-re<a class=anchor href=#_az_ipnat_szûrési_szabályai_ftp_re></a></h5><div class=paragraph><p>Az FTP esetében csak egyetlen szûrési szabályra van szükségünk a hálózati címfordításba épített FTP proxy használatához.</p></div><div class=paragraph><p>FTP proxy nélkül az alábbi három szabály kellene:</p></div><div class="literalblock programlisting"><div class=content><pre># Kifelé engedélyezzük a belsõ gépek FTP elérést az internet irányába,
# aktív és passzív módokban.
pass out quick on rl0 proto tcp from any to any port = 21 flags S keep state

# Kifelé engedélyezzük a passzív módhoz tartozó magasabb tartománybeli
# adatcsatornákat.
pass out quick on rl0 proto tcp from any to any port &gt; 1024 flags S keep state

# Aktív módban beengedjük az FTP szervertõl érkezõ adatcsatornát.
pass in quick on rl0 proto tcp from any to any port = 20 flags S keep state</pre></div></div></div></div></div><div class=sect2><h3 id=firewalls-ipfw>30.6. IPFW<a class=anchor href=#firewalls-ipfw></a></h3><div class=paragraph><p>Az IPFIREWALL (IPFW) a FreeBSD által támogatott tûzfalazó alkalmazás, melyet a FreeBSD Projektben résztvevõ önkéntesek fejlesztettek ki és tartanak karban. Régi típusú, állapottartás nélküli szabályokat használ, és az itt használatos szabályírási technikát "egyszerû állapottartó megoldásnak" nevezzük.</p></div><div class=paragraph><p>Az IPFW szabvány FreeBSD-ben levõ, mintaként szolgáló szabályrendszere (ez az <span class=filename>/etc/rc.firewall</span> és <span class=filename>/etc/rc.firewall6</span> állományokban található meg) annyira egyszerû, hogy komolyabb módosítások nélkül nem ajánlatos használni. Ez a példa nem tartalmaz állapottartó szûrést, ami viszont a legtöbb esetben kívánatos lenne, ezért ezt a szakaszt nem erre alapozzuk.</p></div><div class=paragraph><p>Az IPFW állapottartás nélküli szabályainak felépítésében olyan technikailag kifinomult leválogatási képességek bújnak meg, amelyek jócskán meghaladják az átlagos tûzfalépítõk tudását. Az IPFW elsõsorban olyan szakemberek vagy szakmailag elõrehaladott felhasználók számára készült, akiknek speciális csomagszûrési igényeik vannak. A különbözõ protokollok használatának és a hozzájuk tartozó fejlécinformációk mindenre kiterjedõ ismerete szinte nélkülözhetetlen az IPFW valódi erejének kihasználásához. Ez a szint azonban túlmutat a kézikönyv ezen szakaszának keretein.</p></div><div class=paragraph><p>Az IPFW hét komponensbõl épül fel, melyek közül az elsõdleges a rendszermag tûzfalazásért felelõs szabályfeldolgozó és a hozzá tartozó csomagnyilvántartás, majd ezt követi a naplózás, a hálózati címfordítást aktiváló <code>divert</code> szabály, valamint a komolyabb célok megvalósítására alkalmas lehetõségek: a forgalom korlátozásáért felelõs dummynet, a továbbküldésre alkalmas <code>fwd rule</code> szabály, a hálózati hidak támogatása, illetve az ipstealth. Az IPFW egyaránt használható IPv4 és IPv6 esetén.</p></div><div class=sect3><h4 id=firewalls-ipfw-enable>30.6.1. Az IPFW engedélyezése<a class=anchor href=#firewalls-ipfw-enable></a></h4><div class=paragraph><p>Az IPFW az alap FreeBSD telepítésben külön, futás idõben betölthetõ modulként érhetõ el. Ha az <span class=filename>rc.conf</span> állományban megadjuk a <code>firewall_enable="YES"</code> beállítást, akkor a rendszer indulásakor ezt a modult dinamikusan betölti. Az IPFW-t csak akkor kell a FreeBSD rendszermagjába beépítenünk, ha szükségünk van a címfordítási funkciójára is.</p></div><div class=paragraph><p>Ha tehát az <span class=filename>rc.conf</span> állományban megadtuk a <code>firewall_enable="YES"</code> sort és újraindítottuk a számítógépünket, akkor a következõ fehérrel kiemelt üzenet fog megjelenni a rendszerindítás során:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>ipfw2 initialized, divert disabled, rule-based forwarding disabled, default to deny, logging disabled</code></pre></div></div><div class=paragraph><p>A "logging disabled" üzenetbõl kiderül, hogy a modul nem végez naplózást. A naplózást és a hozzá tartozó részletesség szintjét úgy tudjuk beállítani, ha az <span class=filename>/etc/sysctl.conf</span> állományba felvesszük a következõ sorokat, amivel a következõ indításkor már mûködni fog:</p></div><div class="literalblock programlisting"><div class=content><pre>net.inet.ip.fw.verbose=1
net.inet.ip.fw.verbose_limit=5</pre></div></div></div><div class=sect3><h4 id=firewalls-ipfw-kernel>30.6.2. A rendszermag beállításai<a class=anchor href=#firewalls-ipfw-kernel></a></h4><div class=paragraph><p>Ha nem akarjuk kihasználni az IPFW által felkínált címfordítási lehetõségeket, akkor egyáltalán nem szükséges a FreeBSD rendszermagjába belefordítani a támogatását. Ezért az alábbiakat csak kiegészítõ információként tüntettük fel.</p></div><div class="literalblock programlisting"><div class=content><pre>options    IPFIREWALL</pre></div></div><div class=paragraph><p>Ez a beállítás engedélyezi az IPFW használatát a rendszermag részeként.</p></div><div class="literalblock programlisting"><div class=content><pre>options    IPFIREWALL_VERBOSE</pre></div></div><div class=paragraph><p>Ezzel és a <code>log</code> kulcsszóval tudjuk az IPFW szabályain keresztülhaladó csomagokat naplózni.</p></div><div class="literalblock programlisting"><div class=content><pre>options    IPFIREWALL_VERBOSE_LIMIT=5</pre></div></div><div class=paragraph><p>Ez az érték korlátozza a <a href="https://man.freebsd.org/cgi/man.cgi?query=syslogd&amp;sektion=8&amp;format=html">syslogd(8)</a> segítségével naplózott azonos bejegyzések maximális számát. Ezt a beállítást olyan veszélyes környezetekben érdemes használnunk, ahol naplózni akarunk. Segítségével meg tudjuk akadályozni, hogy a rendszernapló elárasztásával megakasszák a rendszerünket.</p></div><div class="literalblock programlisting"><div class=content><pre>options    IPFIREWALL_DEFAULT_TO_ACCEPT</pre></div></div><div class=paragraph><p>Ezen beállítás hatására a tûzfal alapértelmezés szerint mindent átenged, ami általában akkor jöhet jól, amikor elõször beállítjuk a tûzfalat.</p></div><div class="literalblock programlisting"><div class=content><pre>options    IPDIVERT</pre></div></div><div class=paragraph><p>Ezzel a beállítással engedélyezzük a címfordítás használatát.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Ha nem adjuk meg az IPFIREWALL_DEFAULT_TO_ACCEPT beállítást, vagy ha nem engedélyezzük a bejövõ csomagokat, akkor a gépünkre semmilyen csomag nem lesz képes bejutni, illetve onnan kijutni.</p></div></td></tr></tbody></table></div></div><div class=sect3><h4 id=firewalls-ipfw-rc>30.6.3. Az <span class=filename>/etc/rc.conf</span> beállításai<a class=anchor href=#firewalls-ipfw-rc></a></h4><div class=paragraph><p>Így tudjuk engedélyezni a tûzfalat:</p></div><div class="literalblock programlisting"><div class=content><pre>firewall_enable=&#34;YES&#34;</pre></div></div><div class=paragraph><p>A FreeBSD-hez mellékelt alapértelmezett tûzfaltípusok közül az <span class=filename>/etc/rc.firewall</span> állomány átolvasásával tudunk választani, és megadni az alábbi helyett:</p></div><div class="literalblock programlisting"><div class=content><pre>firewall_type=&#34;open&#34;</pre></div></div><div class=paragraph><p>A következõ értékek állnak rendelkezésünkre:</p></div><div class=ulist><ul><li><p><code>open</code> - átengedi az összes forgalmat</p></li><li><p><code>client</code> - csak ezt a gépet védi</p></li><li><p><code>simple</code> - az egész hálózatot védi</p></li><li><p><code>closed</code> - a helyi interfész kivételével minden IP alapú forgalmat tilt</p></li><li><p><code>UNKNOWN</code> - tiltja a tûzfal szabályainak betöltését</p></li><li><p><span class=filename>állománynév</span> - a tûzfal szabályait tartalmazó állomány abszolút elérési útvonala</p></li></ul></div><div class=paragraph><p>Két különbözõ módon lehet betölteni a saját ipfw szabályainkat. Az egyik közülük, ha a <code>firewall_type</code> változóban megadjuk a <em>tûzfal szabályait</em> tartalmazó állomány abszolút elérési útvonalát, az <a href="https://man.freebsd.org/cgi/man.cgi?query=ipfw&amp;sektion=8&amp;format=html">ipfw(8)</a> parancssori beállításai nélkül. Az alábbi példában egy olyan egyszerû szabályrendszert láthatunk, amely blokkolja az összes bejövõ és kimenõ forgalmat:</p></div><div class="literalblock programlisting"><div class=content><pre>add deny in
add deny out</pre></div></div><div class=paragraph><p>Másrészrõl az <code>firewall_script</code> változóban is megadhatjuk azt a szkriptet, amelyben a rendszerindítás során meghívjuk <code>ipfw</code> parancsot. Az iménti szabályrendszert az alábbi szkripttel tudjuk kiváltani:</p></div><div class="literalblock programlisting"><div class=content><pre>#!/bin/sh

ipfw -q flush

ipfw add deny in
ipfw add deny out</pre></div></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Ha a <code>firewall_type</code> változó <code>client</code> vagy <code>simple</code> értékét használjuk, akkor az <span class=filename>/etc/rc.firewall</span> állományban található alapértelmezett szabályokat érdemes átvizsgálnunk, hogy kellõen illeszkednek-e az adott géphez. Hozzátennénk, hogy a fejezetben szereplõ példák azt feltételezik, hogy a <code>firewall_script</code> értéke az <span class=filename>/etc/ipfw.rules</span> állomány.</p></div></td></tr></tbody></table></div><div class=paragraph><p>A naplózás így engedélyezhetõ:</p></div><div class="literalblock programlisting"><div class=content><pre>firewall_logging=&#34;YES&#34;</pre></div></div><div class="admonitionblock warning"><table><tbody><tr><td class=icon><i class="fa icon-warning" title=Warning></i></td><td class=content><div class=paragraph><p>A <code>firewall_logging</code> változó egyedül csak annyit tesz, hogy beállítja a <code>net.inet.ip.fw.verbose</code> sysctl változónak az <code>1</code> értéket (lásd <a href=#firewalls-ipfw-enable>Az IPFW engedélyezése</a>). A napló korlátozására nincs külön változó az <span class=filename>rc.conf</span> állományon belül, de az <span class=filename>/etc/sysctl.conf</span> állomány segítségével és manuálisan be tudjuk állítani a hozzá tartozó változót:</p></div><div class="literalblock programlisting"><div class=content><pre>net.inet.ip.fw.verbose_limit=5</pre></div></div></td></tr></tbody></table></div><div class=paragraph><p>Amennyiben a gépünk átjáróként viselkedik, tehát a <a href="https://man.freebsd.org/cgi/man.cgi?query=natd&amp;sektion=8&amp;format=html">natd(8)</a> segítségével címfordítást végez, a <a href=./#network-natd>Hálózati címfordítás</a>ban olvashatunk utána, hogy ehhez az <span class=filename>/etc/rc.conf</span> állományban milyen beállításokat kell megadnunk.</p></div></div><div class=sect3><h4 id=firewalls-ipfw-cmd>30.6.4. Az IPFW parancs<a class=anchor href=#firewalls-ipfw-cmd></a></h4><div class=paragraph><p>Normál esetben az <code>ipfw</code> parancs használatos arra, hogy a tûzfal mûködése közben az aktív belsõ szabályai közé vegyünk fel vagy töröljünk közülük manuálisan bejegyzéseket. Ennek a módszernek az egyedüli hátránya, hogy az így végrehajtott módosítások el fognak veszni a rendszer leállításával. Itt inkább azt a megoldást javasoljuk, hogy az összes szabályt tegyük bele egy állományba és a rendszerindítás során ezt töltsük be, majd ha változtatni akarunk a tûzfalon, akkor ezt az állományt módosítsuk és a régiek törlésével töltsük be újra az egész szabályrendszert.</p></div><div class=paragraph><p>Az <code>ipfw</code> parancs mellesleg remekül használható a jelenleg futó tûzfalszabályok megjelenítésére a konzolon. Az IPFW nyilvántartásában az egyes szabályokhoz dinamikusan jönnek létre számlálók, amelyek a rá illeszkedõ csomagokat számolják. A tûzfal tesztelése folyamán a szabályok és hozzá tartozó számlálók lekérdezése a megfelelõ mûködés ellenõrzésének egyik lehetséges módja.</p></div><div class=paragraph><p>A szabályokat így tudjuk egymás után felsoroltatni:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># ipfw list</span></code></pre></div></div><div class=paragraph><p>A szabályokat így tudjuk az utolsó illeszkedésük idejével együtt megjeleníteni:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># ipfw -t list</span></code></pre></div></div><div class=paragraph><p>A következõ példában a nyilvántartási információkat kérdezzük le, ekkor a szabályok mellett az illeszkedõ csomagok száma is láthatóvá válik. Az elsõ sorban a szabály száma szerepel, majd ezt követi rendre az illeszkedõ kimenõ és bejövõ csomagok mennyisége, valamint végül maga a szabály.</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># ipfw -a list</span></code></pre></div></div><div class=paragraph><p>A statikus szabályok mellett a dinamikusakat így lehet kilistázni:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># ipfw -d list</span></code></pre></div></div><div class=paragraph><p>A lejárt dinamikus szabályokat is meg tudjuk nézni:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># ipfw -d -e list</span></code></pre></div></div><div class=paragraph><p>A számlálók nullázása:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># ipfw zero</span></code></pre></div></div><div class=paragraph><p>Csak a <em>SZÁM</em> sorszámú szabályhoz tartozó számlálók nullázása:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># ipfw zero SZÁM</span></code></pre></div></div></div><div class=sect3><h4 id=firewalls-ipfw-rules>30.6.5. Szabályrendszerek az IPFW-ben<a class=anchor href=#firewalls-ipfw-rules></a></h4><div class=paragraph><p>Az IPFW esetében a szabályrendszer olyan szabályokból áll, amelyek a csomagokról tartalmuk alapján eldöntik, hogy át kell engedni vagy vissza kell tartani. A gépek közt két irányban áramló csomagok egy munkamenet alapú társalgást képeznek. A tûzfalhoz tartozó szabályrendszer egyaránt feldolgozza a internetrõl a hálózatunk felé igyekvõ csomagokat, illetve a hálózatunk ezekre adott válaszait. Az egyes TCP/IP szolgáltatásokat (mint például telnet, www, levelezés stb.) a hozzájuk tartozó protokol és szabványos (fogadó) portszám írja le. Ezekre a forrásról általában valamilyen nem szabványos (magasabb értékû) portról érkeznek csomagok. Ekkor a kommunikáció összes paramétere (vagyis a portok és címek) bármelyike alapján definiálhatunk blokkolást vagy továbbengedést leíró szabályokat.</p></div><div class=paragraph><p>Amikor egy csomag eléri a tûzfalat, a szabályrendszer elsõ szabályával kerül összehasonlításra és amíg nem illeszkedik valamelyikre, addig lefut rá a többi szabály is fentrõl lefelé egyesével, a sorszámuknak megfelelõ növekvõ sorrendben. Ha a csomag megfelel valamelyik szabály leválogatási paramétereinek, akkor a benne megnevezett cselekvés zajlik le, és számára a feldolgozás befejezõdik. Ezt a viselkedést neveztük "az elsõ illeszkedés nyer" típusú keresésnek. Amennyiben a csomag egyetlen szabályra sem illeszkedik, akkor az IPFW 65535-ös sorszámú állandó szabálya fogja elcsípni, amely feladata szerint eldobja az összes hozzá beérkezõ csomagot anélkül, hogy bármit is válaszolna a csomag feladójának.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>A keresés a <code>count</code>, <code>skipto</code> és <code>tee</code> szabályok után még folytatódik.</p></div></td></tr></tbody></table></div><div class=paragraph><p>Az itt szereplõ utasítások különbözõ állapottartásra vonatkozó opciókat, például a <code>keep state</code>, <code>limit</code>, <code>in</code>, <code>out</code> és <code>via</code> kulcsszavakat tartalmazó szabályokon alapulnak. Lényegében ezt tekinthetjük az inkluzív típusú tûzfalak kiindulási alapjaként.</p></div><div class="admonitionblock warning"><table><tbody><tr><td class=icon><i class="fa icon-warning" title=Warning></i></td><td class=content><div class=paragraph><p>A tûzfal szabályainak beállítása során nem árt óvatosnak lennünk, mert figyelmetlenségünk révén könnyen kizárathatjuk magunkat a gépünkrõl.</p></div></td></tr></tbody></table></div><div class=sect4><h5 id=firewalls-ipfw-rules-syntax>30.6.5.1. A szabályok felépítése<a class=anchor href=#firewalls-ipfw-rules-syntax></a></h5><div class=paragraph><p>Az itt bemutatásra kerülõ szabályok felépítését csak olyan mértékig részletezzük, ami elengedõ a szabványos inkluzív típusú tûzfalak kialakításához. A szabályok felépítésének pontos leírását az <a href="https://man.freebsd.org/cgi/man.cgi?query=ipfw&amp;sektion=8&amp;format=html">ipfw(8)</a> man oldalán találhatjuk meg.</p></div><div class=paragraph><p>A szabályok kulcsszavakat tartalmaznak. Ezeket a kulcsszavakat soronként egy elõre rögzített sorrendben kell szerepeltetni. A kulcsszavakat a szövegben kiemeltük. Bizonyos kulcsszavakhoz további opciókhoz is tartozhatnak, amelyek gyakran maguk is kulcsszavak és szintén további opciókat tartalmazhatnak.</p></div><div class=paragraph><p>A <code>#</code> egy megjegyzés kezdetét jelzi, mely egyaránt megjelenhet egy külön sorban, vagy egy szabályt tartalmazó sor végén. Az üres sorok nem vesznek részt a feldolgozásban.</p></div><div class=paragraph><p><em>PARANCS SZABÁLY_SZÁM CSELEKVÉS NAPLÓZÁS SZûRÉS ÁLLAPOTTARTÁS</em></p></div><div class=sect5><h6 id=_parancs>30.6.5.1.1. PARANCS<a class=anchor href=#_parancs></a></h6><div class=paragraph><p>Minden új szabály elõttt az <span class=parameter>add</span> (mint hozzáadás) parancsnak kell szerepelni, amellyel a belsõ táblázatba tudjuk felvenni.</p></div></div><div class=sect5><h6 id=_szabály_szám>30.6.5.1.2. SZABÁLY_SZÁM<a class=anchor href=#_szabály_szám></a></h6><div class=paragraph><p>A szabályokhoz mindig tartozik egy sorszám is.</p></div></div><div class=sect5><h6 id=_cselekvés_2>30.6.5.1.3. CSELEKVÉS<a class=anchor href=#_cselekvés_2></a></h6><div class=paragraph><p>A szabályhoz az alábbi cselekvések valamelyike kapcsolható, amely akkor hajtódik végre, amikor a csomag megfelel a hozzá tartozó szûrési feltételeknek.</p></div><div class=paragraph><p><span class=parameter>allow | accept | pass | permit</span></p></div><div class=paragraph><p>A fentiek közül mindegyik ugyanazt jelenti, vagyis hatásukra az illeszkedõ csomag kilép a tûzfalból. Ez a szabály megállítja a keresést.</p></div><div class=paragraph><p><span class=parameter>check-state</span></p></div><div class=paragraph><p>A csomagot a dinamikus szabályokat tároló táblázattal veti össze. Ha itt egyezést talál, akkor végrehajtja az egyezõ dinamikus szabályhoz tartozó cselekvést, minden más esetben továbblép a következõ szabályra. Ennek a szabálynak nincs illeszthetõ paramétere. Ha a szabályrendszerben nem szerepel ilyen, akkor a dinamikus szabályok vizsgálatát az elsõ <code>keep-state</code> vagy <code>limit</code> használatánál vonja be a rendszer.</p></div><div class=paragraph><p><span class=parameter>deny | drop</span></p></div><div class=paragraph><p>Mind a két szó ugyanarra utal, vagyis a szabályra illeszkedõ csomagokat el kell dobni. Ebben az esetben a keresés befejezõdik.</p></div></div><div class=sect5><h6 id=_naplózás>30.6.5.1.4. NAPLÓZÁS<a class=anchor href=#_naplózás></a></h6><div class=paragraph><p><span class=parameter>log</span> vagy <span class=parameter>logamount</span></p></div><div class=paragraph><p>Amikor egy csomag egy <code>log</code> kulcsszót tartalmazó szabályra illeszkedik, akkor a rendszernaplóban egy üzenet keletkezik a <code>security</code> (biztonság) funkción keresztül. A naplóba ténylegesen csak akkor kerül bele az üzenet, ha az adott szabály még nem haladta meg a hozzá tartozó <code>logamount</code> paraméter értékét. Ha ezt nem adtuk meg, akkor az itt érvényes korlát a <code>net.inet.ip.fw.verbose_limit</code> sysctl változóból fog származni. A nulla érték mind a két esetben megszünteti ezt a korlátozást. Ha elértük a korlátot, akkor a naplózást úgy tudjuk újra engedélyezni, ha töröljük a naplózáshoz tartozó számláló értékét, lásd az <code>ipfw reset log</code> parancsot.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>A naplózás mindig az összes paraméter illeszkedésének ellenõrzése után történik, de még a cselekvés (accept, deny) elvégzése elõtt. Teljesen rajtunk múlik, hogyan milyen szabályokat naplózunk.</p></div></td></tr></tbody></table></div></div><div class=sect5><h6 id=_szûrés_2>30.6.5.1.5. SZûRÉS<a class=anchor href=#_szûrés_2></a></h6><div class=paragraph><p>Ebben a szakaszban azok a kulcsszavak találhatóak, amelyek segítségével a csomagok különbözõ tulajdonságait tudjuk megvizsgálni és eldönteni, hogy illeszkedik-e a szabályra vagy sem. A következõ általános tulajdonságokat tudjuk megvizsgálni, ebben a kötött sorrendben:</p></div><div class=paragraph><p><span class=parameter>udp | tcp | icmp</span></p></div><div class=paragraph><p>Bármilyen más olyan protokoll is megadható, amely megtalálható az <span class=filename>/etc/protocols</span> állományban. Ezzel adjuk a csomaghoz tartozó protokollt. Használata kötelezõ.</p></div><div class=paragraph><p><span class=parameter>from <em>forrás</em> to <em>cél</em></span></p></div><div class=paragraph><p>Mind a <code>from</code> és <code>to</code> kulcsszavak IP-címek illesztésére alkalmasak. A szabályoknak tartalmazniuk kell a <em>forrás</em> ÉS a <em>cél</em> paramétereket is. Az <code>any</code> egy olyan kulcsszó, amely tetszõleges IP-címre illeszkedik. A <code>me</code> pedig egy olyan speciális kulcsszó, amely a tûzfalat mûködtetõ FreeBSD-s gép (tehát ez a gép) adott interfészhez tartozó IP-címét jelöli, mint ahogy a <code>from me to any</code>, <code>from any to me</code>, <code>from 0.0.0.0/0 to any</code>, <code>from any to 0.0.0.0/0</code>, <code>from 0.0.0.0 to any</code>, <code>from any to 0.0.0.0</code> vagy <code>from me to 0.0.0.0</code> paraméterekben. Az IP-címek numerikus pontozott formában a hálózati maszk hosszával együtt (CIDR-jelöléssel), vagy egyszerûen csak pontozott formában adhatóak meg. A hálózati maszkok megállapításában a <a class=package href=https://cgit.freebsd.org/ports/tree/net-mgmt/ipcalc/>net-mgmt/ipcalc</a> port lehet segítségünkre. Errõl bõvebb információkat a segédprogram honlapján, a <a href=http://jodies.de/ipcalc>http://jodies.de/ipcalc</a> címen találhatunk (angolul).</p></div><div class=paragraph><p><span class=parameter>port <em>szám</em></span></p></div><div class=paragraph><p>A portszámokat is ismerõ protokollok esetében (mint például a TCP vagy UDP) adhatjuk meg. Fontos, hogy itt annak a szolgáltatásnak a portszámát adjuk meg, amelyre a szabály vonatkozik. A szolgáltatás (az <span class=filename>/etc/services</span> állományból származó) nevét is megadhatjuk a port száma helyett.</p></div><div class=paragraph><p><span class=parameter>in | out</span></p></div><div class=paragraph><p>A beérkezõ valamint a kimenõ csomagokat adhatjuk meg ezen a módon. Itt az <code>in</code> és <code>out</code> kulcsszavak, melyeket kötelezõ megadni a szabály részeként.</p></div><div class=paragraph><p><span class=parameter>via <em>interfész</em></span></p></div><div class=paragraph><p>Név szerint az adott interfészen keresztül haladó csomagokat tudjuk szûrni. A <code>via</code> kulcsszó hatására a használt interfész is számítani fog a csomag feldolgozása során.</p></div><div class=paragraph><p><span class=parameter>setup</span></p></div><div class=paragraph><p>Ez a kulcsszó a TCP csomagok esetében a kapcsolatok felépítésére vonatkozó kéréseket segít beazonosítani.</p></div><div class=paragraph><p><span class=parameter>keep-state</span></p></div><div class=paragraph><p>Ez egy kötelezõ kulcsszó. Feldolgozásakor a tûzfal létrehoz dinamikus szabályt, amely alapértelmezés szerint az egyazon protokollt használó forrás és cél IP/port párosok közti kétirányú forgalomra fog automatikusan illeszkedni.</p></div><div class=paragraph><p><span class=parameter>limit {<em>forráscím</em> | <em>forrásport</em> | <em>célcím</em> | <em>célport</em>}</span></p></div><div class=paragraph><p>A tûzfal csak <em>N</em> darab, a szabálynak megfelelõ azonos paraméterû kapcsolatot fog átengedi. Itt egy vagy több forrás- és célcím valamint forrás- és célport adható meg. A <code>limit</code> és a <code>keep-state</code> egy szabályon belül nem használható. A <code>limit</code> ugyanazokat az állapottartó funkciókat képviseli, mint a <code>keep-state</code>, csak a saját kiegészítéseivel megtoldva.</p></div></div></div><div class=sect4><h5 id=_állapottartás>30.6.5.2. ÁLLAPOTTARTÁS<a class=anchor href=#_állapottartás></a></h5><div class=paragraph><p>Az állapottartó szûrés a kétirányú csomagváltásokat egy létrejött kapcsolatba sorolja. Olyan vizsgálatokat végez, amivel képes megállapítani, hogy a csomag küldõje és címzettje között kialakult kommunikáció követ-e valamilyen kétirányú csomagküldésre érvényes folyamatot. Az így felállított sablontól eltérõ összes csomag hamisnak minõsül és automatikusan eldobásra kerül.</p></div><div class=paragraph><p>A <code>check-state</code> segítségével ellenõrizhetjük, hogy az adott csomag a IPFW szerint megfelel-e valamelyik dinamikusan leképzett szabálynak. Ha egyezik valamelyikõjükkel, akkor a csomag a tûzfalból kilépve folytatja útját és a kommunikációban soron következõ csomag számára létrejön egy másik dinamikus szabály. Ha nincs egyezés, akkor csomag feldolgozása a szabályrendszer következõ szabályánál folytatódik.</p></div><div class=paragraph><p>A dinamikus szabályokat kezelõ rutin sebezhetõ, mivel ha egyszerre nagy mennyiségû SYN csomagot küldünk, akkor olyan sok dinamikus bejegyzés keletkezik, hogy egyszerûen kifogyunk a rendelkezésre álló erõforrásokból. A FreeBSD fejlesztõi azonban az ilyen természetû támadások kivédésére is felkészítették, és kialakították belõle a <code>limit</code> opciót. Alkalmazásával le tudjuk korlátozni az egyszerre folyó párhuzamos kapcsolatok számát a forrás vagy a cél a <code>limit</code> paraméternél megadott mezõinek és a csomag IP-címe alapján. Így az adott szabályhoz és IP-címhez csak elõre rögzített mennyiségû nyitott állapotú dinamikus szabály létezhet egy idõben. Ha ezt a korlátot átlépjük, a csomag eldobódik.</p></div></div><div class=sect4><h5 id=_a_tûzfal_üzeneteinek_naplózása>30.6.5.3. A tûzfal üzeneteinek naplózása<a class=anchor href=#_a_tûzfal_üzeneteinek_naplózása></a></h5><div class=paragraph><p>A naplózás elõnyei nyilvánvalóak. Ha engedélyezzük, aktiválása után képesek leszünk olyan információknak utánanézni, mint például milyen csomagokat dobtunk el, honnan érkeztek, hova tartottak. Ez egy komoly fegyverünk lehet a potenciális támadókkal szemben.</p></div><div class=paragraph><p>Azonban hiába engedélyezzünk önmagában a naplózást, attól az IPFW még saját magától nem fog naplózást elõíró szabályokat gyártani. A tûzfal karbantartóinak maguknak kell eldöntenie, hogy a szabályrendszerben mely szabályokhoz tartozzon naplózás, nekik kell felvenni ezekhez a <code>log</code> kulcsszót. Általában csak az eldobással járó <code>deny</code> típusú szabályokat vagy a bejövõ ICMP pingeket szokták naplózni. Gyakran úgy oldják meg ezt, hogy a szabályrendszer utolsó szabályaként lemásolják az <code>ipfw</code> alapértelmezett "mindent eldobunk" szabályát és a naplózást adják meg benne. Ezen a módon fény derül azokra a csomagokra, amelyek a szabályrendszerben semmire sem illeszkedtek.</p></div><div class=paragraph><p>A naplózás azonban egy kétélû fegyver, mivel ha nem vagyunk elég körültekintõek, akkor a sok naplóinformáció között könnyen el tudunk veszni és a lemezünk is gyorsan betelhet a mindent elfoglaló naplóktól. Mellesleg a naplók megdagasztását célzó DoS típusú támadás a rendszerek lebénítására alkalmazott egyik legõsibb technika. Ezek az üzenetek nem csak a rendszernaplóba kerülnek bele, hanem az elsõdleges konzol képernyõjére is kiíródnak, ami egy idõ után idegesítõ tud lenni.</p></div><div class=paragraph><p>A rendszermag <code>IPFIREWALL_VERBOSE_LIMIT=5</code> beállításával azonban képesek vagyunk korlátozni azokat a rendszernapló felé küldött egymás után következõ üzeneteket, amelyek ugyanarra a szabályra vonatkoznak. Amikor ezt a beállítást megadjuk a rendszermag fordításánál, akkor az egyes szabályokhoz az általa meghatározott értéken felül nem jön létre több hasonló üzenet. Hiszen semmi sem derül ki 200 teljesen azonos naplóüzenetbõl. Például, ha az egyes szabályokhoz legfeljebb öt egymást követõ üzenetet engedélyezünk, akkor a többi fennmaradó azonos üzenetet összeszámolja a rendszer és a következõ módon közvetíti a rendszernaplózó szolgáltatás felé:</p></div><div class="literalblock programlisting"><div class=content><pre>last message repeated 45 times</pre></div></div><div class=paragraph><p>Ami magyarul így hangzik:</p></div><div class="literalblock programlisting"><div class=content><pre>az utolsó üzenet 45 alkalommal ismétlõdött meg</pre></div></div><div class=paragraph><p>Az összes csomagokkal kapcsolatos naplózás alapértelmezés szerint a <span class=filename>/var/log/security</span> állományba kerül, amelyet az <span class=filename>/etc/syslog.conf</span> állomány definiál.</p></div></div><div class=sect4><h5 id=firewalls-ipfw-rules-script>30.6.5.4. Szabályokat tartalmazó szkript készítése<a class=anchor href=#firewalls-ipfw-rules-script></a></h5><div class=paragraph><p>A rutinosabb IPFW felhasználók a szabályokat egy állományban programozzák le olyan stílusban, hogy szkriptként is futtatható legyen. Ennek az egyik legnagyobb elõnye, hogy a tûzfal szabályai így egyszerre cserélhetõek a rendszer újraindítása nélkül. Ez a módszer nagyon kényelmes az új szabályok kipróbálásánál, mivel tetszõleges alkalommal végrehajthatjuk. Mivel ez egy szkript, ki tudjuk használni az itt megszokott szimbolikus helyettesítés által felkínált lehetõségeket, és ezzel a gyakran használt értékeket is egyszerre több szabályban tudjuk helyettesíteni. Erre a következõkben fogunk egy konkrét példát látni.</p></div><div class=paragraph><p>A szkript felépítése kompatibilis a <a href="https://man.freebsd.org/cgi/man.cgi?query=sh&amp;sektion=1&amp;format=html">sh(1)</a>, <a href="https://man.freebsd.org/cgi/man.cgi?query=csh&amp;sektion=1&amp;format=html">csh(1)</a> és <a href="https://man.freebsd.org/cgi/man.cgi?query=tcsh&amp;sektion=1&amp;format=html">tcsh(1)</a> parancsértelmezõkkel. A szimbolikus mezõk helyettesítését a $ vagyis dollárjel vezeti be. Maguk a szimbolikus mezõk nem tartalmazzák a $ elõtagot. A szimbolikus mezõk értékeit "kettõs idézõjelek" között kell megadni.</p></div><div class=paragraph><p>A szabályok összeírását kezdjük el így:</p></div><div class="literalblock programlisting"><div class=content><pre>####### itt kezdõdik az ipfw szabályait tartalmazó szkript ######
#
ipfw -q -f flush       # töröljük az összes aktuális szabályt
# Set defaults
oif=&#34;tun0&#34;             # a kimenõ interfész
odns=&#34;192.0.2.11&#34;      # az internet szolgáltató névszerverének IP-címe
cmd=&#34;ipfw -q add &#34;     # a szabályok hozzáadásához szükséges elemek
ks=&#34;keep-state&#34;        # csupán a lustaság miatt
$cmd 00500 check-state
$cmd 00502 deny all from any to any frag
$cmd 00501 deny tcp from any to any established
$cmd 00600 allow tcp from any to any 80 out via $oif setup $ks
$cmd 00610 allow tcp from any to $odns 53 out via $oif setup $ks
$cmd 00611 allow udp from any to $odns 53 out via $oif $ks
#### itt fejezõdik be az ipfw szabályait tartalmazó szkript ######</pre></div></div><div class=paragraph><p>Ezzel készen is vagyunk. Most ne törõdjünk a példában szereplõ szabályokkal, itt most a szimbolikus helyettesítés használatát igyekeztük bemutatni.</p></div><div class=paragraph><p>Ha az iménti példát az <span class=filename>/etc/ipfw.rules</span> állományba mentettük el, akkor az alábbi parancs kiadásával tudjuk újratölteni a benne szereplõ szabályokat:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># sh /etc/ipfw.rules</span></code></pre></div></div><div class=paragraph><p>Az <span class=filename>/etc/ipfw.rules</span> állományt egyébként tetszõleges néven hívhatjuk és bárhová rakhatjuk.</p></div><div class=paragraph><p>Ugyanez természetesen elérhetõ a következõ parancsok egymás utáni begépelésével is:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># ipfw -q -f flush</span>
<span class=c># ipfw -q add check-state</span>
<span class=c># ipfw -q add deny all from any to any frag</span>
<span class=c># ipfw -q add deny tcp from any to any established</span>
<span class=c># ipfw -q add allow tcp from any to any 80 out via tun0 setup keep-state</span>
<span class=c># ipfw -q add allow tcp from any to 192.0.2.11 53 out via tun0 setup keep-state</span>
<span class=c># ipfw -q add 00611 allow udp from any to 192.0.2.11 53 out via tun0 keep-state</span></code></pre></div></div></div><div class=sect4><h5 id=_állapottartó_szabályrendszerek>30.6.5.5. Állapottartó szabályrendszerek<a class=anchor href=#_állapottartó_szabályrendszerek></a></h5><div class=paragraph><p>A most következõ címfordítás nélküli szabályrendszer arra mutat példát, hogyan valósítsunk meg egy biztonságos "inkluzív" tûzfalat. Az inkluzív tûzfalak csak a szabályainak megfelelõ szolgáltatásokat engedik át, minden mást alapértelmezés szerint tiltanak. A komplett hálózati szegmensek védelmére összeállított tûzfalaknak legalább két interfészük van, amelyek mindegyikéhez tartoznia kell szabályoknak a megfelelõ mûködéshez.</p></div><div class=paragraph><p>Az UNIX® mintájú operációs rendszer, köztül a FreeBSD is olyan, hogy a rendszerben belüli kommunikációt a <span class=filename>lo0</span> nevû interfészen és a <code>127.0.0.1</code> IP-címen bonyolítja le. A tûzfalban mindenképpen szerepelniük kell olyan szabályoknak, amelyek gondoskodnak ezen speciális belsõ csomagok zavartalan közlekedésérõl.</p></div><div class=paragraph><p>Az internet felé csatlakozó interfész lesz az, amelyen keresztül a kifelé menõ kéréseket hitelesítjük és vezéreljük az internet elérését, valamint ahol szûrjük az internet felõl érkezõ kéréseket. Ez lehet a PPP esetében a <span class=filename>tun0</span> eszköz, vagy a DSL-, illetve kábelmodemhez csatlakozó hálózati kártya.</p></div><div class=paragraph><p>Abban az esetben, amikor egy vagy több hálózati kártyával csatlakozunk a tûzfal mögött található belsõ helyi hálózatra, szintén gondoskodnunk kell a helyi hálózaton belül mozgó csomagok akadálymentes továbbításáról.</p></div><div class=paragraph><p>A szabályokat elõször három nagyobb osztályba kell sorolnunk: az összes szabadon forgalmazó interfész, a publikus kimenõ és a publikus bejövõ interfész csoportjába.</p></div><div class=paragraph><p>A publikus interfészekhez tartozó csoportokban úgy kell rendeznünk a szabályokat, hogy elõre kerüljenek a gyakrabban használtak és hátra a kevésbé használtak, valamint a csoportok utolsó szabálya blokkoljon és naplózzon minden csomagot az adott interfészen és irányban.</p></div><div class=paragraph><p>A következõ szabályrendszerben szereplõ, a kimenõ kapcsolatokat tartalmazó csoport csak olyan <code>allow</code> típusú szabályokat tartalmaz, amelyek szûrési feltételei egyértelmûen azonosítják az interneten elérhetõ szolgáltatásokat. Az összes szabályban megjelennek a <code>proto</code>, <code>port</code>, <code>in</code>/<code>out</code>, <code>via</code> és <code>keep state</code> opciók. A <code>proto tcp</code> szabályokban emellett szerepel még egy <code>setup</code> opció is, amellyel a kapcsolatokat kezdeményezõ csomagokat tudjuk azonosítani és felvenni az állapottartásért felelõs dinamikus szabályok közé.</p></div><div class=paragraph><p>A bejövõ forgalmat vezérlõ szabályrendszerben elõször az eldobni kívánt csomagokat kell megadni, aminek két eltérõ oka van. Elõször is elõfordulhat, hogy a veszélyes csomagok részleges illeszkedés miatt szabályosnak tûnnek. Az ilyen csomagokat értelemszerûen nem lenne szabad beengedni a szabályok részleges megfelelése alapján. A másodszor az eleve ismerten problémás és értelmetlen csomagokat csendben el kellene vetni, mielõtt a szakaszhoz tartozó utolsó szabály fogná meg és naplózná. Ez az utolsó szabály egyébként szükség esetén felhasználható a támadók elleni bizonyítékok begyûjtésére.</p></div><div class=paragraph><p>A másik, amire még oda kell figyelnünk, hogy a blokkolt csomagok esetében semmilyen válasz nem keletkezzen, egyszerûen csak tûnjenek el. Így a támadó nem fogja tudni, hogy a csomagjai vajon elérték-e a rendszerünket. Minél kevesebb információt tudnak összegyûjteni a rendszerünkrõl a támadók, annál biztonságosabbnak tekinthetõ. Amikor ismeretlen portokra érkezõ csomagokat naplózunk, érdemes az <span class=filename>/etc/services/</span> állományban vagy <a href=http://www.securitystats.com/tools/portsearch.php>http://www.securitystats.com/tools/portsearch.php</a> címen (angolul) utánanézni a porthoz tartozó szolgáltatásnak. A különbözõ trójai programok által portok számai ezen a linken érhetõek el (angolul): <a href=http://www.simovits.com/trojans/trojans.html>http://www.simovits.com/trojans/trojans.html</a>.</p></div></div><div class=sect4><h5 id=_példa_egy_inkluzív_szabályrendszerre>30.6.5.6. Példa egy inkluzív szabályrendszerre<a class=anchor href=#_példa_egy_inkluzív_szabályrendszerre></a></h5><div class=paragraph><p>A most következõ, címfordítást nem tartalmazó szabályrendszer teljesen inkluzív típusú. Éles rendszereken is nyugodtan alkalmazhatjuk. Egyszerûen csak annyit kell tennünk, hogy megjegyzésbe tesszük az olyan szolgáltatásokra vonatkozó szabályokat, amelyeket nem akarunk engedélyezni. Amikor pedig olyan üzenetek jelennek meg a naplóban, amelyeket nem akarunk tovább látni, a bejövõ kapcsolatokhoz vegyünk fel egy <code>deny</code> típusú szabályt hozzájuk. Minden szabályban cseréljük ki a <code>dc0</code> interfészt arra a hálózati kártyára, amely közvetlenül csatlakoztatja rendszerünket az internethez. A felhasználói PPP esetében ez a <code>tun0</code>.</p></div><div class=paragraph><p>A szabályok használatában felfedezhetünk egyfajta rendszerszerûséget:</p></div><div class=ulist><ul><li><p>Mindegyik sorban, ahol az internet felé nyitunk meg egy kapcsolatot, a <code>keep-state</code> opciót használjuk.</p></li><li><p>Az internetrõl az összes hitelesített szolgáltatás elérése tartalmazza a <code>limit</code> opciót az elárasztások kivédése miatt.</p></li><li><p>Az összes szabályban az <code>in</code> vagy az <code>out</code> paraméterrel megadjuk szûrni kívánt forgalom irányát.</p></li><li><p>Az összes szabályban szerepel a <code>via</code> paraméterrel a csomagokat továbbító interfész neve.</p></li></ul></div><div class=paragraph><p>Az alábbi szabályokat tegyük az <span class=filename>/etc/ipfw.rules</span> állományba.</p></div><div class="literalblock programlisting"><div class=content><pre>############## Itt kezdõdnek az IPFW szabályai ##########################
# Kezdés elõtt töröljük az összes aktív szabályt.
ipfw -q -f flush

# Állítsuk be a parancsok további szükséges opciót.
cmd=&#34;ipfw -q add&#34;
pif=&#34;dc0&#34;     # az internethez csatlakozó
              # interfész neve

#################################################################
# A belsõ hálózat számára ne korlátozzunk semmit se.
# Ha nincs helyi hálózatunk, akkor erre nincs szükségünk.
# Az &#39;xl0&#39; nevét írjuk át a helyi hálózatra csatlakozó
# interfész nevére.
################################################################
#$cmd 00005 allow all from any to any via xl0

################################################################
# A rendszer belsõ interfészét se szûrjük.
################################################################
$cmd 00010 allow all from any to any via lo0

################################################################
# A csomagot engedjük át a tûzfalon, ha korábban már felvettünk
# hozzá egy dinamikus szabályt a keep-state opcióval.
################################################################
$cmd 00015 check-state

################################################################
# Az internet felé forgalmazó interfész (kimenõ kapcsolatok)
# A saját hálózatunkról belülrõl vagy errõl az átjáróról
# kezdeményezett kapcsolatokat vizsgáljuk az internet felé.
################################################################

# Kifelé engedélyezzük az internet-szolgáltatónk névszerverének
# elérését. Az x.x.x.x a szolgáltatónk névszerverének IP-címe
# legyen. Ha a szolgáltatónak több névszervere is van, akkor
# másoljuk le ezeket a sorokat és az /etc/resolv.conf
# állományban található IP-címeket helyettesítsük be.
$cmd 00110 allow tcp from any to x.x.x.x 53 out via $pif setup keep-state
$cmd 00111 allow udp from any to x.x.x.x 53 out via $pif keep-state

# Kábel/DSL konfigurációk esetében kifelé engedélyezzük a
# szolgáltatónk DHCP szerverének elérését. Ha a &#34;felhasználói
# PPP&#34;-t használjuk, akkor erre nem lesz szükségünk, az egész
# csoportot törölhetjük. Az alábbi szabállyal csíphetjük el a
# beírandó IP-címet. Ha a naplóban megtaláltuk, akkor vegyük
# ki az elsõ szabályt, a másodikba írjuk bele a címet és
# engedélyezzük.
$cmd 00120 allow log udp from any to any 67 out via $pif keep-state
#$cmd 00120 allow udp from any to x.x.x.x 67 out via $pif keep-state

# Kifelé engedélyezzük a szabvány nem biztonságos WWW
# funkció elérését.
$cmd 00200 allow tcp from any to any 80 out via $pif setup keep-state

# Kifelé engedélyezzük a biztonságos HTTPS funkció
# elérését TLS SSL használatával.
$cmd 00220 allow tcp from any to any 443 out via $pif setup keep-state

# Kifelé engedélyezzük a e-mailek küldését és fogadását.
$cmd 00230 allow tcp from any to any 25 out via $pif setup keep-state
$cmd 00231 allow tcp from any to any 110 out via $pif setup keep-state

# Kifelé engedélyezzük a FreeBSD (a make install és a CVSUP)
# funkcióit. Ezzel lényegében a rendszeradminisztrátornak
# ,,ISTENI&#39;&#39; jogokat adunk.
$cmd 00240 allow tcp from me to any out via $pif setup keep-state uid root

# Kifelé engedélyezzük a pinget.
$cmd 00250 allow icmp from any to any out via $pif keep-state

# Kifelé engedélyezzük az idõ szolgáltatást.
$cmd 00260 allow tcp from any to any 37 out via $pif setup keep-state

# Kifelé engedélyezzük az nntp news szolgáltatást
# (vagyis a hírcsoportokat)
$cmd 00270 allow tcp from any to any 119 out via $pif setup keep-state

# Kifelé engedélyezzük a biztonságos FTP, telnet és SCP
# elérését az SSH (secure shell) használatával.
$cmd 00280 allow tcp from any to any 22 out via $pif setup keep-state

# Kifelé engedélyezzük a whois szolgáltatást.
$cmd 00290 allow tcp from any to any 43 out via $pif setup keep-state

# Dobjuk el és naplózzunk mindent, ami megpróbál kijutni.
# Ez a szabály gondoskodik róla, hogy alapértelmezés szerint
# mindent blokkoljunk.
$cmd 00299 deny log all from any to any out via $pif

################################################################
# Az internet felõli interfész (bejövõ kapcsolatok)
# A saját hálózatunk felé vagy erre az átjáróra
# nyitott kapcsolatokat vizsgáljuk az internet felõl.
################################################################

# Blokkoljunk minden olyan bejövõ forgalmat, amely a fenntartott
# címtartományok felé tart.
$cmd 00300 deny all from 192.168.0.0/16 to any in via $pif  #RFC 1918: privát IP
$cmd 00301 deny all from 172.16.0.0/12 to any in via $pif   #RFC 1918: privát IP
$cmd 00302 deny all from 10.0.0.0/8 to any in via $pif      #RFC 1918: privát IP
$cmd 00303 deny all from 127.0.0.0/8 to any in via $pif     #helyi
$cmd 00304 deny all from 0.0.0.0/8 to any in via $pif       #helyi
$cmd 00305 deny all from 169.254.0.0/16 to any in via $pif  #DHCP
$cmd 00306 deny all from 192.0.2.0/24 to any in via $pif    #dokumentációs célokra fenntartott
$cmd 00307 deny all from 204.152.64.0/23 to any in via $pif #Sun klaszterek összekötésére használt
$cmd 00308 deny all from 224.0.0.0/3 to any in via $pif     #D és E osztályú multicast

# A nyilvános pingek tiltása.
$cmd 00310 deny icmp from any to any in via $pif

# Az ident szolgáltatás tiltása.
$cmd 00315 deny tcp from any to any 113 in via $pif

# Blokkoljuk az összes Netbios szolgáltatást: 137=név, 138=datagram,
# 139=session. A Netbios az MS Windows megosztását implementálja.
# Blokkoljuk az MS Windows hosts2 névszerver kéréseit is a 81-es
# porton.
$cmd 00320 deny tcp from any to any 137 in via $pif
$cmd 00321 deny tcp from any to any 138 in via $pif
$cmd 00322 deny tcp from any to any 139 in via $pif
$cmd 00323 deny tcp from any to any 81 in via $pif

# Eldobjuk az összes késõn érkezõ csomagot.
$cmd 00330 deny all from any to any frag in via $pif

# Eldobjuk azokat az ACK csomagokat, amelyek egyik dinamikus
# szabálynak sem felelnek meg.
$cmd 00332 deny tcp from any to any established in via $pif

# Befelé engedélyezzük a szolgáltató DHCP szerverének válaszát. Ebben
# a szabályban csak a DHCP szerver IP-címe szerepelhet, mivel ez az
# egyetlen olyan hitelesített forrás, ami ilyen csomagokat küldhet.
# Ez csak a kábeles és DSL típusú kapcsolatok esetében szükséges.
# Amikor a &#34;felhasználói PPP&#34;-vel csatlakozunk az internethez, nem
# kell ez a szabály. Ugyanazt az IP-címet kell megadnunk, amelyet a
# kimenõ kapcsolatoknál is.
#$cmd 00360 allow udp from any to x.x.x.x 67 in via $pif keep-state

# Befelé engedélyezzük a szabvány WWW funkciót, mivel webszerverünk
# is van.
$cmd 00400 allow tcp from any to me 80 in via $pif setup limit src-addr 2

# Befelé engedélyezzük a biztonságos FTP, telnet és SCP
# típusú kapcsolatokat az internetrõl.
$cmd 00410 allow tcp from any to me 22 in via $pif setup limit src-addr 2

# Befelé engedélyezzük az internetrõl érkezõ nem biztonságos telnet
# kapcsolatokat. Azért tekintjük nem biztonságosnak, mert az
# azonosítók és a jelszavak az interneten titkosítatlanul vándorolnak.
# Töröljük ezt a csoportot, ha nincs telnet szolgáltatásunk.
$cmd 00420 allow tcp from any to me 23 in via $pif setup limit src-addr 2

# Dobjuk el és naplózzuk az összes többi kintrõl érkezõ csomagot.
$cmd 00499 deny log all from any to any in via $pif

# Alapértelmezés szerint dobjuk el mindent. Az ide érkezõ
# csomagokat is naplózzuk, amibõl többet is ki tudunk majd
# deríteni.
$cmd 00999 deny log all from any to any
############# Itt fejezõdnek be az IPFW szabályai #####################</pre></div></div></div><div class=sect4><h5 id=_példa_hálózati_címfordításra_és_állapottartásra>30.6.5.7. Példa hálózati címfordításra és állapottartásra<a class=anchor href=#_példa_hálózati_címfordításra_és_állapottartásra></a></h5><div class=paragraph><p>Az IPFW címfordító funkciójának kihasználásához további konfigurációs beállítások alkalmazására is szükségünk lesz. A rendszermagban opció között meg kell adnunk az <code>option IPDIVERT</code> sort a többi <code>IPFIREWALL</code> sor mellett, és fordítanunk egy saját verziót.</p></div><div class=paragraph><p>Emellett még az <span class=filename>/etc/rc.conf</span> állományban is engedélyezni kell az IPFW alapvetõ funkcióit.</p></div><div class="literalblock programlisting"><div class=content><pre>natd_enable=&#34;YES&#34;                   # engedélyezzük a címfordításért felelõs démont
natd_interface=&#34;rl0&#34;                # az internet felé mutató hálózati kártya neve
natd_flags=&#34;-dynamic -m&#34;            # -m = a portszámok megtartása, ha lehetséges</pre></div></div><div class=paragraph><p>Az állapottartó szabályok használata a <code>divert natd</code> címfordítási opcióval együtt nagyban növeli a szabályrendszer leprogramozásának bonyolultságát. A <code>check-state</code> és <code>divert natd</code> szabályok helye kritikus a megfelelõ mûködés tekintetében. Az eddig megszokott egyszerû viselkedés itt már nem érvényesül. Bevezetünk egy új cselekvést is, amelynek a neve <code>skipto</code>. A <code>skipto</code> parancs használatához elengedhetetlen a szabályok sorszámozása, mivel pontosan tudnunk kell, hogy a <code>skipto</code> hatására hova kell ugrania a vezérlésnek.</p></div><div class=paragraph><p>A következõ példában nem fogunk sok megjegyzést látni, mivel benne az egyik lehetséges programozási stílust próbáljuk érzékeltetni és a csomagok szabályrendszerek közti áramlását magyarázzuk.</p></div><div class=paragraph><p>A feldolgozás a szabályokat tartalmazó állomány tetején található elsõ szabállyal kezdõdik, és innen egyesével pereg végig lefelé a feldolgozás egészen addig, amíg a csomag a szûrési feltételek valamelyikének eleget nem tesz és távozik a tûzfalból. Leginkább a 100-as, 101-es, 450-es, 500-as és 510-es sorszámú szabályokat emelnénk ki. Ezek vezérlik kimenõ és bejövõ csomagok fordítását, ezért a hozzájuk tartozó dinamikus állapottartó bejegyzések mindig a helyi hálózat IP-címeire hivatkoznak. Amit még érdemes megfigyelnünk, hogy az összes áteresztõ és eldobó szabályban szerepel a csomag haladási iránya (tehát kimenõ vagy éppen bejövõ) és az érintett interfészt megnevezése. Emellett azt is vegyük észre, hogy az összes kifelé irányuló kapcsolatlétrehozási kérés az 500-as sorszámú szabályhoz fog ugrani a címfordítás elvégzéséhez.</p></div><div class=paragraph><p>Tegyük fel, hogy a helyi hálózatunkon levõ felhasználók szeretnek honlapokat nézgetni az interneten. A honlapok a 80-as porton keresztül kommunikálnak. Tehát amikor egy ilyen csomag eléri a tûzfalat, nem fog illeszkedni a 100-as szabályra, mert a fejléce szerint kifelé halad és nem befelé. A 101-es szabályon is átlép, mivel ez az elsõ csomag, így a dinamikus állapottartó táblázatban sem szerepel még. A csomag végül a 125-ös szabályra fog illeszkedni: kifelé halad az internetre csatlakozó hálózati kártyán. A csomagban azonban még mindig az eredeti forrás IP-címe található, amely a helyi hálózat egyik gépére hivatkozik. A szabály illeszkedésekor két cselekvés is végbemegy. A <code>keep-state</code> opció hatására ez a szabály felveszi ezt a kapcsolatot az állapottartó dinamikus szabályok közé és végrehajtja a másik megadott feladatot. Ez a feladat része a dinamikus táblázatba rögzített bejegyzésnek, ami ebben az esetben a <code>skipto 500</code> ("ugorjunk az 500-as szabályra") lesz. Az 500-as szabály a továbbküldés elõtt lefordítja a csomag forrás IP-címét. Ezt ne felejtsük el, nagyon fontos! A csomag ezután eljut a céljához, és visszatérve ismét belép a szabályrendszer tetején. Ezúttal illeszkedni fog a 100-as szabályra és a cél IP-címét visszafordítjuk a helyi hálózatunk megfelelõ gépének címére. Ezután a <code>check-state</code> szabályhoz kerül, amely megtalálja a dinamikus szabályok között és továbbengedi a belsõ hálózatra. Ezzel visszakerül a küldõ géphez, amely egy újabb csomagot küld egy újabb adatszeletet kérve a távoli szervertõl. Ekkor már a <code>check-state</code> szabály megtalálja a hozzá tartozó bejegyzést a dinamikus szabályok között és végrehajtódik a korábban letárolt <code>skipto 500</code> mûvelet. A csomag erre az 500-as szabályra ugrik, ahol lefordítjuk a címét és továbbküldjük.</p></div><div class=paragraph><p>Az bejövõ oldalon minden, ami egy korábban kialakult kapcsolat részeként érkezik, automatikusan a <code>check-state</code> és a megfelelõ helyre rakott <code>divert natd</code> szabályok által dolgozódik fel. Itt mindössze a rossz csomagok eldobásával és a hitelesített szolgáltatások elérésének biztosításával kell foglalkoznunk. Például a tûzfalon egy webszerver fut, és azt szeretnénk, hogy az internetrõl képesek legyenek elérni a rajta levõ oldalakat. Az újonnan beérkezõ kapcsolatépítési kérelem a 100-as szabályra fog illeszkedni, amelynek a cél IP-címét a tûzfal helyi hálózaton található címére fogjuk leképezni. A csomagot ezután még megvizsgáljuk, nem tartalmaz-e valamilyen huncutságot, majd végül a 425-ös szabálynál fog kikötni. Az egyezéskor két dolog történhet: a csomaghoz felveszünk egy dinamikus szabályt, de ezúttal az adott forrás IP-címrõl érkezõ kapcsolatkérések számát 2-re lekorlátozzuk. Ezzel az adott szolgáltatás portján meg tudjuk óvni a tûzfalat üzemeltetõ gépet a DoS típusú támadásoktól. A csomagot ezután hozzá tartozó cselekvés szerint továbbengedjük a belsõ hálózat felé. Visszatéréskor a tûzfal felismeri, hogy a csomag egy már meglevõ kapcsolathoz tartozik, ezért közvetlenül az 500-as szabályhoz kerül címfordításra, majd a kimenõ interfészen keresztül továbbküldjük.</p></div><div class=paragraph><p>Íme az elsõ példa egy ilyen szabályrendszerre:</p></div><div class="literalblock programlisting"><div class=content><pre>#!/bin/sh
cmd=&#34;ipfw -q add&#34;
skip=&#34;skipto 500&#34;
pif=rl0
ks=&#34;keep-state&#34;
good_tcpo=&#34;22,25,37,43,53,80,443,110,119&#34;

ipfw -q -f flush

$cmd 002 allow all from any to any via xl0  # nem szûrjük a belsõ hálózatot
$cmd 003 allow all from any to any via lo0  # nem szûrjük a helyi interfészt

$cmd 100 divert natd ip from any to any in via $pif
$cmd 101 check-state

# A kimenõ csomagok hitelesítése:
$cmd 120 $skip udp from any to xx.168.240.2 53 out via $pif $ks
$cmd 121 $skip udp from any to xx.168.240.5 53 out via $pif $ks
$cmd 125 $skip tcp from any to any $good_tcpo out via $pif setup $ks
$cmd 130 $skip icmp from any to any out via $pif $ks
$cmd 135 $skip udp from any to any 123 out via $pif $ks

# Az összes olyan csomagot eldobjuk, amely a fenntartott
# címtartományokba tart:
$cmd 300 deny all from 192.168.0.0/16  to any in via $pif  #RFC 1918: privát IP
$cmd 301 deny all from 172.16.0.0/12   to any in via $pif  #RFC 1918: privát IP
$cmd 302 deny all from 10.0.0.0/8      to any in via $pif  #RFC 1918: privát IP
$cmd 303 deny all from 127.0.0.0/8     to any in via $pif  #helyi
$cmd 304 deny all from 0.0.0.0/8       to any in via $pif  #helyi
$cmd 305 deny all from 169.254.0.0/16  to any in via $pif  #DHCP
$cmd 306 deny all from 192.0.2.0/24    to any in via $pif  #dokumentációs célokra fenntartott
$cmd 307 deny all from 204.152.64.0/23 to any in via $pif  #Sun klaszter
$cmd 308 deny all from 224.0.0.0/3     to any in via $pif  #D és E osztályú multicast

# Az érkezõ csomagok hitelesítése:
$cmd 400 allow udp from xx.70.207.54 to any 68 in $ks
$cmd 420 allow tcp from any to me 80 in via $pif setup limit src-addr 1

$cmd 450 deny log ip from any to any

# Ide ugrunk a kimenõ állapottartó szabályoknál:
$cmd 500 divert natd ip from any to any out via $pif
$cmd 510 allow ip from any to any

##################### a szabályok vége ##################</pre></div></div><div class=paragraph><p>A következõ példa teljesen megegyezik az elõzõvel, azonban itt már dokumentációs szándékkal szerepelnek megjegyzések is, melyek a tapasztalatlan IPFW szabályíróknak segítik jobban megérteni a szabályok pontos mûködését.</p></div><div class=paragraph><p>A második példa:</p></div><div class="literalblock programlisting"><div class=content><pre>#!/bin/sh
############# Az IPFW szabályai itt kezdõdnek ###########################
# Kezdés elõtt töröljük az összes jelenleg aktív szabályt:
ipfw -q -f flush

# Beállítjuk a parancsok megfelelõ elõtagjait:
cmd=&#34;ipfw -q add&#34;
skip=&#34;skipto 800&#34;
pif=&#34;rl0&#34;     # az internethez csatlakozó
              # hálózati interfész neve

#################################################################
# A belsõ hálózat számára ne korlátozzunk semmit se.
# Ha nincs helyi hálózatunk, akkor erre nincs szükségünk.
# Az &#39;xl0&#39; nevét írjuk át a helyi hálózatra csatlakozó
# interfész nevére.
#################################################################
$cmd 005 allow all from any to any via xl0

#################################################################
# A rendszer belsõ interfészét se szûrjük.
#################################################################
$cmd 010 allow all from any to any via lo0

#################################################################
# Ellenõrizzük, hogy ez egy beérkezõ csomag és ha igen, akkor
# fordítsuk a címét.
#################################################################
$cmd 014 divert natd ip from any to any in via $pif

#################################################################
# Ha ehhez a csomaghoz korábban már vettük fel dinamikus
# szabályt a keep-state opció révén, akkor engedjük tovább.
#################################################################
$cmd 015 check-state

#################################################################
# Az internet felé forgalmazó interfész (kimenõ kapcsolatok)
# A saját hálózatunkról belülrõl vagy errõl az átjáróról
# kezdeményezett kapcsolatokat vizsgáljuk az internet felé.
#################################################################

# Kifelé engedélyezzük az internet-szolgáltatónk névszerverének
# elérését. Az x.x.x.x a szolgáltató névszerverének IP-címe
# lesz. Ha a szolgáltatónknak több névszervere is van, akkor
# az /etc/resolv.conf állományból nézzük ki a címeiket és
# másoljuk le az alábbi sor mindegyikükhöz.
$cmd 020 $skip tcp from any to x.x.x.x 53 out via $pif setup keep-state

# A kábeles és DSL kapcsolatok esetén engedélyezzük a szolgáltató
# DHCP szerverének elérését.
$cmd 030 $skip udp from any to x.x.x.x 67 out via $pif keep-state

# Kifelé engedélyezzük a szabvány nem biztonságos WWW funkciót
$cmd 040 $skip tcp from any to any 80 out via $pif setup keep-state

# Kifelé engedélyezzük a biztonságos HTTPS funkciót a TLS SSL
# használatával.
$cmd 050 $skip tcp from any to any 443 out via $pif setup keep-state

# Kifelé engedélyezzük az e-mailek küldését és fogadását.
$cmd 060 $skip tcp from any to any 25 out via $pif setup keep-state
$cmd 061 $skip tcp from any to any 110 out via $pif setup keep-state

# Kifelé engedélyezzük a FreeBSD (make install és CVSUP) funkcióit.
# Ezzel a rendszeradminisztrátornak ,,ISTENI&#39;&#39; jogokat adunk.
$cmd 070 $skip tcp from me to any out via $pif setup keep-state uid root

# Kifelé engedélyezzük a pinget.
$cmd 080 $skip icmp from any to any out via $pif keep-state

# Kifelé engedélyezzük az idõ szolgáltatást.
$cmd 090 $skip tcp from any to any 37 out via $pif setup keep-state

# Kifelé engedélyezzük az nntp news szolgáltatást (tehát a
# hírcsoportokat).
$cmd 100 $skip tcp from any to any 119 out via $pif setup keep-state

# Kifelé engedélyezzük a biztonságos FTP, telnet és SCP
# funkciókat az SSH (secure shell) használatával.
$cmd 110 $skip tcp from any to any 22 out via $pif setup keep-state

# Kifelé engedélyezzük ki a whois kéréseket.
$cmd 120 $skip tcp from any to any 43 out via $pif setup keep-state

# Kifelé engedélyezzük az NTP idõszerver elérését.
$cmd 130 $skip udp from any to any 123 out via $pif keep-state

#################################################################
# Az internet felõli interfész (bejövõ kapcsolatok)
# A saját hálózatunk felé vagy erre az átjáróra
# nyitott kapcsolatokat vizsgáljuk az internet felõl.
#################################################################

# Tiltsuk a fenntartott címtartományok felé haladó összes beérkezõ
# forgalmat.
$cmd 300 deny all from 192.168.0.0/16  to any in via $pif  #RFC 1918: privát IP
$cmd 301 deny all from 172.16.0.0/12   to any in via $pif  #RFC 1918: privát IP
$cmd 302 deny all from 10.0.0.0/8      to any in via $pif  #RFC 1918: privát IP
$cmd 303 deny all from 127.0.0.0/8     to any in via $pif  #helyi
$cmd 304 deny all from 0.0.0.0/8       to any in via $pif  #helyi
$cmd 305 deny all from 169.254.0.0/16  to any in via $pif  #DHCP
$cmd 306 deny all from 192.0.2.0/24    to any in via $pif  #dokumentációs célokra fenntartott
$cmd 307 deny all from 204.152.64.0/23 to any in via $pif  #Sun klaszter
$cmd 308 deny all from 224.0.0.0/3     to any in via $pif  #D és E osztályú multicast

# Az ident tiltása.
$cmd 315 deny tcp from any to any 113 in via $pif

# Blokkoljuk az összes Netbios szolgáltatást: 137=név, 138=datagram,
# 139=session. A Netbios az MS Windows megosztását implementálja.
# Blokkoljuk az MS Windows hosts2 névszerver kéréseit is a 81-es
# porton.
$cmd 320 deny tcp from any to any 137 in via $pif
$cmd 321 deny tcp from any to any 138 in via $pif
$cmd 322 deny tcp from any to any 139 in via $pif
$cmd 323 deny tcp from any to any 81  in via $pif

# Dobjuk el a késõn érkezõ csomagokat.
$cmd 330 deny all from any to any frag in via $pif

# Dobjuk el azokat az ACK csomagokat, amelyekre nincs
# dinamikus szabály.
$cmd 332 deny tcp from any to any established in via $pif

# Engedélyezzük a szolgáltató DHCP szerverétõl érkezõ forgalmat. Ennek
# a szabálynak tartalmaznia kell a DHCP szerver címét, mert csak tõle
# fogadunk el ilyen típusú csomagokat. Egyedül csak kábeles vagy DSL
# konfigurációk esetén használatos, a &#34;felhasználói PPP&#34; esetében
# törölhetjük. Ez ugyanaz az IP-cím, amelyet a kimenõ kapcsolatoknál
# megadtunk.
$cmd 360 allow udp from x.x.x.x to any 68 in via $pif keep-state

# Befelé engedélyezzük a szabvány WWW funkciót, mivel van
# webszerverünk.
$cmd 370 allow tcp from any to me 80 in via $pif setup limit src-addr 2

# Befelé engedélyezzük a biztonságos FTP, telnet és SCP
# használatát az internetrõl.
$cmd 380 allow tcp from any to me 22 in via $pif setup limit src-addr 2

# Befelé engedélyezzük a nem biztonságos telnet elérését az
# internetrõl. Azért nem tekintjük biztonságosnak, mert az
# azonosítókat és a jelszavakat az interneten titkosítatlanul
# közvetíti. Ha nincs telnet szolgáltatásunk, akkor törölhetjük is ezt
# a csoportot.
$cmd 390 allow tcp from any to me 23 in via $pif setup limit src-addr 2

# Dobjuk el és naplózzuk az összes internetrõl érkezõ hitelesítetlen kapcsolatot.
$cmd 400 deny log all from any to any in via $pif

# Dobjuk el és naplózzuk az összes internetre menõ hitelesítetlen kapcsolatot.
$cmd 450 deny log all from any to any out via $pif

# Ez lesz a kimenõ szabályokhoz tartozó &#34;skipto&#34; célja.
$cmd 800 divert natd ip from any to any out via $pif
$cmd 801 allow ip from any to any

# Minden mást alapértelmezés szerint tiltunk és naplózunk.
$cmd 999 deny log all from any to any
############# Az IPFW szabályai itt fejezõdnek be #####################</pre></div></div></div></div></div></div></div><div class=sect1><h2 id=advanced-networking>Chapter 31. Egyéb haladó hálózati témák<a class=anchor href=#advanced-networking></a></h2><div class=sectionbody><div class=sect2><h3 id=advanced-networking-synopsis>31.1. Áttekintés<a class=anchor href=#advanced-networking-synopsis></a></h3><div class=paragraph><p>Ebben a fejezetben számos komolyabb hálózati témát fogunk tárgyalni.</p></div><div class=paragraph><p>A fejezet elolvasása során megismerjük:</p></div><div class=ulist><ul><li><p>az átjárók és az útválasztás alapjait;</p></li><li><p>hogyan állítsunk be IEEE® 802.11 és Bluetooth® eszközöket;</p></li><li><p>a FreeBSD segítségével hogyan tudunk két hálózatot összekötni hálózati hidakon keresztül;</p></li><li><p>hogyan indítsuk hálózatról egy lemez nélküli gépet;</p></li><li><p>hogyan állítsunk be hálózati címfordítást;</p></li><li><p>hogyan kapcsoljunk össze két számítógépet PLIP használatával;</p></li><li><p>hogyan állítsuk be az IPv6 használatát egy FreeBSD-s gépen</p></li><li><p>hogyan állítsuk be az ATM használatát;</p></li><li><p>hogyan engedélyezzük és használjuk a Közös címredundancia protokollt FreeBSD-ben.</p></li></ul></div><div class=paragraph><p>A fejezet elolvasásához ajánlott:</p></div><div class=ulist><ul><li><p>az <span class=filename>/etc/rc</span> könyvtárban található szkriptek mûködésének ismerete;</p></li><li><p>az alapvetõ hálózati fogalmak ismerete;</p></li><li><p>egy új FreeBSD rendszermag beállításának és telepítésének ismerete (<a href=./#kernelconfig>A FreeBSD rendszermag testreszabása</a>);</p></li><li><p>a külsõ szoftverek telepítésének ismerete (<a href=./#ports>Alkalmazások telepítése. csomagok és portok</a>).</p></li></ul></div></div><div class=sect2><h3 id=network-routing>31.2. Átjárók és az útválasztás<a class=anchor href=#network-routing></a></h3><div class=paragraph><p>Egy gép egy másikat úgy tud megtalálni a hálózaton, ha erre létezik egy olyan mechanizmus, amely leírja, hogyan tudunk eljutni az egyiktõl a másikig. Ezt hívjuk <em>útválasztásnak</em> (routing). Az "útvonal" (route) címek egy párjaként adható meg, egy "céllal" (destination) és egy "átjáróval" (gateway). Ez a páros mondja meg, hogy ha el akarjuk érni ezt a <em>célt</em>, akkor ezen az <em>átjárón</em> keresztül kell továbbhaladnunk. A céloknak három típusa lehet: egyéni gépek, alhálózatok és az "alapértelmezett". Az "alapértelmezett útvonalat" (default route) abban az esetben alkalmazzuk, ha semelyik más útvonal nem megfelelõ. Az alapértelmezett útvonalakról a késõbbiekben még beszélni fogunk. Három típusa van az átjáróknak: egyéni gépek, felületek (avagy "linkek") és a hardveres Ethernet címek (MAC-címek).</p></div><div class=sect3><h4 id=_példa>31.2.1. Példa<a class=anchor href=#_példa></a></h4><div class=paragraph><p>Az útválasztás különbözõ területeit a következõ <code>netstat</code> parancs alapján fogjuk bemutatni:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>% netstat <span class=nt>-r</span>
Routing tables

Destination      Gateway            Flags     Refs     Use     Netif Expire

default          outside-gw         UGSc       37      418      ppp0
localhost        localhost          UH          0      181       lo0
test0            0:e0:b5:36:cf:4f   UHLW        5    63288       ed0     77
10.20.30.255     <span class=nb>link</span><span class=c>#1             UHLW        1     2421</span>
example.com      <span class=nb>link</span><span class=c>#1             UC          0        0</span>
host1            0:e0:a8:37:8:1e    UHLW        3     4601       lo0
host2            0:e0:a8:37:8:1e    UHLW        0        5       lo0 <span class=o>=&gt;</span>
host2.example.com <span class=nb>link</span><span class=c>#1             UC          0        0</span>
224              <span class=nb>link</span><span class=c>#1             UC          0        0</span></code></pre></div></div><div class=paragraph><p>Az elsõ két sorban az alapértelmezett útvonalat (melyrõl részleteiben majd a <a href=#network-routing-default>következõ szakaszban</a> fogunk szólni) és a <code>localhost</code> útvonalát láthatjuk.</p></div><div class=paragraph><p>A <code>localhost</code> címhez az útválasztási táblázatban a <span class=filename>lo0</span> eszköz tartozik (a <code>Netif</code> oszlopban), amelyet loopback eszköznek is neveznek. Ez arra utasítja a rendszert, hogy az ide küldött csomagokat ne a helyi hálózaton küldje keresztül, hanem csak ezen a belsõ felületen, mivel úgyis oda jutnának vissza, ahonnan indultak.</p></div><div class=paragraph><p>A táblázatban a következõ sor egy <code>0:e0</code> kezdetû címet tartalmaz. Ez egy hardveres Ethernet cím, más néven MAC-cím. A FreeBSD magától képes beazonosítani tetszõleges gépet (ebben a példában a <code>test0</code> gépet) a helyi Ethernetes hálózaton és felvenni hozzá egy útvonalat, közvetlenül az <span class=filename>ed0</span> Ethernetes csatolófelületen keresztül. Ehhez a típusú útvonalhoz tartozik még egy lejárati idõ is (a <code>Expire</code> oszlop), amely akkor kap szerepet, ha ennyi idõ elteltével nem kapunk semmilyen hírt a géprõl. Amikor ilyen történik, az géphez eddig nyilvántartott útvonal automatikusan törlõdik. Ezek a gépek a RIP (útvonal-információs protokoll, Routing Information Protocol) nevû mechanizmuson keresztül azonosítódnak, mely a legrövidebb út kiszámítása alapján határozza meg a helyi gépekhez vezetõ útvonalat.</p></div><div class=paragraph><p>A FreeBSD a helyi alhálózat (<code>10.20.30.255</code> és <code>example.com</code>, az alhálózathoz tartozó név) esetében is felvesz útvonalakat. A <code>link#1</code> megnevezés a gépben található elsõ Ethernet-kártyát jelöli. Megfigyelhetjük, hogy rajta kívül nincs is több felülete.</p></div><div class=paragraph><p>Mindegyik csoport (a helyi hálózati gépek és a helyi alhálózatokatok) útvonalait a routed nevû démon tartja automatikusan karban. Ha ez nem fut, akkor csak a statikusan definiált (vagyis az elõre megadott) útvonalak fognak létezni.</p></div><div class=paragraph><p>A <code>host1</code> sor a saját gépünkre vonatkozik, amelyet az Ethernet címe szerint ismerünk. Mivel mi vagyunk küldõ gép, a FreeBSD tudni fogja, hogy ilyenkor az Ethernetes felület helyett a loopback eszközt (<span class=filename>lo0</span>) kell használnia.</p></div><div class=paragraph><p>A két <code>host2</code> sor arra mutat példát, amikor az <a href="https://man.freebsd.org/cgi/man.cgi?query=ifconfig&amp;sektion=8&amp;format=html">ifconfig(8)</a> paranccsal álneveket hozunk létre (ennek konkrét okait lásd az Ethernetrõl szóló részben). A <span class=filename>lo0</span> felület neve után szereplõ <code>⇒</code> szimbólum azt jelzi, hogy ez nem csak egy loopback felület (mivel a címe szintén a helyi gépre mutat), hanem a felület egy másik neve. Ilyen útvonalak csak az álneveket ismerõ gépeknél jelennek meg. A helyi hálózaton minden más gépnél egyszerûen csak a <code>link#1</code> jelenik meg az ilyen útvonalak esetében.</p></div><div class=paragraph><p>Az utolsó sor (a <code>224</code> céllal rendelkezõ alhálózat) a multicastre (többesküldésre) szolgál, amellyel majd egy másik szakaszban foglalkozunk.</p></div><div class=paragraph><p>Végezetül az útvonalakhoz tartozó különféle tulajdonságok a <code>Flags</code> oszlopban láthatóak. Az alábbi rövid táblázatban összefoglaltunk közülük néhányat:</p></div><table class="tableblock frame-none grid-all stretch informaltable"><col style=width:50%><col style=width:50%><tbody><tr><td class="tableblock halign-left valign-top"><p class=tableblock>U</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Up: az útvonal aktív</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>H</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Host: az útvonal egyetlen gépre mutat</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>G</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Gateway: az adott cél felé ezen a gépen keresztül küldjünk, amely majd kitalálja, hogy merre küldje tovább</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>S</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Static: ez az útvonal statikus, nem a rendszer hozta létre automatikusan</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>C</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Clone: ebbõl az útvonalból származtatunk új útvonalat azokhoz a gépekhez, amelyekhez csatlakozunk. Ilyen útvonalakat általában a helyi hálózatokban találhatunk</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>W</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>WasCloned: azt jelzi, hogy ezt az útvonalat egy helyi hálózatra mutató (klón, avagy Clone típusú) útvonal alapján hoztuk létre automatikusan</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>L</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Link: az útvonal Ethernetes hardverhez kapcsolódik</p></td></tr></tbody></table></div><div class=sect3><h4 id=network-routing-default>31.2.2. Alapértelmezett útvonalak<a class=anchor href=#network-routing-default></a></h4><div class=paragraph><p>Amikor a helyi rendszernek fel kell vennie a kapcsolatot egy távoli géppel, ellenõrzi az útválasztási táblázatban, hogy létezik-e már hozzá valamilyen útvonal. Ha a távoli gép egy olyan alhálózatba esik, amelyet már el tudunk érni (klónozott útvonalak), akkor a rendszer megnézi, hogy a hozzá tartozó felületen képes-e kapcsolatot létesíteni.</p></div><div class=paragraph><p>Ha minden ismert útvonal csõdöt mond, akkor a rendszerünknek marad még egy utolsó esélye: az "alapértelmezett" útvonal használata. Ez az útvonal egy speciális átjáró útvonal (ebbõl általában csak egyetlen egy létezik a rendszerben) és tulajdonságai között mindig szerepel a <code>c</code>. A helyi hálózat gépei közül ez az átjáró az legyen, amelyik közvetlenül kapcsolódik a külsõ világhoz (PPP összeköttetéssel, DSL, kábelmodem, T1 vagy bármilyen más hálózati felületen keresztül).</p></div><div class=paragraph><p>Amikor pedig magát a külsõ világ felé átjáróként szolgáló gépet állítjuk be, az alapértelmezett útvonal az internet-szolgáltatónk által megadott gép címe lesz.</p></div><div class=paragraph><p>Vegyünk egy példát az alapértelmezett útvonalakra. Egy tipikus konfiguráció:</p></div><div class=imageblock><div class=content><img src=../../../../images/books/handbook/advanced-networking/net-routing.png alt="net routing"></div></div><div class=paragraph><p>A <code>Helyi1</code> és <code>Helyi2</code> gépek a hálózatunk tagjai. A <code>Helyi1</code> az internet-szolgáltatót éri el egy betárcsázós PPP kapcsolaton keresztül. A PPP szerver a külsõ felületén keresztül a helyi hálózaton pedig egy másik átjáróhoz csatlakozik.</p></div><div class=paragraph><p>Az egyes gépek alapértelmezett útvonalai így alakulnak:</p></div><table class="tableblock frame-none grid-all stretch informaltable"><col style=width:33.3333%><col style=width:33.3333%><col style=width:33.3334%><thead><tr><th class="tableblock halign-left valign-top">Gép</th><th class="tableblock halign-left valign-top">Alapértelmezett átjáró</th><th class="tableblock halign-left valign-top">Felület</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class=tableblock>Helyi2</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Helyi1</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Ethernet</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>Helyi1</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>T1-ÁJ</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>PPP</p></td></tr></tbody></table><div class=paragraph><p>Gyakran felmerül a kérdés, hogy "Miért (és hogy-hogy) a <code>T1-ÁJ</code> a <code>Helyi1</code> gép számára az alapértelmezett átjáró és nem a szolgáltató azon szervere, amelyhez csatlakozott?"</p></div><div class=paragraph><p>Ne felejtsük el, hogy a PPP felület a szolgáltató helyi hálózatában a mi részünkre kap címet, és a itt az összes többi géphez tartozó útvonal automatikusan létrejön. Emiatt már eleve el tudjuk érni a <code>T1-ÁJ</code> gépet, ezért amikor a szolgáltatón keresztül küldünk, nincs szükségünk egy további lépcsõre.</p></div><div class=paragraph><p>Általában a <code>X.X.X.1</code> címet szokták a helyi hálózat átjárójának kiosztani. Ezért (az elõbbi példát újrahasznosítva) ha a helyi hálózatunkon a C osztályú <code>10.20.30</code> címtartományt használjuk, és a szolgáltatónkhoz a <code>10.9.9</code> címtartomány tartozik, akkor az alapértelmezett útvonalak a következõk lesznek:</p></div><table class="tableblock frame-none grid-all stretch informaltable"><col style=width:50%><col style=width:50%><thead><tr><th class="tableblock halign-left valign-top">Gép</th><th class="tableblock halign-left valign-top">Alapértelmezett útvonal</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class=tableblock>Helyi2 (10.20.30.2)</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Helyi1 (10.20.30.1)</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>Helyi1 (10.20.30.1, 10.9.9.30)</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>T1-ÁJ (10.9.9.1)</p></td></tr></tbody></table><div class=paragraph><p>Az <span class=filename>/etc/rc.conf</span> állományon keresztül könnyen meg tudjuk adni az alapértelmezett útvonalat. A példánkban a <code>Helyi2</code> gép <span class=filename>/etc/rc.conf</span> állományába kell felvennünk a következõ sort:</p></div><div class="literalblock programlisting"><div class=content><pre>defaultrouter=&#34;10.20.30.1&#34;</pre></div></div><div class=paragraph><p>A <a href="https://man.freebsd.org/cgi/man.cgi?query=route&amp;sektion=8&amp;format=html">route(8)</a> parancs használatával viszont akár közvetlenül is megtehetjük mindezt:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># route add default 10.20.30.1</span></code></pre></div></div><div class=paragraph><p>A <a href="https://man.freebsd.org/cgi/man.cgi?query=route&amp;sektion=8&amp;format=html">route(8)</a> man oldalon olvashatunk arról bõvebben, hogy a hálózati útválasztási táblázatokat kézzel hogyan tudjuk módosítani.</p></div></div><div class=sect3><h4 id=network-dual-homed-hosts>31.2.3. Kettõs hálózatú gépek<a class=anchor href=#network-dual-homed-hosts></a></h4><div class=paragraph><p>Egy másik típusú konfigurációról is szót kell ejtenünk, ahol a gép egyszerre két hálózatnak is tagja. Gyakorlatilag az átjáróként üzemelõ számítógépek (mint például az, amelyik a fenti példában PPP kapcsolattal csatlakozott) ilyen kettõs hálózatú gépnek tekinthetõek. Ez a kifejezés azonban igazából csak azokra az esetekre illik, ahol a gép egyszerre két helyi hálózatban is megjelenik.</p></div><div class=paragraph><p>Az egyik esetben a gépben két Ethernet kártya található, melyek mindegyike birtokol egy-egy hálózati címet az egyes alhálózatokon. De elõfordulhat az is, hogy a gépünkben csupán egyetlen Ethernet kártya van és az <a href="https://man.freebsd.org/cgi/man.cgi?query=ifconfig&amp;sektion=8&amp;format=html">ifconfig(8)</a> segítségével álneveket hoztunk létre hozzá. Az elõbbi általában két fizikailag elkülönölõ Ethernet alapú hálózat esetében történik, míg az utóbbinál csak egyetlen fizikai hálózati szegmensrõl van szó, amely viszont logikailag két külön alhálózatot tartalmaz.</p></div><div class=paragraph><p>Akármelyiket is vesszük, az útválasztási táblázatok úgy jönnek létre, hogy bennük a gép a másik alhálózat felé átjáróként (bejövõ útvonalként) lesz nyilvántartva. Ebben a konfigurációban a gép a két alhálózat között útválasztóként fog tevékenykedni, és gyakran valamelyik vagy éppen mind a két irányba be kell állítanunk valamilyen csomagszûrést vagy tûzfalazást.</p></div><div class=paragraph><p>Ha azt szeretnénk, hogy ez a gép a két felület között továbbítson csomagokat, akkor a FreeBSD-ben külön engedélyezni kell ezt a lehetõséget. A következõ szakaszban ennek részleteit tárjuk fel.</p></div></div><div class=sect3><h4 id=network-dedicated-router>31.2.4. Az útválasztók beállítása<a class=anchor href=#network-dedicated-router></a></h4><div class=paragraph><p>A hálózati útválasztó nem csinál mást, csak továbbküldi az egyik felületén beérkezõ csomagokat egy másik felületére. Az internetes szabványok és a sokéves mérnöki tapasztalat azonban nem engedik, hogy a FreeBSD Projekt alapértelmezés szerint is elérhetõvé tegye ezt a FreeBSD rendszerekben. Ezt a lehetõséget az alábbi változó <code>YES</code> értékûre állításával lehet engedélyezni az <a href="https://man.freebsd.org/cgi/man.cgi?query=rc.conf&amp;sektion=5&amp;format=html">rc.conf(5)</a> állományban:</p></div><div class="literalblock programlisting"><div class=content><pre>gateway_enable=&#34;YES&#34;          # Ez legyen YES, ha átjáróként akarunk üzemelni</pre></div></div><div class=paragraph><p>Ezzel lényegében a <code>net.inet.ip.forwarding</code> <a href="https://man.freebsd.org/cgi/man.cgi?query=sysctl&amp;sektion=8&amp;format=html">sysctl(8)</a> változó értékét állítjuk <code>1</code>-re. Ha valamiért egy idõre szüneteltetni akarjuk a csomagok továbbküldését, akkor állítsuk a változó értékét <code>0</code>-ra.</p></div><div class=paragraph><p>Az új útválasztónak nem árt arról sem tudnia, hogy merre továbbítsa a forgalmat. Ha elég egyszerû a hálózatunk, akkor akár statikus útvonalakat is használhatunk. A FreeBSD alapból tartalmazza a BSD-k esetén szabványos <a href="https://man.freebsd.org/cgi/man.cgi?query=routed&amp;sektion=8&amp;format=html">routed(8)</a> útválasztó démont, amely a RIP (v1 és v2) valamint az IRDP megoldásokat ismeri. A BGP v4, OSPF v2 és a többi fejlettebb útválasztási protokoll a <a class=package href=https://cgit.freebsd.org/ports/tree/net/zebra/>net/zebra</a> csomagban érhetõ el. Az ettõl bonyolultabb hálózati útválasztási feladatokhoz olyan kereskedelmi termékek is elérhetõek, mint például a GateD®.</p></div></div><div class=sect3><h4 id=network-static-routes>31.2.5. Statikus útvonalak beállítása<a class=anchor href=#network-static-routes></a></h4><div class=sect4><h5 id=_manuális_konfiguráció>31.2.5.1. Manuális konfiguráció<a class=anchor href=#_manuális_konfiguráció></a></h5><div class=paragraph><p>Tegyük fel, hogy hálózatunk a következõ:</p></div><div class=imageblock><div class=content><img src=../../../../images/books/handbook/advanced-networking/static-routes.png alt="static routes"></div></div><div class=paragraph><p>Ebben a forgatókönyvben az <code>A-utvalaszto</code> a mi FreeBSD-s gépünk, amely az internet felé vezetõ útválasztó szerepét játssza. Számára az alapértelmezett útvonal a <code>10.0.0.1</code>, amelyen keresztül a külsõ világot tudja elérni. Feltételezzük, hogy a <code>B-utvalaszto</code> nevû gépet már eleve jól állítottuk be, ezért tudja merre kell mennie. (A kép alapján egyszerû: csak vegyünk fel egy alapértelmezett útvonalat a <code>B-utvalaszto</code> géphez, ahol így a <code>192.168.1.1</code> lesz az átjáró.)</p></div><div class=paragraph><p>Ha megnézzük most az <code>A-utvalaszto</code> útválasztási táblázatát, akkor nagyjából a következõket fogjuk látni:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>% netstat <span class=nt>-nr</span>
Routing tables

Internet:
Destination        Gateway            Flags    Refs      Use  Netif  Expire
default            10.0.0.1           UGS         0    49378    xl0
127.0.0.1          127.0.0.1          UH          0        6    lo0
10.0.0/24          <span class=nb>link</span><span class=c>#1             UC          0        0    xl0</span>
192.168.1/24       <span class=nb>link</span><span class=c>#2             UC          0        0    xl1</span></code></pre></div></div><div class=paragraph><p>Az <code>A-utvalaszto</code> útválasztási táblázata alapján jelen helyzetben nem lehet elérni a 2. belsõ hálózatot. Nincs ugyanis olyan útvonal, amely a <code>192.168.2.0/24</code> alhálózat felé vezetne. Ezt például úgy tudjuk megoldani, ha manuálisan felvesszük ezt az útvonalat. Az alábbi paranccsal hozzáadjuk a 2. belsõ hálózat elérését az <code>A-utvalaszto</code> útválasztási táblázatához, ahol a <code>192.168.1.2</code> lesz a következõ ugrási pont (next hop):</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># route add -net 192.168.2.0/24 192.168.1.2</span></code></pre></div></div><div class=paragraph><p>Most már az <code>A-utvalaszto</code> bármelyik gépet képes elérni a <code>192.168.2.0/24</code> hálózaton.</p></div></div><div class=sect4><h5 id=_rögzített_konfiguráció>31.2.5.2. Rögzített konfiguráció<a class=anchor href=#_rögzített_konfiguráció></a></h5><div class=paragraph><p>A fenti példa tökéletesen szemlélti a statikus útvonalak felvételét egy mûködõ rendszeren. Azonban ezzel az a gond, hogy az így megadott útválasztási információ nem marad meg a gép újraindítása után. Ezért az elõbbihez hasonló statikus útvonalakat inkább az <span class=filename>/etc/rc.conf</span> állományban rögzítsük:</p></div><div class="literalblock programlisting"><div class=content><pre># A 2. belsõ hálózat elérését felvesszük statikus útvonalként
static_routes=&#34;belsohalo2&#34;
route_belsohalo2=&#34;-net 192.168.2.0/24 192.168.1.2&#34;</pre></div></div><div class=paragraph><p>A <code>static_routes</code> konfigurációs változó karakterláncok szóközzel tagolt felsorolását tartalmazza. Mindegyik karakterlánc egy útvonal neve. Az iménti példában csak egyetlen ilyen név szerepelt a <code>static_routes</code> értékében, amely a <em>belsohalo2</em> volt. Utána beírtunk még egy konfigurációs változót is, amelynek a neve <code>route_belsohalo2</code>. Ide helyeztük a <a href="https://man.freebsd.org/cgi/man.cgi?query=route&amp;sektion=8&amp;format=html">route(8)</a> parancsnak átadandó beállítás összes paraméterét. Ez pontosan olyan, mintha a következõ parancsot adtuk volna ki:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># route add -net 192.168.2.0/24 192.168.1.2</span></code></pre></div></div><div class=paragraph><p>Ezért kellett a <code>"-net 192.168.2.0/24 192.168.1.2"</code>.</p></div><div class=paragraph><p>Ahogy már korábban is említettük, a <code>static_routes</code> értékében több karakterláncot is megadhatunk, aminek segítségével egyszerre több statikus útvonalat is létrehozhatunk. A következõ sorok arra mutatnak példát, hogy a <code>192.168.0.0/24</code> és <code>192.168.1.0/24</code> hálózatok számára miként állítsunk be statikus útvonalakat a képzeletbeli útválasztónkon:</p></div><div class="literalblock programlisting"><div class=content><pre>static_routes=&#34;net1 net2&#34;
route_net1=&#34;-net 192.168.0.0/24 192.168.0.1&#34;
route_net2=&#34;-net 192.168.1.0/24 192.168.1.1&#34;</pre></div></div></div></div><div class=sect3><h4 id=network-routing-propagation>31.2.6. Az útvonalak terjedése<a class=anchor href=#network-routing-propagation></a></h4><div class=paragraph><p>Azt már tudjuk, hogyan adjuk meg a külvilág felé vezetõ útvonalakat, azonban arról még nem beszéltünk, hogy kívülrõl miként találnak meg bennünket.</p></div><div class=paragraph><p>Annyit már megismertünk, hogy az útválasztási táblázatokban megadhatjuk a hálózaton azt a gépet, amelyen keresztül az adott címtartomány (a példában egy C osztályú alhálózat) felé küldhetünk, amely pedig továbbküldi a hozzá érkezõ csomagokat.</p></div><div class=paragraph><p>Amikor a csatlakozunk az internet-szolgáltatónkhoz, a nála levõ útválasztási táblázatok úgy állítódnak be, hogy az alhálózatunk felé igyekvõ adatok a korábban létrejött PPP összeköttetésen keresztül jutnak el hozzánk. A világ többi részén levõ rendszerek viszont honnan fogják tudni, hogy a mi internet-szolgáltatónknak küldjenek?</p></div><div class=paragraph><p>Van egy rendszer (ez leginkább a névszerverek elosztott információs adatbázisához hasonlít), ami nyilvántartja a pillanatnyilag kiosztott címtartományokat és megadja a csatlakozási pontjukat az internet gerinchálózatán. Ez a "gerinc" tulajdonképpen olyan fõvonalakból áll, amelyen keresztül a világban az országok között mozog az internet forgalma. A gerinchálózat mindegyik gépe tárolja a központi útválasztási táblázatok egy másolatát, ami a forgalmat egy adott hálózatról a megadott gerincbeli hordozóra irányítja át, végig az internet-szolgáltatók láncán egészen addig, amíg az el nem éri a hálózatunkat.</p></div><div class=paragraph><p>A szolgáltatónk feladata, hogy a gépünk felé leágazásként (és így a felénk vezetõ útként) beregisztálja magát a gerinchálózat gépein. Ezt nevezik az útvonal terjedésének.</p></div></div><div class=sect3><h4 id=network-routing-troubleshooting>31.2.7. Hibaelhárítás<a class=anchor href=#network-routing-troubleshooting></a></h4><div class=paragraph><p>Néha gondok lehetnek az útvonal terjedésével, és egyes gépek nem képesek elérni minket. A <a href="https://man.freebsd.org/cgi/man.cgi?query=traceroute&amp;sektion=8&amp;format=html">traceroute(8)</a> parancs mind közül talán az egyik leghasznosabb ilyen helyzetekben, mivel ezzel fel tudjuk deríteni, hogy az útválasztás hol akad meg. Ugyanilyen jól hasznosítható azokban az esetekben, amikor látszólag nem tudunk elérni egy távoli gépet (tehát a <a href="https://man.freebsd.org/cgi/man.cgi?query=ping&amp;sektion=8&amp;format=html">ping(8)</a> csõdöt mond).</p></div><div class=paragraph><p>A <a href="https://man.freebsd.org/cgi/man.cgi?query=traceroute&amp;sektion=8&amp;format=html">traceroute(8)</a> parancsnak annak a távoli gépnek a nevét kell megadnunk, amelyhez csatlakozni akarunk. Futása közben megjeleníti azokat az átjárókat, amelyeken keresztül csatlakozni próbál, akár sikerült elérni a célgépet, akár a kapcsolat hiánya miatt kudarcot vall.</p></div><div class=paragraph><p>A parancs használatáról és mûködésérõl részletesebb információkat a <a href="https://man.freebsd.org/cgi/man.cgi?query=traceroute&amp;sektion=8&amp;format=html">traceroute(8)</a> man oldalán találunk.</p></div></div><div class=sect3><h4 id=network-routing-multicast>31.2.8. Útválasztás multicast esetén<a class=anchor href=#network-routing-multicast></a></h4><div class=paragraph><p>A FreeBSD alapból támogatja mind a multicastet használó alkalmazásokat, mind pedig a multicasthez tartozó útválasztást. Multicast esetében semmilyen speciális beállítás nem szükségeltetik, az ilyen alkalmazások egybõl el tudják érni ezt a lehetõséget. A multicast kérések útválasztásához azonban be kell építenünk némi támogatást a rendszermagba:</p></div><div class="literalblock programlisting"><div class=content><pre>options MROUTING</pre></div></div><div class=paragraph><p>Emellett még el kell indítanunk az <a href="https://man.freebsd.org/cgi/man.cgi?query=mrouted&amp;sektion=8&amp;format=html">mrouted(8)</a> démont is, amelyhez az <span class=filename>/etc/mrouted.conf</span> állományban még be kell állítanunk tunneleket és a DVMRP használatát. A multicasthez tartozó további beállításokat az <a href="https://man.freebsd.org/cgi/man.cgi?query=mrouted&amp;sektion=8&amp;format=html">mrouted(8)</a> man oldalán találhatjuk.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>A FreeBSD 7.0 megjelenésével a <a href="https://man.freebsd.org/cgi/man.cgi?query=mrouted&amp;sektion=8&amp;format=html">mrouted(8)</a> démont kivették az alaprendszerbõl. Azt a DVMRP többesküldési protokollt valósítja meg, amelyet a legtöbb alkalmazásban mostanság már a <a href="https://man.freebsd.org/cgi/man.cgi?query=pim&amp;sektion=4&amp;format=html">pim(4)</a> segítségével oldanak meg. Ennek megfelelõen a hozzá tartozó multicast protokollt valósítja meg, amelyet a legtöbb alkalmazásban mostanság már a <a href="https://man.freebsd.org/cgi/man.cgi?query=pim&amp;sektion=4&amp;format=html">pim(4)</a> segítségével oldanak meg. Ennek megfelelõen a hozzá tartozó <a href="https://man.freebsd.org/cgi/man.cgi?query=map-mbone&amp;sektion=8&amp;format=html">map-mbone(8)</a> és <a href="https://man.freebsd.org/cgi/man.cgi?query=mrinfo&amp;sektion=8&amp;format=html">mrinfo(8)</a> segédprogramok is eltávolításra kerültek. Ezek a programok attól a kiadástól kezdõdõen a Portgyûjtemény részeként érhetõek el a <a class=package href=https://cgit.freebsd.org/ports/tree/net/mrouted/>net/mrouted</a> portban.</p></div></td></tr></tbody></table></div></div></div><div class=sect2><h3 id=network-wireless>31.3. Vezeték nélküli hálózatok<a class=anchor href=#network-wireless></a></h3><div class=sect3><h4 id=_a_vezeték_nélküli_hálózatok_alapjai>31.3.1. A vezeték nélküli hálózatok alapjai<a class=anchor href=#_a_vezeték_nélküli_hálózatok_alapjai></a></h4><div class=paragraph><p>A legtöbb vezeték nélküli hálózat az IEEE® 802.11 szabványon nyugszik. Az alapvetõ vezeték nélküli hálózatokban több olyan állomást találhatunk, amelyek egymással rádiójelek szórásával kommunikálnak a 2,4 GHz vagy 5 GHz frekvenciatartományban (noha ez a helyi viszonyoknak megfelelõen változhat, és a 2,3 GHz, illetve a 4,9 GHz tartományokban is lehetséges a kommunikáció).</p></div><div class=paragraph><p>A 802.11 szabványú hálózatok kétféleképpen szervezõdnek. Elõször is <em>infrastrukturálisan</em>, (infrastructural mode) ahol az egyik állomást kinevezzük a központnak és a többi pedig ehhez fog tartozni. Az ilyen hálózatokat BSS-nek nevezzük és az imént említett központ neve hozzáférési pont (Access Point, AP) lesz. A BSS-ben az összes kommunikáció a hozzáférési pontokon keresztül halad még abban az esetben is, amikor az egyik állomás egy másik vezeték nélküli állomással akarja felvenni a kapcsolatot. Az ilyen jellegû hálózatok másik típusú szervezõdési módjában nincsenek kijelölt központok és a kommunikáció az állomások között közvetlenül zajlik. A hálózat ezen formáját IBBS-nek nevezzük, vagy ismeretebb nevén <em>ad-hoc hálózatnak</em> (ad-hoc network).</p></div><div class=paragraph><p>A 802.11 alapú hálózatok elsõként a 2,4 GHz-es sávot hódították meg, és az IEEE® 802.11 valamint 802.11b szabványokban rögzített protokollokat használták. Ezekben a specifikációkban megtalálhatjuk a mûködési frekvenciát, a közeghozzáférési réteg jellemzõinek leírását, beleértve a keretezést és az átviteli sebességeket (a kommunikáció ugyanis eltérõ sebességekkel is történhet). A késõbb kiadott 802.11a szabvány azt specifikálja, hogy az 5 GHz-es tartományban miként mûködjenek, ahol többek közt megtalálhatjuk a különféle jelkezelési mechanizmusokat és a nagyobb átviteli sebességek használatát. Ezt még a 802.11g szabvány követte, ami a 802.11b hálózatokkal kompatibilis módon lehetõvé tette a 802.11a jelkezelésének és átviteli módszereinek használatát a 2,4 GHz-es sávban.</p></div><div class=paragraph><p>A 802.11 alapú hálózatok mindenféle átviteli technikáitól eltekintve többféle biztonsági megoldással találkozhatunk. Az korai 802.11 dokumentumok egy nagyon egyszerû biztonsági protokollt, a WEP-et említenek. Ez a protokoll a hálózaton mozgó adatokat egy rögzített és ismert osztott kulccsal kódolja le az RC4 titkosítással. A kommunikációhoz az összes állomásnak elõre meg kell egyeznie ebben a kulcsban. Errõl a sémáról idõközben kiderült, hogy könnyen feltörhetõ és manapság már csak nagyon ritkán alkalmazzák, kivéve talán csak a kóbor felhasználók elijesztésére. A jelenleg érvényes biztonsági elõírásokat az IEEE® 802.11i specifikáció adja meg, amely új kriptográfiai titkosításokat definiál valamint egy további protokollt az állomások azonosítására és a kulcsok cseréjére. Emellett a titkosításhoz használt kulcsok idõszakosan frissülnek és külön eszközök állnak rendelkezésre a betörési kísérletek észlelésére (és azok elhárítására). A vezeték nélküli hálózatok esetében másik elterjedt titkosítási protokoll a WPA. Ez igazából 802.11i elõdjének tekinthetõ, amelyet egy ipari csoport definiált, amíg a 802.11i minõsítés alatt állt. A WPA ennek megfelelõen teljesíti a 802.11i szabvány elvárásainak egy részét és kifejezetten a régi hardverek számára készült. A WPA mûködéséhez egyedül a TKIP titkosításra van szükségünk, amely az eredeti WEP titkosításból származik. A 802.11i engedi a TKIP használatát, de az adatok kódolására egy erõsebb titkosítás, az AES-CCM ismeretét is igényli. (Az AES a WPA esetében nem kell, mivel a régi eszközök esetében túlságosan költségesnek ítélték meg a használatát.)</p></div><div class=paragraph><p>A fenti szabványokon kívül a 802.11e a másik fontos szabvány, amire tekintettel kell lennünk. Ez írja le a 802.11 hálózatokon a multimédiás alkalmazások közvetítéséhez, mint például a videók valós idejû lejátszásához vagy a VoIP (voice over IP) megvalósításához tartozó protokollokat. A 802.11i szabványhoz hasonlóan a 802.11e is magában foglal egy elõzetes specifikációt, amelyet WME (késõbb pedig már WMM)-nek neveznek. Ezt szintén egy ipari csoport definiálta a 802.11e részeként, amivel a 802.11e végsõ elfogadásáig tudják a multimédiás igényeket kiszolgálni. Amit a 802.11e és WME/WMM megoldásaival kapcsolatban érdemes tudnunk: a QoS (Quality of Service) protokoll és más egyéb fejlett közeghozzáférési protokollok segítségével a vezeték nélküli hálózatokban lehetõvé teszik a forgalom prioritás szerinti ütemezését. Ezen protokollok megfelelõ implementációjának segítségével tehát a fontosabb adatok nagy sebességû küldését és áramoltatását vagyunk képesek elérni.</p></div><div class=paragraph><p>A FreeBSD a 6.0 verzió óta ismeri a 802.11a, 802.11b és 802.11g szabványokon alapján mûködõ hálózatokat. A WPA és 802.11i biztonsági protokollok (a 11a, 11b és 11g szabványok bármelyike esetén) hasonlóképpen támogatottak, valamint a WME/WMM protokollok mûködéséhez szükséges QoS csak bizonyos vezeték nélküli eszközök esetében.</p></div></div><div class=sect3><h4 id=network-wireless-basic>31.3.2. Kezdeti beállítások<a class=anchor href=#network-wireless-basic></a></h4><div class=sect4><h5 id=_a_rendszermag_beállítása_5>31.3.2.1. A rendszermag beállítása<a class=anchor href=#_a_rendszermag_beállítása_5></a></h5><div class=paragraph><p>A vezeték nélküli hálózatok használatához egy vezeték nélküli hálózati kártyára lesz szükségünk, valamint a rendszermagban is be kell állítani ehhez a megfelelõ támogatást. Ez utóbbit több különbözõ modulra szedték szét, és ezek közül csak azokat kell beállítani, amelyeket tényleg használni is fogunk.</p></div><div class=paragraph><p>Elõször is tehát kell egy vezeték nélküli eszköz. Az elterjedtebb típusaik általában az Atheos által gyártott alkatrészeket tartalmazzák. Az ilyen fajtájú eszközöket az <a href="https://man.freebsd.org/cgi/man.cgi?query=ath&amp;sektion=4&amp;format=html">ath(4)</a> meghajtó kezeli, melyet úgy tudunk a rendszer indításakor betölteni, ha a <span class=filename>/boot/loader.conf</span> állományba felvesszük a következõ sort:</p></div><div class="literalblock programlisting"><div class=content><pre>if_ath_load=&#34;YES&#34;</pre></div></div><div class=paragraph><p>Az Atheos meghajtója három különálló részre oszlik: maga a meghajtó (<a href="https://man.freebsd.org/cgi/man.cgi?query=ath&amp;sektion=4&amp;format=html">ath(4)</a>), a hardveres réteg, ami a chipfüggõ funkciókat kezeli (<a href="https://man.freebsd.org/cgi/man.cgi?query=ath_hal&amp;sektion=4&amp;format=html">ath_hal(4)</a>) és a keretek küldésével kapcsolatban az átviteli sebesség megválasztását lehetõvé tevõ algoritmus (ez itt most az ath_rate_sample). Amikor ezt a támogatást modulként töltjük be, ezek a függõségek automatikusan feloldódnak. Ha az Atheos eszközök helyett valamelyik másikhoz tartozó modult szeretnénk használni, akkor például az Intersil Prism esetében a <a href="https://man.freebsd.org/cgi/man.cgi?query=wi&amp;sektion=4&amp;format=html">wi(4)</a> meghajtót kell megadnunk:</p></div><div class="literalblock programlisting"><div class=content><pre>if_wi_load=&#34;YES&#34;</pre></div></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>A leírás további részeiben az <a href="https://man.freebsd.org/cgi/man.cgi?query=ath&amp;sektion=4&amp;format=html">ath(4)</a> eszközt fogjuk használni, minden más esetben ennek a nevét kell csak lecserélünk a példákban. A rendszerben elérhetõ vezeték nélküli meghajtók és az általuk támogatott kártyák listája a FreeBSD Hardverjegyzetekben található. Ezek a jegyzetek a különbözõ architektúrákra és kiadásokhoz a FreeBSD holnapjáról, a <a href=http://www.FreeBSD.org/releases/>Kiadási jegyzetek</a> oldalról érhetõek el. Ha a vezeték nélküli eszközünkhöz nem létezik natív FreeBSD-s meghajtó, akkor az <a href=./#config-network-ndis>NDIS</a> meghajtó segítségével akár közvetlenül a Windows®-os meghajtóját is használhatjuk.</p></div></td></tr></tbody></table></div><div class=paragraph><p>FreeBSD 7.<em>X</em> esetén az eszközmeghajtó beállításával együtt a 802.11 hálózatok támogatását is be kell töltenünk a rendszermagba. Ez az <a href="https://man.freebsd.org/cgi/man.cgi?query=ath&amp;sektion=4&amp;format=html">ath(4)</a> meghajtó esetében a legalább a <a href="https://man.freebsd.org/cgi/man.cgi?query=wlan&amp;sektion=4&amp;format=html">wlan(4)</a>, <code>wlan_scan_ap</code> és <code>wlan_scan_sta</code> modulok betöltését jelenti. A <a href="https://man.freebsd.org/cgi/man.cgi?query=wlan&amp;sektion=4&amp;format=html">wlan(4)</a> modul a vezetéknélküli eszköz meghajtóprogramjával együtt töltõdik be, míg a többi modult a <span class=filename>/boot/loader.conf</span> állomány használatával kell a rendszerindítás során betöltenünk:</p></div><div class="literalblock programlisting"><div class=content><pre>wlan_scan_ap_load=&#34;YES&#34;
wlan_scan_sta_load=&#34;YES&#34;</pre></div></div><div class=paragraph><p>A FreeBSD 8.0 kiadástól kezdõdõen ezek a modulok részei a <a href="https://man.freebsd.org/cgi/man.cgi?query=wlan&amp;sektion=4&amp;format=html">wlan(4)</a> meghajtónak, amely a hálózati kártya meghajtójával együtt mindig automatikusan betöltõdik.</p></div><div class=paragraph><p>Emellett még azokra a modulokra is szükségünk van, amelyek a használni kívánt biztonsági protokollokhoz nyújtanak kriptográfiai támogatást. Ezek hivatalosan a <a href="https://man.freebsd.org/cgi/man.cgi?query=wlan&amp;sektion=4&amp;format=html">wlan(4)</a> modul kérésére automatikusan betöltõdnek, azonban itt most manuálisan állítjuk be. Erre a célra a következõ modulokat találjuk: <a href="https://man.freebsd.org/cgi/man.cgi?query=wlan_wep&amp;sektion=4&amp;format=html">wlan_wep(4)</a>, <a href="https://man.freebsd.org/cgi/man.cgi?query=wlan_ccmp&amp;sektion=4&amp;format=html">wlan_ccmp(4)</a> és <a href="https://man.freebsd.org/cgi/man.cgi?query=wlan_tkip&amp;sektion=4&amp;format=html">wlan_tkip(4)</a>. A <a href="https://man.freebsd.org/cgi/man.cgi?query=wlan_ccmp&amp;sektion=4&amp;format=html">wlan_ccmp(4)</a> és <a href="https://man.freebsd.org/cgi/man.cgi?query=wlan_tkip&amp;sektion=4&amp;format=html">wlan_tkip(4)</a> meghajtók csak akkor fognak kelleni, ha a WPA és/vagy a 802.11i biztonsági protokollokat használjuk. Amennyiben a hálózatunkon nincs titkosítás, akkor még a <a href="https://man.freebsd.org/cgi/man.cgi?query=wlan_wep&amp;sektion=4&amp;format=html">wlan_wep(4)</a> támogatás sem kell. Ezeket a modulok úgy lehet betölteni a rendszerindításnál, ha felvesszük a következõ sorokat a <span class=filename>/boot/loader.conf</span> állományba:</p></div><div class="literalblock programlisting"><div class=content><pre>wlan_wep_load=&#34;YES&#34;
wlan_ccmp_load=&#34;YES&#34;
wlan_tkip_load=&#34;YES&#34;</pre></div></div><div class=paragraph><p>Miután ezt megcsináltuk, egyszerûen csak indítsuk újra a gépünket. Ha még nem akarjuk újraindítani a gépet, akkor a <a href="https://man.freebsd.org/cgi/man.cgi?query=kldload&amp;sektion=8&amp;format=html">kldload(8)</a> parancs segítségével akár kézzel is betölthetjük az elõbb felsorolt modulokat.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Ha nem akarunk modulokat használni, a mûködéshez szükséges meghajtókat a rendszermagba is be tudjuk építeni a következõ sorok megadásával a rendszermag beállításait tartalmazó állományban:</p></div><div class="literalblock programlisting"><div class=content><pre>device wlan                # a 802.11 támogatása
device wlan_wep            # 802.11 WEP  támogatás
device wlan_ccmp           # 802.11 CCMP támogatás
device wlan_tkip           # 802.11 TKIP támogatás
device wlan_amrr           # AMRR forgalomvezérlési algoritmus
device ath                 # Atheros IEEE 802.11 vezeték nélküli hálózati meghajtó
device ath_hal             # az Atheros meghajtó hardveres rétege
options AH_SUPPORT_AR5416  # az AR5416 tx/rx leírók engedélyezése
device ath_rate_sample     # SampleRate forgalomvezérlési algoritmus</pre></div></div><div class=paragraph><p>Hozzátesszük, hogy az alábbi sorok hozzáadása a FreeBSD 7.<em>X</em> változatában kötelezõ, más verzióknál viszont nem:</p></div><div class="literalblock programlisting"><div class=content><pre>device wlan_scan_ap        # a 802.11 AP módú keresés
device wlan_scan_sta       # a 802.11 STA módú keresés</pre></div></div><div class=paragraph><p>Az elõbbiek megadásával fordítsuk újra és telepítsük a rendszermagot, majd indítsuk újra a számítógépünket.</p></div></td></tr></tbody></table></div><div class=paragraph><p>Miután a rendszerünk újra elindult, a rendszer indítás során generált üzenetei között találnunk kell valamennyi információt a felismert vezeték nélküli eszközökrõl. Például:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>ath0: &lt;Atheros 5212&gt; mem 0x88000000-0x8800ffff irq 11 at device 0.0 on cardbus1
ath0: <span class=o>[</span>ITHREAD]
ath0: AR2413 mac 7.9 RF2413 phy 4.5</code></pre></div></div></div></div><div class=sect3><h4 id=_az_infrastrukturális_mûködési_mód>31.3.3. Az infrastrukturális mûködési mód<a class=anchor href=#_az_infrastrukturális_mûködési_mód></a></h4><div class=paragraph><p>Általában az infrastrukturális avagy a BBS mód használata a gyakori. Ebben a mûködési módban adott számú vezeték nélküli hozzáférési pont csatlakozik a hagyományos hálózatra. Mindegyik vezeték nélküli hálózatnak saját neve van, amit a hálózat SSID-jének hívunk. A vezeték nélküli kliensek ezekhez a vezeték nélküli hozzáférési pontokhoz kapcsolódnak.</p></div><div class=sect4><h5 id=_a_freebsd_s_kliensek_használata>31.3.3.1. A FreeBSD-s kliensek használata<a class=anchor href=#_a_freebsd_s_kliensek_használata></a></h5><div class=sect5><h6 id=_hogyan_keressünk_hozzáférési_pontokat>31.3.3.1.1. Hogyan keressünk hozzáférési pontokat<a class=anchor href=#_hogyan_keressünk_hozzáférési_pontokat></a></h6><div class=paragraph><p>A hálózatok kereséséhez az <code>ifconfig</code> paranccsal tudunk nekifogni. Egy ilyen kérés kiszolgálása eltarthat néhány pillanatig, mivel ekkor a rendszernek végig kell bóklásznia az összes elérhetõ frekvenciát és azokon hozzáférési pontok után kutatni. Egyedül a rendszeradminisztrátor kezdeményezheti ezeket a kereséseket:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># ifconfig wlan0 create wlandev ath0</span>
<span class=c># ifconfig wlan0 up scan</span>
SSID/MESH ID    BSSID              CHAN RATE  S:N     INT CAPS
dlinkap         00:13:46:49:41:76   11   54M <span class=nt>-90</span>:96   100 EPS  WPA WME
freebsdap       00:11:95:c3:0d:ac    1   54M <span class=nt>-83</span>:96   100 EPS  WPA</code></pre></div></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Csak <code>up</code> jelzésû felületen tudunk hálózatokat keresni. További keresésekre már nincs szükség a felület <code>up</code> állapotban tartásához.</p></div></td></tr></tbody></table></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>FreeBSD 7.<em>X</em> esetén a <span class=filename>wlan0</span> eszköz helyett közvetlenül az adott eszköz nevét kell megadnunk, például <span class=filename>ath0</span>. Az iménti sorokat ennek megfelelõen tehát ebben az esetben így kell értelmezni:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># ifconfig ath0 up scan</span></code></pre></div></div><div class=paragraph><p>A leírás további részében a FreeBSD 7.<em>X</em> felhasználóknak ezen séma alapján kell használniuk a parancsokat és a konfigurációs beállításokat.</p></div></td></tr></tbody></table></div><div class=paragraph><p>A keresés során keletkezõ listában láthatjuk megtalált BBS vagy IBBS fajtájú hálózatokat. A hálózatok neve és <code>SSID</code>-ja mellett még megjelenik egy <code>BSSID</code> oszlop is, ahol a hozzáférési pontok MAC-címe szerepel. A <code>CAPS</code> oszlop az egyes állomások tulajdonságait adja meg:</p></div><div class=dlist><dl><dt class=hdlist1><code>E</code></dt><dd><p>Extended Service Set (ESS): az állomás egy infrastrukturális vagyis BBS hálózat része.</p></dd><dt class=hdlist1><code>I</code></dt><dd><p>IBSS/ad-hoc hálózat: az állomás egy ad-hoc hálózat része.</p></dd><dt class=hdlist1><code>P</code></dt><dd><p>Privacy: a BBS-en belül minden keretet titkosítani kell. Tehát a BSS arra kötelezi az állomást, hogy WEP, TKIP vagy AES-CCMP titkosítás használatával kódolja a hálózat tagjai között közlekedõ kereteket.</p></dd><dt class=hdlist1><code>S</code></dt><dd><p>Short Preamble: a hálózatban rövid bevezetõjeleket használnak (a 802.11b High Rate/DSSS PHY elõírásai szerint), ahol a szokványos 128 bites szinkronizációs mezõ hossza csak 56 bit.</p></dd><dt class=hdlist1><code>s</code></dt><dd><p>Short Slot Time: a 802.11g hálózat rövid slotidõt használ, mivel nem találhatóak benne régi (802.11b szabványú) állomások.</p></dd></dl></div><div class=paragraph><p>A jelenleg ismert hálózatok listáját így tudjuk lekérdezni:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># ifconfig wlan0 list scan</span></code></pre></div></div><div class=paragraph><p>Ezt az információt maga az adapter automatikusan, vagy a felhasználó tudja frissíteni a <code>scan</code> kérés kiadásával. Az elavult adatok maguktól törlõdnek a gyorsítótárból, így idõvel a lista zsugorodni fog, hacsak nem keresünk folyamatosan hálózatokat.</p></div></div><div class=sect5><h6 id=_alapvetõ_beállítások_2>31.3.3.1.2. Alapvetõ beállítások<a class=anchor href=#_alapvetõ_beállítások_2></a></h6><div class=paragraph><p>Ebben a szakaszban arra mutatunk példákat, hogy miként tudunk FreeBSD alatt titkosítás nélkül használni egy vezeték nélküli hálózati kártyát. Miután elsajátítottuk az itt szereplõ ismereteket, határozottan javasoljuk, hogy a vezeték nélküli hálózatunkat <a href=#network-wireless-wpa>WPA</a> használatával állítsuk be.</p></div><div class=paragraph><p>A vezeték nélküli hálózatok beállítása három elemi lépésbõl épül fel: a hozzáférési pont kiválasztása, az állomásunk hitelesítése és az IP-cím beállítása. A következõkben ezeket a lépéseket vitatjuk meg.</p></div><div class=sect6><h7 id=_a_hozzáférési_pont_kiválasztása>31.3.3.1.2.1. A hozzáférési pont kiválasztása<a class=anchor href=#_a_hozzáférési_pont_kiválasztása></a></h7><div class=paragraph><p>A legtöbb esetben hagyjuk, hogy a rendszer válassza ki magának a különbözõ heurisztikák alapján a leginkább megfelelõ hozzáférési pontot. Ez az alapértelmezett tevékenység, amikor aktiváljuk a felületet vagy valamilyen más módon, például az<span class=filename>/etc/rc.conf</span> állományból hivatkozunk rá:</p></div><div class="literalblock programlisting"><div class=content><pre>wlans_ath0=&#34;wlan0&#34;
ifconfig_wlan0=&#34;DHCP&#34;</pre></div></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>A korábban említettek szerint a FreeBSD 7.<em>X</em> felhasználóknak csak a kártyát kell beállítani:</p></div><div class="literalblock programlisting"><div class=content><pre>ifconfig_ath0=&#34;DHCP&#34;</pre></div></div></td></tr></tbody></table></div><div class=paragraph><p>Ha viszont több hozzáférési pont közül mi magunk akarunk kiválasztani egyet, akkor ezt az SSID megadásával tehetjük meg:</p></div><div class="literalblock programlisting"><div class=content><pre>wlans_ath0=&#34;wlan0&#34;
ifconfig_wlan0=&#34;ssid saját_ssid DHCP&#34;</pre></div></div><div class=paragraph><p>Amikor olyan környezetben vagyunk, ahol több hozzáférési pontnak is megegyezik az SSID-ja (gyakran így próbálják egyszerûsíteni azt, hogy automatikusan váltani lehessen köztük), akkor szükségünk lehet ezt egy adott eszközhöz hozzárendelni. Ebben az esetben a hozzáférési pont BSSID-ját is definiálni kell (és az SSID-t akár el is hagyhatjuk):</p></div><div class="literalblock programlisting"><div class=content><pre>wlans_ath0=&#34;wlan0&#34;
ifconfig_wlan0=&#34;ssid saját_ssid bssid xx:xx:xx:xx:xx:xx DHCP&#34;</pre></div></div><div class=paragraph><p>Más módokon is képesek vagyunk szabályozni a hozzáférési pontok megválasztását, például a rendszerünk által vizsgált frekvenciasávok megadásával. Ez olyankor tud hasznos lenni, ha többsávos vezeték nélküli kártyánk van, és az összes tartomány végigpásztázása túlságosan sok idõt venne el. Ezt a mûvelet a <code>mode</code> paraméter megadásával lehet egy konkrét sávra leszûkíteni, például a</p></div><div class="literalblock programlisting"><div class=content><pre>wlans_ath0=&#34;wlan0&#34;
ifconfig_wlan0=&#34;mode 11g ssid saját_ssid DHCP&#34;</pre></div></div><div class=paragraph><p>beállítás hatására a kártya 802.11g módban fog üzemelni, ami kizárólag csak 2,4 GHz-es frekvenciákon használható, így az 5 GHz-es csatornákat egyszerûen figyelmen kívül hagyjuk. Ugyanezt a <code>channel</code> paraméterrel is meg tudjuk oldani, mivel így a mûködést egy adott frekvenciára korlátozzuk, valamint a <code>chanlist</code> paraméterrel, ahol a pásztázandó csatornákat sorolhatjuk fel. Ezekrõl a paraméterekrõl részletesebb leírást az <a href="https://man.freebsd.org/cgi/man.cgi?query=ifconfig&amp;sektion=8&amp;format=html">ifconfig(8)</a> man oldalon találhatunk.</p></div></div><div class=sect6><h7 id=_hitelesítés>31.3.3.1.2.2. Hitelesítés<a class=anchor href=#_hitelesítés></a></h7><div class=paragraph><p>Miután sikeresen kiválasztottuk a számunkra megfelelõ hozzáférési pontot, az adatok küldéséhez az állomásunknak valamilyen módon hitelesítenie kell magát. A hitelesítés több módon történhet. Erre a leggyakrabban alkalmazott sémát nyílt hitelesítésnek (open authentication) nevezik, ahol a hálózathoz tetszõleges állomás csatlakozhat és kommunikálhat vele. Ezt a típusú hitelesítést akkor érdemes használni, amikor a vezeték nélküli hálózatunkat teszteljük. Más sémákban az adatfolyam megindításához egy titkosítási kézfogás szükséges, vagy elõre megosztott kulcsok esetleg jelszavak segítségével, vagy bonyolultabb sémák esetében itt még olyan különbözõ háttérszolgáltatások is megjelennek, mint például a RADIUS. A legtöbb felhasználó a nyílt hitelesítést használja, ami egyben az alapértelmezés is. A másik legelterjedtebb beállítás a WPA-PSK, avagy WPA Personal, amelyrõl <a href=#network-wireless-wpa-wpa-psk>lentebb</a> még szólni fogunk.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Ha Apple® AirPort® Extreme Base Station típusú hozzáférési pontunk van, akkor az osztott kulcsú hitelesítés mellett egy WEP kulcsot is be állítanunk. Ezt az <span class=filename>/etc/rc.conf</span> állományban vagy a <a href="https://man.freebsd.org/cgi/man.cgi?query=wpa_supplicant&amp;sektion=8&amp;format=html">wpa_supplicant(8)</a> programban tehetjük meg. Ha egyetlen AirPort® bázisállomásunk van, akkor az elérést valahogy így tudjuk beállítani:</p></div><div class="literalblock programlisting"><div class=content><pre>wlans_ath0=&#34;wlan0&#34;
ifconfig_wlan0=&#34;authmode shared wepmode on weptxkey 1 wepkey 01234567 DHCP&#34;</pre></div></div><div class=paragraph><p>Általánosságban véve elmondhatjuk, hogy az osztott kulcsú hitelesítést inkább kerüljük el, mivel WEP kulcsok használatára alapszik és ráadásul olyan módon, hogy nagyon könnyû feltörni. Ha már mindenképpen a WEP mellett kell döntenünk (például a régebbi eszközökkel így tudunk csak kompatibilisek maradni), akkor jobban járunk, ha a <code>nyílt</code> hitelesítéshez alkalmazzuk. A WEP használatát érintõ további információkat a <a href=#network-wireless-wep>WEP</a>ban találjuk.</p></div></td></tr></tbody></table></div></div><div class=sect6><h7 id=_ip_cím_szerzése_dhcp_használatával>31.3.3.1.2.3. IP-cím szerzése DHCP használatával<a class=anchor href=#_ip_cím_szerzése_dhcp_használatával></a></h7><div class=paragraph><p>Miután kiválasztottunk egy hozzáférési pontot és beállítottuk a hitelesítés paramétereit, egy IP-cím is kelleni fog a kommunikációhoz. Az esetek túlnyomó részében DHCP-n keresztül kapunk IP-címet a vezeték nélküli kapcsolatunkhoz. Ezt úgy érhetjük el, ha egyszerûen megnyitjuk az <span class=filename>/etc/rc.conf</span> állományt és az alábbihoz hasonló módon felvesszük a <code>DHCP</code> paramétert az eszközünk beállításaihoz:</p></div><div class="literalblock programlisting"><div class=content><pre>wlans_ath0=&#34;DHCP&#34;
ifconfig_wlan0=&#34;DHCP&#34;</pre></div></div><div class=paragraph><p>Így már készen is állunk a vezeték nélküli felület használatára:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># /etc/rc.d/netif start</span></code></pre></div></div><div class=paragraph><p>Ahogy a felület mûködõképessé válik, az <code>ifconfig</code> parancs segítségével ellenõrizni is tudjuk az <span class=filename>ath0</span> felület állapotát:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># ifconfig wlan0</span>
wlan0: <span class=nv>flags</span><span class=o>=</span>8843&lt;UP,BROADCAST,RUNNING,SIMPLEX,MULTICAST&gt; mtu 1500
        ether 00:11:95:d5:43:62
        inet 192.168.1.100 netmask 0xffffff00 broadcast 192.168.1.255
        media: IEEE 802.11 Wireless Ethernet OFDM/54Mbps mode 11g
        status: associated
        ssid dlinkap channel 11 <span class=o>(</span>2462 Mhz 11g<span class=o>)</span> bssid 00:13:46:49:41:76
        country US ecm authmode OPEN privacy OFF txpower 21.5 bmiss 7
        scanvalid 60 bgscan bgscanintvl 300 bgscanidle 250 roam:rssi 7
        roam:rate 5 protmode CTS wme burst</code></pre></div></div><div class=paragraph><p>A <code>status: associated</code> azt jelenti, hogy sikeresen csatlakoztunk egy vezeték nélküli hálózathoz (jelen esetben ez a <code>dlinkap</code>). A <code>bssid 00:13:46:49:41:76</code> rész a hozzáférési pont MAC-címét tartalmazza. Az <code>authmode OPEN</code> pedig arról számol be, hogy a kommunikáció nem titkosított.</p></div></div><div class=sect6><h7 id=_statikus_ip_cím>31.3.3.1.2.4. Statikus IP-cím<a class=anchor href=#_statikus_ip_cím></a></h7><div class=paragraph><p>Ha valami okból nem tudjuk az IP-címünket DHCP szerveren keresztül lekérni, beállíthatunk rögzített IP-címet is. Ehhez nem kell mást tennünk, mint a korábban bemutatott <code>DHCP</code> kulcsszót kicserélni egy konkrét címmel. A hozzáférési ponthoz megadott többi paramétert azonban feltétlenül hagyjuk meg:</p></div><div class="literalblock programlisting"><div class=content><pre>wlans_ath0=&#34;wlan0&#34;
ifconfig_wlan0=&#34;inet 192.168.1.100 netmask 255.255.255.0ssid saját_ssidi&#34;</pre></div></div></div></div><div class=sect5><h6 id=network-wireless-wpa>31.3.3.1.3. WPA<a class=anchor href=#network-wireless-wpa></a></h6><div class=paragraph><p>A WPA (Wi-Fi Protected Access, vagyis védett wi-fi hozzáférés) a 802.11 szabványokban használatos biztonsági protokoll, amelyet a <a href=#network-wireless-wep>WEP</a> gyengeségeinek és megfelelõ hitelesítésének ellensúlyozására dolgoztak ki. A WPA a 802.1X hitelesítési protokolljait erõsíti és az adat sértetlenségének megõrzésére a WEP helyett több titkosítási algoritmust is felhasznál. A WPA által igényelt egyetlen titkosítás a TKIP (Temporary Key Integrity Protocol, vagyis az ideiglenes kulcs integritási protokoll), amely a WEP által az integritás ellenõrzésére és a bejutások észlelésére és azok reagálására szánt alap RC4 titkosítást bõvíti ki. A TKIP a régebbi hardvereken csupán szoftveres módosítással mûködõképessé tehetõ. Ez a kompromisszum a védelmet ugyan növeli, de még mindig kevés a támadások megfelelõ elhárításához. A WPA a TKIP mellett tartalmazza még az AES-CCMP titkosítást is, és ennek a használata javasolt. Ezt a specifikációt gyakran WPA2 (vagy RSN) néven emlegetik.</p></div><div class=paragraph><p>A WPA definiál hitelesítési és titkosítási protokollokat. A hitelesítés általában a következõ két technika egyike alapján történik: vagy 802.1X és egy háttérszolgáltatás, például a RADIUS segítségével, vagy egy elõre megosztott kulcsot alkalmazó minimális kézfogással az állomás és a hozzáférési pont között. Az elõbbit gyakran WPA Enterprise-nak, míg az utóbbit WPA Personalnak hívják. Mivel a legtöbben nem állítanak be egy komplett RADIUS alapú szervert a vezeték nélküli hálózatukhoz, ezért a WPA-PSK a WPA leginkább elterjedten használt változata.</p></div><div class=paragraph><p>A vezeték nélküli kapcsolat és a hitelesítés (kulcs alapján vagy szerverrel) vezérlését a <a href="https://man.freebsd.org/cgi/man.cgi?query=wpa_supplicant&amp;sektion=8&amp;format=html">wpa_supplicant(8)</a> segédprogram végzi. Ennek a programnak mûködéséhez egy konfigurációs állományra van szüksége, amely az <span class=filename>/etc/wpa_supplicant.conf</span> néven érhetõ el. Errõl az állományról bõvebb információt a <a href="https://man.freebsd.org/cgi/man.cgi?query=wpa_supplicant.conf&amp;sektion=5&amp;format=html">wpa_supplicant.conf(5)</a> man oldalán lelhetünk.</p></div><div class=sect6><h7 id=network-wireless-wpa-wpa-psk>31.3.3.1.3.1. WPA-PSK<a class=anchor href=#network-wireless-wpa-wpa-psk></a></h7><div class=paragraph><p>A WPA-PSK, más néven WPA-Personal, egy adott jelszó alapján generált elõre megosztott kulcssal (pre-shared key, PSK) mûködik, amit a vezeték nélküli hálózatokban mesterkulcsént használnak. Ez azt jelenti, hogy minden egyes vezeték nélküli felhasználó ugyanazon a kulcson osztozik. A WPA-PSK olyan kis méretû hálózatok esetében megfelelõ, ahol a hitelesítést elvégzõ szerver használata nem lehetséges vagy nem oldható meg.</p></div><div class="admonitionblock warning"><table><tbody><tr><td class=icon><i class="fa icon-warning" title=Warning></i></td><td class=content><div class=paragraph><p>Mindig igyekezzünk erõs jelszavakat használni, melyek kellõen hosszúak és sokféle karaktert tartalmaznak, és így nehezebben fejthetõek meg vagy törhetõek fel.</p></div></td></tr></tbody></table></div><div class=paragraph><p>Elõször az <span class=filename>/etc/wpa_supplicant.conf</span> állományban állítsuk be az SSID-t és a hálózatunkhoz tartozó elõre megosztott kulcsot:</p></div><div class="literalblock programlisting"><div class=content><pre>network={
  ssid=&#34;freebsdap&#34;
  psk=&#34;freebsdmall&#34;
}</pre></div></div><div class=paragraph><p>Ezután az <span class=filename>/etc/rc.conf</span> állományban jelezzük, hogy a vezeték nélküli eszközt a WPA segítségével állítjuk be és az IP-címet a DHCP szervertõl kérjük el:</p></div><div class="literalblock programlisting"><div class=content><pre>wlans_ath0=&#34;wlan0&#34;
ifconfig_ath0=&#34;WPA DHCP&#34;</pre></div></div><div class=paragraph><p>Innentõl már fel is tudjuk éleszteni a felületet:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># /etc/rc.d/netif start</span>
Starting wpa_supplicant.
DHCPDISCOVER on wlan0 to 255.255.255.255 port 67 interval 5
DHCPDISCOVER on wlan0 to 255.255.255.255 port 67 interval 6
DHCPOFFER from 192.168.0.1
DHCPREQUEST on wlan0 to 255.255.255.255 port 67
DHCPACK from 192.168.0.1
bound to 192.168.0.254 <span class=nt>--</span> renewal <span class=k>in </span>300 seconds.
wlan0: <span class=nv>flags</span><span class=o>=</span>8843&lt;UP,BROADCAST,RUNNING,SIMPLEX,MULTICAST&gt; mtu 1500
      ether 00:11:95:d5:43:62
      inet 192.168.0.254 netmask 0xffffff00 broadcast 192.168.0.255
      media: IEEE 802.11 Wireless Ethernet autoselect OFDM/36Mbps mode 11g
      status: associated
      ssid freebsdap channel 1 <span class=o>(</span>2412 Mhz 11g<span class=o>)</span> bssid 00:11:95:c3:0d:ac
      country US ecm authmode WPA2/802.11i privacy ON deftxkey UNDEF
      AES-CCM 3:128-bit txpower 21.5 bmiss 7 scanvalid 450 bgscan
      bgscanintvl 300 bgscanidle 250 roam:rssi 7 roam:rate 5 protmode CTS
      wme burst roaming MANUAL</code></pre></div></div><div class=paragraph><p>Kézzel is megpróbálhatjuk elindítani az <a href=#network-wireless-wpa-wpa-psk>elõbb</a> elkészített <span class=filename>/etc/wpa_supplicant.conf</span> állomány használatával:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># wpa_supplicant -i wlan0 -c /etc/wpa_supplicant.conf</span>
Trying to associate with 00:11:95:c3:0d:ac <span class=o>(</span><span class=nv>SSID</span><span class=o>=</span><span class=s1>&#39;freebsdap&#39;</span> <span class=nv>freq</span><span class=o>=</span>2412 MHz<span class=o>)</span>
Associated with 00:11:95:c3:0d:ac
WPA: Key negotiation completed with 00:11:95:c3:0d:ac <span class=o>[</span><span class=nv>PTK</span><span class=o>=</span>CCMP <span class=nv>GTK</span><span class=o>=</span>CCMP]
CTRL-EVENT-CONNECTED - Connection to 00:11:95:c3:0d:ac completed <span class=o>(</span>auth<span class=o>)</span> <span class=o>[</span><span class=nb>id</span><span class=o>=</span>0 <span class=nv>id_str</span><span class=o>=]</span></code></pre></div></div><div class=paragraph><p>A következõ parancs a <code>dhclient</code> indítása legyen, amivel megszerezzük a DHCP szervertõl az IP-címünket:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># dhclient wlan0</span>
DHCPREQUEST on wlan0 to 255.255.255.255 port 67
DHCPACK from 192.168.0.1
bound to 192.168.0.254 <span class=nt>--</span> renewal <span class=k>in </span>300 seconds.
<span class=c># ifconfig wlan0</span>
ath0: <span class=nv>flags</span><span class=o>=</span>8843&lt;UP,BROADCAST,RUNNING,SIMPLEX,MULTICAST&gt; mtu 1500
      ether 00:11:95:d5:43:62
      inet 192.168.0.254 netmask 0xffffff00 broadcast 192.168.0.255
      media: IEEE 802.11 Wireless Ethernet OFDM/36Mbps mode 11g
      status: associated
      ssid freebsdap channel 1 <span class=o>(</span>2412 Mhz 11g<span class=o>)</span> bssid 00:11:95:c3:0d:ac
      country US ecm authmode WPA2/802.11i privacy ON deftxkey UNDEF
      AES-CCM 3:128-bit txpower 21.5 bmiss 7 scanvalid 450 bgscan
      bgscanintvl 300 bgscanidle 250 roam:rssi 7 roam:rate 5 protmode CTS
      wme burst roaming MANUAL</code></pre></div></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Ha az <span class=filename>/etc/rc.conf</span> állományban szerepel a <code>ifconfig_wlan0="DHCP"</code> sor, akkor egyáltalán nem szükséges a <code>dhclient</code> parancs manuális kiadása, mivel a <code>dhclient</code> magától el fog indulni, miután a <code>wpa_supplicant</code> egyeztette a kulcsokat.</p></div></td></tr></tbody></table></div><div class=paragraph><p>Amikor a DHCP nem használható, megadhatunk a statikus IP-címet is, miután a <code>wpa_supplicant</code> sikeresen lebonyolította a hitelesítést:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># ifconfig wlan0 inet 192.168.0.100 netmask 255.255.255.0</span>
<span class=c># ifconfig wlan0</span>
ath0: <span class=nv>flags</span><span class=o>=</span>8843&lt;UP,BROADCAST,RUNNING,SIMPLEX,MULTICAST&gt; mtu 1500
      ether 00:11:95:d5:43:62
      inet 192.168.0.100 netmask 0xffffff00 broadcast 192.168.0.255
      media: IEEE 802.11 Wireless Ethernet OFDM/36Mbps mode 11g
      status: associated
      ssid freebsdap channel 1 <span class=o>(</span>2412 Mhz 11g<span class=o>)</span> bssid 00:11:95:c3:0d:ac
      country US ecm authmode WPA2/802.11i privacy ON deftxkey UNDEF
      AES-CCM 3:128-bit txpower 21.5 bmiss 7 scanvalid 450 bgscan
      bgscanintvl 300 bgscanidle 250 roam:rssi 7 roam:rate 5 protmode CTS
      wme burst roaming MANUAL</code></pre></div></div><div class=paragraph><p>Ha egyáltalán nem használunk DHCP szervert, akkor nekünk kell beállítani az alapértelmezett átjárót és a névszervert is:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># route add default alapértelmezett_átjáró</span>
<span class=c># echo &#34;nameserver névszerver&#34; &gt;&gt; /etc/resolv.conf</span></code></pre></div></div></div><div class=sect6><h7 id=network-wireless-wpa-eap-tls>31.3.3.1.3.2. WPA és EAP-TLS<a class=anchor href=#network-wireless-wpa-eap-tls></a></h7><div class=paragraph><p>A másik mód, ahogy a WPA használható, az a 802.1X hitelesítési szerveren keresztül történik, és ebben az esetben a WPA neve WPA-Enterprise. Ez sokkal biztonságosabb a WPA-Personal elõre kiosztott kulcsaival szemben. A WPA-Enterprise az EAP (Extensible Authentication Protocol, azaz Bõvíthetõ hitelesítési protokoll) használatán alapszik.</p></div><div class=paragraph><p>Az EAP önmaga nem végez titkosítást, mivel úgy alakították ki, hogy magát az EAP protokollt kell egy titkosított járaton keresztül bújtatni. Az EAP hitelesítési módszereinek több típusát is kidolgozták, melyek közül a legismertebbek az EAP-TLS, EAP-TTLS valamint a EAP-PEAP.</p></div><div class=paragraph><p>Az EAP-TLS (EAP szállítási rétegbeli védelemmel) a vezeték nélküli világban egy nagyon jól támogatott hitelesítési protokoll, mivel ez volt az elsõ EAP módszer, amit a <a href=http://www.wi-fi.org/>Wi-fi szövetség</a> jóváhagyott. Az EAP-TLS mûködéséhez három tanúsítvány kell: egy hitelesítõ hatóságtól (Certificate Authority, CA), egy a hitelesítést végzõ szervertõl és egy a klienstõl. Ezzel az EAP módszerrel mind a hitelesítõ szerver, mind a vezeték nélküli kliens külön képviselik a saját tanúsítványaikat, és ezeket a szervezetünket hitelesítõ hatóság aláírása alapján ellenõrzik.</p></div><div class=paragraph><p>A korábbiaknak megfelelõen a beállításokat szintén az <span class=filename>/etc/wpa_supplicant.conf</span> állományon keresztül végezzük el:</p></div><div class="literalblock programlisting"><div class=content><pre>network={
  ssid=&#34;freebsdap&#34; <i class=conum data-value=1></i><b>(1)</b>
  proto=RSN  <i class=conum data-value=2></i><b>(2)</b>
  key_mgmt=WPA-EAP <i class=conum data-value=3></i><b>(3)</b>
  eap=TLS <i class=conum data-value=4></i><b>(4)</b>
  identity=&#34;loader&#34; <i class=conum data-value=5></i><b>(5)</b>
  ca_cert=&#34;/etc/certs/cacert.pem&#34; <i class=conum data-value=6></i><b>(6)</b>
  client_cert=&#34;/etc/certs/clientcert.pem&#34; <i class=conum data-value=7></i><b>(7)</b>
  private_key=&#34;/etc/certs/clientkey.pem&#34; <i class=conum data-value=8></i><b>(8)</b>
  private_key_passwd=&#34;freebsdmallclient&#34; <i class=conum data-value=9></i><b>(9)</b>
}</pre></div></div><div class="colist arabic"><table><tbody><tr><td><i class=conum data-value=1></i><b>1</b></td><td>Ez a mezõ adja meg a hálózat nevét (SSID).</td></tr><tr><td><i class=conum data-value=2></i><b>2</b></td><td>Itt az RSN (IEEE® 802.11i), vagyis a WPA2 protokollt használjuk.</td></tr><tr><td><i class=conum data-value=3></i><b>3</b></td><td>A <code>key_mgmt</code> sor a kulcskezelési protokollt adja meg. A mi esetünkben ez a WPA lesz, EAP hitelesítéssel: <code>WPA-EAP</code>.</td></tr><tr><td><i class=conum data-value=4></i><b>4</b></td><td>Ebben a mezõben az EAP módszert nevezzük meg a kapcsolathoz.</td></tr><tr><td><i class=conum data-value=5></i><b>5</b></td><td>Az <code>identity</code> mezõ az EAP esetén használt azonosítót tartalmazza.</td></tr><tr><td><i class=conum data-value=6></i><b>6</b></td><td>A <code>ca_cert</code> mezõ a hitelesítõ hatóság tanúsítványát tároló állomány elérési útvonalát adja meg. Ezt a szerver tanúsítványának hitelesítéséhez használjuk.</td></tr><tr><td><i class=conum data-value=7></i><b>7</b></td><td>A <code>client_cert</code> sor a kliens tanúsítványát tartalmazó állomány elérési útvonalát adja meg. Ennek a vezeték nélküli hálózat minden egyes kliense esetében egyedinek kell lennie.</td></tr><tr><td><i class=conum data-value=8></i><b>8</b></td><td>A <code>private_key</code> mezõ a kliens tanúsítvánáynak privát kulcsát tároló állomány elérési útját adja meg.</td></tr><tr><td><i class=conum data-value=9></i><b>9</b></td><td>A <code>private_key_passwd</code> mezõ a privát kulcshoz tartozó jelmondatot rögzíti.</td></tr></tbody></table></div><div class=paragraph><p>Az <span class=filename>/etc/rc.conf</span> állományba vegyük fel a következõ sorokat:</p></div><div class="literalblock programlisting"><div class=content><pre>wlans_ath0=&#34;wlan0&#34;
ifconfig_wlan0=&#34;WPA DHCP&#34;</pre></div></div><div class=paragraph><p>A következõ lépés a felület felébresztése lesz az <span class=filename>rc.d</span> eszköz segítségével:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># /etc/rc.d/netif start</span>
Starting wpa_supplicant.
DHCPREQUEST on wlan0 to 255.255.255.255 port 67
DHCPREQUEST on wlan0 to 255.255.255.255 port 67
DHCPACK from 192.168.0.20
bound to 192.168.0.254 <span class=nt>--</span> renewal <span class=k>in </span>300 seconds.
wlan0: <span class=nv>flags</span><span class=o>=</span>8843&lt;UP,BROADCAST,RUNNING,SIMPLEX,MULTICAST&gt; mtu 1500
      ether 00:11:95:d5:43:62
      inet 192.168.0.254 netmask 0xffffff00 broadcast 192.168.0.255
      media: IEEE 802.11 Wireless Ethernet DS/11Mbps mode 11g
      status: associated
      ssid freebsdap channel 1 <span class=o>(</span>2412 Mhz 11g<span class=o>)</span> bssid 00:11:95:c3:0d:ac
      country US ecm authmode WPA2/802.11i privacy ON deftxkey UNDEF
      AES-CCM 3:128-bit txpower 21.5 bmiss 7 scanvalid 450 bgscan
      bgscanintvl 300 bgscanidle 250 roam:rssi 7 roam:rate 5 protmode CTS
      wme burst roaming MANUAL</code></pre></div></div><div class=paragraph><p>Természetesen, ahogy azt már az elõbbiekben is megmutattuk, mindezt manuálisan is el tudjuk végezni a <code>wpa_supplicant</code> és az <code>ifconfig</code> parancsok segítségével.</p></div></div><div class=sect6><h7 id=network-wireless-wpa-eap-ttls>31.3.3.1.3.3. WPA és EAP-TTLS<a class=anchor href=#network-wireless-wpa-eap-ttls></a></h7><div class=paragraph><p>Az EAP-TLS használatakor mind a hitelesítést végzõ szervernek és kliensnek is kell tanúsítvány, azonban az EAP-TTLS ( szállítási rétegbeli védelem EAP tunnelen keresztül) esetében a kliensnél ez elhagyható. Ez a módszer nagyjából olyan, mint amit a webes oldalak csinálnak, ahol a webszerverek egy védett SSL tunnelt képeznek még akkor is, amikor a látogatók nem rendelkeznek kliens oldali tanúsítvánnyal. Az EAP-TTLS egy titkosított TLS tunnelen keresztül védi le a hitelesítési adatok forgalmát.</p></div><div class=paragraph><p>Ezt ismét az <span class=filename>/etc/wpa_supplicant.conf</span> állományon keresztül tudjuk beállítani:</p></div><div class="literalblock programlisting"><div class=content><pre>network={
  ssid=&#34;freebsdap&#34;
  proto=RSN
  key_mgmt=WPA-EAP
  eap=TTLS <i class=conum data-value=1></i><b>(1)</b>
  identity=&#34;test&#34; <i class=conum data-value=2></i><b>(2)</b>
  password=&#34;test&#34; <i class=conum data-value=3></i><b>(3)</b>
  ca_cert=&#34;/etc/certs/cacert.pem&#34; <i class=conum data-value=4></i><b>(4)</b>
  phase2=&#34;auth=MD5&#34; <i class=conum data-value=5></i><b>(5)</b>
}</pre></div></div><div class="colist arabic"><table><tbody><tr><td><i class=conum data-value=1></i><b>1</b></td><td>Ebben a mezõben az EAP módszert állítjuk be a kapcsolathoz.</td></tr><tr><td><i class=conum data-value=2></i><b>2</b></td><td>Az <code>identity</code> mezõ a titkosított TLS tunnelen keresztül az EAP hitelesítésnél felhasznált azonosítót adja meg.</td></tr><tr><td><i class=conum data-value=3></i><b>3</b></td><td>A <code>password</code> tartalmazza az EAP hitelesítésnél használt jelmondatot.</td></tr><tr><td><i class=conum data-value=4></i><b>4</b></td><td>A <code>ca_cert</code> mezõ hivatkozik a hitelesítõ hatóság tanúsítványát tartalmazó állományra. Ez az állomány kell a szerver tanúsítványának ellenõrzéséhez.</td></tr><tr><td><i class=conum data-value=5></i><b>5</b></td><td>Ebben a mezõben a titkosított TLS tunnelben használt hitelesítési módszer nevezzük meg. Jelen esetünkben ez az EAP MD5-Challenge használatával. A "belsõ hitelesítés" fázisát gyakran csak "phase2"-nak (2. fázisnak) hívják.</td></tr></tbody></table></div><div class=paragraph><p>Mindezek mellett még a következõ sorokat is vegyük fel az <span class=filename>/etc/rc.conf</span> állományba:</p></div><div class="literalblock programlisting"><div class=content><pre>wlans_ath0=&#34;wlan0&#34;
ifconfig_wlan0=&#34;WPA DHCP&#34;</pre></div></div><div class=paragraph><p>Ezután hozzuk mûködésbe a felületet:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># /etc/rc.d/netif start</span>
Starting wpa_supplicant.
DHCPREQUEST on wlan0 to 255.255.255.255 port 67
DHCPREQUEST on wlan0 to 255.255.255.255 port 67
DHCPREQUEST on wlan0 to 255.255.255.255 port 67
DHCPACK from 192.168.0.20
bound to 192.168.0.254 <span class=nt>--</span> renewal <span class=k>in </span>300 seconds.
wlan0: <span class=nv>flags</span><span class=o>=</span>8843&lt;UP,BROADCAST,RUNNING,SIMPLEX,MULTICAST&gt; mtu 1500
      ether 00:11:95:d5:43:62
      inet 192.168.0.254 netmask 0xffffff00 broadcast 192.168.0.255
      media: IEEE 802.11 Wireless Ethernet DS/11Mbps mode 11g
      status: associated
      ssid freebsdap channel 1 <span class=o>(</span>2412 Mhz 11g<span class=o>)</span> bssid 00:11:95:c3:0d:ac
      country US ecm authmode WPA2/802.11i privacy ON deftxkey UNDEF
      AES-CCM 3:128-bit txpower 21.5 bmiss 7 scanvalid 450 bgscan
      bgscanintvl 300 bgscanidle 250 roam:rssi 7 roam:rate 5 protmode CTS
      wme burst roaming MANUAL</code></pre></div></div></div><div class=sect6><h7 id=network-wireless-wpa-eap-peap>31.3.3.1.3.4. WPA és EAP-PEAP<a class=anchor href=#network-wireless-wpa-eap-peap></a></h7><div class=paragraph><p>A PEAP (Védett EAP) az EAP-TTLS egyik alternatívájaként jött létre. A PEAP módszernek két változata van, melyek közül a leggyakoribb a PEAPv0/EAP-MSCHAPv2. A leírás további részében a PEAP elnevezéssel erre az EAP módszerre fogunk hivatkozni. A PEAP az EAP-TLS után a leginkább alkalmazott szabvány, más szóval, ha a hálózatunkban többféle operációs rendszer is megtalálható, akkor az EAP-TLS után valószínûleg a PEAP lesz a másik, amit mindegyik ismerni fog.</p></div><div class=paragraph><p>A PEAP hasonló az EAP-TTLS-hez: szerver oldali tanúsítványokkal hitelesíti a klienseket és titkosított TLS tunnelt hoz létre a kliens és a hitelesítést végzõ szerver között, amivel segíti megóvni a hitelesítési információkat. Biztonság szempontjából az EAP-TTLS és a PEAP között az a különbség, hogy a PEAP hitelesítés a felhasználói nevet titkosítatlanul küldi és csak a jelszó megy át a titkosított TLS tunnelen. Az EAP-TTLS egyaránt a TLS tunnelt használja mind a felhasználói név, mind a jelszó esetében.</p></div><div class=paragraph><p>Az EAP-PEAP beállításait az <span class=filename>/etc/wpa_supplicant.conf</span> állományba kell felvenni:</p></div><div class="literalblock programlisting"><div class=content><pre>network={
  ssid=&#34;freebsdap&#34;
  proto=RSN
  key_mgmt=WPA-EAP
  eap=PEAP <i class=conum data-value=1></i><b>(1)</b>
  identity=&#34;test&#34; <i class=conum data-value=2></i><b>(2)</b>
  password=&#34;test&#34; <i class=conum data-value=3></i><b>(3)</b>
  ca_cert=&#34;/etc/certs/cacert.pem&#34; <i class=conum data-value=4></i><b>(4)</b>
  phase1=&#34;peaplabel=0&#34; <i class=conum data-value=5></i><b>(5)</b>
  phase2=&#34;auth=MSCHAPV2&#34; <i class=conum data-value=6></i><b>(6)</b>
}</pre></div></div><div class="colist arabic"><table><tbody><tr><td><i class=conum data-value=1></i><b>1</b></td><td>Ebben a mezõben megadjuk, az EAP módszert használjuk a kapcsolathoz.</td></tr><tr><td><i class=conum data-value=2></i><b>2</b></td><td>Az <code>identity</code> mezõ az EAP hitelesítés során a titkosított TLS tunnelben átküldött azonosítót tartalmazza.</td></tr><tr><td><i class=conum data-value=3></i><b>3</b></td><td>A <code>password</code> mezõ az EAP hitelesítés során használt jelmondatot definiálja.</td></tr><tr><td><i class=conum data-value=4></i><b>4</b></td><td>A <code>ca_cert</code> mezõ a hitelesítõ hatóság tanúsítványát tartalmazó állomány elérési útját adja meg. Ez az állomány kell a szerver tanúsítványának ellenõrzéséhez.</td></tr><tr><td><i class=conum data-value=5></i><b>5</b></td><td>Ez a mezõ a hitelesítés elsõ fázisának (vagyis a TLS tunnel) paramétereit tartalmazza. A hitelesítést végzõ szervertõl függõen a hitelesítéshez meg kell adnunk bizonyos címkéket. A legtöbb esetben a címke a "kliens oldali EAP titkosítás" lesz, amit a <code>peaplabel=0</code> használatával állítunk be. A részleteket a <a href="https://man.freebsd.org/cgi/man.cgi?query=wpa_supplicant.conf&amp;sektion=5&amp;format=html">wpa_supplicant.conf(5)</a> man oldalon olvashatjuk.</td></tr><tr><td><i class=conum data-value=6></i><b>6</b></td><td>Ebben a mezõben a titkosított TLS tunnelben alkalmazott hitelesítést protokollt nevezzük meg. A PEAP esetében ez az <code>auth=MSCHAPV2</code> lesz.</td></tr></tbody></table></div><div class=paragraph><p>A következõket kell még hozzátennünk az <span class=filename>/etc/rc.conf</span> állományhoz:</p></div><div class="literalblock programlisting"><div class=content><pre>wlans_ath0=&#34;wlan0&#34;
ifconfig_wlan0=&#34;WPA DHCP&#34;</pre></div></div><div class=paragraph><p>Ezután már mûködésbe is hozhatjuk a felületet:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># /etc/rc.d/netif start</span>
Starting wpa_supplicant.
DHCPREQUEST on wlan0 to 255.255.255.255 port 67
DHCPREQUEST on wlan0 to 255.255.255.255 port 67
DHCPREQUEST on wlan0 to 255.255.255.255 port 67
DHCPACK from 192.168.0.20
bound to 192.168.0.254 <span class=nt>--</span> renewal <span class=k>in </span>300 seconds.
wlan0: <span class=nv>flags</span><span class=o>=</span>8843&lt;UP,BROADCAST,RUNNING,SIMPLEX,MULTICAST&gt; mtu 1500
      ether 00:11:95:d5:43:62
      inet 192.168.0.254 netmask 0xffffff00 broadcast 192.168.0.255
      media: IEEE 802.11 Wireless Ethernet DS/11Mbps mode 11g
      status: associated
      ssid freebsdap channel 1 <span class=o>(</span>2412 Mhz 11g<span class=o>)</span> bssid 00:11:95:c3:0d:ac
      country US ecm authmode WPA2/802.11i privacy ON deftxkey UNDEF
      AES-CCM 3:128-bit txpower 21.5 bmiss 7 scanvalid 450 bgscan
      bgscanintvl 300 bgscanidle 250 roam:rssi 7 roam:rate 5 protmode CTS
      wme burst roaming MANUAL</code></pre></div></div></div></div><div class=sect5><h6 id=network-wireless-wep>31.3.3.1.4. WEP<a class=anchor href=#network-wireless-wep></a></h6><div class=paragraph><p>A WEP (Wired Equivalent Privacy, azaz kábellel egyenértékû titkosság) az eredeti 802.11 szabvány része. Nincs külön hitelesítési mechanizmusa, csupán a hozzáférés-vezérlés egy gyenge formájával találkozhatunk benne, amit azonban könnyen fel lehet törni.</p></div><div class=paragraph><p>A WEP <code>ifconfig</code> parancs használatán keresztül állítható be:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># ifconfig wlan0 create wlandev ath0</span>
<span class=c># ifconfig wlan0 inet 192.168.1.100 netmask 255.255.255.0 \</span>
	  ssid saját_hálózat wepmode on weptxkey 3 wepkey 3:0x3456789012</code></pre></div></div><div class=ulist><ul><li><p>A <code>weptxkey</code> utal arra, hogy a küldés során WEP kulcsot használunk. Itt most egy harmadik kulcsot használtunk, amelynek egyeznie kell a hozzáférési pont beállításaival. Ha nem tudjuk pontosan, hogy milyen kulcsot használ a hozzáférési pont, akkor próbálkozzunk az <code>1</code> érték (vagyis az elsõ kulcs) megadásával.</p></li><li><p>A <code>wepkey</code> után következik a kiválasztott WEP kulcs. <em>index:kulcs</em> alakban kell megadni, és ha itt nem adunk meg indexet, akkor azzal az <code>1</code> indexû kulcsot állítjuk be. Úgyis fogalmazhatnánk, hogy az indexet csak olyankor kell megadni, amikor nem az elsõ kulcsot akarjuk használni.</p><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>A <code>0x3456789012</code> értéket a hozzáférési pontnál beállított kulcsra kell beállítani.</p></div></td></tr></tbody></table></div></li></ul></div><div class=paragraph><p>Ha érdekelnek minket a további részletek, akkor bátran lapozzuk fel az <a href="https://man.freebsd.org/cgi/man.cgi?query=ifconfig&amp;sektion=8&amp;format=html">ifconfig(8)</a> parancs man oldalát.</p></div><div class=paragraph><p>A <code>wpa_supplicant</code> segédprogramot is bevonhatjuk a vezeték nélküli felületek WEP alapú használatába. A fenti példát a következõ módon tudjuk leírni az <span class=filename>/etc/wpa_supplicant.conf</span> állományban:</p></div><div class="literalblock programlisting"><div class=content><pre>network={
  ssid=&#34;sajat_halozat&#34;
  key_mgmt=NONE
  wep_key3=3456789012
  wep_tx_keyidx=3
}</pre></div></div><div class=paragraph><p>Majd:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># wpa_supplicant -i wlan0 -c /etc/wpa_supplicant.conf</span>
Trying to associate with 00:13:46:49:41:76 <span class=o>(</span><span class=nv>SSID</span><span class=o>=</span><span class=s1>&#39;dlinkap&#39;</span> <span class=nv>freq</span><span class=o>=</span>2437 MHz<span class=o>)</span>
Associated with 00:13:46:49:41:76</code></pre></div></div></div></div></div><div class=sect3><h4 id=_az_ad_hoc_mûködési_mód>31.3.4. Az ad-hoc mûködési mód<a class=anchor href=#_az_ad_hoc_mûködési_mód></a></h4><div class=paragraph><p>Az IBSS vagy más néven ad-hoc módot pont-pont típusú kapcsolatok kialakítására tervezték. Például, ha az <code>A</code> és a <code>B</code> gépek között egy ad-hoc típusú hálózatot akarunk létesíteni, akkor egyszerûen csak ki kell választanunk két IP-címet és egy SSID-t.</p></div><div class=paragraph><p>Így állítjuk be az <code>A</code> gépet:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># ifconfig wlan0 create wlandev ath0 wlanmode adhoc</span>
<span class=c># ifconfig wlan0 inet 192.168.0.1 netmask 255.255.255.0 ssid freebsdap</span>
<span class=c># ifconfig wlan0</span>
  wlan0: <span class=nv>flags</span><span class=o>=</span>8843&lt;UP,BROADCAST,RUNNING,SIMPLEX,MULTICAST&gt; metric 0 mtu 1500
	  ether 00:11:95:c3:0d:ac
	  inet 192.168.0.1 netmask 0xffffff00 broadcast 192.168.0.255
	  media: IEEE 802.11 Wireless Ethernet autoselect mode 11g &lt;adhoc&gt;
	  status: running
	  ssid freebsdap channel 2 <span class=o>(</span>2417 MHz<span class=o>)</span> bssid 02:11:95:c3:0d:ac
	  country US ecm authmode OPEN privacy OFF txpower 21.5 scanvalid 60
	  protmode CTS wme burst</code></pre></div></div><div class=paragraph><p>Az <code>adhoc</code> paraméterrel utalunk arra, hogy a felület most IBSS módban mûködik.</p></div><div class=paragraph><p>A <code>B</code> gépen ezután már képesek vagyunk észlelni az <code>A</code> gépet:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># ifconfig wlan0 create wlandev ath0 wlanmode adhoc</span>
  SSID/MESH ID    BSSID              CHAN RATE  S:N     INT CAPS
  freebsdap       02:11:95:c3:0d:ac    2   54M <span class=nt>-64</span>:-96  100 IS   WME</code></pre></div></div><div class=paragraph><p>A kimenetben szereplõ <code>I</code> is megerõsíti, hogy az <code>A</code> gépet ad-hoc módban érjük el. Így már csak a <code>B</code> gépet kell beállítanunk egy másik IP-címmel:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># ifconfig wlan0 inet 192.168.0.2 netmask 255.255.255.0 ssid freebsdap</span>
<span class=c># ifconfig wlan0</span>
  wlan0: <span class=nv>flags</span><span class=o>=</span>8843&lt;UP,BROADCAST,RUNNING,SIMPLEX,MULTICAST&gt; metric 0 mtu 1500
	  ether 00:11:95:d5:43:62
	  inet 192.168.0.2 netmask 0xffffff00 broadcast 192.168.0.255
	  media: IEEE 802.11 Wireless Ethernet autoselect mode 11g &lt;adhoc&gt;
	  status: running
	  ssid freebsdap channel 2 <span class=o>(</span>2417 Mhz 11g<span class=o>)</span> bssid 02:11:95:c3:0d:ac
	  country US ecm authmode OPEN privacy OFF txpower 21.5 scanvalid 60
	  protmode CTS wme burst</code></pre></div></div><div class=paragraph><p>Most már mind az <code>A</code> és mind a <code>B</code> készen áll az adatok cseréjére.</p></div></div><div class=sect3><h4 id=network-wireless-ap>31.3.5. FreeBSD alapú hozzáférési pontok<a class=anchor href=#network-wireless-ap></a></h4><div class=paragraph><p>A FreeBSD képes hozzáférési pontként (Access Point, AP) is üzemelni, így nem kell külön hardveres hozzáférési pontot vásárolnunk vagy ad-hoc hálózatot használnunk. Ez különösen akkor hasznos, amikor a FreeBSD gépet egy másik hálózat (például az internet) felé állítottuk be átjárónak.</p></div><div class=sect4><h5 id=network-wireless-ap-basic>31.3.5.1. Alapvetõ beállítások<a class=anchor href=#network-wireless-ap-basic></a></h5><div class=paragraph><p>Mielõtt nekiállnánk a FreeBSD-s gépünket hozzáférési pontnak beállítani, egy olyan rendszermagra lesz szükségünk, amely tartalmazza a megfelelõ vezeték nélküli támogatást a kártyánkhoz. Emellett az alkalmazni kívánt biztonsági protokollok támogatását is bele kell építenünk. Ennek részleteit lásd a <a href=#network-wireless-basic>Kezdeti beállítások</a>ban.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Jelenleg az NDIS meghajtón keresztül használt Windows®-os meghajtók nem teszik lehetõvé hozzáférési pontok kialakítását. Egyedül a vezeték nélküli eszközök natív FreeBSD-s meghajtói ismerik a hozzáférési pont módot.</p></div></td></tr></tbody></table></div><div class=paragraph><p>Ahogy betöltöttük a vezeték nélküli hálózatok támogatását, egybõl ellenõrizni is tudjuk, hogy a vezeték nélküli eszközünk használható-e hozzáférési pontként (avagy "hostap" módban):</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># ifconfig wlan0 create wlandev ath0</span>
<span class=c># ifconfig wlan0 list caps</span>
<span class=nv>drivercaps</span><span class=o>=</span>6f85edc1&lt;STA,FF,TURBOP,IBSS,HOSTAP,AHDEMO,TXPMGT,SHSLOT,SHPREAMBLE,MONITOR,MBSS,WPA1,WPA2,BURST,WME,WDS,BGSCAN,TXFRA&gt;
<span class=nv>crytocaps</span><span class=o>=</span>1f&lt;WEP,TKIP,AES,AES_CCM,TKIPMIC&gt;</code></pre></div></div><div class=paragraph><p>A fenti kimenetben láthatjuk a kártyánk tulajdonságait. A <code>HOSTAP</code> szó arról tanúskodik, hogy a vezeték nélküli kártyánk képes hozzáférési pontként viselkedni. Mellette még a különféle támogatott titkosítási módszerek is láthatóak: WEP, TKIP, AES stb. Ezekbõl az információkból tudjuk kideríteni, hogy a hozzáférési pontunkon milyen titkosítási protokollokat tudunk használni.</p></div><div class=paragraph><p>A vezeték nélküli eszközünket innentõl már csak hozzáférési pontnak állíthatjuk át a viruális hálózati eszköz létrehozásakor, ezért a korábban létrehozott eszközt ehhez elõször meg kell semmisítenünk:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># ifconfig wlan0 destroy</span></code></pre></div></div><div class=paragraph><p>Ezzel létrejön a megfelelõ beállításokkal, majd ezekhez állítjuk még be a többit:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># ifconfig wlan0 create wlandev ath0 wlanmode hostap</span>
<span class=c># ifconfig wlan0 inet 192.168.0.1 netmask 255.255.255.0 ssid freebsdap mode 11g channel 1</span></code></pre></div></div><div class=paragraph><p>Az <code>ifconfig</code> parancs ismételt használatával le is tudjuk kérdezni az <span class=filename>wlan0</span> felület állapotát:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># ifconfig wlan0</span>
  wlan0: <span class=nv>flags</span><span class=o>=</span>8843&lt;UP,BROADCAST,RUNNING,SIMPLEX,MULTICAST&gt; metric 0 mtu 1500
	  inet 192.168.0.1 netmask 0xffffff00 broadcast 192.168.0.255
	  inet6 fe80::211:95ff:fec3:dac%ath0 prefixlen 64 scopeid 0x4
	  ether 00:11:95:c3:0d:ac
	  media: IEEE 802.11 Wireless Ethernet autoselect mode 11g &lt;hostap&gt;
	  status: running
	  ssid freebsdap channel 1 <span class=o>(</span>2412 Mhz<span class=o>)</span> bssid 00:11:95:c3:0d:ac
	  country US ecm authmode OPEN privacy OFF txpower 21.5 scanvalid 60
	  protmode CTS wme burst dtimperiod 1 <span class=nt>-dfs</span></code></pre></div></div><div class=paragraph><p>A <code>hostap</code> paraméterbõl kiderül, hogy a felület hozzáférési pont módban van.</p></div><div class=paragraph><p>Ha az <span class=filename>/etc/rc.conf</span> állományban megadjuk a következõ sorokat, akkor a felület beállítása a rendszer indításakor magától megtörténik:</p></div><div class="literalblock programlisting"><div class=content><pre>wlans_ath0=&#34;wlan0&#34;
create_args_wlan0=&#34;wlanmode hostap&#34;
ifconfig_wlan0=&#34;inet 192.168.0.1 netmask 255.255.255.0 ssid freebsdap mode 11g channel 1&#34;</pre></div></div></div><div class=sect4><h5 id=_hitelesítés_vagy_titkosítás_nélküli_hozzáférési_pontok>31.3.5.2. Hitelesítés vagy titkosítás nélküli hozzáférési pontok<a class=anchor href=#_hitelesítés_vagy_titkosítás_nélküli_hozzáférési_pontok></a></h5><div class=paragraph><p>Habár a hozzáférési pontok mûködtetése nem javasolt hitelesítés vagy titkosítás nélkül, ebben a módban könnyen meg tudunk gyõzõdni a hozzáférési pontunk használhatóságáról. Ez a típusú konfiguráció ezenkívül még fontos szerepet játszik a klienseken felbukkanó hibák kiszûrésében is.</p></div><div class=paragraph><p>Miután sikerült az elõbbiekben bemutatottak alapján beállítani a hozzáférési pontunkat, egy másik vezeték nélküli géprõl rögtön meg is kezdhetjük a keresését:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># ifconfig ath0 up scan</span>
SSID/MESH ID    BSSID              CHAN RATE   S:N     INT CAPS
freebsdap       00:11:95:c3:0d:ac    1   54M <span class=nt>-66</span>:-96  100 ES   WME</code></pre></div></div><div class=paragraph><p>Láthatjuk, hogy a kliens megtalálta a hozzáférési pontot és tudunk is rá kapcsolódni:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># ifconfig wlan0 inet 192.168.0.2 netmask 255.255.255.0 ssid freebsdap</span>
<span class=c># ifconfig wlan0</span>
  wlan0: <span class=nv>flags</span><span class=o>=</span>8843&lt;UP,BROADCAST,RUNNING,SIMPLEX,MULTICAST&gt; metric 0 mtu 1500
	  inet 192.168.0.2 netmask 0xffffff00 broadcast 192.168.0.255
	  media: IEEE 802.11 Wireless Ethernet OFDM/54Mbps mode 11g
	  status: associated
	  ssid freebsdap channel 1 <span class=o>(</span>2412 Mhz 11g<span class=o>)</span> bssid 00:11:95:c3:0d:ac
	  country US ecm authmode OPEN privacy OFF txpower 21.5 bmiss 7
	  scanvalid 60 bgscan bgscanintvl 300 bgscanidle 250 roam:rssi 7
	  roam:rate 5 protmode CTS wme burst</code></pre></div></div></div><div class=sect4><h5 id=_wpa_titkosítást_használó_hozzáférési_pontok>31.3.5.3. WPA titkosítást használó hozzáférési pontok<a class=anchor href=#_wpa_titkosítást_használó_hozzáférési_pontok></a></h5><div class=paragraph><p>Ebben a szakaszban a FreeBSD-s hozzáférési pontunkat WPA titkosítással állítjuk be. A WPA és a WPA alapú kliensek beállításának részleteit a <a href=#network-wireless-wpa>WPA</a>ban találjuk.</p></div><div class=paragraph><p>A WPA titkosítást használó hozzáférési pontokon a hostapd démon foglalkozik a kliensek hitelesítésével és a kulcsok kezelésével.</p></div><div class=paragraph><p>A továbbiakban az összes beállítást egy olyan FreeBSD-s gépen végezzük el, amely hozzáférési pontként mûködik. Ahogy sikerült beállítanunk a hozzáférési pont módot, az <span class=filename>/etc/rc.conf</span> állományban a következõ sor segítségével könnyen meg tudjuk oldani, hogy az hostapd démon a rendszerrel együtt magától elinduljon:</p></div><div class="literalblock programlisting"><div class=content><pre>hostapd_enable=&#34;YES&#34;</pre></div></div><div class=paragraph><p>Mielõtt megpróbálnánk beállítani a hostapd démont, ne felejtsük el elvégezni a <a href=#network-wireless-ap-basic>Alapvetõ beállítások</a>ban említett alapvetõ beállításokat sem.</p></div><div class=sect5><h6 id=_wpa_psk>31.3.5.3.1. WPA-PSK<a class=anchor href=#_wpa_psk></a></h6><div class=paragraph><p>A WPA-PSK használatát olyan kis méretû hálózatok számára szánják, ahol egy külön hitelesítõ szervert alkalmazása nem lehetséges vagy nem kívánatos.</p></div><div class=paragraph><p>A konfiguráció az <span class=filename>/etc/hostapd.conf</span> állományon keresztül történik:</p></div><div class="literalblock programlisting"><div class=content><pre>interface=wlan0 <i class=conum data-value=1></i><b>(1)</b>
debug=1 <i class=conum data-value=2></i><b>(2)</b>
ctrl_interface=/var/run/hostapd <i class=conum data-value=3></i><b>(3)</b>
ctrl_interface_group=wheel <i class=conum data-value=4></i><b>(4)</b>
ssid=freebsdap <i class=conum data-value=5></i><b>(5)</b>
wpa=1 <i class=conum data-value=6></i><b>(6)</b>
wpa_passphrase=freebsdmall <i class=conum data-value=7></i><b>(7)</b>
wpa_key_mgmt=WPA-PSK <i class=conum data-value=8></i><b>(8)</b>
wpa_pairwise=CCMP TKIP <i class=conum data-value=9></i><b>(9)</b></pre></div></div><div class="colist arabic"><table><tbody><tr><td><i class=conum data-value=1></i><b>1</b></td><td>Ebben a mezõben jelöljük ki a hozzáférési pontként használt vezeték nélküli felületet.</td></tr><tr><td><i class=conum data-value=2></i><b>2</b></td><td>Ebben a mezõben adjuk meg a hostapd futtatása során keletkezõ üzenetek részletességét. A példában szereplõ <code>1</code> érték ennek a legkisebb szintjét jelöli.</td></tr><tr><td><i class=conum data-value=3></i><b>3</b></td><td>A <code>ctrl_interface</code> mezõ megadja a hostapd által használt könyvtár elérési útvonalát, amiben azokat a tartományokhoz tartozó socketeket tároljuk, amelyeken keresztül olyan programokkal tudunk kommunikálni, mint például a <a href="https://man.freebsd.org/cgi/man.cgi?query=hostapd_cli&amp;sektion=8&amp;format=html">hostapd_cli(8)</a>. Itt az alapértelmezett értéket írtuk be.</td></tr><tr><td><i class=conum data-value=4></i><b>4</b></td><td>A <code>ctrl_interface_group</code> sor beállítja azt a csoportot (ez jelen esetben a <code>wheel</code>), amin keresztül a vezérlõfelület (control interface) állományaihoz hozzá tudunk férni.</td></tr><tr><td><i class=conum data-value=5></i><b>5</b></td><td>Ebben a mezõben a hálózat nevét állítjuk be.</td></tr><tr><td><i class=conum data-value=6></i><b>6</b></td><td>A <code>wpa</code> mezõvel engedélyezzük a WPA használatát és megadjuk, hogy melyik WPA hitelesítési protokollt alkalmazzuk. Az itt szereplõ <code>1</code> érték a WPA-PSK hitelesítés állítja be a hozzáférési pont számára.</td></tr><tr><td><i class=conum data-value=7></i><b>7</b></td><td>A <code>wpa_passphrase</code> mezõ a WPA hitelesítéshez szükséges ASCII jelmondatot tartalmazza.</td></tr><tr><td><i class=conum data-value=8></i><b>8</b></td><td>A <code>wpa_key_mgmt</code> sor a kulcsok kezelésére használt protokollt definiálja. Ez a mi esetünk most a WPA-PSK.</td></tr><tr><td><i class=conum data-value=9></i><b>9</b></td><td>A <code>wpa_pairwise</code> mezõ a hozzáférési pont által elfogadott titkosítási algoritmusokat határozza meg. A példában a TKIP (WPA) és CCMP (WPA2) titkosítást is támogatjuk. A CCMP titkosítás a TKIP egyik alternatívája, és lehetõség szerint használjuk ezt. A TKIP csak olyan állomások esetében javasolt, amelyek nem támogatják a CCMP használatát.</td></tr></tbody></table></div><div class=paragraph><p>A következõ lépés a hostapd elindítása:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># /etc/rc.d/hostapd forcestart</span></code></pre></div></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># ifconfig wlan0</span>
  wlan0: <span class=nv>flags</span><span class=o>=</span>8843&lt;UP,BROADCAST,RUNNING,SIMPLEX,MULTICAST&gt; mtu 2290
	  inet 192.168.0.1 netmask 0xffffff00 broadcast 192.168.0.255
	  inet6 fe80::211:95ff:fec3:dac%ath0 prefixlen 64 scopeid 0x4
	  ether 00:11:95:c3:0d:ac
	  media: IEEE 802.11 Wireless Ethernet autoselect mode 11g &lt;hostap&gt;
	  status: associated
	  ssid freebsdap channel 1 bssid 00:11:95:c3:0d:ac
	  authmode WPA2/802.11i privacy MIXED deftxkey 2 TKIP 2:128-bit txpowmax 36 protmode CTS dtimperiod 1 bintval 100</code></pre></div></div><div class=paragraph><p>A hozzáférési pont mostantól mûködik, innentõl a kliensek már képesek csatlakozni hozzá, bõvebben lásd a <a href=#network-wireless-wpa>WPA</a>ban. A hozzáférési ponthoz tartozó állomásokat az <code>ifconfig wlan0 list sta</code> paranccsal tudjuk listázni.</p></div></div></div><div class=sect4><h5 id=_wep_titkosítást_használó_hozzáférési_pontok>31.3.5.4. WEP titkosítást használó hozzáférési pontok<a class=anchor href=#_wep_titkosítást_használó_hozzáférési_pontok></a></h5><div class=paragraph><p>A WEP titkosítást nem javasoljuk a hozzáférési pontok esetében, mivel nem tartalmaz semmilyen hitelesítési mechanizmust és könnyen feltörhetõ. Egyes régebbi vezeték nélküli kártyák azonban csak a WEP által nyújtott védelmet ismerik, ezért az ilyenek csak olyan hozzáférési pontokhoz tudnak csatlakozni, amelyek vagy nem használnank hitelesítést és titkosítást, vagy erre a WEP protokollt használják.</p></div><div class=paragraph><p>A vezeték nélküli eszközt tegyük hozzáférési pont módba és állítsuk be neki a megfelelõ SSID-t és IP-címet:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># ifconfig wlan0 create wlandev ath0 wlanmode hostap</span>
<span class=c># ifconfig wlan0 inet 192.168.0.1 netmask 255.255.255.0 \</span>
	ssid freebsdap wepmode on weptxkey 3 wepkey 3:0x3456789012 mode 11g</code></pre></div></div><div class=ulist><ul><li><p>A <code>weptxkey</code> beállítás után adjuk meg a küldéshez használt WEP kulcsot. Itt a harmadik kulcsot adtuk meg (vegyük észre, hogy a kulcsok számozása az <code>1</code> értékkel kezdõdik). Ez a paramétert az adatok tényleges titkosításához kell megadni.</p></li><li><p>A <code>wepkey</code> a kiválasztott WEP kulcs beállítását jelöli, aminek a formátuma <em>index:kulcs</em>. Ha itt nem adunk meg indexet, akkor automatikusan az elsõ kulcsot állítjuk be. Ezért talán mondanunk sem kell, hogy az indexet csak akkor kell megadni, ha nem az elsõ kulcsot akarjuk használni.</p></li></ul></div><div class=paragraph><p>A <span class=filename>wlan0</span> felület állapotának megtekintéséhez adjuk ki megint az <code>ifconfig</code> parancsot:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># ifconfig wlan0</span>
  ath0: <span class=nv>flags</span><span class=o>=</span>8843&lt;UP,BROADCAST,RUNNING,SIMPLEX,MULTICAST&gt; mtu 1500
	  inet 192.168.0.1 netmask 0xffffff00 broadcast 192.168.0.255
	  ether 00:11:95:c3:0d:ac
	  media: IEEE 802.11 Wireless Ethernet autoselect mode 11g &lt;hostap&gt;
	  status: running
	  ssid freebsdap channel 4 <span class=o>(</span>2427 Mhz<span class=o>)</span> bssid 00:11:95:c3:0d:ac
	  country US ecm authmode OPEN privacy ON deftxkey 3 wepkey 3:40-bit
	  txpower 21.5 scanvalid 60 protmode CTS wme burst dtimperiod 1 <span class=nt>-dfs</span></code></pre></div></div><div class=paragraph><p>Egy másik vezeték nélküli géprõl most már megpróbálhatjuk megkeresni a hozzáférési pontot:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># ifconfig wlan0 create wlandev ath0</span>
SSID            BSSID              CHAN RATE  S:N   INT CAPS
freebsdap       00:11:95:c3:0d:ac    1   54M 22:1   100 EPS</code></pre></div></div><div class=paragraph><p>Láthatjuk, hogy a kliens megtalálta a hozzáférési pontot, és a megfelelõ paraméterekkel (kulcs stb.) képes kapcsolódni hozzá a <a href=#network-wireless-wep>WEP</a>ban leírtak szerint.</p></div></div></div><div class=sect3><h4 id=_a_vezetékes_és_vezeték_nélküli_hálózatok_együttes_használata>31.3.6. A vezetékes és vezeték nélküli hálózatok együttes használata<a class=anchor href=#_a_vezetékes_és_vezeték_nélküli_hálózatok_együttes_használata></a></h4><div class=paragraph><p>A vezetékes hálózatok általában jobb teljesítményt nyújtanak és megbízhatóbbak, miközben a vezeték nélküli hálózatok pedig nagyobb rugalmasságot és mozgásteret szolgáltatnak. Ezért a hordozható számítógépek tulajdonosaiban felmerülhet az igény, hogy egyszerre mind a kettõt használva, tetszõlegesen és problémamentesen válthassanak a hálózatok között.</p></div><div class=paragraph><p>FreeBSD rendszereken ún. "hibatûrõ" módon két vagy akár több hálózati interfészt össze tudunk vonni. Ennek köszönhetõen az aktív hálózati kapcsolat megszünésekor rendszerünk önállóan igyekszik mindig a fennmaradó elérhetõ hálózatok közül a leginkább preferáltabbra váltani.</p></div><div class=paragraph><p>A hálózati összeköttetések összefûzésével és a hibatûrés konkrét megvalósításával az <a href=#network-aggregation>Linkek összefûzése és hibatûrése</a>ban foglalkozunk, ahol a <a href=#networking-lagg-wired-and-wireless>Hibatûrés beállítása vezetékes és vezeték nélküli hálózatok között</a>ban láthatjuk is a vezetékes és vezeték nélküli kapcsolatok együttes használatának beállítását.</p></div></div><div class=sect3><h4 id=_hibaelhárítás_3>31.3.7. Hibaelhárítás<a class=anchor href=#_hibaelhárítás_3></a></h4><div class=paragraph><p>Ha valamilyen gondunk lenne a vezeték nélküli hálózatok használatával, akad néhány lépés, amivel esetleg fel tudjuk deríteni a hiba okát.</p></div><div class=ulist><ul><li><p>Ha nem látjuk a hozzáférési pontot a pásztázás után, ellenõrizzük, hogy a vezeték nélküli eszközt véletlenül nem korlátoztuk-e le bizonyos csatornákra.</p></li><li><p>Ha nem tudunk csatlakozni a hozzáférési ponthoz, akkor egyeztessük vele az állomás egyes paramétereit, beleértve a hitelesítési sémát és a biztonsági protokollokat. Minél jobban egyszerûsítsük le a konfigurációkat. Ha WPA vagy WEP titkosítást használunk, akkor a hozzáférési ponton állítsunk be nyílt hitelesítést és kapcsoljuk ki a titkosítást, majd nézzük meg, hogy így eljut-e hozzánk valamilyen forgalom.</p></li><li><p>Ahogy sikerült csatlakozunk a hozzáférési ponthoz, a biztonsági beállításokat olyan egyszerû eszközökkel próbáljuk meg diagnosztizálni, mint például a <a href="https://man.freebsd.org/cgi/man.cgi?query=ping&amp;sektion=8&amp;format=html">ping(8)</a>.</p><div class=paragraph><p>A <code>wpa_supplicant</code> segédprogrammal tudunk nyomkövetést végezni. A <code>-dd</code> opció megadásával indítsuk el manuálisan és ellenõrizzük a rendszernaplókat.</p></div></li><li><p>Vannak alacsonyabb szintû nyomkövetési lehetõségek is. A 802.11 protokollt támogató rétegben is tudunk engedélyezni nyomkövetési üzeneteket a <span class=filename>/usr/src/tools/tools/net80211</span> könyvtárban található <code>wlandebug</code> program segítségével. Például a</p><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># wlandebug -i ath0 +scan+auth+debug+assoc</span>
  net.wlan.0.debug: 0 <span class=o>=&gt;</span> 0xc80000&lt;assoc,auth,scan&gt;</code></pre></div></div><div class=paragraph><p>paranccsal a hozzáférési pontok kereséséhez és a 802.11 protokollon belül a kapcsolat megszervezéséhez szükséges kézfogásokhoz kapcsolódó konzolüzeneteket tudjuk engedélyezni.</p></div><div class=paragraph><p>A 802.11 rétegben rengeteg hasznos statisztikát találhatunk. Mindezeket a <code>wlanstats</code> eszközzel tudjuk kiíratni. Ezeknek a statisztikáknak a 802.11 réteg összes hibáját be kell tudniuk azonosítaniuk. Vigyázzunk azonban, mert az eszközmeghajtókban a 802.11 réteg alatt rejlõ bizonyos hibák ilyenkor nem jelennek meg. Az eszközfüggõ problémák felderítésével kapcsolatban a megfelelõ meghajtó dokumentációját olvassuk át.</p></div></li></ul></div><div class=paragraph><p>Amennyiben a fenti tanácsok mentén sem sikerül orvosolnunk a hibát okát, küldjünk egy hibajelentést és mellékeljük hozzá a fentebb tárgyalt eszközök által gyártott kimeneteket.</p></div></div></div><div class=sect2><h3 id=network-bluetooth>31.4. Bluetooth<a class=anchor href=#network-bluetooth></a></h3><div class=sect3><h4 id=_bevezetés_5>31.4.1. Bevezetés<a class=anchor href=#_bevezetés_5></a></h4><div class=paragraph><p>A Bluetooth egy olyan vezeték nélküli technológia, amellyel a 2,4 GHz-es frekvenciatartományban tudunk személyi hálózatokat létrehozni 10 méteren belül. Az ilyen típusú hálózatok általában alkalmi jelleggel keletkeznek különféle hordozható eszközök, mint például mobiltelefonok, kézi számítógépek és laptopok között. Eltérõen más népszerû vezeték nélküli technológiáktól, például a wi-fitõl, a Bluetooth magasabb szintû szolgáltási profilokat is felajánl: FTP-szerû állományszervereket, az állományok áttolását, hang átküldését, soros vonali emulációt és még sok minden mást.</p></div><div class=paragraph><p>A FreeBSD-ben megvalósított Bluetooth protokollkészlet a Netgraph rendszerre építkezik (lásd <a href="https://man.freebsd.org/cgi/man.cgi?query=netgraph&amp;sektion=4&amp;format=html">netgraph(4)</a>). A Bluetooth alapú USB-s hardverzárak széles körét támogatja az <a href="https://man.freebsd.org/cgi/man.cgi?query=ng_ubt&amp;sektion=4&amp;format=html">ng_ubt(4)</a> meghajtó. A Broadcom BCM2033 chipre épített Bluetooth eszközöket az <a href="https://man.freebsd.org/cgi/man.cgi?query=ubtbcmfw&amp;sektion=4&amp;format=html">ubtbcmfw(4)</a> és az <a href="https://man.freebsd.org/cgi/man.cgi?query=ng_ubt&amp;sektion=4&amp;format=html">ng_ubt(4)</a> meghajtók támogatják. A 3Com Bluetooth PC Card 3CRWB60-A eszközt az <a href="https://man.freebsd.org/cgi/man.cgi?query=ng_bt3c&amp;sektion=4&amp;format=html">ng_bt3c(4)</a> meghajtó támogatja. A soros és UART alapú Bluetooth eszközöket a <a href="https://man.freebsd.org/cgi/man.cgi?query=sio&amp;sektion=4&amp;format=html">sio(4)</a>, <a href="https://man.freebsd.org/cgi/man.cgi?query=ng_h4&amp;sektion=4&amp;format=html">ng_h4(4)</a> és <a href="https://man.freebsd.org/cgi/man.cgi?query=hcseriald&amp;sektion=8&amp;format=html">hcseriald(8)</a> ismeri. Ebben a szakaszban a Bluetooth alapú USB-s hardverzárak használatát mutatjuk be.</p></div></div><div class=sect3><h4 id=_az_eszköz_csatlakoztatása>31.4.2. Az eszköz csatlakoztatása<a class=anchor href=#_az_eszköz_csatlakoztatása></a></h4><div class=paragraph><p>Alapértelmezés szerint a Bluetooth eszközmeghajtók modulként érhetõek el. Az eszköz csatlakoztatása elõtt a megfelelõ meghajtót be kell töltenünk a rendszermagba:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># kldload ng_ubt</span></code></pre></div></div><div class=paragraph><p>Ha a Bluetooth eszköz már a rendszer indításakor is jelen van, akkor a modult az <span class=filename>/boot/loader.conf</span> állományon keresztül is betölthetjük:</p></div><div class="literalblock programlisting"><div class=content><pre>ng_ubt_load=&#34;YES&#34;</pre></div></div><div class=paragraph><p>Dugjuk be az USB-s hardverzárunkat. Az alábbihoz hasonló kimenet fog keletkezni a konzolon (vagy a rendszernaplóban):</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>ubt0: vendor 0x0a12 product 0x0001, rev 1.10/5.25, addr 2
ubt0: Interface 0 endpoints: <span class=nv>interrupt</span><span class=o>=</span>0x81, bulk-in<span class=o>=</span>0x82, bulk-out<span class=o>=</span>0x2
ubt0: Interface 1 <span class=o>(</span>alt.config 5<span class=o>)</span> endpoints: isoc-in<span class=o>=</span>0x83, isoc-out<span class=o>=</span>0x3,
      <span class=nv>wMaxPacketSize</span><span class=o>=</span>49, <span class=nv>nframes</span><span class=o>=</span>6, buffer <span class=nv>size</span><span class=o>=</span>294</code></pre></div></div><div class=paragraph><p>Az <span class=filename>/etc/rc.d/bluetooth</span> szkript fogja végezni a Bluetooth használatához szükséges protokollkészlet elindítását és leállítását. Jó ötlet leállítani az eszköz eltávolítása elõtt, de ha elhagyjuk, (általában) nem okoz végzetes hibát. Az indításkor a következõ kimenetet kapjuk:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># /etc/rc.d/bluetooth start ubt0</span>
BD_ADDR: 00:02:72:00:d4:1a
Features: 0xff 0xff 0xf 00 00 00 00 00
&lt;3-Slot&gt; &lt;5-Slot&gt; &lt;Encryption&gt; &lt;Slot offset&gt;
&lt;Timing accuracy&gt; &lt;Switch&gt; &lt;Hold mode&gt; &lt;Sniff mode&gt;
&lt;Park mode&gt; &lt;RSSI&gt; &lt;Channel quality&gt; &lt;SCO <span class=nb>link</span><span class=o>&gt;</span>
&lt;HV2 packets&gt; &lt;HV3 packets&gt; &lt;u-law log&gt; &lt;A-law log&gt; &lt;CVSD&gt;
&lt;Paging scheme&gt; &lt;Power control&gt; &lt;Transparent SCO data&gt;
Max. ACL packet size: 192 bytes
Number of ACL packets: 8
Max. SCO packet size: 64 bytes
Number of SCO packets: 8</code></pre></div></div></div><div class=sect3><h4 id=_host_controller_interface_hci>31.4.3. Host Controller Interface (HCI)<a class=anchor href=#_host_controller_interface_hci></a></h4><div class=paragraph><p>A Host Controller Interface (HCI) egy parancsfelületet nyújt a mûködési sáv vezérlõjéhez (baseband controller) és az összeköttetések kezelõjéhez (link manager), valamint hozzáférést a hardverállapot és -vezérlõ regiszterekhez. Ez a felület egy egységes módszert szolgáltat a Bluetooth mûködési sávjához tartozó tulajdonságok eléréséhez. Az eszközön üzemelõ HCI réteg a Bluetooth hardverben található HCI firmware-rel vált adatokat és parancsokat. A Host Controller Transport Layer (vagyis a fizikai busz) meghajtója mind a két HCI réteget és a kettejük közti információcserét is elérhetõvé teszi.</p></div><div class=paragraph><p>Az egyes Bluetooth eszközökhöz létrejön egy-egy <em>hci</em> típusú Netgraph-beli csomópont. Ez a HCI csomópont általában a Bluetooth eszközmeghajtó csomópontjához (lefelé) és az L2CAP csomóponthoz (felfelé) csatlakozik. Az összes HCI mûveletet a HCI csomóponton kell elvégezni és nem az eszközmeghajtóhoz tartozón. A HCI csomópont alapértelmezett neve a "devicehci". Ezekrõl többet az <a href="https://man.freebsd.org/cgi/man.cgi?query=ng_hci&amp;sektion=4&amp;format=html">ng_hci(4)</a> man oldalán tudhatunk meg.</p></div><div class=paragraph><p>Az egyik legáltalánosabb feladat a Bluetooth eszközök esetében a közelben levõ további eszközök felderítése. Ezt a mûveletet <em>tudakozódásnak</em> ("inquiry") nevezik. A tudakozódást és az összes többi HCI-hez kapcsolódó mûveletet a <a href="https://man.freebsd.org/cgi/man.cgi?query=hccontrol&amp;sektion=8&amp;format=html">hccontrol(8)</a> segédprogrammal tudjuk elvégezni. A lentebb látható példa azt mutatja meg, hogyan tudunk Bluetooth eszközöket keresni egy adott távolságon belül. Az elérhetõ eszközök listáját néhány másodpercen alatt megkapjuk. A távoli azonban eszközök csak akkor fognak válaszolni, ha <em>felderíthetõ</em> ("discoverable") módban vannak.</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>% hccontrol <span class=nt>-n</span> ubt0hci inquiry
Inquiry result, <span class=nv>num_responses</span><span class=o>=</span>1
Inquiry result <span class=c>#0</span>
       BD_ADDR: 00:80:37:29:19:a4
       Page Scan Rep. Mode: 0x1
       Page Scan Period Mode: 00
       Page Scan Mode: 00
       Class: 52:02:04
       Clock offset: 0x78ef
Inquiry complete. Status: No error <span class=o>[</span>00]</code></pre></div></div><div class=paragraph><p>A <code>BD_ADDR</code> a Bluetooth eszköz egyedi címe, hasonló a hálózati kártyák MAC-címéhez. Erre a címre lesz szükség ahhoz, hogy a továbbiakban kommunikálni tudjunk az eszközzel. Emberek számára értelmezhetõ nevet is hozzá tudunk rendelni a BD_ADDR címhez. Az <span class=filename>/etc/bluetooth/hosts</span> állomány tartalmazza a Bluetooth eszközökre vonatkozó információkat. A következõ példában azt láthatjuk, hogyan tudunk beszédesebb nevet adni egy távoli eszköznek:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>% hccontrol <span class=nt>-n</span> ubt0hci remote_name_request 00:80:37:29:19:a4
BD_ADDR: 00:80:37:29:19:a4
Name: Pav T39-ese</code></pre></div></div><div class=paragraph><p>Amikor tudakozódni kezdünk a távoli Bluetooth eszközök jelenléte felõl, a gépünket "sajat.gep.nev (ubt0)" néven fogják látni. Ez a helyi eszközhöz rendelt név bármikor megváltoztatható.</p></div><div class=paragraph><p>A Bluetooth rendszer lehetõség ad pont-pont (természetesen csak két Bluetooth egység között) vagy pont-multipont típusú kapcsolatok kiépítésére. A pont-multipont kapcsolat esetén a kapcsolaton több Bluetooth eszköz osztozik. A most következõ példában megláthatjuk, hogyan kell az aktív mûködési sávban lekérdezni a helyi eszköz létrejött kapcsolatait:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>% hccontrol <span class=nt>-n</span> ubt0hci read_connection_list
Remote BD_ADDR    Handle Type Mode Role Encrypt Pending Queue State
00:80:37:29:19:a4     41  ACL    0 MAST    NONE       0     0 OPEN</code></pre></div></div><div class=paragraph><p>A <em>kapcsolat azonosítója</em> (connection handle) akkor hasznos, amikor egy sávbeli kapcsolatot akarunk lezárni. Ezt általában nem kell kézzel megcsinálni. A rendszer magától lezárja az inaktív sávbeli kapcsolatokat.</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># hccontrol -n ubt0hci disconnect 41</span>
Connection handle: 41
Reason: Connection terminated by <span class=nb>local </span>host <span class=o>[</span>0x16]</code></pre></div></div><div class=paragraph><p>A <code>hccontrol help</code> paranccsal tudjuk lekérdezni az elérhetõ HCI parancsokat. A legtöbb HCI parancs végrehajtásához nem kellenek rendszeradminisztrátori jogosultságok.</p></div></div><div class=sect3><h4 id=_logical_link_control_and_adaptation_protocol_l2cap>31.4.4. Logical Link Control and Adaptation Protocol (L2CAP)<a class=anchor href=#_logical_link_control_and_adaptation_protocol_l2cap></a></h4><div class=paragraph><p>A Logical Link Control and Adaptation Protocol (L2CAP) a kapcsolat-orientált és a kapcsolat nélküli adatszolgáltatásokért felelõs a felsõbb rétegek felé, valamit támogatja a protokollok többszörözését, a darabolást és az összerakást. Az L2CAP a magasabb szintû protokollok és az alkalmazások számára egészen 64 kilobyte méretig lehetõvé teszi az adatcsomagok küldését és fogadását.</p></div><div class=paragraph><p>A L2CAP a <em>csatorna</em> (channel) fogalmára építkezik. A csatorna egy logikai kapcsolatot képvisel a mûködési sávon belüli kapcsolat felett. Mindegyik csatornához egyetlen protokoll kötõdik, egy a többhöz alapon. Több csatorna is tarthozhat ugyanahhoz a protokollhoz, de egy csatornán nem használhatunk több protokollt. A csatornákon keresztül érkezõ L2CAP csomagok ezután a megfelelõ felsõbb rétegbeli protokollokhoz kerülnek. Több csatorna osztozhat ugyanazon a sávbeli kapcsolaton.</p></div><div class=paragraph><p>Minden Bluetooth eszközhöz létrejön egy <em>l2cap</em> típusú Netgraph-csomópont. Az L2CAP csomópont általában egy Bluetooth HCI csomóponthoz (lefelé) és egy Bluetooth sockethez (felfelé) kapcsolódik. Az L2CAP csomópont alapértelmezett neve "devicel2cap". Errõl részletesebben az <a href="https://man.freebsd.org/cgi/man.cgi?query=ng_l2cap&amp;sektion=4&amp;format=html">ng_l2cap(4)</a> man oldal világosít fel minket.</p></div><div class=paragraph><p>Ezen a szinten hasznos parancsnak bizonyulhat az <a href="https://man.freebsd.org/cgi/man.cgi?query=l2ping&amp;sektion=8&amp;format=html">l2ping(8)</a>, amivel más eszközöket tudunk pingelni. Elõfordulhat, hogy egyes Bluetooth implementációk nem válaszolnak semmilyen feléjük küldött adatra, így az alábbi példában is szereplõ <code>0 bytes</code> teljesen normális.</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># l2ping -a 00:80:37:29:19:a4</span>
0 bytes from 0:80:37:29:19:a4 <span class=nv>seq_no</span><span class=o>=</span>0 <span class=nb>time</span><span class=o>=</span>48.633 ms <span class=nv>result</span><span class=o>=</span>0
0 bytes from 0:80:37:29:19:a4 <span class=nv>seq_no</span><span class=o>=</span>1 <span class=nb>time</span><span class=o>=</span>37.551 ms <span class=nv>result</span><span class=o>=</span>0
0 bytes from 0:80:37:29:19:a4 <span class=nv>seq_no</span><span class=o>=</span>2 <span class=nb>time</span><span class=o>=</span>28.324 ms <span class=nv>result</span><span class=o>=</span>0
0 bytes from 0:80:37:29:19:a4 <span class=nv>seq_no</span><span class=o>=</span>3 <span class=nb>time</span><span class=o>=</span>46.150 ms <span class=nv>result</span><span class=o>=</span>0</code></pre></div></div><div class=paragraph><p>Az <a href="https://man.freebsd.org/cgi/man.cgi?query=l2control&amp;sektion=8&amp;format=html">l2control(8)</a> segédprogram használható az L2CAP csomópontok különbözõ mûveleteinek kivitelezésére. Ebben a példában a helyi eszközhöz tartozó logikai kapcsolatokat (csatornák) és sávokat kérdezzük le:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>% l2control <span class=nt>-a</span> 00:02:72:00:d4:1a read_channel_list
L2CAP channels:
Remote BD_ADDR     SCID/ DCID   PSM  IMTU/ OMTU State
00:07:e0:00:0b:ca    66/   64     3   132/  672 OPEN
% l2control <span class=nt>-a</span> 00:02:72:00:d4:1a read_connection_list
L2CAP connections:
Remote BD_ADDR    Handle Flags Pending State
00:07:e0:00:0b:ca     41 O           0 OPEN</code></pre></div></div><div class=paragraph><p>Másik ugyanilyen diagnosztikai eszköz a <a href="https://man.freebsd.org/cgi/man.cgi?query=btsockstat&amp;sektion=1&amp;format=html">btsockstat(1)</a>. Ha a viselkedését tekintjük, akkor leginkább a <a href="https://man.freebsd.org/cgi/man.cgi?query=netstat&amp;sektion=1&amp;format=html">netstat(1)</a> programra hasonlít, de a Bluetooth hálózatban megjelenõ adatszerkezetekkel dolgozik. Az alábbi példa az iménti <a href="https://man.freebsd.org/cgi/man.cgi?query=l2control&amp;sektion=8&amp;format=html">l2control(8)</a> parancs kimenetében szereplõ logikai kapcsolatokat mutatja:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>% btsockstat
Active L2CAP sockets
PCB      Recv-Q Send-Q Local address/PSM       Foreign address   CID   State
c2afe900      0      0 00:02:72:00:d4:1a/3     00:07:e0:00:0b:ca 66    OPEN
Active RFCOMM sessions
L2PCB    PCB      Flag MTU   Out-Q DLCs State
c2afe900 c2b53380 1    127   0     Yes  OPEN
Active RFCOMM sockets
PCB      Recv-Q Send-Q Local address     Foreign address   Chan DLCI State
c2e8bc80      0    250 00:02:72:00:d4:1a 00:07:e0:00:0b:ca 3    6    OPEN</code></pre></div></div></div><div class=sect3><h4 id=_az_rfcomm_protokoll>31.4.5. Az RFCOMM protokoll<a class=anchor href=#_az_rfcomm_protokoll></a></h4><div class=paragraph><p>Az RFCOMM protokoll a soros portok emulációját valósítja meg az L2CAP protokollon keresztül. A protokoll az ETSI TS 07.10. RFCOMM szabványán alapszik, és egy egyszerû átviteli protokoll, amelyet a 9 tûs RS-232 (EIATIA-232-E) soros portok emulációjára készítettek fel. Az RFCOMM protokoll legfeljebb 60 kapcsolat (RFCOMM csatorna) párhuzamos használatát támogatja két Bluetooth eszköz között.</p></div><div class=paragraph><p>Az RFCOMM számára a teljes kommunikációs útvonal két különbözõ eszközön futó alkalmazást (kommunikációs végpontot) és köztük levõ kommunikációs szegments foglalja magában. Az RFCOMM az adott eszközön a soros portot használó alkalmazások részére készült. A kommunikációs szegmens az egyik eszköztõl a másikig vezetõ Bluetooth alapú összeköttetés (közvetlen kapcsolat).</p></div><div class=paragraph><p>Közvetlen kapcsolat esetén az RFCOMM csak az eszközök közti kapcsolattal foglalkozik, valamint hálózati kapcsolat esetén az eszköz és a modem közti kapcsolattal. Az RFCOMM más konfigurációkat is támogat, például olyan modulokat, amelyek az egyik oldalon a Bluetooth vezeték nélküli technológián keresztül kommunikálnak, míg a másik oldalon egy vonalas felületet nyújtanak.</p></div><div class=paragraph><p>A FreeBSD-ben az RFCOMM protokollt Bluetooth foglalatok rétegében valósították meg.</p></div></div><div class=sect3><h4 id=_az_eszközök_párosítása>31.4.6. Az eszközök párosítása<a class=anchor href=#_az_eszközök_párosítása></a></h4><div class=paragraph><p>Alapértelmezés szerint a Bluetooth kommunikáció nem hitelesítõdik és bármelyik eszköz képes bármelyik másikkal felvenni a kapcsolatot. Egy Bluetooth eszköz (például egy mobiltelefon) egy adott szolgáltatáshoz igényelhet hitelesítést (például betárcsázáshoz). A Bluetooth alapú hitelesítés többnyire <em>PIN kódokkal</em> történik. A PIN kód egy legfeljebb 16 karakterbõl álló ASCII karakterlánc. A felhasználóknak mind a két eszközön ugyanazt a PIN kódot kell megadniuk. Miután megadtuk a PIN kódot, az eszközök létrehoznak hozzájuk egy <em>összekötettésbeli kulcsot</em> (link key). Ezután ezt a kulcsot vagy az eszközökön tároljuk vagy pedig valamilyen tartós tárolón. A következõ alkalommal mind a két eszközt ezt a korábban elkészített kulcsot fogja használni. Ezt az eljárást nevezik <em>párosításnak</em> (pairing). Ha valamelyik eszköz elveszti az össszeköttetés kulcsát, akkor a párosítást meg kell ismételni.</p></div><div class=paragraph><p>A <a href="https://man.freebsd.org/cgi/man.cgi?query=hcsecd&amp;sektion=8&amp;format=html">hcsecd(8)</a> démon felelõs az összes Bluetooth alapú hitelesítési kérés lekezeléséért. Az alapértelmezett konfigurációs állománya az <span class=filename>/etc/bluetooth/hcsecd.conf</span>. Például így tudjuk benne egy mobiltelefonhoz megadni az "1234" PIN kódot:</p></div><div class="literalblock programlisting"><div class=content><pre>device {
        bdaddr  00:80:37:29:19:a4;
        name    &#34;Pav T39-ese&#34;;
        key     nokey;
        pin     &#34;1234&#34;;
      }</pre></div></div><div class=paragraph><p>Semmilyen korlátozás nincs a PIN kódokra (a méretüktõl eltekintve). Egyes eszközökbe (például a Bluetooth fejhallgatók) elõre rögzített PIN kódot építettek bele. A <code>-d</code> kapcsoló hatására a <a href="https://man.freebsd.org/cgi/man.cgi?query=hcsecd&amp;sektion=8&amp;format=html">hcsecd(8)</a> démont az elõtérben lehet futtatni, így könnyebben láthatjuk mi történik. A távoli eszközt állítsuk be a párosítás elfogadására és kezdeményezzünk felé egy Bluetooth kapcsolatot. A távoli eszköznek erre azt kell válaszolnia, hogy elfogadta a párosítást, majd kérni fogja a PIN kódot. Adjuk meg ugyanazt a PIN kódot, mint amit a <span class=filename>hcsecd.conf</span> állományba is beírtunk. Most már a gépünk és a távoli eszköz párban vannak. A párosítást a távoli eszközrõl is kezdeményezhetjük.</p></div><div class=paragraph><p>A FreeBSD 5.5, 6.1 és újabb változataiban az <span class=filename>/etc/rc.conf</span> állományba a következõ sort kell felvenni a hcsecd automatikus indításához:</p></div><div class="literalblock programlisting"><div class=content><pre>hcsecd_enable=&#34;YES&#34;</pre></div></div><div class=paragraph><p>Ez pedig a hcsecd démon által generált kimenetre példa:</p></div><div class="literalblock programlisting"><div class=content><pre>hcsecd[16484]: Got Link_Key_Request event from &#39;ubt0hci&#39;, remote bdaddr 0:80:37:29:19:a4
hcsecd[16484]: Found matching entry, remote bdaddr 0:80:37:29:19:a4, name &#39;Pav&#39;s T39&#39;, link key doesn&#39;t exist
hcsecd[16484]: Sending Link_Key_Negative_Reply to &#39;ubt0hci&#39; for remote bdaddr 0:80:37:29:19:a4
hcsecd[16484]: Got PIN_Code_Request event from &#39;ubt0hci&#39;, remote bdaddr 0:80:37:29:19:a4
hcsecd[16484]: Found matching entry, remote bdaddr 0:80:37:29:19:a4, name &#39;Pav&#39;s T39&#39;, PIN code exists
hcsecd[16484]: Sending PIN_Code_Reply to &#39;ubt0hci&#39; for remote bdaddr 0:80:37:29:19:a4</pre></div></div></div><div class=sect3><h4 id=_service_discovery_protocol_sdp>31.4.7. Service Discovery Protocol (SDP)<a class=anchor href=#_service_discovery_protocol_sdp></a></h4><div class=paragraph><p>A Service Discovery Protocol (SDP) segítségével a kliens alkalmazások képes felderíteni, hogy a szerver alkalmazások részérõl milyen szolgáltatások érhetõek el, valamint ezek a szolgáltatások milyen tulajdonságokkal rendelkeznek. A szolgáltatások tulajdonsági közé soroljuk többek között a felajánlott szolgáltatás típusát vagy osztályát, illetve a szolgáltatás kihasználásához szükséges mechanizmusra vagy protokollra vonatkozó információkat.</p></div><div class=paragraph><p>Az SDP az SDP szerver és az SDP kliens közti kommunikációt foglalja magában. A szerver karbantart egy listát azokról a szolgáltatási rekordokról, amelyek a szerverhez tartozó szolgáltatások jellemzõit írják le. Mindegyik ilyen szolgáltatási rekord egyetlen szolgáltatás adatait tartalmazza. A kliensek egy SDP kéréssel ezeket a szolgáltatási rekordokat kérhetik el az SDP szervertõl. Amennyiben a kliens, vagy a hozzá tartozó alkalmazás a szolgáltatás használata mellett dönt, akkor a szolgáltatás használatához a megfelelõ szolgáltató felé nyitnia kell egy külön kapcsolatot. Az SDP csak a szolgáltatások és azok tulajdonságainak felderítéséhez ad segítséget, de semmilyen eszközt nem tartalmaz a felhasználásukra.</p></div><div class=paragraph><p>Általában az SDP kliensek általában valamilyen számunkra kellõ tulajdonság alapján keresnek szolgáltatásokat. Ráadásul adódhatnak olyan alkalmak is, amikor a szolgáltatások elõzetes ismerete nélkül szeretnénk felderíteni a rendelkezésre álló szolgáltatások típusait. A felajánlott szolgáltatások ilyen típusú feldolgozását nevezzük <em>böngészésnek</em> (browsing).</p></div><div class=paragraph><p>Az <a href="https://man.freebsd.org/cgi/man.cgi?query=sdpd&amp;sektion=8&amp;format=html">sdpd(8)</a> Bluetooth SDP szerver és a parancssoros <a href="https://man.freebsd.org/cgi/man.cgi?query=sdpcontrol&amp;sektion=8&amp;format=html">sdpcontrol(8)</a> kliens az alap FreeBSD telepítés része. Az alábbi példában egy SDP böngészési kérést adunk ki:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>% sdpcontrol <span class=nt>-a</span> 00:01:03:fc:6e:ec browse
Record Handle: 00000000
Service Class ID List:
        Service Discovery Server <span class=o>(</span>0x1000<span class=o>)</span>
Protocol Descriptor List:
        L2CAP <span class=o>(</span>0x0100<span class=o>)</span>
                Protocol specific parameter <span class=c>#1: u/int/uuid16 1</span>
                Protocol specific parameter <span class=c>#2: u/int/uuid16 1</span>

Record Handle: 0x00000001
Service Class ID List:
        Browse Group Descriptor <span class=o>(</span>0x1001<span class=o>)</span>

Record Handle: 0x00000002
Service Class ID List:
        LAN Access Using PPP <span class=o>(</span>0x1102<span class=o>)</span>
Protocol Descriptor List:
        L2CAP <span class=o>(</span>0x0100<span class=o>)</span>
        RFCOMM <span class=o>(</span>0x0003<span class=o>)</span>
                Protocol specific parameter <span class=c>#1: u/int8/bool 1</span>
Bluetooth Profile Descriptor List:
        LAN Access Using PPP <span class=o>(</span>0x1102<span class=o>)</span> ver. 1.0</code></pre></div></div><div class=paragraph><p>és így tovább. Mindegyik szolgáltatáshoz hozzátartozik a tulajdonságok egy listája (például RFCOMM csatorna). Lehetséges, hogy szolgáltatástól függõen bizonyos tulajdonságokat kell figyelnünk. Egyes Bluetooth implementációk nem támogatják a szolgáltatások böngészését és ezért egy üres listát adnak vissza. Ebben az esetben egy konkrét szolgáltatásra tudunk rákeresni. A következõ példában az OBEX Object Push (OPUSH) szolgáltatást keressük:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>% sdpcontrol <span class=nt>-a</span> 00:01:03:fc:6e:ec search OPUSH</code></pre></div></div><div class=paragraph><p>FreeBSD alatt az <a href="https://man.freebsd.org/cgi/man.cgi?query=sdpd&amp;sektion=8&amp;format=html">sdpd(8)</a> szerverrel tudunk szolgáltatásokat felajánlani a Bluetooth klienseknek. A FreeBSD 5.5, 6.1 vagy késõbbi változataiban ehhez a következõ sort kell megadnunk az <span class=filename>/etc/rc.conf</span> állományban:</p></div><div class="literalblock programlisting"><div class=content><pre>sdpd_enable=&#34;YES&#34;</pre></div></div><div class=paragraph><p>Ezután az sdpd démon így indítható el:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># /etc/rc.d/sdpd start</span></code></pre></div></div><div class=paragraph><p>A távoli kliensek részére Bluetooth szolgáltatásokat felajánlani kívánó helyi szerver alkalmazásoknak regisztrálniuk kell magukat a helyi SDP démonnál. Például az egyik ilyen alkalmazás az <a href="https://man.freebsd.org/cgi/man.cgi?query=rfcomm_pppd&amp;sektion=8&amp;format=html">rfcomm_pppd(8)</a>, és elindítása után regisztrálni fogja a Bluetooth LAN szolgáltatást a helyi SDP démonnál.</p></div><div class=paragraph><p>A helyi SDP szerveren regisztrált szolgáltatásokat a helyi vezérlési csatornán keresztül egy <code>browse</code> kéréssel tudjuk lekérdezni:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># sdpcontrol -l browse</span></code></pre></div></div></div><div class=sect3><h4 id=_a_betárcsázós_hálózati_és_a_ppp_hálózati_hozzáférési_lan_profilok>31.4.8. A betárcsázós hálózati és a PPP hálózati hozzáférési (LAN) profilok<a class=anchor href=#_a_betárcsázós_hálózati_és_a_ppp_hálózati_hozzáférési_lan_profilok></a></h4><div class=paragraph><p>A betárcsázós hálózati (Dial-Up Networking, DUN) profil leggyakrabban a modemek és mobiltelefonok között tûnik fel. Ez a profil a következõ forgatókönyveket dolgozza fel:</p></div><div class=ulist><ul><li><p>A számítógépünkkel egy mobiltelefont vagy modemet vezeték nélküli modemként használunk, amivel az internethez vagy más hálózatokhoz csatlakozunk betárcsázással.</p></li><li><p>A számítógépünkkel egy mobiltelefonon vagy modemen keresztül fogadunk adathívásokat.</p></li></ul></div><div class=paragraph><p>A PPP hálózati hozzáférési (LAN) profil a következõ helyezetekben alkalmazható:</p></div><div class=ulist><ul><li><p>LAN hozzáférés egyetlen Bluetooth eszközhöz</p></li><li><p>LAN hozzáférés több Bluetooth eszközhöz</p></li><li><p>Két gép összekötése (a soros vonali kapcsolat emulációval PPP-n keresztül)</p></li></ul></div><div class=paragraph><p>FreeBSD alatt mind a két profilt a <a href="https://man.freebsd.org/cgi/man.cgi?query=ppp&amp;sektion=8&amp;format=html">ppp(8)</a> és az <a href="https://man.freebsd.org/cgi/man.cgi?query=rfcomm_pppd&amp;sektion=8&amp;format=html">rfcomm_pppd(8)</a> valósítja meg - egy olyan wrapper eszköz, amely az RFCOMM Bluetooth kapcsolatokat a PPP számára is értelmessé alakítja át. Mielõtt még bármelyik profilt elkezdenénk használni, egy új PPP címkét kell létrehozni az <span class=filename>/etc/ppp/ppp.conf</span> állományban. Erre példát az <a href="https://man.freebsd.org/cgi/man.cgi?query=rfcomm_pppd&amp;sektion=8&amp;format=html">rfcomm_pppd(8)</a> man oldalon találhatunk.</p></div><div class=paragraph><p>A következõ példában az <a href="https://man.freebsd.org/cgi/man.cgi?query=rfcomm_pppd&amp;sektion=8&amp;format=html">rfcomm_pppd(8)</a> programot fogjuk használni arra, hogy egy RFCOMM típusú kapcsolatot nyissunk a 00:80:37:29:19:a4 címmel rendelkezõ távoli Bluetooth eszköz felé. A tényleges RFCOMM csatorna számát SDP-n keresztül a távoli eszköztõl kapjuk. Az RFCOMM csatorna kézzel is megadható, és ilyen esetekben az <a href="https://man.freebsd.org/cgi/man.cgi?query=rfcomm_pppd&amp;sektion=8&amp;format=html">rfcomm_pppd(8)</a> nem fog SDP kérést küldeni. A <a href="https://man.freebsd.org/cgi/man.cgi?query=sdpcontrol&amp;sektion=8&amp;format=html">sdpcontrol(8)</a> használatával tudjuk lekérdezni a távoli eszközön létrejött RFCOMM csatornát.</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># rfcomm_pppd -a 00:80:37:29:19:a4 -c -C dun -l rfcomm-dialup</span></code></pre></div></div><div class=paragraph><p>A PPP hálózati elérés (LAN) szolgáltatás beindításához futni kell a <a href="https://man.freebsd.org/cgi/man.cgi?query=sdpd&amp;sektion=8&amp;format=html">sdpd(8)</a> szervernek. A helyi hálózaton keresztül csatlakozó kliensekhez létre kell hozni egy új bejegyzést az <span class=filename>/etc/ppp/ppp.conf</span> állományban. Az <a href="https://man.freebsd.org/cgi/man.cgi?query=rfcomm_pppd&amp;sektion=8&amp;format=html">rfcomm_pppd(8)</a> man oldalon találhatunk erre példákat. Végezetül indítsuk el az RFCOMM PPP szervert egy érvényes RFCOMM csatornaszámmal. Az RFCOMM PPP szerver ekkor automatikusan regisztrálja a Bluetooth LAN szolgáltatást a helyi SDP démonnál. A következõ példában megmutatjuk, hogyan lehet elindítani egy RFCOMM PPP szervert:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># rfcomm_pppd -s -C 7 -l rfcomm-server</span></code></pre></div></div></div><div class=sect3><h4 id=_az_obex_object_push_opush_profil>31.4.9. Az OBEX Object Push (OPUSH) profil<a class=anchor href=#_az_obex_object_push_opush_profil></a></h4><div class=paragraph><p>Az OBEX egy széles körben alkalmazott protokoll a mobileszközök közti egyszerû állományvitelre. Legfõképpen az infravörös kommunikációban alkalmazzák, ahol a laptopok vagy PDA-k közti általános állományátvitelre használják, illetve névjegykártyák vagy naptárbejegyzések átküldésére mobiltelefonok között és egyéb PIM alkalmazást futtató eszközök esetében.</p></div><div class=paragraph><p>Az OBEX szervert és klienst egy külsõ csomag, az obexapp valósítja meg, amelyet az <a class=package href=https://cgit.freebsd.org/ports/tree/comms/obexapp/>comms/obexapp</a> portból érhetünk el.</p></div><div class=paragraph><p>Az OBEX kliens használható objektumok áttolására vagy lehúzására az OBEX szerverhez. Ez az objektum lehet például egy névjegykártya vagy egy megbeszélt találkozó. Az OBEX kliens SDP-n keresztül tud magának RFCOMM csatornaszámot szerezni. Ezt úgy tehetjük meg, ha a szolgáltatás neve helyett egy RFCOMM csatorna számát adjuk meg. A támogatott szolgáltatások: IrMC, FTRN és OPUSH. Számként RFCOMM csatorna is megadható. Az alábbi példában egy OBEX munkamenetet láthatunk, ahol az eszköz információs objektumát húzzuk le a mobiltelefonról és egy új objektumot (egy névjegykártyát) tolunk fel a telefon könyvtárába.</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>% obexapp <span class=nt>-a</span> 00:80:37:29:19:a4 <span class=nt>-C</span> IrMC
obex&gt; get telecom/devinfo.txt devinfo-t39.txt
Success, response: OK, Success <span class=o>(</span>0x20<span class=o>)</span>
obex&gt; put new.vcf
Success, response: OK, Success <span class=o>(</span>0x20<span class=o>)</span>
obex&gt; di
Success, response: OK, Success <span class=o>(</span>0x20<span class=o>)</span></code></pre></div></div><div class=paragraph><p>Az OBEX objektumok tologatásának támogatásához az <a href="https://man.freebsd.org/cgi/man.cgi?query=sdpd&amp;sektion=8&amp;format=html">sdpd(8)</a> szervernek kell futnia. Továbbá a beérkezõ objektumok tárolásához létre kell hoznunk még egy könyvtárat is. Ez az könyvtár alapértelmezés szerint a <span class=filename>/var/spool/obex</span>. Végül indítsuk el az OBEX szervert egy érvényes RFCOMM csatorna számának megadásával. Az OBEX szerver ezután automatikusan regisztrálja az "OBEX Object Push" nevû szolgáltatást a helyi SDP démonnál. Ebben a példában láthatjuk az OBEX szerver indítását:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># obexapp -s -C 10</span></code></pre></div></div></div><div class=sect3><h4 id=_soros_vonali_profil_spp>31.4.10. Soros vonali profil (SPP)<a class=anchor href=#_soros_vonali_profil_spp></a></h4><div class=paragraph><p>A soros vonali profil (Serial Port Profile, SPP) használatával RS232 (vagy ahhoz hasonló) vonali adatátvitelt tudunk emulálni. Ez a profil a régebben fejlesztett alkalmazásokkal birkózik meg, és a Bluetooth technológiával valódi kábel helyett egy virtuális soros portot képez le.</p></div><div class=paragraph><p>Az <a href="https://man.freebsd.org/cgi/man.cgi?query=rfcomm_sppd&amp;sektion=1&amp;format=html">rfcomm_sppd(1)</a> segédprogram ezt a soros vonali profilt valósítja meg. Így egy pszeudo terminált tudunk virtuális soros portként használni. Ha nem adunk meg RFCOMM csatornát, akkor az <a href="https://man.freebsd.org/cgi/man.cgi?query=rfcomm_sppd&amp;sektion=1&amp;format=html">rfcomm_sppd(1)</a> képes SDP-n keresztül kérni egyet magának a távoli eszköztõl. Ha ezt felül kívánjuk bírálni, akkor a parancssorban megadhatunk akár egy konkrét RFCOMM csatornát is.</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># rfcomm_sppd -a 00:07:E0:00:0B:CA -t /dev/ttyp6</span>
rfcomm_sppd[94692]: Starting on /dev/ttyp6...</code></pre></div></div><div class=paragraph><p>Miután csatlakoztunk, a pszeudo terminált tudjuk soros portként használni:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># cu -l ttyp6</span></code></pre></div></div></div><div class=sect3><h4 id=_hibaelhárítás_4>31.4.11. Hibaelhárítás<a class=anchor href=#_hibaelhárítás_4></a></h4><div class=sect4><h5 id=_nem_tudunk_csatlakozni_a_távoli_eszközzel>31.4.11.1. Nem tudunk csatlakozni a távoli eszközzel<a class=anchor href=#_nem_tudunk_csatlakozni_a_távoli_eszközzel></a></h5><div class=paragraph><p>Egyes Bluetooth eszközök nem támogatják a szerepek cseréjét (role switch). Alapértelmezés szerint amikor a FreeBSD elfogad egy új kapcsolatot, megpróbál rajta szerepet cserélni és mesterré válni. Azok az eszközök, amelyek ezt nem támogatják, nem lesznek képesek emiatt csatlakozni. Ez a szerepváltás az új kapcsolatok felépítése során zajlik le, ezért egy távoli eszköztõl nem lehet megtudni, hogy ismeri-e ezt a lehetõséget. A helyi oldalon a következõ HCI opcióval lehet kikapcsolni a szerepcserét:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># hccontrol -n ubt0hci write_node_role_switch 0</span></code></pre></div></div></div><div class=sect4><h5 id=_valami_nem_megy_lehet_látni_valahogy_pontosan_mi_is_történik>31.4.11.2. Valami nem megy. Lehet látni valahogy, pontosan mi is történik?<a class=anchor href=#_valami_nem_megy_lehet_látni_valahogy_pontosan_mi_is_történik></a></h5><div class=paragraph><p>Persze, igen. Egy külsõ csomag, a hcidump segítségével, amely a <a class=package href=https://cgit.freebsd.org/ports/tree/comms/hcidump/>comms/hcidump</a> portból érhetõ el. A hcidump segédprogram a <a href="https://man.freebsd.org/cgi/man.cgi?query=tcpdump&amp;sektion=1&amp;format=html">tcpdump(1)</a> programhoz hasonlítható. Ezzel lehet a Bluetooth csomagok tartalmát megnézni a terminálon vagy elmenteni ezeket egy állományba.</p></div></div></div></div><div class=sect2><h3 id=network-bridging>31.5. Hálózati hidak<a class=anchor href=#network-bridging></a></h3><div class=sect3><h4 id=_bevezetés_6>31.5.1. Bevezetés<a class=anchor href=#_bevezetés_6></a></h4><div class=paragraph><p>Gyakran hasznos lehet anélkül felosztani egy fizikai hálózatot (például egy Ethernet szegmenst) két külön hálózati szegmensre, hogy külön IP-alhálózatot kellene létrehozunk és összekötnünk ezeket egy útválasztóval. A két ilyen módon kialakított hálózatot összekötõ eszközt nevezzük "hálózati hídnak" (bridge). A legalább két hálózati felülettel rendelkezõ FreeBSD rendszerek képesek hálózati híd szerepét betölteni.</p></div><div class=paragraph><p>A hálózati híd az eszközök adatkapcsolati rétegben a hozzá tartozó felületein megjelenõ (vagyis Ethernet) címének megtanulásával mûködik. A két hálózat között csak akkor közvetít forgalmat, amikor a forrás és cél nem ugyanabban a hálózatban található.</p></div><div class=paragraph><p>A hálózati hidak bizonyos szempontból lényegében nagyon kevés porttal rendelkezõ Ethernet switch-ek.</p></div></div><div class=sect3><h4 id=_a_hálózati_hidak_tipikus_alkalmazásai>31.5.2. A hálózati hidak tipikus alkalmazásai<a class=anchor href=#_a_hálózati_hidak_tipikus_alkalmazásai></a></h4><div class=paragraph><p>Napjainkban akad néhány igen jellemzõ szituáció, ahol szükség van a hálózati hidak alkalmazására.</p></div><div class=sect4><h5 id=_hálózatok_összekötése>31.5.2.1. Hálózatok összekötése<a class=anchor href=#_hálózatok_összekötése></a></h5><div class=paragraph><p>A hálózati hidak alapvetõ feladata két vagy több hálózati szegmens összekötése. Az egyszerû hálózati környezet felállítása helyett több okból is felmerülhet a hidak létrehozása: kábelezési megszorítások, tûzfalazás vagy pszeudo hálózatok, például virtuális gépek felületének csatlakoztatása miatt. Egy híd használatával ráadásul össze tudunk kötni egy vezeték nélküli hozzáférési pontként üzemelõ felületet egy vezetékes hálózattal.</p></div></div><div class=sect4><h5 id=_szûrés_vagy_forgalomkorlátozás_tûzfallal>31.5.2.2. Szûrés vagy forgalomkorlátozás tûzfallal<a class=anchor href=#_szûrés_vagy_forgalomkorlátozás_tûzfallal></a></h5><div class=paragraph><p>Sokszor elõfordulhat, hogy útválasztás vagy hálózati címfordítás (NAT) nélkül szeretnénk tûzfalat használni.</p></div><div class=paragraph><p>Példaként képzeljünk el egy olyan kis méretû céget, amely egy DSL vagy ISDN vonalon kapcsolódik az internet-szolgáltatójához. A szolgáltatótól 13, mindenki által használható IP-címet kaptak és a hálózatukban 10 gép van. Ebben a helyzetben egy útválasztást végzõ tûzfal mûködtetése nehézkessé válna az alhálózatok problémái miatt.</p></div><div class=paragraph><p>Egy hídként viselkedõ tûzfallal azonban minden IP számozási probléma nélkül egyszerûen be tudjuk dobni a gépeket a DSL/ISDN útválasztó mögé.</p></div></div><div class=sect4><h5 id=_a_hálózat_megcsapolása>31.5.2.3. A hálózat megcsapolása<a class=anchor href=#_a_hálózat_megcsapolása></a></h5><div class=paragraph><p>Egy hálózati híddal úgy kapcsolunk össze két hálózati szegmenst, hogy közben meg tudjuk vizsgálni a kettejük között mozgó Ethernet kereteket. Ezt a híd felületen a <a href="https://man.freebsd.org/cgi/man.cgi?query=bpf&amp;sektion=4&amp;format=html">bpf(4)</a> valamint a <a href="https://man.freebsd.org/cgi/man.cgi?query=tcpdump&amp;sektion=1&amp;format=html">tcpdump(1)</a> segítségével tudjuk megoldani, vagy úgy, ha egy másik felületen elküldjük az összes keret másolatát (span, vagyis feszítõ port).</p></div></div><div class=sect4><h5 id=_vpn_az_adatkapcsolati_rétegben>31.5.2.4. VPN az adatkapcsolati rétegben<a class=anchor href=#_vpn_az_adatkapcsolati_rétegben></a></h5><div class=paragraph><p>A két Ethernet hálózatot egy IP alapú összeköttetésen keresztül is össze tudunk kötni, ha a hálózatokat egy EtherIP járaton keresztül kötjük össze híddal, vagy egy OpenVPN-hez hasonló <a href="https://man.freebsd.org/cgi/man.cgi?query=tap&amp;sektion=4&amp;format=html">tap(4)</a> alapú megoldással.</p></div></div><div class=sect4><h5 id=_redundancia_az_adatkapcsolati_rétegben>31.5.2.5. Redundancia az adatkapcsolati rétegben<a class=anchor href=#_redundancia_az_adatkapcsolati_rétegben></a></h5><div class=paragraph><p>A hálózatokat több linken keresztül kötjük össze és a redundáns útvonalakat a feszítõfa protokollal (Spanning Tree Protocol, STP). Az Ethernetes hálózatok esetében a megfelelõ mûködéshez a két eszköz között csak egyetlen aktív útvonal létezhet, így a feszítõfa protokoll észleli a hurkokat és a redundáns összeköttetéseket blokkolt állapotba teszi. Amikor azonban az aktív linkek egyike meghibásodik, akkor a protokoll újraszámolja a fát és a hálózati pontjai közti konnektivitást megpróbálja helyreállítani az addig blokkolt linkek ismételt engedélyezésével.</p></div></div></div><div class=sect3><h4 id=_a_rendszermag_beállításai_3>31.5.3. A rendszermag beállításai<a class=anchor href=#_a_rendszermag_beállításai_3></a></h4><div class=paragraph><p>Ebben a szakaszban az <a href="https://man.freebsd.org/cgi/man.cgi?query=if_bridge&amp;sektion=4&amp;format=html">if_bridge(4)</a> hálózati híd implementációval foglalkozunk, de a Netgraph segítségével is tudunk hidakat építeni. Ez utóbbiról az <a href="https://man.freebsd.org/cgi/man.cgi?query=ng_bridge&amp;sektion=4&amp;format=html">ng_bridge(4)</a> man oldalon olvashatunk.</p></div><div class=paragraph><p>Amikor létrehozunk egy hálózati hidat, az <a href="https://man.freebsd.org/cgi/man.cgi?query=ifconfig&amp;sektion=8&amp;format=html">ifconfig(8)</a> automatikusan betölti a hozzá tartozó meghajtót. Ha viszont a rendszermag beállításait tartalmazó állományba felvesszük a <code>device if_bridge</code> sort, akkor akár be is építhetjük a rendszermagba.</p></div><div class=paragraph><p>A csomagszûrés minden olyan tûzfallal használható, amely a <a href="https://man.freebsd.org/cgi/man.cgi?query=pfil&amp;sektion=9&amp;format=html">pfil(9)</a> rendszerre kapcsolódik. Maga a tûzfal is betölthetõ modulként, vagy belefordítható a rendszermagba.</p></div><div class=paragraph><p>A hálózati híddal forgalmat is tudunk szabályozni az <a href="https://man.freebsd.org/cgi/man.cgi?query=altq&amp;sektion=4&amp;format=html">altq(4)</a> vagy a <a href="https://man.freebsd.org/cgi/man.cgi?query=dummynet&amp;sektion=4&amp;format=html">dummynet(4)</a> segítségével.</p></div></div><div class=sect3><h4 id=_a_hálózati_híd_engedélyezése>31.5.4. A hálózati híd engedélyezése<a class=anchor href=#_a_hálózati_híd_engedélyezése></a></h4><div class=paragraph><p>Hálózati hidak felületek klónozásával hozhatóak létre. A híd létrehozásához használjuk az <a href="https://man.freebsd.org/cgi/man.cgi?query=ifconfig&amp;sektion=8&amp;format=html">ifconfig(8)</a> programot, és a megfelelõ meghajtó automatikusan betöltõdik, ha nem lenne még elérhetõ a rendszermagban.</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># ifconfig bridge create</span>
bridge0
<span class=c># ifconfig bridge0</span>
bridge0: <span class=nv>flags</span><span class=o>=</span>8802&lt;BROADCAST,SIMPLEX,MULTICAST&gt; metric 0 mtu 1500
        ether 96:3d:4b:f1:79:7a
        <span class=nb>id </span>00:00:00:00:00:00 priority 32768 hellotime 2 fwddelay 15
        maxage 20 holdcnt 6 proto rstp maxaddr 100 <span class=nb>timeout </span>1200
        root <span class=nb>id </span>00:00:00:00:00:00 priority 0 ifcost 0 port 0</code></pre></div></div><div class=paragraph><p>Ekkor létrejön a hálózati hídhoz tartozó felület és véletlenszerûen generálódik hozzá egy Ethernetes cím. A <code>maxaddr</code> és a <code>timeout</code> paraméterek vezérlik, hogy a híd mennyi MAC-címet tartson meg a keretek továbbításáért felelõs táblázatban és mennyi másodperc után töröljön automatikusan egy bejegyzést a legutolsó használat után. A többi paraméter a feszítõfa mûködését irányítja.</p></div><div class=paragraph><p>Vegyük fel a hídhoz tartozó hálózati tagfelületeket. A híd csak akkor fog a tagfelületek között csomagokat továbbküldeni, amikor a híd és a tagok is <code>up</code> állapotban vannak:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># ifconfig bridge0 addm fxp0 addm fxp1 up</span>
<span class=c># ifconfig fxp0 up</span>
<span class=c># ifconfig fxp1 up</span></code></pre></div></div><div class=paragraph><p>A híd most már átküldi az Ethernet kereteket a <span class=filename>fxp0</span> és <span class=filename>fxp1</span> felületek között. Az iméntiekkel megegyezõ konfigurációt az <span class=filename>/etc/rc.conf</span> állományban így alakíthatjuk ki:</p></div><div class="literalblock programlisting"><div class=content><pre>cloned_interfaces=&#34;bridge0&#34;
ifconfig_bridge0=&#34;addm fxp0 addm fxp1 up&#34;
ifconfig_fxp0=&#34;up&#34;
ifconfig_fxp1=&#34;up&#34;</pre></div></div><div class=paragraph><p>Ha a hídhoz IP-címet is rendelni akarunk, akkor inkább magánál a hídnál adjuk meg, ne a tagoknál. Ezt statikusan vagy DHCP használatával is megtehetjük:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># ifconfig bridge0 inet 192.168.0.1/24</span></code></pre></div></div><div class=paragraph><p>A hídhoz IPv6 címet is hozzá tudunk rendelni.</p></div></div><div class=sect3><h4 id=_tûzfalazás>31.5.5. Tûzfalazás<a class=anchor href=#_tûzfalazás></a></h4><div class=paragraph><p>Ha engedélyezzük a csomagszûrést, a hídon áthaladó csomagok elõször a küldõ felület érkezési oldalára kerülnek, majd a hídra, végül a megfelelõ irányban levõ felület küldési oldalára. Bármelyik fázis letiltható. Amikor a csomagok áramlásának iránya fontos számunkra, akkor jobban járunk, ha nem magára a hídra, hanem csak a tagfelületekre állítjuk be a tûzfalat.</p></div><div class=paragraph><p>A híd számos módosítható beállítással rendelkezik a nem-IP és ARP csomagok átküldésére, valamint arra, hogy az IPFW tûzfal adatkapcsolati réteg szintjén mûködhessen. Az <a href="https://man.freebsd.org/cgi/man.cgi?query=if_bridge&amp;sektion=4&amp;format=html">if_bridge(4)</a> man oldal ennek részleteit tárja fel.</p></div></div><div class=sect3><h4 id=_feszítõfák>31.5.6. Feszítõfák<a class=anchor href=#_feszítõfák></a></h4><div class=paragraph><p>A híd meghajtója a gyors feszítõfa protokollt (Rapid Spanning Tree Protocol, RSTP avagy 802.1w) valósítja meg, ami visszafelé kompatibilis a korábban említett feszítõfa protokollal. A feszítõfákat a hálózati topológiában felbukkanó hurkok észlelésére és eltávolítására alkalmazzák. Az RSTP azonban a hagyományos STP-nél valamivel gyorsabb konvergenciát ígér, mivel itt a szomszédos switch-ek kicserélik egymás között az adataikat, és így újabb hurkok létrehozása nélkül képesek viszonylag gyorsan egyik állapotból átváltani a másikba.</p></div><div class=paragraph><p>Az alábbi táblázat a támogatott mûködési módokat láthatjuk:</p></div><table class="tableblock frame-none grid-all stretch informaltable"><col style=width:33.3333%><col style=width:33.3333%><col style=width:33.3334%><thead><tr><th class="tableblock halign-left valign-top">Operációs rendszer</th><th class="tableblock halign-left valign-top">STP módok</th><th class="tableblock halign-left valign-top">Alapértelmezés</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class=tableblock>FreeBSD 5.4-FreeBSD 6.2</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>STP</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>STP</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>FreeBSD 6.3+</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>RSTP vagy STP</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>STP</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>FreeBSD 7.0+</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>RSTP vagy STP</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>RSTP</p></td></tr></tbody></table><div class=paragraph><p>A tagfelületeken az <code>stp</code> paranccsal tudjuk engedélyezni a feszítõfák használatát. Az <span class=filename>fxp0</span> és <span class=filename>fxp1</span> felületeket összekötõ hídfelület esetében tehát így:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># ifconfig bridge0 stp fxp0 stp fxp1</span>
bridge0: <span class=nv>flags</span><span class=o>=</span>8843&lt;UP,BROADCAST,RUNNING,SIMPLEX,MULTICAST&gt; metric 0 mtu 1500
        ether d6:cf:d5:a0:94:6d
        <span class=nb>id </span>00:01:02:4b:d4:50 priority 32768 hellotime 2 fwddelay 15
        maxage 20 holdcnt 6 proto rstp maxaddr 100 <span class=nb>timeout </span>1200
        root <span class=nb>id </span>00:01:02:4b:d4:50 priority 32768 ifcost 0 port 0
        member: fxp0 <span class=nv>flags</span><span class=o>=</span>1c7&lt;LEARNING,DISCOVER,STP,AUTOEDGE,PTP,AUTOPTP&gt;
                port 3 priority 128 path cost 200000 proto rstp
                role designated state forwarding
        member: fxp1 <span class=nv>flags</span><span class=o>=</span>1c7&lt;LEARNING,DISCOVER,STP,AUTOEDGE,PTP,AUTOPTP&gt;
                port 4 priority 128 path cost 200000 proto rstp
                role designated state forwarding</code></pre></div></div><div class=paragraph><p>Láthatjuk, hogy a híd a feszítõfában megkapta a <code>00:01:02:4b:d4:50</code>-es azonosítót és a <code>32768</code>-as prioritást. Mivel <code>root id</code> értéke is ugyanez, elmondhatjuk, hogy ez a fa gyökereként funkcionáló híd.</p></div><div class=paragraph><p>Ha a hálózaton már valahol létezik egy másik híd:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>bridge0: <span class=nv>flags</span><span class=o>=</span>8843&lt;UP,BROADCAST,RUNNING,SIMPLEX,MULTICAST&gt; metric 0 mtu 1500
        ether 96:3d:4b:f1:79:7a
        <span class=nb>id </span>00:13:d4:9a:06:7a priority 32768 hellotime 2 fwddelay 15
        maxage 20 holdcnt 6 proto rstp maxaddr 100 <span class=nb>timeout </span>1200
        root <span class=nb>id </span>00:01:02:4b:d4:50 priority 32768 ifcost 400000 port 4
        member: fxp0 <span class=nv>flags</span><span class=o>=</span>1c7&lt;LEARNING,DISCOVER,STP,AUTOEDGE,PTP,AUTOPTP&gt;
                port 4 priority 128 path cost 200000 proto rstp
                role root state forwarding
        member: fxp1 <span class=nv>flags</span><span class=o>=</span>1c7&lt;LEARNING,DISCOVER,STP,AUTOEDGE,PTP,AUTOPTP&gt;
                port 5 priority 128 path cost 200000 proto rstp
                role designated state forwarding</code></pre></div></div><div class=paragraph><p>A <code>root id 00:01:02:4b:d4:50 priority 32768 ifcost 400000 port 4</code> sor mutatja, hogy a fa gyökerét képezõ híd most a <code>00:01:02:4b:d4:50</code> azonosítóval rendelkezik, és ezt a hidat <code>400000</code>-res költséggel éri el a <code>port 4</code> (a 4. porton) keresztül, amely jelen esetben az <span class=filename>fxp0</span> felület.</p></div></div><div class=sect3><h4 id=_komolyabb_hidak_építése>31.5.7. Komolyabb hidak építése<a class=anchor href=#_komolyabb_hidak_építése></a></h4><div class=sect4><h5 id=_a_forgalom_áramlásának_átszerkesztése>31.5.7.1. A forgalom áramlásának átszerkesztése<a class=anchor href=#_a_forgalom_áramlásának_átszerkesztése></a></h5><div class=paragraph><p>A hidak támogatják az ún. megfigyelési módot, ahol a csomagokat a <a href="https://man.freebsd.org/cgi/man.cgi?query=bpf&amp;sektion=4&amp;format=html">bpf(4)</a> feldolgozásuk után eldobja, így nem folytatódik a feldolgozásuk vagy nem haladnak tovább. Ennek kihasználásával a két vagy több felületen érkezõ adatokat egyetlen <a href="https://man.freebsd.org/cgi/man.cgi?query=bpf&amp;sektion=4&amp;format=html">bpf(4)</a> folyammá tudjuk alakítani. Ez olyan hálózati csapok forgalmának átszerkesztésében hasznos, ahol a két különbözõ felületen keresztül küldjük ki az RX/TX (fogadás/küldés) jeleket.</p></div><div class=paragraph><p>Az alábbi paranccsal tudjuk megoldani, hogy négy felületrõl érkezõ adatot legyünk képesek egyetlen folyamként olvasni:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># ifconfig bridge0 addm fxp0 addm fxp1 addm fxp2 addm fxp3 monitor up</span>
<span class=c># tcpdump -i bridge0</span></code></pre></div></div></div><div class=sect4><h5 id=_feszítõ_portok>31.5.7.2. Feszítõ portok<a class=anchor href=#_feszítõ_portok></a></h5><div class=paragraph><p>A hídhoz befutó Ethernet keretek mindegyikérõl készül egy másolat, ami egy megadott feszítõ porton keresztül megy tovább. Hidanként végtelen számú ilyen feszítõ port létezhet, és ha egy felületet feszítõ portnak adtunk meg, akkor hagyományos portként már nem használhatjuk. Ez leginkább akkor hasznos, amikor passzívan akarjuk megfigyelni a híddal rendelkezõ hálózatot a híd valamelyik feszítõ portjára csatlakozó géprõl.</p></div><div class=paragraph><p>Küldessük az összes keretrõl egy másolatot az <span class=filename>fxp4</span> felületre:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># ifconfig bridge0 span fxp4</span></code></pre></div></div></div><div class=sect4><h5 id=_privát_felületek>31.5.7.3. Privát felületek<a class=anchor href=#_privát_felületek></a></h5><div class=paragraph><p>A privát felületek (private interface) csak más privát felületek felé küldenek tovább adatot. Így feltétel nélkül tudjuk korlátozni a forgalmat, és sem Ethernet keretek, sem pedig ARP nem megy keresztül rajtuk. Ha viszont szelektíven akarjuk korlátozni a forgalmat, akkor helyette használjunk tûzfalat.</p></div></div><div class=sect4><h5 id=_tapadós_felületek>31.5.7.4. Tapadós felületek<a class=anchor href=#_tapadós_felületek></a></h5><div class=paragraph><p>Ha a híd egyik tagfelületét tapadósnak (sticky) adjuk meg, akkor a dinamikusan megtanult címek bejegyzései a gyorsítótárba kerülésük után állandósulnak. A tapadós bejegyzések soha nem évülnek el vagy cserélõdnek le, még abban az esetben sem, ha utána az adott címet egy másik felületrõl látjuk. Így a továbbításra vonatkozó táblázatot nem kell elõre feltöltenünk, és a híd egyik oldalán meglátott kliensek nem képesek átvándorolni egy másik hálózati szegmensbe.</p></div><div class=paragraph><p>Másik ilyen példa a tapadós címek használatára az lehetne, amikor a hidat VLAN-nal kombináljuk, és így egy olyan útválasztót hozunk létre, ahol az ügyfeleink az IP-címtartomány pocséklása nélkül zárhatóak el egymástól. Tegyük fel, hogy az <code>A-ugyfel</code> a <code>vlan100</code>, és a <code>B-ugyfel</code> a <code>vlan101</code> felületen csatlakozik. A híd IP-címe <code>192.168.0.1</code>, amely maga is egy internet felé mutató útválasztó.</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># ifconfig bridge0 addm vlan100 sticky vlan100 addm vlan101 sticky vlan101</span>
<span class=c># ifconfig bridge0 inet 192.168.0.1/24</span></code></pre></div></div><div class=paragraph><p>Mind a két kliens a <code>192.168.0.1</code> címet látja alapértelmezett átjáróként, és mivel a híd gyorsítótára tapadós bejegyzéseket tartalmaz, a MAC-címeik meghamisításával nem tudják elcsípni a másikuk forgalmát.</p></div><div class=paragraph><p>A VLAN-ok közti bárminemû kommunikációt privát felületek létrehozásával akadályozzuk meg (vagy egy tûzfallal):</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># ifconfig bridge0 private vlan100 private vlan101</span></code></pre></div></div><div class=paragraph><p>Ezzel a megoldással az ügyfeleinket teljesen elszigeteljük egymástól úgy, hogy közben az egész <code>/24</code> címtartomány külön alhálózatok kialakítása nélkül kiosztható.</p></div></div><div class=sect4><h5 id=_címek_korlátozása>31.5.7.5. Címek korlátozása<a class=anchor href=#_címek_korlátozása></a></h5><div class=paragraph><p>Korlátozhatóak az egy felület mögül küldeni képes egyedi MAC-címek. Amikor ezen a határon felül érkeznek ismeretlen feladótól csomagok, egészen addig eldobjuk ezeket, amíg egy korábban már regisztrált bejegyzést a rendszer ki nem töröl vagy ki nem veszünk a gyorsítótárból.</p></div><div class=paragraph><p>A következõ példában az <code>vlan100</code> felületen csatlakozó <code>A-ugyfel</code> számára korlátozzuk le 10-re az Ethernet eszközök számát:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># ifconfig bridge0 ifmaxaddr vlan100 10</span></code></pre></div></div></div><div class=sect4><h5 id=_snmp_felügyelet>31.5.7.6. SNMP felügyelet<a class=anchor href=#_snmp_felügyelet></a></h5><div class=paragraph><p>A hidak és az STP paraméterei az alap FreeBSD rendszerben megtalálható SNMP démonnal felügyelhetõek. A hídhoz exportált felügyeleti információk (Management Information Base, MIB) megfelelnek az IETF által elõírt szabványoknak, így akár tetszõleges SNMP kliens vagy bármilyen más felügyeleti szoftver alkalmas az olvasásukra.</p></div><div class=paragraph><p>A hidat mûködtetõ gépen az <span class=filename>/etc/snmp.config</span> állományban engedélyezzük a <code>begemotSnmpdModulePath."bridge" = "/usr/lib/snmp_bridge.so"</code> sort és indítsuk el a bsnmpd démont. Itt még szükség lehet más beállítások, például a közösségek nevének (community name) vagy a hozzáférési listák (access list) módosítására is. Ezzel kapcsolatban a <a href="https://man.freebsd.org/cgi/man.cgi?query=bsnmpd&amp;sektion=1&amp;format=html">bsnmpd(1)</a> és az <a href="https://man.freebsd.org/cgi/man.cgi?query=snmp_bridge&amp;sektion=3&amp;format=html">snmp_bridge(3)</a> man oldalakat lapozzuk fel.</p></div><div class=paragraph><p>A következõ példában a Net-SNMP nevû szoftver (<a class=package href=https://cgit.freebsd.org/ports/tree/net-mgmt/net-snmp/>net-mgmt/net-snmp</a>) fogjuk használni a híd elérésére, de ugyanerre a <a class=package href=https://cgit.freebsd.org/ports/tree/net-mgmt/bsnmptools/>net-mgmt/bsnmptools</a> port is alkalmas. Az SNMP klienst használó gépen egészítsük ki az <span class=filename>$HOME/.snmp/snmp.conf</span> állományt a híd felügyeleti információinak importálásával az Net-SNMP rendszerébe:</p></div><div class="literalblock programlisting"><div class=content><pre>mibdirs +/usr/shared/snmp/mibs
mibs +BRIDGE-MIB:RSTP-MIB:BEGEMOT-MIB:BEGEMOT-BRIDGE-MIB</pre></div></div><div class=paragraph><p>Az IETF BRIDGE-MIB (RFC 4188) használatán keresztül így tudjuk elindítani egy híd felügyeletét:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>% snmpwalk <span class=nt>-v</span> 2c <span class=nt>-c</span> public bridge1.example.com mib-2.dot1dBridge
BRIDGE-MIB::dot1dBaseBridgeAddress.0 <span class=o>=</span> STRING: 66:fb:9b:6e:5c:44
BRIDGE-MIB::dot1dBaseNumPorts.0 <span class=o>=</span> INTEGER: 1 ports
BRIDGE-MIB::dot1dStpTimeSinceTopologyChange.0 <span class=o>=</span> Timeticks: <span class=o>(</span>189959<span class=o>)</span> 0:31:39.59 centi-seconds
BRIDGE-MIB::dot1dStpTopChanges.0 <span class=o>=</span> Counter32: 2
BRIDGE-MIB::dot1dStpDesignatedRoot.0 <span class=o>=</span> Hex-STRING: 80 00 00 01 02 4B D4 50
...
BRIDGE-MIB::dot1dStpPortState.3 <span class=o>=</span> INTEGER: forwarding<span class=o>(</span>5<span class=o>)</span>
BRIDGE-MIB::dot1dStpPortEnable.3 <span class=o>=</span> INTEGER: enabled<span class=o>(</span>1<span class=o>)</span>
BRIDGE-MIB::dot1dStpPortPathCost.3 <span class=o>=</span> INTEGER: 200000
BRIDGE-MIB::dot1dStpPortDesignatedRoot.3 <span class=o>=</span> Hex-STRING: 80 00 00 01 02 4B D4 50
BRIDGE-MIB::dot1dStpPortDesignatedCost.3 <span class=o>=</span> INTEGER: 0
BRIDGE-MIB::dot1dStpPortDesignatedBridge.3 <span class=o>=</span> Hex-STRING: 80 00 00 01 02 4B D4 50
BRIDGE-MIB::dot1dStpPortDesignatedPort.3 <span class=o>=</span> Hex-STRING: 03 80
BRIDGE-MIB::dot1dStpPortForwardTransitions.3 <span class=o>=</span> Counter32: 1
RSTP-MIB::dot1dStpVersion.0 <span class=o>=</span> INTEGER: rstp<span class=o>(</span>2<span class=o>)</span></code></pre></div></div><div class=paragraph><p>A példában látszik, hogy a <code>dot1dStpTopChanges.0</code> értéke kettõ, ami arra utal, hogy az STP híd topológiája kétszer változott. A topológia változása pedig azt jelenti, hogy a hálózaton belül egy vagy több link állapota megváltozott vagy egyszerûen meghibásodott és ezért egy új fát kellett számolni. A <code>dot1dStpTimeSinceTopologyChange.0</code> érték adja meg, hogy ez pontosan mikor is történt.</p></div><div class=paragraph><p>Több híd felületének felügyeletéhez a belsõ BEGEMOT-BRIDGE-MIB parancsot is használhatjuk:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>% snmpwalk <span class=nt>-v</span> 2c <span class=nt>-c</span> public bridge1.example.com
enterprises.fokus.begemot.begemotBridge
BEGEMOT-BRIDGE-MIB::begemotBridgeBaseName.<span class=s2>&#34;bridge0&#34;</span> <span class=o>=</span> STRING: bridge0
BEGEMOT-BRIDGE-MIB::begemotBridgeBaseName.<span class=s2>&#34;bridge2&#34;</span> <span class=o>=</span> STRING: bridge2
BEGEMOT-BRIDGE-MIB::begemotBridgeBaseAddress.<span class=s2>&#34;bridge0&#34;</span> <span class=o>=</span> STRING: e:ce:3b:5a:9e:13
BEGEMOT-BRIDGE-MIB::begemotBridgeBaseAddress.<span class=s2>&#34;bridge2&#34;</span> <span class=o>=</span> STRING: 12:5e:4d:74:d:fc
BEGEMOT-BRIDGE-MIB::begemotBridgeBaseNumPorts.<span class=s2>&#34;bridge0&#34;</span> <span class=o>=</span> INTEGER: 1
BEGEMOT-BRIDGE-MIB::begemotBridgeBaseNumPorts.<span class=s2>&#34;bridge2&#34;</span> <span class=o>=</span> INTEGER: 1
...
BEGEMOT-BRIDGE-MIB::begemotBridgeStpTimeSinceTopologyChange.<span class=s2>&#34;bridge0&#34;</span> <span class=o>=</span> Timeticks: <span class=o>(</span>116927<span class=o>)</span> 0:19:29.27 centi-seconds
BEGEMOT-BRIDGE-MIB::begemotBridgeStpTimeSinceTopologyChange.<span class=s2>&#34;bridge2&#34;</span> <span class=o>=</span> Timeticks: <span class=o>(</span>82773<span class=o>)</span> 0:13:47.73 centi-seconds
BEGEMOT-BRIDGE-MIB::begemotBridgeStpTopChanges.<span class=s2>&#34;bridge0&#34;</span> <span class=o>=</span> Counter32: 1
BEGEMOT-BRIDGE-MIB::begemotBridgeStpTopChanges.<span class=s2>&#34;bridge2&#34;</span> <span class=o>=</span> Counter32: 1
BEGEMOT-BRIDGE-MIB::begemotBridgeStpDesignatedRoot.<span class=s2>&#34;bridge0&#34;</span> <span class=o>=</span> Hex-STRING: 80 00 00 40 95 30 5E 31
BEGEMOT-BRIDGE-MIB::begemotBridgeStpDesignatedRoot.<span class=s2>&#34;bridge2&#34;</span> <span class=o>=</span> Hex-STRING: 80 00 00 50 8B B8 C6 A9</code></pre></div></div><div class=paragraph><p>Így tudjuk megadni, hogy a hidat <code>mib-2.dot1dBridge</code> részfán keresztül akarjuk megfigyelni:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>% snmpset <span class=nt>-v</span> 2c <span class=nt>-c</span> private bridge1.example.com
BEGEMOT-BRIDGE-MIB::begemotBridgeDefaultBridgeIf.0 s bridge2</code></pre></div></div></div></div></div><div class=sect2><h3 id=network-aggregation>31.6. Linkek összefûzése és hibatûrése<a class=anchor href=#network-aggregation></a></h3><div class=sect3><h4 id=_bevezetés_7>31.6.1. Bevezetés<a class=anchor href=#_bevezetés_7></a></h4><div class=paragraph><p>A <a href="https://man.freebsd.org/cgi/man.cgi?query=lagg&amp;sektion=4&amp;format=html">lagg(4)</a> felület lehetõvé teszi, hogy több hálózati felületet egyetlen virtuális felületként fûzzünk össze, és ezzel egy hibatûrõ és nagysebességû összeköttetést alakítsunk ki.</p></div></div><div class=sect3><h4 id=_mûködési_módok>31.6.2. Mûködési módok<a class=anchor href=#_mûködési_módok></a></h4><div class=dlist><dl><dt class=hdlist1>failover</dt><dd><p>Csak az elsõdlegesként kijelölt porton keresztül fogad és küld adatokat. Amikor ez az elsõdleges port elérhetetlenné válik, a következõ aktív portot fogja használni. Az elsõként felvett felület válik automatikusan az elsõdleges porttá, és az utána felvett összes többit pedig csak hiba esetén használjuk.</p></dd><dt class=hdlist1>Cisco® Fast EtherChannel®</dt><dd><p>A Cisco® Fast EtherChannel® (FEC) technológia támogatása. Ez egy statikus beállítás, és nem egyezteti az összefûzést a többiekkel vagy a linkek felügyeletéhez nem vált kereteket. Ha a switch támogatja az LACP használatát, akkor inkább azt válasszuk.</p><div class=paragraph><p>A FEC a kimenõ forgalmat a fejlécekben szereplõ protokollok alapján számolt hasítókóddal próbálja szétosztani az aktív portok között, és tetszõleges aktív porton fogad beérkezõ adatokat. Az említett hasítókódban egy Ethernetes forrás- és célcím szerepel, valamint ha elérhetõ, akkor egy VLAN címke, illetve az IPv4/IPv6 forrás- és célcím.</p></div></dd><dt class=hdlist1>LACP</dt><dd><p>Az IEEE® 802.3ad Link Aggregation Control Protocol (LACP) és a Marker Protcol támogatása. Az LACP megpróbálja egyeztetni a többi géppel az összefûzhetõ linkeket egy vagy több csoportban (Link Aggregated Group, LAG). Mindegyik ilyen csoportban ugyanolyan sebességû portokat találunk, full-duplex mûködési módban. A forgalmat így a legnagyobb összsebességgel rendelkezõ csoportban megtalálható portok között osztja el, ami a legtöbb esetben az összes portot magában foglaló csoport. A fizikai konnektivitás megváltozása esetén a linkek összefûzõdése igen gyorsan alkalmazkodik az új konfigurációhoz.</p><div class=paragraph><p>Az LACP a kimenõ forgalmat az aktív portok között osztja szét fejlécekben szereplõ protokollok alapján számolt hasítókóddal, és bármelyik aktív portról fogad bejövõ forgalmat. A hasítókódban megtalálható az Ethernetes forrás- és célcím, valamint ha elérhetõ, akkor a VLAN címke, illetve az IPv4/IPv6 forrás- és célcímek.</p></div></dd><dt class=hdlist1>Loadbalance</dt><dd><p>Ez a <em>FEC</em> mód másik neve.</p></dd><dt class=hdlist1>Round-Robin</dt><dd><p>A kimenõ forgalmat egy körkörös (Round-Robin) elvû ütemezõvel osztja szét az aktív portok között és tetszõleges aktív portról fogad bejövõ forgalmat. Ez a mûködési mód megsérti az Ethernet keretek rendezését és csak nagy körültekintés mellett alkalmazzuk.</p></dd></dl></div></div><div class=sect3><h4 id=_példák_5>31.6.3. Példák<a class=anchor href=#_példák_5></a></h4><div id=networking-lacp-aggregation-cisco class=exampleblock><div class=title>Példa 37. LACP alapú összefûzés egy Cisco® switch-csel</div><div class=content><div class=paragraph><p>Ebben a példában egy FreeBSD-s gép két felületét kapcsoljuk össze switch-csel egy egyszerû terhelés-kiegyenlítéssel és hibatûréssel beállított linken keresztül. Mivel az Ethernet keretek sorrendje döntõ fontosságú, ezért a két állomás között egyazon fizikai linken zajló forgalom maximális sebességét az adott felület kapacitása korlátozza. A küldési algoritmus a lehetõ legtöbb információ alapján próbálja egymástól megkülönböztetni a forgalmakat és elosztani ezeket a rendelkezésre álló felületek között.</p></div><div class=paragraph><p>A Cisco® switch-en vegyünk fel a <em>FastEthernet0/1</em> és <em>FastEthernet0/2</em> interfészeket az <em>1</em> csoportba (channel group):</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>interface FastEthernet0/1
 channel-group 1 mode active
 channel-protocol lacp
<span class=o>!</span>
interface FastEthernet0/2
 channel-group 1 mode active
 channel-protocol lacp</code></pre></div></div><div class=paragraph><p>A FreeBSD-s gépen pedig a <em>fxp0</em> és <em>fxp1</em> használatával hozzunk létre a <a href="https://man.freebsd.org/cgi/man.cgi?query=lagg&amp;sektion=4&amp;format=html">lagg(4)</a> interfészt:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># ifconfig lagg0 create</span>
<span class=c># ifconfig lagg0 up laggproto lacp laggport fxp0 laggport fxp1</span></code></pre></div></div><div class=paragraph><p>Ellenõrizzük a felület állapotát:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># ifconfig lagg0</span></code></pre></div></div><div class=paragraph><p>A <em>ACTIVE</em> jelzésû, vagyis aktív állapotú portok az összefûzéshez kialakított csoport azon tagjai, amelyeknél felépült a kapcsolat a távoli switch felé és készen állnak a küldésre és fogadásra. Ha az <a href="https://man.freebsd.org/cgi/man.cgi?query=ifconfig&amp;sektion=8&amp;format=html">ifconfig(8)</a> programtól részletesebb kimenetet kérünk, akkor láthatjuk a csoportok azonosítóit is:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>lagg0: <span class=nv>flags</span><span class=o>=</span>8843&lt;UP,BROADCAST,RUNNING,SIMPLEX,MULTICAST&gt; metric 0 mtu 1500
        <span class=nv>options</span><span class=o>=</span>8&lt;VLAN_MTU&gt;
        ether 00:05:5d:71:8d:b8
        media: Ethernet autoselect
        status: active
        laggproto lacp
        laggport: fxp1 <span class=nv>flags</span><span class=o>=</span>1c&lt;ACTIVE,COLLECTING,DISTRIBUTING&gt;
        laggport: fxp0 <span class=nv>flags</span><span class=o>=</span>1c&lt;ACTIVE,COLLECTING,DISTRIBUTING&gt;</code></pre></div></div><div class=paragraph><p>A <code>show lacp neighbor</code> paranccsal kérdezhetjük le a portok állapotát:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>switch# show lacp neighbor
Flags:  S - Device is requesting Slow LACPDUs
        F - Device is requesting Fast LACPDUs
        A - Device is <span class=k>in </span>Active mode       P - Device is <span class=k>in </span>Passive mode

Channel group 1 neighbors

Partner<span class=s1>&#39;s information:

                  LACP port                        Oper    Port     Port
Port      Flags   Priority  Dev ID         Age     Key     Number   State
Fa0/1     SA      32768     0005.5d71.8db8  29s    0x146   0x3      0x3D
Fa0/2     SA      32768     0005.5d71.8db8  29s    0x146   0x4      0x3D</span></code></pre></div></div><div class=paragraph><p>Részletesebb kijelzést a <code>show lacp neighbor detail</code> paranccsal kaphatunk.</p></div></div></div><div id=networking-lagg-failover class=exampleblock><div class=title>Példa 38. A hibatûrés beállítása</div><div class=content><div class=paragraph><p>A hibatûrési mód arra alkalmas, hogy amikor az elsõdleges porton elvesztjük a kapcsolatot, helyette egy másodlagos interfész használatára tudunk áttérni. Hozzuk létre és állítsuk be a <em>lagg0</em> interfészt, ahol az <em>fxp0</em> legyen a fõinterfész, az <em>fxp1</em> pedig a tartalék interfész:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># ifconfig lagg0 create</span>
<span class=c># ifconfig lagg0 up laggproto failover laggport fxp0 laggport fxp1</span></code></pre></div></div><div class=paragraph><p>Az így létrejövõ interfész nagyjából az alábbi lesz, ahol eltérés a MAC-cím és az eszköz neve:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># ifconfig lagg0</span>
lagg0: <span class=nv>flags</span><span class=o>=</span>8843&lt;UP,BROADCAST,RUNNING,SIMPLEX,MULTICAST&gt; metric 0 mtu 1500
        <span class=nv>options</span><span class=o>=</span>8&lt;VLAN_MTU&gt;
        ether 00:05:5d:71:8d:b8
        media: Ethernet autoselect
        status: active
        laggproto failover
        laggport: fxp1 <span class=nv>flags</span><span class=o>=</span>0&lt;<span class=o>&gt;</span>
        laggport: fxp0 <span class=nv>flags</span><span class=o>=</span>5&lt;MASTER,ACTIVE&gt;</code></pre></div></div><div class=paragraph><p>A forgalom kezdetben az <em>fxp0</em> felületen keresztül érkezik és távozik. Ha az <em>fxp0</em> felületen valamiért megszakadna a kapcsolat, helyette az <em>fxp1</em> lesz az aktív link. Ha késõbb helyreáll a kapcsolat az elsõdleges felületen, akkor újra az lesz aktív link.</p></div></div></div><div id=networking-lagg-wired-and-wireless class=exampleblock><div class=title>Példa 39. Hibatûrés beállítása vezetékes és vezeték nélküli hálózatok között</div><div class=content><div class=paragraph><p>Hordozható számítógépek használata esetén általában érdemesebb a vezeték nélküli kapcsolatot másodlagos interfészként beállítani, így csak akkor használja a rendszer, ha vezetékes hálózat nem érhetõ el. A <a href="https://man.freebsd.org/cgi/man.cgi?query=lagg&amp;sektion=4&amp;format=html">lagg(4)</a> segítségével egyetlen IP-címmel tudjuk használni mind a két interfészt: a teljesítmény és biztonságosság miatt elsõsorban a vezetékes hálózatot használjuk, miközben megmarad a lehetõség az adatok továbbítására a vezeték nélküli kapcsolaton keresztül is.</p></div><div class=paragraph><p>A beállítás során a vezeték nélküli interfész MAC-címét úgy kell módosítanunk, hogy megegyezzen a <a href="https://man.freebsd.org/cgi/man.cgi?query=lagg&amp;sektion=4&amp;format=html">lagg(4)</a> címével. A <a href="https://man.freebsd.org/cgi/man.cgi?query=lagg&amp;sektion=4&amp;format=html">lagg(4)</a> interfész a saját MAC-címét az elsõdleges interfésztõl örökli, amely jelen esetünkben a vezetékes interfész lesz.</p></div><div class=paragraph><p>A most következõ példában a vezetékes hálózatunk lesz az elsõdleges interfész (<em>bge0</em>), míg a vezeték nélküli (<em>wlan0</em>) a másodlagos. A <em>wlan0</em> interfészt az <em>iwn0</em> interfészbõl hoztuk létre, és a vezetékes kapcsolat MAC-címét állítjuk be neki. Elsõ lépésként tehát le kell kérdeznünk a vezetékes interfész MAC-címét:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># ifconfig bge0</span>
bge0: <span class=nv>flags</span><span class=o>=</span>8843&lt;UP,BROADCAST,RUNNING,SIMPLEX,MULTICAST&gt; metric 0 mtu 1500
	<span class=nv>options</span><span class=o>=</span>19b&lt;RXCSUM,TXCSUM,VLAN_MTU,VLAN_HWTAGGING,VLAN_HWCSUM,TSO4&gt;
	ether 00:21:70:da:ae:37
	inet6 fe80::221:70ff:feda:ae37%bge0 prefixlen 64 scopeid 0x2
	nd6 <span class=nv>options</span><span class=o>=</span>29&lt;PERFORMNUD,IFDISABLED,AUTO_LINKLOCAL&gt;
	media: Ethernet autoselect <span class=o>(</span>1000baseT &lt;full-duplex&gt;<span class=o>)</span>
	status: active</code></pre></div></div><div class=paragraph><p>A <em>bge0</em> helyett természetesen a saját vezetékes hálózati interfészünket kell megadni, és az <code>ether</code> kezdetû sorban is saját kártyánk MAC-címe fog megjelenni. Ezután már meg is tudjuk változtatni az <em>iwn0</em> címét:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># ifconfig iwn0 ether 00:21:70:da:ae:37</span></code></pre></div></div><div class=paragraph><p>Aktiváljuk a vezeték nélküli interfészt, de ne állítsunk be neki semmilyen IP-címet:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># ifconfig wlan0 create wlandev iwn0 ssid wlan_hálózat up</span></code></pre></div></div><div class=paragraph><p>Hozzuk létre a <a href="https://man.freebsd.org/cgi/man.cgi?query=lagg&amp;sektion=4&amp;format=html">lagg(4)</a> interfészt a <em>bge0</em> mint elsõdleges interfész megadásával, valamint a <em>wlan0</em> legyen a szükség esetén használható tartalék:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># ifconfig lagg0 create</span>
<span class=c># ifconfig lagg0 up laggproto failover laggport bge0 laggport wlan0</span></code></pre></div></div><div class=paragraph><p>Az így létrehozott interfész nagyjából így fog megjelenni, egyedüli fontosabb eltérések a MAC-címek és az eszközök nevei:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># ifconfig lagg0</span>
lagg0: <span class=nv>flags</span><span class=o>=</span>8843&lt;UP,BROADCAST,RUNNING,SIMPLEX,MULTICAST&gt; metric 0 mtu 1500
        <span class=nv>options</span><span class=o>=</span>8&lt;VLAN_MTU&gt;
        ether 00:21:70:da:ae:37
        media: Ethernet autoselect
        status: active
        laggproto failover
        laggport: wlan0 <span class=nv>flags</span><span class=o>=</span>0&lt;<span class=o>&gt;</span>
        laggport: bge0 <span class=nv>flags</span><span class=o>=</span>5&lt;MASTER,ACTIVE&gt;</code></pre></div></div><div class=paragraph><p>Hogy ne kelljen a rendszer minden egyes indítása után ezt a mûveletet megismételni, vegyük fel a következõ sorokat az <span class=filename>/etc/rc.conf</span> állományba:</p></div><div class="literalblock programlisting"><div class=content><pre>ifconfig_bge0=&#34;up&#34;
ifconfig_iwn0=&#34;ether 00:21:70:da:ae:37&#34;
wlans_iwn0=&#34;wlan0&#34;
ifconfig_wlan0=&#34;WPA&#34;
cloned_interfaces=&#34;lagg0&#34;
ifconfig_lagg0=&#34;laggproto failover laggport bge0 laggport wlan0 DHCP&#34;</pre></div></div></div></div></div></div><div class=sect2><h3 id=network-diskless>31.7. Lemez nélküli mûködés<a class=anchor href=#network-diskless></a></h3><div class=paragraph><p>A FreeBSD képes hálózaton keresztül elindulni és helyi lemez nélkül egy NFS szerver által megosztott állományrendszer csatlakoztatásával mûködni. Ehhez a szabványos konfigurációs állományok módosításán kívül semmi másra nincs szükségünk. Egy ilyen rendszert viszonylag könnyû beállítani, mivel az összes hozzávaló szinte készen elérhetõ:</p></div><div class=ulist><ul><li><p>Rögtön adott legalább két módszer, ha a rendszermagot hálózaton keresztül akarjuk betölteni:</p><div class=ulist><ul><li><p>PXE: az Intel® által fejlesztett Preboot eXecution Environment ("indítás elõtti végrehajtási környezet") nevû rendszer a hálózati kártyákba vagy alaplapokba épített ROM segítségével teszi lehetõvé az intelligens rendszerindítást. A <a href="https://man.freebsd.org/cgi/man.cgi?query=pxeboot&amp;sektion=8&amp;format=html">pxeboot(8)</a> man oldalán olvashatunk errõl részletesebben.</p></li><li><p>Az Etherboot port (<a class=package href=https://cgit.freebsd.org/ports/tree/net/etherboot/>net/etherboot</a>) olyan ROM-ba programozható kódot készít, amellyel rendszermagokat tudunk hálózaton keresztül betölteni. Ez a kód egyaránt felhasználható egy hálózati rendszerindító PROM beégetéséhez, vagy betölthetõ a helyi floppy (esetleg merev)lemezrõl, illetve MS-DOS® rendszer alól. Elég sok hálózati kártya támogatja ezt a módot.</p></li></ul></div></li><li><p>Egy mintaszkript (<span class=filename>/usr/shared/examples/diskless/clone_root</span>) is próbálja megkönnyíteni a szerveren a munkaállomás rendszerindító állományrendszerének létrehozását és karbantartását. Ezt a szkriptet valószínûleg némileg módosítani kell, de így is sokat segít az elindulásban.</p></li><li><p>Az <span class=filename>/etc</span> könyvtárban található szabványos rendszerindításhoz használt állományok, amelyekkel a lemez nélküli indulást lehet detektálni és segíteni.</p></li><li><p>A lapozás, amennyiben szükséges, NFS vagy helyi lemez segítségével oldható meg.</p></li></ul></div><div class=paragraph><p>Számos módon állíthatunk be egy lemez nélküli munkaállomást. Rengeteg részbõl tevõdik össze, és ezek legtöbbje remekül testreszabható az igényeinknek. A továbbiakban egy teljes rendszer összeállításának lehetséges variációit ismertetjük, különös hangsúlyt fektetünk arra, hogy egyszerûek és a hagyományos FreeBSD indítószkriptekkel kompatibilisek maradjanak. A bemutatandó rendszer a következõ jellemzõkkel bír:</p></div><div class=ulist><ul><li><p>A lemez nélküli munkaállomások megosztott <span class=filename>/</span> és <span class=filename>/usr</span> állományrendszereket használnak.</p><div class=paragraph><p>A rendszer indításához használt gyökér állományrendszer a szabvány FreeBSD-s gyökér (ez általában a szerveré), ahol néhány állományt felülírtunk a lemez nélküli mûködéshez vagy azért, mert egyszerûen az adott munkaállomáshoz tartozik.</p></div><div class=paragraph><p>A gyökér azon részeit, amelyeket írhatóvá kívánunk tenni, <a href="https://man.freebsd.org/cgi/man.cgi?query=md&amp;sektion=4&amp;format=html">md(4)</a> alapú állományrendszerekkel lapoljuk felül. Ilyenkor azonban bármilyen rajtuk ejtett változtatás a rendszer újraindításával elveszik.</p></div></li><li><p>A rendszermagot vagy az Etherboot vagy a PXE használatával küldessük át és töltsük be, mivel egyes helyzetekben ezekre szükség lesz.</p></li></ul></div><div class="admonitionblock caution"><table><tbody><tr><td class=icon><i class="fa icon-caution" title=Caution></i></td><td class=content><div class=paragraph><p>A bemutatott rendszer nem biztonságos. Helyezzük a hálózatunk egy jól védett részére, és a többi gép ne tekintse megbízhatónak.</p></div></td></tr></tbody></table></div><div class=paragraph><p>A szakaszban szereplõ összes információt a FreeBSD 5.2.1-RELEASE változatával teszteltük.</p></div><div class=sect3><h4 id=_háttérinformációk>31.7.1. Háttérinformációk<a class=anchor href=#_háttérinformációk></a></h4><div class=paragraph><p>A lemez nélküli munkaállomások beállítása egyszerre adja magát és könnyen is elvéthetõ. Az elkövetett hibákat olykor számos okból kifolyólag nehéz felismerni. Például:</p></div><div class=ulist><ul><li><p>A fordítási idõben megadott beállítások mást eredményeznek futási idõben.</p></li><li><p>A hibaüzenetek gyakran titokzatosak vagy esetleg teljesen el is maradnak.</p></li></ul></div><div class=paragraph><p>Ezért ha valamennyire tisztában vagyunk a háttérben zajló folyamatokkal, akkor sokkal több eséllyel leszünk képesek megoldani a menet közben felmerülõ problémákat.</p></div><div class=paragraph><p>A rendszernek a sikeres felkapaszkodáshoz több mûveletet is végre kell hajtania:</p></div><div class=ulist><ul><li><p>A gépnek szüksége van olyan induló paraméterekhez, mint például az IP-cím, a végrehajtható állomány neve, a szerver neve, a gyökér elérési útja. Ezeket a DHCP vagy a BOOTP protokollok használatával adhatjuk meg. A DHCP a BOOTP kompatibilis kiterjesztése, ezért ugyanazokat a portokat és alapvetõ csomagformátumot alkalmazza.</p><div class=paragraph><p>A rendszerüket kizárólag BOOTP használatával is beállíthatjuk. A <a href="https://man.freebsd.org/cgi/man.cgi?query=bootpd&amp;sektion=8&amp;format=html">bootpd(8)</a> szerver az alap FreeBSD rendszer része.</p></div><div class=paragraph><p>A DHCP azonban rengeteg elõnnyel rendelkezik a BOOTP protokollal szemben (áttekinthetõbb konfigurációs állományok, a PXE használatának lehetõsége, illetve sok minden más, ami nem csak a lemez nélküli mûködéshez kellhet), ezért itt alapvetõen egy DHCP alapú konfigurációt mutatunk be, de ahol megoldható, megemlítjük a <a href="https://man.freebsd.org/cgi/man.cgi?query=bootpd&amp;sektion=8&amp;format=html">bootpd(8)</a> esetén alkalmas példákat is. A mintaként szolgáló konfiguráció az ISC DHCP szoftvercsomagot használja (a tesztszerverre ennek a 3.0.1.r12 verzióját telepítetük fel).</p></div></li><li><p>A gépnek egy vagy több programot kell a saját memóriájába áttöltenie. Erre vagy a TFTP vagy pedig az NFS alkalmas. A TFTP és az NFS között sok helyen fordítási idõben tudunk választani. Gyakori hibaforrás a protokollhoz rosszul megadott állománynevek használata: a TFTP általában az összes állományt a szerverrõl egyetlen könyvtárból tölti át, ezért arra számít, hogy a neveiket ehhez viszonyítva adjuk meg. Az NFS használata során azonban abszolút elérési utakat kell megadnunk.</p></li><li><p>A rendszer indítását lehetõvé tevõ közbensõ programokat és a rendszermagot valahogy inicializálni kell és elindítani. Ezen a területen több fontos változat kapott helyet:</p><div class=ulist><ul><li><p>A PXE a <a href="https://man.freebsd.org/cgi/man.cgi?query=pxeboot&amp;sektion=8&amp;format=html">pxeboot(8)</a> kódját fogja betölteni, ez lényegében a FreeBSD betöltõ harmadik fokozatának egy módosított változata. A <a href="https://man.freebsd.org/cgi/man.cgi?query=loader&amp;sektion=8&amp;format=html">loader(8)</a> a mûködéséhez szükséges paramétereket a rendszer indításakor kapja meg, majd a vezérlés átadása elõtt ezeket a rendszermag környezetében hagyja. Ebben az esetben akár a <span class=filename>GENERIC</span> rendszermag is használható.</p></li><li><p>Az Etherboot kevesebb elõkészítéssel közvetlenül magát a rendszermagot tölti be. Ehhez azonban egy saját rendszermagot kell építeni, külön beállításokkal.</p><div class=paragraph><p>A PXE és az Etherboot egyaránt jól használható. Mivel azonban a rendszermagok általában a <a href="https://man.freebsd.org/cgi/man.cgi?query=loader&amp;sektion=8&amp;format=html">loader(8)</a> kódjára hagyják a munka legnagyobb részét, ezért ahol lehetséges, a PXE megoldását érdemes alkalmazni.</p></div><div class=paragraph><p>Tehát ha az alaplapi BIOS és a hálózati kártya is támogatja a PXE használatát, akkor válasszunk inkább azt.</p></div></li></ul></div></li><li><p>Végezetül a gépnek valamilyen módon hozzá kell tudnia férnie az állományrendszerekhez. Erre többnyire az NFS jöhet szóba.</p></li></ul></div><div class=paragraph><p>A további részleket lásd a <a href="https://man.freebsd.org/cgi/man.cgi?query=diskless&amp;sektion=8&amp;format=html">diskless(8)</a> man oldalon.</p></div></div><div class=sect3><h4 id=_beállítási_útmutató>31.7.2. Beállítási útmutató<a class=anchor href=#_beállítási_útmutató></a></h4><div class=sect4><h5 id=_beállítás_a_isc_dhcp_használatával>31.7.2.1. Beállítás a ISC DHCP használatával<a class=anchor href=#_beállítás_a_isc_dhcp_használatával></a></h5><div class=paragraph><p>Az ISC DHCP szervere képes a BOOTP és DHCP kéréseket is megválaszolni.</p></div><div class=paragraph><p>Az ISC DHCP 3.0 nem az alaprendszer része, ezért a használatához elõször telepítenünk kell a <a class=package href=https://cgit.freebsd.org/ports/tree/net/isc-dhcp30-server/>net/isc-dhcp30-server</a> portot vagy a neki megfelelõ csomagot.</p></div><div class=paragraph><p>Ahogy feltelepítettük, le kell futtatnunk az ISC DHCP konfigurációs állományát (ezt általában <span class=filename>/usr/local/etc/dhcpd.conf</span> néven találjuk meg). A most következõ, megjegyzésekkel kiegészített példában egy <code>margaux</code> nevû gép az Etherboot, valamint egy <code>corbieres</code> nevû gép PXE használatával akar kapcsolódni:</p></div><div class="literalblock programlisting"><div class=content><pre>default-lease-time 600;
max-lease-time 7200;
authoritative;

option domain-name &#34;minta.com&#34;;
option domain-name-servers 192.168.4.1;
option routers 192.168.4.1;

subnet 192.168.4.0 netmask 255.255.255.0 {
  use-host-decl-names on; <i class=conum data-value=1></i><b>(1)</b>
  option subnet-mask 255.255.255.0;
  option broadcast-address 192.168.4.255;

  host margaux {
    hardware ethernet 01:23:45:67:89:ab;
    fixed-address margaux.minta.com;
    next-server 192.168.4.4; <i class=conum data-value=2></i><b>(2)</b>
    filename &#34;/data/misc/kernel.diskless&#34;; <i class=conum data-value=3></i><b>(3)</b>
    option root-path &#34;192.168.4.4:/data/misc/diskless&#34;; <i class=conum data-value=4></i><b>(4)</b>
  }
  host corbieres {
    hardware ethernet 00:02:b3:27:62:df;
    fixed-address corbieres.minta.com;
    next-server 192.168.4.4;
    filename &#34;pxeboot&#34;;
    option root-path &#34;192.168.4.4:/data/misc/diskless&#34;;
  }
}</pre></div></div><div class="colist arabic"><table><tbody><tr><td><i class=conum data-value=1></i><b>1</b></td><td>Ez a beállítás arra utasítja a dhcpd démont, hogy a lemez nélküli gép hálózati neveként a <code>host</code> deklarációban megadott értéket küldje el. Ezt úgyis meg lehet csinálni, hogy felvesszünk egy <code>option host-name margaux</code> részt a <code>host</code> deklarációk közé.</td></tr><tr><td><i class=conum data-value=2></i><b>2</b></td><td>A <code>next-server</code> direktíva a betöltõ vagy a rendszermag betöltéséért felelõs TFTP vagy NFS szervert jelöli ki (alapértelmezés szerint ez megegyezik a DHCP szerverrel).</td></tr><tr><td><i class=conum data-value=3></i><b>3</b></td><td>A <code>filename</code> direktíva azt az állományt adja meg, amelyet az Etherboot vagy a PXE a következõ végrehajtási lépésben betölt. Ezt a kiválasztott átviteli módnak megfelelõen kell megadni. Az Etherboot lefordítható az NFS vagy a TFTP használatával is. A FreeBSD port alapból az NFS támogatását tartalmazza. A PXE a TFTP protokollt használja, ezért itt relatív állományneveket adunk meg (ez persze a TFTP szerver beállításaitól függ, de általában ez a jellemzõ). Sõt, a PXE a <span class=filename>pxeboot</span> állományt tölti be, nem is a rendszermagot. Léteznek további érdekes lehetõségek is, mint például a <span class=filename>pxeboot</span> állomány betöltése a FreeBSD CD-jén található <span class=filename>/boot</span> könyvtárból (mivel a <a href="https://man.freebsd.org/cgi/man.cgi?query=pxeboot&amp;sektion=8&amp;format=html">pxeboot(8)</a> a <span class=filename>GENERIC</span> rendszermagot képes betölteni, ezért a PXE használatával akár egy távoli CD-meghajtóról is indíthatjuk a rendszert).</td></tr><tr><td><i class=conum data-value=4></i><b>4</b></td><td>A <code>root-path</code> opció a rendszer indításához használt gyökér állományrendszert nevezi meg, amelyet többnyire az NFS jelölési módszere szerint kell megadni. A PXE használata során el lehet hagyni a gép IP-címét egészen addig, amíg nem engedélyezzük a rendszermagban a BOOTP beállítást. Az NFS szerver ekkor megegyzik a TFTP szerverrel.</td></tr></tbody></table></div></div><div class=sect4><h5 id=_beállítás_a_bootp_használatával>31.7.2.2. Beállítás a BOOTP használatával<a class=anchor href=#_beállítás_a_bootp_használatával></a></h5><div class=paragraph><p>Itt a bootpd (egyetlen kliensre korlátozott) beállítását láthatjuk. Ezt az <span class=filename>/etc/bootptab</span> állományba tegyük.</p></div><div class=paragraph><p>Ne feledjük, hogy a BOOTP használatához az Etherboot portot a <code>NO_DHCP_SUPPORT</code> beállítással kell fordítanunk, miközben a PXE esetében kell a DHCP. Egyébként a bootpd egyedüli nyilvánvaló elõnye csupán annyi, hogy az alaprendszer része.</p></div><div class="literalblock programlisting"><div class=content><pre>.def100:\
  :hn:ht=1:sa=192.168.4.4:vm=rfc1048:\
  :sm=255.255.255.0:\
  :ds=192.168.4.1:\
  :gw=192.168.4.1:\
  :hd=&#34;/tftpboot&#34;:\
  :bf=&#34;/kernel.diskless&#34;:\
  :rp=&#34;192.168.4.4:/data/misc/diskless&#34;:

margaux:ha=0123456789ab:tc=.def100</pre></div></div></div><div class=sect4><h5 id=_a_rendszer_elõkészítése_az_etherboot_számára>31.7.2.3. A rendszer elõkészítése az Etherboot számára<a class=anchor href=#_a_rendszer_elõkészítése_az_etherboot_számára></a></h5><div class=paragraph><p>Az <a href=http://etherboot.sourceforge.net>Etherboot honlapján </a>találhatunk egy <a href=http://etherboot.sourceforge.net/doc/html/userman/t1.html>minden részletre kiterjedõ dokumentációt (angolul)</a>, amely elsõsorban ugyan a Linux típusú rendszerek számára íródott, de ettõl függetlenül még hasznos információkat tartalmaz. A továbbiakban csak annyit szeretnénk körvonalazni, hogy az Etherboot miként bírható mûködésre FreeBSD rendszerekkel.</p></div><div class=paragraph><p>Elõször telepítenünk kell a <a class=package href=https://cgit.freebsd.org/ports/tree/net/etherboot/>net/etherboot</a> csomagot vagy portot.</p></div><div class=paragraph><p>Az Etherboot beállítását (vagyis a TFTP használatának megadását az NFS helyett) az Etherboot forrását tartalmazó könyvtárban található <span class=filename>Config</span> állomány megfelelõ átírásával tudjuk megtenni.</p></div><div class=paragraph><p>Itt most floppyról fogjuk indítani a rendszert. A többi módszerrel (PROM vagy MS-DOS® program) kapcsolatban olvassuk el az Etherboot dokumentációját.</p></div><div class=paragraph><p>A rendszerindító lemez elkészítéséhez tegyünk egy lemezt annak a gépnek a meghajtójába, ahová az Etherboot felkerült. Váltsunk az Etherboot könyvtárán belül az <span class=filename>src</span> alkönyvtárba és gépeljük be:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># gmake bin32/eszköztípus.fd0</span></code></pre></div></div><div class=paragraph><p>Az <em>eszköztípus</em> a lemez nélküli munkaállomás Ethernet kártyájától függ. Az ugyanebben a könyvtárban található <span class=filename>NIC</span> állományból tudjuk kiolvasni, hogy az adott kártyához melyik <em>eszköztípus</em> tartozik.</p></div></div><div class=sect4><h5 id=_a_rendszer_indítása_pxe_használatával>31.7.2.4. A rendszer indítása PXE használatával<a class=anchor href=#_a_rendszer_indítása_pxe_használatával></a></h5><div class=paragraph><p>Alapértelmezés szerint a <a href="https://man.freebsd.org/cgi/man.cgi?query=pxeboot&amp;sektion=8&amp;format=html">pxeboot(8)</a> betöltõ a rendszermagot NFS-en keresztül tölti be. Ha az <span class=filename>/etc/make.conf</span> állományban a <code>LOADER_TFTP_SUPPORT</code> beállítást adjuk meg, akkor TFTP támogatással is lefordítható. Ezzel kapcsolatban a <span class=filename>/usr/shared/examples/etc/make.conf</span> állományban található megjegyzéseket érdemes elolvasnunk.</p></div><div class=paragraph><p>A <span class=filename>make.conf</span> állományban még további két másik hasznos opciót is találhatunk a soros vonali konzollal üzemelõ lemez nélküli gépek számára: az egyik a <code>BOOT_PXELDR_PROBE_KEYBOARD</code>, a másik pedig a <code>BOOT_PXELDR_ALWAYS_SERIAL</code>.</p></div><div class=paragraph><p>A gép indításakor úgy tudjuk beüzemelni a PXE használatát, ha a BIOS beállításai között a <code>Boot from network</code> opciót választjuk ki, vagy a gép bekapcsolása után lenyomjuk hozzá a megfelelõ funkcióbillentyût.</p></div></div><div class=sect4><h5 id=_a_tftp_és_nfs_szerverek_beállítása>31.7.2.5. A TFTP és NFS szerverek beállítása<a class=anchor href=#_a_tftp_és_nfs_szerverek_beállítása></a></h5><div class=paragraph><p>Ha a PXE vagy az Etherboot a TFTP protokollt használja, akkor az állományszerveren a tftpd démont kell elindítani:</p></div><div class="exampleblock procedure"><div class=content><div class="olist arabic"><ol class=arabic><li><p>Készítsünk egy könyvtárat, ahonnan majd a tftpd küldi az állományokat, például legyen ez a <span class=filename>/tftpboot</span>.</p></li><li><p>Vegyük fel a következõ sort az <span class=filename>/etc/inetd.conf</span> állományunkba:</p><div class="literalblock programlisting"><div class=content><pre>tftp	dgram	udp	wait	root	/usr/libexec/tftpd	tftpd -l -s /tftpboot</pre></div></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>A tapasztalat szerint egyes PXE verziók a TFTPTCP alapú változatát használják. Ebben az esetben vegyünk fel még egy második sort is, ahol a <code>dgram udp</code> részt <code>stream tcp</code>-re cseréljük.</p></div></td></tr></tbody></table></div></li><li><p>Mondjuk meg az inetd démonnak, hogy olvassa újra a konfigurációs állományát. Az alábbi parancs megfelelõ mûködéséhez Az <code>inetd_enable="YES"</code> sornak szerepelnie kell az <span class=filename>/etc/rc.conf</span> állományban:</p><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># /etc/rc.d/inetd restart</span></code></pre></div></div></li></ol></div></div></div><div class=paragraph><p>A <span class=filename>tftpboot</span> könyvtárat bárhova rakhatjuk a szerveren. Viszont az <span class=filename>inetd.conf</span> és <span class=filename>dhcpd.conf</span> állományokban ezt ne felejtsük fel megadni.</p></div><div class=paragraph><p>Minden esetben engedélyeznünk kell az NFS használatát és vele együtt exportálni az NFS szerverrõl elérni kívánt állományrendszereket.</p></div><div class="exampleblock procedure"><div class=content><div class="olist arabic"><ol class=arabic><li><p>Az <span class=filename>/etc/rc.conf</span> állományba tegyük bele a következõt:</p><div class="literalblock programlisting"><div class=content><pre>nfs_server_enable=&#34;YES&#34;</pre></div></div></li><li><p>Az <span class=filename>/etc/exports</span> állományban a lemez nélküli rendszereknek szánt gyökérkönyvtárat tegyük elérhetõvé (a példában írjuk át a kötet csatlakozási pontját és a <em>margaux corbieres</em> helyére állítsuk be a saját lemez nélküli munkaállomásaink neveit:</p><div class="literalblock programlisting"><div class=content><pre>/data/misc -alldirs -ro margaux corbieres</pre></div></div></li><li><p>Kérjük meg a mountd démont, hogy olvassa újra a konfigurációs állományát. Elõfordulhat azonban, hogy ehhez elõször az NFS szolgáltatást kell engedélyezni az <span class=filename>/etc/rc.conf</span> állományból és újraindítani a gépet.</p><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># /etc/rc.d/mountd restart</span></code></pre></div></div></li></ol></div></div></div></div><div class=sect4><h5 id=_lemez_nélküli_rendszermag_fordítása>31.7.2.6. Lemez nélküli rendszermag fordítása<a class=anchor href=#_lemez_nélküli_rendszermag_fordítása></a></h5><div class=paragraph><p>Ha az Etherboot használata mellett döntünk, akkor a lemez nélküli kliensek számára a rendszermagot a következõ beállítások használatával kell újrafordítani (a megszokottak mellett):</p></div><div class="literalblock programlisting"><div class=content><pre>options     BOOTP          # BOOTP-n keresztül kérünk IP-címet és hálózati nevet
options     BOOTP_NFSROOT  # a BOOTP-tõl kapott információk alapján csatoljuk a gyökeret NFS-en keresztül</pre></div></div><div class=paragraph><p>Ezek mellett valószínûleg szükségünk lesz a <code>BOOTP_NFSV3</code>, <code>BOOT_COMPAT</code> és <code>BOOTP_WIRED_TO</code> beállítások megadására is (lásd a <span class=filename>NOTES</span> állományt).</p></div><div class=paragraph><p>A beállítások nevei régrõl származnak és némileg félrevezetõek lehetnek, mivel valójában semmit sem változtatnak a rendszermagban levõ DHCP vagy a BOOTP rutinok használatában (egyébként meg lehet adni vagy az egyik vagy a másik protokoll kizárólágos használatát is).</p></div><div class=paragraph><p>Fordítsuk le a rendszermagot (lásd <a href=./#kernelconfig>A FreeBSD rendszermag testreszabása</a>), és másoljuk a <span class=filename>dhcpd.conf</span> állományban megadott helyre.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Amikor a PXE protokollt használjuk, a rendszermagot nem fontos az imént felsorolt paraméterekkel fordítanunk (habár ajánlatos). Az engedélyezésükkel több DHCP kérés keletkezik a rendszermag elindulása közben, ezért kisebb a kockázata annak, hogy a <a href="https://man.freebsd.org/cgi/man.cgi?query=pxeboot&amp;sektion=8&amp;format=html">pxeboot(8)</a> által bizonyos esetekben megszerzett és az új értékek között valamilyen ellentmondás jön létre. A használatuk egyik elõnye, hogy így mellékhatásként a hálózati nevünket is megkapjuk. Ellenkezõ esetben erre is találnunk kellene valamilyen módot, például fenntartani egy-egy <span class=filename>rc.conf</span> állományt minden kliensen.</p></div></td></tr></tbody></table></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Az Etherboot csak akkor lesz képes betölteni a rendszermagot, ha device hinteket is beépítünk. Ezt a következõ beállítással tudjuk megoldani (errõl bõvebben lásd a <span class=filename>NOTES</span> állomány megjegyzéseit):</p></div><div class="literalblock programlisting"><div class=content><pre>hints		&#34;GENERIC.hints&#34;</pre></div></div></td></tr></tbody></table></div></div><div class=sect4><h5 id=_a_rendszerindító_állományrendszer_elõkészítése>31.7.2.7. A rendszerindító állományrendszer elõkészítése<a class=anchor href=#_a_rendszerindító_állományrendszer_elõkészítése></a></h5><div class=paragraph><p>A <span class=filename>dhcpd.conf</span> állomány <code>root-path</code> beállításának megfelelõen hozzunk létre a rendszer indítására alkalmas gyökér állományrendszert.</p></div><div class=sect5><h6 id=_az_állományrendszer_feltöltése_a_make_world_paranccsal>31.7.2.7.1. Az állományrendszer feltöltése a <code>make world</code> paranccsal<a class=anchor href=#_az_állományrendszer_feltöltése_a_make_world_paranccsal></a></h6><div class=paragraph><p>Ezzel a módszerrel a <code>DESTDIR</code> könyvtárba pillanatok alatt telepíteni tudunk egy teljes szûz rendszert (és nem csak a rendszerindító állományrendszert). Ehhez mindössze csak annyit kell tenni, hogy lefuttatjuk a következõ szkriptet:</p></div><div class="literalblock programlisting"><div class=content><pre>#!/bin/sh
export DESTDIR=/data/misc/diskless
mkdir -p ${DESTDIR}
cd /usr/src; make buildworld &amp;&amp; make buildkernel
make installworld &amp;&amp; make installkernel
cd /usr/src/etc; make distribution</pre></div></div><div class=paragraph><p>Miután végzett, már csak a <code>DESTDIR</code> könyvtárban található <span class=filename>/etc/rc.conf</span> és <span class=filename>/etc/fstab</span> állományokat kell az igényeinkhez igazítani.</p></div></div></div><div class=sect4><h5 id=_a_lapozóterület_beállítása>31.7.2.8. A lapozóterület beállítása<a class=anchor href=#_a_lapozóterület_beállítása></a></h5><div class=paragraph><p>Amennyiben szükséges, a szerveren található lapozóállományt NFS-en keresztül el tudjuk érni.</p></div><div class=sect5><h6 id=_lapozás_nfs_sel>31.7.2.8.1. Lapozás NFS-sel<a class=anchor href=#_lapozás_nfs_sel></a></h6><div class=paragraph><p>A rendszermag maga nem támogatja az NFS alapú lapozás engedélyezését a rendszer indításakor. A lapozóállományt ezért a rendszerindító szkripteken keresztül aktiváljuk, amelyekben csatlakoztatunk egy írható állományrendszert, ahol létrehozzuk és engedélyezzük a lapozóállományt. Tetszõleges méretû lapozóállományt például így tudunk készíteni:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># dd if=/dev/zero of=/a/lapozóállomány/helye bs=1k count=1 oseek=100000</span></code></pre></div></div><div class=paragraph><p>Az engedélyezéséhez pedig a következõ sort kell felvenni az <span class=filename>rc.conf</span> állományba:</p></div><div class="literalblock programlisting"><div class=content><pre>swapfile=/a/lapozóállomány/helye</pre></div></div></div></div><div class=sect4><h5 id=_egyéb_problémák_2>31.7.2.9. Egyéb problémák<a class=anchor href=#_egyéb_problémák_2></a></h5><div class=sect5><h6 id=_írásvédett_usr_használata>31.7.2.9.1. Írásvédett <span class=filename>/usr</span> használata<a class=anchor href=#_írásvédett_usr_használata></a></h6><div class=paragraph><p>Ha a lemez nélküli munkaállomáson X szervert akarunk futtatni, akkor az XDM konfigurációs állományait kicsit módosítanunk kell, mert alapértelmezés szerint a <span class=filename>/usr</span> könyvtárban hozza létre a naplókat.</p></div></div><div class=sect5><h6 id=_nem_freebsd_s_szerver_használata>31.7.2.9.2. Nem FreeBSD-s szerver használata<a class=anchor href=#_nem_freebsd_s_szerver_használata></a></h6><div class=paragraph><p>Amikor a rendszer indításához használt állományrendszert nem egy FreeBSD alapú számítógépen tároljuk, akkor elõször ezt egy FreeBSD-s gépen kell elkészíteni, majd a <code>tar</code> vagy <code>cpio</code> segítségével átmásolni a megfelelõ helyre.</p></div><div class=paragraph><p>Ilyen helyzetekben gyakran gondok adódhatnak olyan speciális állományokkal, mint például amelyek a <span class=filename>/dev</span> könyvtárban találhatóak, mivel a fõ- és aleszközazonosítók tárolására szánt méret különbözhet. Ezt úgy oldhatjuk meg, ha exportálunk egy könyvtárat a nem FreeBSD alapú szerveren, ezt csatlakoztatjuk a FreeBSD-s gépen, majd a <a href="https://man.freebsd.org/cgi/man.cgi?query=devfs&amp;sektion=5&amp;format=html">devfs(5)</a> segítségével a eszközleírókat a felhasználó számára észrevétlen módon foglaljuk le.</p></div></div></div></div></div><div class=sect2><h3 id=network-isdn>31.8. ISDN<a class=anchor href=#network-isdn></a></h3><div class=paragraph><p>Az ISDN technológiai és hardveres hátterérõl sokat megtudhatunk <a href=http://www.alumni.caltech.edu/~dank/isdn/>Dan Kegel ISDN-rõl szóló oldalán (angolul)</a>.</p></div><div class=paragraph><p>Az ISDN használatát röviden így foglalhatnánk össze:</p></div><div class=ulist><ul><li><p>Ha Európában élünk, akkor minden bizonnyal az ISDN kártyákkal foglalkozó szakaszt érdemes elolvasnunk.</p></li><li><p>Ha elsõsorban betárcsázós ISDN-nel szeretnénk csatlakozni az internetre egy internet-szolgáltatón keresztül, akkor a terminál adaptereket tárgyaló szakaszt nézzük meg. A szolgáltatók váltásakor ezzel jár a legtöbb rugalmasság és a legkevesebb probléma.</p></li><li><p>Ha két helyi hálózat összekötésére használjuk, vagy az internethez egy bérelt ISDN vonalon keresztül kapcsolódunk, akkor egy önálló útválasztó vagy hálózati híd beállításában érdemes gondolkodnunk.</p></li></ul></div><div class=paragraph><p>A költség fontos szerepet játszik az elfogadható megoldás kiválasztásában. A most következõ lehetõségeket a legolcsóbbtól indulva kezdjük el felsorolni egészen a legdrágábbig.</p></div><div class=sect3><h4 id=network-isdn-cards>31.8.1. ISDN kártyák<a class=anchor href=#network-isdn-cards></a></h4><div class=paragraph><p>A FreeBSD-ben megtalálható ISDN implementáció csak a DSS1/Q.931 (más néven Euro-ISDN) szabvány szerint gyártott passzív kártyákat támogatja. Ismer azonban egyes olyan aktív kártyákat is, amelyeknél a firmware további más jelkezelési protokollokat is támogat. Ilyen többek közt az elsõként támogatott Primary Rate (PRI) ISDN kártya.</p></div><div class=paragraph><p>Az isdn4bsd szoftver segítségével kapcsolódni tudunk más ISDN útválasztókhoz IP-n keresztül a nyers HDLC felett, vagy szinkron PPP használatával. Mindezeket a rendszermagban található PPP-re vagy az <code>isppp</code>-re építkezik.</p></div><div class=paragraph><p>FreeBSD alatt egyre több PC-s ISDN kártyához készül el a támogatás, és a visszajelzések azt mutatják, hogy Európában és a világ minden részén sikerrel használják ezeket.</p></div><div class=paragraph><p>A passzív ISDN kártyák közül is leginkább az Infineon (korábban Siemens) gyártmányú ISAC/HSCX/IPAC ISDN chipkészletek támogatottak, de a Cologne chippel rendelkezõ (de csak ISA buszos) ISDN kártyák, a Winbond W6692 chipes PCI buszos kártyák, és a Tiger300/320/ISAC chipkészletek egyes változatai, valamint néhány gyártófüggõ chipkészlettel rendelkezõ kártya, mint például az AVM Fritz!Card PCI V.1.0 és az AVM Fritz!Card PnP is remekül mûködik.</p></div><div class=paragraph><p>Jelenleg a következõ aktív ISDN kártyákat támogatja a rendszer: AVM B1 (ISA és PCI) BRI kártyák és az AVM T1 PCI PRI kártyák.</p></div><div class=paragraph><p>Az isdn4bsd dokumentációját a rendszerünkön belül a <span class=filename>/usr/shared/examples/isdn/</span> könyvtárban találhatjuk meg, vagy közvetlenül <a href=http://www.freebsd-support.de/i4b/>az isdn4bsd honlapján</a>, ahol több hivatkozást is találunk tippekre, hibajegyzékekre és bõségesebb dokumentációra, például <a href=http://people.FreeBSD.org/~hm/>az isdn4bsd saját kézikönyvére</a>.</p></div><div class=paragraph><p>Ha szeretnénk egy másik ISDN protokoll támogatásának kifejlesztésében résztvenni, vagy egy jelenleg még nem támogatott ISDN kártyát használhatóvá tenni, esetleg valamilyen más módon segíteni az isdn4bsd ügyét, vegyük fel a kapcsolatot Hellmuth Michaelis &lt;<a href=mailto:hm@FreeBSD.org>hm@FreeBSD.org</a>> fejlesztõvel.</p></div><div class=paragraph><p>Az isdn4bsd telepítésével, beállításával és hibaelhárításával kapcsolatos kérdéseinket a <a href=https://lists.FreeBSD.org/subscription/freebsd-isdn>freebsd-isdn</a> levelezési listán tehetjük fel.</p></div></div><div class=sect3><h4 id=_isdn_terminál_adapterek>31.8.2. ISDN terminál adapterek<a class=anchor href=#_isdn_terminál_adapterek></a></h4><div class=paragraph><p>Az ISDN számára olyanok a terminál adapterek, mint a hagyományos telefonvonalak számára a modemek.</p></div><div class=paragraph><p>A legtöbb terminál adapter a Hayes-modemek szabványos AT parancskészletét használja, és könnyen be lehet iktatni egy modem helyett.</p></div><div class=paragraph><p>A terminál adapterek alapvetõen ugyanúgy mûködnek, mint a modemek, kivéve, hogy egy átlagos modemnél jóval nagyobb adatátviteli sebességre képesek. Ezért a <a href=./#ppp>PPP</a> kapcsolatunkat pontosan ugyanúgy kell beállítani, mint a modemek esetében. Ne felejtsük a soros pont sebességét a maximális értékre állítani.</p></div><div class=paragraph><p>A terminál adapterek használatának egyik legnagyobb elõnye, hogy segítségükkel dinamikus PPP-n keresztül tudunk az internet-szolgáltatónkhoz kapcsolódni. Mivel az IP-címtartomány egyre inkább szûkösebb, a legtöbb szolgáltató nem szívesen oszt ki bárkinek is statikus IP-címet. A legtöbb önálló útválasztó azonban nem képes alkalmazkodni az IP-címek dinamikus kiosztásához.</p></div><div class=paragraph><p>A terminál adapter az elérhetõ lehetõségeket és a kapcsolat stabilitását tekintve teljesen a PPP démontól függ. Emiatt egy FreeBSD-s gépet könnyû modemrõl átállítani az ISDN használatára, ha már egyszer beállítottuk a PPP démont. Ezzel együtt azonban a PPP használata során tapasztalt problémák ugyanúgy ismét felmerülnek.</p></div><div class=paragraph><p>Ha a maximális stabilitásra van szükségünk, akkor a rendszermag <a href=./#ppp>PPP</a> beállítását használjuk, és ne a <a href=./#userppp>felhasználói PPP megoldást</a>.</p></div><div class=paragraph><p>A FreeBSD hivatalosan az alábbi terminál adaptereket ismeri:</p></div><div class=ulist><ul><li><p>Motorola BitSurfer és Bitsurfer Pro</p></li><li><p>Adtran</p></li></ul></div><div class=paragraph><p>Valószínûleg a többi terminál adapterrel is képes együttmûködni, mivel a terminál adapterek gyártói általában igyekeznek a termékeiket a szabványos modemes AT parancskészletével kompatibilissá tenni.</p></div><div class=paragraph><p>Az igazi probléma a külsõ terminál adapterekkel adódik, mivel, akárcsak a modemek esetében, egy nagyon jó soros kártyát igényelnek.</p></div><div class=paragraph><p>A soros eszközök mûködésének részleteit valamint az aszinkron és szinkron soros portok közti különbségeket a <a href=https://docs.freebsd.org/en/articles/serial-uart/>FreeBSD soros hardverekrõl</a> szóló cikkében olvashatjuk.</p></div><div class=paragraph><p>A terminál adaptereken keresztül elérhetõ sebességet a PC-kben található szabványos (aszinkron) soros port 115,2 Kb/mp-re korlátozza, még 128 Kb/mp-es adatátvitelû kapcsolatok esetében is. Az ISDN által nyújtott 128 Kb/mp kihasználásához a terminál adaptert egy szinkron soros kártyával kell összekötnünk.</p></div><div class=paragraph><p>Ne higyjük, hogy egy belsõ terminál adapter megvásárlásával megmenekülünk ettõl a gondtól. A belsõ terminál adapterekbe egyszerûen csak egy sima szabványos PC-s soros portot építettek bele. Mindössze egy soros kábelt és egy konnektort takarítunk meg velük.</p></div><div class=paragraph><p>A terminál adapterhez csatlakozó szinkron kártyák legalább olyan gyorsak, mint egy önálló útválasztó, és egy egyszerû 386-osra épülõ FreeBSD rendszerrel talán még rugalmasabban is kezelhetõek.</p></div><div class=paragraph><p>A terminál adapter plusz szinkron kártya kontra önálló útválasztó kérdése már hitkérdéssé fajult, amirõl igen sokat vitatkoztak szerte a levelezési listákon. A teljes okfejtés elolvasásához az <a href=https://www.FreeBSD.org/search/>archívum</a> böngészését javasoljuk.</p></div></div><div class=sect3><h4 id=_önálló_isdn_hálózati_hidak_és_útválasztók>31.8.3. Önálló ISDN hálózati hidak és útválasztók<a class=anchor href=#_önálló_isdn_hálózati_hidak_és_útválasztók></a></h4><div class=paragraph><p>Az ISDN hidak vagy útválasztók nem egészen a FreeBSD vagy operációs rendszerek területéhez tartoznak. Az útválasztás és a hálózatok hidak alapjainak a számítógépes hálózatokról szóló szakirodalomban járhatunk utána.</p></div><div class=paragraph><p>Ebben a szakaszban a hálózati híd és az útválasztó kifejezéseket egymás szinonímájaként fogjuk használni.</p></div><div class=paragraph><p>Ahogy az olcsóbb ISDN útválasztók és hidak árai egyre jobban csökkennek, ezért egyre inkább népszerûbbé válnak. Az ISDN útválasztó egy apró doboz, amelyet közvetlenül a helyi Ethernet hálózatunkra tudunk csatlakoztatni, és a többi útválasztóhoz vagy hídhoz kapcsolódik. A benne található szoftverrel képes kommunikálni a PPP vagy más egyéb népszerû protokollokon keresztül.</p></div><div class=paragraph><p>Az útválasztó egy szabványos terminál adapternél sokkal nagyobb adatátvitelt tesz lehetõvé, mivel a teljes szinkron ISDN kapcsolatot képes kihasználni.</p></div><div class=paragraph><p>Az ISDN útválasztókkal és hidakkal kapcsolatban az egyik legnagyobb problémát a különbözõ gyártók közti eltérések jelenthetik. Ha egy szolgáltatóhoz akarunk ezen a módon csatlakozni, akkor érdemes elõzetesen egyeztetni az igényeinket velük.</p></div><div class=paragraph><p>Ha két helyi hálózati szegmenst akarunk összekapcsolni, mint például az otthoni és az irodai hálózatot, akkor ez a megoldás jár a legkevesebb karbantartási költséggel. Mivel ekkor mi magunk vásároljuk a kapcsolat mind a két oldalára a felszerelést, biztosak lehetünk benne, hogy az így létrehozott összekötettés mûködni fog.</p></div><div class=paragraph><p>Például, ha egy otthon vagy a vállalat egy fiókjánál levõ gépet akarjuk összekötni az igazgatóság hálózatával, akkor a következõ felállást érdemes követnünk:</p></div><div class=exampleblock><div class=title>Példa 40. Egy otthoni vagy egy fiókbeli hálózat</div><div class=content><div class=paragraph><p>A hálózat busz topológiájú és 10 Base 2 Ethernetet használ ("thinnet"). Ha szükséges, akkor az útválasztót egy AUI/10BT adó-vevõvel csatlakoztassuk a hálózati kábelre.</p></div><div class=imageblock><div class=content><img src=../../../../images/books/handbook/advanced-networking/isdn-bus.png alt="10 Base 2 Ethernet"></div></div><div class=paragraph><p>Ha az otthoni vagy fiókbeli számítógép az egyedüli, akkor egy keresztkötésû sodrott érpár kábellel akár közvetlenül is csatlakozhatunk az útválasztóhoz.</p></div></div></div><div class=exampleblock><div class=title>Példa 41. Az igazgatósági iroda vagy egy másik helyi hálózat</div><div class=content><div class=paragraph><p>A hálózat csillag topológiájú, és 10 Base T Ethernet kábelezésû ("sodrott érpár").</p></div><div class=imageblock><div class=content><img src=../../../../images/books/handbook/advanced-networking/isdn-twisted-pair.png alt="Az ISDN hálózat felépítése"></div></div></div></div><div class=paragraph><p>A legtöbb útválasztó/híd elõnye, hogy <em>egyszerre</em> 2 <em>egymástól független</em> PPP kapcsolatot tudunk felépíteni velük 2 egymástól független géppel. Ezt a legtöbb terminál adapter nem támogatja, kivéve azok a (általában drága) típusok, amelyek két soros porttal rendelkeznek. Ezt ne tévesszük össze a csatornák nyalábolásával, az MPP-vel és a többivel.</p></div><div class=paragraph><p>Ez nagyon hasznos lehet például olyan esetekben, amikor van egy dedikált ISDN kapcsolatunk az irodában, amelyet ugyan szeretnénk megcsapolni, de nem szeretnénk a másik ISDN vonalat is elrabolni. Az irodában levõ A útválasztó képes a dedikált B csatornájú kapcsolaton (64 Kb/mp) keresztül elérni az internetet, miközben a másik B csatornát ettõl független adatkapcsolatra használja. A második B csatorna így használható betárcsázásra, kitárcsázásra vagy a másik B csatornával együtt dinamikus nyalábolásra (MPP stb.) a nagyobb sávszélesség elérése érdekében.</p></div><div class=paragraph><p>Az Ethernetes híd nem IP alapú forgalmat is képes továbbítani, ezért rajta keresztül akár IPX vagy SPX és más egyéb protokollokat is használni tudunk.</p></div></div></div><div class=sect2><h3 id=network-natd>31.9. Hálózati címfordítás<a class=anchor href=#network-natd></a></h3><div class=sect3><h4 id=network-natoverview>31.9.1. Áttekintés<a class=anchor href=#network-natoverview></a></h4><div class=paragraph><p>A FreeBSD hálózati címfordításért felelõs démonprogramja, a <a href="https://man.freebsd.org/cgi/man.cgi?query=natd&amp;sektion=8&amp;format=html">natd(8)</a> (Network Address Translation daemon), a beérkezõ nyers IP csomagokat dolgozza fel, és a helyi gépek forráscímét kicserélve visszailleszti ezeket a csomagokat a kimenõ folyamba. A <a href="https://man.freebsd.org/cgi/man.cgi?query=natd&amp;sektion=8&amp;format=html">natd(8)</a> mindezt úgy teszi a forrás IP-címekkel és portokkal, hogy amikor az adat visszaérkezik, akkor képes lesz megmondani a csomag eredeti küldõjét és visszaküldeni neki a választ.</p></div><div class=paragraph><p>A hálózati címfordítást általában az internet-kapcsolatok megosztásánál alkalmazzuk.</p></div></div><div class=sect3><h4 id=network-natsetup>31.9.2. A hálózat felépítése<a class=anchor href=#network-natsetup></a></h4><div class=paragraph><p>Az IPv4 világában egyre jobban fogyó IP-címek és az egyre növekvõ számú, nagysebességre vágyó, például kábeles vagy DSL-es fogyasztók miatt az igény is egyre nagyobb az internet-kapcsolatok megosztására. Ha több számítógéppel szeretnénk egyetlen kapcsolaton és egy IP-címen keresztül kapcsolódni az internetre, akkor ehhez a <a href="https://man.freebsd.org/cgi/man.cgi?query=natd&amp;sektion=8&amp;format=html">natd(8)</a> tökéletes választás.</p></div><div class=paragraph><p>Az esetek többségében a felhasználók egy kábeles vagy DSL vonalra csatlakoznak, melyhez egyetlen IP-cím tartozik, és ezen a gépen keresztül szeretnék elérni az internetet a helyi hálózaton levõ többi géprõl.</p></div><div class=paragraph><p>Ezt úgy tudjuk elérni, ha az internethez kapcsolódó FreeBSD-s gépet átjárónak állítjuk be. Ebben az átjáróban legalább két hálózati felületnek kell léteznie - az egyikkel az internetes útválasztóhoz, a másikkal pedig a helyi hálózathoz kapcsolódik. A belsõ hálózaton levõ gépek egy hub vagy egy switch segítségével csatlakoznak egymáshoz.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Több módon is el tudjuk érni a belsõ hálózatról az internetet egy FreeBSD-s átjárón keresztül. Ebben a példában most csak olyan átjárókkal foglalkozunk, amelyekben legalább két hálózati kártya található.</p></div></td></tr></tbody></table></div><div class=imageblock><div class=content><img src=../../../../images/books/handbook/advanced-networking/natd.png alt="A hálózat felosztása"></div></div><div class=paragraph><p>Egy ehhez hasonló beállítás igen gyakori a megosztott internet-kapcsolatok esetében. A helyi hálózat egyik gépe csatlakozik az internetre. A többi gép ezen az "átjárón" keresztül éri el az internetet.</p></div></div><div class=sect3><h4 id=network-netdloaderconfiguration>31.9.3. A rendszerbetöltõ beállítása<a class=anchor href=#network-netdloaderconfiguration></a></h4><div class=paragraph><p>A <a href="https://man.freebsd.org/cgi/man.cgi?query=natd&amp;sektion=8&amp;format=html">natd(8)</a> mûködéséhez szükséges címfordítási támogatást a <span class=filename>GENERIC</span> típusú rendszermagok nem tartalmazzák, viszont a <span class=filename>/boot/loader.conf</span> megfelelõ paraméterezésével a rendszer betöltése közben ezt hozzá tudjuk adni:</p></div><div class="literalblock programlisting"><div class=content><pre>ipfw_load=&#34;YES&#34;
ipdivert_load=&#34;YES&#34;</pre></div></div><div class=paragraph><p>Valamint a <code>net.inet.ip.fw.default_to_accept</code> változót állítsuk az <code>1</code> értékre.</p></div><div class="literalblock programlisting"><div class=content><pre>net.inet.ip.fw.default_to_accept=&#34;1&#34;</pre></div></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Ez utóbbi beállítást leginkább a tûzfal és a címfordítást végzõ átjáró próbálgatásakor érdemes alkalmazni. Ilyenkor ugyanis az <a href="https://man.freebsd.org/cgi/man.cgi?query=ipfw&amp;sektion=8&amp;format=html">ipfw(8)</a> alapértelmezett módon az <code>allow ip from any to any</code> (minden forgalom engedélyezett) szabályt követi, és nem pedig a kevésbé barátságos <code>deny ip from any to any</code> (minden forgalom tiltott) szabályt. A rendszer újraindításakor így valamivel nehezebb lesz kizárnunk magunkat a szabályok megadása során.</p></div></td></tr></tbody></table></div></div><div class=sect3><h4 id=network-natdkernconfiguration>31.9.4. A rendszermag beállítása<a class=anchor href=#network-natdkernconfiguration></a></h4><div class=paragraph><p>Amikor viszont nincs lehetõségünk modulok használatára, vagy szeretnénk minden igényelt funkciót beépíteni a rendszermagba, akkor a rendszermag beállításait tartalmazó állományban a következõket kell megadnunk:</p></div><div class="literalblock programlisting"><div class=content><pre>options IPFIREWALL
options IPDIVERT</pre></div></div><div class=paragraph><p>A fentiek mellett még ezeket a lehetõségeket tudjuk választani:</p></div><div class="literalblock programlisting"><div class=content><pre>options IPFIREWALL_DEFAULT_TO_ACCEPT
options IPFIREWALL_VERBOSE</pre></div></div></div><div class=sect3><h4 id=network-natdsystemconfiguration>31.9.5. A rendszerindítás beállítása<a class=anchor href=#network-natdsystemconfiguration></a></h4><div class=paragraph><p>A tûzfal és a hálózati címfordítás beindításához a következõknek kell az <span class=filename>/etc/rc.conf</span> állományban lennie:</p></div><div class="literalblock programlisting"><div class=content><pre>gateway_enable=&#34;YES&#34; <i class=conum data-value=1></i><b>(1)</b>
firewall_enable=&#34;YES&#34; <i class=conum data-value=2></i><b>(2)</b>
firewall_type=&#34;OPEN&#34; <i class=conum data-value=3></i><b>(3)</b>
natd_enable=&#34;YES&#34;
natd_interface=&#34;fxp0&#34; <i class=conum data-value=4></i><b>(4)</b>
natd_flags=&#34;&#34; <i class=conum data-value=5></i><b>(5)</b></pre></div></div><div class="colist arabic"><table><tbody><tr><td><i class=conum data-value=1></i><b>1</b></td><td>A gépet átjárónak állítja be. Hatása megegyezik a <code>sysctl net.inet.ip.forwarding=1</code> parancs kiadásával.</td></tr><tr><td><i class=conum data-value=2></i><b>2</b></td><td>A rendszer indításakor engedélyezi az <span class=filename>/etc/rc.firewall</span> állományban szereplõ tûzfalszabályok használatát.</td></tr><tr><td><i class=conum data-value=3></i><b>3</b></td><td>Egy olyan elõre definiált tûzfalat ad meg, amely alapból mindent beenged. Az <span class=filename>/etc/rc.firewall</span> állományban találhatjuk a többi típust.</td></tr><tr><td><i class=conum data-value=4></i><b>4</b></td><td>Megadja, hogy melyik felületen továbbítsunk csomagokat az internet felé (ez a felület csatlakozik az internetre).</td></tr><tr><td><i class=conum data-value=5></i><b>5</b></td><td>Itt szerepel minden további paraméter, amelyet még az indításkor át kell adnunk a <a href="https://man.freebsd.org/cgi/man.cgi?query=natd&amp;sektion=8&amp;format=html">natd(8)</a> démonnak.</td></tr></tbody></table></div><div class=paragraph><p>Amikor megadjuk ezeket a beállításokat az <span class=filename>/etc/rc.conf</span> állományban, pontosan ugyanaz történik, mintha a <code>natd -interface fxp0</code> parancsot adtunk volna ki a rendszer indításakor. Ez tehát manuálisan is elindítható.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Ha túlságosan sok paramétert akarunk egyszerre beállítani <a href="https://man.freebsd.org/cgi/man.cgi?query=natd&amp;sektion=8&amp;format=html">natd(8)</a> használatához, akkor akár egy külön konfigurációs állományt is megadhatunk. Ebben az esetben a konfigurációs állományt a következõ módon kell megjelölni az <span class=filename>/etc/rc.conf</span> állományban:</p></div><div class="literalblock programlisting"><div class=content><pre>natd_flags=&#34;-f /etc/natd.conf&#34;</pre></div></div><div class=paragraph><p>Ekkor a <span class=filename>/etc/natd.conf</span> állomány fogja tartalmazni a beállításokat, soronként egyet. Például a következõ szakaszban ez lesz a tartalma:</p></div><div class="literalblock programlisting"><div class=content><pre>redirect_port tcp 192.168.0.2:6667 6667
redirect_port tcp 192.168.0.3:80 80</pre></div></div><div class=paragraph><p>A konfigurációs állományról és az <code>-f</code> opció használatával kapcsolatban olvassuk el a <a href="https://man.freebsd.org/cgi/man.cgi?query=natd&amp;sektion=8&amp;format=html">natd(8)</a> man oldalát.</p></div></td></tr></tbody></table></div><div class=paragraph><p>A helyi hálózaton mindegyik gépnek az <a href=ftp://ftp.isi.edu/in-notes/rfc1918.txt>RFC 1918</a> által megadott privát IP-címterekbõl származó címet kell használnia, és az alapértelmezett átjárónak mindenhol a natd démont futtató gép IP-címét kell megadni.</p></div><div class=paragraph><p>Például a belsõ hálózaton található <code>A</code> és <code>B</code> kliensek IP-címei rendre <code>192.168.0.2</code> és <code>192.168.0.3</code>, míg a <a href="https://man.freebsd.org/cgi/man.cgi?query=natd&amp;sektion=8&amp;format=html">natd(8)</a> démont futtató gép belsõ címe <code>192.168.0.1</code>. Az <code>A</code> és a <code>B</code> kliens alapértelmezett átjáróját a natd gépre, vagyis a <code>192.168.0.1</code> címre kell beállítanunk. A natd gép külsõ, avagy internetes felülete semmilyen további módosítást nem igényel a <a href="https://man.freebsd.org/cgi/man.cgi?query=natd&amp;sektion=8&amp;format=html">natd(8)</a> mûködéséhez.</p></div></div><div class=sect3><h4 id=network-natdport-redirection>31.9.6. A portok átirányítása<a class=anchor href=#network-natdport-redirection></a></h4><div class=paragraph><p>A <a href="https://man.freebsd.org/cgi/man.cgi?query=natd&amp;sektion=8&amp;format=html">natd(8)</a> alkalmazásának hátránya, hogy a belsõ hálózatra csatlakozó kliensek az internetrõl nem érhetõek el. Tehát a helyi hálózat kliensei képesek elérni a külvilágot, de az visszafelé már nem igaz. Ez akkor jelent igazából problémát, ha az egyik belsõ kliensen szolgáltatásokat akarunk futtatni. A probléma egyik egyszerû megoldása, ha a natd használatával az internet felõl egyszerûen átirányítunk bizonyos portokat a megfelelõ belsõ kliensre.</p></div><div class=paragraph><p>Például tegyük fel, hogy az <code>A</code> kliens egy IRC szervert, míg a <code>B</code> kliens egy webszervert futtat. Ez akkor fog mûködni, ha a szolgáltatásokhoz tartozó 6667 (IRC) és 80 (web) portokat átirányítjuk a hozzájuk tartozó gépek felé.</p></div><div class=paragraph><p>Ehhez a <a href="https://man.freebsd.org/cgi/man.cgi?query=natd&amp;sektion=8&amp;format=html">natd(8)</a> démonnak a <code>-redirect_port</code> paramétert kell átadni. A pontos felírás így néz ki:</p></div><div class="literalblock programlisting"><div class=content><pre>     -redirect_port protokoll célIP:célPORT[-célPORT]
                 [külsõIP:]külsõPORT[-külsõPORT]
                 [távoliIP[:távoliPORT[-távoliPORT]]]</pre></div></div><div class=paragraph><p>A fenti példában tehát ezt kell megadnunk:</p></div><div class="literalblock programlisting"><div class=content><pre>    -redirect_port tcp 192.168.0.2:6667 6667
    -redirect_port tcp 192.168.0.3:80 80</pre></div></div><div class=paragraph><p>Így az egyes külsõ <em>tcp</em> portokat átirányítjuk a belsõ hálózat gépei felé.</p></div><div class=paragraph><p>A <code>-redirect_port</code> paraméternek akár egész porttartományokat is megadhatunk. Például a <em>tcp 192.168.0.2:2000-3000 2000-3000</em> megadásával az összes 2000-tõl 3000-ig terjedõ port csatlakozását leképezzük az <code>A</code> kliens 2000 és 3000 közti portjaira.</p></div><div class=paragraph><p>Ezek a beállítások a <a href="https://man.freebsd.org/cgi/man.cgi?query=natd&amp;sektion=8&amp;format=html">natd(8)</a> közvetlen futtatásakor adhatóak meg, esetleg az <span class=filename>/etc/rc.conf</span> állományban az <code>natd_flags=""</code> opció keresztül, vagy egy külön konfigurációs állományban.</p></div><div class=paragraph><p>A többi beállítási lehetõséget a <a href="https://man.freebsd.org/cgi/man.cgi?query=natd&amp;sektion=8&amp;format=html">natd(8)</a> man oldalán ismerhetjük meg.</p></div></div><div class=sect3><h4 id=network-natdaddress-redirection>31.9.7. A címek átirányítása<a class=anchor href=#network-natdaddress-redirection></a></h4><div class=paragraph><p>A címek átirányítása abban az esetben hasznos, amikor több IP-cím áll rendelkezésünkre, de ezek egy géphez tartoznak. Ilyenkor az <a href="https://man.freebsd.org/cgi/man.cgi?query=natd&amp;sektion=8&amp;format=html">natd(8)</a> képes a belsõ hálózat egyes gépeihez saját külsõ IP-címet rendelni. A <a href="https://man.freebsd.org/cgi/man.cgi?query=natd&amp;sektion=8&amp;format=html">natd(8)</a> a belsõ hálózat kliensei által küldött csomagokban kicseréli a címüket a megfelelõ külsõ IP-címmel, illetve az ezekre a címekre érkezõ forgalmat továbbítja a megfelelõ belsõ kliens irányába. Ezt a megoldást statikus hálózati címfordításnak is nevezzük. Például a <code>128.1.1.2</code> és a <code>128.1.1.3</code> IP-címek a natd démont futtató átjáróhoz tartoznak. A <code>128.1.1.1</code> cím használható a natd alapú átjáró külsõ IP-címeként, miközben a <code>128.1.1.2</code> és a <code>128.1.1.3</code> címeket a belsõ hálózaton elérhetõ <code>A</code> és <code>B</code> kliensek felé közvetítjük.</p></div><div class=paragraph><p>A <code>-redirect_address</code> felírása tehát a következõ:</p></div><div class="literalblock programlisting"><div class=content><pre>-redirect_address helyiIP publikusIP</pre></div></div><table class="tableblock frame-none grid-all stretch informaltable"><col style=width:50%><col style=width:50%><tbody><tr><td class="tableblock halign-left valign-top"><p class=tableblock><em>helyiIP</em></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>A helyi hálózaton található kliens saját IP-címe.</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><em>publikusIP</em></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>A klienshez tartozó megfelelõ külsõ IP-cím.</p></td></tr></tbody></table><div class=paragraph><p>Az iménti példában a pontos paraméterek ezek lesznek:</p></div><div class="literalblock programlisting"><div class=content><pre>-redirect_address 192.168.0.2 128.1.1.2
-redirect_address 192.168.0.3 128.1.1.3</pre></div></div><div class=paragraph><p>A <code>-redirect_port</code> opcióhoz hasonlóan ez is megadható az <span class=filename>/etc/rc.conf</span> állományban az <code>natd_flags=""</code> beállításon keresztül vagy egy külön konfigurációs állományban. A címek átirányításával nincs szüksége a portok átirányítására, mivel az adott IP-címhez tartozó összes forgalmat átirányítjuk.</p></div><div class=paragraph><p>A natd démont futtató gépen a külsõ IP-címeket aktiválni kell és a külsõ felületéhez kell rendelni. A <a href="https://man.freebsd.org/cgi/man.cgi?query=rc.conf&amp;sektion=5&amp;format=html">rc.conf(5)</a> man oldalon járhatunk utána, hogy mindezt hogyan is tudjuk megcsinálni.</p></div></div></div><div class=sect2><h3 id=network-plip>31.10. Párhuzamos vonali IP (PLIP)<a class=anchor href=#network-plip></a></h3><div class=paragraph><p>A párhuzamos vonali IP (Parallel Line IP, PLIP) a TCP/IP protokoll használatát valósítja meg párhuzamos porton keresztül. Olyan gépek számára lehet hasznos, amelyekben nincs hálózati kártya, vagy esetleg laptopoknál. Ebben a szakaszban a következõket tárgyaljuk:</p></div><div class=ulist><ul><li><p>Párhuzamos (laplink) kábel készítése</p></li><li><p>Két számítógép összekapcsolása a PLIP segítségével</p></li></ul></div><div class=sect3><h4 id=network-create-parallel-cable>31.10.1. Párhuzamos kábel készítése<a class=anchor href=#network-create-parallel-cable></a></h4><div class=paragraph><p>Párhuzamos kábelt a legtöbb számítástechnikai boltban tudunk vásárolni. Ha mégsem tudnánk sehol sem beszerezni, vagy egyszerûen tudni szeretnénk, hogyan lehet ilyet készíteni, akkor az alábbi táblázatban láthatjuk, hogy miként tudunk egy hétköznapi nyomtatókábelt átalakítani a céljainkra.</p></div><table class="tableblock frame-none grid-all stretch"><caption class=title>Táblázat 12. A párhuzamos kábel hálózati használatra alkalmas bekötése</caption><col style=width:20%><col style=width:20%><col style=width:20%><col style=width:20%><col style=width:20%><thead><tr><th class="tableblock halign-left valign-top">A-név</th><th class="tableblock halign-left valign-top">A-vég</th><th class="tableblock halign-left valign-top">B-vég</th><th class="tableblock halign-left valign-top">Leírás</th><th class="tableblock halign-left valign-top">Post/Bit</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><div class=literal><pre>....
DATA0
-ERROR
....</pre></div></td><td class="tableblock halign-left valign-top"><div class=literal><pre>....
2
15
....</pre></div></td><td class="tableblock halign-left valign-top"><div class=literal><pre>....
15
2
....</pre></div></td><td class="tableblock halign-left valign-top"><p class=tableblock>Adat</p></td><td class="tableblock halign-left valign-top"><div class=literal><pre>....
0/0x01
1/0x08
....</pre></div></td></tr><tr><td class="tableblock halign-left valign-top"><div class=literal><pre>....
DATA1
+SLCT
....</pre></div></td><td class="tableblock halign-left valign-top"><div class=literal><pre>....
3
13
....</pre></div></td><td class="tableblock halign-left valign-top"><div class=literal><pre>....
13
3
....</pre></div></td><td class="tableblock halign-left valign-top"><p class=tableblock>Adat</p></td><td class="tableblock halign-left valign-top"><div class=literal><pre>....
0/0x02
1/0x10
....</pre></div></td></tr><tr><td class="tableblock halign-left valign-top"><div class=literal><pre>....
DATA2
+PE
....</pre></div></td><td class="tableblock halign-left valign-top"><div class=literal><pre>....
4
12
....</pre></div></td><td class="tableblock halign-left valign-top"><div class=literal><pre>....
12
4
....</pre></div></td><td class="tableblock halign-left valign-top"><p class=tableblock>Adat</p></td><td class="tableblock halign-left valign-top"><div class=literal><pre>....
0/0x04
1/0x20
....</pre></div></td></tr><tr><td class="tableblock halign-left valign-top"><div class=literal><pre>....
DATA3
-ACK
....</pre></div></td><td class="tableblock halign-left valign-top"><div class=literal><pre>....
5
10
....</pre></div></td><td class="tableblock halign-left valign-top"><div class=literal><pre>....
10
5
....</pre></div></td><td class="tableblock halign-left valign-top"><p class=tableblock>Vál. imp.</p></td><td class="tableblock halign-left valign-top"><div class=literal><pre>....
0/0x08
1/0x40
....</pre></div></td></tr><tr><td class="tableblock halign-left valign-top"><div class=literal><pre>....
DATA4
BUSY
....</pre></div></td><td class="tableblock halign-left valign-top"><div class=literal><pre>....
6
11
....</pre></div></td><td class="tableblock halign-left valign-top"><div class=literal><pre>....
11
6
....</pre></div></td><td class="tableblock halign-left valign-top"><p class=tableblock>Adat</p></td><td class="tableblock halign-left valign-top"><div class=literal><pre>....
0/0x10
1/0x80
....</pre></div></td></tr><tr><td class="tableblock halign-left valign-top"><div class=literal><pre>GND</pre></div></td><td class="tableblock halign-left valign-top"><div class=literal><pre>18-25</pre></div></td><td class="tableblock halign-left valign-top"><div class=literal><pre>18-25</pre></div></td><td class="tableblock halign-left valign-top"><p class=tableblock>Föld</p></td><td class="tableblock halign-left valign-top"><div class=literal><pre>-</pre></div></td></tr></tbody></table></div><div class=sect3><h4 id=network-plip-setup>31.10.2. A PLIP beállítása<a class=anchor href=#network-plip-setup></a></h4><div class=paragraph><p>Elõször is szereznünk kell valahonnan egy laplink kábelt. Ha ez megvan, akkor mind a két gépen ellenõrizzük, hogy a rendszermag tartalmazza az <a href="https://man.freebsd.org/cgi/man.cgi?query=lpt&amp;sektion=4&amp;format=html">lpt(4)</a> meghajtót:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># grep lp /var/run/dmesg.boot</span>
lpt0: &lt;Printer&gt; on ppbus0
lpt0: Interrupt-driven port</code></pre></div></div><div class=paragraph><p>A párhuzamos portnak megszakítással vezéreltnek kell lennie ("interrupt driven"), és az <span class=filename>/boot/device.hints</span> állományban szerepelnie kell nagyjából a következõ soroknak:</p></div><div class="literalblock programlisting"><div class=content><pre>hint.ppc.0.at=&#34;isa&#34;
hint.ppc.0.irq=&#34;7&#34;</pre></div></div><div class=paragraph><p>Ezután nézzük meg, hogy a rendszermag beállításait tartalmazó állományban megjelenik-e a <code>device plip</code> sor, vagy a <span class=filename>plip.ko</span> modul betöltõdött-e. Akármelyik is történt, a párhuzamos hálózati felület most már a rendelkezésünkre áll, és az <a href="https://man.freebsd.org/cgi/man.cgi?query=ifconfig&amp;sektion=8&amp;format=html">ifconfig(8)</a> paranccsal ezt meg is tudjuk nézni:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># ifconfig plip0</span>
plip0: <span class=nv>flags</span><span class=o>=</span>8810&lt;POINTOPOINT,SIMPLEX,MULTICAST&gt; mtu 1500</code></pre></div></div><div class=paragraph><p>A laplink kábelt csatlakoztassuk mind a két számítógéphez.</p></div><div class=paragraph><p>Mind a két a hálózati felület paramétereit <code>root</code> felhasználóként hangoljuk be. Például, ha az <code><em>egyikgép</em></code> nevû gépet akarjuk a <code><em>másikgép</em></code> nevû géphez csatlakoztatni:</p></div><div class="literalblock programlisting"><div class=content><pre>              egyikgép &lt;-----&gt; másikgép
IP-cím        10.0.0.1      10.0.0.2</pre></div></div><div class=paragraph><p>Az <code><em>egyikgép</em></code> felületét így állítsuk be:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># ifconfig plip0 10.0.0.1 10.0.0.2</span></code></pre></div></div><div class=paragraph><p>A <code><em>másikgép</em></code> felületét így állítsuk be:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># ifconfig plip0 10.0.0.2 10.0.0.1</span></code></pre></div></div><div class=paragraph><p>Ezt követõen már egy mûködõ kapcsolatnak kell felépülnie. Az egyéb részletek kapcsán az <a href="https://man.freebsd.org/cgi/man.cgi?query=lp&amp;sektion=4&amp;format=html">lp(4)</a> és az <a href="https://man.freebsd.org/cgi/man.cgi?query=lpt&amp;sektion=4&amp;format=html">lpt(4)</a> man oldalait nézzük át.</p></div><div class=paragraph><p>Ezt a két gépet vegyük fel az <span class=filename>/etc/hosts</span> állományba is:</p></div><div class="literalblock programlisting"><div class=content><pre>127.0.0.1               localhost.saját.tartomány localhost
10.0.0.1                egyikgép.saját.tartomány egyikgép
10.0.0.2                másikgép.saját.tartomány</pre></div></div><div class=paragraph><p>A kapcsolat mûködõképességérõl úgy tudunk meggyõzõdni, ha az egyik géprõl megpróbáljuk pingelni a másikat. Például az <code><em>egyikgép</em></code> esetében:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># ifconfig plip0</span>
plip0: <span class=nv>flags</span><span class=o>=</span>8851&lt;UP,POINTOPOINT,RUNNING,SIMPLEX,MULTICAST&gt; mtu 1500
        inet 10.0.0.1 <span class=nt>--</span><span class=o>&gt;</span> 10.0.0.2 netmask 0xff000000
<span class=c># netstat -r</span>
Routing tables

Internet:
Destination        Gateway          Flags     Refs     Use      Netif Expire
másikgép           egyikgép         UH          0       0       plip0
<span class=c># ping -c 4 másikgép</span>
PING másikgép <span class=o>(</span>10.0.0.2<span class=o>)</span>: 56 data bytes
64 bytes from 10.0.0.2: <span class=nv>icmp_seq</span><span class=o>=</span>0 <span class=nv>ttl</span><span class=o>=</span>255 <span class=nb>time</span><span class=o>=</span>2.774 ms
64 bytes from 10.0.0.2: <span class=nv>icmp_seq</span><span class=o>=</span>1 <span class=nv>ttl</span><span class=o>=</span>255 <span class=nb>time</span><span class=o>=</span>2.530 ms
64 bytes from 10.0.0.2: <span class=nv>icmp_seq</span><span class=o>=</span>2 <span class=nv>ttl</span><span class=o>=</span>255 <span class=nb>time</span><span class=o>=</span>2.556 ms
64 bytes from 10.0.0.2: <span class=nv>icmp_seq</span><span class=o>=</span>3 <span class=nv>ttl</span><span class=o>=</span>255 <span class=nb>time</span><span class=o>=</span>2.714 ms

<span class=nt>---</span> másikgép ping statistics <span class=nt>---</span>
4 packets transmitted, 4 packets received, 0% packet loss
round-trip min/avg/max/stddev <span class=o>=</span> 2.530/2.643/2.774/0.103 ms</code></pre></div></div></div></div><div class=sect2><h3 id=network-ipv6>31.11. Az IPv6<a class=anchor href=#network-ipv6></a></h3><div class=paragraph><p>Az IPv6 (másik néven az IPng, vagy a "az internet következõ generációs protokollja", "IP next generation") a jól ismert IP protokoll (avagy az IPv4) új változata. Hasonlóan a jelenleg mûködõ összes többi BSD rendszerhez, a FreeBSD is tartalmazza a KAME IPv6 referencia implementációt. Ezért ha ezzel szeretnénk kísérletezni, akkor ehhez a FreeBSD minden eszköz biztosít számunkra. Ez a szakasz az IPv6 beállítását és használatát mutatja be.</p></div><div class=paragraph><p>Az 1990-es évek elején az IPv4-es címterek rohamos mértékû kimerülését figyelték meg. Az internet jelenlegi bõvülési üteme mellett két nagyobb aggodalomnak adott okot:</p></div><div class=ulist><ul><li><p>A címek elfogyása. Napjainkban efelõl egyre kevesebb a kétség, mivel az RFC 1918 által megfogalmazott privát címterek (<code>10.0.0.0/8</code>, <code>172.16.0.0/12</code>, és <code>192.168.0.0/16</code>), valamint a hálózati címfordítás (Network Address Translation, NAT) használata igen elterjedt.</p></li><li><p>Az útválasztási táblázatok méretének növekedése. Ez még manapság is aggasztó.</p></li></ul></div><div class=paragraph><p>Az IPv6 ezeket és még más egyéb problémákat a következõ módon igyekszik megoldani:</p></div><div class=ulist><ul><li><p>A 128 bites címtér használata. Más szóval, elméletben összesen 340 282 366 920 938 463 463 374 607 431 768 211 456 darab címet képes kiosztani. Ez azt jelenti, hogy bolygónk minden egyes négyzetméterére megközelítõleg 6,67 * 10^27 IPv6 típusú cím jut.</p></li><li><p>Az útválasztók a saját táblázataikban csak a hálózatok összevont címeit tárolják el, ezáltal egy átlagos útválasztási táblázatban található bejegyzések száma 8192 alá csökken.</p></li></ul></div><div class=paragraph><p>Az IPv6 emellett még rengeteg más elõnyös lehetõséget is kínál:</p></div><div class=ulist><ul><li><p>A címek automatikus beállítása (lásd <a href=http://www.ietf.org/rfc/rfc2462.txt>RFC 2462</a>)</p></li><li><p>Anycast (bárkiküldés, vagyis "egy a sokból")</p></li><li><p>Kötelezõ (mandatory) multicast</p></li><li><p>IPsec (IP szintû védelem)</p></li><li><p>Egyszerûsített fejléc</p></li><li><p>Mobil IP</p></li><li><p>IPv6-IPv4 közti átjárhatóság</p></li></ul></div><div class=paragraph><p>Ha mindezekrõl többet szeretnénk megtudni, akkor erre érdemes továbblépnünk:</p></div><div class=ulist><ul><li><p>Az IPv6 áttekintése a <a href=http://playground.sun.com/pub/ipng/html/ipng-main.html>playground.sun.com</a> honlapon</p></li><li><p><a href=http://www.kame.net>KAME.net</a></p></li></ul></div><div class=sect3><h4 id=_az_ipv6_címek_háttere>31.11.1. Az IPv6 címek háttere<a class=anchor href=#_az_ipv6_címek_háttere></a></h4><div class=paragraph><p>Az IPv6 címeknek több típusa létezik: a unicast (egyesküldés), az anycast (bárkiküldés) és a multicast (többesküldés).</p></div><div class=paragraph><p>A unicasthez használt címek jól ismert címek. Az így elküldött csomag pontosan ahhoz a felülethez érkezik meg, amelyhez az adott cím tartozik.</p></div><div class=paragraph><p>Az anycasthez használt címek felírásukban tökéletesen megegyeznek a unicast esetével, de valójában felületek egy csoportját címezik. Az anycastre beállított címekre küldött csomagok mindig a(z útválasztó szerinti) legközelebb levõ felülethez érkeznek meg. Az anycastet az útválasztók számára találták ki.</p></div><div class=paragraph><p>A multicasthez használt címek felületek egy csoportját nevezik meg. A multicast címekre érkezõ csomagokat a csoport minden egyes tagja megkapja.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Az IPv4 esetében az üzenetszórásra szánt (általában az <code>xxx.xxx.xxx.255</code> formátumú) címeket az IPv6 esetében multicast címekkel fejezzük ki.</p></div></td></tr></tbody></table></div><table class="tableblock frame-none grid-all stretch"><caption class=title>Táblázat 13. Fenntartott IPv6 címek</caption><col style=width:25%><col style=width:25%><col style=width:25%><col style=width:25%><thead><tr><th class="tableblock halign-left valign-top">IPv6 cím</th><th class="tableblock halign-left valign-top">Az elõtag hossza (bitekben)</th><th class="tableblock halign-left valign-top">Leírás</th><th class="tableblock halign-left valign-top">Megjegyzés</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>::</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>128 bit</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>nem specifikált</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Vö. a <code>0.0.0.0</code> címmel az IPv4 esetében.</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>::1</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>128 bit</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>saját cím</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Vö. a <code>127.0.0.1</code> címmel az IPv4 esetében.</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>::00:xx:xx:xx:xx</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>96 bit</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>IPv4 beágyazása</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Az alsó 32 bit egy IPv4 formátumú cím. Ezt "IPv4 kompatibilis IPv6 címnek" is nevezik.</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>::ff:xx:xx:xx:xx</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>96 bit</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>IPv4-re leképzett IPv6 címek</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Az alsó 32 bit egy IPv4 címet jelöl. Olyan gépeknél használatos, amelyek nem támogatják az IPv6 protokollt.</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>fe80::</code> - <code>feb::</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>10 bit</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>helyi összeköttetés</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Vö. az IPv4 loopback címeivel.</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>fec0::</code> - <code>fef::</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>10 bit</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>helyi cím</p></td><td class="tableblock halign-left valign-top"></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>ff::</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>8 bit</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>multicast</p></td><td class="tableblock halign-left valign-top"></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>001</code> (2-es alapú)</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>3 bit</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>globális unicast</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Az összes globális unicast címet ebbõl a tartományból osztjuk ki. Az elsõ 3 bit értéke"001".</p></td></tr></tbody></table></div><div class=sect3><h4 id=_az_ipv6_címek_olvasása>31.11.2. Az IPv6 címek olvasása<a class=anchor href=#_az_ipv6_címek_olvasása></a></h4><div class=paragraph><p>Az IPv6 címek kanonikus formája így ábrázolható: <code>x:x:x:x:x:x:x:x</code>, ahol mindegyik "x" egy 16 bites hexadecimális érték. Például: <code>FEBC:A574:382B:23C1:AA49:4592:4EFE:9982</code>.</p></div><div class=paragraph><p>Gyakran a címek hosszú nullákból álló sorozatokat tartalmaznak, ezért mindegyik ilyen sorozatot rövidíteni tudjuk a "::" jelöléssel. Rajtuk kívül még az egyes hexadecimális csoportokban a bevezetõ nullák is elhagyhatóak. Például az <code>fe80::1</code> cím kanonikus formája: <code>fe80:0000:0000:0000:0000:0000:0000:0001</code>.</p></div><div class=paragraph><p>A harmadik forma szerint az utolsó 32 bites részt írjuk fel a megszokott (decimális) IPv4 stílusú pontozással, ahol tehát a "." választja el a tagokat. Így például a <code>2002::10.0.0.1</code> felírás a <code>2002:0000:0000:0000:0000:0000:0a00:0001</code> kanonikus (hexadecimális) ábrázolásnak feleltethetõ meg, ami pedig egyszerûen <code>2002::a00:1</code> alakban is megadható.</p></div><div class=paragraph><p>Mostanra már minden bizonnyal a kedves olvasó érteni fogja a következõt:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># ifconfig</span></code></pre></div></div><div class="literalblock programlisting"><div class=content><pre>rl0: flags=8943&lt;UP,BROADCAST,RUNNING,PROMISC,SIMPLEX,MULTICAST&gt; mtu 1500
         inet 10.0.0.10 netmask 0xffffff00 broadcast 10.0.0.255
         inet6 fe80::200:21ff:fe03:8e1%rl0 prefixlen 64 scopeid 0x1
         ether 00:00:21:03:08:e1
         media: Ethernet autoselect (100baseTX )
         status: active</pre></div></div><div class=paragraph><p>A <code>fe80::200:21ff:fe03:8e1%rl0</code> cím az automatikusan beállított helyi összeköttetés címe. Ez az automatikus beállítás részeként a MAC-címbõl jött létre.</p></div><div class=paragraph><p>Az IPv6 címek szerkezetérõl további részleteket az <a href=http://www.ietf.org/rfc/rfc3513.txt>RFC 3513</a>-ban találunk.</p></div></div><div class=sect3><h4 id=_kapcsolódás>31.11.3. Kapcsolódás<a class=anchor href=#_kapcsolódás></a></h4><div class=paragraph><p>Jelenleg négy módon tudunk más IPv6-os géphez és hálózathoz csatlakozni:</p></div><div class=ulist><ul><li><p>Kérjünk a hálózati elérésünkért felelõs illetékesektõl IPv6 alapú hálózatot. A részletek tekintetében vegyük fel a kapcsolatot az internet-szolgáltatónkkal.</p></li><li><p>A <a href=http://www.sixxs.net>SixXS</a> a világ minden táján kínál végpontokkal rendelkezõ tunneleket.</p></li><li><p>Egy 6-ból-4 (<a href=http://www.ietf.org/rfc/rfc3068.txt>RFC 3068</a>) típusú tunnellel.</p></li><li><p>Ha betárcsázós kapcsolatunk van, akkor használjuk a <a class=package href=https://cgit.freebsd.org/ports/tree/net/freenet6/>net/freenet6</a> portot.</p></li></ul></div></div><div class=sect3><h4 id=_a_nevek_feloldása_az_ipv6_világában>31.11.4. A nevek feloldása az IPv6 világában<a class=anchor href=#_a_nevek_feloldása_az_ipv6_világában></a></h4><div class=paragraph><p>IPv6 alatt régebben két típusa volt a nevek feloldásáért felelõs rekordoknak. Az IETF az A6 rekordokat idõközben elavultnak nyilvánította. Ezért manapság már az AAAA rekordok tekinthetõek szabványosnak.</p></div><div class=paragraph><p>Az AAAA rekordok használata magától értetõdik. A hálózati nevükhöz az alábbi módon tudunk IPv6 címet rendelni az elsõdleges zónát leíró állományban:</p></div><div class="literalblock programlisting"><div class=content><pre>SAJÁTNÉV           AAAA    SAJÁTIPv6CÍM</pre></div></div><div class=paragraph><p>Ha nem rendelkezünk saját névfeloldási zónával, akkor erre kérjük meg a névfeloldást végzõ szolgáltatónkat. A bind jelenlegi változatai (8.3 és 9), valamint a <a class=package href=https://cgit.freebsd.org/ports/tree/dns/djbdns/>dns/djbdns</a> (IPv6 támogatására vonatkozó javítással) támogatják az AAAA rekordokat.</p></div></div><div class=sect3><h4 id=_az_etcrc_conf_szükséges_módosításai>31.11.5. Az <span class=filename>/etc/rc.conf</span> szükséges módosításai<a class=anchor href=#_az_etcrc_conf_szükséges_módosításai></a></h4><div class=sect4><h5 id=_az_ipv6_kliensek_beállításai>31.11.5.1. Az IPv6 kliensek beállításai<a class=anchor href=#_az_ipv6_kliensek_beállításai></a></h5><div class=paragraph><p>Ezek a beállítások egy helyi hálózaton levõ gépre vonatkoznak, nem pedig egy útválasztóra. Az <a href="https://man.freebsd.org/cgi/man.cgi?query=rtsol&amp;sektion=8&amp;format=html">rtsol(8)</a> az alábbi megadásával fogja automatikusan beállítani a felületeinket a rendszer indításakor:</p></div><div class="literalblock programlisting"><div class=content><pre>ipv6_enable=&#34;YES&#34;</pre></div></div><div class=paragraph><p>Ha az <span class=filename>fxp0</span> felülethez statikusan akarunk IP-címet rendelni, például a <code>2001:471:1f11:251:290:27ff:fee0:2093</code> címet, akkor ehhez a következõt kell megadni:</p></div><div class="literalblock programlisting"><div class=content><pre>ipv6_ifconfig_fxp0=&#34;2001:471:1f11:251:290:27ff:fee0:2093&#34;</pre></div></div><div class=paragraph><p>Az <span class=filename>/etc/rc.conf</span> állományban az alapértelmezett átjárót a következõ módon tudjuk a <code>2001:471:1f11:251::1</code> címre beállítani:</p></div><div class="literalblock programlisting"><div class=content><pre>ipv6_defaultrouter=&#34;2001:471:1f11:251::1&#34;</pre></div></div></div><div class=sect4><h5 id=_az_ipv6_útválasztók_és_átjárók_beállítása>31.11.5.2. Az IPv6 útválasztók és átjárók beállítása<a class=anchor href=#_az_ipv6_útválasztók_és_átjárók_beállítása></a></h5><div class=paragraph><p>Itt most a tunnelt biztosító szolgáltató által mutatott irányt követjük, és olyan formára alakítjuk, amely megmarad az újraindítás után is. A rendszer indításakor az <span class=filename>/etc/rc.conf</span> állományban valami ilyesmit kell megadni a járat visszaállításához:</p></div><div class=paragraph><p>Soroljuk fel a beállítandó általános tunnel alapú felületeket, ilyen lehet például a <span class=filename>gif0</span>:</p></div><div class="literalblock programlisting"><div class=content><pre>gif_interfaces=&#34;gif0&#34;</pre></div></div><div class=paragraph><p>A felületnek állítsunk be egy helyi végpontot a <em>SAJÁT_IPv4_CÍM</em> megadásával, valamint egy távoli végpontot a <em>TÁVOLI_IPv4_CÍM</em> megadásával:</p></div><div class="literalblock programlisting"><div class=content><pre>gifconfig_gif0=&#34;SAJÁT_IPv4_CÍM TÁVOLI_IPv4_CÍM&#34;</pre></div></div><div class=paragraph><p>Az IPv6 tunnelünk végpontjához kapott cím aktiválásához az alábbit kell még megadnunk:</p></div><div class="literalblock programlisting"><div class=content><pre>ipv6_ifconfig_gif0=&#34;SAJÁT_KAPOTT_IPv6_TUNNEL_VÉGPONTJÁNAK_CÍME&#34;</pre></div></div><div class=paragraph><p>Ezután már csak az alapértelmezett útvonalat kell beállítani az IPv6 számára. Ez az IPv6 járat másik oldala:</p></div><div class="literalblock programlisting"><div class=content><pre>ipv6_defaultrouter=&#34;SAJÁT_IPv6_TÁVOLI_TUNNEL_VÉGPONTJÁNAK_CÍME&#34;</pre></div></div></div><div class=sect4><h5 id=_az_ipv6_tunnel_beállításai>31.11.5.3. Az IPv6 tunnel beállításai<a class=anchor href=#_az_ipv6_tunnel_beállításai></a></h5><div class=paragraph><p>Amennyiben a szerver IPv6 alapú forgalmat közvetít a hálózatunk és a világ között, az <span class=filename>/etc/rc.conf</span> állományba a következõt kell felvennünk:</p></div><div class="literalblock programlisting"><div class=content><pre>ipv6_gateway_enable=&#34;YES&#34;</pre></div></div></div></div><div class=sect3><h4 id=_az_útválasztók_kihirdetése_és_automatikus_konfigurációja>31.11.6. Az útválasztók kihirdetése és automatikus konfigurációja<a class=anchor href=#_az_útválasztók_kihirdetése_és_automatikus_konfigurációja></a></h4><div class=paragraph><p>Ebben a szakaszban az <a href="https://man.freebsd.org/cgi/man.cgi?query=rtadvd&amp;sektion=8&amp;format=html">rtadvd(8)</a> beállításával fogjuk az alapértelmezett IPv6 útvonalat kihirdetni.</p></div><div class=paragraph><p>Az <a href="https://man.freebsd.org/cgi/man.cgi?query=rtadvd&amp;sektion=8&amp;format=html">rtadvd(8)</a> engedélyezéséhez az alábbi sort kell betennünk az <span class=filename>/etc/rc.conf</span> állományba:</p></div><div class="literalblock programlisting"><div class=content><pre>rtadvd_enable=&#34;YES&#34;</pre></div></div><div class=paragraph><p>Emellett még fontos megadnunk azt a felületet, ahol az IPv6 útválasztó kérelmezését végezzük. Ha erre a feladatra például az <span class=filename>fxp0</span> felületet választjuk, akkor errõl az <a href="https://man.freebsd.org/cgi/man.cgi?query=rtadvd&amp;sektion=8&amp;format=html">rtadvd(8)</a> így értesíthetõ:</p></div><div class="literalblock programlisting"><div class=content><pre>rtadvd_interfaces=&#34;fxp0&#34;</pre></div></div><div class=paragraph><p>Most pedig készítenünk kell hozzá egy konfigurációt is, vagyis az <span class=filename>/etc/rtadvd.conf</span> állományt. Íme erre egy példa:</p></div><div class="literalblock programlisting"><div class=content><pre>fxp0:\
	:addrs#1:addr=&#34;2001:471:1f11:246::&#34;:prefixlen#64:tc=ether:</pre></div></div><div class=paragraph><p>Az <span class=filename>fxp0</span> felületet természetesen cseréljük ki a sajátunkkal.</p></div><div class=paragraph><p>Ezután a <code>2001:471:1f11:246::</code> címre helyére írjuk be a saját kiosztásunk elõtagját.</p></div><div class=paragraph><p>Egy egész <code>/64</code> alhálózat esetén nem is kell többet megadni. Minden más helyezetben az elõtag hosszára <code>prefixlen#</code> vonatkozó értéket is be kell még állítanunk.</p></div></div></div><div class=sect2><h3 id=network-atm>31.12. Az Aszinkron adatátviteli mód (ATM)<a class=anchor href=#network-atm></a></h3><div class=sect3><h4 id=_a_klasszikus_ip_címek_beállítása_atm_felett_állandó>31.12.1. A klasszikus IP-címek beállítása ATM felett (állandó)<a class=anchor href=#_a_klasszikus_ip_címek_beállítása_atm_felett_állandó></a></h4><div class=paragraph><p>A klasszikus IP ATM felett (Classical IP over ATM, CLIP) a legegyszerûbb módszer az IP-címek használatára az Aszinkron adatátviteli móddal (Asynchronous Transfer Mode, ATM) együtt. Kapcsolt és állandó kapcsolatok (Switched Virtual Channel, SVC és Permanent Virtual Channel, PVC) esetén egyaránt megfelelõ. Ebben a szakaszban ez utóbbival fogunk foglalkozni.</p></div><div class=sect4><h5 id=_a_teljesen_hálószerû_konfigurációk>31.12.1.1. A teljesen hálószerû konfigurációk<a class=anchor href=#_a_teljesen_hálószerû_konfigurációk></a></h5><div class=paragraph><p>A CLIP beállítását állandó csatornákon például úgy tudjuk megoldani, ha az összes gépet külön ezekre a célokra szánt állandó csatornákkal összekapcsoljuk egymással. Ez az egyszerû megoldás azonban nagyobb számú gép esetében már nem eléggé hatékony. A következõ példában csupán négy gépet kötünk hálózatba, melyik mindegyike egy ATM kártyával csatlakozik az ATM hálózatra. Ehhez elsõként tervezzük meg az IP-címek kiosztását és a gépek közti ATM kapcsolatokat. A példában ez az alábbiak szerint alakul:</p></div><table class="tableblock frame-none grid-all stretch informaltable"><col style=width:50%><col style=width:50%><thead><tr><th class="tableblock halign-left valign-top">Gép</th><th class="tableblock halign-left valign-top">IP-cím</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>A-gep</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock><code>192.168.173.1</code></p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>B-gep</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock><code>192.168.173.2</code></p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>C-gep</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock><code>192.168.173.3</code></p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>D-gep</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock><code>192.168.173.4</code></p></td></tr></tbody></table><div class=paragraph><p>A teljes hálózat felépítéséhez minden egyes pár között egy-egy ATM kapcsolatra lesz szükségünk:</p></div><table class="tableblock frame-none grid-all stretch informaltable"><col style=width:50%><col style=width:50%><thead><tr><th class="tableblock halign-left valign-top">Gépek</th><th class="tableblock halign-left valign-top">VPI.VCI pár</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>A-gep</code> - <code>B-gep</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>0.100</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>A-gep</code> - <code>C-gep</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>0.101</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>A-gep</code> - <code>D-gep</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>0.102</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>B-gep</code> - <code>C-gep</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>0.103</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>B-gep</code> - <code>D-gep</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>0.104</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>C-gep</code> - <code>D-gep</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>0.105</p></td></tr></tbody></table><div class=paragraph><p>A kapcsolatok egyes végein szereplõ VPI és VCI értékek természetesen eltérhetnek, de ezeket mi most az egyszerûség kedvéért egyenlõnek tekintettük. A következõ lépésben minden gépen állítsuk be az ATM felület:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>A-gep# ifconfig hatm0 192.168.173.1 up
B-gep# ifconfig hatm0 192.168.173.2 up
C-gep# ifconfig hatm0 192.168.173.3 up
D-gep# ifconfig hatm0 192.168.173.4 up</code></pre></div></div><div class=paragraph><p>Ha feltételezzük, hogy minden gépen a <span class=filename>hatm0</span> az ATM felület neve. Most pedig az <code>A-gep</code>-en állítsuk be az állandó csatornákat. (Itt most feltesszük, hogy az ATM switch-eken mindezt már elvégeztük. A switch kézikönyvében errõl részletesebb leírást is találhatunk.)</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>A-gep# atmconfig natm add 192.168.173.2 hatm0 0 100 llc/snap ubr
A-gep# atmconfig natm add 192.168.173.3 hatm0 0 101 llc/snap ubr
A-gep# atmconfig natm add 192.168.173.4 hatm0 0 102 llc/snap ubr

B-gep# atmconfig natm add 192.168.173.1 hatm0 0 100 llc/snap ubr
B-gep# atmconfig natm add 192.168.173.3 hatm0 0 103 llc/snap ubr
B-gep# atmconfig natm add 192.168.173.4 hatm0 0 104 llc/snap ubr

C-gep# atmconfig natm add 192.168.173.1 hatm0 0 101 llc/snap ubr
C-gep# atmconfig natm add 192.168.173.2 hatm0 0 103 llc/snap ubr
C-gep# atmconfig natm add 192.168.173.4 hatm0 0 105 llc/snap ubr

D-gep# atmconfig natm add 192.168.173.1 hatm0 0 102 llc/snap ubr
D-gep# atmconfig natm add 192.168.173.2 hatm0 0 104 llc/snap ubr
D-gep# atmconfig natm add 192.168.173.3 hatm0 0 105 llc/snap ubr</code></pre></div></div><div class=paragraph><p>Természetesen nem csak UBR használható, hanem minden más olyan forgalmazási beállítás, amit az ATM kártyáink ismernek. Itt most a forgalmi beállítás nevét a hozzá tartozó konkrét paraméterek követik. Az <a href="https://man.freebsd.org/cgi/man.cgi?query=atmconfig&amp;sektion=8&amp;format=html">atmconfig(8)</a> segédprogram használatához így kérhetünk segítséget:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># atmconfig help natm add</span></code></pre></div></div><div class=paragraph><p>Olvassuk el az <a href="https://man.freebsd.org/cgi/man.cgi?query=atmconfig&amp;sektion=8&amp;format=html">atmconfig(8)</a> man oldalát.</p></div><div class=paragraph><p>Ugyanez a beállítás az <span class=filename>/etc/rc.conf</span> állomány használatával is elvégezhetõ. Az <code>A-gep</code> esetében mindez így nézne ki:</p></div><div class="literalblock programlisting"><div class=content><pre>network_interfaces=&#34;lo0 hatm0&#34;
ifconfig_hatm0=&#34;inet 192.168.173.1 up&#34;
natm_static_routes=&#34;B-gep C-gep D-gep&#34;
route_B-gep=&#34;192.168.173.2 hatm0 0 100 llc/snap ubr&#34;
route_C-gep=&#34;192.168.173.3 hatm0 0 101 llc/snap ubr&#34;
route_D-gep=&#34;192.168.173.4 hatm0 0 102 llc/snap ubr&#34;</pre></div></div><div class=paragraph><p>A CLIP útvonalak pillanatnyi állapota így kérdezhetõ le:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>A-gep# atmconfig natm show</code></pre></div></div></div></div></div><div class=sect2><h3 id=carp>31.13. A Közös cím redundancia protokoll (CARP)<a class=anchor href=#carp></a></h3><div class=paragraph><p>A Közös cím redundancia protokoll (Common Address Redundancy Protocol, avagy CARP) segítségével több gép képes egyazon IP-címen osztozni. Bizonyos konfigurációkban ez a terhelés elosztására (terhelés-kiegyenlítésre) vagy a rendelkezésre állás növelésére (hibatûrésre) alkalmazható. A benne szereplõ gépek akár eltérõ IP-címmel is rendelkezhetnek, ahogy azt majd a példában is láthatjuk.</p></div><div class=paragraph><p>A CARP támogatásának engedélyezéséhez a FreeBSD rendszermagját a következõ beállítással kell újrafordítanunk:</p></div><div class="literalblock programlisting"><div class=content><pre>device	carp</pre></div></div><div class=paragraph><p>A CARP által biztosított lehetõségek ezután már elérhetõek, és számos <code>sysctl</code> változón keresztül állíthatóak:</p></div><table class="tableblock frame-none grid-all stretch informaltable"><col style=width:50%><col style=width:50%><thead><tr><th class="tableblock halign-left valign-top">Változó</th><th class="tableblock halign-left valign-top">Leírás</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>net.inet.carp.allow</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>A beérkezõ CARP csomagok elfogadása. Alapértelmezés szerint engedélyezett.</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>net.inet.carp.preempt</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Ezzel a beállítással az adott gépen az összes CARP felület leáll, ha közülük bármelyik is mûködésképtelenné válik. Alapértelmezés szerint tiltott.</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>net.inet.carp.log</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>A <code>0</code> értékkel kikapcsoljuk a naplózást. Az <code>1</code> értékkel a rossz CARP csomagok naplózását engedélyezzük. Az ettõl nagyobb értékek esetén pedig a CARP felületek változásait naplózzuk. Az alapértelmezett értéke az <code>1</code>.</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>net.inet.carp.arpbalance</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Az ARP protokoll segítségével próbálja meg a helyi hálózati forgalmat mentesíteni a terheléstõl. Alapértelmezés szerint tiltott.</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>net.inet.carp.suppress_preempt</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Ez a változó írásvédett, és a megszakítás elnyomásának állapotát mutatja. A megszakítás elnyomható, ha a felület egyik linkje nem mûködik. A <code>0</code> érték arra utal, hogy a megszakítást nem nyomták el. Minden probléma növeli ennek a változónak az értékét.</p></td></tr></tbody></table><div class=paragraph><p>A CARP eszközök maguk az <code>ifconfig</code> paranccsal készíthetõek el:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># ifconfig carp0 create</span></code></pre></div></div><div class=paragraph><p>Egy valós környezetben az ilyen felületeknek egy VHID néven ismert egyedi azonosítóval kell rendelkezniük. Ez a VHID vagy más néven a virtuális gépazonosító (azaz Virtual Host Identification) fogja a gépünket a hálózat többi elemétõl megkülönböztetni.</p></div><div class=sect3><h4 id=_a_carp_felhasználása_a_rendelkezésre_állás_javításában>31.13.1. A CARP felhasználása a rendelkezésre állás javításában<a class=anchor href=#_a_carp_felhasználása_a_rendelkezésre_állás_javításában></a></h4><div class=paragraph><p>A CARP használatának egyik módja, ahogy arra már korábban is utaltunk, a szerverek rendelkezésre állásának feljavítása. Ebben a példában három géppel fogunk hibatûrést biztosítani, melyik mindegyike egyedi IP-címmel rendelkezik és ugyanazt a webes tartalmat szolgáltatják. A gépeket egy Round Robin rendszerû (körbejáró) névfeloldással együtt használjuk. A tartalék gépünknek lesz még további két CARP felülete, külön a szerver IP-címeihez tartozó egyes webes tartalmakhoz. Amikor valami meghibásodik, a tartalék szerver átveszi a meghibásodott gép IP-címét. Ilyenkor a hiba teljesen észrevétlen marad a felhasználók számára. A tartalék szerveren a többi szerverrel egyezõ tartalomnak és szolgáltatásoknak kell megjelennie, hogy bármikor át tudja tõlük venni a forgalmat.</p></div><div class=paragraph><p>A hálózati neveiktõl és a virtuális azonosítóiktól eltekintve a két gépet ugyanúgy kell beállítani. Ebben a példában a gépeket most az <code>a-gep.minta.org</code> és <code>b-gep.minta.org</code> nevekkel láttuk el. Elõször is a CARP beállításához el kell helyeznünk a megfelelõ hivatkozásokat az <span class=filename>rc.conf</span> állományban. Az <code>a-gep.minta.org</code> esetében az <span class=filename>rc.conf</span> állomány a következõ sorokat tartalmazza:</p></div><div class="literalblock programlisting"><div class=content><pre>hostname=&#34;a-gep.minta.org&#34;
ifconfig_fxp0=&#34;inet 192.168.1.3 netmask 255.255.255.0&#34;
cloned_interfaces=&#34;carp0&#34;
ifconfig_carp0=&#34;vhid 1 pass testpass 192.168.1.50/24&#34;</pre></div></div><div class=paragraph><p>Miközben a <code>b-gep.minta.org</code> az <span class=filename>rc.conf</span> állományában ezeket adjuk meg:</p></div><div class="literalblock programlisting"><div class=content><pre>hostname=&#34;b-gep.minta.org&#34;
ifconfig_fxp0=&#34;inet 192.168.1.4 netmask 255.255.255.0&#34;
cloned_interfaces=&#34;carp0&#34;
ifconfig_carp0=&#34;vhid 2 pass testpass 192.168.1.51/24&#34;</pre></div></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Nagyon fontos, hogy az <code>ifconfig</code> parancs <code>pass</code> paraméterével megadott jelszavak megegyezzenek. A <span class=filename>carp</span> eszközök csak a megfelelõ jelszót birtokló gépeket fogadják el. A virtuális gépazonosítónak azonban minden esetben el kell térnie.</p></div></td></tr></tbody></table></div><div class=paragraph><p>A harmadik, <code>szolgaltato.minta.org</code> címmel rendelkezõ gépet fogjuk felkészíteni az elõbbi gépek meghibásodására felkészíteni. Ennek a gépnek két <span class=filename>carp</span> eszközre lesz szüksége, melyek az egyes gépeket kezelik. Az ehhez illeszkedõ sorok valahogy így fognak kinézni az <span class=filename>rc.conf</span> állományban:</p></div><div class="literalblock programlisting"><div class=content><pre>hostname=&#34;szolgaltato.minta.org&#34;
ifconfig_fxp0=&#34;inet 192.168.1.5 netmask 255.255.255.0&#34;
cloned_interfaces=&#34;carp0 carp1&#34;
ifconfig_carp0=&#34;vhid 1 advskew 100 pass testpass 192.168.1.50/24&#34;
ifconfig_carp1=&#34;vhid 2 advskew 100 pass testpass 192.168.1.51/24&#34;</pre></div></div><div class=paragraph><p>Két <span class=filename>carp</span> eszköz használatával a <code>szolgaltato.minta.org</code> képes észlelni és átvenni bármelyik olyan gép IP-címét, amely nem válaszol.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Az alap FreeBSD rendszermag használata esetén <em>elõfordulhat</em>, hogy a megszakítás (a "preemption" opció) engedélyezett. Amennyiben így lenne, a <code>szolgaltato.minta.org</code> nem fogja minden esetben fogja rendesen visszaadni az IP-címet az eredeti tulajdonosának. Ilyenkor a rendszergazdának kell ezt manuálisan megtennie. Tehát a következõ parancsot kell kiadnia a <code>szolgaltato.minta.org</code> gépen:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># ifconfig carp0 down &amp;&amp; ifconfig carp0 up</span></code></pre></div></div><div class=paragraph><p>Ezt az adott géphez tartozó <span class=filename>carp</span> felülettel kell megcsinálni.</p></div></td></tr></tbody></table></div><div class=paragraph><p>Innentõl a CARP már teljesen engedélyezhetõ és készen áll a tesztelésre. A teszteléshez vagy a hálózati rendszert kell újraindítani, vagy a gépeket.</p></div><div class=paragraph><p>További információkat a <a href="https://man.freebsd.org/cgi/man.cgi?query=carp&amp;sektion=4&amp;format=html">carp(4)</a> man oldalán találhatunk.</p></div></div></div></div></div><h1 id=appendices class=sect0>Part V: Függelék<a class=anchor href=#appendices></a></h1><div class=sect1><h2 id=mirrors>Függelék A: A FreeBSD beszerzése<a class=anchor href=#mirrors></a></h2><div class=sectionbody><div class=sect2><h3 id=mirrors-cdrom>A.1. CD és DVD kiadók<a class=anchor href=#mirrors-cdrom></a></h3><div class=sect3><h4 id=_kiskereskedelmi_dobozos_termékek>A.1.1. Kiskereskedelmi dobozos termékek<a class=anchor href=#_kiskereskedelmi_dobozos_termékek></a></h4><div class=paragraph><p>A FreeBSD beszerezhetõ számos kiskereskedõtõl dobozos termék formájában is (FreeBSD CD-k, egyéb szoftverek és nyomtatott dokumentáció):</p></div><div class=ulist><ul><li><p>CompUSA<br>WWW: <a href=http://www.compusa.com/ class=bare>http://www.compusa.com/</a></p></li><li><p>Frys Electronics<br>WWW: <a href=http://www.frys.com/ class=bare>http://www.frys.com/</a></p></li></ul></div></div><div class=sect3><h4 id=_cd_és_dvd_készletek>A.1.2. CD- és DVD-készletek<a class=anchor href=#_cd_és_dvd_készletek></a></h4><div class=paragraph><p>FreeBSD CD- és DVD-készletek rengeteg helyrõl rendelhetõek:</p></div><div class=ulist><ul><li><p>FreeBSD Mall, Inc.<br>700 Harvest Park Ste F<br>Brentwood, CA 94513<br>Egyesült Államok<br>Telefon: +1 925 240-6652<br>Fax: +1 925 674-0821<br>e-mail: &lt;<a href=mailto:info@freebsdmall.com>info@freebsdmall.com</a>><br>WWW: <a href=http://www.freebsdmall.com/ class=bare>http://www.freebsdmall.com/</a></p></li><li><p>Dr. Hinner EDV<br>St. Augustinus-Str. 10<br>D-81825 München<br>Németország<br>Telefon: (089) 428 419<br>WWW: <a href=http://www.hinner.de/linux/freebsd.html class=bare>http://www.hinner.de/linux/freebsd.html</a></p></li><li><p>Ikarios<br>22-24 rue Voltaire<br>92000 Nanterre<br>Franciaország<br>WWW: <a href=http://ikarios.com/form/#freebsd class=bare>http://ikarios.com/form/#freebsd</a></p></li><li><p>JMC Software<br>Írország<br>Telefon: 353 1 6291282<br>WWW: <a href=http://www.thelinuxmall.com class=bare>http://www.thelinuxmall.com</a></p></li><li><p>The Linux Emporium<br>Hilliard House, Lester Way<br>Wallingford<br>OX10 9TA<br>Egyesült Királyság<br>Telefon: +44 1491 837010<br>Fax: +44 1491 837016<br>WWW: <a href=http://www.linuxemporium.co.uk/products/bsd/ class=bare>http://www.linuxemporium.co.uk/products/bsd/</a></p></li><li><p>Linux+ DVD Magazine<br>Lewartowskiego 6<br>Warsaw<br>00-190<br>Lengyelország<br>Telefon: +48 22 860 18 18<br>e-mail: &lt;<a href=mailto:editors@lpmagazine.org>editors@lpmagazine.org</a>><br>WWW: <a href=http://www.lpmagazine.org/ class=bare>http://www.lpmagazine.org/</a></p></li><li><p>Linux System Labs Australia<br>21 Ray Drive<br>Balwyn North<br>VIC - 3104<br>Ausztrália<br>Telefon: +61 3 9857 5918<br>Fax: +61 3 9857 8974<br>WWW: <a href=http://www.lsl.com.au class=bare>http://www.lsl.com.au</a></p></li><li><p>LinuxCenter.Ru<br>Galernaya utca, 55<br>Szentpétervár<br>190000<br>Oroszország<br>Telefon: +7-812-3125208<br>e-mail: &lt;<a href=mailto:info@linuxcenter.ru>info@linuxcenter.ru</a>><br>WWW: <a href=http://linuxcenter.ru/shop/freebsd class=bare>http://linuxcenter.ru/shop/freebsd</a></p></li></ul></div></div><div class=sect3><h4 id=_terjesztõk>A.1.3. Terjesztõk<a class=anchor href=#_terjesztõk></a></h4><div class=paragraph><p>Ha viszonteladók vagyunk és szeretnénk CD-s FreeBSD termékeket forgalmazni, akkor az alábbi terjesztõk valamelyikével vegyük fel a kapcsolatot:</p></div><div class=ulist><ul><li><p>Cylogistics<br>809B Cuesta Dr., #2149<br>Mountain View, CA 94040<br>Egyesült Államok<br>Telefon: +1 650 694-4949<br>Fax: +1 650 694-4953<br>e-mail: &lt;<a href=mailto:sales@cylogistics.com>sales@cylogistics.com</a>><br>WWW: <a href=http://www.cylogistics.com/ class=bare>http://www.cylogistics.com/</a></p></li><li><p>Ingram Micro<br>1600 E. St. Andrew Place<br>Santa Ana, CA 92705-4926<br>Egyesült Államok<br>Telefon: 1 (800) 456-8000<br>WWW: <a href=http://www.ingrammicro.com/ class=bare>http://www.ingrammicro.com/</a></p></li><li><p>Kudzu, LLC<br>7375 Washington Ave. S.<br>Edina, MN 55439<br>Egyesült Államok<br>Telefon: +1 952 947-0822<br>Fax: +1 952 947-0876<br>e-mail: &lt;<a href=mailto:sales@kudzuenterprises.com>sales@kudzuenterprises.com</a>></p></li><li><p>LinuxCenter.Kz<br>Uszty-Kamenogorszk<br>Kazahsztán<br>Telefon: +7-705-501-6001<br>e-mail: &lt;<a href=mailto:info@linuxcenter.kz>info@linuxcenter.kz</a>><br>WWW: <a href="http://linuxcenter.kz/page.php?page=fr" class=bare>http://linuxcenter.kz/page.php?page=fr</a></p></li><li><p>LinuxCenter.Ru<br>Galernaya utca, 55<br>Szentpétervár<br>190000<br>Oroszország<br>Telefon: +7-812-3125208<br>e-mail: &lt;<a href=mailto:info@linuxcenter.ru>info@linuxcenter.ru</a>><br>WWW: <a href=http://linuxcenter.ru/freebsd class=bare>http://linuxcenter.ru/freebsd</a></p></li><li><p>Navarre Corp<br>7400 49th Ave South<br>New Hope, MN 55428<br>Egyesült Államok<br>Telefon: +1 763 535-8333<br>Fax: +1 763 535-0341<br>WWW: <a href=http://www.navarre.com/ class=bare>http://www.navarre.com/</a></p></li></ul></div></div></div><div class=sect2><h3 id=mirrors-ftp>A.2. FTP oldalak<a class=anchor href=#mirrors-ftp></a></h3><div class=paragraph><p>A FreeBSD hivatalos forrásai anonim FTP-n keresztül is elérhetõek különféle tükrözésekrõl. Az <a href=ftp://ftp.FreeBSD.org/pub/FreeBSD/>ftp://ftp.FreeBSD.org/pub/FreeBSD/</a> oldal ugyan jó minõségû kapcsolattal rendelkezik és rengeteg felhasználót is enged egyidejûleg kapcsolódni, azonban valószínûleg jobban járunk, ha egy "hozzánk közelebbi" tükrözést választunk (különösen abban az esetben, amikor mi magunk is egy tükrözést akarunk készíteni).</p></div><div class=paragraph><p>A <a href=http://mirrorlist.FreeBSD.org/>FreeBSD tükrözések adatbázisá</a>ban az itt megtalálhatónál sokkal pontosabb leltárt kaphatunk az elérhetõ tükrözésekrõl, mivel közvetlenül a névfeloldás segítségével állapítja meg a szükséges adatokat és nem egy rögzített listát tárol.</p></div><div class=paragraph><p>Emellett az alábbi tükrözésekrõl a FreeBSD elérhetõ anonim FTP-n keresztül is. Amennyiben az anonim FTP használata mellett döntenénk, igyekezzünk a hozzánk legközelebb levõ szervert használni. Az "Elsõdleges tükrözésekként" feltüntetett oldalak általában a teljes FreeBSD archívumot tartalmazzák (az összes jelenleg elérhetõ változatot az összes architektúrára), de a környékünkön vagy országunkban elhelyezkedõ tükörszerverekrõl többnyire gyorsabban tudunk majd letölteni. A regionális oldalakon gyakorta csak a népszerûbb architektúrákon futó népszerûbb változatokat találjuk meg, nem a teljes FreeBSD archívumot. Minden szerver elérhetõ anonim FTP-vel, de közülük néhány még további más módszereket is támogat. Az egyes oldalak által ismert konkrét módszereket a nevük után zárójelben közüljük.</p></div><div class=paragraph><p><a href=#central>Central Servers</a>, <a href=#primary>Primary Mirror Sites</a>, <a href=#armenia>Armenia</a>, <a href=#australia>Australia</a>, <a href=#austria>Austria</a>, <a href=#brazil>Brazil</a>, <a href=#czech-republic>Czech Republic</a>, <a href=#denmark>Denmark</a>, <a href=#estonia>Estonia</a>, <a href=#finland>Finland</a>, <a href=#france>France</a>, <a href=#germany>Germany</a>, <a href=#greece>Greece</a>, <a href=#hong-kong>Hong Kong</a>, <a href=#ireland>Ireland</a>, <a href=#japan>Japan</a>, <a href=#korea>Korea</a>, <a href=#latvia>Latvia</a>, <a href=#lithuania>Lithuania</a>, <a href=#netherlands>Netherlands</a>, <a href=#new-zealand>New Zealand</a>, <a href=#norway>Norway</a>, <a href=#poland>Poland</a>, <a href=#russia>Russia</a>, <a href=#saudi-arabia>Saudi Arabia</a>, <a href=#slovenia>Slovenia</a>, <a href=#south-africa>South Africa</a>, <a href=#spain>Spain</a>, <a href=#sweden>Sweden</a>, <a href=#switzerland>Switzerland</a>, <a href=#taiwan>Taiwan</a>, <a href=#ukraine>Ukraine</a>, <a href=#uk>United Kingdom</a>, <a href=#usa>United States of America</a>.</p></div><div class=paragraph><p>(as of UTC)</p></div><div id=central class=paragraph><p><strong>Central Servers</strong></p></div><div class=paragraph><p><a href=ftp://ftp.FreeBSD.org/pub/FreeBSD/ class=bare>ftp://ftp.FreeBSD.org/pub/FreeBSD/</a> (ftp / ftpv6 / <a href=http://ftp.FreeBSD.org/pub/FreeBSD/ class=bare>http://ftp.FreeBSD.org/pub/FreeBSD/</a> / <a href=http://ftp.FreeBSD.org/pub/FreeBSD/ class=bare>http://ftp.FreeBSD.org/pub/FreeBSD/</a>)</p></div><div id=primary class=paragraph><p><strong>Primary Mirror Sites</strong></p></div><div class=paragraph><p>In case of problems, please contact the hostmaster <code>&lt;<a href=mailto:mirror-admin@FreeBSD.org>mirror-admin@FreeBSD.org</a>></code> for this domain.</p></div><div class=ulist><ul><li><p><a href=ftp://ftp1.FreeBSD.org/pub/FreeBSD/ class=bare>ftp://ftp1.FreeBSD.org/pub/FreeBSD/</a> (ftp)</p></li><li><p><a href=ftp://ftp2.FreeBSD.org/pub/FreeBSD/ class=bare>ftp://ftp2.FreeBSD.org/pub/FreeBSD/</a> (ftp)</p></li><li><p><a href=ftp://ftp3.FreeBSD.org/pub/FreeBSD/ class=bare>ftp://ftp3.FreeBSD.org/pub/FreeBSD/</a> (ftp)</p></li><li><p><a href=ftp://ftp4.FreeBSD.org/pub/FreeBSD/ class=bare>ftp://ftp4.FreeBSD.org/pub/FreeBSD/</a> (ftp / ftpv6 / <a href=http://ftp4.FreeBSD.org/pub/FreeBSD/ class=bare>http://ftp4.FreeBSD.org/pub/FreeBSD/</a> / <a href=http://ftp4.FreeBSD.org/pub/FreeBSD/ class=bare>http://ftp4.FreeBSD.org/pub/FreeBSD/</a>)</p></li><li><p><a href=ftp://ftp5.FreeBSD.org/pub/FreeBSD/ class=bare>ftp://ftp5.FreeBSD.org/pub/FreeBSD/</a> (ftp)</p></li><li><p><a href=ftp://ftp6.FreeBSD.org/pub/FreeBSD/ class=bare>ftp://ftp6.FreeBSD.org/pub/FreeBSD/</a> (ftp)</p></li><li><p><a href=ftp://ftp7.FreeBSD.org/pub/FreeBSD/ class=bare>ftp://ftp7.FreeBSD.org/pub/FreeBSD/</a> (ftp)</p></li><li><p><a href=ftp://ftp10.FreeBSD.org/pub/FreeBSD/ class=bare>ftp://ftp10.FreeBSD.org/pub/FreeBSD/</a> (ftp / ftpv6 / <a href=http://ftp10.FreeBSD.org/pub/FreeBSD/ class=bare>http://ftp10.FreeBSD.org/pub/FreeBSD/</a> / <a href=http://ftp10.FreeBSD.org/pub/FreeBSD/ class=bare>http://ftp10.FreeBSD.org/pub/FreeBSD/</a>)</p></li><li><p><a href=ftp://ftp11.FreeBSD.org/pub/FreeBSD/ class=bare>ftp://ftp11.FreeBSD.org/pub/FreeBSD/</a> (ftp)</p></li><li><p><a href=ftp://ftp13.FreeBSD.org/pub/FreeBSD/ class=bare>ftp://ftp13.FreeBSD.org/pub/FreeBSD/</a> (ftp)</p></li><li><p><a href=ftp://ftp14.FreeBSD.org/pub/FreeBSD/ class=bare>ftp://ftp14.FreeBSD.org/pub/FreeBSD/</a> (ftp / <a href=http://ftp14.FreeBSD.org/pub/FreeBSD/ class=bare>http://ftp14.FreeBSD.org/pub/FreeBSD/</a>)</p></li></ul></div><div id=armenia class=paragraph><p><strong>Armenia</strong></p></div><div class=paragraph><p>In case of problems, please contact the hostmaster <code>&lt;<a href=mailto:hostmaster@am.FreeBSD.org>hostmaster@am.FreeBSD.org</a>></code> for this domain.</p></div><div class=ulist><ul><li><p><a href=ftp://ftp1.am.FreeBSD.org/pub/FreeBSD/ class=bare>ftp://ftp1.am.FreeBSD.org/pub/FreeBSD/</a> (ftp / <a href=http://ftp1.am.FreeBSD.org/pub/FreeBSD/ class=bare>http://ftp1.am.FreeBSD.org/pub/FreeBSD/</a> / rsync)</p></li></ul></div><div id=australia class=paragraph><p><strong>Australia</strong></p></div><div class=paragraph><p>In case of problems, please contact the hostmaster <code>&lt;<a href=mailto:hostmaster@au.FreeBSD.org>hostmaster@au.FreeBSD.org</a>></code> for this domain.</p></div><div class=ulist><ul><li><p><a href=ftp://ftp.au.FreeBSD.org/pub/FreeBSD/ class=bare>ftp://ftp.au.FreeBSD.org/pub/FreeBSD/</a> (ftp)</p></li><li><p><a href=ftp://ftp2.au.FreeBSD.org/pub/FreeBSD/ class=bare>ftp://ftp2.au.FreeBSD.org/pub/FreeBSD/</a> (ftp)</p></li><li><p><a href=ftp://ftp3.au.FreeBSD.org/pub/FreeBSD/ class=bare>ftp://ftp3.au.FreeBSD.org/pub/FreeBSD/</a> (ftp)</p></li></ul></div><div id=austria class=paragraph><p><strong>Austria</strong></p></div><div class=paragraph><p>In case of problems, please contact the hostmaster <code>&lt;<a href=mailto:hostmaster@at.FreeBSD.org>hostmaster@at.FreeBSD.org</a>></code> for this domain.</p></div><div class=ulist><ul><li><p><a href=ftp://ftp.at.FreeBSD.org/pub/FreeBSD/ class=bare>ftp://ftp.at.FreeBSD.org/pub/FreeBSD/</a> (ftp / ftpv6 / <a href=http://ftp.at.FreeBSD.org/pub/FreeBSD/ class=bare>http://ftp.at.FreeBSD.org/pub/FreeBSD/</a> / <a href=http://ftp.at.FreeBSD.org/pub/FreeBSD/ class=bare>http://ftp.at.FreeBSD.org/pub/FreeBSD/</a>)</p></li></ul></div><div id=brazil class=paragraph><p><strong>Brazil</strong></p></div><div class=paragraph><p>In case of problems, please contact the hostmaster <code>&lt;<a href=mailto:hostmaster@br.FreeBSD.org>hostmaster@br.FreeBSD.org</a>></code> for this domain.</p></div><div class=ulist><ul><li><p><a href=ftp://ftp2.br.FreeBSD.org/FreeBSD/ class=bare>ftp://ftp2.br.FreeBSD.org/FreeBSD/</a> (ftp / <a href=http://ftp2.br.FreeBSD.org/ class=bare>http://ftp2.br.FreeBSD.org/</a>)</p></li><li><p><a href=ftp://ftp3.br.FreeBSD.org/pub/FreeBSD/ class=bare>ftp://ftp3.br.FreeBSD.org/pub/FreeBSD/</a> (ftp / rsync)</p></li><li><p><a href=ftp://ftp4.br.FreeBSD.org/pub/FreeBSD/ class=bare>ftp://ftp4.br.FreeBSD.org/pub/FreeBSD/</a> (ftp)</p></li></ul></div><div id=czech-republic class=paragraph><p><strong>Czech Republic</strong></p></div><div class=paragraph><p>In case of problems, please contact the hostmaster <code>&lt;<a href=mailto:hostmaster@cz.FreeBSD.org>hostmaster@cz.FreeBSD.org</a>></code> for this domain.</p></div><div class=ulist><ul><li><p><a href=ftp://ftp.cz.FreeBSD.org/pub/FreeBSD/ class=bare>ftp://ftp.cz.FreeBSD.org/pub/FreeBSD/</a> (ftp / <a href=ftp://ftp.cz.FreeBSD.org/pub/FreeBSD/ class=bare>ftp://ftp.cz.FreeBSD.org/pub/FreeBSD/</a> / <a href=http://ftp.cz.FreeBSD.org/pub/FreeBSD/ class=bare>http://ftp.cz.FreeBSD.org/pub/FreeBSD/</a> / <a href=http://ftp.cz.FreeBSD.org/pub/FreeBSD/ class=bare>http://ftp.cz.FreeBSD.org/pub/FreeBSD/</a> / rsync / rsyncv6)</p></li><li><p><a href=ftp://ftp2.cz.FreeBSD.org/pub/FreeBSD/ class=bare>ftp://ftp2.cz.FreeBSD.org/pub/FreeBSD/</a> (ftp / <a href=http://ftp2.cz.FreeBSD.org/pub/FreeBSD/ class=bare>http://ftp2.cz.FreeBSD.org/pub/FreeBSD/</a>)</p></li></ul></div><div id=denmark class=paragraph><p><strong>Denmark</strong></p></div><div class=paragraph><p>In case of problems, please contact the hostmaster <code>&lt;<a href=mailto:staff@dotsrc.org>staff@dotsrc.org</a>></code> for this domain.</p></div><div class=ulist><ul><li><p><a href=ftp://ftp.dk.FreeBSD.org/pub/FreeBSD/ class=bare>ftp://ftp.dk.FreeBSD.org/pub/FreeBSD/</a> (ftp / ftpv6 / <a href=http://ftp.dk.FreeBSD.org/pub/FreeBSD/ class=bare>http://ftp.dk.FreeBSD.org/pub/FreeBSD/</a> / <a href=http://ftp.dk.FreeBSD.org/pub/FreeBSD/ class=bare>http://ftp.dk.FreeBSD.org/pub/FreeBSD/</a>)</p></li></ul></div><div id=estonia class=paragraph><p><strong>Estonia</strong></p></div><div class=paragraph><p>In case of problems, please contact the hostmaster <code>&lt;<a href=mailto:hostmaster@ee.FreeBSD.org>hostmaster@ee.FreeBSD.org</a>></code> for this domain.</p></div><div class=ulist><ul><li><p><a href=ftp://ftp.ee.FreeBSD.org/pub/FreeBSD/ class=bare>ftp://ftp.ee.FreeBSD.org/pub/FreeBSD/</a> (ftp)</p></li></ul></div><div id=finland class=paragraph><p><strong>Finland</strong></p></div><div class=paragraph><p>In case of problems, please contact the hostmaster <code>&lt;<a href=mailto:hostmaster@fi.FreeBSD.org>hostmaster@fi.FreeBSD.org</a>></code> for this domain.</p></div><div class=ulist><ul><li><p><a href=ftp://ftp.fi.FreeBSD.org/pub/FreeBSD/ class=bare>ftp://ftp.fi.FreeBSD.org/pub/FreeBSD/</a> (ftp)</p></li></ul></div><div id=france class=paragraph><p><strong>France</strong></p></div><div class=paragraph><p>In case of problems, please contact the hostmaster <code>&lt;<a href=mailto:hostmaster@fr.FreeBSD.org>hostmaster@fr.FreeBSD.org</a>></code> for this domain.</p></div><div class=ulist><ul><li><p><a href=ftp://ftp.fr.FreeBSD.org/pub/FreeBSD/ class=bare>ftp://ftp.fr.FreeBSD.org/pub/FreeBSD/</a> (ftp)</p></li><li><p><a href=ftp://ftp1.fr.FreeBSD.org/pub/FreeBSD/ class=bare>ftp://ftp1.fr.FreeBSD.org/pub/FreeBSD/</a> (ftp / <a href=http://ftp1.fr.FreeBSD.org/pub/FreeBSD/ class=bare>http://ftp1.fr.FreeBSD.org/pub/FreeBSD/</a> / rsync)</p></li><li><p><a href=ftp://ftp3.fr.FreeBSD.org/pub/FreeBSD/ class=bare>ftp://ftp3.fr.FreeBSD.org/pub/FreeBSD/</a> (ftp)</p></li><li><p><a href=ftp://ftp6.fr.FreeBSD.org/pub/FreeBSD/ class=bare>ftp://ftp6.fr.FreeBSD.org/pub/FreeBSD/</a> (ftp)</p></li><li><p><a href=ftp://ftp6.fr.FreeBSD.org/pub/FreeBSD/ class=bare>ftp://ftp6.fr.FreeBSD.org/pub/FreeBSD/</a> (ftp / rsync)</p></li><li><p><a href=ftp://ftp7.fr.FreeBSD.org/pub/FreeBSD/ class=bare>ftp://ftp7.fr.FreeBSD.org/pub/FreeBSD/</a> (ftp)</p></li><li><p><a href=ftp://ftp8.fr.FreeBSD.org/pub/FreeBSD/ class=bare>ftp://ftp8.fr.FreeBSD.org/pub/FreeBSD/</a> (ftp)</p></li></ul></div><div id=germany class=paragraph><p><strong>Germany</strong></p></div><div class=paragraph><p>In case of problems, please contact the hostmaster <code>&lt;<a href=mailto:de-bsd-hubs@de.FreeBSD.org>de-bsd-hubs@de.FreeBSD.org</a>></code> for this domain.</p></div><div class=ulist><ul><li><p><a href=ftp://ftp.de.FreeBSD.org/pub/FreeBSD/ class=bare>ftp://ftp.de.FreeBSD.org/pub/FreeBSD/</a> (ftp)</p></li><li><p><a href=ftp://ftp1.de.FreeBSD.org/freebsd/ class=bare>ftp://ftp1.de.FreeBSD.org/freebsd/</a> (ftp / <a href=http://www1.de.FreeBSD.org/freebsd/ class=bare>http://www1.de.FreeBSD.org/freebsd/</a> / rsync://rsync3.de.FreeBSD.org/freebsd/)</p></li><li><p><a href=ftp://ftp2.de.FreeBSD.org/pub/FreeBSD/ class=bare>ftp://ftp2.de.FreeBSD.org/pub/FreeBSD/</a> (ftp / <a href=http://ftp2.de.FreeBSD.org/pub/FreeBSD/ class=bare>http://ftp2.de.FreeBSD.org/pub/FreeBSD/</a> / rsync)</p></li><li><p><a href=ftp://ftp4.de.FreeBSD.org/FreeBSD/ class=bare>ftp://ftp4.de.FreeBSD.org/FreeBSD/</a> (ftp / <a href=http://ftp4.de.FreeBSD.org/pub/FreeBSD/ class=bare>http://ftp4.de.FreeBSD.org/pub/FreeBSD/</a>)</p></li><li><p><a href=ftp://ftp5.de.FreeBSD.org/pub/FreeBSD/ class=bare>ftp://ftp5.de.FreeBSD.org/pub/FreeBSD/</a> (ftp)</p></li><li><p><a href=ftp://ftp7.de.FreeBSD.org/pub/FreeBSD/ class=bare>ftp://ftp7.de.FreeBSD.org/pub/FreeBSD/</a> (ftp / <a href=http://ftp7.de.FreeBSD.org/pub/FreeBSD/ class=bare>http://ftp7.de.FreeBSD.org/pub/FreeBSD/</a>)</p></li></ul></div><div id=greece class=paragraph><p><strong>Greece</strong></p></div><div class=paragraph><p>In case of problems, please contact the hostmaster <code>&lt;<a href=mailto:hostmaster@gr.FreeBSD.org>hostmaster@gr.FreeBSD.org</a>></code> for this domain.</p></div><div class=ulist><ul><li><p><a href=ftp://ftp.gr.FreeBSD.org/pub/FreeBSD/ class=bare>ftp://ftp.gr.FreeBSD.org/pub/FreeBSD/</a> (ftp)</p></li><li><p><a href=ftp://ftp2.gr.FreeBSD.org/pub/FreeBSD/ class=bare>ftp://ftp2.gr.FreeBSD.org/pub/FreeBSD/</a> (ftp)</p></li></ul></div><div id=hong-kong class=paragraph><p><strong>Hong Kong</strong></p></div><div class=paragraph><p><a href=ftp://ftp.hk.FreeBSD.org/pub/FreeBSD/ class=bare>ftp://ftp.hk.FreeBSD.org/pub/FreeBSD/</a> (ftp)</p></div><div id=ireland class=paragraph><p><strong>Ireland</strong></p></div><div class=paragraph><p>In case of problems, please contact the hostmaster <code>&lt;<a href=mailto:hostmaster@ie.FreeBSD.org>hostmaster@ie.FreeBSD.org</a>></code> for this domain.</p></div><div class=ulist><ul><li><p><a href=ftp://ftp3.ie.FreeBSD.org/pub/FreeBSD/ class=bare>ftp://ftp3.ie.FreeBSD.org/pub/FreeBSD/</a> (ftp / rsync)</p></li></ul></div><div id=japan class=paragraph><p><strong>Japan</strong></p></div><div class=paragraph><p>In case of problems, please contact the hostmaster <code>&lt;<a href=mailto:hostmaster@jp.FreeBSD.org>hostmaster@jp.FreeBSD.org</a>></code> for this domain.</p></div><div class=ulist><ul><li><p><a href=ftp://ftp.jp.FreeBSD.org/pub/FreeBSD/ class=bare>ftp://ftp.jp.FreeBSD.org/pub/FreeBSD/</a> (ftp)</p></li><li><p><a href=ftp://ftp2.jp.FreeBSD.org/pub/FreeBSD/ class=bare>ftp://ftp2.jp.FreeBSD.org/pub/FreeBSD/</a> (ftp)</p></li><li><p><a href=ftp://ftp3.jp.FreeBSD.org/pub/FreeBSD/ class=bare>ftp://ftp3.jp.FreeBSD.org/pub/FreeBSD/</a> (ftp)</p></li><li><p><a href=ftp://ftp4.jp.FreeBSD.org/pub/FreeBSD/ class=bare>ftp://ftp4.jp.FreeBSD.org/pub/FreeBSD/</a> (ftp)</p></li><li><p><a href=ftp://ftp5.jp.FreeBSD.org/pub/FreeBSD/ class=bare>ftp://ftp5.jp.FreeBSD.org/pub/FreeBSD/</a> (ftp)</p></li><li><p><a href=ftp://ftp6.jp.FreeBSD.org/pub/FreeBSD/ class=bare>ftp://ftp6.jp.FreeBSD.org/pub/FreeBSD/</a> (ftp)</p></li><li><p><a href=ftp://ftp7.jp.FreeBSD.org/pub/FreeBSD/ class=bare>ftp://ftp7.jp.FreeBSD.org/pub/FreeBSD/</a> (ftp)</p></li><li><p><a href=ftp://ftp8.jp.FreeBSD.org/pub/FreeBSD/ class=bare>ftp://ftp8.jp.FreeBSD.org/pub/FreeBSD/</a> (ftp)</p></li><li><p><a href=ftp://ftp9.jp.FreeBSD.org/pub/FreeBSD/ class=bare>ftp://ftp9.jp.FreeBSD.org/pub/FreeBSD/</a> (ftp)</p></li></ul></div><div id=korea class=paragraph><p><strong>Korea</strong></p></div><div class=paragraph><p>In case of problems, please contact the hostmaster <code>&lt;<a href=mailto:hostmaster@kr.FreeBSD.org>hostmaster@kr.FreeBSD.org</a>></code> for this domain.</p></div><div class=ulist><ul><li><p><a href=ftp://ftp.kr.FreeBSD.org/pub/FreeBSD/ class=bare>ftp://ftp.kr.FreeBSD.org/pub/FreeBSD/</a> (ftp / rsync)</p></li><li><p><a href=ftp://ftp2.kr.FreeBSD.org/pub/FreeBSD/ class=bare>ftp://ftp2.kr.FreeBSD.org/pub/FreeBSD/</a> (ftp / <a href=http://ftp2.kr.FreeBSD.org/pub/FreeBSD/ class=bare>http://ftp2.kr.FreeBSD.org/pub/FreeBSD/</a>)</p></li></ul></div><div id=latvia class=paragraph><p><strong>Latvia</strong></p></div><div class=paragraph><p>In case of problems, please contact the hostmaster <code>&lt;<a href=mailto:hostmaster@lv.FreeBSD.org>hostmaster@lv.FreeBSD.org</a>></code> for this domain.</p></div><div class=ulist><ul><li><p><a href=ftp://ftp.lv.FreeBSD.org/pub/FreeBSD/ class=bare>ftp://ftp.lv.FreeBSD.org/pub/FreeBSD/</a> (ftp / <a href=http://ftp.lv.FreeBSD.org/pub/FreeBSD/ class=bare>http://ftp.lv.FreeBSD.org/pub/FreeBSD/</a>)</p></li></ul></div><div id=lithuania class=paragraph><p><strong>Lithuania</strong></p></div><div class=paragraph><p>In case of problems, please contact the hostmaster <code>&lt;<a href=mailto:hostmaster@lt.FreeBSD.org>hostmaster@lt.FreeBSD.org</a>></code> for this domain.</p></div><div class=ulist><ul><li><p><a href=ftp://ftp.lt.FreeBSD.org/pub/FreeBSD/ class=bare>ftp://ftp.lt.FreeBSD.org/pub/FreeBSD/</a> (ftp / <a href=http://ftp.lt.FreeBSD.org/pub/FreeBSD/ class=bare>http://ftp.lt.FreeBSD.org/pub/FreeBSD/</a>)</p></li></ul></div><div id=netherlands class=paragraph><p><strong>Netherlands</strong></p></div><div class=paragraph><p>In case of problems, please contact the hostmaster <code>&lt;<a href=mailto:hostmaster@nl.FreeBSD.org>hostmaster@nl.FreeBSD.org</a>></code> for this domain.</p></div><div class=ulist><ul><li><p><a href=ftp://ftp.nl.FreeBSD.org/pub/FreeBSD/ class=bare>ftp://ftp.nl.FreeBSD.org/pub/FreeBSD/</a> (ftp / <a href=http://ftp.nl.FreeBSD.org/os/FreeBSD/ class=bare>http://ftp.nl.FreeBSD.org/os/FreeBSD/</a> / rsync)</p></li><li><p><a href=ftp://ftp2.nl.FreeBSD.org/pub/FreeBSD/ class=bare>ftp://ftp2.nl.FreeBSD.org/pub/FreeBSD/</a> (ftp)</p></li></ul></div><div id=new-zealand class=paragraph><p><strong>New Zealand</strong></p></div><div class=ulist><ul><li><p><a href=ftp://ftp.nz.FreeBSD.org/pub/FreeBSD/ class=bare>ftp://ftp.nz.FreeBSD.org/pub/FreeBSD/</a> (ftp / <a href=http://ftp.nz.FreeBSD.org/pub/FreeBSD/ class=bare>http://ftp.nz.FreeBSD.org/pub/FreeBSD/</a>)</p></li></ul></div><div id=norway class=paragraph><p><strong>Norway</strong></p></div><div class=paragraph><p>In case of problems, please contact the hostmaster <code>&lt;<a href=mailto:hostmaster@no.FreeBSD.org>hostmaster@no.FreeBSD.org</a>></code> for this domain.</p></div><div class=ulist><ul><li><p><a href=ftp://ftp.no.FreeBSD.org/pub/FreeBSD/ class=bare>ftp://ftp.no.FreeBSD.org/pub/FreeBSD/</a> (ftp / rsync)</p></li></ul></div><div id=poland class=paragraph><p><strong>Poland</strong></p></div><div class=paragraph><p>In case of problems, please contact the hostmaster <code>&lt;<a href=mailto:hostmaster@pl.FreeBSD.org>hostmaster@pl.FreeBSD.org</a>></code> for this domain.</p></div><div class=ulist><ul><li><p><a href=ftp://ftp.pl.FreeBSD.org/pub/FreeBSD/ class=bare>ftp://ftp.pl.FreeBSD.org/pub/FreeBSD/</a> (ftp)</p></li><li><p>ftp2.pl.FreeBSD.org</p></li></ul></div><div id=russia class=paragraph><p><strong>Russia</strong></p></div><div class=paragraph><p>In case of problems, please contact the hostmaster <code>&lt;<a href=mailto:hostmaster@ru.FreeBSD.org>hostmaster@ru.FreeBSD.org</a>></code> for this domain.</p></div><div class=ulist><ul><li><p><a href=ftp://ftp.ru.FreeBSD.org/pub/FreeBSD/ class=bare>ftp://ftp.ru.FreeBSD.org/pub/FreeBSD/</a> (ftp / <a href=http://ftp.ru.FreeBSD.org/FreeBSD/ class=bare>http://ftp.ru.FreeBSD.org/FreeBSD/</a> / rsync)</p></li><li><p><a href=ftp://ftp2.ru.FreeBSD.org/pub/FreeBSD/ class=bare>ftp://ftp2.ru.FreeBSD.org/pub/FreeBSD/</a> (ftp / <a href=http://ftp2.ru.FreeBSD.org/pub/FreeBSD/ class=bare>http://ftp2.ru.FreeBSD.org/pub/FreeBSD/</a> / rsync)</p></li><li><p><a href=ftp://ftp5.ru.FreeBSD.org/pub/FreeBSD/ class=bare>ftp://ftp5.ru.FreeBSD.org/pub/FreeBSD/</a> (ftp / <a href=http://ftp5.ru.FreeBSD.org/pub/FreeBSD/ class=bare>http://ftp5.ru.FreeBSD.org/pub/FreeBSD/</a> / rsync)</p></li><li><p><a href=ftp://ftp6.ru.FreeBSD.org/pub/FreeBSD/ class=bare>ftp://ftp6.ru.FreeBSD.org/pub/FreeBSD/</a> (ftp)</p></li></ul></div><div id=saudi-arabia class=paragraph><p><strong>Saudi Arabia</strong></p></div><div class=paragraph><p>In case of problems, please contact the hostmaster <code>&lt;<a href=mailto:ftpadmin@isu.net.sa>ftpadmin@isu.net.sa</a>></code> for this domain.</p></div><div class=ulist><ul><li><p><a href=ftp://ftp.isu.net.sa/pub/ftp.freebsd.org class=bare>ftp://ftp.isu.net.sa/pub/ftp.freebsd.org</a> (ftp)</p></li></ul></div><div id=slovenia class=paragraph><p><strong>Slovenia</strong></p></div><div class=paragraph><p>In case of problems, please contact the hostmaster <code>&lt;<a href=mailto:hostmaster@si.FreeBSD.org>hostmaster@si.FreeBSD.org</a>></code> for this domain.</p></div><div class=ulist><ul><li><p><a href=ftp://ftp.si.FreeBSD.org/pub/FreeBSD/ class=bare>ftp://ftp.si.FreeBSD.org/pub/FreeBSD/</a> (ftp)</p></li></ul></div><div id=south-africa class=paragraph><p><strong>South Africa</strong></p></div><div class=paragraph><p>In case of problems, please contact the hostmaster <code>&lt;<a href=mailto:hostmaster@za.FreeBSD.org>hostmaster@za.FreeBSD.org</a>></code> for this domain.</p></div><div class=ulist><ul><li><p><a href=ftp://ftp.za.FreeBSD.org/pub/FreeBSD/ class=bare>ftp://ftp.za.FreeBSD.org/pub/FreeBSD/</a> (ftp)</p></li><li><p><a href=ftp://ftp2.za.FreeBSD.org/pub/FreeBSD/ class=bare>ftp://ftp2.za.FreeBSD.org/pub/FreeBSD/</a> (ftp)</p></li><li><p><a href=ftp://ftp4.za.FreeBSD.org/pub/FreeBSD/ class=bare>ftp://ftp4.za.FreeBSD.org/pub/FreeBSD/</a> (ftp)</p></li></ul></div><div id=spain class=paragraph><p><strong>Spain</strong></p></div><div class=paragraph><p>In case of problems, please contact the hostmaster <code>&lt;<a href=mailto:hostmaster@es.FreeBSD.org>hostmaster@es.FreeBSD.org</a>></code> for this domain.</p></div><div class=ulist><ul><li><p><a href=ftp://ftp.es.FreeBSD.org/pub/FreeBSD/ class=bare>ftp://ftp.es.FreeBSD.org/pub/FreeBSD/</a> (ftp / <a href=http://ftp.es.FreeBSD.org/pub/FreeBSD/ class=bare>http://ftp.es.FreeBSD.org/pub/FreeBSD/</a>)</p></li><li><p><a href=ftp://ftp3.es.FreeBSD.org/pub/FreeBSD/ class=bare>ftp://ftp3.es.FreeBSD.org/pub/FreeBSD/</a> (ftp)</p></li></ul></div><div id=sweden class=paragraph><p><strong>Sweden</strong></p></div><div class=paragraph><p>In case of problems, please contact the hostmaster <code>&lt;<a href=mailto:hostmaster@se.FreeBSD.org>hostmaster@se.FreeBSD.org</a>></code> for this domain.</p></div><div class=ulist><ul><li><p><a href=ftp://ftp.se.FreeBSD.org/pub/FreeBSD/ class=bare>ftp://ftp.se.FreeBSD.org/pub/FreeBSD/</a> (ftp)</p></li><li><p><a href=ftp://ftp2.se.FreeBSD.org/pub/FreeBSD/ class=bare>ftp://ftp2.se.FreeBSD.org/pub/FreeBSD/</a> (ftp / rsync://ftp2.se.FreeBSD.org/)</p></li><li><p><a href=ftp://ftp3.se.FreeBSD.org/pub/FreeBSD/ class=bare>ftp://ftp3.se.FreeBSD.org/pub/FreeBSD/</a> (ftp)</p></li><li><p><a href=ftp://ftp4.se.FreeBSD.org/pub/FreeBSD/ class=bare>ftp://ftp4.se.FreeBSD.org/pub/FreeBSD/</a> (ftp / <a href=ftp://ftp4.se.FreeBSD.org/pub/FreeBSD/ class=bare>ftp://ftp4.se.FreeBSD.org/pub/FreeBSD/</a> / <a href=http://ftp4.se.FreeBSD.org/pub/FreeBSD/ class=bare>http://ftp4.se.FreeBSD.org/pub/FreeBSD/</a> / <a href=http://ftp4.se.FreeBSD.org/pub/FreeBSD/ class=bare>http://ftp4.se.FreeBSD.org/pub/FreeBSD/</a> / rsync://ftp4.se.FreeBSD.org/pub/FreeBSD/ / rsync://ftp4.se.FreeBSD.org/pub/FreeBSD/)</p></li><li><p><a href=ftp://ftp6.se.FreeBSD.org/pub/FreeBSD/ class=bare>ftp://ftp6.se.FreeBSD.org/pub/FreeBSD/</a> (ftp / <a href=http://ftp6.se.FreeBSD.org/pub/FreeBSD/ class=bare>http://ftp6.se.FreeBSD.org/pub/FreeBSD/</a>)</p></li></ul></div><div id=switzerland class=paragraph><p><strong>Switzerland</strong></p></div><div class=paragraph><p>In case of problems, please contact the hostmaster <code>&lt;<a href=mailto:hostmaster@ch.FreeBSD.org>hostmaster@ch.FreeBSD.org</a>></code> for this domain.</p></div><div class=ulist><ul><li><p><a href=ftp://ftp.ch.FreeBSD.org/pub/FreeBSD/ class=bare>ftp://ftp.ch.FreeBSD.org/pub/FreeBSD/</a> (ftp / <a href=http://ftp.ch.FreeBSD.org/pub/FreeBSD/ class=bare>http://ftp.ch.FreeBSD.org/pub/FreeBSD/</a>)</p></li></ul></div><div id=taiwan class=paragraph><p><strong>Taiwan</strong></p></div><div class=paragraph><p>In case of problems, please contact the hostmaster <code>&lt;<a href=mailto:hostmaster@tw.FreeBSD.org>hostmaster@tw.FreeBSD.org</a>></code> for this domain.</p></div><div class=ulist><ul><li><p><a href=ftp://ftp.ch.FreeBSD.org/pub/FreeBSD/ class=bare>ftp://ftp.ch.FreeBSD.org/pub/FreeBSD/</a> (ftp / <a href=ftp://ftp.tw.FreeBSD.org/pub/FreeBSD/ class=bare>ftp://ftp.tw.FreeBSD.org/pub/FreeBSD/</a> / rsync / rsyncv6)</p></li><li><p><a href=ftp://ftp2.tw.FreeBSD.org/pub/FreeBSD/ class=bare>ftp://ftp2.tw.FreeBSD.org/pub/FreeBSD/</a> (ftp / <a href=ftp://ftp2.tw.FreeBSD.org/pub/FreeBSD/ class=bare>ftp://ftp2.tw.FreeBSD.org/pub/FreeBSD/</a> / <a href=http://ftp2.tw.FreeBSD.org/pub/FreeBSD/ class=bare>http://ftp2.tw.FreeBSD.org/pub/FreeBSD/</a> / <a href=http://ftp2.tw.FreeBSD.org/pub/FreeBSD/ class=bare>http://ftp2.tw.FreeBSD.org/pub/FreeBSD/</a> / rsync / rsyncv6)</p></li><li><p><a href=ftp://ftp4.tw.FreeBSD.org/pub/FreeBSD/ class=bare>ftp://ftp4.tw.FreeBSD.org/pub/FreeBSD/</a> (ftp)</p></li><li><p><a href=ftp://ftp5.tw.FreeBSD.org/pub/FreeBSD/ class=bare>ftp://ftp5.tw.FreeBSD.org/pub/FreeBSD/</a> (ftp)</p></li><li><p><a href=ftp://ftp6.tw.FreeBSD.org/pub/FreeBSD/ class=bare>ftp://ftp6.tw.FreeBSD.org/pub/FreeBSD/</a> (ftp / <a href=http://ftp6.tw.FreeBSD.org/ class=bare>http://ftp6.tw.FreeBSD.org/</a> / rsync)</p></li><li><p><a href=ftp://ftp7.tw.FreeBSD.org/pub/FreeBSD/ class=bare>ftp://ftp7.tw.FreeBSD.org/pub/FreeBSD/</a> (ftp)</p></li><li><p><a href=ftp://ftp8.tw.FreeBSD.org/pub/FreeBSD/ class=bare>ftp://ftp8.tw.FreeBSD.org/pub/FreeBSD/</a> (ftp)</p></li><li><p><a href=ftp://ftp11.tw.FreeBSD.org/pub/FreeBSD/ class=bare>ftp://ftp11.tw.FreeBSD.org/pub/FreeBSD/</a> (ftp / <a href=http://ftp11.tw.FreeBSD.org/FreeBSD/ class=bare>http://ftp11.tw.FreeBSD.org/FreeBSD/</a>)</p></li><li><p><a href=ftp://ftp12.tw.FreeBSD.org/pub/FreeBSD/ class=bare>ftp://ftp12.tw.FreeBSD.org/pub/FreeBSD/</a> (ftp)</p></li><li><p><a href=ftp://ftp13.tw.FreeBSD.org/pub/FreeBSD/ class=bare>ftp://ftp13.tw.FreeBSD.org/pub/FreeBSD/</a> (ftp)</p></li><li><p><a href=ftp://ftp14.tw.FreeBSD.org/pub/FreeBSD/ class=bare>ftp://ftp14.tw.FreeBSD.org/pub/FreeBSD/</a> (ftp)</p></li><li><p><a href=ftp://ftp15.tw.FreeBSD.org/pub/FreeBSD/ class=bare>ftp://ftp15.tw.FreeBSD.org/pub/FreeBSD/</a> (ftp)</p></li></ul></div><div id=ukraine class=paragraph><p><strong>Ukraine</strong></p></div><div class=ulist><ul><li><p><a href=ftp://ftp.ua.FreeBSD.org/pub/FreeBSD/ class=bare>ftp://ftp.ua.FreeBSD.org/pub/FreeBSD/</a> (ftp / <a href=http://ftp.ua.FreeBSD.org/pub/FreeBSD/ class=bare>http://ftp.ua.FreeBSD.org/pub/FreeBSD/</a>)</p></li><li><p><a href=ftp://ftp6.ua.FreeBSD.org/pub/FreeBSD/ class=bare>ftp://ftp6.ua.FreeBSD.org/pub/FreeBSD/</a> (ftp / <a href=http://ftp6.ua.FreeBSD.org/pub/FreeBSD class=bare>http://ftp6.ua.FreeBSD.org/pub/FreeBSD</a> / rsync://ftp6.ua.FreeBSD.org/FreeBSD/)</p></li><li><p><a href=ftp://ftp7.ua.FreeBSD.org/pub/FreeBSD/ class=bare>ftp://ftp7.ua.FreeBSD.org/pub/FreeBSD/</a> (ftp)</p></li></ul></div><div id=uk class=paragraph><p><strong>United Kingdom</strong></p></div><div class=paragraph><p>In case of problems, please contact the hostmaster <code>&lt;<a href=mailto:hostmaster@uk.FreeBSD.org>hostmaster@uk.FreeBSD.org</a>></code> for this domain.</p></div><div class=ulist><ul><li><p><a href=ftp://ftp.uk.FreeBSD.org/pub/FreeBSD/ class=bare>ftp://ftp.uk.FreeBSD.org/pub/FreeBSD/</a> (ftp)</p></li><li><p><a href=ftp://ftp2.uk.FreeBSD.org/pub/FreeBSD/ class=bare>ftp://ftp2.uk.FreeBSD.org/pub/FreeBSD/</a> (ftp / rsync://ftp2.uk.FreeBSD.org/ftp.freebsd.org/pub/FreeBSD/)</p></li><li><p><a href=ftp://ftp3.uk.FreeBSD.org/pub/FreeBSD/ class=bare>ftp://ftp3.uk.FreeBSD.org/pub/FreeBSD/</a> (ftp)</p></li><li><p><a href=ftp://ftp4.uk.FreeBSD.org/pub/FreeBSD/ class=bare>ftp://ftp4.uk.FreeBSD.org/pub/FreeBSD/</a> (ftp)</p></li><li><p><a href=ftp://ftp5.uk.FreeBSD.org/pub/FreeBSD/ class=bare>ftp://ftp5.uk.FreeBSD.org/pub/FreeBSD/</a> (ftp)</p></li></ul></div><div id=usa class=paragraph><p><strong>United States of America</strong></p></div><div class=paragraph><p>In case of problems, please contact the hostmaster <code>&lt;<a href=mailto:hostmaster@us.FreeBSD.org>hostmaster@us.FreeBSD.org</a>></code> for this domain.</p></div><div class=ulist><ul><li><p><a href=ftp://ftp1.us.FreeBSD.org/pub/FreeBSD/ class=bare>ftp://ftp1.us.FreeBSD.org/pub/FreeBSD/</a> (ftp)</p></li><li><p><a href=ftp://ftp2.us.FreeBSD.org/pub/FreeBSD/ class=bare>ftp://ftp2.us.FreeBSD.org/pub/FreeBSD/</a> (ftp)</p></li><li><p><a href=ftp://ftp3.us.FreeBSD.org/pub/FreeBSD/ class=bare>ftp://ftp3.us.FreeBSD.org/pub/FreeBSD/</a> (ftp)</p></li><li><p><a href=ftp://ftp4.us.FreeBSD.org/pub/FreeBSD/ class=bare>ftp://ftp4.us.FreeBSD.org/pub/FreeBSD/</a> (ftp / ftpv6 / <a href=http://ftp4.us.FreeBSD.org/pub/FreeBSD/ class=bare>http://ftp4.us.FreeBSD.org/pub/FreeBSD/</a> / <a href=http://ftp4.us.FreeBSD.org/pub/FreeBSD/ class=bare>http://ftp4.us.FreeBSD.org/pub/FreeBSD/</a>)</p></li><li><p><a href=ftp://ftp5.us.FreeBSD.org/pub/FreeBSD/ class=bare>ftp://ftp5.us.FreeBSD.org/pub/FreeBSD/</a> (ftp)</p></li><li><p><a href=ftp://ftp6.us.FreeBSD.org/pub/FreeBSD/ class=bare>ftp://ftp6.us.FreeBSD.org/pub/FreeBSD/</a> (ftp)</p></li><li><p><a href=ftp://ftp8.us.FreeBSD.org/pub/FreeBSD/ class=bare>ftp://ftp8.us.FreeBSD.org/pub/FreeBSD/</a> (ftp)</p></li><li><p><a href=ftp://ftp10.us.FreeBSD.org/pub/FreeBSD/ class=bare>ftp://ftp10.us.FreeBSD.org/pub/FreeBSD/</a> (ftp)</p></li><li><p><a href=ftp://ftp11.us.FreeBSD.org/pub/FreeBSD/ class=bare>ftp://ftp11.us.FreeBSD.org/pub/FreeBSD/</a> (ftp)</p></li><li><p><a href=ftp://ftp13.us.FreeBSD.org/pub/FreeBSD/ class=bare>ftp://ftp13.us.FreeBSD.org/pub/FreeBSD/</a> (ftp / <a href=http://ftp13.us.FreeBSD.org/pub/FreeBSD/ class=bare>http://ftp13.us.FreeBSD.org/pub/FreeBSD/</a> / rsync)</p></li><li><p><a href=ftp://ftp14.us.FreeBSD.org/pub/FreeBSD/ class=bare>ftp://ftp14.us.FreeBSD.org/pub/FreeBSD/</a> (ftp / <a href=http://ftp14.us.FreeBSD.org/pub/FreeBSD/ class=bare>http://ftp14.us.FreeBSD.org/pub/FreeBSD/</a>)</p></li><li><p><a href=ftp://ftp15.us.FreeBSD.org/pub/FreeBSD/ class=bare>ftp://ftp15.us.FreeBSD.org/pub/FreeBSD/</a> (ftp)</p></li></ul></div></div><div class=sect2><h3 id=anoncvs>A.3. Anonim CVS<a class=anchor href=#anoncvs></a></h3><div class=sect3><h4 id=anoncvs-intro>A.3.1. Bevezetés<a class=anchor href=#anoncvs-intro></a></h4><div class=paragraph><p>Az anonim CVS (vagy más néven <em>anoncvs</em>) a FreeBSD-hez mellékelt CVS-es segédprogramok által nyújtott olyan lehetõség, amivel távoli CVS repositorykkal tudunk szinkronizálni. Több más dolog mellett lehetõvé teszi a FreeBSD felhasználói számára, hogy kiemelt jogosultságok nélkül képesek legyenek olvasással kapcsolatos CVS mûveleteket végrehajtani a FreeBSD Projekt hivatalos anoncvs szerverein. A használatához egyszerûen csak a kiválasztott anoncvs szervert kell beállítani a <code>CVSROOT</code> környezeti változó értékének, ahol aztán a <code>cvs login</code> parancsnak a szerver által ismert "anoncvs" jelszót kell megadni. Ezután a <a href="https://man.freebsd.org/cgi/man.cgi?query=cvs&amp;sektion=1&amp;format=html">cvs(1)</a> paranccsal a többi CVS szerverhez hasonlóan lehetõségünk nyílik hozzáférni.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>A <code>cvs login</code> parancs a bejelentkezésekhez szükséges jelszavakat a <code>HOME</code> könyvtárunkban levõ <span class=filename>.cvspass</span> állományban tárolja. Ha ez az állomány nem létezik, akkor a <code>cvs login</code> elsõ használatakor hibát kapunk. Ilyenkor csak hozzunk létre egy üres <span class=filename>.cvspass</span> állományt, majd próbálkozzunk újra.</p></div></td></tr></tbody></table></div><div class=paragraph><p>Habár azt mondhatnánk, hogy a <a href=#cvsup>CVSup</a> és az <em>anoncvs</em> lényegében egyazon feladatot oldják meg, mind a két esetben léteznek olyan kompromisszumok, amelyek befolyásolhatják a felhasználó választását a két szinkronizációs módszer között. Dióhéjban ezt úgy tudnánk összefoglalni, hogy a CVSup a hálózati erõforrásokat hatékonyabban kihasználja és kettejük közül ez a fejlettebb, azonban ennek meg kell fizetnünk az árát. A CVSup használatához elõször ugyanis telepítenünk kell és be kell állítanunk egy speciális klienst, illetve az adatokat a CVSup által <em>gyûjteményeknek</em> (collection) nevezett, viszonylag nagy méretû egyeségekben érhetjük el.</p></div><div class=paragraph><p>Ezzel szemben az anoncvs használata során a megfelelõ CVS modul nevének felhasználásával tetszõlegesen megvizsgálhatunk önálló állományokat vagy akár programokat (mint az <code>ls</code> vagy a <code>grep</code>). Természetesen az anoncvs segítségével csupán az olvasást igénylõ CVS mûveleteket végezhetjük el, ezért ha a FreeBSD Projekt keretein belül fejleszteni is szeretnénk, akkor inkább érdemes a CVSup alkalmazást választani.</p></div></div><div class=sect3><h4 id=anoncvs-usage>A.3.2. Az anonim CVS használata<a class=anchor href=#anoncvs-usage></a></h4><div class=paragraph><p>A <a href="https://man.freebsd.org/cgi/man.cgi?query=cvs&amp;sektion=1&amp;format=html">cvs(1)</a> parancsot nagyon könnyû beállítani az anonim CVS repositoryk használatához, hiszen mindössze annyit kell tennünk, hogy a <code>CVSROOT</code> környezeti változó értékének megadjuk a FreeBSD Projekt valamelyik <em>anoncvs</em> szerverét. Ezen sorok írásának pillanatában a következõ szerverek érhetõek el:</p></div><div class=ulist><ul><li><p><em>Franciaország</em>: :pserver:anoncvs@anoncvs.fr.FreeBSD.org:/home/ncvs (pserver módban a jelszó "anoncvs", az SSH pedig nincs jelszó)</p></li><li><p><em>Tajvan</em>: :pserver:anoncvs@anoncvs.tw.FreeBSD.org:/home/ncvs (pserver módban a <code>cvs login</code> használatával tetszõleges jelszó megadható, az SSH esetén pedig nincs jelszó)</p><div class="literalblock programlisting"><div class=content><pre>SSH2 HostKey: 1024 02:ed:1b:17:d6:97:2b:58:5e:5c:e2:da:3b:89:88:26 /etc/ssh/ssh_host_rsa_key.pub
SSH2 HostKey: 1024 e8:3b:29:7b:ca:9f:ac:e9:45:cb:c8:17:ae:9b:eb:55 /etc/ssh/ssh_host_dsa_key.pub</pre></div></div></li><li><p><em>Egyesült Államok</em>: <a href=mailto:anoncvs@anoncvs1.FreeBSD.org>anoncvs@anoncvs1.FreeBSD.org</a>:/home/ncvs (csak SSH v2 - nincs jelszó)</p><div class="literalblock programlisting"><div class=content><pre>SSH2 HostKey: 2048 53:1f:15:a3:72:5c:43:f6:44:0e:6a:e9:bb:f8:01:62 /etc/ssh/ssh_host_dsa_key.pub</pre></div></div></li></ul></div><div class=paragraph><p>Mivel a CVS használatával "kikérhetjük" (check out) tulajdonképpen a FreeBSD forrásainak akármelyik eddigi (vagy majd ezután keletkezõ) változatát, érdemes megismerkednünk a <a href="https://man.freebsd.org/cgi/man.cgi?query=cvs&amp;sektion=1&amp;format=html">cvs(1)</a> által alkalmazott revízió (revision) (az <code>-r</code> opcióval állítható) fogalmával és a FreeBSD Projekt repositoryjain belül engedélyezett értékeivel.</p></div><div class=paragraph><p>Címkéket (tag) két esetben használhatunk: a revíziók és az ágak esetén. A revíziós címkék mindig egy adott revízióra hivatkoznak, ami állandóan ugyanazt jelenti. Ezzel szemben az ágak címkéi a fejlesztés adott irányú menetének az adott pillanatban legfrissebb revízióját hivatkozzák. Mivel az ágak címkéi nem egy adott revízióra vonatkoznak, ezért elmondhatjuk róluk, hogy naponta változik a jelentésük.</p></div><div class=paragraph><p>Az <a href=#cvs-tags>CVS címkék</a> tartalmazza a felhasználók számára fontos revíziós címkéket. Ezek azonban nem igazak a Portgyûjteményre, mivel a Portgyûjteménynek nincs egyszerre több fejlesztési iránya.</p></div><div class=paragraph><p>Egy ág címkéjének megadásával általában az adott irányhoz tartozó állományok legfrissebb változatát kapjuk meg. Ha viszont az állományok egy korábbi változatára lenne szükségünk, akkor a <code>-D dátum</code> opció megadásával meg tudjuk adni annak idõpontját. Errõl részletesebben a <a href="https://man.freebsd.org/cgi/man.cgi?query=cvs&amp;sektion=1&amp;format=html">cvs(1)</a> man oldalán olvashatunk.</p></div></div><div class=sect3><h4 id=_példák_6>A.3.3. Példák<a class=anchor href=#_példák_6></a></h4><div class=paragraph><p>Habár a továbbhaladáshoz mindenképpen javasoljuk a <a href="https://man.freebsd.org/cgi/man.cgi?query=cvs&amp;sektion=1&amp;format=html">cvs(1)</a> man oldalának részletes áttanulmányozását, mutatunk néhány gyors példát az anonim CVS használatának tömör illusztrálására:</p></div><div class=exampleblock><div class=title>Példa 42. Valami (az <a href="https://man.freebsd.org/cgi/man.cgi?query=ls&amp;sektion=1&amp;format=html">ls(1)</a>) kikérése a -CURRENT ágból</div><div class=content><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>% setenv CVSROOT :pserver:anoncvs@anoncvs.tw.FreeBSD.org:/home/ncvs
% cvs login
<span class=s2>&#34;Jelszóként&#34;</span> ezután bármit megadhatunk.
% cvs co <span class=nb>ls</span></code></pre></div></div></div></div><div class=exampleblock><div class=title>Példa 43. Az <span class=filename>src/</span> fa kikérése SSH-n keresztül</div><div class=content><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>% cvs <span class=nt>-d</span> anoncvs@anoncvs1.FreeBSD.org:/home/ncvs co src
The authenticity of host <span class=s1>&#39;anoncvs1.freebsd.org (216.87.78.137)&#39;</span> can<span class=s1>&#39;t be established.
DSA key fingerprint is 53:1f:15:a3:72:5c:43:f6:44:0e:6a:e9:bb:f8:01:62.
Are you sure you want to continue connecting (yes/no)? yes
Warning: Permanently added &#39;</span>anoncvs1.freebsd.org<span class=s1>&#39; (DSA) to the list of known hosts.</span></code></pre></div></div></div></div><div class=exampleblock><div class=title>Példa 44. Az <a href="https://man.freebsd.org/cgi/man.cgi?query=ls&amp;sektion=1&amp;format=html">ls(1)</a> 6-STABLE ágban szereplõ változatának kikérése</div><div class=content><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>% setenv CVSROOT :pserver:anoncvs@anoncvs.tw.FreeBSD.org:/home/ncvs
% cvs login
Amikor kéri,  <span class=s2>&#34;jelszóként&#34;</span> bármit megadhatunk.
% cvs co <span class=nt>-rRELENG_6</span> <span class=nb>ls</span></code></pre></div></div></div></div><div class=exampleblock><div class=title>Példa 45. Az <a href="https://man.freebsd.org/cgi/man.cgi?query=ls&amp;sektion=1&amp;format=html">ls(1)</a> változásainak (Unified Diff formátumú) listázása</div><div class=content><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>% setenv CVSROOT :pserver:anoncvs@anoncvs.tw.FreeBSD.org:/home/ncvs
% cvs login
Itt <span class=s2>&#34;jelszóként&#34;</span> bármit megadhatunk.
% cvs rdiff <span class=nt>-u</span> <span class=nt>-rRELENG_5_3_0_RELEASE</span> <span class=nt>-rRELENG_5_4_0_RELEASE</span> <span class=nb>ls</span></code></pre></div></div></div></div><div class=exampleblock><div class=title>Példa 46. A használható modulok nevének kiderítése</div><div class=content><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>% setenv CVSROOT :pserver:anoncvs@anoncvs.tw.FreeBSD.org:/home/ncvs
% cvs login
Ezután  <span class=s2>&#34;jelszóként&#34;</span> bármit megadhatunk.
% cvs co modules
% more modules/modules</code></pre></div></div></div></div></div><div class=sect3><h4 id=_egyéb_helyek>A.3.4. Egyéb helyek<a class=anchor href=#_egyéb_helyek></a></h4><div class=paragraph><p>A következõ helyeken találhatunk még hasznos információkat a CVS használatáról:</p></div><div class=ulist><ul><li><p><a href=http://users.csc.calpoly.edu/~gfisher/classes/308/handouts/cvs-basics.html>A CVS bemutatása</a> (forrás: Kaliforna Állami Mûszaki Egyetem).</p></li><li><p><a href=http://ximbiot.com/cvs/wiki/>A CVS honlapja</a>, a CVS fejlesztésével és alkalmazásával foglalkozó közösség oldala.</p></li><li><p>A <a href=http://www.FreeBSD.org/cgi/cvsweb.cgi>CVSweb</a> a FreeBSD Projekt által használt CVS rendszerének webes felülete.</p></li></ul></div></div></div><div class=sect2><h3 id=ctm>A.4. A CTM használata<a class=anchor href=#ctm></a></h3><div class=paragraph><p>A CTM használatáva a távoli könyvtárakat tudunk egy központi változattal szinkronban tartani. Eredetileg a FreeBSD forrásaihoz fejlesztették ki, de idõvel mások más célokra is alkalmasnak találhatják majd. Az eltérések (delták) feldolgozásával kapcsolatban kevéske dokumentáció áll rendelkezésre, ezért a <a href=https://lists.FreeBSD.org/subscription/ctm-users>ctm-users-desc</a> levelezési listát érdemes felkeresni, ha többet szeretnénk megtudni a CTM egyéb célú alkalmazásairól.</p></div><div class=sect3><h4 id=_miért_használnánk_a_ctm_et>A.4.1. Miért használnánk a CTM-et?<a class=anchor href=#_miért_használnánk_a_ctm_et></a></h4><div class=paragraph><p>A CTM segítségével a FreeBSD forrásainak helyi másolatát hozhatjuk létre. A források több különbözõ "kivitelben" is hozzáférhetõek. A CTM minden esetben képes eleget tenni az igényeinknek, akár az egész CVS fát, akár annak egy részét kívánjuk csak figyelemmel követni. Ha netalán FreeBSD fejlesztõk lennénk, és híján vagyunk vagy éppen gyenge TCP/IP kapcsolattal rendelkezünk, esetleg egyszerûen csak automatikusan értesülni szeretnénk a változásokról, a CTM-et nekünk találták ki. A leggyorsabban fejlõdõ ágakból is naponta legfeljebb három deltát fogunk kapni, azonban érdemes megfontolni a változások automatikus elküldését levélben. A szükséges frissítések méretét mindig igyekszünk minimalizálni. Ez egyébként általában alig 5 KB, de néha (tízbõl egyszer) elõfordul, hogy 10 és 50 KB között van, és idõnként 100 KB vagy afeletti mennyiségû frissítés is érkezhet.</p></div><div class=paragraph><p>Amikor a fejlesztõk által használt forrásokat töltjük le, magunknak kell gondoskodnunk a menet közben felmerülõ különbözõ problémák megoldásáról. Ez kiváltképp igaz abban az esetben, amikor az aktuális, vagy hivatalos nevén "CURRENT" ágat követjük. Mielõtt azonban egy ilyenbe belevágnánk, érdemes fellapozni a <a href=./#current>FreeBSD legfrissebb változatának használatáról</a> szóló fejezetet.</p></div></div><div class=sect3><h4 id=_mire_van_szükségünk_a_ctm_használatához>A.4.2. Mire van szükségünk a CTM használatához?<a class=anchor href=#_mire_van_szükségünk_a_ctm_használatához></a></h4><div class=paragraph><p>A mûködéshez két komponens szükségeltetik: a CTM kliensprogramja és hozzá a kezdeti delták (amivel majd letöltjük a "CURRENT" forrásait).</p></div><div class=paragraph><p>A CTM program már a 2.0 kiadástól kezdve a FreeBSD része, és a források között a <span class=filename>/usr/src/usr.sbin/ctm</span> könyvtárban találjuk meg (amennyiben felraktuk).</p></div><div class=paragraph><p>A CTM mûködéséhez kellõ "deltákat" két módon, FTP-n vagy e-mailen keresztül szerezhetjük be. Ha el tudunk érni interneten levõ FTP oldalakat, akkor az alábbi FTP helyeken találunk a CTM-hez használható adatokat:</p></div><div class=paragraph><p><a href=ftp://ftp.FreeBSD.org/pub/FreeBSD/CTM/>ftp://ftp.FreeBSD.org/pub/FreeBSD/CTM/</a></p></div><div class=paragraph><p>valamint lásd a <a href=#mirrors-ctm>tükrözéseket</a>.</p></div><div class=paragraph><p>FTP-n keresztül lépjünk be a könyvtárba, töltsük le a <span class=filename>README</span> nevû állományt és kövessük a benne szereplõ utasításokat.</p></div><div class=paragraph><p>Ha viszont e-mailen keresztül akarjuk megszerezni a deltákat:</p></div><div class=paragraph><p>Iratkozzunk fel a CTM terjesztési listáinak egyikére. A <a href=https://lists.FreeBSD.org/subscription/ctm-cvs-cur>ctm-cvs-cur-desc</a> lista az egész CVS-fát, míg a <a href=https://lists.FreeBSD.org/subscription/ctm-src-cur>ctm-src-cur-desc</a> a fõ fejlesztési ágat teszi elérhetõvé. A <a href=https://lists.FreeBSD.org/subscription/ctm-src-4>CTM 4-STABLE src branch distribution levelezési lista</a> a 4.X kiadásaihoz ágakat tartalmazza, és így tovább. (Ha nem tudjuk, hogyan kell feliratkozni egy levelezési listára, akkor kattintsunk a lista nevére vagy kövessük a <a href=https://lists.freebsd.org class=bare>https://lists.freebsd.org</a> linket, majd kattintsunk arra a listára, ahova fel akarunk iratkozni. Ezen az oldalon az összes, a feliratkozáshoz nélkülözhetetlen információnak szerepelnie kell.)</p></div><div class=paragraph><p>Miután elkezdenek megérkezni a CTM-frissítéseket tartalmazó levelek, a tartalmukat a <code>ctm_rmail</code> programmal tudjuk kicsomagolni és felhasználni. Az <span class=filename>/etc/aliases</span> állományba akár közvetlenül is beírhatjuk a <code>ctm_rmail</code> programot, és ezzel a önállósítani tudjuk a levélben érkezõ frissítések feldolgozását. A <code>ctm_rmail</code> man oldalán olvashatjuk ennek részleteit.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Nem számít, milyen módon jutunk hozzá a CTM által használt deltákhoz, minden esetben fel kell iratkoznunk a <a href=https://lists.FreeBSD.org/subscription/ctm-announce>ctm-announce-desc</a> levelezési listára. Az elkövetkezendõkben ez lesz az egyetlen hely, ahová a CTM rendszer mûködtetésével kapcsolatos bejelentések beküldésre kerülnek. A feliratkozáshoz kattinsunk a fenti lista nevére és kövessük a mellette szereplõ utasításokat.</p></div></td></tr></tbody></table></div></div><div class=sect3><h4 id=_a_ctm_elsõ_használata>A.4.3. A CTM elsõ használata<a class=anchor href=#_a_ctm_elsõ_használata></a></h4><div class=paragraph><p>Mielõtt nekilátnánk a CTM-hez tartozó delták használatának, elõször el kell jutnunk egy kiindulási ponthoz, ahonnan majd létre tudjuk hozni a rákövetkezõ deltákat.</p></div><div class=paragraph><p>Ehhez elsõként vegyük számba, pontosan mink is van. Általában mindenki egy "üres" könyvtárral kezd. Ilyenkor egy kezdeti "Empty" (mint "üres") elnevezésû deltával tudjuk megkezdeni az CTM által ismert fa szinkronizálását. Erre a célra lesznek majd szintén alkalmasak a "megkezdett" delták is, amelyek valamikor a CD-re fognak felkerülni.</p></div><div class=paragraph><p>Mivel a fák maguk több tíz megabyte-nyi méretûek, ezért érdemes inkább valami kéznél levõ eszközzel megkezdeni a folyamatot. Ha van -RELEASE verziójú CD-nk, akkor másoljuk le róla és bontsuk ki a kiindulásként használt forrásokat. Ezzel jelentõs mennyiségû adat átvitelét takaríthatjuk meg.</p></div><div class=paragraph><p>A "kezdõ" deltákat könnyen megismerjük a szám után <code>X</code> karakterrel leválasztott nevükrõl (például <span class=filename>src-cur.3210XEmpty.gz</span>). Az <code>X</code> után szereplõ megnevezés a kezdeti "kiindulás" (seed) fokának felel meg. Az <span class=filename>Empty</span> egy üres könyvtárra utal. A szabályok szerint az <code>Empty</code> állapotból 100 deltánként jön létre újabb (kiindulásra alkalmas) alapváltozat. Ezek azonban nagyon nagyok is lehetnek. A 70 vagy 80 megabyte-os <code>gzip</code>pel csomagolt adatok gyakoriak az <span class=filename>XEmpty</span> delták esetén.</p></div><div class=paragraph><p>Miután kiválasztottuk a számunkra megfelelõ alapváltozatot, szükségünk lesz a tõle nagyobb sorszámú összes deltára is.</p></div></div><div class=sect3><h4 id=_a_ctm_használata_a_hétköznapokban>A.4.4. A CTM használata a hétköznapokban<a class=anchor href=#_a_ctm_használata_a_hétköznapokban></a></h4><div class=paragraph><p>A delták felhasználásához egyszerûen csak ennyit kell tennünk:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># cd /ahol/tárolni/akarjuk/az/adatokat</span>
<span class=c># ctm -v -v /ahol/tároljuk/a/deltákat/src-xxx.*</span></code></pre></div></div><div class=paragraph><p>A CTM képes értelmezni a <code>gzip</code> által csomagolt adatokat, ezért nincs szükség a delták elõzetes kitömörítésére, amivel tárhelyet tudunk spórolni.</p></div><div class=paragraph><p>Hacsak nem tekinti tökéletesen biztonságosnak az egész folyamatot, akkor a CTM nem fog módosítani a fán. A deltákat a CTM <code>-c</code> kapcsolójával is ellenõrizhetjük, aminek során egyáltalán nem fog módosulni a forrásfa. Ekkor egyszerûen csak ellenõrzi a delták sértetlenségét és megnézi, hogy minden rendben zajlana-e az alkalmazásuk során.</p></div><div class=paragraph><p>A CTM-nek vannak még további kapcsolói is, melyekrõl bõvebben a man oldalakból és a forráskódokból tájékozódhatunk.</p></div><div class=paragraph><p>Most már minden megvan, ami kellhet. Amikor kapunk egy újabb deltát, a forrásaink frissítéséhez csak futtassuk át a CTM-en.</p></div><div class=paragraph><p>Ne töröljük le azokat a deltákat, melyeket nehezen tudtunk letölteni. Helyette érdemes inkább megtartani ezeket arra az esetre, ha valami rossz történne. Még ha csak floppylemezek is állnak rendelkezésünkre, mindenképpen másoljuk le ezeket az <code>fdwrite</code> paranccsal.</p></div></div><div class=sect3><h4 id=_a_saját_változtatásaink_megtartása>A.4.5. A saját változtatásaink megtartása<a class=anchor href=#_a_saját_változtatásaink_megtartása></a></h4><div class=paragraph><p>Fejlesztõként biztosan szeretnénk kísérletezni és állományokat megváltoztatni a forrásfában. A CTM a helyben elkövetett változtatásokat csak korlátozottan támogatja: az <span class=filename>ize</span> nevû állomány meglétének vizsgálata elõtt az <span class=filename>ize.ctm</span> állományt fogja keresni. Ha létezik, akkor a CTM az <span class=filename>ize</span> helyett ezen fog dolgozni.</p></div><div class=paragraph><p>Ezzel a viselkedéssel nyerjük a saját változtatásaink megtartásának egyszerû módját: csak másoljuk le <span class=filename>.ctm</span> kiterjesztéssel a módosítani tervezett állományokat. Ezután már szabadon módosíthatjuk a forrásokat, miközben a CTM a <span class=filename>.ctm</span> kiterjesztésû állományokat folyamatosan szinkronban tartja.</p></div></div><div class=sect3><h4 id=_a_ctm_egyéb_érdekes_beállításai>A.4.6. A CTM egyéb érdekes beállításai<a class=anchor href=#_a_ctm_egyéb_érdekes_beállításai></a></h4><div class=sect4><h5 id=_derítsük_ki_pontosan_miket_is_fog_érinteni_a_frissítés>A.4.6.1. Derítsük ki pontosan miket is fog érinteni a frissítés<a class=anchor href=#_derítsük_ki_pontosan_miket_is_fog_érinteni_a_frissítés></a></h5><div class=paragraph><p>A CTM által a forrásokon elvégzendõ változtatások listáját az <code>-l</code> kapcsolóval kérdezhetjük le.</p></div><div class=paragraph><p>Ez akkor esik kézre, ha szeretnénk feljegyezni a bekövetkezõ változásokat, vagy bármilyen módon elõ- vagy utófeldolgozni a módosított állományokat, esetleg szimplán elõvigyázatosak akarunk lenni.</p></div></div><div class=sect4><h5 id=_biztonsági_másolat_készítése_a_frissítés_elõtt>A.4.6.2. Biztonsági másolat készítése a frissítés elõtt<a class=anchor href=#_biztonsági_másolat_készítése_a_frissítés_elõtt></a></h5><div class=paragraph><p>Néha egyszerûen csak szeretnénk az összes érintett állományról biztonsági másolatot készíteni a CTM által elvégzett frissítés elõtt.</p></div><div class=paragraph><p>A <code>-B <em>mentés-állomány</em></code> beállítás megadásával az adott CTM delta által módosítandó összes állomány tárolásra kerül a <em>mentés-állomány</em> nevû állományba.</p></div></div><div class=sect4><h5 id=_a_frissíthetõ_állományok_korlátozása>A.4.6.3. A frissíthetõ állományok korlátozása<a class=anchor href=#_a_frissíthetõ_állományok_korlátozása></a></h5><div class=paragraph><p>Egyes esetekben érdekünkben állhat leszûkíteni a CTM által eszközölt frissítések hatáskörét, vagy egyszerûen csak néhány állomány szinkronizálására van szükségünk.</p></div><div class=paragraph><p>A CTM számára feldolgozható állományok listáját reguláris kifejezés formájában az <code>-e</code> és <code>-x</code> opciók mentén határozhatjuk meg.</p></div><div class=paragraph><p>Például ha a <span class=filename>lib/libc/Makefile</span> állomány az összegyûjtött CTM delták szerinti legfrissebb verziójához kívánunk hozzájutni, akkor futtassuk az alábbi parancsot:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># cd /akarhova/ahova/ki/akarjuk/bontani/</span>
<span class=c># ctm -e &#39;^lib/libc/Makefile&#39; ~ctm/src-xxx.*</span></code></pre></div></div><div class=paragraph><p>A CTM deltákban megadott minden egyes állomány esetén az <code>-e</code> az <code>-x</code> opciók a parancssorban történt megadásuk sorrendjében kerülnek feldolgozásra. Egy állományt kizárólag csak akkor dolgoz fel a CTM, ha az az <code>-e</code> és <code>-x</code> opciók kiértékelése után is indokolt.</p></div></div></div><div class=sect3><h4 id=_további_tervek_a_ctm_mel_kapcsolatban>A.4.7. További tervek a CTM-mel kapcsolatban<a class=anchor href=#_további_tervek_a_ctm_mel_kapcsolatban></a></h4><div class=paragraph><p>Rengeteg van:</p></div><div class=ulist><ul><li><p>Valamiféle hitelesítés bevezetése a CTM rendszerbe, amivel észlelhetõek a meghamisított CTM-frissítések.</p></li><li><p>A CTM beállításainak letisztázása, mivel eléggé megtévesztõek és nehézkesen használhatóak.</p></li></ul></div></div><div class=sect3><h4 id=_egyebek_2>A.4.8. Egyebek<a class=anchor href=#_egyebek_2></a></h4><div class=paragraph><p>Léteznek delták a <code>portok</code> gyûjteményéhez is, azonban még nem mutatkozott túlzottan nagy érdeklõdés irántuk.</p></div></div><div class=sect3><h4 id=mirrors-ctm>A.4.9. CTM tükrözések<a class=anchor href=#mirrors-ctm></a></h4><div class=paragraph><p>A <a href=#ctm>CTM</a>/FreeBSD anonim FTP-n keresztül elérhetõ az alábbi tüköroldalak valamelyikérõl. Amennyiben ezen a módon kívánjuk letölteni a CTM rendszerhez tartozó állományokat, elõször próbálkozzunk a hozzánk legközelebb levõ szerverrel.</p></div><div class=paragraph><p>Ha bármilyen gond merülne fel, értesítsük a <a href=https://lists.FreeBSD.org/subscription/ctm-users>ctm-users-desc</a> levelezési listát.</p></div><div class=dlist><dl><dt class=hdlist1>Kalifornia, Bay Area (hivatalos forrás)</dt><dd><div class=ulist><ul><li><p><a href=ftp://ftp.FreeBSD.org/pub/FreeBSD/development/CTM/>ftp://ftp.FreeBSD.org/pub/FreeBSD/development/CTM/</a></p></li></ul></div></dd><dt class=hdlist1>Dél-Afrika (a korábbi delták biztonsági másolatai)</dt><dd><div class=ulist><ul><li><p><a href=ftp://ftp.za.FreeBSD.org/pub/FreeBSD/CTM/>ftp://ftp.za.FreeBSD.org/pub/FreeBSD/CTM/</a></p></li></ul></div></dd><dt class=hdlist1>Tajvan/R.O.C.</dt><dd><div class=ulist><ul><li><p><a href=ftp://ctm.tw.FreeBSD.org/pub/FreeBSD/development/CTM/>ftp://ctm.tw.FreeBSD.org/pub/FreeBSD/development/CTM/</a></p></li><li><p><a href=ftp://ctm2.tw.FreeBSD.org/pub/FreeBSD/development/CTM/>ftp://ctm2.tw.FreeBSD.org/pub/FreeBSD/development/CTM/</a></p></li><li><p><a href=ftp://ctm3.tw.FreeBSD.org/pub/FreeBSD/development/CTM/>ftp://ctm3.tw.FreeBSD.org/pub/FreeBSD/development/CTM/</a></p></li></ul></div></dd></dl></div><div class=paragraph><p>Ha nem találtunk volna hozzánk közel esõ tükrözést, vagy ha talált tükör nem elég friss, akkor próbálkozzunk egy olyan keresõmotor használatával, mint például az <a href=http://www.alltheweb.com/>alltheweb</a>.</p></div></div></div><div class=sect2><h3 id=cvsup>A.5. A CVSup használata<a class=anchor href=#cvsup></a></h3><div class=sect3><h4 id=cvsup-intro>A.5.1. Bevezetés<a class=anchor href=#cvsup-intro></a></h4><div class=paragraph><p>A CVSup távoli szervereken található központi repositorykban levõ forrásfák terjesztésére és a rajtuk keresztüli frissítésre alkalmas programcsomag. A FreeBSD forrásait egy CVS repositoryban tartják karban Kaliforniában egy fejlesztéseket tároló központi számítógépen. A CVSup segítségével a FreeBSD felhasználói könnyen szinkronban tudják vele tartani a saját forrásaikat.</p></div><div class=paragraph><p>A CVSup az ún. <em>lehúzással</em> frissít. Ilyenkor a kliensek csak akkor kérnek a szervertõl frissítéseket, amikor szükségük van rá, miközben a szerver passzívan várja a frissítési kérelmeket. Ennek megfelelõen tehát minden esetben a kliens kezdeményezi a frissítést, a szerver pedig önmagától sosem küld ilyeneket kéretlenül. A felhasználóknak így vagy maguknak kell meghívniuk a CVSup kliensét, vagy a frissítések rendszeres automatikus letöltéséhez be kell állítaniuk a <code>cron</code> rendszerprogramot.</p></div><div class=paragraph><p>A CVSup kifejezés ebben az írásmódban az egész programcsomagra utal. Fõ alkotórészei a a felhasználó gépén futó <code>cvsup</code> nevû kliens, és a FreeBSD tüköroldalain futó <code>cvsupd</code> nevû szerver.</p></div><div class=paragraph><p>A FreeBSD dokumentációjának és levelezési listáinak fürkészése során rengeteg hivatkozást találhatunk egy sup nevû alkalmazásra. A sup a CVSup elõdje volt, és hasonló célokat szolgált. A CVSup használat tekintetében nagyon hasonlít a sup-hoz, és ami azt illeti, a a <code>sup</code> konfigurációs állományaival visszafele kompatibilis formátumot használ. Mivel a CVSup sokkal gyorsabb és rugalmasabb, a supot már nem használja a FreeBSD Projekt.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>A csup a CVSup C nyelven újraírt változata. Legnagyobb elõnye, hogy gyorsabb és nincs szüksége a Modula-3 nyelv futtató környezetére, ezért azt nem kell a használatához telepíteni. Ráadásul, ha a FreeBSD 6.2 vagy annál késõbbi változatát használjuk, akkor minden további nélkül a rendelkezésünkre áll, hiszen az alaprendszer része. A FreeBSD korábbi verzióinak alaprendszerei ugyan nem tartalmazzák a <a href="https://man.freebsd.org/cgi/man.cgi?query=csup&amp;sektion=1&amp;format=html">csup(1)</a> parancsot, viszont a <a class=package href=https://cgit.freebsd.org/ports/tree/net/csup/>net/csup</a> port vagy csomag segítségével pillanatok alatt telepíteni tudjuk. Amennyiben a csup mellett tennénk le a voksunkat, a szakasz fennmaradó részében egyszerûen hagyjuk ki a CVSup telepítésérõl szóló lépéseket és a CVSup hivatkozásait helyettesítsük a csup programmal.</p></div></td></tr></tbody></table></div></div><div class=sect3><h4 id=cvsup-install>A.5.2. Telepítés<a class=anchor href=#cvsup-install></a></h4><div class=paragraph><p>A CVSup telepítésének legegyszerûbb módja a FreeBSD <a href=./#ports>csomaggyûjteményében</a> található elõrefordított <a class=package href=https://cgit.freebsd.org/ports/tree/net/cvsup/>net/cvsup</a> csomag használata. Ha viszont inkább forrásból akarjuk telepíteni a CVSupot, akkor helyette használjuk a <a class=package href=https://cgit.freebsd.org/ports/tree/net/cvsup/>net/cvsup</a> portot. De legyünk elõvigyázatosak: a <a class=package href=https://cgit.freebsd.org/ports/tree/net/cvsup/>net/cvsup</a> portnak szüksége van a Modula-3 rendszerre, aminek letöltése és lefordítása pedig meglehetõsen sok idõt és tárhelyet igényel.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Ha olyan gépen akarjuk használni a CVSupot, ahol nincs XFree86™, Xorg vagy bármilyen más ilyen szerver, akkor használjuk a <a class=package href=https://cgit.freebsd.org/ports/tree/net/cvsup-without-gui/>net/cvsup-without-gui</a> portot, ami nem tartalmazza a hozzá tartozó grafikus felületet.</p></div></td></tr></tbody></table></div><div class=paragraph><p>Ha a FreeBSD 6.1 vagy korábbi változatain szeretnénk telepíteni a csupot, használjuk a FreeBSD <a href=./#ports>csomaggyûjteményében</a> megtalálható <a class=package href=https://cgit.freebsd.org/ports/tree/net/csup/>net/csup</a> csomagot. Ha viszont forrásból kívánjuk telepíteni a csup programot, akkor helyette használjuk a <a class=package href=https://cgit.freebsd.org/ports/tree/net/csup/>net/csup</a> portot.</p></div></div><div class=sect3><h4 id=cvsup-config>A.5.3. A CVSup beállítása<a class=anchor href=#cvsup-config></a></h4><div class=paragraph><p>A CVSup mûködését a <span class=filename>supfile</span> elnevezésû állomány vezérli. A <a href=file://localhost/usr/shared/examples/cvsup/>/usr/shared/examples/cvsup/</a> könyvárban találhatunk néhány példát a <span class=filename>supfile</span> állományokra.</p></div><div class=paragraph><p>A <span class=filename>supfile</span> állományban szereplõ információk a CVSup használatával kapcsolatban a következõ kérdéseket válaszolják meg:</p></div><div class=ulist><ul><li><p><a href=#cvsup-config-files>Milyen állományokat akarunk letölteni?</a></p></li><li><p><a href=#cvsup-config-vers>Milyen verzióikra van szükségünk?</a></p></li><li><p><a href=#cvsup-config-where>Honnan akarjuk ezeket beszerezni?</a></p></li><li><p><a href=#cvsup-config-dest>Hova akarjuk rakni a számítógépünkön?</a></p></li><li><p><a href=#cvsup-config-status>Hova akarjuk rakni az állapotot tároló állományokat?</a></p></li></ul></div><div class=paragraph><p>Az imént feltett kérdésekre a következõ szakaszokban összeállítandó <span class=filename>supfile</span> segítségével fogunk válaszolni. Ehhez elõször bemutatjuk a <span class=filename>supfile</span> formátumú állományok általános szerkezetét.</p></div><div class=paragraph><p>A <span class=filename>supfile</span> állományok szöveget tartalmaznak. A megjegyzések <code>#</code> karakterrel kezdõdnek és a sor végéig tartanak. A kizárólag csak megjegyzéseket tartalmazó vagy üres sorok nem kerülnek feldolgozásra.</p></div><div class=paragraph><p>Az összes többi fennmaradó sorban pedig azokat az állományokat írjuk le, amelyeket a felhasználó le akar tölteni. Az ilyen fajtájú sorok egy "gyûjtemény" (collection) nevével kezdõdnek, ami állományok egy szerver által meghatározott logikai csoportjára utal. A gyûjtemény neve ennek megfelelõen elárulja a szervernek, hogy pontosan milyen állományokra van szükségünk. Ezután következik whitespace-szel elválasztva nulla vagy több mezõ, amelyek a korábban feltett kérdéseinket válaszolják meg rendre. Ezeknek a mezõknek két típusa létezik: a beállításokat és a konkrét értéket tároló mezõk. A beállításokat tároló mezõk különbözõ kulcsszavakat tartalmaznak, például a <code>delete</code> (törlés) vagy <code>compress</code> (tömörítés). Az értéket tároló mezõk is egy kulcsszóval kezdõdnek, azonban utána közvetlenül egy <code>=</code> (egyenlõségjel) jön, amelyet egy második szó követ szorosan. Így például a <code>release=cvs</code> pontosan egy ilyen értékmezõ lesz.</p></div><div class=paragraph><p>Egy <span class=filename>supfile</span> általában egynél több gyûjtemény letöltését írja le. Ezért az ilyen állományok felépítésének egyik módja, ha az egyes gyûjteményhez explicite megadjuk a hozzá tartozó mezõket. Azonban így a <span class=filename>supfile</span> állományok gyorsan megnövekednek és kényelmetlenné válnak, mivel a legtöbb gyûjtemény esetén szinte ugyanazokat a mezõket kellene megadnunk. A CVSup az ilyen típusú bonyodalmak elkerülésére egy alapértelmezési megoldást javasol. A <code>*default</code> nevû álgyûjteménnyel kezdõdõ sorok segítségével meg tudunk adni olyan beállításokat és értékeket, amelyek az utána következõ gyûjtemények számára alapértelmezésnek fognak számítani a <span class=filename>supfile</span> állományban. Az itt megadott alapértelmezések természetesen az egyes gyûjteményekben tetszõleges módon felülbírálhatóak, a mezõk magán a gyûjteményen belüli megadásával. Az állományban az alapértelmezések is megváltoztathatóak vagy bõvíthetõek további <code>*default</code> sorok hozzáadásával.</p></div><div class=paragraph><p>Mindezek tudatában most már megkezdhetjük a <a href=./#current>FreeBSD-CURRENT</a> ág tartalmának letöltésére és frissen tartására alkalmas <span class=filename>supfile</span> állomány összeállítását.</p></div><div class=ulist><ul><li><p><a id=cvsup-config-files></a>Milyen állományokat akarunk letölteni?</p><div class=paragraph><p>A CVSupon keresztül elérhetõ állományok "gyûjteményeknek" hívott nevesített csoportokra bontva érhetõek el. A hivatkozható gyûjtemények leírását a <a href=#cvsup-collec>következõ szakaszban</a> találjuk. Ebben a példában most szeretnénk letölteni az egész FreeBSD rendszer forrását. Ezt a <code>src-all</code> nevû gyûjteményre hivatkozva érhetjük el. A <span class=filename>supfile</span> állományunk létrehozásának elsõ lépéseként soronként egyet megadva felsoroljuk a letölteni kívánt gyûjteményeket (jelen esetünkben csak egyetlen egyet):</p></div><div class="literalblock programlisting"><div class=content><pre>src-all</pre></div></div></li><li><p><a id=cvsup-config-vers></a>Milyen verzióikra van szükségünk?</p><div class=paragraph><p>A CVSup használatával tulajdonképpen a források összes valaha létezett verziójához hozzá tudunk férni. Ez annak köszönhetõ, hogy a cvsupd szerver közvetlenül a CVS repositoryból dolgozik, ami pedig az összes verziót tartalmazza. A <code>tag=</code> és <code>date=</code> értékmezõk segítségével adhatjuk meg az igényelt verziókat.</p></div><div class="admonitionblock warning"><table><tbody><tr><td class=icon><i class="fa icon-warning" title=Warning></i></td><td class=content><div class=paragraph><p>Legyünk óvatosak azonban a <code>tag=</code> mezõk helyes megadásával. Egyes címkék ugyanis csak bizonyos állománygyûjtemények esetén élnek. Ha hibás vagy elírt címkét adunk meg, akkor a CVSup törölni fog olyan állományokat, amelyeket valószínûleg nem kellene. A <code>ports-*</code> gyûjtemények esetében pedig kifejezetten <em>csak</em> a <code>tag=.</code> mezõk használhatóak!</p></div></td></tr></tbody></table></div><div class=paragraph><p>A <code>tag=</code> mezõk a tárházban található szimbolikus címkéket nevezik meg. A címkéknek két típusa van: a revíziókhoz és az ágakhoz tartozó címkék. A revíziós címkék mindig egy adott revíziót hivatkoznak, jelentésük állandó. Ezzel szemben az ágak címkéi egy adott fejlesztési ág adott idõpontjában elérhetõ revíziót címkézi. Mivel az ágak címkéi nem egy konkrét revízióra vonatkoznak, ezért akár olyanra is utalhatnak, ami pillanatnyilag még nem is létezik.</p></div><div class=paragraph><p>Az <a href=#cvs-tags>CVS címkék</a>ban megtalálhatjuk a fontosabb ágak címkéit. A CVSup konfigurációs állományában a címkéket a <code>tag=</code> elõtaggal kell bevezetni (így tehát a <code>RELENG_4</code> címke hivatkozása <code>tag=RELENG_4</code> lesz). Ne felejtsük el, hogy a Portgyûjtemény esetében csak <code>tag=.</code> mezõ megadásának van értelme.</p></div><div class="admonitionblock warning"><table><tbody><tr><td class=icon><i class="fa icon-warning" title=Warning></i></td><td class=content><div class=paragraph><p>Igyekezzünk pontosan lemásolni a címkék neveit, mivel a CVSup nem képes megkülönböztetni az érvényes és az érvénytelen címkéket. Ha véletlen elírjuk a címkét, akkor a CVSup úgy fog viselkedni, mintha olyan érvényes címkére hivatkozhatunk volna, amihez nem tartoznak állományok. Ennek következtében pedig egyszerûen letörli a már meglevõ forrásainkat.</p></div></td></tr></tbody></table></div><div class=paragraph><p>Egy ág címkéjének megadása során általában az adott fejlesztési vonal legfrissebb verzióját kapjuk meg. Ha viszont az adott ág valamelyik korábbi változatára lenne szükségünk, akkor a <code>date=</code> értékmezõ felhasználásával meg tudjuk adni a hozzá tartozó dátumot. Ennek mûködésérõl a <a href="https://man.freebsd.org/cgi/man.cgi?query=cvsup&amp;sektion=1&amp;format=html">cvsup(1)</a> man oldala részletesebben értekezik.</p></div><div class=paragraph><p>A példában mi most a FreeBSD-CURRENT verziót akarjuk letölteni. Ezért a következõ sort tesszük a <span class=filename>supfile</span> állományunk elejére:</p></div><div class="literalblock programlisting"><div class=content><pre>*default tag=.</pre></div></div><div class=paragraph><p>Ha nem adunk meg sem <code>tag=</code>, sem pedig <code>date=</code> mezõket, akkor egy fontos eset következik be. Ilyenkor ugyanis egy konkrét verzió helyett közvetlenül a szerver CVS repositoryjából kapjuk meg az állományokat, az összes kiegészítõ információjukkal együtt. A fejlesztõk általában ezt a típusú megoldást kedvelik, mivel így a saját rendszerükön is könnyen karban tudnak tartani egy példányt, amiben tudnak keresni a revíziók között és ki tudják kérni akár az állományok korábbi változatait is. Természetesen ennek függvényében jóval több tárhelyre van szükségük.</p></div></li><li><p><a id=cvsup-config-where></a>Honnan akarjuk ezeket beszerezni?</p><div class=paragraph><p>A <code>host=</code> mezõ beállításával közöljük a <code>cvsup</code> klienssel, honnan töltse le a frissítéseket. A <a href=#cvsup-mirrors>CVSup tükrözések</a> közül bármelyik megfelel erre a célra, habár leginkább azt érdemes választani, ami a kibertérben a hozzánk legközelebb esik. A példában most egy kitalált FreeBSD terjesztési oldalt választunk, a <code>cvsup99.FreeBSD.org</code>-ot:</p></div><div class="literalblock programlisting"><div class=content><pre>*default host=cvsup99.FreeBSD.org</pre></div></div><div class=paragraph><p>A CVSup futtatása elõtt tehát ne felejtsük el megváltoztatni ezt a létezõ számítógép hálózati nevére. A <code>cvsup</code> futtatásakor a <code>-h <em>hálózati név</em></code> opció megadásával lehetõségünk ennek felülbírálására.</p></div></li><li><p><a id=cvsup-config-dest></a>Hova akarjuk rakni a számítógépünkön?</p><div class=paragraph><p>A <code>prefix=</code> mezõ adja meg a <code>cvsup</code> számára, hogy hova tegye a kapott állományokat. A példában a forrásokat közvetlenül a forrásokat tároló központi könyvtárba, a <span class=filename>/usr/src</span> könyvtárba tettük. Mivel a <span class=filename>src</span> könyvtár neve már hallgatólagosan benne foglaltatik a letöltésre kiválasztott gyûjtemény nevében, ezért itt csak ennyit kell megadnunk:</p></div><div class="literalblock programlisting"><div class=content><pre>*default prefix=/usr</pre></div></div></li><li><p><a id=cvsup-config-status></a>Hova akarjuk rakni az állapotot tároló állományokat?</p><div class=paragraph><p>A CVSup kliens egy "bázisnak" (base) nevezett könyvtárban folyamatosan fenntart bizonyos állományokban állapotokat (status file). Ezek a már letöltött állományok nyilvántartásával segítik a CVSup hatékony munkavégzését. Mi most a szabványos bázist, a <span class=filename>/var/db</span> könyvtárat fogjuk használni:</p></div><div class="literalblock programlisting"><div class=content><pre>*default base=/var/db</pre></div></div><div class=paragraph><p>Amennyiben még nem létezne a bázisként használni kívánt könyvtár, ideje létrehoznunk. A <code>cvsup</code> ugyanis egy nem létezõ könyvtár esetén nem lesz hajlandó mûködni.</p></div></li><li><p>További beállítások a <span class=filename>supfile</span> állományban:</p><div class=paragraph><p>Általában még egy sor szokott szerepelni a <span class=filename>supfile</span> állományokban:</p></div><div class="literalblock programlisting"><div class=content><pre>*default release=cvs delete use-rel-suffix compress</pre></div></div><div class=paragraph><p>A <code>release=cvs</code> mezõ jelzi, hogy a szervernek a FreeBSD fõ CVS repositoryból kell kikeresnie az információkat. Tulajdonképpen majdnem mindig errõl van szó, és az itt megadható többi lehetõség ismertetése most egyébként is meghaladná a szakasz határait.</p></div><div class=paragraph><p>A <code>delete</code> hatására a CVSup képes lesz állományokat törölni. Mindig érdemes megadnunk, hiszen a CVSup csak így tudja teljes mértékben frissentartani a forrásokat. A CVSup természetesen csak azokat az állományokat igyekszik letörölni, amelyek miatt valóban felelõs. A kóbor állományokat nem fogja bántani.</p></div><div class=paragraph><p>A <code>use-rel-suffix</code> hatása egy igazi…​ Rejtély. Ha tényleg érdekel minket a mûködése, lapozzuk fel bátran a <a href="https://man.freebsd.org/cgi/man.cgi?query=cvsup&amp;sektion=1&amp;format=html">cvsup(1)</a> man oldalát. Nyugodtan adjuk meg és különösebben ne törõdjünk vele.</p></div><div class=paragraph><p>A <code>compress</code> beállítás segítségével a kommunikációs csatornán vándorló adatokat tudjuk gzip-szerû módon tömöríteni. Ha a hálózati kapcsolatunk sebessége meghaladja a 1,5 Mbitet másodpercenként (T1), akkor ezt már nem érdemes használni, viszont minden más esetben lényeges gyorsulást hozhat.</p></div></li><li><p>Összegezzük az eddigieket:</p><div class=paragraph><p>Íme a példaként összerakott <span class=filename>supfile</span> állományunk teljes tartalma:</p></div><div class="literalblock programlisting"><div class=content><pre>*default tag=.
*default host=cvsup99.FreeBSD.org
*default prefix=/usr
*default base=/var/db
*default release=cvs delete use-rel-suffix compress

src-all</pre></div></div></li></ul></div><div class=sect4><h5 id=cvsup-refuse-file>A.5.3.1. A <span class=filename>refuse</span> állomány<a class=anchor href=#cvsup-refuse-file></a></h5><div class=paragraph><p>Ahogy arról már korábban szó esett, a CVSup <em>lehúzással</em> frissít. Ez alapvetõen annyit jelent, hogy feltárcsázunk egy CVSup szervert, aki a következõt mondja nekünk: "A következõket tudod tõlem letölteni…​", amire a kliensünk ezt válaszolja: "Rendben, akkor nekem kell ez, ez, ez meg ez." Alapértelmezés szerint a CVSup kliense azokat az állományokat fogja letölteni, amelyeket a konfigurációs állományban szereplõ gyûjtemények és címkék által megneveztünk. Ez azonban nem mindig felel meg az igényeinknek, különösen akkor, amikor a <span class=filename>doc</span>, <span class=filename>ports</span> vagy <span class=filename>www</span> fákat akarjuk letölteni - az emberek többsége ugyanis nem beszél négy vagy öt nyelven, ezért nincs is szükségük a nyelvfüggõ állományok letöltésére. A Portgyûjtemény letöltése során a <em>ports-all</em> helyett egyszerûen egyenként is felsorolhatjuk a számunkra érdekes kategóriákat (például <em>ports-astrology</em>, <em>ports-biology</em> stb). Azonban mivel a <span class=filename>doc</span> és a <span class=filename>www</span> fákhoz nincsenek nyelvfüggõ gyûjtemények, ezért elõ kell halásznunk a CVSup egyik remek funkcióját, a <span class=filename>refuse</span> állományt.</p></div><div class=paragraph><p>A <span class=filename>refuse</span> állománnyal lényegében arra utasítjuk a CVSup alkalmazást, hogy a gyûjteményekbõl ne töltse le az összes állományt. Úgy is fogalmazhatnánk, hogy javaslatára a kliens <em>visszautasít</em> (refuse) bizonyos szervertõl érkezõ állományokat. Ezeket a visszautasításokat tároló <span class=filename>refuse</span> állományt a <span class=filename>bázis/sup/</span> könyvtárban találhatjuk meg (illetve ha még nincsenek, akkor ide kell rakunk ezeket). Itt a <em>bázis</em> a <span class=filename>supfile</span> állományban megadott <code>base=</code> mezõre utal, ami a példánkban a <span class=filename>/var/db</span> könyvtár volt. Ennek megfelelõen tehát a <span class=filename>refuse</span> állomány a <span class=filename>/var/db/sup/refuse</span> lesz.</p></div><div class=paragraph><p>A <span class=filename>refuse</span> állomány felépítése igen egyszerû: a letölteni nem kívánt állományok és könyvtárak neveit tartalmazza. Például ha az angolul mellett esetleg még beszélünk egy kevés németet is, de nincs szükségünk az angol dokumentáció német fordítására sem, akkor a következõket írjuk a <span class=filename>refuse</span> állományba:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>doc/bn_<span class=k>*</span>
doc/da_<span class=k>*</span>
doc/de_<span class=k>*</span>
doc/el_<span class=k>*</span>
doc/es_<span class=k>*</span>
doc/fr_<span class=k>*</span>
doc/hu_<span class=k>*</span>
doc/it_<span class=k>*</span>
doc/ja_<span class=k>*</span>
doc/mn_<span class=k>*</span>
doc/nl_<span class=k>*</span>
doc/no_<span class=k>*</span>
doc/pl_<span class=k>*</span>
doc/pt_<span class=k>*</span>
doc/ru_<span class=k>*</span>
doc/sr_<span class=k>*</span>
doc/tr_<span class=k>*</span>
doc/zh_<span class=k>*</span></code></pre></div></div><div class=paragraph><p>és így tovább a többi nyelvre is (melyeket a <a href=http://www.FreeBSD.org/cgi/cvsweb.cgi/>FreeBSD CVS repository</a> böngészésével deríthetjük ki).</p></div><div class=paragraph><p>Ezzel az alkalmas funkcióval a lassú vagy drága internetes kapcsolattal rendelkezõ felhasználók nagyon jól tudnak gazdálkodni, mivel így nem kell letölteniük az egyáltalán nem használt állományokat. A <span class=filename>refuse</span> állományokról és a CVSup más hasonlóan elegáns funkcióiról a saját man oldaláról tudhatunk meg többet.</p></div></div></div><div class=sect3><h4 id=_a_cvsup_futtatása>A.5.4. A CVSup futtatása<a class=anchor href=#_a_cvsup_futtatása></a></h4><div class=paragraph><p>Most már készen állunk egy próba frissítés elvégzésére. A parancssorban nem sok mindent kell beírnunk ehhez:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># cvsup supfile</span></code></pre></div></div><div class=paragraph><p>ahol a <span class=filename>supfile</span> a frissen létrehozott <span class=filename>supfile</span> állományunk neve lesz. Feltételezve, hogy a parancsot X11 alatt adtunk ki, az <code>cvsup</code> erre feldob egy grafikus ablakot néhány gombbal. Nyomjuk meg a <b class=button>go</b> feliratú gombot és dõljünk hátra.</p></div><div class=paragraph><p>Mivel a példában a <span class=filename>/usr/src</span> könyvtárunk frissítését állítottuk be, az állományok aktualizálásához szükséges jogosultságok biztosításához a <code>cvsup</code> programot <code>root</code> felhasználóként kell elindítanunk. Teljesen érthetõ, ha egy kicsit izgatottak vagyunk ezekben a pillanatokban, hiszen az elõbb hoztunk létre egy általunk eddig ismeretlen programhoz egy konfigurációs állományt. Ezért megemlítenénk, hogy ilyenkor elõször mindig próbáljuk ki a konfigurációkat, mielõtt azok bármilyen módosítást végeznének a fontos állományainkon. Ehhez hozzunk létre valahol egy üres könyvtárat, majd adjuk meg a parancssorban ennek a nevét:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># mkdir /var/tmp/proba</span>
<span class=c># cvsup supfile /var/tmp/proba</span></code></pre></div></div><div class=paragraph><p>Az így megadott könyvtárba kerülnek a frissítés eredményeképpen keletkezõ állományok. A CVSup elõször megvizsgálja a <span class=filename>/usr/src</span> könyvtárban található állományokat, viszont egyiküket sem módosítja vagy törli. A frissítések ehelyett a <span class=filename>/var/tmp/proba/usr/src</span> könyvtárba fognak kerülni. A CVSup emellett még a báziskönyvtárában tárolt állapotokat sem fogja megváltoztatni. A módosított állományok új változatai a megadott könyvtárba jönnek létre. Mivel a <span class=filename>/usr/src</span> könyvtárt ehhez csak olvasni fogjuk, a próba lefuttatásához még <code>root</code> felhasználónak sem kell lennünk.</p></div><div class=paragraph><p>Ha nem használunk X11-et vagy egyszerûen csak nincs szükségünk a grafikus felületre, a parancssorban pár további opció megadásával így is kiadhatjuk a <code>cvsup</code> parancsot:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># cvsup -g -L 2 supfile</span></code></pre></div></div><div class=paragraph><p>A <code>-g</code> hatására a CVSup nem hozza be a grafikus felületét. Ha nem talál X11-et, akkor ez természetesen automatikus, de ellenkezõ esetben ezt is meg kell adnunk.</p></div><div class=paragraph><p>Az <code>-L 2</code> megadásával a CVSup az összes elvégzendõ frissítésrõl részletes értesítést ad. A részletességnek három foka van, <code>-L 0</code>-tól indulva egészen <code>-L 2</code>-ig. Itt az alapértelmezett érték a 0, amivel a hibaüzenetek kivételével egyetlen üzenetet sem kapunk.</p></div><div class=paragraph><p>Rengeteg egyéb beállítás adható még meg, ezeket a <code>cvsup -H</code> kiadásával kérdezhetjük le. A beállítások pontosabb leírását a man oldalon találjuk meg.</p></div><div class=paragraph><p>Miután elégedetten tapasztaltuk, hogy a frissítés remekül mûködik, a <a href="https://man.freebsd.org/cgi/man.cgi?query=cron&amp;sektion=8&amp;format=html">cron(8)</a> segítségével próbáljuk meg az egész folyamatot önmûködövé tenni a CVSup szabályos idõközönkénti futtatásával. Ekkor viszont magától értetõdik, hogy a CVSup számára ne engedjük használni a grafikus felületet.</p></div></div><div class=sect3><h4 id=cvsup-collec>A.5.5. A CVSup állománygyûjteményei<a class=anchor href=#cvsup-collec></a></h4><div class=paragraph><p>A CVSup révén elérhetõ állománygyûjtemények egy hierarchikus rendszert alkotnak. Van néhány nagyobb állománygyûjtemény, amelyek kisebb al-állománygyûjteményekre bonthatóak. A nagyobb gyûjtemények letöltése ezért a kisebb algyûjtemények letöltésével egyenlõ. A gyûjtemények közt fennálló hierarchikus rendszer a lentebb szereplõ lista behúzásaiban érhetõ tetten.</p></div><div class=paragraph><p>A leggyakrabban használt gyûjtemények a <code>src-all</code> és a <code>ports-all</code> neveket viselik. A többi gyûjteményt általában csak kevesen és csak speciális célokra használják, ezért egyes tükrözéseken nem feltétlenül találjuk meg mindegyiküket.</p></div><div class=dlist><dl><dt class=hdlist1><code>cvs-all release=cvs</code></dt><dd><p>A FreeBSD fõ CVS repositoryja, beleértve a titkosításhoz tartozó kódokat is.</p><div class=dlist><dl><dt class=hdlist1><code>distrib release=cvs</code></dt><dd><p>A FreeBSD terjesztéséhez és tükrözéséhez kapcsolódó állományok.</p></dd><dt class=hdlist1><code>doc-all release=cvs</code></dt><dd><p>A FreeBSD kézikönyvének és a többi dokumentáció forrásai. Nem tartalmazza a FreeBSD honlapjának forrásait.</p></dd><dt class=hdlist1><code>ports-all release=cvs</code></dt><dd><p>A FreeBSD portgyûjteménye.</p><div class="admonitionblock important"><table><tbody><tr><td class=icon><i class="fa icon-important" title=Important></i></td><td class=content><div class=paragraph><p>Ha nem akarjuk a <code>ports-all</code> egészét (vagyis a teljes portfát) frissíteni, csak a lentebb szereplõ egyes algyûjteményeket letölteni, akkor <em>soha</em> ne feledkezzünk meg a <code>ports-base</code> megadásáról! Amikor valami változik a portok mûködésében, akkor a <code>ports-base</code> által képviselt algyûjteményben szereplõ állományokat igen gyorsan elkezdik használni a "valódi" portok. Ezért ha csak a "valódi" portokat frissítjük, amelyek viszont igényt tartanak néhány újabb funkcióra is, akkor könnyen fordítási hibára vagy különbözõ rejtélyes hibaüzenetekbe futhatunk. Emiatt <em>legeslegelõször</em> mindig tegyünk róla, hogy a <code>ports-base</code> algyûjteményünk a lehetõ legfrissebb legyen.</p></div></td></tr></tbody></table></div><div class="admonitionblock important"><table><tbody><tr><td class=icon><i class="fa icon-important" title=Important></i></td><td class=content><div class=paragraph><p>Ha a <span class=filename>ports/INDEX</span> állomány egy saját példányát kívánjuk létrehozni, akkor ahhoz a <code>ports-all</code> gyûjteményt (tehát a teljes portfát) le <em>kell</em> kérnünk. A <span class=filename>ports/INDEX</span> állományt a portfa egy része alapján nem készíthetjük el. Errõl bõvebben lásd a <a href=https://docs.freebsd.org/hu/books/faq/#MAKE-INDEX>GYIK</a>-ot.</p></div></td></tr></tbody></table></div><div class=dlist><dl><dt class=hdlist1><code>ports-accessibility release=cvs</code></dt><dd><p>A fogyatékos felhasználókat segítõ szoftverek.</p></dd><dt class=hdlist1><code>ports-arabic release=cvs</code></dt><dd><p>Arab nyelvi támogatás.</p></dd><dt class=hdlist1><code>ports-archivers release=cvs</code></dt><dd><p>Archiváló eszközök.</p></dd><dt class=hdlist1><code>ports-astro release=cvs</code></dt><dd><p>Csillagászathoz tartozó portok.</p></dd><dt class=hdlist1><code>ports-audio release=cvs</code></dt><dd><p>Hangtámogatás.</p></dd><dt class=hdlist1><code>ports-base release=cvs</code></dt><dd><p>A Portgyûjtemény saját infrastruktúrája - az <span class=filename>Mk/</span>, <span class=filename>Tools/</span> és <span class=filename>/usr/ports</span> különféle alkönyvtáraiban elhelyezkedõ állományok.</p><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Ne hagyjuk figyelmen kívül <a href=#cvsup-collec-pbase-warn>a fenti fontos figyelmeztetést</a> sem: ezt az algyûjteményt <em>mindig</em> a FreeBSD Portgyûjteményével együtt frissítsük!</p></div></td></tr></tbody></table></div></dd><dt class=hdlist1><code>ports-benchmarks release=cvs</code></dt><dd><p>Teljesítménytesztek.</p></dd><dt class=hdlist1><code>ports-biology release=cvs</code></dt><dd><p>Biológia.</p></dd><dt class=hdlist1><code>ports-cad release=cvs</code></dt><dd><p>Számítógépes tervezõeszközök (CAD).</p></dd><dt class=hdlist1><code>ports-chinese release=cvs</code></dt><dd><p>Kínai nyelvi támogatás.</p></dd><dt class=hdlist1><code>ports-comms release=cvs</code></dt><dd><p>Kommunikációs szoftverek.</p></dd><dt class=hdlist1><code>ports-converters release=cvs</code></dt><dd><p>Karakterkódolások közti átalakítók.</p></dd><dt class=hdlist1><code>ports-databases release=cvs</code></dt><dd><p>Adatbázisok.</p></dd><dt class=hdlist1><code>ports-deskutils release=cvs</code></dt><dd><p>A számítógép feltalálása elõtt is már létezõ eszközök.</p></dd><dt class=hdlist1><code>ports-devel release=cvs</code></dt><dd><p>Fejlesztõeszközök.</p></dd><dt class=hdlist1><code>ports-dns release=cvs</code></dt><dd><p>Névfeloldással kapcsolatos szoftverek.</p></dd><dt class=hdlist1><code>ports-editors release=cvs</code></dt><dd><p>Szövegszerkesztõk.</p></dd><dt class=hdlist1><code>ports-emulators release=cvs</code></dt><dd><p>Más operációs rendszerek emulátorai.</p></dd><dt class=hdlist1><code>ports-finance release=cvs</code></dt><dd><p>Pénzügyi, gazdasági és hasonló alkalmazások.</p></dd><dt class=hdlist1><code>ports-ftp release=cvs</code></dt><dd><p>FTP kliensek és szerverek.</p></dd><dt class=hdlist1><code>ports-games release=cvs</code></dt><dd><p>Játékok.</p></dd><dt class=hdlist1><code>ports-german release=cvs</code></dt><dd><p>Német nyelvi támogatás.</p></dd><dt class=hdlist1><code>ports-graphics release=cvs</code></dt><dd><p>Grafikus segédeszközök.</p></dd><dt class=hdlist1><code>ports-hebrew release=cvs</code></dt><dd><p>Héber nyelvi támogatás.</p></dd><dt class=hdlist1><code>ports-hungarian release=cvs</code></dt><dd><p>Magyar nyelvi támogatás.</p></dd><dt class=hdlist1><code>ports-irc release=cvs</code></dt><dd><p>IRC-vel kapcsolatos programok.</p></dd><dt class=hdlist1><code>ports-japanese release=cvs</code></dt><dd><p>Japán nyelvi támogatás.</p></dd><dt class=hdlist1><code>ports-java release=cvs</code></dt><dd><p>Java™ segédeszközök.</p></dd><dt class=hdlist1><code>ports-korean release=cvs</code></dt><dd><p>Koreai nyelvi támogatás.</p></dd><dt class=hdlist1><code>ports-lang release=cvs</code></dt><dd><p>Programozási nyelvek.</p></dd><dt class=hdlist1><code>ports-mail release=cvs</code></dt><dd><p>Levelezõ programok.</p></dd><dt class=hdlist1><code>ports-math release=cvs</code></dt><dd><p>Numerikus számításokkal foglalkozó programok.</p></dd><dt class=hdlist1><code>ports-mbone release=cvs</code></dt><dd><p>MBone alkalmazások.</p></dd><dt class=hdlist1><code>ports-misc release=cvs</code></dt><dd><p>Egyéb segédprogramok.</p></dd><dt class=hdlist1><code>ports-multimedia release=cvs</code></dt><dd><p>Multimediás szoftverek.</p></dd><dt class=hdlist1><code>ports-net release=cvs</code></dt><dd><p>Hálózati szoftverek.</p></dd><dt class=hdlist1><code>ports-net-im release=cvs</code></dt><dd><p>Üzenetküldõ (Instant Messaging, IM) szoftverek.</p></dd><dt class=hdlist1><code>ports-net-mgmt release=cvs</code></dt><dd><p>Hálózati karbantartó szoftverek.</p></dd><dt class=hdlist1><code>ports-net-p2p release=cvs</code></dt><dd><p>Egyenrangú (Peer to Peer, P2P) hálózatok.</p></dd><dt class=hdlist1><code>ports-news release=cvs</code></dt><dd><p>USENET hírszoftverek.</p></dd><dt class=hdlist1><code>ports-palm release=cvs</code></dt><dd><p>A Palm™ sorozat szoftveres támogatása.</p></dd><dt class=hdlist1><code>ports-polish release=cvs</code></dt><dd><p>Lengyel nyelvi támogatás.</p></dd><dt class=hdlist1><code>ports-ports-mgmt release=cvs</code></dt><dd><p>A portok és csomagok karbantartását végzõ segédeszközök.</p></dd><dt class=hdlist1><code>ports-portuguese release=cvs</code></dt><dd><p>Portugál nyelvi támogatás.</p></dd><dt class=hdlist1><code>ports-print release=cvs</code></dt><dd><p>Nyomdai programok.</p></dd><dt class=hdlist1><code>ports-russian release=cvs</code></dt><dd><p>Orosz nyelvi támogatás.</p></dd><dt class=hdlist1><code>ports-science release=cvs</code></dt><dd><p>Tudományos programok.</p></dd><dt class=hdlist1><code>ports-security release=cvs</code></dt><dd><p>Biztonsági segédprogramok.</p></dd><dt class=hdlist1><code>ports-shells release=cvs</code></dt><dd><p>Parancsértelmezõk.</p></dd><dt class=hdlist1><code>ports-sysutils release=cvs</code></dt><dd><p>Rendszerprogramok.</p></dd><dt class=hdlist1><code>ports-textproc release=cvs</code></dt><dd><p>Szövegfeldolgozást segítõ eszközök (kivéve az asztali kiadványszerkesztést).</p></dd><dt class=hdlist1><code>ports-ukrainian release=cvs</code></dt><dd><p>Ukrán nyelvi támogatás.</p></dd><dt class=hdlist1><code>ports-vietnamese release=cvs</code></dt><dd><p>Vietnámi nyelvi támogatás.</p></dd><dt class=hdlist1><code>ports-www release=cvs</code></dt><dd><p>A világhálóhoz tartozó szoftverek.</p></dd><dt class=hdlist1><code>ports-x11 release=cvs</code></dt><dd><p>Az X Window System mûködését segítõ portok.</p></dd><dt class=hdlist1><code>ports-x11-clocks release=cvs</code></dt><dd><p>X11 órák.</p></dd><dt class=hdlist1><code>ports-x11-drivers release=cvs</code></dt><dd><p>X11 meghajtók.</p></dd><dt class=hdlist1><code>ports-x11-fm release=cvs</code></dt><dd><p>X11 állománykezelõk.</p></dd><dt class=hdlist1><code>ports-x11-fonts release=cvs</code></dt><dd><p>X11 betûtípusok és a hozzájuk tartozó segédprogramok.</p></dd><dt class=hdlist1><code>ports-x11-toolkits release=cvs</code></dt><dd><p>X11 eszközrendszerek.</p></dd><dt class=hdlist1><code>ports-x11-servers release=cvs</code></dt><dd><p>X11 szerverek.</p></dd><dt class=hdlist1><code>ports-x11-themes release=cvs</code></dt><dd><p>X11 témák.</p></dd><dt class=hdlist1><code>ports-x11-wm release=cvs</code></dt><dd><p>X11 ablakkezelõk.</p></dd></dl></div></dd><dt class=hdlist1><code>projects-all release=cvs</code></dt><dd><p>A FreeBSD projektek forrásainak repositoryja.</p></dd><dt class=hdlist1><code>src-all release=cvs</code></dt><dd><p>A FreeBSD fontosabb forrásai, a titkosításhoz tartozó kódokkal együtt.</p><div class=dlist><dl><dt class=hdlist1><code>src-base release=cvs</code></dt><dd><p>A <span class=filename>/usr/src</span> könyvtárban levõ egyéb állományok.</p></dd><dt class=hdlist1><code>src-bin release=cvs</code></dt><dd><p>Az egyfelhasználós módban használható segédeszközök (<span class=filename>/usr/src/bin</span>).</p></dd><dt class=hdlist1><code>src-cddl release=cvs</code></dt><dd><p>A CDDL licenc szerint terjesztett segédprogramok és függvénykönyvtárak (<span class=filename>/usr/src/cddl</span>).</p></dd><dt class=hdlist1><code>src-contrib release=cvs</code></dt><dd><p>A FreeBSD Projekten kívül fejlesztett segédprogramok és függvénykönyvtárak, viszonylag kevés módosítással (<span class=filename>/usr/src/contrib</span>).</p></dd><dt class=hdlist1><code>src-crypto release=cvs</code></dt><dd><p>A FreeBSD Projekten kívül fejlesztett, titkosítással kapcsolatos segédprogramok és függvénykönyvtárak, viszonylag kevés módosítással (<span class=filename>/usr/src/crypto</span>).</p></dd><dt class=hdlist1><code>src-eBones release=cvs</code></dt><dd><p>Kerberos és DES (<span class=filename>/usr/src/eBones</span>). A FreeBSD jelenlegi változatai nem használják.</p></dd><dt class=hdlist1><code>src-etc release=cvs</code></dt><dd><p>A rendszer beállításait tartalmazó állományok (<span class=filename>/usr/src/etc</span>).</p></dd><dt class=hdlist1><code>src-games release=cvs</code></dt><dd><p>Játékok (<span class=filename>/usr/src/games</span>).</p></dd><dt class=hdlist1><code>src-gnu release=cvs</code></dt><dd><p>A GPL licenc szerint terjesztett segédprogramok (<span class=filename>/usr/src/gnu</span>).</p></dd><dt class=hdlist1><code>src-include release=cvs</code></dt><dd><p>(C nyelvi) Header állományok (<span class=filename>/usr/src/include</span>).</p></dd><dt class=hdlist1><code>src-kerberos5 release=cvs</code></dt><dd><p>A Kerberos5 biztonsági csomag (<span class=filename>/usr/src/kerberos5</span>).</p></dd><dt class=hdlist1><code>src-kerberosIV release=cvs</code></dt><dd><p>A KerberosIV biztonsági csomag (<span class=filename>/usr/src/kerberosIV</span>).</p></dd><dt class=hdlist1><code>src-lib release=cvs</code></dt><dd><p>Függvénykönyvtárak (<span class=filename>/usr/src/lib</span>).</p></dd><dt class=hdlist1><code>src-libexec release=cvs</code></dt><dd><p>Más programok által futtatott rendszerprogramok (<span class=filename>/usr/src/libexec</span>).</p></dd><dt class=hdlist1><code>src-release release=cvs</code></dt><dd><p>A FreeBSD kiadások elkészítéséhez szükséges állományok (<span class=filename>/usr/src/release</span>).</p></dd><dt class=hdlist1><code>src-rescue release=cvs</code></dt><dd><p>Statikusan linkelt programok vészhelyzet esetére, lásd <a href="https://man.freebsd.org/cgi/man.cgi?query=rescue&amp;sektion=8&amp;format=html">rescue(8)</a> (<span class=filename>/usr/src/rescue</span>).</p></dd><dt class=hdlist1><code>src-sbin release=cvs</code></dt><dd><p>Egyfelhasználós módban használható rendszereszközök (<span class=filename>/usr/src/sbin</span>).</p></dd><dt class=hdlist1><code>src-secure release=cvs</code></dt><dd><p>Titkosítással foglalkozó függvénykönyvtárak és parancsok (<span class=filename>/usr/src/secure</span>).</p></dd><dt class=hdlist1><code>src-share release=cvs</code></dt><dd><p>Több rendszer között megosztható állományok (<span class=filename>/usr/src/share</span>).</p></dd><dt class=hdlist1><code>src-sys release=cvs</code></dt><dd><p>A rendszermag (<span class=filename>/usr/src/sys</span>).</p></dd><dt class=hdlist1><code>src-sys-crypto release=cvs</code></dt><dd><p>A rendszermagban levõ titkosítással foglalkozó kód (<span class=filename>/usr/src/sys/crypto</span>).</p></dd><dt class=hdlist1><code>src-tools release=cvs</code></dt><dd><p>A FreeBSD karbantartására való különbözõ segédprogramok (<span class=filename>/usr/src/tools</span>).</p></dd><dt class=hdlist1><code>src-usrbin release=cvs</code></dt><dd><p>Felhasználói segédprogramok (<span class=filename>/usr/src/usr.bin</span>).</p></dd><dt class=hdlist1><code>src-usrsbin release=cvs</code></dt><dd><p>Rendszerszintû segédprogramok (<span class=filename>/usr/src/usr.sbin</span>).</p></dd></dl></div></dd><dt class=hdlist1><code>www release=cvs</code></dt><dd><p>A FreeBSD Projekt honlapjának forráskódja.</p></dd></dl></div></dd><dt class=hdlist1><code>distrib release=self</code></dt><dd><p>A CVSup szerver saját konfigurációs állományai. A CVSup tükrözései használják.</p></dd><dt class=hdlist1><code>gnats release=current</code></dt><dd><p>A GNATS hibanyilvántartó adatbázis.</p></dd><dt class=hdlist1><code>mail-archive release=current</code></dt><dd><p>A FreeBSD levelezési listáinak archívuma.</p></dd><dt class=hdlist1><code>www release=current</code></dt><dd><p>A FreeBSD Projekt honlapjának generált állományai (de nem a forrásai). A WWW tükrözések használják.</p></dd></dl></div></div><div class=sect3><h4 id=_bõvebb_információk>A.5.6. Bõvebb információk<a class=anchor href=#_bõvebb_információk></a></h4><div class=paragraph><p>A CVSup részletesebb bemutatását és a hozzá tartozó GYIK-ot <a href=http://www.cvsup.org>A CVSup honlapján</a> találjuk meg.</p></div><div class=paragraph><p>A CVSup FreeBSD-re vonatkozó tárgyalása a <a href=https://lists.FreeBSD.org/subscription/freebsd-hackers>FreeBSD technical discussions levelezési lista</a>n történik. Itt és az <a href=https://lists.FreeBSD.org/subscription/freebsd-announce>FreeBSD announcements levelezési lista</a>n jelentik be a szoftver újabb változatait.</p></div><div class=paragraph><p>A CVSup alkalmazással kapcsolatos kérdéseket és hibajelentéseket illetõen a <a href=http://www.cvsup.org/faq.html#bugreports>CVSup GYIK</a>-ot érdemes megnéznünk.</p></div></div><div class=sect3><h4 id=cvsup-mirrors>A.5.7. CVSup oldalak<a class=anchor href=#cvsup-mirrors></a></h4><div class=paragraph><p>A FreeBSD <a href=#cvsup>CVSup</a> szerverei az alábbi oldalakon érhetõek el:</p></div></div></div><div class=sect2><h3 id=cvs-tags>A.6. CVS címkék<a class=anchor href=#cvs-tags></a></h3><div class=paragraph><p>Meg kell adnunk egy revízió címkéjét, amikor a cvs vagy CVSup használatával letöltjük vagy frissítjük a forrásokat. A revíziós címkék a FreeBSD egyik fejlesztési irányát vagy egy adott idõpontbeli állapotát hivatkozzák. Az elõbbi egy "ág címkéje", míg az utóbbi pedig egy "kiadás címkéje".</p></div><div class=sect3><h4 id=_az_ágak_címkéi>A.6.1. Az ágak címkéi<a class=anchor href=#_az_ágak_címkéi></a></h4><div class=paragraph><p>A <code>HEAD</code> kivételével (amely mindig egy érvényes címke) az összes címke csak a <span class=filename>src/</span> fára vonatkozik. A <span class=filename>ports/</span>, <span class=filename>doc/</span> és <span class=filename>www/</span> fák nem tartalmaznak ágakat.</p></div><div class=dlist><dl><dt class=hdlist1>HEAD</dt><dd><p>A fõ fejlesztési ág, avagy a FreeBSD-CURRENT szimbolikus neve. Ha nem adunk meg revíziót, ez lesz az alapértelmezés.</p><div class=paragraph><p>A CVSup számára ezt <code>.</code> címke jelzi (itt most nem mondatvégi pontot jelöli, hanem a <code>.</code> karaktert).</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>A CVS számára ez lesz az alapértelmezett érték, ha nem adunk meg konkrét revíziós címkét. Többnyire <em>nem</em> túlzottan jó ötlet egy STABLE változatot használó gépen a CURRENT verziójú források kikérése, kivéve hacsak nem ez a szándékunk.</p></div></td></tr></tbody></table></div></dd><dt class=hdlist1>RELENG_8</dt><dd><p>A FreeBSD-8.X fejlesztési ága, más néven a FreeBSD 8-STABLE</p></dd><dt class=hdlist1>RELENG_8_1</dt><dd><p>A FreeBSD-8.1 kiadás ága, ahová csak a biztonsági frissítések és a kritikus hibajavítások kerülnek.</p></dd><dt class=hdlist1>RELENG_8_0</dt><dd><p>A FreeBSD-8.0 kiadás ága, ahová csak a biztonsági frissítések és a kritikus hibajavítások kerülnek.</p></dd><dt class=hdlist1>RELENG_7</dt><dd><p>A FreeBSD-7.X fejlesztési ága, más néven a FreeBSD 7-STABLE</p></dd><dt class=hdlist1>RELENG_7_3</dt><dd><p>A FreeBSD-7.3 kiadás ága, ahová csak a biztonsági frissítések és a kritikus hibajavítások kerülnek.</p></dd><dt class=hdlist1>RELENG_7_2</dt><dd><p>A FreeBSD-7.2 kiadás ága, ahová csak a biztonsági frissítések és a kritikus hibajavítások kerülnek.</p></dd><dt class=hdlist1>RELENG_7_1</dt><dd><p>A FreeBSD-7.1 kiadás ága, ahová csak a biztonsági frissítések és a kritikus hibajavítások kerülnek.</p></dd><dt class=hdlist1>RELENG_7_0</dt><dd><p>A FreeBSD-7.0 kiadás ága, ahová csak a biztonsági frissítések és a kritikus hibajavítások kerülnek.</p></dd><dt class=hdlist1>RELENG_6</dt><dd><p>A FreeBSD-6.X fejlesztési ága, más néven a FreeBSD 6-STABLE</p></dd><dt class=hdlist1>RELENG_6_4</dt><dd><p>A FreeBSD-6.4 kiadás ága, ahová csak biztonsági frissítések és a kritikus hibajavítások kerülnek.</p></dd><dt class=hdlist1>RELENG_6_3</dt><dd><p>A FreeBSD-6.3 kiadás ága, ahová csak biztonsági frissítések és a kritikus hibajavítások kerülnek.</p></dd><dt class=hdlist1>RELENG_6_2</dt><dd><p>A FreeBSD-6.2 kiadás ága, ahová csak biztonsági frissítések és a kritikus hibajavítások kerülnek.</p></dd><dt class=hdlist1>RELENG_6_1</dt><dd><p>A FreeBSD-6.1 kiadás ága, ahová csak biztonsági frissítések és a kritikus hibajavítások kerülnek.</p></dd><dt class=hdlist1>RELENG_6_0</dt><dd><p>A FreeBSD-6.0 kiadás ága, ahová csak biztonsági frissítések és a kritikus hibajavítások kerülnek.</p></dd><dt class=hdlist1>RELENG_5</dt><dd><p>A FreeBSD-5.X fejlesztési ág, más néven a FreeBSD 5-STABLE.</p></dd><dt class=hdlist1>RELENG_5_5</dt><dd><p>A FreeBSD-5.5 kiadás ága, ahová csak biztonsági frissítések és a kritikus hibajavítások kerülnek.</p></dd><dt class=hdlist1>RELENG_5_4</dt><dd><p>A FreeBSD-5.4 kiadás ága, ahová csak biztonsági frissítések és a kritikus hibajavítások kerülnek.</p></dd><dt class=hdlist1>RELENG_5_3</dt><dd><p>A FreeBSD-5.3 kiadás ága, ahová csak biztonsági frissítések és a kritikus hibajavítások kerülnek.</p></dd><dt class=hdlist1>RELENG_5_2</dt><dd><p>A FreeBSD-5.2 és FreeBSD-5.2.1 kiadások ága, ahová csak biztonsági frissítések és a kritikus hibajavítások kerülnek.</p></dd><dt class=hdlist1>RELENG_5_1</dt><dd><p>A FreeBSD-5.1 kiadás ága, ahová csak biztonsági frissítések és a kritikus hibajavítások kerülnek.</p></dd><dt class=hdlist1>RELENG_5_0</dt><dd><p>A FreeBSD-5.0 kiadás ága, ahová csak biztonsági frissítések és a kritikus hibajavítások kerülnek.</p></dd><dt class=hdlist1>RELENG_4</dt><dd><p>A FreeBSD-4.X fejlesztési ága, más néven a FreeBSD 4-STABLE.</p></dd><dt class=hdlist1>RELENG_4_11</dt><dd><p>A FreeBSD-4.11 kiadás ága, ahová csak biztonsági frissítések és a kritikus hibajavítások kerülnek.</p></dd><dt class=hdlist1>RELENG_4_10</dt><dd><p>A FreeBSD-4.10 kiadás ága, ahová csak biztonsági frissítések és a kritikus hibajavítások kerülnek.</p></dd><dt class=hdlist1>RELENG_4_9</dt><dd><p>A FreeBSD-4.9 kiadás ága, ahová csak biztonsági frissítések és a kritikus hibajavítások kerülnek.</p></dd><dt class=hdlist1>RELENG_4_8</dt><dd><p>A FreeBSD-4.8 kiadás ága, ahová csak biztonsági frissítések és a kritikus hibajavítások kerülnek.</p></dd><dt class=hdlist1>RELENG_4_7</dt><dd><p>A FreeBSD-4.7 kiadás ága, ahová csak biztonsági frissítések és a kritikus hibajavítások kerülnek.</p></dd><dt class=hdlist1>RELENG_4_6</dt><dd><p>A FreeBSD-4.6 és FreeBSD-4.6.2 kiadások ága, ahová csak biztonsági frissítések és a kritikus hibajavítások kerülnek.</p></dd><dt class=hdlist1>RELENG_4_5</dt><dd><p>A FreeBSD-4.5 kiadás ága, ahová csak biztonsági frissítések és a kritikus hibajavítások kerülnek.</p></dd><dt class=hdlist1>RELENG_4_4</dt><dd><p>A FreeBSD-4.4 kiadás ága, ahová csak biztonsági frissítések és a kritikus hibajavítások kerülnek.</p></dd><dt class=hdlist1>RELENG_4_3</dt><dd><p>A FreeBSD-4.3 kiadás ága, ahová csak biztonsági frissítések és a kritikus hibajavítások kerülnek.</p></dd><dt class=hdlist1>RELENG_3</dt><dd><p>A FreeBSD-3.X fejlesztési ága, más néven a 3.X-STABLE.</p></dd><dt class=hdlist1>RELENG_2_2</dt><dd><p>A FreeBSD-2.2.X fejlesztési ága, más néven a 2.2-STABLE. Ez az ág manapság már elavult.</p></dd></dl></div></div><div class=sect3><h4 id=_a_kiadások_címkéi>A.6.2. A kiadások címkéi<a class=anchor href=#_a_kiadások_címkéi></a></h4><div class=paragraph><p>Ezek a címkék a FreeBSD egyes kiadásainak dátumára hivatkoznak. Egy kiadás elõkészítésének és terjesztésének folyamatáról részleteiben a <a href=https://www.FreeBSD.org/releng/>kiadásokat összefoglaló lapról</a> és a <a href=https://docs.freebsd.org/en/articles/releng/#release-proc>kiadások építésérõl szóló cikkbõl</a> tájékozódhatunk. Az <span class=filename>src</span> fában <code>RELENG_</code> kezdetû címkéket találunk. A <span class=filename>ports</span> és <span class=filename>doc</span> fákban a címkék nevei a <code>RELEASE</code> elõtaggal kezdõdnek. Végezetül a <span class=filename>www</span> fában nincsenek kiadásokhoz tartozó címkék.</p></div><div class=dlist><dl><dt class=hdlist1>RELENG_8_1_0_RELEASE</dt><dd><p>FreeBSD 8.1</p></dd><dt class=hdlist1>RELENG_8_0_0_RELEASE</dt><dd><p>FreeBSD 8.0</p></dd><dt class=hdlist1>RELENG_7_3_0_RELEASE</dt><dd><p>FreeBSD 7.3</p></dd><dt class=hdlist1>RELENG_7_2_0_RELEASE</dt><dd><p>FreeBSD 7.2</p></dd><dt class=hdlist1>RELENG_7_1_0_RELEASE</dt><dd><p>FreeBSD 7.1</p></dd><dt class=hdlist1>RELENG_7_0_0_RELEASE</dt><dd><p>FreeBSD 7.0</p></dd><dt class=hdlist1>RELENG_6_4_0_RELEASE</dt><dd><p>FreeBSD 6.4</p></dd><dt class=hdlist1>RELENG_6_3_0_RELEASE</dt><dd><p>FreeBSD 6.3</p></dd><dt class=hdlist1>RELENG_6_2_0_RELEASE</dt><dd><p>FreeBSD 6.2</p></dd><dt class=hdlist1>RELENG_6_1_0_RELEASE</dt><dd><p>FreeBSD 6.1</p></dd><dt class=hdlist1>RELENG_6_0_0_RELEASE</dt><dd><p>FreeBSD 6.0</p></dd><dt class=hdlist1>RELENG_5_5_0_RELEASE</dt><dd><p>FreeBSD 5.5</p></dd><dt class=hdlist1>RELENG_5_4_0_RELEASE</dt><dd><p>FreeBSD 5.4</p></dd><dt class=hdlist1>RELENG_4_11_0_RELEASE</dt><dd><p>FreeBSD 4.11</p></dd><dt class=hdlist1>RELENG_5_3_0_RELEASE</dt><dd><p>FreeBSD 5.3</p></dd><dt class=hdlist1>RELENG_4_10_0_RELEASE</dt><dd><p>FreeBSD 4.10</p></dd><dt class=hdlist1>RELENG_5_2_1_RELEASE</dt><dd><p>FreeBSD 5.2.1</p></dd><dt class=hdlist1>RELENG_5_2_0_RELEASE</dt><dd><p>FreeBSD 5.2</p></dd><dt class=hdlist1>RELENG_4_9_0_RELEASE</dt><dd><p>FreeBSD 4.9</p></dd><dt class=hdlist1>RELENG_5_1_0_RELEASE</dt><dd><p>FreeBSD 5.1</p></dd><dt class=hdlist1>RELENG_4_8_0_RELEASE</dt><dd><p>FreeBSD 4.8</p></dd><dt class=hdlist1>RELENG_5_0_0_RELEASE</dt><dd><p>FreeBSD 5.0</p></dd><dt class=hdlist1>RELENG_4_7_0_RELEASE</dt><dd><p>FreeBSD 4.7</p></dd><dt class=hdlist1>RELENG_4_6_2_RELEASE</dt><dd><p>FreeBSD 4.6.2</p></dd><dt class=hdlist1>RELENG_4_6_1_RELEASE</dt><dd><p>FreeBSD 4.6.1</p></dd><dt class=hdlist1>RELENG_4_6_0_RELEASE</dt><dd><p>FreeBSD 4.6</p></dd><dt class=hdlist1>RELENG_4_5_0_RELEASE</dt><dd><p>FreeBSD 4.5</p></dd><dt class=hdlist1>RELENG_4_4_0_RELEASE</dt><dd><p>FreeBSD 4.4</p></dd><dt class=hdlist1>RELENG_4_3_0_RELEASE</dt><dd><p>FreeBSD 4.3</p></dd><dt class=hdlist1>RELENG_4_2_0_RELEASE</dt><dd><p>FreeBSD 4.2</p></dd><dt class=hdlist1>RELENG_4_1_1_RELEASE</dt><dd><p>FreeBSD 4.1.1</p></dd><dt class=hdlist1>RELENG_4_1_0_RELEASE</dt><dd><p>FreeBSD 4.1</p></dd><dt class=hdlist1>RELENG_4_0_0_RELEASE</dt><dd><p>FreeBSD 4.0</p></dd><dt class=hdlist1>RELENG_3_5_0_RELEASE</dt><dd><p>FreeBSD 3.5</p></dd><dt class=hdlist1>RELENG_3_4_0_RELEASE</dt><dd><p>FreeBSD 3.4</p></dd><dt class=hdlist1>RELENG_3_3_0_RELEASE</dt><dd><p>FreeBSD 3.3</p></dd><dt class=hdlist1>RELENG_3_2_0_RELEASE</dt><dd><p>FreeBSD 3.2</p></dd><dt class=hdlist1>RELENG_3_1_0_RELEASE</dt><dd><p>FreeBSD 3.1</p></dd><dt class=hdlist1>RELENG_3_0_0_RELEASE</dt><dd><p>FreeBSD 3.0</p></dd><dt class=hdlist1>RELENG_2_2_8_RELEASE</dt><dd><p>FreeBSD 2.2.8</p></dd><dt class=hdlist1>RELENG_2_2_7_RELEASE</dt><dd><p>FreeBSD 2.2.7</p></dd><dt class=hdlist1>RELENG_2_2_6_RELEASE</dt><dd><p>FreeBSD 2.2.6</p></dd><dt class=hdlist1>RELENG_2_2_5_RELEASE</dt><dd><p>FreeBSD 2.2.5</p></dd><dt class=hdlist1>RELENG_2_2_2_RELEASE</dt><dd><p>FreeBSD 2.2.2</p></dd><dt class=hdlist1>RELENG_2_2_1_RELEASE</dt><dd><p>FreeBSD 2.2.1</p></dd><dt class=hdlist1>RELENG_2_2_0_RELEASE</dt><dd><p>FreeBSD 2.2.0</p></dd></dl></div></div></div><div class=sect2><h3 id=mirrors-afs>A.7. AFS oldalak<a class=anchor href=#mirrors-afs></a></h3><div class=paragraph><p>A FreeBSD a következõ szerverein érhetõ el AFS:</p></div><div class=dlist><dl><dt class=hdlist1>Svédország</dt><dd><p>Az állományok a következõ helyen érhetõek el: <span class=filename>/afs/stacken.kth.se/ftp/pub/FreeBSD/</span></p><div class="literalblock programlisting"><div class=content><pre>stacken.kth.se         # Stacken Computer Club, KTH, Svédország
130.237.234.43         #hot.stacken.kth.se
130.237.237.230        #fishburger.stacken.kth.se
130.237.234.3          #milko.stacken.kth.se</pre></div></div><div class=paragraph><p>Karbantartó: <a href=mailto:ftp@stacken.kth.se>ftp@stacken.kth.se</a></p></div></dd></dl></div></div><div class=sect2><h3 id=mirrors-rsync>A.8. Rsync oldalak<a class=anchor href=#mirrors-rsync></a></h3><div class=paragraph><p>A most következõ oldalakon a FreeBSD-t érhetjük el az rsync protokollal. Az rsync segédprogram mûködésében leginkább a <a href="https://man.freebsd.org/cgi/man.cgi?query=rcp&amp;sektion=1&amp;format=html">rcp(1)</a> parancshoz hasonlít, de sokkal több beállítással rendelkezik, és az rsync távoli frissítéseket kezelõ protokollja segítségével csak az állományok csoportjai között levõ eltéréseket küldi át, amivel a hálózaton keresztüli szinkronizáció rendkívül felgyorsítható. Ez olyankor jelent számunkra a legtöbbet, ha a FreeBSD FTP szerverének vagy CVS repositoryjának egyik tükrözését tartjuk karban. Az rsync több operációs rendszerre is elérhetõ, és FreeBSD-n a <a class=package href=https://cgit.freebsd.org/ports/tree/net/rsync/>net/rsync</a> port vagy csomag tartalmazza.</p></div><div class=dlist><dl><dt class=hdlist1>Cseh Köztársaság</dt><dd><p>rsync://ftp.cz.FreeBSD.org/</p><div class=paragraph><p>Elérhetõ gyûjtemények:</p></div><div class=ulist><ul><li><p>ftp: a FreeBSD FTP szerverének részleges tükrözése.</p></li><li><p>FreeBSD: a FreeBSD FTP szerverének teljes tükrözése.</p></li></ul></div></dd><dt class=hdlist1>Hollandia</dt><dd><p>rsync://ftp.nl.FreeBSD.org/</p><div class=paragraph><p>Elérhetõ gyûjtemények:</p></div><div class=ulist><ul><li><p>FreeBSD: a FreeBSD FTP szerverének teljes tükrözése.</p></li></ul></div></dd><dt class=hdlist1>Oroszország</dt><dd><p>rsync://ftp.mtu.ru</p><div class=paragraph><p>Elérhetõ gyûjtemények:</p></div><div class=ulist><ul><li><p>FreeBSD: A FreeBSD FTP szerver teljes tartalma.</p></li><li><p>FreeBSD-gnats: A GNATS hibanyilvántartó adatbázis.</p></li><li><p>FreeBSD-Archive: A FreeBSD archívumait tároló FTP szerver tükrözése.</p></li></ul></div></dd><dt class=hdlist1>Tajvan</dt><dd><p>rsync://ftp.tw.FreeBSD.org/</p><div class=paragraph><p>rsync://ftp2.tw.FreeBSD.org/</p></div><div class=paragraph><p>rsync://ftp6.tw.FreeBSD.org/</p></div><div class=paragraph><p>Elérhetõ gyûjtemények:</p></div><div class=ulist><ul><li><p>FreeBSD: a FreeBSD FTP szerverének teljes tükrözése.</p></li></ul></div></dd><dt class=hdlist1>Egyesült Királyság</dt><dd><p>rsync://rsync.mirrorservice.org/</p><div class=paragraph><p>Elérhetõ gyûjtemények:</p></div><div class=ulist><ul><li><p>sites/ftp.freebsd.org: a FreeBSD FTP szerverének teljes tükrözése.</p></li></ul></div></dd><dt class=hdlist1>Amerikai Egyesült Államok</dt><dd><p>rsync://ftp-master.FreeBSD.org/</p><div class=paragraph><p>Ezt a szervert csak az elsõdleges FreeBSD tükrözéseknek szabad használniuk.</p></div><div class=paragraph><p>Elérhetõ gyûjtemények:</p></div><div class=ulist><ul><li><p>FreeBSD: a FreeBSD FTP szerverének központi archívuma.</p></li><li><p>acl: a FreeBSD központi ACL listája.</p><div class=paragraph><p>rsync://ftp13.FreeBSD.org/</p></div><div class=paragraph><p>Elérhetõ gyûjtemények:</p></div></li><li><p>FreeBSD: a FreeBSD FTP szerver teljes tükrözése.</p></li></ul></div></dd></dl></div></div></div></div><div class=sect1><h2 id=bibliography>Függelék B: Irodalomjegyzék<a class=anchor href=#bibliography></a></h2><div class=sectionbody><div class=paragraph><p>Míg a man oldalak a FreeBSD operációs rendszer egyes önálló részeit tárgyalják, ismert a tény, hogy arról egyáltalán nem szólnak, miképpen illeszkednek egymáshoz ezek az alkotóelemek, és ezáltal hogyan mûködik maga az operációs rendszer. Erre a célra egyedül csak egy jó UNIX®-os rendszeradminisztrációs szakkönyv és egy jó felhasználói kézikönyv alkalmas.</p></div><div class=sect2><h3 id=bibliography-freebsd>B.1. A FreeBSD-rõl szóló könyvek és folyóiratok<a class=anchor href=#bibliography-freebsd></a></h3><div class=paragraph><p><em>Idegennyelvû könyvek és folyóiratok:</em></p></div><div class=ulist><ul><li><p><a href=http://jdli.tw.FreeBSD.org/publication/book/freebsd2/index.htm>Using FreeBSD</a> (kínai). <a href=http://www.drmaster.com.tw/>Drmaster</a>, 1997. ISBN 9-578-39435-7.</p></li><li><p>FreeBSD Unleashed (kínai fordítás). <a href=http://www.hzbook.com/>China Machine Press</a>. ISBN 7-111-10201-0.</p></li><li><p>FreeBSD From Scratch (1. kiadás, kínai). China Machine Press. ISBN 7-111-07482-3.</p></li><li><p>FreeBSD From Scratch (2. kiadás, kínai). China Machine Press. ISBN 7-111-10286-X.</p></li><li><p>FreeBSD Handbook (2. kiadás, kínai). <a href=http://www.ptpress.com.cn/>Posts & Telecom Press</a>. ISBN 7-115-10541-3.</p></li><li><p>FreeBSD 3.x Internet (kínai). <a href=http://www.tup.tsinghua.edu.cn/>Tsinghua University Press</a>. ISBN 7-900625-66-6.</p></li><li><p>FreeBSD & Windows (kínai). <a href=http://www.tdpress.com/>China Railway Publishing House</a>. ISBN 7-113-03845-X</p></li><li><p>FreeBSD Internet Services HOWTO (kínai). China Railway Publishing House. ISBN 7-113-03423-3</p></li><li><p>FreeBSD for PC 98’ers (japán). SHUWA System Co, LTD. ISBN 4-87966-468-5 C3055 P2900E.</p></li><li><p>FreeBSD (japán). CUTT. ISBN 4-906391-22-2 C3055 P2400E.</p></li><li><p><a href="http://www.shoeisha.com/book/Detail.asp?bid=650">Complete Introduction to FreeBSD</a> (japán). <a href=http://www.shoeisha.co.jp/>Shoeisha Co., Ltd</a>. ISBN 4-88135-473-6 P3600E.</p></li><li><p><a href=http://www.ascii.co.jp/pb/book1/shinkan/detail/1322785.html>Personal UNIX® Starter Kit FreeBSD</a> (japán). <a href=http://www.ascii.co.jp/>ASCII</a>. ISBN 4-7561-1733-3 P3000E.</p></li><li><p>FreeBSD Handbook (japán fordítás). <a href=http://www.ascii.co.jp/>ASCII</a>. ISBN 4-7561-1580-2 P3800E.</p></li><li><p>FreeBSD mit Methode (német). <a href=http://www.cul.de>Computer und Literatur Verlag</a>/Vertrieb Hanser, 1998. ISBN 3-932311-31-0.</p></li><li><p><a href=http://www.cul.de/freebsd.html>FreeBSD 4 - Installieren, Konfigurieren, Administrieren</a> (német). <a href=http://www.cul.de>Computer und Literatur Verlag</a>, 2001. ISBN 3-932311-88-4.</p></li><li><p><a href=http://www.cul.de/freebsd.html>FreeBSD 5 - Installieren, Konfigurieren, Administrieren</a> (német). <a href=http://www.cul.de>Computer und Literatur Verlag</a>, 2003. ISBN 3-936546-06-1.</p></li><li><p><a href=http://www.mitp.de/vmi/mitp/detail/pWert/1343/>FreeBSD de Luxe</a> (német). <a href=http://www.mitp.de>Verlag Modere Industrie</a>, 2003. ISBN 3-8266-1343-0.</p></li><li><p><a href=http://www.pc.mycom.co.jp/FreeBSD/install-manual.html>FreeBSD Install and Utilization Manual</a> (japán). <a href=http://www.pc.mycom.co.jp/>Mainichi Communications Inc.</a>, 1998. ISBN 4-8399-0112-0.</p></li><li><p>Onno W Purbo, Dodi Maryanto, Syahrial Hubbany, Widjil Widodo <em><a href=http://maxwell.itb.ac.id/>Building Internet Server with FreeBSD</a></em> (indonéz nyelven). <a href=http://www.elexmedia.co.id/>Elex Media Komputindo</a>.</p></li><li><p>Absolute BSD: The Ultimate Guide to FreeBSD (kínai fordítás). <a href=http://www.grandtech.com.tw/>GrandTech Press</a>, 2003. ISBN 986-7944-92-5.</p></li><li><p><a href=http://www.twbsd.org/cht/book/>The FreeBSD 6.0 Book</a> (kínai). Drmaster, 2006. ISBN 9-575-27878-X.</p></li></ul></div><div class=paragraph><p><em>Angol nyelvû könyvek és folyóiratok:</em></p></div><div class=ulist><ul><li><p><a href=http://www.AbsoluteBSD.com/>Absolute BSD, 2nd Edition: The Complete Guide to FreeBSD</a>. <a href=http://www.nostarch.com/>No Starch Press</a>, 2007. ISBN: 978-1-59327-151-0</p></li><li><p><a href=http://www.freebsdmall.com/cgi-bin/fm/bsdcomp>The Complete FreeBSD</a>. <a href=http://www.oreilly.com/>O’Reilly</a>, 2003. ISBN: 0596005164</p></li><li><p><a href=http://www.freebsd-corp-net-guide.com/>The FreeBSD Corporate Networker’s Guide</a>. <a href=http://www.awl.com/aw/>Addison-Wesley</a>, 2000. ISBN: 0201704811</p></li><li><p><a href=http://andrsn.stanford.edu/FreeBSD/introbook/>FreeBSD: An Open-Source Operating System for Your Personal Computer</a>. The Bit Tree Press, 2001. ISBN: 0971204500</p></li><li><p>Teach Yourself FreeBSD in 24 Hours. <a href=http://www.samspublishing.com/>Sams</a>, 2002. ISBN: 0672324245</p></li><li><p>FreeBSD 6 Unleashed. <a href=http://www.samspublishing.com/>Sams</a>, 2006. ISBN: 0672328755</p></li><li><p>FreeBSD: The Complete Reference. <a href=http://books.mcgraw-hill.com>McGrawHill</a>, 2003. ISBN: 0072224096</p></li><li><p><a href=http://www.bsdmag.org/>BSD Magazine</a>, megjelenik a Software Press Sp., z o.o. SK gondozásában. ISSN 1898-9144</p></li></ul></div></div><div class=sect2><h3 id=bibliography-userguides>B.2. Felhasználói kézikönyvek<a class=anchor href=#bibliography-userguides></a></h3><div class=ulist><ul><li><p>Computer Systems Research Group, UC Berkeley. <em>4.4BSD User’s Reference Manual</em>. O’Reilly & Associates, Inc., 1994. ISBN 1-56592-075-9</p></li><li><p>Computer Systems Research Group, UC Berkeley. <em>4.4BSD User’s Supplementary Documents</em>. O’Reilly & Associates, Inc., 1994. ISBN 1-56592-076-7</p></li><li><p><em>UNIX® in a Nutshell</em>. O’Reilly & Associates, Inc., 1990. ISBN 093717520X</p></li><li><p>Mui, Linda. <em>What You Need To Know When You Can’t Find Your UNIX® System Administrator</em>. O’Reilly & Associates, Inc., 1995. ISBN 1-56592-104-6</p></li><li><p><a href=http://www.osu.edu/>Ohio Állami Egyetemnek</a> van egy <a href=http://8help.osu.edu/wks/unix_course/index.html>Alapozó UNIX® kurzusa</a>, amely az Interneten keresztül is elérhetõ HTML és PostScript formátumokban.</p><div class=paragraph><p>Ennek a dokumentumnak egy olasz <a href=https://www.FreeBSD.org/doc/it_IT.ISO8859-15/books/unix-introduction/index.html>fordítása</a> is elérhetõ az Olasz FreeBSD Dokumentációs Projekt keretében.</p></div></li><li><p><a href=http://www.jp.FreeBSD.org/>Jpman Project, Japanese FreeBSD User’s Group</a>. <a href=http://www.pc.mycom.co.jp/FreeBSD/urm.html>FreeBSD User’s Reference Manual</a> (japán fordítás). <a href=http://www.pc.mycom.co.jp/>Mainichi Communications Inc.</a>, 1998. ISBN4-8399-0088-4 P3800E.</p></li><li><p>Az <a href=http://www.ed.ac.uk/>Edinburghi Egyetemen</a> készítettek az újoncok számára egy <a href=http://unixhelp.ed.ac.uk/>Internetes kézikönyvet</a> a UNIX® környezetekhez.</p></li></ul></div></div><div class=sect2><h3 id=bibliography-adminguides>B.3. Rendszeradminisztrátori kézikönyvek<a class=anchor href=#bibliography-adminguides></a></h3><div class=ulist><ul><li><p>Albitz, Paul and Liu, Cricket. <em>DNS and BIND</em> (4. kiadás). O’Reilly & Associates, Inc., 2001. ISBN 1-59600-158-4</p></li><li><p>Computer Systems Research Group, UC Berkeley. <em>4.4BSD System Manager’s Manual</em>. O’Reilly & Associates, Inc., 1994. ISBN 1-56592-080-5</p></li><li><p>Costales, Brian és mások. <em>Sendmail</em> (2. kiadás). O’Reilly & Associates, Inc., 1997. ISBN 1-56592-222-0</p></li><li><p>Frisch, Æleen. <em>Essential System Administration</em> (2. kiadás). O’Reilly & Associates, Inc., 1995. ISBN 1-56592-127-5</p></li><li><p>Hunt, Craig. <em>TCP/IP Network Administration</em> (2. kiadás). O’Reilly & Associates, Inc., 1997. ISBN 1-56592-322-7</p></li><li><p>Nemeth, Evi. <em>UNIX® System Administration Handbook</em> (3. kiadás). Prentice Hall, 2000. ISBN 0-13-020601-6</p></li><li><p>Stern, Hal. <em>Managing NFS and NIS</em>. O’Reilly & Associates, Inc., 1991. ISBN 0-937175-75-7</p></li><li><p><a href=http://www.jp.FreeBSD.org/>Jpman Project, Japan FreeBSD Users Group</a>. <a href=http://www.pc.mycom.co.jp/FreeBSD/sam.html>FreeBSD System Administrator’s Manual</a> (japán fordítás). <a href=http://www.pc.mycom.co.jp/>Mainichi Communications Inc.</a>, 1998. ISBN4-8399-0109-0 P3300E.</p></li><li><p>Dreyfus, Emmanuel. <a href=http://www.eyrolles.com/Informatique/Livre/9782212114638/>Cahiers de l’Admin: BSD</a> (2. kiadás, franciául). Eyrolles, 2004. ISBN 2-212-11463-X</p></li></ul></div></div><div class=sect2><h3 id=bibliography-programmers>B.4. Programozói kézikönyvek<a class=anchor href=#bibliography-programmers></a></h3><div class=ulist><ul><li><p>Asente, Paul, Converse, Diana, and Swick, Ralph. <em>X Window System Toolkit</em>. Digital Press, 1998. ISBN 1-55558-178-1</p></li><li><p>Computer Systems Research Group, UC Berkeley. <em>4.4BSD Programmer’s Reference Manual</em>. O’Reilly & Associates, Inc., 1994. ISBN 1-56592-078-3</p></li><li><p>Computer Systems Research Group, UC Berkeley. <em>4.4BSD Programmer’s Supplementary Documents</em>. O’Reilly & Associates, Inc., 1994. ISBN 1-56592-079-1</p></li><li><p>Harbison, Samuel P. and Steele, Guy L. Jr. <em>C: A Reference Manual</em> (4. kiadás). Prentice Hall, 1995. ISBN 0-13-326224-3</p></li><li><p>Kernighan, Brian and Dennis M. Ritchie. <em>The C Programming Language</em> (2. kiadás). PTR Prentice Hall, 1988. ISBN 0-13-110362-8</p></li><li><p>Lehey, Greg. <em>Porting UNIX® Software</em>. O’Reilly & Associates, Inc., 1995. ISBN 1-56592-126-7</p></li><li><p>Plauger, P. J. <em>The Standard C Library</em>. Prentice Hall, 1992. ISBN 0-13-131509-9</p></li><li><p>Spinellis, Diomidis. <a href=http://www.spinellis.gr/codereading/>Code Reading: The Open Source Perspective</a>. Addison-Wesley, 2003. ISBN 0-201-79940-5</p></li><li><p>Spinellis, Diomidis. <a href=http://www.spinellis.gr/codequality/>Code Quality: The Open Source Perspective</a>. Addison-Wesley, 2006. ISBN 0-321-16607-8</p></li><li><p>Stevens, W. Richard and Stephen A. Rago. <em>Advanced Programming in the UNIX® Environment</em> (2. kiadás). Reading, Mass. : Addison-Wesley, 2005. ISBN 0-201-43307-9</p></li><li><p>Stevens, W. Richard. <em>UNIX® Network Programming</em> (2. kiadás), PTR Prentice Hall, 1998. ISBN 0-13-490012-X</p></li><li><p>Wells, Bill. "Writing Serial Drivers for UNIX®". <em>Dr. Dobb’s Journal</em>. 19(15), 1994. december, 68-71. és 97-99. oldal.</p></li></ul></div></div><div class=sect2><h3 id=bibliography-osinternals>B.5. Az operációs rendszerek belsõ mûködésérõl<a class=anchor href=#bibliography-osinternals></a></h3><div class=ulist><ul><li><p>Andleigh, Prabhat K. <em>UNIX® System Architecture</em>. Prentice-Hall, Inc., 1990. ISBN 0-13-949843-5</p></li><li><p>Jolitz, William. "Porting UNIX® to the 386". <em>Dr. Dobb’s Journal</em>. 1991. január - 1992. július.</p></li><li><p>Leffler, Samuel J., Marshall Kirk McKusick, Michael J Karels és John Quarterman. <em>The Design and Implementation of the 4.3BSD UNIX® Operating System</em>. Reading, Mass. : Addison-Wesley, 1989. ISBN 0-201-06196-1</p></li><li><p>Leffler, Samuel J., Marshall Kirk McKusick. <em>The Design and Implementation of the 4.3BSD UNIX® Operating System: Answer Book</em>. Reading, Mass. : Addison-Wesley, 1991. ISBN 0-201-54629-9</p></li><li><p>McKusick, Marshall Kirk, Keith Bostic, Michael J Karels és John Quarterman. <em>The Design and Implementation of the 4.4BSD Operating System</em>. Reading, Mass. : Addison-Wesley, 1996. ISBN 0-201-54979-4</p><div class=paragraph><p>(A könyv 2. fejezete elérhetõ <a href={design-44bsd.en}>online</a> a FreeBSD Dokumentációs Projekt részeként, valamint <a href=http://www.netapp.com/tech_library/nfsbook.html>itt</a> a 9. fejezet.)</p></div></li><li><p>Marshall Kirk McKusick, George V. Neville-Neil. <em>The Design and Implementation of the FreeBSD Operating System</em>. Boston, Mass. : Addison-Wesley, 2004. ISBN 0-201-70245-2</p></li><li><p>Stevens, W. Richard. <em>TCP/IP Illustrated, Vol 1: The Protocols</em>. Reading, Mass. : Addison-Wesley, 1996. ISBN 0-201-63346-9</p></li><li><p>Schimmel, Curt. <em>UNIX® Systems for Modern Architectures</em>. Reading, Mass. : Addison-Wesley, 1994. ISBN 0-201-63338-8</p></li><li><p>Stevens, W. Richard. <em>TCP/IP Illustrated, Vol 3: TCP for Transactions, HTTP, NNTP and the UNIX® Domain Protocols</em>. Reading, Mass. : Addison-Wesley, 1996. ISBN 0-201-63495-3</p></li><li><p>Vahalia, Uresh. <em>UNIX® Internals - The New Frontiers</em>. Prentice Hall, 1996. ISBN 0-13-101908-2</p></li><li><p>Wright, Gary R. és W. Richard Stevens. <em>TCP/IP Illustrated, Vol 2: The Implementation</em>. Reading, Mass. : Addison-Wesley, 1995. ISBN 0-201-63354-X</p></li></ul></div></div><div class=sect2><h3 id=bibliography-security>B.6. Biztonságról szóló írások<a class=anchor href=#bibliography-security></a></h3><div class=ulist><ul><li><p>Cheswick, William R. és Steven M. Bellovin. <em>Firewalls and Internet Security: Repelling the Wily Hacker</em>. Reading, Mass. : Addison-Wesley, 1995. ISBN 0-201-63357-4</p></li><li><p>Garfinkel, Simson és Gene Spafford. <em>Practical UNIX® & Internet Security</em> (2. kiadás). O’Reilly & Associates, Inc., 1996. ISBN 1-56592-148-8</p></li><li><p>Garfinkel, Simson. <em>PGP Pretty Good Privacy</em>. O’Reilly & Associates, Inc., 1995. ISBN 1-56592-098-8</p></li></ul></div></div><div class=sect2><h3 id=bibliography-hardware>B.7. Hardverrel foglalkozó írások<a class=anchor href=#bibliography-hardware></a></h3><div class=ulist><ul><li><p>Anderson, Don és Tom Shanley. <em>Pentium Processor System Architecture</em> (2. kiadás). Reading, Mass. : Addison-Wesley, 1995. ISBN 0-201-40992-5</p></li><li><p>Ferraro, Richard F. <em>Programmer’s Guide to the EGA, VGA, and Super VGA Cards</em> (3. kiadás). Reading, Mass. : Addison-Wesley, 1995. ISBN 0-201-62490-7</p></li><li><p>Az Intel® által gyártott processzorokról és chipsetekrõl, valamint az általuk kialakított szabványokról a <a href=http://developer.intel.com/>saját fejlesztõi oldalukon</a>, általában PDF állományok formájában kaphatunk információkat.</p></li><li><p>Shanley, Tom. <em>80486 System Architecture</em> (3. kiadás). Reading, Mass. : Addison-Wesley, 1995. ISBN 0-201-40994-1</p></li><li><p>Shanley, Tom. <em>ISA System Architecture</em> (3. kiadás). Reading, Mass. : Addison-Wesley, 1995. ISBN 0-201-40996-8</p></li><li><p>Shanley, Tom. <em>PCI System Architecture</em> (4. kiadás). Reading, Mass. : Addison-Wesley, 1999. ISBN 0-201-30974-2</p></li><li><p>Van Gilluwe, Frank. <em>The Undocumented PC</em> (2. kiadás). Reading, Mass: Addison-Wesley Pub. Co., 1996. ISBN 0-201-47950-8</p></li><li><p>Messmer, Hans-Peter. <em>The Indispensable PC Hardware Book</em> (4. kiadás). Reading, Mass: Addison-Wesley Pub. Co., 2002. ISBN 0-201-59616-4</p></li></ul></div></div><div class=sect2><h3 id=bibliography-history>B.8. UNIX® történelem<a class=anchor href=#bibliography-history></a></h3><div class=ulist><ul><li><p>Lion, John. <em>Lion’s Commentary on UNIX®</em> (6. kiadás, forráskóddal). ITP Media Group, 1996. ISBN 1573980137</p></li><li><p>Raymond, Eric S. <em>The New Hacker’s Dictionary</em> (3. kiadás). MIT Press, 1996. ISBN 0-262-68092-0. Vagy <a href=http://www.catb.org/~esr/jargon/html/index.html>Zsargon fájlként</a> is ismert.</p></li><li><p>Salus, Peter H. <em>A quarter century of UNIX®</em>. Addison-Wesley Publishing Company, Inc., 1994. ISBN 0-201-54777-5</p></li><li><p>Simon Garfinkel, Daniel Weise, Steven Strassmann. <em>The UNIX®-HATERS Handbook</em>. IDG Books Worldwide, Inc., 1994. ISBN 1-56884-203-1. Elfogyott, de még elérhetõ <a href=http://www.simson.net/ref/ugh.pdf>ezen</a> a linken.</p></li><li><p>Don Libes, Sandy Ressler. <em>Life with UNIX®</em> - különkiadás. Prentice-Hall, Inc., 1989. ISBN 0-13-536657-7</p></li><li><p><em>The BSD family tree</em>. <a href=http://www.FreeBSD.org/cgi/cvsweb.cgi/src/shared/misc/bsd-family-tree>http://www.FreeBSD.org/cgi/cvsweb.cgi/src/shared/misc/bsd-family-tree</a> vagy egy telepített FreeBSD rendszeren a <a href=file://localhost/usr/shared/misc/bsd-family-tree>/usr/shared/misc/bsd-family-tree</a> állomány.</p></li><li><p><em>Networked Computer Science Technical Reports Library</em>. <a href=http://www.ncstrl.org/>http://www.ncstrl.org/</a></p></li><li><p><em>Old BSD releases from the Computer Systems Research group (CSRG)</em>. <a href=http://www.mckusick.com/csrg/>http://www.mckusick.com/csrg/</a>Ez a 4 CD-s készlet tartalmazza az összes BSD verziót a 1BSD-tõl kezdve a 4.4BSD és 4.4BSD-Lite2-ig (de nem a 2.11BSD-t sajnos nem). Az utolsó lemezen megtalálhatóak a végleges források, illetve az SCCS állományok.</p></li></ul></div></div><div class=sect2><h3 id=bibliography-journals>B.9. Magazinok és folyóiratok<a class=anchor href=#bibliography-journals></a></h3><div class=ulist><ul><li><p><em>The C/C++ Users Journal</em>. R&amp;D Publications Inc. ISSN 1075-2838</p></li><li><p><em>Sys Admin - The Journal for UNIX® System Administrators</em>. Miller Freeman, Inc. ISSN 1061-2688</p></li><li><p><em>freeX - Das Magazin für Linux® - BSD - UNIX®</em> (német). Computer- und Literaturverlag GmbH. ISSN 1436-7033</p></li></ul></div></div></div></div><div class=sect1><h2 id=eresources>Függelék C: Források az interneten<a class=anchor href=#eresources></a></h2><div class=sectionbody><div class=paragraph><p>A FreeBSD gyors ütemû fejlõdése a nyomtatott médiát alkalmatlanná teszi a legfrissebb fejlesztések nyomonkövetésére. Ezzel szemben az elektronikus erõforrások a biztos, ha gyakran nem is csak az egyetlen, módjai a legújabb elõrelépések figyelemmel követésének. Mivel a FreeBSD-t többségében önkéntesek fejlesztik, az õt körülvevõ felhasználói közösség önmaga is egyfajta "szakmai segélynyújtó egyletként" funkcionál, amelyet leghatékonyabban elektronikus levélben, webes fórumokon vagy USENET hírcsoportokon keresztül érhetünk el.</p></div><div class=paragraph><p>A továbbiakban a FreeBSD felhasználók közösségének különbözõ fajtájú elérhetõségeit vázoljuk fel nagyvonalakban. Ha úgy érezzük, hogy ebbõl a felsorolásban kimaradt volna valami, akkor ne habozzunk róla értesítést küldeni a <a href=https://lists.FreeBSD.org/subscription/freebsd-doc>FreeBSD Dokumentációs Projekt levelezési lista</a> címére (angolul), hogy felvehessük a többi közé.</p></div><div class=sect2><h3 id=eresources-mail>C.1. Levelezési listák<a class=anchor href=#eresources-mail></a></h3><div class=paragraph><p>A FreeBSD köré csoportosulókat levelezési listákon keresztül tudjuk közvetlenül elérni, ezen a módon tehetünk fel kérdéseket, vethetünk fel témákat. Ezek között több különbözõ területtel foglalkozó listát találhatunk. Ezért célszerû mindig a hozzászólásainkat a témánkhoz legközelebb álló listára küldeni, mert enélkül szinte biztos, hogy nem kapunk pontos vagy gyors választ.</p></div><div class=paragraph><p>A különbözõ listák témájának rövid leírása a dokumentum alján olvasható. <em>Szeretnénk mindenkit megkérni, hogy mielõtt feliratkozik vagy levelet küld valamelyik listára, figyelmesen olvassa el ezeket.</em> Az egyes listák tagjai már így is naponta többszáz FreeBSD-vel kapcsolatos üzenetet kapnak, miközben a listák tematikájának és szabályainak lefektetésével igyekszünk a jel-zaj arányt minél kedvezõbb szinten tartani. Ezek nélkül a levelezési listák a Projekt számára haszontalan kommunikációs eszközökké válnának.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p><em>A <a href=https://lists.FreeBSD.org/subscription/freebsd-test>FreeBSD test levelezési lista</a> címet használjuk, ha ki akarjuk próbálni, hogy tudunk-e levelet küldeni a FreeBSD listáira.</em> A többi listára viszont lehetõleg ne küldjünk teszt jellegû üzeneteket.</p></div></td></tr></tbody></table></div><div class=paragraph><p>Ha nem tudjuk eldönteni, hogy pontosan melyik listát is kellene megcímeznünk kérdésünkkel, olvassuk el a <a href=https://docs.freebsd.org/en/articles/freebsd-questions/>Hogyan kapjunk értékelhetõ választ a FreeBSD-questions levelezési listáról</a> címû leírást (angolul).</p></div><div class=paragraph><p>Mielõtt akármelyik listára is levelet küldenénk, olvassuk el a <a href=https://docs.freebsd.org/en/articles/mailing-list-faq/>Levelezési listák Gyakran Ismételt Kérdéseit</a> (angolul), amivel elkerülhetjük a gyakran feltett kérdések és témák ismételt felhozását.</p></div><div class=paragraph><p>A levelezési listák tartalma folyamatosan archiválódik, és ezekben az archívumokban a <a href=https://www.FreeBSD.org/search/>FreeBSD honlapján</a> tudunk keresni. Az itt elérhetõ, kulcsszavak alapján történõ keresés remek módját nyújtja a gyakran felmerülõ kérdések egyszerû és gyors megválaszolásának, ezért ilyen esetekben elõször mindig ezt javasolt használni. Ez egyben mellesleg azt is jelenti, hogy a FreeBSD levelezési listáira küldött üzenetek fennmaradnak az örökkévalóságig. Ha a beküldendõ üzenet bizalmas információkat tartalmaz, érdemes megfontolni egy eldobható anonim e-mail cím használatát és kizárólag csak a publikus részet beküldeni.</p></div><div class=sect3><h4 id=eresources-summary>C.1.1. A listák összefoglalása<a class=anchor href=#eresources-summary></a></h4><div class=paragraph><p><em>Általános listák:</em> A következõ általános célú listákhoz szabadon (és nyugodtan) csatlakozhatunk:</p></div><table class="tableblock frame-none grid-all stretch informaltable"><col style=width:50%><col style=width:50%><thead><tr><th class="tableblock halign-left valign-top">Lista</th><th class="tableblock halign-left valign-top">Tartalom</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class=tableblock><a href=https://lists.FreeBSD.org/subscription/freebsd-advocacy>freebsd-advocacy</a></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>A FreeBSD igéjének terjesztése</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><a href=https://lists.FreeBSD.org/subscription/freebsd-announce>FreeBSD announcements levelezési lista</a></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Fontosabb események és elõrelépések a projektek életében</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><a href=https://lists.FreeBSD.org/subscription/freebsd-arch>freebsd-arch</a></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Architekturális és tervezési kérdések tárgyalása</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><a href=https://lists.FreeBSD.org/subscription/freebsd-bugbusters>freebsd-bugbusters</a></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>A FreeBSD hibabejelentéseit tároló adatbázis és a kapcsolódó eszközök karbantartására vonatkozó megbeszélések</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><a href=https://lists.FreeBSD.org/subscription/freebsd-bugs>freebsd-bugs</a></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Hibajelentések</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><a href=https://lists.FreeBSD.org/subscription/freebsd-chat>freebsd-chat</a></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>A FreeBSD közösség nem szakmai jellegû dolgai</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><a href=https://lists.FreeBSD.org/subscription/freebsd-current>FreeBSD-CURRENT levelezési lista</a></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>A FreeBSD-CURRENT használatának tárgyalása</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><a href=https://lists.FreeBSD.org/subscription/freebsd-isp>freebsd-isp</a></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>A FreeBSD-t alkalmazó internet-szolgáltatók fóruma</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><a href=https://lists.FreeBSD.org/subscription/freebsd-jobs>freebsd-jobs</a></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>FreeBSD-s munkalehetõségek</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><a href=https://lists.FreeBSD.org/subscription/freebsd-policy>freebsd-policy</a></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>A FreeBSD fejlõdését irányító csoport (Core Team) döntéseirõl tájékoztató lista. A forgalma kicsi, csak olvasható.</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><a href=https://lists.FreeBSD.org/subscription/freebsd-questions>freebsd-questions</a></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>A felhasználók kérdései és szakmai segítségnyújtás</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><a href=https://lists.FreeBSD.org/subscription/freebsd-security-notifications>FreeBSD security notifications levelezési lista</a></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Biztonsági figyelmeztetések</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><a href=https://lists.FreeBSD.org/subscription/freebsd-stable>FreeBSD-STABLE; levelezési lista</a></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>A FreeBSD-STABLE használatát illetõ kérdések</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><a href=https://lists.FreeBSD.org/subscription/freebsd-test>FreeBSD test levelezési lista</a></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Ide lehet küldeni a próbaüzeneteket</p></td></tr></tbody></table><div class=paragraph><p><em>Szakmai listák:</em> A következõ listák szakmai jellegû témákat képviselnek. Mielõtt bármelyikükre levelet küldenénk vagy feliratkoznánk, figyelmesen olvassuk el a tartalmukat és céljaikat bemutató rövid leírásukat.</p></div><table class="tableblock frame-none grid-all stretch informaltable"><col style=width:50%><col style=width:50%><thead><tr><th class="tableblock halign-left valign-top">Lista</th><th class="tableblock halign-left valign-top">Tartalom</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class=tableblock><a href=https://lists.FreeBSD.org/subscription/freebsd-acpi>FreeBSD ACPI levelezési lista</a></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Az ACPI és energiagazdálkodás támogatás fejlesztése</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><a href=https://lists.FreeBSD.org/subscription/freebsd-afs>freebsd-afs</a></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Az AFS portolása FreeBSD-re</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><a href=https://lists.FreeBSD.org/subscription/aic7xxx>freebsd-aic7xxx</a></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Az Adaptec® AIC 7xxx sorozat meghajtóinak fejlesztése</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><a href={alpha-url}>alpha</a></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>A FreeBSD Alpha portja</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><a href=https://lists.FreeBSD.org/subscription/freebsd-amd64>freebsd-amd64</a></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>A FreeBSD AMD64 portja</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><a href=https://lists.FreeBSD.org/subscription/freebsd-apache>freebsd-apache</a></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Az Apache és hozzá tartozó portok tárgyalása</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><a href=https://lists.FreeBSD.org/subscription/freebsd-arm>freebsd-arm</a></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>A FreeBSD ARM® portja</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><a href=https://lists.FreeBSD.org/subscription/freebsd-atm>freebsd-atm</a></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>FreeBSD használata ATM hálózatokkal</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><a href=https://lists.FreeBSD.org/subscription/freebsd-audit>freebsd-audit</a></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>A forráskód ellenõrzésérõl szóló projekt</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><a href=https://lists.FreeBSD.org/subscription/freebsd-binup>freebsd-binup</a></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>A bináris frissítésekkel foglalkozó rendszer tervezése és fejlesztése</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><a href=https://lists.FreeBSD.org/subscription/freebsd-bluetooth>freebsd-bluetooth</a></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>A Bluetooth® technológia használata a FreeBSD-ben</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><a href=https://lists.FreeBSD.org/subscription/freebsd-cluster>freebsd-cluster</a></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>A FreeBSD klaszteres környezetben</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><a href=https://lists.FreeBSD.org/subscription/freebsd-cvsweb>freebsd-cvsweb</a></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>A CVSweb karbantartása</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><a href=https://lists.FreeBSD.org/subscription/freebsd-database>freebsd-database</a></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Adatbázisok használata és fejlesztése FreeBSD alatt</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><a href=https://lists.FreeBSD.org/subscription/freebsd-doc>freebsd-doc</a></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>FreeBSD-rõl szóló leírások készítése</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><a href=https://lists.FreeBSD.org/subscription/freebsd-drivers>freebsd-drivers</a></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Eszközmeghajtók írása FreeBSD-re</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><a href=https://lists.FreeBSD.org/subscription/freebsd-eclipse>freebsd-eclipse</a></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Az Eclipse integrált fejlesztõi környezet, eszközeinek, gazdag kliens alkalmazásinak és portjainak FreeBSD alatti használata</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><a href=https://lists.FreeBSD.org/subscription/freebsd-embedded>freebsd-embedded</a></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>A FreeBSD használata beágyazott alkalmazásokban</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><a href=https://lists.FreeBSD.org/subscription/freebsd-eol>freebsd-eol</a></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Olyan FreeBSD-s szoftverek független továbbfejlesztése, amelyeket hivatalosan már nem támogatnak</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><a href=https://lists.FreeBSD.org/subscription/freebsd-emulation>freebsd-emulation</a></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Linux/MS-DOS®/Windows® és hasonló rendszerek emulációja</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><a href=https://lists.FreeBSD.org/subscription/freebsd-firewire>freebsd-firewire</a></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>A FreeBSD és a FireWire® (iLink, IEEE 1394) kapcsolatának technikai kérdései</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><a href=https://lists.FreeBSD.org/subscription/freebsd-fs>freebsd-fs</a></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Állományrendszerek</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><a href=https://lists.FreeBSD.org/subscription/freebsd-gecko>freebsd-gecko</a></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>A Gecko Rendering Engine alkalmazásával kapcsolatos problémák</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><a href=https://lists.FreeBSD.org/subscription/freebsd-geom>freebsd-geom</a></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>A GEOM-hoz tartozó témák és implementációk</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><a href=https://lists.FreeBSD.org/subscription/freebsd-gnome>freebsd-gnome</a></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>A GNOME és GNOME-alkalmazások portolása</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><a href=https://lists.FreeBSD.org/subscription/freebsd-hackers>freebsd-hackers</a></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Általános szakmai témák</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><a href=https://lists.FreeBSD.org/subscription/freebsd-hardware>freebsd-hardware</a></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>A FreeBSD futtatására szolgáló hardverekkel foglalkozó témák</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><a href=https://lists.FreeBSD.org/subscription/freebsd-i18n>freebsd-i18n</a></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>A FreeBSD honosítása</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><a href=https://lists.FreeBSD.org/subscription/freebsd-ia32>freebsd-ia32</a></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>A FreeBSD használata az IA-32 (Intel® x86) platformon</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><a href=https://lists.FreeBSD.org/subscription/freebsd-ia64>freebsd-ia64</a></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>A FreeBSD portolása az Intel® következõ IA64 rendszereire</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><a href=https://lists.FreeBSD.org/subscription/freebsd-ipfw>freebsd-ipfw</a></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Az IP tûzfal kódjának újratervezését érintõ szakmai megbeszélések</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><a href=https://lists.FreeBSD.org/subscription/freebsd-isdn>freebsd-isdn</a></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>ISDN fejlesztõk levelei</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><a href=https://lists.FreeBSD.org/subscription/freebsd-jail>freebsd-jail</a></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>A <a href="https://man.freebsd.org/cgi/man.cgi?query=jail&amp;sektion=8&amp;format=html">jail(8)</a> segédprogram</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><a href=https://lists.FreeBSD.org/subscription/freebsd-java>freebsd-java</a></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Java™ fejlesztõk kérdései és a JDK™-k átültetése FreeBSD-re</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><a href=https://mail.kde.org/mailman/listinfo/kde-freebsd>freebsd-kde</a></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>A KDE és KDE-alkalmazások portolása</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><a href=https://lists.FreeBSD.org/subscription/freebsd-lfs>freebsd-lfs</a></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Az LFS portolása FreeBSD-re</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><a href=https://lists.FreeBSD.org/subscription/freebsd-libh>freebsd-libh</a></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>A második generációs telepítõ- és csomagrendszer</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><a href=https://lists.FreeBSD.org/subscription/freebsd-mips>freebsd-mips</a></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>A FreeBSD portolása MIPS®-re</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><a href=https://lists.FreeBSD.org/subscription/freebsd-mobile>freebsd-mobile</a></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>A mobil számítógépekkel kapcsolatos megbeszélések</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><a href=https://lists.FreeBSD.org/subscription/freebsd-mono>freebsd-mono</a></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Mono és C# alkalmazások FreeBSD alatt</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><a href=https://lists.FreeBSD.org/subscription/freebsd-mozilla>freebsd-mozilla</a></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>A Mozilla átültetése FreeBSD-re</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><a href=https://lists.FreeBSD.org/subscription/freebsd-multimedia>FreeBSD multimedia levelezési lista</a></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Multimédia alkalmazások</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><a href=https://lists.FreeBSD.org/subscription/freebsd-new-bus>freebsd-new-bus</a></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>A buszarchitektúrával kapcsolatos szakmai megbeszélések</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><a href=https://lists.FreeBSD.org/subscription/freebsd-net>freebsd-net</a></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>A TCP/IP forráskódjával és hálózatkezeléssel kapcsolatos kérdések</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><a href=https://lists.FreeBSD.org/subscription/freebsd-openoffice>freebsd-openoffice</a></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>A OpenOffice.org és StarOffice™ alkalmazások portolása FreeBSD-re</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><a href=https://lists.FreeBSD.org/subscription/freebsd-performance>freebsd-performance</a></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Nagy terhelésû és teljesítményû rendszerek teljesítményhangolási kérdései</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><a href=https://lists.FreeBSD.org/subscription/freebsd-perl>freebsd-perl</a></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>A rengeteg Perl alapú port karbantársa</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><a href=https://lists.FreeBSD.org/subscription/freebsd-pf>freebsd-pf</a></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>A csomagszûrõ mûködésével kapcsolatos kérdések és megbeszélések</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><a href=https://lists.FreeBSD.org/subscription/freebsd-platforms>freebsd-platforms</a></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Portolás nem Intel® architektúrájú platformokra</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><a href=https://lists.FreeBSD.org/subscription/freebsd-ports>freebsd-ports</a></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>A Portgyûjtemény mûködése</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><a href=https://lists.FreeBSD.org/subscription/freebsd-ports-bugs>freebsd-ports-bugs</a></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>A portokhoz tartozó hibák és hibajelentések megbeszélése</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><a href=https://lists.FreeBSD.org/subscription/freebsd-ppc>freebsd-ppc</a></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>A FreeBSD portolása PowerPC®-re</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><a href=https://lists.FreeBSD.org/subscription/freebsd-proliant>freebsd-proliant</a></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>HP ProLiant szerverek és a FreeBSD kapcsolata</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><a href=https://lists.FreeBSD.org/subscription/freebsd-python>freebsd-python</a></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>A Python FreeBSD-n futó változatának problémái</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><a href={qa-url}>qa</a></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>A minõségbiztosítás megbeszélése, különösen a kiadások közeledtével</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><a href=https://lists.FreeBSD.org/subscription/freebsd-rc>freebsd-rc</a></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Az <span class=filename>rc.d</span> rendszer és annak fejlõdése</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><a href=https://lists.FreeBSD.org/subscription/freebsd-realtime>freebsd-realtime</a></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>A FreeBSD valósidejû kiterjesztéseinek fejlesztése</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><a href=https://lists.FreeBSD.org/subscription/freebsd-ruby>freebsd-ruby</a></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>A Ruby használata FreeBSD rendszereken</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><a href=https://lists.FreeBSD.org/subscription/freebsd-scsi>freebsd-scsi</a></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>A SCSI alrendszer</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><a href=https://lists.FreeBSD.org/subscription/freebsd-security>FreeBSD security levelezési lista</a></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>A FreeBSD mûködését fenyegetõ biztonsági problémák</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><a href=https://lists.FreeBSD.org/subscription/freebsd-small>freebsd-small</a></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>A FreeBSD használata beágyazott alkalmazásokban (elavult; helyette a <a href=https://lists.FreeBSD.org/subscription/freebsd-embedded>freebsd-embedded</a> címét használjuk)</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><a href={smp-url}>smp</a></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Az [A]Szimmetrikus többszálú feldolgozáshoz ([A]Symmetric MultiProcessing) tartozó tervezési megbeszélések</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><a href=https://lists.FreeBSD.org/subscription/freebsd-sparc64>freebsd-sparc64</a></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>A FreeBSD portolása SPARC® alapú rendszerekre</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><a href=https://lists.FreeBSD.org/subscription/freebsd-standards>freebsd-standards</a></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>A FreeBSD megfelelése a C99 és POSIX® szabványoknak</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><a href=https://lists.FreeBSD.org/subscription/freebsd-sun4v>freebsd-sun4v</a></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>A FreeBSD portolása UltraSPARC® T1 alapú rendszerekre</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><a href=https://lists.FreeBSD.org/subscription/freebsd-sysinstall>freebsd-sysinstall</a></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>A <a href="https://man.freebsd.org/cgi/man.cgi?query=sysinstall&amp;sektion=8&amp;format=html">sysinstall(8)</a> fejlesztése</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><a href=https://lists.FreeBSD.org/subscription/freebsd-threads>freebsd-threads</a></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>A FreeBSD szálkezelése</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><a href=https://lists.FreeBSD.org/subscription/freebsd-testing>freebsd-testing</a></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>A FreeBSD teljesítmény- és megbízhatósági tesztjei</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><a href=https://lists.FreeBSD.org/subscription/freebsd-tilera>freebsd-tilera</a></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>A FreeBSD portolása a Tilera processzorcsalád tagjaira</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><a href=https://lists.FreeBSD.org/subscription/freebsd-tokenring>freebsd-tokenring</a></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>A Token Ring támogatása a FreeBSD-ben</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><a href=https://lists.FreeBSD.org/subscription/freebsd-toolchain>freebsd-toolchain</a></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>A FreeBSD alapvetõ segédprogramjainak karbantartása</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><a href=https://lists.FreeBSD.org/subscription/freebsd-usb>freebsd-usb</a></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>USB támogatás a FreeBSD-ben</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><a href=https://lists.FreeBSD.org/subscription/freebsd-virtualization>freebsd-virtualization</a></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>A FreeBSD részérõl támogatott különbözõ virtualizációs technológiák tárgyalása</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><a href=https://lists.FreeBSD.org/subscription/freebsd-vuxml>freebsd-vuxml</a></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>A VuXML infrastruktúra tárgyalása</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><a href=https://lists.FreeBSD.org/subscription/freebsd-x11>freebsd-x11</a></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Az X11 karbantartása és támogata FreeBSD alatt</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><a href=https://lists.FreeBSD.org/subscription/freebsd-xen>freebsd-xen</a></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>A Xen™ FreeBSD portjának (implementációk, használat) tárgyalása</p></td></tr></tbody></table><div class=paragraph><p><em>Korlátozott listák:</em> (Limited lists) A következõ listák sokkal jobban specializálódótt (és igényesebb) közösségnek szólnak, nem a nagyközönségnek. Ezért mielõtt egy ilyen listára feliratkoznánk, érdemes némi tapasztalatot gyûjtenünk a szakmai témájú listákon, így megismerjük az itt alkalmazott kommunikációs szabályokat.</p></div><table class="tableblock frame-none grid-all stretch informaltable"><col style=width:50%><col style=width:50%><thead><tr><th class="tableblock halign-left valign-top">Lista</th><th class="tableblock halign-left valign-top">Tartalom</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class=tableblock><a href=https://lists.FreeBSD.org/subscription/freebsd-hubs>freebsd-hubs</a></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>A tükrözések üzemeltetõi számára (infrastrukturális támogatás)</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><a href=https://lists.FreeBSD.org/subscription/freebsd-user-groups>freebsd-user-groups</a></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>A felhasználói csoportok összefogása</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><a href=https://lists.FreeBSD.org/subscription/freebsd-vendors>freebsd-vendors</a></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>A forgalmazók koordinálása a kiadások elõtt</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><a href=https://lists.FreeBSD.org/subscription/freebsd-wip-status>freebsd-wip-status</a></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>A FreeBSD-vel kapcsolatos folyamatban levõ fejlesztések helyzetjelentései</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><a href=https://lists.FreeBSD.org/subscription/freebsd-www>freebsd-www</a></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>A <a href=https://www.FreeBSD.org/>www.FreeBSD.org</a> karbantartói számára</p></td></tr></tbody></table><div class=paragraph><p><em>Kivonatolt listák:</em> (Digest lists) Az eddig említett listák elérhetõek kivonatolt formában is. Miután feliratkoztunk egy listára, a hozzáférésünk beállításainál kiválaszthatjuk, hogy kivonatolt formátumban kívánjuk-e kapni a leveleket.</p></div><div class=paragraph><p><em>CVS és SVN listák:</em> (CVS SVN lists) A következõ listák a forrásfa különbözõ részeinek változtatásáról és a hozzájuk tartozó üzenetekrõl adnak értesítést. Ezek a listák <em>csak olvasásra</em> vannak, nem szabad rájuk levelet küldeni.</p></div><table class="tableblock frame-none grid-all stretch informaltable"><col style=width:33.3333%><col style=width:33.3333%><col style=width:33.3334%><thead><tr><th class="tableblock halign-left valign-top">Lista</th><th class="tableblock halign-left valign-top">Forráskód területe</th><th class="tableblock halign-left valign-top">A terület leírása (minek a forrása)</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class=tableblock><a href=https://lists.FreeBSD.org/subscription/cvs-all>cvs-all</a></p></td><td class="tableblock halign-left valign-top"><p class=tableblock><span class=filename>/usr/(CVSROOT|doc|ports)</span></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>A fában végzett akármelyik módosítás (az összes CVS lista együtt)</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><a href=https://lists.FreeBSD.org/subscription/cvs-doc>cvs-doc</a></p></td><td class="tableblock halign-left valign-top"><p class=tableblock><span class=filename>/usr/(doc|www)</span></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>A doc és www ágak változásai</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><a href=https://lists.FreeBSD.org/subscription/cvs-ports>cvs-ports</a></p></td><td class="tableblock halign-left valign-top"><p class=tableblock><span class=filename>/usr/ports</span></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>A portfa változásai</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><a href=https://lists.FreeBSD.org/subscription/cvs-projects>cvs-projects</a></p></td><td class="tableblock halign-left valign-top"><p class=tableblock><span class=filename>/usr/projects</span></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>A projektek változásai</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><a href=https://lists.FreeBSD.org/subscription/cvs-src>cvs-src</a></p></td><td class="tableblock halign-left valign-top"><p class=tableblock><span class=filename>/usr/src</span></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>A rendszer forrásának változásai (az svn és cvs közti importer mûködése alapján generálódik)</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><a href=https://lists.FreeBSD.org/subscription/svn-src-all>A teljes src fa SVN commit üzenetei (kivéve "user" és "projects")</a></p></td><td class="tableblock halign-left valign-top"><p class=tableblock><span class=filename>/usr/src</span></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>A Subversion repositoryk változásai (kivéve a <span class=filename>user</span> és a <span class=filename>projects</span>)</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><a href=https://lists.FreeBSD.org/subscription/svn-src-head>Az src fa head/-current ágának SVN commit üzenetei</a></p></td><td class="tableblock halign-left valign-top"><p class=tableblock><span class=filename>/usr/src</span></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>A Subversion repository "fõágának" (a FreeBSD-CURRENT forrásainak) változásai</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><a href=https://lists.FreeBSD.org/subscription/svn-src-projects>svn-src-projects</a></p></td><td class="tableblock halign-left valign-top"><p class=tableblock><span class=filename>/usr/projects</span></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>A <span class=filename>projects</span> változásai a forrásokat tároló Subversion repositoryn belül</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><a href=https://lists.FreeBSD.org/subscription/svn-src-release>svn-src-release</a></p></td><td class="tableblock halign-left valign-top"><p class=tableblock><span class=filename>/usr/src</span></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>A <span class=filename>releases</span> változásai a forrásokat tároló Subversion repositoryn belül</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><a href=https://lists.FreeBSD.org/subscription/svn-src-releng>svn-src-releng</a></p></td><td class="tableblock halign-left valign-top"><p class=tableblock><span class=filename>/usr/src</span></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>A <span class=filename>releng</span> ágak (biztonsági frissítések és kiadások) változásai a forrásokat tároló Subversion repositoryn belül</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><a href=https://lists.FreeBSD.org/subscription/svn-src-stable>svn-src-stable</a></p></td><td class="tableblock halign-left valign-top"><p class=tableblock><span class=filename>/usr/src</span></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>A stabil verziókhoz tartozó ágak változásai a forrásokat tároló Subversion repositoryn belüle</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><a href=https://lists.FreeBSD.org/subscription/svn-src-stable-6>svn-src-stable-6</a></p></td><td class="tableblock halign-left valign-top"><p class=tableblock><span class=filename>/usr/src</span></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>A <span class=filename>stable/6</span> ág változásai a forrásokat tároló Subversion repositoryn belül</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><a href=https://lists.FreeBSD.org/subscription/svn-src-stable-7>svn-src-stable-7</a></p></td><td class="tableblock halign-left valign-top"><p class=tableblock><span class=filename>/usr/src</span></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>A <span class=filename>stable/7</span> ág változásai a forrásokat tároló Subversion repositoryn belül</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><a href=https://lists.FreeBSD.org/subscription/svn-src-stable-8>svn-src-stable-8</a></p></td><td class="tableblock halign-left valign-top"><p class=tableblock><span class=filename>/usr/src</span></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>A <span class=filename>stable/8</span> ág változásai a forrásokat tároló Subversion repositoryn belül</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><a href=https://lists.FreeBSD.org/subscription/svn-src-stable-other>svn-src-stable-other</a></p></td><td class="tableblock halign-left valign-top"><p class=tableblock><span class=filename>/usr/src</span></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>A Subversion repositoryban található korábbi <span class=filename>stable</span> ágak változásai</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><a href=https://lists.FreeBSD.org/subscription/svn-src-svnadmin>svn-src-svnadmin</a></p></td><td class="tableblock halign-left valign-top"><p class=tableblock><span class=filename>/usr/src</span></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>A forrásokat tároló Subversion repositoryhoz tartozó szkriptek és egy konfigurációs állományok változásai</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><a href=https://lists.FreeBSD.org/subscription/svn-src-user>svn-src-user</a></p></td><td class="tableblock halign-left valign-top"><p class=tableblock><span class=filename>/usr/src</span></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>A <span class=filename>user</span> változásai a forrásokat tároló Subversion repositoryn belül</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><a href=https://lists.FreeBSD.org/subscription/svn-src-vendor>svn-src-vendor</a></p></td><td class="tableblock halign-left valign-top"><p class=tableblock><span class=filename>/usr/src</span></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>A <span class=filename>vendor</span> változásai a forrásokat tároló Subversion repositoryn belül</p></td></tr></tbody></table></div><div class=sect3><h4 id=eresources-subscribe>C.1.2. Hogyan iratkozzunk fel<a class=anchor href=#eresources-subscribe></a></h4><div class=paragraph><p>Ha fel akarunk iratkozni valamelyik listára, kattintsunk a nevére, vagy menjünk a <a href=https://lists.freebsd.org class=bare>https://lists.freebsd.org</a> címre és a válasszuk ki onnan a keresett listát. A lista oldalán megtalálunk minden feliratkozással kapcsolatos utasítást.</p></div><div class=paragraph><p>Ténylegesen úgy tudunk üzenni egy listára, ha levelet küldünk az <a href=mailto:listanév@FreeBSD.org>listanév@FreeBSD.org</a> címre, amely ezután a lista tagjai között kézbesítésre kerül a világban.</p></div><div class=paragraph><p>A listáról úgy tudunk leiratkozni, ha a róla kapott valamelyik levél alján található URL-re kattintunk. Másik megoldás, ha magunk küldünk egy levelet a <a href=mailto:listanév-unsubscribe@FreeBSD.org>listanév-unsubscribe@FreeBSD.org</a> címre.</p></div><div class=paragraph><p>Még egyszer szeretnénk kérni, hogy a szakmai témájú levelezési listákon folyó társalgásokat igyekezzünk az adott témán belül tartani. Ha csupán a fontosabb bejelentésekre vagyunk kíváncsiak, akkor a kisforgalmú <a href=https://lists.FreeBSD.org/subscription/freebsd-announce>FreeBSD announcements levelezési lista</a> használatát válasszuk.</p></div></div><div class=sect3><h4 id=eresources-charters>C.1.3. A listák tematikája<a class=anchor href=#eresources-charters></a></h4><div class=paragraph><p><em>Minden</em> FreeBSD-s levelezési lista rendelkezik bizonyos alapszabályokkal, amelyek minden tagnak el kell fogadnia. Az ismeretett irányelvek elleni vétkezés a FreeBSD postamesterének <a href=mailto:postmaster@FreeBSD.org>postmaster@FreeBSD.org</a> két (2, azaz kettõ) írásos figyelmeztetését vonja maga után, amelyek figyelmen kívül hagyásával, tehát a harmadik szabálysértés alkalmával, a küldõ eltávolításra kerül a FreeBSD összes levelezési listájáról és a továbbiakban szûrni fogják a leveleit. Sajnáljuk, hogy ilyen szabályokat és szankciókat kellett bevezetnünk, de napjaink internetes technológiái igen elvadultak és ahogy az látható is, sokan egyszerûen nem fogják fel, mennyire sérülékenyek egyes részei.</p></div><div class=paragraph><p>Közlekedési szabályok:</p></div><div class=ulist><ul><li><p>Minden beküldött levél témájának meg kell felelnie az adott lista tartalmának, tehát például a szakmai kérdésekkel foglalkozó listákon csak szakmai témájú leveleknek szabad megjelenniük. Az oda nem illõ cseverészés és értelmetlen vitázás csak a lista értékét csökkenti, ezért ezt senkitõl sem tûrjük. A kötetlenebb, konkrét téma nélküli megbeszéléseket inkább a <a href=https://lists.FreeBSD.org/subscription/freebsd-chat>FreeBSD chat levelezési lista</a> címén folytassuk.</p></li><li><p>2 listánál többre ne küldjük be ugyanazt a levelet, és 2 listára is csak akkor küldjük, ha az egyértelmûen és nyilvánvalóan indokolt. A legtöbb listánál így is rengeteg az átfedés, kivéve a legtitkosabb kombinációkat (például "-stable és -scsi"), ezért nem túl sok értelme van egyszerre egynél több listát is értesíteni. Ha olyan üzenetet kapunk, amelynek a <code>Cc</code> (másolat) mezõjében több lista címe is szerepel, akkor továbbküldés vagy válaszadás során töröljük ezeket. <em>Az általunk küldött levelekért továbbra is mi magunk vagyunk a felelõsek, függetlenül attól, hogy ki volt a levél eredeti feladója.</em></p></li><li><p>Tilos (vita közben) személyeskedni vagy káromkodni, beleértve a felhasználókat és a fejlesztõket is. A netikett megszegését, például a privát levelezés elõzetes engedély nélküli továbbküldését vagy egyes részleteinek közlését, elítéljük, de nyíltan nem tiltjuk. Nagyon ritka esetekben <em>azonban</em> elõfordulhat, hogy a sértõ tartalom önmagában ellenkezik a lista elveivel és figyelmeztetést (esetleg kitiltást) von maga után.</p></li><li><p>A FreeBSD-hez nem kötõdõ termékek vagy szolgáltatások reklámozása szigorúan tilos, és ha bebizonyosodik, hogy a küldõ szándékosan küldte szét, akkor azonnali kitiltásban részesül.</p></li></ul></div><div class=paragraph><p><em>Az egyes listák tematikája:</em></p></div><div class=dlist><dl><dt class=hdlist1><a href=https://lists.FreeBSD.org/subscription/freebsd-acpi>FreeBSD ACPI levelezési lista</a></dt><dd><p><em>Az ACPI és energiagazdálkodás támogatásának fejlesztése</em></p></dd><dt class=hdlist1><a href=https://lists.FreeBSD.org/subscription/freebsd-afs>freebsd-afs</a></dt><dd><p><em>Andrew File System</em></p><div class=paragraph><p>Ez a lista a CMU/Transarc AFS portolásáról szól</p></div></dd><dt class=hdlist1><a href=https://lists.FreeBSD.org/subscription/freebsd-announce>FreeBSD announcements levelezési lista</a></dt><dd><p><em>Fontosabb események / nagyobb lépések</em></p><div class=paragraph><p>Olyan emberek számára ajánlott ez a levelezési lista, akik csak a FreeBSD jelentõsebb eseményei bejelentései iránt érdeklõdnek. Ide értendõk a különbözõ idõközi és egyéb kiadások, a FreeBSD újításainak bejelentései. Idõnként önkéntesek toborzására stb. is használják. A forgalma nagyon kicsi, tartalma szigorúan ellenõrzõtt.</p></div></dd><dt class=hdlist1><a href=https://lists.FreeBSD.org/subscription/freebsd-arch>freebsd-arch</a></dt><dd><p><em>Architekturális és tervezési kérdések</em></p><div class=paragraph><p>Ez a lista a FreeBSD architektúráját érintõ megbeszélések színtere. Az itt megjelenõ üzenetek szigorúan szakmai jellegûek. Néhány idevágó téma:</p></div><div class=ulist><ul><li><p>Hogyan alakítsuk úgy át a fordítási rendszert, hogy egyszerre több különbözõ paraméterû fordítás is képes legyen futni.</p></li><li><p>Mit kellene javítani a VFS-en a Heidemann-rétegek mûködéséhez.</p></li><li><p>Hogyan tudnánk úgy átalakítani az eszközmeghajtók felületét, hogy ugyanazok a meghajtók minden gond nélkül képesek legyenek több buszon és architektúrán is mûködni.</p></li><li><p>Hogyan írjunk meghajtót hálózati eszközökhöz.</p></li></ul></div></dd><dt class=hdlist1><a href=https://lists.FreeBSD.org/subscription/freebsd-audit>freebsd-audit</a></dt><dd><p><em>A forráskód vizsgálatát végzõ projekt</em></p><div class=paragraph><p>Ez a levelezési lista a FreeBSD forráskódjának vizsgálatával foglalkozik. Habár eredetileg csak a biztonságot érintõ változtatások ellenõrzésére jött létre, napjainkra már a forráskód mindenféle változását felülvizsgálja.</p></div><div class=paragraph><p>Erre a listára rengeteg javítás érkezik, amelyek valószínûleg egy átlag FreeBSD felhasználó számára nem túlzottan érdekesek. A kód változásától független biztonsági kérdések megvitatása a freebsd-security listán történik. Viszont az összes fejlesztõnek javasoljuk, hogy küldjék be felülvizsgálatra a javításaikat, különösen abban az esetben, amikor a forráskód olyan részéhez nyúlnak, ahol az adott hiba javítása a rendszer egészének mûködésére kihatással lehet.</p></div></dd><dt class=hdlist1><a href=https://lists.FreeBSD.org/subscription/freebsd-binup>freebsd-binup</a></dt><dd><p><em>A FreeBSD bináris frissítésével foglalkozó projekt</em></p><div class=paragraph><p>Ez a lista ad otthont a binup vagy más néven a bináris frissítési rendszer (binary update system) körül felmerülõ problémák tárgyalásának. Tervezési kérdések, implementációs részletek, javítások, hiba- és állapotjelentések, funkciók igénylése, a kód változásainak naplózása és minden, ami a binuppal kapcsolatos.</p></div></dd><dt class=hdlist1><a href=https://lists.FreeBSD.org/subscription/freebsd-bluetooth>freebsd-bluetooth</a></dt><dd><p><em>Bluetooth® a FreeBSD-ben</em></p><div class=paragraph><p>Ez a Bluetooth®-os FreeBSD felhasználók gyülekezõhelye. Tervezési és implementációs kérdések, javítások, hiba- és állapotjelentések, funkciók igénylése, minden, ami Bluetooth®.</p></div></dd><dt class=hdlist1><a href=https://lists.FreeBSD.org/subscription/freebsd-bugbusters>freebsd-bugbusters</a></dt><dd><p><em>A hibajelentések kezelésének összefogása</em></p><div class=paragraph><p>A lista célja a Bugmeister és az õ Bugbustereinek, valamint a hibajelentések adatbázisai iránti kifejezetten érdeklõdõ személyek együttmûködésének és kapcsolattartásának elõsegítése. Ez a lista nem az egyes hibákról, javításokról vagy azok jelentésérõl szól.</p></div></dd><dt class=hdlist1><a href=https://lists.FreeBSD.org/subscription/freebsd-bugs>freebsd-bugs</a></dt><dd><p><em>Hibajelentések</em></p><div class=paragraph><p>Ezen a levelezési listán lehet a FreeBSD hibáit bejelenteni. Ha lehet, akkor a hibákat a <a href="https://man.freebsd.org/cgi/man.cgi?query=send-pr&amp;sektion=1&amp;format=html">send-pr(1)</a> paranccsal vagy a <a href=https://www.FreeBSD.org/send-pr/>webes felületen</a> keresztül küldjük be.</p></div></dd><dt class=hdlist1><a href=https://lists.FreeBSD.org/subscription/freebsd-chat>freebsd-chat</a></dt><dd><p><em>A FreeBSD közösség nem szakmai jellegû dolgai</em></p><div class=paragraph><p>Erre a listára kerül minden olyan nem szakmai jellegû, társadalmi érintkezéssel kapcsolatos információ, ami a többi listáról kimaradt: Jordan mennyire hasonlít a rajzfilmeken látható vadászgörényre, kis- vagy nagybetûvel írjuk-e, ki iszik sok kávét, hol fõzik a legjobb söröket, ki fõz sört az alagsorában és így tovább. Elvétve felbukkannak olyan fontosabb események is (bulik, lakodalmak, gyermekáldás, új munkahely stb), amelyek ugyan szakmai témájúak, de a folyományaik már inkább a -chat listára tartoznak.</p></div></dd><dt class=hdlist1>FreeBSD core team</dt><dd><p><em>A FreeBSD irányítását végzõ csapat</em></p><div class=paragraph><p>Ezt a belsõ levelezési listát a Core Team tagjai használják. Akkor érdemes ide levelet küldeni, ha FreeBSD-vel kapcsolatos fontos ügyekben lenne szükségünk döntésre vagy véleményre.</p></div></dd><dt class=hdlist1><a href=https://lists.FreeBSD.org/subscription/freebsd-current>FreeBSD-CURRENT levelezési lista</a></dt><dd><p><em>A FreeBSD-CURRENT használatával kapcsolatos megbeszélések</em></p><div class=paragraph><p>A FreeBSD-CURRENT felhasználóinak levelezési listája. Itt értesülhetünk a -CURRENT felhasználókat érintõ friss újdonságairól, és azokról az utasításokról, amelyek követésével mûködéképesen tarthatjuk a -CURRENT rendszerünket. Aki a "-CURRENT" verziót használja, mindenképpen iratkozzon fel erre a listára. Ez is egy szakmai jellegû lista, ahová csak szigorúan ilyen témákat várnak.</p></div></dd><dt class=hdlist1><a href=https://lists.FreeBSD.org/subscription/freebsd-cvsweb>freebsd-cvsweb</a></dt><dd><p><em>A FreeBSD CVSweb projekt</em></p><div class=paragraph><p>A FreeBSD CVSweb szolgáltatásának használatáról, fejlesztésérõl és karbantartásáról szóló megbeszélések.</p></div></dd><dt class=hdlist1><a href=https://lists.FreeBSD.org/subscription/freebsd-doc>freebsd-doc</a></dt><dd><p><em>A dokumentációs projekt</em></p><div class=paragraph><p>Ez a levelezési lista a FreeBSD-rõl szóló különbözõ dokumentumok készítésével kapcsolatos problémák és projektek tárgyalásait öleli fel. A levelezési lista tagjait együttesen a "FreeBSD Dokumentációs Projekt"-nek nevezik. Ez egy nyílt lista, csatlakozzunk hozzá bátran!</p></div></dd><dt class=hdlist1><a href=https://lists.FreeBSD.org/subscription/freebsd-drivers>freebsd-drivers</a></dt><dd><p><em>Eszközmeghajtók írása FreeBSD-re</em></p><div class=paragraph><p>A FreeBSD-hez készülõ eszközmeghajtókról szóló szakmai fórum. Elsõsorban itt tehetik fel a meghajtók készítõi a FreeBSD rendszermagjában megtalalálható API-kra vonatkozó kérdéseiket.</p></div></dd><dt class=hdlist1><a href=https://lists.FreeBSD.org/subscription/freebsd-eclipse>freebsd-eclipse</a></dt><dd><p><em>Az Eclipse integrált fejlesztõi környezetének, segéprogramjainak, kliensalkalmazásainak és portjainak FreeBSD felhasználók számára meghirdetett fóruma.</em></p><div class=paragraph><p>A lista azzal a szándékkal jött létre, hogy kölcsönös támogatást nyújtson az Eclipse fejlesztõi környezet, a hozzá tartozó segédeszközök, kliensalkalmazások FreeBSD változatának megválasztásában, telepítésében és használatában. Emellett az Eclipse környezet és pluginjainak FreeBSD-re történõ portolásáról is szó esik.</p></div><div class=paragraph><p>Valamint igyekszik minél többet profitálni az Eclipse és a FreeBSD köré csoportosuló közösségek kölcsönös információcseréjébõl.</p></div><div class=paragraph><p>Habár a lista elsõdlegesen az Eclipse felhasználóinek igényeire koncentrál, azok számára is táptalajt ad, akik az Eclipse keretrendszer segítségével FreeBSD specifikus alkalmazásokat szeretnének kifejleszteni.</p></div></dd><dt class=hdlist1><a href=https://lists.FreeBSD.org/subscription/freebsd-embedded>freebsd-embedded</a></dt><dd><p><em>A FreeBSD használata beágyazott alkalmazásokban</em></p><div class=paragraph><p>Ez a lista a FreeBSD beágyazott rendszerekben történõ használatát igyekszik megvitatni. Ez egy szakmai jellegû lista, ezért ide szigorúan csak ilyen témájú leveleket várunk. A listán tárgyalt beágyazott rendszereknek tekintünk minden olyan számítási eszközt, amely az általános számítási környezetekkel szemben egyetlen feladatot lát el. Nem feltétlenül csak ilyenek, de például a különféle telefonok, illetve hálózati eszközök, mint például útválasztók, switchek, PBX-ek, távoli mérõeszközök, PDA-k, eladási rendszerek és így tovább.</p></div></dd><dt class=hdlist1><a href=https://lists.FreeBSD.org/subscription/freebsd-emulation>freebsd-emulation</a></dt><dd><p><em>A Linux/MS-DOS®/Windows® rendszerek emulációja</em></p><div class=paragraph><p>Ezen a listán arról értekezhetünk és olvashatunk, hogy FreeBSD alatt miként futtassunk más operációs rendszerekre írt programokat.</p></div></dd><dt class=hdlist1><a href=https://lists.FreeBSD.org/subscription/freebsd-eol>freebsd-eol</a></dt><dd><p><em>Összefogás a FreeBSD Projekt által tovább már támogatott, FreeBSD-hez tartozó szoftverekért</em></p><div class=paragraph><p>Ezen a listán kap vagy kaphat helyet a FreeBSD Projekt által hivatalosan tovább már nem fejlesztett szoftverek felhasználói összefogáson alapuló támogatása (például biztonsági figyelmeztetések vagy javítások formájában).</p></div></dd><dt class=hdlist1><a href=https://lists.FreeBSD.org/subscription/freebsd-firewire>freebsd-firewire</a></dt><dd><p><em>FireWire® (iLink, IEEE 1394)</em></p><div class=paragraph><p>Ez a levelezési lista foglalkozik a FreeBSD FireWire® (azaz IEEE 1394, avagy iLink) alrendszerének implementációjával. Az itt felmerülõ témák többek közt a szabványok, buszos eszközök és a hozzájuk tartozó protokollok, vezérlõkártyák és chipkészletek, valamint a mûködtetésükre szánt programok felépítése és megvalósítása.</p></div></dd><dt class=hdlist1><a href=https://lists.FreeBSD.org/subscription/freebsd-fs>freebsd-fs</a></dt><dd><p><em>Állományrendszerek</em></p><div class=paragraph><p>A FreeBSD-ben megjelenõ állományrendszerek kivesézése. Mivel ez egy szakmai jellegû lista, ide határozottan csak ilyen jellegû leveleket várunk.</p></div></dd><dt class=hdlist1><a href=https://lists.FreeBSD.org/subscription/freebsd-gecko>freebsd-gecko</a></dt><dd><p><em>Gecko Rendering Engine</em></p><div class=paragraph><p>Ezen a levelezési listán a Gecko FreeBSD rendszerekre portolt változatával kapcsolatos fórumot találjuk.</p></div><div class=paragraph><p>Az itt felmerülõ témák többségükben a Gecko alapú alkalmazásokról, telepítésükrõl, és a FreeBSD alatti fejlesztésükrõl, támogatásukról szólnak.</p></div></dd><dt class=hdlist1><a href=https://lists.FreeBSD.org/subscription/freebsd-geom>freebsd-geom</a></dt><dd><p><em>GEOM</em></p><div class=paragraph><p>A GEOM és a vele kapcsolatos implementáció megbeszélései. Szakmai jellegû lista, ezért erre tekintettel csak ilyen témájú leveleket postázzunk ide.</p></div></dd><dt class=hdlist1><a href=https://lists.FreeBSD.org/subscription/freebsd-gnome>freebsd-gnome</a></dt><dd><p><em>GNOME</em></p><div class=paragraph><p>A GNOME asztalkörnyezet FreeBSD rendszereket érintõ használatáról szóló lista. Mûszaki jellegû, ezért szigorúan csak ilyen témákban társgalodjunk itt.</p></div></dd><dt class=hdlist1><a href=https://lists.FreeBSD.org/subscription/freebsd-ipfw>freebsd-ipfw</a></dt><dd><p><em>IP tûzfalak</em></p><div class=paragraph><p>A FreeBSD-ben levõ IP tûzfal újratervezésével foglalkozó elgondolások és szakmai témájú megbeszélések otthona. Ide szigorúan csak ilyen témájú leveleket küldjünk!</p></div></dd><dt class=hdlist1><a href=https://lists.FreeBSD.org/subscription/freebsd-ia64>freebsd-ia64</a></dt><dd><p><em>A FreeBSD portolása I64-re</em></p><div class=paragraph><p>Ez a levelezési lista a FreeBSD az Intel® IA-64 platformjára készített portjával foglalkozó egyének kommunikációs eszköze, ahol az ezzel kapcsolatos problémák és azok különbözõ megoldásai kerülnek terítékre. A téma iránt érdeklõdõket is szívesen látjuk.</p></div></dd><dt class=hdlist1><a href=https://lists.FreeBSD.org/subscription/freebsd-isdn>freebsd-isdn</a></dt><dd><p><em>ISDN kommunikáció</em></p><div class=paragraph><p>Ez a levelezési lista a FreeBSD ISDN támogatásáról szól.</p></div></dd><dt class=hdlist1><a href=https://lists.FreeBSD.org/subscription/freebsd-java>freebsd-java</a></dt><dd><p><em>Java™ alapú fejlesztések</em></p><div class=paragraph><p>A levelezési listán a nagyobb Java™ alkalmazások FreeBSD alapú fejlesztését, valamint a JDK™-k portolásáról és karbantartását beszélik meg.</p></div></dd></dl></div><div id=eresources-charters-jobs class=dlist><dl><dt class=hdlist1><a href=https://lists.FreeBSD.org/subscription/freebsd-jobs>freebsd-jobs</a></dt><dd><p><em>Munkát keres/kínál</em></p><div class=paragraph><p>Erre a fórumra tudjuk beküldeni a kifejezetten FreeBSD-hez kapcsolódó munkaajánlatokat és önéletrajzokat, tehát ez a megfelelõ hely, ha FreeBSD-s munkát keresünk, vagy éppen FreeBSD szakértõket. Ez azonban <em>nem</em> egy általános célú állásbörze, mert arra megvannak a megfelelõ helyek.</p></div><div class=paragraph><p>Szeretnénk hozzátenni, hogy ez a lista, a többi <code>FreeBSD.org</code> levelezési listához hasonlóan, világméretekben mûködik. Ezért ne felejtsük sosem pontosan megjelölni a munkavégzés helyét, illetve hogy milyen kommunikációs és esetlegesen költözési lehetõségeket javaslunk.</p></div><div class=paragraph><p>A leveleket csak nyílt formátumban küldjük - elsõsorban szöveges formátumban, de az egyszerûbb PDF, HTML vagy még néhány más hozzájuk hasonló formátumot is alkalmazhatunk. Az olyan zárt formátumok, mint például a Microsoft® Word (<span class=filename>.doc</span>) azonban nem fognak továbbítódni.</p></div></dd><dt class=hdlist1><a href=https://mail.kde.org/mailman/listinfo/kde-freebsd>freebsd-kde</a></dt><dd><p><em>KDE</em></p><div class=paragraph><p>A KDE és FreeBSD kapcsolatáról szóló lista. Szigorúan szakmai jellegû, ezért csak ilyen témájú levelek küldése elfogadott.</p></div></dd><dt class=hdlist1><a href=https://lists.FreeBSD.org/subscription/freebsd-hackers>freebsd-hackers</a></dt><dd><p><em>Szakmai kérdések</em></p><div class=paragraph><p>Ez a FreeBSD szakmai jellegû kérdéseivel foglalkozó fórum. Ez az elsõ számû szakmai levelezési lista. A FreeBSD fejlesztésével aktívan foglalkozó egyének számára ajánljuk, hiszen itt vethetik fel problémáikat, itt kereshetnek rájuk megoldásokat. Az ilyen típusú megbeszéléseket figyelemmel követõ egyéneket is szívesen fogadjuk. Mivel ez egy erõsen szakmai jellegû lista, ezért csak ilyen témájú leveleket várunk ide.</p></div></dd><dt class=hdlist1><a href=https://lists.FreeBSD.org/subscription/freebsd-hardware>freebsd-hardware</a></dt><dd><p><em>A FreeBSD és a hardverek kapcsolatáról általában</em></p><div class=paragraph><p>Ezen a listán kerül megvitatásra minden olyan hardver, amelyen a FreeBSD mûködik: milyen gondok adódhatnak, milyen hardvereket érdemes beszereznünk vagy elkerülnünk.</p></div></dd><dt class=hdlist1><a href=https://lists.FreeBSD.org/subscription/freebsd-hubs>freebsd-hubs</a></dt><dd><p><em>Tükrözések</em></p><div class=paragraph><p>A FreeBSD tükrözéseit karbantartó egyének számára fontos bejelentések és megbeszélések.</p></div></dd><dt class=hdlist1><a href=https://lists.FreeBSD.org/subscription/freebsd-isp>freebsd-isp</a></dt><dd><p><em>Az internet-szolgáltatók fóruma</em></p><div class=paragraph><p>Ezen a levelezési listán a FreeBSD-t használó internet-szolgáltatók tehetik fel kérdéseiket. Szigorúan csak szakmai jellegû kérdések engedélyezettek.</p></div></dd><dt class=hdlist1><a href=https://lists.FreeBSD.org/subscription/freebsd-mono>freebsd-mono</a></dt><dd><p><em>Mono és C# alkalmazások FreeBSD alatt</em></p><div class=paragraph><p>Ezen a levelezési listán a Mono fejlesztõi keretrendszer FreeBSD alatt futó változatával kapcsolatos megbeszélések folynak. Ez egy szakmai jellegû lista. Itt a Mono vagy más C# alkalmazások FreeBSD változatának elkészítésén dolgozó egyének tudnak problémákat felvetni vagy megvitatni a különbözõ megoldásokat. Rajtuk kívül viszont szeretettel várunk minden érdeklõdõt a téma iránt.</p></div></dd><dt class=hdlist1><a href=https://lists.FreeBSD.org/subscription/freebsd-openoffice>freebsd-openoffice</a></dt><dd><p><em>OpenOffice.org</em></p><div class=paragraph><p>Az OpenOffice.org és StarOffice™ portolásával és karbantartásával kapcsolatos megbeszélések.</p></div></dd><dt class=hdlist1><a href=https://lists.FreeBSD.org/subscription/freebsd-performance>freebsd-performance</a></dt><dd><p><em>A FreeBSD hangolásának és gyorsításának tárgyalása</em></p><div class=paragraph><p>Ezen a levelezési listán van lehetõségük a hackereknek, rendszergazdáknak és/vagy az érintett feleknek a FreeBSD teljesítményével kapcsolatos témákban kifejteni a véleményüket. Leginkább nagy terhelés alatt levõ, vagy teljesítménybeli problémákkal küszködõ, esetleg még többet tudó FreeBSD rendszerek tárgyalása a cél. Lehetõleg az érintett gyártókkal és szállítókkal együttesen próbáljuk kidolgozni a FreeBSD teljesítményének növelésére tett kísérleteinket, ezért õket is szívesen látjuk ezen a listán. Ez a kifejezetten szakmai jellegû lista többségében a tapasztalt FreeBSD felhasználók, hackerek vagy rendszergazdák számára tárja fel a gyors, megbízható és skálázható FreeBSD rendszerek lehetõségeit. Ez alapvetõen nem egy kérdezgetõs lista, ahol a dokumentációk elolvasását tudjuk megspórolni, hanem egy olyan hely, ahol a teljesítményt érintõ megválaszolatlan kérdések és elõremutató fejlesztések nyernek teret.</p></div></dd><dt class=hdlist1><a href=https://lists.FreeBSD.org/subscription/freebsd-pf>freebsd-pf</a></dt><dd><p><em>A csomagszûrõ tûzfalrendszerrel kapcsolatos kérdések</em></p><div class=paragraph><p>A FreeBSD csomagszûrõjéhez (packet filter, pf) tartozó tûzfalrendszer megbeszéléseit összefoglaló lista. Szakmai jellegû fejtegetések és felhasználói kérdések egyaránt jöhetnek. Továbbá ezen a listán foglalkozunk az ALTQ rendszer mûködésével is.</p></div></dd><dt class=hdlist1><a href=https://lists.FreeBSD.org/subscription/freebsd-platforms>freebsd-platforms</a></dt><dd><p><em>Portolás nem Intel® plaformokra</em></p><div class=paragraph><p>A FreeBSD különbözõ, nem az Intel® architektúrára építkezõ portjainak indítványozása és általános jellegû megvitatása. Ez egy kiemelten szakmai jellegû lista, ezért ide csak ilyen témájú leveleket várunk.</p></div></dd><dt class=hdlist1><a href=https://lists.FreeBSD.org/subscription/freebsd-policy>freebsd-policy</a></dt><dd><p><em>Az Core Team szabályozásai</em></p><div class=paragraph><p>Alacsony forgalmú, csak olvasható lista, ahol a FreeBSD fejlesztését irányító csoport különbözõ döntéseirõl olvashatunk.</p></div></dd><dt class=hdlist1><a href=https://lists.FreeBSD.org/subscription/freebsd-ports>freebsd-ports</a></dt><dd><p><em>A "portok" megbeszélése</em></p><div class=paragraph><p>A FreeBSD "portgyûjteményével" (<span class=filename>/usr/ports</span>), a portok infrastruktúrájával és a portok fejlesztésének irányításával kapcsolatos megbeszélések. Erõsen szakmai jellegû lista, ezért ide csak ilyen témában írjunk.</p></div></dd><dt class=hdlist1><a href=https://lists.FreeBSD.org/subscription/freebsd-ports-bugs>freebsd-ports-bugs</a></dt><dd><p><em>A "portok" hibáinak tárgyalása</em></p><div class=paragraph><p>A FreeBSD "portgyûjteményének" (<span class=filename>/usr/ports</span>), a bejelentett portok és azok módosításához kötõdõ hibajelentésekkel foglalkozó lista. Ez egy szakmai jellegû lista, ahol csak ilyen jellegû témákra számítunk.</p></div></dd><dt class=hdlist1><a href=https://lists.FreeBSD.org/subscription/freebsd-proliant>freebsd-proliant</a></dt><dd><p><em>A FreeBSD és a HP ProLiant szerverek kapcsolatát érintõ szakmai megbeszélések</em></p><div class=paragraph><p>Ezen a levelezési listán a FreeBSD HP ProLiant szervereken történõ használatát célozzuk meg, beleértve a ProLianthoz tartozó eszközmeghajtókat, karbantartó és konfigurációs szoftvereket és BIOS-frissítéseket. Ennek megfelelõen tehát a hpasmd, hpasmcli és hpacucli modulok is elsõsorban itt kerülnek felboncolásra.</p></div></dd><dt class=hdlist1><a href=https://lists.FreeBSD.org/subscription/freebsd-python>freebsd-python</a></dt><dd><p><em>A FreeBSD és a Python</em></p><div class=paragraph><p>A lista a FreeBSD Python támogatásának fejlesztésérõl folytatott szakmai megbeszéléseket foglalja össze. Elsõsorban a Python portolásával foglalkozó egyének, valamint a külsõ fejlesztõk által készített modulok és a Zope FreeBSD-s alkalmazásával foglalkozik. Az említett témák iránti érdeklõdõket is szeretettel várjuk.</p></div></dd><dt class=hdlist1><a href=https://lists.FreeBSD.org/subscription/freebsd-questions>freebsd-questions</a></dt><dd><p><em>Felhasználói kérdések</em></p><div class=paragraph><p>Ez a levelezési lista a FreeBSD-vel kapcsolatos kérdésekrõl szól. Lehetõleg ne küldjünk "hogyan" témájú kérdéseket erre a szakmai listára, hacsak nem kifejezetten szakmai jellegûnek szánjuk.</p></div></dd><dt class=hdlist1><a href=https://lists.FreeBSD.org/subscription/freebsd-ruby>freebsd-ruby</a></dt><dd><p><em>A Ruby használata FreeBSD rendszereken</em></p><div class=paragraph><p>Ezen a listán a FreeBSD Ruby támogatásával foglalkozunk, témáját tekintve teljesen szakmai jellegû. Elsõsorban a Ruby portokon, külsõ Ruby könyvtárakon és rendszereken dolgozó fejlesztõk figyelmébe ajánljuk.</p></div><div class=paragraph><p>Mindenkit szeretettel várunk, aki ezekkel kapcsolatos szakmai tárgyú témákat szeretne megvitatni.</p></div></dd><dt class=hdlist1><a href=https://lists.FreeBSD.org/subscription/freebsd-scsi>freebsd-scsi</a></dt><dd><p><em>A SCSI alrendszer</em></p><div class=paragraph><p>Ezt a levelezési listát a FreeBSD alatt a SCSI alrendszerrel foglalkozók számára tarjuk fenn. Mivel ez egy erõsen szakmai jellegû lista, ezért rajta csak szakmai témák megengedettek.</p></div></dd><dt class=hdlist1><a href=https://lists.FreeBSD.org/subscription/freebsd-security>FreeBSD security levelezési lista</a></dt><dd><p><em>Biztonsági problémák</em></p><div class=paragraph><p>A FreeBSD biztonságát illetõ kérdések (DES, Kerberos, biztonsági rések és javításaik, stb.) Szakmai jellegû lista, ezért ide csak a témához szorosan kapcsolódó leveleket szabad beküldeni. Alapvetõen nem kérdezz-felelek típusú a lista mûködése, habár a GYIK-hoz minden hozzájárulást (kérdést ÉS választ EGYARÁNT) szívesen veszünk.</p></div></dd><dt class=hdlist1><a href=https://lists.FreeBSD.org/subscription/freebsd-security-notifications>FreeBSD security notifications levelezési lista</a></dt><dd><p><em>Biztonsági figyelmeztetések</em></p><div class=paragraph><p>A FreeBSD-t érintõ biztonsági problémákról és javításaikról szóló értesítések. Megbeszélésekkel, vitákkal nem foglalkozik, mivel azok a FreeBSD-security listán folynak.</p></div></dd><dt class=hdlist1><a href=https://lists.FreeBSD.org/subscription/freebsd-small>freebsd-small</a></dt><dd><p><em>A FreeBSD használata beágyazott alkalmazásokban</em></p><div class=paragraph><p>A szokatlanul kis méretû vagy beágyazott FreeBSD rendszerekhez kapcsolódó megbeszélések színhelye. Szakmai jellegû lista, ezért szigorúan csak a témához tartozó leveleket fogad.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Ezt a listát idõközben felváltotta a <a href=https://lists.FreeBSD.org/subscription/freebsd-embedded>freebsd-embedded</a> lista.</p></div></td></tr></tbody></table></div></dd><dt class=hdlist1><a href=https://lists.FreeBSD.org/subscription/freebsd-stable>FreeBSD-STABLE; levelezési lista</a></dt><dd><p><em>A FreeBSD-STABLE használatáról szóló lista</em></p><div class=paragraph><p>Ez a FreeBSD-STABLE használóinak levelezési listája. Ide kerülnek beküldésre a -STABLE ágat futtató felhasználókat érintõ friss változások, valamint hozzájuk kötõdõen a -STABLE használatához szükséges elvégzendõ lépések. Aki a "STABLE" jelzésû változatot használja, mindenképpen iratkozzon fel rá. Szigorúan szakmai jellegû lista, ezért csak szakmai témájú leveleket vár.</p></div></dd><dt class=hdlist1><a href=https://lists.FreeBSD.org/subscription/freebsd-standards>freebsd-standards</a></dt><dd><p><em>C99 és POSIX megfelelés</em></p><div class=paragraph><p>Ez a fórum foglalkozik a FreeBSD és a C99, valamint a POSIX szabványok szerinti megfelelésével.</p></div></dd><dt class=hdlist1><a href=https://lists.FreeBSD.org/subscription/freebsd-toolchain>freebsd-toolchain</a></dt><dd><p><em>A FreeBSD alapvetõ segédprogramjainak karbantartása</em></p><div class=paragraph><p>Ezen a listán a FreeBSD egyes kiadásaihoz mellékelt alapvetõ segédprogramokkal kapcsolatos témákat találjuk meg. Ilyen többek közt rendszerben használt Clang és a GCC fordítók aktuálisan használt változatai, de emellett még szó eshet a rendszerhez kapcsolódó különféle assemblerek, linkerek és debuggerek állapotáról.</p></div></dd><dt class=hdlist1><a href=https://lists.FreeBSD.org/subscription/freebsd-usb>freebsd-usb</a></dt><dd><p><em>A FreeBSD USB támogatása</em></p><div class=paragraph><p>Ez a levelezési lista fogja összes a FreeBSD USB támogatásával foglalkozó szakmai témákat.</p></div></dd><dt class=hdlist1><a href=https://lists.FreeBSD.org/subscription/freebsd-user-groups>freebsd-user-groups</a></dt><dd><p><em>A felhasználói csoportokat irányító lista</em></p><div class=paragraph><p>Ez a levelezési lista az egyes területeken mûködõ felhasználói csoportok az irányítást végzõ központi csoport tagjai általi összehangolásához tartozó problémák megbeszélésére való. Ez a lista leginkább a gyûlések letisztázására és a több csoporton átívelõ nagyobb projektek szervezéséhez használatos.</p></div></dd><dt class=hdlist1><a href=https://lists.FreeBSD.org/subscription/freebsd-vendors>freebsd-vendors</a></dt><dd><p><em>Gyártók</em></p><div class=paragraph><p>A FreeBSD projekt és a hozzá kötödõ hardver- és szoftvergyártók együttmûködését elõsegítõ lista.</p></div></dd><dt class=hdlist1><a href=https://lists.FreeBSD.org/subscription/freebsd-virtualization>freebsd-virtualization</a></dt><dd><p><em>A FreeBSD részérõl támogatott különbözõ virtualizációs technológiák</em></p><div class=paragraph><p>Ezen a levelezési listán elsõsorban a FreeBSD által támogatott virtualizációs megoldásokat vitatjuk meg. Ennek keretében egyrészt az ehhez kapcsolódó alapvetõ funkciók megvalósítása valamint további újítások kerülnek a középpontba, másrészt a felhasználók számára ezzel létrehoztunk egy fórumot a felmerülõ problémák megoldására és az alkalmazási lehetõségek megbeszelésére.</p></div></dd><dt class=hdlist1><a href=https://lists.FreeBSD.org/subscription/freebsd-wip-status>freebsd-wip-status</a></dt><dd><p><em>A FreeBSD-vel kapcsolatos folyamatban levõ fejlesztések helyzetjelentése</em></p><div class=paragraph><p>Ezen a levelezési listán kerülnek bejelentésre a FreeBSD továbbfejlesztéséhez fûzõdõ különbözõ munkák és azok haladásának menete. Az ide befutó üzeneteket moderálják. Javasoljuk, hogy elsõdlegesen az adott témához tartozó tematikus FreeBSD listára küldjük a bejelentésünket és csak egy másolatot erre a listára. Ennek köszönhetõen a munkánk az adott témaspecifikus listán rögtön meg is vitatható, mivel ezen a listán semmi ilyen nem engedélyezett.</p></div><div class=paragraph><p>A lista archívumába tekintve tájékozódhatunk arról, hogy pontosan milyen formai követelmények illene megfelelnie a beküldenõ üzenetünknek.</p></div><div class=paragraph><p>A listára beérkezõ üzenetekbõl egy szerkesztett válogatás jelenik meg néhány havonta a FreeBSD honlapján a Projekt helyzetjelentésének részeként . A korábban beküldött jelentések mellett itt még találhatunk további példákat.</p></div></dd><dt class=hdlist1><a href=https://lists.FreeBSD.org/subscription/freebsd-xen>freebsd-xen</a></dt><dd><p><em>A Xen™ FreeBSD portjának (implementáció és használat) megvitatása</em></p><div class=paragraph><p>A lista elsõsorban a Xen™ FreeBSD-re készült változatával foglalkozik. Elõreláthatólag elég kevesen fognak írni erre a listára ahhoz, hogy helyet kapjanak rajta az implementációt és a kialakítást érintõ szakmai jellegû megbeszélések és a telepítéssel kapcsolatos kérdések egyaránt.</p></div></dd></dl></div></div><div class=sect3><h4 id=eresources-mailfiltering>C.1.4. A levelezési listák szûrése<a class=anchor href=#eresources-mailfiltering></a></h4><div class=paragraph><p>A kéretlen reklámlevelek, vírusok és egyebek elleni védekezés céljából a FreeBSD levelezési listáinak forgalmát több módon is szûrik. Az ebben a szakaszban bemutatott szûrési megoldások nem fedik le a levelezési listák védelme érdekében alkalmazott összes lehetõséget.</p></div><div class=paragraph><p>A levelezési listákra csak bizonyos típusú csatolt állományokat küldhetünk be. Az alábbi listában nem található MIME típusú csatolt objektumokat még a listára érkezés elõtt törlik.</p></div><div class=ulist><ul><li><p>application/octet-stream</p></li><li><p>application/pdf</p></li><li><p>application/pgp-signature</p></li><li><p>application/x-pkcs7-signature</p></li><li><p>message/rfc822</p></li><li><p>multipart/alternative</p></li><li><p>multipart/related</p></li><li><p>multipart/signed</p></li><li><p>text/html</p></li><li><p>text/plain</p></li><li><p>text/x-diff</p></li><li><p>text/x-patch</p></li></ul></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Egyes levelezési listák ugyan megengedhetnek további csatolt MIME objektumokat is, habár a legtöbb lista esetében a fenti lista a mérvadó.</p></div></td></tr></tbody></table></div><div class=paragraph><p>Ha egy levélben a szöveg HTML és nyers szöveg formátumban is szerepel, a HTML változat automatikusan eltávolításra kerül. Ha az e-mail csak HTML formában tartalmazza a szöveget, akkor automatikusan nyers szövegre alakítódik át.</p></div></div></div><div class=sect2><h3 id=eresources-news>C.2. Usenet hírcsoportok<a class=anchor href=#eresources-news></a></h3><div class=paragraph><p>A két FreeBSD-s hírcsoport mellett még akadnak olyan további csoportok is, ahol FreeBSD témájú kérdéseket vitathatunk meg vagy hasznos lehet számunkra. Az itt felsorolt hírcsoportok <a href=http://minnie.tuhs.org/BSD-info/bsdnews_search.html>kulcsszavakkal kereshetõ archívuma</a> Warren Toomey tulajdona (<a href=mailto:wkt@cs.adfa.edu.au>wkt@cs.adfa.edu.au</a>).</p></div><div class=sect3><h4 id=_bsd_s_hírcsoportok>C.2.1. BSD-s hírcsoportok<a class=anchor href=#_bsd_s_hírcsoportok></a></h4><div class=ulist><ul><li><p><a href=news:comp.unix.bsd.freebsd.announce>comp.unix.bsd.freebsd.announce</a></p></li><li><p><a href=news:comp.unix.bsd.freebsd.misc>comp.unix.bsd.freebsd.misc</a></p></li><li><p><a href=news:de.comp.os.unix.bsd>de.comp.os.unix.bsd</a> (német)</p></li><li><p><a href=news:fr.comp.os.bsd>fr.comp.os.bsd</a> (francia)</p></li><li><p><a href=news:it.comp.os.freebsd>it.comp.os.freebsd</a> (olasz)</p></li><li><p><a href=news:tw.bbs.comp.386bsd>tw.bbs.comp.386bsd</a> (hagyományos kínai)</p></li></ul></div></div><div class=sect3><h4 id=_egyéb_érdekes_unix_os_hírcsoportok>C.2.2. Egyéb érdekes UNIX®-os hírcsoportok<a class=anchor href=#_egyéb_érdekes_unix_os_hírcsoportok></a></h4><div class=ulist><ul><li><p><a href=news:comp.unix>comp.unix</a></p></li><li><p><a href=news:comp.unix.questions>comp.unix.questions</a></p></li><li><p><a href=news:comp.unix.admin>comp.unix.admin</a></p></li><li><p><a href=news:comp.unix.programmer>comp.unix.programmer</a></p></li><li><p><a href=news:comp.unix.shell>comp.unix.shell</a></p></li><li><p><a href=news:comp.unix.user-friendly>comp.unix.user-friendly</a></p></li><li><p><a href=news:comp.security.unix>comp.security.unix</a></p></li><li><p><a href=news:comp.sources.unix>comp.sources.unix</a></p></li><li><p><a href=news:comp.unix.advocacy>comp.unix.advocacy</a></p></li><li><p><a href=news:comp.unix.misc>comp.unix.misc</a></p></li><li><p><a href=news:comp.bugs.4bsd>comp.bugs.4bsd</a></p></li><li><p><a href=news:comp.bugs.4bsd.ucb-fixes>comp.bugs.4bsd.ucb-fixes</a></p></li><li><p><a href=news:comp.unix.bsd>comp.unix.bsd</a></p></li></ul></div></div><div class=sect3><h4 id=_x_window_system>C.2.3. X Window System<a class=anchor href=#_x_window_system></a></h4><div class=ulist><ul><li><p><a href=news:comp.windows.x.i386unix>comp.windows.x.i386unix</a></p></li><li><p><a href=news:comp.windows.x>comp.windows.x</a></p></li><li><p><a href=news:comp.windows.x.apps>comp.windows.x.apps</a></p></li><li><p><a href=news:comp.windows.x.announce>comp.windows.x.announce</a></p></li><li><p><a href=news:comp.windows.x.intrinsics>comp.windows.x.intrinsics</a></p></li><li><p><a href=news:comp.windows.x.motif>comp.windows.x.motif</a></p></li><li><p><a href=news:comp.windows.x.pex>comp.windows.x.pex</a></p></li><li><p><a href=news:comp.emulators.ms-windows.wine>comp.emulators.ms-windows.wine</a></p></li></ul></div></div></div><div class=sect2><h3 id=eresources-web>C.3. Világhálós szolgáltatások<a class=anchor href=#eresources-web></a></h3><div class=paragraph><p><a href=#central-mirrors>Central Servers</a>, <a href=#armenia-mirrors>Armenia</a>, <a href=#australia-mirrors>Australia</a>, <a href=#austria-mirrors>Austria</a>, <a href=#czech-republic-mirrors>Czech Republic</a>, <a href=#denmark-mirrors>Denmark</a>, <a href=#finland-mirrors>Finland</a>, <a href=#france-mirrors>France</a>, <a href=#germany-mirrors>Germany</a>, <a href=#hong-kong-mirrors>Hong Kong</a>, <a href=#ireland-mirrors>Ireland</a>, <a href=#japan-mirrors>Japan</a>, <a href=#latvia-mirrors>Latvia</a>, <a href=#lithuania-mirrors>Lithuania</a>, <a href=#netherlands-mirrors>Netherlands</a>, <a href=#norway-mirrors>Norway</a>, <a href=#russia-mirrors>Russia</a>, <a href=#slovenia-mirrors>Slovenia</a>, <a href=#south-africa-mirrors>South Africa</a>, <a href=#spain-mirrors>Spain</a>, <a href=#sweden-mirrors>Sweden</a>, <a href=#switzerland-mirrors>Switzerland</a>, <a href=#taiwan-mirrors>Taiwan</a>, <a href=#uk-mirrors>United Kingdom</a>, <a href=#usa-mirrors>United States of America</a>.</p></div><div class=paragraph><p>(as of UTC)</p></div><div id=central-mirrors class=paragraph><p><strong>Central Servers</strong></p></div><div class=ulist><ul><li><p><a href=https://www.FreeBSD.org/ class=bare>https://www.FreeBSD.org/</a></p></li></ul></div><div id=armenia-mirrors class=paragraph><p><strong>Armenia</strong></p></div><div class=ulist><ul><li><p><a href=http://www.at.FreeBSD.org/ class=bare>http://www.at.FreeBSD.org/</a> (IPv6)</p></li></ul></div><div id=australia-mirrors class=paragraph><p><strong>Australia</strong></p></div><div class=ulist><ul><li><p><a href=http://www.au.FreeBSD.org/ class=bare>http://www.au.FreeBSD.org/</a></p></li><li><p><a href=http://www2.au.FreeBSD.org/ class=bare>http://www2.au.FreeBSD.org/</a></p></li></ul></div><div id=austria-mirrors class=paragraph><p><strong>Austria</strong></p></div><div class=ulist><ul><li><p><a href=http://www.at.FreeBSD.org/ class=bare>http://www.at.FreeBSD.org/</a> (IPv6)</p></li></ul></div><div id=czech-republic-mirrors class=paragraph><p><strong>Czech Republic</strong></p></div><div class=ulist><ul><li><p><a href=http://www.cz.FreeBSD.org/ class=bare>http://www.cz.FreeBSD.org/</a> (IPv6)</p></li></ul></div><div id=denmark-mirrors class=paragraph><p><strong>Denmark</strong></p></div><div class=ulist><ul><li><p><a href=http://www.dk.FreeBSD.org/ class=bare>http://www.dk.FreeBSD.org/</a> (IPv6)</p></li></ul></div><div id=finland-mirrors class=paragraph><p><strong>Finland</strong></p></div><div class=ulist><ul><li><p><a href=http://www.fi.FreeBSD.org/ class=bare>http://www.fi.FreeBSD.org/</a></p></li></ul></div><div id=france-mirrors class=paragraph><p><strong>France</strong></p></div><div class=ulist><ul><li><p><a href=http://www1.fr.FreeBSD.org/ class=bare>http://www1.fr.FreeBSD.org/</a></p></li></ul></div><div id=germany-mirrors class=paragraph><p><strong>Germany</strong></p></div><div class=ulist><ul><li><p><a href=http://www.de.FreeBSD.org/ class=bare>http://www.de.FreeBSD.org/</a></p></li></ul></div><div id=hong-kong-mirrors class=paragraph><p><strong>Hong Kong</strong></p></div><div class=ulist><ul><li><p><a href=http://www.hk.FreeBSD.org/ class=bare>http://www.hk.FreeBSD.org/</a></p></li></ul></div><div id=ireland-mirrors class=paragraph><p><strong>Ireland</strong></p></div><div class=ulist><ul><li><p><a href=http://www.ie.FreeBSD.org/ class=bare>http://www.ie.FreeBSD.org/</a></p></li></ul></div><div id=japan-mirrors class=paragraph><p><strong>Japan</strong></p></div><div class=ulist><ul><li><p><a href=http://www.jp.FreeBSD.org/www.FreeBSD.org/ class=bare>http://www.jp.FreeBSD.org/www.FreeBSD.org/</a> (IPv6)</p></li></ul></div><div id=latvia-mirrors class=paragraph><p><strong>Latvia</strong></p></div><div class=ulist><ul><li><p><a href=http://www.lv.FreeBSD.org/ class=bare>http://www.lv.FreeBSD.org/</a></p></li></ul></div><div id=lithuania-mirrors class=paragraph><p><strong>Lithuania</strong></p></div><div class=ulist><ul><li><p><a href=http://www.lt.FreeBSD.org/ class=bare>http://www.lt.FreeBSD.org/</a></p></li></ul></div><div id=netherlands-mirrors class=paragraph><p><strong>Netherlands</strong></p></div><div class=ulist><ul><li><p><a href=http://www.nl.FreeBSD.org/ class=bare>http://www.nl.FreeBSD.org/</a></p></li></ul></div><div id=norway-mirrors class=paragraph><p><strong>Norway</strong></p></div><div class=ulist><ul><li><p><a href=http://www.no.FreeBSD.org/ class=bare>http://www.no.FreeBSD.org/</a></p></li></ul></div><div id=russia-mirrors class=paragraph><p><strong>Russia</strong></p></div><div class=ulist><ul><li><p><a href=http://www.ru.FreeBSD.org/ class=bare>http://www.ru.FreeBSD.org/</a> (IPv6)</p></li></ul></div><div id=slovenia-mirrors class=paragraph><p><strong>Slovenia</strong></p></div><div class=ulist><ul><li><p><a href=http://www.si.FreeBSD.org/ class=bare>http://www.si.FreeBSD.org/</a></p></li></ul></div><div id=south-africa-mirrors class=paragraph><p><strong>South Africa</strong></p></div><div class=ulist><ul><li><p><a href=http://www.za.FreeBSD.org/ class=bare>http://www.za.FreeBSD.org/</a></p></li></ul></div><div id=spain-mirrors class=paragraph><p><strong>Spain</strong></p></div><div class=ulist><ul><li><p><a href=http://www.es.FreeBSD.org/ class=bare>http://www.es.FreeBSD.org/</a></p></li><li><p><a href=http://www2.es.FreeBSD.org/ class=bare>http://www2.es.FreeBSD.org/</a></p></li></ul></div><div id=sweden-mirrors class=paragraph><p><strong>Sweden</strong></p></div><div class=ulist><ul><li><p><a href=http://www.se.FreeBSD.org/ class=bare>http://www.se.FreeBSD.org/</a></p></li></ul></div><div id=switzerland-mirrors class=paragraph><p><strong>Switzerland</strong></p></div><div class=ulist><ul><li><p><a href=http://www.ch.FreeBSD.org/ class=bare>http://www.ch.FreeBSD.org/</a> (IPv6)</p></li><li><p><a href=http://www2.ch.FreeBSD.org/ class=bare>http://www2.ch.FreeBSD.org/</a> (IPv6)</p></li></ul></div><div id=taiwan-mirrors class=paragraph><p><strong>Taiwan</strong></p></div><div class=ulist><ul><li><p><a href=http://www.tw.FreeBSD.org/ class=bare>http://www.tw.FreeBSD.org/</a></p></li><li><p><a href=http://www2.tw.FreeBSD.org/ class=bare>http://www2.tw.FreeBSD.org/</a></p></li><li><p><a href=http://www4.tw.FreeBSD.org/ class=bare>http://www4.tw.FreeBSD.org/</a></p></li><li><p><a href=http://www5.tw.FreeBSD.org/ class=bare>http://www5.tw.FreeBSD.org/</a> (IPv6)</p></li></ul></div><div id=uk-mirrors class=paragraph><p><strong>United Kingdom</strong></p></div><div class=ulist><ul><li><p><a href=http://www1.uk.FreeBSD.org class=bare>http://www1.uk.FreeBSD.org</a></p></li><li><p><a href=http://www3.uk.FreeBSD.org/ class=bare>http://www3.uk.FreeBSD.org/</a></p></li></ul></div><div id=usa-mirrors class=paragraph><p><strong>United States of America</strong></p></div><div class=ulist><ul><li><p><a href=http://www5.us.FreeBSD.org/ class=bare>http://www5.us.FreeBSD.org/</a> (IPv6)</p></li></ul></div><div class=sect3><h4 id=eresources-web-social>C.3.1. Fórumok, blogok és ismertségi hálózatok<a class=anchor href=#eresources-web-social></a></h4><div class=ulist><ul><li><p>A <a href=http://forums.freebsd.org/>FreeBSD fórumok</a> a FreeBSD kapcsán felmerülõ kérdések és szakmai témák megvitatásához egy webes felületet kínálnak fel.</p></li><li><p>A <a href=http://planet.freebsdish.org/>Planet FreeBSD</a> honlapján fejlesztõk által vezetett tucatnyi webes naplót és hozzájuk tartozó RSS feedeket találhatunk. Sok fejlesztõ ezen a módon készít rövid feljegyzéseket a jelenlegi munkájáról, az új javításokról és más egyéb terveirõl.</p></li><li><p>A Youtube-on keresztül elérhetõ <a href=http://www.youtube.com/bsdconferences>BSDConferences</a> csatornán a világ minden táján tartott különbözõ BSD témájú konferenciák videoanyagait találhatjuk meg. Segítségével megtekinthetjük a fontosabb fejlesztõk által a saját munkájukról tartott különbözõ elõadásokat.</p></li></ul></div></div><div class=sect3><h4 id=eresources-web-mirrors>C.3.2. Hivatalos tükrözések<a class=anchor href=#eresources-web-mirrors></a></h4></div></div><div class=sect2><h3 id=eresources-email>C.4. E-mail címek<a class=anchor href=#eresources-email></a></h3><div class=paragraph><p>A következõ felhasználói csoportok nyújtanak FreeBSD-s e-mail címeket tagjaiknak. A rendszergazdák bármilyen visszaélés esetén fenntartják a visszavonás jogát.</p></div><table class="tableblock frame-none grid-all stretch informaltable"><col style=width:25%><col style=width:25%><col style=width:25%><col style=width:25%><thead><tr><th class="tableblock halign-left valign-top">Címtartomány</th><th class="tableblock halign-left valign-top">Lehetõségek</th><th class="tableblock halign-left valign-top">Felhasználói csoport</th><th class="tableblock halign-left valign-top">Rendszergazda</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class=tableblock>ukug.uk.FreeBSD.org</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Csak továbbítás</p></td><td class="tableblock halign-left valign-top"><p class=tableblock><a href=mailto:ukfreebsd@uk.FreeBSD.org>ukfreebsd@uk.FreeBSD.org</a></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Lee Johnston <a href=mailto:lee@uk.FreeBSD.org>lee@uk.FreeBSD.org</a></p></td></tr></tbody></table></div></div></div><div class=sect1><h2 id=pgpkeys>Függelék D: PGP-kulcsok<a class=anchor href=#pgpkeys></a></h2><div class=sectionbody><div class=paragraph><p>The OpenPGP keys of the <code>FreeBSD.org</code> officers are shown here. These keys can be used to verify a signature or send encrypted email to one of the officers. A full list of FreeBSD OpenPGP keys is available in the <a href=https://docs.freebsd.org/en/articles/pgpkeys/>PGP Keys</a> article. The complete keyring can be downloaded at <a href=https://docs.FreeBSD.org/pgpkeys/pgpkeys.txt>pgpkeyring.txt</a>.</p></div><div class=sect2><h3 id=pgpkeys-officers>D.1. Tisztségviselők<a class=anchor href=#pgpkeys-officers></a></h3><div class=sect3><h4 id=_security_officer_team_security_officerfreebsd_org>D.1.1. Security Officer Team <code>&lt;<a href=mailto:security-officer@FreeBSD.org>security-officer@FreeBSD.org</a>></code><a class=anchor href=#_security_officer_team_security_officerfreebsd_org></a></h4><div class="literalblock literal-block-margin"><div class=content><pre>pub   rsa4096/D9AD2A18057474CB 2022-12-11 [C] [expires: 2026-01-24]
      Key fingerprint = 0BE3 3275 D74C 953C 79F8  1107 D9AD 2A18 0574 74CB
uid                            FreeBSD Security Officer &lt;security-officer@freebsd.org&gt;
sub   rsa4096/6E58DE901F001AEF 2022-12-11 [S] [expires: 2025-01-15]
sub   rsa4096/46DB26D62F6039B7 2022-12-11 [E] [expires: 2025-01-15]</pre></div></div><div class="literalblock literal-block-margin"><div class=content><pre>-----BEGIN PGP PUBLIC KEY BLOCK-----

mQINBGOVdeUBEADHF5VGg1iPbACB+7lomX6aDytUf0k2k2Yc/Kp6lfYv7JKU+1nr
TcNF7Gt1YkajPSeWRKNZw/X94g4w5TEOHbJ6QQWx9g+N7RjEq75actQ/r2N5zY4S
ujfFTepbvgR55mLTxlxGKFBmNrfNbpHRyh4GwFRgPlxf5Jy9SB+0m54yFS4QlSd0
pIzO0CLkjHUFy/8S93oSK2zUkgok5gLWruBXom+8VC3OtBElkWswPkE1pKZvMQCv
VyM+7BS+MCFXSdZczDZZoEzpQJGhUYFsdg0KqlLv6z1rP+HsgUYKTkRpcrumDQV0
MMuCE4ECU6nFDDTnbR8Wn3LF5oTt0GtwS0nWf+nZ1SFTDURcSPR4Lp/PKjuDAkOS
P8BaruCNx1ItHSwcnXw0gS4+h8FjtWNZpsawtzjjgApcl+m9KP6dkBcbN+i1DHm6
NG6YQVtVWyN8aOKmoC/FEm1CWh1bv+ri9XOkF2EqT/ktbjbT1hFoFGBkS9/35y1G
3KKyWtwKcyF4OXcArl6sQwGgiYnZEG3sUMaGrwQovRtMf7le3cAYsMkXyiAnEufa
deuabYLD8qp9L/eNo+9aZmhJqQg4EQb+ePH7bGPNDZ+M5oGUwReX857FoWaPhs4L
dAKQ1YwASxdKKh8wnaamjIeZSGP5TCjurH7pADAIaB3/D+ZNl2a7od+C1wARAQAB
tDdGcmVlQlNEIFNlY3VyaXR5IE9mZmljZXIgPHNlY3VyaXR5LW9mZmljZXJAZnJl
ZWJzZC5vcmc+iQJSBBMBCgA8AhsBBAsJCAcEFQoJCAUWAgMBAAIeBQIXgBYhBAvj
MnXXTJU8efgRB9mtKhgFdHTLBQJjlXeQBQkF3u+rAAoJENmtKhgFdHTLOVoQALS3
cj7rqYkHiV4zDYrgPEp9O1kAyGI8VdfGAMkDVTqr+wP4v/o7LIUrgwZl5qxesVFB
VknFr0Wp5g9h0iAjasoI5sDd6tH2SmumhBHXFVdftzDQhrugxH6fWRhHs0SaFYCk
Qt5nFbcpUfWgtQ35XTbsL8iENdYpjKXsSFQrJneGSwxIjWYTFn6ps/AI3gwR8+Bn
OffEFdYugJ049O6Vu6YBFJHrnMO7NbF4v95dVYuLtpMIaXWM+V9KITmhaBzFz5fM
Q7UOzcLlbxOYKNIWcp8QQk429mayKW5VUeUExUD1ZzBHn+P6ZG7QTMDu/RmBqiHo
ewCMVz4n9uXT5BiOngE4CvS0WQwHzK+k9MLpG2u/Bo9+LT0Ceh9Ou1rfU5+0tRwl
GyOFFjf3INS7I7gkcAwxQ7dzDItN/UQPZpg8y9mABU2x4enz0AvTnb61d/1dnTEr
tdNgU433he0ZnD1HurZCjBEWC656wv6iMdWcD8gjhMbmEpPmjvXcYlTO6zhEygSM
DiwdQCWK2W4++YJerA6ULBi3niNWBpofOFH8XylV56ruhjtHCo7+/3carcMoPOJv
lVZ1zCKxLro3TRBT15JTFBGqblRyTopFK3PuxW//GTnZOtpQEOV6yL4RAXcWeC1d
1hb5k/YxUmRF6XsDNEH4b08T8ZO8dV3dAV43Wh1oiQEzBBABCAAdFiEEuyjUCzYO
7pNq7RVv5fe8y6O93fgFAmObXVYACgkQ5fe8y6O93fiBlwf/W8y1XXJIx1ZA3n6u
f7aS70rbP9KFPr4U0dixwKE/gbtIQ9ckeNXrDDWz0v0NCz4qS+33IPiJg1WcY3vR
W90e7QgAueCo5TdZPImPbCs42vadpa5byMXS4Pw+xyT+d/yp2oLKYbj3En4bg1GM
w71DezIjvV+e01UR++u1t9yZ8LOWM5Kumz1zyQLZDZ8qIKt1bBfpa+E0cEqtNQWu
iGhQE3AHI8eWV+jBkg5y2zHRIevbWb1UPsj43lgkFtAGHk9rrM8Rmgr4AXr531iD
srBwauKZ/MElcF3MINuLH+gkPPaFHw/YIpLRLaZXZVsw3Xi1RNXI2n2ea29dvs/C
Lcf1vYkCMwQQAQgAHRYhBPwOh4rlr+eIAo1jVdOXkvSep+XCBQJjm14FAAoJENOX
kvSep+XC0DcP/1ZB7k9p1T+9QbbZZE1PJiHby3815ccH3XKexbNmmakHIn3L6Cet
F891Kqt9ssbhFRMNtyZ/k/8y8Hv5bKxVep5/HMyK+8aqfDFN0WMrqZh0/CiR6DJh
gnAmPNw/hAVHMHaYGII9kCrFfPFJ02FKoc81g9F08odb7TV+UlvRjkErhRxF+dGS
wQoO0RCbf0Z1cs7nd0Vb2z4IJh4XMxBjWc/uQ2Q9dH/0uRzwpAnR4YX+MG5YrX7Z
zBvDyR0r76iQwRSDKgioNgkr6R3rq1NZGdaj+8b0LzdOqtzKJ/eupDe3+H67e/EN
qymtreGjrubpiU9bKvYArisUqhE5KtguryvR6Qz9bj87nPg33DT3WWGVrwFRxBox
dbWzjQFv0wug8m4GAwVF7fPR5/eW7IHw8zvgn0vSPcZz7MZ4e6Y5jN4kA5/xWJYZ
Sps54qQWB+FA30unIXN68KqdIzONIbtaY3W4/JjJUCm4T+wEjKaH+wJX8w1DMjlg
mkTmGh/UrTyC1vXbPgk9Sy3cRTICR1T9z7W8UlmTtnKrUklrjlFR7SXzrEXzLGOX
Fm+NEHpHNXqzcm6c3QfzY/yQ9HSAQ/t7SUQ9caRePbDz3/msyPxtGFor9roQv6VN
wRXCyRgkH4Y5tPhJAQ8G/FxX+VXFb93QL0lfelb23/BBu6cUwW63SRn5uQINBGOV
dskBEADqo8z6TFAhrvHhJV5wHdj67guoYvpXP8gvdCqos8SLluqi0AWgJEwlqu7L
mKQ6qMoJ+2DN6y+dEtvOVgBAgF63LLf3FQKq9FB/3uqeIiQlCIl3H43f8KttEZzf
/lbry4Y6QhS2OXM31Ut9Q+1IfTGwvs1E8/J1U4jQrAGqNKknXyQyMweJ0jvvcSLJ
nv3S7COUJVOT3cTgVeh3RIQlFzqK2rSQmygDpS8bT8MjCsZr+KGezKpbddKXio4a
QW/e6nCMyYR8bo0GQ9DpsyAOsaENnkghncQhA7GdPZK9xLMNQMCp0OdcZlqRVjRZ
OutuzNW6PPoczs/NQq02YWK4BPtSV7+ldS9gPZTLIpnRNQRzcnA0vnQTqSAfasVw
sAGm+MpH7zcaMf2Tw1K08u7+5gyObgzUzQmGLCgo9VIncnDis0s4gfTmtrr5jCeV
7LYDQX+2fApMtXbVXeKJem1PS+Z6LPbW2HklxYuG5nFgewCYlQjKujfiwW1Clhi4
JQeE1Naobbaar99V/VeoHrOYAEWP0bkUyrFcocLJ+0g3KpjSkctIptgGGpMBKe4U
9O7pWoTki8Yz/uYQn/p0iZcG8SfKM8I4283jdsi5SUiNNJJZCBQTVA7d8MxUVv5+
qpX/v5XqYM3pHza2DLXzwfAE9O2dgN1OMZYIld+OnWcpm2PxIwARAQABiQRyBBgB
CgAmFiEEC+MydddMlTx5+BEH2a0qGAV0dMsFAmOVdskCGwIFCQICKQACQAkQ2a0q
GAV0dMvBdCAEGQEKAB0WIQS2FSd+gQh991yBgztuWN6QHwAa7wUCY5V2yQAKCRBu
WN6QHwAa77gbEADpUBT14cesITuMsOWYsyEtNmB4UlTFWCktk/YzyCotasZxIhMP
Xih9G1tDo9ExIWT8jNjSSA+w0Viua/PirDLvI8JtX1JiK3nwMenwlXwlkRAk9TJW
y944YegHF/5ytntwZ/L4BMYc3MztyZbw+sDwnNBZKYmO8gwfYobtfoGxOR4Onb37
bbUVw62xHQIn2zafSmMQ4oMXZTm9EteIYwgcrC1h+Urv5IXCJZHrqmXCPE5g5XZ1
G9jqkwlaRYWjcLD0qxwc5m9LNrF6OBS9N6S7DncIYt9VupI5OCr1uRSqzqaBMFDC
lTTH+dAx3b6J1KFB0UiHP3FeTalFh8L3NE+dN9apNAgkUWv/v4oo/6dkRu3NZse2
RAo/o2X5r40qk/lhydQRZTSTFsiuH3VUWVsgmqAHnHW7pMMw8FAlKhyRSFnhbW7r
e0jj8XMIO7G5yjQKQCnYuPdXbx++bP1PzsEWDv9j/sph5arcosdo6tEXklWHED17
MEPIton1+NRfsU0peEVggQXlwdTcZN/h7FeCZ56dcwCWdCpSlv6CcWzRXSNUyJpK
a9qfIqBX/monjy7w5IHmhvLwAYI6IoT11h1QDEfGfhrwWPwOjnXsaYm5E7wv8w69
PxMbOJbMpWSg8L7xW3LXKR1VwXggUC1+b3y67E5Ggi1hf0lfTnTMpL2ClO2QD/oC
hMIafhzxbjh2WzgYahVHZH3gpHc1/0Bnc07s9+Pa6EYYM9r0XzezLW7bswOjVloR
FreQ3FIF/2OSN0OGdm7dyYl0OliTIDDDlwK/l8bcckUcpHNR1dw0P3KvDlmLmzZy
G4HmzzSBa9jiFirEfcg2rnGc6Zi382jGVALuYVplPXyMOUiChp0AAQZzTIYpXw/g
pBE6em2k740yuK6WqG4yXXgk67FoH10TQvMd4Q73K4zw+9DMpThlUHcfBmAoViZw
il7C0xl+ysHX8ZI3JU8s1r3XAnpqdHi4Wpixm/ctXbVnTSA3FQr2SctJYqR1VHRW
GMW+Ii2SQDS+t9bZTzOgAPLDtfy+JqhBpwCB1a1EHftkJEojpfZipaYGkf3yc+vN
wUeUHp/csF9CT7Qbqaj1t7fVWzv7jcVKpRwngIT4vTSzqbo6WC34FuUAH0t7tJ5K
eZ625AqEFLmtqtDo+ydJhZrVrXBNXPfkx5hSVW/I9hvckMNwA3t0KfQC2sz+Z1Q1
a4vDWQYRytfyrgZkWGbXMn6l1JyqIolgJZuax2kYs7Vu3t8KptqCbv0ZBAGoMm7r
RLgVodhI9voA8YxCirSChrueJYn+JKk8MIyk3DdXpBoocMIAjFJAUgXjV5NQpZMy
xR8BEiQnBcHRIKVWEEyhbLtHpmCEsnKNyKVGoxs31IkEcgQYAQoAJgIbAhYhBAvj
MnXXTJU8efgRB9mtKhgFdHTLBQJlhctvBQkD8n2mAkDBdCAEGQEKAB0WIQS2FSd+
gQh991yBgztuWN6QHwAa7wUCY5V2yQAKCRBuWN6QHwAa77gbEADpUBT14cesITuM
sOWYsyEtNmB4UlTFWCktk/YzyCotasZxIhMPXih9G1tDo9ExIWT8jNjSSA+w0Viu
a/PirDLvI8JtX1JiK3nwMenwlXwlkRAk9TJWy944YegHF/5ytntwZ/L4BMYc3Mzt
yZbw+sDwnNBZKYmO8gwfYobtfoGxOR4Onb37bbUVw62xHQIn2zafSmMQ4oMXZTm9
EteIYwgcrC1h+Urv5IXCJZHrqmXCPE5g5XZ1G9jqkwlaRYWjcLD0qxwc5m9LNrF6
OBS9N6S7DncIYt9VupI5OCr1uRSqzqaBMFDClTTH+dAx3b6J1KFB0UiHP3FeTalF
h8L3NE+dN9apNAgkUWv/v4oo/6dkRu3NZse2RAo/o2X5r40qk/lhydQRZTSTFsiu
H3VUWVsgmqAHnHW7pMMw8FAlKhyRSFnhbW7re0jj8XMIO7G5yjQKQCnYuPdXbx++
bP1PzsEWDv9j/sph5arcosdo6tEXklWHED17MEPIton1+NRfsU0peEVggQXlwdTc
ZN/h7FeCZ56dcwCWdCpSlv6CcWzRXSNUyJpKa9qfIqBX/monjy7w5IHmhvLwAYI6
IoT11h1QDEfGfhrwWPwOjnXsaYm5E7wv8w69PxMbOJbMpWSg8L7xW3LXKR1VwXgg
UC1+b3y67E5Ggi1hf0lfTnTMpL2ClAkQ2a0qGAV0dMsjqhAAorQ725G342raJ+os
6+E/EFNsr4SR5H+AeinlQ2ymNSeO/ODsV6dmyYD3hed0mAXvIJt2B46fFC4eAP9f
VOIbMMhPMpnJuZyLPDi8gXcZLgWSRhJ88R98KIsmKlh+/fdZM4RI1JLjICi7kyNR
4jtKCzLj0DYVBzp1mn0lTwtFzv7SC9djpqFLnO5YoGPWfQHHhY02Trh2posRwAHO
oacXSFvsoQv6k6XNlStJ4lnrkH6t+Od4kU3/TJ0eQXs7Zd2WEVnMe1IhbihsGcAY
mzZzZlLOhskHCeVE2taHiXC6h4tC3/69I16N8ICauxGY41clPhiNmVaAzmkunOPz
ry5utl6HkpZ5/3UMVHI1JIvsfJW+vSMUhdcQILAv6DbRWWHeax3ZZ6iAVGCtJS7U
glwZM1Xor0okGtIS+aJ/Cw7tZ8Nm18lutcrf2MVW+BWpzMQKnWFQYTn1NEWjzYnx
9Na22+E8AvW02TdS0NSiP0sG/0q7lBNEck9vH4WEbbEXktj51Dg4ISUhQyW8BWwW
X+kSiNeqtcaikUb8SFj5vpTDotTSzikfT/jisvR5goTMNFCVHFZdXCdsbUZd8Iub
egAOh6Db/06y3mFYDEfcGJipab400OY03a2xw9Vz+YxrKfELCTBo2tZv+3K8kXgq
XFcbyJnkXmjnYM/sw5kKqtzuc7i5Ag0EY5V3BwEQAMpFVczZo9ZPNsgW791UW5o6
wnrnd1nIO+S4rc37q2TEz8KGHCuxo5NwffZ2t6Ln04BI54pbapg17b7a0hPka37H
FkL28n4VyMdx0CsAm3QEfUsdK6xwKV2SucYeVcrV1upcN4PdXD7su1I7/A4CWXFJ
G047zJ0Z89lJZiQEiAq7ghvEoinC0sm+0a6ao/ocqCgWCKM1yCPOyzJXleRrv29S
RnYziMR+q2U0x9xg9Xl6GMwUmFwbJc9nORVvLH7fbU6/du8EgoAYrglFOFZG/TSo
lSGWRSMiavz0JSD/i+rEN4aIT4WfBe+L9Wy1AmrNxiAO+zKmzHQu3JSxDncr+y+h
cd+W0gqw10FoI9jWLcL7kR+6a0iOjuJSXSopq2l3DafiPxtCFmr4CGQhzBHM6e4/
v/NNd3F0XpVbJ6RQph7lkfvfz8q2lvUlHhezJ0p1xXmhff9CHjdVMhmAmz5+imBA
Xk2mottNfKb0pFEen1xY3K/UPA4g+oPsSj495MsvIg9eIMCcC3/z0SEUMWH/styy
JzPqfpyfGwZeTcIj9vg2o+RnGvmcLVYA/EGToPk905kv/cK73oy8bZyOB0zMg7T9
PaWgLUO0sqjqo0Mw3knFySg3oRXlcilPQvfPdX0JvwLpc9DWlr1+1GkCXJ08lWug
Jc96CJQupKRb1IbC0oUXABEBAAGJAjwEGAEKACYWIQQL4zJ110yVPHn4EQfZrSoY
BXR0ywUCY5V3BwIbDAUJAgIpAAAKCRDZrSoYBXR0ywwtD/wIDmEcHdFlyFRTomUB
jbeK2uzcZIhkkgL58lc63UPle5iJ2FBvmYS+0rQS53sVEsccn5KfkOwTryKllvWb
l0IzuiqfawxALcfWpfZJHzTMSnDHfgXvOOyFMQruqRDAHAr7PNC0CnbT0sEF2ZFz
ad8M9fLqtkXUx4mgECNGJ4CVqg75KY8uUzv/BmRwEf587FT5/iAIed5MjFB2VFDX
9GABcvTTbHxCZIxnxl3cs15SxT0lAofZ2ueU6kWYWZSXFeaEM/4ymPJws2mmV0Ak
bJghLXCn9Mx3nX6NTZZ9Harbru+RzW3/Hg3DZd0J9vko8PafP0l1NWtgyX74CqvT
gjzTxXTnqrRXzcczK7fhcC2u4i0prPtXXcyyi7SwpoLikaZCLFFhUmOx+mS5Tjtg
FyFZBNxnO7iAwkzfcTcC9sPoWaFmiQf6q5EIYzG+WQpncj80mxl3HWOP6oFj/hZJ
RYseKeMkvJzLTo87rFdM6CsMrLwETR6e+aWM0btPFil1rXVACNOjsy0bxTV8OJEf
yxnYmyjvnBvB0kdiaVEDdVhxgSqzLAX4mgXa49/V6M/uzMr+n3/A1Jdk4V6fVm8S
5cFIXxoUat3cB4xGaT9OWD3o1NPr6eS9Vo0EsJlRl81SG68fS+Qtk2fX27T68YG4
Aa3zMfZxUsVuFLtTuQbRC+fJpIkCPAQYAQoAJgIbDBYhBAvjMnXXTJU8efgRB9mt
KhgFdHTLBQJlhcuqBQkD8n1oAAoJENmtKhgFdHTLoO0QAJsTE9fkleb7YzPEuP9G
J3jx8PGdWm7n+8UNdr24kS6gOXVUfPZrWa5So21hcIwZb4PZDqHSVSQnRciKhSnG
7gplYPNGZ4+FWbLr/mBRYarjkVFLUuCPexSIjxV1KSGJnWs9YTVAKZAz75GpCML6
jD6biCOQCQ86wqOdWvZIZR8YvurrxR64ABB0rjbsaG8cNOUX1cwAfdLwthf64dS+
2m3lqNGDHkP5eNL0RIxC5gXYEp0lvmlMH3ZuO5WrfH73PTDg89bxXeuhrFmSEwf4
xWm603oi8/2qQvR9/7jb0o+t71NQuWrWIFONZWWgZBUGso+uyT3XgY4YqKGR3z2Q
zKHYnJ6M7SvSYpqS7RtcxcCXF0HGNfES8cAgtKVpFtbtSwXXp8O8oLyjmVIO/NjU
pbLOGdFIsarsezLFV9f2fqZ63J34hyUSg8LrYVV1fA5DJUpebbX4hLpdk0MMtgG4
3BwKIGlJTpL5RkQ/uQU3YW2kairy7o+1imDD0TRzQxtdjVOI5vnlTNcfJZIIfLx4
drABA12OvpX3dfPV62R+8BAlJFT430CG6AISJIBqJRFvuikmnZGUvEHmOUs/FLbb
aXTPkKc7tR2WIwljRvMV+Qk84cWcX6YchMslMuiDM1mtlQZig34WHGSE+zCWnXAs
lIHlSwox7qfdO0Kz2XncSbIA
=QvUh
-----END PGP PUBLIC KEY BLOCK-----</pre></div></div></div><div class=sect3><h4 id=_core_team_titkár_core_secretaryfreebsd_org>D.1.2. Core Team Titkár <code>&lt;<a href=mailto:core-secretary@FreeBSD.org>core-secretary@FreeBSD.org</a>></code><a class=anchor href=#_core_team_titkár_core_secretaryfreebsd_org></a></h4><div class="literalblock literal-block-margin"><div class=content><pre>pub   rsa4096/4D632518C3546B05 2024-02-17 [SC] [expires: 2025-02-16]
      Key fingerprint = 1A23 6A92 528D 00DD 7965  76FE 4D63 2518 C354 6B05
uid                            FreeBSD Core Team Secretary &lt;core-secretary@FreeBSD.org&gt;
sub   rsa4096/CABFDE12CA516ED2 2024-02-17 [E] [expires: 2025-02-16]</pre></div></div><div class="literalblock literal-block-margin"><div class=content><pre>-----BEGIN PGP PUBLIC KEY BLOCK-----

mQINBGXQ1o8BEAC+Rcg8cmVxuP17Vu+q5KgCx/XiulQuqKXAqqBlYCH2jqk6DINP
yFrREGBhzd/qNmlAYEahQ4Zgl0bUZNTrZVDyzicOvPP0jH+KSTQwRs7NOawEdlVO
cyHrwDCPEqf5ZzD4NhfTriEOw+j0pEH/onitUGvoQRtx15xWyaJQxDEBMTYMLewE
86D1bltwnTNczE3UZb7oQLJXkAX5hcLtou70XJGgZITvJkK+kp/xot2eFjnqRz/u
WeXnKhYAmC07EKwZ1uw047eHKwMMRBYqzApLwoQtfE430Kxf2q8de64x8zDbi6YM
1J4r8OAxOtHVyfJ0j7Q23DEZz0VVb4b1Tx5OG2Re/KSNvqI0awJO4TcRmOR88OyY
dzyXgnX6Sa7GVQY1FXvn7vtFuDAt7egZOzeomSHL9bdX07LTQ4UtM88EV9wm3q4q
smoatV9jsvPQ1zxCU3aQD/5eWTJH2/kz1LIuBL/Qi5XQpJn91lBtUWJrCgkHWPGu
f//rnnXmsG7DAChW+yZ7cFO8lfNa8sFhPqSxCYphWmJTrvadyQtDngB8JakWdnmK
pfGS6y5lel+181vw38ZZKt04AKM+nDY8051lBM7Q9Q6kTLI33UZeImndx5xYukVD
kV6aQ31HYfEark15c7iEz+OAcwFnM2ntXMt7kKGd40CqzusiPcQkPqPbAQARAQAB
tDhGcmVlQlNEIENvcmUgVGVhbSBTZWNyZXRhcnkgPGNvcmUtc2VjcmV0YXJ5QEZy
ZWVCU0Qub3JnPokCVwQTAQoAQRYhBBojapJSjQDdeWV2/k1jJRjDVGsFBQJl0NaP
AhsDBQkB4TOACAsJDQgMBwsDBRUKCQgLBRYDAgEAAh4FAheAAAoJEE1jJRjDVGsF
nacP/3PSg8JPmWoBfWrgT287NZ7OAU16/uGpDxlBUoVeEtkEDqZVW8yBFzrMhbwj
bJs3CZ+L85HMUDLZoxSwVnPM8PLVRzHTybYV7agYYzMox5C/jp2aeAgy9KYVd0Tk
07GMTYrSh4fhHWpxXz7IBOxk0RXvQxTHlg1u0DASkibYb2UTDcUNG5Q9kP/8jaIZ
kVDX8a5LDdOCgWaYdKPg4blv/UMjkegJz+Ayp7gXTcux6koW5F6ysSw9sgLBWb2D
b/KNIi4MBMe46xyXB/dqGAR4ibrUXTcQ4OAZNq1L6uWG1A49XuSgykdIwr00MzQw
wfVpKT31ww4ayVHLgj7NuqPlab9S5/fPfJ4MAvGE4GqWQFgsPKgKImUMgnnxTGpv
l7Dqk2MnWqn+wEi0bRES0PVBG96G+sZJQeaxBhoB+HwUSFqoZQg166AJIl//4t2w
bx0a1aWQSS0DZt3wsQW3NW9AE6L+FnFfIc2pQVoLjmvcGalDuvnemRmEOgotiZmt
32bi2aWxg0/Qio2rjLS2LpV+fhwDSN3Agvtnu53yUdD1TFFjTSMloM4SKhiXoPbI
XgfCLiBLNMsZL0AvO7wQfSePzPYxDLyEcwsfPJ8be+eGG1L62RUyad+MdfyXMH/S
m0sgqW/MW6Nv10RyPQOq3Jbgmp2laRMzKTOvQt5WwQf2FEl9uQINBGXQ1o8BEAC9
1cBYn6Z0QmM0OFWdXQI6fMOeNokaa6ngPgt7bzW5NjryqTdwyHOPZdm4DWf1SO/0
+fJRCqxbICyuMAFrb9fDle8bodALjm5ZquTL3D61HpZD4+RwOzOjYP6wLm7h38HT
/yIyK882Ovlw4Xz/TeSiL/VUSWE9twW7yz3oreCeLUBAfzacS9y+syO+aquEd0/x
JBz+mPQbrqfS64rCZXMZEivgsjkQoE6RM+n1rF4kw4Eu3E2kPevVwsoAaY+MEUM8
JAXaJMaNcLIhbeMy7dO/z6z2I3h5bUw5KxfVwzYSzSeRpYh53dNaB4NY+f5/vTrL
4dZmqBcLgcV0zZ02dj/u0SiwWlUFUpFGuSiW16DN7+2zG1zOWi7Nl44JawM62Tlf
mO8zruVGEHaV3e8fFwBLRKM0Sc7e3aLECISsfYeC5ZbRRbpQ1KX+VQr3FBKAMzG4
l9Go7vZ+UcLKpQx2rVPTJt1vDnRV49X6CF2Q/lV9iafQ4MTy6ACdAloT1yfH/lhU
iWQo1qDyRCSlmNBDsYl8gLrwMp4gGQAv3imZHxnJF5ru3nUYGG0U08D5mf2sWv5P
Wh7By8Jm8bmaP8cUF86lO9BJXh2d9QN5jqrAtXqYzenZ+ABSoL1XrD/yv3270rH7
H4gAUtgP+vJ3uMyRu9055OC+ie/b613NojCW5nYN2QARAQABiQI8BBgBCgAmFiEE
GiNqklKNAN15ZXb+TWMlGMNUawUFAmXQ1o8CGwwFCQHhM4AACgkQTWMlGMNUawXh
7w/+KjbEWTwAhjm2HJ3w4tXtPC5URg+A+BzYYVH/q0+956c1QeD0LYafHBw4LEMI
lhRvHQnmzwjtY8v/DgmLOVDMiMWVHo0Q2iQyMvOT1WyEPcgOTJLhvyVzDqRZx7AS
B4G8uNVkKAdBZ7OSXAP27lR/2SEoG05esw8b7Y39pVtucC3aeiua+19PLJWadBjj
XuvXuSCho0km+nk4IgadYmxIDyiMeyKZ8wCl7CJkzECm83q2OtNsMe3k8lgEXybt
KlQxnYApZmhqLMV5ob8WOk3AgAVsif1m332CiEIb1Sfx6wt3nXy/410CXdDDucuj
ndJVfJ6Un33tn0irZ5scPA2HmzK1PGMfgOGtkM8B3LE/x8kEKeWKb3l9boB32Unm
iTfKgEna+JISEab3bzOPWdCQFB8LyGXuWlhtvqmRoX8GtiMRy/F4mzh+l3lYHjj3
4EvPVyippO5zwU+S9HElJ2G37K6zrOmd5cGBrw4aBDoO70QVrMN4O86uvC9kChDb
qyFF5UgXg29QxJjiSCv98ksDMqpJ5AFYrmrsBtwU64OANrxxJ4AZLQ1apYmG9RWD
VHZgfeI60FNBLfKwix9UffFT7piQ/MLrjSde8gPH5S6ezBMrYpfGEopaI9A5qXe3
LnHz88gfdmaBM77YDZM/p23nmCrUxlE3kkbgjTY8NRjYyF8=
=MkAH
-----END PGP PUBLIC KEY BLOCK-----</pre></div></div></div><div class=sect3><h4 id=_ports_management_team_titkár_portmgr_secretaryfreebsd_org>D.1.3. Ports Management Team Titkár <code>&lt;<a href=mailto:portmgr-secretary@FreeBSD.org>portmgr-secretary@FreeBSD.org</a>></code><a class=anchor href=#_ports_management_team_titkár_portmgr_secretaryfreebsd_org></a></h4><div class="literalblock literal-block-margin"><div class=content><pre>pub   ed25519/E3C401F60D709D59 2023-03-06 [SC] [expires: 2027-03-05]
      Key fingerprint = BED4 A1D3 6555 B681 2E9F  ABDA E3C4 01F6 0D70 9D59
uid                            FreeBSD Ports Management Team Secretary &lt;portmgr-secretary@FreeBSD.org&gt;
sub   cv25519/2C92B55E27A641C3 2023-03-06 [E] [expires: 2027-03-05]</pre></div></div><div class="literalblock literal-block-margin"><div class=content><pre>-----BEGIN PGP PUBLIC KEY BLOCK-----

mDMEZAXJvxYJKwYBBAHaRw8BAQdASFAC20WL3R1T6uNyGMZbfJCxDkcP4C5vi3Op
tcZ2fbq0R0ZyZWVCU0QgUG9ydHMgTWFuYWdlbWVudCBUZWFtIFNlY3JldGFyeSA8
cG9ydG1nci1zZWNyZXRhcnlARnJlZUJTRC5vcmc+iJYEExYKAD4WIQS+1KHTZVW2
gS6fq9rjxAH2DXCdWQUCZAXJvwIbAwUJB4TOAAULCQgHAwUVCgkICwUWAwIBAAIe
BQIXgAAKCRDjxAH2DXCdWYN1AP43TjyfZtZ3DLYT++g0+SuPsoO/3yWVybA+UmFL
zb8MngEA+LLNUfvEwCuXS/soh+ww5bpfmi3UUmeGiQEAXug3iA+JATMEEAEKAB0W
IQT7N0XIbxXo7ayBMvzYKU7Du8TX1QUCZAXLkwAKCRDYKU7Du8TX1XHMB/9R1MX4
6zMgpKqPPt76GOI+eGEdBK6bY8aJZjQGdqTh9f6VtXVoTGIG7cvhc9X8tDBoB0PT
2KZWheF51AV1+NHU4HwLAQ1BMebrFvWSfkw4xg4fBGwDhz9/GN85No+Js772V5ey
8lRiL6meRVWxMlLyWcxGd8JjcC5yX/iAUQ3SBGCLqW7unWjjg7CTd+AMBwcqPGrv
ax8q6eFVguJcHJAjMnKf6HAy4cpK3s+uMoUBCGnszSN12B3ysKfyC4pNO/pix5tA
Q5v8aRqTeFPh5zmNhWo0KGPzplTPqRQSHDl7GDQC8Ru3MhzFkeWzHsexjZVwS6W2
DPcYpuuAsA0XOZIZiQIzBBABCgAdFiEEEBpxaxYrAOVb7eoFrbv4YQo3ibcFAmQF
0u0ACgkQrbv4YQo3ibccwg/9F2Xuic3nhKxRbB3mJeDo6SYQETa/Gh1qQ34+8zlt
8UMazOx67gnYQfy+pXjro6eQ2up0a4eUYezcNOudqAQD21nRz3HA6EQVNcE/TzEA
xl5CJntTaLOt7S+EDXFW5BuQIvhhoMGgm8+WNVgA0EJ7tfL0OcYBSvr19fqwChEn
9c14cSk6mgHSsleP5NvskYN053pxHwy0LTSb8YBBv52th37t/CRFC1363rS5q+D7
JixFopd1O5pKpA5ipvE4gGgRjPtwjx0SjjepwK/3fuhEJQQyKzTIKlMfu2Dj/iR2
Li1Sfccau5LQXOj9fUITU3u1YG7yrm8VGzT7ao4d+KRwgMLjd2pLqiGIbbJwGBiP
FRmtilWQoeIlmSlFX4obAA517DOK0pW1mH8+eEn4EJd3SekT3yzFyKTASv0J48Z8
3F928xg+eZvHxVC0t1J+J5IG0gt3EEncuWKIPQGR7PiQbti6R3FQVTz6WfMWOebP
Qi0E9F/Aqakr6Vj2sKGrDq+ebpaF5G8Yw1YrUl2IDiPzkCegp3ZbI0wh11Xvzhi8
LXPQGK4jBQas4G8cegfitzmtdGRHYrbMv0R9I4mvaL+WlOuD2AvyVG28lguqVhnN
AZP+ohdquYyX2CNCVvbKWAtXo6Ur0vWG8BL8m6defAtEkIwVBALaOHQOSI3aNUz4
lwy4OARkBcm/EgorBgEEAZdVAQUBAQdAsefmSfxEOdOr02+K/6noYCuJ1FeAWVz6
jFYQ+9w6jggDAQgHiH4EGBYKACYWIQS+1KHTZVW2gS6fq9rjxAH2DXCdWQUCZAXJ
vwIbDAUJB4TOAAAKCRDjxAH2DXCdWRl4AP9h5ot212BK29S6ZcMBhHvmtF5PG1oD
c7LnZycSRmbFiwEAndCMpAGOhDW8iVgDd0wLQq/ZMPe+xccfG1b3zFH2EgE=
=iiAT
-----END PGP PUBLIC KEY BLOCK-----</pre></div></div></div><div class=sect3><h4 id=_doceng_secretaryfreebsd_org>D.1.4. <code>&lt;<a href=mailto:doceng-secretary@FreeBSD.org>doceng-secretary@FreeBSD.org</a>></code><a class=anchor href=#_doceng_secretaryfreebsd_org></a></h4><div class="literalblock literal-block-margin"><div class=content><pre>pub   rsa2048/E1C03580AEB45E58 2019-10-31 [SC] [expires: 2022-10-30]
      Key fingerprint = F24D 7B32 B864 625E 5541  A0E4 E1C0 3580 AEB4 5E58
uid                            FreeBSD Doceng Team Secretary &lt;doceng-secretary@freebsd.org&gt;
sub   rsa2048/9EA8D713509472FC 2019-10-31 [E] [expires: 2022-10-30]</pre></div></div><div class="literalblock literal-block-margin"><div class=content><pre>-----BEGIN PGP PUBLIC KEY BLOCK-----

mQENBF27FFcBCADeoSsIgyQUY8vREwkTikwFFlNg31MVy5s/Nq1cNK1PRfRMnprS
yfB62KqbYuz16bmQKaA9zHN4FGfiTvR6tl66LVHm1s/5HPiLv8sP14GsruLro9zN
v72dO7a9i68bMw+jarPOnu9dGiDFEI0dACOkdCGEYKEUapQeNpmWRrQ46BeXyFwF
JcNx76bJJUkwk6fWC0W63D762e6lCEX6ndoaPjjLBnFvtx13heNGUc8RukBwe2mA
U5pSGHj47J05bdWiRSwZaXa8PcW+20zTWaP755w7zWe4h60GANY7OsT9nuOqsioJ
QonxTrJuZweKRV8fNQ1EfDws3HZr7/7iXvO3ABEBAAG0PEZyZWVCU0QgRG9jZW5n
IFRlYW0gU2VjcmV0YXJ5IDxkb2Nlbmctc2VjcmV0YXJ5QGZyZWVic2Qub3JnPokB
VAQTAQoAPhYhBPJNezK4ZGJeVUGg5OHANYCutF5YBQJduxRXAhsDBQkFo5qABQsJ
CAcDBRUKCQgLBRYDAgEAAh4BAheAAAoJEOHANYCutF5YB2IIALw+EPYmOz9qlqIn
oTFmk/5MrcdzC5iLEfxubbF6TopDWsWPiOh5mAuvfEmROSGf6ctvdYe9UtQV3VNY
KeeyskeFrIBOFo2KG/dFqKPAWef6IfhbW3HWDWo5uOBg01jHzQ/pB1n6SMKiXfsM
idL9wN+UQKxF3Y7S/bVrZTV0isRUolO9+8kQeSYT/NMojVM0H2fWrTP/TaNEW4fY
JBDAl5hsktzdl8sdbNqdC0GiX3xb4GvgVzGGQELagsxjfuXk6PfOyn6Wx2d+yRcI
FrKojmhihBp5VGFQkntBIXQkaW0xhW+WBGxwXdaAl0drQlZ3W+edgdOl705x73kf
Uw3Fh2a5AQ0EXbsUVwEIANEPAsltM4vFj2pi5xEuHEcZIrIX/ZJhoaBtZkqvkB+H
4pu3/eQHK5hg0Dw12ugffPMz8mi57iGNI9TXd8ZYMJxAdvEZSDHCKZTX9G+FcxWa
/AzKNiG25uSISzz7rMB/lV1gofCdGtpHFRFTiNxFcoacugTdlYDiscgJZMJSg/hC
GXBdEKXR5WRAgAGandcL8llCToOt1lZEOkd5vJM861w6evgDhAZ2HGhRuG8/NDxG
r4UtlnYGUCFof/Q4oPNbDJzmZXF+8OQyTNcEpVD3leEOWG1Uv5XWS2XKVHcHZZ++
ISo/B5Q6Oi3SJFCVV9f+g09YF+PgfP/mVMBgif2fT20AEQEAAYkBPAQYAQoAJhYh
BPJNezK4ZGJeVUGg5OHANYCutF5YBQJduxRXAhsMBQkFo5qAAAoJEOHANYCutF5Y
kecIAMTh2VHQqjXHTszQMsy3NjiTVVITI3z+pzY0u2EYmLytXQ2pZMzLHMcklmub
5po0X4EvL6bZiJcLMI2mSrOs0Gp8P3hyMI40IkqoLMp7VA2LFlPgIJ7K5W4oVwf8
khY6lw7qg2l69APm/MM3xAyiL4p6MU8tpvWg5AncZ6lxyy27rxVflzEtCrKQuG/a
oVaOlMjH3uxvOK6IIxlhvWD0nKs/e2h2HIAZ+ILE6ytS5ZEg2GXuigoQZdEnv71L
xyvE9JANwGZLkDxnS5pgN2ikfkQYlFpJEkrNTQleCOHIIIp8vgJngEaP51xOIbQM
CiG/y3cmKQ/ZfH7BBvlZVtZKQsI=
=MQKT
-----END PGP PUBLIC KEY BLOCK-----</pre></div></div></div></div></div></div></div><hr><div class=last-modified><p><strong>Last modified on</strong>: 2021. december 11. by <a href="https://cgit.freebsd.org/doc/commit/?id=2b027dd017" target=_blank>Sergio Carlavilla Delgado</a></p></div><div class=buttons><div class=home><i class="fa fa-home" aria-hidden=true title=Home></i><div class=container><a href=../ class=direction>Home</a></div></div></div><label class="hidden book-menu-overlay" for=menu-control></label></div><aside class=toc><div class=toc-content><h3>Table of Contents</h3><nav id=TableOfContents><ul><li><a href=#book-preface>Előszó</a><ul><li><a href=#preface-audience>Kiknek szánjuk ezt a könyvet</a></li><li><a href=#preface-changes-from3>Változtatások a harmadik kiadás óta</a></li><li><a href=#preface-changes-from2>Változtatások a második kiadás (2004) óta</a></li><li><a href=#preface-changes>Változtatások az elsõ kiadás (2001) óta</a></li><li><a href=#preface-overview>A könyv felépítése</a></li><li><a href=#preface-conv>A könyvben alkalmazott konvenciók</a></li><li><a href=#preface-acknowledgements>Köszönetnyilvánítás</a></li></ul></li><li><a href=#getting-started>Part I: Bevezetés</a><ul><li><a href=#introduction>Chapter 1. Bemutatkozás</a></li><li><a href=#install>Chapter 2. A FreeBSD telepítése</a></li><li><a href=#basics>Chapter 3. A UNIX alapjai</a></li><li><a href=#ports>Chapter 4. Alkalmazások telepítése: csomagok és portok</a></li><li><a href=#x11>Chapter 5. Az X Window System</a></li></ul></li><li><a href=#common-tasks>Part II: Gyakori feladatok</a><ul><li><a href=#desktop>Chapter 6. II. Rész Gyakori feladatok</a></li><li><a href=#multimedia>Chapter 7. Multimédia</a></li><li><a href=#kernelconfig>Chapter 8. A FreeBSD rendszermag testreszabása</a></li><li><a href=#printing>Chapter 9. Nyomtatás</a></li><li><a href=#linuxemu>Chapter 10. Bináris Linux kompatibilitás</a></li></ul></li><li><a href=#system-administration>Part III: Rendszeradminisztráció</a><ul><li><a href=#config-tuning>Chapter 11. Beállítás és finomhangolás</a></li><li><a href=#boot>Chapter 12. A FreeBSD rendszerindítási folyamata</a></li><li><a href=#users>Chapter 13. Felhasználók és hozzáférések alapvető kezelése</a></li><li><a href=#security>Chapter 14. Biztonság</a></li><li><a href=#jails>Chapter 15. A jail alrendszer</a></li><li><a href=#mac>Chapter 16. Kötelező hozzáférés-vezérlés (MAC)</a></li><li><a href=#audit>Chapter 17. Biztonsági események vizsgálata</a></li><li><a href=#disks>Chapter 18. Háttértárak</a></li><li><a href=#geom>Chapter 19. GEOM: A moduláris lemezszervező rendszer</a></li><li><a href=#filesystems>Chapter 20. Támogatott állományrendszerek</a></li><li><a href=#vinum-vinum>Chapter 21. A Vinum kötetkezelő</a></li><li><a href=#virtualization>Chapter 22. Virtualizáció</a></li><li><a href=#l10n>Chapter 23. Honosítás - Az I18N/L10N használata és beállítása</a></li><li><a href=#updating-upgrading>Chapter 24. A FreeBSD frissítése és frissen tartása</a></li><li><a href=#dtrace>Chapter 25. DTrace</a></li></ul></li><li><a href=#network-communication>Part IV: Hálózati kommunikáció</a><ul><li><a href=#serialcomms>Chapter 26. Soros vonali kommunikáció</a></li><li><a href=#ppp-and-slip>Chapter 27. A PPP és a SLIP</a></li><li><a href=#mail>Chapter 28. Elektronikus levelezés</a></li><li><a href=#network-servers>Chapter 29. Hálózati szerverek</a></li><li><a href=#firewalls>Chapter 30. Tűzfalak</a></li><li><a href=#advanced-networking>Chapter 31. Egyéb haladó hálózati témák</a></li></ul></li><li><a href=#appendices>Part V: Függelék</a><ul><li><a href=#mirrors>Függelék A: A FreeBSD beszerzése</a></li><li><a href=#bibliography>Függelék B: Irodalomjegyzék</a></li><li><a href=#eresources>Függelék C: Források az interneten</a></li><li><a href=#pgpkeys>Függelék D: PGP-kulcsok</a></li></ul></li></ul></nav><hr><div class=resources><h3>Resources</h3><ul class=contents><li><i class="fa fa-file-pdf-o" aria-hidden=true title="Download PDF"></i><a href=https://download.freebsd.org/doc/hu/books/handbook/handbook_hu.pdf>Download PDF</a></li><li><i class="fa fa-pencil-square-o" aria-hidden=true title="Edit this page"></i><a href=https://github.com/freebsd/freebsd-doc/blob/main/documentation/content/hu/book target=_blank>Edit this page</a></li></ul></div></div></aside><a class=to-top href=#top><i class="fa fa-arrow-circle-up" aria-hidden=true></i></a></main><footer><div class=footer-container><section class=logo-column><img src=https://docs.freebsd.org/images/FreeBSD-colors.svg width=160 height=50 alt="FreeBSD logo"><div class=options-container><div class=language-container><a id=languages href=https://docs.freebsd.org/hu/languages><img src=https://docs.freebsd.org/images/language.png class=language-image alt="Choose language">
<span>Hungarian</span></a></div><div class=theme-container><select id=theme-chooser><option value=theme-system>System</option><option value=theme-light>Light</option><option value=theme-dark>Dark</option><option value=theme-high-contrast>High contrast</option></select></div></div></section><section class=about-column><h3 class=column-title>About</h3><ul class=column-elements-container><li><a href=https://www.freebsd.org/about/ target=_blank class=column-element>FreeBSD</a></li><li><a href=https://freebsdfoundation.org/ target=_blank class=column-element>FreeBSD Foundation</a></li><li><a href=https://www.freebsd.org/where/ target=_blank class=column-element>Get FreeBSD</a></li><li><a href=https://www.freebsd.org/internal/code-of-conduct target=_blank class=column-element>Code of Conduct</a></li><li><a href=https://www.freebsd.org/security/ target=_blank class=column-element>Security Advisories</a></li></ul></section><section class=documentation-column><h3 class=column-title>Documentation</h3><ul class=column-elements-container><li><a href=/hu class=column-element>Documentation portal</a></li><li><a href=https://man.FreeBSD.org target=_blank class=column-element>Manual pages</a></li><li><a href=https://papers.FreeBSD.org target=_blank class=column-element>Presentations and papers</a></li><li><a href=https://docs-archive.freebsd.org/doc/ target=_blank class=column-element>Previous versions</a></li><li><a href=https://docs-archive.freebsd.org/44doc/ target=_blank class=column-element>4.4BSD Documents</a></li><li><a href=https://wiki.freebsd.org/ target=_blank class=column-element>Wiki</a></li></ul></section><section class=community-column><h3 class=column-title>Community</h3><ul class=column-elements-container><li><a href=https://docs.freebsd.org/hu/articles/contributing class=column-element>Get involved</a></li><li><a href=https://forums.freebsd.org/ target=_blank class=column-element>Community forum</a></li><li><a href=https://lists.freebsd.org/ target=_blank class=column-element>Mailing lists</a></li><li><a href=https://wiki.freebsd.org/IRC/Channels target=_blank class=column-element>IRC Channels</a></li><li><a href=https://bugs.freebsd.org/bugzilla/ target=_blank class=column-element>Bug Tracker</a></li></ul></section><section class=legal-column><h3 class=column-title>Legal</h3><ul class=column-elements-container><li><a href=https://freebsdfoundation.org/donate/ target=_blank class=column-element>Donations</a></li><li><a href=https://www.freebsd.org/copyright/freebsd-license/ target=_blank class=column-element>Licensing</a></li><li><a href=https://www.freebsd.org/privacy/ target=_blank class=column-element>Privacy Policy</a></li><li><a href=https://www.freebsd.org/copyright/ target=_blank class=column-element>Legal notices</a></li></ul></section><section class=copyright-column><p>&copy; 1994-2024 The FreeBSD Project. All rights reserved</p><span>Made with <span class=heart>♥</span> by the FreeBSD Community</span></section></div></footer></body></html>