<!doctype html><html class=theme-light lang=zh-tw><head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content><meta name=keywords content><meta name=copyright content="1995-2024 The FreeBSD Foundation"><link rel=canonical href=http://172.16.201.134:1313/zh-tw/books/developers-handbook/l10n/><title>章 4. Localization and Internationalization - L10N and I18N | FreeBSD Documentation Portal</title>
<meta name=theme-color content="#790000"><meta name=color-scheme content="system light dark high-contrast"><link rel="shortcut icon" href=http://172.16.201.134:1313/favicon.ico><link rel=stylesheet href=http://172.16.201.134:1313/styles/main.min.css><link rel=stylesheet href=http://172.16.201.134:1313/css/font-awesome-min.css><script defer src=/js/theme-chooser.min.js></script><script defer src=/js/copy-clipboard.min.js></script><script defer src=/js/search.min.js></script><meta name=twitter:card content="summary"><meta name=twitter:domain content="docs.FreeBSD.org"><meta name=twitter:site content="@freebsd"><meta name=twitter:url content="https://twitter.com/freebsd"><meta property="og:title" content="章 4. Localization and Internationalization - L10N and I18N"><meta property="og:description" content><meta property="og:type" content="website"><meta property="og:image" content="http://172.16.201.134:1313/favicon.ico"><meta property="og:image:alt" content="FreeBSD Logo"><meta property="og:locale" content="zh-tw"><meta property="og:url" content="http://172.16.201.134:1313/zh-tw/books/developers-handbook/l10n/"><meta property="og:site_name" content="FreeBSD Documentation Portal"><script type=application/ld+json>{"@context":"http://schema.org","@type":"Article","url":"http:\/\/172.16.201.134:1313\/zh-tw\/books\/developers-handbook\/l10n\/","name":"FreeBSD Documentation Portal","headline":"FreeBSD Documentation Portal","description":"FreeBSD Documentation Portal"}</script></head><body><header><div class=header-container><div class=logo-menu-bars-container><a href=https://www.FreeBSD.org class=logo><img src=http://172.16.201.134:1313/images/FreeBSD-monochromatic.svg width=160 height=50 alt="FreeBSD logo">
</a><label class=menu-bars for=menu-bars><i class="fa fa-bars" aria-hidden=true></i></label></div><input id=menu-bars type=checkbox><nav><ul class=menu><li class=menu-item><input id=about type=checkbox>
<a href=# aria-label="Navigate to About section"><label class=menu-item-description for=about>About
<i class="fa fa-angle-down fa-lg" aria-hidden=true></i></label></a><ul class=sub-menu><li class=title><a href=https://www.freebsd.org/about/ target=_blank>About</a></li><li><a href=https://www.freebsd.org/about/ target=_blank>FreeBSD</a></li><li><a href=https://freebsdfoundation.org/about-us/about-the-foundation/ target=_blank>FreeBSD Foundation</a></li><li><a href=https://www.freebsd.org/internal/code-of-conduct/ target=_blank>Code of Conduct</a></li></ul></li><li class=menu-item><input id=download type=checkbox>
<a href=# aria-label="Navigate to get FreeBSD section"><label class=menu-item-description for=download>Get FreeBSD
<i class="fa fa-angle-down fa-lg" aria-hidden=true></i></label></a><ul class=sub-menu><li class=title><a href=https://www.freebsd.org/where/ target=_blank>Get FreeBSD</a></li><li><a href=https://www.freebsd.org/releases/ target=_blank>Release Information</a></li><li><a href=https://www.freebsd.org/releng/ target=_blank>Release Engineering</a></li><li><a href=https://www.freebsd.org/security/ target=_blank>Security Advisories</a></li></ul></li><li class=menu-item><input id=documentation type=checkbox>
<a href=# aria-label="Navigate to get Documentation section"><label class=menu-item-description for=documentation>Documentation
<i class="fa fa-angle-down fa-lg" aria-hidden=true></i></label></a><ul class=sub-menu><li class=title><a href=/zh-tw>Documentation portal</a></li><li><a href=http://172.16.201.134:1313/zh-tw/books/handbook>FreeBSD Handbook</a></li><li><a href=http://172.16.201.134:1313/zh-tw/books/porters-handbook>Porter's Handbook</a></li><li><a href=https://docs.FreeBSD.org/en/books/fdp-primer>Documentation Project Handbook</a></li><li><a href=https://man.FreeBSD.org target=_blank>Manual pages</a></li><li><a href=https://papers.FreeBSD.org target=_blank>Presentations and papers</a></li><li><a href=https://wiki.FreeBSD.org target=_blank>Wiki</a></li><li><a href=http://172.16.201.134:1313/zh-tw/books>Books</a></li><li><a href=http://172.16.201.134:1313/zh-tw/articles>Articles</a></li></ul></li><li class=menu-item><input id=community type=checkbox>
<a href=# aria-label="Navigate to get Community section"><label class=menu-item-description for=community>Community
<i class="fa fa-angle-down fa-lg" aria-hidden=true></i></label></a><ul class=sub-menu><li class=title><a href=https://www.freebsd.org/community/>Community</a></li><li><a href=http://172.16.201.134:1313/zh-tw/articles/contributing>Get involved</a></li><li><a href=https://forums.freebsd.org/ target=_blank>Forum</a></li><li><a href=https://lists.freebsd.org/ target=_blank>Mailing lists</a></li><li><a href=https://wiki.freebsd.org/IRC/Channels target=_blank>IRC Channels</a></li><li><a href=https://bugs.freebsd.org/bugzilla/ target=_blank>Bug Tracker</a></li><li><a href=https://www.freebsd.org/support/ target=_blank>Support</a></li></ul></li></ul></nav><div class=search-donate-container><form class=search method=get id=search-header-form action=https://docs.freebsd.org/search name=search-header-form><input type=hidden name=DB value=zh-tw>
<input id=words name=P type=text size=20 maxlength=255>
<button>
<i class="fa fa-search" aria-hidden=true></i></button></form><div class=donate><a href=https://freebsdfoundation.org/donate/ target=_blank><span class=heart>♥</span>
Donate</a></div></div></div></header><input type=checkbox class="hidden toggle" id=menu-control><main class=main-wrapper-book><a id=top></a><aside class=book-menu><div class=book-menu-content><input id=search-book type=text placeholder=Search aria-label=Search maxlength=128><nav id=MenuContents><ul><li><input type=checkbox id=chapter-b1b18a35567534d1699b4dd27b58b2ff class=toggle>
<label for=chapter-b1b18a35567534d1699b4dd27b58b2ff><a role=button></a></label><a href=http://172.16.201.134:1313/zh-tw/books/developers-handbook/parti/>Part I. Grundlagen</a></li><li><input type=checkbox id=chapter-3af9d0cd3607fbe44d37e3a13957c40f class=toggle>
<label class="icon cursor" for=chapter-3af9d0cd3607fbe44d37e3a13957c40f><a role=button></a></label><a href=http://172.16.201.134:1313/zh-tw/books/developers-handbook/introduction/>章 1. 簡介</a><ul><li><a href=http://172.16.201.134:1313/zh-tw/books/developers-handbook/introduction/#introduction-devel>1.1. 在 FreeBSD 開發程式</a></li><li><a href=http://172.16.201.134:1313/zh-tw/books/developers-handbook/introduction/#introduction-bsdvision>1.2. The BSD Vision</a></li><li><a href=http://172.16.201.134:1313/zh-tw/books/developers-handbook/introduction/#introduction-archguide>1.3. 程式架構指南</a></li><li><a href=http://172.16.201.134:1313/zh-tw/books/developers-handbook/introduction/#introduction-layout>1.4. <span class=filename>/usr/src</span> 的架構</a></li></ul></li><li><input type=checkbox id=chapter-15219234c513f9a79d9cb2d3bcf73d13 class=toggle>
<label class="icon cursor" for=chapter-15219234c513f9a79d9cb2d3bcf73d13><a role=button></a></label><a href=http://172.16.201.134:1313/zh-tw/books/developers-handbook/tools/>章 2. 程式開發工具</a><ul><li><a href=http://172.16.201.134:1313/zh-tw/books/developers-handbook/tools/#tools-synopsis>2.1. 概敘</a></li><li><a href=http://172.16.201.134:1313/zh-tw/books/developers-handbook/tools/#tools-intro>2.2. 簡介</a></li><li><a href=http://172.16.201.134:1313/zh-tw/books/developers-handbook/tools/#tools-programming>2.3. Programming 概念</a></li><li><a href=http://172.16.201.134:1313/zh-tw/books/developers-handbook/tools/#tools-compiling>2.4. 用 <code>cc</code> 來編譯程式</a></li><li><a href=http://172.16.201.134:1313/zh-tw/books/developers-handbook/tools/#tools-make>2.5. Make</a></li><li><a href=http://172.16.201.134:1313/zh-tw/books/developers-handbook/tools/#debugging>2.6. Debugging</a></li><li><a href=http://172.16.201.134:1313/zh-tw/books/developers-handbook/tools/#emacs>2.7. Using Emacs as a Development Environment</a></li><li><a href=http://172.16.201.134:1313/zh-tw/books/developers-handbook/tools/#tools-reading>2.8. Further Reading</a></li></ul></li><li><input type=checkbox id=chapter-7319f5d899d5be33daaf1f2d5f180558 class=toggle>
<label class="icon cursor" for=chapter-7319f5d899d5be33daaf1f2d5f180558><a role=button></a></label><a href=http://172.16.201.134:1313/zh-tw/books/developers-handbook/secure/>章 3. Secure Programming</a><ul><li><a href=http://172.16.201.134:1313/zh-tw/books/developers-handbook/secure/#secure-synopsis>3.1. Synopsis</a></li><li><a href=http://172.16.201.134:1313/zh-tw/books/developers-handbook/secure/#secure-philosophy>3.2. Secure Design Methodology</a></li><li><a href=http://172.16.201.134:1313/zh-tw/books/developers-handbook/secure/#secure-bufferov>3.3. Buffer Overflows</a></li><li><a href=http://172.16.201.134:1313/zh-tw/books/developers-handbook/secure/#secure-setuid>3.4. SetUID issues</a></li><li><a href=http://172.16.201.134:1313/zh-tw/books/developers-handbook/secure/#secure-chroot>3.5. Limiting your program’s environment</a></li><li><a href=http://172.16.201.134:1313/zh-tw/books/developers-handbook/secure/#secure-trust>3.6. Trust</a></li><li><a href=http://172.16.201.134:1313/zh-tw/books/developers-handbook/secure/#secure-race-conditions>3.7. Race Conditions</a></li></ul></li><li><input type=checkbox id=chapter-0240ccaf7010beed911378cfab7bd8fc class=toggle checked>
<label class="icon cursor" for=chapter-0240ccaf7010beed911378cfab7bd8fc><a role=button></a></label><a href=http://172.16.201.134:1313/zh-tw/books/developers-handbook/l10n/>章 4. Localization and Internationalization - L10N and I18N</a><ul><li><a href=http://172.16.201.134:1313/zh-tw/books/developers-handbook/l10n/#l10n-programming>4.1. Programming I18N Compliant Applications</a></li><li><a href=http://172.16.201.134:1313/zh-tw/books/developers-handbook/l10n/#posix-nls>4.2. Localized Messages with POSIX.1 Native Language Support (NLS)</a></li></ul></li><li><input type=checkbox id=chapter-c3107aaf64e60e1ee09bc33fc9fd641a class=toggle>
<label class="icon cursor" for=chapter-c3107aaf64e60e1ee09bc33fc9fd641a><a role=button></a></label><a href=http://172.16.201.134:1313/zh-tw/books/developers-handbook/policies/>章 5. Source Tree Guidelines and Policies</a><ul><li><a href=http://172.16.201.134:1313/zh-tw/books/developers-handbook/policies/#policies-style>5.1. Style Guidelines</a></li><li><a href=http://172.16.201.134:1313/zh-tw/books/developers-handbook/policies/#policies-maintainer>5.2. <code>MAINTAINER</code> on Makefiles</a></li><li><a href=http://172.16.201.134:1313/zh-tw/books/developers-handbook/policies/#policies-contributed>5.3. Contributed Software</a></li><li><a href=http://172.16.201.134:1313/zh-tw/books/developers-handbook/policies/#policies-encumbered>5.4. Encumbered Files</a></li><li><a href=http://172.16.201.134:1313/zh-tw/books/developers-handbook/policies/#policies-shlib>5.5. Shared Libraries</a></li></ul></li><li><input type=checkbox id=chapter-c7b4fd5a7f8f049234fe3bc225acef44 class=toggle>
<label class="icon cursor" for=chapter-c7b4fd5a7f8f049234fe3bc225acef44><a role=button></a></label><a href=http://172.16.201.134:1313/zh-tw/books/developers-handbook/testing/>章 6. Regression and Performance Testing</a><ul><li><a href=http://172.16.201.134:1313/zh-tw/books/developers-handbook/testing/#testing-micro-benchmark>6.1. Micro Benchmark Checklist</a></li><li><a href=http://172.16.201.134:1313/zh-tw/books/developers-handbook/testing/#testing-tinderbox>6.2. The FreeBSD Source Tinderbox</a></li><li><a href=http://172.16.201.134:1313/zh-tw/books/developers-handbook/testing/#_the_index_cgi_script>6.3. The <span class=filename>index.cgi</span> Script</a></li><li><a href=http://172.16.201.134:1313/zh-tw/books/developers-handbook/testing/#_official_build_servers>6.4. Official Build Servers</a></li><li><a href=http://172.16.201.134:1313/zh-tw/books/developers-handbook/testing/#_official_summary_site>6.5. Official Summary Site</a></li></ul></li><li><input type=checkbox id=chapter-1f9b02a65f2bc5d4015a050d706fa837 class=toggle>
<label for=chapter-1f9b02a65f2bc5d4015a050d706fa837><a role=button></a></label><a href=http://172.16.201.134:1313/zh-tw/books/developers-handbook/partii/>Part II. Interprozess-Kommunikation</a></li><li><input type=checkbox id=chapter-5e03777f678dd5731a581d7956d19c13 class=toggle>
<label class="icon cursor" for=chapter-5e03777f678dd5731a581d7956d19c13><a role=button></a></label><a href=http://172.16.201.134:1313/zh-tw/books/developers-handbook/sockets/>章 7. Sockets</a><ul><li><a href=http://172.16.201.134:1313/zh-tw/books/developers-handbook/sockets/#sockets-synopsis>7.1. Synopsis</a></li><li><a href=http://172.16.201.134:1313/zh-tw/books/developers-handbook/sockets/#sockets-diversity>7.2. Networking and Diversity</a></li><li><a href=http://172.16.201.134:1313/zh-tw/books/developers-handbook/sockets/#sockets-protocols>7.3. Protocols</a></li><li><a href=http://172.16.201.134:1313/zh-tw/books/developers-handbook/sockets/#sockets-model>7.4. The Sockets Model</a></li><li><a href=http://172.16.201.134:1313/zh-tw/books/developers-handbook/sockets/#sockets-essential-functions>7.5. Essential Socket Functions</a></li><li><a href=http://172.16.201.134:1313/zh-tw/books/developers-handbook/sockets/#sockets-helper-functions>7.6. Helper Functions</a></li><li><a href=http://172.16.201.134:1313/zh-tw/books/developers-handbook/sockets/#sockets-concurrent-servers>7.7. Concurrent Servers</a></li></ul></li><li><input type=checkbox id=chapter-5cbeeaa29a95a5f152e5ccc3901d0fd3 class=toggle>
<label class="icon cursor" for=chapter-5cbeeaa29a95a5f152e5ccc3901d0fd3><a role=button></a></label><a href=http://172.16.201.134:1313/zh-tw/books/developers-handbook/ipv6/>章 8. IPv6 Internals</a><ul><li><a href=http://172.16.201.134:1313/zh-tw/books/developers-handbook/ipv6/#ipv6-implementation>8.1. IPv6/IPsec Implementation</a></li></ul></li><li><input type=checkbox id=chapter-c9a07b517dc2e43d169c8e013e23cfc1 class=toggle>
<label for=chapter-c9a07b517dc2e43d169c8e013e23cfc1><a role=button></a></label><a href=http://172.16.201.134:1313/zh-tw/books/developers-handbook/partiii/>Part III. Kernel</a></li><li><input type=checkbox id=chapter-db22f8e5e5e9496dbc711815e2e05f36 class=toggle>
<label class="icon cursor" for=chapter-db22f8e5e5e9496dbc711815e2e05f36><a role=button></a></label><a href=http://172.16.201.134:1313/zh-tw/books/developers-handbook/kernelbuild/>章 9. Building and Installing a FreeBSD Kernel</a><ul><li><a href=http://172.16.201.134:1313/zh-tw/books/developers-handbook/kernelbuild/#kernelbuild-traditional>9.1. Building the Faster but Brittle Way</a></li></ul></li><li><input type=checkbox id=chapter-3036877c53948cfb76174f2776bbdf64 class=toggle>
<label class="icon cursor" for=chapter-3036877c53948cfb76174f2776bbdf64><a role=button></a></label><a href=http://172.16.201.134:1313/zh-tw/books/developers-handbook/kerneldebug/>章 10. Kernel Debugging</a><ul><li><a href=http://172.16.201.134:1313/zh-tw/books/developers-handbook/kerneldebug/#kerneldebug-obtain>10.1. Obtaining a Kernel Crash Dump</a></li><li><a href=http://172.16.201.134:1313/zh-tw/books/developers-handbook/kerneldebug/#kerneldebug-gdb>10.2. Debugging a Kernel Crash Dump with <code>kgdb</code></a></li><li><a href=http://172.16.201.134:1313/zh-tw/books/developers-handbook/kerneldebug/#kerneldebug-online-ddb>10.3. On-Line Kernel Debugging Using DDB</a></li><li><a href=http://172.16.201.134:1313/zh-tw/books/developers-handbook/kerneldebug/#kerneldebug-online-gdb>10.4. On-Line Kernel Debugging Using Remote GDB</a></li><li><a href=http://172.16.201.134:1313/zh-tw/books/developers-handbook/kerneldebug/#kerneldebug-console>10.5. Debugging a Console Driver</a></li><li><a href=http://172.16.201.134:1313/zh-tw/books/developers-handbook/kerneldebug/#kerneldebug-deadlocks>10.6. Debugging Deadlocks</a></li><li><a href=http://172.16.201.134:1313/zh-tw/books/developers-handbook/kerneldebug/#kerneldebug-dcons>10.7. Kernel debugging with Dcons</a></li><li><a href=http://172.16.201.134:1313/zh-tw/books/developers-handbook/kerneldebug/#kerneldebug-options>10.8. Glossary of Kernel Options for Debugging</a></li></ul></li><li><input type=checkbox id=chapter-86707094ce48d6e89e5f45569c084cea class=toggle>
<label for=chapter-86707094ce48d6e89e5f45569c084cea><a role=button></a></label><a href=http://172.16.201.134:1313/zh-tw/books/developers-handbook/partiv/>Part IV. Architekturen</a></li><li><input type=checkbox id=chapter-43b1e1e6d2a94eb8b161876bc22ce644 class=toggle>
<label class="icon cursor" for=chapter-43b1e1e6d2a94eb8b161876bc22ce644><a role=button></a></label><a href=http://172.16.201.134:1313/zh-tw/books/developers-handbook/x86/>章 11. x86 Assembly Language Programming</a><ul><li><a href=http://172.16.201.134:1313/zh-tw/books/developers-handbook/x86/#x86-intro>11.1. Synopsis</a></li><li><a href=http://172.16.201.134:1313/zh-tw/books/developers-handbook/x86/#x86-the-tools>11.2. The Tools</a></li><li><a href=http://172.16.201.134:1313/zh-tw/books/developers-handbook/x86/#x86-system-calls>11.3. System Calls</a></li><li><a href=http://172.16.201.134:1313/zh-tw/books/developers-handbook/x86/#x86-return-values>11.4. Return Values</a></li><li><a href=http://172.16.201.134:1313/zh-tw/books/developers-handbook/x86/#x86-portable-code>11.5. Creating Portable Code</a></li><li><a href=http://172.16.201.134:1313/zh-tw/books/developers-handbook/x86/#x86-first-program>11.6. Our First Program</a></li><li><a href=http://172.16.201.134:1313/zh-tw/books/developers-handbook/x86/#x86-unix-filters>11.7. Writing UNIX® Filters</a></li><li><a href=http://172.16.201.134:1313/zh-tw/books/developers-handbook/x86/#x86-buffered-io>11.8. Buffered Input and Output</a></li><li><a href=http://172.16.201.134:1313/zh-tw/books/developers-handbook/x86/#x86-command-line>11.9. Command Line Arguments</a></li><li><a href=http://172.16.201.134:1313/zh-tw/books/developers-handbook/x86/#x86-environment>11.10. UNIX® Environment</a></li><li><a href=http://172.16.201.134:1313/zh-tw/books/developers-handbook/x86/#x86-files>11.11. Working with Files</a></li><li><a href=http://172.16.201.134:1313/zh-tw/books/developers-handbook/x86/#x86-one-pointed-mind>11.12. One-Pointed Mind</a></li><li><a href=http://172.16.201.134:1313/zh-tw/books/developers-handbook/x86/#x86-fpu>11.13. Using the FPU</a></li><li><a href=http://172.16.201.134:1313/zh-tw/books/developers-handbook/x86/#x86-caveats>11.14. Caveats</a></li><li><a href=http://172.16.201.134:1313/zh-tw/books/developers-handbook/x86/#x86-acknowledgements>11.15. Acknowledgements</a></li></ul></li><li><input type=checkbox id=chapter-c49dfe630861d471fb2f58f5b554ed84 class=toggle>
<label for=chapter-c49dfe630861d471fb2f58f5b554ed84><a role=button></a></label><a href=http://172.16.201.134:1313/zh-tw/books/developers-handbook/partv/>Part V. Appendices</a></li><li><input type=checkbox id=chapter-ac9541a3f38001d13964c1b0b324bb83 class=toggle>
<label for=chapter-ac9541a3f38001d13964c1b0b324bb83><a role=button></a></label><a href=http://172.16.201.134:1313/zh-tw/books/developers-handbook/bibliography/>附錄</a></li><li></li></ul></nav></div></aside><div class=book><div class=book-menu-mobile><label for=menu-control><span class=menu-control-button><i class="fa fa-list" aria-hidden=true title="Book menu"></i>
Book menu</span></label></div><h1 class=title>章 4. Localization and Internationalization - L10N and I18N</h1><div class="admonitionblock note"><p><i class="fa fa-exclamation-circle" aria-hidden=true></i>
This translation may be out of date. To help with the translations please access the <a href=https://translate-dev.freebsd.org/ target=_blank>FreeBSD translations instance</a>.</p></div><div class=toc-mobile><h3>目錄</h3><nav id=TableOfContents><ul><li><a href=#l10n-programming>4.1. Programming I18N Compliant Applications</a></li><li><a href=#posix-nls>4.2. Localized Messages with POSIX.1 Native Language Support (NLS)</a></li></ul></nav></div><div class=book-content><div id=preamble><div class=sectionbody></div></div><div class=sect1><h2 id=l10n-programming>4.1. Programming I18N Compliant Applications<a class=anchor href=#l10n-programming></a></h2><div class=sectionbody><div class=paragraph><p>To make your application more useful for speakers of other languages, we hope that you will program I18N compliant. The GNU gcc compiler and GUI libraries like QT and GTK support I18N through special handling of strings. Making a program I18N compliant is very easy. It allows contributors to port your application to other languages quickly. Refer to the library specific I18N documentation for more details.</p></div><div class=paragraph><p>In contrast with common perception, I18N compliant code is easy to write. Usually, it only involves wrapping your strings with library specific functions. In addition, please be sure to allow for wide or multibyte character support.</p></div><div class=sect2><h3 id=_a_call_to_unify_the_i18n_effort>4.1.1. A Call to Unify the I18N Effort<a class=anchor href=#_a_call_to_unify_the_i18n_effort></a></h3><div class=paragraph><p>It has come to our attention that the individual I18N/L10N efforts for each country has been repeating each others' efforts. Many of us have been reinventing the wheel repeatedly and inefficiently. We hope that the various major groups in I18N could congregate into a group effort similar to the Core Team’s responsibility.</p></div><div class=paragraph><p>Currently, we hope that, when you write or port I18N programs, you would send it out to each country’s related FreeBSD mailing list for testing. In the future, we hope to create applications that work in all the languages out-of-the-box without dirty hacks.</p></div><div class=paragraph><p>The <a href=https://lists.FreeBSD.org/subscription/freebsd-i18n>FreeBSD internationalization 郵遞論壇</a> has been established. If you are an I18N/L10N developer, please send your comments, ideas, questions, and anything you deem related to it.</p></div></div><div class=sect2><h3 id=_perl_and_python>4.1.2. Perl and Python<a class=anchor href=#_perl_and_python></a></h3><div class=paragraph><p>Perl and Python have I18N and wide character handling libraries. Please use them for I18N compliance.</p></div></div></div></div><div class=sect1><h2 id=posix-nls>4.2. Localized Messages with POSIX.1 Native Language Support (NLS)<a class=anchor href=#posix-nls></a></h2><div class=sectionbody><div class=paragraph><p>Beyond the basic I18N functions, like supporting various input encodings or supporting national conventions, such as the different decimal separators, at a higher level of I18N, it is possible to localize the messages written to the output by the various programs. A common way of doing this is using the POSIX.1 NLS functions, which are provided as a part of the FreeBSD base system.</p></div><div class=sect2><h3 id=nls-catalogs>4.2.1. Organizing Localized Messages into Catalog Files<a class=anchor href=#nls-catalogs></a></h3><div class=paragraph><p>POSIX.1 NLS is based on catalog files, which contain the localized messages in the desired encoding. The messages are organized into sets and each message is identified by an integer number in the containing set. The catalog files are conventionally named after the locale they contain localized messages for, followed by the <code>.msg</code> extension. For instance, the Hungarian messages for ISO8859-2 encoding should be stored in a file called <span class=filename>hu_HU.ISO8859-2</span>.</p></div><div class=paragraph><p>These catalog files are common text files that contain the numbered messages. It is possible to write comments by starting the line with a <code>$</code> sign. Set boundaries are also separated by special comments, where the keyword <code>set</code> must directly follow the <code>$</code> sign. The <code>set</code> keyword is then followed by the set number. For example:</p></div><div class="literalblock programlisting"><div class=content><pre>$set 1</pre></div></div><div class=paragraph><p>The actual message entries start with the message number and followed by the localized message. The well-known modifiers from <a href="https://man.freebsd.org/cgi/man.cgi?query=printf&amp;sektion=3&amp;format=html">printf(3)</a> are accepted:</p></div><div class="literalblock programlisting"><div class=content><pre>15 &#34;File not found: %s\n&#34;</pre></div></div><div class=paragraph><p>The language catalog files have to be compiled into a binary form before they can be opened from the program. This conversion is done with the <a href="https://man.freebsd.org/cgi/man.cgi?query=gencat&amp;sektion=1&amp;format=html">gencat(1)</a> utility. Its first argument is the filename of the compiled catalog and its further arguments are the input catalogs. The localized messages can also be organized into more catalog files and then all of them can be processed with <a href="https://man.freebsd.org/cgi/man.cgi?query=gencat&amp;sektion=1&amp;format=html">gencat(1)</a>.</p></div></div><div class=sect2><h3 id=nls-using>4.2.2. Using the Catalog Files from the Source Code<a class=anchor href=#nls-using></a></h3><div class=paragraph><p>Using the catalog files is simple. To use the related functions, <span class=filename>nl_types.h</span> must be included. Before using a catalog, it has to be opened with <a href="https://man.freebsd.org/cgi/man.cgi?query=catopen&amp;sektion=3&amp;format=html">catopen(3)</a>. The function takes two arguments. The first parameter is the name of the installed and compiled catalog. Usually, the name of the program is used, such as grep. This name will be used when looking for the compiled catalog file. The <a href="https://man.freebsd.org/cgi/man.cgi?query=catopen&amp;sektion=3&amp;format=html">catopen(3)</a> call looks for this file in <span class=filename>/usr/shared/nls/locale/catname</span> and in <span class=filename>/usr/local/shared/nls/locale/catname</span>, where <code>locale</code> is the locale set and <code>catname</code> is the catalog name being discussed. The second parameter is a constant, which can have two values:</p></div><div class=ulist><ul><li><p><code>NL_CAT_LOCALE</code>, which means that the used catalog file will be based on <code>LC_MESSAGES</code>.</p></li><li><p><code>0</code>, which means that <code>LANG</code> has to be used to open the proper catalog.</p></li></ul></div><div class=paragraph><p>The <a href="https://man.freebsd.org/cgi/man.cgi?query=catopen&amp;sektion=3&amp;format=html">catopen(3)</a> call returns a catalog identifier of type <code>nl_catd</code>. Please refer to the manual page for a list of possible returned error codes.</p></div><div class=paragraph><p>After opening a catalog <a href="https://man.freebsd.org/cgi/man.cgi?query=catgets&amp;sektion=3&amp;format=html">catgets(3)</a> can be used to retrieve a message. The first parameter is the catalog identifier returned by <a href="https://man.freebsd.org/cgi/man.cgi?query=catopen&amp;sektion=3&amp;format=html">catopen(3)</a>, the second one is the number of the set, the third one is the number of the messages, and the fourth one is a fallback message, which will be returned if the requested message cannot be retrieved from the catalog file.</p></div><div class=paragraph><p>After using the catalog file, it must be closed by calling <a href="https://man.freebsd.org/cgi/man.cgi?query=catclose&amp;sektion=3&amp;format=html">catclose(3)</a>, which has one argument, the catalog id.</p></div></div><div class=sect2><h3 id=nls-example>4.2.3. A Practical Example<a class=anchor href=#nls-example></a></h3><div class=paragraph><p>The following example will demonstrate an easy solution on how to use NLS catalogs in a flexible way.</p></div><div class=paragraph><p>The below lines need to be put into a common header file of the program, which is included into all source files where localized messages are necessary:</p></div><div class="literalblock programlisting"><div class=content><pre>#ifdef WITHOUT_NLS
#define getstr(n)	 nlsstr[n]
#else
#include nl_types.h

extern nl_catd		 catalog;
#define getstr(n)	 catgets(catalog, 1, n, nlsstr[n])
#endif

extern char		*nlsstr[];</pre></div></div><div class=paragraph><p>Next, put these lines into the global declaration part of the main source file:</p></div><div class="literalblock programlisting"><div class=content><pre>#ifndef WITHOUT_NLS
#include nl_types.h
nl_catd	 catalog;
#endif

/*
 * Default messages to use when NLS is disabled or no catalog
 * is found.
 */
char    *nlsstr[] = {
        &#34;&#34;,
/* 1*/  &#34;some random message&#34;,
/* 2*/  &#34;some other message&#34;
};</pre></div></div><div class=paragraph><p>Next come the real code snippets, which open, read, and close the catalog:</p></div><div class="literalblock programlisting"><div class=content><pre>#ifndef WITHOUT_NLS
	catalog = catopen(&#34;myapp&#34;, NL_CAT_LOCALE);
#endif

...

printf(getstr(1));

...

#ifndef WITHOUT_NLS
	catclose(catalog);
#endif</pre></div></div><div class=sect3><h4 id=_reducing_strings_to_localize>4.2.3.1. Reducing Strings to Localize<a class=anchor href=#_reducing_strings_to_localize></a></h4><div class=paragraph><p>There is a good way of reducing the strings that need to be localized by using libc error messages. This is also useful to just avoid duplication and provide consistent error messages for the common errors that can be encountered by a great many of programs.</p></div><div class=paragraph><p>First, here is an example that does not use libc error messages:</p></div><div class="literalblock programlisting"><div class=content><pre>#include err.h
...
if (!S_ISDIR(st.st_mode))
	errx(1, &#34;argument is not a directory&#34;);</pre></div></div><div class=paragraph><p>This can be transformed to print an error message by reading <code>errno</code> and printing an error message accordingly:</p></div><div class="literalblock programlisting"><div class=content><pre>#include err.h
#include errno.h
...
if (!S_ISDIR(st.st_mode)) {
	errno = ENOTDIR;
	err(1, NULL);
}</pre></div></div><div class=paragraph><p>In this example, the custom string is eliminated, thus translators will have less work when localizing the program and users will see the usual "Not a directory" error message when they encounter this error. This message will probably seem more familiar to them. Please note that it was necessary to include <span class=filename>errno.h</span> in order to directly access <code>errno</code>.</p></div><div class=paragraph><p>It is worth to note that there are cases when <code>errno</code> is set automatically by a preceding call, so it is not necessary to set it explicitly:</p></div><div class="literalblock programlisting"><div class=content><pre>#include err.h
...
if ((p = malloc(size)) == NULL)
	err(1, NULL);</pre></div></div></div></div><div class=sect2><h3 id=nls-mk>4.2.4. Making use of <span class=filename>bsd.nls.mk</span><a class=anchor href=#nls-mk></a></h3><div class=paragraph><p>Using the catalog files requires few repeatable steps, such as compiling the catalogs and installing them to the proper location. In order to simplify this process even more, <span class=filename>bsd.nls.mk</span> introduces some macros. It is not necessary to include <span class=filename>bsd.nls.mk</span> explicitly, it is pulled in from the common Makefiles, such as <span class=filename>bsd.prog.mk</span> or <span class=filename>bsd.lib.mk</span>.</p></div><div class=paragraph><p>Usually it is enough to define <code>NLSNAME</code>, which should have the catalog name mentioned as the first argument of <a href="https://man.freebsd.org/cgi/man.cgi?query=catopen&amp;sektion=3&amp;format=html">catopen(3)</a> and list the catalog files in <code>NLS</code> without their <code>.msg</code> extension. Here is an example, which makes it possible to to disable NLS when used with the code examples before. The <code>WITHOUT_NLS</code> <a href="https://man.freebsd.org/cgi/man.cgi?query=make&amp;sektion=1&amp;format=html">make(1)</a> variable has to be defined in order to build the program without NLS support.</p></div><div class="literalblock programlisting"><div class=content><pre>.if !defined(WITHOUT_NLS)
NLS=	es_ES.ISO8859-1
NLS+=	hu_HU.ISO8859-2
NLS+=	pt_BR.ISO8859-1
.else
CFLAGS+=	-DWITHOUT_NLS
.endif</pre></div></div><div class=paragraph><p>Conventionally, the catalog files are placed under the <span class=filename>nls</span> subdirectory and this is the default behavior of <span class=filename>bsd.nls.mk</span>. It is possible, though to override the location of the catalogs with the <code>NLSSRCDIR</code> <a href="https://man.freebsd.org/cgi/man.cgi?query=make&amp;sektion=1&amp;format=html">make(1)</a> variable. The default name of the precompiled catalog files also follow the naming convention mentioned before. It can be overridden by setting the <code>NLSNAME</code> variable. There are other options to fine tune the processing of the catalog files but usually it is not needed, thus they are not described here. For further information on <span class=filename>bsd.nls.mk</span>, please refer to the file itself, it is short and easy to understand.</p></div></div></div></div></div><hr><div class=last-modified><p><strong>最後修改於</strong>: March 9, 2024 由 <a href="https://cgit.freebsd.org/doc/commit/?id=6199af92e7" target=_blank>Danilo G. Baio</a></p></div><div class=buttons><div class=prev><i class="fa fa-angle-left" aria-hidden=true title=Prev></i><div class=container><a href=http://172.16.201.134:1313/zh-tw/books/developers-handbook/secure class=direction>Prev</a></div></div><div class=home><i class="fa fa-home" aria-hidden=true title=Home></i><div class=container><a href=../ class=direction>Home</a></div></div><div class=next><div class=container><a href=http://172.16.201.134:1313/zh-tw/books/developers-handbook/policies class=direction>Next</a></div><i class="fa fa-angle-right" aria-hidden=true title=Next></i></div></div><label class="hidden book-menu-overlay" for=menu-control></label></div><aside class=toc><div class=toc-content><h3>目錄</h3><nav id=TableOfContents><ul><li><a href=#l10n-programming>4.1. Programming I18N Compliant Applications</a></li><li><a href=#posix-nls>4.2. Localized Messages with POSIX.1 Native Language Support (NLS)</a></li></ul></nav><hr><div class=resources><h3>資源</h3><ul class=contents><li><i class="fa fa-file-pdf-o" aria-hidden=true title="下載 PDF"></i><a href=https://download.freebsd.org/doc/zh-tw/books/developers-handbook/developers-handbook_zh-tw.pdf>下載 PDF</a></li><li><i class="fa fa-pencil-square-o" aria-hidden=true title=編輯此頁></i><a href=https://github.com/freebsd/freebsd-doc/blob/main/documentation/content/zh-tw/_index target=_blank>編輯此頁</a></li></ul></div></div></aside><a class=to-top href=#top><i class="fa fa-arrow-circle-up" aria-hidden=true></i></a></main><footer><div class=footer-container><section class=logo-column><img src=http://172.16.201.134:1313/images/FreeBSD-colors.svg width=160 height=50 alt="FreeBSD logo"><div class=options-container><div class=language-container><a id=languages href=http://172.16.201.134:1313/zh-tw/languages><img src=http://172.16.201.134:1313/images/language.png class=language-image alt=選擇語言>
<span>繁體中文</span></a></div><div class=theme-container><select id=theme-chooser><option value=theme-system>System</option><option value=theme-light>淺色</option><option value=theme-dark>深色</option><option value=theme-high-contrast>高對比</option></select></div></div></section><section class=about-column><h3 class=column-title>About</h3><ul class=column-elements-container><li><a href=https://www.freebsd.org/about/ target=_blank class=column-element>FreeBSD</a></li><li><a href=https://freebsdfoundation.org/ target=_blank class=column-element>FreeBSD Foundation</a></li><li><a href=https://www.freebsd.org/where/ target=_blank class=column-element>Get FreeBSD</a></li><li><a href=https://www.freebsd.org/internal/code-of-conduct target=_blank class=column-element>Code of Conduct</a></li><li><a href=https://www.freebsd.org/security/ target=_blank class=column-element>Security Advisories</a></li></ul></section><section class=documentation-column><h3 class=column-title>Documentation</h3><ul class=column-elements-container><li><a href=/zh-tw class=column-element>Documentation portal</a></li><li><a href=https://man.FreeBSD.org target=_blank class=column-element>Manual pages</a></li><li><a href=https://papers.FreeBSD.org target=_blank class=column-element>Presentations and papers</a></li><li><a href=https://docs-archive.freebsd.org/doc/ target=_blank class=column-element>Previous versions</a></li><li><a href=https://docs-archive.freebsd.org/44doc/ target=_blank class=column-element>4.4BSD Documents</a></li><li><a href=https://wiki.freebsd.org/ target=_blank class=column-element>Wiki</a></li></ul></section><section class=community-column><h3 class=column-title>Community</h3><ul class=column-elements-container><li><a href=http://172.16.201.134:1313/zh-tw/articles/contributing class=column-element>Get involved</a></li><li><a href=https://forums.freebsd.org/ target=_blank class=column-element>Community forum</a></li><li><a href=https://lists.freebsd.org/ target=_blank class=column-element>Mailing lists</a></li><li><a href=https://wiki.freebsd.org/IRC/Channels target=_blank class=column-element>IRC Channels</a></li><li><a href=https://bugs.freebsd.org/bugzilla/ target=_blank class=column-element>Bug Tracker</a></li></ul></section><section class=legal-column><h3 class=column-title>Legal</h3><ul class=column-elements-container><li><a href=https://freebsdfoundation.org/donate/ target=_blank class=column-element>Donations</a></li><li><a href=https://www.freebsd.org/copyright/freebsd-license/ target=_blank class=column-element>Licensing</a></li><li><a href=https://www.freebsd.org/privacy/ target=_blank class=column-element>Privacy Policy</a></li><li><a href=https://www.freebsd.org/copyright/ target=_blank class=column-element>Legal notices</a></li></ul></section><section class=copyright-column><p>&copy; 1994-2024 The FreeBSD Project. All rights reserved</p><span>Made with <span class=heart>♥</span> by the FreeBSD Community</span></section></div></footer></body></html>