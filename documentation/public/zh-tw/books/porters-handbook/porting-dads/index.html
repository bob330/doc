<!doctype html><html class=theme-light lang=zh-tw><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="A list of common dos and don'ts that are encountered during the FreeBSD porting process"><meta name=keywords content="dos,don'ts,porting,ports,guide"><meta name=copyright content="1995-2024 The FreeBSD Foundation"><link rel=canonical href=https://docs.freebsd.org/zh-tw/books/porters-handbook/porting-dads/><title>Chapter 13. Dos and Don'ts | FreeBSD Documentation Portal</title>
<meta name=theme-color content="#790000"><meta name=color-scheme content="system light dark high-contrast"><link rel="shortcut icon" href=https://docs.freebsd.org/favicon.ico><link rel=stylesheet href=https://docs.freebsd.org/styles/main.min.css><link rel=stylesheet href=https://docs.freebsd.org/css/font-awesome-min.css><script defer src=/js/theme-chooser.min.js></script><script defer src=/js/copy-clipboard.min.js></script><script defer src=/js/search.min.js></script><meta name=twitter:card content="summary"><meta name=twitter:domain content="docs.FreeBSD.org"><meta name=twitter:site content="@freebsd"><meta name=twitter:url content="https://twitter.com/freebsd"><meta property="og:title" content="Chapter 13. Dos and Don'ts"><meta property="og:description" content="A list of common dos and don'ts that are encountered during the FreeBSD porting process"><meta property="og:type" content="website"><meta property="og:image" content="https://docs.freebsd.org/favicon.ico"><meta property="og:image:alt" content="FreeBSD Logo"><meta property="og:locale" content="zh-tw"><meta property="og:url" content="https://docs.freebsd.org/zh-tw/books/porters-handbook/porting-dads/"><meta property="og:site_name" content="FreeBSD Documentation Portal"><script type=application/ld+json>{"@context":"http://schema.org","@type":"Article","url":"https:\/\/docs.freebsd.org\/zh-tw\/books\/porters-handbook\/porting-dads\/","name":"FreeBSD Documentation Portal","headline":"FreeBSD Documentation Portal","description":"FreeBSD Documentation Portal"}</script></head><body><header><div class=header-container><div class=logo-menu-bars-container><a href=https://www.FreeBSD.org class=logo><img src=https://docs.freebsd.org/images/FreeBSD-monochromatic.svg width=160 height=50 alt="FreeBSD logo">
</a><label class=menu-bars for=menu-bars><i class="fa fa-bars" aria-hidden=true></i></label></div><input id=menu-bars type=checkbox><nav><ul class=menu><li class=menu-item><input id=about type=checkbox>
<a href=# aria-label="Navigate to About section"><label class=menu-item-description for=about>About
<i class="fa fa-angle-down fa-lg" aria-hidden=true></i></label></a><ul class=sub-menu><li class=title><a href=https://www.freebsd.org/about/ target=_blank>About</a></li><li><a href=https://www.freebsd.org/about/ target=_blank>FreeBSD</a></li><li><a href=https://freebsdfoundation.org/about-us/about-the-foundation/ target=_blank>FreeBSD Foundation</a></li><li><a href=https://www.freebsd.org/internal/code-of-conduct/ target=_blank>Code of Conduct</a></li></ul></li><li class=menu-item><input id=download type=checkbox>
<a href=# aria-label="Navigate to get FreeBSD section"><label class=menu-item-description for=download>Get FreeBSD
<i class="fa fa-angle-down fa-lg" aria-hidden=true></i></label></a><ul class=sub-menu><li class=title><a href=https://www.freebsd.org/where/ target=_blank>Get FreeBSD</a></li><li><a href=https://www.freebsd.org/releases/ target=_blank>Release Information</a></li><li><a href=https://www.freebsd.org/releng/ target=_blank>Release Engineering</a></li><li><a href=https://www.freebsd.org/security/ target=_blank>Security Advisories</a></li></ul></li><li class=menu-item><input id=documentation type=checkbox>
<a href=# aria-label="Navigate to get Documentation section"><label class=menu-item-description for=documentation>Documentation
<i class="fa fa-angle-down fa-lg" aria-hidden=true></i></label></a><ul class=sub-menu><li class=title><a href=/zh-tw>Documentation portal</a></li><li><a href=https://docs.freebsd.org/zh-tw/books/handbook>FreeBSD Handbook</a></li><li><a href=https://docs.freebsd.org/zh-tw/books/porters-handbook>Porter's Handbook</a></li><li><a href=https://docs.FreeBSD.org/en/books/fdp-primer>Documentation Project Handbook</a></li><li><a href=https://man.FreeBSD.org target=_blank>Manual pages</a></li><li><a href=https://papers.FreeBSD.org target=_blank>Presentations and papers</a></li><li><a href=https://wiki.FreeBSD.org target=_blank>Wiki</a></li><li><a href=https://docs.freebsd.org/zh-tw/books>Books</a></li><li><a href=https://docs.freebsd.org/zh-tw/articles>Articles</a></li></ul></li><li class=menu-item><input id=community type=checkbox>
<a href=# aria-label="Navigate to get Community section"><label class=menu-item-description for=community>Community
<i class="fa fa-angle-down fa-lg" aria-hidden=true></i></label></a><ul class=sub-menu><li class=title><a href=https://www.freebsd.org/community/>Community</a></li><li><a href=https://docs.freebsd.org/zh-tw/articles/contributing>Get involved</a></li><li><a href=https://forums.freebsd.org/ target=_blank>Forum</a></li><li><a href=https://lists.freebsd.org/ target=_blank>Mailing lists</a></li><li><a href=https://wiki.freebsd.org/IRC/Channels target=_blank>IRC Channels</a></li><li><a href=https://bugs.freebsd.org/bugzilla/ target=_blank>Bug Tracker</a></li><li><a href=https://www.freebsd.org/support/ target=_blank>Support</a></li></ul></li></ul></nav><div class=search-donate-container><form class=search method=get id=search-header-form action=https://docs.freebsd.org/search name=search-header-form><input type=hidden name=DB value=zh-tw>
<input id=words name=P type=text size=20 maxlength=255>
<button>
<i class="fa fa-search" aria-hidden=true></i></button></form><div class=donate><a href=https://freebsdfoundation.org/donate/ target=_blank><span class=heart>♥</span>
Donate</a></div></div></div></header><input type=checkbox class="hidden toggle" id=menu-control><main class=main-wrapper-book><a id=top></a><aside class=book-menu><div class=book-menu-content><input id=search-book type=text placeholder=Search aria-label=Search maxlength=128><nav id=MenuContents><ul><li><input type=checkbox id=chapter-c934186a5adac4f64b993f751abed30c class=toggle>
<label for=chapter-c934186a5adac4f64b993f751abed30c><a role=button></a></label><a href=https://docs.freebsd.org/zh-tw/books/porters-handbook/porting-why/>章 1. 楔子</a></li><li><input type=checkbox id=chapter-2798d78fe854f2709bab5ca473b97050 class=toggle>
<label for=chapter-2798d78fe854f2709bab5ca473b97050><a role=button></a></label><a href=https://docs.freebsd.org/zh-tw/books/porters-handbook/new-port/>章 2. 製作新的 Port</a></li><li><input type=checkbox id=chapter-c0d52b9121b517084e01f59cefa725e1 class=toggle>
<label class="icon cursor" for=chapter-c0d52b9121b517084e01f59cefa725e1><a role=button></a></label><a href=https://docs.freebsd.org/zh-tw/books/porters-handbook/quick-porting/>章 3. 打造 Port 快速上手篇</a><ul><li><a href=https://docs.freebsd.org/zh-tw/books/porters-handbook/quick-porting/#porting-makefile>3.1. 編寫 <span class=filename>Makefile</span></a></li><li><a href=https://docs.freebsd.org/zh-tw/books/porters-handbook/quick-porting/#porting-desc>3.2. 撰寫說明檔</a></li><li><a href=https://docs.freebsd.org/zh-tw/books/porters-handbook/quick-porting/#porting-checksum>3.3. 產生 checksum 檔</a></li><li><a href=https://docs.freebsd.org/zh-tw/books/porters-handbook/quick-porting/#porting-testing>3.4. 測試 Port</a></li><li><a href=https://docs.freebsd.org/zh-tw/books/porters-handbook/quick-porting/#porting-portlint>3.5. 以 <code>portlint</code> 來作檢查 Port</a></li><li><a href=https://docs.freebsd.org/zh-tw/books/porters-handbook/quick-porting/#porting-submitting>3.6. 提交新的 Port</a></li></ul></li><li><input type=checkbox id=chapter-3694de03923da61ba10a0a25efca6ef0 class=toggle>
<label class="icon cursor" for=chapter-3694de03923da61ba10a0a25efca6ef0><a role=button></a></label><a href=https://docs.freebsd.org/zh-tw/books/porters-handbook/slow-porting/>章 4. Slow Porting</a><ul><li><a href=https://docs.freebsd.org/zh-tw/books/porters-handbook/slow-porting/#slow-work>4.1. How Things Work</a></li><li><a href=https://docs.freebsd.org/zh-tw/books/porters-handbook/slow-porting/#slow-sources>4.2. 取得原始碼</a></li><li><a href=https://docs.freebsd.org/zh-tw/books/porters-handbook/slow-porting/#slow-modifying>4.3. Modifying the Port</a></li><li><a href=https://docs.freebsd.org/zh-tw/books/porters-handbook/slow-porting/#slow-patch>4.4. Patching</a></li><li><a href=https://docs.freebsd.org/zh-tw/books/porters-handbook/slow-porting/#slow-configure>4.5. 設定</a></li><li><a href=https://docs.freebsd.org/zh-tw/books/porters-handbook/slow-porting/#slow-user-input>4.6. 處理使用者輸入</a></li></ul></li><li><input type=checkbox id=chapter-165f6a6dba6651f8c25fc63ab83d6538 class=toggle>
<label class="icon cursor" for=chapter-165f6a6dba6651f8c25fc63ab83d6538><a role=button></a></label><a href=https://docs.freebsd.org/zh-tw/books/porters-handbook/makefiles/>Chapter 5. Configuring the Makefile</a><ul><li><a href=https://docs.freebsd.org/zh-tw/books/porters-handbook/makefiles/#makefile-source>5.1. The Original Source</a></li><li><a href=https://docs.freebsd.org/zh-tw/books/porters-handbook/makefiles/#makefile-naming>5.2. Naming</a></li><li><a href=https://docs.freebsd.org/zh-tw/books/porters-handbook/makefiles/#makefile-categories>5.3. Categorization</a></li><li><a href=https://docs.freebsd.org/zh-tw/books/porters-handbook/makefiles/#makefile-distfiles>5.4. The Distribution Files</a></li><li><a href=https://docs.freebsd.org/zh-tw/books/porters-handbook/makefiles/#makefile-maintainer>5.5. <code>MAINTAINER</code></a></li><li><a href=https://docs.freebsd.org/zh-tw/books/porters-handbook/makefiles/#makefile-comment>5.6. <code>COMMENT</code></a></li><li><a href=https://docs.freebsd.org/zh-tw/books/porters-handbook/makefiles/#licenses>5.7. Licenses</a></li><li><a href=https://docs.freebsd.org/zh-tw/books/porters-handbook/makefiles/#makefile-portscout>5.8. <code>PORTSCOUT</code></a></li><li><a href=https://docs.freebsd.org/zh-tw/books/porters-handbook/makefiles/#makefile-depend>5.9. Dependencies</a></li><li><a href=https://docs.freebsd.org/zh-tw/books/porters-handbook/makefiles/#makefile-masterdir>5.10. Slave Ports and <code>MASTERDIR</code></a></li><li><a href=https://docs.freebsd.org/zh-tw/books/porters-handbook/makefiles/#makefile-manpages>5.11. Man Pages</a></li><li><a href=https://docs.freebsd.org/zh-tw/books/porters-handbook/makefiles/#makefile-info>5.12. Info Files</a></li><li><a href=https://docs.freebsd.org/zh-tw/books/porters-handbook/makefiles/#makefile-options>5.13. Makefile Options</a></li><li><a href=https://docs.freebsd.org/zh-tw/books/porters-handbook/makefiles/#makefile-wrkdir>5.14. Specifying the Working Directory</a></li><li><a href=https://docs.freebsd.org/zh-tw/books/porters-handbook/makefiles/#conflicts>5.15. Conflict Handling</a></li><li><a href=https://docs.freebsd.org/zh-tw/books/porters-handbook/makefiles/#install>5.16. Installing Files</a></li><li><a href=https://docs.freebsd.org/zh-tw/books/porters-handbook/makefiles/#binary-alias>5.17. Use <code>BINARY_ALIAS</code> to Rename Commands Instead of Patching the Build</a></li></ul></li><li><input type=checkbox id=chapter-19e3150e00beb84341d8ac1a73936ef0 class=toggle>
<label class="icon cursor" for=chapter-19e3150e00beb84341d8ac1a73936ef0><a role=button></a></label><a href=https://docs.freebsd.org/zh-tw/books/porters-handbook/special/>Chapter 6. Special Considerations</a><ul><li><a href=https://docs.freebsd.org/zh-tw/books/porters-handbook/special/#staging>6.1. Staging</a></li><li><a href=https://docs.freebsd.org/zh-tw/books/porters-handbook/special/#bundled-libs>6.2. Bundled Libraries</a></li><li><a href=https://docs.freebsd.org/zh-tw/books/porters-handbook/special/#porting-shlibs>6.3. Shared Libraries</a></li><li><a href=https://docs.freebsd.org/zh-tw/books/porters-handbook/special/#porting-restrictions>6.4. Ports with Distribution Restrictions or Legal Concerns</a></li><li><a href=https://docs.freebsd.org/zh-tw/books/porters-handbook/special/#building>6.5. Building Mechanisms</a></li><li><a href=https://docs.freebsd.org/zh-tw/books/porters-handbook/special/#using-autotools>6.6. Using GNU Autotools</a></li><li><a href=https://docs.freebsd.org/zh-tw/books/porters-handbook/special/#using-gettext>6.7. Using GNU <code>gettext</code></a></li><li><a href=https://docs.freebsd.org/zh-tw/books/porters-handbook/special/#using-perl>6.8. Using Perl</a></li><li><a href=https://docs.freebsd.org/zh-tw/books/porters-handbook/special/#using-x11>6.9. Using X11</a></li><li><a href=https://docs.freebsd.org/zh-tw/books/porters-handbook/special/#using-gnome>6.10. Using GNOME</a></li><li><a href=https://docs.freebsd.org/zh-tw/books/porters-handbook/special/#gnome-components>6.11. GNOME Components</a></li><li><a href=https://docs.freebsd.org/zh-tw/books/porters-handbook/special/#using-qt>6.12. Using Qt</a></li><li><a href=https://docs.freebsd.org/zh-tw/books/porters-handbook/special/#using-kde>6.13. Using KDE</a></li><li><a href=https://docs.freebsd.org/zh-tw/books/porters-handbook/special/#using-lxqt>6.14. Using LXQt</a></li><li><a href=https://docs.freebsd.org/zh-tw/books/porters-handbook/special/#using-java>6.15. Using Java</a></li><li><a href=https://docs.freebsd.org/zh-tw/books/porters-handbook/special/#using-php>6.16. Web Applications, Apache and PHP</a></li><li><a href=https://docs.freebsd.org/zh-tw/books/porters-handbook/special/#using-python>6.17. Using Python</a></li><li><a href=https://docs.freebsd.org/zh-tw/books/porters-handbook/special/#using-tcl>6.18. Using Tcl/Tk</a></li><li><a href=https://docs.freebsd.org/zh-tw/books/porters-handbook/special/#using-ruby>6.19. Using Ruby</a></li><li><a href=https://docs.freebsd.org/zh-tw/books/porters-handbook/special/#using-sdl>6.20. Using SDL</a></li><li><a href=https://docs.freebsd.org/zh-tw/books/porters-handbook/special/#using-wx>6.21. Using wxWidgets</a></li><li><a href=https://docs.freebsd.org/zh-tw/books/porters-handbook/special/#using-lua>6.22. Using Lua</a></li><li><a href=https://docs.freebsd.org/zh-tw/books/porters-handbook/special/#using-iconv>6.23. Using <code>iconv</code></a></li><li><a href=https://docs.freebsd.org/zh-tw/books/porters-handbook/special/#using-xfce>6.24. Using Xfce</a></li><li><a href=https://docs.freebsd.org/zh-tw/books/porters-handbook/special/#using-databases>6.25. Using Databases</a></li><li><a href=https://docs.freebsd.org/zh-tw/books/porters-handbook/special/#rc-scripts>6.26. Starting and Stopping Services (<code>rc</code> Scripts)</a></li><li><a href=https://docs.freebsd.org/zh-tw/books/porters-handbook/special/#users-and-groups>6.27. Adding Users and Groups</a></li><li><a href=https://docs.freebsd.org/zh-tw/books/porters-handbook/special/#requiring-kernel-sources>6.28. Ports That Rely on Kernel Sources</a></li><li><a href=https://docs.freebsd.org/zh-tw/books/porters-handbook/special/#go-libs>6.29. Go Libraries</a></li><li><a href=https://docs.freebsd.org/zh-tw/books/porters-handbook/special/#haskell-libs>6.30. Haskell Libraries</a></li><li><a href=https://docs.freebsd.org/zh-tw/books/porters-handbook/special/#shell-completion>6.31. Shell Completion Files</a></li></ul></li><li><input type=checkbox id=chapter-2a77b1fa0736427c336503055c700137 class=toggle>
<label class="icon cursor" for=chapter-2a77b1fa0736427c336503055c700137><a role=button></a></label><a href=https://docs.freebsd.org/zh-tw/books/porters-handbook/flavors/>Chapter 7. Flavors</a><ul><li><a href=https://docs.freebsd.org/zh-tw/books/porters-handbook/flavors/#flavors-intro>7.1. An Introduction to Flavors</a></li><li><a href=https://docs.freebsd.org/zh-tw/books/porters-handbook/flavors/#flavors-using>7.2. Using FLAVORS</a></li><li><a href=https://docs.freebsd.org/zh-tw/books/porters-handbook/flavors/#flavors-auto-php>7.3. <code>USES=php</code> and Flavors</a></li><li><a href=https://docs.freebsd.org/zh-tw/books/porters-handbook/flavors/#flavors-auto-python>7.4. <code>USES=python</code> and Flavors</a></li><li><a href=https://docs.freebsd.org/zh-tw/books/porters-handbook/flavors/#flavors-auto-lua>7.5. <code>USES=lua</code> and Flavors</a></li></ul></li><li><input type=checkbox id=chapter-154554011c772e1e6cc0108eef5e0b2b class=toggle>
<label class="icon cursor" for=chapter-154554011c772e1e6cc0108eef5e0b2b><a role=button></a></label><a href=https://docs.freebsd.org/zh-tw/books/porters-handbook/plist/>Chapter 8. Advanced pkg-plist Practices</a><ul><li><a href=https://docs.freebsd.org/zh-tw/books/porters-handbook/plist/#plist-sub>8.1. Changing pkg-plist Based on Make Variables</a></li><li><a href=https://docs.freebsd.org/zh-tw/books/porters-handbook/plist/#plist-cleaning>8.2. Empty Directories</a></li><li><a href=https://docs.freebsd.org/zh-tw/books/porters-handbook/plist/#plist-config>8.3. Configuration Files</a></li><li><a href=https://docs.freebsd.org/zh-tw/books/porters-handbook/plist/#plist-dynamic>8.4. Dynamic Versus Static Package List</a></li><li><a href=https://docs.freebsd.org/zh-tw/books/porters-handbook/plist/#plist-autoplist>8.5. Automated Package List Creation</a></li><li><a href=https://docs.freebsd.org/zh-tw/books/porters-handbook/plist/#plist-keywords>8.6. Expanding Package List with Keywords</a></li></ul></li><li><input type=checkbox id=chapter-5955b0791ccd51005b5bc5bebeec91e5 class=toggle>
<label class="icon cursor" for=chapter-5955b0791ccd51005b5bc5bebeec91e5><a role=button></a></label><a href=https://docs.freebsd.org/zh-tw/books/porters-handbook/pkg-files/>Chapter 9. pkg-*</a><ul><li><a href=https://docs.freebsd.org/zh-tw/books/porters-handbook/pkg-files/#porting-message>9.1. pkg-message</a></li><li><a href=https://docs.freebsd.org/zh-tw/books/porters-handbook/pkg-files/#pkg-install>9.2. pkg-install</a></li><li><a href=https://docs.freebsd.org/zh-tw/books/porters-handbook/pkg-files/#pkg-deinstall>9.3. pkg-deinstall</a></li><li><a href=https://docs.freebsd.org/zh-tw/books/porters-handbook/pkg-files/#pkg-names>9.4. Changing the Names of pkg-*</a></li><li><a href=https://docs.freebsd.org/zh-tw/books/porters-handbook/pkg-files/#using-sub-files>9.5. Making Use of <code>SUB_FILES</code> and <code>SUB_LIST</code></a></li></ul></li><li><input type=checkbox id=chapter-ee86a11caedb6395ed82b94ec7a9c6cd class=toggle>
<label class="icon cursor" for=chapter-ee86a11caedb6395ed82b94ec7a9c6cd><a role=button></a></label><a href=https://docs.freebsd.org/zh-tw/books/porters-handbook/testing/>Chapter 10. Testing the Port</a><ul><li><a href=https://docs.freebsd.org/zh-tw/books/porters-handbook/testing/#make-describe>10.1. Running <code>make describe</code></a></li><li><a href=https://docs.freebsd.org/zh-tw/books/porters-handbook/testing/#testing-portclippy>10.2. Portclippy / Portfmt</a></li><li><a href=https://docs.freebsd.org/zh-tw/books/porters-handbook/testing/#testing-portlint>10.3. Portlint</a></li><li><a href=https://docs.freebsd.org/zh-tw/books/porters-handbook/testing/#testing-porttools>10.4. Port Tools</a></li><li><a href=https://docs.freebsd.org/zh-tw/books/porters-handbook/testing/#porting-prefix>10.5. <code>PREFIX</code> and <code>DESTDIR</code></a></li><li><a href=https://docs.freebsd.org/zh-tw/books/porters-handbook/testing/#testing-poudriere>10.6. Poudriere</a></li></ul></li><li><input type=checkbox id=chapter-4ccaefe2590c044ca2b79c46e79fe17f class=toggle>
<label class="icon cursor" for=chapter-4ccaefe2590c044ca2b79c46e79fe17f><a role=button></a></label><a href=https://docs.freebsd.org/zh-tw/books/porters-handbook/upgrading/>Chapter 11. Upgrading a Port</a><ul><li><a href=https://docs.freebsd.org/zh-tw/books/porters-handbook/upgrading/#git-diff>11.1. Using Git to Make Patches</a></li><li><a href=https://docs.freebsd.org/zh-tw/books/porters-handbook/upgrading/#moved-and-updating-files>11.2. UPDATING and MOVED</a></li></ul></li><li><input type=checkbox id=chapter-1023911bc0041506653280b832dea3b2 class=toggle>
<label class="icon cursor" for=chapter-1023911bc0041506653280b832dea3b2><a role=button></a></label><a href=https://docs.freebsd.org/zh-tw/books/porters-handbook/security/>Chapter 12. Security</a><ul><li><a href=https://docs.freebsd.org/zh-tw/books/porters-handbook/security/#security-intro>12.1. Why Security is So Important</a></li><li><a href=https://docs.freebsd.org/zh-tw/books/porters-handbook/security/#security-fix>12.2. Fixing Security Vulnerabilities</a></li><li><a href=https://docs.freebsd.org/zh-tw/books/porters-handbook/security/#security-notify>12.3. Keeping the Community Informed</a></li></ul></li><li><input type=checkbox id=chapter-9a8875d5d59aa92f1e5a78e9ecd1fbe7 class=toggle checked>
<label class="icon cursor" for=chapter-9a8875d5d59aa92f1e5a78e9ecd1fbe7><a role=button></a></label><a href=https://docs.freebsd.org/zh-tw/books/porters-handbook/porting-dads/>Chapter 13. Dos and Don'ts</a><ul><li><a href=https://docs.freebsd.org/zh-tw/books/porters-handbook/porting-dads/#dads-intro>13.1. Introduction</a></li><li><a href=https://docs.freebsd.org/zh-tw/books/porters-handbook/porting-dads/#porting-wrkdir>13.2. <code>WRKDIR</code></a></li><li><a href=https://docs.freebsd.org/zh-tw/books/porters-handbook/porting-dads/#porting-wrkdirprefix>13.3. <code>WRKDIRPREFIX</code></a></li><li><a href=https://docs.freebsd.org/zh-tw/books/porters-handbook/porting-dads/#porting-versions>13.4. Differentiating Operating Systems and OS Versions</a></li><li><a href=https://docs.freebsd.org/zh-tw/books/porters-handbook/porting-dads/#dads-after-port-mk>13.5. Writing Something After bsd.port.mk</a></li><li><a href=https://docs.freebsd.org/zh-tw/books/porters-handbook/porting-dads/#dads-sh-exec>13.6. Use the <code>exec</code> Statement in Wrapper Scripts</a></li><li><a href=https://docs.freebsd.org/zh-tw/books/porters-handbook/porting-dads/#dads-rational>13.7. Do Things Rationally</a></li><li><a href=https://docs.freebsd.org/zh-tw/books/porters-handbook/porting-dads/#dads-cc>13.8. Respect Both <code>CC</code> and <code>CXX</code></a></li><li><a href=https://docs.freebsd.org/zh-tw/books/porters-handbook/porting-dads/#dads-cflags>13.9. Respect <code>CFLAGS</code></a></li><li><a href=https://docs.freebsd.org/zh-tw/books/porters-handbook/porting-dads/#dads-verbose-logs>13.10. Verbose Build Logs</a></li><li><a href=https://docs.freebsd.org/zh-tw/books/porters-handbook/porting-dads/#dads-feedback>13.11. Feedback</a></li><li><a href=https://docs.freebsd.org/zh-tw/books/porters-handbook/porting-dads/#dads-readme>13.12. README.html</a></li><li><a href=https://docs.freebsd.org/zh-tw/books/porters-handbook/porting-dads/#dads-noinstall>13.13. Marking a Port Not Installable with <code>BROKEN</code>, <code>FORBIDDEN</code>, or <code>IGNORE</code></a></li><li><a href=https://docs.freebsd.org/zh-tw/books/porters-handbook/porting-dads/#dads-arch>13.14. Architectural Considerations</a></li><li><a href=https://docs.freebsd.org/zh-tw/books/porters-handbook/porting-dads/#dads-deprecated>13.15. Marking a Port for Removal with <code>DEPRECATED</code> or <code>EXPIRATION_DATE</code></a></li><li><a href=https://docs.freebsd.org/zh-tw/books/porters-handbook/porting-dads/#dads-dot-error>13.16. Avoid Use of the <code>.error</code> Construct</a></li><li><a href=https://docs.freebsd.org/zh-tw/books/porters-handbook/porting-dads/#dads-sysctl>13.17. Usage of sysctl</a></li><li><a href=https://docs.freebsd.org/zh-tw/books/porters-handbook/porting-dads/#dads-rerolling-distfiles>13.18. Rerolling Distfiles</a></li><li><a href=https://docs.freebsd.org/zh-tw/books/porters-handbook/porting-dads/#dads-use-posix-standards>13.19. Use POSIX Standards</a></li><li><a href=https://docs.freebsd.org/zh-tw/books/porters-handbook/porting-dads/#dads-misc>13.20. Miscellanea</a></li></ul></li><li><input type=checkbox id=chapter-5ef4c4c471a3f55c74fb71881f9d8713 class=toggle>
<label for=chapter-5ef4c4c471a3f55c74fb71881f9d8713><a role=button></a></label><a href=https://docs.freebsd.org/zh-tw/books/porters-handbook/porting-samplem/>Chapter 14. A Sample Makefile</a></li><li><input type=checkbox id=chapter-15c16456ccd7b4dc2a25fa8defa336a1 class=toggle>
<label class="icon cursor" for=chapter-15c16456ccd7b4dc2a25fa8defa336a1><a role=button></a></label><a href=https://docs.freebsd.org/zh-tw/books/porters-handbook/order/>Chapter 15. Order of Variables in Port Makefiles</a><ul><li><a href=https://docs.freebsd.org/zh-tw/books/porters-handbook/order/#porting-order-portname>15.1. <code>PORTNAME</code> Block</a></li><li><a href=https://docs.freebsd.org/zh-tw/books/porters-handbook/order/#porting-order-patch>15.2. <code>PATCHFILES</code> Block</a></li><li><a href=https://docs.freebsd.org/zh-tw/books/porters-handbook/order/#porting-order-maintainer>15.3. <code>MAINTAINER</code> Block</a></li><li><a href=https://docs.freebsd.org/zh-tw/books/porters-handbook/order/#porting-order-license>15.4. <code>LICENSE</code> Block</a></li><li><a href=https://docs.freebsd.org/zh-tw/books/porters-handbook/order/#porting-order-broken>15.5. Generic <code>BROKEN</code>/<code>IGNORE</code>/<code>DEPRECATED</code> Messages</a></li><li><a href=https://docs.freebsd.org/zh-tw/books/porters-handbook/order/#porting-order-depends>15.6. The Dependencies Block</a></li><li><a href=https://docs.freebsd.org/zh-tw/books/porters-handbook/order/#porting-order-flavors>15.7. Flavors</a></li><li><a href=https://docs.freebsd.org/zh-tw/books/porters-handbook/order/#porting-order-uses>15.8. <code>USES</code> and <code>USE_x</code></a></li><li><a href=https://docs.freebsd.org/zh-tw/books/porters-handbook/order/#porting-order-variables>15.9. Standard bsd.port.mk Variables</a></li><li><a href=https://docs.freebsd.org/zh-tw/books/porters-handbook/order/#porting-order-options>15.10. Options and Helpers</a></li><li><a href=https://docs.freebsd.org/zh-tw/books/porters-handbook/order/#porting-order-rest>15.11. The Rest of the Variables</a></li><li><a href=https://docs.freebsd.org/zh-tw/books/porters-handbook/order/#porting-order-targets>15.12. The Targets</a></li></ul></li><li><input type=checkbox id=chapter-70f5a4755700a24529175d26e65871bf class=toggle>
<label class="icon cursor" for=chapter-70f5a4755700a24529175d26e65871bf><a role=button></a></label><a href=https://docs.freebsd.org/zh-tw/books/porters-handbook/keeping-up/>Chapter 16. Keeping Up</a><ul><li><a href=https://docs.freebsd.org/zh-tw/books/porters-handbook/keeping-up/#freshports>16.1. FreshPorts</a></li><li><a href=https://docs.freebsd.org/zh-tw/books/porters-handbook/keeping-up/#cgit>16.2. The Web Interface to the Source Repository</a></li><li><a href=https://docs.freebsd.org/zh-tw/books/porters-handbook/keeping-up/#ports-mailing-list>16.3. The FreeBSD Ports Mailing List</a></li><li><a href=https://docs.freebsd.org/zh-tw/books/porters-handbook/keeping-up/#build-cluster>16.4. The FreeBSD Port Building Cluster</a></li><li><a href=https://docs.freebsd.org/zh-tw/books/porters-handbook/keeping-up/#distfile-survey>16.5. Portscout: the FreeBSD Ports Distfile Scanner</a></li><li><a href=https://docs.freebsd.org/zh-tw/books/porters-handbook/keeping-up/#portsmon>16.6. The FreeBSD Ports Monitoring System</a></li></ul></li><li><input type=checkbox id=chapter-8225273087f0e195be28132f4b5a0562 class=toggle>
<label class="icon cursor" for=chapter-8225273087f0e195be28132f4b5a0562><a role=button></a></label><a href=https://docs.freebsd.org/zh-tw/books/porters-handbook/uses/>Chapter 17. Using USES Macros</a><ul><li><a href=https://docs.freebsd.org/zh-tw/books/porters-handbook/uses/#uses-intro>17.1. An Introduction to <code>USES</code></a></li><li><a href=https://docs.freebsd.org/zh-tw/books/porters-handbook/uses/#uses-7z>17.2. <code>7z</code></a></li><li><a href=https://docs.freebsd.org/zh-tw/books/porters-handbook/uses/#uses-ada>17.3. <code>ada</code></a></li><li><a href=https://docs.freebsd.org/zh-tw/books/porters-handbook/uses/#uses-autoreconf>17.4. <code>autoreconf</code></a></li><li><a href=https://docs.freebsd.org/zh-tw/books/porters-handbook/uses/#uses-blaslapack>17.5. <code>blaslapack</code></a></li><li><a href=https://docs.freebsd.org/zh-tw/books/porters-handbook/uses/#uses-bdb>17.6. <code>bdb</code></a></li><li><a href=https://docs.freebsd.org/zh-tw/books/porters-handbook/uses/#uses-bison>17.7. <code>bison</code></a></li><li><a href=https://docs.freebsd.org/zh-tw/books/porters-handbook/uses/#uses-cabal>17.8. <code>cabal</code></a></li><li><a href=https://docs.freebsd.org/zh-tw/books/porters-handbook/uses/#uses-cargo>17.9. <code>cargo</code></a></li><li><a href=https://docs.freebsd.org/zh-tw/books/porters-handbook/uses/#uses-charsetfix>17.10. <code>charsetfix</code></a></li><li><a href=https://docs.freebsd.org/zh-tw/books/porters-handbook/uses/#uses-cmake>17.11. <code>cmake</code></a></li><li><a href=https://docs.freebsd.org/zh-tw/books/porters-handbook/uses/#uses-compiler>17.12. <code>compiler</code></a></li><li><a href=https://docs.freebsd.org/zh-tw/books/porters-handbook/uses/#uses-cpe>17.13. <code>cpe</code></a></li><li><a href=https://docs.freebsd.org/zh-tw/books/porters-handbook/uses/#uses-cran>17.14. <code>cran</code></a></li><li><a href=https://docs.freebsd.org/zh-tw/books/porters-handbook/uses/#uses-desktop-file-utils>17.15. <code>desktop-file-utils</code></a></li><li><a href=https://docs.freebsd.org/zh-tw/books/porters-handbook/uses/#uses-desthack>17.16. <code>desthack</code></a></li><li><a href=https://docs.freebsd.org/zh-tw/books/porters-handbook/uses/#uses-display>17.17. <code>display</code></a></li><li><a href=https://docs.freebsd.org/zh-tw/books/porters-handbook/uses/#uses-dos2unix>17.18. <code>dos2unix</code></a></li><li><a href=https://docs.freebsd.org/zh-tw/books/porters-handbook/uses/#uses-drupal>17.19. <code>drupal</code></a></li><li><a href=https://docs.freebsd.org/zh-tw/books/porters-handbook/uses/#uses-eigen>17.20. <code>eigen</code></a></li><li><a href=https://docs.freebsd.org/zh-tw/books/porters-handbook/uses/#uses-fakeroot>17.21. <code>fakeroot</code></a></li><li><a href=https://docs.freebsd.org/zh-tw/books/porters-handbook/uses/#uses-fam>17.22. <code>fam</code></a></li><li><a href=https://docs.freebsd.org/zh-tw/books/porters-handbook/uses/#uses-firebird>17.23. <code>firebird</code></a></li><li><a href=https://docs.freebsd.org/zh-tw/books/porters-handbook/uses/#uses-fonts>17.24. <code>fonts</code></a></li><li><a href=https://docs.freebsd.org/zh-tw/books/porters-handbook/uses/#uses-fortran>17.25. <code>fortran</code></a></li><li><a href=https://docs.freebsd.org/zh-tw/books/porters-handbook/uses/#uses-fuse>17.26. <code>fuse</code></a></li><li><a href=https://docs.freebsd.org/zh-tw/books/porters-handbook/uses/#uses-gem>17.27. <code>gem</code></a></li><li><a href=https://docs.freebsd.org/zh-tw/books/porters-handbook/uses/#uses-gettext>17.28. <code>gettext</code></a></li><li><a href=https://docs.freebsd.org/zh-tw/books/porters-handbook/uses/#uses-gettext-runtime>17.29. <code>gettext-runtime</code></a></li><li><a href=https://docs.freebsd.org/zh-tw/books/porters-handbook/uses/#uses-gettext-tools>17.30. <code>gettext-tools</code></a></li><li><a href=https://docs.freebsd.org/zh-tw/books/porters-handbook/uses/#uses-ghostscript>17.31. <code>ghostscript</code></a></li><li><a href=https://docs.freebsd.org/zh-tw/books/porters-handbook/uses/#uses-gl>17.32. <code>gl</code></a></li><li><a href=https://docs.freebsd.org/zh-tw/books/porters-handbook/uses/#uses-gmake>17.33. <code>gmake</code></a></li><li><a href=https://docs.freebsd.org/zh-tw/books/porters-handbook/uses/#uses-gnome>17.34. <code>gnome</code></a></li><li><a href=https://docs.freebsd.org/zh-tw/books/porters-handbook/uses/#uses-go>17.35. <code>go</code></a></li><li><a href=https://docs.freebsd.org/zh-tw/books/porters-handbook/uses/#uses-gperf>17.36. <code>gperf</code></a></li><li><a href=https://docs.freebsd.org/zh-tw/books/porters-handbook/uses/#uses-grantlee>17.37. <code>grantlee</code></a></li><li><a href=https://docs.freebsd.org/zh-tw/books/porters-handbook/uses/#uses-groff>17.38. <code>groff</code></a></li><li><a href=https://docs.freebsd.org/zh-tw/books/porters-handbook/uses/#uses-gssapi>17.39. <code>gssapi</code></a></li><li><a href=https://docs.freebsd.org/zh-tw/books/porters-handbook/uses/#uses-horde>17.40. <code>horde</code></a></li><li><a href=https://docs.freebsd.org/zh-tw/books/porters-handbook/uses/#uses-iconv>17.41. <code>iconv</code></a></li><li><a href=https://docs.freebsd.org/zh-tw/books/porters-handbook/uses/#uses-imake>17.42. <code>imake</code></a></li><li><a href=https://docs.freebsd.org/zh-tw/books/porters-handbook/uses/#uses-kde>17.43. <code>kde</code></a></li><li><a href=https://docs.freebsd.org/zh-tw/books/porters-handbook/uses/#uses-kmod>17.44. <code>kmod</code></a></li><li><a href=https://docs.freebsd.org/zh-tw/books/porters-handbook/uses/#uses-lha>17.45. <code>lha</code></a></li><li><a href=https://docs.freebsd.org/zh-tw/books/porters-handbook/uses/#uses-libarchive>17.46. <code>libarchive</code></a></li><li><a href=https://docs.freebsd.org/zh-tw/books/porters-handbook/uses/#uses-libedit>17.47. <code>libedit</code></a></li><li><a href=https://docs.freebsd.org/zh-tw/books/porters-handbook/uses/#uses-libtool>17.48. <code>libtool</code></a></li><li><a href=https://docs.freebsd.org/zh-tw/books/porters-handbook/uses/#uses-linux>17.49. <code>linux</code></a></li><li><a href=https://docs.freebsd.org/zh-tw/books/porters-handbook/uses/#uses-localbase>17.50. <code>localbase</code></a></li><li><a href=https://docs.freebsd.org/zh-tw/books/porters-handbook/uses/#uses-lua>17.51. <code>lua</code></a></li><li><a href=https://docs.freebsd.org/zh-tw/books/porters-handbook/uses/#uses-lxqt>17.52. <code>lxqt</code></a></li><li><a href=https://docs.freebsd.org/zh-tw/books/porters-handbook/uses/#uses-makeinfo>17.53. <code>makeinfo</code></a></li><li><a href=https://docs.freebsd.org/zh-tw/books/porters-handbook/uses/#uses-makeself>17.54. <code>makeself</code></a></li><li><a href=https://docs.freebsd.org/zh-tw/books/porters-handbook/uses/#uses-mate>17.55. <code>mate</code></a></li><li><a href=https://docs.freebsd.org/zh-tw/books/porters-handbook/uses/#uses-meson>17.56. <code>meson</code></a></li><li><a href=https://docs.freebsd.org/zh-tw/books/porters-handbook/uses/#uses-metaport>17.57. <code>metaport</code></a></li><li><a href=https://docs.freebsd.org/zh-tw/books/porters-handbook/uses/#uses-mysql>17.58. <code>mysql</code></a></li><li><a href=https://docs.freebsd.org/zh-tw/books/porters-handbook/uses/#uses-mono>17.59. <code>mono</code></a></li><li><a href=https://docs.freebsd.org/zh-tw/books/porters-handbook/uses/#uses-motif>17.60. <code>motif</code></a></li><li><a href=https://docs.freebsd.org/zh-tw/books/porters-handbook/uses/#uses-ncurses>17.61. <code>ncurses</code></a></li><li><a href=https://docs.freebsd.org/zh-tw/books/porters-handbook/uses/#uses-ninja>17.62. <code>ninja</code></a></li><li><a href=https://docs.freebsd.org/zh-tw/books/porters-handbook/uses/#uses-objc>17.63. <code>objc</code></a></li><li><a href=https://docs.freebsd.org/zh-tw/books/porters-handbook/uses/#uses-openal>17.64. <code>openal</code></a></li><li><a href=https://docs.freebsd.org/zh-tw/books/porters-handbook/uses/#uses-pathfix>17.65. <code>pathfix</code></a></li><li><a href=https://docs.freebsd.org/zh-tw/books/porters-handbook/uses/#uses-pear>17.66. <code>pear</code></a></li><li><a href=https://docs.freebsd.org/zh-tw/books/porters-handbook/uses/#uses-perl5>17.67. <code>perl5</code></a></li><li><a href=https://docs.freebsd.org/zh-tw/books/porters-handbook/uses/#uses-pgsql>17.68. <code>pgsql</code></a></li><li><a href=https://docs.freebsd.org/zh-tw/books/porters-handbook/uses/#uses-php>17.69. <code>php</code></a></li><li><a href=https://docs.freebsd.org/zh-tw/books/porters-handbook/uses/#uses-pkgconfig>17.70. <code>pkgconfig</code></a></li><li><a href=https://docs.freebsd.org/zh-tw/books/porters-handbook/uses/#uses-pure>17.71. <code>pure</code></a></li><li><a href=https://docs.freebsd.org/zh-tw/books/porters-handbook/uses/#uses-pyqt>17.72. <code>pyqt</code></a></li><li><a href=https://docs.freebsd.org/zh-tw/books/porters-handbook/uses/#uses-python>17.73. <code>python</code></a></li><li><a href=https://docs.freebsd.org/zh-tw/books/porters-handbook/uses/#uses-qmail>17.74. <code>qmail</code></a></li><li><a href=https://docs.freebsd.org/zh-tw/books/porters-handbook/uses/#uses-qmake>17.75. <code>qmake</code></a></li><li><a href=https://docs.freebsd.org/zh-tw/books/porters-handbook/uses/#uses-qt>17.76. <code>qt</code></a></li><li><a href=https://docs.freebsd.org/zh-tw/books/porters-handbook/uses/#uses-qt-dist>17.77. <code>qt-dist</code></a></li><li><a href=https://docs.freebsd.org/zh-tw/books/porters-handbook/uses/#uses-readline>17.78. <code>readline</code></a></li><li><a href=https://docs.freebsd.org/zh-tw/books/porters-handbook/uses/#uses-samba>17.79. <code>samba</code></a></li><li><a href=https://docs.freebsd.org/zh-tw/books/porters-handbook/uses/#uses-scons>17.80. <code>scons</code></a></li><li><a href=https://docs.freebsd.org/zh-tw/books/porters-handbook/uses/#uses-shared-mime-info>17.81. <code>shared-mime-info</code></a></li><li><a href=https://docs.freebsd.org/zh-tw/books/porters-handbook/uses/#uses-shebangfix>17.82. <code>shebangfix</code></a></li><li><a href=https://docs.freebsd.org/zh-tw/books/porters-handbook/uses/#uses-sqlite>17.83. <code>sqlite</code></a></li><li><a href=https://docs.freebsd.org/zh-tw/books/porters-handbook/uses/#uses-ssl>17.84. <code>ssl</code></a></li><li><a href=https://docs.freebsd.org/zh-tw/books/porters-handbook/uses/#uses-tar>17.85. <code>tar</code></a></li><li><a href=https://docs.freebsd.org/zh-tw/books/porters-handbook/uses/#uses-tcl>17.86. <code>tcl</code></a></li><li><a href=https://docs.freebsd.org/zh-tw/books/porters-handbook/uses/#uses-terminfo>17.87. <code>terminfo</code></a></li><li><a href=https://docs.freebsd.org/zh-tw/books/porters-handbook/uses/#uses-tk>17.88. <code>tk</code></a></li><li><a href=https://docs.freebsd.org/zh-tw/books/porters-handbook/uses/#uses-uidfix>17.89. <code>uidfix</code></a></li><li><a href=https://docs.freebsd.org/zh-tw/books/porters-handbook/uses/#uses-uniquefiles>17.90. <code>uniquefiles</code></a></li><li><a href=https://docs.freebsd.org/zh-tw/books/porters-handbook/uses/#uses-varnish>17.91. <code>varnish</code></a></li><li><a href=https://docs.freebsd.org/zh-tw/books/porters-handbook/uses/#uses-webplugin>17.92. <code>webplugin</code></a></li><li><a href=https://docs.freebsd.org/zh-tw/books/porters-handbook/uses/#uses-xfce>17.93. <code>xfce</code></a></li><li><a href=https://docs.freebsd.org/zh-tw/books/porters-handbook/uses/#uses-xorg>17.94. <code>xorg</code></a></li><li><a href=https://docs.freebsd.org/zh-tw/books/porters-handbook/uses/#uses-xorg-cat>17.95. <code>xorg-cat</code></a></li><li><a href=https://docs.freebsd.org/zh-tw/books/porters-handbook/uses/#uses-zip>17.96. <code>zip</code></a></li></ul></li><li><input type=checkbox id=chapter-7713ccc63287693c9be6c832b2c1e850 class=toggle>
<label class="icon cursor" for=chapter-7713ccc63287693c9be6c832b2c1e850><a role=button></a></label><a href=https://docs.freebsd.org/zh-tw/books/porters-handbook/versions/>Chapter 18. __FreeBSD_version Values</a><ul><li><a href=https://docs.freebsd.org/zh-tw/books/porters-handbook/versions/#versions-14>18.1. FreeBSD 14 Versions</a></li><li><a href=https://docs.freebsd.org/zh-tw/books/porters-handbook/versions/#versions-13>18.2. FreeBSD 13 Versions</a></li><li><a href=https://docs.freebsd.org/zh-tw/books/porters-handbook/versions/#versions-12>18.3. FreeBSD 12 Versions</a></li><li><a href=https://docs.freebsd.org/zh-tw/books/porters-handbook/versions/#versions-11>18.4. FreeBSD 11 Versions</a></li><li><a href=https://docs.freebsd.org/zh-tw/books/porters-handbook/versions/#versions-10>18.5. FreeBSD 10 Versions</a></li><li><a href=https://docs.freebsd.org/zh-tw/books/porters-handbook/versions/#versions-9>18.6. FreeBSD 9 Versions</a></li><li><a href=https://docs.freebsd.org/zh-tw/books/porters-handbook/versions/#versions-8>18.7. FreeBSD 8 Versions</a></li><li><a href=https://docs.freebsd.org/zh-tw/books/porters-handbook/versions/#versions-7>18.8. FreeBSD 7 Versions</a></li><li><a href=https://docs.freebsd.org/zh-tw/books/porters-handbook/versions/#versions-6>18.9. FreeBSD 6 Versions</a></li><li><a href=https://docs.freebsd.org/zh-tw/books/porters-handbook/versions/#versions-5>18.10. FreeBSD 5 Versions</a></li><li><a href=https://docs.freebsd.org/zh-tw/books/porters-handbook/versions/#versions-4>18.11. FreeBSD 4 Versions</a></li><li><a href=https://docs.freebsd.org/zh-tw/books/porters-handbook/versions/#versions-3>18.12. FreeBSD 3 Versions</a></li><li><a href=https://docs.freebsd.org/zh-tw/books/porters-handbook/versions/#versions-2.2>18.13. FreeBSD 2.2 Versions</a></li><li><a href=https://docs.freebsd.org/zh-tw/books/porters-handbook/versions/#versions-2>18.14. FreeBSD 2 Before 2.2-RELEASE Versions</a></li></ul></li><li></li></ul></nav></div></aside><div class=book><div class=book-menu-mobile><label for=menu-control><span class=menu-control-button><i class="fa fa-list" aria-hidden=true title="Book menu"></i>
Book menu</span></label></div><h1 class=title>Chapter 13. Dos and Don'ts</h1><div class="admonitionblock note"><p><i class="fa fa-exclamation-circle" aria-hidden=true></i>
This translation may be out of date. To help with the translations please access the <a href=https://translate-dev.freebsd.org/ target=_blank>FreeBSD translations instance</a>.</p></div><div class=toc-mobile><h3>目錄</h3><nav id=TableOfContents><ul><li><a href=#dads-intro>13.1. Introduction</a></li><li><a href=#porting-wrkdir>13.2. <code>WRKDIR</code></a></li><li><a href=#porting-wrkdirprefix>13.3. <code>WRKDIRPREFIX</code></a></li><li><a href=#porting-versions>13.4. Differentiating Operating Systems and OS Versions</a></li><li><a href=#dads-after-port-mk>13.5. Writing Something After bsd.port.mk</a></li><li><a href=#dads-sh-exec>13.6. Use the <code>exec</code> Statement in Wrapper Scripts</a></li><li><a href=#dads-rational>13.7. Do Things Rationally</a></li><li><a href=#dads-cc>13.8. Respect Both <code>CC</code> and <code>CXX</code></a></li><li><a href=#dads-cflags>13.9. Respect <code>CFLAGS</code></a></li><li><a href=#dads-verbose-logs>13.10. Verbose Build Logs</a></li><li><a href=#dads-feedback>13.11. Feedback</a></li><li><a href=#dads-readme>13.12. README.html</a></li><li><a href=#dads-noinstall>13.13. Marking a Port Not Installable with <code>BROKEN</code>, <code>FORBIDDEN</code>, or <code>IGNORE</code></a></li><li><a href=#dads-arch>13.14. Architectural Considerations</a></li><li><a href=#dads-deprecated>13.15. Marking a Port for Removal with <code>DEPRECATED</code> or <code>EXPIRATION_DATE</code></a></li><li><a href=#dads-dot-error>13.16. Avoid Use of the <code>.error</code> Construct</a></li><li><a href=#dads-sysctl>13.17. Usage of sysctl</a></li><li><a href=#dads-rerolling-distfiles>13.18. Rerolling Distfiles</a></li><li><a href=#dads-use-posix-standards>13.19. Use POSIX Standards</a></li><li><a href=#dads-misc>13.20. Miscellanea</a></li></ul></nav></div><div class=book-content><div id=preamble><div class=sectionbody></div></div><div class=sect1><h2 id=dads-intro>13.1. Introduction<a class=anchor href=#dads-intro></a></h2><div class=sectionbody><div class=paragraph><p>Here is a list of common dos and don’ts that are encountered during the porting process.
Check the port against this list, but also check ports in the <a href=https://bugs.FreeBSD.org/search/>PR database</a> that others have submitted.
Submit any comments on ports as described in <a href=https://docs.freebsd.org/zh-tw/articles/contributing/#CONTRIB-GENERAL>Bug Reports and General Commentary</a>.
Checking ports in the PR database will both make it faster for us to commit them, and prove that you know what you are doing.</p></div></div></div><div class=sect1><h2 id=porting-wrkdir>13.2. <code>WRKDIR</code><a class=anchor href=#porting-wrkdir></a></h2><div class=sectionbody><div class=paragraph><p>Do not write anything to files outside <code>WRKDIR</code>. <code>WRKDIR</code> is the only place that is guaranteed to be writable during the port build (see <a href=https://docs.freebsd.org/en/books/handbook/#PORTS-CD>installing ports from a CDROM</a> for an example of building ports from a read-only tree).
The <span class=filename>pkg-*</span> files can be modified by <a href=../pkg-files/#pkg-names>redefining a variable</a> rather than overwriting the file.</p></div></div></div><div class=sect1><h2 id=porting-wrkdirprefix>13.3. <code>WRKDIRPREFIX</code><a class=anchor href=#porting-wrkdirprefix></a></h2><div class=sectionbody><div class=paragraph><p>Make sure the port honors <code>WRKDIRPREFIX</code>.
Most ports do not have to worry about this.
In particular, when referring to a <code>WRKDIR</code> of another port, note that the correct location is <span class=filename>${WRKDIRPREFIX}${PORTSDIR}/subdir/name/work</span> not <span class=filename>${PORTSDIR}/subdir/name/work</span> or <span class=filename>${.CURDIR}/../../subdir/name/work</span> or some such.</p></div></div></div><div class=sect1><h2 id=porting-versions>13.4. Differentiating Operating Systems and OS Versions<a class=anchor href=#porting-versions></a></h2><div class=sectionbody><div class=paragraph><p>Some code needs modifications or conditional compilation based upon what version of FreeBSD Unix it is running under.
The preferred way to tell FreeBSD versions apart are the <code>__FreeBSD_version</code> and <code>__FreeBSD__</code> macros defined in <a href=https://cgit.freebsd.org/src/tree/sys/sys/param.h>sys/param.h</a>. If this file is not included add the code,</p></div><div class="literalblock programlisting"><div class=content><pre>#include &lt;sys/param.h&gt;</pre></div></div><div class=paragraph><p>to the proper place in the <span class=filename>.c</span> file.</p></div><div class=paragraph><p><code>__FreeBSD__</code> is defined in all versions of FreeBSD as their major version number.
For example, in FreeBSD 9.x, <code>__FreeBSD__</code> is defined to be <code>9</code>.</p></div><div class="literalblock programlisting"><div class=content><pre>#if __FreeBSD__ &gt;= 9
#  if __FreeBSD_version &gt;= 901000
	 /* 9.1+ release specific code here */
#  endif
#endif</pre></div></div><div class=paragraph><p>A complete list of <code>__FreeBSD_version</code> values is available in <a href=../versions/#versions>__FreeBSD_version Values</a>.</p></div></div></div><div class=sect1><h2 id=dads-after-port-mk>13.5. Writing Something After bsd.port.mk<a class=anchor href=#dads-after-port-mk></a></h2><div class=sectionbody><div class=paragraph><p>Do not write anything after the <code>.include &lt;bsd.port.mk></code> line.
It usually can be avoided by including <span class=filename>bsd.port.pre.mk</span> somewhere in the middle of the <span class=filename>Makefile</span> and <span class=filename>bsd.port.post.mk</span> at the end.</p></div><div class="admonitionblock important"><table><tbody><tr><td class=icon><i class="fa icon-important" title=Important></i></td><td class=content><div class=paragraph><p>Include either the <span class=filename>bsd.port.pre.mk</span>/<span class=filename>bsd.port.post.mk</span> pair or <span class=filename>bsd.port.mk</span> only; do not mix these two usages.</p></div></td></tr></tbody></table></div><div class=paragraph><p><span class=filename>bsd.port.pre.mk</span> only defines a few variables, which can be used in tests in the <span class=filename>Makefile</span>, <span class=filename>bsd.port.post.mk</span> defines the rest.</p></div><div class=paragraph><p>Here are some important variables defined in <span class=filename>bsd.port.pre.mk</span> (this is not the complete list, please read <span class=filename>bsd.port.mk</span> for the complete list).</p></div><table class="tableblock frame-none grid-all stretch informaltable"><col style=width:50%><col style=width:50%><thead><tr><th class="tableblock halign-left valign-top">Variable</th><th class="tableblock halign-left valign-top">Description</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>ARCH</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>The architecture as returned by <code>uname -m</code> (for example, <code>i386</code>)</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>OPSYS</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>The operating system type, as returned by <code>uname -s</code> (for example, <code>FreeBSD</code>)</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>OSREL</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>The release version of the operating system (for example, <code>2.1.5</code> or <code>2.2.7</code>)</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>OSVERSION</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>The numeric version of the operating system; the same as <a href=../versions/#versions><code>__FreeBSD_version</code></a>.</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>LOCALBASE</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>The base of the "local" tree (for example, <code>/usr/local</code>)</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>PREFIX</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Where the port installs itself (see <a href=../testing/#porting-prefix>more on <code>PREFIX</code></a>).</p></td></tr></tbody></table><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>When <code>MASTERDIR</code> is needed, always define it before including <span class=filename>bsd.port.pre.mk</span>.</p></div></td></tr></tbody></table></div><div class=paragraph><p>Here are some examples of things that can be added after <span class=filename>bsd.port.pre.mk</span>:</p></div><div class="literalblock programlisting"><div class=content><pre># no need to compile lang/perl5 if perl5 is already in system
.if ${OSVERSION} &gt; 300003
BROKEN=	perl is in system
.endif</pre></div></div><div class=paragraph><p>Always use tab instead of spaces after <code>BROKEN=</code>.</p></div></div></div><div class=sect1><h2 id=dads-sh-exec>13.6. Use the <code>exec</code> Statement in Wrapper Scripts<a class=anchor href=#dads-sh-exec></a></h2><div class=sectionbody><div class=paragraph><p>If the port installs a shell script whose purpose is to launch another program,
and if launching that program is the last action performed by the script,
make sure to launch the program using the <code>exec</code> statement, for instance:</p></div><div class="literalblock programlisting"><div class=content><pre>#!/bin/sh
exec %%LOCALBASE%%/bin/java -jar %%DATADIR%%/foo.jar &#34;$@&#34;</pre></div></div><div class=paragraph><p>The <code>exec</code> statement replaces the shell process with the specified program.
If <code>exec</code> is omitted, the shell process remains in memory while the program is executing,
and needlessly consumes system resources.</p></div></div></div><div class=sect1><h2 id=dads-rational>13.7. Do Things Rationally<a class=anchor href=#dads-rational></a></h2><div class=sectionbody><div class=paragraph><p>The <span class=filename>Makefile</span> should do things in a simple and reasonable manner.
Making it a couple of lines shorter or more readable is always better.
Examples include using a make <code>.if</code> construct instead of a shell <code>if</code> construct, not redefining <code>do-extract</code> if redefining <code>EXTRACT*</code> is enough, and using <code>GNU_CONFIGURE</code> instead of <code>CONFIGURE_ARGS += --prefix=${PREFIX}</code>.</p></div><div class=paragraph><p>If a lot of new code is needed to do something, there may already be an implementation of it in <span class=filename>bsd.port.mk</span>.
While hard to read, there are a great many seemingly-hard problems for which <span class=filename>bsd.port.mk</span> already provides a shorthand solution.</p></div></div></div><div class=sect1><h2 id=dads-cc>13.8. Respect Both <code>CC</code> and <code>CXX</code><a class=anchor href=#dads-cc></a></h2><div class=sectionbody><div class=paragraph><p>The port must respect both <code>CC</code> and <code>CXX</code>.
What we mean by this is that the port must not set the values of these variables absolutely, overriding existing values;
instead, it may append whatever values it needs to the existing values.
This is so that build options that affect all ports can be set globally.</p></div><div class=paragraph><p>If the port does not respect these variables, please add <code>NO_PACKAGE=ignores either cc or cxx</code> to the <span class=filename>Makefile</span>.</p></div><div class=paragraph><p>Here is an example of a <span class=filename>Makefile</span> respecting both <code>CC</code> and <code>CXX</code>.
Note the <code>?=</code>:</p></div><div class="literalblock programlisting"><div class=content><pre>CC?= gcc</pre></div></div><div class="literalblock programlisting"><div class=content><pre>CXX?= g++</pre></div></div><div class=paragraph><p>Here is an example which respects neither <code>CC</code> nor <code>CXX</code>:</p></div><div class="literalblock programlisting"><div class=content><pre>CC= gcc</pre></div></div><div class="literalblock programlisting"><div class=content><pre>CXX= g++</pre></div></div><div class=paragraph><p>Both <code>CC</code> and <code>CXX</code> can be defined on FreeBSD systems in <span class=filename>/etc/make.conf</span>.
The first example defines a value if it was not previously set in <span class=filename>/etc/make.conf</span>, preserving any system-wide definitions.
The second example clobbers anything previously defined.</p></div></div></div><div class=sect1><h2 id=dads-cflags>13.9. Respect <code>CFLAGS</code><a class=anchor href=#dads-cflags></a></h2><div class=sectionbody><div class=paragraph><p>The port must respect <code>CFLAGS</code>.
What we mean by this is that the port must not set the value of this variable absolutely, overriding the existing value.
Instead, it may append whatever values it needs to the existing value.
This is so that build options that affect all ports can be set globally.</p></div><div class=paragraph><p>If it does not, please add <code>NO_PACKAGE=ignores cflags</code> to the <span class=filename>Makefile</span>.</p></div><div class=paragraph><p>Here is an example of a <span class=filename>Makefile</span> respecting <code>CFLAGS</code>. Note the <code>+=</code>:</p></div><div class="literalblock programlisting"><div class=content><pre>CFLAGS+= -Wall -Werror</pre></div></div><div class=paragraph><p>Here is an example which does not respect <code>CFLAGS</code>:</p></div><div class="literalblock programlisting"><div class=content><pre>CFLAGS= -Wall -Werror</pre></div></div><div class=paragraph><p><code>CFLAGS</code> is defined on FreeBSD systems in <span class=filename>/etc/make.conf</span>.
The first example appends additional flags to <code>CFLAGS</code>, preserving any system-wide definitions.
The second example clobbers anything previously defined.</p></div><div class=paragraph><p>Remove optimization flags from the third party <span class=filename>Makefile</span>s.
The system <code>CFLAGS</code> contains system-wide optimization flags.
An example from an unmodified <span class=filename>Makefile</span>:</p></div><div class="literalblock programlisting"><div class=content><pre>CFLAGS= -O3 -funroll-loops -DHAVE_SOUND</pre></div></div><div class=paragraph><p>Using system optimization flags, the <span class=filename>Makefile</span> would look similar to this example:</p></div><div class="literalblock programlisting"><div class=content><pre>CFLAGS+= -DHAVE_SOUND</pre></div></div></div></div><div class=sect1><h2 id=dads-verbose-logs>13.10. Verbose Build Logs<a class=anchor href=#dads-verbose-logs></a></h2><div class=sectionbody><div class=paragraph><p>Make the port build system display all commands executed during the build stage.
Complete build logs are crucial to debugging port problems.</p></div><div class=paragraph><p>Non-informative build log example (bad):</p></div><div class="literalblock programlisting"><div class=content><pre>  CC     source1.o
  CC     source2.o
  CCLD   someprogram</pre></div></div><div class=paragraph><p>Verbose build log example (good):</p></div><div class="literalblock programlisting"><div class=content><pre>cc -O2 -pipe -I/usr/local/include -c -o source1.o source1.c
cc -O2 -pipe -I/usr/local/include -c -o source2.o source2.c
cc -o someprogram source1.o source2.o -L/usr/local/lib -lsomelib</pre></div></div><div class=paragraph><p>Some build systems such as CMake, ninja, and GNU configure are set up for verbose logging by the ports framework.
In other cases, ports might need individual tweaks.</p></div></div></div><div class=sect1><h2 id=dads-feedback>13.11. Feedback<a class=anchor href=#dads-feedback></a></h2><div class=sectionbody><div class=paragraph><p>Do send applicable changes and patches to the upstream maintainer for inclusion in the next release of the code.
This makes updating to the next release that much easier.</p></div></div></div><div class=sect1><h2 id=dads-readme>13.12. README.html<a class=anchor href=#dads-readme></a></h2><div class=sectionbody><div class=paragraph><p><span class=filename>README.html</span> is not part of the port, but generated by <code>make readme</code>.
Do not include this file in patches or commits.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>If <code>make readme</code> fails, make sure that the default value of <code>ECHO_MSG</code> has not been modified by the port.</p></div></td></tr></tbody></table></div></div></div><div class=sect1><h2 id=dads-noinstall>13.13. Marking a Port Not Installable with <code>BROKEN</code>, <code>FORBIDDEN</code>, or <code>IGNORE</code><a class=anchor href=#dads-noinstall></a></h2><div class=sectionbody><div class=paragraph><p>In certain cases, users must be prevented from installing a port.
There are several variables that can be used in a port’s <span class=filename>Makefile</span> to tell the user that the port cannot be installed.
The value of these make variables will be the reason that is shown to users for why the port refuses to install itself.
Please use the correct make variable.
Each variable conveys radically different meanings, both to users and to automated systems that depend on <span class=filename>Makefile</span>s, such as <a href=../keeping-up/#build-cluster>the ports build cluster</a>, <a href=../keeping-up/#freshports>FreshPorts</a>, and <a href=../keeping-up/#portsmon>portsmon</a>.</p></div><div class=sect2><h3 id=dads-noinstall-variables>13.13.1. Variables<a class=anchor href=#dads-noinstall-variables></a></h3><div class=ulist><ul><li><p><code>BROKEN</code> is reserved for ports that currently do not compile, install, deinstall, or run correctly. Use it for ports where the problem is believed to be temporary.</p><div class=paragraph><p>If instructed, the build cluster will still attempt to try to build them to see if the underlying problem has been resolved.
(However, in general, the cluster is run without this.)</p></div><div class=paragraph><p>For instance, use <code>BROKEN</code> when a port:</p></div><div class=ulist><ul><li><p>does not compile</p></li><li><p>fails its configuration or installation process</p></li><li><p>installs files outside of <span class=filename>${PREFIX}</span></p></li><li><p>does not remove all its files cleanly upon deinstall (however, it may be acceptable, and desirable, for the port to leave user-modified files behind)</p></li><li><p>has runtime issues on systems where it is supposed to run fine.</p></li></ul></div></li><li><p><code>FORBIDDEN</code> is used for ports that contain a security vulnerability or induce grave concern regarding the security of a FreeBSD system with a given port installed (for example, a reputably insecure program or a program that provides easily exploitable services). Mark ports as <code>FORBIDDEN</code> as soon as a particular piece of software has a vulnerability and there is no released upgrade. Ideally upgrade ports as soon as possible when a security vulnerability is discovered so as to reduce the number of vulnerable FreeBSD hosts (we like being known for being secure), however sometimes there is a noticeable time gap between disclosure of a vulnerability and an updated release of the vulnerable software. Do not mark a port <code>FORBIDDEN</code> for any reason other than security.</p></li><li><p><code>IGNORE</code> is reserved for ports that must not be built for some other reason. Use it for ports where the problem is believed to be structural. The build cluster will not, under any circumstances, build ports marked as <code>IGNORE</code>. For instance, use <code>IGNORE</code> when a port:</p><div class=ulist><ul><li><p>does not work on the installed version of FreeBSD</p></li><li><p>has a distfile which may not be automatically fetched due to licensing restrictions</p></li><li><p>does not work with some other currently installed port (for instance, the port depends on <a class=package href=https://cgit.freebsd.org/ports/tree/www/apache20/>www/apache20</a> but <a class=package href=https://cgit.freebsd.org/ports/tree/www/apache22/>www/apache22</a> is installed)</p><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>If a port would conflict with a currently installed port (for example, if they install a file in the same place that performs a different function), <a href=../makefiles/#conflicts>use <code>CONFLICTS</code> instead</a>.
<code>CONFLICTS</code> will set <code>IGNORE</code> by itself.</p></div></td></tr></tbody></table></div></li></ul></div></li></ul></div></div><div class=sect2><h3 id=dads-noinstall-notes>13.13.2. Implementation Notes<a class=anchor href=#dads-noinstall-notes></a></h3><div class=paragraph><p>Do not quote the values of <code>BROKEN</code>, <code>IGNORE</code>, and related variables.
Due to the way the information is shown to the user, the wording of messages for each variable differ:</p></div><div class="literalblock programlisting"><div class=content><pre>BROKEN=	fails to link with base -lcrypto</pre></div></div><div class="literalblock programlisting"><div class=content><pre>IGNORE=	unsupported on recent versions</pre></div></div><div class=paragraph><p>resulting in this output from <code>make describe</code>:</p></div><div class="literalblock programlisting"><div class=content><pre>===&gt;  foobar-0.1 is marked as broken: fails to link with base -lcrypto.</pre></div></div><div class="literalblock programlisting"><div class=content><pre>===&gt;  foobar-0.1 is unsupported on recent versions.</pre></div></div></div></div></div><div class=sect1><h2 id=dads-arch>13.14. Architectural Considerations<a class=anchor href=#dads-arch></a></h2><div class=sectionbody><div class=sect2><h3 id=dads-arch-general>13.14.1. General Notes on Architectures<a class=anchor href=#dads-arch-general></a></h3><div class=paragraph><p>FreeBSD runs on many more processor architectures than just the well-known x86-based ones.
Some ports have constraints which are particular to one or more of these architectures.</p></div><div class=paragraph><p>For the list of supported architectures, run:</p></div><div class="literalblock programlisting"><div class=content><pre>cd ${SRCDIR}; make targets</pre></div></div><div class=paragraph><p>The values are shown in the form <code>TARGET</code>/<code>TARGET_ARCH</code>.
The ports read-only makevar <code>ARCH</code> is set based on the value of <code>TARGET_ARCH</code>.
Port <span class=filename>Makefile</span>s should test the value of this Makevar.</p></div></div><div class=sect2><h3 id=dads-arch-neutral>13.14.2. Marking a Port as Architecture Neutral<a class=anchor href=#dads-arch-neutral></a></h3><div class=paragraph><p>Ports that do not have any architecture-dependent files or requirements are identified by setting <code>NO_ARCH=yes</code>.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p><code>NO_ARCH</code> is meant to indicate that there is no need to build a package for each of the supported architectures.
The goal is to reduce the amount of resources spent on building and distributing the packages such as network bandwidth and disk space on mirrors and on distribution media.
Currently, however, our package infrastructure (e.g., package managers, mirrors, and package builders) is not set up to fully benefit from <code>NO_ARCH</code>.</p></div></td></tr></tbody></table></div></div><div class=sect2><h3 id=dads-arch-ignore>13.14.3. Marking a Port as Ignored Only On Certain Architectures<a class=anchor href=#dads-arch-ignore></a></h3><div class=ulist><ul><li><p>To mark a port as <code>IGNORE</code>d only on certain architectures, there are two other convenience variables that will automatically set <code>IGNORE</code>: <code>ONLY_FOR_ARCHS</code> and <code>NOT_FOR_ARCHS</code>. Examples:</p><div class="literalblock programlisting"><div class=content><pre>ONLY_FOR_ARCHS=	i386 amd64</pre></div></div><div class="literalblock programlisting"><div class=content><pre>NOT_FOR_ARCHS=	ia64 sparc64</pre></div></div><div class=paragraph><p>A custom <code>IGNORE</code> message can be set using <code>ONLY_FOR_ARCHS_REASON</code> and <code>NOT_FOR_ARCHS_REASON</code>.
Per architecture entries are possible with <code>ONLY_FOR_ARCHS_REASON_ARCH</code> and <code>NOT_FOR_ARCHS_REASON_ARCH</code>.</p></div></li></ul></div><div id=dads-arch-i386 class=ulist><ul><li><p>If a port fetches i386 binaries and installs them, set <code>IA32_BINARY_PORT</code>. If this variable is set, <span class=filename>/usr/lib32</span> must be present for IA32 versions of libraries and the kernel must support IA32 compatibility. If one of these two dependencies is not satisfied, <code>IGNORE</code> will be set automatically.</p></li></ul></div></div><div class=sect2><h3 id=dads-arch-cluster>13.14.4. Cluster-Specific Considerations<a class=anchor href=#dads-arch-cluster></a></h3><div class=ulist><ul><li><p>Some ports attempt to tune themselves to the exact machine they are being built on by specifying <code>-march=native</code> to the compiler. This should be avoided: either list it under an off-by-default option, or delete it entirely.</p><div class=paragraph><p>Otherwise, the default package produced by the build cluster might not run on every single machine of that <code>ARCH</code>.</p></div></li></ul></div></div></div></div><div class=sect1><h2 id=dads-deprecated>13.15. Marking a Port for Removal with <code>DEPRECATED</code> or <code>EXPIRATION_DATE</code><a class=anchor href=#dads-deprecated></a></h2><div class=sectionbody><div class=paragraph><p>Do remember that <code>BROKEN</code> and <code>FORBIDDEN</code> are to be used as a temporary resort if a port is not working.
Permanently broken ports will be removed from the tree entirely.</p></div><div class=paragraph><p>When it makes sense to do so, users can be warned about a pending port removal with <code>DEPRECATED</code> and <code>EXPIRATION_DATE</code>.
The former is a string stating why the port is scheduled for removal; the latter is a string in ISO 8601 format (YYYY-MM-DD).
Both will be shown to the user.</p></div><div class=paragraph><p>It is possible to set <code>DEPRECATED</code> without an <code>EXPIRATION_DATE</code> (for instance, recommending a newer version of the port), but the converse does not make any sense.</p></div><div class=paragraph><p>There is no set policy on how much notice to give.
Current practice seems to be one month for security-related issues and two months for build issues.
This also gives any interested committers a little time to fix the problems.</p></div></div></div><div class=sect1><h2 id=dads-dot-error>13.16. Avoid Use of the <code>.error</code> Construct<a class=anchor href=#dads-dot-error></a></h2><div class=sectionbody><div class=paragraph><p>The correct way for a <span class=filename>Makefile</span> to signal that the port cannot be installed due to some external factor (for instance, the user has specified an illegal combination of build options) is to set a non-blank value to <code>IGNORE</code>.
This value will be formatted and shown to the user by <code>make install</code>.</p></div><div class=paragraph><p>It is a common mistake to use <code>.error</code> for this purpose.
The problem with this is that many automated tools that work with the ports tree will fail in this situation.
The most common occurrence of this is seen when trying to build <span class=filename>/usr/ports/INDEX</span> (see <a href=../testing/#make-describe>Running <code>make describe</code></a>).
However, even more trivial commands such as <code>make maintainer</code> also fail in this scenario.
This is not acceptable.</p></div><div id=dot-error-breaks-index class=exampleblock><div class=title>例 1. How to Avoid Using <code>.error</code></div><div class=content><div class=paragraph><p>The first of the next two <span class=filename>Makefile</span> snippets will cause <code>make index</code> to fail, while the second one will not:</p></div><div class="literalblock programlisting"><div class=content><pre>.error &#34;option is not supported&#34;</pre></div></div><div class="literalblock programlisting"><div class=content><pre>IGNORE=option is not supported</pre></div></div></div></div></div></div><div class=sect1><h2 id=dads-sysctl>13.17. Usage of sysctl<a class=anchor href=#dads-sysctl></a></h2><div class=sectionbody><div class=paragraph><p>The usage of <span class=filename>sysctl</span> is discouraged except in targets.
This is because the evaluation of any <code>makevar</code>s, such as used during <code>make index</code>,
then has to run the command, further slowing down that process.</p></div><div class=paragraph><p>Only use <a href="https://man.freebsd.org/cgi/man.cgi?query=sysctl&amp;sektion=8&amp;format=html">sysctl(8)</a> through <code>SYSCTL</code>, as it contains the fully qualified path and can be overridden, if one has such a special need.</p></div></div></div><div class=sect1><h2 id=dads-rerolling-distfiles>13.18. Rerolling Distfiles<a class=anchor href=#dads-rerolling-distfiles></a></h2><div class=sectionbody><div class=paragraph><p>Sometimes the authors of software change the content of released distfiles without changing the file’s name.
Verify that the changes are official and have been performed by the author.
It has happened in the past that the distfile was silently altered on the download servers with the intent to cause harm or compromise end user security.</p></div><div class=paragraph><p>Put the old distfile aside, download the new one, unpack them and compare the content with <a href="https://man.freebsd.org/cgi/man.cgi?query=diff&amp;sektion=1&amp;format=html">diff(1)</a>.
If there is nothing suspicious, update <span class=filename>distinfo</span>.</p></div><div class="admonitionblock important"><table><tbody><tr><td class=icon><i class="fa icon-important" title=Important></i></td><td class=content><div class=paragraph><p>Be sure to summarize the differences in the PR and commit log, so that other people know that nothing bad has happened.</p></div></td></tr></tbody></table></div><div class=paragraph><p>Contact the authors of the software and confirm the changes with them.</p></div></div></div><div class=sect1><h2 id=dads-use-posix-standards>13.19. Use POSIX Standards<a class=anchor href=#dads-use-posix-standards></a></h2><div class=sectionbody><div class=paragraph><p>FreeBSD ports generally expect POSIX compliance.
Some software and build systems make assumptions based on a particular operating system or environment that can cause problems when used in a port.</p></div><div class=paragraph><p>Do not use <span class=filename>/proc</span> if there are any other ways of getting the information.
For example, <code>setprogname(argv[0])</code> in <code>main()</code> and then <a href="https://man.freebsd.org/cgi/man.cgi?query=getprogname&amp;sektion=3&amp;format=html">getprogname(3)</a> to know the executable name.</p></div><div class=paragraph><p>Do not rely on behavior that is undocumented by POSIX.</p></div><div class=paragraph><p>Do not record timestamps in the critical path of the application if it also works without.
Getting timestamps may be slow, depending on the accuracy of timestamps in the OS.
If timestamps are really needed, determine how precise they have to be and use an API which is documented to just deliver the needed precision.</p></div><div class=paragraph><p>A number of simple syscalls (for example <a href="https://man.freebsd.org/cgi/man.cgi?query=gettimeofday&amp;sektion=2&amp;format=html">gettimeofday(2)</a>, <a href="https://man.freebsd.org/cgi/man.cgi?query=getpid&amp;sektion=2&amp;format=html">getpid(2)</a>) are much faster on Linux® than on any other operating system due to caching and the vsyscall performance optimizations.
Do not rely on them being cheap in performance-critical applications.
In general, try hard to avoid syscalls if possible.</p></div><div class=paragraph><p>Do not rely on Linux®-specific socket behavior.
In particular, default socket buffer sizes are different (call <a href="https://man.freebsd.org/cgi/man.cgi?query=setsockopt&amp;sektion=2&amp;format=html">setsockopt(2)</a> with <code>SO_SNDBUF</code> and <code>SO_RCVBUF</code>, and while Linux®'s <a href="https://man.freebsd.org/cgi/man.cgi?query=send&amp;sektion=2&amp;format=html">send(2)</a> blocks when the socket buffer is full, FreeBSD’s will fail and set <code>ENOBUFS</code> in errno.</p></div><div class=paragraph><p>If relying on non-standard behavior is required, encapsulate it properly into a generic API, do a check for the behavior in the configure stage, and stop if it is missing.</p></div><div class=paragraph><p>Check the <a href=https://www.freebsd.org/cgi/man.cgi>man pages</a> to see if the function used is a POSIX interface (in the "STANDARDS" section of the man page).</p></div><div class=paragraph><p>Do not assume that <span class=filename>/bin/sh</span> is bash.
Ensure that a command line passed to <a href="https://man.freebsd.org/cgi/man.cgi?query=system&amp;sektion=3&amp;format=html">system(3)</a> will work with a POSIX compliant shell.</p></div><div class=paragraph><p>A list of common bashisms is available <a href=https://wiki.ubuntu.com/DashAsBinSh>here</a>.</p></div><div class=paragraph><p>Check that headers are included in the POSIX or man page recommended way.
For example, <span class=filename>sys/types.h</span> is often forgotten, which is not as much of a problem for Linux® as it is for FreeBSD.</p></div></div></div><div class=sect1><h2 id=dads-misc>13.20. Miscellanea<a class=anchor href=#dads-misc></a></h2><div class=sectionbody><div class=paragraph><p>Always double-check <span class=filename>pkg-descr</span> and <span class=filename>pkg-plist</span>.
If reviewing a port and a better wording can be achieved, do so.</p></div><div class=paragraph><p>Do not copy more copies of the GNU General Public License into our system, please.</p></div><div class=paragraph><p>Please be careful to note any legal issues! Do not let us illegally distribute software!</p></div></div></div></div><hr><div class=last-modified><p><strong>最後修改於</strong>: March 9, 2024 由 <a href="https://cgit.freebsd.org/doc/commit/?id=6199af92e7" target=_blank>Danilo G. Baio</a></p></div><div class=buttons><div class=prev><i class="fa fa-angle-left" aria-hidden=true title=Prev></i><div class=container><a href=https://docs.freebsd.org/zh-tw/books/porters-handbook/security class=direction>Prev</a></div></div><div class=home><i class="fa fa-home" aria-hidden=true title=Home></i><div class=container><a href=../ class=direction>Home</a></div></div><div class=next><div class=container><a href=https://docs.freebsd.org/zh-tw/books/porters-handbook/porting-samplem class=direction>Next</a></div><i class="fa fa-angle-right" aria-hidden=true title=Next></i></div></div><label class="hidden book-menu-overlay" for=menu-control></label></div><aside class=toc><div class=toc-content><h3>目錄</h3><nav id=TableOfContents><ul><li><a href=#dads-intro>13.1. Introduction</a></li><li><a href=#porting-wrkdir>13.2. <code>WRKDIR</code></a></li><li><a href=#porting-wrkdirprefix>13.3. <code>WRKDIRPREFIX</code></a></li><li><a href=#porting-versions>13.4. Differentiating Operating Systems and OS Versions</a></li><li><a href=#dads-after-port-mk>13.5. Writing Something After bsd.port.mk</a></li><li><a href=#dads-sh-exec>13.6. Use the <code>exec</code> Statement in Wrapper Scripts</a></li><li><a href=#dads-rational>13.7. Do Things Rationally</a></li><li><a href=#dads-cc>13.8. Respect Both <code>CC</code> and <code>CXX</code></a></li><li><a href=#dads-cflags>13.9. Respect <code>CFLAGS</code></a></li><li><a href=#dads-verbose-logs>13.10. Verbose Build Logs</a></li><li><a href=#dads-feedback>13.11. Feedback</a></li><li><a href=#dads-readme>13.12. README.html</a></li><li><a href=#dads-noinstall>13.13. Marking a Port Not Installable with <code>BROKEN</code>, <code>FORBIDDEN</code>, or <code>IGNORE</code></a></li><li><a href=#dads-arch>13.14. Architectural Considerations</a></li><li><a href=#dads-deprecated>13.15. Marking a Port for Removal with <code>DEPRECATED</code> or <code>EXPIRATION_DATE</code></a></li><li><a href=#dads-dot-error>13.16. Avoid Use of the <code>.error</code> Construct</a></li><li><a href=#dads-sysctl>13.17. Usage of sysctl</a></li><li><a href=#dads-rerolling-distfiles>13.18. Rerolling Distfiles</a></li><li><a href=#dads-use-posix-standards>13.19. Use POSIX Standards</a></li><li><a href=#dads-misc>13.20. Miscellanea</a></li></ul></nav><hr><div class=resources><h3>資源</h3><ul class=contents><li><i class="fa fa-file-pdf-o" aria-hidden=true title="下載 PDF"></i><a href=https://download.freebsd.org/doc/zh-tw/books/porters-handbook/porters-handbook_zh-tw.pdf>下載 PDF</a></li><li><i class="fa fa-pencil-square-o" aria-hidden=true title=編輯此頁></i><a href=https://github.com/freebsd/freebsd-doc/blob/main/documentation/content/zh-tw/_index target=_blank>編輯此頁</a></li></ul></div></div></aside><a class=to-top href=#top><i class="fa fa-arrow-circle-up" aria-hidden=true></i></a></main><footer><div class=footer-container><section class=logo-column><img src=https://docs.freebsd.org/images/FreeBSD-colors.svg width=160 height=50 alt="FreeBSD logo"><div class=options-container><div class=language-container><a id=languages href=https://docs.freebsd.org/zh-tw/languages><img src=https://docs.freebsd.org/images/language.png class=language-image alt=選擇語言>
<span>繁體中文</span></a></div><div class=theme-container><select id=theme-chooser><option value=theme-system>System</option><option value=theme-light>淺色</option><option value=theme-dark>深色</option><option value=theme-high-contrast>高對比</option></select></div></div></section><section class=about-column><h3 class=column-title>About</h3><ul class=column-elements-container><li><a href=https://www.freebsd.org/about/ target=_blank class=column-element>FreeBSD</a></li><li><a href=https://freebsdfoundation.org/ target=_blank class=column-element>FreeBSD Foundation</a></li><li><a href=https://www.freebsd.org/where/ target=_blank class=column-element>Get FreeBSD</a></li><li><a href=https://www.freebsd.org/internal/code-of-conduct target=_blank class=column-element>Code of Conduct</a></li><li><a href=https://www.freebsd.org/security/ target=_blank class=column-element>Security Advisories</a></li></ul></section><section class=documentation-column><h3 class=column-title>Documentation</h3><ul class=column-elements-container><li><a href=/zh-tw class=column-element>Documentation portal</a></li><li><a href=https://man.FreeBSD.org target=_blank class=column-element>Manual pages</a></li><li><a href=https://papers.FreeBSD.org target=_blank class=column-element>Presentations and papers</a></li><li><a href=https://docs-archive.freebsd.org/doc/ target=_blank class=column-element>Previous versions</a></li><li><a href=https://docs-archive.freebsd.org/44doc/ target=_blank class=column-element>4.4BSD Documents</a></li><li><a href=https://wiki.freebsd.org/ target=_blank class=column-element>Wiki</a></li></ul></section><section class=community-column><h3 class=column-title>Community</h3><ul class=column-elements-container><li><a href=https://docs.freebsd.org/zh-tw/articles/contributing class=column-element>Get involved</a></li><li><a href=https://forums.freebsd.org/ target=_blank class=column-element>Community forum</a></li><li><a href=https://lists.freebsd.org/ target=_blank class=column-element>Mailing lists</a></li><li><a href=https://wiki.freebsd.org/IRC/Channels target=_blank class=column-element>IRC Channels</a></li><li><a href=https://bugs.freebsd.org/bugzilla/ target=_blank class=column-element>Bug Tracker</a></li></ul></section><section class=legal-column><h3 class=column-title>Legal</h3><ul class=column-elements-container><li><a href=https://freebsdfoundation.org/donate/ target=_blank class=column-element>Donations</a></li><li><a href=https://www.freebsd.org/copyright/freebsd-license/ target=_blank class=column-element>Licensing</a></li><li><a href=https://www.freebsd.org/privacy/ target=_blank class=column-element>Privacy Policy</a></li><li><a href=https://www.freebsd.org/copyright/ target=_blank class=column-element>Legal notices</a></li></ul></section><section class=copyright-column><p>&copy; 1994-2024 The FreeBSD Project. All rights reserved</p><span>Made with <span class=heart>♥</span> by the FreeBSD Community</span></section></div></footer></body></html>