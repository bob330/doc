<!doctype html><html class=theme-light lang=ru><head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="Часто задаваемые вопросы и ответы по FreeBSD 11.X, 12.X и 13.X, касающиеся всех аспектов FreeBSD"><meta name=keywords content="FAQ,FreeBSD FAQ"><meta name=copyright content="1995-2024 The FreeBSD Foundation"><link rel=canonical href=http://172.16.201.134:1313/ru/books/faq/><title>Часто задаваемые вопросы по FreeBSD 12.X и 13.X | FreeBSD Documentation Portal</title>
<meta name=theme-color content="#790000"><meta name=color-scheme content="system light dark high-contrast"><link rel="shortcut icon" href=http://172.16.201.134:1313/favicon.ico><link rel=stylesheet href=http://172.16.201.134:1313/styles/main.min.css><link rel=stylesheet href=http://172.16.201.134:1313/css/font-awesome-min.css><script defer src=/js/theme-chooser.min.js></script><script defer src=/js/copy-clipboard.min.js></script><script defer src=/js/search.min.js></script><meta name=twitter:card content="summary"><meta name=twitter:domain content="docs.FreeBSD.org"><meta name=twitter:site content="@freebsd"><meta name=twitter:url content="https://twitter.com/freebsd"><meta property="og:title" content="Часто задаваемые вопросы по FreeBSD 12.X и 13.X"><meta property="og:description" content="Часто задаваемые вопросы и ответы по FreeBSD 11.X, 12.X и 13.X, касающиеся всех аспектов FreeBSD"><meta property="og:type" content="website"><meta property="og:image" content="http://172.16.201.134:1313/favicon.ico"><meta property="og:image:alt" content="FreeBSD Logo"><meta property="og:locale" content="ru"><meta property="og:url" content="http://172.16.201.134:1313/ru/books/faq/"><meta property="og:site_name" content="FreeBSD Documentation Portal"><script type=application/ld+json>{"@context":"http://schema.org","@type":"Article","url":"http:\/\/172.16.201.134:1313\/ru\/books\/faq\/","name":"FreeBSD Documentation Portal","headline":"FreeBSD Documentation Portal","description":"FreeBSD Documentation Portal"}</script></head><body><header><div class=header-container><div class=logo-menu-bars-container><a href=https://www.FreeBSD.org class=logo><img src=http://172.16.201.134:1313/images/FreeBSD-monochromatic.svg width=160 height=50 alt="FreeBSD logo">
</a><label class=menu-bars for=menu-bars><i class="fa fa-bars" aria-hidden=true></i></label></div><input id=menu-bars type=checkbox><nav><ul class=menu><li class=menu-item><input id=about type=checkbox>
<a href=# aria-label="Navigate to About section"><label class=menu-item-description for=about>О нас
<i class="fa fa-angle-down fa-lg" aria-hidden=true></i></label></a><ul class=sub-menu><li class=title><a href=https://www.freebsd.org/about/ target=_blank>О нас</a></li><li><a href=https://www.freebsd.org/about/ target=_blank>FreeBSD</a></li><li><a href=https://freebsdfoundation.org/about-us/about-the-foundation/ target=_blank>Фонд FreeBSD</a></li><li><a href=https://www.freebsd.org/internal/code-of-conduct/ target=_blank>Кодекс Этики</a></li></ul></li><li class=menu-item><input id=download type=checkbox>
<a href=# aria-label="Navigate to get FreeBSD section"><label class=menu-item-description for=download>Получить FreeBSD
<i class="fa fa-angle-down fa-lg" aria-hidden=true></i></label></a><ul class=sub-menu><li class=title><a href=https://www.freebsd.org/where/ target=_blank>Получить FreeBSD</a></li><li><a href=https://www.freebsd.org/releases/ target=_blank>Информация о релизах</a></li><li><a href=https://www.freebsd.org/releng/ target=_blank>Подготовка релизов</a></li><li><a href=https://www.freebsd.org/security/ target=_blank>Бюллетени Безопасности</a></li></ul></li><li class=menu-item><input id=documentation type=checkbox>
<a href=# aria-label="Navigate to get Documentation section"><label class=menu-item-description for=documentation>Документация
<i class="fa fa-angle-down fa-lg" aria-hidden=true></i></label></a><ul class=sub-menu><li class=title><a href=/ru>Портал документации</a></li><li><a href=http://172.16.201.134:1313/ru/books/handbook>Руководство</a></li><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook>Руководство по созданию портов</a></li><li><a href=https://docs.FreeBSD.org/en/books/fdp-primer>Учебник Проекта Документирования</a></li><li><a href=https://man.FreeBSD.org target=_blank>Страницы Справочника</a></li><li><a href=https://papers.FreeBSD.org target=_blank>Презентации и публикации</a></li><li><a href=https://wiki.FreeBSD.org target=_blank>Wiki</a></li><li><a href=http://172.16.201.134:1313/ru/books>Книги</a></li><li><a href=http://172.16.201.134:1313/ru/articles>Статьи</a></li></ul></li><li class=menu-item><input id=community type=checkbox>
<a href=# aria-label="Navigate to get Community section"><label class=menu-item-description for=community>Сообщество
<i class="fa fa-angle-down fa-lg" aria-hidden=true></i></label></a><ul class=sub-menu><li class=title><a href=https://www.freebsd.org/community/>Сообщество</a></li><li><a href=http://172.16.201.134:1313/ru/articles/contributing>Стать участником</a></li><li><a href=https://forums.freebsd.org/ target=_blank>Форум</a></li><li><a href=https://lists.freebsd.org/ target=_blank>Списки рассылки</a></li><li><a href=https://wiki.freebsd.org/IRC/Channels target=_blank>Каналы IRC</a></li><li><a href=https://bugs.freebsd.org/bugzilla/ target=_blank>Трекер ошибок</a></li><li><a href=https://www.freebsd.org/support/ target=_blank>Поддержка</a></li></ul></li></ul></nav><div class=search-donate-container><form class=search method=get id=search-header-form action=https://docs.freebsd.org/search name=search-header-form><input type=hidden name=DB value=ru>
<input id=words name=P type=text size=20 maxlength=255>
<button>
<i class="fa fa-search" aria-hidden=true></i></button></form><div class=donate><a href=https://freebsdfoundation.org/donate/ target=_blank><span class=heart>♥</span>
Пожертвования</a></div></div></div></header><input type=checkbox class="hidden toggle" id=menu-control><main class=main-wrapper-book><a id=top></a><div class=book><h1 class=title>Часто задаваемые вопросы по FreeBSD 12.X и 13.X</h1><div class="admonitionblock note"><p><i class="fa fa-exclamation-circle" aria-hidden=true></i>
Этот перевод может быть устаревшим. Для того, чтобы помочь с переводом, пожалуйста, обратитесь к <a href=https://translate-dev.freebsd.org/ target=_blank>Сервер переводов FreeBSD</a>.</p></div><div class=copyright>Copyright © 1995-2023 The FreeBSD Russian Documentation Project</div><div class=legalnotice><a id=trademarks></a><details><summary>товарные знаки</summary><p>FreeBSD является зарегистрированным товарным знаком Фонда FreeBSD.</p><p>IBM, AIX, OS/2, PowerPC, PS/2, S/390 и ThinkPad являются товарными знаками International Business Machines Corporation в Соединённых Штатах, других странах, или по всему миру.</p><p>IEEE, POSIX и 802 являются зарегистрированными товарными знаками Institute of Electrical and Electronics Engineers, Inc. в Соединённых Штатах.</p><p>Adobe, Acrobat, Acrobat Reader и PostScript это или зарегистрированные торговые марки или торговые марки Adobe Systems Incorporated в Соединенных Штатах и/или других странах.</p><p>Intel, Celeron, EtherExpress, i386, i486, Itanium, Pentium и Xeon это торговые марки или зарегистрированные торговые марки Intel Corporation или ее дочерних компаний в Соединенных Штатах и других странах.</p><p>Linux является торговым знаком Linus Torvalds.</p><p>Microsoft, FrontPage, IntelliMouse, MS-DOS, Outlook, Windows, Windows Media и Windows NT это или зарегистрированные торговые марки или торговые марки Microsoft Corporation в Соединенных Штатах и/или других странах.</p><p>Motif, OSF/1 и UNIX это зарегистрированные торговые марки, а IT DialTone и The Open Group это торговые марки Open Group в Соединенных Штатах и других странах.</p><p>Sun, Sun Microsystems, Java, Java Virtual Machine, JDK, JRE, JSP, JVM, Netra, Solaris, StarOffice, SunOS это торговые марки или зарегистрированные торговые марки Sun Microsystems, Inc. в Соединенных Штатах и других странах.</p><p>NetBSD это зарегистрированная торговая марка NetBSD Foundation.</p><p>Многие из обозначений, используемые производителями и продавцами для обозначения своих продуктов, заявляются в качестве товарных знаков. Когда такие обозначения появляются в этом документе, и Проекту FreeBSD известно о товарном знаке, к обозначению добавляется знак “™” или “®”.</p></details></div><div class=toc-mobile><h3>Содержание</h3><nav id=TableOfContents><ul><li><a href=#_вступление>1. Вступление</a></li><li><a href=#_документация_и_поддержка>2. Документация и поддержка</a></li><li><a href=#_установка>3. Установка</a></li><li><a href=#hardware>4. Аппаратная совместимость</a></li><li><a href=#troubleshoot>5. Устранение некоторых проблем</a></li><li><a href=#applications>6. Прикладные программы</a></li><li><a href=#kernelconfig>7. Конфигурирование ядра</a></li><li><a href=#_диски_файловые_системы_и_начальные_загрузчики>8. Диски, файловые системы и начальные загрузчики</a></li><li><a href=#_zfs>9. ZFS</a></li><li><a href=#_системное_администрирование>10. Системное администрирование</a></li><li><a href=#_x_window_system_и_виртуальные_консоли>11. X Window System и виртуальные консоли</a></li><li><a href=#_работа_в_сети>12. Работа в сети</a></li><li><a href=#_безопасность>13. Безопасность</a></li><li><a href=#serial>14. Коммуникационные адаптеры</a></li><li><a href=#_разное>15. Разное</a></li><li><a href=#_юмор_от_freebsd>16. Юмор от FreeBSD</a></li><li><a href=#_сложные_темы>17. Сложные темы</a></li><li><a href=#acknowledgments>18. Наши благодарности</a></li></ul></nav></div><div class=book-content><div id=preamble><div class=sectionbody><div class="paragraph abstract-title"><p>Аннотация</p></div><div class=paragraph><p>Этот документ является так называемым FAQ (Frequently Asked Questions), то есть списком Часто Задаваемых Вопросов по FreeBSD версий 13.X и 12.X.
Мы прилагаем все усилия, чтобы сделать этот FAQ максимально информативным; если у вас есть идеи по его усовершенствованию, присылайте их на адрес <a href=https://lists.FreeBSD.org/subscription/freebsd-doc>Список рассылки Проекта Документации FreeBSD</a>.</p></div><div class=paragraph><p>Самая последняя редакция этого документа всегда доступна на <a href=https://docs.freebsd.org/ru/books/faq/>Web-сайте FreeBSD</a>.
Его также можно сгрузить в виде одного
большого файла в формате <a href=.>HTML</a> по HTTP или в различных других форматах с
<a href=https://download.freebsd.org/doc/>FTP-сервера FreeBSD</a>.</p></div><hr></div></div><div class=sect1><h2 id=_вступление>1. Вступление<a class=anchor href=#_вступление></a></h2><div class=sectionbody><div class=sect2><h3 id=_freebsd_что_это_такое>1.1. FreeBSD - что это такое?<a class=anchor href=#_freebsd_что_это_такое></a></h3><div class=paragraph><p>FreeBSD - это современная операционная система для настольных компьютеров, ноутбуков, серверов и встраиваемых систем с поддержкой большого количества <a href=https://www.FreeBSD.org/ru/platforms/>платформ</a>.</p></div><div class=paragraph><p>В основе FreeBSD лежит операционная система "4.4BSD-Lite" Калифорнийского Университета (Беркли) с некоторыми усовершенствованиями из "4.4BSD-Lite2".
Также она косвенно базируется на 386BSD (BSD Net/2, перенесённой на платформу i386™ Уильямом Джолитцем (William Jolitz)), хотя от того первоначального кода осталось очень мало.</p></div><div class=paragraph><p>FreeBSD используется компаниями, Интернет-провайдерами, научными работниками, профессионалами в вычислительной технике, студентами и рядовыми пользователями по всему миру для работы, образования и отдыха.</p></div><div class=paragraph><p>Для более детального знакомства с FreeBSD обратитесь к <a href=https://docs.freebsd.org/ru/books/handbook//>Руководству по FreeBSD</a>.</p></div></div><div class=sect2><h3 id=FreeBSD-goals>1.2. Какова цель FreeBSD?<a class=anchor href=#FreeBSD-goals></a></h3><div class=paragraph><p>Цель проекта FreeBSD - предоставить быструю и стабильную операционную систему общего назначения, которую можно использовать в любых целях без каких-либо ограничений.</p></div></div><div class=sect2><h3 id=bsd-license-restrictions>1.3. Есть ли в лицензии FreeBSD какие-то ограничения?<a class=anchor href=#bsd-license-restrictions></a></h3><div class=paragraph><p>Да.
Эти ограничения не касаются аспектов использования кода, но главным образом описывают отношение к этому коду со стороны Проекта FreeBSD. Текст лицензионного соглашения доступен <a href=https://www.FreeBSD.org/ru/copyright/freebsd-license/>здесь</a>, и вкратце он может быть изложен следующим образом:</p></div><div class=ulist><ul><li><p>Не говорите, что это написано вами.</p></li><li><p>Не судитесь с нами, если что-то не работает.</p></li><li><p>Не удаляйте и не изменяйте лицензию.</p></li></ul></div><div class=paragraph><p>Многие из нас вкладывают в проект значительные усилия и определённо были бы не против получения небольшой финансовой поддержки сейчас и в будущем, но мы на этом не настаиваем.
Мы надеемся, что наша основная и самая значительная "миссия" - предоставить код всем желающим, для любых целей, так чтобы он нашел самое широкое применение и принёс наибольшую пользу. Это, на наш взгляд, одна из самых фундаментальных целей Free Software, которую мы с энтузиазмом поддерживаем.</p></div><div class=paragraph><p>Часть исходного кода нашей системы, подпадающая под действие
<a href=https://www.FreeBSD.org/copyright/COPYING>GNU General Public License (GPL)</a> или
<a href=https://www.FreeBSD.org/copyright/COPYING.LIB>GNU Library General Public
License (LGPL)</a>, имеет несколько больше ограничений, хотя и представляет собой
навязывание доступа к исходным текстам, а не наоборот, как обычно. Из-за
дополнительных сложностей, которые могут возникнуть в случае коммерческого
использования программного обеспечения GPL, мы стараемся, где только это
возможно, заменить подобное программное обеспечение аналогичным, но подпадающим
под менее строгую <a href=https://www.FreeBSD.org/copyright/freebsd-license/>лицензию
FreeBSD</a>.</p></div></div><div class=sect2><h3 id=replace-current-OS>1.4. Может ли FreeBSD заменить операционную систему, используемую мною сейчас?<a class=anchor href=#replace-current-OS></a></h3><div class=paragraph><p>Для большинства людей это возможно.
Но этот вопрос не так уж и однозначен.</p></div><div class=paragraph><p>Большинство пользователей на самом деле не используют операционную систему. Они работают с приложениями. Именно прикладные программы и используют операционную систему. FreeBSD разработана для того, чтобы дать надежное и полнофункциональное окружение для приложений. Она поддерживает широкий спектр Web-браузеров, офисных пакетов, программ для работы с электронной почтой, графических пакетов, программных сред, сетевых серверов и многое другое. Большинство этих приложений могут
быть получено из <a href=https://www.FreeBSD.org/ports/>Коллекции Портов</a>.</p></div><div class=paragraph><p>Если приложение доступно только для одной операционной системы, то нельзя всего лишь заменить эту операционную систему. Однако есть вероятность, что похожая программа существует для FreeBSD. В качестве сервера для офиса, или сервера Интернет, или надежной рабочей станции FreeBSD практически всегда справится со всем, что вам нужно. Многие пользователи по всему миру, включая как новичков, так и опытных администраторов UNIX®, используют FreeBSD в качестве своей единственной настольной операционной системы.</p></div><div class=paragraph><p>Пользователям, переходящим на FreeBSD с другого варианта UNIX®-подобной
системы, FreeBSD покажется очень знакомой. Пользователей Windows® и Mac
OS®, напротив, может привлечь использование одного из трёх дистрибутивов
<a href=https://www.ghostbsd.org/>GhostBSD</a>, <a href=https://www.midnightbsd.org/>MidnightBSD</a>
или <a href=https://www.nomadbsd.org/>NomadBSD</a>, предназначенных для настольных систем
и построенных на базе FreeBSD. Пользователям, которые не использовали до этого
UNIX®, нужно понимать, что понадобится потратить дополнительное время на
изучение подхода UNIX® к организации работы. Этот FAQ и
<a href=https://docs.freebsd.org/ru/books/handbook/>Руководство по FreeBSD</a> являются прекрасными отправными
точками.&lt;/para></p></div></div><div class=sect2><h3 id=why-called-FreeBSD>1.5. Почему система называется именно FreeBSD?<a class=anchor href=#why-called-FreeBSD></a></h3><div class=ulist><ul><li><p>Она может использоваться безо всяческих выплат, даже для извлечения выгоды.</p></li><li><p>Все исходные тексты операционной системы свободно доступны, на её использование в других разработках (как коммерческих, так и некоммерческих) и дальнейшее распространение наложены минимальные ограничения.</p></li><li><p>Любой, у кого есть усовершенствования или исправления, может предоставить свой код и он будет (правда, с парой оговорок) добавлен в исходные тексты системы.</p></li></ul></div><div class=paragraph><p>Следует отметить, что слово "free" используется здесь в двух смыслах: один означает "бесплатно", а другой "делать всё, что хотите". За исключением пары вещей, которые вы <em>не можете</em> делать с FreeBSD, например, претендовать на то, что являетесь её разработчиком, на самом деле можно делать с ней всё, что вам заблагорассудится.</p></div></div><div class=sect2><h3 id=differences-to-other-bsds>1.6. В чём заключается разница между FreeBSD и NetBSD, OpenBSD и другими операционными системами с открытым кодом семейства BSD?<a class=anchor href=#differences-to-other-bsds></a></h3><div class=paragraph><p>Джеймс Ховард (James Howard) создал хорошее описание истории и отличий между разными проектами под названием <a href=https://jameshoward.us/archive/bsd-family-tree/>Семейное древо BSD</a>, в котором даётся подробный ответ на этот вопрос.
Часть информации там устарела, однако историческая часть остаётся точной.</p></div><div class=paragraph><p>Многие из проектов семейства BSD обмениваются изменениями и готовым кодом даже
сегодня. Все они происходят от общего предка.</p></div><div class=paragraph><p>Цели проекта FreeBSD описаны выше в <a href=#FreeBSD-goals>Какова цель FreeBSD?</a>. Цели других наиболее
известных проектов семейства BSD можно кратко описать так:</p></div><div class=ulist><ul><li><p>OpenBSD ориентируется на то, что превыше всего является безопасность
операционной системы.
Команда OpenBSD написала <a href="https://man.freebsd.org/cgi/man.cgi?query=ssh&amp;sektion=1&amp;format=html">ssh(1)</a> и <a href="https://man.freebsd.org/cgi/man.cgi?query=pf&amp;sektion=4&amp;format=html">pf(4)</a>, которые были перенесены во
FreeBSD.</p></li><li><p>NetBSD ориентируется на простое портирование на другие аппаратные платформы.</p></li><li><p>DragonFly BSD отделилась от FreeBSD 4.8, и с тех пор в ней были разработаны многие интересные собственные функциональные возможности, включая файловую систему HAMMER и поддержку "vkernels" - запуска ядра в пользовательском режиме.</p></li></ul></div></div><div class=sect2><h3 id=latest-version>1.7. Какова последняя версия FreeBSD?<a class=anchor href=#latest-version></a></h3><div class=paragraph><p>На любом этапе разработки FreeBSD может существовать несколько параллельных веток. Релизы 13.X выполняются из ветки 13-STABLE, а релизы 12.X выполняются из 12-STABLE.</p></div><div class=paragraph><p>Вплоть до версии 12.0 ветка 12.X была известна как <em>-STABLE</em>.
Однако к моменту выхода 14.X ветка 12.X получит статус
"extended support" (расширенная поддержка), и исправления будут вноситься
только для серьёзных проблем, к примеру, связанных с безопасностью.</p></div><div class=paragraph><p>Релизы делаются <a href=#release-freq>раз в несколько месяцев</a>. Хотя многие стараются отслеживать актуальное состояние исходных текстов FreeBSD (обратите внимание на вопросы о <a href=#current>FreeBSD-CURRENT</a> и <a href=#stable>FreeBSD-STABLE</a>), делать это не обязательно, так как исходные тексты постоянно меняются.</p></div><div class=paragraph><p>Более полную информацию о релизах FreeBSD можно получить на странице
<a href=https://www.FreeBSD.org/releng/#release-build>Информации о подготовке релизов</a>
и на странице Справочника <a href="https://man.freebsd.org/cgi/man.cgi?query=release&amp;sektion=7&amp;format=html">release(7)</a>.</p></div></div><div class=sect2><h3 id=current>1.8. Что такое FreeBSD-CURRENT?<a class=anchor href=#current></a></h3><div class=paragraph><p><a href=https://docs.freebsd.org/ru/books/handbook/cutting-edge/#current>FreeBSD-CURRENT</a> - это версия
операционной системы, находящаяся в стадии разработки, которая должна потом
стать новой веткой FreeBSD-STABLE. Таким образом, она представляет реальный
интерес только для разработчиков системы и её фанатов. Обратитесь к
<a href=https://docs.freebsd.org/ru/books/handbook/cutting-edge/#current>соответствующему разделу</a>
<a href=https://docs.freebsd.org/ru/books/handbook/>Руководства</a> для прояснения деталей работы с <em>-CURRENT</em>.</p></div><div class=paragraph><p>Пользователям, не знакомым с FreeBSD, не следует использовать FreeBSD-CURRENT.
Эта ветка зачастую меняется очень быстро и иногда из-за ошибок может быть неработоспособной.
Подразумевается, что те, кто используют FreeBSD-CURRENT, должны быть в состоянии изучить проблему, найти причину и сообщить о этом.</p></div></div><div class=sect2><h3 id=stable>1.9. В чём смысл FreeBSD-STABLE?<a class=anchor href=#stable></a></h3><div class=paragraph><p><em>FreeBSD-STABLE</em> является веткой разработки, из которой выполняются основные релизы.
В эту ветку изменения вносятся медленнее, и при этом предполагается, что до этого они были протестированы во FreeBSD-CURRENT.
Несмотря на это, исходный код FreeBSD-STABLE в любой момент времени может быть пригоден, а может быть и непригоден к широкому использованию, так как может содержать скрытые ошибки и вырожденные случаи, которые ещё не были выявлены во FreeBSD-CURRENT.
Пользователям, не имеющим возможностей для тестирования, следует работать с самым свежим релизом FreeBSD.
С другой стороны, <em>FreeBSD-CURRENT</em> продолжает являться единой веткой, не разрываемой с момента выхода версии 2.0.</p></div><div class=paragraph><p>Для получения более подробной информации о ветках обратитесь к разделу статьи "<a href=https://docs.freebsd.org/ru/articles/releng/#rel-branch>Подготовка релизов FreeBSD: Создание ветки релиза</a>", а состояние веток и расписание предстоящих релизов можно получить на странице <a href=https://www.FreeBSD.org/releng>Информация о подготовке релизов</a>.
Версия <a href=https://www.FreeBSD.org/releases/12.3R/announce/>12.3</a> является самым последним релизом в
ветке 12-STABLE; она была выпущена December 7, 2021). Версия
<a href=https://www.FreeBSD.org/releases/13.1R/announce/>13.1</a> является самым последним релизом в
ветке 13-STABLE; она была выпущена May 16, 2022).</p></div></div><div class=sect2><h3 id=release-freq>1.10. В какой момент выпускаются новые версии FreeBSD?<a class=anchor href=#release-freq></a></h3><div class=paragraph><p>Группа Выпуска Релизов FreeBSD &lt;<a href=mailto:re@FreeBSD.org>re@FreeBSD.org</a>> выпускает новую старшую версию FreeBSD в среднем каждые 18 месяцев и младшие версии каждые 8 месяцев. Даты релизов обычно объявляются заранее, так что те, кто работает над системой, знают, когда их проекты должны быть закончены и протестированы. Период тестирования предшествует выходу каждого релиза, для того, чтобы удостовериться в том, что добавление новых возможностей не повлияло на стабильность работы релиза. Многие пользователи расценивают такую осторожность как одну из приятнейших черт FreeBSD, хотя необходимость дожидаться <em>-STABLE</em> для получения всех этих новых возможностей может несколько разочаровывать.</p></div><div class=paragraph><p>Дополнительная информация о процессе подготовки релиза (в том числе планы выпуска последующих релизов) может быть найдена на страницах Web-сайта FreeBSD, посвящённых <a href=https://www.FreeBSD.org/releng/>выпуску релизов</a>.</p></div><div class=paragraph><p>Для тех, кому нужно или хочется, еженедельно выпускаются бинарные снапшоты, как описано выше.</p></div></div><div class=sect2><h3 id=snapshot-freq>1.11. Когда выпускаются снэпшоты FreeBSD?<a class=anchor href=#snapshot-freq></a></h3><div class=paragraph><p><a href=https://www.FreeBSD.org/snapshots/>Снэпшот</a>-релизы FreeBSD
выпускаются исходя из актуального состояния веток <em>-CURRENT</em> и <em>-STABLE</em>.
Цели выпуска каждого такого снэпшот-релиза таковы:</p></div><div class=ulist><ul><li><p>Протестировать самую последнюю версию программы установки системы.</p></li><li><p>Дать людям, которые хотят работать с ветками <em>-CURRENT</em> или <em>-STABLE</em>,
но не имеют достаточно времени или пропускной способности сети
для отслеживания ежедневных изменений, простой способ их
начальной установки.</p></li><li><p>Зафиксировать состояние определённого кода на какой-то
момент времени на случай, если позже мы что-нибудь очень сильно
сломаем.
(Хотя Git, как правило, не позволяет случиться ничему такому ужасному).</p></li><li><p>Обеспечить все новые функции и исправления, которым
требуется тестирование, как можно большим количеством
потенциальных тестировщиков.</p></li></ul></div><div class=paragraph><p>Не утверждается, что всякий снэпшот <em>-CURRENT</em> с любой точки зрения имеет
качество "готового продукта". Если нужна стабильно
работающая и полностью протестированная система, то
придерживайтесь политики использования полноценных релизов.</p></div><div class=paragraph><p>Снэпшот-релизы доступны непосредственно
<a href=https://www.FreeBSD.org/snapshots/>отсюда</a>.</p></div><div class=paragraph><p>Официальные снэпшоты регулярно выпускаются для всех активно разрабатываемых
веток.</p></div></div><div class=sect2><h3 id=responsible>1.12. Кто отвечает за разработку FreeBSD?<a class=anchor href=#responsible></a></h3><div class=paragraph><p>Ключевые решения, касающиеся проекта FreeBSD, такие, как общее направление развития проекта или кто может добавлять код к дереву исходных текстов, принимаются <a href=https://www.FreeBSD.org/administration/#t-core>управляющей командой</a> разработчиков (Core Team), состоящей из 9 человек.
Также существует многочисленная группа, состоящая из более чем 350 так называемых <a href=https://docs.freebsd.org/en/articles/contributors/#staff-committers>коммиттеров</a> (committers), которые могут вносить изменения прямо в дерево исходных текстов FreeBSD.</p></div><div class=paragraph><p>Однако большинство нетривиальных изменений широко обсуждается в <a href=#mailing>списках рассылки</a>, и не существует никаких ограничений на участие в подобных дискуссиях.</p></div></div><div class=sect2><h3 id=where-get>1.13. Где можно найти FreeBSD?<a class=anchor href=#where-get></a></h3><div class=paragraph><p>Все поддерживаемые релизы FreeBSD доступны на странице
<a href=https://www.freebsd.org/where/>поиска релизов FreeBSD</a>:</p></div><div class=ulist><ul><li><p>Для получения самого последнего релиза 13-STABLE, 13.2-RELEASE, перейдите по ссылке для выбора <a href=https://www.freebsd.org/where/#download-rel132>соответствующей архитектуры и режима установки для 13.2-RELEASE</a>.</p></li><li><p>Для получения самого последнего релиза 12-STABLE, 12.4-RELEASE, перейдите по ссылке для выбора <a href=https://www.freebsd.org/where/#download-rel124>соответствующей архитектуры и режима установки для 12.4-RELEASE</a>.</p></li><li><p><a href=https://www.FreeBSD.org/snapshots/>Снэпшот-релизы</a> для веток <a href=#current>-CURRENT</a> и <a href=#stable>-STABLE</a> выпускаются ежемесячно, но они нужны исключительно для разработчиков и тех, кто тестирует самые последние нововведения.</p></li></ul></div><div class=paragraph><p>Информация о возможностях получения FreeBSD на CD, DVD и других носителях
доступна в <a href=https://docs.freebsd.org/ru/books/handbook/mirrors/#mirrors>Руководстве</a>.</p></div></div><div class=sect2><h3 id=_как_можно_получить_доступ_к_базе_сообщений_о_проблемах_problem_report>1.14. Как можно получить доступ к базе сообщений о проблемах (Problem Report)?<a class=anchor href=#_как_можно_получить_доступ_к_базе_сообщений_о_проблемах_problem_report></a></h3><div class=paragraph><p>База данных всех сообщений пользователей о проблемах может быть запрошена с помощью нашего <a href=https://bugs.FreeBSD.org/search/>Web-интерфейса</a>.</p></div><div class=paragraph><p>Можно использовать <a href=https://www.FreeBSD.org/support/bugreports/>Web-интерфейс</a> для отсылки сообщений об ошибках через браузер.</p></div><div class=paragraph><p>Перед тем, как посылать сообщение об ошибке, прочтите статью <a href=https://docs.freebsd.org/ru/articles/problem-reports/>Составление сообщений о проблеме во FreeBSD</a> о том, как писать хорошие сообщения об ошибках.</p></div></div></div></div><div class=sect1><h2 id=_документация_и_поддержка>2. Документация и поддержка<a class=anchor href=#_документация_и_поддержка></a></h2><div class=sectionbody><div class=sect2><h3 id=books>2.1. Есть ли хорошие книги по FreeBSD?<a class=anchor href=#books></a></h3><div class=paragraph><p>В рамках проекта создаётся обширная документация, которая доступна в онлайне по
следующей ссылке: <a href=https://www.FreeBSD.org/docs/>https://www.FreeBSD.org/docs/</a>.</p></div></div><div class=sect2><h3 id=doc-formats>2.2. Можно ли получить документацию в другом формате, например, в виде PDF?<a class=anchor href=#doc-formats></a></h3><div class=paragraph><p>Да.
<a href=https://download.freebsd.org/doc/>Документация доступна к сгрузке также и
в других форматах</a> на сайте FreeBSD.</p></div><div class=paragraph><p>Каталоги с документацией подразделяется на категории в зависимости от:</p></div><div class=ulist><ul><li><p>Имени документа, например, <code>faq</code> или <code>handbook</code>.</p></li><li><p>Языка документа на базе наименования региональных настроек, размещаемых в
каталоге <span class=filename>/usr/share/locale</span> системы FreeBSD, без учёта кодировки,
так как во всей документации сейчас используется UTF-8.
На данный момент доступны следующие языки:</p><table class="tableblock frame-none grid-all stretch informaltable"><col style=width:50%><col style=width:50%><thead><tr><th class="tableblock halign-left valign-top">Кодировка</th><th class="tableblock halign-left valign-top">Язык</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>en</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Английский</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>bn-bd</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Бенгальский или Бангла (Бангладеш)</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>da</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Датский</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>de</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Немецкий</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>el</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Греческий</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>es</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Испанский</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>fr</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Французский</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>hu</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Венгерский</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>it</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Итальянский</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>ja</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Японский</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>ko</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Корейский</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>mn</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Монгольский</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>nl</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Голландский</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>pl</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Польский</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>pt-br</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Португальский (Бразилия)</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>ru</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Русский</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>tr</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Турецкий</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>zh-cn</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Упрощённый китайский (Китай)</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>zh-tw</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Традиционный китайский (Тайвань)</p></td></tr></tbody></table><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Некоторые документы могут иметься не на всех языках.</p></div></td></tr></tbody></table></div></li><li><p>Формат документа.
Мы распространяем документацию в нескольких различных форматах.
У каждого из форматов имеются свои плюсы и свои минусы.
Некоторые форматы лучше подходят для чтения в on-line, тогда как другие предназначены для получения эстетично выглядящей бумажной копии.
Наличие документации во всех этих форматах обеспечивает возможность прочтения нашими пользователями любой её части как с экрана монитора, так и на бумаге после вывода на печать.
На данный момент доступны следующие форматы;</p><table class="tableblock frame-none grid-all stretch informaltable"><col style=width:50%><col style=width:50%><thead><tr><th class="tableblock halign-left valign-top">Формат</th><th class="tableblock halign-left valign-top">Значение</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>html</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>В зависимости от документа: Один большой HTML-файл, содержащий документ полностью, или набор небольших связанных HTML-файлов, в обоих случаях содержащих изображения, таблицы стилей и код JavaScript</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>pdf</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Adobe’s Portable Document Format</p></td></tr></tbody></table></li><li><p>Способ сжатия и создания архива.</p><div class="olist loweralpha"><ol class=loweralpha type=a><li><p>В случае формата <code>html</code>, файлы пакетируются с помощью <a href="https://man.freebsd.org/cgi/man.cgi?query=tar&amp;sektion=1&amp;format=html">tar(1)</a>.
Получающийся файл <span class=filename>.tar</span> затем сжимается утилитой <a href="https://man.freebsd.org/cgi/man.cgi?query=gzip&amp;sektion=1&amp;format=html">gzip(1)</a>.</p></li><li><p>При использовании формата PDF создаётся один файл. К примеру,
<span class=filename>explaining-bsd_en.pdf</span>, <span class=filename>faq_en.pdf</span> и так далее.</p></li></ol></div></li></ul></div><div class=paragraph><p>Выбрав формат, сгрузите файлы, распакуйте их при необходимости, а затем
скопируйте документацию в соответствующие места.</p></div><div class=paragraph><p>Например, HTML-версию FAQ можно найти в
<span class=filename>doc/en/books/faq/faq_en.tar.gz</span>. Для сгрузки и распаковки этого
файла выполните:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>% fetch https://download.freebsd.org/doc/en/books/faq/faq_en.tar.gz
% <span class=nb>tar </span>xvf faq_en.tar.gz</code></pre></div></div><div class=paragraph><p>Если файл сжат, tar автоматически определит подходящий формат и корректно его распакует, в результате чего появится набор файлов.
Главным является <span class=filename>index.html</span>, и в нём находится всё содержимое документа, начиная с оглавления, ссылающегося на остальные части документа.</p></div></div><div class=sect2><h3 id=mailing>2.3. Где найти информацию по спискам рассылки FreeBSD? Какие существуют телеконференции по FreeBSD?<a class=anchor href=#mailing></a></h3><div class=paragraph><p>Исчерпывающая информация содержится в extref:https://docs.freebsd.org/ru/books/handbook/eresources/[разделе
Руководства, eresources-mail], который посвящён спискам рассылки, и в
<a href=https://docs.freebsd.org/ru/books/handbook/eresources/#eresources-news>разделе Руководства</a>, касающемся
новостных конференций.</p></div></div><div class=sect2><h3 id=irc>2.4. Существуют ли каналы IRC (Internet Relay Chat) по FreeBSD?<a class=anchor href=#irc></a></h3><div class=paragraph><p>Да, в большинстве крупнейших сетей IRC имеется канал для обсуждения FreeBSD, а
на wiki-странице FreeBSD размещён актуальный
<a href=https://wiki.freebsd.org/IRC/Channels>список IRC-каналов</a>.</p></div><div class=paragraph><p>Все эти каналы разные и не связаны друг к другом. Поскольку их манеры общения
отличаются, попробуйте каждый, пока не найдёте соответствующий вашему стилю.</p></div></div><div class=sect2><h3 id=forums>2.5. Есть ли какие-нибудь web-форумы для обсуждения FreeBSD?<a class=anchor href=#forums></a></h3><div class=paragraph><p>Официальные форумы FreeBSD расположены по адресу <a href=https://forums.FreeBSD.org/>https://forums.FreeBSD.org/</a>.</p></div></div><div class=sect2><h3 id=training>2.6. Где можно пройти платные курсы по FreeBSD и получить поддержку?<a class=anchor href=#training></a></h3><div class=paragraph><p><a href=http://www.ixsystems.com>iXsystems, Inc.</a>, дочерней компанией которой является <a href=http://www.freebsdmall.com/>FreeBSD Mall</a>, оказывает <a href=http://www.ixsystems.com/support>услуги поддержки</a> программного обеспечения FreeBSD на коммерческой основе, в дополнение к разработкам на платформе FreeBSD и решениям, требующим тонкой настройки.</p></div><div class=paragraph><p>BSD Certification Group, Inc. предоставляет сертификацию системного администрирования DragonFly BSD, FreeBSD, NetBSD и OpenBSD. Для получения дополнительной информации посетите <a href=http://www.BSDCertification.org>их сайт</a>.</p></div><div class=paragraph><p>Чтобы попасть в этот список, другие организации, осуществляющие обучение и поддержку, должны обратиться к нам в Проект.</p></div></div></div></div><div class=sect1><h2 id=_установка>3. Установка<a class=anchor href=#_установка></a></h2><div class=sectionbody><div class=sect2><h3 id=which-architecture>3.1. Какую архитектуру нужно загрузить? У меня есть 64-разрядный процессор Intel®, но я вижу только amd64.<a class=anchor href=#which-architecture></a></h3><div class=paragraph><p>amd64 - это термин, применяемый во FreeBSD для обозначения 64-разрядной архитектуры x86 (также известна как "x86-64" или "x64"). На большинстве современных компьютеров следует использовать amd64. Для более старых подойдёт i386. При установке системы на отличную от x86 архитектуру, выберите платформу, наиболее подходящую для оборудования.</p></div></div><div class=sect2><h3 id=floppy-download>3.2. Какой файл нужно скачать для установки FreeBSD?<a class=anchor href=#floppy-download></a></h3><div class=paragraph><p>На странице <a href=https://www.freebsd.org/ru/where/>Получение FreeBSD</a> выберите
<code>[iso]</code> с соответствующей оборудованию архитектурой.</p></div><div class=paragraph><p>Можно использовать любой из:</p></div><table class="tableblock frame-none grid-all stretch informaltable"><col style=width:50%><col style=width:50%><thead><tr><th class="tableblock halign-left valign-top">файл</th><th class="tableblock halign-left valign-top">описание</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class=tableblock><span class=filename>disc1.iso</span></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Содержит достаточно для установки FreeBSD и минимальный набор пакетов.</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><span class=filename>dvd1.iso</span></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Наподобие <span class=filename>disc1.iso</span>, но с дополнительными пакетами.</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><span class=filename>memstick.img</span></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Образ с автозагрузкой для записи на USB флешку.</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><span class=filename>bootonly.iso</span></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Минимальный образ, требующий сетевое подключение для завершения установки FreeBSD.</p></td></tr></tbody></table><div class=paragraph><p>Полные инструкции по этой процедуре, а также более подробную информацию по
общим вопросам, возникающим при установке, можно найти в
<a href=https://docs.freebsd.org/ru/books/handbook/bsdinstall>разделе Руководства об установке FreeBSD</a>.</p></div></div><div class=sect2><h3 id=_что_нужно_делать_если_установочный_образ_не_запускается>3.3. Что нужно делать, если установочный образ не запускается?<a class=anchor href=#_что_нужно_делать_если_установочный_образ_не_запускается></a></h3><div class=paragraph><p>Это может быть вызвано тем, что образ был загружен по FTP не в режиме <em>binary</em>.</p></div><div class=paragraph><p>В некоторых клиентских программах FTP по умолчанию используется текстовый (<em>ascii</em>) режим передачи, в котором любые последовательности символов "конец строки" заменяются на используемые в системе клиента. В таком случае образ загрузочного диска будет неизбежно испорчен. Проверьте контрольную сумму SHA-256 полученного файла: если он не <em>точно</em> такой же как на FTP-сервере, то ошибка произошла, скорее всего, в процессе передачи.</p></div><div class=paragraph><p>В случае использования командной строки FTP-клиента введите команду <em>binary</em> в командной строке FTP после подключения к серверу, но перед началом передачи файла.</p></div></div><div class=sect2><h3 id=install-instructions-location>3.4. Где находятся инструкции по установке FreeBSD?<a class=anchor href=#install-instructions-location></a></h3><div class=paragraph><p>Инструкции по установке можно найти в extref:https://docs.freebsd.org/ru/books/handbook/bsdinstall/[главе
Руководства], посвящённой установке FreeBSD.</p></div></div><div class=sect2><h3 id=custom-boot-floppy>3.5. Как сделать собственный установочный диск?<a class=anchor href=#custom-boot-floppy></a></h3><div class=paragraph><p>Индивидуальный установочный носитель FreeBSD можно создать, запустив процедуру построения индивидуального релиза. Следуйте инструкциям в статье о <a href=https://docs.freebsd.org/ru/articles/releng/>подготовке релизов FreeBSD</a>.</p></div></div><div class=sect2><h3 id=windows-coexist>3.6. Может ли Windows® сосуществовать с FreeBSD? (специфично для x86)<a class=anchor href=#windows-coexist></a></h3><div class=paragraph><p>Да, если Windows® установлена первой. Загрузчик FreeBSD будет управлять процессом выбора загрузки Windows® или FreeBSD. Если Windows® устанавливается следом, то это приведёт к перезаписи загрузчика. Если такое случится, обратитесь к следующему разделу.</p></div></div><div class=sect2><h3 id=bootmanager-restore>3.7. Другая операционная система уничтожила мой загрузчик операционной системы! Как мне его вернуть? (специфично для x86)<a class=anchor href=#bootmanager-restore></a></h3><div class=paragraph><p>Способ восстановления зависит от используемого загрузчика. Меню выбора загрузки, используемое во FreeBSD, можно переустановить с помощью <a href="https://man.freebsd.org/cgi/man.cgi?query=boot0cfg&amp;sektion=8&amp;format=html">boot0cfg(8)</a>. Пример для восстановления меню загрузки на диске <em>ada0</em>:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># boot0cfg -B ada0</span></code></pre></div></div><div class=paragraph><p>Неинтерактивный загрузчик MBR можно установить с помощью <a href="https://man.freebsd.org/cgi/man.cgi?query=gpart&amp;sektion=8&amp;format=html">gpart(8)</a>:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># gpart bootcode -b /boot/mbr ada0</span></code></pre></div></div><div class=paragraph><p>Более сложные ситуации, включая использование дисков GPT, рассматриваются в <a href="https://man.freebsd.org/cgi/man.cgi?query=gpart&amp;sektion=8&amp;format=html">gpart(8)</a>.</p></div></div><div class=sect2><h3 id=need-complete-sources>3.8. Нужно ли устанавливать исходные тексты системы?<a class=anchor href=#need-complete-sources></a></h3><div class=paragraph><p>В общем случае, нет. Для работы основной системы присутствие исходных текстов не требуется. Некоторые порты наподобие <span class=filename>sysutils/lsof</span> не будут собираться без установленных исходных текстов системы. В частности, если порт собирает модуль ядра или напрямую обращается к структурам ядра, в этом случае исходные тексты должны быть установлены.</p></div></div><div class=sect2><h3 id=need-kernel>3.9. Нужно ли перекомпилировать ядро?<a class=anchor href=#need-kernel></a></h3><div class=paragraph><p>Обычно нет.
Поставляемое ядро <code>GENERIC</code> содержит драйвера, необходимые для типового компьютера.
Инструмент <a href="https://man.freebsd.org/cgi/man.cgi?query=freebsd-update&amp;sektion=8&amp;format=html">freebsd-update(8)</a> не может использоваться для обновления FreeBSD с собственным ядром, и это является ещё одной причиной для того, чтобы по возможности придерживаться использования ядра <code>GENERIC</code>.
Для компьютеров с очень небольшим объёмом ОЗУ, таких как встраиваемые системы, может потребоваться собственное небольшое ядро, содержащее только необходимые драйверы.</p></div></div><div class=sect2><h3 id=password-encryption>3.10. Какой из методов шифрования паролей (DES, Blowfish или MD5) я должен использовать, и как указать, шифрование какого типа применяется пользователями?<a class=anchor href=#password-encryption></a></h3><div class=paragraph><p>Во FreeBSD по умолчанию используется метод шифрования <em>SHA512</em>.
Пароли, зашифрованные методом DES, остаются доступными для обратной совместимости с операционными системами, в которых всё ещё используется менее защищённый метод шифрования паролей.
FreeBSD также поддерживает пароли в форматах Blowfish и MD5.
Управление выбором используемого метода для новых паролей осуществляется через параметр входа <code>passwd_format</code> в файле <span class=filename>/etc/login.conf</span>, принимающий значения <code>des</code>, <code>blf</code> (если они доступны) или <code>md5</code>.
Подробная информация о параметрах входа находится на странице Справочника <a href="https://man.freebsd.org/cgi/man.cgi?query=login.conf&amp;sektion=5&amp;format=html">login.conf(5)</a>.</p></div></div><div class=sect2><h3 id=ffs-limits>3.11. Какие существуют ограничения для файловой системы FFS?<a class=anchor href=#ffs-limits></a></h3><div class=paragraph><p>Наибольший размер файловой системы FFS ограничен практически количеством памяти, которая требуется для работы <a href="https://man.freebsd.org/cgi/man.cgi?query=fsck&amp;sektion=8&amp;format=html">fsck(8)</a>. <a href="https://man.freebsd.org/cgi/man.cgi?query=fsck&amp;sektion=8&amp;format=html">fsck(8)</a> использует 1 бит на фрагмент, и для стандартного размера фрагмента 4 Кбайт это эквивалентно использованию 32 Мбайт памяти на терабайт дискового пространства. Это означает, что на архитектурах с ограничением размера пользовательского процесса в 2 Гбайт (например, i386™) максимальный размер файловой системы, доступный для <a href="https://man.freebsd.org/cgi/man.cgi?query=fsck&amp;sektion=8&amp;format=html">fsck(8)</a>, составляет ~60 Тбайт.</p></div><div class=paragraph><p>Без ограничения на память для <a href="https://man.freebsd.org/cgi/man.cgi?query=fsck&amp;sektion=8&amp;format=html">fsck(8)</a> максимальный размер файловой системы составляет 2 ^ 64 (блоков) * 32 Кбайт ⇒ 16 экса * 32 Кбайт ⇒ 512 зеттабайт.</p></div><div class=paragraph><p>Максимальный размер файла на FFS приблизительно равен 2 петабайт со стандартным размером блока 32 Кбайт. Каждый 32 Кбайтный блок может адресовать до 4096 блоков. С использованием тройной косвенной адресации это составляет 32 Кбайт * 12 + 32 Кбайт * 4096 + 32 Кбайт * 4096^2 + 32 Кбайт * 4096^3. Увеличение размера блока до 64 Кбайт увеличит максимальный размер файла в 16 раз.</p></div></div><div class=sect2><h3 id=archsw-readin-failed-error>3.12. Я скомпилировал новое ядро и при загрузке получил сообщение об ошибке readin failed.<a class=anchor href=#archsw-readin-failed-error></a></h3><div class=paragraph><p>Ядро и компоненты системы не синхронизированы. Такая конфигурация не поддерживается. Обязательно используйте команды <code>make buildworld</code> и <code>make buildkernel</code> для обновления ядра.</p></div><div class=paragraph><p>Загрузите систему, непосредственно указав ядро на втором этапе загрузки, нажав любую клавишу до запуска загрузчика при появлении символов <code>|</code>.</p></div></div><div class=sect2><h3 id=general-configuration-tool>3.13. Существует ли инструмент для настройки системы после её установки?<a class=anchor href=#general-configuration-tool></a></h3><div class=paragraph><p>Да, bsdconfig предоставляет замечательный интерфейс для пост-установочной настройки FreeBSD.</p></div></div></div></div><div class=sect1><h2 id=hardware>4. Аппаратная совместимость<a class=anchor href=#hardware></a></h2><div class=sectionbody><div class=sect2><h3 id=compatibility-general>4.1. Вопросы общего характера<a class=anchor href=#compatibility-general></a></h3><div class=sect3><h4 id=which-hardware-to-get>4.1.1. Я хочу приобрести некое оборудование для моей системы FreeBSD. Какая модель/производитель/тип лучше всего?<a class=anchor href=#which-hardware-to-get></a></h4><div class=paragraph><p>Это постоянно обсуждается в списках рассылки FreeBSD и является ожидаемым вопросом, так как аппаратура меняется очень быстро. Обратитесь к Hardware Notes для
FreeBSD <a href=https://www.FreeBSD.org/releases/12.3R/hardware/>12.3</a> или
<a href=https://www.FreeBSD.org/releases/13.1R/hardware/>13.1</a>, а также поищите в
<a href=https://www.FreeBSD.org/search/#mailinglists>архивах списков рассылки</a> перед
тем, как задавать вопросы о самом последнем и лучшем оборудовании. Весьма
вероятно, что обсуждение касаемо этого типа оборудования велось как раз на прошлой неделе.</p></div><div class=paragraph><p>Перед приобретением лэптопа посмотрите архивы <a href=https://lists.FreeBSD.org/subscription/freebsd-questions>Список рассылки, посвящённый вопросам и ответам пользователей FreeBSD</a> или, возможно, более специфичные списки рассылки по данному типу оборудования.</p></div></div><div class=sect3><h4 id=memory-upper-limitation>4.1.2. Каковы ограничения на оперативную память?<a class=anchor href=#memory-upper-limitation></a></h4><div class=paragraph><p>FreeBSD как операционная система в целом поддерживает столько же физической памяти (ОЗУ), сколько аппаратная платформа, на которой она работает.
Имейте в виду, что различные платформы имеют различные ограничения на память; например, i386™ без PAE поддерживает максимум 4 Гбайт памяти (и обычно ещё меньше из-за адресного пространства PCI), а i386™ с PAE поддерживает максимум 64 Гбайт.
Во FreeBSD 10 для платформы AMD64 поддерживается до 4 Тбайт физической памяти.</p></div></div><div class=sect3><h4 id=memory-i386-over-4gb>4.1.3. Почему FreeBSD видит меньше 4 Гбайт памяти, когда система установлена на машину i386™?<a class=anchor href=#memory-i386-over-4gb></a></h4><div class=paragraph><p>Общее адресное пространство для машин i386™ является 32-разрядным; это означает, что адресоваться (т.е. быть получено) может не более 4 Гбайт памяти.
Более того, некоторые адреса в этом диапазоне зарезервированы для различных целей аппаратным обеспечением, например, для использования и управления устройствами PCI, для доступа к видеопамяти, и так далее.
Таким образом, общий объем памяти, используемой операционной системой для ядра и приложений, ограничен размером, значительно меньшим, чем 4 Гбайт.
В такой конфигурации максимально доступная физическая память составляет от 3.2 Гбайт до 3.7 Гбайт.</p></div><div class=paragraph><p>Для преодоления ограничения в 3.2 Гбайт-3.7 Гбайт установленной памяти (т.е. для получения 4 Гбайт, но также более 4 Гбайт) должен использоваться специальный механизм, именуемый PAE.
Сокращение PAE означает Physical Address Extension (расширение физического адреса) и предоставляет для 32-разрядных x86 процессоров способ адресовать более 4 Гбайт памяти.
PAE переназначает память, которая иначе была бы перекрыта адресными резервациями для аппаратных устройств выше диапазона 4 Гбайт, и использует её как дополнительную физическую память (смотрите <a href="https://man.freebsd.org/cgi/man.cgi?query=pae&amp;sektion=4&amp;format=html">pae(4)</a>).
Использование PAE имеет свои недостатки; такая модель доступа к памяти является чуть более медленной по сравнению с обычным режимом (без PAE), и также не работают динамически загружаемые модули (смотрите <a href="https://man.freebsd.org/cgi/man.cgi?query=kld&amp;sektion=4&amp;format=html">kld(4)</a>).
Это означает, что все драйверы должны присутствовать статически в самом ядре.</p></div><div class=paragraph><p>Самый распространённым способом включения PAE является сборка нового ядра со специальным уже подготовленным файлом конфигурации ядра, именуемым <span class=filename>PAE</span>, который уже сконфигурирован для сборки безопасного ядра.
Имейте в виду, что некоторые строки в этом файле конфигурации ядра являются слишком консервативными, и некоторые драйверы, помеченные как неготовые для использования с PAE, на самом деле являются годными.
На практике, если драйвер работает на 64-разрядной архитектуре (такой как AMD64), он также работает с PAE.
При создании своего собственного файла конфигурации ядра можно включить PAE, добавив следующую строку:</p></div><div class="literalblock programlisting"><div class=content><pre>options       PAE</pre></div></div><div class=paragraph><p>PAE не является широко используемым в настоящее время, поскольку большинство нового x86 аппаратного обеспечения также поддерживает работу в 64-разрядном режиме, также известном как AMD64 или Intel® 64. Этот режим имеет большее адресное пространство и не нуждается в таких трюках. FreeBSD поддерживает AMD64, и рекомендуется использование этой версии FreeBSD вместо версии i386™, если требуется больше 4 Гбайт памяти.</p></div></div></div><div class=sect2><h3 id=compatibility-processors>4.2. Аппаратные платформы и процессоры<a class=anchor href=#compatibility-processors></a></h3><div class=sect3><h4 id=architectures>4.2.1. Поддерживает ли FreeBSD аппаратные платформы, отличные от x86?<a class=anchor href=#architectures></a></h4><div class=paragraph><p>Полноценно поддерживаются архитектуры первого класса, такие, как
i386 или amd64. Архитектуры 2 и 3 класса поддерживаются, исходя
из принципа наибольшего внимания при имеющихся возможностях.
Полное описание классов доступно в extref:https://docs.freebsd.org/ru/articles/committers-guide/[Руководстве
коммиттера, archs].</p></div><div class=paragraph><p>Полный список поддерживаемых архитектур находится на <a href=https://www.FreeBSD.org/ru/platforms/>странице</a>, посвящённой платформам.</p></div></div><div class=sect3><h4 id=smp-support>4.2.2. Поддерживает ли FreeBSD многопроцессорные системы (SMP)?<a class=anchor href=#smp-support></a></h4><div class=paragraph><p>FreeBSD поддерживает симметричное мультипроцессирование (SMP) на всех невстраиваемых платформах (например, i386, amd64 и так далее). SMP также поддерживается для arm и MIPS, хотя некоторые процессоры могут это не поддерживать. В реализации SMP во FreeBSD используется мелкодисперсная синхронизация, и производительность масштабируется почти линейно с ростом количества процессоров.</p></div><div class=paragraph><p>За подробной информацией обращайтесь к странице Справочника <a href="https://man.freebsd.org/cgi/man.cgi?query=smp&amp;sektion=4&amp;format=html">smp(4)</a>.</p></div></div><div class=sect3><h4 id=microcode>4.2.3. Что такое микрокод? Как установить обновление микрокода для процессоров AMD или Intel?<a class=anchor href=#microcode></a></h4><div class=paragraph><p>Микрокод является программным средством реализации аппаратных инструкций процессора.
Его использование позволяет исправлять ошибки процессора без замены микросхемы.</p></div><div class=paragraph><p>Установите <a class=package href=https://cgit.freebsd.org/ports/tree/sysutils/cpu-microcode/>sysutils/cpu-microcode</a>, а затем добавьте:</p></div><div class="literalblock programlisting"><div class=content><pre>microcode_update_enable=&#34;YES&#34;</pre></div></div><div class=paragraph><p>в <span class=filename>/etc/rc.conf</span></p></div></div></div><div class=sect2><h3 id=compatibility-peripherals>4.3. Периферийные устройства<a class=anchor href=#compatibility-peripherals></a></h3><div class=sect3><h4 id=supported-peripherals>4.3.1. Какого рода периферийные устройства поддерживает FreeBSD?<a class=anchor href=#supported-peripherals></a></h4><div class=paragraph><p>За информацией о списке оборудования, о котором известно, что оно
работоспособно, а также данными о каких бы то ни было ограничечниях, обратитесь
к Hardware Notes для FreeBSD link:https://www.FreeBSD.org/releases/12.3R/hardware/
[12.3] или <a href=https://www.FreeBSD.org/releases/13.1R/hardware/>13.1</a>.</p></div></div></div><div class=sect2><h3 id=compatibility-kbd-mice>4.4. Клавиатуры и мыши<a class=anchor href=#compatibility-kbd-mice></a></h3><div class=sect3><h4 id=moused>4.4.1. Можно ли использовать мышь вне X Window?<a class=anchor href=#moused></a></h4><div class=paragraph><p>Используемый по умолчанию драйвер консоли <a href="https://man.freebsd.org/cgi/man.cgi?query=syscons&amp;sektion=4&amp;format=html">syscons(4)</a> предоставляет возможность использования указателя мыши в текстовых консолях для выделения и переноса текста. Запустите демон мыши <a href="https://man.freebsd.org/cgi/man.cgi?query=moused&amp;sektion=8&amp;format=html">moused(8)</a> и включите отображение указателя мыши в виртуальной консоли:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># moused -p /dev/xxxx -t yyyy</span>
<span class=c># vidcontrol -m on</span></code></pre></div></div><div class=paragraph><p>Здесь <em>xxxx</em> - это имя устройства мыши, а <em>yyyy</em> - тип протокола, используемого мышью. Даемон мыши может автоматически определять тип протокола большинства мышей, за исключением старых, работающих по последовательному интерфейсу. Для выполнения автоматического определения в качестве протокола укажите <code>auto</code>. Если автоматическое определение не работает, то обратитесь к справочным страницам по <a href="https://man.freebsd.org/cgi/man.cgi?query=moused&amp;sektion=8&amp;format=html">moused(8)</a> для получения списка поддерживаемых типов протоколов.</p></div><div class=paragraph><p>Для мыши типа PS/2 добавьте строчку <code>moused_enable="YES"</code> в файл <span class=filename>/etc/rc.conf</span> для запуска даемона мыши во время загрузки системы. Кроме того, для использования даемона мыши во всех виртуальных терминалах, а не только на консоли, добавьте <code>allscreens_flags="-m on"</code> в файле <span class=filename>/etc/rc.conf</span>.</p></div><div class=paragraph><p>После запуска даемона мыши, доступ к мыши должен согласовываться между даемоном мыши и другими программами типа X Window. Обратитесь к вопросу из FAQ<a href=#x-and-moused>Почему моя мышь не работает с X?</a> для получения более полной информации по этому вопросу.</p></div></div><div class=sect3><h4 id=text-mode-cut-paste>4.4.2. Как можно вырезать и копировать текст с помощью мыши в текстовой консоли?<a class=anchor href=#text-mode-cut-paste></a></h4><div class=paragraph><p>Удалить данные с помощью мыши нельзя.
Однако их можно скопировать и вставить.
После запуска даемона мыши, как описано в ответе на <a href=#moused>предыдущий вопрос</a>, нажмите кнопку 1 (левую) и двигайте мышь для выделения текста.
Затем нажмите кнопку 2 (среднюю) для его вставки с позиции текстового курсора.
Нажатие кнопки 3 (правой) "расширит" выбранную текстовую область.</p></div><div class=paragraph><p>Если у вашей мыши отсутствует средняя кнопка, её можно сэмулировать либо переназначить кнопки опциями даемона мыши. Обратитесь к справочным страницам по <a href="https://man.freebsd.org/cgi/man.cgi?query=moused&amp;sektion=8&amp;format=html">moused(8)</a> для получения полной информации.</p></div></div><div class=sect3><h4 id=mouse-wheel-buttons>4.4.3. У моей мыши есть дополнительные колёсико и кнопочки. Можно ли их использовать во FreeBSD?<a class=anchor href=#mouse-wheel-buttons></a></h4><div class=paragraph><p>Ответ, к сожалению, "в зависимости от обстоятельств". Эти мышки с дополнительными возможностями, как правило, требуют наличия специальных драйверов. До тех пор, пока драйвер мыши или прикладная программа не будут иметь отдельную поддержку такой мыши, она будет работать как стандартная двух- или трёхкнопочная мышь.</p></div><div class=paragraph><p>Возможные способы использования колёсиков мыши при работе в X Window описаны в <a href=#x-and-wheel>другом разделе</a>.</p></div></div><div class=sect3><h4 id=keyboard-delete-key>4.4.4. Как использовать клавишу delete в sh и csh?<a class=anchor href=#keyboard-delete-key></a></h4><div class=paragraph><p>Для Bourne Shell добавьте следующие строки в <span class=filename>~/.shrc</span>. Смотрите <a href="https://man.freebsd.org/cgi/man.cgi?query=sh&amp;sektion=1&amp;format=html">sh(1)</a> и <a href="https://man.freebsd.org/cgi/man.cgi?query=editrc&amp;sektion=5&amp;format=html">editrc(5)</a>.</p></div><div class="literalblock programlisting"><div class=content><pre>bind ^[[3~ ed-delete-next-char # for xterm</pre></div></div><div class=paragraph><p>Для C Shell добавьте следующие строки в <span class=filename>~/.cshrc</span>. Смотрите <a href="https://man.freebsd.org/cgi/man.cgi?query=csh&amp;sektion=1&amp;format=html">csh(1)</a>.</p></div><div class="literalblock programlisting"><div class=content><pre>bindkey ^[[3~ delete-char # for xterm</pre></div></div></div></div><div class=sect2><h3 id=compatibility-other>4.5. Другое оборудование<a class=anchor href=#compatibility-other></a></h3><div class=sect3><h4 id=es1370-silent-pcm>4.5.1. Есть ли решение проблемы отсутствия звука при использовании звуковых адаптеров <a href="https://man.freebsd.org/cgi/man.cgi?query=pcm&amp;sektion=4&amp;format=html">pcm(4)</a>?<a class=anchor href=#es1370-silent-pcm></a></h4><div class=paragraph><p>Некоторые звуковые адаптеры при каждой загрузке устанавливают нулевой уровень
громкости выводимого звука. При работе с FreeBSD 13 и более ранними версиями
при каждой загрузке машины выполняйте следующую команду:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># mixer pcm 100 vol 100 cd 100</span></code></pre></div></div><div class=paragraph><p>Используйте следующую команду при работе с FreeBSD 14 и более поздними
версиями:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># mixer pcm.volume=100 vol.volume=100 cd.volume=100</span></code></pre></div></div></div><div class=sect3><h4 id=power-management-support>4.5.2. Поддерживает ли FreeBSD управление энергосбережением на лэптопах?<a class=anchor href=#power-management-support></a></h4><div class=paragraph><p>FreeBSD поддерживает функции ACPI, реализованные в современном оборудовании. Дополнительная информация находится на странице Справочника <a href="https://man.freebsd.org/cgi/man.cgi?query=acpi&amp;sektion=4&amp;format=html">acpi(4)</a>.</p></div></div></div></div></div><div class=sect1><h2 id=troubleshoot>5. Устранение некоторых проблем<a class=anchor href=#troubleshoot></a></h2><div class=sectionbody><div class=sect2><h3 id=_почему_freebsd_определяет_неправильное_количество_памяти_на_аппаратуре_i386>5.1. Почему FreeBSD определяет неправильное количество памяти на аппаратуре i386™?<a class=anchor href=#_почему_freebsd_определяет_неправильное_количество_памяти_на_аппаратуре_i386></a></h3><div class=paragraph><p>Наиболее вероятная причина заключается в различии между адресами физической и виртуальной памяти.</p></div><div class=paragraph><p>Существующее соглашение для большинства оборудования ПК заключается в использовании пространства памяти, лежащей в диапазоне между 3.5 ГБ и 4 ГБ для специальных нужд (обычно для нужд PCI). Это пространство адресов используется для доступа к PCI оборудованию. Как результат, реальная физическая память не может быть получена в данном адресном пространстве.</p></div><div class=paragraph><p>Какие действия выполняются с памятью в данном регионе, зависит от оборудования. К сожалению, некоторое оборудование ничего не выполняет и возможность использовать эти 500 МБ ОЗУ полностью потеряна.</p></div><div class=paragraph><p>К счастью, большинство оборудования перераспределяет память к более верхней позиции, так что она всё ещё может использоваться. Тем не менее, это может вызвать некоторое замешательство при просмотре сообщений, выдаваемых при загрузке.</p></div><div class=paragraph><p>На 32-битной версии FreeBSD кажется, что эта память потерялась, поскольку она переназначится в диапазон выше 4 ГБ, который не доступен для 32 битного ядра. В данном случае, решение заключается в сборке ядра с PAE. За дополнительной информацией обращайтесь к статье об ограничениях памяти.</p></div><div class=paragraph><p>На 64nbsp;битной версии FreeBSD или в случае использования ядра с включённым PAE FreeBSD корректно определит и перераспределит память, так, что она станет годной к использованию. Тем не менее, во время загрузки может показаться, что FreeBSD определяет больше памяти, чем реально имеется в системе из-за описанного перераспределения. Это нормально, и информация о доступной памяти будет скорректирована по окончанию процесса загрузки.</p></div></div><div class=sect2><h3 id=signal11>5.2. Программы аварийно завершают работу с ошибкой Signal 11.<a class=anchor href=#signal11></a></h3><div class=paragraph><p>Ошибки выполнения, связанные с сигналом 11, происходят, когда процесс пытается обратиться к области памяти, доступ к которой ему не был дан операционной системой. Если что-то подобное происходит в случайные, казалось бы, промежутки времени, следует начать поиск причины.</p></div><div class=paragraph><p>Эти проблемы могут быть классифицированы следующим образом:</p></div><div class="olist arabic"><ol class=arabic><li><p>Если проблема возникает только в определённом самостоятельно разработанном приложении, то скорее всего это ошибка в коде.</p></li><li><p>Если это проблема в части базового комплекта системы FreeBSD, то это тоже может быть ошибка в программном коде, хотя в большинстве случаев такие проблемы обнаруживаются и ошибки исправляются задолго до того, как обычным читателям FAQ доводится использовать этот код (именно для этого предназначена версия -CURRENT).</p></li></ol></div><div class=paragraph><p>Вероятно, это не связано с ошибкой во FreeBSD, если проблема проявляется при компиляции программы, и при этом ошибка компилятора каждый раз разная.</p></div><div class=paragraph><p>Например, если запуск <code>make buildworld</code> завершился неудачей при попытке компиляции <span class=filename>ls.c</span> в <span class=filename>ls.o</span> и при повторном запуске компиляция снова прервалась на том же месте, то это ошибка процесса построения. Обновите исходные тексты и попробуйте снова. Если же компиляция прерывается в каком-то другом месте, то причина наиболее вероятно кроется в оборудовании.</p></div><div class=paragraph><p>В первом случае воспользуйтесь отладчиком, к примеру, <a href="https://man.freebsd.org/cgi/man.cgi?query=gdb&amp;sektion=1&amp;format=html">gdb(1)</a>, для нахождения точки программы, в которой делается попытка доступа к неверному адресу, и исправьте эту ошибку.</p></div><div class=paragraph><p>Во втором случае проверьте, какой компонент вашего оборудования неисправен.</p></div><div class=paragraph><p>Среди часто приводящих к этому причин:</p></div><div class="olist arabic"><ol class=arabic><li><p>Жёсткие диски могут перегреваться. Проверьте работоспособность вентиляторов, так как жёсткие диски и другое оборудование могут перегреваться.</p></li><li><p>Процессор перегревается. Это может произойти при разгоне процессора или при поломке процессорного вентилятора.
В любом случае убедитесь, что ваше оборудование работает в нормальном режиме,
как ему и положено, по крайней мере, на момент поиска причин неисправности.
В противном случае сбросьте частоту на настройки по умолчанию.)</p><div class=paragraph><p>Что касается разгона, то медленная система обходится дешевле, чем сгоревшая система, требующая замены!
К тому же проблемы на таких системах не находят понимания общественности.</p></div></li><li><p>Проблемная память. Если установлены различные микросхемы SIMM/DIMM, вытащите их все и попробуйте по одной до локализации проблемы в проблематичной микросхеме DIMM/SIMM, либо их комбинации.</p></li><li><p>Чересчур оптимистичные настройки материнской платы. Настройки BIOS и перемычки на материнской плате предоставляют возможность задавать различные частоты и задержки.
Часто бывает достаточно настроек по умолчанию, но иногда установка слишком малых периодов ожидания для ОЗУ или установка параметра "RAM Speed: Turbo" вызывает странное поведение.
Возможным решением может стать установка параметров BIOS по умолчанию с предварительной записью текущих значений.</p></li><li><p>Неустойчивое или недостаточное электропитание материнской платы.
Уберите неиспользуемые адаптеры ввода/вывода, жёсткие диски и приводы компакт-дисков или отключите их от кабеля электропитания для проверки, что блок питания может работать с меньшей нагрузкой.
Или попробуйте воспользоваться другим блоком питания, желательно большей мощности.
Например, если имеющийся блок питания рассчитан на 250 Ватт, попробуйте другой мощностью 300 Ватт.</p></li></ol></div><div class=paragraph><p>Прочитайте раздел про <a href=#signal11>Signal 11</a> для дальнейшего объяснения и обсуждения, как аппаратура или программное обеспечение для тестирования памяти могут пропускать сбойную память. Подробная информация по этому вопросу содержится в <a href=http://www.bitwizard.nl/sig11/>FAQ по проблеме SIG11</a>.</p></div><div class=paragraph><p>Наконец, если ничего не помогает, то, возможно, это из-за ошибки во FreeBSD. Следуйте <a href=#access-pr>этим инструкциям</a> для отправки сообщения о проблеме.</p></div></div><div class=sect2><h3 id=trap-12-panic>5.3. Моя система аварийно завершает работу с сообщениями Fatal trap 12: page fault in kernel mode либо panic:, и выдаёт много дополнительной информации. Что мне делать?<a class=anchor href=#trap-12-panic></a></h3><div class=paragraph><p>Разработчики FreeBSD интересуются такими ошибками, но им нужно больше информации, чем просто текст ошибки. Скопируйте весь текст сообщения. Затем обратитесь к разделу FAQ об <a href=#kernel-panic-troubleshooting>аварийных завершениях работы ядра</a>, постройте отладочное ядро и получите трассу вызовов. Это может звучать трудной задачей, зато не требует навыков программирования. Просто следуйте указаниям.</p></div></div><div class=sect2><h3 id=proc-table-full>5.4. Что означает сообщение об ошибке maxproc limit exceeded by uid %i, please see tuning(7) and login.conf(5)?<a class=anchor href=#proc-table-full></a></h3><div class=paragraph><p>Ядро FreeBSD позволяет одновременно существовать ограниченному числу процессов. Это зависит от значения переменной <a href="https://man.freebsd.org/cgi/man.cgi?query=sysctl&amp;sektion=8&amp;format=html">sysctl(8)</a> <code>kern.maxusers</code>. <code>kern.maxusers</code> также влияет на другие ограничения ядра, такие как буферы работы с сетью. Если система сильно загружена, поднимите <code>kern.maxusers</code>. Кроме максимального числа процессов это также увеличит значения других параметров, ограничивающих систему.</p></div><div class=paragraph><p>Для корректировки значения <code>kern.maxusers</code> обратитесь к разделу
<a href=https://docs.freebsd.org/ru/books/handbook/config/#kern-maxfiles>Ограничения файлов/процессов</a>
Руководства. В нём говорится об открытых файлах, но те же ограничения касаются
и процессов.</p></div><div class=paragraph><p>Если система загружена слабо, но в ней запущено слишком много процессов, поправьте параметр <code>kern.maxproc</code>, определив его значение в <span class=filename>/boot/loader.conf</span>. Изменение не вступит в силу до перезагрузки системы. За дополнительной информацией, касающейся настройки параметров, обращайтесь к странице Справочника <a href="https://man.freebsd.org/cgi/man.cgi?query=loader.conf&amp;sektion=5&amp;format=html">loader.conf(5)</a>. Если эти процессы запущены одним и тем же пользователем, поправьте значение <code>kern.maxprocperuid</code>, чтобы оно было на единицу меньше, чем новое значение <code>kern.maxproc</code>. Оно должно быть меньше по крайней мере на единицу, потому что системная программа <a href="https://man.freebsd.org/cgi/man.cgi?query=init&amp;sektion=8&amp;format=html">init(8)</a> должна работать всегда.</p></div></div><div class=sect2><h3 id=remote-fullscreen>5.5. Полноэкранные приложения на удалённой машине работают неправильно!<a class=anchor href=#remote-fullscreen></a></h3><div class=paragraph><p>На удалённой машине тип терминала может отличаться от <code>xterm</code>, который требуется для использования консоли FreeBSD. Либо же ядро может иметь неправильные значения ширины и высоты терминала.</p></div><div class=paragraph><p>Проверьте, чтобы переменная окружения <code>TERM</code> имела значение <code>xterm</code>. Если удалённая машина его не поддерживает, попробуйте <code>vt100</code>.</p></div><div class=paragraph><p>Запустите <code>stty -a</code>, чтобы узнать, какие размеры терминала заданы в ядре.
Если значения неправильные, их можно поменять командой <code>stty rows <em>RR</em> cols <em>CC</em></code>.</p></div><div class=paragraph><p>Либо же, если на клиентской машине установлен <a class=package href=https://cgit.freebsd.org/ports/tree/x11/xterm/>x11/xterm</a>, запуск <code>resize</code> позволит узнать у терминала правильные размеры и применить эти значения.</p></div></div><div class=sect2><h3 id=connection-delay>5.6. Почему подключение через ssh или telnet к моему компьютеру занимает так долго времени?<a class=anchor href=#connection-delay></a></h3><div class=paragraph><p>Симптом: между моментом установления TCP-соединения и выдачей клиентским программным обеспечением запроса на ввод пароля (или, в случае использования <a href="https://man.freebsd.org/cgi/man.cgi?query=telnet&amp;sektion=1&amp;format=html">telnet(1)</a>, выдачей приглашения на вход) проходит большой промежуток времени.</p></div><div class=paragraph><p>Проблема: скорее всего, задержка вызвана программным обеспечением на стороне сервера, которое пытается преобразовать IP-адрес клиента в имя хоста.
Многие серверы, включая Telnet и SSH, поставляемые с FreeBSD, делают это для того, чтобы, кроме всего прочего, записать имя хоста в файле журнала для справки администратора.</p></div><div class=paragraph><p>Лечение: Если проблема возникает при подключении клиента к любому серверу, то причина в клиенте. Если проблема возникает только при чьей-либо попытке подключиться к серверу, то проблема в сервере.</p></div><div class=paragraph><p>Если проблема с клиентом, то единственным методом ее решения является исправление DNS, чтобы сервер смог распознать вашу машину. Если это происходит в локальной сети, то предположите, что это проблема с сервером, и продолжайте чтение. Если это происходит в сети Интернет, обратитесь к вашему провайдеру.</p></div><div class=paragraph><p>Если проблема с сервером в локальной сети, настройте сервер для разрешения запросов на преобразование адреса в имя хоста в диапазоне локальных адресов. Обратитесь к страницам Справочника по <a href="https://man.freebsd.org/cgi/man.cgi?query=hosts&amp;sektion=5&amp;format=html">hosts(5)</a> и <a href="https://man.freebsd.org/cgi/man.cgi?query=named&amp;sektion=8&amp;format=html">named(8)</a> для получения более подробной информации. Если это происходит в сети Интернет, то проблема может заключаться в некорректной работе ресолвера локального сервера. Для проверки попробуйте получить адрес другого хоста, такого как <code>www.yahoo.com</code>. Если это не работает, то в этом и состоит проблема.</p></div><div class=paragraph><p>Из-за свежей установки FreeBSD, также возможно, что информация о домене и сервере имён отсутствует в <span class=filename>/etc/resolv.conf</span>. Это часто будет вызывать задержку в работе SSH, так как опция <code>UseDNS</code> по умолчанию установлена в значение <code>yes</code> в <span class=filename>/etc/ssh/sshd_config</span>. Если именно это является причиной проблемы, то добавьте недостающую информацию в <span class=filename>/etc/resolv.conf</span>, либо в качестве временной меры установите <code>UseDNS</code> в <code>no</code> в файле <span class=filename>sshd_config</span>.</p></div></div><div class=sect2><h3 id=file-table-full>5.7. Почему в <a href="https://man.freebsd.org/cgi/man.cgi?query=dmesg&amp;sektion=8&amp;format=html">dmesg(8)</a> регулярно выводятся сообщения file: table is full?<a class=anchor href=#file-table-full></a></h3><div class=paragraph><p>Такое сообщение об ошибке сигнализирует о том, что в системе закончились
доступные файловые дескрипторы. Обратитесь к разделу
<a href=https://docs.freebsd.org/ru/books/handbook/config/#kern-maxfiles>kern.maxfiles</a> главы о
<a href=https://docs.freebsd.org/ru/books/handbook/config/#configtuning-kernel-limits>настройке ограничений ядра</a> Руководства для выяснения всех подробностей и поиска решения.</p></div></div><div class=sect2><h3 id=computer-clock-skew>5.8. Почему часы на моем компьютере показывают неправильное время?<a class=anchor href=#computer-clock-skew></a></h3><div class=paragraph><p>На компьютере установлено по меньшей мере два таймера, и FreeBSD выбрала не тот.</p></div><div class=paragraph><p>Запустите <a href="https://man.freebsd.org/cgi/man.cgi?query=dmesg&amp;sektion=8&amp;format=html">dmesg(8)</a> и посмотрите строки, содержащие слово <code>Timecounter</code>. FreeBSD выбирает таймер с наибольшим значением качества.</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># dmesg | grep Timecounter</span>
Timecounter <span class=s2>&#34;i8254&#34;</span> frequency 1193182 Hz quality 0
Timecounter <span class=s2>&#34;ACPI-fast&#34;</span> frequency 3579545 Hz quality 1000
Timecounter <span class=s2>&#34;TSC&#34;</span> frequency 2998570050 Hz quality 800
Timecounters tick every 1.000 msec</code></pre></div></div><div class=paragraph><p>Удостоверьтесь в этом, проверив <a href="https://man.freebsd.org/cgi/man.cgi?query=sysctl&amp;sektion=3&amp;format=html">sysctl(3)</a>-переменную <code>kern.timecounter.hardware</code>.</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># sysctl kern.timecounter.hardware</span>
kern.timecounter.hardware: ACPI-fast</code></pre></div></div><div class=paragraph><p>Это может быть неработающий таймер ACPI. Самым простым решением будет отключить таймер ACPI в <span class=filename>/boot/loader.conf</span>:</p></div><div class="literalblock programlisting"><div class=content><pre>debug.acpi.disabled=&#34;timer&#34;</pre></div></div><div class=paragraph><p>Либо же BIOS может изменить частоту таймера TSC - возможно, для изменения скорости работы процессора при работе от батареи или переводя в режим пониженного электропитания, но FreeBSD не отслеживает это, и в результате часы начинают спешить или отставать.</p></div><div class=paragraph><p>В этом примере имеется также и таймер <code>i8254</code>, и он может быть выбран записью его имени в <a href="https://man.freebsd.org/cgi/man.cgi?query=sysctl&amp;sektion=3&amp;format=html">sysctl(3)</a>-переменную <code>kern.timecounter.hardware</code>.</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># sysctl kern.timecounter.hardware=i8254</span>
kern.timecounter.hardware: TSC -&gt; i8254</code></pre></div></div><div class=paragraph><p>Теперь компьютер должен аккуратнее следить за временем.</p></div><div class=paragraph><p>Чтобы это изменение вступало в силу во время загрузки системы, добавьте в файл <span class=filename>/etc/sysctl.conf</span> такую строчку:</p></div><div class="literalblock programlisting"><div class=content><pre>kern.timecounter.hardware=i8254</pre></div></div></div><div class=sect2><h3 id=_что_означает_сообщение_swap_pager_indefinite_wait_buffer>5.9. Что означает сообщение swap_pager: indefinite wait buffer:?<a class=anchor href=#_что_означает_сообщение_swap_pager_indefinite_wait_buffer></a></h3><div class=paragraph><p>Это значит, что процесс пытается считать страницу памяти с
диска, но попытки сделать это оканчиваются неудачно в течение
более 20 секунд. Это может быть вызвано повреждёнными блоками
на диске, кабелями, подключением или другим оборудованием ввода/вывода. Если диск сам по себе повреждён, вы также увидите ошибки работы с диском в <span class=filename>/var/log/messages</span> и в выводе <code>dmesg</code>. В противном случае проверьте кабели и подключения.</p></div></div><div class=sect2><h3 id=lock-order-reversal>5.10. Что такое lock order reversal?<a class=anchor href=#lock-order-reversal></a></h3><div class=paragraph><p>Ядро FreeBSD использует несколько блокировок для арбитража доступа к соответствующим ресурсам.
Когда несколько потоков в ядре пытаются захватить несколько блокировок подряд, всегда существует возможность появления мёртвой блокировки (deadlock), где два потока захватили по одной блокировке и заблокированы в ожидании освобождения другим потоком второй блокировки.
Такой проблемы синхронизации можно избежать, если все потоки получают блокировки в одинаковом порядке.</p></div><div class=paragraph><p>Система диагностирования блокировок <a href="https://man.freebsd.org/cgi/man.cgi?query=witness&amp;sektion=4&amp;format=html">witness(4)</a>, которая по умолчанию включена во FreeBSD-CURRENT и выключена для стабильных веток и релизов, определяет возможность появления мёртвых блокировок из-за ошибок их использования, включая захват нескольких блокировок в различном порядке в разных частях ядра.
Механизм <a href="https://man.freebsd.org/cgi/man.cgi?query=witness&amp;sektion=4&amp;format=html">witness(4)</a> пытается обнаруживать эту проблему по мере её появления и сообщает о ней на системную консоль сообщением <code>lock order reversal</code> (которое также часто называют LOR).</p></div><div class=paragraph><p>В силу консервативности <a href="https://man.freebsd.org/cgi/man.cgi?query=witness&amp;sektion=4&amp;format=html">witness(4)</a> возможны ложные срабатывания.
При правильном срабатывании такое сообщение <em>не</em> означает, что система находится в состоянии мёртвой блокировки; его следует рассматривать как предупреждение о том, что в этом месте могла произойти мёртвая блокировка.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Плохие LOR обычно быстро исправляют, поэтому перед написанием сообщения в списки рассылки следует проверить архивы <a href=https://lists.FreeBSD.org/subscription/freebsd-current>Список рассылки, посвящённый обсуждению FreeBSD-CURRENT</a>.</p></div></td></tr></tbody></table></div></div><div class=sect2><h3 id=called-with-non-sleepable-locks-held>5.11. Что означают сообщения <code>Called …​ with the following non-sleepable locks held</code>?<a class=anchor href=#called-with-non-sleepable-locks-held></a></h3><div class=paragraph><p>Это означает, что функция, которая может находиться в "спящем" состоянии была вызвана во время использования мьютекс (или другого не "засыпающего") блокирования.</p></div><div class=paragraph><p>Объяснением того, что это ошибка, является то, что мьютексы не предполагают нахождения в удерживаемом состоянии длительные промежутки времени, и блокируются только на короткие периоды синхронизации.
Это правило позволяет драйверам устройств использовать мьютексы для синхронизации с остальной частью ядра во время прерываний.
Прерывания (во FreeBSD) могут находиться не в "спящем состоянии". Следовательно необходимо, чтобы не было подсистем в ядре, которые бы занимались блокировкой длительный период, используя мьютекс.</p></div><div class=paragraph><p>Для нахождения таких ошибок в ядро могут быть добавлены assertions, которые будут взаимодействовать с подсистемой <a href="https://man.freebsd.org/cgi/man.cgi?query=witness&amp;sektion=4&amp;format=html">witness(4)</a> для генерирования предупреждения или фатальной ошибки (в зависимости от системной конфигурации) в случаях когда производится потенциально блокирующий вызов с удержанием мьютекса.</p></div><div class=paragraph><p>В общем, такие предупреждения не критичны, но тем не менее, с неудачной синхронизацией (timing) они могут вызвать нежелательные эффекты, начиная от незначительной задержки в ответной реакции системы до полной её блокировки.</p></div><div class=paragraph><p>Дополнительная информация о синхронизации во FreeBSD находится на странице Справочника <a href="https://man.freebsd.org/cgi/man.cgi?query=locking&amp;sektion=9&amp;format=html">locking(9)</a>.</p></div></div><div class=sect2><h3 id=touch-not-found>5.12. Почему процесс buildworld/installworld завершается с сообщением touch: not found?<a class=anchor href=#touch-not-found></a></h3><div class=paragraph><p>Эта ошибка не означает, что не найдена утилита <a href="https://man.freebsd.org/cgi/man.cgi?query=touch&amp;sektion=1&amp;format=html">touch(1)</a>. Ошибка наверняка появляется из-за того, что даты модификации файлов установлены в будущем. Если CMOS часы установлены на локальное время, отрегулируйте часовой механизм ядра, запустив команду <code>adjkerntz -i</code> в однопользовательском режиме.</p></div></div></div></div><div class=sect1><h2 id=applications>6. Прикладные программы<a class=anchor href=#applications></a></h2><div class=sectionbody><div class=sect2><h3 id=_где_находятся_все_прикладные_программы>6.1. Где находятся все прикладные программы?<a class=anchor href=#_где_находятся_все_прикладные_программы></a></h3><div class=paragraph><p>Обратитесь на <a href=https://www.FreeBSD.org/ports/>страницу портов</a>, содержащую
информацию о программных продуктах, перенесённых во FreeBSD.</p></div><div class=paragraph><p>Большинство портов должно нормально работать во всех поддерживаемых версиях FreeBSD. Неработоспособные порты специально помечаются соответствующим образом. При выходе нового релиза FreeBSD в него в каталог <span class=filename>ports/</span> также включается актуальная на момент выхода Коллекция Портов.</p></div><div class=paragraph><p>FreeBSD умеет работать со сжатыми двоичными пакетами для упрощения установки и удаления портов. Используйте <a href="https://man.freebsd.org/cgi/man.cgi?query=pkg&amp;sektion=7&amp;format=html">pkg(7)</a> для управления процессом установки пакетов.</p></div></div><div class=sect2><h3 id=how-do-download-ports-tree>6.2. Как загрузить дерево Портов? Следует ли использовать Git?<a class=anchor href=#how-do-download-ports-tree></a></h3><div class=paragraph><p>Обратитесь к разделу
<a href=https://docs.freebsd.org/ru/books/handbook/ports/#ports-using-installation-methods>Установка Коллекции Портов</a>.</p></div></div><div class=sect2><h3 id=ports-4x>6.3. Почему этот порт не компилируется на моей машине с 12.X - или 13.X -STABLE?<a class=anchor href=#ports-4x></a></h3><div class=paragraph><p>Если установленная версия FreeBSD значительно отстаёт от <em>-CURRENT</em> или
<em>-STABLE</em>, обновите Коллекцию Портов, следуя указаниям раздела
<a href=https://docs.freebsd.org/ru/books/handbook/ports/#ports-using>Использование Коллекции Портов</a>. Если
система находится в актуальном состоянии, то, возможно, кто-то внёс изменение в
порт, который работоспособен в <em>-CURRENT</em>, но
не работает в <em>-STABLE</em>. <a href=https://bugs.FreeBSD.org/submit/>Отправьте</a>
сообщение об ошибке, так как предполагается, что Коллекция Портов
работает как для ветки <em>-CURRENT</em>, так и <em>-STABLE</em>.</p></div></div><div class=sect2><h3 id=make-index>6.4. Я попытался сформировать файл INDEX командой make index, однако попытка окончилась неудачей. Почему?<a class=anchor href=#make-index></a></h3><div class=paragraph><p>Первым делом убедитесь, что Коллекция Портов находится в актуальном состоянии. Ошибки, которые отражаются на построении файла <span class=filename>INDEX</span> из актуальной копии Коллекции Портов, бросаются в глаза и поэтому практически всегда исправляются немедленно.</p></div><div class=paragraph><p>В редких случаях <span class=filename>INDEX</span> не перестраивается из-за странных
комбинаций значений переменных <code>OPTIONS_SET</code>, заданных в
файле <span class=filename>make.conf</span>. Если вы подозреваете, что
дело именно в этом, то, прежде чем сообщать об этом в <a href=https://lists.FreeBSD.org/subscription/freebsd-ports>Список рассылки, посвящённый Портам FreeBSD</a>,
попытайтесь сформировать <span class=filename>INDEX</span> с отключенными значениями этих
переменных.</p></div></div><div class=sect2><h3 id=ports-update>6.5. Я обновил исходные тексты. Как теперь обновить установленные порты?<a class=anchor href=#ports-update></a></h3><div class=paragraph><p>С FreeBSD не поставляется инструмент обновления портов, но есть несколько инструментов, немного облегчающих этот процесс. Кроме того, для упрощения работы с портами доступны дополнительные инструменты; смотрите раздел Руководства FreeBSD <a href=https://docs.freebsd.org/ru/books/handbook/ports/#ports-using>об обновлении портов</a>.</p></div></div><div class=sect2><h3 id=ports-major-upgrade>6.6. Нужно ли мне перекомпилировать все порты каждый раз, когда я выполняю мажорное обновление (со сменой старшей версии FreeBSD)?<a class=anchor href=#ports-major-upgrade></a></h3><div class=paragraph><p>Да!
Хотя на новой системе программное обеспечение, скомпилированное под более старый релиз, будет работать, но только до тех пор, пока вы не начнёте устанавливать другие порты или обновлять существующие.</p></div><div class=paragraph><p>Когда система обновляется, различные совместно используемые библиотеки, загружаемые модули и другие части системы замещаются более новыми версиями. Приложения, скомпонованные с более старыми версиями, могут перестать запускаться либо начнут функционировать неправильно.</p></div><div class=paragraph><p>Для получения дополнительной информации обращайтесь к
<a href="https://docs.freebsd.org/ru/books/handbook/cutting-edge/#посвящённому обновлениям">разделу</a>
Руководства по FreeBSD.</p></div></div><div class=sect2><h3 id=ports-minor-upgrade>6.7. Нужно ли мне перекомпилировать все порты каждый раз, когда я выполняю минорное обновление (без изменения старшей версии FreeBSD)?<a class=anchor href=#ports-minor-upgrade></a></h3><div class=paragraph><p>В общем случае этого не требуется.
Разработчики FreeBSD делают всё возможное для сохранения двоичной совместимости между всеми релизами в пределах одной старшей версии. Любые исключения из этого правила документируются в "Примечаниях к релизу", и там же даются советы, которых следует придерживаться.</p></div></div><div class=sect2><h3 id=minimal-sh>6.8. Почему возможности /bin/sh так малы? Почему бы во FreeBSD не использовать bash или какой-либо другой командный процессор?<a class=anchor href=#minimal-sh></a></h3><div class=paragraph><p>Многим требуется, чтобы разрабатываемые скрипты для командного процессора были переносимы между многими системами. Именно поэтому в POSIX® очень подробно описан командный процессор и набор утилит. Большинство скриптов пишутся на языке процессора Bourne shell (<a href="https://man.freebsd.org/cgi/man.cgi?query=sh&amp;sektion=1&amp;format=html">sh(1)</a>), к тому же некоторые важные программные вызовы (<a href="https://man.freebsd.org/cgi/man.cgi?query=make&amp;sektion=1&amp;format=html">make(1)</a>, <a href="https://man.freebsd.org/cgi/man.cgi?query=system&amp;sektion=3&amp;format=html">system(3)</a>, <a href="https://man.freebsd.org/cgi/man.cgi?query=popen&amp;sektion=3&amp;format=html">popen(3)</a> и их аналоги на языках скриптов высокого уровня, таких как Perl или Tcl) предполагают для интерпретации команд использование именно Bourne shell. Так как Bourne shell используется столь широко и часто, то очень важно, чтобы он стартовал очень быстро, его поведение было строго регламентировано и при этом потребности в оперативной памяти были малы.</p></div><div class=paragraph><p>В имеющейся реализации мы приложили максимум усилий для воплощения в жизнь всех этих требований одновременно. Для того, чтобы сохранить <code>/bin/sh</code> небольшим по размеру, мы не включили многие из обычных возможностей, которые имеются в других командных процессорах. Для этого имеются в наличии командные процессоры, обладающие гораздо большими возможностями, такие как <code>bash</code>, <code>scsh</code>, <a href="https://man.freebsd.org/cgi/man.cgi?query=tcsh&amp;sektion=1&amp;format=html">tcsh(1)</a> и <code>zsh</code>. Сравните использование памяти этими оболочками, посмотрев в колонки "VSZ" и "RSS" вывода команды <code>ps -u</code>.</p></div></div></div></div><div class=sect1><h2 id=kernelconfig>7. Конфигурирование ядра<a class=anchor href=#kernelconfig></a></h2><div class=sectionbody><div class=sect2><h3 id=make-kernel>7.1. Я хочу изменить настройки ядра. Это сложно?<a class=anchor href=#make-kernel></a></h3><div class=paragraph><p>Вовсе нет!
Обратитесь к <a href=https://docs.freebsd.org/ru/books/handbook/kernelconfig/>разделу о настройке ядра</a>
Руководства, который посвящён этому вопросу.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Новый файл <span class=filename>kernel</span> будет установлен в каталог <span class=filename>/boot/kernel</span> вместе со своими модулями, а старое ядро и его модули будут перемещены в каталог <span class=filename>/boot/kernel.old</span>.
Если сделана ошибка в конфигурации, просто загрузите предыдущую версию ядра.</p></div></td></tr></tbody></table></div></div><div class=sect2><h3 id=why-kernel-big>7.2. Почему моё ядро такое большое?<a class=anchor href=#why-kernel-big></a></h3><div class=paragraph><p>Ядра <code>GENERIC</code>, поставляемые в составе FreeBSD, компилируется в <em>режиме отладки</em>.
Ядра, построенные в таком режиме, содержат отладочную информацию, которая хранится в отдельных файлах, используемых для отладки.
Файлы для отладки размещаются в <span class=filename>/usr/lib/debug/boot/kernel/</span>.
Заметьте, что снижения производительности при использовании отладочного ядра нет или оно незначительно, и отладочное ядро полезно иметь под рукой на случай аварийного завершения работы системы.</p></div><div class=paragraph><p>При нехватке дискового пространства существует несколько вариантов уменьшения размера <span class=filename>/boot/kernel/</span> и <span class=filename>/usr/lib/debug/</span>.</p></div><div class=paragraph><p>Чтобы не устанавливать файлы с символьной информацией, убедитесь в наличии следующей строки в <span class=filename>/etc/src.conf</span>:</p></div><div class="literalblock programlisting"><div class=content><pre>WITHOUT_KERNEL_SYMBOLS=yes</pre></div></div><div class=paragraph><p>Для получения дополнительной информации смотрите страницу Справочника <a href="https://man.freebsd.org/cgi/man.cgi?query=src.conf&amp;sektion=5&amp;format=html">src.conf(5)</a>.</p></div><div class=paragraph><p>Если вы хотите совсем избежать создания файлов для отладки, убедитесь в
выполнении следующих двух условий:</p></div><div class=ulist><ul><li><p>В конфигурационном файле ядра нет такой строчки:</p><div class="literalblock programlisting"><div class=content><pre>makeoptions DEBUG=-g</pre></div></div></li><li><p>Вы не запускали утилиту <a href="https://man.freebsd.org/cgi/man.cgi?query=config&amp;sektion=8&amp;format=html">config(8)</a> с опцией <code>-g</code>.</p></li></ul></div><div class=paragraph><p>В любой из вышеописанных ситуаций ядро будет построено с отладочным режимом.</p></div><div class=paragraph><p>Чтобы скомпилировать и установить только нужные модули, укажите их в <span class=filename>/etc/make.conf</span>:</p></div><div class="literalblock programlisting"><div class=content><pre>MODULES_OVERRIDE= accf_http ipfw</pre></div></div><div class=paragraph><p>Замените <em>accf_httpd ipfw</em> на нужный список модулей. Это уменьшит размер
каталога с ядром, а также время сборки. Для получения дополнительной
информации почитайте <span class=filename>/usr/share/examples/etc/make.conf</span>.</p></div><div class=paragraph><p>Для дальнейшего уменьшения размера также можно удалить ненужные устройства из ядра. Для получения дополнительной информации смотрите <a href=#make-kernel>Я хочу изменить настройки ядра. Это сложно?</a>.</p></div><div class=paragraph><p>Для вступления любого из этих действий в силу следуйте указаниям по
<a href=https://docs.freebsd.org/ru/books/handbook/kernelconfig/#kernelconfig-building>сборке и установке</a> нового ядра.</p></div><div class=paragraph><p>К вашему сведению, примерный размер ядра FreeBSD 11 amd64
(<span class=filename>/boot/kernel/kernel</span>) составляет 25 Mбайт.</p></div></div><div class=sect2><h3 id=_почему_мне_не_удаётся_откомпилировать_ни_один_вариант_ядра_даже_generic>7.3. Почему мне не удаётся откомпилировать ни один вариант ядра, даже GENERIC?<a class=anchor href=#_почему_мне_не_удаётся_откомпилировать_ни_один_вариант_ядра_даже_generic></a></h3><div class=paragraph><p>Есть несколько причин, приводящих к возникновению этой проблемы:</p></div><div class=ulist><ul><li><p>Дерево исходных текстов отличается от того, что использовалось для построения
работающей в данный момент системы.
Перед обновлением прочитайте файл <span class=filename>/usr/src/UPDATING</span>, обращая
особое внимание на раздел "COMMON ITEMS" в его конце.</p></li><li><p>Выполнение команды <code>make buildkernel</code> не было успешно завершено. Корректное
исполнение задачи <code>make buildkernel</code> зависит от файлов, полученных после
выполнения <code>make buildworld</code>.</p></li><li><p>Даже при построении <a href=#stable>FreeBSD-STABLE</a> возможно, что дерево исходных
текстов было загружено в тот момент, когда оно модифицировалось или было
неработоспособно.
Построение гарантируется только для релизов, хотя в большинстве случаев
<a href=#stable>FreeBSD-STABLE</a> строится без проблем.
Попробуйте сгрузить дерево исходных текстов повторно и посмотрите, решилась
ли проблема. Если с зеркалирующим сервером есть проблемы, попробуйте
использовать другое зеркало.</p></li></ul></div></div><div class=sect2><h3 id=scheduler-in-use>7.4. Какой планировщик используется в работающей системе?<a class=anchor href=#scheduler-in-use></a></h3><div class=paragraph><p>Название используемого планировщика доступно напрямую в виде значения sysctl-параметра <code>kern.sched.name</code>:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>% sysctl kern.sched.name
kern.sched.name: ULE</code></pre></div></div></div><div class=sect2><h3 id=_что_такое_kern_sched_quantum>7.5. Что такое kern.sched.quantum?<a class=anchor href=#_что_такое_kern_sched_quantum></a></h3><div class=paragraph><p><code>kern.sched.quantum</code> определяет максимальное количество тактов, которое процесс может выполняться, не будучи прерванным.</p></div></div></div></div><div class=sect1><h2 id=_диски_файловые_системы_и_начальные_загрузчики>8. Диски, файловые системы и начальные загрузчики<a class=anchor href=#_диски_файловые_системы_и_начальные_загрузчики></a></h2><div class=sectionbody><div class=sect2><h3 id=adding-disks>8.1. Как добавить в систему новый диск?<a class=anchor href=#adding-disks></a></h3><div class=paragraph><p>Обратитесь к разделу <a href=https://docs.freebsd.org/ru/books/handbook/disks/#disks-adding>Добавление дисков</a> Руководства по FreeBSD.</p></div></div><div class=sect2><h3 id=new-huge-disk>8.2. Как перенести систему на большой новый диск?<a class=anchor href=#new-huge-disk></a></h3><div class=paragraph><p>Самый лучший способ заключается в переустановке операционной системы на новый диск с последующим переносом пользовательских данных. Это настоятельно рекомендуется при отслеживании ветки <em>-STABLE</em> в течение более одного релиза или при обновлении релиза вместо установки нового. Установите booteasy на оба диска с помощью <a href="https://man.freebsd.org/cgi/man.cgi?query=boot0cfg&amp;sektion=8&amp;format=html">boot0cfg(8)</a> и выполняйте загрузку с любого из них, пока не будете довольны новой конфигурацией. Пропустите следующий абзац, чтобы перейти к вопросу переноса данных после этой операции.</p></div><div class=paragraph><p>Либо разбейте на разделы и разметьте новый диск с помощью <a href="https://man.freebsd.org/cgi/man.cgi?query=sade&amp;sektion=8&amp;format=html">sade(8)</a> или <a href="https://man.freebsd.org/cgi/man.cgi?query=gpart&amp;sektion=8&amp;format=html">gpart(8)</a>. Если диски отформатированы в MBR, то booteasy можно установить на оба диска с помощью <a href="https://man.freebsd.org/cgi/man.cgi?query=boot0cfg&amp;sektion=8&amp;format=html">boot0cfg(8)</a> для того, чтобы иметь возможность выполнять загрузку как старой, так и новой системы после выполнения копирования.</p></div><div class=paragraph><p>После подготовки диска данные нельзя просто так взять и перенести. Используйте для этого инструменты, которые учитывают файлы устройств и системные флаги, например, <a href="https://man.freebsd.org/cgi/man.cgi?query=dump&amp;sektion=8&amp;format=html">dump(8)</a>. И хотя рекомендуется выполнять перенос данных в однопользовательском режиме, это не является обязательным условием.</p></div><div class=paragraph><p>Если на дисках стоит UFS, никогда не используйте ничего, кроме <a href="https://man.freebsd.org/cgi/man.cgi?query=dump&amp;sektion=8&amp;format=html">dump(8)</a> и <a href="https://man.freebsd.org/cgi/man.cgi?query=restore&amp;sektion=8&amp;format=html">restore(8)</a> для переноса корневой файловой системы. Эти команды также следует использовать при переносе отдельного раздела на другой пустой раздел. Последовательность шагов при использовании <code>dump</code> для переноса данных с раздела UFS на новый раздел:</p></div><div class="exampleblock procedure"><div class=content><div class="olist arabic"><ol class=arabic><li><p>выполните команду <code>newfs</code> над новым разделом.</p></li><li><p>командой <code>mount</code> смонтируйте его во временный каталог.</p></li><li><p>командой <code>cd</code> перейдите в этот каталог.</p></li><li><p>выполните команду <code>dump</code> над старым разделом, направив вывод в новый раздел.</p></li></ol></div></div></div><div class=paragraph><p>Например, чтобы перенести корневую файловую систему на устройство <span class=filename>/dev/ada1s1a</span> с использованием каталога <span class=filename>/mnt</span> в качестве временной точки монтирования, наберите:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># newfs /dev/ad1as1a</span>
<span class=c># mount /dev/ad1as1a /mnt</span>
<span class=c># cd /mnt</span>
<span class=c># dump 0af - / | restore rf -</span></code></pre></div></div><div class=paragraph><p>Переразбиение разделов с использованием <code>dump</code> требует несколько больше усилий. Для объединения раздела типа <span class=filename>/var</span> с его вышестоящим разделом, создайте новый раздел, достаточно большой для размещения их обоих, переместите вышестоящий раздел так, как это описано выше, а затем переместите нижестоящий раздел в пустой каталог, созданный при первом перемещении:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># newfs /dev/ada1s1a</span>
<span class=c># mount /dev/ad1as1a /mnt</span>
<span class=c># cd /mnt</span>
<span class=c># dump 0af - / | restore rf -</span>
<span class=c># cd var</span>
<span class=c># dump 0af - /var | restore rf -</span></code></pre></div></div><div class=paragraph><p>Для отделения каталога от вышестоящего, скажем, для размещения <span class=filename>/var</span> в собственном разделе, которого не было, создайте оба раздела, затем смонтируйте нижестоящий раздел в подходящий каталог во временную точку монтирования, а затем переместите старый единый раздел:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># newfs /dev/ada1s1a</span>
<span class=c># newfs /dev/ada1s1d</span>
<span class=c># mount /dev/ada1s1a /mnt</span>
<span class=c># mkdir /mnt/var</span>
<span class=c># mount /dev/ada1s1d /mnt/var</span>
<span class=c># cd /mnt</span>
<span class=c># dump 0af - / | restore rf -</span></code></pre></div></div><div class=paragraph><p>Для перемещения пользовательских данных также имеются программы <a href="https://man.freebsd.org/cgi/man.cgi?query=cpio&amp;sektion=1&amp;format=html">cpio(1)</a> и <a href="https://man.freebsd.org/cgi/man.cgi?query=pax&amp;sektion=1&amp;format=html">pax(1)</a>. Известно, что они теряют информацию о флагах файлов, так что используйте их с осторожностью.</p></div></div><div class=sect2><h3 id=safe-softupdates>8.3. На каких разделах можно без опаски использовать механизм Soft Updates? Я слышал, что использование Soft Updates на / могут приводить к проблемам. Что насчёт журналируемых Soft Updates?<a class=anchor href=#safe-softupdates></a></h3><div class=paragraph><p>Краткий ответ: обычно Soft Updates можно использовать без опаски на всех разделах.</p></div><div class=paragraph><p>Подробный ответ: Soft Updates имеют две характеристики, которые могут быть нежелательны на некоторых разделах. Во-первых, раздел с Soft Updates имеет небольшой шанс потери данных по время аварийного останова системы. Раздел не будет попорчен, поскольку данные будет просто потеряны. Во-вторых, Soft Updates могут приводить к временной нехватке дискового пространства.</p></div><div class=paragraph><p>При использовании Soft Updates ядро может задерживать до тридцати секунд запись изменений на физический диск. При удалении большого файла он остается на диске, пока ядро не выполнит фактическое удаление. Это может привести к очень простой гонке. Предположим, удаляется один большой файл и тут же создаётся другой большой файл. Первый файл на самом деле ещё не удалён с диска, поэтому для второго файла на диске может не хватить места. Это приведёт к ошибке о том, что на разделе нет достаточного пространства, несмотря на то, что только что освободилось много места. Через пару секунд создание файла сработает, как и ожидалось.</p></div><div class=paragraph><p>Если система может аварийно остановиться после того, как ядро примет набор данных для записи на диск, но перед тем, как данные реально запишутся, то данные могут потеряться. Такой риск чрезвычайно мал, но в целом управляем.</p></div><div class=paragraph><p>Эти проблемы влияют на все разделы, использующие Soft Updates. Итак, что это означает для корневого раздела?</p></div><div class=paragraph><p>Жизненно важная информация на корневом разделе меняется очень редко. Если в системе произойдет сбой в период тридцатисекундного окна после выполнения такого изменения, возможно, что данные окажутся потерянными. Этот риск незначителен для большинства применений, но его нужно учитывать. Если система не может принять такой риск, не используйте Soft Updates с корневой файловой системой!</p></div><div class=paragraph><p><span class=filename>/</span> традиционно является одним из самых маленьких разделов. Если каталог <span class=filename>/tmp</span> размещён в <span class=filename>/</span> и у вас заполнен <span class=filename>/tmp</span>, то могут периодически возникать проблемы с дисковым пространством. Создание символической ссылки <span class=filename>/tmp</span>, указывающей на <span class=filename>/var/tmp</span> решит эту проблему.</p></div><div class=paragraph><p>В заключение, <a href="https://man.freebsd.org/cgi/man.cgi?query=dump&amp;sektion=8&amp;format=html">dump(8)</a> не работает в режиме реального времени (-L) с файловой системой, для которой включены журналируемые Soft Updates (SU+J).</p></div></div><div class=sect2><h3 id=_можно_ли_смонтировать_другие_файловые_системы>8.4. Можно ли смонтировать другие файловые системы?<a class=anchor href=#_можно_ли_смонтировать_другие_файловые_системы></a></h3><div class=paragraph><p>FreeBSD поддерживает ряд других файловых систем.</p></div><div class=dlist><dl><dt class=hdlist1>UFS</dt><dd><p>Компакт-диски с файловой системой UFS могут быть смонтированы без всяких проблем.
Монтирование файловых систем Digital UNIX или других систем, поддерживающих UFS, может быть более сложным, в зависимости от особенностей разбиения диска конкретной операционной системой.</p></dd><dt class=hdlist1>ext2/ext3</dt><dd><p>FreeBSD поддерживает разделы <code>ext2fs</code>, <code>ext3fs</code> и <code>ext4fs</code>. За дополнительной
информацией обратитесь к странице Справочника <a href="https://man.freebsd.org/cgi/man.cgi?query=ext2fs&amp;sektion=5&amp;format=html">ext2fs(5)</a>.</p></dd><dt class=hdlist1>NTFS</dt><dd><p>Поддержка NTFS, реализованная на базе FUSE, доступна в виде порта
<a class=package href=https://cgit.freebsd.org/ports/tree/sysutils/fusefs-ntfs/>sysutils/fusefs-ntfs</a>. Для получения более полной информации
обратитесь к <a href="https://man.freebsd.org/cgi/man.cgi?query=ntfs-3g&amp;sektion=8&amp;format=html">ntfs-3g(8)</a>.</p></dd><dt class=hdlist1>FAT</dt><dd><p>Во FreeBSD имеется драйвер для работы с FAT в режиме чтения-записи. Для получения дополнительной информации обратитесь к странице справочника <a href="https://man.freebsd.org/cgi/man.cgi?query=mount_msdosfs&amp;sektion=8&amp;format=html">mount_msdosfs(8)</a>.</p></dd><dt class=hdlist1>ZFS</dt><dd><p>FreeBSD включает в себя портированную из Sun™ реализацию файловой системы ZFS. В настоящее время рекомендуется использовать её только на платформе amd64 с достаточным объемом памяти. Для получения более полной информации обратитесь к странице Справочника <a href="https://man.freebsd.org/cgi/man.cgi?query=zfs&amp;sektion=8&amp;format=html">zfs(8)</a>.</p></dd></dl></div><div class=paragraph><p>FreeBSD включает сетевую файловую систему NFS. В Коллекции портов FreeBSD имеется несколько приложений FUSE для поддержки многих других файловых систем.</p></div></div><div class=sect2><h3 id=mount-dos>8.5. Как смонтировать вторичный раздел DOS?<a class=anchor href=#mount-dos></a></h3><div class=paragraph><p>Вторичные разделы DOS находятся после <em>всех</em> первичных разделов.
Например, если "E" является вторым разделом DOS на втором диске SCSI, то в
каталоге <span class=filename>/dev</span> будет находиться файл устройства для "слайса 5".
Чтобы его смонтировать, выполните следующую команду:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># mount -t msdosfs /dev/da1s5 /dos/e</span></code></pre></div></div></div><div class=sect2><h3 id=crypto-file-system>8.6. Существует ли криптографическая файловая система для FreeBSD?<a class=anchor href=#crypto-file-system></a></h3><div class=paragraph><p>Да, <a href="https://man.freebsd.org/cgi/man.cgi?query=gbde&amp;sektion=8&amp;format=html">gbde(8)</a> и <a href="https://man.freebsd.org/cgi/man.cgi?query=geli&amp;sektion=8&amp;format=html">geli(8)</a>. Обратитесь к разделу
<a href=https://docs.freebsd.org/ru/books/handbook/disks/#disks-encrypting>Шифрование дисковых разделов</a>
Руководства по FreeBSD.</p></div></div><div class=sect2><h3 id=grub-loader>8.7. Как загрузить FreeBSD и Linux® с помощью GRUB?<a class=anchor href=#grub-loader></a></h3><div class=paragraph><p>Для загрузки FreeBSD с использованием GRUB добавьте следующие строки в <span class=filename>/boot/grub/menu.lst</span> или <span class=filename>/boot/grub/grub.conf</span>, в зависимости от используемого дистрибутива Linux®.</p></div><div class="literalblock programlisting"><div class=content><pre>title FreeBSD 9.1
root (hd0,a)
kernel /boot/loader</pre></div></div><div class=paragraph><p>Где <em>hd0,a</em> указывает на корневой раздел на первом диске. Чтобы указать номер слайса, напишите что-то вроде <em>(hd0,2,a)</em>. По умолчанию, если номер слайса не указан, GRUB ищет первый слайс c разделом <code>a</code>.</p></div></div><div class=sect2><h3 id=booteasy-loader>8.8. Как загрузить FreeBSD и Linux® с помощью BootEasy?<a class=anchor href=#booteasy-loader></a></h3><div class=paragraph><p>Установите LILO в начало загрузочного раздела Linux®, а не в Master Boot
Record. После этого загрузите LILO из BootEasy.</p></div><div class=paragraph><p>Это рекомендуется делать при одновременном использовании Windows® и Linux®, чтобы упростить восстановление работоспособности Linux® в случае переустановки Windows®.</p></div></div><div class=sect2><h3 id=changing-bootprompt>8.9. Как сменить приглашение загрузчика с ??? на что-нибудь более значащее?<a class=anchor href=#changing-bootprompt></a></h3><div class=paragraph><p>Этого нельзя сделать со стандартным загрузчиком, не переписав его. В категории <span class=filename>sysutils</span> Коллекции Портов есть ряд других менеджеров загрузки.</p></div></div><div class=sect2><h3 id=removable-drives>8.10. Как использовать устройство для чтения сменных дисков?<a class=anchor href=#removable-drives></a></h3><div class=paragraph><p>Если у вас уже есть файловая система на устройстве, то используйте такую команду:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># mount -t msdosfs /dev/da0s1 /mnt</span></code></pre></div></div><div class=paragraph><p>Если это устройство будет использоваться только на системах FreeBSD, то разбейте его на разделы UFS или ZFS. Это обеспечит поддержку длинных имён файлов, увеличение производительности и надёжность. Если устройство будет использоваться с другими операционными системами, то лучше сделать более совместимый выбор, например, msdosfs.</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># dd if=/dev/zero of=/dev/da0 count=2</span>
<span class=c># gpart create -s GPT /dev/da0</span>
<span class=c># gpart add -t freebsd-ufs /dev/da0</span></code></pre></div></div><div class=paragraph><p>Наконец, остаётся создать новую файловую систему:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># newfs /dev/da0p1</span></code></pre></div></div><div class=paragraph><p>и смонтировать её:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># mount /dev/da0s1 /mnt</span></code></pre></div></div><div class=paragraph><p>Хорошо ещё добавить строку в файл <span class=filename>/etc/fstab</span> (прочтите справку по <a href="https://man.freebsd.org/cgi/man.cgi?query=fstab&amp;sektion=5&amp;format=html">fstab(5)</a>), чтобы в будущем можно было просто давать команду <code>mount /mnt</code>:</p></div><div class="literalblock programlisting"><div class=content><pre>/dev/da0p1 /mnt ufs rw,noauto 0 0</pre></div></div></div><div class=sect2><h3 id=mount-cd-superblock>8.11. Почему при монтировании компакт-диска выдаётся сообщение Incorrect super block?<a class=anchor href=#mount-cd-superblock></a></h3><div class=paragraph><p>Необходимо указать тип монтируемого устройства. Это описано в разделе
Руководства <a href=https://docs.freebsd.org/ru/books/handbook/disks/#mounting-cd>Использование CD с данными</a>.</p></div></div><div class=sect2><h3 id=cdrom-not-configured>8.12. При монтировании компакт-диска выдаётся сообщение Device not configured.<a class=anchor href=#cdrom-not-configured></a></h3><div class=paragraph><p>Обычно это означает, что в приводе нет компакт-диска либо устройство не
обнаружено на шине. Обратитесь к разделу extref:https://docs.freebsd.org/ru/books/handbook/disks/[Использование
CD с данными, mounting-cd] в Руководстве, где подробно обсуждается этот вопрос.</p></div></div><div class=sect2><h3 id=cdrom-unicode-filenames>8.13. Почему при монтировании CD-ROM во FreeBSD все неанглийские символы в именах файлов отображаются как вопросительные знаки?<a class=anchor href=#cdrom-unicode-filenames></a></h3><div class=paragraph><p>Скорее всего, на компакт-диске для хранения информации о файлах и каталогах используется расширение "Joliet". Это описано в разделе Руководства об
<a href=https://docs.freebsd.org/ru/books/handbook/disks/#mounting-cd>использовании CD с данными</a>.</p></div></div><div class=sect2><h3 id=burncd-isofs>8.14. Записанный во FreeBSD CD не читается ни в какой другой операционной системой. Почему?<a class=anchor href=#burncd-isofs></a></h3><div class=paragraph><p>Это означает, что на CD был записан непосредственно необработанный файл без создания файловой системы ISO 9660. Прочтите раздел Руководства об
<a href=https://docs.freebsd.org/ru/books/handbook/disks/>использовании CD с данными</a>.</p></div></div><div class=sect2><h3 id=copy-cd>8.15. Как создать образ CD с данными?<a class=anchor href=#copy-cd></a></h3><div class=paragraph><p>Это описано в разделе Руководства о extref:https://docs.freebsd.org/ru/books/handbook/disks/[записи данных на
файловую систему ISO, mkisofs]. Более полную информацию о работе с
компакт-дисками можно найти в разделе о extref:https://docs.freebsd.org/ru/books/handbook/disks/[создании
компакт-дисков, creating-cds] в главе Руководства об устройствах хранения
данных.</p></div></div><div class=sect2><h3 id=mount-audio-CD>8.16. Почему я не могу смонтировать аудио CD?<a class=anchor href=#mount-audio-CD></a></h3><div class=paragraph><p>Попытка смонтировать аудио CD приведёт к сообщению об ошибке вида <code>cd9660: /dev/acd0c: Invalid argument</code>. Причина этого заключается в том, что команда <code>mount</code> работает только с файловыми системами. На аудио CD файловых систем нет; они содержат только данные. Используйте вместо этого программу, которая умеет читать аудио CD, например, порт <a class=package href=https://cgit.freebsd.org/ports/tree/audio/xmcd/>audio/xmcd</a>.</p></div></div><div class=sect2><h3 id=multi-session-CD>8.17. Как выполнить mount для многосеансового CD?<a class=anchor href=#multi-session-CD></a></h3><div class=paragraph><p>По умолчанию <a href="https://man.freebsd.org/cgi/man.cgi?query=mount&amp;sektion=8&amp;format=html">mount(8)</a> будет пытаться смонтировать последнюю дорожку (сеанс) CD с данными. Для загрузки более раннего сеанса используйте параметр командной строки <code>-s</code>. За конкретными примерами обращайтесь к странице Справочника <a href="https://man.freebsd.org/cgi/man.cgi?query=mount_cd9660&amp;sektion=8&amp;format=html">mount_cd9660(8)</a>.</p></div></div><div class=sect2><h3 id=user-floppymount>8.18. Как разрешить обычным пользователям монтировать компакт-диски, DVD, USB-диски и другие сменные носители?<a class=anchor href=#user-floppymount></a></h3><div class=paragraph><p>Как пользователь <code>root</code>, установите системную переменную <code>vfs.usermount</code> в значение <code>1</code>.</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># sysctl vfs.usermount=1</span></code></pre></div></div><div class=paragraph><p>Чтобы это срабатывало во время загрузки системы, добавьте строчку <code>vfs.usermount=1</code> в файл <span class=filename>/etc/sysctl.conf</span>.</p></div><div class=paragraph><p>Пользователи могут монтировать только те устройства, к которым у них имеется доступ на чтение. Чтобы разрешить пользователям монтировать устройство, должны быть заданы разрешения в <span class=filename>/etc/devfs.conf</span>.</p></div><div class=paragraph><p>Например, чтобы разрешить пользователям монтировать первое устройство USB, добавьте такую строчку:</p></div><div class="literalblock programlisting"><div class=content><pre># Allow all users to mount a USB drive.
	    own       /dev/da0       root:operator
	    perm      /dev/da0       0666</pre></div></div><div class=paragraph><p>Теперь все пользователи могут монтировать устройства с правами доступа на чтение в собственные каталоги:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>% <span class=nb>mkdir</span> ~/my-mount-point
% mount <span class=nt>-t</span> msdosfs /dev/da0 ~/my-mount-point</code></pre></div></div><div class=paragraph><p>Размонтирование устройства осуществляется просто:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>% umount ~/my-mount-point</code></pre></div></div><div class=paragraph><p>Использование <code>vfs.usermount</code>, однако, имеет некоторые негативные стороны, связанные с вопросами безопасности. Более правильным способом работы с носителями в формате MS-DOS® является использование пакета <a class=package href=https://cgit.freebsd.org/ports/tree/emulators/mtools/>emulators/mtools</a> из Коллекции Портов.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Имя устройства, использованное в предыдущих примерах, должно быть изменено в соответствии с конфигурацией.</p></div></td></tr></tbody></table></div></div><div class=sect2><h3 id=du-vs-df>8.19. Команды du и df показывают разный объём доступного дискового пространства. Что происходит?<a class=anchor href=#du-vs-df></a></h3><div class=paragraph><p>Это связано с тем, как эти команды на самом деле работают. <code>du</code> проходит по дереву каталогов, подсчитывая, насколько большой объём занимает каждый файл, и выдает общий объем. <code>df</code> просто запрашивает файловую систему об оставшемся объеме. Это выглядит как одно и то же, однако файл без записи в каталоге затронет <code>df</code>, но не повлияет на <code>du</code>.</p></div><div class=paragraph><p>Когда программа использует файл и этот файл удаляется, то на самом деле он не
удаляется из файловой системы, пока программа не прекратит его использовать.
Однако файл тут же удаляется из списка каталога. В качестве примера можно
представить файл, размер которого достаточен, чтобы повлиять на результаты
работы команд <code>du</code> и <code>df</code>. Любой файл, просматриваемый при помощи команды
<code>more</code>, может быть удалён без выдачи сообщений об ошибке. Запись о файле
просто удаляется из каталога, так что другие программы или пользователи не
смогут к нему обратиться.
Тем не менее, <code>du</code> покажет, что файл исчез, поскольку она просматривает дерево каталогов, а файла там нет. <code>df</code> показывает, что файл всё ещё здесь, так как файловая система знает, что <code>more</code> всё ещё использует это пространство. Как только закончится работа с <code>more</code>, команды <code>du</code> и <code>df</code> придут в соответствие.</p></div><div class=paragraph><p>Такая ситуация часто встречается на Web-серверах.
Многие устанавливают Web-сервер на FreeBSD и забывают выполнять ротацию файлов
протоколов.
Журнал доступа заполняет <span class=filename>/var</span>.
Новый администратор удаляет файл, но система всё ещё сообщает о том, что раздел
заполнен.
Остановка и перезапуск программы Web-сервера освободит файл, позволяя системе
освободить дисковое пространство.
Для предотвращения подобной ситуации настройте <a href="https://man.freebsd.org/cgi/man.cgi?query=newsyslog&amp;sektion=8&amp;format=html">newsyslog(8)</a>.</p></div><div class=paragraph><p>Заметьте, что подсистема отложенных обновлений (Soft Updates) может задерживать освобождение дискового пространства, и может потребоваться до 30 секунд, чтобы изменения стали заметны.</p></div></div><div class=sect2><h3 id=_как_добавить_дополнительную_виртуальную_память>8.20. Как добавить дополнительную виртуальную память?<a class=anchor href=#_как_добавить_дополнительную_виртуальную_память></a></h3><div class=paragraph><p>В этом разделе <a href=https://docs.freebsd.org/ru/books/handbook/config/#adding-swap-space>Руководства</a>
описывается, как это сделать.</p></div></div><div class=sect2><h3 id=manufacturer-disk-size>8.21. Почему FreeBSD считает, что размер моего диска меньше, чем заявляет его производитель?<a class=anchor href=#manufacturer-disk-size></a></h3><div class=paragraph><p>Производители дисков считают гигабайт равным миллиарду байт, а FreeBSD приравнивает его к 1073741824 байт. Это объясняет, почему, к примеру, в сообщениях при загрузке FreeBSD указывается, что ёмкость диска, объём которого должен быть равным 80 Гбайт, составляет 76319 Мбайт.</p></div><div class=paragraph><p>Заметьте также, что FreeBSD будет (по умолчанию) <a href=#disk-more-than-full>резервировать</a> 8% ёмкости диска.</p></div></div><div class=sect2><h3 id=disk-more-than-full>8.22. Почему возможно заполнение раздела больше чем на 100%?<a class=anchor href=#disk-more-than-full></a></h3><div class=paragraph><p>Часть каждого раздела UFS (по умолчанию 8%) зарезервировано для использования операционной системой и пользователем <code>root</code>. Утилита <a href="https://man.freebsd.org/cgi/man.cgi?query=df&amp;sektion=1&amp;format=html">df(1)</a> не учитывает это при подсчёте значения в колонке <code>Capacity</code>, так что оно может превышать 100%. Обратите внимание, что колонка <code>Blocks</code> всегда больше, чем сумма значений в колонках <code>Used</code> и <code>Avail</code>, обычно на 8%.</p></div><div class=paragraph><p>Для получения более подробной информации обратитесь к описанию опции <code>-m</code> в справке по <a href="https://man.freebsd.org/cgi/man.cgi?query=tunefs&amp;sektion=8&amp;format=html">tunefs(8)</a>.</p></div></div></div></div><div class=sect1><h2 id=_zfs>9. ZFS<a class=anchor href=#_zfs></a></h2><div class=sectionbody><div class=sect2><h3 id=_какой_минимальный_объём_озу_требуется_для_zfs>9.1. Какой минимальный объём ОЗУ требуется для ZFS?<a class=anchor href=#_какой_минимальный_объём_озу_требуется_для_zfs></a></h3><div class=paragraph><p>Для комфортного использования требуется 4 Гбайт ОЗУ, но конкретная нагрузка может сильно различаться.</p></div></div><div class=sect2><h3 id=what-is-zil>9.2. Что такое ZIL и когда он используется?<a class=anchor href=#what-is-zil></a></h3><div class=paragraph><p>ZIL (ZFS intent log) представляет собой журнал операций записи, используемый
для реализации логики подтверждения записи на диск в стандарте
posix, которая работает при сбоях. При нормальной работе отдельные
операции записи объединяются в группу транзакций и записываются на
диск при заполнении группы ("Transaction Group Commit"). Однако системные
вызовы типа <a href="https://man.freebsd.org/cgi/man.cgi?query=fsync&amp;sektion=2&amp;format=html">fsync(2)</a> требуют подтверждения записи данных на надёжное
устройство перед возвратом управления. ZIL нужен для работы с операциями
записи, которые были подтверждены как выполненные, но в рамках транзакции
на диск ещё не записаны. Группы транзакций помечаются меткой
времени. В случае сбоя выполняется поиск последней корректной
метки и из ZIL извлекаются недостающие данные.</p></div></div><div class=sect2><h3 id=need-ssd-for-zil>9.3. Нужен ли мне SSD для ZIL?<a class=anchor href=#need-ssd-for-zil></a></h3><div class=paragraph><p>По умолчанию ZFS хранит ZIL в пуле со всеми данными.
Если приложение интенсивно выполняет операции записи, то размещение
ZIL на отдельном устройстве, обладающем высокими показателями
скорости синхронной последовательной записи, может улучшить общую
производительность системы. При другом характере нагрузки SSD вряд
ли сможет что-то сильно улучшить.</p></div></div><div class=sect2><h3 id=what-is-l2arc>9.4. Что такое L2ARC?<a class=anchor href=#what-is-l2arc></a></h3><div class=paragraph><p>L2ARC - это кэш на чтение, хранимый на быстром устройстве, таком как SSD. Этот кэш не сохраняется между перезагрузками. Следует заметить, что ОЗУ выступает
как кэширующее устройство первого уровня, а L2ARC необходим
только при нехватке оперативной памяти.</p></div><div class=paragraph><p>L2ARC требует пространства в ARC для его индексации. Таким образом, рабочий
набор, который идеально помещается в ARC, не будет там помещаться при
использовании L2ARC, поскольку часть ARC будет отведена под индекс L2ARC с
вытеснением части рабочего набора в L2ARC, более медленный, чем ОЗУ.</p></div></div><div class=sect2><h3 id=should-enable-dedup>9.5. Целесообразно ли включение дедупликации?<a class=anchor href=#should-enable-dedup></a></h3><div class=paragraph><p>В общем случае нет.</p></div><div class=paragraph><p>Дедупликация занимает значительный объём ОЗУ и может увеличить задержки операций ввода/вывода.
Если только данные не являются сильно дублированными (сильно дублированными являются образы виртуальных машин или резервные копии пользовательских данных), то дедупликация может принести больше вреда, чем пользы.
Другое соображение касается невозможности отменить статус дедупликации.
Если данные записаны при включённой дедупликации, её выключение не приведёт к обратной репликации объединённых блоков до момента их модификации.</p></div><div class=paragraph><p>Дедупликация также может приводить к некоторым неожиданным ситуациям.
В частности, удаление файлов может сильно замедлиться.</p></div></div><div class=sect2><h3 id=zpool-fully-full>9.6. Я не могу создать или удалить файлы на пуле ZFS. Как я могу это исправить?<a class=anchor href=#zpool-fully-full></a></h3><div class=paragraph><p>Такое может произойти при 100% заполненности пула. ZFS требуется свободное место на диске для записи метаданных транзакций. Для восстановления работоспособного состояния пула обрежьте файл перед его удалением.</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>% <span class=nb>truncate</span> <span class=nt>-s</span> 0 unimportant-file</code></pre></div></div><div class=paragraph><p>Обрезка файла работает по той причине, что новая транзакция при этом не
запускается, но вместо этого создаются новые свободные блоки.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>На системах с дополнительными настройками наборов данных ZFS,
такими, как дедупликация, свободное место может не быть доступно сразу.</p></div></td></tr></tbody></table></div></div><div class=sect2><h3 id=zfs-ssd-trim>9.7. Поддерживается ли TRIM в ZFS для твердотельных накопителей?<a class=anchor href=#zfs-ssd-trim></a></h3><div class=paragraph><p>ZFS во FreeBSD 12.3 и 12.4: TRIM включен по умолчанию.
Для отключения TRIM: добавьте строку ниже в файл
<span class=filename>/etc/sysctl.conf</span>, затем перезапустите систему.</p></div><div class="literalblock programlisting"><div class=content><pre>vfs.zfs.trim.enabled=0</pre></div></div><div class=paragraph><p>OpenZFS во FreeBSD 13.0 и более старших версиях: обратитесь к
<a href="https://man.freebsd.org/cgi/man.cgi?query=zpool-trim&amp;sektion=8&amp;format=html">zpool-trim(8)</a> и изучите параметр <code>autotrim</code> в <a href="https://man.freebsd.org/cgi/man.cgi?query=zpoolprops&amp;sektion=7&amp;format=html">zpoolprops(7)</a>.</p></div></div></div></div><div class=sect1><h2 id=_системное_администрирование>10. Системное администрирование<a class=anchor href=#_системное_администрирование></a></h2><div class=sectionbody><div class=sect2><h3 id=startup-config-files>10.1. Где расположены файлы конфигурации системы?<a class=anchor href=#startup-config-files></a></h3><div class=paragraph><p>Основным конфигурационным файлом является <span class=filename>/etc/defaults/rc.conf</span>, который описан в <a href="https://man.freebsd.org/cgi/man.cgi?query=rc.conf&amp;sektion=5&amp;format=html">rc.conf(5)</a>.
Этот файл используют скрипты запуска системы, такие как <span class=filename>/etc/rc</span> и <span class=filename>/etc/rc.d</span>, которые описаны в <a href="https://man.freebsd.org/cgi/man.cgi?query=rc&amp;sektion=8&amp;format=html">rc(8)</a>.
<em>Не редактируйте этот файл!</em>
Вместо изменения параметра в <span class=filename>/etc/defaults/rc.conf</span> скопируйте соответствующую строку в <span class=filename>/etc/rc.conf</span> и поменяйте значение там.</p></div><div class=paragraph><p>К примеру, для запуска <a href="https://man.freebsd.org/cgi/man.cgi?query=sshd&amp;sektion=8&amp;format=html">sshd(8)</a>, поставляемого с системой сервера OpenSSH:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># echo &#39;sshd_enable=&#34;YES&#34;&#39; &gt;&gt; /etc/rc.conf</span></code></pre></div></div><div class=paragraph><p>Альтернативным способом является использование <a href="https://man.freebsd.org/cgi/man.cgi?query=sysrc&amp;sektion=8&amp;format=html">sysrc(8)</a> для
корректировки <span class=filename>/etc/rc.conf</span>:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># sysrc sshd_enable=&#34;YES&#34;</span></code></pre></div></div><div class=paragraph><p>Для запуска локальных сервисов поместите соответствующие скрипты в каталог <span class=filename>/usr/local/etc/rc.d</span>. У этих скриптов должен быть выставлен бит выполнимости, по умолчанию используются права доступа <code>555</code>.</p></div></div><div class=sect2><h3 id=adding-users>10.2. Как проще всего добавить пользователя?<a class=anchor href=#adding-users></a></h3><div class=paragraph><p>Используйте команду <a href="https://man.freebsd.org/cgi/man.cgi?query=adduser&amp;sektion=8&amp;format=html">adduser(8)</a> или <a href="https://man.freebsd.org/cgi/man.cgi?query=pw&amp;sektion=8&amp;format=html">pw(8)</a> в случае выполнения более сложных операций.</p></div><div class=paragraph><p>Чтобы удалить пользователя, используйте команду <a href="https://man.freebsd.org/cgi/man.cgi?query=rmuser&amp;sektion=8&amp;format=html">rmuser(8)</a> или, если это будет необходимо, <a href="https://man.freebsd.org/cgi/man.cgi?query=pw&amp;sektion=8&amp;format=html">pw(8)</a>.</p></div></div><div class=sect2><h3 id=root-not-found-cron-errors>10.3. Почему после редактирования моего файла crontab я получаю сообщения вида root: not found?<a class=anchor href=#root-not-found-cron-errors></a></h3><div class=paragraph><p>Обычно это случается при редактировании системного файла crontab.</p></div><div class=paragraph><p>Это неправильный подход, потому что системный crontab имеет формат, отличный от пользовательских crontab. Системный crontab имеет дополнительное поле, указывающее, под каким пользователем запускать команду. <a href="https://man.freebsd.org/cgi/man.cgi?query=cron&amp;sektion=8&amp;format=html">cron(8)</a> полагает, что имя пользователя является первым словом в команде на выполнение. Поскольку такой команды не существует, отображается это сообщение об ошибке.</p></div><div class=paragraph><p>Чтобы удалить лишний неправильный crontab:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># crontab -r</span></code></pre></div></div></div><div class=sect2><h3 id=su-wheel-group>10.4. Команда su выдаёт сообщение you are not in the correct group to su root, когда я пытаюсь сменить привилегии на root.<a class=anchor href=#su-wheel-group></a></h3><div class=paragraph><p>Это особенность работы системы защиты. Для того, чтобы сменить пользовательский идентификатор с помощью <code>su</code> на пользователя <code>root</code> или любого другого с привилегиями суперпользователя, учётная запись должна являться членом группы <code>wheel</code>. Если бы этого не было, то любой, имеющий доступ к системе и узнавший пароль пользователя <code>root</code>, смог бы получить в системе уровень доступа суперпользователя.</p></div><div class=paragraph><p>Чтобы разрешить кому-либо менять привилегии на <code>root</code>, включите его в группу <code>wheel</code> с помощью <code>pw</code>.</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># pw groupmod wheel -m lisa</span></code></pre></div></div><div class=paragraph><p>В примере выше пользователь <code>lisa</code> будет добавлен в группу <code>wheel</code>.</p></div></div><div class=sect2><h3 id=rcconf-readonly>10.5. Я сделал ошибку в файле rc.conf или в каком-то другом файле начальной загрузки, и теперь не могу его отредактировать из-за того, что файловая система находится в режиме только для чтения. Что мне делать?<a class=anchor href=#rcconf-readonly></a></h3><div class=paragraph><p>Перезапустите систему, используя в приглашении загрузчика команду <code>boot -s</code> для входа в однопользовательский режим. При получении приглашения на ввод полного пути до командного процессора нажмите <code>Enter</code>, а затем выполните команду <code>mount -urw /</code> для повторного монтирования корневой файловой системы в режиме чтения/записи. Вам может также потребоваться выполнить команду <code>mount -a -t ufs</code> для монтирования файловой системы, в которой расположен ваш любимый текстовый редактор.
Если редактор расположен на сетевой файловой системе, выполните сетевые настройки вручную до монтирования сетевой файловой системы, либо воспользуйтесь редактором, находящимся в локальной файловой системе, таким, как <a href="https://man.freebsd.org/cgi/man.cgi?query=ed&amp;sektion=1&amp;format=html">ed(1)</a>.</p></div><div class=paragraph><p>Чтобы использовать полноэкранный редактор, такой как <a href="https://man.freebsd.org/cgi/man.cgi?query=vi&amp;sektion=1&amp;format=html">vi(1)</a> или <a href="https://man.freebsd.org/cgi/man.cgi?query=emacs&amp;sektion=1&amp;format=html">emacs(1)</a>, выполните команду <code>export TERM=xterm</code>, чтобы эти редакторы смогли получить корректную информацию из базы данных <a href="https://man.freebsd.org/cgi/man.cgi?query=termcap&amp;sektion=5&amp;format=html">termcap(5)</a>.</p></div><div class=paragraph><p>После выполнения этих шагов отредактируйте файл <span class=filename>/etc/rc.conf</span> для исправления ошибки. Сообщение об ошибке, выводимое сразу же после сообщений при загрузке ядра, должно указать на номер строки в файле, которая содержит ошибку.</p></div></div><div class=sect2><h3 id=printer-setup>10.6. Почему у меня возникают проблемы с установкой принтера?<a class=anchor href=#printer-setup></a></h3><div class=paragraph><p>Обратитесь к соответствующему <a href=https://docs.freebsd.org/ru/books/handbook/printing/>разделу</a> Руководства, посвящённому печати, за советами по разрешению проблем.</p></div></div><div class=sect2><h3 id=keyboard-mappings>10.7. Как я могу откорректировать раскладку клавиатуры для моей системы?<a class=anchor href=#keyboard-mappings></a></h3><div class=paragraph><p>Обратитесь к разделу Руководства, посвящённому <a href=https://docs.freebsd.org/ru/books/handbook/l10n/#using-localization>использованию локализации</a>, а именно к части, описывающей <a href=https://docs.freebsd.org/ru/books/handbook/l10n/#setting-console>настройку консоли</a>.</p></div></div><div class=sect2><h3 id=user-quotas>10.8. Почему не получается заставить работать дисковые квоты?<a class=anchor href=#user-quotas></a></h3><div class="olist arabic"><ol class=arabic><li><p>Возможно, что ядро не сконфигурировано должным образом для работы с квотами. В этом случае добавьте следующую строчку в конфигурационный файл ядра и пересоберите ядро:</p><div class="literalblock programlisting"><div class=content><pre>options QUOTA</pre></div></div><div class=paragraph><p>Прочтите <a href=https://docs.freebsd.org/ru/books/handbook/disks/>главу Руководства по квотам, quotas</a> для
получения полной информации.</p></div></li><li><p>Не включайте квотирование на разделе <span class=filename>/</span>.</p></li><li><p>Помещайте файл с квотами в ту файловую систему, которую он обслуживает:</p><table class="tableblock frame-none grid-all stretch informaltable"><col style=width:50%><col style=width:50%><thead><tr><th class="tableblock halign-left valign-top">Файловая система</th><th class="tableblock halign-left valign-top">Файл квот</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class=tableblock><span class=filename>/usr</span></p></td><td class="tableblock halign-left valign-top"><p class=tableblock><span class=filename>/usr/admin/quotas</span></p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><span class=filename>/home</span></p></td><td class="tableblock halign-left valign-top"><p class=tableblock><span class=filename>/home/admin/quotas</span></p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>…​</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>…​</p></td></tr></tbody></table></li></ol></div></div><div class=sect2><h3 id=sysv-ipc>10.9. Поддерживает ли FreeBSD вызовы IPC из System V?<a class=anchor href=#sysv-ipc></a></h3><div class=paragraph><p>Да, во FreeBSD в ядро <span class=filename>GENERIC</span> включена поддержка IPC в стиле System V, в том числе совместно используемой памяти, сообщений и семафоров.
В нестандартном ядре поддержка может быть включена посредством загрузки модулей ядра <span class=filename>sysvshm.ko</span>, <span class=filename>sysvsem.ko</span> и <span class=filename>sysvmsg.ko</span> или добавлением в конфигурационный файл ядра следующих строк:</p></div><div class="literalblock programlisting"><div class=content><pre>options    SYSVSHM	  # enable shared memory
options    SYSVSEM	  # enable for semaphores
options    SYSVMSG	  # enable for messaging</pre></div></div><div class=paragraph><p>Перекомпилируйте и переустановите ядро.</p></div></div><div class=sect2><h3 id=sendmail-alternative>10.10. Какое другое программное обеспечение для почтового сервера можно использовать вместо Sendmail?<a class=anchor href=#sendmail-alternative></a></h3><div class=paragraph><p>Сервер <a href=http://www.sendmail.org/>Sendmail</a> является программным обеспечением для работы почтового сервера во FreeBSD, используемым по умолчанию, но его можно заменить другим MTA, установленным из Коллекции Портов. В дереве портов имеется <a class=package href=https://cgit.freebsd.org/ports/tree/mail/exim/>mail/exim</a>, <a class=package href=https://cgit.freebsd.org/ports/tree/mail/postfix/>mail/postfix</a> и <a class=package href=https://cgit.freebsd.org/ports/tree/mail/qmail/>mail/qmail</a>. Проверьте архивы списков рассылки на предмет обсуждения достоинств и недостатков имеющихся MTA.</p></div></div><div class=sect2><h3 id=forgot-root-pw>10.11. Я забыл пароль пользователя root! Что делать?<a class=anchor href=#forgot-root-pw></a></h3><div class=paragraph><p>Без паники!
Перезапустите систему, наберите <code>boot -s</code> в приглашении <code>Boot:</code> для входа в
однопользовательский режим.
На вопрос об используемой оболочке нажмите <kbd>Enter</kbd> для получения # в качестве приглашения.
Выполните команду <code>mount -urw /</code>, чтобы перемонтировать корневую файловую
систему в режиме чтения/записи, после чего выполните команду <code>mount -a</code> для
монтирования всех файловых систем.
Запустите команду <code>passwd root</code>, чтобы сменить пароль пользователя <code>root</code>, а затем <a href="https://man.freebsd.org/cgi/man.cgi?query=exit&amp;sektion=1&amp;format=html">exit(1)</a> для продолжения процесса загрузки.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Если при входе в однопользовательский режим предлагается ввести пароль пользователя <code>root</code>, это означает, что консоль была помечена как <code>insecure</code> в <span class=filename>/etc/ttys</span>. В этом случае потребуется загрузиться с установочного диска FreeBSD, выбрать <span class=guimenuitem>Live CD</span> или <span class=guimenuitem>Shell</span> в начале процесса установки и выполнить указанные выше команды. В этом случае смонтируйте нужный раздел и выполните туда chroot. Например, замените команду <code>mount -urw /</code> на <code>mount /dev/ada0p1 /mnt; chroot /mnt</code> для системы, расположенной на <em>ada0p1</em>.</p></div></td></tr></tbody></table></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Если корневой раздел не получается смонтировать в однопользовательском режиме, то возможно, что разделы являются зашифрованными, и смонтировать их без ключей доступа не представляется возможным.
За дополнительной информацией обратитесь к разделу <a href=https://docs.freebsd.org/ru/books/handbook/disks/#disks-encrypting>Руководства</a>, посвящённому шифрованию дисков во FreeBSD.</p></div></td></tr></tbody></table></div></div><div class=sect2><h3 id=CAD-reboot>10.12. Как запретить перезагрузку по нажатию Control Alt Delete?<a class=anchor href=#CAD-reboot></a></h3><div class=paragraph><p>При использовании стандартного драйвера консоли <a href="https://man.freebsd.org/cgi/man.cgi?query=vt&amp;sektion=4&amp;format=html">vt(4)</a> этого можно добиться,
задав следующий системный параметр <a href="https://man.freebsd.org/cgi/man.cgi?query=sysctl&amp;sektion=8&amp;format=html">sysctl(8)</a>:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># sysctl kern.vt.kbd_reboot=0</span></code></pre></div></div></div><div class=sect2><h3 id=_как_преобразовать_текстовые_файлы_dos_в_формат_unix>10.13. Как преобразовать текстовые файлы DOS в формат UNIX®?<a class=anchor href=#_как_преобразовать_текстовые_файлы_dos_в_формат_unix></a></h3><div class=paragraph><p>Воспользуйтесь следующей командой <a href="https://man.freebsd.org/cgi/man.cgi?query=perl&amp;sektion=1&amp;format=html">perl(1)</a>:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>% perl <span class=nt>-i</span>.bak <span class=nt>-npe</span> <span class=s1>&#39;s/\r\n/\n/g&#39;</span> file<span class=o>(</span>s<span class=o>)</span></code></pre></div></div><div class=paragraph><p>где <em>file(s)</em> - это один или несколько файлов для обработки. Преобразование делается в том же самом файле, оригинальные файлы сохраняются с расширением <span class=filename>.bak</span>.</p></div><div class=paragraph><p>Либо используйте <a href="https://man.freebsd.org/cgi/man.cgi?query=tr&amp;sektion=1&amp;format=html">tr(1)</a>:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>% <span class=nb>tr</span> <span class=nt>-d</span> <span class=s1>&#39;\r&#39;</span> &lt; dos-text-file <span class=o>&gt;</span> unix-file</code></pre></div></div><div class=paragraph><p>где <em>dos-text-file</em> - это имя файла, содержащего текст DOS, а в файл <em>unix-file</em> будет помещён уже преобразованный текст. Этот способ может работать гораздо быстрее, чем при использовании <code>perl</code>.</p></div><div class=paragraph><p>Еще один способ отформатировать тестовые файлы DOS состоит в использовании <a class=package href=https://cgit.freebsd.org/ports/tree/converters/dosunix/>converters/dosunix</a> из Коллекции Портов. Для получения дополнительной информации ознакомьтесь с документацией порта.</p></div></div><div class=sect2><h3 id=reread-rc>10.14. Как перечитать содержимое /etc/rc.conf и перестартовать /etc/rc без перезагрузки системы?<a class=anchor href=#reread-rc></a></h3><div class=paragraph><p>Перейдите в однопользовательский режим, а затем возвратитесь обратно в многопользовательский.</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># shutdown now</span>
<span class=c># return</span>
<span class=c># exit</span></code></pre></div></div></div><div class=sect2><h3 id=release-candidate>10.15. Я пытался обновить мою систему до последней -STABLE, а получил -BETAx, -RC или -PRERELEASE! Что происходит?<a class=anchor href=#release-candidate></a></h3><div class=paragraph><p>Краткий ответ: это же просто название. <em>RC</em> означает "Release Candidate". Это значит, что вскоре произойдет выход релиза. Во FreeBSD появление <em>-PRERELEASE</em>, как правило, равнозначно прекращению внесения изменений в код системы перед появлением релиза. (Для некоторых релизом метка <em>-BETA</em> использовалась точно так же, как и <em>-PRERELEASE</em>.)</p></div><div class=paragraph><p>Подробный ответ: во FreeBSD релизы выпускаются из одного из двух мест. Крупные релизы, точка-ноль, такие, как 9.0-RELEASE и 10.0-RELEASE, ответвляются от основного потока разработки, более известного как <a href=#current>-CURRENT</a>. Мелкие релизы, такие, как 6.3-RELEASE или 5.2-RELEASE, являлись снэпшотами активной ветки <a href=#stable>-STABLE</a>. Начиная с 4.3-RELEASE, каждый релиз также имеет свою ветвь, которой могут следовать те, кому необходим сверхконсервативный метод обновления (как правило, внесение только тех исправлений, которые касаются вопросов обеспечения безопасности).</p></div><div class=paragraph><p>Когда делается релиз, то ветвь, из которой он выпускается, подвергается некоторой подготовке. Частью этого процесса является замораживание кода. Когда инициируется замораживание кода, то имя ветки изменяется для того, чтобы отразить факт близости релиза. Например, если ветка называлась 6.2-STABLE, то её имя будет изменено на 6.3-PRERELEASE, чтобы обозначить момент прекращения внесения изменений в код системы и период дополнительного тестирования перед выходом релиза. В это время исправления ошибок могут быть внесены в код системы для того, чтобы быть включенными в релиз. Когда исходный код подготовлен к выпуску релиза, имя будет изменено на 6.3-RC для обозначения того, что релиз будет сделан, скорее всего, именно из этого кода. Когда код находится на этапе RC, в нём могут исправляться только самые критичные ошибки. Как только релиз (в нашем примере 6.3-RELEASE) и ветка релиза будут созданы, ветвь будет переименована в 6.3-STABLE.</p></div><div class=paragraph><p>Для получения дополнительной информации о номерах версий и различных ветках Git обратитесь к статье о <a href=https://docs.freebsd.org/ru/articles/releng/>выпуске релизов</a>.</p></div></div><div class=sect2><h3 id=kernel-chflag-failure>10.16. Я попытался установить новое ядро, однако утилита <a href="https://man.freebsd.org/cgi/man.cgi?query=chflags&amp;sektion=1&amp;format=html">chflags(1)</a> не сработала. Как это обойти?<a class=anchor href=#kernel-chflag-failure></a></h3><div class=paragraph><p>Краткий ответ: Режим безопасности имеет значение больше нуля. Для установки ядра перезагрузите машину и войдите в однопользовательский режим.</p></div><div class=paragraph><p>Подробный ответ: FreeBSD запрещает менять системные флаги при работе на уровнях безопасности, превышающих 0. Чтобы проверить текущий уровень безопасности:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># sysctl kern.securelevel</span></code></pre></div></div><div class=paragraph><p>Уровень безопасности нельзя понизить в многопользовательском режиме, поэтому для установки ядра загрузитесь в однопользовательский режим, или измените уровень безопасности в <span class=filename>/etc/rc.conf</span>, а затем выполните перезагрузку. Обратитесь к странице Справочника по <a href="https://man.freebsd.org/cgi/man.cgi?query=init&amp;sektion=8&amp;format=html">init(8)</a> за подробной информацией о <code>securelevel</code> и посмотрите <span class=filename>/etc/defaults/rc.conf</span> и справочную страницу по <a href="https://man.freebsd.org/cgi/man.cgi?query=rc.conf&amp;sektion=5&amp;format=html">rc.conf(5)</a> для выяснения подробностей о файле <span class=filename>rc.conf</span>.</p></div></div><div class=sect2><h3 id=kernel-securelevel-time>10.17. Не получается изменить системное время больше чем на одну секунду! Как это обойти?<a class=anchor href=#kernel-securelevel-time></a></h3><div class=paragraph><p>Краткий ответ: Система работает на уровне безопасности со значением выше 1. Для смены даты перезагрузите машину и войдите в однопользовательский режим.</p></div><div class=paragraph><p>Подробный ответ: FreeBSD запрещает менять системное время больше чем на одну секунду на уровне безопасности выше 1. Чтобы определить уровень безопасности:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># sysctl kern.securelevel</span></code></pre></div></div><div class=paragraph><p>Уровень безопасности нельзя понизить в многопользовательском режиме. Для изменения даты перезагрузите систему в однопользовательский режим, либо измените уровень безопасности в <span class=filename>/etc/rc.conf</span>, а затем выполните перезагрузку. Обратитесь к странице Справочника по <a href="https://man.freebsd.org/cgi/man.cgi?query=init&amp;sektion=8&amp;format=html">init(8)</a> за подробной информацией о <code>securelevel</code> и посмотрите <span class=filename>/etc/defaults/rc.conf</span> и справочную страницу по <a href="https://man.freebsd.org/cgi/man.cgi?query=rc.conf&amp;sektion=5&amp;format=html">rc.conf(5)</a> для выяснения подробностей о файле <span class=filename>rc.conf</span>.</p></div></div><div class=sect2><h3 id=statd-mem-leak>10.18. Для чего rpc.statd использует 256 Мбайт оперативной памяти?<a class=anchor href=#statd-mem-leak></a></h3><div class=paragraph><p>Нет, это не ошибка утечки памяти и он не использует 256 Мбайт оперативной памяти.
Для удобства <code>rpc.statd</code> отображает большой объём памяти в своё адресное пространство.
Здесь нет ничего ужасно неправильного с технической точки зрения; просто это сбивает с толку программы вроде <a href="https://man.freebsd.org/cgi/man.cgi?query=top&amp;sektion=1&amp;format=html">top(1)</a> и <a href="https://man.freebsd.org/cgi/man.cgi?query=ps&amp;sektion=1&amp;format=html">ps(1)</a>.</p></div><div class=paragraph><p><a href="https://man.freebsd.org/cgi/man.cgi?query=rpc.statd&amp;sektion=8&amp;format=html">rpc.statd(8)</a> отображает свой статусный файл (<span class=filename>/var/db/statd.status</span>) в сообственное адресное пространство; для того, чтобы избежать последующих беспокойств о повторном отображении статусного файла в память, когда его размер нужно будет увеличить, под этот файл выделяется щедро заданный объём.</p></div></div><div class=sect2><h3 id=unsetting-schg>10.19. Почему я не могу снять с файла флаг schg?<a class=anchor href=#unsetting-schg></a></h3><div class=paragraph><p>Система работает на уровне защиты выше нуля. Понизьте уровень защиты и
попробуйте ещё раз. Для получения более подробной информации обратитесь к
<a href=#securelevel>разделу FAQ об уровне защиты</a> и справочной странице <a href="https://man.freebsd.org/cgi/man.cgi?query=init&amp;sektion=8&amp;format=html">init(8)</a>.</p></div></div><div class=sect2><h3 id=vnlru>10.20. Что такое vnlru?<a class=anchor href=#vnlru></a></h3><div class=paragraph><p><code>vnlru</code> сбрасывает и освобождает vnode, когда система достигает ограничения по параметру <code>kern.maxvnodes</code>. Этот поток ядра в основном работает вхолостую и активируется только при наличии огромного объема ОЗУ и обращении к десяткам тысяч файлов небольшого размера.</p></div></div><div class=sect2><h3 id=top-memory-states>10.21. Что означают различные состояния памяти, показываемые утилитой top?<a class=anchor href=#top-memory-states></a></h3><div class=ulist><ul><li><p><code>Active</code>: по статистике страницы недавно использовались.</p></li><li><p><code>Inactive</code>: по статистике страницы недавно не использовались.</p></li><li><p><code>Laundry</code>: страницы, которые, согласно статистике, давно не использовались,
но содержат данные, то есть их содержимое необходимо сохранить перед тем, как
повторно использовать.</p></li><li><p><code>Free</code>: страницы, не содержащие данных, и которые можно повторно использовать
прямо сейчас.</p></li><li><p><code>Wired</code>: страницы, зафиксированные в памяти, обычно для использования ядром, а также иногда для специального использования процессами.</p></li></ul></div><div class=paragraph><p>Страницы чаще всего записываются на диск (типа синхронизации VM), когда они находятся в состоянии Laundry, однако синхронизироваться могут также и страницы в состоянии Active и Inactive.
Это зависит от возможности отслеживания центральным процессором бита 'модифицированности', и в некоторых ситуациях это может быть лучше для блока синхронизируемых страниц VM, вне зависимости от их принадлежности к той или иной очереди.
В большинстве встречающихся ситуаций лучше всего представлять очередь Laundry как очередь условно неиспользуемых страниц, которые могут быть, а могут и не быть в процессе записи на диск.
Очередь Inactive содержит как чистые, так и грязные страницы; чистые страницы ближе к голове очереди потребляются сразу же для восполнения нехватки свободных страниц памяти, а грязные страницы перемещаются в очередь Laundry для последующей обработки.</p></div><div class=paragraph><p>Есть ещё некоторые другие флаги (например, флаг занятости или счётчик занятости), которые могут влиять на описанные правила.</p></div></div><div class=sect2><h3 id=free-memory-amount>10.22. Сколько свободной памяти доступно?<a class=anchor href=#free-memory-amount></a></h3><div class=paragraph><p>Есть пара определений "свободной памяти".
В наиболее распространённом случае это объём памяти, доступной к немедленному потреблению без высвобождения уже используемой.
Этот объём равен объёму очереди свободных страниц вместе с некоторыми другими зарезервированными страницами.
Этот размер доступен в виде <a href="https://man.freebsd.org/cgi/man.cgi?query=sysctl&amp;sektion=8&amp;format=html">sysctl(8)</a>-переменной <code>vm.stats.vm.v_free_count</code>, которая показывается, например, утилитой <a href="https://man.freebsd.org/cgi/man.cgi?query=top&amp;sektion=1&amp;format=html">top(1)</a>.
Во втором случае "свободная память" обозначает общий объём виртуальной памяти, доступной пользовательским процессам, который зависит от объёма раздела подкачки и доступной к использованию оперативной памяти.
Другие определения "свободной памяти" также возможны, но они достаточно бесполезны, ведь в любом случае важно сохранять низкий уровень подкачки и избегать исчерпания раздела подкачки.</p></div></div><div class=sect2><h3 id=var-empty>10.23. Что такое <span class=filename>/var/empty</span>?<a class=anchor href=#var-empty></a></h3><div class=paragraph><p><span class=filename>/var/empty</span> представляет собой каталог, который используется в программе <a href="https://man.freebsd.org/cgi/man.cgi?query=sshd&amp;sektion=8&amp;format=html">sshd(8)</a> при выполнении разделения полномочий. Каталог <span class=filename>/var/empty</span> пуст, его владельцем является <code>root</code>, и на нём установлен флаг <code>schg</code>. Этот каталог не должен удаляться.</p></div></div><div class=sect2><h3 id=newsyslog-expectations>10.24. Я поменял /etc/newsyslog.conf. Как проверить правильность изменений?<a class=anchor href=#newsyslog-expectations></a></h3><div class=paragraph><p>Чтобы посмотреть, что будет делать <a href="https://man.freebsd.org/cgi/man.cgi?query=newsyslog&amp;sektion=8&amp;format=html">newsyslog(8)</a>, используйте следующую команду:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>% newsyslog <span class=nt>-nrvv</span></code></pre></div></div></div><div class=sect2><h3 id=_как_поправить_часовой_пояс>10.25. Как поправить часовой пояс?<a class=anchor href=#_как_поправить_часовой_пояс></a></h3><div class=paragraph><p>Используйте <a href="https://man.freebsd.org/cgi/man.cgi?query=tzsetup&amp;sektion=8&amp;format=html">tzsetup(8)</a>.</p></div></div></div></div><div class=sect1><h2 id=_x_window_system_и_виртуальные_консоли>11. X Window System и виртуальные консоли<a class=anchor href=#_x_window_system_и_виртуальные_консоли></a></h2><div class=sectionbody><div class=sect2><h3 id=whatis-X>11.1. Что такое X Window System?<a class=anchor href=#whatis-X></a></h3><div class=paragraph><p>X Window System (обычно <code>X11</code>) является наиболее общедоступной оконной системой, которая может работать на UNIX® и UNIX®-подобных системах, в том числе и во FreeBSD. Разработкой стандартов на используемый <a href=http://en.wikipedia.org/wiki/X_Window_System_core_protocol>X-протокол</a> занимается организация <a href=http://www.x.org/wiki/>The X.Org Foundation</a>, с текущей эталонной реализацией version 11 release 7.7, поэтому название часто сокращается до <code>X11</code>.</p></div><div class=paragraph><p>Для разных архитектур и операционных систем существует множество реализаций этой системы. Реализацию кода для серверной части называют <code>X-сервером</code>.</p></div></div><div class=sect2><h3 id=running-X>11.2. Я хочу запустить Xorg, как это сделать?<a class=anchor href=#running-X></a></h3><div class=paragraph><p>Для установки Xorg выполните одно из действий:</p></div><div class=paragraph><p>Используйте мета-порт <span class=filename>x11/xorg</span>, который выполняет построение и установку всех компонентов Xorg.</p></div><div class=paragraph><p>Используйте <span class=filename>x11/xorg-minimal</span>, который выполняет построение и установку только необходимых компонентов Xorg.</p></div><div class=paragraph><p>Установите Xorg из пакетов FreeBSD.</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># pkg install xorg</span></code></pre></div></div><div class=paragraph><p>После установки Xorg следуйте указаниям в разделе
<a href=https://docs.freebsd.org/ru/books/handbook/x11/#x-config>Конфигурация X11</a> Руководства по FreeBSD.</p></div></div><div class=sect2><h3 id=running-X-securelevels>11.3. Я попытался запустить X, но получил сообщение 'No devices detected' после ввода команды startx. Что мне теперь делать?<a class=anchor href=#running-X-securelevels></a></h3><div class=paragraph><p>Вероятно, в системе установлен повышенный уровень безопасности (<code>securelevel</code>). При повышенном уровне защиты систему X запустить невозможно, потому что X требуются права на операции записи в устройство <a href="https://man.freebsd.org/cgi/man.cgi?query=io&amp;sektion=4&amp;format=html">io(4)</a>. Дополнительная информация находится на странице Справочника <a href="https://man.freebsd.org/cgi/man.cgi?query=init&amp;sektion=8&amp;format=html">init(8)</a>.</p></div><div class=paragraph><p>Существует два решения проблемы: возвратить нулевое значение <code>securelevel</code> или запускать <a href="https://man.freebsd.org/cgi/man.cgi?query=xdm&amp;sektion=8&amp;format=html">xdm(8)</a> (или любой другой менеджер дисплеев) во время загрузки, до того, как будет повышено значение <code>securelevel</code>.</p></div><div class=paragraph><p>Обратитесь к <a href=#xdm-boot>Как запустить XDM во время загрузки?</a> для получения более полной информации о запуске
<a href="https://man.freebsd.org/cgi/man.cgi?query=xdm&amp;sektion=8&amp;format=html">xdm(8)</a> во время загрузки.</p></div></div><div class=sect2><h3 id=x-and-moused>11.4. Почему моя мышь не работает с X?<a class=anchor href=#x-and-moused></a></h3><div class=paragraph><p>При использовании стандартного драйвера консоли <a href="https://man.freebsd.org/cgi/man.cgi?query=vt&amp;sektion=4&amp;format=html">vt(4)</a> во FreeBSD можно включить поддержку указателя мыши во всех виртуальных экранах. Во избежание конфликтов с X, драйвер <a href="https://man.freebsd.org/cgi/man.cgi?query=vt&amp;sektion=4&amp;format=html">vt(4)</a> поддерживает виртуальное устройство <span class=filename>/dev/sysmouse</span>. Все события от реального устройства мыши пишутся в устройство <a href="https://man.freebsd.org/cgi/man.cgi?query=sysmouse&amp;sektion=4&amp;format=html">sysmouse(4)</a> через <a href="https://man.freebsd.org/cgi/man.cgi?query=moused&amp;sektion=8&amp;format=html">moused(8)</a>. Чтобы использовать мышь на одной и более виртуальных консолях, и при этом продолжать использовать X, посмотрите <a href=#moused>Можно ли использовать мышь вне X Window?</a> и настройте <a href="https://man.freebsd.org/cgi/man.cgi?query=moused&amp;sektion=8&amp;format=html">moused(8)</a>.</p></div><div class=paragraph><p>Затем отредактируйте <span class=filename>/etc/X11/xorg.conf</span>, чтобы в нём были следующие строки:</p></div><div class="literalblock programlisting"><div class=content><pre>Section &#34;InputDevice&#34;
   Option	  &#34;Protocol&#34; &#34;SysMouse&#34;
   Option	  &#34;Device&#34; &#34;/dev/sysmouse&#34;
.....</pre></div></div><div class=paragraph><p>Начиная с версии Xorg 7.4 раздел <code>InputDevice</code> в файле <span class=filename>xorg.conf</span> игнорируется, и вместо него используется механизм автоматически определяемых устройств. Чтобы восстановить прежнее поведение, добавьте в раздел <code>ServerLayout</code> или <code>ServerFlags</code> такую строку:</p></div><div class="literalblock programlisting"><div class=content><pre>Option &#34;AutoAddDevices&#34; &#34;false&#34;</pre></div></div><div class=paragraph><p>Некоторые предпочитают использовать в X устройство <span class=filename>/dev/mouse</span>. Чтобы оно работало, файл устройства <span class=filename>/dev/mouse</span> должен являться ссылкой на <span class=filename>/dev/sysmouse</span> (посмотрите справку по <a href="https://man.freebsd.org/cgi/man.cgi?query=sysmouse&amp;sektion=4&amp;format=html">sysmouse(4)</a>). Это можно сделать, добавив следующую строку в <span class=filename>/etc/devfs.conf</span> (посмотрите справку по <a href="https://man.freebsd.org/cgi/man.cgi?query=devfs.conf&amp;sektion=5&amp;format=html">devfs.conf(5)</a>):</p></div><div class="literalblock programlisting"><div class=content><pre>link    sysmouse    mouse</pre></div></div><div class=paragraph><p>Ссылка может быть создана путем перезапуска <a href="https://man.freebsd.org/cgi/man.cgi?query=devfs&amp;sektion=5&amp;format=html">devfs(5)</a> с использованием следующей команды (из под пользователя <code>root</code>):</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># service devfs restart</span></code></pre></div></div></div><div class=sect2><h3 id=x-and-wheel>11.5. У моей мыши есть колёсико. Могу ли я его использовать при работе в X?<a class=anchor href=#x-and-wheel></a></h3><div class=paragraph><p>Да, если X настроена для использования 5-кнопочной мыши. Для этого добавьте строчки <code>Buttons 5</code> и <code>ZAxisMapping 4 5</code> в раздел "InputDevice" файла <span class=filename>/etc/X11/xorg.conf</span> как показано в этом примере:</p></div><div class="literalblock programlisting"><div class=content><pre>Section &#34;InputDevice&#34;
   Identifier      &#34;Mouse1&#34;
   Driver	  &#34;mouse&#34;
   Option	  &#34;Protocol&#34; &#34;auto&#34;
   Option	  &#34;Device&#34; &#34;/dev/sysmouse&#34;
   Option	  &#34;Buttons&#34; &#34;5&#34;
   Option	  &#34;ZAxisMapping&#34; &#34;4 5&#34;
EndSection</pre></div></div><div class=paragraph><p>Использование мыши может быть активировано в Emacs путём добавления в
<span class=filename>~/.emacs</span> следующих строк:</p></div><div class="literalblock programlisting"><div class=content><pre>;; wheel mouse
(global-set-key [mouse-4] &#39;scroll-down)
(global-set-key [mouse-5] &#39;scroll-up)</pre></div></div></div><div class=sect2><h3 id=_как_заставить_работать_тачпад_synaptics_в_x>11.6. Как заставить работать тачпад Synaptics в X?<a class=anchor href=#_как_заставить_работать_тачпад_synaptics_в_x></a></h3><div class=paragraph><p>Для его работы понадобится настроить некоторые вещи.</p></div><div class=paragraph><p>Чтобы использовать драйвер synaptics из Xorg, для начала удалите строку moused_enable из <span class=filename>rc.conf</span>.</p></div><div class=paragraph><p>Для включения synaptics добавьте следующую строку в <span class=filename>/boot/loader.conf</span>:</p></div><div class="literalblock programlisting"><div class=content><pre>hw.psm.synaptics_support=&#34;1&#34;</pre></div></div><div class=paragraph><p>Добавьте следующее в <span class=filename>/etc/X11/xorg.conf</span>:</p></div><div class="literalblock programlisting"><div class=content><pre>Section &#34;InputDevice&#34;
Identifier  &#34;Touchpad0&#34;
Driver      &#34;synaptics&#34;
Option      &#34;Protocol&#34; &#34;psm&#34;
Option      &#34;Device&#34; &#34;/dev/psm0&#34;
EndSection</pre></div></div><div class=paragraph><p>Добавьте в раздел "ServerLayout" вот что:</p></div><div class="literalblock programlisting"><div class=content><pre>InputDevice    &#34;Touchpad0&#34; &#34;SendCoreEvents&#34;</pre></div></div></div><div class=sect2><h3 id=_как_использовать_удалённые_x_дисплеи>11.7. Как использовать удалённые X-дисплеи?<a class=anchor href=#_как_использовать_удалённые_x_дисплеи></a></h3><div class=paragraph><p>Из соображений обеспечения информационной безопасности открывать удалённые окна на машине по умолчанию запрещено.</p></div><div class=paragraph><p>Для включения этой возможности запустите X с аргументом <code>-listen_tcp</code>:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>% startx <span class=nt>-listen_tcp</span></code></pre></div></div></div><div class=sect2><h3 id=_что_такое_виртуальные_консоли_и_как_изменить_их_количество>11.8. Что такое виртуальные консоли и как изменить их количество?<a class=anchor href=#_что_такое_виртуальные_консоли_и_как_изменить_их_количество></a></h3><div class=paragraph><p>Виртуальные консоли предоставляют несколько одновременных сеансов работы с той же самой машиной без установки какой бы то ни было сети или запуска X.</p></div><div class=paragraph><p>При запуске системы после вывода сообщений этапа загрузки на консоль выдаётся приглашение для входа в систему. Введите своё имя и пароль, чтобы начать работу на первой виртуальной консоли.</p></div><div class=paragraph><p>Чтобы запустить ещё один сеанс, скажем, чтобы заглянуть в документацию по программе или для чтения электронной почты во время ожидания завершения передачи данных по FTP, нажмите <kbd>F2</kbd>, удерживая <kbd>Alt</kbd>. Это отобразит приглашение на второй виртуальной консоли. Чтобы вернуться к первоначальному сеансу, нажмите <span class=keyseq><kbd>Alt</kbd>+<kbd>F1</kbd></span>.</p></div><div class=paragraph><p>По умолчанию во FreeBSD задействованы восемь виртуальных консолей, а комбинации клавиш <span class=keyseq><kbd>Alt</kbd>+<kbd>F1</kbd></span>, <span class=keyseq><kbd>Alt</kbd>+<kbd>F2</kbd></span>, <span class=keyseq><kbd>Alt</kbd>+<kbd>F3</kbd></span> и далее служат для переключения между ними.</p></div><div class=paragraph><p>Чтобы увеличить количество виртуальных консолей, отредактируйте <span class=filename>/etc/ttys</span> (смотрите страницу Справочника <a href="https://man.freebsd.org/cgi/man.cgi?query=ttys&amp;sektion=5&amp;format=html">ttys(5)</a>), добавив туда записи для терминалов с именами от <span class=filename>ttyv8</span> до <span class=filename>ttyvc</span> после комментария про "Virtual terminals":</p></div><div class="literalblock programlisting"><div class=content><pre># Edit the existing entry for ttyv8 in /etc/ttys and change
# &#34;off&#34; to &#34;on&#34;.
ttyv8   &#34;/usr/libexec/getty Pc&#34;	 xterm  on secure
ttyv9   &#34;/usr/libexec/getty Pc&#34;	 xterm  on secure
ttyva   &#34;/usr/libexec/getty Pc&#34;	 xterm  on secure
ttyvb   &#34;/usr/libexec/getty Pc&#34;	 xterm  on secure</pre></div></div><div class=paragraph><p>Чем больше виртуальных терминалов, тем больше ресурсов используется. Это может привести к проблемам на системах с 8 Мбайт ОЗУ или меньше. Подумайте о смене статуса консолей с <code>secure</code> на <code>insecure</code>.</p></div><div class="admonitionblock important"><table><tbody><tr><td class=icon><i class="fa icon-important" title=Important></i></td><td class=content><div class=paragraph><p>Чтобы запустить сервер X, нужно зарезервировать под него хотя бы один виртуальный терминал со значением <code>off</code>. Это означает, что под виртуальные консоли можно отвести только одиннадцать функциональных клавиш, и ещё одна остаётся за X-сервером.</p></div></td></tr></tbody></table></div><div class=paragraph><p>Например, чтобы запустить X и 11 виртуальных консолей, нужно настроить двенадцатый виртуальный терминал:</p></div><div class="literalblock programlisting"><div class=content><pre>ttyvb   &#34;/usr/libexec/getty Pc&#34;	 xterm  off secure</pre></div></div><div class=paragraph><p>Самым простым способом активировать виртуальные консоли является перезагрузка.</p></div></div><div class=sect2><h3 id=vty-from-x>11.9. Как осуществляется доступ к виртуальным консолям из X?<a class=anchor href=#vty-from-x></a></h3><div class=paragraph><p>Используйте комбинацию клавиш <span class=keyseq><kbd>Ctrl</kbd>+<kbd>Alt</kbd>+<kbd>Fn</kbd></span> для переключения обратно в виртуальную консоль. Нажмите <span class=keyseq><kbd>Ctrl</kbd>+<kbd>Alt</kbd>+<kbd>F1</kbd></span>, чтобы вернуться на первую виртуальную консоль.</p></div><div class=paragraph><p>После того, как вы оказались в текстовой консоли, используйте комбинации <span class=keyseq><kbd>Alt</kbd>+<kbd>Fn</kbd></span> для переключения между ними.</p></div><div class=paragraph><p>Чтобы вернуться в сеанс работы X, переключитесь в виртуальную консоль, на которой запущена X Window.
Если X была запущена из командной строки с использованием команды <code>startx</code>, то сеанс работы X будет привязан к следующей неиспользуемой виртуальной консоли, а не к той текстовой консоли, с которой она была запущен.
В случае восьми активных виртуальных терминалов X будет работать на девятом, поэтому используйте комбинацию <span class=keyseq><kbd>Alt</kbd>+<kbd>F9</kbd></span>.</p></div></div><div class=sect2><h3 id=xdm-boot>11.10. Как запустить XDM во время загрузки?<a class=anchor href=#xdm-boot></a></h3><div class=paragraph><p>Есть две философские школы, проповедующие различные методы запуска <a href="https://man.freebsd.org/cgi/man.cgi?query=xdm&amp;sektion=8&amp;format=html">xdm(8)</a>.
Последователи одного течения запускают <code>xdm</code> из <span class=filename>/etc/ttys</span>
(посмотрите <a href="https://man.freebsd.org/cgi/man.cgi?query=ttys&amp;sektion=5&amp;format=html">ttys(5)</a>), используя приводимый там пример, тогда как другие
устанавливают значение параметра <code>xdm_enable=yes</code> в <span class=filename>/etc/rc.conf</span>.
Оба метода равноправны, и один из них может работать в ситуациях, с которыми не
справляется другой, и наоборот. В обоих случаях результат один и тот же: X
выводит графическое приглашение для входа в систему.</p></div><div class=paragraph><p>Плюсом метода с использованием <a href="https://man.freebsd.org/cgi/man.cgi?query=ttys&amp;sektion=5&amp;format=html">ttys(5)</a> является документирование того, на каком vty будет запущен X и то, что ответственность за перезапуск X-сервера при завершении сеанса работы лежит на процессе <a href="https://man.freebsd.org/cgi/man.cgi?query=init&amp;sektion=8&amp;format=html">init(8)</a>. Метод с использованием <a href="https://man.freebsd.org/cgi/man.cgi?query=rc&amp;sektion=8&amp;format=html">rc(8)</a> позволяет просто прекратить работу xdm командой <code>kill xdm</code>, если при запуске X возникли какие-нибудь проблемы.</p></div><div class=paragraph><p>При использовании метода с <a href="https://man.freebsd.org/cgi/man.cgi?query=rc&amp;sektion=8&amp;format=html">rc(8)</a> значение <code>xdm_tty</code> (которое по умолчанию
определено как <code>ttyv8</code>) может быть задано в файле <span class=filename>/etc/rc.conf</span>
для указания виртуального терминала, на котором запускается <a href="https://man.freebsd.org/cgi/man.cgi?query=xdm&amp;sektion=8&amp;format=html">xdm(8)</a>.</p></div></div><div class=sect2><h3 id=xconsole-failure>11.11. При запуске xconsole выдаётся сообщение Couldn’t open console.<a class=anchor href=#xconsole-failure></a></h3><div class=paragraph><p>Если X запускается с помощью startx, права на устройство <span class=filename>/dev/console</span><em>не</em> изменяются, поэтому такие программы как xterm -C и xconsole не будут работать.</p></div><div class=paragraph><p>Это зависит от прав доступа, установленных для консоли по умолчанию. В многопользовательской системе вовсе не нужно, чтобы любой пользователь мог выводить информацию на системную консоль. Для пользователей, вошедших в систему через VTY, для решения этой проблемы существует файл <a href="https://man.freebsd.org/cgi/man.cgi?query=fbtab&amp;sektion=5&amp;format=html">fbtab(5)</a>.</p></div><div class=paragraph><p>В общем, раскомментируйте строчку в файле <span class=filename>/etc/fbtab</span> (посмотрите справку по <a href="https://man.freebsd.org/cgi/man.cgi?query=fbtab&amp;sektion=5&amp;format=html">fbtab(5)</a>):</p></div><div class="literalblock programlisting"><div class=content><pre>/dev/ttyv0 0600 /dev/console</pre></div></div><div class=paragraph><p>Этого будет достаточно для того, чтобы всякий, кто вошёл в систему с терминала <span class=filename>/dev/ttyv0</span>, имел доступ к консоли.</p></div></div><div class=sect2><h3 id=ps2-x>11.12. Моя мышь PS/2 в X работает неправильно.<a class=anchor href=#ps2-x></a></h3><div class=paragraph><p>Мышь и драйвер могли рассинхронизироваться. В редких случаях драйвер может ошибочно сообщать о проблемах синхронизации:</p></div><div class="literalblock programlisting"><div class=content><pre>psmintr: out of sync (xxxx != yyyy)</pre></div></div><div class=paragraph><p>Если это случилось, отмените проверку согласования, установив значение флага для драйвера мыши PS/2 в <code>0x100</code>. Проще всего это сделать добавлением <code>hint.psm.0.flags="0x100"</code> в <span class=filename>/boot/loader.conf</span> с перезагрузкой.</p></div></div><div class=sect2><h3 id=mouse-button-reverse>11.13. Как поменять местами кнопки мыши?<a class=anchor href=#mouse-button-reverse></a></h3><div class=paragraph><p>Наберите <code>xmodmap -e "pointer = 3 2 1"</code>. Добавьте эту команду в <span class=filename>~/.xinitrc</span> или <span class=filename>~/.xsession</span> для автоматического запуска.</p></div></div><div class=sect2><h3 id=install-splash>11.14. Как установить экранную заставку и где такие заставки можно найти?<a class=anchor href=#install-splash></a></h3><div class=paragraph><p>Подробный ответ находится в разделе extref:https://docs.freebsd.org/ru/books/handbook/[Загрузочные
экранные заставки, boot-splash] Руководства FreeBSD.</p></div></div><div class=sect2><h3 id=_можно_ли_в_x_задействовать_windows_клавиши_на_клавиатуре>11.15. Можно ли в X задействовать <kbd>Windows</kbd>-клавиши на клавиатуре?<a class=anchor href=#_можно_ли_в_x_задействовать_windows_клавиши_на_клавиатуре></a></h3><div class=paragraph><p>Да.
Воспользуйтесь <a href="https://man.freebsd.org/cgi/man.cgi?query=xmodmap&amp;sektion=1&amp;format=html">xmodmap(1)</a> для привязки функций к этим клавишам.</p></div><div class=paragraph><p>Если все клавиатуры Windows стандартны, то эти три клавиши имеют следующие клавиатурные коды:</p></div><div class=ulist><ul><li><p>115 - клавиша <kbd>Windows</kbd> между клавишами <kbd>Ctrl</kbd> и <kbd>Alt</kbd> с левой стороны</p></li><li><p>116 - клавиша <kbd>Windows</kbd> справа от <kbd>AltGr</kbd></p></li><li><p>117 - клавиша <kbd>Menu</kbd>, слева от клавиши <kbd>Ctrl</kbd>, находящейся справа</p></li></ul></div><div class=paragraph><p>Чтобы заставить левую клавишу <kbd>Windows</kbd> набирать запятую, попробуйте выполнить такую команду:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># xmodmap -e &#34;keycode 115 = comma&#34;</span></code></pre></div></div><div class=paragraph><p>Для того, чтобы переопределения клавиш <kbd>Windows</kbd> выполнялись автоматически каждый раз при запуске X, поместите команды <code>xmodmap</code> в <span class=filename>~/.xinitrc</span> либо, что предпочтительней, создайте файл <span class=filename>~/.xmodmaprc</span> и включите в него параметры <code>xmodmap</code> по одному на строку, затем добавьте в <span class=filename>~/.xinitrc</span> такую строку:</p></div><div class="literalblock programlisting"><div class=content><pre>xmodmap $HOME/.xmodmaprc</pre></div></div><div class=paragraph><p>Например, чтобы переопределить эти 3 клавиши так, чтобы они выполняли функции клавиш <kbd>F13</kbd>, <kbd>F14</kbd> и <kbd>F15</kbd>. Это позволит легко привязать их к полезным функциям в приложениях или менеджере окон.</p></div><div class=paragraph><p>Чтобы сделать это, поместите такие строки в файл <span class=filename>~/.xmodmaprc</span>:</p></div><div class="literalblock programlisting"><div class=content><pre>keycode 115 = F13
keycode 116 = F14
keycode 117 = F15</pre></div></div><div class=paragraph><p>При использовании менеджера рабочего стола <a class=package href=https://cgit.freebsd.org/ports/tree/x11-wm/fvwm2/>x11-wm/fvwm2</a> клавиши можно переопределить так, чтобы нажатие <kbd>F13</kbd> сворачивало в иконку (и восстанавливало предыдущий размер) того окна, на которое указывает курсор, <kbd>F14</kbd> перемещало окно с курсором на передний план или, если оно уже впереди, возвращало обратно, а <kbd>F15</kbd> вызывало главное меню Workplace, даже если курсор находится не на рабочем столе, что бывает полезно, когда рабочий стол совсем не виден.</p></div><div class=paragraph><p>Следующие записи в <span class=filename>~/.fvwmrc</span> позволяют достичь описанных выше функций:</p></div><div class="literalblock programlisting"><div class=content><pre>Key F13	FTIWS	A	Iconify
Key F14	FTIWS	A	RaiseLower
Key F15	A	A	Menu Workplace Nop</pre></div></div></div><div class=sect2><h3 id=x-3d-acceleration>11.16. Как активировать аппаратное ускорение 3D-графики для OpenGL®?<a class=anchor href=#x-3d-acceleration></a></h3><div class=paragraph><p>Наличие 3D-ускорения зависит от версии сервера Xorg и типа графического
адаптера. Для адаптера nVidia используйте предскомпилированный драйвер для
FreeBSD, установив один из нижеследующих портов:</p></div><div class=paragraph><p>Последние версии адаптеров nVidia поддерживаются портом
<a class=package href=https://cgit.freebsd.org/ports/tree/x11/nvidia-driver/>x11/nvidia-driver</a>.</p></div><div class=paragraph><p>Более старые драйверы доступны в следующем виде:</p></div><div class=ulist><ul><li><p><a class=package href=https://cgit.freebsd.org/ports/tree/x11/nvidia-driver-390/>x11/nvidia-driver-390</a></p></li><li><p><a class=package href=https://cgit.freebsd.org/ports/tree/x11/nvidia-driver-340/>x11/nvidia-driver-340</a></p></li><li><p><a class=package href=https://cgit.freebsd.org/ports/tree/x11/nvidia-driver-304/>x11/nvidia-driver-304</a></p></li></ul></div><div class=paragraph><p>nVidia предоставляет подробную информацию о том, какие адаптеры поддерживаются тем или иным драйвером, на своём сайте: <a href=http://www.nvidia.com/object/IO_32667.html>http://www.nvidia.com/object/IO_32667.html</a>.</p></div><div class=paragraph><p>Для адаптеров Matrox G200/G400 следует попробовать порт
<a class=package href=https://cgit.freebsd.org/ports/tree/x11-drivers/xf86-video-mga/>x11-drivers/xf86-video-mga</a>.</p></div><div class=paragraph><p>Для ATI Rage 128 и Radeon посмотрите страницы Справочника <a href="https://man.freebsd.org/cgi/man.cgi?query=ati&amp;sektion=4&amp;format=html">ati(4)</a>, <a href="https://man.freebsd.org/cgi/man.cgi?query=r128&amp;sektion=4&amp;format=html">r128(4)</a> и <a href="https://man.freebsd.org/cgi/man.cgi?query=radeon&amp;sektion=4&amp;format=html">radeon(4)</a>.</p></div></div></div></div><div class=sect1><h2 id=_работа_в_сети>12. Работа в сети<a class=anchor href=#_работа_в_сети></a></h2><div class=sectionbody><div class=sect2><h3 id=diskless-booting>12.1. Где можно найти информацию о бездисковой загрузке?<a class=anchor href=#diskless-booting></a></h3><div class=paragraph><p>"Бездисковая загрузка" означает, что машина с FreeBSD загружается по сети и
читает необходимые файлы с сервера, а не со своего диска. Подробное описание
есть в extref:https://docs.freebsd.org/ru/books/handbook/advanced-networking/[соответствующей главе,
network-diskless] Руководства.</p></div></div><div class=sect2><h3 id=router>12.2. Может ли машина с FreeBSD использоваться как выделенный маршрутизатор?<a class=anchor href=#router></a></h3><div class=paragraph><p>Да.
Обратитесь к разделу Руководства, посвящённому
<a href=https://docs.freebsd.org/ru/books/handbook/advanced-networking/#advanced-networking>сложным вопросам работы в сети</a>, а
именно к той части, где рассказывается о <a href=https://docs.freebsd.org/ru/books/handbook/advanced-networking/#network-routing>маршрутизации и шлюзах маршрутизации</a>.</p></div></div><div class=sect2><h3 id=natd>12.3. Поддерживает ли FreeBSD технологию NAT или Masquerading?<a class=anchor href=#natd></a></h3><div class=paragraph><p>Да.
Для получения указаний по использованию NAT через подключение PPP
обратитесь к <a href=https://docs.freebsd.org/ru/books/handbook/}ppp-and-slip/#userppp>разделу Руководства о PPP</a>.
Чтобы использовать NAT вместе с другим типом сетевого подключения, взгляните
на раздел Руководства, посвящённый extref:[natd, network-natd].</p></div></div><div class=sect2><h3 id=ethernet-aliases>12.4. Как настроить алиас в сети Ethernet?<a class=anchor href=#ethernet-aliases></a></h3><div class=paragraph><p>Если алиас находится в той же самой сети, что и уже настроенный на интерфейсе адрес, допишите к этой команде <code>netmask 0xffffffff</code>:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># ifconfig ed0 alias 192.0.2.2 netmask 0xffffffff</span></code></pre></div></div><div class=paragraph><p>В противном случае укажите сетевой адрес и маску обычным образом:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># ifconfig ed0 alias 172.16.141.5 netmask 0xffffff00</span></code></pre></div></div><div class=paragraph><p>Дополнительная информация может быть найдена в extref:https://docs.freebsd.org/ru/books/handbook/config/[Руководстве,
configtuning-virtual-hosts] по FreeBSD.</p></div></div><div class=sect2><h3 id=_почему_я_не_могу_смонтировать_диск_linux_по_nfs>12.5. Почему я не могу смонтировать диск Linux® по NFS?<a class=anchor href=#_почему_я_не_могу_смонтировать_диск_linux_по_nfs></a></h3><div class=paragraph><p>Некоторые версии NFS для Linux® поддерживают запросы на монтирование только с привилегированного порта; попробуйте выполнить следующую команду:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># mount -o -P linuxbox:/blah /mnt</span></code></pre></div></div></div><div class=sect2><h3 id=exports-errors>12.6. Почему mountd продолжает выдавать сообщения can’t change attributes и bad exports list на моём сервере NFS, работающем под управлением FreeBSD?<a class=anchor href=#exports-errors></a></h3><div class=paragraph><p>В большинстве случаев проблема заключается в недостаточном понимании корректного формата файла <span class=filename>/etc/exports</span>.
Просмотрите ещё раз справочную информацию по <a href="https://man.freebsd.org/cgi/man.cgi?query=exports&amp;sektion=5&amp;format=html">exports(5)</a> и раздел об <a href=https://docs.freebsd.org/ru/books/handbook/network-servers/#network-nfs>NFS</a> Руководства, особенно в части <a href=https://docs.freebsd.org/ru/books/handbook/#configuring-nfs>настройки NFS</a>.</p></div></div><div class=sect2><h3 id=ip-multicast>12.7. Как включить поддержку multicast IP?<a class=anchor href=#ip-multicast></a></h3><div class=paragraph><p>Установите пакет <a class=package href=https://cgit.freebsd.org/ports/tree/net/mrouted/>net/mrouted</a> и добавьте <code>mrouted_enable="YES"</code> в <span class=filename>/etc/rc.conf</span> для запуска этого сервиса во время загрузки.</p></div></div><div class=sect2><h3 id=fqdn-hosts>12.8. Почему я должен использовать FQDN для хостов не в моей сети?<a class=anchor href=#fqdn-hosts></a></h3><div class=paragraph><p>За ответом на этот вопрос обратитесь к extref:https://docs.freebsd.org/ru/books/handbook/mail/[Руководству,
mail-trouble] по FreeBSD.</p></div></div><div class=sect2><h3 id=network-permission-denied>12.9. Почему при выполнении любых сетевых операций выдаётся сообщение Permission denied?<a class=anchor href=#network-permission-denied></a></h3><div class=paragraph><p>Если ядро скомпилировано с параметром <code>IPFIREWALL</code>, имейте в виду, что политикой по умолчанию является запрет прохождения любых пакетов, которые не разрешены явным образом.</p></div><div class=paragraph><p>Если межсетевой экран был случайно сконфигурирован неверным образом, то для восстановления работоспособности сети наберите такую команду из-под пользователя <code>root</code>:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># ipfw add 65534 allow all from any to any</span></code></pre></div></div><div class=paragraph><p>Рассмотрите использование <code>firewall_type='open'</code> в файле <span class=filename>/etc/rc.conf</span>.</p></div><div class=paragraph><p>Дополнительная информация о настройке данного межсетевого экрана находится в
<a href=https://docs.freebsd.org/ru/books/handbook/firewalls/#firewalls-ipfw>соответствующей главе</a> Руководства.</p></div></div><div class=sect2><h3 id=ipfw-fwd>12.10. Почему моё правило “fwd” для <code>ipfw</code> по перенаправлению сервиса на другую машину не работает?<a class=anchor href=#ipfw-fwd></a></h3><div class=paragraph><p>Возможно, потому что вместо простого перенаправления пакетов нужна трансляция сетевых адресов (NAT). Правило "fwd" только перенаправляет пакеты и данные внутри него не меняет.
Рассмотрим такое правило:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>01000 fwd 10.0.0.1 from any to foo 21</code></pre></div></div><div class=paragraph><p>Когда пакет с адресом назначения <em>foo</em> достигает машины с этим правилом, пакет перенаправляется на <em>10.0.0.1</em>, но в нём остаётся адрес назначения <em>foo</em>.
Адрес назначения пакета не меняется на <em>10.0.0.1</em>.
Большинство машин, скорее всего, отбросят полученный пакет, имеющий адрес назначения, им не соответствующий.
Таким образом, правило "fwd" часто работает не так, как ожидает пользователь.
Описанное поведение является особенностью, а не ошибкой.</p></div><div class=paragraph><p>Обратитесь к <a href=#service-redirect>FAQ о перенаправлении сервисов</a>, руководству по <a href="https://man.freebsd.org/cgi/man.cgi?query=natd&amp;sektion=8&amp;format=html">natd(8)</a> или одной из нескольких утилит для перенаправления портов из <a href=https://www.FreeBSD.org/ports/>Коллекции Портов</a> для того, чтобы сделать это правильно.</p></div></div><div class=sect2><h3 id=service-redirect>12.11. Как можно перенаправить запросы сервисов с одной машины на другую?<a class=anchor href=#service-redirect></a></h3><div class=paragraph><p>Запросы FTP и других сервисов можно перенаправить с помощью порта <a class=package href=https://cgit.freebsd.org/ports/tree/sysutils/socket/>sysutils/socket</a>. Замените запись для этого сервиса в <span class=filename>/etc/inetd.conf</span> на вызов <code>socket</code>, как показано в этом примере для ftpd:</p></div><div class="literalblock programlisting"><div class=content><pre>ftp stream tcp nowait nobody /usr/local/bin/socket socket ftp.example.com ftp</pre></div></div><div class=paragraph><p>где <em>ftp.example.com</em> и <em>ftp</em> являются соответственно хостом и портом для перенаправления.</p></div></div><div class=sect2><h3 id=bandwidth-mgr-tool>12.12. Где можно найти средства управления сетевым трафиком?<a class=anchor href=#bandwidth-mgr-tool></a></h3><div class=paragraph><p>Для FreeBSD имеются три средства управления трафиком. <a href="https://man.freebsd.org/cgi/man.cgi?query=dummynet&amp;sektion=4&amp;format=html">dummynet(4)</a> интегрирован в систему FreeBSD как составная часть <a href="https://man.freebsd.org/cgi/man.cgi?query=ipfw&amp;sektion=4&amp;format=html">ipfw(4)</a>. <a href=http://www.sonycsl.co.jp/person/kjc/programs.html>ALTQ</a> включен во FreeBSD как составная часть <a href="https://man.freebsd.org/cgi/man.cgi?query=pf&amp;sektion=4&amp;format=html">pf(4)</a>. Bandwidth Manager компании <a href=http://www.etinc.com/>Emerging Technologies</a> является коммерческим продуктом.</p></div></div><div class=sect2><h3 id=bpf-not-configured>12.13. Почему появляются сообщения /dev/bpf0: device not configured?<a class=anchor href=#bpf-not-configured></a></h3><div class=paragraph><p>Для работы приложения требуется Berkeley Packet Filter (<a href="https://man.freebsd.org/cgi/man.cgi?query=bpf&amp;sektion=4&amp;format=html">bpf(4)</a>), однако это устройство удалено из вашего ядра. Постройте новое ядро с добавлением в его конфигурационный файл следующей строки:</p></div><div class="literalblock programlisting"><div class=content><pre>device bpf	# Berkeley Packet Filter</pre></div></div></div><div class=sect2><h3 id=mount-smb-share>12.14. Как смонтировать диск Windows®-машины в моей локальной сети, как это делает smbmount в Linux®?<a class=anchor href=#mount-smb-share></a></h3><div class=paragraph><p>Используйте пакет SMBFS. В него включён набор изменений в ядре и пользовательские программы. Программы и информация доступны как <a href="https://man.freebsd.org/cgi/man.cgi?query=mount_smbfs&amp;sektion=8&amp;format=html">mount_smbfs(8)</a> и входят в состав базовой системы.</p></div></div><div class=sect2><h3 id=icmp-response-bw-limit>12.15. Что значат сообщения Limiting icmp/open port/closed port response в файле журнала?<a class=anchor href=#icmp-response-bw-limit></a></h3><div class=paragraph><p>Данное сообщение ядра означает, что имеет место некоторая активность, приводящая к отправке большого количества ответных пакетов ICMP или сбросов TCP (RST). Ответы ICMP часто генерируются в результате попыток подключения к незанятым портам UDP. Сбросы TCP генерируются в результате попыток подключения к закрытым портам TCP. Помимо всего прочего, такие сообщения могут быть вызваны следующими действиями:</p></div><div class=ulist><ul><li><p>Лобовая атака типа отказ в обслуживании DoS (в отличие от атак в один пакет, которые используют конкретную брешь в защите).</p></li><li><p>Сканирование портов в попытке осуществить подключение к большому количеству портов (в отличие от проб нескольких известных портов).</p></li></ul></div><div class=paragraph><p>Первое число в сообщении показывает количество пакетов, которое ядро отправило
бы при отсутствии ограничений, а второе число отражает лимит.
Этот лимит управляется при помощи переменной <code>net.inet.icmp.icmplim</code>.
В этом примере устанавливается лимит на <code>300</code> пакетов в секунду:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># sysctl net.inet.icmp.icmplim=300</span></code></pre></div></div><div class=paragraph><p>Для выключения подобных сообщений без отключения самого ограничения используйте <code>net.inet.icmp.icmplim_output</code>, чтобы подавить вывода:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># sysctl net.inet.icmp.icmplim_output=0</span></code></pre></div></div><div class=paragraph><p>И наконец, чтобы полностью выключить это ограничение, сделайте <code>net.inet.icmp.icmplim</code> равным <code>0</code>. Выключение этого лимита не приветствуется по причинам, изложенным выше.</p></div></div><div class=sect2><h3 id=unknown-hw-addr-format>12.16. Что это за сообщения arp: unknown hardware address format?<a class=anchor href=#unknown-hw-addr-format></a></h3><div class=paragraph><p>Это означает, что какое-то устройство в локальной сети Ethernet использует MAC-адрес в формате, неизвестном FreeBSD. Вероятно, это происходит из-за того, что кто-то в сети экспериментирует с сетевым адаптером. Чаще всего это происходит в сетях с кабельными модемами. Это безобидно и не должно влиять на производительность системы FreeBSD.</p></div></div><div class=sect2><h3 id=arp-wrong-iface>12.17. Почему я постоянно вижу сообщения вида 192.168.0.10 is on fxp1 but got reply from 00:15:17:67:cf:82 on rl0 и как мне их отключить?<a class=anchor href=#arp-wrong-iface></a></h3><div class=paragraph><p>Это так, потому что пакет приходит извне сети, чего не должно быть. Чтобы отключить эти сообщения, установите <code>net.link.ether.inet.log_arp_wrong_iface</code> в значение <code>0</code>.</p></div></div><div class=sect2><h3 id=ipv6-only>12.18. Как скомпилировать ядро, поддерживающее только IPv6?<a class=anchor href=#ipv6-only></a></h3><div class=paragraph><p>Выполните конфигурацию ядра со следующими параметрами:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>include GENERIC
ident GENERIC-IPV6ONLY
makeoptions MKMODULESENV+<span class=o>=</span><span class=s2>&#34;WITHOUT_INET_SUPPORT=&#34;</span>
nooptions INET
nodevice gre</code></pre></div></div></div></div></div><div class=sect1><h2 id=_безопасность>13. Безопасность<a class=anchor href=#_безопасность></a></h2><div class=sectionbody><div class=sect2><h3 id=_что_означает_термин_sandbox_песочница>13.1. Что означает термин sandbox (песочница)?<a class=anchor href=#_что_означает_термин_sandbox_песочница></a></h3><div class=paragraph><p>"Sandbox" - это термин, используемый при обеспечении безопасности. Он имеет два значения:</p></div><div class=ulist><ul><li><p>Процесс, помещённый внутрь некоторых виртуальных стен, которые предназначены для предотвращения взлома всей системы в результате взлома этого конкретного процесса.</p><div class=paragraph><p>Процесс может работать только в границах этих стен.
Поскольку, что бы этот процесс ни делал, он эти стены разрушить не может, особый аудит его кода не нужен для того, чтобы с уверенностью сказать, насколько его работа безопасна для системы.</p></div><div class=paragraph><p>Стеной может служить, например, идентификатор пользователя. Вот определение, даваемое на страницах Справочника <a href="https://man.freebsd.org/cgi/man.cgi?query=security&amp;sektion=7&amp;format=html">security(7)</a> и <a href="https://man.freebsd.org/cgi/man.cgi?query=named&amp;sektion=8&amp;format=html">named(8)</a>.</p></div><div class=paragraph><p>Рассмотрим, например, службу <code>ntalk</code> (смотрите <a href="https://man.freebsd.org/cgi/man.cgi?query=inetd&amp;sektion=8&amp;format=html">inetd(8)</a>).
Раньше эта служба запускалась с полномочиями пользователя <code>root</code>.
Теперь она запускается с полномочиями пользователя с идентификатором <code>tty</code>.
Пользователь <code>tty</code> является песочницей, предназначенной для того, чтобы
пользователю, которому удалось проникнуть в систему через <code>ntalk</code>, было сложнее
взломать систему и получить полномочия больше, чем обладает этот идентификатор.</p></div></li><li><p>Процесс, помещённый внутрь симулируемой машины.
Это означает, что некто, взломавший процесс, может думать, что может сломать и
систему в целом, однако фактически может сломать только симулятор этой машины
и не может модифицировать никаких реальных данных.</p><div class=paragraph><p>Самым распространённым способом достигнуть такого результата является построение имитирующего окружения в каталоге и затем запуск процессов в этом каталоге через chroot (т.е. задав этот каталог в качестве <span class=filename>/</span> для этого процесса, а не реальный <span class=filename>/</span> всей системы).</p></div><div class=paragraph><p>Другим часто используемым методом является монтирование низлежащей файловой системы в режиме "только для чтения" и затем создание уровня файловой системы поверх неё, что даёт процессу видимость доступа по записи на ту файловую систему. Процесс будет полагать, что может записывать в те файлы, но это будет единственный процесс, который увидит результат - другие процессы не будут этого делать ни в коем случае.</p></div><div class=paragraph><p>Попытка сделать такой тип песочницы настолько прозрачна, что пользователь (или взломщик) даже не поймёт, что он в ней находится.</p></div></li></ul></div><div class=paragraph><p>В UNIX® реализованы два типа "песочниц". Один на уровне процесса, и один на уровне идентификаторов пользователей.</p></div><div class=paragraph><p>Каждый процесс в UNIX® полностью защищён от других процессов. Никакой процесс не может модифицировать адресное пространство другого процесса.</p></div><div class=paragraph><p>В UNIX® каждым процессом владеет некоторый идентификатор пользователя. Если этот пользователь не <code>root</code>, он ограждает процесс от других, владельцами которых являются другие пользователи. Этот идентификатор используется также для защиты данных на диске.</p></div></div><div class=sect2><h3 id=securelevel>13.2. Что такое уровень безопасности (securelevel)?<a class=anchor href=#securelevel></a></h3><div class=paragraph><p><code>securelevel</code> является механизмом обеспечения безопасности, который реализован в ядре. Когда уровень защиты больше нуля, ядро ограничивает выполнение некоторых операций; даже суперпользователю <code>root</code> запрещается их выполнять. Механизм уровня защиты ограничивает возможности по:</p></div><div class=ulist><ul><li><p>снятию некоторых флагов с файлов, таких, как <code>schg</code> (системный флаг неизменяемости),</p></li><li><p>записи в память ядра через устройства <span class=filename>/dev/mem</span> и <span class=filename>/dev/kmem</span>,</p></li><li><p>загрузке модулей ядра и</p></li><li><p>изменению правил сетевого экрана.</p></li></ul></div><div class=paragraph><p>Для выяснения состояния уровня защиты в работающей системе:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># sysctl -n kern.securelevel</span></code></pre></div></div><div class=paragraph><p>Результат содержит текущее значение уровня защиты.
Если оно больше нуля, то по крайней мере некоторые из защит этого механизма включены.</p></div><div class=paragraph><p>Уровень защиты работающей системы не может быть понижен, поскольку это противоречит назначению этого механизма.
Если для задачи требуется неположительный уровень защиты, измените значения переменных <code>kern_securelevel</code> и <code>kern_securelevel_enable</code> в файле <span class=filename>/etc/rc.conf</span>, а затем перезагрузите систему.</p></div><div class=paragraph><p>Более подробная информация об уровнях защиты и о том, какие специфические действия выполняют все уровни, может быть найдена на справочных страницах о <a href="https://man.freebsd.org/cgi/man.cgi?query=init&amp;sektion=8&amp;format=html">init(8)</a>.</p></div><div class="admonitionblock warning"><table><tbody><tr><td class=icon><i class="fa icon-warning" title=Warning></i></td><td class=content><div class=paragraph><p>Уровень защиты не является панацеей; в нём есть много недостатков. Зачастую он даёт обманчивое чувство безопасности.</p></div><div class=paragraph><p>Одной из самых больших проблем является то, что для его эффективной работы все файлы, используемые в процессе загрузки, должны быть защищены.
Если атакующий сможет заставить систему выполнять свой код до установки уровня защиты (что происходит достаточно поздно во время процесса загрузки, так как некоторые вещи, выполняемые системой в это время, не могут быть сделаны при повышенном уровне защиты), то эта защита может быть отключена.
Хотя такая задача по защите всех файлов, используемых в процессе загрузки, технически вполне осуществима, если это будет сделано, то поддержка системы станет кошмаром, так как для изменения конфигурационного файла придётся останавливать систему, переводя её по крайней мере в однопользовательский режим.</p></div><div class=paragraph><p>Это обстоятельство, а также ряд других, часто обсуждаются в списках рассылки, в частности, во <a href=https://lists.FreeBSD.org/subscription/freebsd-security>Список рассылки FreeBSD, посвящённый информационной безопасности</a>.
Поищите в <a href=https://www.FreeBSD.org/search/>архивах</a> более подробное обсуждение. Предпочтителен более гибкий механизм.</p></div></td></tr></tbody></table></div></div><div class=sect2><h3 id=toor-account>13.3. Что это за пользователь toor с UID 0? Я подвергся взлому?<a class=anchor href=#toor-account></a></h3><div class=paragraph><p>Не волнуйтесь, <code>toor</code> является "альтернативной" учётной записью суперпользователя (toor - это root, записанный задом наперёд).
Его предлагается использовать с нестандартным командным интерпретатором, так чтобы не нужно было менять используемый по умолчанию командный процессор для <code>root</code>.
Это важно, так как оболочки, не являющиеся частью дистрибутива системы, но установленные из портов или пакаджей, размещаются в каталоге <span class=filename>/usr/local/bin</span>, который по умолчанию располагается в другой файловой системе.
Если командный процессор для пользователя <code>root</code> располагается в <span class=filename>/usr/local/bin</span> и файловая система, содержащая <span class=filename>/usr/local/bin</span>, не смонтирована, то пользователь <code>root</code> не сможет войти в систему для исправления проблемы и понадобится перезагрузиться в однопользовательском режиме, чтобы указать путь до командного процессора.</p></div><div class=paragraph><p>Некоторые используют <code>toor</code> для выполнения повседневных административных работ с нестандартным командным процессором, оставляя <code>root</code> со стандартной оболочкой для работы в однопользовательском режиме или выполнения аварийных работ.
По умолчанию ни один пользователь не сможет войти в систему как <code>toor</code>, потому что для этой учётной записи не указан пароль, поэтому войдите из-под <code>root</code> и установите пароль для <code>toor</code> до того, как использовать его для входа в систему.</p></div></div></div></div><div class=sect1><h2 id=serial>14. Коммуникационные адаптеры<a class=anchor href=#serial></a></h2><div class=sectionbody><div class=paragraph><p>В этом разделе освещены вопросы о работе последовательных адаптеров во FreeBSD.</p></div><div class=sect2><h3 id=serial-console-prompt>14.1. Как сделать так, чтобы приглашение boot: выводилось на консоль на последовательном порту?<a class=anchor href=#serial-console-prompt></a></h3><div class=paragraph><p>Подробная информация находится в <a href=https://docs.freebsd.org/ru/books/handbook/serialcomms/#serialconsole-setup>этом разделе Руководства</a>.</p></div></div><div class=sect2><h3 id=found-serial>14.2. Как узнать, обнаружила ли FreeBSD последовательные порты или внутренние модемы?<a class=anchor href=#found-serial></a></h3><div class=paragraph><p>В процессе своей загрузки ядро FreeBSD будет пытаться найти последовательные порты, с поддержкой которых ядро сконфигурировано. Внимательно просмотрите сообщения загрузки либо выполните такую команду после того, как система запустилась и работает:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>% <span class=nb>grep</span> <span class=nt>-E</span> <span class=s1>&#39;^(sio|uart)[0-9]&#39;</span> &lt; /var/run/dmesg.boot
uart0: &lt;16550 or compatible&gt; port 0x3f8-0x3ff irq 4 flags 0x10 on acpi0
uart0: console <span class=o>(</span>115200,n,8,1<span class=o>)</span>
uart1: &lt;16550 or compatible&gt; port 0x2f8-2x3ff irq 3 on acpi0</code></pre></div></div><div class=paragraph><p>В этом примере присутствуют два последовательных порта. Первый находится на IRQ4, порт ввода/вывода <code>0x3f8</code>, и построен на микросхеме UART типа 16550. Второй использует тот же тип микросхемы, но находится на IRQ3 и использует адрес порта ввода/вывода <code>0x2f8</code>. Внутренние модемы выглядят точно также, как последовательные порты, за исключением того, что модем к ним подключен всегда.</p></div><div class=paragraph><p>В ядро <span class=filename>GENERIC</span> встроена поддержка двух последовательных портов, с теми же IRQ и адресами портов ввода/вывода, как указано в примере выше. Если эти настройки не соответствуют системе или имеется больше внутренних модемов или последовательных портов, чем описано в ядре, переконфигурируйте его, следуя инструкциям в разделе <a href=#make-kernel>о построении ядра</a>.</p></div></div><div class=sect2><h3 id=access-serial-ports>14.3. Как осуществляется доступ к последовательным портам во FreeBSD? (специфично для x86)<a class=anchor href=#access-serial-ports></a></h3><div class=paragraph><p>Третий последовательный порт, <span class=filename>sio2</span> или <span class=filename>COM3</span>, обозначается как <span class=filename>/dev/cuad2</span> для устройств, выполняющих исходящие звонки, и <span class=filename>/dev/ttyd2</span> для устройств, принимающих входящие звонки. Какая разница между этими двумя классами устройств?</p></div><div class=paragraph><p>При открытии <span class=filename>/dev/ttydX</span> в блокирующем режиме процесс будет ожидать неактивности соответствующего устройства <span class=filename>cuadX</span>, а затем появления сигнала о наличии несущей. При открытии устройства <span class=filename>cuadX</span> он проверяет, что последовательный порт не занят устройством <span class=filename>ttydX</span>. Если порт доступен, он похищает его у устройства <span class=filename>ttydX</span>. Также устройство <span class=filename>cuadX</span> не следит за наличием несущей. С такой схемой работы и модемом в режиме автоответа удалённые пользователи могут входить в систему, а локальные пользователи через тот же модем могут по прежнему осуществлять исходящие звонки, а система позаботится о возможных конфликтах.</p></div></div><div class=sect2><h3 id=enable-multiport-serial>14.4. Как включить поддержку многопортовых последовательных адаптеров?<a class=anchor href=#enable-multiport-serial></a></h3><div class=paragraph><p>Информация о конфигурировании ядра содержится в соответствующем разделе, посвящённом этому вопросу. Для многопортовых последовательных адаптеров добавьте в файл <a href="https://man.freebsd.org/cgi/man.cgi?query=device.hints&amp;sektion=5&amp;format=html">device.hints(5)</a> по строке <a href="https://man.freebsd.org/cgi/man.cgi?query=sio&amp;sektion=4&amp;format=html">sio(4)</a> на каждый порт. Но IRQ должен быть указан только у одного порта. Все порты на адаптере должны использовать одно и то же значение IRQ. Для обеспечения согласованности используйте для указания IRQ последний последовательный порт. Также укажите следующую опцию в файле конфигурации ядра:</p></div><div class="literalblock programlisting"><div class=content><pre>COM_MULTIPORT</pre></div></div><div class=paragraph><p>В следующем примере указано содержимое <span class=filename>/boot/device.hints</span> для 4-портового последовательного адаптера AST на IRQ 12:</p></div><div class="literalblock programlisting"><div class=content><pre>hint.sio.4.at=&#34;isa&#34;
hint.sio.4.port=&#34;0x2a0&#34;
hint.sio.4.flags=&#34;0x701&#34;
hint.sio.5.at=&#34;isa&#34;
hint.sio.5.port=&#34;0x2a8&#34;
hint.sio.5.flags=&#34;0x701&#34;
hint.sio.6.at=&#34;isa&#34;
hint.sio.6.port=&#34;0x2b0&#34;
hint.sio.6.flags=&#34;0x701&#34;
hint.sio.7.at=&#34;isa&#34;
hint.sio.7.port=&#34;0x2b8&#34;
hint.sio.7.flags=&#34;0x701&#34;
hint.sio.7.irq=&#34;12&#34;</pre></div></div><div class=paragraph><p>Флаги указывают, что управляющий порт имеет младший номер устройства <code>7</code> (<code>0x700</code>), и все порты совместно используют один и тот же номер IRQ (<code>0x001</code>).</p></div></div><div class=sect2><h3 id=default-serial-params>14.5. Можно ли настроить для последовательного порта режим работы по умолчанию?<a class=anchor href=#default-serial-params></a></h3><div class=paragraph><p>Смотрите раздел Руководства по FreeBSD, посвящённый
<a href=https://docs.freebsd.org/ru/books/handbook/serialcomms/#serial-hw-config>последовательным соединениям</a>.</p></div></div><div class=sect2><h3 id=cannot-tip>14.6. Почему не удаётся запустить tip или cu?<a class=anchor href=#cannot-tip></a></h3><div class=paragraph><p>Встроенные утилиты <a href="https://man.freebsd.org/cgi/man.cgi?query=tip&amp;sektion=1&amp;format=html">tip(1)</a> и <a href="https://man.freebsd.org/cgi/man.cgi?query=cu&amp;sektion=1&amp;format=html">cu(1)</a> могут получить доступ к каталогу <span class=filename>/var/spool/lock</span> только из-под пользователя <code>uucp</code> и членов группы <code>dialer</code>. Используйте группу <code>dialer</code> для управления доступом к модему или удалённым системам посредством добавления в неё пользовательских учётных записей.</p></div><div class=paragraph><p>Либо же можно разрешить всем запускать <a href="https://man.freebsd.org/cgi/man.cgi?query=tip&amp;sektion=1&amp;format=html">tip(1)</a> и <a href="https://man.freebsd.org/cgi/man.cgi?query=cu&amp;sektion=1&amp;format=html">cu(1)</a>:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># chmod 4511 /usr/bin/cu</span>
<span class=c># chmod 4511 /usr/bin/tip</span></code></pre></div></div></div></div></div><div class=sect1><h2 id=_разное>15. Разное<a class=anchor href=#_разное></a></h2><div class=sectionbody><div class=sect2><h3 id=more-swap>15.1. Почему FreeBSD использует много места в разделе подкачки даже при большом объёме свободной памяти?<a class=anchor href=#more-swap></a></h3><div class=paragraph><p>FreeBSD активно перемещает неиспользуемые страницы памяти, к которым не было обращений, в раздел подкачки, чтобы увеличить объём доступной физической памяти для активного использования. Такое активное использование раздела подкачки компенсируется использованием дополнительной свободной оперативной памяти для кеширования.</p></div><div class=paragraph><p>Заметьте, что хотя FreeBSD предпочитает использовать раздел подкачки, страницы не перемещаются произвольно при полностью неактивной системе. По этой причине система не будет находиться целиком в разделе подкачки после ночного простаивания.</p></div></div><div class=sect2><h3 id=top-freemem>15.2. Почему утилита <a href="https://man.freebsd.org/cgi/man.cgi?query=top&amp;sektion=1&amp;format=html">top(1)</a> показывает очень маленький объём свободной памяти, даже когда запущено всего лишь несколько приложений?<a class=anchor href=#top-freemem></a></h3><div class=paragraph><p>Просто дело в том, что под свободной памятью подразумевается никак не
используемая память. Вся память, которая программам явно не выделялась,
используется ядром FreeBSD для дискового кэша. Значения, показываемые
утилитой &amp;man.top.1; с метками <code>Inact</code> и <code>Laundry</code>, являются кэшированными
данными разных степеней устаревания. То, что данные находятся в кэше, означает, что система не будет обращаться к медленному диску снова за теми данными, обращение к которым было недавно, повышая таким образом общую производительность. В общем случае маленькие значения в пункте <code>Free</code>, показываемые утилитой <a href="https://man.freebsd.org/cgi/man.cgi?query=top&amp;sektion=1&amp;format=html">top(1)</a> для свободной памяти - это хорошо, если, конечно они не <em>очень</em> маленькие.</p></div></div><div class=sect2><h3 id=chmod-symlinks>15.3. Почему командой chmod невозможно изменить права на символические ссылки?<a class=anchor href=#chmod-symlinks></a></h3><div class=paragraph><p>Символические ссылки не имеют атрибутов доступа, и по умолчанию утилита <a href="https://man.freebsd.org/cgi/man.cgi?query=chmod&amp;sektion=1&amp;format=html">chmod(1)</a> следует по символической ссылке, чтобы по возможности изменить права доступа на исходный файл. Для файла <span class=filename>foo</span> с символической ссылкой <span class=filename>bar</span> на этот файл эта команда всегда будет выполняться успешно.</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>% <span class=nb>chmod </span>g-w bar</code></pre></div></div><div class=paragraph><p>Однако права на файл <span class=filename>bar</span> не изменятся.</p></div><div class=paragraph><p>Чтобы это работало, используйте опцию <code>-H</code> или <code>-L</code> вместе с опцией <code>-R</code>. Обратитесь к страницам Справочника по команде <a href="https://man.freebsd.org/cgi/man.cgi?query=chmod&amp;sektion=1&amp;format=html">chmod(1)</a> и по <a href="https://man.freebsd.org/cgi/man.cgi?query=symlink&amp;sektion=7&amp;format=html">symlink(7)</a>.</p></div><div class="admonitionblock warning"><table><tbody><tr><td class=icon><i class="fa icon-warning" title=Warning></i></td><td class=content><div class=paragraph><p>Опция <code>-R</code> выполняет <a href="https://man.freebsd.org/cgi/man.cgi?query=chmod&amp;sektion=1&amp;format=html">chmod(1)</a> <em>рекурсивно</em>. Будьте внимательны, задавая каталоги или символические ссылки на каталоги в параметрах <a href="https://man.freebsd.org/cgi/man.cgi?query=chmod&amp;sektion=1&amp;format=html">chmod(1)</a>. Чтобы изменить права на каталог, на который указывает символическая ссылка, используйте <a href="https://man.freebsd.org/cgi/man.cgi?query=chmod&amp;sektion=1&amp;format=html">chmod(1)</a> без опций и следуйте символической ссылке с помощью лидирующего слэша (<span class=filename>/</span>). Например, если <span class=filename>foo</span> является символической ссылкой на каталог <span class=filename>bar</span>, то чтобы изменить права на <span class=filename>foo</span> (на самом деле на <span class=filename>bar</span>), выполните такую команду:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>% <span class=nb>chmod </span>555 foo/</code></pre></div></div><div class=paragraph><p>Если задан ведущий слэш, то <a href="https://man.freebsd.org/cgi/man.cgi?query=chmod&amp;sektion=1&amp;format=html">chmod(1)</a> будет следовать символической ссылке <span class=filename>foo</span>, меняя права на каталог <span class=filename>bar</span>.</p></div></td></tr></tbody></table></div></div><div class=sect2><h3 id=dos-binaries>15.4. Могу ли я запускать программы для DOS во FreeBSD?<a class=anchor href=#dos-binaries></a></h3><div class=paragraph><p>Да.
Программа эмуляции DOS, <a class=package href=https://cgit.freebsd.org/ports/tree/emulators/doscmd/>emulators/doscmd</a>, доступна в Коллекции Портов
FreeBSD.</p></div><div class=paragraph><p>Если doscmd не достаточно, <a class=package href=https://cgit.freebsd.org/ports/tree/emulators/pcemu/>emulators/pcemu</a> эмулирует 8088 и набор сервисов BIOS, достаточный для запуска многих приложений текстового режима DOS. Требуется X Window System.</p></div><div class=paragraph><p>В Коллекции Портов FreeBSD также имеется <a class=package href=https://cgit.freebsd.org/ports/tree/emulators/dosbox/>emulators/dosbox</a>. Программа в основном предназначена для эмуляции старых игр, написанных под DOS, для хранения файлов которых используется локальная файловая система.</p></div></div><div class=sect2><h3 id=translation>15.5. Что мне нужно сделать, чтобы перевести документацию FreeBSD на мой родной язык?<a class=anchor href=#translation></a></h3><div class=paragraph><p>Ознакомьтесь с <a href=https://docs.freebsd.org/en/books/fdp-primer/#translations>FAQ по Переводам</a> из FreeBSD Documentation Project Primer.</p></div></div><div class=sect2><h3 id=freebsd-mail-bounces>15.6. Почему возвращается моя электронная почта, отправленная на любой из адресов FreeBSD.org?<a class=anchor href=#freebsd-mail-bounces></a></h3><div class=paragraph><p>В почтовой системе <code>FreeBSD.org</code> в Postfix применяются некоторые проверки входящей почты, и отвергаются сообщения, которые были неправильно сформированы при пересылке либо как-то иначе похожи на спам. Вот некоторые из требований:</p></div><div class=ulist><ul><li><p>IP-адрес клиента SMTP должен иметь обратное преобразование в символическое имя.</p></li><li><p>Полное имя хоста, указанное на этапе EHLO/HELO в процессе обмена сообщениями SMTP, должно разрешаться в IP-адрес клиента.</p></li></ul></div><div class=paragraph><p>Дополнительные советы по доставке письма:</p></div><div class=ulist><ul><li><p>Письмо должно быть отправлено в текстовом формате. Сообщение в почтовый список рассылки, как правило, не должно иметь размер больше 200 Кбайт.</p></li><li><p>Избегайте избыточного кросспостинга.
Выберите <em>один</em> список рассылки, который кажется наиболее подходящим.</p></li></ul></div><div class=paragraph><p>Если у вас всё ещё остались трудности при работе с почтовой инфраструктурой <code>FreeBSD.org</code>, отправьте сообщение с подробным описанием на адрес <a href=mailto:postmaster@freebsd.org>postmaster@freebsd.org</a>. Укажите в нём временной интервал для проверки логов - и обратите внимание, что мы держим журнал почтовых логов всего за неделю. (Обязательно укажите часовой пояс или разницу в UTC.)</p></div></div><div class=sect2><h3 id=free-account>15.7. Где можно получить бесплатный доступ к FreeBSD?<a class=anchor href=#free-account></a></h3><div class=paragraph><p>Хотя FreeBSD не предоставляет бесплатный доступ ни к одному из своих серверов, другие компании предоставляют UNIX®-системы с открытым доступом. Стоимость этой услуги различна, также как и ограниченный набор услуг.</p></div><div class=paragraph><p><a href=http://www.arbornet.org/>Arbornet, Inc</a>, также известный как <em>M-Net</em>, предоставляет свободный доступ к UNIX®-системам с 1983 года. Начиная на платформе Altos с работающей System III, сайт перешёл на BSD/OS в 1991. В июне 2000 сайт сменил систему снова, теперь на FreeBSD. <em>M-Net</em> может быть доступна через протоколы telnet и SSH и предоставляет доступ к полному набору программного обеспечения FreeBSD. Однако доступ к сети ограничен для членов и спонсоров, которые поддерживают систему, которая работает как неприбыльная организация. <em>M-Net</em> предоставляет также услуги электронной доски объявлений (BBS) и интерактивного чата.</p></div></div><div class=sect2><h3 id=daemon-name>15.8. Как зовут этого маленького симпатичного красного парня?<a class=anchor href=#daemon-name></a></h3><div class=paragraph><p>У него нет определённого имени, он называется просто "даемон BSD".
Если вам непременно нужно имя, называйте его "beastie".
Заметьте, что "beastie" произносится как "BSD".</p></div><div class=paragraph><p>Больше о даемоне BSD можно узнать из его <a href=http://www.mckusick.com/beastie/index.html>домашней страницы</a>.</p></div></div><div class=sect2><h3 id=use-beastie>15.9. Могу ли я использовать изображение даемона BSD?<a class=anchor href=#use-beastie></a></h3><div class=paragraph><p>Вполне может быть.
Правами на даемона BSD обладает Marshall Kirk McKusick.
Для выяснения подробностей относительно правил его использования обратитесь к странице автора <a href=http://www.mckusick.com/beastie/mainpage/copyright.html>Statement on the Use of the BSD Daemon Figure</a>.</p></div><div class=paragraph><p>В общем, использовать изображение можно в высокохудожественном стиле и в личных целях, если даются соответствующие отсылки. Перед использованием знака в коммерческих целях обратитесь за разрешением к Kirk McKusick &lt;<a href=mailto:mckusick@FreeBSD.org>mckusick@FreeBSD.org</a>>. Дополнительная информация находится на <a href=http://www.mckusick.com/beastie/index.html>домашней странице Даемона BSD</a>.</p></div></div><div class=sect2><h3 id=daemon-images>15.10. Не найдётся ли у вас изображений даемона BSD, которые можно использовать?<a class=anchor href=#daemon-images></a></h3><div class=paragraph><p>В каталоге <span class=filename>/usr/share/examples/BSD_daemon/</span> есть рисунки в форматах
eps и Xfig.</p></div></div><div class=sect2><h3 id=glossary>15.11. При просмотре списков рассылки я встретил сокращение или другой термин, который мне не понятен. Где я должен посмотреть, что он значит?<a class=anchor href=#glossary></a></h3><div class=paragraph><p>Обратитесь к <a href=https://docs.freebsd.org/ru/books/handbook/glossary/>Глоссарию FreeBSD</a>.</p></div></div><div class=sect2><h3 id=bikeshed-painting>15.12. Почему я должен беспокоиться о цвете велосипедных навесов (bikeshed)?<a class=anchor href=#bikeshed-painting></a></h3><div class=paragraph><p>На самом деле, очень краткий ответ на этот вопрос заключается в том, что вы этого делать не должны. Если давать более подробный ответ, то ваше умение делать навесы не должно означать, что вы должны препятствовать другим делать их просто потому, что вам не нравится цвет, в который они собираются их окрашивать. Эта метафора означает, что вам не нужно обсуждать каждую мелочь просто потому, что вы знаете о ней достаточно много. Некоторые люди отмечают, что объём шума, генерируемый при появлении некоторого изменения, находится в обратной зависимости от сложности самого изменения.</p></div><div class=paragraph><p>Более пространный и полный ответ заключается в том, что после очень долгого обсуждения того, должна ли утилита <a href="https://man.freebsd.org/cgi/man.cgi?query=sleep&amp;sektion=1&amp;format=html">sleep(1)</a> обрабатывать дробное число, заданное в качестве второго аргумента, Poul-Henning Kamp &lt;<a href=mailto:phk@FreeBSD.org>phk@FreeBSD.org</a>> опубликовал большое сообщение,
озаглавленное <a href=http://www.bikeshed.com>Велосипедный навес (любого цвета) на
зелёной траве…​</a>. Соответствующие части этого сообщения цитируются ниже.</p></div><div class=paragraph><p>Poul-Henning Kamp &lt;<a href=mailto:phk@FreeBSD.org>phk@FreeBSD.org</a>> on freebsd-hackers, October 2, 1999
"Что это за история с этим навесом для велосипеда?", кто-то из вас спрашивал меня.</p></div><div class=paragraph><p>Это долгая история, точнее, это старая история, но на самом деле она коротка.
В начале 1960-х годов Сирил Норткот Паркинсон (C. Northcote Parkinson) написал книгу "Законы Паркинсона", которая содержит много интересных взглядов на процесс управления.</p></div><div class=paragraph><p><em>[немного выдержек из краткого содержания книги]</em></p></div><div class=paragraph><p>В конкретном примере велосипедный навес сопоставляется с другим важным объектом - атомной электростанцией. Я полагаю, что это иллюстрирует древность книги.</p></div><div class=paragraph><p>Паркинсон показывает, что вы можете прийти на совещание руководителей и получить добро на строительство многомиллионной или даже многомиллиардной атомной электростанции, но если вы хотите построить навес для велосипеда, то погрязнете в бесконечных обсуждениях.</p></div><div class=paragraph><p>Паркинсон объясняет это тем, что атомная станция настолько большой, дорогой и сложный объект, что люди не могут его осознать и вместо того, чтобы попробовать это сделать, они полагаются на то, что кто-то уже проверил все мелочи до того, как всё зашло так далеко. В своей книге Ричард П. Фейнманн (Richard P. Feynmann) даёт несколько интересных и очень поучительных примеров, связанных с Лос Аламос.</p></div><div class=paragraph><p>Велосипедный навес - это противоположный случай. Любой может построить навес за один уикэнд, и у него ещё останется время посмотреть футбол по телевизору. Так что не важно, насколько хорошо вы готовились к обсуждению, насколько убедительны будут ваши аргументы, кто-нибудь воспользуется шансом показать, что он не зря ест свой хлеб, что он обращает внимание, что он <em>здесь</em>.</p></div><div class=paragraph><p>В Дании это называется “оставить отпечаток своего пальца”.
Это всё касается личной гордости и престижа, это возможность указать куда-то и сказать: “Вот! Это сделал я”.
Это сильно выражено в политиках, но присутствует во многих людях, которые получают возможность сделать это.
Просто вспомните об отпечатках ног во влажном цементе.</p></div></div></div></div><div class=sect1><h2 id=_юмор_от_freebsd>16. Юмор от FreeBSD<a class=anchor href=#_юмор_от_freebsd></a></h2><div class=sectionbody><div class=sect2><h3 id=very-very-cool>16.1. Насколько FreeBSD горяча?<a class=anchor href=#very-very-cool></a></h3><div class=paragraph><p><em>В.</em> Кто-нибудь делал замеры температуры при работе FreeBSD?
Я знаю, что Linux® греется меньше, чем DOS, но никогда не видел упоминания FreeBSD.
Наверное, эта система - горячая штучка.</p></div><div class=paragraph><p><em>О.</em> Нет, но мы сделали различные вкусовые тесты у добровольцев с завязанными
глазами, которые до этого приняли по 250 микрограмм LSD-25. 35% участников
заявили, что FreeBSD имеет вкус апельсина, тогда как вкус Linux® был похож на
фиолетовый туман. Ни одна из групп не отметила значительной разницы в
температуре. Мы уже собирались опубликовать полные результаты этого опроса,
когда обнаружили, что слишком много добровольцев покинули помещение во время
тестов, что несколько смазало результаты. Думаем, что большинство добровольцев
работают сейчас в Apple над их новым GUI "чеши и нюхай". Это ведь старый
добрый бизнес!</p></div><div class=paragraph><p>Если серьёзно, то FreeBSD использует инструкцию HLT (halt), когда система
простаивает, что уменьшает потребление энергии и, в свою очередь, выделение
тепла.
Вдобавок, если у вас настроен ACPI (усовершенствованный интерфейс
управления конфигурацией и питанием), то FreeBSD может переводить процессор в
режим пониженного энергопотребления.</p></div></div><div class=sect2><h3 id=letmeoutofhere>16.2. Кто там скребётся в микросхемах памяти??<a class=anchor href=#letmeoutofhere></a></h3><div class=paragraph><p><em>В.</em> Делает ли FreeBSD что-нибудь "эдакое" при компиляции ядра, что вызывает поскрипывание микросхем памяти?
При компиляции (и в короткий промежуток времени после обнаружения дисковода при старте системы) от, видимо, микросхем памяти исходит странный царапающий звук.</p></div><div class=paragraph><p><em>О.</em> Да!
Вы встретите частое упоминание "даемонов" в документации по BSD, но
не все знают, что речь идёт о настоящих нематериальных существах, которые
теперь завладели и вашим компьютером. Царапающий звук, издаваемый микросхемами
памяти - это на самом деле высокочастотное перешёптывание между даемонами,
когда они решают, как лучше справиться с различными задачами по
администрированию системы.</p></div><div class=paragraph><p>Если шум достиг ваших ушей, команда DOS <code>fdisk /mbr</code> их спугнёт, но не
удивляйтесь, если они отреагируют соответствующим образом и попытаются вас
остановить.
Фактически, если во время выполнения этой команды вы услышите сатанинский голос
Билла Гейтса из встроенного динамика, бегите и даже не оглядывайтесь!
Избавленные от противостояния с даемонами BSD, близнецы-демоны DOS и Windows®
часто могут захватить полный контроль над вашей машиной, чтобы навлечь
вечное проклятие на вашу душу.
Теперь, когда вы это знаете, если бы у вас был выбор, думаем, что вы бы
предпочли привыкнуть к царапающему звуку, не так ли?</p></div></div><div class=sect2><h3 id=_сколько_требуется_разработчиков_freebsd_чтобы_сменить_электрическую_лампочку>16.3. Сколько требуется разработчиков FreeBSD, чтобы сменить электрическую лампочку?<a class=anchor href=#_сколько_требуется_разработчиков_freebsd_чтобы_сменить_электрическую_лампочку></a></h3><div class=paragraph><p>Необходимо иметь ровно одну тысячу сто шестьдесят девять разработчиков:</p></div><div class=paragraph><p>Двадцать три сообщат в -CURRENT о том, что не горит свет;</p></div><div class=paragraph><p>Четыре начнут утверждать, что это проблема конфигурации и такие сообщения нужно посылать в -questions;</p></div><div class=paragraph><p>Трое оформят PR по этому поводу, причём одно их них будет направлено в doc и будет содержать только строчку "здесь темно";</p></div><div class=paragraph><p>Один закоммитит неоттестированную лампочку, что сломает построение системы, а затем через пять минут вернёт всё назад;</p></div><div class=paragraph><p>Восемь поругаются с авторами PR по поводу включения патчей в PR;</p></div><div class=paragraph><p>Пять сообщат о том, что не проходит компиляция системы;</p></div><div class=paragraph><p>Тридцать один человек ответит, что у них всё работает и наверное, те обновились в неподходящее время;</p></div><div class=paragraph><p>Один пошлёт патч для новой лампочки в -hackers;</p></div><div class=paragraph><p>Один пожалуется, что у него имелись патчики ещё три года назад, но когда он послал их в -CURRENT, они были проигнорированы и он имел неудачный опыт работы с системой PR; кроме того предлагаемая лампочка не имеет отражателя.</p></div><div class=paragraph><p>Тридцать семь начнут кричать, что лампочки не относятся к базовой системе, что коммиттеры не имеют права делать такие вещи без опроса общественности и ЧТО ВООБЩЕ -CORE ДЕЛАЕТ ПО ЭТОМУ ПОВОДУ?</p></div><div class=paragraph><p>Две сотни напишут о цвете велосипедного навеса;</p></div><div class=paragraph><p>Трое скажут, что этот патч не соответствует <a href="https://man.freebsd.org/cgi/man.cgi?query=style&amp;sektion=9&amp;format=html">style(9)</a></p></div><div class=paragraph><p>Семнадцать возразят, что предлагаемая новая лампа подпадает под лицензию GPL;</p></div><div class=paragraph><p>Пятьсот восемьдесят шесть раздуют флейм по поводу сравнения лицензий GPL, BSD, MIT, NPL и личных мнений о неизвестных основателей FSF;</p></div><div class=paragraph><p>Семеро пошлют различные части этих обсуждений в -chat и -advocacy;</p></div><div class=paragraph><p>Один закоммитит предлагаемую лампу, хотя она светит хуже, чем старая;</p></div><div class=paragraph><p>Двое откатят эти изменения с ужасной руганью в журнале коммитта о том, что лучше FreeBSD будет сидеть в темноте, чем с тусклой лампой.</p></div><div class=paragraph><p>Сорок шесть громко воспротивятся этому изменению и потребуют объяснений от -core;</p></div><div class=paragraph><p>Одиннадцать попросят уменьшить размер лампочки, чтобы она подошла к их Тамагочи на случай, если мы когда-нибудь соберёмся переносить FreeBSD на эту платформу;</p></div><div class=paragraph><p>Семьдесят три заявят о SNR в -hackers и -chat и в знак протеста отпишутся;</p></div><div class=paragraph><p>Тринадцать пошлют письма "unsubscribe", "How do I unsubscribe?" или "Please remove me from the list" с обычной подписью;</p></div><div class=paragraph><p>Один закоммитит работающую лампочку в то время, как все будут слишком заняты руганью, чтобы это заметить;</p></div><div class=paragraph><p>Тридцать один человек напишет, что новая лампочка будет светить на 0.364% ярче, если её откомпилировать с помощью TenDRA (хотя при этом она приобретёт форму куба) и что FreeBSD должна перейти на компилятор TenDRA, а не на GCC;</p></div><div class=paragraph><p>Один заметит, что у лампочки отсутствует цоколь;</p></div><div class=paragraph><p>Девять (включая авторов PR) спросят "что такое MFC?";</p></div><div class=paragraph><p>Спустя две недели после смены лампочки пятьдесят семь человек сообщат о том, что света всё равно нет.</p></div><div class=paragraph><p><em>Nik Clayton &lt;<a href=mailto:nik@FreeBSD.org>nik@FreeBSD.org</a>> добавил:</em></p></div><div class=paragraph><p><em>Я сильно смеялся над всем этим.</em></p></div><div class=paragraph><p><em>И тогда я подумал, "Постойте-ка, найдётся ли кто-нибудь, чтобы задокументировать это?"</em></p></div><div class=paragraph><p><em>И на меня снизошло озарение :-)</em></p></div><div class=paragraph><p><em>Thomas Abthorpe &lt;<a href=mailto:tabthorpe@FreeBSD.org>tabthorpe@FreeBSD.org</a>></em> говорит: "Нет, <em>настоящие</em> хакеры FreeBSD не боятся темноты!"</p></div></div><div class=sect2><h3 id=dev-null>16.4. Куда направляются данные, записываемые в /dev/null?<a class=anchor href=#dev-null></a></h3><div class=paragraph><p>Они отправляются в специальную сточную трубу для данных в CPU, где преобразуются в тепло, выдуваемое через охлаждающие вентиляторы. Вот почему охлаждение ЦП становится все более важным; так как люди используют все более быстрые процессоры, они все менее заботятся о данных, все большее их количество оканчивает свой путь в <span class=filename>/dev/null</span>, перегревая ЦП. Если вы удалите <span class=filename>/dev/null</span> (что соответственно отключит трубу данных в ЦП), то ваш процессор может охладиться, но система начнет переполняться излишними данными и начнет работать с ошибками. Если у вас быстрое сетевое подключение, вы можете охладить CPU, читая данные из <span class=filename>/dev/random</span> и посылая их куда-нибудь; однако вы рискуете перегреть ваше сетевое соединение и <span class=filename>/</span> или разозлить вашего провайдера, так как большинство данных преобразуется в тепло на его оборудовании, но, как правило, у него хорошее охлаждение, так что если вы не перестараетесь, все должно быть в порядке.</p></div><div class=paragraph><p><em>Пол Робинсон (Paul Robinson) добавляет:</em></p></div><div class=paragraph><p>Есть и другие методы. Как знает каждый хороший системный администратор, частью хорошей практики является посылка данных на экран интересным образом, чтобы феи, которые образуют картинку, были счастливы. Экранные феи (часто неправильно называемые "пикселами") различаются по цвету головных уборов, которые они носят (красные, зеленые или синие), и прячутся или появляются (показывая, таким образом, цвет своих шляп), когда получают немного пищи. Видеоадаптеры преобразуют данные в еду для фей, а затем посылают ее феям - чем дороже адаптер, тем лучше еда, тем лучше ведут себя феи. Они также нуждаются в постоянной стимуляции - вот зачем нужны хранители экранов.</p></div><div class=paragraph><p>Продолжив наше предположение, вы можете просто выдавать случайные данные на консоль, таким образом позволяя феям их потреблять. Это вовсе приводит к прекращению выделения тепла, феи постоянно счастливы, а данные быстро исчезают, даже если на вашем экране все выглядит несколько хаотично.</p></div><div class=paragraph><p>Как бывший администратор крупного провайдера, который имел много проблем при попытке поддерживать постоянную температуру в серверной комнате, я выступаю против того, чтобы люди посылали ненужные им данные в сеть. Волшебников, которые выполняют коммутацию пакетов и маршрутизацию, это также затрудняет.</p></div></div><div class=sect2><h3 id=punk-my-friend>16.5. Мой коллега проводит слишком много времени за компьютером.<a class=anchor href=#punk-my-friend></a></h3><div class=paragraph><p>Как я могу отвадить его от этого?</p></div><div class=paragraph><p>Установите пакет <a class=package href=https://cgit.freebsd.org/ports/tree/games/sl/>games/sl</a> и дождитесь момента, когда коллега ошибочно
введёт <code>sl</code> вместо <code>ls</code>.</p></div></div></div></div><div class=sect1><h2 id=_сложные_темы>17. Сложные темы<a class=anchor href=#_сложные_темы></a></h2><div class=sectionbody><div class=sect2><h3 id=learn-advanced>17.1. Как можно узнать больше о внутреннем устройстве FreeBSD?<a class=anchor href=#learn-advanced></a></h3><div class=paragraph><p>Обратитесь к <a href=https://docs.freebsd.org/ru/books/arch-handbook/>Руководству по архитектуре FreeBSD</a>.</p></div><div class=paragraph><p>Кроме того, большинство общих знаний о UNIX® непосредственно применимо к FreeBSD.</p></div></div><div class=sect2><h3 id=how-to-contribute>17.2. Как внести свой вклад в проект FreeBSD? Что можно сделать в качестве помощи?<a class=anchor href=#how-to-contribute></a></h3><div class=paragraph><p>Мы принимаем помощь в любой форме: документации, кода и даже
художественной графики. Обратитесь к соответствующей статье
<a href=https://docs.freebsd.org/ru/articles/contributing/>Участие в проекте FreeBSD</a>, в которой вы найдёте советы
относительно того, как это сделать.&lt;/para></p></div><div class=paragraph><p>И спасибо вам за то, что вы об этом подумали!</p></div></div><div class=sect2><h3 id=define-snap-release>17.3. Что такое снапшоты и релизы?<a class=anchor href=#define-snap-release></a></h3><div class=paragraph><p>В <a href=http://cgit.FreeBSD.org/src/>хранилище Git</a> сейчас находятся 3 активно/полуактивно развивающихся ветки FreeBSD.
(Более ранние ветки изменяются очень редко, именно поэтому в разработке только 3 активные ветки):</p></div><div class=ulist><ul><li><p>stable/12, также известная как 12-STABLE</p></li><li><p>stable/13, также известная как 13-STABLE</p></li><li><p>main, также известная как <em>-CURRENT</em> и 15.0</p></li></ul></div><div class=paragraph><p>На данный момент <em>-CURRENT</em> является находящимся в разработке деревом
14.X; ветка 13-STABLE, stable/13, отделилась от <em>-CURRENT</em>
January 2021, а ветка 12-STABLE, stable/12, отделилась от
<em>-CURRENT</em> December 2018.</p></div></div><div class=sect2><h3 id=_что_делать_при_аварийном_останове_системы>17.4. Что делать при аварийном останове системы?<a class=anchor href=#_что_делать_при_аварийном_останове_системы></a></h3><div class=paragraph><p>Вот типичная паника ядра:</p></div><div class="literalblock programlisting"><div class=content><pre>Fatal trap 12: page fault while in kernel mode
fault virtual address   = 0x40
fault code              = supervisor read, page not present
instruction pointer     = 0x8:0xf014a7e5
stack pointer           = 0x10:0xf4ed6f24
frame pointer           = 0x10:0xf4ed6f28
code segment            = base 0x0, limit 0xfffff, type 0x1b
                        = DPL 0, pres 1, def32 1, gran 1
processor eflags        = interrupt enabled, resume, IOPL = 0
current process         = 80 (mount)
interrupt mask          =
trap number             = 12
panic: page fault</pre></div></div><div class=paragraph><p>Этого сообщения не достаточно.
Хотя значение указателя инструкций важно, но оно зависит от конфигурации, поскольку значение меняется для каждого конкретного файла ядра.
Если это ядро <span class=filename>GENERIC</span> из одного из снэпшотов, то кто-то ещё может отследить функцию, вызвавшую ошибку, но в случае со специально сконфигурированным ядром только вы можете сказать нам, где случилась ошибка.</p></div><div class=paragraph><p>Чтобы продолжить:</p></div><div class="exampleblock procedure"><div class=content><div class="olist arabic"><ol class=arabic><li><p>Запишите значение указателя инструкций.
Заметьте, что часть <code>0x8:</code> в этом случае не важна: нам нужна часть <code>0xf0xxxxxx</code>.</p></li><li><p>Когда система перезагрузится, сделайте следующее:</p><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>% nm <span class=nt>-n</span> kernel.that.caused.the.panic | <span class=nb>grep </span>f0xxxxxx</code></pre></div></div><div class=paragraph><p>где <code>f0xxxxxx</code> - это значение указателя инструкций. Однако неприятность заключается в том, что вы не получите точного соответствия, так как в таблице имен ядра для точек входа в функции даны адреса на начало функций, а указатель инструкций будет указывать куда-то внутрь её тела. Если вы не получили точного соответствия, опустите последнюю цифру в значении указателя инструкций и попробуйте снова:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>% nm <span class=nt>-n</span> kernel.that.caused.the.panic | <span class=nb>grep </span>f0xxxxx</code></pre></div></div><div class=paragraph><p>Если и это не привело ни к каким результатам, отрежьте следующую цифру. Повторяйте, пока не получите хоть что-то. Результатом будет список функций, которые, возможно, привели к аварийному останову. Этот механизм обнаружения ошибочного места довольно неточен, но это всё же лучше, чем ничего.</p></div></li></ol></div></div></div><div class=paragraph><p>Тем не менее, лучшим способом выяснить причину, вызвавшую аварийный останов, является получение аварийного дампа системы, а затем использование <a href="https://man.freebsd.org/cgi/man.cgi?query=kgdb&amp;sektion=1&amp;format=html">kgdb(1)</a> для получения трассировки вызовов в этом дампе.</p></div><div class=paragraph><p>В любом случае, метод таков:</p></div><div class="exampleblock procedure"><div class=content><div class="olist arabic"><ol class=arabic><li><p>Убедитесь в том, что в файле конфигурации ядра имеется следующая строка:</p><div class="literalblock programlisting"><div class=content><pre>makeoptions     DEBUG=-g          # Build kernel with gdb(1) debug symbols</pre></div></div></li><li><p>Перейдите в каталог <span class=filename>/usr/src</span>:</p><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># cd /usr/src</span></code></pre></div></div></li><li><p>Скомпилируйте ядро:</p><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># make buildkernel KERNCONF=MYKERNEL</span></code></pre></div></div></li><li><p>Дождитесь завершения компиляции.</p><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># make installkernel KERNCONF=MYKERNEL</span></code></pre></div></div></li><li><p>Выполните перезагрузку.</p></li></ol></div></div></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Если не указать <code>KERNCONF</code>, то будет собрано и установлено ядро <span class=filename>GENERIC</span>.</p></div></td></tr></tbody></table></div><div class=paragraph><p>В процессе выполнения команды <a href="https://man.freebsd.org/cgi/man.cgi?query=make&amp;sektion=1&amp;format=html">make(1)</a> будут построены два ядра, <span class=filename>/usr/obj/usr/src/sys/MYKERNEL/kernel</span> и <span class=filename>/usr/obj/usr/src/sys/MYKERNEL/kernel.debug</span>.
<span class=filename>kernel</span> будет установлен как <span class=filename>/boot/kernel/kernel</span>, тогда как <span class=filename>kernel.debug</span> может быть использован в качестве источника отладочной информации для <a href="https://man.freebsd.org/cgi/man.cgi?query=kgdb&amp;sektion=1&amp;format=html">kgdb(1)</a>.</p></div><div class=paragraph><p>Чтобы получать аварийный дамп, отредактируйте файл <span class=filename>/etc/rc.conf</span> так, чтобы устройство <code>dumpdev</code> указывало на раздел подкачки или имело значение <code>AUTO</code>. В этом случае скрипты <a href="https://man.freebsd.org/cgi/man.cgi?query=rc&amp;sektion=8&amp;format=html">rc(8)</a> будут вызывать команду <a href="https://man.freebsd.org/cgi/man.cgi?query=dumpon&amp;sektion=8&amp;format=html">dumpon(8)</a> для создания аварийных дампов. Эту команду можно также запускать вручную.
После аварийной остановки аварийный дамп может быть получен с помощью программы <a href="https://man.freebsd.org/cgi/man.cgi?query=savecore&amp;sektion=8&amp;format=html">savecore(8)</a>; если значение переменной <code>dumpdev</code> было задано в <span class=filename>/etc/rc.conf</span>, то скрипты <a href="https://man.freebsd.org/cgi/man.cgi?query=rc&amp;sektion=8&amp;format=html">rc(8)</a> запустят <a href="https://man.freebsd.org/cgi/man.cgi?query=savecore&amp;sektion=8&amp;format=html">savecore(8)</a> автоматически и поместят аварийный дамп в каталог <span class=filename>/var/crash</span>.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Аварийные дампы FreeBSD обычно имеют размер, равный объёму оперативной памяти. Поэтому убедитесь в наличии достаточного места для хранения дампа в каталоге <span class=filename>/var/crash</span>. Либо запустите вручную <a href="https://man.freebsd.org/cgi/man.cgi?query=savecore&amp;sektion=8&amp;format=html">savecore(8)</a>, чтобы создать аварийный дамп в другом каталоге, где достаточно места. Размер аварийного дампа можно уменьшить, указав в конфигурации ядра <code>options MAXMEM=N</code>, где <em>N</em> - значение в Кбайт для объёма памяти, которое будет использоваться ядром. Например, для 1 Гбайт ОЗУ установите ограничение на использование памяти ядром в 128 Мбайт, так чтобы размер аварийного дампа был равен 128 Мбайт, а не 1 Гбайт.</p></div></td></tr></tbody></table></div><div class=paragraph><p>Как только аварийный дамп получен, трассировку вызовов можно получить таким образом:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>% kgdb /usr/obj/usr/src/sys/MYKERNEL/kernel.debug /var/crash/vmcore.0
<span class=o>(</span>kgdb<span class=o>)</span> backtrace</code></pre></div></div><div class=paragraph><p>Заметьте, что это может дать несколько экранов полезной информации. Лучше всего использовать <a href="https://man.freebsd.org/cgi/man.cgi?query=script&amp;sektion=1&amp;format=html">script(1)</a> для перехвата всего вывода. При использовании необработанного файла ядра со всей отладочной информацией может быть найдена конкретная строка исходного текста ядра, при достижении которой случилась аварийная остановка. Для выяснения последовательности событий, приведших к аварийному останову, трассировка стека обычно читается снизу вверх. Также можно использовать <a href="https://man.freebsd.org/cgi/man.cgi?query=kgdb&amp;sektion=1&amp;format=html">kgdb(1)</a> для вывода значений различных переменных или структур, чтобы выяснить состояние системы во время аварии.</p></div><div class="admonitionblock tip"><table><tbody><tr><td class=icon><i class="fa icon-tip" title=Tip></i></td><td class=content><div class=paragraph><p>Если есть второй компьютер, то можно настроить <a href="https://man.freebsd.org/cgi/man.cgi?query=kgdb&amp;sektion=1&amp;format=html">kgdb(1)</a> на режим удалённой отладки, включая определение точек останова и пошаговый проход по коду ядра.</p></div></td></tr></tbody></table></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Если включена поддержка <code>DDB</code> и ядро переходит в режим отладки, можно намеренно вызвать аварийный останов и создание аварийного дампа, набрав <code>panic</code> в приглашении командной строки <code>ddb</code>. Выполнение фазы аварийного останова может снова остановиться с вызовом отладчика. В этом случае наберите <code>continue</code>, и процесс будет завершён созданием аварийного дампа.</p></div></td></tr></tbody></table></div></div><div class=sect2><h3 id=dlsym-failure>17.5. Перестала работать функция dlsym() для исполняемых файлов ELF!<a class=anchor href=#dlsym-failure></a></h3><div class=paragraph><p>По умолчанию при работе с форматом ELF символы, определённые в исполняемом файле, не доступны динамическому загрузчику. Поэтому при вызове функции <code>dlsym()</code>, которая осуществляет поиск по дескриптору, полученному после вызова <code>dlopen(NULL, flags)</code>, желаемый результат достигнут не будет.</p></div><div class=paragraph><p>Чтобы осуществить поиск символов в исполняемом файле процесса с помощью функции <code>dlsym()</code>, выполните компоновку исполняемого файла с параметром <code>--export-dynamic</code> компоновщика ELF (<a href="https://man.freebsd.org/cgi/man.cgi?query=ld&amp;sektion=1&amp;format=html">ld(1)</a>).</p></div></div><div class=sect2><h3 id=change-kernel-address-space>17.6. Как я могу увеличить или уменьшить адресное пространство ядра в архитектуре i386?<a class=anchor href=#change-kernel-address-space></a></h3><div class=paragraph><p>По умолчанию размер адресного пространства ядра для i386 равен 1 Гбайт (2 Гбайт для PAE). Для работы сервера с интенсивной сетевой нагрузкой или при использовании ZFS этого может быть недостаточно.</p></div><div class=paragraph><p>Чтобы увеличить доступное пространство, добавьте следующую строку в файл конфигурации ядра и пересоберите ядро:</p></div><div class="literalblock programlisting"><div class=content><pre>options KVA_PAGES=N</pre></div></div><div class=paragraph><p>Чтобы получить нужное значение для <em>N</em>, разделите желаемый размер адресного пространства (в мегабайтах) на четыре (для 2 Гбайт это будет <code>512</code>).</p></div></div></div></div><div class=sect1><h2 id=acknowledgments>18. Наши благодарности<a class=anchor href=#acknowledgments></a></h2><div class=sectionbody><div class=paragraph><p>Этот небольшой скромный документ с ответами на часто задаваемые вопросы создавался, переписывался, редактировался, сокращался, растягивался, уродовался, потрошился, пристально разглядывался, полностью перетряхивался, обдумывался, отвергался, перестраивался, критиковался и снова укреплялся в течение последнего десятилетия силами сотен, если не тысяч, людей.
Постоянно.</p></div><div class=paragraph><p>Мы хотим поблагодарить каждого из них и приглашаем вас
<a href=https://docs.freebsd.org/ru/articles/contributing/>присоединиться к ним</a>, чтобы сделать этот FAQ ещё лучше.</p></div></div></div></div><hr><div class=last-modified><p><strong>Изменено</strong>: 29 августа 2023 г. by <a href="https://cgit.freebsd.org/doc/commit/?id=62a9442593" target=_blank>Andrei Zakhvatov</a></p></div><div class=buttons><div class=home><i class="fa fa-home" aria-hidden=true title=Главная></i><div class=container><a href=../ class=direction>Главная</a></div></div></div><label class="hidden book-menu-overlay" for=menu-control></label></div><aside class=toc><div class=toc-content><h3>Содержание</h3><nav id=TableOfContents><ul><li><a href=#_вступление>1. Вступление</a></li><li><a href=#_документация_и_поддержка>2. Документация и поддержка</a></li><li><a href=#_установка>3. Установка</a></li><li><a href=#hardware>4. Аппаратная совместимость</a></li><li><a href=#troubleshoot>5. Устранение некоторых проблем</a></li><li><a href=#applications>6. Прикладные программы</a></li><li><a href=#kernelconfig>7. Конфигурирование ядра</a></li><li><a href=#_диски_файловые_системы_и_начальные_загрузчики>8. Диски, файловые системы и начальные загрузчики</a></li><li><a href=#_zfs>9. ZFS</a></li><li><a href=#_системное_администрирование>10. Системное администрирование</a></li><li><a href=#_x_window_system_и_виртуальные_консоли>11. X Window System и виртуальные консоли</a></li><li><a href=#_работа_в_сети>12. Работа в сети</a></li><li><a href=#_безопасность>13. Безопасность</a></li><li><a href=#serial>14. Коммуникационные адаптеры</a></li><li><a href=#_разное>15. Разное</a></li><li><a href=#_юмор_от_freebsd>16. Юмор от FreeBSD</a></li><li><a href=#_сложные_темы>17. Сложные темы</a></li><li><a href=#acknowledgments>18. Наши благодарности</a></li></ul></nav><hr><div class=resources><h3>Материалы</h3><ul class=contents><li><i class="fa fa-file-pdf-o" aria-hidden=true title="Скачать PDF"></i><a href=https://download.freebsd.org/doc/ru/books/faq/faq_ru.pdf>Скачать PDF</a></li><li><i class="fa fa-pencil-square-o" aria-hidden=true title="Редактировать эту страницу"></i><a href=https://github.com/freebsd/freebsd-doc/blob/main/documentation/content/ru/_index target=_blank>Редактировать эту страницу</a></li></ul></div></div></aside><a class=to-top href=#top><i class="fa fa-arrow-circle-up" aria-hidden=true></i></a></main><footer><div class=footer-container><section class=logo-column><img src=http://172.16.201.134:1313/images/FreeBSD-colors.svg width=160 height=50 alt="FreeBSD logo"><div class=options-container><div class=language-container><a id=languages href=http://172.16.201.134:1313/ru/languages><img src=http://172.16.201.134:1313/images/language.png class=language-image alt="Выберите язык">
<span>Русский</span></a></div><div class=theme-container><select id=theme-chooser><option value=theme-system>Система</option><option value=theme-light>Светлый</option><option value=theme-dark>Тёмный</option><option value=theme-high-contrast>Высокая контрастность</option></select></div></div></section><section class=about-column><h3 class=column-title>О нас</h3><ul class=column-elements-container><li><a href=https://www.freebsd.org/about/ target=_blank class=column-element>FreeBSD</a></li><li><a href=https://freebsdfoundation.org/ target=_blank class=column-element>Фонд FreeBSD</a></li><li><a href=https://www.freebsd.org/where/ target=_blank class=column-element>Получить FreeBSD</a></li><li><a href=https://www.freebsd.org/internal/code-of-conduct target=_blank class=column-element>Кодекс Этики</a></li><li><a href=https://www.freebsd.org/security/ target=_blank class=column-element>Бюллетени Безопасности</a></li></ul></section><section class=documentation-column><h3 class=column-title>Документация</h3><ul class=column-elements-container><li><a href=/ru class=column-element>Портал документации</a></li><li><a href=https://man.FreeBSD.org target=_blank class=column-element>Страницы Справочника</a></li><li><a href=https://papers.FreeBSD.org target=_blank class=column-element>Презентации и публикации</a></li><li><a href=https://docs-archive.freebsd.org/doc/ target=_blank class=column-element>Предыдущие версии</a></li><li><a href=https://docs-archive.freebsd.org/44doc/ target=_blank class=column-element>Документы 4.4BSD</a></li><li><a href=https://wiki.freebsd.org/ target=_blank class=column-element>Wiki</a></li></ul></section><section class=community-column><h3 class=column-title>Сообщество</h3><ul class=column-elements-container><li><a href=http://172.16.201.134:1313/ru/articles/contributing class=column-element>Принять участие</a></li><li><a href=https://forums.freebsd.org/ target=_blank class=column-element>Форум Сообщества</a></li><li><a href=https://lists.freebsd.org/ target=_blank class=column-element>Списки рассылки</a></li><li><a href=https://wiki.freebsd.org/IRC/Channels target=_blank class=column-element>Каналы IRC</a></li><li><a href=https://bugs.freebsd.org/bugzilla/ target=_blank class=column-element>Трекер ошибок</a></li></ul></section><section class=legal-column><h3 class=column-title>Юридическая информация</h3><ul class=column-elements-container><li><a href=https://freebsdfoundation.org/donate/ target=_blank class=column-element>Пожертвования</a></li><li><a href=https://www.freebsd.org/copyright/freebsd-license/ target=_blank class=column-element>Лицензирование</a></li><li><a href=https://www.freebsd.org/privacy/ target=_blank class=column-element>Политика Конфиденциальности</a></li><li><a href=https://www.freebsd.org/copyright/ target=_blank class=column-element>Юридические оговорки</a></li></ul></section><section class=copyright-column><p>&copy; 1994-2024 Проект FreeBSD. Все права защищены</p><span>Сделано с помощью <span class=heart>♥</span> Сообществом FreeBSD</span></section></div></footer></body></html>