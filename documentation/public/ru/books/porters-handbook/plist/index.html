<!doctype html><html class=theme-light lang=ru><head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content><meta name=keywords content><meta name=copyright content="1995-2024 The FreeBSD Foundation"><link rel=canonical href=http://172.16.201.134:1313/ru/books/porters-handbook/plist/><title>Глава 7. Продвинутые практики pkg-plist | FreeBSD Documentation Portal</title>
<meta name=theme-color content="#790000"><meta name=color-scheme content="system light dark high-contrast"><link rel="shortcut icon" href=http://172.16.201.134:1313/favicon.ico><link rel=stylesheet href=http://172.16.201.134:1313/styles/main.min.css><link rel=stylesheet href=http://172.16.201.134:1313/css/font-awesome-min.css><script defer src=/js/theme-chooser.min.js></script><script defer src=/js/copy-clipboard.min.js></script><script defer src=/js/search.min.js></script><meta name=twitter:card content="summary"><meta name=twitter:domain content="docs.FreeBSD.org"><meta name=twitter:site content="@freebsd"><meta name=twitter:url content="https://twitter.com/freebsd"><meta property="og:title" content="Глава 7. Продвинутые практики pkg-plist"><meta property="og:description" content><meta property="og:type" content="website"><meta property="og:image" content="http://172.16.201.134:1313/favicon.ico"><meta property="og:image:alt" content="FreeBSD Logo"><meta property="og:locale" content="ru"><meta property="og:url" content="http://172.16.201.134:1313/ru/books/porters-handbook/plist/"><meta property="og:site_name" content="FreeBSD Documentation Portal"><script type=application/ld+json>{"@context":"http://schema.org","@type":"Article","url":"http:\/\/172.16.201.134:1313\/ru\/books\/porters-handbook\/plist\/","name":"FreeBSD Documentation Portal","headline":"FreeBSD Documentation Portal","description":"FreeBSD Documentation Portal"}</script></head><body><header><div class=header-container><div class=logo-menu-bars-container><a href=https://www.FreeBSD.org class=logo><img src=http://172.16.201.134:1313/images/FreeBSD-monochromatic.svg width=160 height=50 alt="FreeBSD logo">
</a><label class=menu-bars for=menu-bars><i class="fa fa-bars" aria-hidden=true></i></label></div><input id=menu-bars type=checkbox><nav><ul class=menu><li class=menu-item><input id=about type=checkbox>
<a href=# aria-label="Navigate to About section"><label class=menu-item-description for=about>О нас
<i class="fa fa-angle-down fa-lg" aria-hidden=true></i></label></a><ul class=sub-menu><li class=title><a href=https://www.freebsd.org/about/ target=_blank>О нас</a></li><li><a href=https://www.freebsd.org/about/ target=_blank>FreeBSD</a></li><li><a href=https://freebsdfoundation.org/about-us/about-the-foundation/ target=_blank>Фонд FreeBSD</a></li><li><a href=https://www.freebsd.org/internal/code-of-conduct/ target=_blank>Кодекс Этики</a></li></ul></li><li class=menu-item><input id=download type=checkbox>
<a href=# aria-label="Navigate to get FreeBSD section"><label class=menu-item-description for=download>Получить FreeBSD
<i class="fa fa-angle-down fa-lg" aria-hidden=true></i></label></a><ul class=sub-menu><li class=title><a href=https://www.freebsd.org/where/ target=_blank>Получить FreeBSD</a></li><li><a href=https://www.freebsd.org/releases/ target=_blank>Информация о релизах</a></li><li><a href=https://www.freebsd.org/releng/ target=_blank>Подготовка релизов</a></li><li><a href=https://www.freebsd.org/security/ target=_blank>Бюллетени Безопасности</a></li></ul></li><li class=menu-item><input id=documentation type=checkbox>
<a href=# aria-label="Navigate to get Documentation section"><label class=menu-item-description for=documentation>Документация
<i class="fa fa-angle-down fa-lg" aria-hidden=true></i></label></a><ul class=sub-menu><li class=title><a href=/ru>Портал документации</a></li><li><a href=http://172.16.201.134:1313/ru/books/handbook>Руководство</a></li><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook>Руководство по созданию портов</a></li><li><a href=https://docs.FreeBSD.org/en/books/fdp-primer>Учебник Проекта Документирования</a></li><li><a href=https://man.FreeBSD.org target=_blank>Страницы Справочника</a></li><li><a href=https://papers.FreeBSD.org target=_blank>Презентации и публикации</a></li><li><a href=https://wiki.FreeBSD.org target=_blank>Wiki</a></li><li><a href=http://172.16.201.134:1313/ru/books>Книги</a></li><li><a href=http://172.16.201.134:1313/ru/articles>Статьи</a></li></ul></li><li class=menu-item><input id=community type=checkbox>
<a href=# aria-label="Navigate to get Community section"><label class=menu-item-description for=community>Сообщество
<i class="fa fa-angle-down fa-lg" aria-hidden=true></i></label></a><ul class=sub-menu><li class=title><a href=https://www.freebsd.org/community/>Сообщество</a></li><li><a href=http://172.16.201.134:1313/ru/articles/contributing>Стать участником</a></li><li><a href=https://forums.freebsd.org/ target=_blank>Форум</a></li><li><a href=https://lists.freebsd.org/ target=_blank>Списки рассылки</a></li><li><a href=https://wiki.freebsd.org/IRC/Channels target=_blank>Каналы IRC</a></li><li><a href=https://bugs.freebsd.org/bugzilla/ target=_blank>Трекер ошибок</a></li><li><a href=https://www.freebsd.org/support/ target=_blank>Поддержка</a></li></ul></li></ul></nav><div class=search-donate-container><form class=search method=get id=search-header-form action=https://docs.freebsd.org/search name=search-header-form><input type=hidden name=DB value=ru>
<input id=words name=P type=text size=20 maxlength=255>
<button>
<i class="fa fa-search" aria-hidden=true></i></button></form><div class=donate><a href=https://freebsdfoundation.org/donate/ target=_blank><span class=heart>♥</span>
Пожертвования</a></div></div></div></header><input type=checkbox class="hidden toggle" id=menu-control><main class=main-wrapper-book><a id=top></a><aside class=book-menu><div class=book-menu-content><input id=search-book type=text placeholder=Поиск aria-label=Поиск maxlength=128><nav id=MenuContents><ul><li><input type=checkbox id=chapter-c934186a5adac4f64b993f751abed30c class=toggle>
<label for=chapter-c934186a5adac4f64b993f751abed30c><a role=button></a></label><a href=http://172.16.201.134:1313/ru/books/porters-handbook/porting-why/>Глава 1. Введение</a></li><li><input type=checkbox id=chapter-2798d78fe854f2709bab5ca473b97050 class=toggle>
<label for=chapter-2798d78fe854f2709bab5ca473b97050><a role=button></a></label><a href=http://172.16.201.134:1313/ru/books/porters-handbook/new-port/>Глава 2. Как самому сделать новый порт</a></li><li><input type=checkbox id=chapter-c0d52b9121b517084e01f59cefa725e1 class=toggle>
<label class="icon cursor" for=chapter-c0d52b9121b517084e01f59cefa725e1><a role=button></a></label><a href=http://172.16.201.134:1313/ru/books/porters-handbook/quick-porting/>Глава 3. Быстрое портирование</a><ul><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/quick-porting/#porting-makefile>3.1. Создание файла <span class=filename>Makefile</span></a></li><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/quick-porting/#porting-desc>3.2. Создание информационных файлов</a></li><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/quick-porting/#porting-checksum>3.3. Создание файла с контрольной суммой</a></li><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/quick-porting/#porting-testing>3.4. Тестирование порта</a></li><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/quick-porting/#porting-portlint>3.5. Проверка вашего порта утилитой <code>portlint</code></a></li><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/quick-porting/#porting-submitting>3.6. Посылка нового порта</a></li></ul></li><li><input type=checkbox id=chapter-3694de03923da61ba10a0a25efca6ef0 class=toggle>
<label class="icon cursor" for=chapter-3694de03923da61ba10a0a25efca6ef0><a role=button></a></label><a href=http://172.16.201.134:1313/ru/books/porters-handbook/slow-porting/>Глава 4. Медленное портирование</a><ul><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/slow-porting/#slow-work>4.1. Как всё это работает</a></li><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/slow-porting/#slow-sources>4.2. Получение исходного кода</a></li><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/slow-porting/#slow-modifying>4.3. Модификация порта</a></li><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/slow-porting/#slow-patch>4.4. Создание патчей</a></li><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/slow-porting/#slow-configure>4.5. Конфигурирование</a></li><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/slow-porting/#slow-user-input>4.6. Обработка пользовательского ввода</a></li></ul></li><li><input type=checkbox id=chapter-165f6a6dba6651f8c25fc63ab83d6538 class=toggle>
<label class="icon cursor" for=chapter-165f6a6dba6651f8c25fc63ab83d6538><a role=button></a></label><a href=http://172.16.201.134:1313/ru/books/porters-handbook/makefiles/>Глава 5. Настройка файла Makefile</a><ul><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/makefiles/#makefile-source>5.1. Оригинальные исходный код</a></li><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/makefiles/#makefile-naming>5.2. Именование</a></li><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/makefiles/#makefile-categories>5.3. Разделение по категориям</a></li><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/makefiles/#makefile-distfiles>5.4. Дистрибутивные файлы</a></li><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/makefiles/#makefile-maintainer>5.5. <code>MAINTAINER</code></a></li><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/makefiles/#makefile-comment>5.6. <code>COMMENT</code></a></li><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/makefiles/#makefile-portscout>5.7. <code>PORTSCOUT</code></a></li><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/makefiles/#makefile-depend>5.8. Зависимости</a></li><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/makefiles/#makefile-masterdir>5.9. <code>MASTERDIR</code></a></li><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/makefiles/#makefile-manpages>5.10. Страницы Справочника</a></li><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/makefiles/#makefile-info>5.11. Файлы в формате info</a></li><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/makefiles/#makefile-options>5.12. Опции для Makefile</a></li><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/makefiles/#makefile-wrkdir>5.13. Задание рабочего каталога</a></li><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/makefiles/#conflicts>5.14. Разрешение конфликтов</a></li><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/makefiles/#install>5.15. Установка файлов</a></li></ul></li><li><input type=checkbox id=chapter-19e3150e00beb84341d8ac1a73936ef0 class=toggle>
<label class="icon cursor" for=chapter-19e3150e00beb84341d8ac1a73936ef0><a role=button></a></label><a href=http://172.16.201.134:1313/ru/books/porters-handbook/special/>Глава 6. Особые соглашения</a><ul><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/special/#staging>6.1. Staging</a></li><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/special/#porting-shlibs>6.2. Динамические библиотеки</a></li><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/special/#porting-restrictions>6.3. Порты с ограничениями на распространение или с правовым обременением</a></li><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/special/#building>6.4. Механизмы построения</a></li><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/special/#using-autotools>6.5. Использование GNU Autotools</a></li><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/special/#using-gettext>6.6. Использование GNU <code>gettext</code></a></li><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/special/#using-perl>6.7. Использование Perl</a></li><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/special/#using-x11>6.8. Использование X11</a></li><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/special/#using-gnome>6.9. Использование GNOME</a></li><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/special/#using-qt>6.10. Использование Qt</a></li><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/special/#using-kde>6.11. Использование KDE</a></li><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/special/#using-java>6.12. Использование Java</a></li><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/special/#using-php>6.13. Веб-приложения, Apache и PHP</a></li><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/special/#using-python>6.14. Использование Python</a></li><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/special/#using-tcl>6.15. Использование Tcl/Tk</a></li><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/special/#using-emacs>6.16. Использование Emacs</a></li><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/special/#using-ruby>6.17. Использование Ruby</a></li><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/special/#using-sdl>6.18. Использование SDL</a></li><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/special/#using-wx>6.19. Использование wxWidgets</a></li><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/special/#using-lua>6.20. Использование Lua</a></li><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/special/#using-iconv>6.21. Использование <code>iconv</code></a></li><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/special/#using-xfce>6.22. Использование Xfce</a></li><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/special/#using-mozilla>6.23. Использование Mozilla</a></li><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/special/#using-databases>6.24. Использование баз данных</a></li><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/special/#rc-scripts>6.25. Запуск и остановка служб (сценарии <code>rc</code>)</a></li><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/special/#users-and-groups>6.26. Добавление пользователей и групп</a></li><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/special/#requiring-kernel-sources>6.27. Порты, требующие наличия исходных текстов ядра</a></li></ul></li><li><input type=checkbox id=chapter-154554011c772e1e6cc0108eef5e0b2b class=toggle checked>
<label class="icon cursor" for=chapter-154554011c772e1e6cc0108eef5e0b2b><a role=button></a></label><a href=http://172.16.201.134:1313/ru/books/porters-handbook/plist/>Глава 7. Продвинутые практики pkg-plist</a><ul><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/plist/#plist-sub>7.1. Изменение содержимого <span class=filename>pkg-plist</span> в зависимости от make-переменных</a></li><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/plist/#plist-cleaning>7.2. Пустые каталоги</a></li><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/plist/#plist-config>7.3. Конфигурационные файлы</a></li><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/plist/#plist-dynamic>7.4. Динамический или статический список упаковки</a></li><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/plist/#plist-autoplist>7.5. Автоматическое создание списка упаковки</a></li></ul></li><li><input type=checkbox id=chapter-5955b0791ccd51005b5bc5bebeec91e5 class=toggle>
<label class="icon cursor" for=chapter-5955b0791ccd51005b5bc5bebeec91e5><a role=button></a></label><a href=http://172.16.201.134:1313/ru/books/porters-handbook/pkg-files/>Глава 8. Файлы pkg-*</a><ul><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/pkg-files/#porting-message>8.1. <span class=filename>pkg-message</span></a></li><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/pkg-files/#pkg-install>8.2. <span class=filename>pkg-install</span></a></li><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/pkg-files/#pkg-deinstall>8.3. <span class=filename>pkg-deinstall</span></a></li><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/pkg-files/#pkg-names>8.4. Изменение имён файлов <span class=filename>pkg-*</span></a></li><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/pkg-files/#using-sub-files>8.5. Использование <code>SUB_FILES</code> и <code>SUB_LIST</code></a></li></ul></li><li><input type=checkbox id=chapter-ee86a11caedb6395ed82b94ec7a9c6cd class=toggle>
<label class="icon cursor" for=chapter-ee86a11caedb6395ed82b94ec7a9c6cd><a role=button></a></label><a href=http://172.16.201.134:1313/ru/books/porters-handbook/testing/>Глава 9. Тестирование вашего порта</a><ul><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/testing/#make-describe>9.1. Запуск <code>make describe</code></a></li><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/testing/#testing-portlint>9.2. Portlint</a></li><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/testing/#testing-porttools>9.3. Port Tools</a></li><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/testing/#porting-prefix>9.4. <code>PREFIX</code> и <code>DESTDIR</code></a></li><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/testing/#testing-tinderbox>9.5. Tinderbox</a></li><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/testing/#testing-poudriere>9.6. Poudriere</a></li></ul></li><li><input type=checkbox id=chapter-4ccaefe2590c044ca2b79c46e79fe17f class=toggle>
<label class="icon cursor" for=chapter-4ccaefe2590c044ca2b79c46e79fe17f><a role=button></a></label><a href=http://172.16.201.134:1313/ru/books/porters-handbook/upgrading/>Глава 10. Обновление отдельного порта</a><ul><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/upgrading/#svn-diff>10.1. Использование Subversion для создания патчей</a></li><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/upgrading/#moved-and-updating-files>10.2. Файлы <span class=filename>UPDATING</span> и <span class=filename>MOVED</span></a></li></ul></li><li><input type=checkbox id=chapter-1023911bc0041506653280b832dea3b2 class=toggle>
<label class="icon cursor" for=chapter-1023911bc0041506653280b832dea3b2><a role=button></a></label><a href=http://172.16.201.134:1313/ru/books/porters-handbook/security/>Глава 11. Безопасность портов</a><ul><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/security/#security-intro>11.1. Почему безопасность так важна</a></li><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/security/#security-fix>11.2. Исправление уязвимостей безопасности</a></li><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/security/#security-notify>11.3. Обеспечение сообщества информацией</a></li></ul></li><li><input type=checkbox id=chapter-9a8875d5d59aa92f1e5a78e9ecd1fbe7 class=toggle>
<label class="icon cursor" for=chapter-9a8875d5d59aa92f1e5a78e9ecd1fbe7><a role=button></a></label><a href=http://172.16.201.134:1313/ru/books/porters-handbook/porting-dads/>Глава 12. Что делать нужно, и что делать нельзя</a><ul><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/porting-dads/#dads-intro>12.1. Введение</a></li><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/porting-dads/#porting-wrkdir>12.2. <code>WRKDIR</code></a></li><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/porting-dads/#porting-wrkdirprefix>12.3. <code>WRKDIRPREFIX</code></a></li><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/porting-dads/#porting-versions>12.4. Различение операционных систем и версий ОС</a></li><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/porting-dads/#dads-after-port-mk>12.5. Написание чего-либо после <span class=filename>bsd.port.mk</span></a></li><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/porting-dads/#dads-sh-exec>12.6. Использование выражения <code>exec</code> в сценариях обёртках</a></li><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/porting-dads/#dads-rational>12.7. Поступайте разумно</a></li><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/porting-dads/#dads-cc>12.8. Работа как с <code>CC</code>, так и <code>CXX</code></a></li><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/porting-dads/#dads-cflags>12.9. Использование <code>CFLAGS</code></a></li><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/porting-dads/#dads-pthread>12.10. Библиотеки потоков</a></li><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/porting-dads/#dads-feedback>12.11. Пожелания</a></li><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/porting-dads/#dads-readme>12.12. <span class=filename>README.html</span></a></li><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/porting-dads/#dads-noinstall>12.13. Пометка неустанавливаемого порта как <code>BROKEN</code>, <code>FORBIDDEN</code> или <code>IGNORE</code></a></li><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/porting-dads/#dads-deprecated>12.14. Пометка порта на удаление с <code>DEPRECATED</code> или <code>EXPIRATION_DATE</code></a></li><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/porting-dads/#dads-dot-error>12.15. Избегайте использования конструкции <code>.error</code></a></li><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/porting-dads/#dads-sysctl>12.16. Использование <span class=filename>sysctl</span></a></li><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/porting-dads/#dads-rerolling-distfiles>12.17. Меняющиеся дистрибутивные файлы</a></li><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/porting-dads/#dads-avoiding-linuxisms>12.18. Избегание линуксизмов</a></li><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/porting-dads/#dads-misc>12.19. Разное</a></li></ul></li><li><input type=checkbox id=chapter-5ef4c4c471a3f55c74fb71881f9d8713 class=toggle>
<label for=chapter-5ef4c4c471a3f55c74fb71881f9d8713><a role=button></a></label><a href=http://172.16.201.134:1313/ru/books/porters-handbook/porting-samplem/>Глава 13. Примерный Makefile</a></li><li><input type=checkbox id=chapter-70f5a4755700a24529175d26e65871bf class=toggle>
<label class="icon cursor" for=chapter-70f5a4755700a24529175d26e65871bf><a role=button></a></label><a href=http://172.16.201.134:1313/ru/books/porters-handbook/keeping-up/>Глава 14. Актуализация</a><ul><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/keeping-up/#freshports>14.1. FreshPorts</a></li><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/keeping-up/#svnweb>14.2. Web-интерфейс к хранилищу исходных текстов</a></li><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/keeping-up/#ports-mailing-list>14.3. Список рассылки FreeBSD, посвящённый портам</a></li><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/keeping-up/#build-cluster>14.4. Кластер построения портов FreeBSD</a></li><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/keeping-up/#distfile-survey>14.5. Portscout: сканер дистрибутивных файлов портов FreeBSD</a></li><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/keeping-up/#portsmon>14.6. Система мониторинга портов FreeBSD</a></li></ul></li><li><input type=checkbox id=chapter-8225273087f0e195be28132f4b5a0562 class=toggle>
<label class="icon cursor" for=chapter-8225273087f0e195be28132f4b5a0562><a role=button></a></label><a href=http://172.16.201.134:1313/ru/books/porters-handbook/uses/>Глава 15. Значения USES</a><ul><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/uses/#uses-intro>15.1. An Introduction to <code>USES</code></a></li><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/uses/#uses-7z>15.2. <code>7z</code></a></li><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/uses/#uses-ada>15.3. <code>ada</code></a></li><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/uses/#uses-autoreconf>15.4. <code>autoreconf</code></a></li><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/uses/#uses-blaslapack>15.5. <code>blaslapack</code></a></li><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/uses/#uses-bdb>15.6. <code>bdb</code></a></li><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/uses/#uses-bison>15.7. <code>bison</code></a></li><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/uses/#uses-cabal>15.8. <code>cabal</code></a></li><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/uses/#uses-cargo>15.9. <code>cargo</code></a></li><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/uses/#uses-charsetfix>15.10. <code>charsetfix</code></a></li><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/uses/#uses-cmake>15.11. <code>cmake</code></a></li><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/uses/#uses-compiler>15.12. <code>compiler</code></a></li><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/uses/#uses-cpe>15.13. <code>cpe</code></a></li><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/uses/#uses-cran>15.14. <code>cran</code></a></li><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/uses/#uses-desktop-file-utils>15.15. <code>desktop-file-utils</code></a></li><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/uses/#uses-desthack>15.16. <code>desthack</code></a></li><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/uses/#uses-display>15.17. <code>display</code></a></li><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/uses/#uses-dos2unix>15.18. <code>dos2unix</code></a></li><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/uses/#uses-drupal>15.19. <code>drupal</code></a></li><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/uses/#uses-eigen>15.20. <code>eigen</code></a></li><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/uses/#uses-fakeroot>15.21. <code>fakeroot</code></a></li><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/uses/#uses-fam>15.22. <code>fam</code></a></li><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/uses/#uses-firebird>15.23. <code>firebird</code></a></li><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/uses/#uses-fonts>15.24. <code>fonts</code></a></li><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/uses/#uses-fortran>15.25. <code>fortran</code></a></li><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/uses/#uses-fuse>15.26. <code>fuse</code></a></li><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/uses/#uses-gem>15.27. <code>gem</code></a></li><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/uses/#uses-gettext>15.28. <code>gettext</code></a></li><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/uses/#uses-gettext-runtime>15.29. <code>gettext-runtime</code></a></li><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/uses/#uses-gettext-tools>15.30. <code>gettext-tools</code></a></li><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/uses/#uses-ghostscript>15.31. <code>ghostscript</code></a></li><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/uses/#uses-gl>15.32. <code>gl</code></a></li><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/uses/#uses-gmake>15.33. <code>gmake</code></a></li><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/uses/#uses-gnome>15.34. <code>gnome</code></a></li><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/uses/#uses-go>15.35. <code>go</code></a></li><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/uses/#uses-gperf>15.36. <code>gperf</code></a></li><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/uses/#uses-grantlee>15.37. <code>grantlee</code></a></li><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/uses/#uses-groff>15.38. <code>groff</code></a></li><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/uses/#uses-gssapi>15.39. <code>gssapi</code></a></li><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/uses/#uses-horde>15.40. <code>horde</code></a></li><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/uses/#uses-iconv>15.41. <code>iconv</code></a></li><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/uses/#uses-imake>15.42. <code>imake</code></a></li><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/uses/#uses-kde>15.43. <code>kde</code></a></li><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/uses/#uses-kmod>15.44. <code>kmod</code></a></li><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/uses/#uses-lha>15.45. <code>lha</code></a></li><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/uses/#uses-libarchive>15.46. <code>libarchive</code></a></li><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/uses/#uses-libedit>15.47. <code>libedit</code></a></li><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/uses/#uses-libtool>15.48. <code>libtool</code></a></li><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/uses/#uses-linux>15.49. <code>linux</code></a></li><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/uses/#uses-localbase>15.50. <code>localbase</code></a></li><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/uses/#uses-lua>15.51. <code>lua</code></a></li><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/uses/#uses-lxqt>15.52. <code>lxqt</code></a></li><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/uses/#uses-makeinfo>15.53. <code>makeinfo</code></a></li><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/uses/#uses-makeself>15.54. <code>makeself</code></a></li><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/uses/#uses-mate>15.55. <code>mate</code></a></li><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/uses/#uses-meson>15.56. <code>meson</code></a></li><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/uses/#uses-metaport>15.57. <code>metaport</code></a></li><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/uses/#uses-mysql>15.58. <code>mysql</code></a></li><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/uses/#uses-mono>15.59. <code>mono</code></a></li><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/uses/#uses-motif>15.60. <code>motif</code></a></li><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/uses/#uses-ncurses>15.61. <code>ncurses</code></a></li><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/uses/#uses-ninja>15.62. <code>ninja</code></a></li><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/uses/#uses-objc>15.63. <code>objc</code></a></li><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/uses/#uses-openal>15.64. <code>openal</code></a></li><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/uses/#uses-pathfix>15.65. <code>pathfix</code></a></li><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/uses/#uses-pear>15.66. <code>pear</code></a></li><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/uses/#uses-perl5>15.67. <code>perl5</code></a></li><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/uses/#uses-pgsql>15.68. <code>pgsql</code></a></li><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/uses/#uses-php>15.69. <code>php</code></a></li><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/uses/#uses-pkgconfig>15.70. <code>pkgconfig</code></a></li><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/uses/#uses-pure>15.71. <code>pure</code></a></li><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/uses/#uses-pyqt>15.72. <code>pyqt</code></a></li><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/uses/#uses-python>15.73. <code>python</code></a></li><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/uses/#uses-qmail>15.74. <code>qmail</code></a></li><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/uses/#uses-qmake>15.75. <code>qmake</code></a></li><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/uses/#uses-qt>15.76. <code>qt</code></a></li><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/uses/#uses-qt-dist>15.77. <code>qt-dist</code></a></li><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/uses/#uses-readline>15.78. <code>readline</code></a></li><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/uses/#uses-samba>15.79. <code>samba</code></a></li><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/uses/#uses-scons>15.80. <code>scons</code></a></li><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/uses/#uses-shared-mime-info>15.81. <code>shared-mime-info</code></a></li><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/uses/#uses-shebangfix>15.82. <code>shebangfix</code></a></li><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/uses/#uses-sqlite>15.83. <code>sqlite</code></a></li><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/uses/#uses-ssl>15.84. <code>ssl</code></a></li><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/uses/#uses-tar>15.85. <code>tar</code></a></li><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/uses/#uses-tcl>15.86. <code>tcl</code></a></li><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/uses/#uses-terminfo>15.87. <code>terminfo</code></a></li><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/uses/#uses-tk>15.88. <code>tk</code></a></li><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/uses/#uses-uidfix>15.89. <code>uidfix</code></a></li><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/uses/#uses-uniquefiles>15.90. <code>uniquefiles</code></a></li><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/uses/#uses-varnish>15.91. <code>varnish</code></a></li><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/uses/#uses-webplugin>15.92. <code>webplugin</code></a></li><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/uses/#uses-xfce>15.93. <code>xfce</code></a></li><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/uses/#uses-xorg>15.94. <code>xorg</code></a></li><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/uses/#uses-xorg-cat>15.95. <code>xorg-cat</code></a></li><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/uses/#uses-zip>15.96. <code>zip</code></a></li></ul></li><li><input type=checkbox id=chapter-7713ccc63287693c9be6c832b2c1e850 class=toggle>
<label class="icon cursor" for=chapter-7713ccc63287693c9be6c832b2c1e850><a role=button></a></label><a href=http://172.16.201.134:1313/ru/books/porters-handbook/versions/>Глава 16. Значения __FreeBSD_version</a><ul><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/versions/#versions-13>16.1. FreeBSD 13 Versions</a></li><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/versions/#versions-12>16.2. FreeBSD 12 Versions</a></li><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/versions/#versions-11>16.3. FreeBSD 11 Versions</a></li><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/versions/#versions-10>16.4. FreeBSD 10 Versions</a></li><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/versions/#versions-9>16.5. FreeBSD 9 Versions</a></li><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/versions/#versions-8>16.6. FreeBSD 8 Versions</a></li><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/versions/#versions-7>16.7. FreeBSD 7 Versions</a></li><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/versions/#versions-6>16.8. FreeBSD 6 Versions</a></li><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/versions/#versions-5>16.9. FreeBSD 5 Versions</a></li><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/versions/#versions-4>16.10. FreeBSD 4 Versions</a></li><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/versions/#versions-3>16.11. FreeBSD 3 Versions</a></li><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/versions/#versions-2.2>16.12. FreeBSD 2.2 Versions</a></li><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/versions/#versions-2>16.13. FreeBSD 2 Before 2.2-RELEASE Versions</a></li></ul></li><li></li></ul></nav></div></aside><div class=book><div class=book-menu-mobile><label for=menu-control><span class=menu-control-button><i class="fa fa-list" aria-hidden=true title="Меню книг"></i>
Меню книг</span></label></div><h1 class=title>Глава 7. Продвинутые практики pkg-plist</h1><div class="admonitionblock note"><p><i class="fa fa-exclamation-circle" aria-hidden=true></i>
Этот перевод может быть устаревшим. Для того, чтобы помочь с переводом, пожалуйста, обратитесь к <a href=https://translate-dev.freebsd.org/ target=_blank>Сервер переводов FreeBSD</a>.</p></div><div class=toc-mobile><h3>Содержание</h3><nav id=TableOfContents><ul><li><a href=#plist-sub>7.1. Изменение содержимого <span class=filename>pkg-plist</span> в зависимости от make-переменных</a></li><li><a href=#plist-cleaning>7.2. Пустые каталоги</a></li><li><a href=#plist-config>7.3. Конфигурационные файлы</a></li><li><a href=#plist-dynamic>7.4. Динамический или статический список упаковки</a></li><li><a href=#plist-autoplist>7.5. Автоматическое создание списка упаковки</a></li></ul></nav></div><div class=book-content><div id=preamble><div class=sectionbody></div></div><div class=sect1><h2 id=plist-sub>7.1. Изменение содержимого <span class=filename>pkg-plist</span> в зависимости от make-переменных<a class=anchor href=#plist-sub></a></h2><div class=sectionbody><div class=paragraph><p>Некоторые порты, в частности, порты <code>p5-</code>, должны менять содержимое своих файлов <span class=filename>pkg-plist</span> в зависимости от того, с какими параметрами они были отконфигурированы (или в зависимости от версии языка <code>perl</code> в случае портов <code>p5-</code>). Чтобы облегчить этот процесс, любые вхождения ключевых слов <code>%%OSREL%%</code>, <code>%%PERL_VER%%</code> и <code>%%PERL_VERSION%%</code> в файле <span class=filename>pkg-plist</span> будут заменяться соответствующими значениями. Значением <code>%%OSREL%%</code> является номер версии операционной системы (например, <code>4.9</code>). <code>%%PERL_VERSION%%</code> и <code>%%PERL_VER%%</code> обозначают полный номер версии <code>perl</code> (например, <code>5.8.9</code>). Некоторые другие <code>%%VARS%%</code>, имеющие отношение к файлам документации порта, описаны в <a href=#install-documentation>соответствующем разделе</a>.</p></div><div class=paragraph><p>Если вам нужно сделать другие подстановки, вы можете указать в переменной <code>PLIST_SUB</code> список пар <code>VAR=VALUE</code>, и все вхождения <code>%%VAR%%</code> в файле <span class=filename>pkg-plist</span> будут заменяться на значение <em>VALUE</em>.</p></div><div class=paragraph><p>Например, если у вас имеется порт, который устанавливает много файлов в каталог, зависящий от версии, вы можете задать нечто типа</p></div><div class="literalblock programlisting"><div class=content><pre>OCTAVE_VERSION=	2.0.13
PLIST_SUB=	OCTAVE_VERSION=${OCTAVE_VERSION}</pre></div></div><div class=paragraph><p>в файле <span class=filename>Makefile</span> и использовать <code>%%OCTAVE_VERSION%%</code> везде, где нужно указать номер версии в файле <span class=filename>pkg-plist</span>. Таким образом, при обновлении порта вам не нужно будет менять десятки (а в некоторых случаях и сотни) строк в файле <span class=filename>pkg-plist</span>.</p></div><div class=paragraph><p>Если ваш порт устанавливает файлы в соответствии с установленными в порту опциями, то обычным способом управления является добавление префиксов <code>%%TAG%%</code> для строк <span class=filename>pkg-plist</span> с добавлением этого <code>TAG</code> в переменную <code>PLIST_SUB</code> внутри <span class=filename>Makefile</span> со специальным значением <code>@comment</code>, которое указывает пакетным инструментам игнорировать эти строки:</p></div><div class="literalblock programlisting"><div class=content><pre>.if defined(WITH_X11)
PLIST_SUB+=	X11=&#34;&#34;
.else
PLIST_SUB+=	X11=&#34;@comment &#34;
.endif</pre></div></div><div class=paragraph><p>и в самом <span class=filename>pkg-plist</span>:</p></div><div class="literalblock programlisting"><div class=content><pre>%%X11%%bin/foo-gui</pre></div></div><div class=paragraph><p>Эта подстановка будет сделана между выполнением целей <code>pre-install</code> и <code>do-install</code>, посредством чтения файла <span class=filename>PLIST</span> и записью в файл <span class=filename>TMPPLIST</span> (по умолчанию это файл <span class=filename>WRKDIR/.PLIST.mktmp</span>). Так что если ваш порт строит <span class=filename>PLIST</span> на лету, делайте это во время или до выполнения цели <code>pre-install</code>. Кроме того, если вашему порту требуется отредактировать получающийся файл, делайте это в цели <code>post-install</code> изменением файла <span class=filename>TMPPLIST</span>.</p></div><div class=paragraph><p>Другой способ изменения списка сборки порта основан на определении значений переменных <code>PLIST_FILES</code>, <code>PLIST_DIRS</code> и <code>PLIST_DIRSTRY</code>. Каждое из них рассматривается как перечень путей для записи в <span class=filename>TMPPLIST</span> содержимого <span class=filename>PLIST</span>. Имена, перечисленные в <code>PLIST_FILES</code>, <code>PLIST_DIRS</code> и <code>PLIST_DIRSTRY</code> подвергаются подстановке <code>%%VAR%%</code>, как описано выше. За исключением этого, имена из <code>PLIST_FILES</code> будут появляться в окончательном варианте перечня сборки без изменений, тогда как <code>@dirrm</code> и <code>@dirrmtry</code> будут соответственно предшествовать именам из <code>PLIST_DIRS</code> и <code>PLIST_DIRSTRY</code>. Для того чтобы изменения вступили в силу, <code>PLIST_FILES</code>, <code>PLIST_DIRS</code> и <code>PLIST_DIRSTRY</code> должны задаваться до того, как будет записываться <span class=filename>TMPPLIST</span>, то есть в цели <code>pre-install</code> или ещё раньше.</p></div></div></div><div class=sect1><h2 id=plist-cleaning>7.2. Пустые каталоги<a class=anchor href=#plist-cleaning></a></h2><div class=sectionbody><div class=sect2><h3 id=plist-dir-cleaning>7.2.1. Очистка пустых каталогов<a class=anchor href=#plist-dir-cleaning></a></h3><div class=paragraph><p>Заставьте ваш порты удалять пустые каталоги при удалении. Обычно это достигается добавлением строк <code>@dirrm</code> для всех каталогов, которые создаются этим портом. Вам нужно удалить подкаталоги до того, как вы сможете удалить родительские каталоги.</p></div><div class="literalblock programlisting"><div class=content><pre> :
lib/X11/oneko/pixmaps/cat.xpm
lib/X11/oneko/sounds/cat.au
 :
@dirrm lib/X11/oneko/pixmaps
@dirrm lib/X11/oneko/sounds
@dirrm lib/X11/oneko</pre></div></div><div class=paragraph><p>Однако, иногда <code>@dirrm</code> будет выдавать ошибки, потому что другие порты используют тот же самый подкаталог. Вы можете использовать <code>@dirrmtry</code> для удаления только пустых каталогов без выдачи предупреждений.</p></div><div class="literalblock programlisting"><div class=content><pre>@dirrmtry share/doc/gimp</pre></div></div><div class=paragraph><p>Эта команда не выведет никаких сообщений об ошибках и не вызовет аварийного завершения работы <code>pkg delete</code> (см. <a href="https://man.freebsd.org/cgi/man.cgi?query=pkg-delete&amp;sektion=8&amp;format=html">pkg-delete(8)</a>), даже если каталог <span class=filename>${PREFIX}/shared/doc/gimp</span> не пуст из-за того, что другие порты установили сюда какие-то файлы.</p></div></div><div class=sect2><h3 id=plist-dir-empty>7.2.2. Создание пустых каталогов<a class=anchor href=#plist-dir-empty></a></h3><div class=paragraph><p>Пустым каталогам, создаваемым во время установки порта, нужно особое внимание. Они не будут созданы при установке пакета, потому что пакеты содержат только файлы, а <code>pkg add</code> и <code>pkg install</code> создают для них каталоги по мере надобности. Чтобы убедиться, что пустой каталог создается при установке пакета, добавьте эту строку в <span class=filename>pkg-plist</span> перед соответствующей строкой <code>@dirrm</code>:</p></div><div class="literalblock programlisting"><div class=content><pre>@exec mkdir -p %D/shared/foo/templates</pre></div></div></div></div></div><div class=sect1><h2 id=plist-config>7.3. Конфигурационные файлы<a class=anchor href=#plist-config></a></h2><div class=sectionbody><div class=paragraph><p>Если ваш порт устанавливает конфигурационные файлы в каталог <span class=filename>PREFIX/etc</span> (или куда-то еще), <em>не</em> делайте их простого перечисления в файле <span class=filename>pkg-plist</span>. Это приведёт к тому, что по команде <code>pkg delete</code> или при новой установке файлы, тщательно отредактированные и настроенные пользователем, будут уничтожены.</p></div><div class=paragraph><p>Вместо этого установите файл(ы) с примерами с расширением <span class=filename>filename.sample</span>. Затем скопируйте файл с примером на место настоящего файла конфигурации, если таковой ещё не существует. При деинсталляции удаляйте файл конфигурации только в том случае, если он идентичен файлу с расширением <span class=filename>.sample</span>. Вам нужно управлять этим в <span class=filename>Makefile</span> и в <span class=filename>pkg-plist</span> (для установки из пакета).</p></div><div class=paragraph><p>Пример части <span class=filename>Makefile</span>:</p></div><div class="literalblock programlisting"><div class=content><pre>post-install:
	@if [ ! -f ${PREFIX}/etc/orbit.conf ]; then \
	${CP} -p ${PREFIX}/etc/orbit.conf.sample ${STAGEDIR}${PREFIX}/etc/orbit.conf ; \
	fi</pre></div></div><div class=paragraph><p>Добавьте по три строки в <span class=filename>pkg-plist</span> для каждого конфигурационного файла, как показано ниже:</p></div><div class="literalblock programlisting"><div class=content><pre>@unexec if cmp -s %D/etc/orbit.conf.sample %D/etc/orbit.conf; then rm -f %D/etc/orbit.conf; fi
etc/orbit.conf.sample
@exec if [ ! -f %D/etc/orbit.conf ] ; then cp -p %D/%F %B/orbit.conf; fi</pre></div></div><div class=paragraph><p>Данные строки являются упорядоченными. На этапе удаления файл с примером сравнивается с рабочим конфигурационным файлом. Полное совпадение означает отсутствие каких-либо изменений в рабочем файле со стороны пользователя, и следовательно этот файл может быть безопасно удалён. Так как файл с примером всё ещё должен существовать для сравнения, строка <code>@unexec</code> следует перед именем файла с примером конфигурации. На этапе установки, если рабочий файл конфигурации отсутствует, он копируется из файла с примером. Файл с примером обязательно должен быть установлен до операции копирования, поэтому строка <code>@exec</code> следует после имени файла с примером конфигурации.</p></div><div class=paragraph><p>Для получения дополнительного отладочного вывода на экран можно временно удалить параметр <code>-s</code> из команды <a href="https://man.freebsd.org/cgi/man.cgi?query=cmp&amp;sektion=1&amp;format=html">cmp(1)</a>.</p></div><div class=paragraph><p>Для получения дополнительной инфорации по использованию <code>%D</code> и прочих маркеров подстановки обратитесь к странице Справочника <a href="https://man.freebsd.org/cgi/man.cgi?query=pkg-create&amp;sektion=8&amp;format=html">pkg-create(8)</a>.</p></div><div class=paragraph><p>Если существует действительно стоящая причина не устанавливать рабочий файл конфигурации по умолчанию, уберите строку <code>@exec</code> из <span class=filename>pkg-plist</span> и добавьте <a href=#porting-message>сообщение</a>, указывающее на то, что пользователь обязан скопировать и отредактировать этот файл перед тем, как программное обеспечение начнёт работать.</p></div></div></div><div class=sect1><h2 id=plist-dynamic>7.4. Динамический или статический список упаковки<a class=anchor href=#plist-dynamic></a></h2><div class=sectionbody><div class=paragraph><p><em>Статический список упаковки</em> - это список упаковки, который доступен в Коллекции Портов или как файл <span class=filename>pkg-plist</span> (с подстановкой переменных или без неё), или как встроенный в <span class=filename>Makefile</span> посредством <code>PLIST_FILES</code>, <code>PLIST_DIRS</code> и <code>PLIST_DIRSTRY</code>. Даже если содержимое является автоматически порождаемым при помощи инструмента или в результате выполнения цели в Makefile <em>до</em> включения в Коллекцию Портов коммиттером, то список всё ещё будет считаться статическим, поскольку его можно узнать без необходимости скачивания или компиляции дистрибутива.</p></div><div class=paragraph><p><em>Динамический список упаковки</em> это список упаковки, который получается во время компиляции порта и строится на основе устанавливаемых файлов и каталогов. Узнать такой список невозможно до того, как исходный код портируемого приложения будет скачен и скомпилирован, или после запуска <code>make clean</code>.</p></div><div class=paragraph><p>Хотя использование динамических список упаковки не запрещено, сопровождающие должны использовать статические списки упаковки везде, где это возможно, поскольку это позволяет пользователям выполнять <a href="https://man.freebsd.org/cgi/man.cgi?query=grep&amp;sektion=1&amp;format=html">grep(1)</a> по доступным портам для обнаружения, например, который порт устанавливает определенный файл. Динамические списки должны быть использованы в основном для сложных портов, для которых изменения в списке упаковки кардинальным образом основаны на необязательных возможностях порта (и, таким образом, делая сопровождение статических списков упаковки невозможным), или портов, которые изменяют список упаковки на основе версии используемого им программного обеспечения (например, порты, которые порождают документы при помощи Javadoc).</p></div></div></div><div class=sect1><h2 id=plist-autoplist>7.5. Автоматическое создание списка упаковки<a class=anchor href=#plist-autoplist></a></h2><div class=sectionbody><div class=paragraph><p>Первым делом убедитесь, что ваш порт практически полностью завершён и осталось создать только <span class=filename>pkg-plist</span>. После этого вы можете запустить <code>make makeplist</code> для автоматического создания <span class=filename>pkg-plist</span>. Содержимое этого файла должно быть дважды перепроверено.</p></div><div class=paragraph><p>Пользовательские конфигурационные файлы должны быть удалены или быть установлены как <span class=filename>filename.sample</span>. Файл <span class=filename>info/dir</span> включать в список не нужно, но должны быть добавлены соответствующие строчки <span class=filename>install-info</span>, так, как это описано в разделе о <a href=#makefile-info>файлах в формате info</a>. Все библиотеки, устанавливаемые портом, должны быть перечислены так, как это описано в разделе о <a href=#porting-shlibs>динамических библиотеках</a>.</p></div></div></div></div><hr><div class=last-modified><p><strong>Изменено</strong>: 9 марта 2024 г. by <a href="https://cgit.freebsd.org/doc/commit/?id=6199af92e7" target=_blank>Danilo G. Baio</a></p></div><div class=buttons><div class=prev><i class="fa fa-angle-left" aria-hidden=true title=Назад></i><div class=container><a href=http://172.16.201.134:1313/ru/books/porters-handbook/special class=direction>Назад</a></div></div><div class=home><i class="fa fa-home" aria-hidden=true title=Главная></i><div class=container><a href=../ class=direction>Главная</a></div></div><div class=next><div class=container><a href=http://172.16.201.134:1313/ru/books/porters-handbook/pkg-files class=direction>Далее</a></div><i class="fa fa-angle-right" aria-hidden=true title=Далее></i></div></div><label class="hidden book-menu-overlay" for=menu-control></label></div><aside class=toc><div class=toc-content><h3>Содержание</h3><nav id=TableOfContents><ul><li><a href=#plist-sub>7.1. Изменение содержимого <span class=filename>pkg-plist</span> в зависимости от make-переменных</a></li><li><a href=#plist-cleaning>7.2. Пустые каталоги</a></li><li><a href=#plist-config>7.3. Конфигурационные файлы</a></li><li><a href=#plist-dynamic>7.4. Динамический или статический список упаковки</a></li><li><a href=#plist-autoplist>7.5. Автоматическое создание списка упаковки</a></li></ul></nav><hr><div class=resources><h3>Материалы</h3><ul class=contents><li><i class="fa fa-file-pdf-o" aria-hidden=true title="Скачать PDF"></i><a href=https://download.freebsd.org/doc/ru/books/porters-handbook/porters-handbook_ru.pdf>Скачать PDF</a></li><li><i class="fa fa-pencil-square-o" aria-hidden=true title="Редактировать эту страницу"></i><a href=https://github.com/freebsd/freebsd-doc/blob/main/documentation/content/ru/_index target=_blank>Редактировать эту страницу</a></li></ul></div></div></aside><a class=to-top href=#top><i class="fa fa-arrow-circle-up" aria-hidden=true></i></a></main><footer><div class=footer-container><section class=logo-column><img src=http://172.16.201.134:1313/images/FreeBSD-colors.svg width=160 height=50 alt="FreeBSD logo"><div class=options-container><div class=language-container><a id=languages href=http://172.16.201.134:1313/ru/languages><img src=http://172.16.201.134:1313/images/language.png class=language-image alt="Выберите язык">
<span>Русский</span></a></div><div class=theme-container><select id=theme-chooser><option value=theme-system>Система</option><option value=theme-light>Светлый</option><option value=theme-dark>Тёмный</option><option value=theme-high-contrast>Высокая контрастность</option></select></div></div></section><section class=about-column><h3 class=column-title>О нас</h3><ul class=column-elements-container><li><a href=https://www.freebsd.org/about/ target=_blank class=column-element>FreeBSD</a></li><li><a href=https://freebsdfoundation.org/ target=_blank class=column-element>Фонд FreeBSD</a></li><li><a href=https://www.freebsd.org/where/ target=_blank class=column-element>Получить FreeBSD</a></li><li><a href=https://www.freebsd.org/internal/code-of-conduct target=_blank class=column-element>Кодекс Этики</a></li><li><a href=https://www.freebsd.org/security/ target=_blank class=column-element>Бюллетени Безопасности</a></li></ul></section><section class=documentation-column><h3 class=column-title>Документация</h3><ul class=column-elements-container><li><a href=/ru class=column-element>Портал документации</a></li><li><a href=https://man.FreeBSD.org target=_blank class=column-element>Страницы Справочника</a></li><li><a href=https://papers.FreeBSD.org target=_blank class=column-element>Презентации и публикации</a></li><li><a href=https://docs-archive.freebsd.org/doc/ target=_blank class=column-element>Предыдущие версии</a></li><li><a href=https://docs-archive.freebsd.org/44doc/ target=_blank class=column-element>Документы 4.4BSD</a></li><li><a href=https://wiki.freebsd.org/ target=_blank class=column-element>Wiki</a></li></ul></section><section class=community-column><h3 class=column-title>Сообщество</h3><ul class=column-elements-container><li><a href=http://172.16.201.134:1313/ru/articles/contributing class=column-element>Принять участие</a></li><li><a href=https://forums.freebsd.org/ target=_blank class=column-element>Форум Сообщества</a></li><li><a href=https://lists.freebsd.org/ target=_blank class=column-element>Списки рассылки</a></li><li><a href=https://wiki.freebsd.org/IRC/Channels target=_blank class=column-element>Каналы IRC</a></li><li><a href=https://bugs.freebsd.org/bugzilla/ target=_blank class=column-element>Трекер ошибок</a></li></ul></section><section class=legal-column><h3 class=column-title>Юридическая информация</h3><ul class=column-elements-container><li><a href=https://freebsdfoundation.org/donate/ target=_blank class=column-element>Пожертвования</a></li><li><a href=https://www.freebsd.org/copyright/freebsd-license/ target=_blank class=column-element>Лицензирование</a></li><li><a href=https://www.freebsd.org/privacy/ target=_blank class=column-element>Политика Конфиденциальности</a></li><li><a href=https://www.freebsd.org/copyright/ target=_blank class=column-element>Юридические оговорки</a></li></ul></section><section class=copyright-column><p>&copy; 1994-2024 Проект FreeBSD. Все права защищены</p><span>Сделано с помощью <span class=heart>♥</span> Сообществом FreeBSD</span></section></div></footer></body></html>