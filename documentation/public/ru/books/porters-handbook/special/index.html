<!doctype html><html class=theme-light lang=ru><head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content><meta name=keywords content><meta name=copyright content="1995-2024 The FreeBSD Foundation"><link rel=canonical href=http://172.16.201.134:1313/ru/books/porters-handbook/special/><title>Глава 6. Особые соглашения | FreeBSD Documentation Portal</title>
<meta name=theme-color content="#790000"><meta name=color-scheme content="system light dark high-contrast"><link rel="shortcut icon" href=http://172.16.201.134:1313/favicon.ico><link rel=stylesheet href=http://172.16.201.134:1313/styles/main.min.css><link rel=stylesheet href=http://172.16.201.134:1313/css/font-awesome-min.css><script defer src=/js/theme-chooser.min.js></script><script defer src=/js/copy-clipboard.min.js></script><script defer src=/js/search.min.js></script><meta name=twitter:card content="summary"><meta name=twitter:domain content="docs.FreeBSD.org"><meta name=twitter:site content="@freebsd"><meta name=twitter:url content="https://twitter.com/freebsd"><meta property="og:title" content="Глава 6. Особые соглашения"><meta property="og:description" content><meta property="og:type" content="website"><meta property="og:image" content="http://172.16.201.134:1313/favicon.ico"><meta property="og:image:alt" content="FreeBSD Logo"><meta property="og:locale" content="ru"><meta property="og:url" content="http://172.16.201.134:1313/ru/books/porters-handbook/special/"><meta property="og:site_name" content="FreeBSD Documentation Portal"><script type=application/ld+json>{"@context":"http://schema.org","@type":"Article","url":"http:\/\/172.16.201.134:1313\/ru\/books\/porters-handbook\/special\/","name":"FreeBSD Documentation Portal","headline":"FreeBSD Documentation Portal","description":"FreeBSD Documentation Portal"}</script></head><body><header><div class=header-container><div class=logo-menu-bars-container><a href=https://www.FreeBSD.org class=logo><img src=http://172.16.201.134:1313/images/FreeBSD-monochromatic.svg width=160 height=50 alt="FreeBSD logo">
</a><label class=menu-bars for=menu-bars><i class="fa fa-bars" aria-hidden=true></i></label></div><input id=menu-bars type=checkbox><nav><ul class=menu><li class=menu-item><input id=about type=checkbox>
<a href=# aria-label="Navigate to About section"><label class=menu-item-description for=about>О нас
<i class="fa fa-angle-down fa-lg" aria-hidden=true></i></label></a><ul class=sub-menu><li class=title><a href=https://www.freebsd.org/about/ target=_blank>О нас</a></li><li><a href=https://www.freebsd.org/about/ target=_blank>FreeBSD</a></li><li><a href=https://freebsdfoundation.org/about-us/about-the-foundation/ target=_blank>Фонд FreeBSD</a></li><li><a href=https://www.freebsd.org/internal/code-of-conduct/ target=_blank>Кодекс Этики</a></li></ul></li><li class=menu-item><input id=download type=checkbox>
<a href=# aria-label="Navigate to get FreeBSD section"><label class=menu-item-description for=download>Получить FreeBSD
<i class="fa fa-angle-down fa-lg" aria-hidden=true></i></label></a><ul class=sub-menu><li class=title><a href=https://www.freebsd.org/where/ target=_blank>Получить FreeBSD</a></li><li><a href=https://www.freebsd.org/releases/ target=_blank>Информация о релизах</a></li><li><a href=https://www.freebsd.org/releng/ target=_blank>Подготовка релизов</a></li><li><a href=https://www.freebsd.org/security/ target=_blank>Бюллетени Безопасности</a></li></ul></li><li class=menu-item><input id=documentation type=checkbox>
<a href=# aria-label="Navigate to get Documentation section"><label class=menu-item-description for=documentation>Документация
<i class="fa fa-angle-down fa-lg" aria-hidden=true></i></label></a><ul class=sub-menu><li class=title><a href=/ru>Портал документации</a></li><li><a href=http://172.16.201.134:1313/ru/books/handbook>Руководство</a></li><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook>Руководство по созданию портов</a></li><li><a href=https://docs.FreeBSD.org/en/books/fdp-primer>Учебник Проекта Документирования</a></li><li><a href=https://man.FreeBSD.org target=_blank>Страницы Справочника</a></li><li><a href=https://papers.FreeBSD.org target=_blank>Презентации и публикации</a></li><li><a href=https://wiki.FreeBSD.org target=_blank>Wiki</a></li><li><a href=http://172.16.201.134:1313/ru/books>Книги</a></li><li><a href=http://172.16.201.134:1313/ru/articles>Статьи</a></li></ul></li><li class=menu-item><input id=community type=checkbox>
<a href=# aria-label="Navigate to get Community section"><label class=menu-item-description for=community>Сообщество
<i class="fa fa-angle-down fa-lg" aria-hidden=true></i></label></a><ul class=sub-menu><li class=title><a href=https://www.freebsd.org/community/>Сообщество</a></li><li><a href=http://172.16.201.134:1313/ru/articles/contributing>Стать участником</a></li><li><a href=https://forums.freebsd.org/ target=_blank>Форум</a></li><li><a href=https://lists.freebsd.org/ target=_blank>Списки рассылки</a></li><li><a href=https://wiki.freebsd.org/IRC/Channels target=_blank>Каналы IRC</a></li><li><a href=https://bugs.freebsd.org/bugzilla/ target=_blank>Трекер ошибок</a></li><li><a href=https://www.freebsd.org/support/ target=_blank>Поддержка</a></li></ul></li></ul></nav><div class=search-donate-container><form class=search method=get id=search-header-form action=https://docs.freebsd.org/search name=search-header-form><input type=hidden name=DB value=ru>
<input id=words name=P type=text size=20 maxlength=255>
<button>
<i class="fa fa-search" aria-hidden=true></i></button></form><div class=donate><a href=https://freebsdfoundation.org/donate/ target=_blank><span class=heart>♥</span>
Пожертвования</a></div></div></div></header><input type=checkbox class="hidden toggle" id=menu-control><main class=main-wrapper-book><a id=top></a><aside class=book-menu><div class=book-menu-content><input id=search-book type=text placeholder=Поиск aria-label=Поиск maxlength=128><nav id=MenuContents><ul><li><input type=checkbox id=chapter-c934186a5adac4f64b993f751abed30c class=toggle>
<label for=chapter-c934186a5adac4f64b993f751abed30c><a role=button></a></label><a href=http://172.16.201.134:1313/ru/books/porters-handbook/porting-why/>Глава 1. Введение</a></li><li><input type=checkbox id=chapter-2798d78fe854f2709bab5ca473b97050 class=toggle>
<label for=chapter-2798d78fe854f2709bab5ca473b97050><a role=button></a></label><a href=http://172.16.201.134:1313/ru/books/porters-handbook/new-port/>Глава 2. Как самому сделать новый порт</a></li><li><input type=checkbox id=chapter-c0d52b9121b517084e01f59cefa725e1 class=toggle>
<label class="icon cursor" for=chapter-c0d52b9121b517084e01f59cefa725e1><a role=button></a></label><a href=http://172.16.201.134:1313/ru/books/porters-handbook/quick-porting/>Глава 3. Быстрое портирование</a><ul><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/quick-porting/#porting-makefile>3.1. Создание файла <span class=filename>Makefile</span></a></li><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/quick-porting/#porting-desc>3.2. Создание информационных файлов</a></li><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/quick-porting/#porting-checksum>3.3. Создание файла с контрольной суммой</a></li><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/quick-porting/#porting-testing>3.4. Тестирование порта</a></li><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/quick-porting/#porting-portlint>3.5. Проверка вашего порта утилитой <code>portlint</code></a></li><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/quick-porting/#porting-submitting>3.6. Посылка нового порта</a></li></ul></li><li><input type=checkbox id=chapter-3694de03923da61ba10a0a25efca6ef0 class=toggle>
<label class="icon cursor" for=chapter-3694de03923da61ba10a0a25efca6ef0><a role=button></a></label><a href=http://172.16.201.134:1313/ru/books/porters-handbook/slow-porting/>Глава 4. Медленное портирование</a><ul><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/slow-porting/#slow-work>4.1. Как всё это работает</a></li><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/slow-porting/#slow-sources>4.2. Получение исходного кода</a></li><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/slow-porting/#slow-modifying>4.3. Модификация порта</a></li><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/slow-porting/#slow-patch>4.4. Создание патчей</a></li><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/slow-porting/#slow-configure>4.5. Конфигурирование</a></li><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/slow-porting/#slow-user-input>4.6. Обработка пользовательского ввода</a></li></ul></li><li><input type=checkbox id=chapter-165f6a6dba6651f8c25fc63ab83d6538 class=toggle>
<label class="icon cursor" for=chapter-165f6a6dba6651f8c25fc63ab83d6538><a role=button></a></label><a href=http://172.16.201.134:1313/ru/books/porters-handbook/makefiles/>Глава 5. Настройка файла Makefile</a><ul><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/makefiles/#makefile-source>5.1. Оригинальные исходный код</a></li><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/makefiles/#makefile-naming>5.2. Именование</a></li><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/makefiles/#makefile-categories>5.3. Разделение по категориям</a></li><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/makefiles/#makefile-distfiles>5.4. Дистрибутивные файлы</a></li><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/makefiles/#makefile-maintainer>5.5. <code>MAINTAINER</code></a></li><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/makefiles/#makefile-comment>5.6. <code>COMMENT</code></a></li><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/makefiles/#makefile-portscout>5.7. <code>PORTSCOUT</code></a></li><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/makefiles/#makefile-depend>5.8. Зависимости</a></li><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/makefiles/#makefile-masterdir>5.9. <code>MASTERDIR</code></a></li><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/makefiles/#makefile-manpages>5.10. Страницы Справочника</a></li><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/makefiles/#makefile-info>5.11. Файлы в формате info</a></li><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/makefiles/#makefile-options>5.12. Опции для Makefile</a></li><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/makefiles/#makefile-wrkdir>5.13. Задание рабочего каталога</a></li><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/makefiles/#conflicts>5.14. Разрешение конфликтов</a></li><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/makefiles/#install>5.15. Установка файлов</a></li></ul></li><li><input type=checkbox id=chapter-19e3150e00beb84341d8ac1a73936ef0 class=toggle checked>
<label class="icon cursor" for=chapter-19e3150e00beb84341d8ac1a73936ef0><a role=button></a></label><a href=http://172.16.201.134:1313/ru/books/porters-handbook/special/>Глава 6. Особые соглашения</a><ul><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/special/#staging>6.1. Staging</a></li><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/special/#porting-shlibs>6.2. Динамические библиотеки</a></li><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/special/#porting-restrictions>6.3. Порты с ограничениями на распространение или с правовым обременением</a></li><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/special/#building>6.4. Механизмы построения</a></li><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/special/#using-autotools>6.5. Использование GNU Autotools</a></li><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/special/#using-gettext>6.6. Использование GNU <code>gettext</code></a></li><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/special/#using-perl>6.7. Использование Perl</a></li><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/special/#using-x11>6.8. Использование X11</a></li><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/special/#using-gnome>6.9. Использование GNOME</a></li><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/special/#using-qt>6.10. Использование Qt</a></li><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/special/#using-kde>6.11. Использование KDE</a></li><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/special/#using-java>6.12. Использование Java</a></li><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/special/#using-php>6.13. Веб-приложения, Apache и PHP</a></li><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/special/#using-python>6.14. Использование Python</a></li><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/special/#using-tcl>6.15. Использование Tcl/Tk</a></li><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/special/#using-emacs>6.16. Использование Emacs</a></li><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/special/#using-ruby>6.17. Использование Ruby</a></li><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/special/#using-sdl>6.18. Использование SDL</a></li><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/special/#using-wx>6.19. Использование wxWidgets</a></li><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/special/#using-lua>6.20. Использование Lua</a></li><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/special/#using-iconv>6.21. Использование <code>iconv</code></a></li><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/special/#using-xfce>6.22. Использование Xfce</a></li><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/special/#using-mozilla>6.23. Использование Mozilla</a></li><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/special/#using-databases>6.24. Использование баз данных</a></li><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/special/#rc-scripts>6.25. Запуск и остановка служб (сценарии <code>rc</code>)</a></li><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/special/#users-and-groups>6.26. Добавление пользователей и групп</a></li><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/special/#requiring-kernel-sources>6.27. Порты, требующие наличия исходных текстов ядра</a></li></ul></li><li><input type=checkbox id=chapter-154554011c772e1e6cc0108eef5e0b2b class=toggle>
<label class="icon cursor" for=chapter-154554011c772e1e6cc0108eef5e0b2b><a role=button></a></label><a href=http://172.16.201.134:1313/ru/books/porters-handbook/plist/>Глава 7. Продвинутые практики pkg-plist</a><ul><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/plist/#plist-sub>7.1. Изменение содержимого <span class=filename>pkg-plist</span> в зависимости от make-переменных</a></li><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/plist/#plist-cleaning>7.2. Пустые каталоги</a></li><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/plist/#plist-config>7.3. Конфигурационные файлы</a></li><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/plist/#plist-dynamic>7.4. Динамический или статический список упаковки</a></li><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/plist/#plist-autoplist>7.5. Автоматическое создание списка упаковки</a></li></ul></li><li><input type=checkbox id=chapter-5955b0791ccd51005b5bc5bebeec91e5 class=toggle>
<label class="icon cursor" for=chapter-5955b0791ccd51005b5bc5bebeec91e5><a role=button></a></label><a href=http://172.16.201.134:1313/ru/books/porters-handbook/pkg-files/>Глава 8. Файлы pkg-*</a><ul><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/pkg-files/#porting-message>8.1. <span class=filename>pkg-message</span></a></li><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/pkg-files/#pkg-install>8.2. <span class=filename>pkg-install</span></a></li><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/pkg-files/#pkg-deinstall>8.3. <span class=filename>pkg-deinstall</span></a></li><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/pkg-files/#pkg-names>8.4. Изменение имён файлов <span class=filename>pkg-*</span></a></li><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/pkg-files/#using-sub-files>8.5. Использование <code>SUB_FILES</code> и <code>SUB_LIST</code></a></li></ul></li><li><input type=checkbox id=chapter-ee86a11caedb6395ed82b94ec7a9c6cd class=toggle>
<label class="icon cursor" for=chapter-ee86a11caedb6395ed82b94ec7a9c6cd><a role=button></a></label><a href=http://172.16.201.134:1313/ru/books/porters-handbook/testing/>Глава 9. Тестирование вашего порта</a><ul><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/testing/#make-describe>9.1. Запуск <code>make describe</code></a></li><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/testing/#testing-portlint>9.2. Portlint</a></li><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/testing/#testing-porttools>9.3. Port Tools</a></li><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/testing/#porting-prefix>9.4. <code>PREFIX</code> и <code>DESTDIR</code></a></li><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/testing/#testing-tinderbox>9.5. Tinderbox</a></li><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/testing/#testing-poudriere>9.6. Poudriere</a></li></ul></li><li><input type=checkbox id=chapter-4ccaefe2590c044ca2b79c46e79fe17f class=toggle>
<label class="icon cursor" for=chapter-4ccaefe2590c044ca2b79c46e79fe17f><a role=button></a></label><a href=http://172.16.201.134:1313/ru/books/porters-handbook/upgrading/>Глава 10. Обновление отдельного порта</a><ul><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/upgrading/#svn-diff>10.1. Использование Subversion для создания патчей</a></li><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/upgrading/#moved-and-updating-files>10.2. Файлы <span class=filename>UPDATING</span> и <span class=filename>MOVED</span></a></li></ul></li><li><input type=checkbox id=chapter-1023911bc0041506653280b832dea3b2 class=toggle>
<label class="icon cursor" for=chapter-1023911bc0041506653280b832dea3b2><a role=button></a></label><a href=http://172.16.201.134:1313/ru/books/porters-handbook/security/>Глава 11. Безопасность портов</a><ul><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/security/#security-intro>11.1. Почему безопасность так важна</a></li><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/security/#security-fix>11.2. Исправление уязвимостей безопасности</a></li><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/security/#security-notify>11.3. Обеспечение сообщества информацией</a></li></ul></li><li><input type=checkbox id=chapter-9a8875d5d59aa92f1e5a78e9ecd1fbe7 class=toggle>
<label class="icon cursor" for=chapter-9a8875d5d59aa92f1e5a78e9ecd1fbe7><a role=button></a></label><a href=http://172.16.201.134:1313/ru/books/porters-handbook/porting-dads/>Глава 12. Что делать нужно, и что делать нельзя</a><ul><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/porting-dads/#dads-intro>12.1. Введение</a></li><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/porting-dads/#porting-wrkdir>12.2. <code>WRKDIR</code></a></li><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/porting-dads/#porting-wrkdirprefix>12.3. <code>WRKDIRPREFIX</code></a></li><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/porting-dads/#porting-versions>12.4. Различение операционных систем и версий ОС</a></li><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/porting-dads/#dads-after-port-mk>12.5. Написание чего-либо после <span class=filename>bsd.port.mk</span></a></li><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/porting-dads/#dads-sh-exec>12.6. Использование выражения <code>exec</code> в сценариях обёртках</a></li><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/porting-dads/#dads-rational>12.7. Поступайте разумно</a></li><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/porting-dads/#dads-cc>12.8. Работа как с <code>CC</code>, так и <code>CXX</code></a></li><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/porting-dads/#dads-cflags>12.9. Использование <code>CFLAGS</code></a></li><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/porting-dads/#dads-pthread>12.10. Библиотеки потоков</a></li><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/porting-dads/#dads-feedback>12.11. Пожелания</a></li><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/porting-dads/#dads-readme>12.12. <span class=filename>README.html</span></a></li><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/porting-dads/#dads-noinstall>12.13. Пометка неустанавливаемого порта как <code>BROKEN</code>, <code>FORBIDDEN</code> или <code>IGNORE</code></a></li><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/porting-dads/#dads-deprecated>12.14. Пометка порта на удаление с <code>DEPRECATED</code> или <code>EXPIRATION_DATE</code></a></li><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/porting-dads/#dads-dot-error>12.15. Избегайте использования конструкции <code>.error</code></a></li><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/porting-dads/#dads-sysctl>12.16. Использование <span class=filename>sysctl</span></a></li><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/porting-dads/#dads-rerolling-distfiles>12.17. Меняющиеся дистрибутивные файлы</a></li><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/porting-dads/#dads-avoiding-linuxisms>12.18. Избегание линуксизмов</a></li><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/porting-dads/#dads-misc>12.19. Разное</a></li></ul></li><li><input type=checkbox id=chapter-5ef4c4c471a3f55c74fb71881f9d8713 class=toggle>
<label for=chapter-5ef4c4c471a3f55c74fb71881f9d8713><a role=button></a></label><a href=http://172.16.201.134:1313/ru/books/porters-handbook/porting-samplem/>Глава 13. Примерный Makefile</a></li><li><input type=checkbox id=chapter-70f5a4755700a24529175d26e65871bf class=toggle>
<label class="icon cursor" for=chapter-70f5a4755700a24529175d26e65871bf><a role=button></a></label><a href=http://172.16.201.134:1313/ru/books/porters-handbook/keeping-up/>Глава 14. Актуализация</a><ul><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/keeping-up/#freshports>14.1. FreshPorts</a></li><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/keeping-up/#svnweb>14.2. Web-интерфейс к хранилищу исходных текстов</a></li><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/keeping-up/#ports-mailing-list>14.3. Список рассылки FreeBSD, посвящённый портам</a></li><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/keeping-up/#build-cluster>14.4. Кластер построения портов FreeBSD</a></li><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/keeping-up/#distfile-survey>14.5. Portscout: сканер дистрибутивных файлов портов FreeBSD</a></li><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/keeping-up/#portsmon>14.6. Система мониторинга портов FreeBSD</a></li></ul></li><li><input type=checkbox id=chapter-8225273087f0e195be28132f4b5a0562 class=toggle>
<label class="icon cursor" for=chapter-8225273087f0e195be28132f4b5a0562><a role=button></a></label><a href=http://172.16.201.134:1313/ru/books/porters-handbook/uses/>Глава 15. Значения USES</a><ul><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/uses/#uses-intro>15.1. An Introduction to <code>USES</code></a></li><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/uses/#uses-7z>15.2. <code>7z</code></a></li><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/uses/#uses-ada>15.3. <code>ada</code></a></li><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/uses/#uses-autoreconf>15.4. <code>autoreconf</code></a></li><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/uses/#uses-blaslapack>15.5. <code>blaslapack</code></a></li><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/uses/#uses-bdb>15.6. <code>bdb</code></a></li><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/uses/#uses-bison>15.7. <code>bison</code></a></li><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/uses/#uses-cabal>15.8. <code>cabal</code></a></li><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/uses/#uses-cargo>15.9. <code>cargo</code></a></li><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/uses/#uses-charsetfix>15.10. <code>charsetfix</code></a></li><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/uses/#uses-cmake>15.11. <code>cmake</code></a></li><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/uses/#uses-compiler>15.12. <code>compiler</code></a></li><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/uses/#uses-cpe>15.13. <code>cpe</code></a></li><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/uses/#uses-cran>15.14. <code>cran</code></a></li><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/uses/#uses-desktop-file-utils>15.15. <code>desktop-file-utils</code></a></li><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/uses/#uses-desthack>15.16. <code>desthack</code></a></li><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/uses/#uses-display>15.17. <code>display</code></a></li><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/uses/#uses-dos2unix>15.18. <code>dos2unix</code></a></li><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/uses/#uses-drupal>15.19. <code>drupal</code></a></li><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/uses/#uses-eigen>15.20. <code>eigen</code></a></li><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/uses/#uses-fakeroot>15.21. <code>fakeroot</code></a></li><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/uses/#uses-fam>15.22. <code>fam</code></a></li><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/uses/#uses-firebird>15.23. <code>firebird</code></a></li><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/uses/#uses-fonts>15.24. <code>fonts</code></a></li><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/uses/#uses-fortran>15.25. <code>fortran</code></a></li><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/uses/#uses-fuse>15.26. <code>fuse</code></a></li><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/uses/#uses-gem>15.27. <code>gem</code></a></li><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/uses/#uses-gettext>15.28. <code>gettext</code></a></li><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/uses/#uses-gettext-runtime>15.29. <code>gettext-runtime</code></a></li><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/uses/#uses-gettext-tools>15.30. <code>gettext-tools</code></a></li><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/uses/#uses-ghostscript>15.31. <code>ghostscript</code></a></li><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/uses/#uses-gl>15.32. <code>gl</code></a></li><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/uses/#uses-gmake>15.33. <code>gmake</code></a></li><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/uses/#uses-gnome>15.34. <code>gnome</code></a></li><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/uses/#uses-go>15.35. <code>go</code></a></li><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/uses/#uses-gperf>15.36. <code>gperf</code></a></li><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/uses/#uses-grantlee>15.37. <code>grantlee</code></a></li><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/uses/#uses-groff>15.38. <code>groff</code></a></li><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/uses/#uses-gssapi>15.39. <code>gssapi</code></a></li><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/uses/#uses-horde>15.40. <code>horde</code></a></li><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/uses/#uses-iconv>15.41. <code>iconv</code></a></li><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/uses/#uses-imake>15.42. <code>imake</code></a></li><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/uses/#uses-kde>15.43. <code>kde</code></a></li><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/uses/#uses-kmod>15.44. <code>kmod</code></a></li><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/uses/#uses-lha>15.45. <code>lha</code></a></li><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/uses/#uses-libarchive>15.46. <code>libarchive</code></a></li><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/uses/#uses-libedit>15.47. <code>libedit</code></a></li><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/uses/#uses-libtool>15.48. <code>libtool</code></a></li><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/uses/#uses-linux>15.49. <code>linux</code></a></li><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/uses/#uses-localbase>15.50. <code>localbase</code></a></li><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/uses/#uses-lua>15.51. <code>lua</code></a></li><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/uses/#uses-lxqt>15.52. <code>lxqt</code></a></li><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/uses/#uses-makeinfo>15.53. <code>makeinfo</code></a></li><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/uses/#uses-makeself>15.54. <code>makeself</code></a></li><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/uses/#uses-mate>15.55. <code>mate</code></a></li><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/uses/#uses-meson>15.56. <code>meson</code></a></li><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/uses/#uses-metaport>15.57. <code>metaport</code></a></li><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/uses/#uses-mysql>15.58. <code>mysql</code></a></li><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/uses/#uses-mono>15.59. <code>mono</code></a></li><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/uses/#uses-motif>15.60. <code>motif</code></a></li><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/uses/#uses-ncurses>15.61. <code>ncurses</code></a></li><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/uses/#uses-ninja>15.62. <code>ninja</code></a></li><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/uses/#uses-objc>15.63. <code>objc</code></a></li><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/uses/#uses-openal>15.64. <code>openal</code></a></li><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/uses/#uses-pathfix>15.65. <code>pathfix</code></a></li><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/uses/#uses-pear>15.66. <code>pear</code></a></li><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/uses/#uses-perl5>15.67. <code>perl5</code></a></li><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/uses/#uses-pgsql>15.68. <code>pgsql</code></a></li><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/uses/#uses-php>15.69. <code>php</code></a></li><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/uses/#uses-pkgconfig>15.70. <code>pkgconfig</code></a></li><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/uses/#uses-pure>15.71. <code>pure</code></a></li><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/uses/#uses-pyqt>15.72. <code>pyqt</code></a></li><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/uses/#uses-python>15.73. <code>python</code></a></li><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/uses/#uses-qmail>15.74. <code>qmail</code></a></li><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/uses/#uses-qmake>15.75. <code>qmake</code></a></li><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/uses/#uses-qt>15.76. <code>qt</code></a></li><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/uses/#uses-qt-dist>15.77. <code>qt-dist</code></a></li><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/uses/#uses-readline>15.78. <code>readline</code></a></li><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/uses/#uses-samba>15.79. <code>samba</code></a></li><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/uses/#uses-scons>15.80. <code>scons</code></a></li><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/uses/#uses-shared-mime-info>15.81. <code>shared-mime-info</code></a></li><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/uses/#uses-shebangfix>15.82. <code>shebangfix</code></a></li><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/uses/#uses-sqlite>15.83. <code>sqlite</code></a></li><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/uses/#uses-ssl>15.84. <code>ssl</code></a></li><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/uses/#uses-tar>15.85. <code>tar</code></a></li><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/uses/#uses-tcl>15.86. <code>tcl</code></a></li><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/uses/#uses-terminfo>15.87. <code>terminfo</code></a></li><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/uses/#uses-tk>15.88. <code>tk</code></a></li><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/uses/#uses-uidfix>15.89. <code>uidfix</code></a></li><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/uses/#uses-uniquefiles>15.90. <code>uniquefiles</code></a></li><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/uses/#uses-varnish>15.91. <code>varnish</code></a></li><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/uses/#uses-webplugin>15.92. <code>webplugin</code></a></li><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/uses/#uses-xfce>15.93. <code>xfce</code></a></li><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/uses/#uses-xorg>15.94. <code>xorg</code></a></li><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/uses/#uses-xorg-cat>15.95. <code>xorg-cat</code></a></li><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/uses/#uses-zip>15.96. <code>zip</code></a></li></ul></li><li><input type=checkbox id=chapter-7713ccc63287693c9be6c832b2c1e850 class=toggle>
<label class="icon cursor" for=chapter-7713ccc63287693c9be6c832b2c1e850><a role=button></a></label><a href=http://172.16.201.134:1313/ru/books/porters-handbook/versions/>Глава 16. Значения __FreeBSD_version</a><ul><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/versions/#versions-13>16.1. FreeBSD 13 Versions</a></li><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/versions/#versions-12>16.2. FreeBSD 12 Versions</a></li><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/versions/#versions-11>16.3. FreeBSD 11 Versions</a></li><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/versions/#versions-10>16.4. FreeBSD 10 Versions</a></li><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/versions/#versions-9>16.5. FreeBSD 9 Versions</a></li><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/versions/#versions-8>16.6. FreeBSD 8 Versions</a></li><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/versions/#versions-7>16.7. FreeBSD 7 Versions</a></li><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/versions/#versions-6>16.8. FreeBSD 6 Versions</a></li><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/versions/#versions-5>16.9. FreeBSD 5 Versions</a></li><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/versions/#versions-4>16.10. FreeBSD 4 Versions</a></li><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/versions/#versions-3>16.11. FreeBSD 3 Versions</a></li><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/versions/#versions-2.2>16.12. FreeBSD 2.2 Versions</a></li><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook/versions/#versions-2>16.13. FreeBSD 2 Before 2.2-RELEASE Versions</a></li></ul></li><li></li></ul></nav></div></aside><div class=book><div class=book-menu-mobile><label for=menu-control><span class=menu-control-button><i class="fa fa-list" aria-hidden=true title="Меню книг"></i>
Меню книг</span></label></div><h1 class=title>Глава 6. Особые соглашения</h1><div class="admonitionblock note"><p><i class="fa fa-exclamation-circle" aria-hidden=true></i>
Этот перевод может быть устаревшим. Для того, чтобы помочь с переводом, пожалуйста, обратитесь к <a href=https://translate-dev.freebsd.org/ target=_blank>Сервер переводов FreeBSD</a>.</p></div><div class=toc-mobile><h3>Содержание</h3><nav id=TableOfContents><ul><li><a href=#staging>6.1. Staging</a></li><li><a href=#porting-shlibs>6.2. Динамические библиотеки</a></li><li><a href=#porting-restrictions>6.3. Порты с ограничениями на распространение или с правовым обременением</a></li><li><a href=#building>6.4. Механизмы построения</a></li><li><a href=#using-autotools>6.5. Использование GNU Autotools</a></li><li><a href=#using-gettext>6.6. Использование GNU <code>gettext</code></a></li><li><a href=#using-perl>6.7. Использование Perl</a></li><li><a href=#using-x11>6.8. Использование X11</a></li><li><a href=#using-gnome>6.9. Использование GNOME</a></li><li><a href=#using-qt>6.10. Использование Qt</a></li><li><a href=#using-kde>6.11. Использование KDE</a></li><li><a href=#using-java>6.12. Использование Java</a></li><li><a href=#using-php>6.13. Веб-приложения, Apache и PHP</a></li><li><a href=#using-python>6.14. Использование Python</a></li><li><a href=#using-tcl>6.15. Использование Tcl/Tk</a></li><li><a href=#using-emacs>6.16. Использование Emacs</a></li><li><a href=#using-ruby>6.17. Использование Ruby</a></li><li><a href=#using-sdl>6.18. Использование SDL</a></li><li><a href=#using-wx>6.19. Использование wxWidgets</a></li><li><a href=#using-lua>6.20. Использование Lua</a></li><li><a href=#using-iconv>6.21. Использование <code>iconv</code></a></li><li><a href=#using-xfce>6.22. Использование Xfce</a></li><li><a href=#using-mozilla>6.23. Использование Mozilla</a></li><li><a href=#using-databases>6.24. Использование баз данных</a></li><li><a href=#rc-scripts>6.25. Запуск и остановка служб (сценарии <code>rc</code>)</a></li><li><a href=#users-and-groups>6.26. Добавление пользователей и групп</a></li><li><a href=#requiring-kernel-sources>6.27. Порты, требующие наличия исходных текстов ядра</a></li></ul></nav></div><div class=book-content><div id=preamble><div class=sectionbody><div class=paragraph><p>Имеется ещё несколько вещей, которые вы должны иметь в виду при создании порта. Этот раздел описывает наиболее часто встречающиеся из них.</p></div></div></div><div class=sect1><h2 id=staging>6.1. Staging<a class=anchor href=#staging></a></h2><div class=sectionbody><div class=paragraph><p><span class=filename>bsd.port.mk</span> ожидает от портов работу с "каталогом сборки". Это означает, что порт должен устанавливать файлы не напрямую в назначенные каталоги (то есть, например, под <code>PREFIX</code>), а в отдельный каталог, из которого затем собирается пакет. Во многих случаях привилегии root для этого не требуются, что делает возможным сборку пакетов из-под непривилегированного пользователя. В режиме staging порт собирается и устанавливается в каталог сборки <code>STAGEDIR</code>. Пакет создается из каталога сборки и затем устанавливается в систему. В инструментарии automake такая концепция именуется <code>DESTDIR</code>; в прочем, в FreeBSD <code>DESTDIR</code> имеет собственное значение (смотрите <a href=../testing/#porting-prefix><code>PREFIX</code> и <code>DESTDIR</code></a>).</p></div><div class=paragraph><p>Если для порта всё ещё требуются системные привилегии при выполнении цели <code>package</code>, то в <span class=filename>Makefile</span> должна быть добавлена следующая строка:</p></div><div class="literalblock programlisting"><div class=content><pre>NEED_ROOT=	yes</pre></div></div><div class=paragraph><p>Метапорты, то есть порты, которые не устанавливают файлы непосредственно, а только зависят от других портов, должны по возможности избегать распаковки <a href="https://man.freebsd.org/cgi/man.cgi?query=mtree&amp;sektion=8&amp;format=html">mtree(8)</a> в каталог сборки. Это основная иерархия каталогов пакета, и эти пустые каталоги будут выглядеть лишними. Для предотвращения распаковки <a href="https://man.freebsd.org/cgi/man.cgi?query=mtree&amp;sektion=8&amp;format=html">mtree(8)</a> добавьте эту строку:</p></div><div class="literalblock programlisting"><div class=content><pre>NO_MTREE=	yes</pre></div></div><div class=paragraph><p>Staging задействуется посредством добавления переменной <code>STAGEDIR</code> слева от путей, которые используются в целях <code>pre-install</code>, <code>do-install</code> и <code>post-install</code> (смотрите примеры в книге). Обычно сюда относятся <code>PREFIX</code>, <code>ETCDIR</code>, <code>DATADIR</code>, <code>EXAMPLESDIR</code>, <code>MANPREFIX</code>, <code>DOCSDIR</code> и так далее. Каталоги должны создаваться при выполнении цели <code>post-install</code>. Избегайте использования абсолютных путей, когда это возможно.</p></div><div class=paragraph><p>При создании символический ссылки <code>STAGEDIR</code> должен ставиться только для пути назначения. Например:</p></div><div class="literalblock programlisting"><div class=content><pre>${LN} -sf libfoo.so.42 ${STAGEDIR}${PREFIX}/lib/libfoo.so</pre></div></div><div class=paragraph><p>Первоначальный путь <span class=filename>${PREFIX}/lib/libfoo.so.42</span> выглядит нормально, но по факту может быть неправильным. Абсолютные пути могут указывать на неподходящее место, например, когда удалённая файловая система смонтирована по NFS как непривилегированная точка монтирования. Относительные пути реже подвержены проблемам и часто намного короче.</p></div><div class=paragraph><p>Порты, устанавливающие модули ядра, должны предварять путь установки (по умолчанию <span class=filename>/boot/modules</span>) переменной <code>STAGEDIR</code>.</p></div></div></div><div class=sect1><h2 id=porting-shlibs>6.2. Динамические библиотеки<a class=anchor href=#porting-shlibs></a></h2><div class=sectionbody><div class=paragraph><p>Если ваш порт устанавливает одну или несколько динамических библиотек, определите переменную <code>USE_LDCONFIG</code>, которая приведёт к запуску из <span class=filename>bsd.port.mk</span> команды <code>${LDCONFIG} -m</code> относительно каталога, в который устанавливается новая библиотека (как правило, это <span class=filename>PREFIX/lib</span>), во время выполнения цели <code>post-install</code> для её регистрации в кэше динамических библиотек. Эта переменная, если она определена, также приведёт к добавлению соответствующей пары команд <code>@exec /sbin/ldconfig -m</code> и <code>@unexec /sbin/ldconfig -R</code> в ваш файл <span class=filename>pkg-plist</span>, так что пользователь, устанавливающий пакет, сможет сразу же использовать динамическую библиотеку, а удаление пакета не приведёт к тому, что система будет предполагать, что библиотека всё ещё имеется в наличии.</p></div><div class="literalblock programlisting"><div class=content><pre>USE_LDCONFIG=	yes</pre></div></div><div class=paragraph><p>Если нужно, вы можете переопределить каталог по умолчанию, задав значение <code>USE_LDCONFIG</code>, в котором должны быть перечислены каталоги, в которые устанавливаются динамические библиотеки. Например, если ваш порт устанавливает динамические библиотеки в каталоги <span class=filename>PREFIX/lib/foo</span> и <span class=filename>PREFIX/lib/bar</span>, то вы можете в файле <span class=filename>Makefile</span> указать следующее:</p></div><div class="literalblock programlisting"><div class=content><pre>USE_LDCONFIG=	${PREFIX}/lib/foo ${PREFIX}/lib/bar</pre></div></div><div class=paragraph><p>Будьте добры перепроверить, т.к. часто это вовсе не является необходимым и может быть решено иначе с помощью <code>-rpath</code> или установки <code>LD_RUN_PATH</code> во время компоновки (для примера смотрите <a class=package href=https://cgit.freebsd.org/ports/tree/lang/moscow_ml/>lang/moscow_ml</a>), или с помощью сценария-обёртки, который выставляет <code>LD_LIBRARY_PATH</code> перед запуском исполняемого файла как это делает <a class=package href=https://cgit.freebsd.org/ports/tree/www/seamonkey/>www/seamonkey</a>.</p></div><div class=paragraph><p>При установке 32-разрядных библиотек на 64-разрядной системе используйте вместо этого <code>USE_LDCONFIG32</code>.</p></div><div class=paragraph><p>Постарайтесь сохранять номера версий динамических библиотек в формате <span class=filename>libfoo.so.0</span>. Наш компоновщик позаботится только о старшем (первом) номере.</p></div><div class=paragraph><p>Если при обновлении порта увеличивается старший номер версии библиотеки, то для всех портов, компонуемых с затронутой библиотекой, следует увеличить значение <code>PORTREVISION</code> для форсирования перекомпиляции с новой версией библиотеки.</p></div></div></div><div class=sect1><h2 id=porting-restrictions>6.3. Порты с ограничениями на распространение или с правовым обременением<a class=anchor href=#porting-restrictions></a></h2><div class=sectionbody><div class=paragraph><p>Лицензии бывают разных видов, и некоторые накладывают ограничение на то, как приложение может быть оформлено в виде пакета, может ли оно продаваться для извлечения коммерческой выгоды, и так далее.</p></div><div class="admonitionblock important"><table><tbody><tr><td class=icon><i class="fa icon-important" title=Important></i></td><td class=content><div class=paragraph><p>На вас, как на человека, портирующего приложение, ложится обязанность прочесть лицензионные соглашения на программное обеспечение и удостовериться, что проект FreeBSD не будет являться их нарушителем, если будет заниматься распространением исходного кода или в бинарном виде по FTP/HTTP или на CD-ROM. Если у вас возникли сомнения, то, пожалуйста, обратитесь в <a href=https://lists.FreeBSD.org/subscription/freebsd-ports>Список рассылки, посвящённый Портам FreeBSD</a>.</p></div></td></tr></tbody></table></div><div class=paragraph><p>В подобных ситуациях можно использовать переменные, описываемые в последующих разделах.</p></div><div class=sect2><h3 id=_no_package>6.3.1. <code>NO_PACKAGE</code><a class=anchor href=#_no_package></a></h3><div class=paragraph><p>Эта переменная указывает, что мы не можем создавать для приложения двоичный пакет. К примеру, лицензия не позволяет бинарное распространение или она может запрещать распространение пакетов, созданных из изменённых исходников.</p></div><div class=paragraph><p>Однако файлы <code>DISTFILES</code> могут свободно зеркалироваться по FTP/HTTP. Они также могут распространяться, используя CD-ROM (или на похожих носителях), если не установлена переменная <code>NO_CDROM</code>.</p></div><div class=paragraph><p><code>NO_PACKAGE</code> должна также использоваться, если двоичный пакет, как правило, бесполезен, а приложение должно всегда компилироваться из исходного кода. К примеру, если в приложение во время компиляции жёстко включается конфигурационная информация, привязанная к конкретной системе, то задайте переменную <code>NO_PACKAGE</code>.</p></div><div class=paragraph><p>Значением переменной <code>NO_PACKAGE</code> должна быть строка, описывающая причину, по которой пакет не должен создаваться.</p></div></div><div class=sect2><h3 id=_no_cdrom>6.3.2. <code>NO_CDROM</code><a class=anchor href=#_no_cdrom></a></h3><div class=paragraph><p>Эта переменная указывает на то, что, хотя мы имеем право создавать бинарные пакеты, мы не можем помещать эти пакеты или файлы <code>DISTFILES</code> порта на CD-ROM (или на похожие носители) для перепродажи. Однако бинарные пакеты и файлы <code>DISTFILES</code> порта будут оставаться доступными посредством FTP/HTTP.</p></div><div class=paragraph><p>Если эта переменная устанавливается вместе с <code>NO_PACKAGE</code>, то только файлы порта <code>DISTFILES</code> будут доступны, и только посредством FTP/HTTP.</p></div><div class=paragraph><p>В качестве значения <code>NO_CDROM</code> должна указываться строка, описывающая причины, по которым порт не может распространяться на CD-ROM. К примеру, это применяется, если лицензионное соглашение приложения предполагает только его "некоммерческое" использование.</p></div></div><div class=sect2><h3 id=_nofetchfiles>6.3.3. <code>NOFETCHFILES</code><a class=anchor href=#_nofetchfiles></a></h3><div class=paragraph><p>Файлы, определенные в переменной <code>NOFETCHFILES</code>, не будут извлекаться ни из одного из <code>MASTER_SITES</code>. Примером такого файла является файл, поставляемый на CD-ROM.</p></div><div class=paragraph><p>Инструменты, проверяющие доступность этих файлов на <code>MASTER_SITES</code>, должны игнорировать эти файлы и не сообщать о них.</p></div></div><div class=sect2><h3 id=_restricted>6.3.4. <code>RESTRICTED</code><a class=anchor href=#_restricted></a></h3><div class=paragraph><p>Задайте эту переменную, если лицензия на приложение не позволяет ни зеркалировать файлы <code>DISTFILES</code>, ни распространять бинарный пакет через FTP/HTTP или на CD-ROM.</p></div><div class=paragraph><p>Ни <code>NO_CDROM</code>, ни <code>NO_PACKAGE</code> не стоит устанавливать вместе с <code>RESTRICTED</code>, так как последняя переменная подразумевает первые две.</p></div><div class=paragraph><p>В качестве значения <code>RESTRICTED</code> должна указываться строка, описывающая причины, по которым порт нельзя распространять. Обычно это означает, что порт использует закрытое программное обеспечение, а пользователь должен вручную сгрузить файлы <code>DISTFILES</code>, возможно, после заполнения регистрационной формы или подтверждения соглашения с условиями EULA.</p></div></div><div class=sect2><h3 id=_restricted_files>6.3.5. <code>RESTRICTED_FILES</code><a class=anchor href=#_restricted_files></a></h3><div class=paragraph><p>Если заданы <code>RESTRICTED</code> или <code>NO_CDROM</code>, то значение этой переменной по умолчанию соответствует <code>${DISTFILES} ${PATCHFILES}</code>, в противном случае она пуста. Если ограничены в распространении лишь некоторые из дистрибутивных файлов, то в этой переменной задаётся их список.</p></div></div><div class=sect2><h3 id=_legal_text>6.3.6. <code>LEGAL_TEXT</code><a class=anchor href=#_legal_text></a></h3><div class=paragraph><p>Если порт имеет правовое обременение, которое не покрывается перечисленными выше переменными, то переменной <code>LEGAL_TEXT</code> следует присвоить строку с описанием данного обременения. Например, если было получено особое разрешение для FreeBSD на распространение двоичного файла, то эта переменная должна содержать соответствующее указание.</p></div></div><div class=sect2><h3 id=_usrportslegal_и_legal>6.3.7. <span class=filename>/usr/ports/LEGAL</span> и <code>LEGAL</code><a class=anchor href=#_usrportslegal_и_legal></a></h3><div class=paragraph><p>Порт, содержащий любую из перечисленных выше переменных, также должен быть добавлен в <span class=filename>/usr/ports/LEGAL</span>. Первый столбец содержит шаблон совпадения с дистрибутивными файлами, имеющими ограничения на распространение. Второй столбец содержит корень порта. Третий столбец содержит вывод <code>make -VLEGAL</code>.</p></div></div><div class=sect2><h3 id=_примеры_использования>6.3.8. Примеры использования<a class=anchor href=#_примеры_использования></a></h3><div class=paragraph><p>Предпочтительным способом реализации утверждения "архивы исходных текстов для этого порта должны загружаться самостоятельно" является следующее:</p></div><div class="literalblock programlisting"><div class=content><pre>.if !exists(${DISTDIR}/${DISTNAME}${EXTRACT_SUFX})
IGNORE=	may not be redistributed because of licensing reasons. Please visit some-website to accept their license and download ${DISTFILES} into ${DISTDIR}
.endif</pre></div></div><div class=paragraph><p>Это одновременно и информирует пользователя, и устанавливает нужные метаданные на пользовательской машине для использования автоматическими программами.</p></div><div class=paragraph><p>Обратите внимание, что данная кляуза должна предшествовать подключению файла <span class=filename>bsd.port.pre.mk</span>.</p></div></div></div></div><div class=sect1><h2 id=building>6.4. Механизмы построения<a class=anchor href=#building></a></h2><div class=sectionbody><div class=sect2><h3 id=parallel-builds>6.4.1. Параллельное построение портов<a class=anchor href=#parallel-builds></a></h3><div class=paragraph><p>Инфраструктура портов FreeBSD поддерживает параллельное построение с использованием множественных подпроцессов <code>make</code>, что позволяет системам SMP задействовать всю доступную мощность CPU, тем самым делая построение портов более быстрым и эффективным.</p></div><div class=paragraph><p>Это достигается путём передачи флага <code>-jX</code> команде <a href="https://man.freebsd.org/cgi/man.cgi?query=make&amp;sektion=1&amp;format=html">make(1)</a>. Такое построение портов является поведением по умолчанию. К сожалению, не все порты поддерживают параллельную сборку достаточно хорошо, и поэтому может потребоваться выключить этот механизм явным образом путём добавления переменной <code>MAKE_JOBS_UNSAFE=yes</code>. Эта переменная используется в случае, когда известно, что порт ломается с <code>-jX</code>.</p></div></div><div class=sect2><h3 id=using-make>6.4.2. <code>make</code>, <code>gmake</code> и <code>imake</code><a class=anchor href=#using-make></a></h3><div class=paragraph><p>Если ваш порт использует GNU make, то установите <code>USES= gmake</code>.</p></div><table class="tableblock frame-none grid-all stretch"><caption class=title>Таблица 1. Переменные для портов, использующих gmake</caption><col style=width:50%><col style=width:50%><thead><tr><th class="tableblock halign-left valign-top">Переменная</th><th class="tableblock halign-left valign-top">Значение</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>USES= gmake</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Для сборки порта требуется <code>gmake</code>.</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>GMAKE</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Полный путь к команде <code>gmake</code>, если отсутствует в <code>PATH</code>.</p></td></tr></tbody></table><div class=paragraph><p>Если ваш порт является приложением X, которое создает файлы <span class=filename>Makefile</span> из <span class=filename>Imakefile</span>, используя imake, то установите <code>USES= imake</code>. Это заставит стадию конфигурирования автоматически выполнить <code>xmkmf -a</code>. Если флаг <code>-a</code> представляет для вашего порта проблему, то установите <code>XMKMF=xmkmf</code>. Если порт использует imake, но не понимает цель <code>install.man</code>, то следует установить <code>NO_INSTALL_MANPAGES=yes</code>.</p></div><div class=paragraph><p>Если исходный <span class=filename>Makefile</span> вашего порта имеет что-нибудь помимо <code>all</code> в качестве основной цели построения, то задайте соответствующее значение <code>ALL_TARGET</code>. То же касается <code>install</code> и <code>INSTALL_TARGET</code>.</p></div></div><div class=sect2><h3 id=using-configure>6.4.3. Сценарий <code>configure</code><a class=anchor href=#using-configure></a></h3><div class=paragraph><p>Если ваш порт использует сценарий <code>configure</code> для получения файлов <span class=filename>Makefile</span> из файлов <span class=filename>Makefile.in</span>, то установите <code>GNU_CONFIGURE=yes</code>. Если вы хотите дать дополнительные параметры сценарию <code>configure</code> (аргументом по умолчанию является <code>--prefix=${PREFIX} --infodir=${PREFIX}/${INFO_PATH} --mandir=${MANPREFIX}/man --build=${CONFIGURE_TARGET}</code>), установите эти параметры в <code>CONFIGURE_ARGS</code>. Дополнительные переменные окружения можно передать, используя переменную <code>CONFIGURE_ENV</code>.</p></div><table class="tableblock frame-none grid-all stretch"><caption class=title>Таблица 2. Переменные для портов, использующих <code>configure</code></caption><col style=width:50%><col style=width:50%><thead><tr><th class="tableblock halign-left valign-top">Переменная</th><th class="tableblock halign-left valign-top">Значение</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>GNU_CONFIGURE</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Порт использует сценарий <code>configure</code> для подготовки построения.</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>HAS_CONFIGURE</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>То же, что и <code>GNU_CONFIGURE</code>, кроме того, что цель configure по умолчанию не добавляется в <code>CONFIGURE_ARGS</code>.</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>CONFIGURE_ARGS</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Дополнительные параметры, передаваемые сценарию <code>configure</code>.</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>CONFIGURE_ENV</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Дополнительные переменные окружения, задаваемые для запуска сценария <code>configure</code>.</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>CONFIGURE_TARGET</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Переопределить цель configure по умолчанию. Значением по умолчанию является <code>${MACHINE_ARCH}-portbld-freebsd${OSREL}</code>.</p></td></tr></tbody></table></div><div class=sect2><h3 id=using-cmake>6.4.4. Использование <code>cmake</code><a class=anchor href=#using-cmake></a></h3><div class=paragraph><p>Если порт использует CMake, определите <code>USES= cmake</code> или <code>USES= cmake:outsource</code> для построения во внешнем каталоге (см. ниже).</p></div><table class="tableblock frame-none grid-all stretch"><caption class=title>Таблица 3. Переменные для портов, использующих <code>cmake</code></caption><col style=width:50%><col style=width:50%><thead><tr><th class="tableblock halign-left valign-top">Переменная</th><th class="tableblock halign-left valign-top">Значение</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>CMAKE_ARGS</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Специфичные для порта флаги CMake, передаваемые <code>cmake</code>.</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>CMAKE_BUILD_TYPE</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Тип построения (предопределённые профили построения CMake). По умолчанию <code>Release</code>, <code>Debug</code> при использовании <code>WITH_DEBUG</code>.</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>CMAKE_ENV</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Переменные окружения для передачи <code>cmake</code>. По умолчанию <code>${CONFIGURE_ENV}</code>.</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>CMAKE_SOURCE_PATH</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Путь к каталогу с исходным кодом. По умолчанию <code>${WRKSRC}</code>.</p></td></tr></tbody></table><table class="tableblock frame-none grid-all stretch"><caption class=title>Таблица 4. Переменные построения <code>cmake</code>, устанавливаемые пользователем</caption><col style=width:50%><col style=width:50%><thead><tr><th class="tableblock halign-left valign-top">Переменная</th><th class="tableblock halign-left valign-top">Значение</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>CMAKE_VERBOSE</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Разрешает подробный вывод сообщений при построении. Значение по умолчанию не задано, если не заданы <code>BATCH</code> или <code>PACKAGE_BUILDING</code>.</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>CMAKE_NOCOLOR</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Запрещает цветной вывод сообщений при построении. Значение по умолчанию не задано, если не заданы <code>BATCH</code> или <code>PACKAGE_BUILDING</code>.</p></td></tr></tbody></table><div class=paragraph><p>CMake поддерживает следующие профили построения: <code>Debug</code>, <code>Release</code>, <code>RelWithDebInfo</code> и <code>MinSizeRel</code>. Профили <code>Debug</code> и <code>Release</code> учитывают системные флаги <code>*FLAGS</code>; <code>RelWithDebInfo</code> и <code>MinSizeRel</code> соответственно определяют <code>CFLAGS</code> со значением <code>-O2 -g</code> и <code>-Os -DNDEBUG</code>. Значение <code>CMAKE_BUILD_TYPE</code> экспортируется в нижнем регистре в <code>PLIST_SUB</code> и должно использоваться, если порт устанавливает файлы <code>*.cmake</code> в зависимости от типа построения (для примера посмотрите на <a class=package href=https://cgit.freebsd.org/ports/tree/deskutils/strigi/>deskutils/strigi</a>). Следует учитывать, что некоторые проекты могут определять собственные профили построения и/или форсировать конкретный тип построения через установку <code>CMAKE_BUILD_TYPE</code> в файлах <span class=filename>CMakeLists.txt</span>. Для того чтобы порт для такого проекта учитывал <code>CFLAGS</code> и <code>WITH_DEBUG</code>, из этих файлов должны быть удалены значения <code>CMAKE_BUILD_TYPE</code>.</p></div><div class=paragraph><p>Большинство проектов, основанных на CMake, поддерживают метод внешнего (out-of-source) построения. Для порта внешнее построение можно запросить с использованием суффикса <code>:outsource</code>. В этом случае <code>CONFIGURE_WRKSRC</code>, <code>BUILD_WRKSRC</code> и <code>INSTALL_WRKSRC</code> будут иметь значение <code>${WRKDIR}/.build</code> для каталога, содержащего файлы, получаемые на этапах конфигурации и построения; при этом каталог с исходным кодом будет оставаться без изменений.</p></div><div id=using-cmake-example class=exampleblock><div class=title>Пример 1. Пример для <code>USES= cmake</code></div><div class=content><div class=paragraph><p>Следующий отрывок демонстрирует использование CMake для порта. <code>CMAKE_SOURCE_PATH</code> обычно не требуется, но может быть установлен, когда исходный код не находится в верхнем каталоге или если порт используется для построения части проекта.</p></div><div class="literalblock programlisting"><div class=content><pre>USES=			cmake:outsource
CMAKE_SOURCE_PATH=	${WRKSRC}/subproject</pre></div></div></div></div></div><div class=sect2><h3 id=using-scons>6.4.5. Использование <code>scons</code><a class=anchor href=#using-scons></a></h3><div class=paragraph><p>Если ваш порт использует SCons, определите <code>USE_SCONS=yes</code>.</p></div><table class="tableblock frame-none grid-all stretch"><caption class=title>Таблица 5. Переменные для портов, использующих <code>scons</code></caption><col style=width:50%><col style=width:50%><thead><tr><th class="tableblock halign-left valign-top">Переменная</th><th class="tableblock halign-left valign-top">Значение</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>SCONS_ARGS</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Специфичные для порта флаги SCons, передаваемые окружению SCons.</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>SCONS_BUILDENV</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Переменные для установки в системном окружении.</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>SCONS_ENV</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Переменные для установки в окружении SCons.</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>SCONS_TARGET</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Последний параметр для передачи SCons, похожий на <code>MAKE_TARGET</code>.</p></td></tr></tbody></table><div class=paragraph><p>Для того, чтобы сторонний <span class=filename>SConstruct</span> соответствовал всему, что передается SCons в переменной <code>SCONS_ENV</code> (самое главное, это <code>CC/CXX/CFLAGS/CXXFLAGS</code>), примените патч к <span class=filename>SConstruct</span>, так чтобы переменная построения <code>Environment</code> выглядела следующим образом:</p></div><div class="literalblock programlisting"><div class=content><pre>env = Environment(**ARGUMENTS)</pre></div></div><div class=paragraph><p>В дальнейшем ее можно изменить при помощи <code>env.Append</code> и <code>env.Replace</code>.</p></div></div></div></div><div class=sect1><h2 id=using-autotools>6.5. Использование GNU Autotools<a class=anchor href=#using-autotools></a></h2><div class=sectionbody><div class=sect2><h3 id=using-autotools-introduction>6.5.1. Введение<a class=anchor href=#using-autotools-introduction></a></h3><div class=paragraph><p>Различные инструменты GNU autotools предоставляют механизм абстракции для построения частей программного обеспечения на широком наборе операционных систем и аппаратных архитектур. Внутри Коллекции Портов отдельный порт может использовать эти инструменты при помощи простых конструкций:</p></div><div class="literalblock programlisting"><div class=content><pre>USE_AUTOTOOLS=	tool:version[:operation] ...</pre></div></div><div class=paragraph><p>К моменту написания <em>tool</em> может быть одним из <code>libtool</code>, <code>libltdl</code>, <code>autoconf</code>, <code>autoheader</code>, <code>automake</code> или <code>aclocal</code>.</p></div><div class=paragraph><p><em>version</em> указывает конкретную версию используемого инструмента (смотрите <code>devel/{automake,autoconf,libtool}[0-9]+</code> для получения действительных версий).</p></div><div class=paragraph><p><em>operation</em> является необязательным расширением и указывает на способ использования инструмента.</p></div><div class=paragraph><p>Одновременно может быть указано несколько инструментов, добавляя их все на одной строке или используя конструкцию Makefile <code>+=</code>.</p></div><div class=paragraph><p>В заключение, существует специальный инструмент по называнию <code>autotools</code>, который является удобной функцией при установке всех доступных версий autotools для возможности проведения кросс-разработки. Это также может быть достигнуто путем установки порта <code>devel/autotools</code>.</p></div></div><div class=sect2><h3 id=using-libtool>6.5.2. <code>libtool</code><a class=anchor href=#using-libtool></a></h3><div class=paragraph><p>Динамические библиотеки, использующие инфраструктуру построения GNU, обычно используют libtool для настройки компиляции и установки динамических библиотек в соответствии с особенностями данной операционной системы. В типичной практике используется копирование встроенного в приложение <code>libtool</code>. Если вам нужно использовать внешнюю команду <code>libtool</code>, то вы можете использовать версию, поставляемую Коллекцией Портов:</p></div><div class="literalblock programlisting"><div class=content><pre>USE_AUTOTOOLS=	libtool:version[:env]</pre></div></div><div class=paragraph><p>При отсутствии дополнительных операций, <code>libtool:version</code> сообщает инфраструктуре построения о применении патча к сценарию configure с установленной в системе копией <code>libtool</code>. Означает использование <code>GNU_CONFIGURE</code>. Более того, некоторые переменные make и оболочки shell будут назначены для дальнейшего использования этим портом. Подробности смотрите в <span class=filename>bsd.autotools.mk</span>.</p></div><div class=paragraph><p>При использовании операции <code>:env</code> будет настроено только окружение.</p></div><div class=paragraph><p>Наконец, <code>LIBTOOLFLAGS</code> и <code>LIBTOOLFILES</code> можно установить по желанию, чтобы переопределить наиболее вероятные аргументы для <code>libtool</code> и файлы, предназначенные для изменения. Большинству портов это скорее всего не понадобится. Для дальнейших подробностей смотрите <span class=filename>bsd.autotools.mk</span>.</p></div></div><div class=sect2><h3 id=using-libltdl>6.5.3. <code>libltdl</code><a class=anchor href=#using-libltdl></a></h3><div class=paragraph><p>Некоторые порты задействуют пакет с библиотекой <code>libltdl</code>, которая является частью комплекта <code>libtool</code>. Использование этой библиотеки не вызывает автоматическое использование самой <code>libtool</code>, и, таким образом, обеспечивается отдельная конструкция.</p></div><div class="literalblock programlisting"><div class=content><pre>USE_AUTOTOOLS=	libltdl:version</pre></div></div><div class=paragraph><p>Всё, что в настоящее время она делает, это добавление <code>LIB_DEPENDS</code> для подходящего порта <code>libltdl</code>, потому она предоставляется как удобная функция для помощи в устранении всяких зависимостей от портов autotools вне инфраструктуры <code>USE_AUTOTOOLS</code>. Для этого инструмента не существует необязательных операций.</p></div></div><div class=sect2><h3 id=using-autoconf>6.5.4. <code>autoconf</code> и <code>autoheader</code><a class=anchor href=#using-autoconf></a></h3><div class=paragraph><p>Вместо сценария configure некоторые порты содержат шаблон autoconf в файле <span class=filename>configure.ac</span>. Вы можете использовать следующие присвоения, чтобы позволить <code>autoconf</code> создать сценарий configure, а <code>autoheader</code> создать заголовки шаблона для использования в сценарии configure.</p></div><div class="literalblock programlisting"><div class=content><pre>USE_AUTOTOOLS=	autoconf:version[:env]</pre></div></div><div class=paragraph><p>и</p></div><div class="literalblock programlisting"><div class=content><pre>USE_AUTOTOOLS=	autoheader:version</pre></div></div><div class=paragraph><p>которые также подразумевают использование <code>autoconf:version</code>.</p></div><div class=paragraph><p>Аналогично команде <code>libtool</code> включение необязательной операции <code>:env</code> всего лишь настраивает окружение для дальнейшего использования. Без этого выполняется наложение патчей и переконфигурирование порта.</p></div><div class=paragraph><p>Дополнительные необязательные переменные <code>AUTOCONF_ARGS</code> и <code>AUTOHEADER_ARGS</code> можно переопределить в <span class=filename>Makefile</span> порта, если указано явным образом. Как и с эквивалентами <code>libtool</code>, большинству портов это вряд ли понадобится.</p></div></div><div class=sect2><h3 id=using-automake>6.5.5. <code>automake</code> и <code>aclocal</code><a class=anchor href=#using-automake></a></h3><div class=paragraph><p>Некоторые пакеты содержат только файлы <span class=filename>Makefile.am</span>. Они должны быть преобразованы в файлы <span class=filename>Makefile.in</span> с использованием automake и дальнейшей обработкой <code>configure</code> для получения настоящего <span class=filename>Makefile</span>.</p></div><div class=paragraph><p>Аналогично, иногда пакеты не поставляются с вложенными файлами <span class=filename>aclocal.m4</span>, снова требуемых для построения программного обеспечения. Их можно получить командой <code>aclocal</code>, которая просматривает <span class=filename>configure.ac</span> или <span class=filename>configure.in</span>.</p></div><div class=paragraph><p><code>aclocal</code> имеет похожую связь с <code>automake</code>, как у <code>autoheader</code> с <code>autoconf</code>, что описано в предыдущей главе. <code>aclocal</code> подразумевает использование <code>automake</code>, таким образом, мы имеем:</p></div><div class="literalblock programlisting"><div class=content><pre>USE_AUTOTOOLS=	automake:version[:env]</pre></div></div><div class=paragraph><p>и</p></div><div class="literalblock programlisting"><div class=content><pre>USE_AUTOTOOLS=	aclocal:version</pre></div></div><div class=paragraph><p>которые также подразумевают использование <code>automake:version</code>.</p></div><div class=paragraph><p>Также как и для <code>libtool</code> и <code>autoconf</code>, подключение необязательной операции <code>:env</code> всего лишь устанавливает окружение для дальнейшего пользования. Без этого выполняется реконфигурирование этого порта.</p></div><div class=paragraph><p>Как и в случае с <code>autoconf</code> и <code>autoheader</code>, обе команды <code>automake</code> и <code>aclocal</code> соответственно имеют необязательные переменные <code>AUTOMAKE_ARGS</code> и <code>ACLOCAL_ARGS</code>, которые при необходимости можно переопределить в <span class=filename>Makefile</span> порта.</p></div></div></div></div><div class=sect1><h2 id=using-gettext>6.6. Использование GNU <code>gettext</code><a class=anchor href=#using-gettext></a></h2><div class=sectionbody><div class=sect2><h3 id=_простой_вариант_использования>6.6.1. Простой вариант использования<a class=anchor href=#_простой_вариант_использования></a></h3><div class=paragraph><p>Если для вашего порта требуется <code>gettext</code>, добавьте <code>USES= gettext</code>, и ваш порт унаследует зависимость от <a class=package href=https://cgit.freebsd.org/ports/tree/devel/gettext/>devel/gettext</a>. <a href=../makefiles/#uses-makefiles><code>USES</code></a> содержит перечень других значений для использования <code>gettext</code>.</p></div><div class=paragraph><p>Довольно распространенным случаем является использование в порте <code>gettext</code> и <code>configure</code>. Как правило, GNU <code>configure</code> способен находить <code>gettext</code> автоматически. Если он все же не сможет это сделать, то подсказки для размещения <code>gettext</code> можно передать через переменные окружения <code>CPPFLAGS</code> и <code>LDFLAGS</code>:</p></div><div class="literalblock programlisting"><div class=content><pre>USES=	gettext
CPPFLAGS+=	-I${LOCALBASE}/include
LDFLAGS+=	-L${LOCALBASE}/lib

GNU_CONFIGURE=	yes</pre></div></div><div class=paragraph><p>Конечно же, этот код можно записать в более компактном виде, если передавать флаги в <code>configure</code> не требуется:</p></div><div class="literalblock programlisting"><div class=content><pre>USES=	gettext
GNU_CONFIGURE=	yes</pre></div></div></div><div class=sect2><h3 id=_оптимальное_использование>6.6.2. Оптимальное использование<a class=anchor href=#_оптимальное_использование></a></h3><div class=paragraph><p>Некоторые программные продукты позволяют отключать NLS, к примеру, передавая параметр <code>--disable-nls</code> сценарию <code>configure</code>. В этом случае ваш порт должен использовать <code>gettext</code>, в зависимости от значения <code>NLS</code>. Для портов небольшой или средней сложности вы можете полагаться на следующую идиому:</p></div><div class="literalblock programlisting"><div class=content><pre>GNU_CONFIGURE=	yes

.include &lt;bsd.port.options.mk&gt;

.if ${PORT_OPTIONS:MNLS}
USES+=			gettext
PLIST_SUB+=		NLS=&#34;&#34;
.else
CONFIGURE_ARGS+=	--disable-nls
PLIST_SUB+=		NLS=&#34;@comment &#34;
.endif

.include &lt;bsd.port.mk&gt;</pre></div></div><div class=paragraph><p>Следующий пункт в вашем списке дел разобраться, чтобы файлы каталога сообщения включались в список упаковки по условию. Часть, входящая в <span class=filename>Makefile</span>, уже обеспечена этой идиомой. Остальное объясняется в главе <a href=#plist-sub>продвинутые практики <span class=filename>pkg-plist</span></a>. Вкратце, каждое вхождение <code>%%NLS%%</code> в <span class=filename>pkg-plist</span> будет заменено на “@comment”, если NLS выключен, или пустой строкой, если включен. В результате строки, предваряемые <code>%%NLS%%</code>, станут комментариями в итоговом листе упаковки, если NLS выключен; иначе, префикс будет просто удален. Всё, что вам нужно, это вставить <code>%%NLS%%</code> перед каждым путем к файлу каталога сообщений в <span class=filename>pkg-plist</span>. Например:</p></div><div class="literalblock programlisting"><div class=content><pre>%%NLS%%share/locale/fr/LC_MESSAGES/foobar.mo
%%NLS%%share/locale/no/LC_MESSAGES/foobar.mo</pre></div></div><div class=paragraph><p>В особо сложных случаях вам понадобиться использовать более продвинутые техники, чем данный рецепт, такие как <a href=#plist-dynamic>динамические списки упаковки</a>.</p></div></div><div class=sect2><h3 id=_управление_каталогами_сообщений>6.6.3. Управление каталогами сообщений<a class=anchor href=#_управление_каталогами_сообщений></a></h3><div class=paragraph><p>Существует момент, который следует учитывать при установке файлов каталогов сообщений. Целевые каталоги для размещения, расположенные под <span class=filename>LOCALBASE/shared/locale</span>, редко когда должны создаваться и удаляться портом. Для наиболее популярных языков имеются собственные каталоги, перечисленные в <span class=filename>PORTSDIR/Templates/BSD.local.dist</span>. Каталоги для множества других языков управляются с помощью порта <a class=package href=https://cgit.freebsd.org/ports/tree/devel/gettext/>devel/gettext</a>. Обратите внимание на его <span class=filename>pkg-plist</span> и посмотрите, куда данный порт собирается установить файлы каталогов сообщений для единственного в своем роде языка.</p></div></div></div></div><div class=sect1><h2 id=using-perl>6.7. Использование Perl<a class=anchor href=#using-perl></a></h2><div class=sectionbody><div class=paragraph><p>Если <code>MASTER_SITES</code> установлена в значение <code>MASTER_SITE_PERL_CPAN</code>, то предпочтительным значением <code>MASTER_SITE_SUBDIR</code> является имя иерархии верхнего уровня. Например, рекомендуемым значением для <code>p5-Module-Name</code> является <code>Module</code>. Иерархию верхнего уровня можно посмотреть на сайте <a href=http://cpan.org/modules/by-module/>cpan.org</a>. Это поддерживает порт в рабочем состоянии при изменении модуля автором.</p></div><div class=paragraph><p>Исключением этого правила является отсутствие соответствующего каталога или файла с дистрибутивом в этом каталоге. В качестве <code>MASTER_SITE_SUBDIR</code> в этом случае разрешается использовать id автора.</p></div><div class=paragraph><p>В качестве значения все из настраиваемых knobs ниже принимают <code>YES</code> или строку с версией вида <code>5.8.0+</code>. <code>YES</code> означает, что данный порт можно использовать с любой из поддерживаемых версий Perl. Если порт работает только с некоторыми версиями Perl, то это можно обозначить при помощи строки с версией, указывающей на минимальную версию (пример: <code>5.7.3+</code>), максимальную версию (пример: <code>5.8.0-</code>) или точную версию (пример: <code>5.8.3</code>).</p></div><table class="tableblock frame-none grid-all stretch"><caption class=title>Таблица 6. Переменные для портов, использующих Perl</caption><col style=width:50%><col style=width:50%><thead><tr><th class="tableblock halign-left valign-top">Переменная</th><th class="tableblock halign-left valign-top">Значение</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>USE_PERL5</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Perl 5 используется для построения и работы.</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>USE_PERL5_BUILD</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Perl 5 используется для построения.</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>USE_PERL5_RUN</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Perl 5 используется во время работы.</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>PERL</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Полный путь к интерпретатору Perl 5, либо в системе, либо установленному из портов, но без номера версии. Используйте это, если вам нужно заменить строки “#!” в скриптах.</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>PERL_CONFIGURE</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Конфигурация при помощи MakeMaker языка Perl. Влечёт <code>USE_PERL5</code>.</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>PERL_MODBUILD</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Конфигурация, построение и установка с использованием Module::Build. Влечёт <code>PERL_CONFIGURE</code>.</p></td></tr></tbody></table><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Порты для модулей Perl, которые не имеют официального вебсайта, должны указывать <code>cpan.org</code> в строке WWW в файле <span class=filename>pkg-descr</span>. Предпочтительная форма URL <code><a href=http://search.cpan.org/dist/Module-Name/ class=bare>http://search.cpan.org/dist/Module-Name/</a></code> (включая завершающий слэш).</p></div></td></tr></tbody></table></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Не используйте <code>${SITE_PERL}</code> в объявлении зависимостей. Использование этой конструкции подразумевает наличие подключенного <span class=filename>bsd.perl.mk</span>, что не всегда так. Порты, зависимые от этого порта, получат неправильные зависимости, если файлы этого порта будут перемещены при последующем обновлении. Правильный способ объявления зависимостей для модулей Perl показан в примере ниже.</p></div></td></tr></tbody></table></div><div id=use-perl-dependency-example class=exampleblock><div class=title>Пример 2. Пример зависимости Perl</div><div class=content><div class="literalblock programlisting"><div class=content><pre>p5-IO-Tee&gt;=0.64:${PORTSDIR}/devel/p5-IO-Tee</pre></div></div></div></div><div class=paragraph><p>Для портов Perl, которые устанавливают страницы справочника, в <span class=filename>pkg-plist</span> можно использовать макрос <code>PERL5_MANx</code> (где <em>x</em> принимает значение от <code>1</code> до <code>9</code>). Например,</p></div><div class="literalblock programlisting"><div class=content><pre>lib/perl5/5.14/man/man3/AnyEvent::I3.3.gz</pre></div></div><div class=paragraph><p>можно заменить на</p></div><div class="literalblock programlisting"><div class=content><pre>%%PERL5_MAN3%%/AnyEvent::I3.3.gz</pre></div></div></div></div><div class=sect1><h2 id=using-x11>6.8. Использование X11<a class=anchor href=#using-x11></a></h2><div class=sectionbody><div class=sect2><h3 id=x11-variables>6.8.1. Компоненты X.Org<a class=anchor href=#x11-variables></a></h3><div class=paragraph><p>X.Org является реализацией X11, доступной в Коллекции Портов. Если ваше приложение зависит от компонентов X, установите в переменную <code>USE_XORG</code> в перечень требуемых компонентов. К настоящему времени доступными компонентами являются:</p></div><div class=paragraph><p><code>bigreqsproto compositeproto damageproto dmx dmxproto dri2proto evieproto fixesproto fontcacheproto fontenc fontsproto fontutil glproto ice inputproto kbproto libfs oldx pciaccess pixman printproto randrproto recordproto renderproto resourceproto scrnsaverproto sm trapproto videoproto x11 xau xaw xaw6 xaw7 xbitmaps xcmiscproto xcomposite xcursor xdamage xdmcp xevie xext xextproto xf86bigfontproto xf86dgaproto xf86driproto xf86miscproto xf86rushproto xf86vidmodeproto xfixes xfont xfontcache xft xi xinerama xineramaproto xkbfile xkbui xmu xmuu xorg-server xp xpm xprintapputil xprintutil xproto xproxymngproto xrandr xrender xres xscrnsaver xt xtrans xtrap xtst xv xvmc xxf86dga xxf86misc xxf86vm</code>.</p></div><div class=paragraph><p>Всегда актуальный перечень можно найти в <span class=filename>/usr/ports/Mk/bsd.xorg.mk</span>.</p></div><div class=paragraph><p>Проект Mesa является попыткой обеспечить свободную реализацию OpenGL. Вы можете указать зависимость от различных компонентов этого проекта при помощи переменной <code>USE_GL</code>. Действительные опции: <code>glut, glu, glw, glew, gl</code> и <code>linux</code>. Для обратной совместимости значение <code>yes</code> соответствует <code>glu</code>.</p></div><div id=use-xorg-example class=exampleblock><div class=title>Пример 3. Пример для USE_XORG</div><div class=content><div class="literalblock programlisting"><div class=content><pre>USE_XORG=	xrender xft xkbfile xt xaw
USE_GL=		glu</pre></div></div></div></div><table class="tableblock frame-none grid-all stretch"><caption class=title>Таблица 7. Переменные для портов, использующих X</caption><col style=width:50%><col style=width:50%><tbody><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>USES= imake</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Используется <code>imake</code>.</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>XMKMF</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Задаёт маршрут до <code>xmkmf</code>, если он отсутствует в <code>PATH</code>. По умолчанию это <code>xmkmf -a</code>.</p></td></tr></tbody></table><div id=using-x11-vars class=exampleblock><div class=title>Пример 4. Использование переменных X11 в порте</div><div class=content><div class="literalblock programlisting"><div class=content><pre># Использовать некоторые библиотеки X11
USE_XORG=	x11 xpm</pre></div></div></div></div></div><div class=sect2><h3 id=porting-motif>6.8.2. Порты, которым требуется Motif<a class=anchor href=#porting-motif></a></h3><div class=paragraph><p>Если вашему порту требуется Motif, задайте переменную <code>USES= motif</code> в файле <span class=filename>Makefile</span>. Реализация Motif, используемая по умолчанию, находится в <a class=package href=https://cgit.freebsd.org/ports/tree/x11-toolkits/open-motif/>x11-toolkits/open-motif</a>. Пользователи вместо этого могут выбрать <a class=package href=https://cgit.freebsd.org/ports/tree/x11-toolkits/lesstif/>x11-toolkits/lesstif</a> через установку переменной <code>WANT_LESSTIF</code>.</p></div><div class=paragraph><p>Переменная <code>MOTIFLIB</code> будет установлена в <span class=filename>bsd.port.mk</span>, чтобы ссылаться на соответствующую библиотеку Motif. Пожалуйста, измените исходные тексты вашего порта на использование <code>${MOTIFLIB}</code> везде, где упоминается библиотека Motif, в первоначальном <span class=filename>Makefile</span> или <span class=filename>Imakefile</span>.</p></div><div class=paragraph><p>Существует два общих случая:</p></div><div class=ulist><ul><li><p>Если порт обращается к библиотеке Motif как <code>-lXm</code> в своих файлах <span class=filename>Makefile</span> или <span class=filename>Imakefile</span>, просто подставьте вместо этих обращений <code>${MOTIFLIB}</code>.</p></li><li><p>Если порт использует <code>XmClientLibs</code> в своем файле <span class=filename>Imakefile</span>, измените это обращение на <code>${MOTIFLIB} ${XTOOLLIB} ${XLIB}</code>.</p></li></ul></div><div class=paragraph><p>Заметьте, что переменная <code>MOTIFLIB</code> (как правило) раскрывается в <code>-L/usr/local/lib -lXm</code> или <code>/usr/local/lib/libXm.a</code>, так что нет нужды впереди добавлять <code>-L</code> или <code>-l</code>.</p></div></div><div class=sect2><h3 id=_шрифты_для_x11>6.8.3. Шрифты для X11<a class=anchor href=#_шрифты_для_x11></a></h3><div class=paragraph><p>Если ваш порт устанавливает шрифты для X Window System, поместите их в каталог <span class=filename>LOCALBASE/lib/X11/fonts/local</span>.</p></div></div><div class=sect2><h3 id=_получение_поддельного_display_используя_xvfb>6.8.4. Получение поддельного <code>DISPLAY</code>, используя Xvfb<a class=anchor href=#_получение_поддельного_display_используя_xvfb></a></h3><div class=paragraph><p>Некоторые приложения для успешной компиляции требуют наличие работающего дисплея X11. Это создает проблему для машин, которые работают в режиме headless. При использовании следующего канонического хака инфраструктура построения запустит сервер X в виртуальном фреймбуфере. Затем переменная работающего <code>DISPLAY</code> передается при построении.</p></div><div class="literalblock programlisting"><div class=content><pre>USES=	display</pre></div></div></div><div class=sect2><h3 id=desktop-entries>6.8.5. Элементы рабочего стола<a class=anchor href=#desktop-entries></a></h3><div class=paragraph><p>Элементы рабочего стола (<a href=http://standards.freedesktop.org/desktop-entry-spec/latest/>стандарта Freedesktop</a>) предоставляют способ автоматической настройки функций рабочего стола при установке новой программы, не требуя вмешательства пользователя. Например, новые программы автоматически отображаются в меню приложений совместимых окружений рабочего стола. Элементы рабочего стола изначально появились в окружении рабочего стола GNOME, но в настоящее время являются стандартом и также работают с KDE и Xfce. Такая небольшая автоматизация предоставляет реальное удобство для пользователя, и посему элементы рабочего стола приветствуются в приложениях, которые можно использовать в окружении рабочего стола.</p></div><div class=sect3><h4 id=_использование_предопределенных_файлов_desktop>6.8.5.1. Использование предопределенных файлов <span class=filename>.desktop</span><a class=anchor href=#_использование_предопределенных_файлов_desktop></a></h4><div class=paragraph><p>Порты, включающие предопределенные файлы <span class=filename>*.desktop</span>, должны включать эти файлы в <span class=filename>pkg-plist</span> и устанавливать их в каталог <span class=filename>$LOCALBASE/shared/applications</span>. Для установки этих файлов используется <a href=#install-macros>макрос <code>INSTALL_DATA</code></a>.</p></div></div><div class=sect3><h4 id=updating-desktop-database>6.8.5.2. Обновление базы данных рабочего стола<a class=anchor href=#updating-desktop-database></a></h4><div class=paragraph><p>Если в файле порта <span class=filename>portname.desktop</span> имеется запись MimeType, то база данных рабочего стола олжна быть обновлена после установки и удаления. Для этого укажите <code>USES</code>= desktop-file-utils.</p></div></div><div class=sect3><h4 id=desktop-entries-macro>6.8.5.3. Создание элементов рабочего стола с использованием <code>DESKTOP_ENTRIES</code><a class=anchor href=#desktop-entries-macro></a></h4><div class=paragraph><p>Элементы рабочего стола можно легко создавать для приложений, используя переменную <code>DESKTOP_ENTRIES</code>. Будет автоматически создан, установлен и добавлен в <span class=filename>pkg-plist</span> файл с названием <span class=filename>name.desktop</span>. Синтаксис:</p></div><div class="literalblock programlisting"><div class=content><pre>DESKTOP_ENTRIES=	&#34;NAME&#34; &#34;COMMENT&#34; &#34;ICON&#34; &#34;COMMAND&#34; &#34;CATEGORY&#34; StartupNotify</pre></div></div><div class=paragraph><p>Перечень возможных категорий доступен на <a href=http://standards.freedesktop.org/menu-spec/latest/apa.html>вебсайте Freedesktop</a>. <code>StartupNotify</code> отобразит, поддерживает ли приложение <em>уведомления о запуске</em>. Как правило, это графический индикатор часы вместо указателя мыши, меню или панель, которые уведомляют пользователя о загрузке программы. Программа, поддерживающая уведомления о запуске, очистит этот индикатор после запуска. Программы, несовместимые с уведомлениями о запуске, не будут очищать индикатор (возможно, вызывая путаницу и приводя пользователей в бешенство), и поэтому должны иметь <code>StartupNotify</code> в выключенном состоянии <code>false</code>; тогда индикатор не будет отображаться совсем.</p></div><div class=paragraph><p>Пример:</p></div><div class="literalblock programlisting"><div class=content><pre>DESKTOP_ENTRIES=	&#34;ToME&#34; &#34;Roguelike game based on JRR Tolkien&#39;s work&#34; \
			&#34;${DATADIR}/xtra/graf/tome-128.png&#34; \
			&#34;tome -v -g&#34; &#34;Application;Game;RolePlaying;&#34; \
			false</pre></div></div></div></div></div></div><div class=sect1><h2 id=using-gnome>6.9. Использование GNOME<a class=anchor href=#using-gnome></a></h2><div class=sectionbody><div class=paragraph><p>Для задания того, какие компоненты GNOME использует конкретный порт, проект FreeBSD/GNOME использует собственный набор переменных. На странице проекта FreeBSD/GNOME размещён <a href=http://www.FreeBSD.org/gnome/docs/porting/>исчерпывающий список этих переменных</a>.</p></div></div></div><div class=sect1><h2 id=using-qt>6.10. Использование Qt<a class=anchor href=#using-qt></a></h2><div class=sectionbody><div class=sect2><h3 id=qt-common>6.10.1. Порты, для которых требуется Qt<a class=anchor href=#qt-common></a></h3><table class="tableblock frame-none grid-all stretch"><caption class=title>Таблица 8. Переменные для портов, использующих Qt</caption><col style=width:50%><col style=width:50%><tbody><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>USE_QT4</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Указывает инструменты и библиотеки в качестве зависимостей для портов, которые используют Qt 4. Для получения подробностей смотрите <a href=#qt4-components>выбор компонентов Qt 4</a>.</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>QT_PREFIX</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Устанавливается в значение, содержащее путь к установленному Qt (переменная только для чтения).</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>MOC</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Устанавливается в значение, содержащее путь к <code>moc</code> (переменная только для чтения). По умолчанию устанавливается в соответствии со значением <code>USE_QT_VER</code>.</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>QTCPPFLAGS</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Дополнительные флаги компилятора для инструментального пакета Qt, передаваемые через переменную <code>CONFIGURE_ENV</code>. По умолчанию устанавливается в соответствии со значением <code>USE_QT_VER</code>.</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>QTCFGLIBS</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Дополнительные флаги компоновки для инструментального пакета Qt, передаваемые через переменную <code>CONFIGURE_ENV</code>. По умолчанию устанавливается в соответствии со значением <code>USE_QT_VER</code>.</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>QTNONSTANDARD</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Подавляет изменение <code>CONFIGURE_ENV</code>, <code>CONFIGURE_ARGS</code>, <code>CPPFLAGS</code> и <code>MAKE_ENV</code>.</p></td></tr></tbody></table><table class="tableblock frame-none grid-all stretch"><caption class=title>Таблица 9. Дополнительные переменные для портов, использующих Qt 4.x</caption><col style=width:50%><col style=width:50%><tbody><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>UIC</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Устанавливает путь к <code>uic</code> (переменная только для чтения).</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>QMAKE</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Устанавливает путь к <code>qmake</code> (переменная только для чтения).</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>QMAKESPEC</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Устанавливает путь к конфигурационному файлу для <code>qmake</code> (переменная только для чтения).</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>QMAKEFLAGS</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Дополнительные флаги для <code>qmake</code>.</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>QT_INCDIR</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Устанавливает каталоги для заголовков Qt 4 (переменная только для чтения).</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>QT_LIBDIR</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Устанавливает путь к библиотекам Qt 4 (переменная только для чтения).</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>QT_PLUGINDIRC</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Устанавливает путь к плагинам Qt 4 (переменная только для чтения).</p></td></tr></tbody></table><div class=paragraph><p>При заданной переменной <code>USE_QT4</code> применяются следующие настройки:</p></div><div class="literalblock programlisting"><div class=content><pre>CONFIGURE_ARGS+=	--with-qt-includes=${QT_INCDIR} \
			--with-qt-libraries=${QT_LIBDIR} \
			--with-extra-libs=${LOCALBASE}/lib \
			--with-extra-includes=${LOCALBASE}/include
CONFIGURE_ENV+=	MOC=&#34;${MOC}&#34; UIC=&#34;${UIC}&#34; LIBS=&#34;${QTCFGLIBS}&#34; \
		QMAKE=&#34;${QMAKE}&#34; QMAKESPEC=&#34;${QMAKESPEC}&#34; QTDIR=&#34;${QT_PREFIX}&#34;
MAKE_ENV+=	QMAKESPEC=&#34;${QMAKESPEC}&#34;

PLIST_SUB+=	QT_INCDIR_REL=${QT_INCDIR_REL} \
		QT_LIBDIR_REL=${QT_LIBDIR_REL} \
		QT_PLUGINDIR_REL=${QT_PLUGINDIR_REL}</pre></div></div></div><div class=sect2><h3 id=qt4-components>6.10.2. Выбор компонентов<a class=anchor href=#qt4-components></a></h3><div class=paragraph><p>В переменной <code>USE_QT4</code> должны указываться зависимости от отдельных инструментов и библиотек Qt 4. К каждому компоненту можно добавить суффикс, <code>_build</code> или <code>_run</code>, отражающий, когда должна быть применена зависимость, во время сборки или выполнения, соответственно. Если суффикс отсутствует, зависимость от компонента будет и для времени сборки, и для времени выполнения. Обычно, компоненты библиотек должны указываться без суффиксов, компоненты инструментов - с суффиксом <code>_build</code>, а компоненты плагинов - с суффиксом <code>_run</code>. Наиболее общие используемые компоненты перечислены ниже (все доступные компоненты перечислены в <code>_USE_QT4_ALL</code> в файле <span class=filename>/usr/ports/Mk/bsd.qt.mk</span>):</p></div><table class="tableblock frame-none grid-all stretch"><caption class=title>Таблица 10. Доступные библиотечные компоненты Qt 4</caption><col style=width:50%><col style=width:50%><thead><tr><th class="tableblock halign-left valign-top">Название</th><th class="tableblock halign-left valign-top">Описание</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>corelib</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>основная библиотека (можно опустить, если порт не использует ничего, кроме <code>corelib</code>)</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>gui</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>библиотека графического пользовательского интерфейса</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>network</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>сетевая библиотека</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>opengl</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>библиотека OpenGL</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>qt3support</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>библиотека совместимости с Qt 3</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>qtestlib</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>библиотека модульного тестирования</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>script</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>библиотека сценариев</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>sql</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>библиотека SQL</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>xml</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>библиотека XML</p></td></tr></tbody></table><div class=paragraph><p>Вы можете определить, от каких библиотек зависит приложение, запустив <code>ldd</code> на основной исполняемый файл после успешной компиляции.</p></div><table class="tableblock frame-none grid-all stretch"><caption class=title>Таблица 11. Доступные компоненты инструментов Qt 4</caption><col style=width:50%><col style=width:50%><thead><tr><th class="tableblock halign-left valign-top">Название</th><th class="tableblock halign-left valign-top">Описание</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>moc</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>мета-объектный компилятор (нужен при построении почти для каждого приложения Qt)</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>qmake</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>генератор Makefile / утилита построения</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>rcc</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>компилятор ресурсов (нужен, если приложение идет вместе с файлами <span class=filename><strong>.rc</strong></span><strong> или <span class=filename></span></strong>.qrc)</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>uic</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>компилятор пользовательского интерфейса (нужен, если приложение идет вместе с файлами <span class=filename>*.ui</span>, созданными при помощи Qt Designer, - на практике каждое приложение Qt с GUI)</p></td></tr></tbody></table><table class="tableblock frame-none grid-all stretch"><caption class=title>Таблица 12. Доступные компоненты плагинов Qt 4</caption><col style=width:50%><col style=width:50%><thead><tr><th class="tableblock halign-left valign-top">Название</th><th class="tableblock halign-left valign-top">Описание</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>iconengines</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>плагин для движка иконок SVG (если приложение поставляется с иконками SVG)</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>imageformats</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>плагины для графических форматов GIF, JPEG, MNG и SVG (если приложение поставляется с графическими файлами)</p></td></tr></tbody></table><div id=qt4-components-example class=exampleblock><div class=title>Пример 5. Выбор компонентов Qt 4</div><div class=content><div class=paragraph><p>В этом примере портированное приложение использует библиотеку графического пользовательского интерфейса Qt 4, основную библиотеку Qt 4, все инструменты генерации кода Qt 4 и генератор Makefile Qt 4. Поскольку библиотека <code>gui</code> подразумевает зависимость от основной библиотеки, указывать <code>corelib</code> нет необходимости. Инструменты генерации кода Qt 4 <code>moc</code>, <code>uic</code> и <code>rcc</code>, а также генератор Makefile <code>qmake</code> нужны только для времени построения, поэтому они указаны с суффиксом <code>_build</code>:</p></div><div class="literalblock programlisting"><div class=content><pre>USE_QT4=	gui moc_build qmake_build rcc_build uic_build</pre></div></div></div></div></div><div class=sect2><h3 id=using-qmake>6.10.3. Использование <code>qmake</code><a class=anchor href=#using-qmake></a></h3><table class="tableblock frame-none grid-all stretch"><caption class=title>Таблица 13. Переменные для портов, использующих <code>qmake</code></caption><col style=width:50%><col style=width:50%><thead><tr><th class="tableblock halign-left valign-top">Название</th><th class="tableblock halign-left valign-top">Описание</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>QMAKE_ARGS</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Спефицичные для порта флаги QMake для передачи программе <code>qmake</code>.</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>QMAKE_ENV</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Переменные окружения, устанавливаемые для программы <code>qmake</code>. По умолчанию соответствует значению <code>${CONFIGURE_ENV}</code>.</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>QMAKE_PRO</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Название файла проекта <span class=filename>.pro</span>. По умолчанию имеет пустое значение (с использованием автоопределения).</p></td></tr></tbody></table><div class=paragraph><p>Если вместе с приложением вместо <span class=filename>configure</span> поставляется файл <span class=filename>.pro</span>, вы можете использовать следующее:</p></div><div class="literalblock programlisting"><div class=content><pre>USES=	qmake
USE_QT4=	qmake_build</pre></div></div><div class=paragraph><p><code>USES=qmake</code> указывает порту на использование <code>qmake</code> в процессе конфигурации. Обратите внимание, что <code>USES=qmake</code> не подразумевает зависимость от Qt 4 <code>qmake</code>. Для этого в значении <code>USE_QT4</code> должен присутствовать компонент <code>qmake_build</code>.</p></div><div class=paragraph><p>Приложения Qt часто пишутся в кроссплатформенной манере, и X11/Unix часто не является для них платформой разработки, что в свою очередь часто приводит к соответствующим упущенным моментам:</p></div><div class=ulist><ul><li><p><em>Отсутствующие дополнительные пути для заголовочных файлов.</em> Многие приложения идут с поддержкой иконки в системном трее, но пренебрегают смотреть на наличие заголовочных файлов и/или библиотеками в каталогах X11. Вы можете сообщить <code>qmake</code>, чтобы она добавила каталоги в пути поиска заголовочных файлов и библиотек через командную строку. К примеру:</p><div class="literalblock programlisting"><div class=content><pre>QMAKE_ARGS+= INCLUDEPATH+=${LOCALBASE}/include \
	LIBS+=-L${LOCALBASE}/lib</pre></div></div></li><li><p><em>Фиктивные пути установки.</em> Иногда данные, такие как иконки и файлы .desktop, устанавливаются по умолчанию в каталоги, которые не просматриваются XDG-совместимыми приложениями. Примером является <a class=package href=https://cgit.freebsd.org/ports/tree/editors/texmaker/>editors/texmaker</a> - взгляните на <span class=filename>patch-texmaker.pro</span> из каталога <span class=filename>files</span> этого порта, который можно взять в качестве шаблона исправления этого непосредственно в файле проекта <code>qmake</code>.</p></li></ul></div></div></div></div><div class=sect1><h2 id=using-kde>6.11. Использование KDE<a class=anchor href=#using-kde></a></h2><div class=sectionbody><div class=sect2><h3 id=kde4-variables>6.11.1. Задание переменных KDE 4<a class=anchor href=#kde4-variables></a></h3><div class=paragraph><p>Если ваше приложение зависит от KDE 4.x, присвойте <code>USE_KDE4</code> список требуемых компонентов. Для переопределения типа зависимости компонента могут быть использованы суффиксы <code>_build</code> и <code>_run</code> (например, <code>baseapps_run</code>). Если суффикс не задан, будет использован тип зависимости по умолчанию. Если вы хотите использовать оба типа, добавьте компонент дважды с обоими суффиксами (например, <code>automoc4_build automoc4_run</code>). Основные наиболее используемые компоненты перечислены ниже (актуальные компоненты задокументированы в начале файла <span class=filename>/usr/ports/Mk/bsd.kde4.mk</span>):</p></div><table class="tableblock frame-none grid-all stretch"><caption class=title>Таблица 14. Доступные компоненты KDE 4</caption><col style=width:50%><col style=width:50%><thead><tr><th class="tableblock halign-left valign-top">Название</th><th class="tableblock halign-left valign-top">Описание</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>kdehier</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Иерархия основных каталогов KDE</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>kdelibs</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>KDE Developer Platform</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>kdeprefix</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Если установлено, то порт будет установлен в <code>${KDE4_PREFIX}</code> вместо <code>${LOCALBASE}</code></p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>sharedmime</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>База данных MIME типов для портов KDE</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>automoc4</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>automoc для пакетов Qt 4</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>akonadi</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Сервер хранения KDE-Pim</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>soprano</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Фреймворк Qt 4 RDF</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>strigi</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Поисковые даемон рабочего стола</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>libkcddb</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Библиотека KDE CDDB</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>libkcompactdisc</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Библиотека KDE для взаимодействия с аудио-CD</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>libkdeedu</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Библиотеки, используемые для образовательных приложений</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>libkdcraw</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Библиотека KDE LibRaw</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>libkexiv2</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Библиотека KDE Exiv2</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>libkipi</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>KDE Image Plugin Interface</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>libkonq</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Основная библиотека Konqueror</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>libksane</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Библиотека KDE SANE ("Scanner Access Now Easy")</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>pimlibs</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Библиотеки KDE-Pim</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>kate</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Тектовый редактор</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>marble</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Виртуальный глобус</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>okular</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Универсальный просмотрщик документов</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>korundum</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Привязка Ruby к KDE</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>perlkde</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Привязка Perl к KDE</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>pykde4</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Привязка Python к KDE</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>pykdeuic4</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Компилятор пользовательского интерфейса PyKDE</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>smokekde</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Библиотеки KDE SMOKE</p></td></tr></tbody></table><div class=paragraph><p>Порты KDE 4.x устанавливаются в <code>KDE4_PREFIX</code>, что в настоящее время соответствует <span class=filename>/usr/local/kde4</span>. Это достигается путем указания компонента <code>kdeprefix</code>, который определяет значение по умолчанию для <code>PREFIX</code>. Тем не менее, порты учитывают любые <code>PREFIX</code>, установленные через переменную окружения <code>MAKEFLAGS</code> и/или параметры <code>make</code>.</p></div><div id=kde4-components-example class=exampleblock><div class=title>Пример 6. Пример <code>USE_KDE4</code></div><div class=content><div class=paragraph><p>Это простой пример для порта KDE 4. <code>USES= cmake:outsource</code> указывает порту использовать CMake, конфигурационный инструмент, широко применяемый в проектах KDE 4 (подробное описание даёт <a href=#using-cmake>Использование <code>cmake</code></a>). <code>USE_KDE4</code> добавляет зависимость от библиотек KDE и заставляет порты использовать <code>automoc4</code> во время сборки. Требуемые компоненты KDE и другие зависимости можно определить в журнале configure. <code>USE_KDE4</code> не подразумевает <code>USE_QT4</code>. Если порт требует какой-либо из компонентов Qt 4, их следует указать в <code>USE_QT4</code>.</p></div><div class="literalblock programlisting"><div class=content><pre>USES=		cmake:outsource
USE_KDE4=	kdelibs kdeprefix automoc4
USE_QT4=	moc_build qmake_build rcc_build uic_build</pre></div></div></div></div></div></div></div><div class=sect1><h2 id=using-java>6.12. Использование Java<a class=anchor href=#using-java></a></h2><div class=sectionbody><div class=sect2><h3 id=java-variables>6.12.1. Задание переменных<a class=anchor href=#java-variables></a></h3><div class=paragraph><p>Если вашему порту необходимо наличие Java™ Development Kit (JDK™) для построения, работы или даже распаковки дистрибутивного файла, то в нём должна быть задана переменная <code>USE_JAVA</code>.</p></div><div class=paragraph><p>В Коллекции Портов присутствуют несколько JDK различных разработчиков и разных версий. Если ваш порт должен использовать одну из этих версий, то вы должны указать, какую именно. Самой последней версией и версией по умолчанию является <a class=package href=https://cgit.freebsd.org/ports/tree/java/openjdk6/>java/openjdk6</a>.</p></div><table class="tableblock frame-none grid-all stretch"><caption class=title>Таблица 15. Переменные, которые которые могут задаваться портами, использующими Java</caption><col style=width:50%><col style=width:50%><thead><tr><th class="tableblock halign-left valign-top">Переменная</th><th class="tableblock halign-left valign-top">Значение</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>USE_JAVA</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Должна быть определена для того, что последующие переменные вступили в действие.</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>JAVA_VERSION</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Список версий Java, перечисленных через пробел, подходящих для порта. Опциональный знак <code>""` позволяет вам указать диапазон версий (возможные значения: `1.5[] 1.6[] 1.7[]</code>).</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>JAVA_OS</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Список операционных систем, перечисленных через пробел, порты JDK для которых подходят для порта (возможные значения: <code>native linux</code>).</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>JAVA_VENDOR</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Список разработчиков портов JDK, перечисленных через пробел, которые подходят для порта (возможные значения: <code>freebsd bsdjava sun openjdk</code>).</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>JAVA_BUILD</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Если задана, то означает, что выбранный порт JDK должен быть добавлен к зависимостям порта для его построения.</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>JAVA_RUN</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Если задана, то означает, что выбранный порт JDK должен быть добавлен в зависимостям порта для его работы.</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>JAVA_EXTRACT</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Если задана, то означает, что выбранный порт JDK должен быть добавлен в зависимостям порта для распаковки его дистрибутивных файлов.</p></td></tr></tbody></table><div class=paragraph><p>Ниже перечисляются все значения, которые принимают переменные после задания переменной <code>USE_JAVA</code>:</p></div><table class="tableblock frame-none grid-all stretch"><caption class=title>Таблица 16. Переменные, доступные в портах, использующих Java</caption><col style=width:50%><col style=width:50%><thead><tr><th class="tableblock halign-left valign-top">Переменная</th><th class="tableblock halign-left valign-top">Значение</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>JAVA_PORT</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Название порта JDK (к примеру, <code>'java/openjdk6'</code>).</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>JAVA_PORT_VERSION</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Полное наименовании версии порта JDK (к примеру, <code>'1.6.0'</code>). Если вам нужны только первые две цифры номера версии, используйте <code>${JAVA_PORT_VERSION:C/^([0-9])\.([0-9])(.*)$/\1.\2/}</code>.</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>JAVA_PORT_OS</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Операционная система, используемая портом JDK (к примеру, <code>'native'</code>).</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>JAVA_PORT_VENDOR</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Разработчик порта JDK (к примеру, <code>'openjdk'</code>).</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>JAVA_PORT_OS_DESCRIPTION</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Описание операционной системы, используемой портом JDK (к примеру, <code>'Native'</code>).</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>JAVA_PORT_VENDOR_DESCRIPTION</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Описание разработчика порта JDK (к примеру, <code>'OpenJDK BSD Porting Team'</code>).</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>JAVA_HOME</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Маршрут к установочному каталогу JDK (к примеру, <span class=filename>'/usr/local/openjdk6'</span>).</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>JAVAC</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Маршрут к используемому компилятору Java (к примеру, <span class=filename>'/usr/local/openjdk6/bin/javac'</span>.</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>JAR</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Маршрут к используемой утилите <code>jar</code> (к примеру, <span class=filename>'/usr/local/openjdk6/bin/jar'</span> или <span class=filename>'/usr/local/bin/fastjar'</span>).</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>APPLETVIEWER</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Маршрут к утилите <code>appletviewer</code> (к примеру, <span class=filename>'/usr/local/openjdk6/bin/appletviewer'</span>).</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>JAVA</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Маршрут к выполняемому файлу <code>java</code>. Используйте его для запуска Java-программ (к примеру, <span class=filename>'/usr/local/openjdk6/bin/java'</span>).</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>JAVADOC</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Маршрут к вспомогательной программе <code>javadoc</code>.</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>JAVAH</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Маршрут к программе <code>javah</code>.</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>JAVAP</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Маршрут к программе <code>javap</code>.</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>JAVA_KEYTOOL</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Маршрут к вспомогательной программе <code>keytool</code>.</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>JAVA_N2A</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Маршрут к утилите <code>native2ascii</code>.</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>JAVA_POLICYTOOL</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Маршрут к программе <code>policytool</code>.</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>JAVA_SERIALVER</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Маршрут к вспомогательной программе <code>serialver</code>.</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>RMIC</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Маршрут к генератору каркаса программ RMI, утилите <code>rmic</code>.</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>RMIREGISTRY</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Маршрут к программе регистрации RMI, <code>rmiregistry</code>.</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>RMID</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Маршрут к программе-даемону RMI <code>rmid</code>.</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>JAVA_CLASSES</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Маршрут к архиву, который содержит файлы классов JDK, <span class=filename>${JAVA_HOME}/jre/lib/rt.jar</span>.</p></td></tr></tbody></table><div class=paragraph><p>Вы можете воспользоваться make-целью <code>java-debug</code> для получения информации, необходимой для отладки вашего порта. При её выполнении будут выданы значения многих упомянутых выше переменных.</p></div><div class=paragraph><p>Кроме того, для единообразия установки всех портов Java определены следующие константы:</p></div><table class="tableblock frame-none grid-all stretch"><caption class=title>Таблица 17. Константы, определённые для портов, использующих Java</caption><col style=width:50%><col style=width:50%><thead><tr><th class="tableblock halign-left valign-top">Константа</th><th class="tableblock halign-left valign-top">Значение</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>JAVASHAREDIR</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Корневой каталог для всего, что связано с Java. По умолчанию: <span class=filename>${PREFIX}/shared/java</span>.</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>JAVAJARDIR</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Каталог, в который должны устанавливаться JAR-файлы. По умолчанию: <span class=filename>${JAVASHAREDIR}/classes</span>.</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>JAVALIBDIR</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Каталог, в который устанавливаются JAR-файлы из других портов. По умолчанию: <span class=filename>${LOCALBASE}/shared/java/classes</span>.</p></td></tr></tbody></table><div class=paragraph><p>Соответствующие записи определяются в обоих переменных <code>PLIST_SUB</code> (описана в <a href=../plist/#plist-sub>Изменение содержимого pkg-plist в зависимости от make-переменных</a>) и <code>SUB_LIST</code>.</p></div></div><div class=sect2><h3 id=java-building-with-ant>6.12.2. Построение с Ant<a class=anchor href=#java-building-with-ant></a></h3><div class=paragraph><p>Если построение порта производится с использованием Apache Ant, то необходимо определить <code>USE_ANT</code>. Таким образом Ant становится подкомандой make. Если в порте не определена цель <code>do-build</code>, то будет установлена цель по умолчанию, которая просто запускает Ant в соответствии со значением <code>MAKE_ENV</code>, <code>MAKE_ARGS</code> и <code>ALL_TARGET</code>. Это похоже на механизм <code>USES= gmake</code>, который описан в <a href=#building>Механизмы построения</a>.</p></div></div><div class=sect2><h3 id=java-best-practices>6.12.3. Практические рекомендации<a class=anchor href=#java-best-practices></a></h3><div class=paragraph><p>При портировании Java-библиотеки ваш порт должен устанавливать JAR-файл(ы) в каталог <span class=filename>${JAVAJARDIR}</span>, а все остальные данные в каталог <span class=filename>${JAVASHAREDIR}/${PORTNAME}</span> (за исключением документации, о которой пойдёт речь ниже). Для уменьшения размера упакованного файла вы можете сослаться на JAR-файл(ы) непосредственно в файле <span class=filename>Makefile</span>. Просто воспользуйтесь следующей директивой (в которой <span class=filename>myport.jar</span> является именем JAR-файла, устанавливаемого как часть порта):</p></div><div class="literalblock programlisting"><div class=content><pre>PLIST_FILES+=	%%JAVAJARDIR%%/myport.jar</pre></div></div><div class=paragraph><p>При портировании Java-приложения порт обычно устанавливает всё в один каталог (в том числе все свои JAR-зависимости). В этом отношении настоятельно рекомендуется использование <span class=filename>${JAVASHAREDIR}/${PORTNAME}</span>. На усмотрение создателя порта остаётся решение вопроса о том, устанавливать ли дополнительные JAR-зависимости в этот каталог или напрямую использовать уже установленные (из каталога <span class=filename>${JAVAJARDIR}</span>).</p></div><div class=paragraph><p>При портировании приложения Java™, для запуска сервиса которого требуется сервер приложений, такой как <a class=package href=https://cgit.freebsd.org/ports/tree/www/tomcat7/>www/tomcat7</a>, для производителя в порядке вещей является распространение файла <span class=filename>.war</span>. Файл <span class=filename>.war</span> - это Веб-приложение АРхивированное и оно распаковывается при вызове данным приложением. Избегайте добавлять файлы <span class=filename>.war</span> в <span class=filename>pkg-plist</span>. Это не является наилучшим решением. Сервер приложений производит расширение архива <span class=filename>war</span> без должной его очистки при удалении порта. Более подходящим способом работы с этим файлом будет распаковать архив, установить файлы и добавить их в <span class=filename>pkg-plist</span>.</p></div><div class="literalblock programlisting"><div class=content><pre>TOMCATDIR=	${LOCALBASE}/apache-tomcat-7.0
WEBAPPDIR=	myapplication

post-extract:
	@${MKDIR} ${WRKDIR}/${PORTDIRNAME}
	@${TAR} xf ${WRKDIR}/myapplication.war -C ${WRKDIR}/${PORTDIRNAME}

do-install:
	cd ${WRKDIR} &amp;&amp; \
	${INSTALL} -d -o ${WWWOWN} -g ${WWWGRP} ${TOMCATDIR}/webapps/${PORTDIRNAME}
	@cd ${WRKDIR}/${PORTDIRNAME} &amp;&amp; ${COPYTREE_SHARE} \* ${WEBAPPDIR}/${PORTDIRNAME}</pre></div></div><div class=paragraph><p>Вне зависимости от типа вашего порта (библиотека это или приложение), дополнительная документация должна устанавливаться <a href=#install-documentation>в тоже самое место</a>, что и для других портов. Известно, что в зависимости от используемой версии JDK утилита JavaDoc генерирует различные наборы файлов. Для портов, которые не привязаны к использованию определённой версии JDK, таким образом становится проблематичным определить список файлов для упаковки (<span class=filename>pkg-plist</span>). Это одна из причин, по которой создателям портов настоятельно рекомендуется использовать макрос <code>PORTDOCS</code>. Более того, даже если вы сможете угадать набор файлов, который будет сгенерирован утилитой <code>javadoc</code>, размер получающегося файла <span class=filename>pkg-plist</span> голосует за использование <code>PORTDOCS</code>.</p></div><div class=paragraph><p>Значением по умолчанию для переменной <code>DATADIR</code> является <span class=filename>${PREFIX}/shared/${PORTNAME}</span>. Хорошей идеей является переопределение для Java-портов значения <code>DATADIR</code> как <span class=filename>${JAVASHAREDIR}/${PORTNAME}</span>. На самом деле <code>DATADIR</code> автоматически добавляется к <code>PLIST_SUB</code> (это описано в <a href=../plist/#plist-sub>Изменение содержимого pkg-plist в зависимости от make-переменных</a>), так что вы сможете использовать <code>%%DATADIR%%</code> непосредственно в <span class=filename>pkg-plist</span>.</p></div><div class=paragraph><p>Что касается выбора между построением портов Java из исходных текстов или их прямой установкой из бинарных дистрибутивов, то на момент создания этого текста определённой политики на этот счёт не существует. Однако участники <a href=http://www.freebsd.org/java/>Проекта FreeBSD Java</a> рекомендуют создателям портов строить их из исходных текстов, если эта задача является несложной.</p></div><div class=paragraph><p>Все возможности, которые были описаны в этом разделе, реализованы в файле <span class=filename>bsd.java.mk</span>. Если вы предположите, что вашему порту требуется менее тривиальная поддержка Java, пожалуйста, взгляните сначала на <a href="http://svnweb.FreeBSD.org/ports/head/Mk/bsd.java.mk?view=markup">журнал изменений bsd.java.mk в Subversion</a>, так как для документирования последних изменений требуется какое-то время. Затем, если вы думаете, что не хватающая вам поддержка окажется полезной для многих других портов Java, обсудите ваш вопрос в freebsd-java.</p></div><div class=paragraph><p>Хотя в базе сообщений об ошибках для соответствующих PR имеется категория <code>java</code>, она относится к работе над портированием JDK, которые проводит Проект FreeBSD Java. Таким образом, вы должны относить свой Java-порт, как и любой другой, к категории <code>ports</code>, если решаемый вами вопрос не относится ни к реализации JDK, ни к <span class=filename>bsd.java.mk</span>.</p></div><div class=paragraph><p>Похожим образом определена политика по отношению к <code>CATEGORIES</code> порта Java, которая подробно описана в <a href=../makefiles/#makefile-categories>Разделение по категориям</a>.</p></div></div></div></div><div class=sect1><h2 id=using-php>6.13. Веб-приложения, Apache и PHP<a class=anchor href=#using-php></a></h2><div class=sectionbody><div class=sect2><h3 id=using-apache>6.13.1. Apache<a class=anchor href=#using-apache></a></h3><table class="tableblock frame-none grid-all stretch"><caption class=title>Таблица 18. Переменные для портов, использующих Apache</caption><col style=width:50%><col style=width:50%><tbody><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>USE_APACHE</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Порт требует Apache. Возможные значения: <code>yes</code> (берёт любую версию), <code>22</code>, <code>24</code>, <code>22-24</code>, <code>22+</code> и так далее. Версия по умолчанию <code>22</code>. Более подробная информация содержится в файле <span class=filename>ports/Mk/bsd.apache.mk</span> и на странице <a href=http://wiki.freebsd.org/Apache/>wiki.freebsd.org/Apache/</a>.</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>APXS</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Полный путь к исполняемому файлу <code>apxs</code>. Может быть переопределен в вашем порту.</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>HTTPD</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Полный путь к исполняемому файлу <code>httpd</code>. Может быть переопределен в вашем порту.</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>APACHE_VERSION</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Версия установленного Apache (переменная только для чтения). Эта переменная доступна только после подключения <span class=filename>bsd.port.pre.mk</span>. Возможные значения: <code>22</code>, <code>24</code>.</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>APACHEMODDIR</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Каталог для модулей Apache. Значение переменной автоматически подставляется в <span class=filename>pkg-plist</span>.</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>APACHEINCLUDEDIR</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Каталог для заголовков Apache. Значение переменной автоматически подставляется в <span class=filename>pkg-plist</span>.</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>APACHEETCDIR</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Каталог для конфигурационных файлов Apache. Значение переменной автоматически подставляется в <span class=filename>pkg-plist</span>.</p></td></tr></tbody></table><table class="tableblock frame-none grid-all stretch"><caption class=title>Таблица 19. Используемые переменные при портировании модулей Apache</caption><col style=width:50%><col style=width:50%><tbody><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>MODULENAME</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Название модуля. Значением по умолчанию является <code>PORTNAME</code>. Пример: <code>mod_hello</code></p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>SHORTMODNAME</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Краткое название модуля. Наследуется автоматически от <code>MODULENAME</code>, но может быть переопределено. Пример: <code>hello</code></p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>AP_FAST_BUILD</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Использовать <code>apxs</code> для компиляции и установки модуля.</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>AP_GENPLIST</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Также автоматически создает <span class=filename>pkg-plist</span>.</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>AP_INC</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Добавляет каталог к пути поиска заголовков во время компиляции.</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>AP_LIB</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Добавляет каталог к пути поиска библиотек во время компиляции.</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>AP_EXTRAS</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Дополнительные флаги, передаваемые <code>apxs</code>.</p></td></tr></tbody></table></div><div class=sect2><h3 id=web-apps>6.13.2. Веб-приложения<a class=anchor href=#web-apps></a></h3><div class=paragraph><p>Веб-приложения следует устанавливать в <span class=filename>PREFIX/www/appname</span>. Для вашего удобства этот путь одинаково доступен в <span class=filename>Makefile</span> и <span class=filename>pkg-plist</span> как переменная <code>WWWDIR</code>, а путь относительно <code>PREFIX</code> доступен в <span class=filename>Makefile</span> как <code>WWWDIR_REL</code>.</p></div><div class=paragraph><p>Пользователь и группа процесса веб-сервера доступны как <code>WWWOWN</code> и <code>WWWGRP</code>, в случае если вам нужно изменить владельца для некоторых файлов. Значением по умолчанию и для владельца, и для группы является <code>www</code>. Если вы хотите использовать в вашем порте другие значения, воспользуйтесь для этого нотацией <code>WWWOWN?= myuser</code>, чтобы позволить пользователю легко переопределить их.</p></div><div class=paragraph><p>Не добавляйте зависимость от Apache, если веб-приложение явным образом не нуждается в Apache. Учитывайте, что пользователи могут пожелать запустить ваше веб-приложение на другом веб-сервере помимо Apache.</p></div></div><div class=sect2><h3 id=php-variables>6.13.3. PHP<a class=anchor href=#php-variables></a></h3><table class="tableblock frame-none grid-all stretch"><caption class=title>Таблица 20. Переменные для портов, использующих PHP</caption><col style=width:50%><col style=width:50%><tbody><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>USE_PHP</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Порт требует PHP. Значение <code>yes</code> добавляет зависимость от PHP. Вместо этого может быть указан перечень требуемых расширений PHP. Пример: <code>pcre xml gettext</code></p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>DEFAULT_PHP_VER</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Выбирает старший номер версии, с которым будет установлен PHP как зависимость в случае, когда PHP еще не установлен. По умолчанию <code>5</code>. Возможные значения: <code>4</code>, <code>5</code></p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>IGNORE_WITH_PHP</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Порт не работает с PHP данной версии. Возможные значения: <code>4</code>, <code>5</code></p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>USE_PHPIZE</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Порт будет построен как расширение PHP.</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>USE_PHPEXT</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Порт будет считаться расширением PHP, включая установку и регистрацию в реестре расширений.</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>USE_PHP_BUILD</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Установить PHP как зависимость времени построения.</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>WANT_PHP_CLI</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Хочет CLI (командная строка) версию PHP.</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>WANT_PHP_CGI</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Хочет CGI версию PHP.</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>WANT_PHP_MOD</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Хочет PHP как модуль Apache.</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>WANT_PHP_SCR</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Хочет CLI или CGI версию PHP.</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>WANT_PHP_WEB</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Хочет модуль Apache или CGI версию PHP.</p></td></tr></tbody></table></div><div class=sect2><h3 id=_модули_pear>6.13.4. Модули PEAR<a class=anchor href=#_модули_pear></a></h3><div class=paragraph><p>Портирование модулей PEAR является очень простым процессом.</p></div><div class=paragraph><p>Используйте переменные <code>FILES</code>, <code>TESTS</code>, <code>DATA</code>, <code>SQLS</code>, <code>SCRIPTFILES</code>, <code>DOCS</code> and <code>EXAMPLES</code> для перечисления файлов, которые вы хотите установить. Все перечисленные файлы будут автоматически установлены в подходящие места и добавлены в <span class=filename>pkg-plist</span>.</p></div><div class=paragraph><p>Подключите <span class=filename>${PORTSDIR}/devel/pear/bsd.pear.mk</span> на последней строке <span class=filename>Makefile</span>.</p></div><div id=pear-makefile class=exampleblock><div class=title>Пример 7. Пример Makefile для классов PEAR</div><div class=content><div class="literalblock programlisting"><div class=content><pre>PORTNAME=	Date
PORTVERSION=	1.4.3
CATEGORIES=	devel www pear

MAINTAINER=	example@domain.com
COMMENT=	PEAR Date and Time Zone Classes

BUILD_DEPENDS=	${PEARDIR}/PEAR.php:${PORTSDIR}/devel/pear-PEAR
RUN_DEPENDS:=	${BUILD_DEPENDS}

FILES=		Date.php Date/Calc.php Date/Human.php Date/Span.php     \
		Date/TimeZone.php
TESTS=		test_calc.php test_date_methods_span.php testunit.php   \
		testunit_date.php testunit_date_span.php wknotest.txt   \
		bug674.php bug727_1.php bug727_2.php bug727_3.php       \
		bug727_4.php bug967.php weeksinmonth_4_monday.txt       \
		weeksinmonth_4_sunday.txt weeksinmonth_rdm_monday.txt   \
		weeksinmonth_rdm_sunday.txt
DOCS=		TODO
_DOCSDIR=	.

.include &lt;bsd.port.pre.mk&gt;
.include &#34;${PORTSDIR}/devel/pear/bsd.pear.mk&#34;
.include &lt;bsd.port.post.mk&gt;</pre></div></div></div></div></div></div></div><div class=sect1><h2 id=using-python>6.14. Использование Python<a class=anchor href=#using-python></a></h2><div class=sectionbody><div class=paragraph><p>Коллекция Портов поддерживает параллельную установку множества версий Python. Следует убедиться, что в портах используется правильный интерпретатор <code>python</code> в соответствии с переменной <code>PYTHON_VERSION</code>, установленной пользователем. По большей части это означает замену пути к исполняемому файлу <code>python</code> в сценариях на значение переменной <code>PYTHON_CMD</code>.</p></div><div class=paragraph><p>Порты, устанавливающие файлы под каталог <code>PYTHON_SITELIBDIR</code>, должны использовать префикс вида <code>pyXY-</code>, таким образом названия пакетов будут включать в себя версию Python, с которой они установлены.</p></div><div class="literalblock programlisting"><div class=content><pre>PKGNAMEPREFIX=	${PYTHON_PKGNAMEPREFIX}</pre></div></div><table class="tableblock frame-none grid-all stretch"><caption class=title>Таблица 21. Переменные для портов, которые используют Python</caption><col style=width:50%><col style=width:50%><tbody><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>USE_PYTHON</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Для этого порта нужен Python. Минимальная требуемая версия может быть указана с таким значением как <code>2.6+</code>. Также можно указан диапазон версий с разделением двух версий через -, например: <code>2.6-2.7</code></p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>USE_PYDISTUTILS</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Использовать дистрибутивные утилиты (distutils) Python для конфигурации, компиляции и установки. Необходимо, если порт использует <span class=filename>setup.py</span>. Переопределяет цели <code>do-build</code> и <code>do-install</code> и также может переопределять <code>do-configure</code>, если не определена <code>GNU_CONFIGURE</code>.</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>PYTHON_PKGNAMEPREFIX</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Используется как <code>PKGNAMEPREFIX</code> для отличия пакетов, использующих разные версии Python. Пример: <code>py24-</code></p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>PYTHON_SITELIBDIR</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Местонахождение дерева site-packages, которое содержит путь установки Python (обычно, <code>LOCALBASE</code>). Переменная <code>PYTHON_SITELIBDIR</code> может быть очень полезной при установке модулей Python.</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>PYTHONPREFIX_SITELIBDIR</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Вариант PYTHON_SITELIBDIR без PREFIX. По возможности всегда используйте <code>%%PYTHON_SITELIBDIR%%</code> в <span class=filename>pkg-plist</span>. Значением по умолчанию для <code>%%PYTHON_SITELIBDIR%%</code> является <code>lib/python%%PYTHON_VERSION%%/site-packages</code>.</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>PYTHON_CMD</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Командная строка интерпретатора Python, включая номер версии.</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>PYNUMERIC</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Строка зависимости для расширения numeric.</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>PYNUMPY</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Строка зависимости для нового расширения numeric, numpy (PYNUMERIC объявлен устаревшим вышестоящим производителем).</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>PYXML</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Строка зависимости для расширения XML (не нужно для Python 2.0 и выше, т.к. включено в основной дистрибутив).</p></td></tr></tbody></table><div class=paragraph><p>Полный перечень доступных переменных можно найти в <span class=filename>/usr/ports/Mk/bsd.python.mk</span>.</p></div><div class=paragraph><p>Некоторые приложения на Python заявляют о поддержке <code>DESTDIR</code> (требуется для staging), которая не работает (в частности, у Mailman до версии 2.1.16). Ограничение можно обойти путём перекомпиляции сценариев. Например, это можно выполнить в цели <code>post-build</code>. С учётом того, что после установки предполагаемое место размещения сценариев Python будет находиться в <code>PYTHONPREFIX_SITELIBDIR</code>, можно применить следующее решение:</p></div><div class="literalblock programlisting"><div class=content><pre>(cd ${STAGEDIR}${PREFIX} \
  &amp;&amp; ${PYTHON_CMD} ${PYTHON_LIBDIR}/compileall.py \
   -d ${PREFIX} -f ${PYTHONPREFIX_SITELIBDIR:S;${PREFIX}/;;})</pre></div></div><div class=paragraph><p>Эта команда перекомпилирует исходный текст с заменой путей на относительные к каталогу сборки, а также дописывает значение <code>PREFIX</code> перед именем файла, записанного в выходном файле с промежуточным представлением, с использованием <code>-d</code>. <code>-f</code> требуется для безусловной перекомпиляции, <code>:S;${PREFIX}/;;</code> удаляет префиксы из значения переменной <code>PYTHONPREFIX_SITELIBDIR</code>, чтобы сделать его относительным к <code>PREFIX</code>.</p></div><div class=paragraph><p>Для этого требуется Python 2.7 или выше. Это не работает с Python 2.6.</p></div></div></div><div class=sect1><h2 id=using-tcl>6.15. Использование Tcl/Tk<a class=anchor href=#using-tcl></a></h2><div class=sectionbody><div class=paragraph><p>В Коллекции Портов поддерживается одновременная установка множественных версий Tcl/Tk. Порты должны пытаться поддерживать по крайней мере версию Tcl/Tk, используемую по умолчанию, и выше с помощью переменных <code>USE_TCL</code> и <code>USE_TK</code>. Желаемую версию <code>tcl</code> можно указать в переменной <code>WITH_TCL_VER</code>.</p></div><table class="tableblock frame-none grid-all stretch"><caption class=title>Таблица 22. Наиболее востребованные переменные для портов, которые используют Tcl/Tk</caption><col style=width:50%><col style=width:50%><tbody><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>USE_TCL</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Порт зависит от библиотеки Tcl (не оболочки). Минимальную требуемую версию можно указать с использованием таких значений, как 84+. Отдельные неподдерживаемые версии указываются в переменной <code>INVALID_TCL_VER</code>.</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>USE_TCL_BUILD</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Tcl нужен для порта только на время сборки.</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>USE_TCL_WRAPPER</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Эту новую переменную следует использовать для портов, для которых требуется оболочка Tcl и не требуется конкретная версия <code>tclsh</code>. Обертка <code>tclsh</code> устанавливается в систему. Пользователь может указать желаемую оболочку <code>tcl</code> для использования.</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>WITH_TCL_VER</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Определяемые пользователем переменные, которые устанавливают желаемую версию Tcl.</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>UNIQUENAME_WITH_TCL_VER</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Подобно <code>WITH_TCL_VER</code>, но для каждого порта.</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>USE_TCL_THREADS</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Требует многопоточную сборку Tcl/Tk.</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>USE_TK</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Порт зависит от библиотеки Tk (не от предпочитаемой оболочки). Подразумевает <code>USE_TCL</code> с тем же значением. Для большей информации смотрите описание переменной <code>USE_TCL</code>.</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>USE_TK_BUILD</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Аналогично <code>USE_TCL_BUILD</code>.</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>USE_TK_WRAPPER</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Аналогично <code>USE_TCL_WRAPPER</code>.</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>WITH_TK_VER</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Аналогично <code>WITH_TCL_VER</code>, подразумевает <code>WITH_TCL_VER</code> той же версии.</p></td></tr></tbody></table><div class=paragraph><p>Полный перечень доступных переменных находится в <span class=filename>/usr/ports/Mk/bsd.tcl.mk</span>.</p></div></div></div><div class=sect1><h2 id=using-emacs>6.16. Использование Emacs<a class=anchor href=#using-emacs></a></h2><div class=sectionbody><div class=paragraph><p>Этот раздел ещё предстоит написать.</p></div></div></div><div class=sect1><h2 id=using-ruby>6.17. Использование Ruby<a class=anchor href=#using-ruby></a></h2><div class=sectionbody><table class="tableblock frame-none grid-all stretch"><caption class=title>Таблица 23. Полезные переменные для портов, использующих Ruby</caption><col style=width:50%><col style=width:50%><thead><tr><th class="tableblock halign-left valign-top">Переменная</th><th class="tableblock halign-left valign-top">Описание</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>USE_RUBY</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Порт требует Ruby.</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>USE_RUBY_EXTCONF</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Порт использует для конфигурации <span class=filename>extconf.rb</span>.</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>USE_RUBY_SETUP</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Порт использует для конфигурации <span class=filename>setup.rb</span>.</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>RUBY_SETUP</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Устанавливает альтернативное имя для <span class=filename>setup.rb</span>. Распространенным значением является <span class=filename>install.rb</span>.</p></td></tr></tbody></table><div class=paragraph><p>Следующая таблица отражает некоторые переменные, доступные авторам портов через инфраструктуру портов. Эти переменные должны использоваться для установки файлов в правильное месторасположение. Используйте их в <span class=filename>pkg-plist</span> как можно больше. Эти переменные не должны переопределяться в самом порте.</p></div><table class="tableblock frame-none grid-all stretch"><caption class=title>Таблица 24. Отобранные переменные только для чтения для портов, использующих Ruby</caption><col style=width:33.3333%><col style=width:33.3333%><col style=width:33.3334%><thead><tr><th class="tableblock halign-left valign-top">Переменная</th><th class="tableblock halign-left valign-top">Описание</th><th class="tableblock halign-left valign-top">Примерное значение</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>RUBY_PKGNAMEPREFIX</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Используется как <code>PKGNAMEPREFIX</code> для различия пакетов от разных версий Ruby.</p></td><td class="tableblock halign-left valign-top"><p class=tableblock><code>ruby18-</code></p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>RUBY_VERSION</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Полная версия Ruby в форме <code>x.y.z</code>.</p></td><td class="tableblock halign-left valign-top"><p class=tableblock><code>1.8.2</code></p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>RUBY_SITELIBDIR</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Путь для установки архитектуронезависимых библиотек.</p></td><td class="tableblock halign-left valign-top"><p class=tableblock><code>/usr/local/lib/ruby/site_ruby/1.8</code></p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>RUBY_SITEARCHLIBDIR</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Путь для установки архитектурозависимых библиотек.</p></td><td class="tableblock halign-left valign-top"><p class=tableblock><code>/usr/local/lib/ruby/site_ruby/1.8/amd64-freebsd6</code></p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>RUBY_MODDOCDIR</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Путь для установки документации модуля.</p></td><td class="tableblock halign-left valign-top"><p class=tableblock><code>/usr/local/shared/doc/ruby18/patsy</code></p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>RUBY_MODEXAMPLESDIR</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Путь для установки примеров модуля.</p></td><td class="tableblock halign-left valign-top"><p class=tableblock><code>/usr/local/shared/examples/ruby18/patsy</code></p></td></tr></tbody></table><div class=paragraph><p>Полный перечень доступных переменных находится в <span class=filename>/usr/ports/Mk/bsd.ruby.mk</span>.</p></div></div></div><div class=sect1><h2 id=using-sdl>6.18. Использование SDL<a class=anchor href=#using-sdl></a></h2><div class=sectionbody><div class=paragraph><p>Переменная <code>USE_SDL</code> используется для автоматической настройки зависимостей для портов, использующих библиотеки на основе SDL, такие как <a class=package href=https://cgit.freebsd.org/ports/tree/devel/sdl12/>devel/sdl12</a> или <a class=package href=https://cgit.freebsd.org/ports/tree/graphics/sdl_image/>graphics/sdl_image</a>.</p></div><div class=paragraph><p>Для версии 1.2 на данный момент распознаются следующие SDL-библиотеки:</p></div><div class=ulist><ul><li><p>sdl: <a class=package href=https://cgit.freebsd.org/ports/tree/devel/sdl12/>devel/sdl12</a></p></li><li><p>console: <a class=package href=https://cgit.freebsd.org/ports/tree/devel/sdl_console/>devel/sdl_console</a></p></li><li><p>gfx: <a class=package href=https://cgit.freebsd.org/ports/tree/graphics/sdl_gfx/>graphics/sdl_gfx</a></p></li><li><p>image: <a class=package href=https://cgit.freebsd.org/ports/tree/graphics/sdl_image/>graphics/sdl_image</a></p></li><li><p>mixer: <a class=package href=https://cgit.freebsd.org/ports/tree/audio/sdl_mixer/>audio/sdl_mixer</a></p></li><li><p>mm: <a class=package href=https://cgit.freebsd.org/ports/tree/devel/sdlmm/>devel/sdlmm</a></p></li><li><p>net: <a class=package href=https://cgit.freebsd.org/ports/tree/net/sdl_net/>net/sdl_net</a></p></li><li><p>pango: <a class=package href=https://cgit.freebsd.org/ports/tree/x11-toolkits/sdl_pango/>x11-toolkits/sdl_pango</a></p></li><li><p>sound: <a class=package href=https://cgit.freebsd.org/ports/tree/audio/sdl_sound/>audio/sdl_sound</a></p></li><li><p>ttf: <a class=package href=https://cgit.freebsd.org/ports/tree/graphics/sdl_ttf/>graphics/sdl_ttf</a></p></li></ul></div><div class=paragraph><p>Для версии 2.0 на данный момент распознаются следующие SDL-библиотеки:</p></div><div class=ulist><ul><li><p>sdl: <a class=package href=https://cgit.freebsd.org/ports/tree/devel/sdl20/>devel/sdl20</a></p></li><li><p>gfx: <a class=package href=https://cgit.freebsd.org/ports/tree/graphics/sdl2_gfx/>graphics/sdl2_gfx</a></p></li><li><p>image: <a class=package href=https://cgit.freebsd.org/ports/tree/graphics/sdl2_image/>graphics/sdl2_image</a></p></li><li><p>mixer: <a class=package href=https://cgit.freebsd.org/ports/tree/audio/sdl2_mixer/>audio/sdl2_mixer</a></p></li><li><p>net: <a class=package href=https://cgit.freebsd.org/ports/tree/net/sdl2_net/>net/sdl2_net</a></p></li><li><p>ttf: <a class=package href=https://cgit.freebsd.org/ports/tree/graphics/sdl2_ttf/>graphics/sdl2_ttf</a></p></li></ul></div><div class=paragraph><p>Таким образом, если порт имеет зависимость от <a class=package href=https://cgit.freebsd.org/ports/tree/net/sdl_net/>net/sdl_net</a> и <a class=package href=https://cgit.freebsd.org/ports/tree/audio/sdl_mixer/>audio/sdl_mixer</a>, то строка будет следующей:</p></div><div class="literalblock programlisting"><div class=content><pre>USE_SDL=	net mixer</pre></div></div><div class=paragraph><p>Зависимость от порта <a class=package href=https://cgit.freebsd.org/ports/tree/devel/sdl12/>devel/sdl12</a>, который требуется для <a class=package href=https://cgit.freebsd.org/ports/tree/net/sdl_net/>net/sdl_net</a> и <a class=package href=https://cgit.freebsd.org/ports/tree/audio/sdl_mixer/>audio/sdl_mixer</a>, будет также автоматически добавлен.</p></div><div class=paragraph><p>Если вы используете <code>USE_SDL</code> с элементами SDL 1.2, то он автоматически:</p></div><div class=ulist><ul><li><p>Добавляет зависимость от sdl12-config к <code>BUILD_DEPENDS</code></p></li><li><p>Добавляет переменную <code>SDL_CONFIG</code> к <code>CONFIGURE_ENV</code></p></li><li><p>Добавляет зависимости от указанных библиотек к <code>LIB_DEPENDS</code></p></li></ul></div><div class=paragraph><p>Если вы используете <code>USE_SDL</code> с элементами SDL 2.0, то он автоматически:</p></div><div class=ulist><ul><li><p>Добавляет зависимость от sdl2-config к <code>BUILD_DEPENDS</code></p></li><li><p>Добавляет переменную <code>SDL2_CONFIG</code> к <code>CONFIGURE_ENV</code></p></li><li><p>Добавляет зависимости от указанных библиотек к <code>LIB_DEPENDS</code></p></li></ul></div><div class=paragraph><p>Для проверки наличия библиотеки SDL вы можете делать это при помощи переменной <code>WANT_SDL</code>:</p></div><div class="literalblock programlisting"><div class=content><pre>WANT_SDL=	yes

.include &lt;bsd.port.pre.mk&gt;

.if ${HAVE_SDL:Mmixer}!=&#34;&#34;
USE_SDL+=	mixer
.endif

.include &lt;bsd.port.post.mk&gt;</pre></div></div></div></div><div class=sect1><h2 id=using-wx>6.19. Использование wxWidgets<a class=anchor href=#using-wx></a></h2><div class=sectionbody><div class=paragraph><p>Эта глава описывает статус библиотек wxWidgets в дереве портов и их интеграцию с системой портов.</p></div><div class=sect2><h3 id=wx-introduction>6.19.1. Введение<a class=anchor href=#wx-introduction></a></h3><div class=paragraph><p>Существует множество версий библиотек wxWidgets, конфликтующих между собой (устанавливают файлы под тем же именем). В дереве портов эта проблема решена путем установки каждой версии под собственным названием с использованием номера версии в качестве суффикса.</p></div><div class=paragraph><p>Очевидным недостатком этого является необходимость изменения каждого приложения для нахождения искомой версии. К счастью, большинство приложений для определения нужного компилятора и флагов компоновки вызывают сценарий <code>wx-config</code>. Для каждой доступной версии этот сценарий имеет своё имя. Большинство приложений учитывают переменную окружения или принимают аргумент configure для указания, какой сценарий <code>wx-config</code> следует вызывать. На все остальные приходится накладывать патч.</p></div></div><div class=sect2><h3 id=wx-version>6.19.2. Выбор версии<a class=anchor href=#wx-version></a></h3><div class=paragraph><p>Для того, чтобы заставить ваш порт использовать конкретную версию wxWidgets, существует две доступные для определения переменные (если определена только одна, то вторая примет значение по умолчанию):</p></div><table id=wx-ver-sel-table class="tableblock frame-none grid-all stretch"><caption class=title>Таблица 25. Переменные для выбора версии wxWidgets</caption><col style=width:33.3333%><col style=width:33.3333%><col style=width:33.3334%><thead><tr><th class="tableblock halign-left valign-top">Переменная</th><th class="tableblock halign-left valign-top">Описание</th><th class="tableblock halign-left valign-top">Значение по умолчанию</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>USE_WX</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Перечень версий, которые порт может использовать</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Все доступные версии</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>USE_WX_NOT</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Перечень версий, которые порт не может использовать</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Нет</p></td></tr></tbody></table><div class=paragraph><p>Перечень доступных версий wxWidgets и соответствующих им портов в дереве:</p></div><table class="tableblock frame-none grid-all stretch"><caption class=title>Таблица 26. Доступные версии wxWidgets</caption><col style=width:50%><col style=width:50%><thead><tr><th class="tableblock halign-left valign-top">Версия</th><th class="tableblock halign-left valign-top">Порт</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>2.4</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock><a class=package href=https://cgit.freebsd.org/ports/tree/x11-toolkits/wxgtk24/>x11-toolkits/wxgtk24</a></p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>2.6</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock><a class=package href=https://cgit.freebsd.org/ports/tree/x11-toolkits/wxgtk26/>x11-toolkits/wxgtk26</a></p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>2.8</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock><a class=package href=https://cgit.freebsd.org/ports/tree/x11-toolkits/wxgtk28/>x11-toolkits/wxgtk28</a></p></td></tr></tbody></table><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Версии начиная с <code>2.5</code> также поставляются с Unicode и устанавливается подчиненным портом с названием как как у обычного, но с суффиксом <code>-unicode</code>, но этим можно управлять при помощи переменных (смотрите <a href=#wx-unicode>Unicode</a>).</p></div></td></tr></tbody></table></div><div class=paragraph><p>Переменные в <a href=#wx-ver-sel-table>Переменные для выбора версии wxWidgets</a> можно установить в одну или более следующих комбинаций, разделенных пробелами:</p></div><table class="tableblock frame-none grid-all stretch"><caption class=title>Таблица 27. Определение версии для wxWidgets</caption><col style=width:50%><col style=width:50%><thead><tr><th class="tableblock halign-left valign-top">Описание</th><th class="tableblock halign-left valign-top">Пример</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class=tableblock>Единичная версия</p></td><td class="tableblock halign-left valign-top"><p class=tableblock><code>2.4</code></p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>Восходящий диапазон</p></td><td class="tableblock halign-left valign-top"><p class=tableblock><code>2.4+</code></p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>Нисходящий диапазон</p></td><td class="tableblock halign-left valign-top"><p class=tableblock><code>2.6-</code></p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>Полный диапазон (обязан быть восходящим)</p></td><td class="tableblock halign-left valign-top"><p class=tableblock><code>2.4-2.6</code></p></td></tr></tbody></table><div class=paragraph><p>Кроме того, существует несколько переменных для выбора предпочитаемых версий из перечня доступных. Они могут быть установлены в несколько версий, первая из которых будет иметь наибольший приоритет.</p></div><table class="tableblock frame-none grid-all stretch"><caption class=title>Таблица 28. Переменные для выбора предпочитаемых версий wxWidgets</caption><col style=width:50%><col style=width:50%><thead><tr><th class="tableblock halign-left valign-top">Название</th><th class="tableblock halign-left valign-top">Предназначение</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>WANT_WX_VER</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>порт</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>WITH_WX_VER</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>пользователь</p></td></tr></tbody></table></div><div class=sect2><h3 id=wx-components>6.19.3. Выбор компонентов<a class=anchor href=#wx-components></a></h3><div class=paragraph><p>Существуют другие приложения, которые, хотя и не являются библиотеками wxWidgets, но в тоже время относятся к ним. Эти приложения можно указать в переменной <code>WX_COMPS</code>. Доступны следующие компоненты:</p></div><table class="tableblock frame-none grid-all stretch"><caption class=title>Таблица 29. Доступные компоненты wxWidgets</caption><col style=width:33.3333%><col style=width:33.3333%><col style=width:33.3334%><thead><tr><th class="tableblock halign-left valign-top">Название</th><th class="tableblock halign-left valign-top">Описание</th><th class="tableblock halign-left valign-top">Ограничение версии</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>wx</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>основная библиотека</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>нет</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>contrib</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>сторонние библиотеки</p></td><td class="tableblock halign-left valign-top"><p class=tableblock><code>нет</code></p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>python</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>wxPython (привязки к Python)</p></td><td class="tableblock halign-left valign-top"><p class=tableblock><code>2.4-2.6</code></p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>mozilla</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>wxMozilla</p></td><td class="tableblock halign-left valign-top"><p class=tableblock><code>2.4</code></p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>svg</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>wxSVG</p></td><td class="tableblock halign-left valign-top"><p class=tableblock><code>2.6</code></p></td></tr></tbody></table><div class=paragraph><p>Тип добавляемой зависимости при выборе каждого компонента может быть указан вручную путем добавления суффикса, отделенного точкой с запятой. Если таковой отсутствует, но будет использовано значение по умолчанию (смотрите <a href=#wx-def-dep-types>Типы зависимости wxWidgets, используемые по умолчанию</a>). Доступные типы зависимости:</p></div><table class="tableblock frame-none grid-all stretch"><caption class=title>Таблица 30. Доступные типы зависимости wxWidgets</caption><col style=width:50%><col style=width:50%><thead><tr><th class="tableblock halign-left valign-top">Название</th><th class="tableblock halign-left valign-top">Описание</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>build</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Компонент требуется для построения, эквивалентен <code>BUILD_DEPENDS</code></p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>run</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Компонент требуется для запуска, эквивалентен <code>RUN_DEPENDS</code></p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>lib</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Компонент требуется для построения и запуска, эквивалентен <code>LIB_DEPENDS</code></p></td></tr></tbody></table><div class=paragraph><p>Значения по умолчанию для компонентов подробно рассматриваются в следующей таблице:</p></div><table id=wx-def-dep-types class="tableblock frame-none grid-all stretch"><caption class=title>Таблица 31. Типы зависимости wxWidgets, используемые по умолчанию</caption><col style=width:50%><col style=width:50%><thead><tr><th class="tableblock halign-left valign-top">Компонент</th><th class="tableblock halign-left valign-top">Тип зависимости</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>wx</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock><code>lib</code></p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>contrib</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock><code>lib</code></p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>python</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock><code>run</code></p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>mozilla</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock><code>lib</code></p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>svg</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock><code>lib</code></p></td></tr></tbody></table><div id=wx-components-example class=exampleblock><div class=title>Пример 8. Выбор компонентов wxWidgets</div><div class=content><div class=paragraph><p>Следующий фрагмент относится к порту, в котором используется wxWidgets версии <code>2.4</code> с его сторонними библиотеками.</p></div><div class="literalblock programlisting"><div class=content><pre>USE_WX=		2.4
WX_COMPS=	wx contrib</pre></div></div></div></div></div><div class=sect2><h3 id=wx-unicode>6.19.4. Unicode<a class=anchor href=#wx-unicode></a></h3><div class=paragraph><p>Библиотека wxWidgets поддерживает Unicode начиная с версии <code>2.5</code>. В дереве портов доступны обе версии и могут быть выбраны с использованием следующих переменных:</p></div><table id=wx-unicode-var-table class="tableblock frame-none grid-all stretch"><caption class=title>Таблица 32. Переменные для выбора версии wxWidgets с Unicode</caption><col style=width:33.3333%><col style=width:33.3333%><col style=width:33.3334%><thead><tr><th class="tableblock halign-left valign-top">Переменная</th><th class="tableblock halign-left valign-top">Описание</th><th class="tableblock halign-left valign-top">Предназначение</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>WX_UNICODE</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Порт работает <em>только</em> с версией Unicode</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>порт</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>WANT_UNICODE</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Порт работает с обеими версиями, но предпочитает версию с Unicode</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>порт</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>WITH_UNICODE</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Порт будет использовать версию Unicode</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>пользователь</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>WITHOUT_UNICODE</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Порт будет использовать обычную версию, если это поддерживается (когда <code>WX_UNICODE</code> не определена)</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>пользователь</p></td></tr></tbody></table><div class="admonitionblock warning"><table><tbody><tr><td class=icon><i class="fa icon-warning" title=Warning></i></td><td class=content><div class=paragraph><p>Не используйте <code>WX_UNICODE</code> для портов, которые могут использовать обе версии. Если вы хотите, чтобы порт по умолчанию использовал Unicode, определите вместо этого <code>WANT_UNICODE</code>.</p></div></td></tr></tbody></table></div></div><div class=sect2><h3 id=wx-version-detection>6.19.5. Обнаружение установленных версий<a class=anchor href=#wx-version-detection></a></h3><div class=paragraph><p>Для обнаружения установленной версии вам необходимо задать переменную <code>WANT_WX</code>. Если вы не присвоите ей определенную версию, то компоненты получат суффикс версии. Переменная <code>HAVE_WX</code> будет заполнена после обнаружения.</p></div><div id=wx-ver-det-example class=exampleblock><div class=title>Пример 9. Обнаружение установленных версий и компонентов wxWidgets</div><div class=content><div class=paragraph><p>Следующий фрагмент может быть использован в порту, который использует wxWidgets, в случае если он установлен или выбран соответствующий параметр.</p></div><div class="literalblock programlisting"><div class=content><pre>WANT_WX=	yes

.include &lt;bsd.port.pre.mk&gt;

.if defined(WITH_WX) || !empty(PORT_OPTIONS:MWX) || !empty(HAVE_WX:Mwx-2.4)
USE_WX=			2.4
CONFIGURE_ARGS+=	--enable-wx
.endif</pre></div></div><div class=paragraph><p>Следующий фрагмент может быть использован в порту, который задействует поддержку wxPython, в случае если он установлен или выбран соответствующий параметр, в дополнение к wxWidgets, обе версии <code>2.6</code>.</p></div><div class="literalblock programlisting"><div class=content><pre>USE_WX=		2.6
WX_COMPS=	wx
WANT_WX=	2.6

.include &lt;bsd.port.pre.mk&gt;

.if defined(WITH_WXPYTHON) || !empty(PORT_OPTIONS:MWXPYTHON) || !empty(HAVE_WX:Mpython)
WX_COMPS+=		python
CONFIGURE_ARGS+=	--enable-wxpython
.endif</pre></div></div></div></div></div><div class=sect2><h3 id=wx-defined-variables>6.19.6. Переменные для определения<a class=anchor href=#wx-defined-variables></a></h3><div class=paragraph><p>Следующие переменные доступны в порту (после определения одной из переменных из <a href=#wx-ver-sel-table>Переменные для выбора версии wxWidgets</a>).</p></div><table class="tableblock frame-none grid-all stretch"><caption class=title>Таблица 33. Переменные, определенные для портов, использующих wxWidgets</caption><col style=width:50%><col style=width:50%><thead><tr><th class="tableblock halign-left valign-top">Название</th><th class="tableblock halign-left valign-top">Описание</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>WX_CONFIG</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Путь к сценарию wxWidgets <code>wx-config</code> (с другим именем)</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>WXRC_CMD</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Путь к программе wxWidgets <code>wxrc</code> (с другим именем)</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>WX_VERSION</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Версия wxWidgets, которая будет использоваться (например, <code>2.6</code>)</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>WX_UNICODE</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Если не определена, но Unicode будет использоваться, то она будет определена</p></td></tr></tbody></table></div><div class=sect2><h3 id=wx-premk>6.19.7. Обработка в <span class=filename>bsd.port.pre.mk</span><a class=anchor href=#wx-premk></a></h3><div class=paragraph><p>Если вам нужно использовать переменные для запуска команд сразу после подключения <span class=filename>bsd.port.pre.mk</span>, то вам нужно определить <code>WX_PREMK</code>.</p></div><div class="admonitionblock important"><table><tbody><tr><td class=icon><i class="fa icon-important" title=Important></i></td><td class=content><div class=paragraph><p>Если вы определите <code>WX_PREMK</code>, то версия, зависимости, компоненты и заданные переменные не изменяться, в случае вы изменили переменные порта wxWidgets после подключения <span class=filename>bsd.port.pre.mk</span>.</p></div></td></tr></tbody></table></div><div id=wx-premk-example class=exampleblock><div class=title>Пример 10. Использование переменных wxWidgets в командах</div><div class=content><div class=paragraph><p>Следующий фрагмент иллюстрирует использование переменной <code>WX_PREMK</code> посредством запуска сценария <code>wx-config</code> для получения строки с полной версией с присвоением ее переменной и передачей в программу.</p></div><div class="literalblock programlisting"><div class=content><pre>USE_WX=		2.4
WX_PREMK=	yes

.include &lt;bsd.port.pre.mk&gt;

.if exists(${WX_CONFIG})
VER_STR!=	${WX_CONFIG} --release

PLIST_SUB+=	VERSION=&#34;${VER_STR}&#34;
.endif</pre></div></div></div></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Переменные wxWidgets можно безопасно использовать в командах внутри целей без необходимости в использовании <code>WX_PREMK</code>.</p></div></td></tr></tbody></table></div></div><div class=sect2><h3 id=wx-additional-config-args>6.19.8. Дополнительные параметры <code>configure</code><a class=anchor href=#wx-additional-config-args></a></h3><div class=paragraph><p>Некоторые сценарии GNU <code>configure</code> не могут найти wxWidgets только с установленной переменной окружения <code>WX_CONFIG</code>, требуя дополнительные параметры. Для их передачи можно использовать переменную <code>WX_CONF_ARGS</code>.</p></div><table class="tableblock frame-none grid-all stretch"><caption class=title>Таблица 34. Допустимые значения <code>WX_CONF_ARGS</code></caption><col style=width:50%><col style=width:50%><thead><tr><th class="tableblock halign-left valign-top">Возможное значение</th><th class="tableblock halign-left valign-top">Получаемый параметр</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>absolute</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock><code>--with-wx-config=${WX_CONFIG}</code></p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>relative</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock><code>--with-wx=${LOCALBASE} --with-wx-config=${WX_CONFIG:T}</code></p></td></tr></tbody></table></div></div></div><div class=sect1><h2 id=using-lua>6.20. Использование Lua<a class=anchor href=#using-lua></a></h2><div class=sectionbody><div class=paragraph><p>Эта глава описывает статус библиотек Lua в дереве портов и их интеграцию в систему портов.</p></div><div class=sect2><h3 id=lua-introduction>6.20.1. Введение<a class=anchor href=#lua-introduction></a></h3><div class=paragraph><p>Существует множество версий библиотек Lua и соответствующих интерпретаторов, конфликтующих между собой (устанавливают файлы под тем же именем). В дереве портов эта проблема решена путем установки каждой версии в собственное место с использованием номера версии в качестве суффикса.</p></div><div class=paragraph><p>Очевидным недостатком этого является необходимость изменения каждого приложения для нахождения искомой версии. Но это решается добавлением некоторых дополнительных флагов для компилятора и компоновщика.</p></div></div><div class=sect2><h3 id=lua-version>6.20.2. Выбор версии<a class=anchor href=#lua-version></a></h3><div class=paragraph><p>Для того, чтобы заставить ваш порт использовать конкретную версию Lua, существует две доступные для определения переменные (если определена только одна, то вторая примет значение по умолчанию):</p></div><table id=lua-ver-sel-table class="tableblock frame-none grid-all stretch"><caption class=title>Таблица 35. Переменные для выбора версии Lua</caption><col style=width:33.3333%><col style=width:33.3333%><col style=width:33.3334%><thead><tr><th class="tableblock halign-left valign-top">Переменная</th><th class="tableblock halign-left valign-top">Описание</th><th class="tableblock halign-left valign-top">Значение по умолчанию</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>USE_LUA</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Перечень версий, которые порт может использовать</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Все доступные версии</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>USE_LUA_NOT</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Перечень версий, которые порт не может использовать</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Пусто</p></td></tr></tbody></table><div class=paragraph><p>Перечень доступных версий Lua и соответствующих портов в дереве:</p></div><table class="tableblock frame-none grid-all stretch"><caption class=title>Таблица 36. Доступные версии Lua</caption><col style=width:50%><col style=width:50%><thead><tr><th class="tableblock halign-left valign-top">Версия</th><th class="tableblock halign-left valign-top">Порт</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>4.0</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock><a class=package href=https://cgit.freebsd.org/ports/tree/lang/lua4/>lang/lua4</a></p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>5.0</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock><a class=package href=https://cgit.freebsd.org/ports/tree/lang/lua50/>lang/lua50</a></p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>5.1</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock><a class=package href=https://cgit.freebsd.org/ports/tree/lang/lua/>lang/lua</a></p></td></tr></tbody></table><div class=paragraph><p>Переменные из <a href=#lua-ver-sel-table>Переменные для выбора версии Lua</a> могут иметь комбинации из одного или нескольких значений, разделенных пробелом:</p></div><table class="tableblock frame-none grid-all stretch"><caption class=title>Таблица 37. Определение версии Lua</caption><col style=width:50%><col style=width:50%><thead><tr><th class="tableblock halign-left valign-top">Описание</th><th class="tableblock halign-left valign-top">Пример</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class=tableblock>Единичная версия</p></td><td class="tableblock halign-left valign-top"><p class=tableblock><code>4.0</code></p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>Восходящий диапазон</p></td><td class="tableblock halign-left valign-top"><p class=tableblock><code>5.0+</code></p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>Нисходящий диапазон</p></td><td class="tableblock halign-left valign-top"><p class=tableblock><code>5.0-</code></p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>Полный диапазон (обязан быть восходящим)</p></td><td class="tableblock halign-left valign-top"><p class=tableblock><code>5.0-5.1</code></p></td></tr></tbody></table><div class=paragraph><p>Кроме того, существует несколько переменных для выбора предпочитаемых версий из перечня доступных. Они могут быть установлены в несколько версий, первая из которых будет иметь наибольший приоритет.</p></div><table class="tableblock frame-none grid-all stretch"><caption class=title>Таблица 38. Переменные для выбора предпочитаемых версий Lua</caption><col style=width:50%><col style=width:50%><thead><tr><th class="tableblock halign-left valign-top">Название</th><th class="tableblock halign-left valign-top">Предназначение</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>WANT_LUA_VER</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>порт</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>WITH_LUA_VER</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>пользователь</p></td></tr></tbody></table><div id=lua-version-example class=exampleblock><div class=title>Пример 11. Выбор версии Lua</div><div class=content><div class=paragraph><p>Следующий фрагмент взят из порта, который использует Lua версий <code>5.0</code> или <code>5.1</code>, по умолчанию <code>5.0</code>. Значение может быть переопределено пользователем с использованием переменной <code>WITH_LUA_VER</code>.</p></div><div class="literalblock programlisting"><div class=content><pre>USE_LUA=	5.0-5.1
WANT_LUA_VER=	5.0</pre></div></div></div></div></div><div class=sect2><h3 id=lua-components>6.20.3. Выбор компонентов<a class=anchor href=#lua-components></a></h3><div class=paragraph><p>Существуют другие приложения, которые хотя и не являются библиотеками Lua, но относятся к ним. Эти приложения можно указать в переменной <code>LUA_COMPS</code>. Доступны следующие компоненты:</p></div><table class="tableblock frame-none grid-all stretch"><caption class=title>Таблица 39. Доступные компоненты Lua</caption><col style=width:33.3333%><col style=width:33.3333%><col style=width:33.3334%><thead><tr><th class="tableblock halign-left valign-top">Название</th><th class="tableblock halign-left valign-top">Описание</th><th class="tableblock halign-left valign-top">Ограничение версии</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>lua</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Основная библиотека</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>нет</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>tolua</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Библиотека доступа к коду C/C++</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>4.0-5.0</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>ruby</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Привязка к Ruby</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>4.0-5.0</p></td></tr></tbody></table><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Есть и другие компоненты, но они относятся к модулям для интерпретатора и не используются приложениями (только другими модулями).</p></div></td></tr></tbody></table></div><div class=paragraph><p>Тип зависимости можно выбрать для каждого компонента через добавление суффикса, отделенного точкой с запятой. В случае отсутствия будет использован тип по умолчанию (смотрите <a href=#lua-def-dep-types>Типы зависимости Lua, используемые по умолчанию</a>). Доступные следующие типы:</p></div><table class="tableblock frame-none grid-all stretch"><caption class=title>Таблица 40. Доступные типы зависимости Lua</caption><col style=width:50%><col style=width:50%><thead><tr><th class="tableblock halign-left valign-top">Название</th><th class="tableblock halign-left valign-top">Описание</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>build</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Компонент требуется для построения, эквивалентен <code>BUILD_DEPENDS</code></p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>run</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Компонент требуется для запуска, эквивалентен <code>RUN_DEPENDS</code></p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>lib</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Компонент требуется для построения и запуска, эквивалентен <code>LIB_DEPENDS</code></p></td></tr></tbody></table><div class=paragraph><p>Значения по умолчанию для компонентов подробно рассматриваются в следующей таблице:</p></div><table id=lua-def-dep-types class="tableblock frame-none grid-all stretch"><caption class=title>Таблица 41. Типы зависимости Lua, используемые по умолчанию</caption><col style=width:50%><col style=width:50%><thead><tr><th class="tableblock halign-left valign-top">Компонент</th><th class="tableblock halign-left valign-top">Тип зависимости</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>lua</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock><code>lib</code> для <code>4.0-5.0</code> (динамическая) и <code>build</code> для <code>5.1</code> (статическая)</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>tolua</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock><code>build</code> (статическая)</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>ruby</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock><code>lib</code> (динамическая)</p></td></tr></tbody></table><div id=lua-components-example class=exampleblock><div class=title>Пример 12. Выбор компонентов Lua</div><div class=content><div class=paragraph><p>Следующий фрагмент соответствует порту, использующему Lua версии <code>4.0</code> и привязку к Ruby.</p></div><div class="literalblock programlisting"><div class=content><pre>USE_LUA=	4.0
LUA_COMPS=	lua ruby</pre></div></div></div></div></div><div class=sect2><h3 id=lua-version-detection>6.20.4. Обнаружение установленных версий<a class=anchor href=#lua-version-detection></a></h3><div class=paragraph><p>Для обнаружения установленной версии вам необходимо задать переменную <code>WANT_LUA</code>. Если вы не присвоите ей определенную версию, то компоненты получат суффикс версии. Переменная <code>HAVE_LUA</code> будет заполнена после обнаружения.</p></div><div id=lua-ver-det-example class=exampleblock><div class=title>Пример 13. Обнаружение установленных версий и компонентов Lua</div><div class=content><div class=paragraph><p>Следующий фрагмент можно использовать для порта, использующего Lua, если она установлена, или был выбран соответствующий параметр.</p></div><div class="literalblock programlisting"><div class=content><pre>WANT_LUA=	yes

.include &lt;bsd.port.pre.mk&gt;

.if defined(WITH_LUA5) || !empty(PORT_OPTIONS:MLUA5) || !empty(HAVE_LUA:Mlua-5.[01])
USE_LUA=		5.0-5.1
CONFIGURE_ARGS+=	--enable-lua5
.endif</pre></div></div><div class=paragraph><p>Следующий фрагмент можно использовать для порта, который включает поддержку tolua, если такой компонент установлен, или был выбран соответствующий параметр в дополнение к Lua, оба имеют версию <code>4.0</code>.</p></div><div class="literalblock programlisting"><div class=content><pre>USE_LUA=	4.0
LUA_COMPS=	lua
WANT_LUA=	4.0

.include &lt;bsd.port.pre.mk&gt;

.if defined(WITH_TOLUA) || !empty(PORT_OPTIONS:MTOLUA) || !empty(HAVE_LUA:Mtolua)
LUA_COMPS+=		tolua
CONFIGURE_ARGS+=	--enable-tolua
.endif</pre></div></div></div></div></div><div class=sect2><h3 id=lua-defined-variables>6.20.5. Переменные для определения<a class=anchor href=#lua-defined-variables></a></h3><div class=paragraph><p>Следующие переменные доступны в порту (после определения одной из переменных из <a href=#lua-ver-sel-table>Переменные для выбора версии Lua</a>).</p></div><table class="tableblock frame-none grid-all stretch"><caption class=title>Таблица 42. Переменные, определенные для портов, использующих Lua</caption><col style=width:50%><col style=width:50%><thead><tr><th class="tableblock halign-left valign-top">Название</th><th class="tableblock halign-left valign-top">Описание</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>LUA_VER</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Версия Lua, которая будет использоваться (например, <code>5.1</code>)</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>LUA_VER_SH</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Старший номер версии динамической библиотеки Lua (например, <code>1</code>)</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>LUA_VER_STR</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Версия Lua без точки (например, <code>51</code>)</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>LUA_PREFIX</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Префикс, в который установлена Lua (и компоненты)</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>LUA_SUBDIR</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Каталог под <span class=filename>${PREFIX}/bin</span>, <span class=filename>${PREFIX}/share</span> и <span class=filename>${PREFIX}/lib</span>, в который установлена Lua</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>LUA_INCDIR</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Каталог, в который установлены заголовочные файлы Lua и tolua</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>LUA_LIBDIR</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Каталог, в который установлены библиотеки Lua и tolua</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>LUA_MODLIBDIR</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Каталог, в который установлены модули библиотеки Lua (<span class=filename>.so</span>)</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>LUA_MODSHAREDIR</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Каталог, в который установлены модули Lua (<span class=filename>.lua</span>)</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>LUA_PKGNAMEPREFIX</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Префикс с именем пакета, используемый модулями Lua</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>LUA_CMD</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Путь к интерпретатору Lua</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>LUAC_CMD</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Путь к компилятору Lua</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>TOLUA_CMD</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Путь к программе tolua</p></td></tr></tbody></table><div id=lua-variables-example class=exampleblock><div class=title>Пример 14. Указание для порта, где искать Lua</div><div class=content><div class=paragraph><p>Следующий фрагмент показывает, как сообщить порту, который использует сценарий configure, где расположены заголовочные файлы и библиотеки Lua.</p></div><div class="literalblock programlisting"><div class=content><pre>USE_LUA=	4.0
GNU_CONFIGURE=	yes
CONFIGURE_ENV=	CPPFLAGS=&#34;-I${LUA_INCDIR}&#34; LDFLAGS=&#34;-L${LUA_LIBDIR}&#34;</pre></div></div></div></div></div><div class=sect2><h3 id=lua-premk>6.20.6. Обработка в <span class=filename>bsd.port.pre.mk</span><a class=anchor href=#lua-premk></a></h3><div class=paragraph><p>Если вам нужно использовать переменные для запуска команд сразу после подключения <span class=filename>bsd.port.pre.mk</span>, для этого вам нужно определить переменную <code>LUA_PREMK</code>.</p></div><div class="admonitionblock important"><table><tbody><tr><td class=icon><i class="fa icon-important" title=Important></i></td><td class=content><div class=paragraph><p>Если вы задаете <code>LUA_PREMK</code>, то версия, зависимости, компоненты и уже заданные переменные не будут изменены, в случае если вы изменили переменные порта Lua после подключения <span class=filename>bsd.port.pre.mk</span>.</p></div></td></tr></tbody></table></div><div id=lua-premk-example class=exampleblock><div class=title>Пример 15. Использование переменных Lua в командах</div><div class=content><div class=paragraph><p>Следующий фрагмент иллюстрирует использование <code>LUA_PREMK</code> посредством запуска интерпретатора Lua для того, чтобы получить строку с полной версией, сохранить ее в переменную и передать программе.</p></div><div class="literalblock programlisting"><div class=content><pre>USE_LUA=	5.0
LUA_PREMK=	yes

.include &lt;bsd.port.pre.mk&gt;

.if exists(${LUA_CMD})
VER_STR!=	${LUA_CMD} -v

CFLAGS+=	-DLUA_VERSION_STRING=&#34;${VER_STR}&#34;
.endif</pre></div></div></div></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Переменные Lua можно безопасно использовать в командах внутри целей без необходимости в использовании <code>LUA_PREMK</code>.</p></div></td></tr></tbody></table></div></div></div></div><div class=sect1><h2 id=using-iconv>6.21. Использование <code>iconv</code><a class=anchor href=#using-iconv></a></h2><div class=sectionbody><div class=paragraph><p>После 10-08-2013 (<a href=https://svnweb.freebsd.org/changeset/base/254273>r254273</a>) в составе FreeBSD 10-CURRENT и более новых версий имеется собственный <code>iconv</code>. В более ранних версиях дополнительной зависимостью выступал <a class=package href=https://cgit.freebsd.org/ports/tree/converters/libiconv/>converters/libiconv</a>.</p></div><div class=paragraph><p>Для программного обеспечения, которому нужен <code>iconv</code>, определите <code>USES=iconv</code>. Версии FreeBSD до 10-CURRENT от 13-08-2013 (<a href=https://svnweb.freebsd.org/changeset/base/254273>r254273</a>) не имеют собственного <code>iconv</code>. На этих более ранных версиях будет автоматически добавлена зависимость от <a class=package href=https://cgit.freebsd.org/ports/tree/converters/libiconv/>converters/libiconv</a>.</p></div><div class=paragraph><p>Когда порт задаёт <code>USES=iconv</code>, становятся доступными следующие переменные:</p></div><table class="tableblock frame-none grid-all stretch informaltable"><col style=width:25%><col style=width:25%><col style=width:25%><col style=width:25%><thead><tr><th class="tableblock halign-left valign-top">Имя переменной</th><th class="tableblock halign-left valign-top">Назначение</th><th class="tableblock halign-left valign-top">Значение до FreeBSD 10-CURRENT 254273 (13-08-2013)</th><th class="tableblock halign-left valign-top">Значение после FreeBSD 10-CURRENT 254273 (13-08-2013)</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>ICONV_CMD</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Каталог размещения двоичного файла <code>iconv</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock><code>${LOCALBASE}/bin/iconv</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock><span class=filename>/usr/bin/iconv</span></p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>ICONV_LIB</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Аргумент <code>ld</code> для компоновки с <span class=filename>libiconv</span> (если нужно)</p></td><td class="tableblock halign-left valign-top"><p class=tableblock><code>-liconv</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>(пусто)</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>ICONV_PREFIX</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Каталог размещения реализации <code>iconv</code> (используется для сценариев конфигурации)</p></td><td class="tableblock halign-left valign-top"><p class=tableblock><code>${LOCALBASE}</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock><span class=filename>/usr</span></p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>ICONV_CONFIGURE_ARG</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Параметр предварительно собранной конфигурации для сценариев конфигурации</p></td><td class="tableblock halign-left valign-top"><p class=tableblock><code>--with-libiconv-prefix=${LOCALBASE}</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>(пусто)</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>ICONV_CONFIGURE_BASE</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Параметр предварительно собранной конфигурации для сценариев конфигурации</p></td><td class="tableblock halign-left valign-top"><p class=tableblock><code>--with-libiconv=${LOCALBASE}</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>(пусто)</p></td></tr></tbody></table><div class=paragraph><p>В следующих двух примерах демонстрируется автоматическое присвоение переменным правильных значений для систем, использующих <a class=package href=https://cgit.freebsd.org/ports/tree/converters/libiconv/>converters/libiconv</a> или собственный <code>iconv</code>.</p></div><div id=iconv-simple-use class=exampleblock><div class=title>Пример 16. Простое использование <code>iconv</code></div><div class=content><div class="literalblock programlisting"><div class=content><pre>USES=		iconv
LDFLAGS+=	-L${LOCALBASE}/lib ${ICONV_LIB}</pre></div></div></div></div><div id=iconv-configure-use class=exampleblock><div class=title>Пример 17. Использование <code>iconv</code> с <code>configure</code></div><div class=content><div class="literalblock programlisting"><div class=content><pre>USES=		iconv
CONFIGURE_ARGS+=${ICONV_CONFIGURE_ARG}</pre></div></div></div></div><div class=paragraph><p>Как показано выше, <code>ICONV_LIB</code> имеет пустое значение с собственным <code>iconv</code>. Эту особенность можно использовать для обнаружения собственного <code>iconv</code> с соответствующими действиями.</p></div><div class=paragraph><p>Иногда в программе параметр <code>ld</code> или путь поиска жёстко заданы в <span class=filename>Makefile</span> или сценарии конфигурации. Для решения этой проблемы можно использовать следующий подход:</p></div><div id=iconv-reinplace class=exampleblock><div class=title>Пример 18. Исправление жёстко заданного <code>-liconv</code></div><div class=content><div class="literalblock programlisting"><div class=content><pre>USES=		iconv

post-patch:
	@${REINPLACE_CMD} -e &#39;s/-liconv/${ICONV_LIB}/&#39; ${WRKSRC}/Makefile</pre></div></div></div></div><div class=paragraph><p>В некоторых случаях необходимо установить альтернативные значения или выполнить операции в случае использования собственного <code>iconv</code>. Перед проверкой значения <code>ICONV_LIB</code> обязан быть подключён <span class=filename>bsd.port.pre.mk</span>:</p></div><div id=iconv-conditional class=exampleblock><div class=title>Пример 19. Проверка доступности собственного <code>iconv</code></div><div class=content><div class="literalblock programlisting"><div class=content><pre>USES=		iconv

.include &lt;bsd.port.pre.mk&gt;

post-patch:
.if empty(ICONV_LIB)
	# обнаружен собственный iconv
	@${REINPLACE_CMD} -e &#39;s|iconv||&#39; ${WRKSRC}/Config.sh
.endif

.include &lt;bsd.port.post.mk&gt;</pre></div></div></div></div></div></div><div class=sect1><h2 id=using-xfce>6.22. Использование Xfce<a class=anchor href=#using-xfce></a></h2><div class=sectionbody><div class=paragraph><p>Переменная <code>USE_XFCE</code> используется для автоматической конфигурации зависимостей для портов, использующих библиотеки или приложения на основе Xfce, такие как <a class=package href=https://cgit.freebsd.org/ports/tree/x11-toolkits/libxfce4gui/>x11-toolkits/libxfce4gui</a> и <a class=package href=https://cgit.freebsd.org/ports/tree/x11-wm/xfce4-panel/>x11-wm/xfce4-panel</a>.</p></div><div class=paragraph><p>В настоящее время распознаются следующие библиотеки и приложения Xfce:</p></div><div class=ulist><ul><li><p>libexo: <a class=package href=https://cgit.freebsd.org/ports/tree/x11/libexo/>x11/libexo</a></p></li><li><p>libgui: <a class=package href=https://cgit.freebsd.org/ports/tree/x11-toolkits/libxfce4gui/>x11-toolkits/libxfce4gui</a></p></li><li><p>libutil: <a class=package href=https://cgit.freebsd.org/ports/tree/x11/libxfce4util/>x11/libxfce4util</a></p></li><li><p>libmcs: <a class=package href=https://cgit.freebsd.org/ports/tree/x11/libxfce4mcs/>x11/libxfce4mcs</a></p></li><li><p>mcsmanager: <a class=package href=https://cgit.freebsd.org/ports/tree/sysutils/xfce4-mcs-manager/>sysutils/xfce4-mcs-manager</a></p></li><li><p>panel: <a class=package href=https://cgit.freebsd.org/ports/tree/x11-wm/xfce4-panel/>x11-wm/xfce4-panel</a></p></li><li><p>thunar: <a class=package href=https://cgit.freebsd.org/ports/tree/x11-fm/thunar/>x11-fm/thunar</a></p></li><li><p>wm: <a class=package href=https://cgit.freebsd.org/ports/tree/x11-wm/xfce4-wm/>x11-wm/xfce4-wm</a></p></li><li><p>xfdev: <a class=package href=https://cgit.freebsd.org/ports/tree/dev/xfce4-dev-tools/>dev/xfce4-dev-tools</a></p></li></ul></div><div class=paragraph><p>Распознаются следующие дополнительные параметры:</p></div><div class=ulist><ul><li><p>configenv: Используйте, если ваш порт требует специально измененного значения <code>CONFIGURE_ENV</code> для поиска требуемых для порта библиотек.</p><div class="literalblock programlisting"><div class=content><pre>-I${LOCALBASE}/include -L${LOCALBASE}/lib</pre></div></div><div class=paragraph><p>добавляется в CPPFLAGS к <code>CONFIGURE_ENV</code>.</p></div></li></ul></div><div class=paragraph><p>Следовательно, если у порта имеется зависимость от <a class=package href=https://cgit.freebsd.org/ports/tree/sysutils/xfce4-mcs-manager/>sysutils/xfce4-mcs-manager</a>, и порт требует специальных CPPFLAGS в своем окружении configure, то синтаксис будет следующим:</p></div><div class="literalblock programlisting"><div class=content><pre>USE_XFCE=	mcsmanager configenv</pre></div></div></div></div><div class=sect1><h2 id=using-mozilla>6.23. Использование Mozilla<a class=anchor href=#using-mozilla></a></h2><div class=sectionbody><table class="tableblock frame-none grid-all stretch"><caption class=title>Таблица 43. Переменные для портов, использующих Mozilla</caption><col style=width:50%><col style=width:50%><tbody><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>USE_GECKO</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Один из бэкэндов Gecko, с которым может работать порт. Возможные значения: <code>libxul</code> (<span class=filename>libxul.so</span>), <code>seamonkey</code> (<span class=filename>libgtkembedmoz.so</span>, устаревший, больше не должен использоваться).</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>USE_FIREFOX</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Для запуска порта требуется Firefox. Возможные значения: <code>yes</code> (версия по умолчанию), <code>40</code>, <code>36</code>, <code>35</code>. По умолчанию устанавливает зависимость от версии <code>40</code>.</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>USE_FIREFOX_BUILD</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Для построения порта требуется Firefox. Возможные значения: смотрите USE_FIREFOX. Автоматически устанавливает USE_FIREFOX с присвоением того же значения.</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>USE_SEAMONKEY</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Для запуска порта требуется SeaMonkey. Возможные значения: <code>yes</code> (версия по умолчанию), <code>20</code>, <code>11</code> (устарело, больше не должно использоваться). По умолчанию устанавливает зависимость от версии <code>20</code>.</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>USE_SEAMONKEY_BUILD</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Для построения порта требуется SeaMonkey. Возможные значения: смотрите USE_SEAMONKEY. Автоматически устанавливает USE_SEAMONKEY с присвоением того же значения.</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>USE_THUNDERBIRD</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Для запуска порта требуется Thunderbird. Возможные значения: <code>yes</code> (версия по умолчанию), <code>31</code>, <code>30</code> (устарело, больше не должно использоваться). По умолчанию устанавливает зависимость от версии <code>31</code>.</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>USE_THUNDERBIRD_BUILD</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Для построения порта требуется Thunderbird. Возможные значения: смотрите USE_THUNDERBIRD. Автоматически устанавливает USE_THUNDERBIRD с присвоением того же значения.</p></td></tr></tbody></table><div class=paragraph><p>Полный перечень доступных переменных можно получить в файле <span class=filename>/usr/ports/Mk/bsd.gecko.mk</span>.</p></div></div></div><div class=sect1><h2 id=using-databases>6.24. Использование баз данных<a class=anchor href=#using-databases></a></h2><div class=sectionbody><table class="tableblock frame-none grid-all stretch"><caption class=title>Таблица 44. Переменные для портов, использующих базы данных</caption><col style=width:50%><col style=width:50%><thead><tr><th class="tableblock halign-left valign-top">Переменная</th><th class="tableblock halign-left valign-top">Значение</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>USE_BDB</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Если переменная установлена в <code>yes</code>, добавляет зависимость от порта <a class=package href=https://cgit.freebsd.org/ports/tree/databases/db41/>databases/db41</a>. Также переменной можно присвоить значения: 2, 3, 40, 41, 42, 43, 44, 46, 47, 48 или 51. Вы можете объявить диапазон принимаемых значений, <code>USE_BDB</code>=42+ будет искать установленную версию с наибольшим номером, и, если ничего не установлено, вернется к 42.</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>USE_MYSQL</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Если переменная установлена в <code>yes</code>, добавляет зависимость от порта <a class=package href=https://cgit.freebsd.org/ports/tree/databases/mysql55-client/>databases/mysql55-client</a>. Как связанная переменная, <code>WANT_MYSQL_VER</code> может быть установлена в значение 323, 40, 41, 50, 51, 52, 55 или 60.</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>USE_PGSQL</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Если установлена в <code>yes</code>, добавляет зависимость от порта <a class=package href=https://cgit.freebsd.org/ports/tree/databases/postgresql90-client/>databases/postgresql90-client</a>. Как связанная переменная, <code>WANT_PGSQL_VER</code> может быть установлена в значение 83, 84, 90, 91 или 92. Вы можете указать максимальное и минимальное значения; <code>WANT_PGSQL_VER=90+</code> сделает порт зависимым от минимальной версии 9.0.</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>USE_SQLITE</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Если переменная имеет значение <code>yes</code>, добавляет зависимость от порта <a class=package href=https://cgit.freebsd.org/ports/tree/databases/sqlite3/>databases/sqlite3</a>. Переменная может принимать значения: 3, 2.</p></td></tr></tbody></table><div class=paragraph><p>Подробнее смотрите в <a href="http://svnweb.FreeBSD.org/ports/head/Mk/bsd.database.mk?view=markup">bsd.database.mk</a>.</p></div></div></div><div class=sect1><h2 id=rc-scripts>6.25. Запуск и остановка служб (сценарии <code>rc</code>)<a class=anchor href=#rc-scripts></a></h2><div class=sectionbody><div class=paragraph><p>Сценарии <span class=filename>rc.d</span> используются для запуска служб при запуске системы и дают администратору стандартный способ остановки, запуска и перезапуска службы. Порты интегрируются в системную инфраструктуру <span class=filename>rc.d</span>. Подробности по её использованию можно найти в <a href=https://docs.freebsd.org/ru/books/handbook/config-tuning/#configtuning-rcd>главе rc.d Руководства</a>. Подробное объяснение доступных команд находится в <a href="https://man.freebsd.org/cgi/man.cgi?query=rc&amp;sektion=8&amp;format=html">rc(8)</a> и <a href="https://man.freebsd.org/cgi/man.cgi?query=rc.subr&amp;sektion=8&amp;format=html">rc.subr(8)</a>. Наконец, есть <a href=https://docs.freebsd.org/en/articles/rc-scripting/>статья</a>о практических аспектах написания сценариев <span class=filename>rc.d</span>.</p></div><div class=paragraph><p>Установить можно один или более сценариев <span class=filename>rc.d</span>:</p></div><div class="literalblock programlisting"><div class=content><pre>USE_RC_SUBR=	doormand</pre></div></div><div class=paragraph><p>Сценарии обязаны размещаться в подкаталоге <span class=filename>files</span> с обязательным добавлением суффикса <code>.in</code> к имени файла. Для этого файла будут использоваться стандартные расширения <code>SUB_LIST</code>. Также особенно приветствуется использование расширений <code>%%PREFIX%%</code> и <code>%%LOCALBASE%%</code>. Подробнее о <code>SUB_LIST</code> в <a href=#using-sub-files>соответствующей главе</a>.</p></div><div class=paragraph><p>Начиная с FreeBSD 6.1-RELEASE локальные сценарии <span class=filename>rc.d</span> (включая установленные из портов) включены в общий <a href="https://man.freebsd.org/cgi/man.cgi?query=rcorder&amp;sektion=8&amp;format=html">rcorder(8)</a> основной системы.</p></div><div class=paragraph><p>Пример простого сценария <span class=filename>rc.d</span>:</p></div><div class="literalblock programlisting"><div class=content><pre>#!/bin/sh

# $FreeBSD$
#
# PROVIDE: doormand
# REQUIRE: LOGIN
# KEYWORD: shutdown
#
# Add the following lines to /etc/rc.conf.local or /etc/rc.conf
# to enable this service:
#
# doormand_enable (bool):	Set to NO by default.
#				Set it to YES to enable doorman.
# doormand_config (path):	Set to %%PREFIX%%/etc/doormand/doormand.cf
#				by default.

. /etc/rc.subr

name=doormand
rcvar=doormand_enable

load_rc_config $name

: ${doormand_enable:=&#34;NO&#34;}
: ${doormand_config=&#34;%%PREFIX%%/etc/doormand/doormand.cf&#34;}

command=%%PREFIX%%/sbin/${name}
pidfile=/var/run/${name}.pid

command_args=&#34;-p $pidfile -f $doormand_config&#34;

run_rc_command &#34;$1&#34;</pre></div></div><div class=paragraph><p>Если нет стоящей причины запускать службы раньше всех портов, сценарии должны использовать</p></div><div class="literalblock programlisting"><div class=content><pre>REQUIRE: LOGIN</pre></div></div><div class=paragraph><p>Если служба работает под определенным пользователем (отличным от root), то это делается принудительно. В сценарий выше включена конструкция</p></div><div class="literalblock programlisting"><div class=content><pre>KEYWORD: shutdown</pre></div></div><div class=paragraph><p>потому что вымышленный порт, который мы используем в качестве примера, запускает службу, и она должна корректно завершиться при выключении системы. Если сценарий не запускает постоянную службу, то это не является необходимым.</p></div><div class=paragraph><p>Для необязательных элементов конфигурации присвоение переменной по умолчанию в стиле "=" является более предпочтительным по сравнению со стилем ":=", используемым здесь, поскольку первый устанавливает значение по умолчанию только если переменная не установлена, а последний устанавливает её, если переменная не установлена <em>или</em> обнулена. Пользователь вполне может написать в своем файле <span class=filename>rc.conf.local</span> что-нибудь типа</p></div><div class="literalblock programlisting"><div class=content><pre>doormand_flags=&#34;&#34;</pre></div></div><div class=paragraph><p>и тогда произойдет неуместная подстановка переменной с использованием ":=", что переопределит намерения пользователя. Переменная <code>_enable</code> является обязательной; значением по умолчанию должно быть ":".</p></div><div class=sect2><h3 id=_контрольный_список_перед_внесением_изменений>6.25.1. Контрольный список перед внесением изменений<a class=anchor href=#_контрольный_список_перед_внесением_изменений></a></h3><div class=paragraph><p>Перед тем, как отсылать порт со сценарием <span class=filename>rc.d</span>, и тем более перед его коммитом, сверьтесь со следующим контрольным списком, чтобы убедиться, что порт для этого готов.</p></div><div class=paragraph><p>Большинство из этих проверок умеет выполнять порт <a class=package href=https://cgit.freebsd.org/ports/tree/devel/rclint/>devel/rclint</a>, но это не является заменой надлежащему просмотру.</p></div><div class="exampleblock procedure"><div class=content><div class="olist arabic"><ol class=arabic><li><p>Если это новый файл, заканчивается ли он на <span class=filename>.sh</span>? Если это так, то имя файла должно быть изменено на <span class=filename>file.in</span>, поскольку файлы <span class=filename>rc.d</span> не могут оканчиваться на такое расширение.</p></li><li><p>Присутствует ли в файле тег <code>$FreeBSD$</code>?</p></li><li><p>Соответствуют ли друг другу имя файла (без <span class=filename>.in</span>), строка <code>PROVIDE</code> и <code>$</code><em>name</em>? Имя файла, совпадающее с <code>PROVIDE</code>, упрощает отладку, особенно для проблем, связанных с <a href="https://man.freebsd.org/cgi/man.cgi?query=rcorder&amp;sektion=8&amp;format=html">rcorder(8)</a>. Соответствие имени файла и <code>$</code><em>name</em> также упрощает понимание, какие переменные имеют отношение к сценарию в <span class=filename>rc.conf[.local]</span>. Последнее также является тем, что вы могли бы назвать "политикой" для всех новых сценариев, включая те, что входят в базовую систему.</p></li><li><p>Содержит ли строка <code>REQUIRE</code> значение LOGIN? Это условие обязательно для сценариев, работающих не из-под суперпользователя. Если сценарий запускается из-под суперпользователя, то стоит ли его запускать до <code>LOGIN</code>? Если нет, то его следует запускать после, так чтобы мы могли свободно сгруппировать локальные сценарии в той точке <a href="https://man.freebsd.org/cgi/man.cgi?query=rcorder&amp;sektion=8&amp;format=html">rcorder(8)</a>, когда почти все сценарии в базовой системе уже стартовали.</p></li><li><p>Запускает ли сценарий постоянную службу? Если да, то он должен иметь <code>KEYWORD: shutdown</code>.</p></li><li><p>Убедитесь в том, что в сценарии отсутствует <code>KEYWORD: FreeBSD</code>. Это перестало быть нужным и нежелательно уже много лет. Это также служит индикатором того, что новый сценарий был скопирован со старого, поэтому особое внимание должно быть уделено при проверке.</p></li><li><p>Если сценарий использует интерпретируемый язык, такой как <code>perl</code>, <code>python</code> или <code>ruby</code>, то убедитесь, что значение <code>command_interpreter</code> установлено должным образом. В противном случае</p><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># service name stop</span></code></pre></div></div><div class=paragraph><p>возможно будет работать неправильно. Смотрите <a href="https://man.freebsd.org/cgi/man.cgi?query=service&amp;sektion=8&amp;format=html">service(8)</a> для дополнительной информации.</p></div></li><li><p>Все ли вхождения <span class=filename>/usr/local</span> были заменены на <code>%%PREFIX%%</code>?</p></li><li><p>Идет ли присвоение переменным значений по умолчанию после <code>load_rc_config</code>?</p></li><li><p>Используются ли пустые строки при присвоении значений по умолчанию? Такие присвоения должны быть удалены, но перепроверьте, что эти параметры задокументированы в комментариях в начале файла.</p></li><li><p>Действительно ли в сценариях используются значения, присвоенные переменным?</p></li><li><p>Являются ли параметры по умолчанию, перечисленные в <em>name</em><code>_flags</code>, обязательными? Если это так, то их следует поместить в <code>command_args</code>. Параметр <code>-d</code> здесь - это как красный флаг (прошу прощения за каламбур), поскольку обычно он применяется для "демонизации" процесса и поэтому на самом деле обязательный.</p></li><li><p>Никогда не включайте переменную <em>name</em><code>_flags</code> в <code>command_args</code> (и наоборот; в прочем, такая ошибка встречается реже).</p></li><li><p>Запускает ли сценарий какой-либо код безусловно? Это нехорошо. Обычно такие вещи могут/должны помещаться в <code>start_precmd</code>.</p></li><li><p>Все логические условия должны использовать функцию <code>checkyesno</code>. Не пишите самописных проверок для <code>[Yy][Ee][Ss]</code>, и так далее.</p></li><li><p>Если в сценарии выполняется цикл (например, ожидание чего-либо перед стартом), используется ли счетчик для завершения цикла? Мы не хотим бесконечного ожидания загрузки в случае возникновения ошибки.</p></li><li><p>Создает ли сценарий файлы или каталоги, которым нужны особые права доступа? Например, файл <span class=filename>pid</span>, который должен принадлежать пользователю, из-под которого запускается процесс. Вместо традиционных команд <a href="https://man.freebsd.org/cgi/man.cgi?query=touch&amp;sektion=1&amp;format=html">touch(1)</a>/<a href="https://man.freebsd.org/cgi/man.cgi?query=chown&amp;sektion=8&amp;format=html">chown(8)</a>/<a href="https://man.freebsd.org/cgi/man.cgi?query=chmod&amp;sektion=1&amp;format=html">chmod(1)</a> подумайте об использовании <a href="https://man.freebsd.org/cgi/man.cgi?query=install&amp;sektion=1&amp;format=html">install(1)</a> с подходящими аргументами командной строки, для того чтобы выполнить всю процедуру за один шаг.</p></li></ol></div></div></div></div></div></div><div class=sect1><h2 id=users-and-groups>6.26. Добавление пользователей и групп<a class=anchor href=#users-and-groups></a></h2><div class=sectionbody><div class=paragraph><p>Некоторые порты требуют в установленной системе наличие определенного пользователя. Выберите свободный UID в диапазоне от 50 до 999 и зарегистрируйте его в <span class=filename>ports/UIDs</span> (для пользователей) и/или в <span class=filename>ports/GIDs</span> (для групп). Удостоверьтесь, что не используете UID, уже используемый системой или другими портами.</p></div><div class=paragraph><p>Пожалуйста, включите в патч изменение для этих двух файлов, если вам требуется создать нового пользователя или группу для вашего порта.</p></div><div class=paragraph><p>Затем вы сможете использовать в вашем <span class=filename>Makefile</span> переменные <code>USERS</code> и <code>GROUPS</code>, и пользователь автоматически создастся при установке порта.</p></div><div class="literalblock programlisting"><div class=content><pre>USERS=	pulse
GROUPS=	pulse pulse-access pulse-rt</pre></div></div><div class=paragraph><p>Текущий перечень зарезервированных UID и GID находится в <span class=filename>ports/UIDs</span> и <span class=filename>ports/GIDs</span>.</p></div></div></div><div class=sect1><h2 id=requiring-kernel-sources>6.27. Порты, требующие наличия исходных текстов ядра<a class=anchor href=#requiring-kernel-sources></a></h2><div class=sectionbody><div class=paragraph><p>Некоторым портам (таким как загружаемые модули ядра) для компиляции нужны файлы с исходными текстами ядра. Ниже указан корректный способ определения, установлены ли они пользователем:</p></div><div class="literalblock programlisting"><div class=content><pre>USES=	kmod</pre></div></div><div class=paragraph><p>Кроме этой проверки, <code>kmod</code> заботится о большинстве пунктов, которые должны учитываться в этих портах.</p></div></div></div></div><hr><div class=last-modified><p><strong>Изменено</strong>: 9 марта 2024 г. by <a href="https://cgit.freebsd.org/doc/commit/?id=6199af92e7" target=_blank>Danilo G. Baio</a></p></div><div class=buttons><div class=prev><i class="fa fa-angle-left" aria-hidden=true title=Назад></i><div class=container><a href=http://172.16.201.134:1313/ru/books/porters-handbook/makefiles class=direction>Назад</a></div></div><div class=home><i class="fa fa-home" aria-hidden=true title=Главная></i><div class=container><a href=../ class=direction>Главная</a></div></div><div class=next><div class=container><a href=http://172.16.201.134:1313/ru/books/porters-handbook/plist class=direction>Далее</a></div><i class="fa fa-angle-right" aria-hidden=true title=Далее></i></div></div><label class="hidden book-menu-overlay" for=menu-control></label></div><aside class=toc><div class=toc-content><h3>Содержание</h3><nav id=TableOfContents><ul><li><a href=#staging>6.1. Staging</a></li><li><a href=#porting-shlibs>6.2. Динамические библиотеки</a></li><li><a href=#porting-restrictions>6.3. Порты с ограничениями на распространение или с правовым обременением</a></li><li><a href=#building>6.4. Механизмы построения</a></li><li><a href=#using-autotools>6.5. Использование GNU Autotools</a></li><li><a href=#using-gettext>6.6. Использование GNU <code>gettext</code></a></li><li><a href=#using-perl>6.7. Использование Perl</a></li><li><a href=#using-x11>6.8. Использование X11</a></li><li><a href=#using-gnome>6.9. Использование GNOME</a></li><li><a href=#using-qt>6.10. Использование Qt</a></li><li><a href=#using-kde>6.11. Использование KDE</a></li><li><a href=#using-java>6.12. Использование Java</a></li><li><a href=#using-php>6.13. Веб-приложения, Apache и PHP</a></li><li><a href=#using-python>6.14. Использование Python</a></li><li><a href=#using-tcl>6.15. Использование Tcl/Tk</a></li><li><a href=#using-emacs>6.16. Использование Emacs</a></li><li><a href=#using-ruby>6.17. Использование Ruby</a></li><li><a href=#using-sdl>6.18. Использование SDL</a></li><li><a href=#using-wx>6.19. Использование wxWidgets</a></li><li><a href=#using-lua>6.20. Использование Lua</a></li><li><a href=#using-iconv>6.21. Использование <code>iconv</code></a></li><li><a href=#using-xfce>6.22. Использование Xfce</a></li><li><a href=#using-mozilla>6.23. Использование Mozilla</a></li><li><a href=#using-databases>6.24. Использование баз данных</a></li><li><a href=#rc-scripts>6.25. Запуск и остановка служб (сценарии <code>rc</code>)</a></li><li><a href=#users-and-groups>6.26. Добавление пользователей и групп</a></li><li><a href=#requiring-kernel-sources>6.27. Порты, требующие наличия исходных текстов ядра</a></li></ul></nav><hr><div class=resources><h3>Материалы</h3><ul class=contents><li><i class="fa fa-file-pdf-o" aria-hidden=true title="Скачать PDF"></i><a href=https://download.freebsd.org/doc/ru/books/porters-handbook/porters-handbook_ru.pdf>Скачать PDF</a></li><li><i class="fa fa-pencil-square-o" aria-hidden=true title="Редактировать эту страницу"></i><a href=https://github.com/freebsd/freebsd-doc/blob/main/documentation/content/ru/_index target=_blank>Редактировать эту страницу</a></li></ul></div></div></aside><a class=to-top href=#top><i class="fa fa-arrow-circle-up" aria-hidden=true></i></a></main><footer><div class=footer-container><section class=logo-column><img src=http://172.16.201.134:1313/images/FreeBSD-colors.svg width=160 height=50 alt="FreeBSD logo"><div class=options-container><div class=language-container><a id=languages href=http://172.16.201.134:1313/ru/languages><img src=http://172.16.201.134:1313/images/language.png class=language-image alt="Выберите язык">
<span>Русский</span></a></div><div class=theme-container><select id=theme-chooser><option value=theme-system>Система</option><option value=theme-light>Светлый</option><option value=theme-dark>Тёмный</option><option value=theme-high-contrast>Высокая контрастность</option></select></div></div></section><section class=about-column><h3 class=column-title>О нас</h3><ul class=column-elements-container><li><a href=https://www.freebsd.org/about/ target=_blank class=column-element>FreeBSD</a></li><li><a href=https://freebsdfoundation.org/ target=_blank class=column-element>Фонд FreeBSD</a></li><li><a href=https://www.freebsd.org/where/ target=_blank class=column-element>Получить FreeBSD</a></li><li><a href=https://www.freebsd.org/internal/code-of-conduct target=_blank class=column-element>Кодекс Этики</a></li><li><a href=https://www.freebsd.org/security/ target=_blank class=column-element>Бюллетени Безопасности</a></li></ul></section><section class=documentation-column><h3 class=column-title>Документация</h3><ul class=column-elements-container><li><a href=/ru class=column-element>Портал документации</a></li><li><a href=https://man.FreeBSD.org target=_blank class=column-element>Страницы Справочника</a></li><li><a href=https://papers.FreeBSD.org target=_blank class=column-element>Презентации и публикации</a></li><li><a href=https://docs-archive.freebsd.org/doc/ target=_blank class=column-element>Предыдущие версии</a></li><li><a href=https://docs-archive.freebsd.org/44doc/ target=_blank class=column-element>Документы 4.4BSD</a></li><li><a href=https://wiki.freebsd.org/ target=_blank class=column-element>Wiki</a></li></ul></section><section class=community-column><h3 class=column-title>Сообщество</h3><ul class=column-elements-container><li><a href=http://172.16.201.134:1313/ru/articles/contributing class=column-element>Принять участие</a></li><li><a href=https://forums.freebsd.org/ target=_blank class=column-element>Форум Сообщества</a></li><li><a href=https://lists.freebsd.org/ target=_blank class=column-element>Списки рассылки</a></li><li><a href=https://wiki.freebsd.org/IRC/Channels target=_blank class=column-element>Каналы IRC</a></li><li><a href=https://bugs.freebsd.org/bugzilla/ target=_blank class=column-element>Трекер ошибок</a></li></ul></section><section class=legal-column><h3 class=column-title>Юридическая информация</h3><ul class=column-elements-container><li><a href=https://freebsdfoundation.org/donate/ target=_blank class=column-element>Пожертвования</a></li><li><a href=https://www.freebsd.org/copyright/freebsd-license/ target=_blank class=column-element>Лицензирование</a></li><li><a href=https://www.freebsd.org/privacy/ target=_blank class=column-element>Политика Конфиденциальности</a></li><li><a href=https://www.freebsd.org/copyright/ target=_blank class=column-element>Юридические оговорки</a></li></ul></section><section class=copyright-column><p>&copy; 1994-2024 Проект FreeBSD. Все права защищены</p><span>Сделано с помощью <span class=heart>♥</span> Сообществом FreeBSD</span></section></div></footer></body></html>