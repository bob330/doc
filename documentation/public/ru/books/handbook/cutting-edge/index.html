<!doctype html><html class=theme-light lang=ru><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content><meta name=keywords content><meta name=copyright content="1995-2024 The FreeBSD Foundation"><link rel=canonical href=https://docs.freebsd.org/ru/books/handbook/cutting-edge/><title>Глава 21. Обновление системы и смена версии FreeBSD | FreeBSD Documentation Portal</title>
<meta name=theme-color content="#790000"><meta name=color-scheme content="system light dark high-contrast"><link rel="shortcut icon" href=https://docs.freebsd.org/favicon.ico><link rel=stylesheet href=https://docs.freebsd.org/styles/main.min.css><link rel=stylesheet href=https://docs.freebsd.org/css/font-awesome-min.css><script defer src=/js/theme-chooser.min.js></script><script defer src=/js/copy-clipboard.min.js></script><script defer src=/js/search.min.js></script><meta name=twitter:card content="summary"><meta name=twitter:domain content="docs.FreeBSD.org"><meta name=twitter:site content="@freebsd"><meta name=twitter:url content="https://twitter.com/freebsd"><meta property="og:title" content="Глава 21. Обновление системы и смена версии FreeBSD"><meta property="og:description" content><meta property="og:type" content="website"><meta property="og:image" content="https://docs.freebsd.org/favicon.ico"><meta property="og:image:alt" content="FreeBSD Logo"><meta property="og:locale" content="ru"><meta property="og:url" content="https://docs.freebsd.org/ru/books/handbook/cutting-edge/"><meta property="og:site_name" content="FreeBSD Documentation Portal"><script type=application/ld+json>{"@context":"http://schema.org","@type":"Article","url":"https:\/\/docs.freebsd.org\/ru\/books\/handbook\/cutting-edge\/","name":"FreeBSD Documentation Portal","headline":"FreeBSD Documentation Portal","description":"FreeBSD Documentation Portal"}</script></head><body><header><div class=header-container><div class=logo-menu-bars-container><a href=https://www.FreeBSD.org class=logo><img src=https://docs.freebsd.org/images/FreeBSD-monochromatic.svg width=160 height=50 alt="FreeBSD logo">
</a><label class=menu-bars for=menu-bars><i class="fa fa-bars" aria-hidden=true></i></label></div><input id=menu-bars type=checkbox><nav><ul class=menu><li class=menu-item><input id=about type=checkbox>
<a href=# aria-label="Navigate to About section"><label class=menu-item-description for=about>О нас
<i class="fa fa-angle-down fa-lg" aria-hidden=true></i></label></a><ul class=sub-menu><li class=title><a href=https://www.freebsd.org/about/ target=_blank>О нас</a></li><li><a href=https://www.freebsd.org/about/ target=_blank>FreeBSD</a></li><li><a href=https://freebsdfoundation.org/about-us/about-the-foundation/ target=_blank>Фонд FreeBSD</a></li><li><a href=https://www.freebsd.org/internal/code-of-conduct/ target=_blank>Кодекс Этики</a></li></ul></li><li class=menu-item><input id=download type=checkbox>
<a href=# aria-label="Navigate to get FreeBSD section"><label class=menu-item-description for=download>Получить FreeBSD
<i class="fa fa-angle-down fa-lg" aria-hidden=true></i></label></a><ul class=sub-menu><li class=title><a href=https://www.freebsd.org/where/ target=_blank>Получить FreeBSD</a></li><li><a href=https://www.freebsd.org/releases/ target=_blank>Информация о релизах</a></li><li><a href=https://www.freebsd.org/releng/ target=_blank>Подготовка релизов</a></li><li><a href=https://www.freebsd.org/security/ target=_blank>Бюллетени Безопасности</a></li></ul></li><li class=menu-item><input id=documentation type=checkbox>
<a href=# aria-label="Navigate to get Documentation section"><label class=menu-item-description for=documentation>Документация
<i class="fa fa-angle-down fa-lg" aria-hidden=true></i></label></a><ul class=sub-menu><li class=title><a href=/ru>Портал документации</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook>Руководство</a></li><li><a href=https://docs.freebsd.org/ru/books/porters-handbook>Руководство по созданию портов</a></li><li><a href=https://docs.FreeBSD.org/en/books/fdp-primer>Учебник Проекта Документирования</a></li><li><a href=https://man.FreeBSD.org target=_blank>Страницы Справочника</a></li><li><a href=https://papers.FreeBSD.org target=_blank>Презентации и публикации</a></li><li><a href=https://wiki.FreeBSD.org target=_blank>Wiki</a></li><li><a href=https://docs.freebsd.org/ru/books>Книги</a></li><li><a href=https://docs.freebsd.org/ru/articles>Статьи</a></li></ul></li><li class=menu-item><input id=community type=checkbox>
<a href=# aria-label="Navigate to get Community section"><label class=menu-item-description for=community>Сообщество
<i class="fa fa-angle-down fa-lg" aria-hidden=true></i></label></a><ul class=sub-menu><li class=title><a href=https://www.freebsd.org/community/>Сообщество</a></li><li><a href=https://docs.freebsd.org/ru/articles/contributing>Стать участником</a></li><li><a href=https://forums.freebsd.org/ target=_blank>Форум</a></li><li><a href=https://lists.freebsd.org/ target=_blank>Списки рассылки</a></li><li><a href=https://wiki.freebsd.org/IRC/Channels target=_blank>Каналы IRC</a></li><li><a href=https://bugs.freebsd.org/bugzilla/ target=_blank>Трекер ошибок</a></li><li><a href=https://www.freebsd.org/support/ target=_blank>Поддержка</a></li></ul></li></ul></nav><div class=search-donate-container><form class=search method=get id=search-header-form action=https://docs.freebsd.org/search name=search-header-form><input type=hidden name=DB value=ru>
<input id=words name=P type=text size=20 maxlength=255>
<button>
<i class="fa fa-search" aria-hidden=true></i></button></form><div class=donate><a href=https://freebsdfoundation.org/donate/ target=_blank><span class=heart>♥</span>
Пожертвования</a></div></div></div></header><input type=checkbox class="hidden toggle" id=menu-control><main class=main-wrapper-book><a id=top></a><aside class=book-menu><div class=book-menu-content><input id=search-book type=text placeholder=Поиск aria-label=Поиск maxlength=128><nav id=MenuContents><ul><li><input type=checkbox id=chapter-eb2a98ce203d8afd517726e6d8776be3 class=toggle>
<label class="icon cursor" for=chapter-eb2a98ce203d8afd517726e6d8776be3><a role=button></a></label><a href=https://docs.freebsd.org/ru/books/handbook/preface/>Предисловие</a><ul><li><a href=https://docs.freebsd.org/ru/books/handbook/preface/#preface-audience>Целевая аудитория</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/preface/#preface-changes-from4>Четвёртое издание</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/preface/#preface-changes-from3>Третье издание</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/preface/#preface-changes-from2>Второе издание (2004)</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/preface/#preface-changes>Первое издание (2001)</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/preface/#preface-overview>Структура этой книги</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/preface/#preface-conv>Договоренности, используемые в этой книге</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/preface/#preface-acknowledgements>Благодарности</a></li></ul></li><li><input type=checkbox id=chapter-14a525fce014b90b8a458a894818255a class=toggle>
<label for=chapter-14a525fce014b90b8a458a894818255a><a role=button></a></label><a href=https://docs.freebsd.org/ru/books/handbook/parti/>Часть I. В начале</a></li><li><input type=checkbox id=chapter-f9c9f3451644df30d224350da97d5da6 class=toggle>
<label class="icon cursor" for=chapter-f9c9f3451644df30d224350da97d5da6><a role=button></a></label><a href=https://docs.freebsd.org/ru/books/handbook/introduction/>Глава 1. Введение</a><ul><li><a href=https://docs.freebsd.org/ru/books/handbook/introduction/#introduction-synopsis>1.1. Краткий обзор</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/introduction/#nutshell>1.2. Добро пожаловать во FreeBSD!</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/introduction/#history>1.3. О Проекте FreeBSD</a></li></ul></li><li><input type=checkbox id=chapter-6aaec170775233b7c45f6cdcfb70d466 class=toggle>
<label class="icon cursor" for=chapter-6aaec170775233b7c45f6cdcfb70d466><a role=button></a></label><a href=https://docs.freebsd.org/ru/books/handbook/install/>Глава 2. Установка FreeBSD версий 8.X и более ранних</a><ul><li><a href=https://docs.freebsd.org/ru/books/handbook/install/#install-synopsis>2.1. Краткий обзор</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/install/#install-hardware>2.2. Аппаратные требования</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/install/#install-pre>2.3. Перед установкой</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/install/#install-start>2.4. Начало установки</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/install/#using-sysinstall>2.5. Введение в Sysinstall</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/install/#install-steps>2.6. Выделение дискового пространства</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/install/#install-choosing>2.7. Выбор устанавливаемых компонентов</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/install/#install-media>2.8. Выбор источника для установки</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/install/#install-final-warning>2.9. Подтверждение установки</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/install/#install-post>2.10. После установки</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/install/#install-trouble>2.11. Решение проблем</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/install/#install-advanced>2.12. Расширенное руководство по установке</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/install/#install-diff-media>2.13. Подготовка собственного источника установки</a></li></ul></li><li><input type=checkbox id=chapter-f693a3fa687a72d63ec8129ee302d664 class=toggle>
<label class="icon cursor" for=chapter-f693a3fa687a72d63ec8129ee302d664><a role=button></a></label><a href=https://docs.freebsd.org/ru/books/handbook/bsdinstall/>Глава 3. Установка FreeBSD версий 9.X и более поздних</a><ul><li><a href=https://docs.freebsd.org/ru/books/handbook/bsdinstall/#bsdinstall-synopsis>3.1. Краткий обзор</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/bsdinstall/#bsdinstall-hardware>3.2. Аппаратные требования</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/bsdinstall/#bsdinstall-pre>3.3. Перед установкой</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/bsdinstall/#bsdinstall-start>3.4. Начало установки</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/bsdinstall/#using-bsdinstall>3.5. Введение в bsdinstall</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/bsdinstall/#bsdinstall-netinstall>3.6. Установка по сети</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/bsdinstall/#bsdinstall-partitioning>3.7. Выделение дискового пространства</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/bsdinstall/#bsdinstall-final-warning>3.8. Завершение установки</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/bsdinstall/#bsdinstall-post>3.9. После установки</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/bsdinstall/#bsdinstall-install-trouble>3.10. Решение проблем</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/bsdinstall/#using-live-cd>3.11. Использование Live CD</a></li></ul></li><li><input type=checkbox id=chapter-9f6db261075f578742036fcc6000eecd class=toggle>
<label class="icon cursor" for=chapter-9f6db261075f578742036fcc6000eecd><a role=button></a></label><a href=https://docs.freebsd.org/ru/books/handbook/basics/>Глава 4. Основы UNIX</a><ul><li><a href=https://docs.freebsd.org/ru/books/handbook/basics/#basics-synopsis>4.1. Краткий обзор</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/basics/#consoles>4.2. Виртуальные консоли и терминалы</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/basics/#users-synopsis>4.3. Пользователи и основы управления учетными записями</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/basics/#permissions>4.4. Права доступа</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/basics/#dirstructure>4.5. Структура каталогов</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/basics/#disk-organization>4.6. Организация дисков</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/basics/#mount-unmount>4.7. Монтирование и размонтирование файловых систем</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/basics/#basics-processes>4.8. Процессы</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/basics/#basics-daemons>4.9. Даемоны, сигналы, уничтожение процессов</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/basics/#shells>4.10. Интерпретатор команд</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/basics/#editors>4.11. Текстовые редакторы</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/basics/#basics-devices>4.12. Устройства и файлы устройств</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/basics/#binary-formats>4.13. Бинарные форматы</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/basics/#basics-more-information>4.14. Дополнительная информация</a></li></ul></li><li><input type=checkbox id=chapter-01c5707e95d14c0ff84bf62600c958d1 class=toggle>
<label class="icon cursor" for=chapter-01c5707e95d14c0ff84bf62600c958d1><a role=button></a></label><a href=https://docs.freebsd.org/ru/books/handbook/ports/>Глава 5. Установка приложений: порты и пакеты</a><ul><li><a href=https://docs.freebsd.org/ru/books/handbook/ports/#ports-synopsis>5.1. Обзор</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/ports/#ports-overview>5.2. Обзор установки программного обеспечения</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/ports/#ports-finding-applications>5.3. Поиск программного обеспечения</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/ports/#packages-using>5.4. Использование бинарных пакетов</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/ports/#pkgng-intro>5.5. Использование pkgng для управления бинарными пакетами</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/ports/#ports-using>5.6. Использование Коллекции Портов</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/ports/#ports-nextsteps>5.7. Действия после установки</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/ports/#ports-broken>5.8. Обработка нерабочих портов</a></li></ul></li><li><input type=checkbox id=chapter-f56428b9e0d0b77cc8e863910f96bbde class=toggle>
<label class="icon cursor" for=chapter-f56428b9e0d0b77cc8e863910f96bbde><a role=button></a></label><a href=https://docs.freebsd.org/ru/books/handbook/wayland/>Глава 6. Wayland</a><ul><li><a href=https://docs.freebsd.org/ru/books/handbook/wayland/#wayland-synopsis>6.1. Общие сведения о Wayland</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/wayland/#wayland-wayfire>6.2. Композитный менеджер Wayfire</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/wayland/#wayland-hikari>6.3. Композитный менеджер Hikari</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/wayland/#wayland-sway>6.4. Композитный менеджер Sway</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/wayland/#wayland-xwayland>6.5. Использование Xwayland</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/wayland/#wayland-remotedesktop>6.6. Организация Удалённого Рабочего Стола при помощи VNC</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/wayland/#wayland-ly>6.7. Менеджер регистраций Wayland</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/wayland/#wayland-utilities>6.8. Полезные Инструменты</a></li></ul></li><li><input type=checkbox id=chapter-3405c00581365a8b5d16af70fe4d1b72 class=toggle>
<label class="icon cursor" for=chapter-3405c00581365a8b5d16af70fe4d1b72><a role=button></a></label><a href=https://docs.freebsd.org/ru/books/handbook/x11/>Глава 6. X Window System</a><ul><li><a href=https://docs.freebsd.org/ru/books/handbook/x11/#x11-synopsis>6.1. Обзор</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/x11/#x-understanding>6.2. Основы X</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/x11/#x-install>6.3. Установка X11</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/x11/#x-config>6.4. Конфигурация X11</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/x11/#x-fonts>6.5. Использование шрифтов в X11</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/x11/#x-xdm>6.6. Менеджеры экранов (Display Managers) X</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/x11/#x11-wm>6.7. Графические оболочки</a></li></ul></li><li><input type=checkbox id=chapter-0eab3565e8f59f5a8a896dfba7eb3680 class=toggle>
<label for=chapter-0eab3565e8f59f5a8a896dfba7eb3680><a role=button></a></label><a href=https://docs.freebsd.org/ru/books/handbook/partii/>Часть II. Общие задачи</a></li><li><input type=checkbox id=chapter-b33cf28993f3f7bf5baf036e79da0f39 class=toggle>
<label class="icon cursor" for=chapter-b33cf28993f3f7bf5baf036e79da0f39><a role=button></a></label><a href=https://docs.freebsd.org/ru/books/handbook/desktop/>Глава 7. Приложения для настольного компьютера</a><ul><li><a href=https://docs.freebsd.org/ru/books/handbook/desktop/#desktop-synopsis>7.1. Краткий обзор</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/desktop/#desktop-browsers>7.2. Браузеры</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/desktop/#desktop-productivity>7.3. Бизнес приложения</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/desktop/#desktop-viewers>7.4. Программы просмотра документов</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/desktop/#desktop-finance>7.5. Финансовые программы</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/desktop/#desktop-summary>7.6. Итоги</a></li></ul></li><li><input type=checkbox id=chapter-152f694a19312ad72ec7bb4e1c3c33b2 class=toggle>
<label class="icon cursor" for=chapter-152f694a19312ad72ec7bb4e1c3c33b2><a role=button></a></label><a href=https://docs.freebsd.org/ru/books/handbook/multimedia/>Глава 8. Мультимедиа</a><ul><li><a href=https://docs.freebsd.org/ru/books/handbook/multimedia/#multimedia-synopsis>8.1. Краткий обзор</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/multimedia/#sound-setup>8.2. Настройка звуковой карты</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/multimedia/#sound-mp3>8.3. Звук MP3</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/multimedia/#video-playback>8.4. Воспроизведение видео</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/multimedia/#tvcard>8.5. Настройка ТВ тюнеров</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/multimedia/#scanners>8.6. Сканеры</a></li></ul></li><li><input type=checkbox id=chapter-80888b4ee02e3e409e5f71cf97a36450 class=toggle>
<label class="icon cursor" for=chapter-80888b4ee02e3e409e5f71cf97a36450><a role=button></a></label><a href=https://docs.freebsd.org/ru/books/handbook/kernelconfig/>Глава 9. Настройка ядра FreeBSD</a><ul><li><a href=https://docs.freebsd.org/ru/books/handbook/kernelconfig/#kernelconfig-synopsis>9.1. Краткий обзор</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/kernelconfig/#kernelconfig-custom-kernel>9.2. Зачем собирать собственное ядро?</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/kernelconfig/#kernelconfig-devices>9.3. Определение аппаратного обеспечения</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/kernelconfig/#kernelconfig-modules>9.4. Драйвера, подсистемы и модули ядра</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/kernelconfig/#kernelconfig-building>9.5. Сборка и установка собственного ядра</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/kernelconfig/#kernelconfig-config>9.6. Конфигурационный файл</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/kernelconfig/#kernelconfig-trouble>9.7. Решение проблем</a></li></ul></li><li><input type=checkbox id=chapter-cb174c55879b17ab955f2f16989a79e0 class=toggle>
<label class="icon cursor" for=chapter-cb174c55879b17ab955f2f16989a79e0><a role=button></a></label><a href=https://docs.freebsd.org/ru/books/handbook/printing/>Глава 10. Печать</a><ul><li><a href=https://docs.freebsd.org/ru/books/handbook/printing/#printing-synopsis>10.1. Краткий обзор</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/printing/#printing-intro-spooler>10.2. Введение</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/printing/#printing-intro-setup>10.3. Основная настройка</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/printing/#printing-advanced>10.4. Расширенная настройка принтера</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/printing/#printing-using>10.5. Использование принтеров</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/printing/#printing-lpd-alternatives>10.6. Альтернативы стандартному спулеру</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/printing/#printing-troubleshooting>10.7. Выявление проблем</a></li></ul></li><li><input type=checkbox id=chapter-c12b8c3f2a8fcefce87087241f695c83 class=toggle>
<label class="icon cursor" for=chapter-c12b8c3f2a8fcefce87087241f695c83><a role=button></a></label><a href=https://docs.freebsd.org/ru/books/handbook/linuxemu/>Глава 11. Двоичная совместимость с Linux</a><ul><li><a href=https://docs.freebsd.org/ru/books/handbook/linuxemu/#linuxemu-synopsis>11.1. Краткий обзор</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/linuxemu/#linuxemu-lbc-install>11.2. Установка</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/linuxemu/#linuxemu-mathematica>11.3. Установка Mathematica®</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/linuxemu/#linuxemu-maple>11.4. Установка Maple™</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/linuxemu/#linuxemu-matlab>11.5. Установка MATLAB®</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/linuxemu/#linuxemu-oracle>11.6. Установка Oracle®</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/linuxemu/#sapr3>11.7. Установка SAP® R/3®</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/linuxemu/#linuxemu-advanced>11.8. Дополнительные сведения</a></li></ul></li><li><input type=checkbox id=chapter-03b11ba627b9a0c85b247f5641bde272 class=toggle>
<label for=chapter-03b11ba627b9a0c85b247f5641bde272><a role=button></a></label><a href=https://docs.freebsd.org/ru/books/handbook/partiii/>Часть III. Системное администрирование</a></li><li><input type=checkbox id=chapter-6c31587f8d736319f099cd4dc1961301 class=toggle>
<label class="icon cursor" for=chapter-6c31587f8d736319f099cd4dc1961301><a role=button></a></label><a href=https://docs.freebsd.org/ru/books/handbook/config/>Глава 12. Настройка и оптимизация</a><ul><li><a href=https://docs.freebsd.org/ru/books/handbook/config/#config-synopsis>12.1. Введение</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/config/#configtuning-initial>12.2. Начальное конфигурирование</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/config/#configtuning-core-configuration>12.3. Основные настройки</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/config/#configtuning-appconfig>12.4. Настройка приложений</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/config/#configtuning-starting-services>12.5. Запуск сервисов</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/config/#configtuning-cron>12.6. Настройка утилиты <code>cron</code></a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/config/#configtuning-rcd>12.7. Использование rc во FreeBSD 5.X и последующих версиях</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/config/#config-network-setup>12.8. Настройка карт сетевых интерфейсов</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/config/#configtuning-virtual-hosts>12.9. Настройка виртуальных серверов</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/config/#configtuning-configfiles>12.10. Файлы настройки</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/config/#configtuning-sysctl>12.11. Настройка с помощью sysctl</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/config/#configtuning-disk>12.12. Оптимизация дисков</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/config/#configtuning-kernel-limits>12.13. Изменение ограничений, накладываемых ядром</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/config/#adding-swap-space>12.14. Увеличение объема подкачки</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/config/#acpi-overview>12.15. Управление питанием и ресурсами</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/config/#ACPI-debug>12.16. Использование и отладка FreeBSD ACPI</a></li></ul></li><li><input type=checkbox id=chapter-459f0012b3b4f0b6b123010f029da5e4 class=toggle>
<label class="icon cursor" for=chapter-459f0012b3b4f0b6b123010f029da5e4><a role=button></a></label><a href=https://docs.freebsd.org/ru/books/handbook/boot/>Глава 13. Процесс загрузки FreeBSD</a><ul><li><a href=https://docs.freebsd.org/ru/books/handbook/boot/#boot-synopsis>13.1. Описание</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/boot/#boot-introduction>13.2. Проблема загрузки</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/boot/#boot-blocks>13.3. Менеджер загрузки и этапы загрузки</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/boot/#boot-kernel>13.4. Взаимодействие с ядром во время загрузки</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/boot/#device-hints>13.5. Хинты устройств</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/boot/#boot-init>13.6. Init: инициализация управления процессами</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/boot/#boot-shutdown>13.7. Процесс остановки системы</a></li></ul></li><li><input type=checkbox id=chapter-917c75fcffbb14d48ed6d0a48e7028f2 class=toggle>
<label class="icon cursor" for=chapter-917c75fcffbb14d48ed6d0a48e7028f2><a role=button></a></label><a href=https://docs.freebsd.org/ru/books/handbook/security/>Глава 14. Безопасность</a><ul><li><a href=https://docs.freebsd.org/ru/books/handbook/security/#security-synopsis>14.1. Краткое описание</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/security/#security-intro>14.2. Введение</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/security/#securing-freebsd>14.3. Защита FreeBSD</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/security/#crypt>14.4. DES, MD5, и шифрование</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/security/#one-time-passwords>14.5. Одноразовые пароли</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/security/#tcpwrappers>14.6. TCP Wrappers</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/security/#kerberosIV>14.7. KerberosIV</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/security/#kerberos5>14.8. Kerberos5</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/security/#openssl>14.9. OpenSSL</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/security/#ipsec>14.10. VPN через IPsec</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/security/#openssh>14.11. OpenSSH</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/security/#fs-acl>14.12. Списки контроля доступа файловой системы (ACL)</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/security/#security-portaudit>14.13. Мониторинг вопросов безопасности в ПО сторонних разработчиков</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/security/#security-advisories>14.14. Сообщения безопасности FreeBSD</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/security/#security-accounting>14.15. Учёт используемых ресурсов</a></li></ul></li><li><input type=checkbox id=chapter-8f4620c77e572cbb58917911a33c73cf class=toggle>
<label class="icon cursor" for=chapter-8f4620c77e572cbb58917911a33c73cf><a role=button></a></label><a href=https://docs.freebsd.org/ru/books/handbook/mac/>Глава 15. Принудительный контроль доступа (MAC)</a><ul><li><a href=https://docs.freebsd.org/ru/books/handbook/mac/#mac-synopsis>15.1. Краткий обзор</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/mac/#mac-inline-glossary>15.2. Ключевые термины этой главы</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/mac/#mac-initial>15.3. Описание MAC</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/mac/#mac-understandlabel>15.4. Метки MAC</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/mac/#mac-modules>15.5. Настройка модулей</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/mac/#mac-bsdextended>15.6. Модуль MAC bsdextended</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/mac/#mac-ifoff>15.7. Модуль MAC ifoff</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/mac/#mac-portacl>15.8. Модуль MAC portacl</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/mac/#mac-labelingpolicies>15.9. Политики MAC, использующие метки</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/mac/#mac-partition>15.10. Модуль MAC partition</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/mac/#mac-mls>15.11. Модуль многоуровневой безопасности MAC (MLS)</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/mac/#mac-biba>15.12. Модуль MAC Biba</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/mac/#mac-lomac>15.13. Модуль MAC LOMAC</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/mac/#mac-implementing>15.14. Реализация защищенной среды с MAC</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/mac/#MAC-examplehttpd>15.15. Другой пример: Использование MAC для защиты веб сервера</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/mac/#mac-troubleshoot>15.16. Решение проблем с инфраструктурой MAC</a></li></ul></li><li><input type=checkbox id=chapter-9598d66a76cb3182057b6bcd775149a0 class=toggle>
<label class="icon cursor" for=chapter-9598d66a76cb3182057b6bcd775149a0><a role=button></a></label><a href=https://docs.freebsd.org/ru/books/handbook/audit/>Глава 16. Аудит событий безопасности</a><ul><li><a href=https://docs.freebsd.org/ru/books/handbook/audit/#audit-synopsis>16.1. Краткий обзор</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/audit/#audit-inline-glossary>16.2. Ключевые понятия</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/audit/#audit-config>16.3. Настройка системы аудита</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/audit/#audit-administration>16.4. Работа с журналами аудита</a></li></ul></li><li><input type=checkbox id=chapter-e1edcad13d9db6e8e4cb645d378ecfaf class=toggle>
<label class="icon cursor" for=chapter-e1edcad13d9db6e8e4cb645d378ecfaf><a role=button></a></label><a href=https://docs.freebsd.org/ru/books/handbook/disks/>Глава 17. Устройства хранения</a><ul><li><a href=https://docs.freebsd.org/ru/books/handbook/disks/#disks-synopsis>17.1. Краткий обзор</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/disks/#disks-naming>17.2. Имена устройств</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/disks/#disks-adding>17.3. Добавление дисков</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/disks/#raid>17.4. RAID</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/disks/#usb-disks>17.5. USB устройства хранения</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/disks/#creating-cds>17.6. Запись и использование оптических носителей (CD)</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/disks/#creating-dvds>17.7. Создание и использование оптических носителей (DVD)</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/disks/#floppies>17.8. Дискеты</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/disks/#backups-tapebackups>17.9. Создание и использование архивных копий на магнитной ленте</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/disks/#backups-floppybackups>17.10. Создание резервных копий на дискетах</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/disks/#backup-strategies>17.11. Стратегии резервного копирования</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/disks/#backup-basics>17.12. Основы технологии резервного копирования</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/disks/#disks-virtual>17.13. Сетевые файловые системы, файловые системы в памяти и с отображением в файл</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/disks/#snapshots>17.14. Мгновенные копии файловых систем</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/disks/#quotas>17.15. Квотирование файловых систем</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/disks/#disks-encrypting>17.16. Шифрование дисковых разделов</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/disks/#swap-encrypting>17.17. Шифрование области подкачки</a></li></ul></li><li><input type=checkbox id=chapter-dde37901a0e0ea32745b67607854900f class=toggle>
<label class="icon cursor" for=chapter-dde37901a0e0ea32745b67607854900f><a role=button></a></label><a href=https://docs.freebsd.org/ru/books/handbook/geom/>Глава 18. GEOM: Модульная инфраструктура преобразования дисковых запросов</a><ul><li><a href=https://docs.freebsd.org/ru/books/handbook/geom/#GEOM-synopsis>18.1. Краткий обзор</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/geom/#GEOM-intro>18.2. Введение в GEOM</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/geom/#GEOM-striping>18.3. RAID0 - Создание дисковой последовательности (Striping)</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/geom/#GEOM-mirror>18.4. RAID1 - Зеркалирование (Mirroring)</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/geom/#geom-ggate>18.5. Сетевые устройства GEOM Gate</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/geom/#geom-glabel>18.6. Метки дисковых устройств</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/geom/#geom-gjournal>18.7. Журналирование UFS средствами GEOM</a></li></ul></li><li><input type=checkbox id=chapter-7af71270807eb7b70cd3eedc6577b254 class=toggle>
<label class="icon cursor" for=chapter-7af71270807eb7b70cd3eedc6577b254><a role=button></a></label><a href=https://docs.freebsd.org/ru/books/handbook/filesystems/>Глава 19. Поддержка файловых систем</a><ul><li><a href=https://docs.freebsd.org/ru/books/handbook/filesystems/#filesystems-synopsis>19.1. Краткий обзор</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/filesystems/#filesystems-zfs>19.2. Файловая система ZFS</a></li></ul></li><li><input type=checkbox id=chapter-49f1e96591c090304ea532012257f4ef class=toggle>
<label class="icon cursor" for=chapter-49f1e96591c090304ea532012257f4ef><a role=button></a></label><a href=https://docs.freebsd.org/ru/books/handbook/l10n/>Глава 20. Локализация - использование и настройка i18n/L10n</a><ul><li><a href=https://docs.freebsd.org/ru/books/handbook/l10n/#l10n-synopsis>20.1. Краткий обзор</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/l10n/#using-localization>20.2. Использование локализации</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/l10n/#l10n-compiling>20.3. Поиск приложений i18n</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/l10n/#lang-setup>20.4. Настройка локализации для некоторых языков</a></li></ul></li><li><input type=checkbox id=chapter-dead2b4c5ea325dd390a9b0dccd8f763 class=toggle checked>
<label class="icon cursor" for=chapter-dead2b4c5ea325dd390a9b0dccd8f763><a role=button></a></label><a href=https://docs.freebsd.org/ru/books/handbook/cutting-edge/>Глава 21. Обновление системы и смена версии FreeBSD</a><ul><li><a href=https://docs.freebsd.org/ru/books/handbook/cutting-edge/#updating-upgrading-synopsis>21.1. Краткий обзор</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/cutting-edge/#updating-upgrading-freebsdupdate>21.2. Обновление FreeBSD</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/cutting-edge/#updating-upgrading-documentation>21.3. Обновление документации</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/cutting-edge/#current-stable>21.4. Использование ветви разработки</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/cutting-edge/#synching>21.5. Синхронизация исходных текстов</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/cutting-edge/#makeworld>21.6. Пересборка мира</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/cutting-edge/#small-lan>21.7. Отслеживание исходных текстов для нескольких машин</a></li></ul></li><li><input type=checkbox id=chapter-bbd25f9a194f9c39ca2d658c75767db5 class=toggle>
<label for=chapter-bbd25f9a194f9c39ca2d658c75767db5><a role=button></a></label><a href=https://docs.freebsd.org/ru/books/handbook/partiv/>Часть IV. Сетевые коммуникации</a></li><li><input type=checkbox id=chapter-499dab596afd7ddac77e80295314e0dd class=toggle>
<label class="icon cursor" for=chapter-499dab596afd7ddac77e80295314e0dd><a role=button></a></label><a href=https://docs.freebsd.org/ru/books/handbook/serialcomms/>Глава 22. Последовательные соединения</a><ul><li><a href=https://docs.freebsd.org/ru/books/handbook/serialcomms/#serial-synopsis>22.1. Краткое описание</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/serialcomms/#serial>22.2. Введение</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/serialcomms/#term>22.3. Терминалы</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/serialcomms/#dialup>22.4. Входящие соединения по модему</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/serialcomms/#dialout>22.5. Исходящие соединения по модему</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/serialcomms/#serialconsole-setup>22.6. Настройка последовательной консоли</a></li></ul></li><li><input type=checkbox id=chapter-95e4571c48bee1cced5e84a538d302e3 class=toggle>
<label class="icon cursor" for=chapter-95e4571c48bee1cced5e84a538d302e3><a role=button></a></label><a href=https://docs.freebsd.org/ru/books/handbook/ppp-and-slip/>Глава 23. PPP и SLIP</a><ul><li><a href=https://docs.freebsd.org/ru/books/handbook/ppp-and-slip/#ppp-and-slip-synopsis>23.1. Краткий обзор</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/ppp-and-slip/#userppp>23.2. PPP уровня пользователя</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/ppp-and-slip/#ppp>23.3. PPP уровня ядра</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/ppp-and-slip/#ppp-troubleshoot>23.4. Решение проблем с соединениями PPP</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/ppp-and-slip/#pppoe>23.5. Использование PPP через Ethernet (PPPoE)</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/ppp-and-slip/#pppoa>23.6. Использование PPP через ATM (PPPoA)</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/ppp-and-slip/#slip>23.7. Использование SLIP</a></li></ul></li><li><input type=checkbox id=chapter-f089ac726c401c9b4bd5c34a295e11bb class=toggle>
<label class="icon cursor" for=chapter-f089ac726c401c9b4bd5c34a295e11bb><a role=button></a></label><a href=https://docs.freebsd.org/ru/books/handbook/mail/>Глава 24. Электронная почта</a><ul><li><a href=https://docs.freebsd.org/ru/books/handbook/mail/#mail-synopsis>24.1. Краткий обзор</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/mail/#mail-using>24.2. Использование электронной почты</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/mail/#sendmail>24.3. Настройка sendmail</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/mail/#mail-changingmta>24.4. Установка другой почтовой программы</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/mail/#mail-trouble>24.5. Поиск и устранение неисправностей</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/mail/#mail-advanced>24.6. Расширенное руководство</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/mail/#outgoing-only>24.7. Настройка почты только для отправки</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/mail/#SMTP-dialup>24.8. Использование почты с коммутируемым соединением</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/mail/#SMTP-Auth>24.9. SMTP аутентификация</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/mail/#mail-agents>24.10. Почтовые программы пользователей</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/mail/#mail-fetchmail>24.11. Использование fetchmail</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/mail/#mail-procmail>24.12. Использование procmail</a></li></ul></li><li><input type=checkbox id=chapter-6de4de3fe925639d4175ce4b6f8c1829 class=toggle>
<label class="icon cursor" for=chapter-6de4de3fe925639d4175ce4b6f8c1829><a role=button></a></label><a href=https://docs.freebsd.org/ru/books/handbook/network-servers/>Глава 25. Сетевые серверы</a><ul><li><a href=https://docs.freebsd.org/ru/books/handbook/network-servers/#network-servers-synopsis>25.1. Краткий обзор</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/network-servers/#network-inetd>25.2. "Супер-сервер"inetd</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/network-servers/#network-nfs>25.3. Network File System (NFS)</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/network-servers/#network-nis>25.4. Network Information System (NIS/YP)</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/network-servers/#network-dhcp>25.5. Автоматическая настройка сети (DHCP)</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/network-servers/#network-dns>25.6. Domain Name System (DNS)</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/network-servers/#network-apache>25.7. Apache HTTP сервер</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/network-servers/#network-samba>25.8. Файл сервер и печать для Microsoft® Windows® клиентов (Samba)</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/network-servers/#network-ftp>25.9. Протокол передачи файлов (FTP)</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/network-servers/#network-ntp>25.10. Синхронизация часов через NTP</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/network-servers/#network-syslogd>25.11. * Remote Host Logging with <code>syslogd</code></a></li></ul></li><li><input type=checkbox id=chapter-776d855c7b75e048f90b5c2c9b35ffe0 class=toggle>
<label class="icon cursor" for=chapter-776d855c7b75e048f90b5c2c9b35ffe0><a role=button></a></label><a href=https://docs.freebsd.org/ru/books/handbook/firewalls/>Глава 26. Межсетевые экраны</a><ul><li><a href=https://docs.freebsd.org/ru/books/handbook/firewalls/#firewalls-intro>26.1. Введение</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/firewalls/#firewalls-concepts>26.2. Принципы работы межсетевых экранов</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/firewalls/#firewalls-apps>26.3. Пакеты межсетевых экранов</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/firewalls/#firewalls-pf>26.4. Packet Filter (PF, межсетевой экран OpenBSD) и ALTQ</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/firewalls/#firewalls-ipf>26.5. * IPFILTER (IPF)</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/firewalls/#firewalls-ipfw>26.6. IPFW</a></li></ul></li><li><input type=checkbox id=chapter-5b07f776a0e6155c1c89aa0d15610380 class=toggle>
<label class="icon cursor" for=chapter-5b07f776a0e6155c1c89aa0d15610380><a role=button></a></label><a href=https://docs.freebsd.org/ru/books/handbook/advanced-networking/>Глава 27. Сложные вопросы работы в сети</a><ul><li><a href=https://docs.freebsd.org/ru/books/handbook/advanced-networking/#advanced-networking-synopsis>27.1. Краткий обзор</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/advanced-networking/#network-routing>27.2. Сетевые шлюзы и маршруты</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/advanced-networking/#network-wireless>27.3. Беспроводные сети</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/advanced-networking/#network-bluetooth>27.4. Bluetooth</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/advanced-networking/#network-bridging>27.5. Мосты</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/advanced-networking/#network-diskless>27.6. Работа с бездисковыми станциями</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/advanced-networking/#network-isdn>27.7. ISDN</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/advanced-networking/#network-natd>27.8. Даемон преобразования сетевых адресов (natd)</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/advanced-networking/#network-plip>27.9. IP по параллельному порту (PLIP)</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/advanced-networking/#network-ipv6>27.10. IPv6</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/advanced-networking/#network-atm>27.11. Асинхронный режим передачи (ATM)</a></li></ul></li><li><input type=checkbox id=chapter-171a77aa9d067a1024f849470e1f33e8 class=toggle>
<label for=chapter-171a77aa9d067a1024f849470e1f33e8><a role=button></a></label><a href=https://docs.freebsd.org/ru/books/handbook/partv/>Часть V. Приложения</a></li><li><input type=checkbox id=chapter-8050f436a0a7986a4aaded93d8e49469 class=toggle>
<label class="icon cursor" for=chapter-8050f436a0a7986a4aaded93d8e49469><a role=button></a></label><a href=https://docs.freebsd.org/ru/books/handbook/mirrors/>Приложение A. Получение FreeBSD</a><ul><li><a href=https://docs.freebsd.org/ru/books/handbook/mirrors/#mirrors-cdrom>A.1. Наборы CD и DVD</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/mirrors/#mirrors-ftp>A.2. FTP сайты</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/mirrors/#ctm>A.3. Использование CTM</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/mirrors/#svn>A.4. Использование Subversion</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/mirrors/#mirrors-rsync>A.5. Использование rsync</a></li></ul></li><li><input type=checkbox id=chapter-128b630a8f88f158e7027fe6c2184d21 class=toggle>
<label class="icon cursor" for=chapter-128b630a8f88f158e7027fe6c2184d21><a role=button></a></label><a href=https://docs.freebsd.org/ru/books/handbook/bibliography/>Приложение B. Библиография</a><ul><li><a href=https://docs.freebsd.org/ru/books/handbook/bibliography/#bibliography-freebsd>B.1. Книги и журналы, специализирующиеся на FreeBSD</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/bibliography/#bibliography-userguides>B.2. Руководства для пользователей</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/bibliography/#bibliography-adminguides>B.3. Руководства для администраторов</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/bibliography/#bibliography-programmers>B.4. Руководства для программистов</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/bibliography/#bibliography-osinternals>B.5. Внутренности операционной системы</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/bibliography/#bibliography-security>B.6. Безопасность</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/bibliography/#bibliography-hardware>B.7. Оборудование</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/bibliography/#bibliography-history>B.8. История UNIX®</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/bibliography/#bibliography-journals>B.9. Прочие издания</a></li></ul></li><li><input type=checkbox id=chapter-8bbb8867c46dac315e2253945d8c18a8 class=toggle>
<label class="icon cursor" for=chapter-8bbb8867c46dac315e2253945d8c18a8><a role=button></a></label><a href=https://docs.freebsd.org/ru/books/handbook/eresources/>Приложение C. Ресурсы в интернет</a><ul><li><a href=https://docs.freebsd.org/ru/books/handbook/eresources/#eresources-mail>C.1. Списки рассылки</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/eresources/#eresources-news>C.2. Новостные группы Usenet</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/eresources/#eresources-web>C.3. Серверы World Wide Web</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/eresources/#eresources-email>C.4. Адреса Email</a></li></ul></li><li><input type=checkbox id=chapter-a80ea4f5a4480b8725422710f954ef36 class=toggle>
<label class="icon cursor" for=chapter-a80ea4f5a4480b8725422710f954ef36><a role=button></a></label><a href=https://docs.freebsd.org/ru/books/handbook/pgpkeys/>Приложение D. PGP ключи</a><ul><li><a href=https://docs.freebsd.org/ru/books/handbook/pgpkeys/#pgpkeys-officers>D.1. Офицеры</a></li></ul></li><li></li></ul></nav></div></aside><div class=book><div class=book-menu-mobile><label for=menu-control><span class=menu-control-button><i class="fa fa-list" aria-hidden=true title="Меню книг"></i>
Меню книг</span></label></div><h1 class=title>Глава 21. Обновление системы и смена версии FreeBSD</h1><div class="admonitionblock note"><p><i class="fa fa-exclamation-circle" aria-hidden=true></i>
Этот перевод может быть устаревшим. Для того, чтобы помочь с переводом, пожалуйста, обратитесь к <a href=https://translate-dev.freebsd.org/ target=_blank>Сервер переводов FreeBSD</a>.</p></div><div class=toc-mobile><h3>Содержание</h3><nav id=TableOfContents><ul><li><a href=#updating-upgrading-synopsis>21.1. Краткий обзор</a></li><li><a href=#updating-upgrading-freebsdupdate>21.2. Обновление FreeBSD</a></li><li><a href=#updating-upgrading-documentation>21.3. Обновление документации</a></li><li><a href=#current-stable>21.4. Использование ветви разработки</a></li><li><a href=#synching>21.5. Синхронизация исходных текстов</a></li><li><a href=#makeworld>21.6. Пересборка мира</a></li><li><a href=#small-lan>21.7. Отслеживание исходных текстов для нескольких машин</a></li></ul></nav></div><div class=book-content><div id=preamble><div class=sectionbody></div></div><div class=sect1><h2 id=updating-upgrading-synopsis>21.1. Краткий обзор<a class=anchor href=#updating-upgrading-synopsis></a></h2><div class=sectionbody><div class=paragraph><p>Между релизами над FreeBSD ведется постоянная работа. Некоторые отдают предпочтение официально выпущенным версиям, в то время как остальные предпочитают использовать последние разработки. Тем не менее, даже для официальных версий часто выходят обновления, связанные с безопасностью и другими критическими исправлениями. Независимо от используемой версии FreeBSD предоставляет все необходимые инструменты для поддержания системы в актуальном состоянии, а также позволяет легко перейти на другую версию. Эта глава описывает, как отслеживать систему в процессе её разработки, а также основные инструменты для поддержания системы FreeBSD в актуальном состоянии.</p></div><div class=paragraph><p>После чтения этой главы вы будете знать:</p></div><div class=ulist><ul><li><p>Как поддерживать систему FreeBSD в актуальном состоянии при помощи freebsd-update, Subversion или CTM.</p></li><li><p>Как узнать состояние установленной системы по отношению к известной нетронутой копии.</p></li><li><p>Как поддерживать установленную документацию в актуальном состоянии при помощи Subversion или портов документации.</p></li><li><p>Разницу между двумя ветвями разработки: FreeBSD-STABLE и FreeBSD-CURRENT.</p></li><li><p>Как перестраивать и переустанавливать всю базовую систему.</p></li></ul></div><div class=paragraph><p>Перед чтением этой главы вы должны:</p></div><div class=ulist><ul><li><p>Правильно настроить сетевое подключение (<a href=../advanced-networking/#advanced-networking>Сложные вопросы работы в сети</a>).</p></li><li><p>Знать, как устанавливать дополнительное стороннее программное обеспечение (<a href=../ports/#ports>Установка приложений. порты и пакеты</a>).</p></li></ul></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>В этой главе для получения и обновления исходных текстов FreeBSD используется команда <code>svn</code>. Для этого нужно сперва установить порт или пакет <a class=package href=https://cgit.freebsd.org/ports/tree/devel/subversion/>devel/subversion</a>.</p></div></td></tr></tbody></table></div></div></div><div class=sect1><h2 id=updating-upgrading-freebsdupdate>21.2. Обновление FreeBSD<a class=anchor href=#updating-upgrading-freebsdupdate></a></h2><div class=sectionbody><div class=paragraph><p>Своевременное применение обновлений безопасности и переход на более новую версию операционной системы - важные аспекты системного администрирования. FreeBSD включает в себя программу <code>freebsd-update</code>, которую можно использовать для решения обеих задач.</p></div><div class=paragraph><p>Эта программа используется для установки распространяемых в двоичном виде обновлений безопасности и исправлений для FreeBSD без необходимости ручной компиляции и установки патчей или нового ядра. Двоичные обновления доступны для всех архитектур и версий, поддерживаемых группой безопасности. Перечень поддерживаемых версий и их ожидаемые даты окончания поддержки указаны на странице <a href=http://www.FreeBSD.org/security/>http://www.FreeBSD.org/security/</a>.</p></div><div class=paragraph><p>Эта программа также используется для незначительных обновлений версии операционной системы, а также для перехода на другую ветвь выпуска релизов. Перед обновлением следует ознакомиться с объявлением о выпуске новой версии, так как там может содержаться важная информация, применимая к версии, на которую намечен переход. С соответствующими объявлениями можно ознакомиться по ссылке <a href=http://www.FreeBSD.org/releases/>http://www.FreeBSD.org/releases/</a>.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Если имеется задание <code>crontab</code>, запускающее <a href="https://man.freebsd.org/cgi/man.cgi?query=freebsd-update&amp;sektion=8&amp;format=html">freebsd-update(8)</a>, то перед сменой версии операционной системы его обязательно нужно выключить.</p></div></td></tr></tbody></table></div><div class=paragraph><p>В этом разделе описывается конфигурационный файл <code>freebsd-update</code>, демонстрируется применение исправлений безопасности и обновление операционной системы со сменой младшей или старшей версии, а также обсуждаются некоторые соображения касаемо смены версии операционной системы.</p></div><div class=sect2><h3 id=freebsdupdate-config-file>21.2.1. Конфигурационный файл<a class=anchor href=#freebsdupdate-config-file></a></h3><div class=paragraph><p>Конфигурационный файл <code>freebsd-update</code> самодостаточен и работает по умолчанию. Некоторые пользователи могут пожелать отредактировать конфигурационный файл <span class=filename>/etc/freebsd-update.conf</span> для лучшего контроля над процессом обновления. В комментариях описываются доступные в этом файле параметры, но для следующих из них может потребоваться дополнительное разъяснение:</p></div><div class="literalblock programlisting"><div class=content><pre># Components of the base system which should be kept updated.
Components world kernel</pre></div></div><div class=paragraph><p>Данный параметр определяет, какие части FreeBSD будут обновлены. По умолчанию обновляется вся базовая система (world) и ядро (kernel). Вместо этого можно указать отдельные компоненты, такие как <code>src/base</code> или <code>src/sys</code>. Тем не менее, лучшим вариантом будет оставить всё как есть, поскольку изменение этого перечня с целью добавления особых пунктов потребует от пользователя указания подряд всех пунктов. Со временем это может привести к негативным последствиям из-за возможной рассинхронизации между исходными текстами и двоичными файлами.</p></div><div class="literalblock programlisting"><div class=content><pre># Paths which start with anything matching an entry in an IgnorePaths
# statement will be ignored.
IgnorePaths /boot/kernel/linker.hints</pre></div></div><div class=paragraph><p>Добавьте сюда пути к каталогам (например, <span class=filename>/bin</span> или <span class=filename>/sbin</span>), которые вы бы хотели оставить нетронутыми в процессе обновления. Этот параметр можно использовать для предотвращения перезаписывания локальных изменений программой <code>freebsd-update</code>.</p></div><div class="literalblock programlisting"><div class=content><pre># Paths which start with anything matching an entry in an UpdateIfUnmodified
# statement will only be updated if the contents of the file have not been
# modified by the user (unless changes are merged; see below).
UpdateIfUnmodified /etc/ /var/ /root/ /.cshrc /.profile</pre></div></div><div class=paragraph><p>Этот параметр позволяет обновлять конфигурационные файлы в указанных каталогах, только если они не содержат изменений. При наличии каких-либо изменений со стороны пользователя автоматическое обновление таких файлов отменяется. Есть другой параметр <code>KeepModifiedMetadata</code>, который предписывает команде <code>freebsd-update</code> сохранять изменения в процессе слияния.</p></div><div class="literalblock programlisting"><div class=content><pre># When upgrading to a new FreeBSD release, files which match MergeChanges
# will have any local changes merged into the version from the new release.
MergeChanges /etc/ /var/named/etc/ /boot/device.hints</pre></div></div><div class=paragraph><p>Список каталогов с конфигурационными файлами, для которых <code>freebsd-update</code> попытается выполнить слияние. Процесс слияния файла представляет собой последовательность изменений в формате <a href="https://man.freebsd.org/cgi/man.cgi?query=diff&amp;sektion=1&amp;format=html">diff(1)</a>, похожую на <a href="https://man.freebsd.org/cgi/man.cgi?query=mergemaster&amp;sektion=8&amp;format=html">mergemaster(8)</a>, но с меньшим количеством параметров. Результат слияния принимается, открывается редактор или <code>freebsd-update</code> прекращает работу. В случае сомнений сделайте резервную копию <span class=filename>/etc</span> и просто согласитесь со всеми изменениями. Для получения подробной информации по команде <code>mergemaster</code> смотрите <a href=#mergemaster>Объединение файлов конфигурации</a>.</p></div><div class="literalblock programlisting"><div class=content><pre># Directory in which to store downloaded updates and temporary
# files used by FreeBSD Update.
# WorkDir /var/db/freebsd-update</pre></div></div><div class=paragraph><p>Этот каталог предназначен для размещения патчей и временных файлов. В случае, когда пользователь выполняет обновление со сменой версии, в этом месте нужно иметь по крайней мере гигабайт свободного дискового пространства.</p></div><div class="literalblock programlisting"><div class=content><pre># When upgrading between releases, should the list of Components be
# read strictly (StrictComponents yes) or merely as a list of components
# which *might* be installed of which FreeBSD Update should figure out
# which actually are installed and upgrade those (StrictComponents no)?
# StrictComponents no</pre></div></div><div class=paragraph><p>Если выставлено значение <code>yes</code>, то <code>freebsd-update</code> будет исходить из того, что список <code>Components</code> является полным, и не будет пытаться выполнить изменения за пределами этого списка. В действительности <code>freebsd-update</code> попытается обновить все файлы, которые принадлежат списку <code>Components</code>.</p></div></div><div class=sect2><h3 id=freebsdupdate-security-patches>21.2.2. Обновления безопасности<a class=anchor href=#freebsdupdate-security-patches></a></h3><div class=paragraph><p>Процесс применения обновлений безопасности FreeBSD был упрощён, что позволяет поддерживать систему в актуальном состоянии, используя <code>freebsd-update</code>. Для получения дополнительной информации по бюллетеням безопасности FreeBSD смотрите <a href=../security/#security-advisories>Сообщения безопасности FreeBSD</a>.</p></div><div class=paragraph><p>Обновления безопасности можно загрузить и установить с использованием следующих команд. Первая команда определяет наличие незагруженных обновлений и показывает файлы, которые будут изменены в процессе обновления. Вторая команда выполняет обновление.</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># freebsd-update fetch</span>
<span class=c># freebsd-update install</span></code></pre></div></div><div class=paragraph><p>Если были установлены обновления ядра, то после этого нужно перезагрузить систему. Если обновление установилось для какого-либо работающего в системе двоичного файла, то следует перезапустить затронутые приложения, чтобы использовалась исправленная версия двоичного файла.</p></div><div class=paragraph><p>Можно настроить ежедневную автоматическую проверку наличия обновлений, добавив следующую запись в <span class=filename>/etc/crontab</span>:</p></div><div class="literalblock programlisting"><div class=content><pre>@daily                                  root    freebsd-update cron</pre></div></div><div class=paragraph><p>При наличии обновлений они будут автоматически загружены. Пользователю <code>root</code> будет отправлено письмо, так что эти обновления можно будет просмотреть и установить самостоятельно командой <code>freebsd-update install</code>.</p></div><div class=paragraph><p>На случай, если что-то пошло не так, в <code>freebsd-update</code> предусмотрен механизм возврата последнего набора изменений с использованием следующей команды:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># freebsd-update rollback</span>
Uninstalling updates... <span class=k>done</span>.</code></pre></div></div><div class=paragraph><p>Если после завершения всех действий было изменено ядро или какой-либо из его модулей, система должна быть перезагружена, а все затронутые исполняемые файлы нужно перезапустить.</p></div><div class=paragraph><p>Команда <code>freebsd-update</code> позволяет автоматически обновлять только ядро <span class=filename>GENERIC</span>. Если используется ядро с собственной конфигурацией, его понадобится пересобрать и переустановить после того, как <code>freebsd-update</code> завершит установку обновлений. Тем не менее, <code>freebsd-update</code> обнаружит и обновит ядро <span class=filename>GENERIC</span> при наличии <span class=filename>/boot/GENERIC</span>, даже если оно не является текущим используемым ядром в системе.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Всегда храните копию ядра <span class=filename>GENERIC</span> в <span class=filename>/boot/GENERIC</span>. Оно пригодится при решении различных проблем, а также при выполнении обновления со сменой версии. Смотрите <a href=#freebsd-update-custom-kernel-9x>Собственная конфигурация ядра в FreeBSD 9.X и более поздних версиях</a> для описания получения копии ядра <span class=filename>GENERIC</span>.</p></div></td></tr></tbody></table></div><div class=paragraph><p>Если конфигурация в <span class=filename>/etc/freebsd-update.conf</span> не изменялась, <code>freebsd-update</code> вместе с остальными обновлениями установит обновлённые исходные тексты ядра. После этого можно обычным способом выполнить перестроение и переустановку нового ядра с собственной конфигурацией.</p></div><div class=paragraph><p>Обновления, получаемые с помощью <code>freebsd-update</code>, не всегда затрагивают ядро. Перестроение собственного ядра не является обязательным, если исходные тексты ядра не были изменены при выполнении <code>freebsd-update install</code>. Тем не менее, <code>freebsd-update</code> всегда обновляет <span class=filename>/usr/src/sys/conf/newvers.sh</span>. Текущий набор изменений, как указано в номере <code>-p</code> в выводе <code>uname -r</code>, получается из этого файла. Перестроение собственного ядра, даже если ничего больше не менялось, позволяет <code>uname</code> правильно сообщать текущий набор изменений в системе. Это в частности может помочь при сопровождении множества систем, поскольку позволяет быстро оценить наличие установленных обновлений в каждой из них.</p></div></div><div class=sect2><h3 id=freebsdupdate-upgrade>21.2.3. Обновления со сменой старшей и младшей версий<a class=anchor href=#freebsdupdate-upgrade></a></h3><div class=paragraph><p>Обновление с FreeBSD 9.0 на FreeBSD 9.1, называется обновлением со сменой младшего номера версии. Смена старшего номера версии происходит, когда FreeBSD переходит с одной значительной версии на другую, как, например, при обновлении с FreeBSD 9.X на FreeBSD 10.X. Оба типа обновлений можно произвести, указав <code>freebsd-update</code> версию, на которую нужно перейти.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Если в системе используется ядро с собственной конфигурацией, убедитесь перед началом обновления в наличии копии ядра <span class=filename>GENERIC</span> в <span class=filename>/boot/GENERIC</span>. Смотрите <a href=#freebsd-update-custom-kernel-9x>Собственная конфигурация ядра в FreeBSD 9.X и более поздних версиях</a> для описания получения копии ядра <span class=filename>GENERIC</span>.</p></div></td></tr></tbody></table></div><div class=paragraph><p>Следующая команда, будучи запущенной на FreeBSD 9.0, выполнит обновление до версии FreeBSD 9.1:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># freebsd-update -r 9.1-RELEASE upgrade</span></code></pre></div></div><div class=paragraph><p>После своего запуска <code>freebsd-update</code> анализирует содержимое конфигурационного файла и собирает необходимую для проведения обновления информацию о текущей установленной системе. На экран будет выдан перечень компонентов, которые удалось и не удалось обнаружить установленными. Например:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>Looking up update.FreeBSD.org mirrors... 1 mirrors found.
Fetching metadata signature <span class=k>for </span>9.0-RELEASE from update1.FreeBSD.org... <span class=k>done</span><span class=nb>.</span>
Fetching metadata index... <span class=k>done</span><span class=nb>.</span>
Inspecting system... <span class=k>done</span><span class=nb>.</span>

The following components of FreeBSD seem to be installed:
kernel/smp src/base src/bin src/contrib src/crypto src/etc src/games
src/gnu src/include src/krb5 src/lib src/libexec src/release src/rescue
src/sbin src/secure src/share src/sys src/tools src/ubin src/usbin
world/base world/info world/lib32 world/manpages

The following components of FreeBSD <span class=k>do </span>not seem to be installed:
kernel/generic world/catpages world/dict world/doc world/games
world/proflibs

Does this look reasonable <span class=o>(</span>y/n<span class=o>)</span>? y</code></pre></div></div><div class=paragraph><p>Следующим шагом <code>freebsd-update</code> попытается загрузить по сети файлы, необходимые для выполнения обновления. В некоторых случаях может потребоваться ответить на вопросы относительно того, что и как устанавливать.</p></div><div class=paragraph><p>Если используется ядро с собственной конфигурацией, то в этом случае появится предупреждение следующего вида:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>WARNING: This system is running a <span class=s2>&#34;MYKERNEL&#34;</span> kernel, which is not a
kernel configuration distributed as part of FreeBSD 9.0-RELEASE.
This kernel will not be updated: you MUST update the kernel manually
before running <span class=s2>&#34;/usr/sbin/freebsd-update install&#34;</span></code></pre></div></div><div class=paragraph><p>На этом этапе предупреждение можно проигнорировать. На промежуточном этапе процесса обновления будет использовано обновлённое ядро <span class=filename>GENERIC</span>.</p></div><div class=paragraph><p>После того, как все изменения были загружены, они будут применены. Этот процесс может занять определённое время, в зависимости от производительности и текущей загруженности компьютера. Затем будет выполнено слияние конфигурационных файлов. Процесс слияния требует от пользователя определённого вмешательства, так как для файла можно выполнить слияние автоматически, а можно открыть текстовый редактор для слияния вручную. Результат успешного слияния будет показан на экране. Неудачное или пропущенное слияние вызовет преждевременное завершение программы. Можно подготовить резервную копию каталога <span class=filename>/etc</span> для таких важных файлов как <span class=filename>master.passwd</span> и <span class=filename>group</span> и выполнить их слияние вручную позднее.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>На данном этапе система еще не модифицирована, и все изменения и слияния происходят в отдельном каталоге. Теперь, когда все изменения успешно применены, все конфигурационные файлы объединены и кажется, что процесс должен пройти плавно, изменения могут быть установлены на диск с помощью следующей команды:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># freebsd-update install</span></code></pre></div></div></td></tr></tbody></table></div><div class=paragraph><p>В первую очередь изменения будут применены к ядру и его модулям. При использовании ядра с собственной конфигурацией укажите для следующей загрузки обновлённое ядро <span class=filename>/boot/GENERIC</span> с помощью <a href="https://man.freebsd.org/cgi/man.cgi?query=nextboot&amp;sektion=8&amp;format=html">nextboot(8)</a>:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># nextboot -k GENERIC</span></code></pre></div></div><div class="admonitionblock warning"><table><tbody><tr><td class=icon><i class="fa icon-warning" title=Warning></i></td><td class=content><div class=paragraph><p>Перед перезагрузкой с ядром <span class=filename>GENERIC</span> убедитесь, что оно содержит все необходимые драйвера для системы для корректной загрузки и подключения к сети, если машина обновляется удалённо. В частности, если в ядре содержится встроенная функциональность, которая обычно обеспечивается модулями ядра, загрузите эти драйвера с ядром <span class=filename>GENERIC</span>, временно указав их как модули в <span class=filename>/boot/loader.conf</span>. Рекомендуется отключить несущественные службы, а также любые локальные и сетевые диски до завершения процесса обновления.</p></div></td></tr></tbody></table></div><div class=paragraph><p>Теперь компьютер должен быть перезагружен с новым ядром:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># shutdown -r now</span></code></pre></div></div><div class=paragraph><p>После перезагрузки нужно повторно запустить команду <code>freebsd-update</code>. Команда прочитает, на каком этапе она находится, и перейдёт к удалению старых объектных файлов и совместно используемых библиотек.</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># freebsd-update install</span></code></pre></div></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Количество этапов установки обновлений может быть два вместо трёх и зависит от того, были ли изменены номера версий каких-либо совместно используемых библиотек.</p></div></td></tr></tbody></table></div><div class=paragraph><p>На этом процесс завершён. Если было выполнено обновление со сменой старшего номера версии, переустановите все порты и пакеты в соответствии с описанием, которое предоставляет <a href=#freebsdupdate-portsrebuild>Обновление пакетов после смены старшей версии системы</a>.</p></div><div class=sect3><h4 id=freebsd-update-custom-kernel-9x>21.2.3.1. Собственная конфигурация ядра в FreeBSD 9.X и более поздних версиях<a class=anchor href=#freebsd-update-custom-kernel-9x></a></h4><div class=paragraph><p>Перед использованием <code>freebsd-update</code> убедитесь в наличии копии ядра <span class=filename>GENERIC</span> в <span class=filename>/boot/GENERIC</span>. Если ядро с собственной конфигурацией было собрано единожды, то в <span class=filename>/boot/kernel.old</span> будет находиться ядро <code>GENERIC</code>. Просто переименуйте этот каталог в <span class=filename>/boot/kernel</span>.</p></div><div class=paragraph><p>Если ядро с собственной конфигурацией было собрано более одного раза, получите копию ядра <code>GENERIC</code>, соответствующую текущей версии операционной системы. При наличии физического доступа копию ядра <code>GENERIC</code> можно установить с установочного носителя:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># mount /cdrom</span>
<span class=c># cd /cdrom/usr/freebsd-dist</span>
<span class=c># tar -C/ -xvf kernel.txz boot/kernel/kernel</span></code></pre></div></div><div class=paragraph><p>Иначе, ядро <code>GENERIC</code> можно собрать и установить из исходных текстов:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># cd /usr/src</span>
<span class=c># make kernel __MAKE_CONF=/dev/null SRCCONF=/dev/null</span></code></pre></div></div><div class=paragraph><p>Чтобы такое ядро было определено как ядро <code>GENERIC</code> программой <code>freebsd-update</code>, в файле конфигурации <span class=filename>GENERIC</span> должны отсутствовать изменения. Также предлагается, что ядро было собрано без использования каких-либо специальных параметров.</p></div><div class=paragraph><p>Загрузка с <span class=filename>GENERIC</span> не требуется, поскольку для <code>freebsd-update</code> достаточно существования <span class=filename>/boot/GENERIC</span>.</p></div></div><div class=sect3><h4 id=freebsdupdate-portsrebuild>21.2.3.2. Обновление пакетов после смены старшей версии системы<a class=anchor href=#freebsdupdate-portsrebuild></a></h4><div class=paragraph><p>После обновления системы со сменой младшей версии установленные приложения, в целом, продолжают работать без каких-либо проблем. Различные старшие версии используют различающиеся двоичные интерфейсы приложений (Application Binary Interface, ABI), из-за чего перестаёт работать большинство сторонних приложений. После обновления системы со сменой старшей версии все установленные пакеты и порты также нуждаются в обновлении. Пакеты можно обновить с использованием <code>pkg upgrade</code>. Для обновления установленных портов используется <a class=package href=https://cgit.freebsd.org/ports/tree/ports-mgmt/portmaster/>ports-mgmt/portmaster</a>.</p></div><div class=paragraph><p>Принудительное обновление все установленных пакетов приведёт к их замене на последние версии из репозитория, даже если номер версии при этом не увеличивался. Это требуется из-за смены версии ABI при обновлении на другую старшую версию FreeBSD. Принудительное обновление можно выполнить так:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># pkg-static upgrade -f</span></code></pre></div></div><div class=paragraph><p>Перестроение всех установленных приложений можно выполнить этой командой:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># portmaster -af</span></code></pre></div></div><div class=paragraph><p>Эта команда будет отображать экран выбора конфигурации для каждого приложения, в котором доступны параметры конфигурации, с ожиданием пользовательского ввода. Чтобы не использовать такое поведение и всегда выбирать параметры по умолчанию, добавьте ключ <code>-G</code> в вышеприведённую команду.</p></div><div class=paragraph><p>После завершения процесса обновления программного обеспечения закончите процесс обновления последним запуском <code>freebsd-update</code>, для того чтобы убедиться, что ничто не было пропущено в процессе обновления:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># freebsd-update install</span></code></pre></div></div><div class=paragraph><p>Если в качестве временной меры использовалось ядро <span class=filename>GENERIC</span>, то это подходящее время для построения и установки нового ядра с собственной конфигурацией в соответствии с инструкциями в <a href=../kernelconfig/#kernelconfig>Настройка ядра FreeBSD</a>.</p></div><div class=paragraph><p>Перезагрузите машину с новой версией FreeBSD. На этом процесс обновления завершён.</p></div></div></div><div class=sect2><h3 id=freebsdupdate-system-comparison>21.2.4. Сравнение состояния системы<a class=anchor href=#freebsdupdate-system-comparison></a></h3><div class=paragraph><p>С помощью команды <code>freebsd-update IDS</code> можно получить состояние установленной версии FreeBSD относительно известной доверенной копии. Эта команда проверяет текущую версию системных утилит, библиотек и конфигурационных файлов, и её можно использовать в качестве встроенной системы обнаружения вторжений (Intrusion Detection System, IDS).</p></div><div class="admonitionblock warning"><table><tbody><tr><td class=icon><i class="fa icon-warning" title=Warning></i></td><td class=content><div class=paragraph><p>Эта команда не является заменой IDS, такой как <a class=package href=https://cgit.freebsd.org/ports/tree/security/snort/>security/snort</a>. Поскольку <code>freebsd-update</code> сохраняет свои данные на диске, возможность подмены становится очевидной. И хотя эта возможность может быть уменьшена при использовании настройки <code>kern.securelevel</code>, а также используя для записи данных <code>freebsd-update</code> файловую систему, которая в остальное время смонтирована только на чтение, лучшим решением будет сравнить систему относительно эталона на физически защищенном носителе, таком как DVD или внешний USB диск с включённой защитой от записи.</p></div></td></tr></tbody></table></div><div class=paragraph><p>Для того, чтобы начать сравнение, укажите файл для сохранения результатов:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># freebsd-update IDS &gt;&gt; outfile.ids</span></code></pre></div></div><div class=paragraph><p>Запустится проверка системы, результат которой будет записан в указанный файл в виде списка файлов вместе с их контрольными суммами в формате SHA256 - для известных файлов из релиза и текущих в системе.</p></div><div class=paragraph><p>Строки в списке чрезмерно длинные, но зато такой формат вывода удобен для разбора. Так, для получения списка всех отличающихся от релиза файлов достаточно выполнить такую команду:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># cat outfile.ids | awk &#39;{ print $1 }&#39; | more</span>
/etc/master.passwd
/etc/motd
/etc/passwd
/etc/pf.conf</code></pre></div></div><div class=paragraph><p>Вывод специально обрезан, на самом деле файлов намного больше. Некоторые из них изменены в ходе нормальной работы: так, файл <span class=filename>/etc/passwd</span> был изменён после заведения пользователей в системе. Модули ядра могли измениться вследствие обновления через <code>freebsd-update</code>. Для исключения из проверки конкретных файлов и каталогов укажите их в качестве значения параметра <code>IDSIgnorePaths</code> в <span class=filename>/etc/freebsd-update.conf</span>.</p></div></div></div></div><div class=sect1><h2 id=updating-upgrading-documentation>21.3. Обновление документации<a class=anchor href=#updating-upgrading-documentation></a></h2><div class=sectionbody><div class=paragraph><p>Документация является неотъемлемой частью операционной системы FreeBSD. И хотя актуальная версия документации FreeBSD всегда доступна на сайте FreeBSD (<a href=https://www.FreeBSD.org/doc/>http://www.freebsd.org/doc/</a>), может быть удобно иметь под рукой актуальную локальную копию сайта FreeBSD, руководств, FAQ и статей.</p></div><div class=paragraph><p>В этом разделе описывается, как использовать исходный текст или Коллекцию Портов FreeBSD для организации актуальной локальной копии документации FreeBSD.</p></div><div class=paragraph><p>За информацией о редактировании и отправке изменений для документации обращайтесь к FreeBSD Documentation Project Primer for New Contributors (<a href=https://docs.freebsd.org/en/books/fdp-primer/>FreeBSD Documentation Project Primer</a>).</p></div><div class=sect2><h3 id=updating-installed-documentation>21.3.1. Обновление документации из исходного кода<a class=anchor href=#updating-installed-documentation></a></h3><div class=paragraph><p>Для перестроения документации FreeBSD из исходного текста требуется набор инструментов, который не является частью основной системы FreeBSD. Требуемые инструменты, включая svn, можно установить из пакета или порта <a class=package href=https://cgit.freebsd.org/ports/tree/textproc/docproj/>textproc/docproj</a>, разработанного в рамках проекта документации FreeBSD.</p></div><div class=paragraph><p>После установки используйте svn для получения копии исходных текстов документации:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># svn checkout https://svn.FreeBSD.org/doc/head /usr/doc</span></code></pre></div></div><div class=paragraph><p>Первоначальная загрузка исходных текстов документации может занять некоторое время. Дайте ей завершиться.</p></div><div class=paragraph><p>Последующие обновления можно получить, выполнив:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># svn update /usr/doc</span></code></pre></div></div><div class=paragraph><p>После того как в <span class=filename>/usr/doc</span> была загружена актуальная копия исходных текстов, всё готово для обновления установленной документации.</p></div><div class=paragraph><p>Полное обновление всех доступных языковых версий можно выполнить, набрав команду:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># cd /usr/doc</span>
<span class=c># make install clean</span></code></pre></div></div><div class=paragraph><p>Для обновления только указанной языковой версии команду <code>make</code> можно запустить в соответствующем подкаталоге <span class=filename>/usr/doc</span>:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># cd /usr/doc/en_US.ISO8859-1</span>
<span class=c># make install clean</span></code></pre></div></div><div class=paragraph><p>Альтернативный способ обновления документации заключается в запуске следующей команды из из <span class=filename>/usr/doc</span> или подкаталога с желаемой языковой версией:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># make update</span></code></pre></div></div><div class=paragraph><p>Используемый при установке формат можно указать через <code>FORMATS</code>:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># cd /usr/doc</span>
<span class=c># make FORMATS=&#39;html html-split&#39; install clean</span></code></pre></div></div><div class=paragraph><p>Для упрощения процесса частичного обновления документации и построения только нужных переводов имеется несколько параметров. Их можно задать как на общесистемном уровне, указав в <span class=filename>/etc/make.conf</span>, так и непосредственно в команде <code>make</code>.</p></div><div class=paragraph><p>Данные параметры включают:</p></div><div class=dlist><dl><dt class=hdlist1><code>DOC_LANG</code></dt><dd><p>Перечень языков и кодировок для построения и установки, например, <code>en_US.ISO8859-1</code> для англоязычной документации.</p></dd><dt class=hdlist1><code>FORMATS</code></dt><dd><p>Единый формат или набор форматов для построения. На данный момент поддерживаются <code>html</code>, <code>html-split</code>, <code>txt</code>, <code>ps</code> и <code>pdf</code>.</p></dd><dt class=hdlist1><code>DOCDIR</code></dt><dd><p>Путь для установки документации. По умолчанию <span class=filename>/usr/shared/doc</span>.</p></dd></dl></div><div class=paragraph><p>Для получения других переменных <code>make</code>, также работающих во FreeBSD в качестве общесистемных, обратитесь к <a href="https://man.freebsd.org/cgi/man.cgi?query=make.conf&amp;sektion=5&amp;format=html">make.conf(5)</a>.</p></div></div><div class=sect2><h3 id=doc-ports-install-package>21.3.2. Обновление документации из портов<a class=anchor href=#doc-ports-install-package></a></h3><div class=paragraph><p>В предыдущем разделе был представлен метод обновления документации FreeBSD из исходных текстов. В этом разделе описывается альтернативный метод с использованием Коллекции Портов, который позволяет:</p></div><div class=ulist><ul><li><p>Установить предварительно собранный пакет документации без необходимости локального построения чего-либо или установки инструментария документации.</p></li><li><p>Выполнить построение исходных текстов документации через инфраструктуру портов, что несколько упрощает этапы загрузки и построения.</p></li></ul></div><div class=paragraph><p>Данный метод обновления документации FreeBSD предоставляется портами и пакетами документации, которые ежемесячно обновляет Группа Менеджеров Дерева Документации &lt;<a href=mailto:doceng@FreeBSD.org>doceng@FreeBSD.org</a>>. Они перечислены в Коллекции Портов FreeBSD в категории docs (<a href=http://www.freshports.org/docs/>http://www.freshports.org/docs/</a>).</p></div><div class=paragraph><p>Порты документации организованы следующим образом:</p></div><div class=ulist><ul><li><p>Пакет или порт <a class=package href=https://cgit.freebsd.org/ports/tree/misc/freebsd-doc-en/>misc/freebsd-doc-en</a> устанавливает всю англоязычную документацию.</p></li><li><p>Метапакет или порт <a class=package href=https://cgit.freebsd.org/ports/tree/misc/freebsd-doc-all/>misc/freebsd-doc-all</a> устанавливает всю документацию на всех доступных языках.</p></li><li><p>Имеются пакеты и порты для каждого перевода, например, <a class=package href=https://cgit.freebsd.org/ports/tree/misc/freebsd-doc-hu/>misc/freebsd-doc-hu</a> для венгерской документации.</p></li></ul></div><div class=paragraph><p>При использовании двоичных пакетов документация FreeBSD будет установлена во всех доступных форматах для данного языка. Например, следующая команда установит последнюю версию пакета венгерской документации:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># pkg install hu-freebsd-doc</span></code></pre></div></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Для пакетов используется другая схема наименования, которая отличается от названия соответствующего порта: <code><em>lang</em>-freebsd-doc</code>, где <em>lang</em> соответствует сокращённому языковому коду, такому как <code>hu</code> для венгерского или <code>zh_cn</code> для упрощённого китайского.</p></div></td></tr></tbody></table></div><div class=paragraph><p>Чтобы указать используемый формат документации, для этого вместо установки готового пакета нужно собрать порт самостоятельно. Ниже приводится пример построения и установки английской документации:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># cd /usr/ports/misc/freebsd-doc-en</span>
<span class=c># make install clean</span></code></pre></div></div><div class=paragraph><p>В порте имеется меню конфигурации, в котором можно указать нужный формат. По умолчанию выбирается HTML с разделителями, такой как на <a href=http://www.FreeBSD.org>http://www.FreeBSD.org</a>, а также PDF.</p></div><div class=paragraph><p>Иначе, при построении порта документации можно указать параметры <code>make</code>, которые включают в себя:</p></div><div class=dlist><dl><dt class=hdlist1><code>WITH_HTML</code></dt><dd><p>Документ в формате HTML на одной странице. Сформированная документация сохраняется в файле <span class=filename>article.html</span> или <span class=filename>book.html</span>.</p></dd><dt class=hdlist1><code>WITH_PDF</code></dt><dd><p>Сформированная документация сохраняется в файле <span class=filename>article.pdf</span> или <span class=filename>book.pdf</span>.</p></dd><dt class=hdlist1><code>DOCBASE</code></dt><dd><p>Указывает место размещения документации. По умолчанию <span class=filename>/usr/local/shared/doc/freebsd</span>.</p></dd></dl></div><div class=paragraph><p>В примере ниже демонстрируется использование переменных для установки венгерской документации в PDF в указанный каталог:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># cd /usr/ports/misc/freebsd-doc-hu</span>
<span class=c># make -DWITH_PDF DOCBASE=share/doc/freebsd/hu install clean</span></code></pre></div></div><div class=paragraph><p>Пакеты или порты документации обновляются согласно инструкциям в <a href=../ports/#ports>Установка приложений. порты и пакеты</a>. Например, следующая команда выполняет обновление установленной документации на венгерском языке с помощью <a class=package href=https://cgit.freebsd.org/ports/tree/ports-mgmt/portmaster/>ports-mgmt/portmaster</a> в режиме использования только готовых пакетов:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># portmaster -PP hu-freebsd-doc</span></code></pre></div></div></div></div></div><div class=sect1><h2 id=current-stable>21.4. Использование ветви разработки<a class=anchor href=#current-stable></a></h2><div class=sectionbody><div class=paragraph><p>Во FreeBSD имеется две ветки разработки: FreeBSD-CURRENT и FreeBSD-STABLE.</p></div><div class=paragraph><p>В этом разделе даётся объяснение для каждой из них и их предназначение, а также рассказывается, как синхронизировать систему с любой из этих веток.</p></div><div class=sect2><h3 id=current>21.4.1. Использование FreeBSD-CURRENT<a class=anchor href=#current></a></h3><div class=paragraph><p>FreeBSD-CURRENT является "передним краем" разработки FreeBSD и предназначена для пользователей с высокой технической грамотностью. Менее продвинутым пользователям, также желающим отслеживать ветку разработки, следует использовать FreeBSD-STABLE.</p></div><div class=paragraph><p>FreeBSD-CURRENT обозначает последнюю версию исходных текстов FreeBSD и включает в себя незавершённые работы, экспериментальные изменения и переходные механизмы, которые могут отсутствовать в следующем официальном релизе. Хотя многие разработчики FreeBSD выполняют компиляцию исходных текстов FreeBSD-CURRENT ежедневно, бывают периоды, когда исходные тексты могут не компилироваться. Обычно такие проблемы решаются сразу по мере возможности, но всё же выбор точки синхронизации исходных текстов является определяющим фактором, содержит ли FreeBSD-CURRENT новую функциональность или же мину замедленного действия.</p></div><div class=paragraph><p>FreeBSD-CURRENT предназначена для трёх основных групп:</p></div><div class="olist arabic"><ol class=arabic><li><p>Члены сообщества FreeBSD, активно работающие над некоторой частью дерева исходных текстов.</p></li><li><p>Члены сообщества FreeBSD, которые являются активными тестерами. Они тратят свое время на исправление проблем, вносят важные предложения по изменениям и общему развитию FreeBSD, присылают патчи.</p></li><li><p>Пользователи, которые хотят быть в курсе изменений, используют текущие исходные тексты для ознакомительных целей либо же иногда высказывают замечания или предоставляют собственный код.</p></li></ol></div><div class=paragraph><p>FreeBSD-CURRENT <em>не</em> должна использоваться в качестве быстрого способа получить новые возможности, не дожидаясь выпуска следующей версии, поскольку предварительная версия не является полностью проверенной и скорее всего содержит ошибки. FreeBSD-CURRENT не является быстрым способом получения исправлений, поскольку любое изменение является в равной мере источником исправления существующих ошибок и появления новых. FreeBSD-CURRENT не является "официально поддерживаемой" каким бы то ни было способом.</p></div><div class=paragraph><p>Чтобы отслеживать изменения во FreeBSD-CURRENT:</p></div><div class="olist arabic"><ol class=arabic><li><p>Подпишитесь на списки рассылки <a href=https://lists.FreeBSD.org/subscription/freebsd-current>Список рассылки, посвящённый обсуждению FreeBSD-CURRENT</a> и <a href=https://lists.FreeBSD.org/subscription/svn-src-head>Список рассылки сообщений об изменениях в репозитории SVN для ветки head/-current дерева исходных текстов</a>. Это <em>необходимо</em> для того, чтобы получать сообщения и важные бюллетени относительно текущего состояния FreeBSD-CURRENT.</p><div class=paragraph><p>Список рассылки <a href=https://lists.FreeBSD.org/subscription/svn-src-head>Список рассылки сообщений об изменениях в репозитории SVN для ветки head/-current дерева исходных текстов</a> содержит записи из журнала коммитов по каждому изменению, а также сопутствующую информацию о возможных побочных эффектах.</p></div><div class=paragraph><p>Чтобы подписаться на эти списки рассылки, перейдите по ссылке <a href=https://lists.freebsd.org class=bare>https://lists.freebsd.org</a>, щёлкните на нужном списке и следуйте дальнейшим инструкциям. Для того чтобы отслеживать изменения всего дерева исходных текстов, а не только FreeBSD-CURRENT, подпишитесь на <a href=https://lists.FreeBSD.org/subscription/svn-src-all>Список рассылки сообщений об изменениях в репозитории SVN для всего дерева исходных текстов (за исключением &lt;quote>user&lt;/quote> и &lt;quote>projects&lt;/quote>)</a>.</p></div></li><li><p>Загрузите исходные тексты FreeBSD-CURRENT. Обычно для этого используется <a href=../mirrors/#svn>svn</a>, с помощью которого можно загрузить исходные тексты -CURRENT из ветки <code>head</code> с одного из зеркал Subversion, перечисленных в <a href=../mirrors/#svn-mirrors>Сайты зеркала Subversion</a>.</p><div class=paragraph><p>Пользователи с очень медленным или ограниченным подключением могут рассматривать использование CTM, который описывается в <a href=../mirrors/#ctm>Использование CTM</a>, однако этот способ является менее надёжным по сравнению с рекомендуемым способом синхронизации исходных текстов посредством svn.</p></div></li><li><p>Вследствие больших размеров репозитория некоторые пользователи для ознакомления или изготовления патчей выбирают частичную загрузку. Тем не менее, для компиляции операционной системы из исходных текстов требуется загрузить FreeBSD-CURRENT <em>полностью</em>, а не только лишь выбранные части.</p><div class=paragraph><p>Перед началом компиляции FreeBSD-CURRENT внимательно прочтите файл <span class=filename>/usr/src/Makefile</span> и следуйте инструкциям в <a href=#makeworld>Пересборка мира</a>. <a href=https://lists.FreeBSD.org/subscription/freebsd-current>Список рассылки, посвящённый обсуждению FreeBSD-CURRENT</a> и <span class=filename>/usr/src/UPDATING</span> позволят быть в курсе прочих процедур, которые иногда бывают необходимы в процессе перехода к следующему релизу.</p></div></li><li><p>Будьте активным участником! Пользователям FreeBSD-CURRENT предлагается высказывать свои соображения по улучшению или исправлению ошибок. Предложения, к которым прилагается код, всегда приветствуются!</p></li></ol></div></div><div class=sect2><h3 id=stable>21.4.2. Использование FreeBSD-STABLE<a class=anchor href=#stable></a></h3><div class=paragraph><p>FreeBSD-STABLE является веткой разработки, из которой выпускаются основные релизы. Изменения в этой ветке происходят с меньшей скоростью и в предположении, что они сперва были проверены во FreeBSD-CURRENT. При этом она <em>остаётся</em> веткой разработки, и в любой момент времени исходные тексты FreeBSD-STABLE могут оказаться не готовы для обычного использования. Это просто другая ветка разработки, не предназначенная для конечных пользователей. Пользователям, у которых нет возможности заниматься тестированием, следует использовать самый последний выпуск FreeBSD.</p></div><div class=paragraph><p>Тем, кто заинтересован процессом разработки FreeBSD или желает поучаствовать, особенно поскольку от этого зависит следующий релиз FreeBSD, стоит отслеживать FreeBSD-STABLE.</p></div><div class=paragraph><p>Хотя ветка FreeBSD-STABLE должна всегда компилироваться и работать, это невозможно гарантировать. Поскольку гораздо больше людей работает с FreeBSD-STABLE, неудивительно, что в FreeBSD-STABLE иногда обнаруживаются ошибки и всплывают непредвиденные ситуации, которые не проявляли себя в FreeBSD-CURRENT. По этим причинам не рекомендуется слепо использовать FreeBSD-STABLE. Особенно важно <em>не</em> обновлять какие-либо сервера, находящиеся в эксплуатации, до FreeBSD-STABLE без тщательного тестирования кода в среде разработки.</p></div><div class=paragraph><p>Чтобы отслеживать изменения во FreeBSD-STABLE:</p></div><div class="olist arabic"><ol class=arabic><li><p>Подпишитесь на список рассылки <a href=https://lists.FreeBSD.org/subscription/freebsd-stable>Список рассылки, посвящённый обсуждению FreeBSD-STABLE;</a>, чтобы быть в курсе о зависимостях процесса компиляции, которые могут появиться во FreeBSD-STABLE или любых других проблемах, требующих особого внимания. Также в этом списке рассылки разработчики делают объявления о спорных исправлениях или добавлениях, давая пользователям возможность высказать свое мнение о возможных тонких моментах.</p><div class=paragraph><p>Подпишитесь на список рассылки svn, соответствующий используемой ветви. Например, при использовании 9-STABLE следует подписаться на <a href=https://lists.FreeBSD.org/subscription/svn-src-stable-9>Список рассылки сообщений об изменениях в репозитории SVN для ветки 9-stable дерева исходных текстов</a>. Этот список рассылки содержит записи из журнала коммитов по каждому изменению, а также сопутствующую информацию о возможных побочных эффектах.</p></div><div class=paragraph><p>Чтобы подписаться на эти списки рассылки, перейдите по ссылке <a href=https://lists.freebsd.org class=bare>https://lists.freebsd.org</a>, щёлкните на нужном списке, и следуйте дальнейшим инструкциям. Для того чтобы отслеживать изменения всего дерева исходных текстов, подпишитесь на <a href=https://lists.FreeBSD.org/subscription/svn-src-all>Список рассылки сообщений об изменениях в репозитории SVN для всего дерева исходных текстов (за исключением &lt;quote>user&lt;/quote> и &lt;quote>projects&lt;/quote>)</a>.</p></div></li><li><p>Чтобы установить новую систему FreeBSD-STABLE, установите самый последний релиз FreeBSD-STABLE, загрузив его с <a href=../mirrors/#mirrors>зеркалирующих сайтов FreeBSD</a> или используйте ежемесячную стандартную сборку FreeBSD-STABLE. Обратитесь к <a href=https://www.FreeBSD.org/snapshots/>www.freebsd.org/snapshots</a> для получения дополнительной информации о снэпшотах.</p><div class=paragraph><p>Чтобы скомпилировать новую или обновить существующую систему FreeBSD до FreeBSD-STABLE, используйте <a href=../mirrors/#svn>svn</a> для загрузки исходных текстов нужной ветки. Имена веток вида <code>stable/9</code> перечислены на странице <a href=https://www.FreeBSD.org/releng/>www.freebsd.org/releng</a>. При отсутствии надёжного Интернет-соединения можно воспользоваться CTM (<a href=../mirrors/#ctm>Использование CTM</a>).</p></div></li><li><p>Перед началом компиляции или обновления до FreeBSD-STABLE внимательно прочтите файл <span class=filename>/usr/src/Makefile</span> и следуйте инструкциям в <a href=#makeworld>Пересборка мира</a>. <a href=https://lists.FreeBSD.org/subscription/freebsd-stable>Список рассылки, посвящённый обсуждению FreeBSD-STABLE;</a> и <span class=filename>/usr/src/UPDATING</span> позволят быть в курсе прочих процедур, которые иногда бывают необходимы в процессе перехода к следующему релизу.</p></li></ol></div></div></div></div><div class=sect1><h2 id=synching>21.5. Синхронизация исходных текстов<a class=anchor href=#synching></a></h2><div class=sectionbody><div class=paragraph><p>Имеются различные способы синхронизации с исходными текстами FreeBSD. В этом разделе сравниваются основные из них, Subversion и CTM.</p></div><div class="admonitionblock warning"><table><tbody><tr><td class=icon><i class="fa icon-warning" title=Warning></i></td><td class=content><div class=paragraph><p>Хотя возможно частичное обновление дерева исходных текстов, единственной поддерживаемой процедурой обновления является обновление всего дерева и перекомпиляция всех программ, работающих в контексте пользователя, например тех, что находятся в каталогах <span class=filename>/bin</span> и <span class=filename>/sbin</span>, а также исходных текстов ядра. Обновление только части дерева исходных текстов, только ядра или только программ часто приводит к возникновению проблем от ошибок компиляции до аварийных остановов системы или потери данных.</p></div></td></tr></tbody></table></div><div class=paragraph><p>Subversion для обновления исходных текстов использует модель <em>pull</em>. Пользователь или сценарий <code>cron</code> запускают программу <code>svn</code>, которая обновляет локальную версию исходных текстов. Subversion является предпочтительным способом обновления локального дерева исходных текстов, поскольку обновления являются актуальными с точностью до минуты и пользователь управляет временем их загрузки. Загрузку определённых файлов и каталогов легко ограничить, а запрашиваемые обновления формируются на лету на стороне сервера. О том, как актуализировать исходные тексты с использованием Subversion, описано в <a href=../mirrors/#svn>svn</a>.</p></div><div class=paragraph><p>CTM не выполняет интерактивное сравнение имеющихся исходных текстов с находящимися в главном архиве, и не выполняет их загрузку. Вместо этого несколько раз в день на главной машине CTM запускается скрипт, находящий изменения в файлах с момента своего предыдущего запуска. Все обнаруженные изменения сжимаются, помечаются последовательным номером и кодируются для передачи по электронной почте в печатном формате ASCII. После получения эти "дельта-файлы CTM" могут быть переданы утилите <code>ctm.rmail</code>, которая осуществляет автоматическое декодирование, проверку и применение изменений к пользовательской копии исходных текстов. Этот процесс более эффективен по сравнению с используемым в Subversion и требует меньше ресурсов сервера, так как он выполнен по модели <em>push</em>, а не <em>pull</em>. Инструкции по использованию CTM для синхронизации исходных текстов даны в <a href=../mirrors/#ctm>Использование CTM</a>.</p></div><div class=paragraph><p>Если пользователь случайно уничтожил часть своего архива, Subversion обнаружит и перестроит повреждённую часть. CTM этого не делает, поэтому если пользователь удалил часть дерева исходных текстов и не имеет архивной копии, то нужно будет начать с самого начала (с последнего "базового дельта-файла"), перестроив всё с помощью CTM.</p></div></div></div><div class=sect1><h2 id=makeworld>21.6. Пересборка мира<a class=anchor href=#makeworld></a></h2><div class=sectionbody><div class=paragraph><p>После того, как локальное дерево исходных текстов было синхронизировано с некоторой версией FreeBSD (FreeBSD-STABLE или FreeBSD-CURRENT), его можно использовать для перестроения системы. Этот процесс известен как перестроение мира.</p></div><div class=paragraph><p><em>Перед</em> перестроением мира убедитесь в выполнении следующих действий:</p></div><div class="exampleblock procedure"><div class=content><div class=paragraph><p><strong>Procedure: <em>Перед</em> тем как приступать к построению мира</strong></p></div><div class="olist arabic"><ol class=arabic><li><p>Сохраните резервную копию всех важных данных на другую систему или съёмный носитель, проверьте её целостность и держите под рукой загрузочный носитель. Невозможно переоценить важность создания резервной копии системы <em>до</em> начала перестроения системы. Хотя перестроение системы является простой задачей, неизбежно возникают ситуации, при которых ошибки в исходных текстах приводят к тому, что система перестаёт загружаться. Возможно, вам никогда не придётся этим воспользоваться, но, постучав по дереву, всегда лучше подстраховаться.</p></li><li><p>Проверьте последние сообщения в списке рассылки <a href=https://lists.FreeBSD.org/subscription/freebsd-stable>Список рассылки, посвящённый обсуждению FreeBSD-STABLE;</a> или <a href=https://lists.FreeBSD.org/subscription/freebsd-current>Список рассылки, посвящённый обсуждению FreeBSD-CURRENT</a> (в зависимости от отслеживаемой ветки). Будьте в курсе любых известных проблем, и тех систем, которые они затрагивают. В случае возникновения подобной проблемы, дождитесь сообщения о том, что эта проблема решена. После этого повторите синхронизацию исходных текстов для получения необходимого исправления.</p></li><li><p>Прочтите <span class=filename>/usr/src/UPDATING</span> для получения информации о дополнительных шагах, необходимых для данной версии исходных текстов. В этом файле содержится важная информация о возможных проблемах и может быть указан порядок выполнения соответствующих команд. При большинстве обновлений требуются дополнительные шаги, например, переименование или удаление определённых файлов перед установкой нового мира. Эти шаги будут перечислены в конце файла, где в явном виде описывается текущая рекомендуемая последовательность действий при обновлении. Если содержимое <span class=filename>UPDATING</span> противоречит каким-либо шагам в этой главе, руководствуйтесь инструкциями в файле <span class=filename>UPDATING</span>, которые имеют больший приоритет.</p></li></ol></div></div></div><div class="admonitionblock warning"><table><tbody><tr><td class=icon><i class="fa icon-warning" title=Warning></i></td><td class=content><div class=title>Не используйте <code>make world</code></div><div class=paragraph><p>В некоторой устаревшей документации рекомендуется использование <code>make world</code>. Эта команда пропускает некоторые важные шаги, поэтому использовать её следует лишь в том случае, если вы точно знаете, что делаете. Почти во всех случаях <code>make world</code> - это неправильный способ, вместо этого следует использовать описанную здесь процедуру.</p></div></td></tr></tbody></table></div><div class=sect2><h3 id=canonical-build>21.6.1. Обзор процесса<a class=anchor href=#canonical-build></a></h3><div class=paragraph><p>Процесс построения мира подразумевает переход с более старой версии FreeBSD с использованием исходных текстов более новой версии, которые были получены согласно инструкциям в <a href=#synching>Синхронизация исходных текстов</a>.</p></div><div class=paragraph><p>Во FreeBSD термин "world" обозначает ядро, исполняемые файлы основой системы, библиотеки, файлы для программирования и встроенный компилятор. Имеет значение порядок, при котором эти компоненты собираются и устанавливаются.</p></div><div class=paragraph><p>Например, из-за ошибки в старом компиляторе невозможно было бы скомпилировать новое ядре. Поскольку новое ядро должно быть собрано новым компилятором, для этого в свою очередь необходимо собрать новый компилятор, но устанавливать его перед сборкой ядра необязательно.</p></div><div class=paragraph><p>Новый мир может зависеть от особенностей нового ядра, поэтому новое ядро должно быть установлено до установки нового мира. Старый мир может работать неправильно на новом ядре, поэтому новый мир должен быть установлен сразу после установки нового ядра.</p></div><div class=paragraph><p>Перед установкой нового мира могут потребоваться изменения в конфигурации, но некоторые из изменений могут не работать со старым миром. Следовательно, используются два разных этапа обновления конфигурации. В основной части процесса обновления выполняется только замена или добавление файлов. Существующие файлы при этом не удаляются. Поскольку это может повлечь проблемы, в <span class=filename>/usr/src/UPDATING</span> содержится информация о том, какие из файлов и на каком шаге нужно удалить вручную.</p></div><div class=paragraph><p>Исходя из этих соображений в следующей процедуре описана рекомендуемая последовательность обновления.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Хорошей практикой является запись в файл вывода команды <code>make</code>. Если что-то пошло не так, копию сообщения об ошибке можно отправить в один из списков рассылки FreeBSD.</p></div><div class=paragraph><p>Проще всего использовать для этого <code>script</code> с параметром, задающим имя файла для сохранения всего вывода. Не сохраняйте вывод в <span class=filename>/tmp</span>, так как этот каталог может быть очищен при следующей перезагрузке. Более подходящим местом является <span class=filename>/var/tmp</span>. Запустите команду непосредственно перед перестроением мира, а после завершения процесса наберите <code>exit</code>:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># script /var/tmp/mw.out</span>
Script started, output file is /var/tmp/mw.out</code></pre></div></div></td></tr></tbody></table></div><div class="exampleblock procedure"><div class=content><div class=paragraph><p><strong>Procedure: Обзор процесса построения мира</strong></p></div><div class=paragraph><p>Команды для построения мира должны запускаться в указанном здесь порядке. В этом разделе даётся краткое описание назначения каждой из команд.</p></div><div class="olist arabic"><ol class=arabic><li><p>Если процесс построения мира уже запускался ранее на этой системе, то в <span class=filename>/usr/obj</span> могла остаться копия предыдущей сборки. Удалите этот каталог для ускорения процесса построения нового мира и возможного сокращений работы по разрешению зависимостей.</p><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># chflags -R noschg /usr/obj/*</span>
<span class=c># rm -rf /usr/obj</span></code></pre></div></div></li><li><p>Скомпилируйте новый компилятор и несколько сопутствующих инструментов и используйте их для компиляции остальной части мира. Результаты сохраняются в <span class=filename>/usr/obj</span>.</p><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># cd /usr/src</span>
<span class=c># make buildworld</span></code></pre></div></div></li><li><p>Для построения нового ядра используйте компилятор, расположенный в <span class=filename>/usr/obj</span>, чтобы защититься от ошибок несоответствия между компилятором и ядром. Это необходимо, так как определённые структуры данных могут поменяться, и при использовании различных версий ядра и исходных текстов перестанут работать <code>ps</code> и <code>top</code>.</p><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># make buildkernel</span></code></pre></div></div></li><li><p>Установите новое ядро и модули, чтобы их можно было использовать для загрузки. Если используется <code>kern.securelevel</code> со значением выше <code>1</code> <em>и</em> на файле ядра установлен <code>noschg</code> или подобный флаг, то для этого сперва придётся дополнительно перейти в однопользовательский режим. В противном случае эту команду можно без проблем запустить в многопользовательском режиме. Смотрите страницу Справочника <a href="https://man.freebsd.org/cgi/man.cgi?query=init&amp;sektion=8&amp;format=html">init(8)</a> для получения информации о <code>kern.securelevel</code>, а также <a href="https://man.freebsd.org/cgi/man.cgi?query=chflags&amp;sektion=1&amp;format=html">chflags(1)</a> для информации об использовании различных файловых флагов.</p><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># make installkernel</span></code></pre></div></div></li><li><p>Переведите систему в однопользовательский режим для минимизации проблем при обновлении уже работающих исполняемых файлов. Это также уменьшит вероятность возникновения проблем при работе старого мира на новом ядре.</p><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># shutdown now</span></code></pre></div></div><div class=paragraph><p>После перехода в однопользовательский режим, запустите эти команды, если в системе используется UFS:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># mount -u /</span>
<span class=c># mount -a -t ufs</span>
<span class=c># swapon -a</span></code></pre></div></div><div class=paragraph><p>Если используется ZFS, запустите другие две команды. В данном примере zpool называется <code>zroot</code>:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># zfs set readonly=off zroot</span>
<span class=c># zfs mount -a</span></code></pre></div></div></li><li><p>Дополнительно: Если желаемая картография клавиатуры отличается от используемой по умолчанию US English, её можно изменить с помощью <a href="https://man.freebsd.org/cgi/man.cgi?query=kbdmap&amp;sektion=1&amp;format=html">kbdmap(1)</a>:</p><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># kbdmap</span></code></pre></div></div></li><li><p>Затем, если часы CMOS установлены на местное время (это так, если вывод <a href="https://man.freebsd.org/cgi/man.cgi?query=date&amp;sektion=1&amp;format=html">date(1)</a> не содержит правильное время и часовой пояс), выполните:</p><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># adjkerntz -i</span></code></pre></div></div></li><li><p>Пересборка мира не включает в себя добавление или обновление конфигурационных файлов в <span class=filename>/etc</span>, <span class=filename>/var</span>, <span class=filename>/usr</span> и некоторых других каталогах. Следующим шагом является выполнение первоначального обновления файлов конфигурации в <span class=filename>/etc</span> для подготовки к новому миру. Следующая команда ограничивается сравнением файлов, необходимых для успешного выполнения цели <code>installworld</code>. В частности, на этом шаге могут быть добавлены новые пользовательские группы, служебные учётные записи и сценарии автозапуска, которые были добавлены во FreeBSD со времени последнего обновления. Это необходимо для их использования при выполнении шага <code>installworld</code>. Смотрите <a href=#mergemaster>Объединение файлов конфигурации</a> для получения более подробных инструкций по этой команде:</p><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># mergemaster -p</span></code></pre></div></div></li><li><p>Установите новый мир и служебные исполняемые файлы, находящиеся в <span class=filename>/usr/obj</span>.</p><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># cd /usr/src</span>
<span class=c># make installworld</span></code></pre></div></div></li><li><p>Обновите остальные файлы конфигурации.</p><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># mergemaster -iF</span></code></pre></div></div></li><li><p>Удалите устаревшие файлы. Это важно, так как в противном случае они могут вызвать проблемы.</p><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># make delete-old</span></code></pre></div></div></li><li><p>Теперь нужна полная перезагрузка системы для того, чтобы загрузить новое ядро и мир с использованием новых конфигурационных файлов.</p><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># reboot</span></code></pre></div></div></li><li><p>Убедитесь, что перед удалением старых версий библиотек все установленные порты были пересобраны согласно инструкциям в <a href=../ports/#ports-upgrading>Обновление портов</a>. По завершению удалите все старые библиотеки во избежание конфликтов с их новыми версиями. За подробным описанием этого шага обратитесь к <a href=#make-delete-old>Удаление устаревших файлов и библиотек</a>.</p><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># make delete-old-libs</span></code></pre></div></div></li></ol></div></div></div><div class=paragraph><p>Если для системы доступно окно обслуживания, обдумайте возможность компиляции системы в однопользовательском режиме вместо использования для этого многопользовательского режима с переводом в однопользовательский режим для установки. Переустановка системы затрагивает множество важных системных файлов, все стандартные системные исполняемые файлы, библиотеки и заголовочные файлы. Замена этих файлов на работающей системе (в частности, используемых в данный момент пользователями) может привести к неприятностям.</p></div></div><div class=sect2><h3 id=src-updating>21.6.2. Файлы конфигурации<a class=anchor href=#src-updating></a></h3><div class=paragraph><p>В процессе построения мира используется несколько файлов конфигурации.</p></div><div class=paragraph><p><span class=filename>Makefile</span>, расположенный в <span class=filename>/usr/src</span>, описывает правила и порядок построения программ, составляющих FreeBSD.</p></div><div class=paragraph><p>В <a href="https://man.freebsd.org/cgi/man.cgi?query=make.conf&amp;sektion=5&amp;format=html">make.conf(5)</a> описаны параметры, доступные для <code>make</code>, а также несколько общих примеров имеется в <span class=filename>/usr/shared/examples/etc/make.conf</span>. Добавляемые в <span class=filename>/etc/make.conf</span> параметры определяют поведение <code>make</code> при построении программ. Эти параметры действуют при каждом использовании <code>make</code>, включая компиляцию приложений из Коллекции Портов, компиляцию собственных программ на Си и построение операционной системы FreeBSD. Изменение некоторых настроек может иметь далекоидущие и порой неожиданные последствия. Прочтите комментарии в обоих местах и примите к сведению, что значения по умолчанию были выбраны как компромисс между производительностью и надёжностью.</p></div><div class=paragraph><p>Поведение при сборке операционной системы из исходных текстов задаётся в <span class=filename>/etc/src.conf</span>. В отличие от <span class=filename>/etc/make.conf</span>, содержимое <span class=filename>/etc/src.conf</span> влияет только на сборку самой операционной системы FreeBSD. Описание многих параметров, доступных в этом файле, имеется в <a href="https://man.freebsd.org/cgi/man.cgi?query=src.conf&amp;sektion=5&amp;format=html">src.conf(5)</a>. Будьте осторожны при выключении на первый взгляд ненужных модулей ядра или параметров сборки. Иногда между ними имеются неожиданные или неочевидные взаимозависимости.</p></div></div><div class=sect2><h3 id=make-buildworld>21.6.3. Переменные и цели выполнения<a class=anchor href=#make-buildworld></a></h3><div class=paragraph><p>Общий формат использования <code>make</code>:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># make -x -DVARIABLE target</span></code></pre></div></div><div class=paragraph><p>В этом примере параметр <code>-<em>x</em></code> передаётся <code>make</code>. Обратитесь к странице Справочника <a href="https://man.freebsd.org/cgi/man.cgi?query=make&amp;sektion=1&amp;format=html">make(1)</a> для получения примеров использования имеющихся параметров.</p></div><div class=paragraph><p>Чтобы передать переменную, укажите её имя с использованием <code>-D_VARIABLE_</code>. Поведение <span class=filename>Makefile</span> зависит от переменных. Они могут быть заданы в <span class=filename>/etc/make.conf</span> или указаны при использовании <code>make</code>. Например, эта переменная указывает, что библиотеки для профилирования собирать не нужно:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># make -DNO_PROFILE target</span></code></pre></div></div><div class=paragraph><p>Это соответствует настройке в <span class=filename>/etc/make.conf</span>:</p></div><div class="literalblock programlisting"><div class=content><pre>NO_PROFILE=    true     #    Обход построения библиотек для профилирования</pre></div></div><div class=paragraph><p><em>target</em> указывает программе <code>make</code> на то, что нужно сделать, а <span class=filename>Makefile</span> определяет доступные цели. Некоторые цели используются в процессе построения для разбиения его на этапы.</p></div><div class=paragraph><p>Разделение опций удобно по двум причинам. Во-первых, это позволяет выполнять сборку, не затрагивая компоненты рабочей системы. По этой причине можно спокойно запустить <code>buildworld</code> на машине, работающей в многопользовательском режиме. Но цель <code>installworld</code> всё же рекомендуется запускать в однопользовательском режиме.</p></div><div class=paragraph><p>Во-вторых, это позволяет использовать монтирование по NFS для обновления многих машин по сети согласно описанию в <a href=#small-lan>Отслеживание исходных текстов для нескольких машин</a>.</p></div><div class=paragraph><p>Параметр <code>-j</code> приводит к запуску нескольких одновременно работающих процессов <code>make</code>. Поскольку процесс компиляции больше всего требователен к подсистеме ввода/вывода, а не к производительности процессора, это можно использовать и на машинах с одним процессором.</p></div><div class=paragraph><p>Используйте следующую команду на машине с одним CPU, чтобы иметь до 4 одновременно работающих процессов. Опубликованные в списке рассылки практические замеры показывают, что в среднем это даёт наибольший выигрыш в производительности.</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># make -j4 buildworld</span></code></pre></div></div><div class=paragraph><p>На многопроцессорной машине попробуйте подобрать значение между <code>6</code> и <code>10</code>, и посмотрите, как это отразится на скорости работы.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Если при выполнении команды <code>make buildworld</code> были заданы значения каких-либо переменных, то при выполнении <code>make installworld</code> нужно задать те же самые переменные. При этом <code>-j</code> <em>нельзя</em> использовать совместно с <code>installworld</code>.</p></div><div class=paragraph><p>Например, если выполнялась эта команда:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># make -DNO_PROFILE buildworld</span></code></pre></div></div><div class=paragraph><p>то результат её выполнения должен устанавливаться командой:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># make -DNO_PROFILE installworld</span></code></pre></div></div><div class=paragraph><p>В противном случае вторая команда попытается установить библиотеки для профилирования, которые не компилировались на этапе выполнения команды <code>make buildworld</code>.</p></div></td></tr></tbody></table></div></div><div class=sect2><h3 id=mergemaster>21.6.4. Объединение файлов конфигурации<a class=anchor href=#mergemaster></a></h3><div class=paragraph><p>FreeBSD предоставляет утилиту <a href="https://man.freebsd.org/cgi/man.cgi?query=mergemaster&amp;sektion=8&amp;format=html">mergemaster(8)</a>, которая является скриптом для оболочки Боурна и предназначена для определения разницы между конфигурационными файлами в каталоге <span class=filename>/etc</span> и конфигурационными файлами из дерева исходных текстов <span class=filename>/usr/src/etc</span>. Это является рекомендуемым способом синхронизации системных конфигурационных файлов с теми, что размещены в дереве исходных текстов.</p></div><div class=paragraph><p>Перед использованием <code>mergemaster</code> рекомендуется скопировать имеющийся каталог <span class=filename>/etc</span> в какое-нибудь безопасное место. <code>-R</code> задает выполнение рекурсивного копирования, а <code>-p</code> сохраняет даты и владельца файлов:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># cp -Rp /etc /etc.old</span></code></pre></div></div><div class=paragraph><p>При запуске <code>mergemaster</code> строит временное корневое окружение, начиная с <span class=filename>/</span>, и заполняет его различными системными конфигурационными файлами. Затем эти файлы сравниваются с текущими установленными в системе. Файлы, которые имеют отличия, будут выданы в формате <a href="https://man.freebsd.org/cgi/man.cgi?query=diff&amp;sektion=1&amp;format=html">diff(1)</a>, где знак <code>+</code> означает добавленные или изменённые строки, а знак <code>-</code> означает строки, которые будут либо полностью удалены, либо заменены на новый файл. Обратитесь к страницам справочной системы по команде <a href="https://man.freebsd.org/cgi/man.cgi?query=diff&amp;sektion=1&amp;format=html">diff(1)</a> для получения более полной информации о формате выдачи отличий в файлах.</p></div><div class=paragraph><p>Затем <code>mergemaster</code> выдаст каждый файл, в котором есть изменения, с вариантами действий: удалить новый файл, упоминаемый здесь как временный, установить временный файл в его неизменённом виде, объединить временный файл с установленным на данный момент, либо просмотреть результат ещё раз.</p></div><div class=paragraph><p>Выбор удаления временного файла укажет <code>mergemaster</code> оставить текущий файл без изменений и удалить его новую версию. Делать это не рекомендуется. Чтобы получить помощь в любое время, наберите <kbd>?</kbd> в приглашении <code>mergemaster</code>. Если пользователь выбирает пропуск файла, запрос появится снова, после того как будут обработаны все остальные файлы.</p></div><div class=paragraph><p>Выбор установки немодифицированного временного файла приведёт к замене текущего файла новым. Для большинства немодифицированных файлов это является подходящим вариантом.</p></div><div class=paragraph><p>Выбор варианта с объединением файла приведёт к вызову текстового редактора, содержащего текст обоих файлов. Файлы можно объединить, просматривая оба файла на экране и выбирая те части из обоих, которые подходят для окончательного варианта. При сравнении файлов нажатие <kbd>l</kbd> выбирает содержимое слева, нажатие <kbd>r</kbd> выбирает содержимое справа. В окончательном варианте будет файл, состоящий из обеих частей, который и будет установлен. Этот вариант обычно используется для файлов, настройки в которых изменялись пользователем.</p></div><div class=paragraph><p>Выбор повторного просмотра результатов выдаст разницу между файлами.</p></div><div class=paragraph><p>После того как утилита <code>mergemaster</code> закончит работу с системными файлами, она выдаст запрос относительно других параметров. Она может запросить перестроение файла паролей и завершится запросом на удаление оставшихся временных файлов.</p></div></div><div class=sect2><h3 id=make-delete-old>21.6.5. Удаление устаревших файлов и библиотек<a class=anchor href=#make-delete-old></a></h3><div class=paragraph><p>В ходе жизненного цикла разработки FreeBSD файлы с их содержимым иногда становятся устаревшими. Это может быть вызвано тем, что функциональность реализуется в другом месте, сменился номер версии библиотеки или файл был целиком удалён из системы. Такие устаревшие файлы, библиотеки и каталоги следует удалять вместе с обновлением системы. Это не даст захламить систему старыми файлами, которые занимают место на диске и на архивных носителях. Кроме того, если в старой библиотеке имеется проблема безопасности или стабильности, такую систему следует обновить до более новой библиотеки, чтобы предотвратить крахи, вызванные работой старой версии. Файлы, каталоги и библиотеки, которые признаны устаревшими, перечислены в <span class=filename>/usr/src/ObsoleteFiles.inc</span>. Для удаления устаревших файлов в процессе обновления системы следует пользоваться следующими инструкциями.</p></div><div class=paragraph><p>После выполнения <code>make installworld</code> и последующего <code>mergemaster</code> проверьте наличие устаревших файлов и библиотек:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># cd /usr/src</span>
<span class=c># make check-old</span></code></pre></div></div><div class=paragraph><p>Если были найдены какие-либо устаревшие файлы, их можно удалить с помощью следующей команды:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># make delete-old</span></code></pre></div></div><div class=paragraph><p>Перед удалением каждого устаревшего файла запрашивается подтверждение. Используйте <code>BATCH_DELETE_OLD_FILES</code>, чтобы сократить этот процесс и позволить системе удалить эти файлы автоматически:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># make -DBATCH_DELETE_OLD_FILES delete-old</span></code></pre></div></div><div class=paragraph><p>Аналогичного эффекта можно достичь, пропустив эти команды через <code>yes</code>:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># yes|make delete-old</span></code></pre></div></div><div class="admonitionblock warning"><table><tbody><tr><td class=icon><i class="fa icon-warning" title=Warning></i></td><td class=content><div class=title>Предупреждение</div><div class=paragraph><p>Удаление устаревших файлов приведёт к нарушению работы программ, которые всё ещё зависят от этих устаревших файлов. Это особенно верно для старых библиотек. В большинстве случаев программы, порты или библиотеки, использующие такую старую библиотеку, нужно перекомпилировать перед выполнением <code>make delete-old-libs</code>.</p></div></td></tr></tbody></table></div><div class=paragraph><p>Программы для проверки наличия зависимостей от совместно используемых библиотек включают в себя <a class=package href=https://cgit.freebsd.org/ports/tree/sysutils/libchk/>sysutils/libchk</a> и <a class=package href=https://cgit.freebsd.org/ports/tree/sysutils/bsdadminscripts/>sysutils/bsdadminscripts</a>.</p></div><div class=paragraph><p>Устаревшие совместно используемые библиотеки могут конфликтовать с более новыми библиотеками, что приводит к сообщениям следующего вида:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>/usr/bin/ld: warning: libz.so.4, needed by /usr/local/lib/libtiff.so, may conflict with libz.so.5
/usr/bin/ld: warning: librpcsvc.so.4, needed by /usr/local/lib/libXext.so, may conflict with librpcsvc.so.5</code></pre></div></div><div class=paragraph><p>Для решения этих проблем выясните, какой именно порт установил данную библиотеку:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># pkg which /usr/local/lib/libtiff.so</span>
  /usr/local/lib/libtiff.so was installed by package tiff-3.9.4
<span class=c># pkg which /usr/local/lib/libXext.so</span>
  /usr/local/lib/libXext.so was installed by package libXext-1.1.1,1</code></pre></div></div><div class=paragraph><p>Затем данный порт нужно удалить, пересобрать и переустановить. Для автоматизации этого процесса можно использовать <a class=package href=https://cgit.freebsd.org/ports/tree/ports-mgmt/portmaster/>ports-mgmt/portmaster</a>. После того как все порты пересобраны и более не используют старые библиотеки, удалите эти старые библиотеки с помощью следующей команды:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># make delete-old-libs</span></code></pre></div></div><div class=paragraph><p>Если что-то работает неправильно, можно с лёгкостью перестроить конкретную часть системы. Например, если файл <span class=filename>/etc/magic</span> был случайно удалён в процессе обновления или переноса <span class=filename>/etc</span>, то команда <code>file</code> перестанет работать. В таком случае это можно исправить вот так:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># cd /usr/src/usr.bin/file</span>
<span class=c># make all install</span></code></pre></div></div></div><div class=sect2><h3 id=updating-questions>21.6.6. Вопросы общего характера<a class=anchor href=#updating-questions></a></h3><div class=dlist><dl><dt class=hdlist1>Нужно ли полностью перестраивать систему при каждом изменении?</dt><dd><p>Это зависит от характера изменения. Например, если svn показывает, что с момента последнего запуска были изменены только следующие файлы:</p><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>src/games/cribbage/instr.c
src/games/sail/pl_main.c
src/release/sysinstall/config.c
src/release/sysinstall/media.c
src/shared/mk/bsd.port.mk</code></pre></div></div><div class=paragraph><p>то перестраивать всю систему возможно незачем. Вместо этого можно перейти в соответствующие подкаталоги и выдать команду <code>make all install</code>. Однако если меняется что-то важное, например, <span class=filename>src/lib/libc/stdlib</span>, то вы должны перестроить всю систему.</p></div><div class=paragraph><p>Некоторые пользователи перестраивают систему каждые две недели, позволяя изменениям накопиться за это время. Другие перестраивают только те вещи, которые менялись, и внимательно отслеживают все зависимости. Всё это зависит от того, как часто пользователь хочет делать обновление и отслеживает ли он FreeBSD-STABLE или FreeBSD-CURRENT.</p></div></dd><dt class=hdlist1>Почему прерывается компиляция с большим количеством ошибок по сигналу 11 (или с другим номером сигнала)?</dt><dd><p>Как правило, это говорит о проблемах с оборудованием. Построение системы является эффективным стресс-тестом для оборудования, в особенности памяти. Явным указателем на это является то, что при перезапуске make процедура построения прекращается в различные моменты времени.</p><div class=paragraph><p>Для исправления этой ошибки попробуйте заменить комплектующие машины, начиная с оперативной памяти, для определения сбоящей компоненты.</p></div></dd><dt class=hdlist1>Можно ли удалить <span class=filename>/usr/obj</span> после окончания?</dt><dd><p>В этом каталоге содержатся все объектные файлы, которые создаются во время фазы компиляции. Обычно одним из первых шагов в процессе <code>make buildworld</code> является удаление этого каталога, чтобы начать заново. Сохранение <span class=filename>/usr/obj</span> после окончания имеет мало смысла, а его удаление освободит приблизительно 2 ГБ дискового пространства.</p></dd><dt class=hdlist1>Могут ли быть продолжены прерванные процессы построения?</dt><dd><p>Это зависит от того, насколько далеко зашел процесс построения перед тем, как была обнаружена проблема. В общем случае процесс <code>make buildworld</code> строит новые копии необходимых инструментальных средств и системные библиотеки. Затем эти средства и библиотеки устанавливаются. Новые инструментальные средства и библиотеки затем используются для перестроения самих себя и повторно устанавливаются. Система в целом теперь перестраивается с новыми системными файлами.</p><div class=paragraph><p>На последней стадии выполнение этих команд является достаточно безопасным, поскольку они не отменяют работу предыдущего <code>make buildworld</code>:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># cd /usr/src</span>
<span class=c># make -DNO_CLEAN all</span></code></pre></div></div><div class=paragraph><p>Если в выводе <code>make buildworld</code> появляется такое сообщение:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=nt>--------------------------------------------------------------</span>
Building everything..
<span class=nt>--------------------------------------------------------------</span></code></pre></div></div><div class=paragraph><p>то делать так вероятно достаточно безопасно.</p></div><div class=paragraph><p>Если такое сообщение не выводится, всегда лучше подстраховаться и запустить сборку с самого начала.</p></div></dd><dt class=hdlist1>Можно ли ускорить сборку мира?</dt><dd><p>Ускорить процесс сборки мира может несколько действий. Например, весь процесс можно выполнять в однопользовательском режиме. Однако, это не позволит пользователям иметь доступ к системе, пока этот процесс не завершится.</p><div class=paragraph><p>Тщательный подход к проектированию файловой системы или использование датасетов ZFS позволит почувствовать разницу. Задумайтесь о размещении <span class=filename>/usr/src</span> и <span class=filename>/usr/obj</span> на различных файловых системах. По возможности размещайте файловые системы на различных дисках и дисковых контроллерах. При монтировании <span class=filename>/usr/src</span> используйте параметр <code>noatime</code>, который отключает запись информации о времени доступа к файлу. Если <span class=filename>/usr/src</span> не расположен на собственной файловой системе, подумайте о перемонтировании <span class=filename>/usr</span> с <code>noatime</code>.</p></div><div class=paragraph><p>Файловая система, на которой располагается <span class=filename>/usr/obj</span>, может быть смонтирована (или перемонтирована) с параметром <code>async</code>. Это приведёт к тому, что операции записи на диск будут выполняться асинхронно. Другими словами, запись будет завершаться немедленно, но данные записываться на диск несколькими секундами позже. Это позволит объединять операции записи и приведёт к значительному приросту производительности.</p></div><div class=paragraph><p>Файловую систему с <span class=filename>/usr/obj</span> можно смонтировать с <code>async</code> для записи на диск в асинхронном режиме. В этом случае операции записи завершаются мгновенно, а сами данные записываются на диск через несколько секунд. Это позволяет писать кластеризованно, что может дать значительный прирост производительности.</p></div><div class="admonitionblock warning"><table><tbody><tr><td class=icon><i class="fa icon-warning" title=Warning></i></td><td class=content><div class=paragraph><p>Имейте в виду, что эта опция делает вашу файловую систему менее устойчивой. С этой опцией имеется больше шансов, что при перезагрузке машины после неожиданного сбоя при пропадании напряжения файловая система окажется в невосстановимом состоянии.</p></div><div class=paragraph><p>Если каталог <span class=filename>/usr/obj</span> - это всё, что есть на этой файловой системе, то это не проблема. Если на той же самой файловой системе имеются какие-то важные данные, то проверьте давность ваших резервных копий перед включением этой опции.</p></div></td></tr></tbody></table></div><div class=paragraph><p>Выключите генерацию профилирующего кода, установив "NO_PROFILE=true" в файле <span class=filename>/etc/make.conf</span>.</p></div><div class=paragraph><p>Передайте утилите <a href="https://man.freebsd.org/cgi/man.cgi?query=make&amp;sektion=1&amp;format=html">make(1)</a> параметр <code>-j<em>n</em></code> для запуска параллельно нескольких процессов. Обычно это помогает вне зависимости от того, сколько процессоров установлено в машине.</p></div></dd><dt class=hdlist1>Что делать, если что-то пошло не так?</dt><dd><p>Скрупулезно проверьте, чтобы в вашем окружении не было мешающих остатков от предыдущих построений:</p><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># chflags -R noschg /usr/obj/usr</span>
<span class=c># rm -rf /usr/obj/usr</span>
<span class=c># cd /usr/src</span>
<span class=c># make cleandir</span>
<span class=c># make cleandir</span></code></pre></div></div><div class=paragraph><p>Да, команду <code>make cleandir</code> действительно нужно выполнять дважды.</p></div><div class=paragraph><p>После этого повторите весь процесс снова, начиная с <code>make buildworld</code>.</p></div><div class=paragraph><p>Если у вас всё ещё есть проблемы, пришлите текст ошибки и вывод команды <code>uname -a</code> в <a href=https://lists.FreeBSD.org/subscription/freebsd-questions>Список рассылки, посвящённый вопросам и ответам пользователей FreeBSD</a>. Будьте готовы ответить на другие вопросы о конфигурации вашей системы!</p></div></dd></dl></div></div></div></div><div class=sect1><h2 id=small-lan>21.7. Отслеживание исходных текстов для нескольких машин<a class=anchor href=#small-lan></a></h2><div class=sectionbody><div class=paragraph><p>Если нужно отслеживать одно и то же дерево исходных текстов на множестве машин, то загрузка кода и полное перестроение системы на каждой из них выглядит как ненужная трата ресурсов: дискового пространства, пропускной способности сети и процессорного времени. Решением является выделение одной машины, которая выполняет основной объём работы, в то время как остальные используют результаты работы посредством NFS. В этом разделе описывается именно этот метод. Для получения информации об использовании NFS обращайтесь в <a href=../network-servers/#network-nfs>Network File System (NFS)</a>.</p></div><div class=paragraph><p>Первым делом определите набор машин, на которых будет выполняться единый набор программ, который мы будем называть <em>набором для построения</em>. Каждая машина может иметь собственное уникальное ядро, но они будут работать с одними и теми же программами пользователя. Из этого набора выберите машину, которая будет являться <em>машиной построения</em>, на которой будут строиться ядро и всё окружение. В идеальном случае это быстрая машина с достаточно незагруженным CPU для выполнения команд <code>make buildworld</code> и <code>make buildkernel</code>.</p></div><div class=paragraph><p>Выберите <em>тестовую машину</em>, которая будет выполнять проверку обновлений программного обеспечения, прежде чем они пойдут в работу. Это <em>должна</em> быть машина, которая может находиться в нерабочем состоянии достаточно долго. Это также может быть машина построения, но не обязательно.</p></div><div class=paragraph><p>Всем машинам в этом наборе для построения нужно смонтировать <span class=filename>/usr/obj</span> и <span class=filename>/usr/src</span> по NFS с машины построения. В случае нескольких наборов для построения каталог <span class=filename>/usr/src</span> должен находиться на одной машине построения и монтироваться на остальных по NFS.</p></div><div class=paragraph><p>Удостоверьтесь, что <span class=filename>/etc/make.conf</span> и <span class=filename>/etc/src.conf</span> на всех машинах в заданном наборе для построения согласуются с машиной построения. Это означает, что машина построения должна строить все те части базовой системы, которые будут устанавливаться на каждой машине из набора для построения. Кроме того, у каждой машины построения должно быть задано имя ядра в переменной <code>KERNCONF</code> в <span class=filename>/etc/make.conf</span>, и машина построения должна перечислить их все в переменной <code>KERNCONF</code>, причём первым должно идти имя её собственного ядра. Машина построения должна хранить конфигурационные файлы ядра каждой машины в каталоге <span class=filename>/usr/src/sys/arch/conf</span>.</p></div><div class=paragraph><p>Постройте ядро и всё окружение на машине построения так, как это описано в <a href=#make-buildworld>Переменные и цели выполнения</a>, но ничего не устанавливайте на самой машине. Вместо этого, установите собранное ядро на тестовой машине. Для этого смонтируйте <span class=filename>/usr/src</span> и <span class=filename>/usr/obj</span> по NFS. Затем выполните команду <code>shutdown now</code> для перехода в однопользовательский режим, для того чтобы установить новое ядро и всё окружение, после чего выполните команду <code>mergemaster</code> обычным образом. После этих действий перезагрузитесь для возврата к обычному режиму работы в многопользовательском режиме.</p></div><div class=paragraph><p>После того, как вы убедитесь в нормальной работе всего на тестовой машине, проведите эту процедуру для установки нового программного обеспечения на каждой из оставшихся машин в наборе для построения.</p></div><div class=paragraph><p>Такой же подход можно использовать и для дерева портов. Сперва нужно смонтировать <span class=filename>/usr/ports</span> по NFS на всех машинах в наборе для построения. Чтобы настроить <span class=filename>/etc/make.conf</span> для использования общего каталога с дистрибутивными файлами, задайте переменную <code>DISTDIR</code> так, чтобы она указывала на общедоступный каталог, доступный для записи тому пользователю, который отображается в пользователя <code>root</code> для точек монтирования NFS. Каждая машина должна задавать <code>WRKDIRPREFIX</code> так, чтобы она указывала на локальный каталог, если порты будут собираться локально. Если же пакеты будут распространяться, задайте на машине построения переменную <code>PACKAGES</code>, чтобы она указывала на каталог, соответствующий <code>DISTDIR</code>.</p></div></div></div></div><hr><div class=last-modified><p><strong>Изменено</strong>: 9 марта 2024 г. by <a href="https://cgit.freebsd.org/doc/commit/?id=6199af92e7" target=_blank>Danilo G. Baio</a></p></div><div class=buttons><div class=prev><i class="fa fa-angle-left" aria-hidden=true title=Назад></i><div class=container><a href=https://docs.freebsd.org/ru/books/handbook/l10n class=direction>Назад</a></div></div><div class=home><i class="fa fa-home" aria-hidden=true title=Главная></i><div class=container><a href=../ class=direction>Главная</a></div></div><div class=next><div class=container><a href=https://docs.freebsd.org/ru/books/handbook/partiv class=direction>Далее</a></div><i class="fa fa-angle-right" aria-hidden=true title=Далее></i></div></div><label class="hidden book-menu-overlay" for=menu-control></label></div><aside class=toc><div class=toc-content><h3>Содержание</h3><nav id=TableOfContents><ul><li><a href=#updating-upgrading-synopsis>21.1. Краткий обзор</a></li><li><a href=#updating-upgrading-freebsdupdate>21.2. Обновление FreeBSD</a></li><li><a href=#updating-upgrading-documentation>21.3. Обновление документации</a></li><li><a href=#current-stable>21.4. Использование ветви разработки</a></li><li><a href=#synching>21.5. Синхронизация исходных текстов</a></li><li><a href=#makeworld>21.6. Пересборка мира</a></li><li><a href=#small-lan>21.7. Отслеживание исходных текстов для нескольких машин</a></li></ul></nav><hr><div class=resources><h3>Материалы</h3><ul class=contents><li><i class="fa fa-file-pdf-o" aria-hidden=true title="Скачать PDF"></i><a href=https://download.freebsd.org/doc/ru/books/handbook/handbook_ru.pdf>Скачать PDF</a></li><li><i class="fa fa-pencil-square-o" aria-hidden=true title="Редактировать эту страницу"></i><a href=https://github.com/freebsd/freebsd-doc/blob/main/documentation/content/ru/_index target=_blank>Редактировать эту страницу</a></li></ul></div></div></aside><a class=to-top href=#top><i class="fa fa-arrow-circle-up" aria-hidden=true></i></a></main><footer><div class=footer-container><section class=logo-column><img src=https://docs.freebsd.org/images/FreeBSD-colors.svg width=160 height=50 alt="FreeBSD logo"><div class=options-container><div class=language-container><a id=languages href=https://docs.freebsd.org/ru/languages><img src=https://docs.freebsd.org/images/language.png class=language-image alt="Выберите язык">
<span>Русский</span></a></div><div class=theme-container><select id=theme-chooser><option value=theme-system>Система</option><option value=theme-light>Светлый</option><option value=theme-dark>Тёмный</option><option value=theme-high-contrast>Высокая контрастность</option></select></div></div></section><section class=about-column><h3 class=column-title>О нас</h3><ul class=column-elements-container><li><a href=https://www.freebsd.org/about/ target=_blank class=column-element>FreeBSD</a></li><li><a href=https://freebsdfoundation.org/ target=_blank class=column-element>Фонд FreeBSD</a></li><li><a href=https://www.freebsd.org/where/ target=_blank class=column-element>Получить FreeBSD</a></li><li><a href=https://www.freebsd.org/internal/code-of-conduct target=_blank class=column-element>Кодекс Этики</a></li><li><a href=https://www.freebsd.org/security/ target=_blank class=column-element>Бюллетени Безопасности</a></li></ul></section><section class=documentation-column><h3 class=column-title>Документация</h3><ul class=column-elements-container><li><a href=/ru class=column-element>Портал документации</a></li><li><a href=https://man.FreeBSD.org target=_blank class=column-element>Страницы Справочника</a></li><li><a href=https://papers.FreeBSD.org target=_blank class=column-element>Презентации и публикации</a></li><li><a href=https://docs-archive.freebsd.org/doc/ target=_blank class=column-element>Предыдущие версии</a></li><li><a href=https://docs-archive.freebsd.org/44doc/ target=_blank class=column-element>Документы 4.4BSD</a></li><li><a href=https://wiki.freebsd.org/ target=_blank class=column-element>Wiki</a></li></ul></section><section class=community-column><h3 class=column-title>Сообщество</h3><ul class=column-elements-container><li><a href=https://docs.freebsd.org/ru/articles/contributing class=column-element>Принять участие</a></li><li><a href=https://forums.freebsd.org/ target=_blank class=column-element>Форум Сообщества</a></li><li><a href=https://lists.freebsd.org/ target=_blank class=column-element>Списки рассылки</a></li><li><a href=https://wiki.freebsd.org/IRC/Channels target=_blank class=column-element>Каналы IRC</a></li><li><a href=https://bugs.freebsd.org/bugzilla/ target=_blank class=column-element>Трекер ошибок</a></li></ul></section><section class=legal-column><h3 class=column-title>Юридическая информация</h3><ul class=column-elements-container><li><a href=https://freebsdfoundation.org/donate/ target=_blank class=column-element>Пожертвования</a></li><li><a href=https://www.freebsd.org/copyright/freebsd-license/ target=_blank class=column-element>Лицензирование</a></li><li><a href=https://www.freebsd.org/privacy/ target=_blank class=column-element>Политика Конфиденциальности</a></li><li><a href=https://www.freebsd.org/copyright/ target=_blank class=column-element>Юридические оговорки</a></li></ul></section><section class=copyright-column><p>&copy; 1994-2024 Проект FreeBSD. Все права защищены</p><span>Сделано с помощью <span class=heart>♥</span> Сообществом FreeBSD</span></section></div></footer></body></html>