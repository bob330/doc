<!doctype html><html class=theme-light lang=ru><head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content><meta name=keywords content><meta name=copyright content="1995-2024 The FreeBSD Foundation"><link rel=canonical href=http://172.16.201.134:1313/ru/books/handbook/network-servers/><title>Глава 25. Сетевые серверы | FreeBSD Documentation Portal</title>
<meta name=theme-color content="#790000"><meta name=color-scheme content="system light dark high-contrast"><link rel="shortcut icon" href=http://172.16.201.134:1313/favicon.ico><link rel=stylesheet href=http://172.16.201.134:1313/styles/main.min.css><link rel=stylesheet href=http://172.16.201.134:1313/css/font-awesome-min.css><script defer src=/js/theme-chooser.min.js></script><script defer src=/js/copy-clipboard.min.js></script><script defer src=/js/search.min.js></script><meta name=twitter:card content="summary"><meta name=twitter:domain content="docs.FreeBSD.org"><meta name=twitter:site content="@freebsd"><meta name=twitter:url content="https://twitter.com/freebsd"><meta property="og:title" content="Глава 25. Сетевые серверы"><meta property="og:description" content><meta property="og:type" content="website"><meta property="og:image" content="http://172.16.201.134:1313/favicon.ico"><meta property="og:image:alt" content="FreeBSD Logo"><meta property="og:locale" content="ru"><meta property="og:url" content="http://172.16.201.134:1313/ru/books/handbook/network-servers/"><meta property="og:site_name" content="FreeBSD Documentation Portal"><script type=application/ld+json>{"@context":"http://schema.org","@type":"Article","url":"http:\/\/172.16.201.134:1313\/ru\/books\/handbook\/network-servers\/","name":"FreeBSD Documentation Portal","headline":"FreeBSD Documentation Portal","description":"FreeBSD Documentation Portal"}</script></head><body><header><div class=header-container><div class=logo-menu-bars-container><a href=https://www.FreeBSD.org class=logo><img src=http://172.16.201.134:1313/images/FreeBSD-monochromatic.svg width=160 height=50 alt="FreeBSD logo">
</a><label class=menu-bars for=menu-bars><i class="fa fa-bars" aria-hidden=true></i></label></div><input id=menu-bars type=checkbox><nav><ul class=menu><li class=menu-item><input id=about type=checkbox>
<a href=# aria-label="Navigate to About section"><label class=menu-item-description for=about>О нас
<i class="fa fa-angle-down fa-lg" aria-hidden=true></i></label></a><ul class=sub-menu><li class=title><a href=https://www.freebsd.org/about/ target=_blank>О нас</a></li><li><a href=https://www.freebsd.org/about/ target=_blank>FreeBSD</a></li><li><a href=https://freebsdfoundation.org/about-us/about-the-foundation/ target=_blank>Фонд FreeBSD</a></li><li><a href=https://www.freebsd.org/internal/code-of-conduct/ target=_blank>Кодекс Этики</a></li></ul></li><li class=menu-item><input id=download type=checkbox>
<a href=# aria-label="Navigate to get FreeBSD section"><label class=menu-item-description for=download>Получить FreeBSD
<i class="fa fa-angle-down fa-lg" aria-hidden=true></i></label></a><ul class=sub-menu><li class=title><a href=https://www.freebsd.org/where/ target=_blank>Получить FreeBSD</a></li><li><a href=https://www.freebsd.org/releases/ target=_blank>Информация о релизах</a></li><li><a href=https://www.freebsd.org/releng/ target=_blank>Подготовка релизов</a></li><li><a href=https://www.freebsd.org/security/ target=_blank>Бюллетени Безопасности</a></li></ul></li><li class=menu-item><input id=documentation type=checkbox>
<a href=# aria-label="Navigate to get Documentation section"><label class=menu-item-description for=documentation>Документация
<i class="fa fa-angle-down fa-lg" aria-hidden=true></i></label></a><ul class=sub-menu><li class=title><a href=/ru>Портал документации</a></li><li><a href=http://172.16.201.134:1313/ru/books/handbook>Руководство</a></li><li><a href=http://172.16.201.134:1313/ru/books/porters-handbook>Руководство по созданию портов</a></li><li><a href=https://docs.FreeBSD.org/en/books/fdp-primer>Учебник Проекта Документирования</a></li><li><a href=https://man.FreeBSD.org target=_blank>Страницы Справочника</a></li><li><a href=https://papers.FreeBSD.org target=_blank>Презентации и публикации</a></li><li><a href=https://wiki.FreeBSD.org target=_blank>Wiki</a></li><li><a href=http://172.16.201.134:1313/ru/books>Книги</a></li><li><a href=http://172.16.201.134:1313/ru/articles>Статьи</a></li></ul></li><li class=menu-item><input id=community type=checkbox>
<a href=# aria-label="Navigate to get Community section"><label class=menu-item-description for=community>Сообщество
<i class="fa fa-angle-down fa-lg" aria-hidden=true></i></label></a><ul class=sub-menu><li class=title><a href=https://www.freebsd.org/community/>Сообщество</a></li><li><a href=http://172.16.201.134:1313/ru/articles/contributing>Стать участником</a></li><li><a href=https://forums.freebsd.org/ target=_blank>Форум</a></li><li><a href=https://lists.freebsd.org/ target=_blank>Списки рассылки</a></li><li><a href=https://wiki.freebsd.org/IRC/Channels target=_blank>Каналы IRC</a></li><li><a href=https://bugs.freebsd.org/bugzilla/ target=_blank>Трекер ошибок</a></li><li><a href=https://www.freebsd.org/support/ target=_blank>Поддержка</a></li></ul></li></ul></nav><div class=search-donate-container><form class=search method=get id=search-header-form action=https://docs.freebsd.org/search name=search-header-form><input type=hidden name=DB value=ru>
<input id=words name=P type=text size=20 maxlength=255>
<button>
<i class="fa fa-search" aria-hidden=true></i></button></form><div class=donate><a href=https://freebsdfoundation.org/donate/ target=_blank><span class=heart>♥</span>
Пожертвования</a></div></div></div></header><input type=checkbox class="hidden toggle" id=menu-control><main class=main-wrapper-book><a id=top></a><aside class=book-menu><div class=book-menu-content><input id=search-book type=text placeholder=Поиск aria-label=Поиск maxlength=128><nav id=MenuContents><ul><li><input type=checkbox id=chapter-eb2a98ce203d8afd517726e6d8776be3 class=toggle>
<label class="icon cursor" for=chapter-eb2a98ce203d8afd517726e6d8776be3><a role=button></a></label><a href=http://172.16.201.134:1313/ru/books/handbook/preface/>Предисловие</a><ul><li><a href=http://172.16.201.134:1313/ru/books/handbook/preface/#preface-audience>Целевая аудитория</a></li><li><a href=http://172.16.201.134:1313/ru/books/handbook/preface/#preface-changes-from4>Четвёртое издание</a></li><li><a href=http://172.16.201.134:1313/ru/books/handbook/preface/#preface-changes-from3>Третье издание</a></li><li><a href=http://172.16.201.134:1313/ru/books/handbook/preface/#preface-changes-from2>Второе издание (2004)</a></li><li><a href=http://172.16.201.134:1313/ru/books/handbook/preface/#preface-changes>Первое издание (2001)</a></li><li><a href=http://172.16.201.134:1313/ru/books/handbook/preface/#preface-overview>Структура этой книги</a></li><li><a href=http://172.16.201.134:1313/ru/books/handbook/preface/#preface-conv>Договоренности, используемые в этой книге</a></li><li><a href=http://172.16.201.134:1313/ru/books/handbook/preface/#preface-acknowledgements>Благодарности</a></li></ul></li><li><input type=checkbox id=chapter-14a525fce014b90b8a458a894818255a class=toggle>
<label for=chapter-14a525fce014b90b8a458a894818255a><a role=button></a></label><a href=http://172.16.201.134:1313/ru/books/handbook/parti/>Часть I. В начале</a></li><li><input type=checkbox id=chapter-f9c9f3451644df30d224350da97d5da6 class=toggle>
<label class="icon cursor" for=chapter-f9c9f3451644df30d224350da97d5da6><a role=button></a></label><a href=http://172.16.201.134:1313/ru/books/handbook/introduction/>Глава 1. Введение</a><ul><li><a href=http://172.16.201.134:1313/ru/books/handbook/introduction/#introduction-synopsis>1.1. Краткий обзор</a></li><li><a href=http://172.16.201.134:1313/ru/books/handbook/introduction/#nutshell>1.2. Добро пожаловать во FreeBSD!</a></li><li><a href=http://172.16.201.134:1313/ru/books/handbook/introduction/#history>1.3. О Проекте FreeBSD</a></li></ul></li><li><input type=checkbox id=chapter-6aaec170775233b7c45f6cdcfb70d466 class=toggle>
<label class="icon cursor" for=chapter-6aaec170775233b7c45f6cdcfb70d466><a role=button></a></label><a href=http://172.16.201.134:1313/ru/books/handbook/install/>Глава 2. Установка FreeBSD версий 8.X и более ранних</a><ul><li><a href=http://172.16.201.134:1313/ru/books/handbook/install/#install-synopsis>2.1. Краткий обзор</a></li><li><a href=http://172.16.201.134:1313/ru/books/handbook/install/#install-hardware>2.2. Аппаратные требования</a></li><li><a href=http://172.16.201.134:1313/ru/books/handbook/install/#install-pre>2.3. Перед установкой</a></li><li><a href=http://172.16.201.134:1313/ru/books/handbook/install/#install-start>2.4. Начало установки</a></li><li><a href=http://172.16.201.134:1313/ru/books/handbook/install/#using-sysinstall>2.5. Введение в Sysinstall</a></li><li><a href=http://172.16.201.134:1313/ru/books/handbook/install/#install-steps>2.6. Выделение дискового пространства</a></li><li><a href=http://172.16.201.134:1313/ru/books/handbook/install/#install-choosing>2.7. Выбор устанавливаемых компонентов</a></li><li><a href=http://172.16.201.134:1313/ru/books/handbook/install/#install-media>2.8. Выбор источника для установки</a></li><li><a href=http://172.16.201.134:1313/ru/books/handbook/install/#install-final-warning>2.9. Подтверждение установки</a></li><li><a href=http://172.16.201.134:1313/ru/books/handbook/install/#install-post>2.10. После установки</a></li><li><a href=http://172.16.201.134:1313/ru/books/handbook/install/#install-trouble>2.11. Решение проблем</a></li><li><a href=http://172.16.201.134:1313/ru/books/handbook/install/#install-advanced>2.12. Расширенное руководство по установке</a></li><li><a href=http://172.16.201.134:1313/ru/books/handbook/install/#install-diff-media>2.13. Подготовка собственного источника установки</a></li></ul></li><li><input type=checkbox id=chapter-f693a3fa687a72d63ec8129ee302d664 class=toggle>
<label class="icon cursor" for=chapter-f693a3fa687a72d63ec8129ee302d664><a role=button></a></label><a href=http://172.16.201.134:1313/ru/books/handbook/bsdinstall/>Глава 3. Установка FreeBSD версий 9.X и более поздних</a><ul><li><a href=http://172.16.201.134:1313/ru/books/handbook/bsdinstall/#bsdinstall-synopsis>3.1. Краткий обзор</a></li><li><a href=http://172.16.201.134:1313/ru/books/handbook/bsdinstall/#bsdinstall-hardware>3.2. Аппаратные требования</a></li><li><a href=http://172.16.201.134:1313/ru/books/handbook/bsdinstall/#bsdinstall-pre>3.3. Перед установкой</a></li><li><a href=http://172.16.201.134:1313/ru/books/handbook/bsdinstall/#bsdinstall-start>3.4. Начало установки</a></li><li><a href=http://172.16.201.134:1313/ru/books/handbook/bsdinstall/#using-bsdinstall>3.5. Введение в bsdinstall</a></li><li><a href=http://172.16.201.134:1313/ru/books/handbook/bsdinstall/#bsdinstall-netinstall>3.6. Установка по сети</a></li><li><a href=http://172.16.201.134:1313/ru/books/handbook/bsdinstall/#bsdinstall-partitioning>3.7. Выделение дискового пространства</a></li><li><a href=http://172.16.201.134:1313/ru/books/handbook/bsdinstall/#bsdinstall-final-warning>3.8. Завершение установки</a></li><li><a href=http://172.16.201.134:1313/ru/books/handbook/bsdinstall/#bsdinstall-post>3.9. После установки</a></li><li><a href=http://172.16.201.134:1313/ru/books/handbook/bsdinstall/#bsdinstall-install-trouble>3.10. Решение проблем</a></li><li><a href=http://172.16.201.134:1313/ru/books/handbook/bsdinstall/#using-live-cd>3.11. Использование Live CD</a></li></ul></li><li><input type=checkbox id=chapter-9f6db261075f578742036fcc6000eecd class=toggle>
<label class="icon cursor" for=chapter-9f6db261075f578742036fcc6000eecd><a role=button></a></label><a href=http://172.16.201.134:1313/ru/books/handbook/basics/>Глава 4. Основы UNIX</a><ul><li><a href=http://172.16.201.134:1313/ru/books/handbook/basics/#basics-synopsis>4.1. Краткий обзор</a></li><li><a href=http://172.16.201.134:1313/ru/books/handbook/basics/#consoles>4.2. Виртуальные консоли и терминалы</a></li><li><a href=http://172.16.201.134:1313/ru/books/handbook/basics/#users-synopsis>4.3. Пользователи и основы управления учетными записями</a></li><li><a href=http://172.16.201.134:1313/ru/books/handbook/basics/#permissions>4.4. Права доступа</a></li><li><a href=http://172.16.201.134:1313/ru/books/handbook/basics/#dirstructure>4.5. Структура каталогов</a></li><li><a href=http://172.16.201.134:1313/ru/books/handbook/basics/#disk-organization>4.6. Организация дисков</a></li><li><a href=http://172.16.201.134:1313/ru/books/handbook/basics/#mount-unmount>4.7. Монтирование и размонтирование файловых систем</a></li><li><a href=http://172.16.201.134:1313/ru/books/handbook/basics/#basics-processes>4.8. Процессы</a></li><li><a href=http://172.16.201.134:1313/ru/books/handbook/basics/#basics-daemons>4.9. Даемоны, сигналы, уничтожение процессов</a></li><li><a href=http://172.16.201.134:1313/ru/books/handbook/basics/#shells>4.10. Интерпретатор команд</a></li><li><a href=http://172.16.201.134:1313/ru/books/handbook/basics/#editors>4.11. Текстовые редакторы</a></li><li><a href=http://172.16.201.134:1313/ru/books/handbook/basics/#basics-devices>4.12. Устройства и файлы устройств</a></li><li><a href=http://172.16.201.134:1313/ru/books/handbook/basics/#binary-formats>4.13. Бинарные форматы</a></li><li><a href=http://172.16.201.134:1313/ru/books/handbook/basics/#basics-more-information>4.14. Дополнительная информация</a></li></ul></li><li><input type=checkbox id=chapter-01c5707e95d14c0ff84bf62600c958d1 class=toggle>
<label class="icon cursor" for=chapter-01c5707e95d14c0ff84bf62600c958d1><a role=button></a></label><a href=http://172.16.201.134:1313/ru/books/handbook/ports/>Глава 5. Установка приложений: порты и пакеты</a><ul><li><a href=http://172.16.201.134:1313/ru/books/handbook/ports/#ports-synopsis>5.1. Обзор</a></li><li><a href=http://172.16.201.134:1313/ru/books/handbook/ports/#ports-overview>5.2. Обзор установки программного обеспечения</a></li><li><a href=http://172.16.201.134:1313/ru/books/handbook/ports/#ports-finding-applications>5.3. Поиск программного обеспечения</a></li><li><a href=http://172.16.201.134:1313/ru/books/handbook/ports/#packages-using>5.4. Использование бинарных пакетов</a></li><li><a href=http://172.16.201.134:1313/ru/books/handbook/ports/#pkgng-intro>5.5. Использование pkgng для управления бинарными пакетами</a></li><li><a href=http://172.16.201.134:1313/ru/books/handbook/ports/#ports-using>5.6. Использование Коллекции Портов</a></li><li><a href=http://172.16.201.134:1313/ru/books/handbook/ports/#ports-nextsteps>5.7. Действия после установки</a></li><li><a href=http://172.16.201.134:1313/ru/books/handbook/ports/#ports-broken>5.8. Обработка нерабочих портов</a></li></ul></li><li><input type=checkbox id=chapter-f56428b9e0d0b77cc8e863910f96bbde class=toggle>
<label class="icon cursor" for=chapter-f56428b9e0d0b77cc8e863910f96bbde><a role=button></a></label><a href=http://172.16.201.134:1313/ru/books/handbook/wayland/>Глава 6. Wayland</a><ul><li><a href=http://172.16.201.134:1313/ru/books/handbook/wayland/#wayland-synopsis>6.1. Общие сведения о Wayland</a></li><li><a href=http://172.16.201.134:1313/ru/books/handbook/wayland/#wayland-wayfire>6.2. Композитный менеджер Wayfire</a></li><li><a href=http://172.16.201.134:1313/ru/books/handbook/wayland/#wayland-hikari>6.3. Композитный менеджер Hikari</a></li><li><a href=http://172.16.201.134:1313/ru/books/handbook/wayland/#wayland-sway>6.4. Композитный менеджер Sway</a></li><li><a href=http://172.16.201.134:1313/ru/books/handbook/wayland/#wayland-xwayland>6.5. Использование Xwayland</a></li><li><a href=http://172.16.201.134:1313/ru/books/handbook/wayland/#wayland-remotedesktop>6.6. Организация Удалённого Рабочего Стола при помощи VNC</a></li><li><a href=http://172.16.201.134:1313/ru/books/handbook/wayland/#wayland-ly>6.7. Менеджер регистраций Wayland</a></li><li><a href=http://172.16.201.134:1313/ru/books/handbook/wayland/#wayland-utilities>6.8. Полезные Инструменты</a></li></ul></li><li><input type=checkbox id=chapter-3405c00581365a8b5d16af70fe4d1b72 class=toggle>
<label class="icon cursor" for=chapter-3405c00581365a8b5d16af70fe4d1b72><a role=button></a></label><a href=http://172.16.201.134:1313/ru/books/handbook/x11/>Глава 6. X Window System</a><ul><li><a href=http://172.16.201.134:1313/ru/books/handbook/x11/#x11-synopsis>6.1. Обзор</a></li><li><a href=http://172.16.201.134:1313/ru/books/handbook/x11/#x-understanding>6.2. Основы X</a></li><li><a href=http://172.16.201.134:1313/ru/books/handbook/x11/#x-install>6.3. Установка X11</a></li><li><a href=http://172.16.201.134:1313/ru/books/handbook/x11/#x-config>6.4. Конфигурация X11</a></li><li><a href=http://172.16.201.134:1313/ru/books/handbook/x11/#x-fonts>6.5. Использование шрифтов в X11</a></li><li><a href=http://172.16.201.134:1313/ru/books/handbook/x11/#x-xdm>6.6. Менеджеры экранов (Display Managers) X</a></li><li><a href=http://172.16.201.134:1313/ru/books/handbook/x11/#x11-wm>6.7. Графические оболочки</a></li></ul></li><li><input type=checkbox id=chapter-0eab3565e8f59f5a8a896dfba7eb3680 class=toggle>
<label for=chapter-0eab3565e8f59f5a8a896dfba7eb3680><a role=button></a></label><a href=http://172.16.201.134:1313/ru/books/handbook/partii/>Часть II. Общие задачи</a></li><li><input type=checkbox id=chapter-b33cf28993f3f7bf5baf036e79da0f39 class=toggle>
<label class="icon cursor" for=chapter-b33cf28993f3f7bf5baf036e79da0f39><a role=button></a></label><a href=http://172.16.201.134:1313/ru/books/handbook/desktop/>Глава 7. Приложения для настольного компьютера</a><ul><li><a href=http://172.16.201.134:1313/ru/books/handbook/desktop/#desktop-synopsis>7.1. Краткий обзор</a></li><li><a href=http://172.16.201.134:1313/ru/books/handbook/desktop/#desktop-browsers>7.2. Браузеры</a></li><li><a href=http://172.16.201.134:1313/ru/books/handbook/desktop/#desktop-productivity>7.3. Бизнес приложения</a></li><li><a href=http://172.16.201.134:1313/ru/books/handbook/desktop/#desktop-viewers>7.4. Программы просмотра документов</a></li><li><a href=http://172.16.201.134:1313/ru/books/handbook/desktop/#desktop-finance>7.5. Финансовые программы</a></li><li><a href=http://172.16.201.134:1313/ru/books/handbook/desktop/#desktop-summary>7.6. Итоги</a></li></ul></li><li><input type=checkbox id=chapter-152f694a19312ad72ec7bb4e1c3c33b2 class=toggle>
<label class="icon cursor" for=chapter-152f694a19312ad72ec7bb4e1c3c33b2><a role=button></a></label><a href=http://172.16.201.134:1313/ru/books/handbook/multimedia/>Глава 8. Мультимедиа</a><ul><li><a href=http://172.16.201.134:1313/ru/books/handbook/multimedia/#multimedia-synopsis>8.1. Краткий обзор</a></li><li><a href=http://172.16.201.134:1313/ru/books/handbook/multimedia/#sound-setup>8.2. Настройка звуковой карты</a></li><li><a href=http://172.16.201.134:1313/ru/books/handbook/multimedia/#sound-mp3>8.3. Звук MP3</a></li><li><a href=http://172.16.201.134:1313/ru/books/handbook/multimedia/#video-playback>8.4. Воспроизведение видео</a></li><li><a href=http://172.16.201.134:1313/ru/books/handbook/multimedia/#tvcard>8.5. Настройка ТВ тюнеров</a></li><li><a href=http://172.16.201.134:1313/ru/books/handbook/multimedia/#scanners>8.6. Сканеры</a></li></ul></li><li><input type=checkbox id=chapter-80888b4ee02e3e409e5f71cf97a36450 class=toggle>
<label class="icon cursor" for=chapter-80888b4ee02e3e409e5f71cf97a36450><a role=button></a></label><a href=http://172.16.201.134:1313/ru/books/handbook/kernelconfig/>Глава 9. Настройка ядра FreeBSD</a><ul><li><a href=http://172.16.201.134:1313/ru/books/handbook/kernelconfig/#kernelconfig-synopsis>9.1. Краткий обзор</a></li><li><a href=http://172.16.201.134:1313/ru/books/handbook/kernelconfig/#kernelconfig-custom-kernel>9.2. Зачем собирать собственное ядро?</a></li><li><a href=http://172.16.201.134:1313/ru/books/handbook/kernelconfig/#kernelconfig-devices>9.3. Определение аппаратного обеспечения</a></li><li><a href=http://172.16.201.134:1313/ru/books/handbook/kernelconfig/#kernelconfig-modules>9.4. Драйвера, подсистемы и модули ядра</a></li><li><a href=http://172.16.201.134:1313/ru/books/handbook/kernelconfig/#kernelconfig-building>9.5. Сборка и установка собственного ядра</a></li><li><a href=http://172.16.201.134:1313/ru/books/handbook/kernelconfig/#kernelconfig-config>9.6. Конфигурационный файл</a></li><li><a href=http://172.16.201.134:1313/ru/books/handbook/kernelconfig/#kernelconfig-trouble>9.7. Решение проблем</a></li></ul></li><li><input type=checkbox id=chapter-cb174c55879b17ab955f2f16989a79e0 class=toggle>
<label class="icon cursor" for=chapter-cb174c55879b17ab955f2f16989a79e0><a role=button></a></label><a href=http://172.16.201.134:1313/ru/books/handbook/printing/>Глава 10. Печать</a><ul><li><a href=http://172.16.201.134:1313/ru/books/handbook/printing/#printing-synopsis>10.1. Краткий обзор</a></li><li><a href=http://172.16.201.134:1313/ru/books/handbook/printing/#printing-intro-spooler>10.2. Введение</a></li><li><a href=http://172.16.201.134:1313/ru/books/handbook/printing/#printing-intro-setup>10.3. Основная настройка</a></li><li><a href=http://172.16.201.134:1313/ru/books/handbook/printing/#printing-advanced>10.4. Расширенная настройка принтера</a></li><li><a href=http://172.16.201.134:1313/ru/books/handbook/printing/#printing-using>10.5. Использование принтеров</a></li><li><a href=http://172.16.201.134:1313/ru/books/handbook/printing/#printing-lpd-alternatives>10.6. Альтернативы стандартному спулеру</a></li><li><a href=http://172.16.201.134:1313/ru/books/handbook/printing/#printing-troubleshooting>10.7. Выявление проблем</a></li></ul></li><li><input type=checkbox id=chapter-c12b8c3f2a8fcefce87087241f695c83 class=toggle>
<label class="icon cursor" for=chapter-c12b8c3f2a8fcefce87087241f695c83><a role=button></a></label><a href=http://172.16.201.134:1313/ru/books/handbook/linuxemu/>Глава 11. Двоичная совместимость с Linux</a><ul><li><a href=http://172.16.201.134:1313/ru/books/handbook/linuxemu/#linuxemu-synopsis>11.1. Краткий обзор</a></li><li><a href=http://172.16.201.134:1313/ru/books/handbook/linuxemu/#linuxemu-lbc-install>11.2. Установка</a></li><li><a href=http://172.16.201.134:1313/ru/books/handbook/linuxemu/#linuxemu-mathematica>11.3. Установка Mathematica®</a></li><li><a href=http://172.16.201.134:1313/ru/books/handbook/linuxemu/#linuxemu-maple>11.4. Установка Maple™</a></li><li><a href=http://172.16.201.134:1313/ru/books/handbook/linuxemu/#linuxemu-matlab>11.5. Установка MATLAB®</a></li><li><a href=http://172.16.201.134:1313/ru/books/handbook/linuxemu/#linuxemu-oracle>11.6. Установка Oracle®</a></li><li><a href=http://172.16.201.134:1313/ru/books/handbook/linuxemu/#sapr3>11.7. Установка SAP® R/3®</a></li><li><a href=http://172.16.201.134:1313/ru/books/handbook/linuxemu/#linuxemu-advanced>11.8. Дополнительные сведения</a></li></ul></li><li><input type=checkbox id=chapter-03b11ba627b9a0c85b247f5641bde272 class=toggle>
<label for=chapter-03b11ba627b9a0c85b247f5641bde272><a role=button></a></label><a href=http://172.16.201.134:1313/ru/books/handbook/partiii/>Часть III. Системное администрирование</a></li><li><input type=checkbox id=chapter-6c31587f8d736319f099cd4dc1961301 class=toggle>
<label class="icon cursor" for=chapter-6c31587f8d736319f099cd4dc1961301><a role=button></a></label><a href=http://172.16.201.134:1313/ru/books/handbook/config/>Глава 12. Настройка и оптимизация</a><ul><li><a href=http://172.16.201.134:1313/ru/books/handbook/config/#config-synopsis>12.1. Введение</a></li><li><a href=http://172.16.201.134:1313/ru/books/handbook/config/#configtuning-initial>12.2. Начальное конфигурирование</a></li><li><a href=http://172.16.201.134:1313/ru/books/handbook/config/#configtuning-core-configuration>12.3. Основные настройки</a></li><li><a href=http://172.16.201.134:1313/ru/books/handbook/config/#configtuning-appconfig>12.4. Настройка приложений</a></li><li><a href=http://172.16.201.134:1313/ru/books/handbook/config/#configtuning-starting-services>12.5. Запуск сервисов</a></li><li><a href=http://172.16.201.134:1313/ru/books/handbook/config/#configtuning-cron>12.6. Настройка утилиты <code>cron</code></a></li><li><a href=http://172.16.201.134:1313/ru/books/handbook/config/#configtuning-rcd>12.7. Использование rc во FreeBSD 5.X и последующих версиях</a></li><li><a href=http://172.16.201.134:1313/ru/books/handbook/config/#config-network-setup>12.8. Настройка карт сетевых интерфейсов</a></li><li><a href=http://172.16.201.134:1313/ru/books/handbook/config/#configtuning-virtual-hosts>12.9. Настройка виртуальных серверов</a></li><li><a href=http://172.16.201.134:1313/ru/books/handbook/config/#configtuning-configfiles>12.10. Файлы настройки</a></li><li><a href=http://172.16.201.134:1313/ru/books/handbook/config/#configtuning-sysctl>12.11. Настройка с помощью sysctl</a></li><li><a href=http://172.16.201.134:1313/ru/books/handbook/config/#configtuning-disk>12.12. Оптимизация дисков</a></li><li><a href=http://172.16.201.134:1313/ru/books/handbook/config/#configtuning-kernel-limits>12.13. Изменение ограничений, накладываемых ядром</a></li><li><a href=http://172.16.201.134:1313/ru/books/handbook/config/#adding-swap-space>12.14. Увеличение объема подкачки</a></li><li><a href=http://172.16.201.134:1313/ru/books/handbook/config/#acpi-overview>12.15. Управление питанием и ресурсами</a></li><li><a href=http://172.16.201.134:1313/ru/books/handbook/config/#ACPI-debug>12.16. Использование и отладка FreeBSD ACPI</a></li></ul></li><li><input type=checkbox id=chapter-459f0012b3b4f0b6b123010f029da5e4 class=toggle>
<label class="icon cursor" for=chapter-459f0012b3b4f0b6b123010f029da5e4><a role=button></a></label><a href=http://172.16.201.134:1313/ru/books/handbook/boot/>Глава 13. Процесс загрузки FreeBSD</a><ul><li><a href=http://172.16.201.134:1313/ru/books/handbook/boot/#boot-synopsis>13.1. Описание</a></li><li><a href=http://172.16.201.134:1313/ru/books/handbook/boot/#boot-introduction>13.2. Проблема загрузки</a></li><li><a href=http://172.16.201.134:1313/ru/books/handbook/boot/#boot-blocks>13.3. Менеджер загрузки и этапы загрузки</a></li><li><a href=http://172.16.201.134:1313/ru/books/handbook/boot/#boot-kernel>13.4. Взаимодействие с ядром во время загрузки</a></li><li><a href=http://172.16.201.134:1313/ru/books/handbook/boot/#device-hints>13.5. Хинты устройств</a></li><li><a href=http://172.16.201.134:1313/ru/books/handbook/boot/#boot-init>13.6. Init: инициализация управления процессами</a></li><li><a href=http://172.16.201.134:1313/ru/books/handbook/boot/#boot-shutdown>13.7. Процесс остановки системы</a></li></ul></li><li><input type=checkbox id=chapter-917c75fcffbb14d48ed6d0a48e7028f2 class=toggle>
<label class="icon cursor" for=chapter-917c75fcffbb14d48ed6d0a48e7028f2><a role=button></a></label><a href=http://172.16.201.134:1313/ru/books/handbook/security/>Глава 14. Безопасность</a><ul><li><a href=http://172.16.201.134:1313/ru/books/handbook/security/#security-synopsis>14.1. Краткое описание</a></li><li><a href=http://172.16.201.134:1313/ru/books/handbook/security/#security-intro>14.2. Введение</a></li><li><a href=http://172.16.201.134:1313/ru/books/handbook/security/#securing-freebsd>14.3. Защита FreeBSD</a></li><li><a href=http://172.16.201.134:1313/ru/books/handbook/security/#crypt>14.4. DES, MD5, и шифрование</a></li><li><a href=http://172.16.201.134:1313/ru/books/handbook/security/#one-time-passwords>14.5. Одноразовые пароли</a></li><li><a href=http://172.16.201.134:1313/ru/books/handbook/security/#tcpwrappers>14.6. TCP Wrappers</a></li><li><a href=http://172.16.201.134:1313/ru/books/handbook/security/#kerberosIV>14.7. KerberosIV</a></li><li><a href=http://172.16.201.134:1313/ru/books/handbook/security/#kerberos5>14.8. Kerberos5</a></li><li><a href=http://172.16.201.134:1313/ru/books/handbook/security/#openssl>14.9. OpenSSL</a></li><li><a href=http://172.16.201.134:1313/ru/books/handbook/security/#ipsec>14.10. VPN через IPsec</a></li><li><a href=http://172.16.201.134:1313/ru/books/handbook/security/#openssh>14.11. OpenSSH</a></li><li><a href=http://172.16.201.134:1313/ru/books/handbook/security/#fs-acl>14.12. Списки контроля доступа файловой системы (ACL)</a></li><li><a href=http://172.16.201.134:1313/ru/books/handbook/security/#security-portaudit>14.13. Мониторинг вопросов безопасности в ПО сторонних разработчиков</a></li><li><a href=http://172.16.201.134:1313/ru/books/handbook/security/#security-advisories>14.14. Сообщения безопасности FreeBSD</a></li><li><a href=http://172.16.201.134:1313/ru/books/handbook/security/#security-accounting>14.15. Учёт используемых ресурсов</a></li></ul></li><li><input type=checkbox id=chapter-8f4620c77e572cbb58917911a33c73cf class=toggle>
<label class="icon cursor" for=chapter-8f4620c77e572cbb58917911a33c73cf><a role=button></a></label><a href=http://172.16.201.134:1313/ru/books/handbook/mac/>Глава 15. Принудительный контроль доступа (MAC)</a><ul><li><a href=http://172.16.201.134:1313/ru/books/handbook/mac/#mac-synopsis>15.1. Краткий обзор</a></li><li><a href=http://172.16.201.134:1313/ru/books/handbook/mac/#mac-inline-glossary>15.2. Ключевые термины этой главы</a></li><li><a href=http://172.16.201.134:1313/ru/books/handbook/mac/#mac-initial>15.3. Описание MAC</a></li><li><a href=http://172.16.201.134:1313/ru/books/handbook/mac/#mac-understandlabel>15.4. Метки MAC</a></li><li><a href=http://172.16.201.134:1313/ru/books/handbook/mac/#mac-modules>15.5. Настройка модулей</a></li><li><a href=http://172.16.201.134:1313/ru/books/handbook/mac/#mac-bsdextended>15.6. Модуль MAC bsdextended</a></li><li><a href=http://172.16.201.134:1313/ru/books/handbook/mac/#mac-ifoff>15.7. Модуль MAC ifoff</a></li><li><a href=http://172.16.201.134:1313/ru/books/handbook/mac/#mac-portacl>15.8. Модуль MAC portacl</a></li><li><a href=http://172.16.201.134:1313/ru/books/handbook/mac/#mac-labelingpolicies>15.9. Политики MAC, использующие метки</a></li><li><a href=http://172.16.201.134:1313/ru/books/handbook/mac/#mac-partition>15.10. Модуль MAC partition</a></li><li><a href=http://172.16.201.134:1313/ru/books/handbook/mac/#mac-mls>15.11. Модуль многоуровневой безопасности MAC (MLS)</a></li><li><a href=http://172.16.201.134:1313/ru/books/handbook/mac/#mac-biba>15.12. Модуль MAC Biba</a></li><li><a href=http://172.16.201.134:1313/ru/books/handbook/mac/#mac-lomac>15.13. Модуль MAC LOMAC</a></li><li><a href=http://172.16.201.134:1313/ru/books/handbook/mac/#mac-implementing>15.14. Реализация защищенной среды с MAC</a></li><li><a href=http://172.16.201.134:1313/ru/books/handbook/mac/#MAC-examplehttpd>15.15. Другой пример: Использование MAC для защиты веб сервера</a></li><li><a href=http://172.16.201.134:1313/ru/books/handbook/mac/#mac-troubleshoot>15.16. Решение проблем с инфраструктурой MAC</a></li></ul></li><li><input type=checkbox id=chapter-9598d66a76cb3182057b6bcd775149a0 class=toggle>
<label class="icon cursor" for=chapter-9598d66a76cb3182057b6bcd775149a0><a role=button></a></label><a href=http://172.16.201.134:1313/ru/books/handbook/audit/>Глава 16. Аудит событий безопасности</a><ul><li><a href=http://172.16.201.134:1313/ru/books/handbook/audit/#audit-synopsis>16.1. Краткий обзор</a></li><li><a href=http://172.16.201.134:1313/ru/books/handbook/audit/#audit-inline-glossary>16.2. Ключевые понятия</a></li><li><a href=http://172.16.201.134:1313/ru/books/handbook/audit/#audit-config>16.3. Настройка системы аудита</a></li><li><a href=http://172.16.201.134:1313/ru/books/handbook/audit/#audit-administration>16.4. Работа с журналами аудита</a></li></ul></li><li><input type=checkbox id=chapter-e1edcad13d9db6e8e4cb645d378ecfaf class=toggle>
<label class="icon cursor" for=chapter-e1edcad13d9db6e8e4cb645d378ecfaf><a role=button></a></label><a href=http://172.16.201.134:1313/ru/books/handbook/disks/>Глава 17. Устройства хранения</a><ul><li><a href=http://172.16.201.134:1313/ru/books/handbook/disks/#disks-synopsis>17.1. Краткий обзор</a></li><li><a href=http://172.16.201.134:1313/ru/books/handbook/disks/#disks-naming>17.2. Имена устройств</a></li><li><a href=http://172.16.201.134:1313/ru/books/handbook/disks/#disks-adding>17.3. Добавление дисков</a></li><li><a href=http://172.16.201.134:1313/ru/books/handbook/disks/#raid>17.4. RAID</a></li><li><a href=http://172.16.201.134:1313/ru/books/handbook/disks/#usb-disks>17.5. USB устройства хранения</a></li><li><a href=http://172.16.201.134:1313/ru/books/handbook/disks/#creating-cds>17.6. Запись и использование оптических носителей (CD)</a></li><li><a href=http://172.16.201.134:1313/ru/books/handbook/disks/#creating-dvds>17.7. Создание и использование оптических носителей (DVD)</a></li><li><a href=http://172.16.201.134:1313/ru/books/handbook/disks/#floppies>17.8. Дискеты</a></li><li><a href=http://172.16.201.134:1313/ru/books/handbook/disks/#backups-tapebackups>17.9. Создание и использование архивных копий на магнитной ленте</a></li><li><a href=http://172.16.201.134:1313/ru/books/handbook/disks/#backups-floppybackups>17.10. Создание резервных копий на дискетах</a></li><li><a href=http://172.16.201.134:1313/ru/books/handbook/disks/#backup-strategies>17.11. Стратегии резервного копирования</a></li><li><a href=http://172.16.201.134:1313/ru/books/handbook/disks/#backup-basics>17.12. Основы технологии резервного копирования</a></li><li><a href=http://172.16.201.134:1313/ru/books/handbook/disks/#disks-virtual>17.13. Сетевые файловые системы, файловые системы в памяти и с отображением в файл</a></li><li><a href=http://172.16.201.134:1313/ru/books/handbook/disks/#snapshots>17.14. Мгновенные копии файловых систем</a></li><li><a href=http://172.16.201.134:1313/ru/books/handbook/disks/#quotas>17.15. Квотирование файловых систем</a></li><li><a href=http://172.16.201.134:1313/ru/books/handbook/disks/#disks-encrypting>17.16. Шифрование дисковых разделов</a></li><li><a href=http://172.16.201.134:1313/ru/books/handbook/disks/#swap-encrypting>17.17. Шифрование области подкачки</a></li></ul></li><li><input type=checkbox id=chapter-dde37901a0e0ea32745b67607854900f class=toggle>
<label class="icon cursor" for=chapter-dde37901a0e0ea32745b67607854900f><a role=button></a></label><a href=http://172.16.201.134:1313/ru/books/handbook/geom/>Глава 18. GEOM: Модульная инфраструктура преобразования дисковых запросов</a><ul><li><a href=http://172.16.201.134:1313/ru/books/handbook/geom/#GEOM-synopsis>18.1. Краткий обзор</a></li><li><a href=http://172.16.201.134:1313/ru/books/handbook/geom/#GEOM-intro>18.2. Введение в GEOM</a></li><li><a href=http://172.16.201.134:1313/ru/books/handbook/geom/#GEOM-striping>18.3. RAID0 - Создание дисковой последовательности (Striping)</a></li><li><a href=http://172.16.201.134:1313/ru/books/handbook/geom/#GEOM-mirror>18.4. RAID1 - Зеркалирование (Mirroring)</a></li><li><a href=http://172.16.201.134:1313/ru/books/handbook/geom/#geom-ggate>18.5. Сетевые устройства GEOM Gate</a></li><li><a href=http://172.16.201.134:1313/ru/books/handbook/geom/#geom-glabel>18.6. Метки дисковых устройств</a></li><li><a href=http://172.16.201.134:1313/ru/books/handbook/geom/#geom-gjournal>18.7. Журналирование UFS средствами GEOM</a></li></ul></li><li><input type=checkbox id=chapter-7af71270807eb7b70cd3eedc6577b254 class=toggle>
<label class="icon cursor" for=chapter-7af71270807eb7b70cd3eedc6577b254><a role=button></a></label><a href=http://172.16.201.134:1313/ru/books/handbook/filesystems/>Глава 19. Поддержка файловых систем</a><ul><li><a href=http://172.16.201.134:1313/ru/books/handbook/filesystems/#filesystems-synopsis>19.1. Краткий обзор</a></li><li><a href=http://172.16.201.134:1313/ru/books/handbook/filesystems/#filesystems-zfs>19.2. Файловая система ZFS</a></li></ul></li><li><input type=checkbox id=chapter-49f1e96591c090304ea532012257f4ef class=toggle>
<label class="icon cursor" for=chapter-49f1e96591c090304ea532012257f4ef><a role=button></a></label><a href=http://172.16.201.134:1313/ru/books/handbook/l10n/>Глава 20. Локализация - использование и настройка i18n/L10n</a><ul><li><a href=http://172.16.201.134:1313/ru/books/handbook/l10n/#l10n-synopsis>20.1. Краткий обзор</a></li><li><a href=http://172.16.201.134:1313/ru/books/handbook/l10n/#using-localization>20.2. Использование локализации</a></li><li><a href=http://172.16.201.134:1313/ru/books/handbook/l10n/#l10n-compiling>20.3. Поиск приложений i18n</a></li><li><a href=http://172.16.201.134:1313/ru/books/handbook/l10n/#lang-setup>20.4. Настройка локализации для некоторых языков</a></li></ul></li><li><input type=checkbox id=chapter-dead2b4c5ea325dd390a9b0dccd8f763 class=toggle>
<label class="icon cursor" for=chapter-dead2b4c5ea325dd390a9b0dccd8f763><a role=button></a></label><a href=http://172.16.201.134:1313/ru/books/handbook/cutting-edge/>Глава 21. Обновление системы и смена версии FreeBSD</a><ul><li><a href=http://172.16.201.134:1313/ru/books/handbook/cutting-edge/#updating-upgrading-synopsis>21.1. Краткий обзор</a></li><li><a href=http://172.16.201.134:1313/ru/books/handbook/cutting-edge/#updating-upgrading-freebsdupdate>21.2. Обновление FreeBSD</a></li><li><a href=http://172.16.201.134:1313/ru/books/handbook/cutting-edge/#updating-upgrading-documentation>21.3. Обновление документации</a></li><li><a href=http://172.16.201.134:1313/ru/books/handbook/cutting-edge/#current-stable>21.4. Использование ветви разработки</a></li><li><a href=http://172.16.201.134:1313/ru/books/handbook/cutting-edge/#synching>21.5. Синхронизация исходных текстов</a></li><li><a href=http://172.16.201.134:1313/ru/books/handbook/cutting-edge/#makeworld>21.6. Пересборка мира</a></li><li><a href=http://172.16.201.134:1313/ru/books/handbook/cutting-edge/#small-lan>21.7. Отслеживание исходных текстов для нескольких машин</a></li></ul></li><li><input type=checkbox id=chapter-bbd25f9a194f9c39ca2d658c75767db5 class=toggle>
<label for=chapter-bbd25f9a194f9c39ca2d658c75767db5><a role=button></a></label><a href=http://172.16.201.134:1313/ru/books/handbook/partiv/>Часть IV. Сетевые коммуникации</a></li><li><input type=checkbox id=chapter-499dab596afd7ddac77e80295314e0dd class=toggle>
<label class="icon cursor" for=chapter-499dab596afd7ddac77e80295314e0dd><a role=button></a></label><a href=http://172.16.201.134:1313/ru/books/handbook/serialcomms/>Глава 22. Последовательные соединения</a><ul><li><a href=http://172.16.201.134:1313/ru/books/handbook/serialcomms/#serial-synopsis>22.1. Краткое описание</a></li><li><a href=http://172.16.201.134:1313/ru/books/handbook/serialcomms/#serial>22.2. Введение</a></li><li><a href=http://172.16.201.134:1313/ru/books/handbook/serialcomms/#term>22.3. Терминалы</a></li><li><a href=http://172.16.201.134:1313/ru/books/handbook/serialcomms/#dialup>22.4. Входящие соединения по модему</a></li><li><a href=http://172.16.201.134:1313/ru/books/handbook/serialcomms/#dialout>22.5. Исходящие соединения по модему</a></li><li><a href=http://172.16.201.134:1313/ru/books/handbook/serialcomms/#serialconsole-setup>22.6. Настройка последовательной консоли</a></li></ul></li><li><input type=checkbox id=chapter-95e4571c48bee1cced5e84a538d302e3 class=toggle>
<label class="icon cursor" for=chapter-95e4571c48bee1cced5e84a538d302e3><a role=button></a></label><a href=http://172.16.201.134:1313/ru/books/handbook/ppp-and-slip/>Глава 23. PPP и SLIP</a><ul><li><a href=http://172.16.201.134:1313/ru/books/handbook/ppp-and-slip/#ppp-and-slip-synopsis>23.1. Краткий обзор</a></li><li><a href=http://172.16.201.134:1313/ru/books/handbook/ppp-and-slip/#userppp>23.2. PPP уровня пользователя</a></li><li><a href=http://172.16.201.134:1313/ru/books/handbook/ppp-and-slip/#ppp>23.3. PPP уровня ядра</a></li><li><a href=http://172.16.201.134:1313/ru/books/handbook/ppp-and-slip/#ppp-troubleshoot>23.4. Решение проблем с соединениями PPP</a></li><li><a href=http://172.16.201.134:1313/ru/books/handbook/ppp-and-slip/#pppoe>23.5. Использование PPP через Ethernet (PPPoE)</a></li><li><a href=http://172.16.201.134:1313/ru/books/handbook/ppp-and-slip/#pppoa>23.6. Использование PPP через ATM (PPPoA)</a></li><li><a href=http://172.16.201.134:1313/ru/books/handbook/ppp-and-slip/#slip>23.7. Использование SLIP</a></li></ul></li><li><input type=checkbox id=chapter-f089ac726c401c9b4bd5c34a295e11bb class=toggle>
<label class="icon cursor" for=chapter-f089ac726c401c9b4bd5c34a295e11bb><a role=button></a></label><a href=http://172.16.201.134:1313/ru/books/handbook/mail/>Глава 24. Электронная почта</a><ul><li><a href=http://172.16.201.134:1313/ru/books/handbook/mail/#mail-synopsis>24.1. Краткий обзор</a></li><li><a href=http://172.16.201.134:1313/ru/books/handbook/mail/#mail-using>24.2. Использование электронной почты</a></li><li><a href=http://172.16.201.134:1313/ru/books/handbook/mail/#sendmail>24.3. Настройка sendmail</a></li><li><a href=http://172.16.201.134:1313/ru/books/handbook/mail/#mail-changingmta>24.4. Установка другой почтовой программы</a></li><li><a href=http://172.16.201.134:1313/ru/books/handbook/mail/#mail-trouble>24.5. Поиск и устранение неисправностей</a></li><li><a href=http://172.16.201.134:1313/ru/books/handbook/mail/#mail-advanced>24.6. Расширенное руководство</a></li><li><a href=http://172.16.201.134:1313/ru/books/handbook/mail/#outgoing-only>24.7. Настройка почты только для отправки</a></li><li><a href=http://172.16.201.134:1313/ru/books/handbook/mail/#SMTP-dialup>24.8. Использование почты с коммутируемым соединением</a></li><li><a href=http://172.16.201.134:1313/ru/books/handbook/mail/#SMTP-Auth>24.9. SMTP аутентификация</a></li><li><a href=http://172.16.201.134:1313/ru/books/handbook/mail/#mail-agents>24.10. Почтовые программы пользователей</a></li><li><a href=http://172.16.201.134:1313/ru/books/handbook/mail/#mail-fetchmail>24.11. Использование fetchmail</a></li><li><a href=http://172.16.201.134:1313/ru/books/handbook/mail/#mail-procmail>24.12. Использование procmail</a></li></ul></li><li><input type=checkbox id=chapter-6de4de3fe925639d4175ce4b6f8c1829 class=toggle checked>
<label class="icon cursor" for=chapter-6de4de3fe925639d4175ce4b6f8c1829><a role=button></a></label><a href=http://172.16.201.134:1313/ru/books/handbook/network-servers/>Глава 25. Сетевые серверы</a><ul><li><a href=http://172.16.201.134:1313/ru/books/handbook/network-servers/#network-servers-synopsis>25.1. Краткий обзор</a></li><li><a href=http://172.16.201.134:1313/ru/books/handbook/network-servers/#network-inetd>25.2. "Супер-сервер"inetd</a></li><li><a href=http://172.16.201.134:1313/ru/books/handbook/network-servers/#network-nfs>25.3. Network File System (NFS)</a></li><li><a href=http://172.16.201.134:1313/ru/books/handbook/network-servers/#network-nis>25.4. Network Information System (NIS/YP)</a></li><li><a href=http://172.16.201.134:1313/ru/books/handbook/network-servers/#network-dhcp>25.5. Автоматическая настройка сети (DHCP)</a></li><li><a href=http://172.16.201.134:1313/ru/books/handbook/network-servers/#network-dns>25.6. Domain Name System (DNS)</a></li><li><a href=http://172.16.201.134:1313/ru/books/handbook/network-servers/#network-apache>25.7. Apache HTTP сервер</a></li><li><a href=http://172.16.201.134:1313/ru/books/handbook/network-servers/#network-samba>25.8. Файл сервер и печать для Microsoft® Windows® клиентов (Samba)</a></li><li><a href=http://172.16.201.134:1313/ru/books/handbook/network-servers/#network-ftp>25.9. Протокол передачи файлов (FTP)</a></li><li><a href=http://172.16.201.134:1313/ru/books/handbook/network-servers/#network-ntp>25.10. Синхронизация часов через NTP</a></li><li><a href=http://172.16.201.134:1313/ru/books/handbook/network-servers/#network-syslogd>25.11. * Remote Host Logging with <code>syslogd</code></a></li></ul></li><li><input type=checkbox id=chapter-776d855c7b75e048f90b5c2c9b35ffe0 class=toggle>
<label class="icon cursor" for=chapter-776d855c7b75e048f90b5c2c9b35ffe0><a role=button></a></label><a href=http://172.16.201.134:1313/ru/books/handbook/firewalls/>Глава 26. Межсетевые экраны</a><ul><li><a href=http://172.16.201.134:1313/ru/books/handbook/firewalls/#firewalls-intro>26.1. Введение</a></li><li><a href=http://172.16.201.134:1313/ru/books/handbook/firewalls/#firewalls-concepts>26.2. Принципы работы межсетевых экранов</a></li><li><a href=http://172.16.201.134:1313/ru/books/handbook/firewalls/#firewalls-apps>26.3. Пакеты межсетевых экранов</a></li><li><a href=http://172.16.201.134:1313/ru/books/handbook/firewalls/#firewalls-pf>26.4. Packet Filter (PF, межсетевой экран OpenBSD) и ALTQ</a></li><li><a href=http://172.16.201.134:1313/ru/books/handbook/firewalls/#firewalls-ipf>26.5. * IPFILTER (IPF)</a></li><li><a href=http://172.16.201.134:1313/ru/books/handbook/firewalls/#firewalls-ipfw>26.6. IPFW</a></li></ul></li><li><input type=checkbox id=chapter-5b07f776a0e6155c1c89aa0d15610380 class=toggle>
<label class="icon cursor" for=chapter-5b07f776a0e6155c1c89aa0d15610380><a role=button></a></label><a href=http://172.16.201.134:1313/ru/books/handbook/advanced-networking/>Глава 27. Сложные вопросы работы в сети</a><ul><li><a href=http://172.16.201.134:1313/ru/books/handbook/advanced-networking/#advanced-networking-synopsis>27.1. Краткий обзор</a></li><li><a href=http://172.16.201.134:1313/ru/books/handbook/advanced-networking/#network-routing>27.2. Сетевые шлюзы и маршруты</a></li><li><a href=http://172.16.201.134:1313/ru/books/handbook/advanced-networking/#network-wireless>27.3. Беспроводные сети</a></li><li><a href=http://172.16.201.134:1313/ru/books/handbook/advanced-networking/#network-bluetooth>27.4. Bluetooth</a></li><li><a href=http://172.16.201.134:1313/ru/books/handbook/advanced-networking/#network-bridging>27.5. Мосты</a></li><li><a href=http://172.16.201.134:1313/ru/books/handbook/advanced-networking/#network-diskless>27.6. Работа с бездисковыми станциями</a></li><li><a href=http://172.16.201.134:1313/ru/books/handbook/advanced-networking/#network-isdn>27.7. ISDN</a></li><li><a href=http://172.16.201.134:1313/ru/books/handbook/advanced-networking/#network-natd>27.8. Даемон преобразования сетевых адресов (natd)</a></li><li><a href=http://172.16.201.134:1313/ru/books/handbook/advanced-networking/#network-plip>27.9. IP по параллельному порту (PLIP)</a></li><li><a href=http://172.16.201.134:1313/ru/books/handbook/advanced-networking/#network-ipv6>27.10. IPv6</a></li><li><a href=http://172.16.201.134:1313/ru/books/handbook/advanced-networking/#network-atm>27.11. Асинхронный режим передачи (ATM)</a></li></ul></li><li><input type=checkbox id=chapter-171a77aa9d067a1024f849470e1f33e8 class=toggle>
<label for=chapter-171a77aa9d067a1024f849470e1f33e8><a role=button></a></label><a href=http://172.16.201.134:1313/ru/books/handbook/partv/>Часть V. Приложения</a></li><li><input type=checkbox id=chapter-8050f436a0a7986a4aaded93d8e49469 class=toggle>
<label class="icon cursor" for=chapter-8050f436a0a7986a4aaded93d8e49469><a role=button></a></label><a href=http://172.16.201.134:1313/ru/books/handbook/mirrors/>Приложение A. Получение FreeBSD</a><ul><li><a href=http://172.16.201.134:1313/ru/books/handbook/mirrors/#mirrors-cdrom>A.1. Наборы CD и DVD</a></li><li><a href=http://172.16.201.134:1313/ru/books/handbook/mirrors/#mirrors-ftp>A.2. FTP сайты</a></li><li><a href=http://172.16.201.134:1313/ru/books/handbook/mirrors/#ctm>A.3. Использование CTM</a></li><li><a href=http://172.16.201.134:1313/ru/books/handbook/mirrors/#svn>A.4. Использование Subversion</a></li><li><a href=http://172.16.201.134:1313/ru/books/handbook/mirrors/#mirrors-rsync>A.5. Использование rsync</a></li></ul></li><li><input type=checkbox id=chapter-128b630a8f88f158e7027fe6c2184d21 class=toggle>
<label class="icon cursor" for=chapter-128b630a8f88f158e7027fe6c2184d21><a role=button></a></label><a href=http://172.16.201.134:1313/ru/books/handbook/bibliography/>Приложение B. Библиография</a><ul><li><a href=http://172.16.201.134:1313/ru/books/handbook/bibliography/#bibliography-freebsd>B.1. Книги и журналы, специализирующиеся на FreeBSD</a></li><li><a href=http://172.16.201.134:1313/ru/books/handbook/bibliography/#bibliography-userguides>B.2. Руководства для пользователей</a></li><li><a href=http://172.16.201.134:1313/ru/books/handbook/bibliography/#bibliography-adminguides>B.3. Руководства для администраторов</a></li><li><a href=http://172.16.201.134:1313/ru/books/handbook/bibliography/#bibliography-programmers>B.4. Руководства для программистов</a></li><li><a href=http://172.16.201.134:1313/ru/books/handbook/bibliography/#bibliography-osinternals>B.5. Внутренности операционной системы</a></li><li><a href=http://172.16.201.134:1313/ru/books/handbook/bibliography/#bibliography-security>B.6. Безопасность</a></li><li><a href=http://172.16.201.134:1313/ru/books/handbook/bibliography/#bibliography-hardware>B.7. Оборудование</a></li><li><a href=http://172.16.201.134:1313/ru/books/handbook/bibliography/#bibliography-history>B.8. История UNIX®</a></li><li><a href=http://172.16.201.134:1313/ru/books/handbook/bibliography/#bibliography-journals>B.9. Прочие издания</a></li></ul></li><li><input type=checkbox id=chapter-8bbb8867c46dac315e2253945d8c18a8 class=toggle>
<label class="icon cursor" for=chapter-8bbb8867c46dac315e2253945d8c18a8><a role=button></a></label><a href=http://172.16.201.134:1313/ru/books/handbook/eresources/>Приложение C. Ресурсы в интернет</a><ul><li><a href=http://172.16.201.134:1313/ru/books/handbook/eresources/#eresources-mail>C.1. Списки рассылки</a></li><li><a href=http://172.16.201.134:1313/ru/books/handbook/eresources/#eresources-news>C.2. Новостные группы Usenet</a></li><li><a href=http://172.16.201.134:1313/ru/books/handbook/eresources/#eresources-web>C.3. Серверы World Wide Web</a></li><li><a href=http://172.16.201.134:1313/ru/books/handbook/eresources/#eresources-email>C.4. Адреса Email</a></li></ul></li><li><input type=checkbox id=chapter-a80ea4f5a4480b8725422710f954ef36 class=toggle>
<label class="icon cursor" for=chapter-a80ea4f5a4480b8725422710f954ef36><a role=button></a></label><a href=http://172.16.201.134:1313/ru/books/handbook/pgpkeys/>Приложение D. PGP ключи</a><ul><li><a href=http://172.16.201.134:1313/ru/books/handbook/pgpkeys/#pgpkeys-officers>D.1. Офицеры</a></li></ul></li><li></li></ul></nav></div></aside><div class=book><div class=book-menu-mobile><label for=menu-control><span class=menu-control-button><i class="fa fa-list" aria-hidden=true title="Меню книг"></i>
Меню книг</span></label></div><h1 class=title>Глава 25. Сетевые серверы</h1><div class="admonitionblock note"><p><i class="fa fa-exclamation-circle" aria-hidden=true></i>
Этот перевод может быть устаревшим. Для того, чтобы помочь с переводом, пожалуйста, обратитесь к <a href=https://translate-dev.freebsd.org/ target=_blank>Сервер переводов FreeBSD</a>.</p></div><div class=toc-mobile><h3>Содержание</h3><nav id=TableOfContents><ul><li><a href=#network-servers-synopsis>25.1. Краткий обзор</a></li><li><a href=#network-inetd>25.2. "Супер-сервер"inetd</a></li><li><a href=#network-nfs>25.3. Network File System (NFS)</a></li><li><a href=#network-nis>25.4. Network Information System (NIS/YP)</a></li><li><a href=#network-dhcp>25.5. Автоматическая настройка сети (DHCP)</a></li><li><a href=#network-dns>25.6. Domain Name System (DNS)</a></li><li><a href=#network-apache>25.7. Apache HTTP сервер</a></li><li><a href=#network-samba>25.8. Файл сервер и печать для Microsoft® Windows® клиентов (Samba)</a></li><li><a href=#network-ftp>25.9. Протокол передачи файлов (FTP)</a></li><li><a href=#network-ntp>25.10. Синхронизация часов через NTP</a></li><li><a href=#network-syslogd>25.11. * Remote Host Logging with <code>syslogd</code></a></li></ul></nav></div><div class=book-content><div id=preamble><div class=sectionbody></div></div><div class=sect1><h2 id=network-servers-synopsis>25.1. Краткий обзор<a class=anchor href=#network-servers-synopsis></a></h2><div class=sectionbody><div class=paragraph><p>Эта глава посвящена некоторым наиболее часто используемым сетевым службам систем UNIX®. Мы опишем, как установить, настроить, протестировать и поддерживать многие различные типы сетевых сервисов. Для облегчения вашей работы в главу включены примеры конфигурационных файлов.</p></div><div class=paragraph><p>После чтения этой главы вы будете знать:</p></div><div class=ulist><ul><li><p>Как управлять даемоном inetd.</p></li><li><p>Как настроить сетевую файловую систему.</p></li><li><p>Как настроить сетевой сервер информации для совместного использования учётных записей пользователей.</p></li><li><p>Как настроить автоматическое конфигурирование сетевых параметров при помощи DHCP.</p></li><li><p>Как настроить сервер имён.</p></li><li><p>Как настроить Apache HTTP сервер.</p></li><li><p>Как настроить файловый и сервер печати для Windows® клиентов с использованием Samba.</p></li><li><p>Как синхронизировать дату и время, а также настроить сервер времени с протоколом NTP.</p></li><li><p>Как настроить стандартный демон протоколирования, <code>syslogd</code>, принимать сообщения от удалённых хостов.</p></li></ul></div><div class=paragraph><p>Перед чтением этой главы вы должны:</p></div><div class=ulist><ul><li><p>Понимать основы работы скриптов <span class=filename>/etc/rc</span>.</p></li><li><p>Свободно владеть основными сетевыми терминами.</p></li><li><p>Знать как устанавливать дополнительные программы сторонних разработчиков (<a href=../ports/#ports>Установка приложений. порты и пакеты</a>).</p></li></ul></div></div></div><div class=sect1><h2 id=network-inetd>25.2. "Супер-сервер"inetd<a class=anchor href=#network-inetd></a></h2><div class=sectionbody><div class=sect2><h3 id=network-inetd-overview>25.2.1. Обзор<a class=anchor href=#network-inetd-overview></a></h3><div class=paragraph><p><a href="https://man.freebsd.org/cgi/man.cgi?query=inetd&amp;sektion=8&amp;format=html">inetd(8)</a> иногда называют также "супер-сервером Интернет", потому что он управляет соединениями к многим сервисам. Когда inetd принимает соединение, он определяет, для какой программы предназначено соединение, запускает соответствующий процесс и предоставляет ему сокет, ссылка на который передается процессу в качестве стандартных устройств ввода, вывода и сообщения об ошибках. Для не слишком нагруженных серверов запуск через inetd может уменьшить общую нагрузку на систему по сравнению с запуском каждого даемона индивидуально в выделенном режиме.</p></div><div class=paragraph><p>В первую очередь inetd используется для вызова других даемонов, но несколько простых протоколов, таких, как chargen, auth и daytime, обслуживаются непосредственно.</p></div><div class=paragraph><p>Этот раздел посвящен основам настройки inetd посредством его параметров командной строки и его конфигурационного файла, <span class=filename>/etc/inetd.conf</span>.</p></div></div><div class=sect2><h3 id=network-inetd-settings>25.2.2. Настройки<a class=anchor href=#network-inetd-settings></a></h3><div class=paragraph><p>inetd инициализируется посредством системы <a href="https://man.freebsd.org/cgi/man.cgi?query=rc&amp;sektion=8&amp;format=html">rc(8)</a>. Параметр <code>inetd_enable</code> по умолчанию установлен в <code>NO</code>, однако может быть включен утилитой sysinstall в процессе установки. Указание</p></div><div class="literalblock programlisting"><div class=content><pre>inetd_enable=&#34;YES&#34;</pre></div></div><div class=paragraph><p>или</p></div><div class="literalblock programlisting"><div class=content><pre>inetd_enable=&#34;NO&#34;</pre></div></div><div class=paragraph><p>в файле <span class=filename>/etc/rc.conf</span> разрешит или запретит запуск inetd во время загрузки. Команда</p></div><div class="literalblock programlisting"><div class=content><pre>/etc/rc.d/inetd rcvar</pre></div></div><div class=paragraph><p>покажет текущие установки переменных, относящихся к inetd.</p></div><div class=paragraph><p>Кроме того, через <code>inetd_flags</code> даемону inetd могут быть переданы различные параметры командной строки.</p></div></div><div class=sect2><h3 id=network-inetd-cmdline>25.2.3. Параметры командной строки<a class=anchor href=#network-inetd-cmdline></a></h3><div class=paragraph><p>Как и большинство даемонов, для inetd существует большое количество разнообразных опций, изменяющих его поведение. Полный из список таков:</p></div><div class=paragraph><p><code>inetd [-d] [-l] [-w] [-W] [-c maximum] [-C rate] [-a address | hostname] [-p filename] [-R rate] [-s maximum] [configuration file]</code></p></div><div class=paragraph><p>Опции могут передаваться inetd при помощи переменной <code>inetd_flags</code> файла <span class=filename>/etc/rc.conf</span>. По умолчанию переменная <code>inetd_flags</code> установлена в <code>-wW -C 60</code>, то есть включает обработку TCP wrapping и запрещает обращаться с одного IP-адреса к сервису более чем 60 раз в минуту.</p></div><div class=paragraph><p>Несмотря на то, что ниже по тексту мы упоминаем опции ограничения частоты обращения к службам (rate-limiting), в большинстве случаев начинающим пользователям нет необходимости менять эти параметры. Эти опции могут стать полезными в том случае, если вы обнаружите, что ваша система принимает чрезмерное количество соединений. Полный список опций можно найти на странице справочника <a href="https://man.freebsd.org/cgi/man.cgi?query=inetd&amp;sektion=8&amp;format=html">inetd(8)</a>.</p></div><div class=dlist><dl><dt class=hdlist1>-c maximum</dt><dd><p>Определение максимального числа одновременных запусков каждой службы; по умолчание не ограничено. Может быть переопределено индивидуально для каждой службы при помощи параметра <code>max-child</code>.</p></dd><dt class=hdlist1>-C rate</dt><dd><p>Определение по умолчанию максимального количества раз, которое служба может быть вызвана с одного IP-адреса в минуту; по умолчанию не ограничено. Может быть переопределено для каждой службы параметром <code>max-connections-per-ip-per-minute</code>.</p></dd><dt class=hdlist1>-R rate</dt><dd><p>Определяет максимальное количество раз, которое служба может быть вызвана в минуту; по умолчанию 256. Частота, равная 0, не ограничивает число вызовов.</p></dd><dt class=hdlist1>-s maximum</dt><dd><p>Задает максимальное количество процессов, одновременно обслуживающих один сервис для одного IP-адреса; по умолчанию не ограничено. Может переопределяться для каждой службы параметром <code>max-child-per-ip</code>.</p></dd></dl></div></div><div class=sect2><h3 id=network-inetd-conf>25.2.4. <span class=filename>inetd.conf</span><a class=anchor href=#network-inetd-conf></a></h3><div class=paragraph><p>Настройка inetd производится через файл <span class=filename>/etc/inetd.conf</span>.</p></div><div class=paragraph><p>Если в файле <span class=filename>/etc/inetd.conf</span> делались изменения, то inetd можно заставить считать его конфигурационный файл повторно посредством команды</p></div><div id=network-inetd-reread class=exampleblock><div class=title>Пример 1. Перезагрузка конфигурационного файла inetd</div><div class=content><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># /etc/rc.d/inetd reload</span></code></pre></div></div></div></div><div class=paragraph><p>В каждой строке конфигурационного файла описывается отдельный даемон. Комментариям в файле предшествует знак "#". Строки в файле <span class=filename>/etc/inetd.conf</span> имеют такой формат:</p></div><div class="literalblock programlisting"><div class=content><pre>service-name
socket-type
protocol
{wait|nowait}[/max-child[/max-connections-per-ip-per-minute[/max-child-per-ip]]]
user[:group][/login-class]
server-program
server-program-arguments</pre></div></div><div class=paragraph><p>Пример записи для даемона <a href="https://man.freebsd.org/cgi/man.cgi?query=ftpd&amp;sektion=8&amp;format=html">ftpd(8)</a>, использующего IPv4:</p></div><div class="literalblock programlisting"><div class=content><pre>ftp     stream  tcp     nowait  root    /usr/libexec/ftpd       ftpd -l</pre></div></div><div class=dlist><dl><dt class=hdlist1>service-name</dt><dd><p>Это имя сервиса, предоставляемого конкретным даемоном. Оно должно соответствовать сервису, указанному в файле <span class=filename>/etc/services</span>. Здесь определяется, какой порт должен обслуживать inetd. При создании нового сервиса он должен помещаться сначала в файл <span class=filename>/etc/services</span>.</p></dd><dt class=hdlist1>socket-type</dt><dd><p><code>stream</code>, <code>dgram</code>, <code>raw</code> либо <code>seqpacket</code>. <code>stream</code> должен использоваться для ориентированных на соединение даемонов TCP, когда как <code>dgram</code> используется для даемонов, использующих транспортный протокол UDP.</p></dd><dt class=hdlist1>protocol</dt><dd><p>Одно из следующих:</p><table class="tableblock frame-none grid-all stretch informaltable"><col style=width:50%><col style=width:50%><thead><tr><th class="tableblock halign-left valign-top">Протокол</th><th class="tableblock halign-left valign-top">Описание</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class=tableblock>tcp, tcp4</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>TCP IPv4</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>udp, udp4</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>UDP IPv4</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>tcp6</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>TCP IPv6</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>udp6</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>UDP IPv6</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>tcp46</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>TCP как для IPv4, так и для v6</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>udp46</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>UDP как для IPv4, так и для v6</p></td></tr></tbody></table></dd><dt class=hdlist1>{wait|nowait}[/max-child[/max-connections-per-ip-per-minute[/max-child-per-ip]]]</dt><dd><p><code>wait|nowait</code> определяет, может ли даемон, вызванный из inetd, работать с собственным сокетом, или нет. Сокеты типа <code>dgram</code> должны использовать параметр <code>wait</code>, когда как даемоны с потоковыми сокетами, которые обычно многопоточны, должны использовать <code>nowait</code>. <code>wait</code> обычно передает много сокетов одному даемону, когда как <code>nowait</code> порождает даемон для каждого нового сокета.</p><div class=paragraph><p>Максимальное число порожденных даемонов, которых может создать inetd, может быть задано параметром <code>max-child</code>. Если нужно ограничение в десять экземпляров некоторого даемона, то после параметра <code>nowait</code> нужно задать <code>/10</code>. При задании <code>/0</code> ограничения на количество экземпляров снимаются.</p></div><div class=paragraph><p>Кроме <code>max-child</code>, могут быть задействованы два других параметра, ограничивающих максимальное число соединений от одного источника. <code>max-connections-per-ip-per-minute</code> ограничивает количество соединений от одного IP-адреса в течение минуты, так что значение, равное десяти, будет ограничивать любой заданный IP-адрес на выполнение десяти попыток подключения к некоторому сервису в минуту. Параметр <code>max-child-per-ip</code> ограничивает количество дочерних процессов, которые могут быть одновременно задействованы на обслуживание одного IP-адреса. Эти опции полезны для предотвращения намеренного или ненамеренного расходования ресурсов и атак типа Denial of Service (DoS) на машину.</p></div><div class=paragraph><p>В этом поле одно из значений <code>wait</code> или <code>nowait</code> обязательны. <code>max-child</code>, <code>max-connections-per-ip-per-minute</code> и <code>max-child-per-ip</code> опциональны.</p></div><div class=paragraph><p>Многопоточный даемон типа stream без ограничений <code>max-child</code>, <code>max-connections-per-ip-per-minute</code> или <code>max-child-per-ip</code> будет определен просто как <code>nowait</code>.</p></div><div class=paragraph><p>Тот же самый даемон с ограничением в максимум десять даемонов будет определен так: <code>nowait/10</code>.</p></div><div class=paragraph><p>Та же конфигурация с ограничением в двадцать соединений на IP-адрес в минуту и общим ограничением в максимум десять порожденных даемонов выглядит так: <code>nowait/10/20</code>.</p></div><div class=paragraph><p>Эти параметры, используемые все со значениями по умолчанию даемоном <a href="https://man.freebsd.org/cgi/man.cgi?query=fingerd&amp;sektion=8&amp;format=html">fingerd(8)</a>, имеют такой вид:</p></div><div class="literalblock programlisting"><div class=content><pre>finger stream  tcp     nowait/3/10 nobody /usr/libexec/fingerd fingerd -s</pre></div></div><div class=paragraph><p>Наконец, пример, описывающий ограничение на 100 даемонов в целом, при этом не более чем по 5 на один IP-адрес, будет выглядеть так: <code>nowait/100/0/5</code>.</p></div></dd><dt class=hdlist1>user</dt><dd><p>Это имя пользователя, под которым должен работать соответствующий даемон. Чаще всего даемоны работают как пользователь <code>root</code>. Для обеспечения безопасности некоторые серверы запускаются как пользователь <code>daemon</code> или как пользователь с минимальными правами <code>nobody</code>.</p></dd><dt class=hdlist1>server-program</dt><dd><p>Полный маршрут к даемону, который будет выполняться при установлении соединения. Если даемон является сервисом, предоставляемым самим inetd, то нужно задать ключевое слово <code>internal</code>.</p></dd><dt class=hdlist1>server-program-arguments</dt><dd><p>Этот параметр работает вместе с параметром <code>server-program</code>, задавая параметры, начиная с <code>argv[0]</code>, передаваемые даемону при запуске. Если в командной строке задано <code>mydaemon -d</code>, то <code>mydaemon -d</code> будет являться значением для <code>server-program-arguments</code>. И снова, если даемон является внутренней службой, то здесь нужно использовать <code>internal</code>.</p></dd></dl></div></div><div class=sect2><h3 id=network-inetd-security>25.2.5. Безопасность<a class=anchor href=#network-inetd-security></a></h3><div class=paragraph><p>В зависимости от выбранных при установке параметров, многие из служб inetd могут оказаться по умолчанию включенными. Если нет особой нужды в некотором даемоне, подумайте, не стоит ли его выключить? Поместите знак "#" перед ненужным даемоном в <span class=filename>/etc/inetd.conf</span> и <a href=#network-inetd-reread>пошлите сигнал для inetd</a>. Некоторые даемоны, такие, как fingerd, вообще нежелательны, потому что они дают информацию, которая может оказаться полезной атакующему.</p></div><div class=paragraph><p>Некоторые даемоны не заботятся о безопасности и имеют большие тайм-ауты для соединений или вообще их не имеют. Это позволяет атакующему неспешно устанавливать соединения к конкретному даемону, истощая имеющиеся ресурсы. Может оказаться полезным задать для некоторых даемонов ограничения <code>max-connections-per-ip-per-minute</code>, <code>max-child</code> и <code>max-child-per-ip</code>, особенно если вы обнаружите слишком большое число соединений.</p></div><div class=paragraph><p>По умолчанию механизм TCP wrapping включен. Обратитесь к справочной странице по <a href="https://man.freebsd.org/cgi/man.cgi?query=hosts_access&amp;sektion=5&amp;format=html">hosts_access(5)</a> для получения более подробной информации о задании ограничений TCP для различных даемонов, запускаемых посредством inetd.</p></div></div><div class=sect2><h3 id=network-inetd-misc>25.2.6. Разное<a class=anchor href=#network-inetd-misc></a></h3><div class=paragraph><p>daytime, time, echo, discard, chargen и auth все являются услугами, предоставляемыми самим inetd.</p></div><div class=paragraph><p>Сервис auth предоставляет идентификационные сетевые услуги и поддается настройке; прочие сервисы ненастраиваемы.</p></div><div class=paragraph><p>Обратитесь к справочной странице по <a href="https://man.freebsd.org/cgi/man.cgi?query=inetd&amp;sektion=8&amp;format=html">inetd(8)</a> для получения более подробной информации.</p></div></div></div></div><div class=sect1><h2 id=network-nfs>25.3. Network File System (NFS)<a class=anchor href=#network-nfs></a></h2><div class=sectionbody><div class=paragraph><p>Кроме поддержки многих прочих типов файловых систем, во FreeBSD встроена поддержка сетевой файловой системы (Network File System), известной как NFS. NFS позволяет системе использовать каталоги и файлы совместно с другими машинами, посредством сети. Посредством NFS пользователи и программы могут получать доступ к файлам на удалённых системах точно так же, как если бы это были файлы на собственных дисках.</p></div><div class=paragraph><p>Вот некоторые из наиболее заметных преимуществ, которые даёт использование NFS:</p></div><div class=ulist><ul><li><p>Отдельно взятые рабочие станции используют меньше собственного дискового пространства, так как совместно используемые данные могут храниться на одной отдельной машине и быть доступными для других машин в сети.</p></li><li><p>Пользователям не нужно иметь домашние каталоги, отдельные для каждой машины в вашей сети. Домашние каталоги могут располагаться на сервере NFS и их можно сделать доступными отовсюду в сети.</p></li><li><p>Устройства хранения информации, такие, как дискеты, приводы CD-ROM и устройства Zip®, могут использоваться другими машинами в сети. Это может привести к уменьшению переносимых устройств хранения информации в сети.</p></li></ul></div><div class=sect2><h3 id=_как_работает_nfs>25.3.1. Как работает NFS<a class=anchor href=#_как_работает_nfs></a></h3><div class=paragraph><p>NFS строится по крайней мере из двух основных частей: сервера и одного или большего количества клиентов. Клиент обращается к данным, находящимся на сервере, в режиме удалённого доступа. Для того, чтобы это нормально функционировало, нужно настроить и запустить несколько процессов.</p></div><div class=paragraph><p>На сервере работают следующие даемоны:</p></div><table class="tableblock frame-none grid-all stretch informaltable"><col style=width:50%><col style=width:50%><thead><tr><th class="tableblock halign-left valign-top">Даемон</th><th class="tableblock halign-left valign-top">Описание</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class=tableblock>nfsd</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Даемон NFS, обслуживающий запросы от клиентов NFS.</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>mountd</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Даемон монтирования NFS, который выполняет запросы, передаваемые ему от <a href="https://man.freebsd.org/cgi/man.cgi?query=nfsd&amp;sektion=8&amp;format=html">nfsd(8)</a>.</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>rpcbind</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Этот даемон позволяет клиентам NFS определить порт, используемый сервером NFS.</p></td></tr></tbody></table><div class=paragraph><p>Клиент может запустить также даемон, называемый nfsiod. nfsiod обслуживает запросы, поступающие от сервера от сервера NFS. Он необязателен, увеличивает производительность, однако для нормальной и правильной работы не требуется. Для получения дополнительной информации обратитесь к разделу справочной системы о <a href="https://man.freebsd.org/cgi/man.cgi?query=nfsiod&amp;sektion=8&amp;format=html">nfsiod(8)</a>.</p></div></div><div class=sect2><h3 id=network-configuring-nfs>25.3.2. Настройка NFS<a class=anchor href=#network-configuring-nfs></a></h3><div class=paragraph><p>Настройка NFS является достаточно незамысловатым процессом. Все процессы, которые должны быть запущены, могут быть запущены во время загрузки посредством нескольких модификаций в вашем файле <span class=filename>/etc/rc.conf</span>.</p></div><div class=paragraph><p>Проверьте, что на NFS-сервере в файле <span class=filename>/etc/rc.conf</span> имеются такие строки:</p></div><div class="literalblock programlisting"><div class=content><pre>rpcbind_enable=&#34;YES&#34;
nfs_server_enable=&#34;YES&#34;
nfs_server_flags=&#34;-u -t -n 4&#34;
mountd_flags=&#34;-r&#34;</pre></div></div><div class=paragraph><p>mountd запускается автоматически, если включена функция сервера NFS.</p></div><div class=paragraph><p>На клиенте убедитесь, что в файле <span class=filename>/etc/rc.conf</span> присутствует такой параметр:</p></div><div class="literalblock programlisting"><div class=content><pre>nfs_client_enable=&#34;YES&#34;</pre></div></div><div class=paragraph><p>Файл <span class=filename>/etc/exports</span> определяет, какие файловые системы на вашем сервере NFS будут экспортироваться (иногда их называют "совместно используемыми"). Каждая строка в <span class=filename>/etc/exports</span> задаёт файловую систему, которая будет экспортироваться и какие машины будут иметь к ней доступ. Кроме машин, имеющих доступ, могут задаваться другие параметры, влияющие на характеристики доступа. Имеется полный набор параметров, которые можно использовать, но здесь пойдёт речь лишь о некоторых из них. Описания остальных параметров можно найти на страницах справочной системы по <a href="https://man.freebsd.org/cgi/man.cgi?query=exports&amp;sektion=5&amp;format=html">exports(5)</a>.</p></div><div class=paragraph><p>Вот несколько примерных строк из файла <span class=filename>/etc/exports</span>:</p></div><div class=paragraph><p>В следующих примерах даётся общая идея того, как экспортировать файловые системы, хотя конкретные параметры могут отличаться в зависимости от ваших условий и конфигурации сети. К примеру, чтобы экспортировать каталог <span class=filename>/cdrom</span> для трёх машин, находящихся в том же самом домене, что и сервер (поэтому отсутствует доменное имя для каждой машины) или для которых имеются записи в файле <span class=filename>/etc/hosts</span>. Флаг <code>-ro</code> указывает на использование экспортируемой файловой системы в режиме только чтения. С этим флагом удалённая система не сможет никоим образом изменить экспортируемую файловую систему.</p></div><div class="literalblock programlisting"><div class=content><pre>/cdrom -ro host1 host2 host3</pre></div></div><div class=paragraph><p>В следующей строке экспортируется файловая система <span class=filename>/home</span>, которая становится доступной трем хостам, указанным по их IP-адресам. Это полезно, если у вас есть собственная сеть без настроенного сервера DNS. Как вариант, файл <span class=filename>/etc/hosts</span> может содержать внутренние имена хостов; пожалуйста, обратитесь к справочную систему по <a href="https://man.freebsd.org/cgi/man.cgi?query=hosts&amp;sektion=5&amp;format=html">hosts(5)</a> для получения дополнительной информации. Флаг <code>-alldirs</code> позволяет рассматривать подкаталоги в качестве точек монтирования. Другими словами, это не монтирование подкаталогов, но разрешение клиентам монтировать только каталоги, которые им требуются или нужны.</p></div><div class="literalblock programlisting"><div class=content><pre>/home  -alldirs  10.0.0.2 10.0.0.3 10.0.0.4</pre></div></div><div class=paragraph><p>В строке, приведённой ниже, файловая система <span class=filename>/a</span> экспортируется таким образом, что она доступна двум клиентам из других доменов. Параметр <code>-maproot=root</code> позволяет пользователю <code>root</code> удалённой системы осуществлять запись на экспортируемую файловую систему как пользователь <code>root</code>. Если параметр <code>-maproot=root</code> не задан, то даже если пользователь имеет права доступа <code>root</code> на удалённой системе, он не сможет модифицировать файлы на экспортированной файловой системе.</p></div><div class="literalblock programlisting"><div class=content><pre>/a  -maproot=root  host.example.com box.example.org</pre></div></div><div class=paragraph><p>Для того, чтобы клиент смог обратиться к экспортированной файловой системе, он должен иметь права сделать это. Проверьте, что клиент указан в вашем файле <span class=filename>/etc/exports</span>.</p></div><div class=paragraph><p>В файле <span class=filename>/etc/exports</span> каждая строка содержит информацию об экспортировании для отдельной файловой системы для отдельно взятого хоста. Удалённый хост может быть задан только один раз для каждой файловой системы, и может иметь только одну запись, используемую по умолчанию, для каждой локальной файловой системы. К примеру, предположим, что <span class=filename>/usr</span> является отдельной файловой системой. Следующий <span class=filename>/etc/exports</span> будет некорректен:</p></div><div class="literalblock programlisting"><div class=content><pre># Invalid when /usr is one file system
/usr/src   client
/usr/ports client</pre></div></div><div class=paragraph><p>Одна файловая система, <span class=filename>/usr</span>, имеет две строки, задающие экспортирование для одного и того же хоста, <code>client</code>. Правильный формат в этом случае таков:</p></div><div class="literalblock programlisting"><div class=content><pre>/usr/src /usr/ports  client</pre></div></div><div class=paragraph><p>Свойства отдельной файловой системы, экспортируемой некоторому хосту, должны задаваться в одной строке. Строки без указания клиента воспринимаются как отдельный хост. Это ограничивает то, как вы можете экспортировать файловые системы, но для большинства это не проблема.</p></div><div class=paragraph><p>Ниже приведён пример правильного списка экспортирования, где <span class=filename>/usr</span> и <span class=filename>/exports</span> являются локальными файловыми системами:</p></div><div class="literalblock programlisting"><div class=content><pre># Экспортируем src и ports для client01 и client02, но
# только client01 имеет права пользователя root на них
/usr/src /usr/ports -maproot=root    client01
/usr/src /usr/ports	       client02
# Клиентские машины имеют пользователя root и могут монтировать всё в
# каталоге /exports.  Кто угодно может монтировать /exports/obj в режиме чтения
/exports -alldirs -maproot=root      client01 client02
/exports/obj -ro</pre></div></div><div class=paragraph><p>Даемон mountd должен быть проинформирован об изменении файла <span class=filename>/etc/exports</span>, чтобы изменения вступили в силу. Это может быть достигнуто посылкой сигнала HUP процессу <code>mountd</code>:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># kill -HUP `cat /var/run/mountd.pid`</span></code></pre></div></div><div class=paragraph><p>или вызовом скрипта <code>mountd</code> подсистемы <a href="https://man.freebsd.org/cgi/man.cgi?query=rc&amp;sektion=8&amp;format=html">rc(8)</a> с соответствующим параметром:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># /etc/rc.d/mountd onereload</span></code></pre></div></div><div class=paragraph><p>За подробной информацией о работе скриптов rc.d обращайтесь к <a href=../config/#configtuning-rcd>Использование rc во FreeBSD 5.X и последующих версиях</a>.</p></div><div class=paragraph><p>Как вариант, при перезагрузке FreeBSD всё настроится правильно. Хотя выполнять перезагрузку вовсе не обязательно. Выполнение следующих команд пользователем <code>root</code> запустит всё, что нужно.</p></div><div class=paragraph><p>На сервере NFS:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># rpcbind</span>
<span class=c># nfsd -u -t -n 4</span>
<span class=c># mountd -r</span></code></pre></div></div><div class=paragraph><p>На клиенте NFS:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># nfsiod -n 4</span></code></pre></div></div><div class=paragraph><p>Теперь всё должно быть готово к реальному монтированию удалённой файловой системы. В приводимых примерах сервер будет носить имя <code>server</code>, а клиент будет носить имя <code>client</code>. Если вы только хотите временно смонтировать удалённую файловую систему, или всего лишь протестировать ваши настройки, то просто запустите команды, подобные приводимым здесь, работая как пользователь <code>root</code> на клиентской машине:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># mount server:/home /mnt</span></code></pre></div></div><div class=paragraph><p>По этой команде файловая система <span class=filename>/home</span> на сервере будет смонтирована в каталог <span class=filename>/mnt</span> на клиенте. Если всё настроено правильно, вы сможете войти в каталог <span class=filename>/mnt</span> на клиенте и увидеть файлы, находящиеся на сервере.</p></div><div class=paragraph><p>Если вы хотите автоматически монтировать удалённую файловую систему при каждой загрузке компьютера, добавьте файловую систему в <span class=filename>/etc/fstab</span>. Вот пример:</p></div><div class="literalblock programlisting"><div class=content><pre>server:/home	  /mnt	  nfs	  rw	  0	  0</pre></div></div><div class=paragraph><p>На страницах справочной системы по <a href="https://man.freebsd.org/cgi/man.cgi?query=fstab&amp;sektion=5&amp;format=html">fstab(5)</a> перечислены все доступные параметры.</p></div></div><div class=sect2><h3 id=_блокировка_файлов>25.3.3. Блокировка файлов<a class=anchor href=#_блокировка_файлов></a></h3><div class=paragraph><p>Некоторым приложениям (например, mutt) для корректной работы необходима возможность блокировки файлов (file locking). При работе по NFS блокировка файлов может осуществляться при помощи демона rpc.lockd. Чтобы его активировать, добавьте следующие записи в файл <span class=filename>/etc/rc.conf</span> как на клиенте, так и на сервере NFS (предполагается, что и клиент, и сервер уже сконфигурированы):</p></div><div class="literalblock programlisting"><div class=content><pre>rpc_lockd_enable=&#34;YES&#34;
rpc_statd_enable=&#34;YES&#34;</pre></div></div><div class=paragraph><p>Запустите демоны, выполнив следующие команды:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># /etc/rc.d/lockd start</span>
<span class=c># /etc/rc.d/statd start</span></code></pre></div></div><div class=paragraph><p>Если нет необходимости в настоящей блокировке файлов между сервером NFS и клиентами, то клиент NFS может быть настроен так, чтобы выполнять блокировки файлов локально, для чего необходимо передать опцию <code>-L</code> команде <a href="https://man.freebsd.org/cgi/man.cgi?query=mount_nfs&amp;sektion=8&amp;format=html">mount_nfs(8)</a>. За подробностями обратитесь к странице справочника <a href="https://man.freebsd.org/cgi/man.cgi?query=mount_nfs&amp;sektion=8&amp;format=html">mount_nfs(8)</a>.</p></div></div><div class=sect2><h3 id=_практическое_использование>25.3.4. Практическое использование<a class=anchor href=#_практическое_использование></a></h3><div class=paragraph><p>У NFS есть много вариантов практического применения. Ниже приводится несколько наиболее широко распространённых способов её использования:</p></div><div class=ulist><ul><li><p>Настройка несколько машин для совместного использования CDROM или других носителей. Это более дешёвый и зачастую более удобный способ установки программного обеспечения на несколько машин.</p></li><li><p>В больших сетях может оказаться более удобным настроить центральный сервер NFS, на котором размещаются все домашние каталоги пользователей. Эти домашние каталоги могут затем экспортироваться в сеть так, что пользователи всегда будут иметь один и тот же домашний каталог вне зависимости от того, на какой рабочей станции они работают.</p></li><li><p>Несколько машин могут иметь общий каталог <span class=filename>/usr/ports/distfiles</span>. Таким образом, когда вам нужно будет установить порт на несколько машин, вы сможете быстро получить доступ к исходным текстам без их загрузки на каждой машине.</p></li></ul></div></div><div class=sect2><h3 id=network-amd>25.3.5. Автоматическое монтирование с amd<a class=anchor href=#network-amd></a></h3><div class=paragraph><p><a href="https://man.freebsd.org/cgi/man.cgi?query=amd&amp;sektion=8&amp;format=html">amd(8)</a> (даемон автоматического монтирования) автоматически монтирует удалённую файловую систему, как только происходит обращение к файлу или каталогу в этой файловой системе. Кроме того, файловые системы, которые были неактивны некоторое время, будут автоматически размонтированы даемоном amd. Использование amd является простой альтернативой статическому монтированию, так как в последнем случае обычно всё должно быть описано в файле <span class=filename>/etc/fstab</span>.</p></div><div class=paragraph><p>amd работает, сам выступая как сервер NFS для каталогов <span class=filename>/host</span> и <span class=filename>/net</span>. Когда происходит обращение к файлу в одном из этих каталогов, amd ищет соответствующий удаленный ресурс для монтирования и автоматически его монтирует. <span class=filename>/net</span> используется для монтирования экспортируемой файловой системы по адресу IP, когда как каталог <span class=filename>/host</span> используется для монтирования ресурса по удаленному имени хоста.</p></div><div class=paragraph><p>Обращение к файлу в каталоге <span class=filename>/host/foobar/usr</span> укажет amd на выполнение попытки монтирования ресурса <span class=filename>/usr</span>, который находится на хосте <code>foobar</code>.</p></div><div class=exampleblock><div class=title>Пример 2. Монтирование ресурса при помощи amd</div><div class=content><div class=paragraph><p>Вы можете посмотреть доступные для монтирования ресурсы отдалённого хоста командой <code>showmount</code>. К примеру, чтобы посмотреть ресурсы хоста с именем <code>foobar</code>, вы можете использовать:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>% showmount <span class=nt>-e</span> foobar
Exports list on foobar:
/usr			       10.10.10.0
/a				 10.10.10.0
% <span class=nb>cd</span> /host/foobar/usr</code></pre></div></div></div></div><div class=paragraph><p>Как видно из примера, <code>showmount</code> показывает <span class=filename>/usr</span> как экспортируемый ресурс. При переходе в каталог <span class=filename>/host/foobar/usr</span> даемон amd пытается разрешить имя хоста <code>foobar</code> и автоматически смонтировать требуемый ресурс.</p></div><div class=paragraph><p>amd может быть запущен из скриптов начальной загрузки, если поместить такую строку в файл <span class=filename>/etc/rc.conf</span>:</p></div><div class="literalblock programlisting"><div class=content><pre>amd_enable=&#34;YES&#34;</pre></div></div><div class=paragraph><p>Кроме того, даемону amd могут быть переданы настроечные флаги через параметр <code>amd_flags</code>. По умолчанию <code>amd_flags</code> настроен следующим образом:</p></div><div class="literalblock programlisting"><div class=content><pre>amd_flags=&#34;-a /.amd_mnt -l syslog /host /etc/amd.map /net /etc/amd.map&#34;</pre></div></div><div class=paragraph><p>Файл <span class=filename>/etc/amd.map</span> задает опции, используемые по умолчанию при монтировании экспортируемых ресурсов. В файле <span class=filename>/etc/amd.conf</span> заданы настройки некоторых более сложных возможностей amd.</p></div><div class=paragraph><p>Обратитесь к справочным страницам по <a href="https://man.freebsd.org/cgi/man.cgi?query=amd&amp;sektion=8&amp;format=html">amd(8)</a> и <a href="https://man.freebsd.org/cgi/man.cgi?query=amd.conf&amp;sektion=8&amp;format=html">amd.conf(8)</a> для получения более полной информации.</p></div></div><div class=sect2><h3 id=network-nfs-integration>25.3.6. Проблемы взаимодействия с другими системами<a class=anchor href=#network-nfs-integration></a></h3><div class=paragraph><p>Некоторые сетевые адаптеры для систем PC с шиной ISA имеют ограничения, которые могут привести к серьезным проблемам в сети, в частности, с NFS. Эти проблемы не специфичны для FreeBSD, однако эту систему они затрагивают.</p></div><div class=paragraph><p>Проблема, которая возникает практически всегда при работе по сети систем PC (FreeBSD) с высокопроизводительными рабочими станциями, выпущенными такими производителями, как Silicon Graphics, Inc. и Sun Microsystems, Inc. Монтирование по протоколу NFS будет работать нормально, и некоторые операции также будут выполняться успешно, но неожиданно сервер окажется недоступным для клиент, хотя запросы к и от других систем будут продолжаться обрабатываться. Такое встречается с клиентскими системами, не зависимо от того, является ли клиент машиной с FreeBSD или рабочей станцией. Во многих системах при возникновении этой проблемы нет способа корректно завершить работу клиента. Единственным выходом зачастую является холодная перезагрузка клиента, потому что ситуация с NFS не может быть разрешена.</p></div><div class=paragraph><p>Хотя "правильным" решением является установка более производительного и скоростного сетевого адаптера на систему FreeBSD, имеется простое решение, приводящее к удовлетворительным результатам. Если система FreeBSD является <em>сервером</em>, укажите параметр <code>-w=1024</code> на клиенте при монтировании. Если система FreeBSD является <em>клиентом</em>, то смонтируйте файловую систему NFS с параметром <code>-r=1024</code>. Эти параметры могут быть заданы в четвертом поле записи в файле <span class=filename>fstab</span> клиента при автоматическом монтировании, или при помощи параметра <code>-o</code> в команде <a href="https://man.freebsd.org/cgi/man.cgi?query=mount&amp;sektion=8&amp;format=html">mount(8)</a> при монтировании вручную.</p></div><div class=paragraph><p>Нужно отметить, что имеется также другая проблема, ошибочно принимаемая за приведенную выше, когда серверы и клиенты NFS находятся в разных сетях. Если это тот самый случай, <em>проверьте</em>, что ваши маршрутизаторы пропускают нужную информацию UDP, в противном случае вы ничего не получите, что бы вы ни предпринимали.</p></div><div class=paragraph><p>В следующих примерах <code>fastws</code> является именем хоста (интерфейса) высокопроизводительной рабочей станции, а <code>freebox</code> является именем хоста (интерфейса) системы FreeBSD со слабым сетевым адаптером. Кроме того, <span class=filename>/sharedfs</span> будет являться экспортируемой через NFS файловой системой (обратитесь к страницам справочной системы по команде <a href="https://man.freebsd.org/cgi/man.cgi?query=exports&amp;sektion=5&amp;format=html">exports(5)</a>), а <span class=filename>/project</span> будет точкой монтирования экспортируемой файловой системы на клиенте. В любом случае, отметьте, что для вашего приложения могут понадобиться дополнительные параметры, такие, как <code>hard</code>, <code>soft</code> или <code>bg</code>.</p></div><div class=paragraph><p>Пример системы FreeBSD (<code>freebox</code>) как клиента в файле <span class=filename>/etc/fstab</span> на машине <code>freebox</code>:</p></div><div class="literalblock programlisting"><div class=content><pre>fastws:/sharedfs /project nfs rw,-r=1024 0 0</pre></div></div><div class=paragraph><p>Команда, выдаваемая вручную на машине <code>freebox</code>:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># mount -t nfs -o -r=1024 fastws:/sharedfs /project</span></code></pre></div></div><div class=paragraph><p>Пример системы FreeBSD в качестве сервера в файле <span class=filename>/etc/fstab</span> на машине <code>fastws</code>:</p></div><div class="literalblock programlisting"><div class=content><pre>freebox:/sharedfs /project nfs rw,-w=1024 0 0</pre></div></div><div class=paragraph><p>Команда, выдаваемая вручную на машине <code>fastws</code>:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># mount -t nfs -o -w=1024 freebox:/sharedfs /project</span></code></pre></div></div><div class=paragraph><p>Практически все 16-разрядные сетевые адаптеры позволят работать без указанных выше ограничений на размер блоков при чтении и записи.</p></div><div class=paragraph><p>Для тех, кто интересуется, ниже описывается, что же происходит в при появлении этой ошибки, и объясняется, почему ее невозможно устранить. Как правило, NFS работает с "блоками" размером 8 килобайт (хотя отдельные фрагменты могут иметь меньшие размеры). Так, пакет Ethernet имеет максимальный размер около 1500 байт, то "блок" NFS разбивается на несколько пакетов Ethernet, хотя на более высоком уровне это все тот же единый блок, который должен быть принят, собран и <em>подтвержден</em> как один блок. Высокопроизводительные рабочие станции могут посылать пакеты, которые соответствуют одному блоку NFS, сразу друг за другом, насколько это позволяет делать стандарт. На слабых, низкопроизводительных адаптерах пакеты, пришедшие позже, накладываются поверх ранее пришедших пакетов того же самого блока до того, как они могут быть переданы хосту и блок как единое целое не может быть собран или подтвержден. В результате рабочая станция входит в ситуацию тайм-аута и пытается повторить передачу, но уже с полным блоком в 8 КБ, и процесс будет повторяться снова, до бесконечности.</p></div><div class=paragraph><p>Задав размер блока меньше размера пакета Ethernet, мы достигаем того, что любой полностью полученный пакет Ethernet может быть подтвержден индивидуально, и избежим тупиковую ситуацию.</p></div><div class=paragraph><p>Наложение пакетов может все еще проявляться, когда высокопроизводительные рабочие станции сбрасывают данные на PC-систему, однако повторение этой ситуации не обязательно с более скоростными адаптерами с "блоками" NFS. Когда происходит наложение, затронутые блоки будут переданы снова, и скорее всего, они будут получены, собраны и подтверждены.</p></div></div></div></div><div class=sect1><h2 id=network-nis>25.4. Network Information System (NIS/YP)<a class=anchor href=#network-nis></a></h2><div class=sectionbody><div class=sect2><h3 id=_что_это_такое>25.4.1. Что это такое?<a class=anchor href=#_что_это_такое></a></h3><div class=paragraph><p>NIS, что является сокращением от Network Information Services (Сетевые Информационные Службы), которые были разработаны компанией Sun Microsystems для централизованного администрирования систем UNIX® (изначально SunOS™). В настоящее время эти службы практически стали промышленным стандартом; все основные UNIX®-подобные системы (Solaris™, HP-UX, AIX®, Linux, NetBSD, OpenBSD, FreeBSD и так далее) поддерживают NIS.</p></div><div class=paragraph><p>NIS первоначально назывались Yellow Pages (или yp), но из-за проблем с торговым знаком Sun изменила это название. Старое название (и yp) всё ещё часто употребляется.</p></div><div class=paragraph><p>Это система клиент/сервер на основе вызовов RPC, которая позволяет группе машин в одном домене NIS совместно использовать общий набор конфигурационных файлов. Системный администратор может настроить клиентскую систему NIS только с минимальной настроечной информацией, а затем добавлять, удалять и модифицировать настроечную информацию из одного места.</p></div><div class=paragraph><p>Это похоже на систему доменов Windows NT®; хотя их внутренние реализации не так уж и похожи, основные функции сравнимы.</p></div></div><div class=sect2><h3 id=_терминыпрограммы_о_которых_вы_должны_знать>25.4.2. Термины/программы, о которых вы должны знать<a class=anchor href=#_терминыпрограммы_о_которых_вы_должны_знать></a></h3><div class=paragraph><p>Существует несколько терминов и некоторое количество пользовательских программ, которые будут нужны, когда вы будете пытаться сделать NIS во FreeBSD, и в случае создания сервера, и в случае работы в качестве клиента NIS:</p></div><table class="tableblock frame-none grid-all stretch informaltable"><col style=width:50%><col style=width:50%><thead><tr><th class="tableblock halign-left valign-top">Термин</th><th class="tableblock halign-left valign-top">Описание</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class=tableblock>Имя домена NIS</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Главный сервер NIS и все его клиенты (включая вторичные серверы), имеют доменное имя NIS. Как и в случае с именем домена Windows NT®, имя домена NIS не имеет ничего общего с DNS.</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>rpcbind</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Для обеспечения работы RPC (Remote Procedure Call, Удалённого Вызова Процедур, сетевого протокола, используемого NIS), должен быть запущен даемон rpcbind. Если даемон rpcbind не запущен, невозможно будет запустить сервер NIS, или работать как NIS-клиент.</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>ypbind</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>"Связывает" NIS-клиента с его NIS-сервером. Он определяет имя NIS-домена системы, и при помощи RPC подключается к серверу. ypbind является основой клиент-серверного взаимодействия в среде NIS; если на клиентской машине программа ypbind перестанет работать, то эта машина не сможет получить доступ к серверу NIS.</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>ypserv</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Программа <code>ypserv</code>, которая должна запускаться только на серверах NIS: это и есть сервер NIS. Если <a href="https://man.freebsd.org/cgi/man.cgi?query=ypserv&amp;sektion=8&amp;format=html">ypserv(8)</a> перестанет работать, то сервер не сможет отвечать на запросы NIS (к счастью, на этот случай предусмотрен вторичный сервер). Есть несколько реализаций NIS (к FreeBSD это не относится), в которых не производится попыток подключиться к другому серверу, если ранее используемый сервер перестал работать. Зачастую единственным средством, помогающим в этой ситуации, является перезапуск серверного процесса (или сервера полностью) или процесса ypbind на клиентской машине.</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>rpc.yppasswdd</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Программа <code>rpc.yppasswdd</code>, другой процесс, который запускается только на главных NIS-серверах: это даемон, позволяющий клиентам NIS изменять свои пароли NIS. Если этот даемон не запущен, то пользователи должны будут входить на основной сервер NIS и там менять свои пароли.</p></td></tr></tbody></table></div><div class=sect2><h3 id=_как_это_работает>25.4.3. Как это работает?<a class=anchor href=#_как_это_работает></a></h3><div class=paragraph><p>В системе NIS существует три типа хостов: основные (master) серверы, вторичные (slave) серверы и клиентские машины. Серверы выполняют роль централизованного хранилища информации о конфигурации хостов. Основные серверы хранят оригиналы этой информации, когда как вторичные серверы хранят ее копию для обеспечения избыточности. Клиенты связываются с серверами, чтобы предоставить им эту информацию.</p></div><div class=paragraph><p>Информация во многих файлах может совместно использоваться следующим образом. Файлы <span class=filename>master.passwd</span>, <span class=filename>group</span> и <span class=filename>hosts</span> используются совместно через NIS. Когда процессу, работающему на клиентской машине, требуется информация, как правило, находящаяся в этих файлах локально, то он делает запрос к серверу NIS, с которым связан.</p></div><div class=sect3><h4 id=_типы_машин>25.4.3.1. Типы машин<a class=anchor href=#_типы_машин></a></h4><div class=ulist><ul><li><p><em>Основной сервер NIS</em>. Такой сервер, по аналогии с первичным контроллером домена Windows NT®, хранит файлы, используемые всеми клиентами NIS. Файлы <span class=filename>passwd</span>, <span class=filename>group</span> и различные другие файлы, используемые клиентами NIS, находятся на основном сервере.</p><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Возможно использование одной машины в качестве сервера для более чем одного домена NIS. Однако, в этом введении такая ситуация не рассматривается, и предполагается менее масштабное использование NIS.</p></div></td></tr></tbody></table></div></li><li><p><em>Вторичные серверы NIS</em>. Похожие на вторичные контроллеры доменов Windows NT®, вторичные серверы NIS содержат копии оригинальных файлов данных NIS. Вторичные серверы NIS обеспечивают избыточность, что нужно в критичных приложениях. Они также помогают распределять нагрузку на основной сервер: клиенты NIS всегда подключаются к тому серверу NIS, который ответил первым, в том числе и к вторичным серверам.</p></li><li><p><em>Клиенты NIS</em>. Клиенты NIS, как и большинство рабочих станций Windows NT®, аутентифицируются на сервере NIS (или на контроллере домена Windows NT® для рабочих станций Windows NT®) во время входа в систему.</p></li></ul></div></div></div><div class=sect2><h3 id=_использование_nisyp>25.4.4. Использование NIS/YP<a class=anchor href=#_использование_nisyp></a></h3><div class=paragraph><p>В этом разделе приводится пример настройки NIS.</p></div><div class=sect3><h4 id=_планирование>25.4.4.1. Планирование<a class=anchor href=#_планирование></a></h4><div class=paragraph><p>Давайте предположим, что вы являетесь администратором в маленькой университетской лаборатории. В настоящий момент в этой лаборатории с 15 машинами отсутствует единая точка администрирования; на каждой машине имеются собственные файлы <span class=filename>/etc/passwd</span> и <span class=filename>/etc/master.passwd</span>. Эти файлы синхронизируются друг с другом только вручную; сейчас, когда вы добавляете пользователя в лаборатории, вы должны выполнить команду <code>adduser</code> на всех 15 машинах. Понятно, что такое положение вещей нужно исправлять, так что вы решили перевести сеть на использование NIS, используя две машины в качестве серверов.</p></div><div class=paragraph><p>Итак, конфигурация лаборатории сейчас выглядит примерно так:</p></div><table class="tableblock frame-none grid-all stretch informaltable"><col style=width:33.3333%><col style=width:33.3333%><col style=width:33.3334%><thead><tr><th class="tableblock halign-left valign-top">Имя машины</th><th class="tableblock halign-left valign-top">IP-адрес</th><th class="tableblock halign-left valign-top">Роль машины</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>ellington</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock><code>10.0.0.2</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Основной сервер NIS</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>coltrane</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock><code>10.0.0.3</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Вторичный сервер NIS</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>basie</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock><code>10.0.0.4</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Факультетская рабочая станция</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>bird</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock><code>10.0.0.5</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Клиентская машина</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>cli[1-11]</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock><code>10.0.0.[6-17]</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Другие клиентские машины</p></td></tr></tbody></table><div class=paragraph><p>Если вы определяете схему NIS первый раз, ее нужно хорошо обдумать. Вне зависимости от размеров вашей сети, есть несколько ключевых моментов, которые требуют принятия решений.</p></div><div class=sect4><h5 id=_выбор_имени_домена_nis>25.4.4.1.1. Выбор имени домена NIS<a class=anchor href=#_выбор_имени_домена_nis></a></h5><div class=paragraph><p>Это имя не должно быть "именем домена", которое вы использовали. Более точно это имя называется "именем домена NIS". Когда клиент рассылает запросы на получение информации, он включает в них имя домена NIS, частью которого является. Таким способом многие сервера в сети могут указать, какой сервер на какой запрос должен отвечать. Думайте о домене NIS как об имени группы хостов, которые каким-то образом связаны.</p></div><div class=paragraph><p>Некоторые организации в качестве имени домена NIS используют свой домен Интернет. Это не рекомендуется, так как может вызвать проблемы в процессе решения сетевых проблем. Имя домена NIS должно быть уникальным в пределах вашей сети и хорошо, если оно будет описывать группу машин, которые представляет. Например, художественный отдел в компании Acme Inc. может находиться в домене NIS с именем "acme-art". В нашем примере положим, что мы выбрали имя <code>test-domain</code>.</p></div><div class=paragraph><p>Несмотря на это, некоторые операционные системы (в частности, SunOS™) используют свое имя домена NIS в качестве имени домена Интернет. Если одна или более машин в вашей сети имеют такие ограничения, вы <em>обязаны</em> использовать имя домена Интернет в качестве имени домена NIS.</p></div></div><div class=sect4><h5 id=_требования_к_серверу>25.4.4.1.2. Требования к серверу<a class=anchor href=#_требования_к_серверу></a></h5><div class=paragraph><p>Есть несколько вещей, которые нужно иметь в виду при выборе машины для использования в качестве сервера NIS. Одной из обескураживающей вещью, касающейся NIS, является уровень зависимости клиентов от серверов. Если клиент не может подключиться к серверу своего домена NIS, зачастую машину просто становится нельзя использовать. Отсутствие информации о пользователях и группах приводит к временной остановке работы большинства систем. Зная это, вы должны выбрать машину, которая не должна подвергаться частым перезагрузкам и не используется для разработки. Сервер NIS в идеале должен быть отдельно стоящей машиной, единственным целью в жизни которой является быть сервером NIS. Если вы работаете в сети, которая не так уж сильно загружена, то можно поместить сервер NIS на машине, на которой запущены и другие сервисы, просто имейте в виду, что если сервер NIS становится недоступным, то это негативно отражается на <em>всех</em> клиентах NIS.</p></div></div></div><div class=sect3><h4 id=_серверы_nis>25.4.4.2. Серверы NIS<a class=anchor href=#_серверы_nis></a></h4><div class=paragraph><p>Оригинальные копии всей информации NIS хранится на единственной машине, которая называется главным сервером NIS. Базы данных, которые используются для хранения информации, называются картами NIS. Во FreeBSD эти карты хранятся в <span class=filename>/var/yp/[domainname]</span>, где <span class=filename>[domainname]</span> является именем обслуживаемого домена NIS. Один сервер NIS может поддерживать одновременно несколько доменов, так что есть возможность иметь несколько таких каталогов, по одному на каждый обслуживаемый домен. Каждый домен будет иметь свой собственный независимый от других набор карт.</p></div><div class=paragraph><p>Основной и вторичный серверы обслуживают все запросы NIS с помощью даемона <code>ypserv</code>. <code>ypserv</code> отвечает за получение входящих запросов от клиентов NIS, распознавание запрашиваемого домена и отображение имени в путь к соответствующему файлы базы данных, а также передаче информации из базы данных обратно клиенту.</p></div><div class=sect4><h5 id=_настройка_основного_сервера_nis>25.4.4.2.1. Настройка основного сервера NIS<a class=anchor href=#_настройка_основного_сервера_nis></a></h5><div class=paragraph><p>Настройка основного сервера NIS может оказаться сравнительно простой, в зависимости от ваших потребностей. В поставку FreeBSD сразу включена поддержка NIS. Все, что вам нужно, это добавить следующие строки в файл <span class=filename>/etc/rc.conf</span>, а FreeBSD сделает за вас всё остальное..</p></div><div class="exampleblock procedure"><div class=content><div class="literalblock programlisting"><div class=content><pre>nisdomainname=&#34;test-domain&#34;</pre></div></div><div class="olist arabic"><ol class=arabic><li><p>В этой строке задается имя домена NIS, которое будет <code>test-domain</code>, еще до настройки сети (например, после перезагрузки).</p><div class="literalblock programlisting"><div class=content><pre>nis_server_enable=&#34;YES&#34;</pre></div></div></li><li><p>Здесь указывается FreeBSD на запуск процессов серверов NIS, когда дело доходит до сетевых настроек.</p><div class="literalblock programlisting"><div class=content><pre>nis_yppasswdd_enable=&#34;YES&#34;</pre></div></div></li><li><p>Здесь указывается на запуск даемона <code>rpc.yppasswdd</code>, который, как это отмечено выше, позволит пользователям менять свой пароль NIS с клиентской машины.</p></li></ol></div></div></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>В зависимости от ваших настроек NIS, вам могут понадобиться дополнительные строки. Обратитесь к <a href=#network-nis-server-is-client>"разделу о серверах NIS, которые являются и клиентами NIS"</a> ниже для получения подробной информации.</p></div></td></tr></tbody></table></div><div class=paragraph><p>После добавления вышеприведенных строк, запустите команду <code>/etc/netstart</code>, работая как администратор. По ней произойдет настройка всего, при этом будут использоваться значения, заданные в файле <span class=filename>/etc/rc.conf</span>. И наконец, перед инициализацией карт NIS, запустите вручную демон ypserv:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># /etc/rc.d/ypserv start</span></code></pre></div></div></div><div class=sect4><h5 id=_инициализация_карт_nis>25.4.4.2.2. Инициализация карт NIS<a class=anchor href=#_инициализация_карт_nis></a></h5><div class=paragraph><p><em>Карты NIS</em> являются файлами баз данных, которые хранятся в каталоге <span class=filename>/var/yp</span>. Они генерируются из конфигурационных файлов, находящихся в каталоге <span class=filename>/etc</span> основного сервера NIS, за одним исключением: файл <span class=filename>/etc/master.passwd</span>. На это есть весомая причина, вам не нужно распространять пароли пользователя <code>root</code> и других административных пользователей на все серверы в домене NIS. По этой причине, прежде чем инициализировать карты NIS, вы должны сделать вот что:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># cp /etc/master.passwd /var/yp/master.passwd</span>
<span class=c># cd /var/yp</span>
<span class=c># vi master.passwd</span></code></pre></div></div><div class=paragraph><p>Вы должны удалить все записи, касающиеся системных пользователей (<code>bin</code>, <code>tty</code>, <code>kmem</code>, <code>games</code> и так далее), а также записи, которые вы не хотите распространять клиентам NIS (например, <code>root</code> и другие пользователи с UID, равным 0 (администраторы)).</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Проверьте, чтобы файл <span class=filename>/var/yp/master.passwd</span> был недоступен для записи ни для группы, ни для остальных пользователей (режим доступа 600)! Воспользуйтесь командой <code>chmod</code>, если это нужно.</p></div></td></tr></tbody></table></div><div class=paragraph><p>Когда с этим будет покончено, самое время инициализировать карты NIS! В поставку FreeBSD включен скрипт с именем <code>ypinit</code>, который делает это (обратитесь к его справочной странице за дополнительной информацией). Отметьте, что этот скрипт имеется в большинстве операционных систем UNIX®, но не во всех. В системе Digital Unix/Compaq Tru64 UNIX он называется <code>ypsetup</code>. Так как мы генерируем карты для главного сервера NIS, то при вызове программы <code>ypinit</code> мы передаем ей параметр <code>-m</code>. Для генерации карт NIS в предположении, что вы уже сделали шаги, описанные выше, выполните следующее:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>ellington# ypinit <span class=nt>-m</span> test-domain
Server Type: MASTER Domain: test-domain
Creating an YP server will require that you answer a few questions.
Questions will all be asked at the beginning of the procedure.
Do you want this procedure to quit on non-fatal errors? <span class=o>[</span>y/n: n] n
Ok, please remember to go back and redo manually whatever fails.
If you don<span class=s1>&#39;t, something might not work.
At this point, we have to construct a list of this domains YP servers.
rod.darktech.org is already known as master server.
Please continue to add any slave servers, one per line. When you are
done with the list, type a &lt;control D&gt;.
master server	:  ellington
next host to add:  coltrane
next host to add:  ^D
The current list of NIS servers looks like this:
ellington
coltrane
Is this correct?  [y/n: y] y

[..вывод при генерации карт..]

NIS Map update completed.
ellington has been setup as an YP master server without any errors.</span></code></pre></div></div><div class=paragraph><p>Программа <code>ypinit</code> должна была создать файл <span class=filename>/var/yp/Makefile</span> из <span class=filename>/var/yp/Makefile.dist</span>. При создании этого файла предполагается, что вы работаете в окружении с единственным сервером NIS и только с машинами FreeBSD. Так как в домене <code>test-domain</code> имеется также и вторичный сервер, то вы должны отредактировать файл <span class=filename>/var/yp/Makefile</span>:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>ellington# vi /var/yp/Makefile</code></pre></div></div><div class=paragraph><p>Вы должны закомментировать строку, в которой указано</p></div><div class="literalblock programlisting"><div class=content><pre>NOPUSH = &#34;True&#34;</pre></div></div><div class=paragraph><p>(она уже не раскомментирована).</p></div></div><div class=sect4><h5 id=_настройка_вторичного_сервера_nis>25.4.4.2.3. Настройка вторичного сервера NIS<a class=anchor href=#_настройка_вторичного_сервера_nis></a></h5><div class=paragraph><p>Настройка вторичного сервера NIS осуществляется ещё проще, чем настройка главного сервера. Войдите на вторичный сервер и отредактируйте файл <span class=filename>/etc/rc.conf</span> точно также, как вы делали это ранее. Единственным отличием является то, что при запуске программы <code>ypinit</code> мы теперь должны использовать опцию <code>-s</code>. Применение опции <code>-s</code> требует также указание имени главного сервера NIS, так что наша команда должна выглядеть так:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>coltrane# ypinit <span class=nt>-s</span> ellington test-domain

Server Type: SLAVE Domain: test-domain Master: ellington

Creating an YP server will require that you answer a few questions.
Questions will all be asked at the beginning of the procedure.

Do you want this procedure to quit on non-fatal errors? <span class=o>[</span>y/n: n]  n

Ok, please remember to go back and redo manually whatever fails.
If you don<span class=s1>&#39;t, something might not work.
There will be no further questions. The remainder of the procedure
should take a few minutes, to copy the databases from ellington.
Transferring netgroup...
ypxfr: Exiting: Map successfully transferred
Transferring netgroup.byuser...
ypxfr: Exiting: Map successfully transferred
Transferring netgroup.byhost...
ypxfr: Exiting: Map successfully transferred
Transferring master.passwd.byuid...
ypxfr: Exiting: Map successfully transferred
Transferring passwd.byuid...
ypxfr: Exiting: Map successfully transferred
Transferring passwd.byname...
ypxfr: Exiting: Map successfully transferred
Transferring group.bygid...
ypxfr: Exiting: Map successfully transferred
Transferring group.byname...
ypxfr: Exiting: Map successfully transferred
Transferring services.byname...
ypxfr: Exiting: Map successfully transferred
Transferring rpc.bynumber...
ypxfr: Exiting: Map successfully transferred
Transferring rpc.byname...
ypxfr: Exiting: Map successfully transferred
Transferring protocols.byname...
ypxfr: Exiting: Map successfully transferred
Transferring master.passwd.byname...
ypxfr: Exiting: Map successfully transferred
Transferring networks.byname...
ypxfr: Exiting: Map successfully transferred
Transferring networks.byaddr...
ypxfr: Exiting: Map successfully transferred
Transferring netid.byname...
ypxfr: Exiting: Map successfully transferred
Transferring hosts.byaddr...
ypxfr: Exiting: Map successfully transferred
Transferring protocols.bynumber...
ypxfr: Exiting: Map successfully transferred
Transferring ypservers...
ypxfr: Exiting: Map successfully transferred
Transferring hosts.byname...
ypxfr: Exiting: Map successfully transferred

coltrane has been setup as an YP slave server without any errors.
Don&#39;</span>t forget to update map ypservers on ellington.</code></pre></div></div><div class=paragraph><p>Теперь у вас должен быть каталог с именем <span class=filename>/var/yp/test-domain</span>. Копии карт главного сервера NIS должны быть в этом каталоге. Вы должны удостовериться, что этот каталог обновляется. Следующие строки в <span class=filename>/etc/crontab</span> вашего вторичного сервера должны это делать:</p></div><div class="literalblock programlisting"><div class=content><pre>20	*	*	*	*	root   /usr/libexec/ypxfr passwd.byname
21	*	*	*	*	root   /usr/libexec/ypxfr passwd.byuid</pre></div></div><div class=paragraph><p>Эти две строки заставляют вторичный сервер синхронизировать свои карты с картами главного сервера. Эти строки не являются обязательными, так как главный сервер автоматически пытается передать вторичным серверам все изменения в своих картах NIS. Однако, учитывая важность информации о паролях для клиентов, зависящих от вторичного сервера, рекомендуется выполнять частые обновления карт с паролями. Это особенно важно в загруженных сетях, в которых обновления карт могут не всегда завершаться успешно.</p></div><div class=paragraph><p>А теперь точно также запустите команду <code>/etc/netstart</code> на вторичном сервере, по которой снова выполнится запуск сервера NIS.</p></div></div></div><div class=sect3><h4 id=_клиенты_nis>25.4.4.3. Клиенты NIS<a class=anchor href=#_клиенты_nis></a></h4><div class=paragraph><p>Клиент NIS выполняет так называемую привязку к конкретному серверу NIS при помощи даемона <code>ypbind</code>. <code>ypbind</code> определяет домен, используемый в системе по умолчанию (тот, который устанавливается по команде <code>domainname</code>), и начинает широковещательную рассылку запросов RPC в локальной сети. В этих запросах указано имя домена, к серверу которого <code>ypbind</code> пытается осуществить привязку. Если сервер, который был настроен для обслуживания запрашиваемого домена, получит широковещательный запрос, он ответит <code>ypbind</code>, который, в свою очередь запомнит адрес сервера. Если имеется несколько серверов (например, главный и несколько вторичных), то <code>ypbind</code> будет использовать адрес первого ответившего. С этого момента клиентская система будет направлять все свои запросы NIS на этот сервер. Время от времени <code>ypbind</code> будет "пинать" сервер для проверки его работоспособности. Если на один из тестовых пакетов не удастся получить ответа за разумное время, то <code>ypbind</code> пометит этот домен как домен, с которым связка разорвана, и снова начнет процесс посылки широковещательных запросов в надежде найти другой сервер.</p></div><div class=sect4><h5 id=_настройка_клиента_nis>25.4.4.3.1. Настройка клиента NIS<a class=anchor href=#_настройка_клиента_nis></a></h5><div class=paragraph><p>Настройка машины с FreeBSD в качестве клиента NIS достаточно проста.</p></div><div class="exampleblock procedure"><div class=content><div class="olist arabic"><ol class=arabic><li><p>Отредактируйте файл <span class=filename>/etc/rc.conf</span>, добавив туда следующие строки для того, чтобы задать имя домена NIS и запустить <code>ypbind</code> во время запуска сетевых служб:</p><div class="literalblock programlisting"><div class=content><pre>nisdomainname=&#34;test-domain&#34;
nis_client_enable=&#34;YES&#34;</pre></div></div></li><li><p>Для импортирования всех возможных учётных записей от сервера NIS, удалите все записи пользователей из вашего файла <span class=filename>/etc/master.passwd</span> и воспользуйтесь командой <code>vipw</code> для добавления следующей строки в конец файла:</p><div class="literalblock programlisting"><div class=content><pre>+:::::::::</pre></div></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Эта строчка даст всем пользователям с корректной учетной записью в картах учетных баз пользователей доступ к этой системе. Есть множество способов настроить ваш клиент NIS, изменив эту строку. Посмотрите ниже текст, касающийся <a href=#network-netgroups>сетевых групп</a>, чтобы получить более подробную информацию. Дополнительная информация для изучения находится в книге издательства O’Reilly под названием <code>Managing NFS and NIS</code>.</p></div></td></tr></tbody></table></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Вы должны оставить хотя бы одну локальную запись (то есть не импортировать ее через NIS) в вашем <span class=filename>/etc/master.passwd</span> и эта запись должна быть также членом группы <code>wheel</code>. Если с NIS что-то случится, эта запись может использоваться для удаленного входа в систему, перехода в режим администратора и исправления неисправностей.</p></div></td></tr></tbody></table></div></li><li><p>Для импортирования всех возможных записей о группах с сервера NIS, добавьте в ваш файл <span class=filename>/etc/group</span> такую строчку:</p><div class="literalblock programlisting"><div class=content><pre>+:*::</pre></div></div></li></ol></div></div></div><div class=paragraph><p>Для немедленного запуска клиента NIS выполните следующую команду с правами пользователя <code>root</code>:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># /etc/netstart</span>
<span class=c># /etc/rc.d/ypbind start</span></code></pre></div></div><div class=paragraph><p>После завершения выполнения этих шагов у вас должно получиться запустить команду <code>ypcat passwd</code> и увидеть карту учетных записей сервера NIS.</p></div></div></div></div><div class=sect2><h3 id=_безопасность_nis>25.4.5. Безопасность NIS<a class=anchor href=#_безопасность_nis></a></h3><div class=paragraph><p>В общем-то любой пользователь, зная имя вашего домена, может выполнить запрос RPC к <a href="https://man.freebsd.org/cgi/man.cgi?query=ypserv&amp;sektion=8&amp;format=html">ypserv(8)</a> и получить содержимое ваших карт NIS. Для предотвращения такого неавторизованного обмена <a href="https://man.freebsd.org/cgi/man.cgi?query=ypserv&amp;sektion=8&amp;format=html">ypserv(8)</a> поддерживает так называемую систему "securenets", которая может использоваться для ограничения доступа к некоторой группе хостов. При запуске <a href="https://man.freebsd.org/cgi/man.cgi?query=ypserv&amp;sektion=8&amp;format=html">ypserv(8)</a> будет пытаться загрузить информацию, касающуюся securenets, из файла <span class=filename>/var/yp/securenets</span>.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Имя каталога зависит от параметра, указанного вместе с опцией <code>-p</code>. Этот файл содержит записи, состоящие из указания сети и сетевой маски, разделенных пробелом. Строчки, начинающиеся со знака "#", считаются комментариями. Примерный файл securenets может иметь примерно такой вид:</p></div></td></tr></tbody></table></div><div class="literalblock programlisting"><div class=content><pre># allow connections from local host -- mandatory
127.0.0.1     255.255.255.255
# allow connections from any host
# on the 192.168.128.0 network
192.168.128.0 255.255.255.0
# allow connections from any host
# between 10.0.0.0 to 10.0.15.255
# this includes the machines in the testlab
10.0.0.0      255.255.240.0</pre></div></div><div class=paragraph><p>Если <a href="https://man.freebsd.org/cgi/man.cgi?query=ypserv&amp;sektion=8&amp;format=html">ypserv(8)</a> получает запрос от адреса, который соответствует одному из этих правил, он будет отрабатывать запрос обычным образом. Если же адрес не подпадает ни под одно правило, запрос будет проигнорирован и в журнал будет записано предупреждающее сообщение. Если файл <span class=filename>/var/yp/securenets</span> не существует, <code>ypserv</code> будет обслуживать соединения от любого хоста.</p></div><div class=paragraph><p>Программа <code>ypserv</code> также поддерживает пакет программ TCP Wrapper от Wietse Venema. Это позволяет администратору для ограничения доступа вместо <span class=filename>/var/yp/securenets</span> использовать конфигурационные файлы TCP Wrapper.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Хотя оба этих метода управления доступом обеспечивают некоторую безопасность, они, как основанные на проверке привилегированного порта, оба подвержены атакам типа "IP spoofing". Весь сетевой трафик, связанный с работой NIS, должен блокироваться вашим брандмауэром.</p></div><div class=paragraph><p>Серверы, использующие файл <span class=filename>/var/yp/securenets</span>, могут быть не в состоянии обслуживать старых клиентов NIS с древней реализацией протокола TCP/IP. Некоторые из этих реализаций при рассылке широковещательных запросов устанавливают все биты машинной части адреса в ноль и/или не в состоянии определить маску подсети при вычислении адреса широковещательной рассылки. Хотя некоторые из этих проблем могут быть решены изменением конфигурации клиента, другие могут привести к отказу от использования <span class=filename>/var/yp/securenets</span>.</p></div><div class=paragraph><p>Использование <span class=filename>/var/yp/securenets</span> на сервере с такой архаичной реализацией TCP/IP является весьма плохой идеей, и приведёт к потере работоспособности NIS в большой части вашей сети.</p></div><div class=paragraph><p>Использование пакета TCP Wrapper увеличит время отклика вашего сервера NIS. Дополнительной задержки может оказаться достаточно для возникновения тайм-аутов в клиентских программах, особенно в загруженных сетях или с медленными серверами NIS. Если одна или более ваших клиентских систем страдают от таких проблем, вы должны преобразовать такие клиентские системы во вторичные серверы NIS и сделать принудительную их привязку к самим себе.</p></div></td></tr></tbody></table></div></div><div class=sect2><h3 id=_запрет_входа_некоторых_пользователей>25.4.6. Запрет входа некоторых пользователей<a class=anchor href=#_запрет_входа_некоторых_пользователей></a></h3><div class=paragraph><p>В нашей лаборатории есть машина <code>basie</code>, о которой предполагается, что она является исключительно факультетской рабочей станцией. Мы не хотим исключать эту машину из домена NIS, однако файл <span class=filename>passwd</span> на главном сервере NIS содержит учетные записи как для работников факультета, так и студентов. Что мы можем сделать?</p></div><div class=paragraph><p>Есть способ ограничить вход некоторых пользователей на этой машине, даже если они присутствуют в базе данных NIS. Чтобы это сделать, вам достаточно добавить <code>-<em>username</em></code> в конец файла <span class=filename>/etc/master.passwd</span> на клиентской машине, где <em>username</em> является именем пользователя, которому вы хотите запретить вход. Рекомендуется сделать это с помощью утилиты <code>vipw</code>, так как <code>vipw</code> проверит ваши изменения в <span class=filename>/etc/master.passwd</span>, а также автоматически перестроит базу данных паролей по окончании редактирования. Например, если мы хотим запретить пользователю <code>bill</code> осуществлять вход на машине <code>basie</code>, то мы сделаем следующее:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>basie# vipw
<span class=o>[</span>add <span class=nt>-bill</span> to the end, <span class=nb>exit</span><span class=o>]</span>
vipw: rebuilding the database...
vipw: <span class=k>done

</span>basie# <span class=nb>cat</span> /etc/master.passwd

root:[password]:0:0::0:0:The super-user:/root:/bin/csh
toor:[password]:0:0::0:0:The other super-user:/root:/bin/sh
daemon:<span class=k>*</span>:1:1::0:0:Owner of many system processes:/root:/sbin/nologin
operator:<span class=k>*</span>:2:5::0:0:System &amp;:/:/sbin/nologin
bin:<span class=k>*</span>:3:7::0:0:Binaries Commands and Source,,,:/:/sbin/nologin
<span class=nb>tty</span>:<span class=k>*</span>:4:65533::0:0:Tty Sandbox:/:/sbin/nologin
kmem:<span class=k>*</span>:5:65533::0:0:KMem Sandbox:/:/sbin/nologin
games:<span class=k>*</span>:7:13::0:0:Games pseudo-user:/usr/games:/sbin/nologin
news:<span class=k>*</span>:8:8::0:0:News Subsystem:/:/sbin/nologin
man:<span class=k>*</span>:9:9::0:0:Mister Man Pages:/usr/shared/man:/sbin/nologin
<span class=nb>bind</span>:<span class=k>*</span>:53:53::0:0:Bind Sandbox:/:/sbin/nologin
uucp:<span class=k>*</span>:66:66::0:0:UUCP pseudo-user:/var/spool/uucppublic:/usr/libexec/uucp/uucico
xten:<span class=k>*</span>:67:67::0:0:X-10 daemon:/usr/local/xten:/sbin/nologin
pop:<span class=k>*</span>:68:6::0:0:Post Office Owner:/nonexistent:/sbin/nologin
nobody:<span class=k>*</span>:65534:65534::0:0:Unprivileged user:/nonexistent:/sbin/nologin
+:::::::::
<span class=nt>-bill</span>

basie#</code></pre></div></div></div><div class=sect2><h3 id=network-netgroups>25.4.7. Использование сетевых групп<a class=anchor href=#network-netgroups></a></h3><div class=paragraph><p>Способ, описанный в предыдущем разделе, работает достаточно хорошо, если вам нужны особые правила для очень малой группы пользователей или машин. В более крупных сетях вы <em>забудете</em> о запрете входа определенных пользователей на важные машины или даже будете настраивать каждую машину по отдельности, теряя таким образом главное преимущество использования NIS: <em>централизованное</em> администрирование.</p></div><div class=paragraph><p>Ответом разработчиков NIS на эту проблему являются <em>сетевые группы</em>. Их назначение и смысл можно сравнить с обычными группами, используемыми в файловых системах UNIX®. Главное отличие заключается в отсутствии числового идентификатора и возможности задать сетевую группу включением как пользователей, так и других сетевых групп.</p></div><div class=paragraph><p>Сетевые группы были разработаны для работы с большими, сложными сетями с сотнями пользователей и машин. С одной стороны, хорошо, если вам приходится с такой ситуацией. С другой стороны, эта сложность делает невозможным описание сетевых групп с помощью простых примеров. Пример, используемый в дальнейшем, демонстрирует эту проблему.</p></div><div class=paragraph><p>Давайте предположим, что успешное внедрение системы NIS в вашей лаборатории заинтересовало ваше руководство. Вашим следующим заданием стало расширение домена NIS для включения в него некоторых других машин студенческого городка. В двух таблицах перечислены имена новых машин и пользователей, а также их краткое описание.</p></div><table class="tableblock frame-none grid-all stretch informaltable"><col style=width:50%><col style=width:50%><thead><tr><th class="tableblock halign-left valign-top">Имена пользователей</th><th class="tableblock halign-left valign-top">Описание</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>alpha</code>, <code>beta</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Обычные служащие IT-департамента</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>charlie</code>, <code>delta</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Практиканты IT-департамента</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>echo</code>, <code>foxtrott</code>, <code>golf</code>, …​</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Обычные сотрудники</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>able</code>, <code>baker</code>, …​</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Проходящие интернатуру</p></td></tr></tbody></table><table class="tableblock frame-none grid-all stretch informaltable"><col style=width:50%><col style=width:50%><thead><tr><th class="tableblock halign-left valign-top">Имена машин</th><th class="tableblock halign-left valign-top">Описание</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>war</code>, <code>death</code>, <code>famine</code>, <code>pollution</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Ваши самые важные серверы. Только служащим IT позволяется входить на эти машины.</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>pride</code>, <code>greed</code>, <code>envy</code>, <code>wrath</code>, <code>lust</code>, <code>sloth</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Менее важные серверы. Все сотрудники департамента IT могут входить на эти машины.</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>one</code>, <code>two</code>, <code>three</code>, <code>four</code>, …​</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Обычные рабочие станции. Только <em>реально нанятым</em> служащим позволяется использовать эти машины.</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>trashcan</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Очень старая машина без каких-либо критичных данных. Даже проходящим интернатуру разрешено ее использовать.</p></td></tr></tbody></table><div class=paragraph><p>Если вы попытаетесь реализовать эти требования, ограничивая каждого пользователя по отдельности, то вам придется добавить на каждой машине в файл <span class=filename>passwd</span> по одной строчке <code>-<em>user</em></code> для каждого пользователя, которому запрещено входить на эту систему. Если вы забудете даже одну строчку, у вас могут начаться проблемы. Гораздо проще делать это правильно во время начальной установки, однако вы постепенно <em>будете забывать</em> добавлять строчки для новых пользователей во время повседневной работы. В конце концов, Мерфи был оптимистом.</p></div><div class=paragraph><p>Использование в этой ситуации сетевых групп дает несколько преимуществ. Нет необходимости описывать по отдельности каждого пользователя; вы ставите в соответствие пользователю одну или несколько сетевых групп и разрешаете или запрещаете вход всем членам сетевой группы. Если вы добавляете новую машину, вам достаточно определить ограничения на вход для сетевых групп. Если добавляется новый пользователь, вам достаточно добавить его к одной или большему числу сетевых групп. Эти изменения независимы друг от друга: нет больше комбинаций "для каждого пользователя и машины". Если настройка вашей системы NIS тщательно спланирована, то для разрешения или запрещения доступа к машинам вам нужно будет модифицировать единственный конфигурационный файл.</p></div><div class=paragraph><p>Первым шагом является инициализация карты NIS по имени netgroup. Программа <a href="https://man.freebsd.org/cgi/man.cgi?query=ypinit&amp;sektion=8&amp;format=html">ypinit(8)</a> во FreeBSD по умолчанию этой карты не создаёт, хотя реализация NIS будет её поддерживает, как только она будет создана. Чтобы создать пустую карту, просто наберите</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>ellington# vi /var/yp/netgroup</code></pre></div></div><div class=paragraph><p>и начните добавлять содержимое. Например, нам нужно по крайней мере четыре сетевых группы: сотрудники IT, практиканты IT, обычные сотрудники и интернатура.</p></div><div class="literalblock programlisting"><div class=content><pre>IT_EMP	(,alpha,test-domain)	(,beta,test-domain)
IT_APP	(,charlie,test-domain)	(,delta,test-domain)
USERS	(,echo,test-domain)	(,foxtrott,test-domain) \
	(,golf,test-domain)
INTERNS (,able,test-domain)	(,baker,test-domain)</pre></div></div><div class=paragraph><p><code>IT_EMP</code>, <code>IT_APP</code> и так далее являются именами сетевых групп. Несколько слов в скобках служат для добавления пользователей в группу. Три поля внутри группы обозначают следующее:</p></div><div class="olist arabic"><ol class=arabic><li><p>Имя хоста или хостов, к которым применимы последующие записи. Если имя хоста не указано, то запись применяется ко всем хостам. Если же указывается имя хоста, то вы получите мир темноты, ужаса и страшной путаницы.</p></li><li><p>Имя учетной записи, которая принадлежит этой сетевой группе.</p></li><li><p>Домен NIS для учетной записи. Вы можете импортировать в вашу сетевую группу учетные записи из других доменов NIS, если вы один из тех несчастных, имеющих более одного домена NIS.</p></li></ol></div><div class=paragraph><p>Каждое из этих полей может содержать шаблоны, подробности даны в странице справочника по <a href="https://man.freebsd.org/cgi/man.cgi?query=netgroup&amp;sektion=5&amp;format=html">netgroup(5)</a>.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Не нужно использовать имена сетевых групп длиннее 8 символов, особенно если в вашем домене NIS имеются машины, работающие под управлением других операционных систем. Имена чувствительны к регистру; использование заглавных букв для имен сетевых групп облегчает распознавание пользователей, имен машин и сетевых групп.</p></div><div class=paragraph><p>Некоторые клиенты NIS (отличные от FreeBSD) не могут работать с сетевыми группами, включающими большое количество записей. Например, в некоторых старых версиях SunOS™ возникают проблемы, если сетевая группа содержит более 15 <em>записей</em>. Вы можете обойти это ограничение, создав несколько подгрупп с 15 или меньшим количеством пользователей и настоящую сетевую группу, состоящую из подгрупп:</p></div><div class="literalblock programlisting"><div class=content><pre>BIGGRP1  (,joe1,domain)  (,joe2,domain)  (,joe3,domain) [...]
BIGGRP2  (,joe16,domain)  (,joe17,domain) [...]
BIGGRP3  (,joe31,domain)  (,joe32,domain)
BIGGROUP  BIGGRP1 BIGGRP2 BIGGRP3</pre></div></div><div class=paragraph><p>Вы можете повторить этот процесс, если вам нужно иметь более 225 пользователей в одной сетевой группе.</p></div></td></tr></tbody></table></div><div class=paragraph><p>Активация и распространение вашей карты NIS проста:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>ellington# <span class=nb>cd</span> /var/yp
ellington# make</code></pre></div></div><div class=paragraph><p>Это приведет к созданию трех карт NIS <span class=filename>netgroup</span>, <span class=filename>netgroup.byhost</span> и <span class=filename>netgroup.byuser</span>. Воспользуйтесь утилитой <a href="https://man.freebsd.org/cgi/man.cgi?query=ypcat&amp;sektion=1&amp;format=html">ypcat(1)</a> для проверки доступности ваших новых карт NIS:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>ellington% ypcat <span class=nt>-k</span> netgroup
ellington% ypcat <span class=nt>-k</span> netgroup.byhost
ellington% ypcat <span class=nt>-k</span> netgroup.byuser</code></pre></div></div><div class=paragraph><p>Вывод первой команды должен соответствовать содержимому файла <span class=filename>/var/yp/netgroup</span>. Вторая команда не выведет ничего, если вы не зададите сетевые группы, специфичные для хоста. Третья команда может использоваться пользователем для получения списка сетевых групп.</p></div><div class=paragraph><p>Настройка клиента достаточно проста. Чтобы настроить сервер <code>war</code>, вам достаточно запустить <a href="https://man.freebsd.org/cgi/man.cgi?query=vipw&amp;sektion=8&amp;format=html">vipw(8)</a> и заменить строку</p></div><div class="literalblock programlisting"><div class=content><pre>+:::::::::</pre></div></div><div class=paragraph><p>на</p></div><div class="literalblock programlisting"><div class=content><pre>+@IT_EMP:::::::::</pre></div></div><div class=paragraph><p>Теперь только данные, касающиеся пользователей, определенных в сетевой группе <code>IT_EMP</code>, импортируются в базу паролей машины <code>war</code> и только этим пользователям будет разрешен вход.</p></div><div class=paragraph><p>К сожалению, это ограничение также касается и функции <code>~</code> командного процессора и всех подпрограмм, выполняющих преобразование между именами пользователей и их числовыми ID. Другими словами, команда <code>cd ~<em>user</em></code> работать не будет, команда <code>ls -l</code> будет выдавать числовые идентификаторы вместо имён пользователей, а <code>find . -user joe -print</code> работать откажется, выдавая сообщение <code>No such user</code>. Чтобы это исправить, вам нужно будет выполнить импорт всех записей о пользователях <em>без разрешения на вход на ваши серверы</em>.</p></div><div class=paragraph><p>Это можно сделать, добавив еще одну строку в файл <span class=filename>/etc/master.passwd</span>. Эта строка должна содержать:</p></div><div class=paragraph><p><code>+:::::::::/sbin/nologin</code>, что означает "Произвести импортирование всех записей с заменой командного процессора на <span class=filename>/sbin/nologin</span> в импортируемых записях". Вы можете заменить любое поле в строке с паролем, указав значение по умолчанию в вашем <span class=filename>/etc/master.passwd</span>.</p></div><div class="admonitionblock warning"><table><tbody><tr><td class=icon><i class="fa icon-warning" title=Warning></i></td><td class=content><div class=paragraph><p>Проверьте, что строка <code>:::::::::/sbin/nologin` помещена после `@IT_EMP:::::::::</code>. В противном случае все пользовательские записи, импортированные из NIS, будут иметь <span class=filename>/sbin/nologin</span> в качестве оболочки.</p></div></td></tr></tbody></table></div><div class=paragraph><p>После этого изменения при появлении нового сотрудника IT вам будет достаточно изменять только одну карту NIS. Вы можете применить подобный метод для менее важных серверов, заменяя старую строку <code>+:::::::::</code> в их файлах <span class=filename>/etc/master.passwd</span> на нечто, подобное следующему:</p></div><div class="literalblock programlisting"><div class=content><pre>+@IT_EMP:::::::::
+@IT_APP:::::::::
+:::::::::/sbin/nologin</pre></div></div><div class=paragraph><p>Соответствующие строки для обычных рабочих станций могут иметь такой вид:</p></div><div class="literalblock programlisting"><div class=content><pre>+@IT_EMP:::::::::
+@USERS:::::::::
+:::::::::/sbin/nologin</pre></div></div><div class=paragraph><p>И все было прекрасно до того момента, когда через несколько недель изменилась политика: Департамент IT начал нанимать интернатуру. Интернатуре в IT позволили использовать обычные рабочие станции и менее важные серверы; практикантам позволили входить на главные серверы. Вы создали новую сетевую группу <code>IT_INTERN</code>, добавили в нее новую интернатуру и начали изменять настройки на всех и каждой машине…​ Как говорит старая мудрость: "Ошибки в централизованном планировании приводят к глобальному хаосу".</p></div><div class=paragraph><p>Возможность в NIS создавать сетевые группы из других сетевых групп может использоваться для предотвращения подобных ситуаций. Одним из вариантов является создание сетевых групп на основе ролей. Например, вы можете создать сетевую группу с именем <code>BIGSRV</code> для задания ограничений на вход на важные серверы, другую сетевую группу с именем <code>SMALLSRV</code> для менее важных серверов и третью сетевую группу под названием <code>USERBOX</code> для обычных рабочих станций. Каждая из этих сетевых групп содержит сетевые группы, которым позволено входить на эти машины. Новые записи для вашей карты NIS сетевой группы должны выглядеть таким образом:</p></div><div class="literalblock programlisting"><div class=content><pre>BIGSRV	  IT_EMP  IT_APP
SMALLSRV  IT_EMP  IT_APP  ITINTERN
USERBOX   IT_EMP  ITINTERN USERS</pre></div></div><div class=paragraph><p>Этот метод задания ограничений на вход работает весьма хорошо, если вы можете выделить группы машин с одинаковыми ограничениями. К сожалению, такая ситуация может быть исключением, но не правилом. В большинстве случаев вам нужна возможность определять ограничения на вход индивидуально для каждой машины.</p></div><div class=paragraph><p>Задание сетевых групп в зависимости от машин является другой возможностью, которой можно воспользоваться при изменении политики, описанной выше. При таком развитии событий файл <span class=filename>/etc/master.passwd</span> на каждой машине содержит две строки, начинающиеся с "+". Первая из них добавляет сетевую группу с учётными записями, которым разрешено входить на эту машину, а вторая добавляет все оставшиеся учетные записи с <span class=filename>/sbin/nologin</span> в качестве командного процессора. Хорошей идеей является использование "ИМЕНИ МАШИНЫ" заглавными буквами для имени сетевой группы. Другими словами, строки должны иметь такой вид:</p></div><div class="literalblock programlisting"><div class=content><pre>+@BOXNAME:::::::::
+:::::::::/sbin/nologin</pre></div></div><div class=paragraph><p>Как только вы завершите эту работу для всех ваших машин, вам не нужно будет снова модифицировать локальные версии <span class=filename>/etc/master.passwd</span>. Все будущие изменения могут быть выполнены изменением карты NIS. Вот пример возможной карты сетевой группы для этого случая с некоторыми полезными дополнениями:</p></div><div class="literalblock programlisting"><div class=content><pre># Сначала определяем группы пользователей
IT_EMP	  (,alpha,test-domain)	  (,beta,test-domain)
IT_APP	  (,charlie,test-domain)  (,delta,test-domain)
DEPT1	  (,echo,test-domain)	  (,foxtrott,test-domain)
DEPT2	  (,golf,test-domain)	  (,hotel,test-domain)
DEPT3	  (,india,test-domain)	  (,juliet,test-domain)
ITINTERN  (,kilo,test-domain)	  (,lima,test-domain)
D_INTERNS (,able,test-domain)	  (,baker,test-domain)
#
# Теперь задаем несколько групп на основе ролей
USERS	  DEPT1   DEPT2     DEPT3
BIGSRV	  IT_EMP  IT_APP
SMALLSRV  IT_EMP  IT_APP    ITINTERN
USERBOX   IT_EMP  ITINTERN  USERS
#
# И группы для специальных задач
# Открыть пользователям echo и golf доступ к антивирусной машине
SECURITY  IT_EMP  (,echo,test-domain)  (,golf,test-domain)
#
# Сетевые группы, специфичные для машин
# Наши главные серверы
WAR	  BIGSRV
FAMINE	  BIGSRV
# Пользователю india необходим доступ к этому серверу
POLLUTION  BIGSRV  (,india,test-domain)
#
# Этот очень важен и ему требуются большие ограничения доступа
DEATH	  IT_EMP
#
# Антивирусная машина, упомянутая выше
ONE	  SECURITY
#
# Ограничить машину единственным пользователем
TWO	  (,hotel,test-domain)
# [...далее следуют другие группы]</pre></div></div><div class=paragraph><p>Если вы используете какие-либо базы данных для управления учетными записями ваших пользователей, вы должны смочь создать первую часть карты с помощью инструментов построения отчетов вашей базы данных. В таком случае новые пользователи автоматически получат доступ к машинам.</p></div><div class=paragraph><p>И последнее замечание: Не всегда бывает разумно использовать сетевые группы на основе машин. Если в студенческих лабораториях вы используете несколько десятков или даже сотен одинаковых машин, то вам нужно использовать сетевые группы на основе ролей, а не основе машин, для того, чтобы размеры карты NIS оставались в разумных пределах.</p></div></div><div class=sect2><h3 id=_важные_замечания>25.4.8. Важные замечания<a class=anchor href=#_важные_замечания></a></h3><div class=paragraph><p>Есть некоторые действия, которые нужно будет выполнять по-другому, если вы работаете с NIS.</p></div><div class=ulist><ul><li><p>Каждый раз, когда вы собираетесь добавить пользователя в лаборатории, вы должны добавить его <em>только</em> на главном сервере NIS и <em>обязательно перестроить карты NIS</em>. Если вы забудете сделать это, то новый пользователь не сможет нигде войти, кроме как на главном сервере NIS. Например, если в лаборатории нам нужно добавить нового пользователя <code>jsmith</code>, мы делаем вот что:</p><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># pw useradd jsmith</span>
<span class=c># cd /var/yp</span>
<span class=c># make test-domain</span></code></pre></div></div><div class=paragraph><p>Вместо <code>pw useradd jsmith</code> вы можете также запустить команду <code>adduser jsmith</code>.</p></div></li><li><p><em>Не помещайте административные учетные записи в карты NIS</em>. Вам не нужно распространять административных пользователей и их пароли на машины, которые не должны иметь доступ к таким учётным записям.</p></li><li><p><em>Сделайте главный и вторичные серверы NIS безопасными и минимизируйте их время простоя</em>. Если кто-то либо взломает, либо просто отключит эти машины, то люди без права входа в лабораторию с легкостью получат доступ.</p><div class=paragraph><p>Это основное уязвимое место в любой централизованно администрируемой системе. Если вы не защищаете ваши серверы NIS, вы будете иметь дело с толпой разозлённых пользователей!</p></div></li></ul></div></div><div class=sect2><h3 id=_совместимость_с_nis_v1>25.4.9. Совместимость с NIS v1<a class=anchor href=#_совместимость_с_nis_v1></a></h3><div class=paragraph><p>ypserv из поставки FreeBSD имеет встроенную поддержку для обслуживания клиентов NIS v1. Реализация NIS во FreeBSD использует только протокол NIS v2, хотя другие реализации имеют поддержку протокола v1 для совместимости со старыми системами. Даемоны ypbind, поставляемые с такими системами, будут пытаться осуществить привязку к серверу NIS v1, даже если это им не нужно (и они будут постоянно рассылать широковещательные запросы в поиске такого сервера даже после получения ответа от сервера v2). Отметьте, что хотя имеется поддержка обычных клиентских вызовов, эта версия ypserv не отрабатывает запросы на передачу карт v1; следовательно, она не может использоваться в качестве главного или вторичного серверов вместе с другими серверами NIS, поддерживающими только протокол v1. К счастью, скорее всего, в настоящий момент такие серверы практически не используются.</p></div></div><div class=sect2><h3 id=network-nis-server-is-client>25.4.10. Серверы NIS, которые также являются клиентами NIS<a class=anchor href=#network-nis-server-is-client></a></h3><div class=paragraph><p>Особое внимание следует уделить использованию ypserv в домене со многими серверами, когда серверные машины являются также клиентами NIS. Неплохо бы заставить серверы осуществить привязку к самим себе, запретив рассылку запросов на привязку и возможно, перекрестную привязку друг к другу. Если один сервер выйдет из строя, а другие будут зависеть от него, то в результате могут возникнуть странные ситуации. Постепенно все клиенты попадут в тайм-аут и попытаются привязаться к другим серверам, но полученная задержка может быть значительной, а странности останутся, так как серверы снова могут привязаться друг к другу.</p></div><div class=paragraph><p>Вы можете заставить хост выполнить привязку к конкретному серверу, запустив команду <code>ypbind</code> с флагом <code>-S</code>. Если вы не хотите делать это вручную каждый раз при перезагрузке вашего сервера NIS, то можете добавить в файл <span class=filename>/etc/rc.conf</span> такие строки:</p></div><div class="literalblock programlisting"><div class=content><pre>nis_client_enable=&#34;YES&#34;   # run client stuff as well
nis_client_flags=&#34;-S NIS domain,server&#34;</pre></div></div><div class=paragraph><p>Дополнительную информацию можно найти на странице справки по <a href="https://man.freebsd.org/cgi/man.cgi?query=ypbind&amp;sektion=8&amp;format=html">ypbind(8)</a>.</p></div></div><div class=sect2><h3 id=_форматы_паролей>25.4.11. Форматы паролей<a class=anchor href=#_форматы_паролей></a></h3><div class=paragraph><p>Одним из общих вопросов, которые возникают в начале работы с NIS, является вопрос совместимости форматов паролей. Если ваш сервер NIS использует пароли, зашифрованные алгоритмом DES, то он будет поддерживать только тех клиентов, что также используют DES. К примеру, если в вашей сети имеются клиенты NIS, использующие Solaris™, то вам, скорее всего, необходимо использовать пароли с шифрованием по алгоритму DES.</p></div><div class=paragraph><p>Чтобы понять, какой формат используют ваши серверы и клиенты, загляните в файл <span class=filename>/etc/login.conf</span>. Если хост настроен на использование паролей, зашифрованных по алгоритму DES, то класс <code>default</code> будет содержать запись вроде следующей:</p></div><div class="literalblock programlisting"><div class=content><pre>default:\
	:passwd_format=des:\
	:copyright=/etc/COPYRIGHT:\
	[Последующие строки опущены]</pre></div></div><div class=paragraph><p>Другими возможными значениями для <code>passwd_format</code> являются <code>blf</code> и <code>md5</code> (для паролей, шифруемых по стандартам Blowfish и MD5 соответственно).</p></div><div class=paragraph><p>Если вы внесли изменения в файл <span class=filename>/etc/login.conf</span>, то вам также нужно перестроить базу данных параметров входа в систему, что достигается запуском следующей команды пользователем <code>root</code>:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># cap_mkdb /etc/login.conf</span></code></pre></div></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Формат паролей, которые уже находятся в файле <span class=filename>/etc/master.passwd</span>, не будет изменён до тех пор, пока пользователь не сменит свой пароль <em>после</em> перестроения базы данных параметров входа в систему.</p></div></td></tr></tbody></table></div><div class=paragraph><p>После этого, чтобы удостовериться в том, что пароли зашифрованы в том формате, который выбран вами, нужно проверить, что строка <code>crypt_default</code> в <span class=filename>/etc/auth.conf</span> указывает предпочтение выбранного вами формата паролей. Для этого поместите выбранный формат первым в списке. Например, при использовании DES-шифрования паролей строка будет выглядеть так:</p></div><div class="literalblock programlisting"><div class=content><pre>crypt_default	=	des blf md5</pre></div></div><div class=paragraph><p>Выполнив вышеперечисленные шаги на каждом из серверов и клиентов NIS, работающих на FreeBSD, вы можете обеспечить их согласованность относительно используемого в вашей сети формата паролей. Если у вас возникли проблемы с аутентификацией клиента NIS, начать её решать определённо стоит отсюда. Запомните: если вы хотите использовать сервер NIS в гетерогенной сети, вам, наверное, нужно будет использовать DES на всех системах в силу того, что это минимальный общий стандарт.</p></div></div></div></div><div class=sect1><h2 id=network-dhcp>25.5. Автоматическая настройка сети (DHCP)<a class=anchor href=#network-dhcp></a></h2><div class=sectionbody><div class=sect2><h3 id=_что_такое_dhcp>25.5.1. Что такое DHCP?<a class=anchor href=#_что_такое_dhcp></a></h3><div class=paragraph><p>DHCP, или Dynamic Host Configuration Protocol (Протокол Динамической Конфигурации Хостов), описывает порядок, по которому система может подключиться к сети и получить необходимую информацию для работы в ней. Во FreeBSD используется <code>dhclient</code>, импортированный из OpenBSD 3.7. Вся информация здесь, относительно <code>dhclient</code> относится либо к ISC, либо к DHCP клиентам. DHCP сервер включён в ISC дистрибутив.</p></div></div><div class=sect2><h3 id=_что_описывается_в_этом_разделе>25.5.2. Что описывается в этом разделе<a class=anchor href=#_что_описывается_в_этом_разделе></a></h3><div class=paragraph><p>В этом разделе описываются, как компоненты клиентской части ISC или OpenBSD DHCP клиента, так и компоненты ISC DHCP системы со стороны сервера. Программа, работающая на клиентской стороне, <code>dhclient</code>, интегрирована в поставку FreeBSD, а серверная часть доступна в виде порта <a class=package href=https://cgit.freebsd.org/ports/tree/net/isc-dhcp42-server/>net/isc-dhcp42-server</a>. Кроме ссылок ниже, много полезной информации находится на страницах справочной системы, описывающих <a href="https://man.freebsd.org/cgi/man.cgi?query=dhclient&amp;sektion=8&amp;format=html">dhclient(8)</a>, <a href="https://man.freebsd.org/cgi/man.cgi?query=dhcp-options&amp;sektion=5&amp;format=html">dhcp-options(5)</a> и <a href="https://man.freebsd.org/cgi/man.cgi?query=dhclient.conf&amp;sektion=5&amp;format=html">dhclient.conf(5)</a>.</p></div></div><div class=sect2><h3 id=_как_это_работает_2>25.5.3. Как это работает<a class=anchor href=#_как_это_работает_2></a></h3><div class=paragraph><p>Когда на клиентской машине выполняется программа <code>dhclient</code>, являющаяся клиентом DHCP, она начинает широковещательную рассылку запросов на получение настроечной информации. По умолчанию эти запросы делаются на 68 порт UDP. Сервер отвечает на UDP 67, выдавая клиенту адрес IP и другую необходимую информацию, такую, как сетевую маску, маршрутизатор и серверы DNS. Вся эта информация даётся в форме "аренды" DHCP и верна только определенное время (что настраивается администратором сервера DHCP). При таком подходе устаревшие адреса IP тех клиентов, которые больше не подключены к сети, могут автоматически использоваться повторно.</p></div><div class=paragraph><p>Клиенты DHCP могут получить от сервера очень много информации. Подробный список находится в странице Справочника <a href="https://man.freebsd.org/cgi/man.cgi?query=dhcp-options&amp;sektion=5&amp;format=html">dhcp-options(5)</a>.</p></div></div><div class=sect2><h3 id=_интеграция_с_freebsd>25.5.4. Интеграция с FreeBSD<a class=anchor href=#_интеграция_с_freebsd></a></h3><div class=paragraph><p>DHCP клиент от OpenBSD, <code>dhclient</code>, полностью интегрирован во FreeBSD. Поддержка клиента DHCP есть как в программе установки, так и в самой системе, что исключает необходимость в знании подробностей конфигурации сети в любой сети, имеющей сервер DHCP.</p></div><div class=paragraph><p>DHCP поддерживается утилитой sysinstall. При настройке сетевого интерфейса из программы sysinstall второй вопрос, который вам задается: "Do you want to try DHCP configuration of the interface?" ("Хотите ли вы попробовать настроить этот интерфейс через DHCP?"). Утвердительный ответ приведёт к запуску программы <code>dhclient</code>, и при удачном его выполнении к автоматическому заданию информации для настройки интерфейса.</p></div><div class=paragraph><p>Есть две вещи, которые вы должны сделать для того, чтобы ваша система использовала DHCP при загрузке:</p></div><div class=ulist><ul><li><p>Убедитесь, что устройство <span class=filename>bpf</span> включено в компиляцию вашего ядра. Чтобы это сделать, добавьте строчку <code>device bpf</code> в конфигурационный файл ядра и перестройте ядро. Более подробная информация о построении ядер имеется в <a href=../kernelconfig/#kernelconfig>Настройка ядра FreeBSD</a>.</p><div class=paragraph><p>Устройство <span class=filename>bpf</span> уже является частью ядра <span class=filename>GENERIC</span>, которое поставляется вместе с FreeBSD, так что, если вы не используете другое ядро, то вам и не нужно его делать для того, чтобы работал DHCP.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Те, кто беспокоится о безопасности, должны иметь в виду, что устройство <span class=filename>bpf</span> является также тем самым устройством, которое позволяет работать программам-снифферам пакетов (хотя для этого они должны быть запущены пользователем <code>root</code>). Наличие устройства <span class=filename>bpf</span><em>необходимо</em> для использования DHCP, но если вы чересчур беспокоитесь о безопасности, то вам нельзя добавлять устройство <span class=filename>bpf</span> в ядро только для того, чтобы в неопределённом будущем использовать DHCP.</p></div></td></tr></tbody></table></div></li><li><p>По умолчанию, конфигурирование FreeBSD по протоколу DHCP выполняется фоновым процессом, или <em>асинхронно</em>. Остальные стартовые скрипты продолжают работу не ожидая завершения процесса конфигурирования, тем самым ускоряя загрузку системы.</p><div class=paragraph><p>Фоновое конфигурирование не создает проблем в случае, если сервер DHCP быстро отвечает на запросы, и процесс конфигурирования происходит быстро. Однако, в некоторых случаях настройка по DHCP может длиться значительное время. При этом запуск сетевых сервисов может потерпеть неудачу, если будет произведен ранее завершения конфигурирования по DHCP. Запуск DHCP в <em>синхронном</em> режиме предотвращает проблему, откладывая выполнение остальных стартовых скриптов до момента завершения конфигурирования по DHCP.</p></div><div class=paragraph><p>Для осуществления фонового конфигурирования по DHCP (асинхронный режим), используйте значение “DHCP” в <span class=filename>/etc/rc.conf</span>:</p></div><div class="literalblock programlisting"><div class=content><pre>ifconfig_fxp0=&#34;DHCP&#34;</pre></div></div><div class=paragraph><p>Для откладывания запуска стартовых скриптов до завершения конфигурирования по DHCP (синхронный режим), укажите значение “SYNCDHCP”:</p></div><div class="literalblock programlisting"><div class=content><pre>ifconfig_fxp0=&#34;SYNCDHCP&#34;</pre></div></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Замените используемое в этих примерах имя <em>fxp0</em> на имя интерфейса, который необходимо сконфигурировать динамически, как это описано в <a href=../config/#config-network-setup>Настройка карт сетевых интерфейсов</a>.</p></div></td></tr></tbody></table></div><div class=paragraph><p>Если <code>dhclient</code> в вашей системе находится в другом месте или если вы хотите задать дополнительные параметры для <code>dhclient</code>, то также укажите следующее (изменив так, как вам нужно):</p></div><div class="literalblock programlisting"><div class=content><pre>dhclient_program=&#34;/sbin/dhclient&#34;
dhclient_flags=&#34;&#34;</pre></div></div></li></ul></div><div class=paragraph><p>Сервер DHCP, dhcpd, включён как часть порта <a class=package href=https://cgit.freebsd.org/ports/tree/net/isc-dhcp42-server/>net/isc-dhcp42-server</a> в коллекцию портов. Этот порт содержит DHCP-сервер от ISC и документацию.</p></div></div><div class=sect2><h3 id=_файлы>25.5.5. Файлы<a class=anchor href=#_файлы></a></h3><div class=ulist><ul><li><p><span class=filename>/etc/dhclient.conf</span></p><div class=paragraph><p><code>dhclient</code> требует наличия конфигурационного файла, <span class=filename>/etc/dhclient.conf</span>. Как правило, файл содержит только комментарии, а настройки по умолчанию достаточно хороши. Этот настроечный файл описан на страницах справочной системы по <a href="https://man.freebsd.org/cgi/man.cgi?query=dhclient.conf&amp;sektion=5&amp;format=html">dhclient.conf(5)</a>.</p></div></li><li><p><span class=filename>/sbin/dhclient</span></p><div class=paragraph><p><code>dhclient</code> скомпонован статически и находится в каталоге <span class=filename>/sbin</span>. На страница Справочника <a href="https://man.freebsd.org/cgi/man.cgi?query=dhclient&amp;sektion=8&amp;format=html">dhclient(8)</a> дается более подробная информация о <code>dhclient</code>.</p></div></li><li><p><span class=filename>/sbin/dhclient-script</span></p><div class=paragraph><p><code>dhclient-script</code> является специфичным для FreeBSD скриптом настройки клиента DHCP. Он описан в <a href="https://man.freebsd.org/cgi/man.cgi?query=dhclient-script&amp;sektion=8&amp;format=html">dhclient-script(8)</a>, но для нормального функционирования никаких модификаций со стороны пользователя не требуется.</p></div></li><li><p><span class=filename>/var/db/dhclient.leases</span></p><div class=paragraph><p>В этом файле клиент DHCP хранит базу данных выданных к использованию адресов в виде журнала. На странице <a href="https://man.freebsd.org/cgi/man.cgi?query=dhclient.leases&amp;sektion=5&amp;format=html">dhclient.leases(5)</a> дается гораздо более подробное описание.</p></div></li></ul></div></div><div class=sect2><h3 id=_дополнительная_литература>25.5.6. Дополнительная литература<a class=anchor href=#_дополнительная_литература></a></h3><div class=paragraph><p>Полное описание протокола DHCP дается в <a href=http://www.freesoft.org/CIE/RFC/2131/>RFC 2131</a>. Кроме того, дополнительная информация есть на сервере <a href=http://www.dhcp.org/>http://www.dhcp.org/</a>.</p></div></div><div class=sect2><h3 id=network-dhcp-server>25.5.7. Установка и настройка сервера DHCP<a class=anchor href=#network-dhcp-server></a></h3><div class=sect3><h4 id=_чему_посвящён_этот_раздел>25.5.7.1. Чему посвящён этот раздел<a class=anchor href=#_чему_посвящён_этот_раздел></a></h4><div class=paragraph><p>Этот раздел даёт информацию о том, как настроить систему FreeBSD для работы в качестве сервера DHCP на основе реализации пакета DHCP от ISC (Internet Systems Consortium).</p></div><div class=paragraph><p>Серверная часть пакета не поставляется как часть FreeBSD, так что вам потребуется установить порт <a class=package href=https://cgit.freebsd.org/ports/tree/net/isc-dhcp42-server/>net/isc-dhcp42-server</a> для получения этого сервиса. Обратитесь к <a href=../ports/#ports>Установка приложений. порты и пакеты</a> для получения более полной информации об использовании коллекции портов.</p></div></div><div class=sect3><h4 id=_установка_сервера_dhcp>25.5.7.2. Установка сервера DHCP<a class=anchor href=#_установка_сервера_dhcp></a></h4><div class=paragraph><p>Для того, чтобы настроить систему FreeBSD на работу в качестве сервера DHCP, вам необходимо обеспечить присутствие устройства <a href="https://man.freebsd.org/cgi/man.cgi?query=bpf&amp;sektion=4&amp;format=html">bpf(4)</a>, вкомпилированного в ядро. Для этого добавьте строку <code>device bpf</code> в файл конфигурации вашего ядра. Для получения более полной информации о построении ядер, обратитесь к <a href=../kernelconfig/#kernelconfig>Настройка ядра FreeBSD</a>.</p></div><div class=paragraph><p>Устройство <span class=filename>bpf</span> уже входит в состав ядра <span class=filename>GENERIC</span>, поставляемого с FreeBSD, так что вам не нужно создавать собственное ядро для обеспечения работы DHCP.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Те, кто обращает особое внимание на вопросы безопасности, должны заметить, что <span class=filename>bpf</span> является тем устройством, что позволяет нормально работать снифферам пакетов (хотя таким программам требуются привилегированный доступ). Наличие устройства <span class=filename>bpf</span><em>обязательно</em> для использования DHCP, но если вы очень обеспокоены безопасностью, наверное, вам не нужно включать <span class=filename>bpf</span> в ваше ядро только потому, что в отдалённом будущем вы собираетесь использовать DHCP.</p></div></td></tr></tbody></table></div><div class=paragraph><p>Следующим действием, которое вам нужно выполнить, является редактирование примерного <span class=filename>dhcpd.conf</span>, который устанавливается в составе порта <a class=package href=https://cgit.freebsd.org/ports/tree/net/isc-dhcp42-server/>net/isc-dhcp42-server</a>. По умолчанию это файл <span class=filename>/usr/local/etc/dhcpd.conf.sample</span>, и вы должны скопировать его в файл <span class=filename>/usr/local/etc/dhcpd.conf</span> перед тем, как его редактировать.</p></div></div><div class=sect3><h4 id=_настройка_сервера_dhcp>25.5.7.3. Настройка сервера DHCP<a class=anchor href=#_настройка_сервера_dhcp></a></h4><div class=paragraph><p><span class=filename>dhcpd.conf</span> состоит из деклараций относительно подсетей и хостов, и проще всего описывается на примере:</p></div><div class="literalblock programlisting"><div class=content><pre>option domain-name &#34;example.com&#34;;<i class=conum data-value=1></i><b>(1)</b>
option domain-name-servers 192.168.4.100;<i class=conum data-value=2></i><b>(2)</b>
option subnet-mask 255.255.255.0;<i class=conum data-value=3></i><b>(3)</b>

default-lease-time 3600;<i class=conum data-value=4></i><b>(4)</b>
max-lease-time 86400;<i class=conum data-value=5></i><b>(5)</b>
ddns-update-style none;<i class=conum data-value=6></i><b>(6)</b>

subnet 192.168.4.0 netmask 255.255.255.0 {
  range 192.168.4.129 192.168.4.254;<i class=conum data-value=7></i><b>(7)</b>
  option routers 192.168.4.1;<i class=conum data-value=8></i><b>(8)</b>
}

host mailhost {
  hardware ethernet 02:03:04:05:06:07;<i class=conum data-value=9></i><b>(9)</b>
  fixed-address mailhost.example.com;<i class=conum data-value=10></i><b>(10)</b>
}</pre></div></div><div class="colist arabic"><table><tbody><tr><td><i class=conum data-value=1></i><b>1</b></td><td>Этот параметр задаёт домен, который будет выдаваться клиентам в качестве домена, используемого по умолчанию при поиске. Обратитесь к страницам справочной системы по <a href="https://man.freebsd.org/cgi/man.cgi?query=resolv.conf&amp;sektion=5&amp;format=html">resolv.conf(5)</a> для получения дополнительной информации о том, что это значит.</td></tr><tr><td><i class=conum data-value=2></i><b>2</b></td><td>Этот параметр задаёт список разделённых запятыми серверов DNS, которые должен использовать клиент.</td></tr><tr><td><i class=conum data-value=3></i><b>3</b></td><td>Маска сети, которая будет выдаваться клиентам.</td></tr><tr><td><i class=conum data-value=4></i><b>4</b></td><td>Клиент может запросить определённое время, которое будет действовать выданная информация. В противном случае сервер выдаст настройки с этим сроком (в секундах).</td></tr><tr><td><i class=conum data-value=5></i><b>5</b></td><td>Это максимальное время, на которое сервер будет выдавать конфигурацию. Если клиент запросит больший срок, он будет подтверждён, но будет действовать только <code>max-lease-time</code> секунд.</td></tr><tr><td><i class=conum data-value=6></i><b>6</b></td><td>Этот параметр задаёт, будет ли сервер DHCP пытаться обновить DNS при выдаче или освобождении конфигурационной информации. В реализации ISC этот параметр является <em>обязательным</em>.</td></tr><tr><td><i class=conum data-value=7></i><b>7</b></td><td>Это определение того, какие IP-адреса должны использоваться в качестве резерва для выдачи клиентам. IP-адреса между и включая границы, будут выдаваться клиентам.</td></tr><tr><td><i class=conum data-value=8></i><b>8</b></td><td>Объявление маршрутизатора, используемого по умолчанию, который будет выдаваться клиентам.</td></tr><tr><td><i class=conum data-value=9></i><b>9</b></td><td>Аппаратный MAC-адрес хоста (чтобы сервер DHCP мог распознать хост, когда тот делает запрос).</td></tr><tr><td><i class=conum data-value=10></i><b>10</b></td><td>Определение того, что хосту всегда будет выдаваться один и тот же IP-адрес. Заметьте, что указание здесь имени хоста корректно, так как сервер DHCP будет разрешать имя хоста самостоятельно до того, как выдать конфигурационную информацию.</td></tr></tbody></table></div><div class=paragraph><p>Когда вы закончите составлять свой <span class=filename>dhcpd.conf</span>, нужно разрешить запуск сервера DHCP в файле <span class=filename>/etc/rc.conf</span>, добавив в него строки</p></div><div class="literalblock programlisting"><div class=content><pre>dhcpd_enable=&#34;YES&#34;
dhcpd_ifaces=&#34;dc0&#34;</pre></div></div><div class=paragraph><p>Замените <code>dc0</code> именем интерфейса (или именами интерфейсов, разделяя их пробелами), на котором(ых) сервер DHCP должен принимать запросы от клиентов.</p></div><div class=paragraph><p>Затем вы можете стартовать сервер DHCP при помощи команды</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># /usr/local/etc/rc.d/isc-dhcpd start</span></code></pre></div></div><div class=paragraph><p>Если в будущем вам понадобится сделать изменения в настройке вашего сервера, то важно заметить, что посылка сигнала <code>SIGHUP</code> приложению dhcpd_не приведёт_ к перезагрузке настроек, как это бывает для большинства даемонов. Вам нужно послать сигнал <code>SIGTERM</code> для остановки процесса, а затем перезапустить его при помощи вышеприведённой команды.</p></div></div><div class=sect3><h4 id=_файлы_2>25.5.7.4. Файлы<a class=anchor href=#_файлы_2></a></h4><div class=ulist><ul><li><p><span class=filename>/usr/local/sbin/dhcpd</span></p><div class=paragraph><p>dhcpd скомпонован статически и расположен в каталоге <span class=filename>/usr/local/sbin</span>. Страницы справочной системы <a href="https://man.freebsd.org/cgi/man.cgi?query=dhcpd&amp;sektion=8&amp;format=html">dhcpd(8)</a>, устанавливаемые портом, содержат более полную информацию о dhcpd.</p></div></li><li><p><span class=filename>/usr/local/etc/dhcpd.conf</span></p><div class=paragraph><p>dhcpd требует наличия конфигурационного файла, <span class=filename>/usr/local/etc/dhcpd.conf</span>, до того, как он будет запущен и начнёт предоставлять сервис клиентам. Необходимо, чтобы этот файл содержал все данные, которая будет выдаваться обслуживаемым клиентам, а также информацию о работе сервера. Этот конфигурационный файл описывается на страницах справочной системы <a href="https://man.freebsd.org/cgi/man.cgi?query=dhcpd.conf&amp;sektion=5&amp;format=html">dhcpd.conf(5)</a>, которые устанавливаются портом.</p></div></li><li><p><span class=filename>/var/db/dhcpd.leases</span></p><div class=paragraph><p>Сервер DHCP ведёт базу данных выданной информации в этом файле, который записывается в виде протокола. Страницы справочной системы <a href="https://man.freebsd.org/cgi/man.cgi?query=dhcpd.leases&amp;sektion=5&amp;format=html">dhcpd.leases(5)</a>, устанавливаемые портом, дают гораздо более подробное описание.</p></div></li><li><p><span class=filename>/usr/local/sbin/dhcrelay</span></p><div class=paragraph><p>dhcrelay используется в сложных ситуациях, когда сервер DHCP пересылает запросы от клиента другому серверу DHCP в отдельной сети. Если вам нужна такая функциональность, то установите порт <a class=package href=https://cgit.freebsd.org/ports/tree/net/isc-dhcp42-relay/>net/isc-dhcp42-relay</a>. На страницах справочной системы <a href="https://man.freebsd.org/cgi/man.cgi?query=dhcrelay&amp;sektion=8&amp;format=html">dhcrelay(8)</a>, которые устанавливаются портом, даётся более полное описание.</p></div></li></ul></div></div></div></div></div><div class=sect1><h2 id=network-dns>25.6. Domain Name System (DNS)<a class=anchor href=#network-dns></a></h2><div class=sectionbody><div class=sect2><h3 id=_обзор>25.6.1. Обзор<a class=anchor href=#_обзор></a></h3><div class=paragraph><p>По умолчанию во FreeBSD используется одна из версий программы BIND (Berkeley Internet Name Domain), являющейся самой распространенной реализацией протокола DNS. DNS - это протокол, при помощи которого имена преобразуются в IP-адреса и наоборот. Например, в ответ на запрос о <code>www.FreeBSD.org</code> будет получен IP-адрес веб-сервера Проекта FreeBSD, а запрос о <code>ftp.FreeBSD.org</code> возвратит IP-адрес соответствующей машины с FTP-сервером. Точно также происходит и обратный процесс. Запрос, содержащий IP-адрес машины, возвратит имя хоста. Для выполнения запросов к DNS вовсе не обязательно иметь в системе работающий сервер имён.</p></div><div class=paragraph><p>FreeBSD в настоящее время поставляется с сервером DNSBIND9, предоставляющим расширенные настройки безопасности, новую схему расположения файлов конфигурации и автоматические настройки для <a href="https://man.freebsd.org/cgi/man.cgi?query=chroot&amp;sektion=8&amp;format=html">chroot(8)</a>.</p></div><div class=paragraph><p>В сети Интернет DNS управляется через достаточно сложную систему авторизированных корневых серверов имён, серверов доменов первого уровня (Top Level Domain, TLD) и других менее крупных серверов имён, которые содержат и кэшируют информацию о конкретных доменах.</p></div><div class=paragraph><p>На данный момент пакет BIND поддерживается Internet Systems Consortium <a href=https://www.isc.org/>https://www.isc.org/</a>.</p></div></div><div class=sect2><h3 id=_используемая_терминология>25.6.2. Используемая терминология<a class=anchor href=#_используемая_терминология></a></h3><div class=paragraph><p>Для понимания этого документа нужно понимать значения некоторых терминов, связанных с работой DNS.</p></div><table class="tableblock frame-none grid-all stretch informaltable"><col style=width:50%><col style=width:50%><thead><tr><th class="tableblock halign-left valign-top">Термин</th><th class="tableblock halign-left valign-top">Определение</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class=tableblock>Прямой запрос к DNS (forward DNS)</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Преобразование имён хостов в адреса IP</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>Ориджин (origin)</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Обозначает домен, покрываемый конкретным файлом зоны</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>named, bind</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Общеупотребительные названия для обозначения пакета BIND, обеспечивающего работу сервера имён во FreeBSD.</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>Резолвер</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Системный процесс, посредством которого машина обращается к серверу имён для получения информации о зоне</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>Обратный DNS (reverse DNS)</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Преобразование адресов IP в имена хостов</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>Корневая зона</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Начало иерархии зон Интернет. Все зоны находятся под корневой зоной, подобно тому, как все файлы располагаются ниже корневого каталога.</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>Зона</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Отдельный домен, поддомен или часть DNS, управляемая одним сервером.</p></td></tr></tbody></table><div class=paragraph><p>Примеры зон:</p></div><div class=ulist><ul><li><p><code>.</code> - так обычно обозначается в документации корневая зона.</p></li><li><p><code>org.</code> - домен верхнего уровня (TLD) в корневой зоне.</p></li><li><p><code>example.org.</code> является зоной в домене верхнего уровня (TLD) <code>org.</code>.</p></li><li><p><code>1.168.192.in-addr.arpa</code> является зоной, в которую включены все IP-адреса, формирующие пространство адресов <code>192.168.1.*</code>.</p></li></ul></div><div class=paragraph><p>Как можно видеть, уточняющая часть имени хоста появляется слева. Например, <code>example.org.</code> более точен, чем <code>org.</code>, также, как <code>org.</code> более точен, чем корневая зона. Расположение каждой части имени хоста сильно похоже на файловую систему: каталог <span class=filename>/dev</span> расположен в корневой файловой системе, и так далее.</p></div></div><div class=sect2><h3 id=_причины_по_которым_вам_может_понадобиться_сервер_имён>25.6.3. Причины, по которым вам может понадобиться сервер имён<a class=anchor href=#_причины_по_которым_вам_может_понадобиться_сервер_имён></a></h3><div class=paragraph><p>Сервера имён обычно используются в двух видах: авторитетный сервер имён и кэширующий сервер имён, также называемый распознавателем (resolver).</p></div><div class=paragraph><p>Авторитетный сервер имён нужен, когда:</p></div><div class=ulist><ul><li><p>нужно предоставлять информацию о DNS остальному миру, отвечая на запросы авторизированно.</p></li><li><p>зарегистрирован домен, такой, как <code>example.org</code> и в этом домене требуется поставить имена машин в соответствие с их адресами IP.</p></li><li><p>блоку адресов IP требуется обратные записи DNS (IP в имена хостов).</p></li><li><p>резервный (slave) сервер имён должен отвечать на запросы.</p></li></ul></div><div class=paragraph><p>Кэширующий сервер имён нужен, когда:</p></div><div class=ulist><ul><li><p>локальный сервер DNS может кэшировать информацию и отвечать на запросы быстрее, чем это происходит при прямом опросе внешнего сервера имён.</p></li></ul></div><div class=paragraph><p>Например, когда кто-нибудь запрашивает информацию о <code>www.FreeBSD.org</code>, то обычно резолвер обращается к серверу имён вашего провайдера, посылает запрос и ожидает ответа. С локальным кэширующим сервером DNS запрос во внешний мир будет делаться всего один раз. Последующие запросы не будут посылаться за пределы локальной сети, потому что информация уже имеется в кэше.</p></div></div><div class=sect2><h3 id=_как_это_работает_3>25.6.4. Как это работает<a class=anchor href=#_как_это_работает_3></a></h3><div class=paragraph><p>Во FreeBSD даемон BIND называется named.</p></div><table class="tableblock frame-none grid-all stretch informaltable"><col style=width:50%><col style=width:50%><thead><tr><th class="tableblock halign-left valign-top">Файл</th><th class="tableblock halign-left valign-top">Описание</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class=tableblock><a href="https://man.freebsd.org/cgi/man.cgi?query=named&amp;sektion=8&amp;format=html">named(8)</a></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Даемон BIND</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><a href="https://man.freebsd.org/cgi/man.cgi?query=rndc&amp;sektion=8&amp;format=html">rndc(8)</a></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Программа управления даемоном сервера имён</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><span class=filename>/etc/namedb</span></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Каталог, в котором располагается вся информация о зонах BIND</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><span class=filename>/etc/namedb/named.conf</span></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Конфигурационный файл для даемона</p></td></tr></tbody></table><div class=paragraph><p>Файлы зон обычно располагаются в каталоге <span class=filename>/etc/namedb</span> и содержат информацию о зоне DNS, за которую отвечает сервер имён.</p></div><div class=paragraph><p>В зависимости от способа конфигурации зоны на сервере файлы зон могут располагаться в подкаталогах <span class=filename>master</span>, <span class=filename>slave</span> или <span class=filename>dynamic</span> иерархии <span class=filename>/etc/namedb</span>. Эти файлы содержат DNS информацию, которую и будет сообщать в ответ на запросы сервер имен.</p></div></div><div class=sect2><h3 id=_запуск_bind>25.6.5. Запуск BIND<a class=anchor href=#_запуск_bind></a></h3><div class=paragraph><p>Так как сервер имён BIND устанавливается по умолчанию, его настройка сравнительно проста.</p></div><div class=paragraph><p>Стандартная конфигурация named запускает простой кэширующий сервер в ограниченной среде <a href="https://man.freebsd.org/cgi/man.cgi?query=chroot&amp;sektion=8&amp;format=html">chroot(8)</a>, который прослушивает запросы на интерфейсе обратной связи (loopback) с адресом (127.0.0.1). Для одноразового запуска даемона в этой конфигурации используйте команду</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># /etc/rc.d/named onestart</span></code></pre></div></div><div class=paragraph><p>Чтобы даемон named запускался во время загрузки, поместите в <span class=filename>/etc/rc.conf</span> следующую строку:</p></div><div class="literalblock programlisting"><div class=content><pre>named_enable=&#34;YES&#34;</pre></div></div><div class=paragraph><p>Разумеется, существует множество различных конфигураций <span class=filename>/etc/namedb/named.conf</span>, лежащих за рамками данного документа. Разнообразные опции запуска named во FreeBSD описаны в переменных <code>named__*_</code> файла <span class=filename>/etc/defaults/rc.conf</span> и странице справочника <a href="https://man.freebsd.org/cgi/man.cgi?query=rc.conf&amp;sektion=5&amp;format=html">rc.conf(5)</a>. Кроме того, полезной может оказаться <a href=../config/#configtuning-rcd>Использование rc во FreeBSD 5.X и последующих версиях</a>.</p></div></div><div class=sect2><h3 id=_конфигурационные_файлы>25.6.6. Конфигурационные файлы<a class=anchor href=#_конфигурационные_файлы></a></h3><div class=paragraph><p>Файлы конфигурации даемона named расположены в каталоге <span class=filename>/etc/namedb</span> и, за исключением случая, когда вам требуется просто резолвер, требуют модификации.</p></div><div class=sect3><h4 id=_etcnamedbnamed_conf>25.6.6.1. <span class=filename>/etc/namedb/named.conf</span><a class=anchor href=#_etcnamedbnamed_conf></a></h4><div class="literalblock programlisting"><div class=content><pre>// $FreeBSD$
//
// If you are going to set up an authoritative server, make sure you
// understand the hairy details of how DNS works.  Even with
// simple mistakes, you can break connectivity for affected parties,
// or cause huge amounts of useless Internet traffic.

options {
	// All file and path names are relative to the chroot directory,
	// if any, and should be fully qualified.
	directory	&#34;/etc/namedb/working&#34;;
	pid-file	&#34;/var/run/named/pid&#34;;
	dump-file	&#34;/var/dump/named_dump.db&#34;;
	statistics-file	&#34;/var/stats/named.stats&#34;;

// If named is being used only as a local resolver, this is a safe default.
// For named to be accessible to the network, comment this option, specify
// the proper IP address, or delete this option.
	listen-on	{ 127.0.0.1; };

// If you have IPv6 enabled on this system, uncomment this option for
// use as a local resolver.  To give access to the network, specify
// an IPv6 address, or the keyword &#34;any&#34;.
//	listen-on-v6	{ ::1; };

// These zones are already covered by the empty zones listed below.
// If you remove the related empty zones below, comment these lines out.
	disable-empty-zone &#34;255.255.255.255.IN-ADDR.ARPA&#34;;
	disable-empty-zone &#34;0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.IP6.ARPA&#34;;
	disable-empty-zone &#34;1.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.IP6.ARPA&#34;;

// If you&#39;ve got a DNS server around at your upstream provider, enter
// its IP address here, and enable the line below.  This will make you
// benefit from its cache, thus reduce overall DNS traffic in the Internet.
/*
	forwarders {
		127.0.0.1;
	};
*/

// If the &#39;forwarders&#39; clause is not empty the default is to &#39;forward first&#39;
// which will fall back to sending a query from your local server if the name
// servers in &#39;forwarders&#39; do not have the answer.  Alternatively you can
// force your name server to never initiate queries of its own by enabling the
// following line:
//	forward only;

// If you wish to have forwarding configured automatically based on
// the entries in /etc/resolv.conf, uncomment the following line and
// set named_auto_forward=yes in /etc/rc.conf.  You can also enable
// named_auto_forward_only (the effect of which is described above).
//	include &#34;/etc/namedb/auto_forward.conf&#34;;</pre></div></div><div class=paragraph><p>Как и говорится в комментариях, если вы хотите получить эффект от использования кэша провайдера, то можно включить раздел <code>forwarders</code>. В обычном случае сервер имён будет рекурсивно опрашивать определённые серверы имён Интернет до тех пор, пока не получит ответ на свой запрос. При включении этого раздела он будет автоматически опрашивать сервер имён вашего провайдера (или тот, который здесь указан), используя преимущества его кэша. наличия нужной информации. Если соответствующий сервер имён провайдера работает быстро и имеет хороший канал связи, то в результате такой настройки вы можете получить хороший результат.</p></div><div class="admonitionblock warning"><table><tbody><tr><td class=icon><i class="fa icon-warning" title=Warning></i></td><td class=content><div class=paragraph><p><code>127.0.0.1</code> здесь работать <em>не будет</em>. Измените его на IP-адрес сервера имён провайдера.</p></div></td></tr></tbody></table></div><div class="literalblock programlisting"><div class=content><pre>/*
	   Modern versions of BIND use a random UDP port for each outgoing
	   query by default in order to dramatically reduce the possibility
	   of cache poisoning.  All users are strongly encouraged to utilize
	   this feature, and to configure their firewalls to accommodate it.

	   AS A LAST RESORT in order to get around a restrictive firewall
	   policy you can try enabling the option below.  Use of this option
	   will significantly reduce your ability to withstand cache poisoning
	   attacks, and should be avoided if at all possible.

	   Replace NNNNN in the example with a number between 49160 and 65530.
	*/
	// query-source address * port NNNNN;
};

// If you enable a local name server, don&#39;t forget to enter 127.0.0.1
// first in your /etc/resolv.conf so this server will be queried.
// Also, make sure to enable it in /etc/rc.conf.

// The traditional root hints mechanism. Use this, OR the slave zones below.
zone &#34;.&#34; { type hint; file &#34;/etc/namedb/named.root&#34;; };

/*	Slaving the following zones from the root name servers has some
	significant advantages:
	1. Faster local resolution for your users
	2. No spurious traffic will be sent from your network to the roots
	3. Greater resilience to any potential root server failure/DDoS

	On the other hand, this method requires more monitoring than the
	hints file to be sure that an unexpected failure mode has not
	incapacitated your server.  Name servers that are serving a lot
	of clients will benefit more from this approach than individual
	hosts.  Use with caution.

	To use this mechanism, uncomment the entries below, and comment
	the hint zone above.

	As documented at http://dns.icann.org/services/axfr/ these zones:
	&#34;.&#34; (the root), ARPA, IN-ADDR.ARPA, IP6.ARPA, and ROOT-SERVERS.NET
	are available for AXFR from these servers on IPv4 and IPv6:
	xfr.lax.dns.icann.org, xfr.cjr.dns.icann.org
*/
/*
zone &#34;.&#34; {
	type slave;
	file &#34;/etc/namedb/slave/root.slave&#34;;
	masters {
		192.5.5.241;	// F.ROOT-SERVERS.NET.
	};
	notify no;
};

zone &#34;arpa&#34; {
	type slave;
	file &#34;/etc/namedb/slave/arpa.slave&#34;;
	masters {
		192.5.5.241;	// F.ROOT-SERVERS.NET.
	};
	notify no;
};
*/

/*	Serving the following zones locally will prevent any queries
	for these zones leaving your network and going to the root
	name servers.  This has two significant advantages:
	1. Faster local resolution for your users
	2. No spurious traffic will be sent from your network to the roots
*/
// RFCs 1912 and 5735 (and BCP 32 for localhost)
zone &#34;localhost&#34;	{ type master; file &#34;/etc/namedb/master/localhost-forward.db&#34;; };
zone &#34;127.in-addr.arpa&#34;	{ type master; file &#34;/etc/namedb/master/localhost-reverse.db&#34;; };
zone &#34;255.in-addr.arpa&#34;	{ type master; file &#34;/etc/namedb/master/empty.db&#34;; };

// RFC 1912-style zone for IPv6 localhost address
zone &#34;0.ip6.arpa&#34;	{ type master; file &#34;/etc/namedb/master/localhost-reverse.db&#34;; };

// &#34;This&#34; Network (RFCs 1912 and 5735)
zone &#34;0.in-addr.arpa&#34;	{ type master; file &#34;/etc/namedb/master/empty.db&#34;; };

// Private Use Networks (RFCs 1918 and 5735)
zone &#34;10.in-addr.arpa&#34;	   { type master; file &#34;/etc/namedb/master/empty.db&#34;; };
zone &#34;16.172.in-addr.arpa&#34; { type master; file &#34;/etc/namedb/master/empty.db&#34;; };
zone &#34;17.172.in-addr.arpa&#34; { type master; file &#34;/etc/namedb/master/empty.db&#34;; };
zone &#34;18.172.in-addr.arpa&#34; { type master; file &#34;/etc/namedb/master/empty.db&#34;; };
zone &#34;19.172.in-addr.arpa&#34; { type master; file &#34;/etc/namedb/master/empty.db&#34;; };
zone &#34;20.172.in-addr.arpa&#34; { type master; file &#34;/etc/namedb/master/empty.db&#34;; };
zone &#34;21.172.in-addr.arpa&#34; { type master; file &#34;/etc/namedb/master/empty.db&#34;; };
zone &#34;22.172.in-addr.arpa&#34; { type master; file &#34;/etc/namedb/master/empty.db&#34;; };
zone &#34;23.172.in-addr.arpa&#34; { type master; file &#34;/etc/namedb/master/empty.db&#34;; };
zone &#34;24.172.in-addr.arpa&#34; { type master; file &#34;/etc/namedb/master/empty.db&#34;; };
zone &#34;25.172.in-addr.arpa&#34; { type master; file &#34;/etc/namedb/master/empty.db&#34;; };
zone &#34;26.172.in-addr.arpa&#34; { type master; file &#34;/etc/namedb/master/empty.db&#34;; };
zone &#34;27.172.in-addr.arpa&#34; { type master; file &#34;/etc/namedb/master/empty.db&#34;; };
zone &#34;28.172.in-addr.arpa&#34; { type master; file &#34;/etc/namedb/master/empty.db&#34;; };
zone &#34;29.172.in-addr.arpa&#34; { type master; file &#34;/etc/namedb/master/empty.db&#34;; };
zone &#34;30.172.in-addr.arpa&#34; { type master; file &#34;/etc/namedb/master/empty.db&#34;; };
zone &#34;31.172.in-addr.arpa&#34; { type master; file &#34;/etc/namedb/master/empty.db&#34;; };
zone &#34;168.192.in-addr.arpa&#34; { type master; file &#34;/etc/namedb/master/empty.db&#34;; };

// Link-local/APIPA (RFCs 3927 and 5735)
zone &#34;254.169.in-addr.arpa&#34; { type master; file &#34;/etc/namedb/master/empty.db&#34;; };

// IETF protocol assignments (RFCs 5735 and 5736)
zone &#34;0.0.192.in-addr.arpa&#34; { type master; file &#34;/etc/namedb/master/empty.db&#34;; };

// TEST-NET-[1-3] for Documentation (RFCs 5735 and 5737)
zone &#34;2.0.192.in-addr.arpa&#34; { type master; file &#34;/etc/namedb/master/empty.db&#34;; };
zone &#34;100.51.198.in-addr.arpa&#34; { type master; file &#34;/etc/namedb/master/empty.db&#34;; };
zone &#34;113.0.203.in-addr.arpa&#34; { type master; file &#34;/etc/namedb/master/empty.db&#34;; };

// IPv6 Range for Documentation (RFC 3849)
zone &#34;8.b.d.0.1.0.0.2.ip6.arpa&#34; { type master; file &#34;/etc/namedb/master/empty.db&#34;; };

// Domain Names for Documentation and Testing (BCP 32)
zone &#34;test&#34; { type master; file &#34;/etc/namedb/master/empty.db&#34;; };
zone &#34;example&#34; { type master; file &#34;/etc/namedb/master/empty.db&#34;; };
zone &#34;invalid&#34; { type master; file &#34;/etc/namedb/master/empty.db&#34;; };
zone &#34;example.com&#34; { type master; file &#34;/etc/namedb/master/empty.db&#34;; };
zone &#34;example.net&#34; { type master; file &#34;/etc/namedb/master/empty.db&#34;; };
zone &#34;example.org&#34; { type master; file &#34;/etc/namedb/master/empty.db&#34;; };

// Router Benchmark Testing (RFCs 2544 and 5735)
zone &#34;18.198.in-addr.arpa&#34; { type master; file &#34;/etc/namedb/master/empty.db&#34;; };
zone &#34;19.198.in-addr.arpa&#34; { type master; file &#34;/etc/namedb/master/empty.db&#34;; };

// IANA Reserved - Old Class E Space (RFC 5735)
zone &#34;240.in-addr.arpa&#34;	{ type master; file &#34;/etc/namedb/master/empty.db&#34;; };
zone &#34;241.in-addr.arpa&#34;	{ type master; file &#34;/etc/namedb/master/empty.db&#34;; };
zone &#34;242.in-addr.arpa&#34;	{ type master; file &#34;/etc/namedb/master/empty.db&#34;; };
zone &#34;243.in-addr.arpa&#34;	{ type master; file &#34;/etc/namedb/master/empty.db&#34;; };
zone &#34;244.in-addr.arpa&#34;	{ type master; file &#34;/etc/namedb/master/empty.db&#34;; };
zone &#34;245.in-addr.arpa&#34;	{ type master; file &#34;/etc/namedb/master/empty.db&#34;; };
zone &#34;246.in-addr.arpa&#34;	{ type master; file &#34;/etc/namedb/master/empty.db&#34;; };
zone &#34;247.in-addr.arpa&#34;	{ type master; file &#34;/etc/namedb/master/empty.db&#34;; };
zone &#34;248.in-addr.arpa&#34;	{ type master; file &#34;/etc/namedb/master/empty.db&#34;; };
zone &#34;249.in-addr.arpa&#34;	{ type master; file &#34;/etc/namedb/master/empty.db&#34;; };
zone &#34;250.in-addr.arpa&#34;	{ type master; file &#34;/etc/namedb/master/empty.db&#34;; };
zone &#34;251.in-addr.arpa&#34;	{ type master; file &#34;/etc/namedb/master/empty.db&#34;; };
zone &#34;252.in-addr.arpa&#34;	{ type master; file &#34;/etc/namedb/master/empty.db&#34;; };
zone &#34;253.in-addr.arpa&#34;	{ type master; file &#34;/etc/namedb/master/empty.db&#34;; };
zone &#34;254.in-addr.arpa&#34;	{ type master; file &#34;/etc/namedb/master/empty.db&#34;; };

// IPv6 Unassigned Addresses (RFC 4291)
zone &#34;1.ip6.arpa&#34;	{ type master; file &#34;/etc/namedb/master/empty.db&#34;; };
zone &#34;3.ip6.arpa&#34;	{ type master; file &#34;/etc/namedb/master/empty.db&#34;; };
zone &#34;4.ip6.arpa&#34;	{ type master; file &#34;/etc/namedb/master/empty.db&#34;; };
zone &#34;5.ip6.arpa&#34;	{ type master; file &#34;/etc/namedb/master/empty.db&#34;; };
zone &#34;6.ip6.arpa&#34;	{ type master; file &#34;/etc/namedb/master/empty.db&#34;; };
zone &#34;7.ip6.arpa&#34;	{ type master; file &#34;/etc/namedb/master/empty.db&#34;; };
zone &#34;8.ip6.arpa&#34;	{ type master; file &#34;/etc/namedb/master/empty.db&#34;; };
zone &#34;9.ip6.arpa&#34;	{ type master; file &#34;/etc/namedb/master/empty.db&#34;; };
zone &#34;a.ip6.arpa&#34;	{ type master; file &#34;/etc/namedb/master/empty.db&#34;; };
zone &#34;b.ip6.arpa&#34;	{ type master; file &#34;/etc/namedb/master/empty.db&#34;; };
zone &#34;c.ip6.arpa&#34;	{ type master; file &#34;/etc/namedb/master/empty.db&#34;; };
zone &#34;d.ip6.arpa&#34;	{ type master; file &#34;/etc/namedb/master/empty.db&#34;; };
zone &#34;e.ip6.arpa&#34;	{ type master; file &#34;/etc/namedb/master/empty.db&#34;; };
zone &#34;0.f.ip6.arpa&#34;	{ type master; file &#34;/etc/namedb/master/empty.db&#34;; };
zone &#34;1.f.ip6.arpa&#34;	{ type master; file &#34;/etc/namedb/master/empty.db&#34;; };
zone &#34;2.f.ip6.arpa&#34;	{ type master; file &#34;/etc/namedb/master/empty.db&#34;; };
zone &#34;3.f.ip6.arpa&#34;	{ type master; file &#34;/etc/namedb/master/empty.db&#34;; };
zone &#34;4.f.ip6.arpa&#34;	{ type master; file &#34;/etc/namedb/master/empty.db&#34;; };
zone &#34;5.f.ip6.arpa&#34;	{ type master; file &#34;/etc/namedb/master/empty.db&#34;; };
zone &#34;6.f.ip6.arpa&#34;	{ type master; file &#34;/etc/namedb/master/empty.db&#34;; };
zone &#34;7.f.ip6.arpa&#34;	{ type master; file &#34;/etc/namedb/master/empty.db&#34;; };
zone &#34;8.f.ip6.arpa&#34;	{ type master; file &#34;/etc/namedb/master/empty.db&#34;; };
zone &#34;9.f.ip6.arpa&#34;	{ type master; file &#34;/etc/namedb/master/empty.db&#34;; };
zone &#34;a.f.ip6.arpa&#34;	{ type master; file &#34;/etc/namedb/master/empty.db&#34;; };
zone &#34;b.f.ip6.arpa&#34;	{ type master; file &#34;/etc/namedb/master/empty.db&#34;; };
zone &#34;0.e.f.ip6.arpa&#34;	{ type master; file &#34;/etc/namedb/master/empty.db&#34;; };
zone &#34;1.e.f.ip6.arpa&#34;	{ type master; file &#34;/etc/namedb/master/empty.db&#34;; };
zone &#34;2.e.f.ip6.arpa&#34;	{ type master; file &#34;/etc/namedb/master/empty.db&#34;; };
zone &#34;3.e.f.ip6.arpa&#34;	{ type master; file &#34;/etc/namedb/master/empty.db&#34;; };
zone &#34;4.e.f.ip6.arpa&#34;	{ type master; file &#34;/etc/namedb/master/empty.db&#34;; };
zone &#34;5.e.f.ip6.arpa&#34;	{ type master; file &#34;/etc/namedb/master/empty.db&#34;; };
zone &#34;6.e.f.ip6.arpa&#34;	{ type master; file &#34;/etc/namedb/master/empty.db&#34;; };
zone &#34;7.e.f.ip6.arpa&#34;	{ type master; file &#34;/etc/namedb/master/empty.db&#34;; };

// IPv6 ULA (RFC 4193)
zone &#34;c.f.ip6.arpa&#34;	{ type master; file &#34;/etc/namedb/master/empty.db&#34;; };
zone &#34;d.f.ip6.arpa&#34;	{ type master; file &#34;/etc/namedb/master/empty.db&#34;; };

// IPv6 Link Local (RFC 4291)
zone &#34;8.e.f.ip6.arpa&#34;	{ type master; file &#34;/etc/namedb/master/empty.db&#34;; };
zone &#34;9.e.f.ip6.arpa&#34;	{ type master; file &#34;/etc/namedb/master/empty.db&#34;; };
zone &#34;a.e.f.ip6.arpa&#34;	{ type master; file &#34;/etc/namedb/master/empty.db&#34;; };
zone &#34;b.e.f.ip6.arpa&#34;	{ type master; file &#34;/etc/namedb/master/empty.db&#34;; };

// IPv6 Deprecated Site-Local Addresses (RFC 3879)
zone &#34;c.e.f.ip6.arpa&#34;	{ type master; file &#34;/etc/namedb/master/empty.db&#34;; };
zone &#34;d.e.f.ip6.arpa&#34;	{ type master; file &#34;/etc/namedb/master/empty.db&#34;; };
zone &#34;e.e.f.ip6.arpa&#34;	{ type master; file &#34;/etc/namedb/master/empty.db&#34;; };
zone &#34;f.e.f.ip6.arpa&#34;	{ type master; file &#34;/etc/namedb/master/empty.db&#34;; };

// IP6.INT is Deprecated (RFC 4159)
zone &#34;ip6.int&#34;		{ type master; file &#34;/etc/namedb/master/empty.db&#34;; };

// NB: Do not use the IP addresses below, they are faked, and only
// serve demonstration/documentation purposes!
//
// Example slave zone config entries.  It can be convenient to become
// a slave at least for the zone your own domain is in.  Ask
// your network administrator for the IP address of the responsible
// master name server.
//
// Do not forget to include the reverse lookup zone!
// This is named after the first bytes of the IP address, in reverse
// order, with &#34;.IN-ADDR.ARPA&#34; appended, or &#34;.IP6.ARPA&#34; for IPv6.
//
// Before starting to set up a master zone, make sure you fully
// understand how DNS and BIND work.  There are sometimes
// non-obvious pitfalls.  Setting up a slave zone is usually simpler.
//
// NB: Don&#39;t blindly enable the examples below. :-)  Use actual names
// and addresses instead.

/* An example dynamic zone
key &#34;exampleorgkey&#34; {
	algorithm hmac-md5;
	secret &#34;sf87HJqjkqh8ac87a02lla==&#34;;
};
zone &#34;example.org&#34; {
	type master;
	allow-update {
		key &#34;exampleorgkey&#34;;
	};
	file &#34;dynamic/example.org&#34;;
};
*/

/* Example of a slave reverse zone
zone &#34;1.168.192.in-addr.arpa&#34; {
	type slave;
	file &#34;/etc/namedb/slave/1.168.192.in-addr.arpa&#34;;
	masters {
		192.168.1.1;
	};
};
*/</pre></div></div><div class=paragraph><p>Это примеры описаний прямой и обратной зон из файла <span class=filename>named.conf</span> для вторичных серверов.</p></div><div class=paragraph><p>Для каждого новой зоны, которую будет обслуживать сервер имён, в файл <span class=filename>named.conf</span> должна быть добавлена запись.</p></div><div class=paragraph><p>К примеру, самая простая запись для домена <code>example.org</code> может выглядеть вот так:</p></div><div class="literalblock programlisting"><div class=content><pre>zone &#34;example.org&#34; {
	type master;
	file &#34;master/example.org&#34;;
};</pre></div></div><div class=paragraph><p>Зона является первичной, что отражается в поле <code>type</code>, и информация о зоне хранится в файле <span class=filename>/etc/namedb/master/example.org</span>, что указывается в поле <code>file</code>.</p></div><div class="literalblock programlisting"><div class=content><pre>zone &#34;example.org&#34; {
	type slave;
	file &#34;slave/example.org&#34;;
};</pre></div></div><div class=paragraph><p>В случае вторичной зоны информация о ней передается с основного сервера имён для заданной зоны и сохраняется в указанном файле. Если и когда основной сервер имён выходит и строя или недосягаем, то скачанная информация о зоне будет находиться на вторичных серверах, и они смогут обслуживать эту зону.</p></div></div><div class=sect3><h4 id=_файлы_зон>25.6.6.2. Файлы зон<a class=anchor href=#_файлы_зон></a></h4><div class=paragraph><p>Пример файла зоны <code>example.org</code> для основного сервера (располагающийся в файле <span class=filename>/etc/namedb/master/example.org</span>) имеет такой вид:</p></div><div class="literalblock programlisting"><div class=content><pre>$TTL 3600        ; 1 hour default TTL
example.org.    IN      SOA      ns1.example.org. admin.example.org. (
                                2006051501      ; Serial
                                10800           ; Refresh
                                3600            ; Retry
                                604800          ; Expire
                                300             ; Negative Response TTL
                        )

; DNS Servers
                IN      NS      ns1.example.org.
                IN      NS      ns2.example.org.

; MX Records
                IN      MX 10   mx.example.org.
                IN      MX 20   mail.example.org.

                IN      A       192.168.1.1

; Machine Names
localhost       IN      A       127.0.0.1
ns1             IN      A       192.168.1.2
ns2             IN      A       192.168.1.3
mx              IN      A       192.168.1.4
mail            IN      A       192.168.1.5

; Aliases
www             IN      CNAME   example.org.</pre></div></div><div class=paragraph><p>Заметьте, что все имена хостов, оканчивающиеся на ".", задают полное имя, тогда как все имена без символа "." на конце считаются заданными относительно origin. Например, <code>ns1</code> преобразуется в <code>ns1.<em>example.org.</em></code></p></div><div class=paragraph><p>Файл зоны имеет следующий формат:</p></div><div class="literalblock programlisting"><div class=content><pre>recordname      IN recordtype  value</pre></div></div><div class=paragraph><p>Наиболее часто используемые записи DNS:</p></div><div class=dlist><dl><dt class=hdlist1>SOA</dt><dd><p>начало зоны ответственности</p></dd><dt class=hdlist1>NS</dt><dd><p>авторитативный сервер имен</p></dd><dt class=hdlist1>A</dt><dd><p>адрес хоста</p></dd><dt class=hdlist1>CNAME</dt><dd><p>каноническое имя для алиаса</p></dd><dt class=hdlist1>MX</dt><dd><p>обмен почтой</p></dd><dt class=hdlist1>PTR</dt><dd><p>указатель на доменное имя (используется в обратных зонах DNS)</p></dd></dl></div><div class="literalblock programlisting"><div class=content><pre>example.org. IN SOA ns1.example.org. admin.example.org. (
                        2006051501      ; Serial
                        10800           ; Refresh after 3 hours
                        3600            ; Retry after 1 hour
                        604800          ; Expire after 1 week
                        300 )           ; Negative Response TTL</pre></div></div><div class=dlist><dl><dt class=hdlist1><code>example.org.</code></dt><dd><p>имя домена, а также ориджин для этого файла зоны.</p></dd><dt class=hdlist1><code>ns1.example.org.</code></dt><dd><p>основной/авторитативный сервер имён для этой зоны.</p></dd><dt class=hdlist1><code>admin.example.org.</code></dt><dd><p>человек, отвечающий за эту зону, адрес электронной почты с символом "@" замененным на точку. (<a href=mailto:admin@example.org>admin@example.org</a> становится <code>admin.example.org</code>)</p></dd><dt class=hdlist1><code>2006051501</code></dt><dd><p>последовательный номер файла. При каждом изменении файла зоны это число должно увеличиваться. В настоящее время для нумерации многие администраторы предпочитают формат <code>ггггммддвв</code>. <code>2006051501</code> будет означать, что файл последний раз изменялся 15.05.2006, а последнее число <code>01</code> означает, что это была первая модификация файла за день. Последовательный номер важен, так как он служит для того, чтобы вторичные серверы узнавали об обновлении зоны.</p></dd></dl></div><div class="literalblock programlisting"><div class=content><pre>       IN      NS      ns1.example.org.</pre></div></div><div class=paragraph><p>Это NS-запись. Такие записи должны иметься для всех серверов имён, которые будут отвечать за зону.</p></div><div class="literalblock programlisting"><div class=content><pre>localhost       IN      A       127.0.0.1
ns1             IN      A       192.168.1.2
ns2             IN      A       192.168.1.3
mx              IN      A       192.168.1.4
mail            IN      A       192.168.1.5</pre></div></div><div class=paragraph><p>Записи типа A служат для обозначения имён машин. Как это видно выше, имя <code>ns1.example.org</code> будет преобразовано в <code>192.168.1.2</code>.</p></div><div class="literalblock programlisting"><div class=content><pre>       IN      A       192.168.1.1</pre></div></div><div class=paragraph><p>Эта строка присваивает IP адрес <code>192.168.1.1</code> текущему ориджину, в данном случае домену <code>example.org</code>.</p></div><div class="literalblock programlisting"><div class=content><pre>www	     IN CNAME	@</pre></div></div><div class=paragraph><p>Записи с каноническими именами обычно используются для присвоения машинам псевдонимов. В этом примере <code>www</code> является псевдонимом для "главной" машины, имя которой по воле случая совпало с именем домена <code>example.org</code> (<code>192.168.1.1</code>). Записи типа CNAME нельзя использовать совместно с другими типами записей для одного и того же имени хоста (recordname).</p></div><div class="literalblock programlisting"><div class=content><pre>	       IN MX   10      mail.example.org.</pre></div></div><div class=paragraph><p>MX-запись указывает, какие почтовые серверы отвечают за обработку входящей электронной почты для зоны. <code>mail.example.org</code> является именем почтового сервера, а 10 обозначает приоритет этого почтового сервера.</p></div><div class=paragraph><p>Можно иметь несколько почтовых серверов с приоритетами, например, 10, 20 и так далее. Почтовый сервер, пытающийся доставить почту для <code>example.org</code>, сначала попробует связаться с машиной, имеющий MX-запись с самым большим приоритетом (наименьшим числовым значением в поле MX), затем с приоритетом поменьше и так далее, до тех пор, пока почта не будет отправлена.</p></div><div class=paragraph><p>Для файлов зон in-addr.arpa (обратные записи DNS) используется тот же самый формат, отличающийся только использованием записей PTR вместо A или CNAME.</p></div><div class="literalblock programlisting"><div class=content><pre>$TTL 3600

1.168.192.in-addr.arpa. IN SOA ns1.example.org. admin.example.org. (
                        2006051501      ; Serial
                        10800           ; Refresh
                        3600            ; Retry
                        604800          ; Expire
                        300 )           ; Negative Response TTL

        IN      NS      ns1.example.org.
        IN      NS      ns2.example.org.

1       IN      PTR     example.org.
2       IN      PTR     ns1.example.org.
3       IN      PTR     ns2.example.org.
4       IN      PTR     mx.example.org.
5       IN      PTR     mail.example.org.</pre></div></div><div class=paragraph><p>В этом файле дается полное соответствие имён хостов IP-адресам в нашем описанном ранее вымышленном домене.</p></div><div class=paragraph><p>Следует отметить, что все имена в правой части PTR-записи должны быть полными доменными именами (то есть, заканчиваться точкой ".").</p></div></div></div><div class=sect2><h3 id=_кэширующий_сервер_имён>25.6.7. Кэширующий сервер имён<a class=anchor href=#_кэширующий_сервер_имён></a></h3><div class=paragraph><p>Кэширующий сервер имён - это сервер имен, чья главная задача - разрешение рекурсивных запросов. Он просто выполняет запросы от своего имени и сохраняет результаты для последующего использования.</p></div></div><div class=sect2><h3 id=_dnssec>25.6.8. * DNSSEC<a class=anchor href=#_dnssec></a></h3><div class=paragraph><p>Этот раздел не переведен.</p></div></div><div class=sect2><h3 id=_безопасность>25.6.9. Безопасность<a class=anchor href=#_безопасность></a></h3><div class=paragraph><p>Хотя BIND является самой распространенной реализацией DNS, всегда стоит вопрос об обеспечении безопасности. Время от времени обнаруживаются возможные и реальные бреши в безопасности.</p></div><div class=paragraph><p>FreeBSD автоматически запускает named в ограниченном окружении (<a href="https://man.freebsd.org/cgi/man.cgi?query=chroot&amp;sektion=8&amp;format=html">chroot(8)</a>); помимо этого, есть еще несколько механизмов, помогающих защититься от возможных атак на сервис DNS.</p></div><div class=paragraph><p>Весьма полезно прочесть сообщения безопасности <a href=http://www.cert.org/>CERT</a> и подписаться на <a href=https://lists.FreeBSD.org/subscription/freebsd-security-notifications>Список рассылки FreeBSD, посвящённый срочным сообщениям, связанным с безопасностью</a> для того, чтобы быть в курсе текущих проблем с обеспечением безопасности Internet и FreeBSD.</p></div><div class="admonitionblock tip"><table><tbody><tr><td class=icon><i class="fa icon-tip" title=Tip></i></td><td class=content><div class=paragraph><p>Если возникает проблема, то наличие последних исходных текстов и свежесобранного named может способствовать её решению.</p></div></td></tr></tbody></table></div></div><div class=sect2><h3 id=dns-read>25.6.10. Дополнительная литература<a class=anchor href=#dns-read></a></h3><div class=paragraph><p>Справочная информация по BIND/named: <a href="https://man.freebsd.org/cgi/man.cgi?query=rndc&amp;sektion=8&amp;format=html">rndc(8)</a>, <a href="https://man.freebsd.org/cgi/man.cgi?query=named&amp;sektion=8&amp;format=html">named(8)</a>, <a href="https://man.freebsd.org/cgi/man.cgi?query=named.conf&amp;sektion=8&amp;format=html">named.conf(8)</a>, <a href="https://man.freebsd.org/cgi/man.cgi?query=nsupdate&amp;sektion=8&amp;format=html">nsupdate(8)</a>, <a href="https://man.freebsd.org/cgi/man.cgi?query=dnssec-signzone&amp;sektion=8&amp;format=html">dnssec-signzone(8)</a>, <a href="https://man.freebsd.org/cgi/man.cgi?query=dnssec-keygen&amp;sektion=8&amp;format=html">dnssec-keygen(8)</a></p></div><div class=ulist><ul><li><p><a href=https://www.isc.org/software/bind>Официальная страница ISC BIND</a></p></li><li><p><a href=https://www.isc.org/software/guild>Официальный форум ISC BIND</a></p></li><li><p><a href=http://www.oreilly.com/catalog/dns5/>Книга издательства O’Reilly DNS and BIND 5th Edition</a></p></li><li><p><a href=http://www.root-dnssec.org/documentation/>Root DNSSEC</a></p></li><li><p><a href=http://data.iana.org/root-anchors/draft-icann-dnssec-trust-anchor.html>DNSSEC Trust Anchor Publication for the Root Zone</a></p></li><li><p><a href=http://tools.ietf.org/html/rfc1034>RFC1034 - Domain Names - Concepts and Facilities</a></p></li><li><p><a href=http://tools.ietf.org/html/rfc1035>RFC1035 - Domain Names - Implementation and Specification</a></p></li><li><p><a href=http://tools.ietf.org/html/rfc4033>RFC4033 - DNS Security Introduction and Requirements</a></p></li><li><p><a href=http://tools.ietf.org/html/rfc4034>RFC4034 - Resource Records for the DNS Security Extensions</a></p></li><li><p><a href=http://tools.ietf.org/html/rfc4035>RFC4035 - Protocol Modifications for the DNS Security Extensions</a></p></li><li><p><a href=http://tools.ietf.org/html/rfc4641>RFC4641 - DNSSEC Operational Practices</a></p></li><li><p><a href=http://tools.ietf.org/html/rfc5011>RFC5011 - Automated Updates of DNS Security (DNSSEC Trust Anchors</a></p></li></ul></div></div></div></div><div class=sect1><h2 id=network-apache>25.7. Apache HTTP сервер<a class=anchor href=#network-apache></a></h2><div class=sectionbody><div class=sect2><h3 id=_обзор_2>25.7.1. Обзор<a class=anchor href=#_обзор_2></a></h3><div class=paragraph><p>FreeBSD используется в качестве платформы для многих из самых нагруженных серверов в мире. Большинство серверов в интернет используют Apache HTTP сервер. Пакеты Apache должны быть включены в поставку FreeBSD. Если вы не установили их во вместе с системой, воспользуйтесь портами <a class=package href=https://cgit.freebsd.org/ports/tree/www/apache13/>www/apache13</a> или <a class=package href=https://cgit.freebsd.org/ports/tree/www/apache22/>www/apache22</a>.</p></div><div class=paragraph><p>Как только Apache был успешно установлен, его необходимо настроить.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>В этом разделе рассказывается о версии 1.3.X Apache HTTP сервера, поскольку эта версия наиболее широко используется в FreeBSD. Apache 2.X содержит много новых технологий, но здесь они не обсуждаются. За дополнительной информацией о Apache 2.X, обращайтесь к <a href=http://httpd.apache.org/>http://httpd.apache.org/</a>.</p></div></td></tr></tbody></table></div></div><div class=sect2><h3 id=_настройка>25.7.2. Настройка<a class=anchor href=#_настройка></a></h3><div class=paragraph><p>В FreeBSD основной файл настройки Apache HTTP сервера устанавливается в <span class=filename>/usr/local/etc/apache/httpd.conf</span>. Это обычный текстовый UNIX® файл настройки с строками комментариев, начинающимися с символа <code>#</code>. Исчерпывающее описание всех возможных параметров настройки находится за пределом рассмотрения этой книги, поэтому здесь будут описаны только наиболее часто модифицируемые директивы.</p></div><div class=dlist><dl><dt class=hdlist1><code>ServerRoot "/usr/local"</code></dt><dd><p>Указывает верхний каталог установки Apache по умолчанию. Бинарные файлы находятся в <span class=filename>bin</span> и <span class=filename>sbin</span>, подкаталоги расположены относительно корневого каталога сервера, файлы настройки находятся в <span class=filename>etc/apache</span>.</p></dd><dt class=hdlist1><code>ServerAdmin you@your.address</code></dt><dd><p>Адрес, на который должны будут отправляться сообщения о проблемах с сервером. Этот адрес выводится на некоторые генерируемые сервером страницы, например с сообщениями об ошибках.</p></dd><dt class=hdlist1><code>ServerName www.example.com</code></dt><dd><p><code>ServerName</code> позволяет вам устанавливать имя хоста, которое отправляется обратно клиентам, если оно отличается от того, с которым настроен хост (например, использование <code>www</code> вместо реального имени хоста).</p></dd><dt class=hdlist1><code>DocumentRoot "/usr/local/www/data"</code></dt><dd><p><code>DocumentRoot</code>: Каталог, внутри которого будут храниться документы. По умолчанию, все запросы обрабатываются внутри этого каталога, но символические ссылки и синонимы могут использоваться для указания на другие каталоги.</p></dd></dl></div><div class=paragraph><p>Хорошей идеей будет сделать резервные копии настроек Apache перед внесением изменений. Как только вы будете удовлетворены первоначальной настройкой, можно запускать Apache.</p></div></div><div class=sect2><h3 id=_запуск_apache>25.7.3. Запуск Apache<a class=anchor href=#_запуск_apache></a></h3><div class=paragraph><p>Apache не запускается из inetd, как это делают многие другие сетевые серверы. Он настроен для автономного запуска, чтобы обеспечивать большую производительность при обработке HTTP запросов от браузеров клиентов. Для упрощения запуска, остановки и перезапуска сервера существует shell скрипт. Для запуска Apache в первый раз просто выполните:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># /usr/local/sbin/apachectl start</span></code></pre></div></div><div class=paragraph><p>Вы можете остановить сервер в любой момент, выполнив:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># /usr/local/sbin/apachectl stop</span></code></pre></div></div><div class=paragraph><p>После внесения любых изменений в файл настроек, вам потребуется перезапустить сервер:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># /usr/local/sbin/apachectl restart</span></code></pre></div></div><div class=paragraph><p>Для перезапуска Apache без прерывания имеющихся соединений, выполните:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># /usr/local/sbin/apachectl graceful</span></code></pre></div></div><div class=paragraph><p>Дополнительная информация находится на странице справочного руководства <a href="https://man.freebsd.org/cgi/man.cgi?query=apachectl&amp;sektion=8&amp;format=html">apachectl(8)</a>.</p></div><div class=paragraph><p>Для запуска Apache при старте системы, добавьте в <span class=filename>/etc/rc.conf</span> следующую строку:</p></div><div class="literalblock programlisting"><div class=content><pre>apache_enable=&#34;YES&#34;</pre></div></div><div class=paragraph><p>или для Apache 2.2:</p></div><div class="literalblock programlisting"><div class=content><pre>apache22_enable=&#34;YES&#34;</pre></div></div><div class=paragraph><p>Если вы хотите передать программе Apache`httpd` дополнительные параметры командной при загрузке системы, они могут быть помещены в дополнительную строку <span class=filename>rc.conf</span>:</p></div><div class="literalblock programlisting"><div class=content><pre>apache_flags=&#34;&#34;</pre></div></div><div class=paragraph><p>Теперь, когда веб сервер запущен, вы можете просмотреть свой веб сайт, задав в строке браузера адрес <code><a href=http://localhost/ class=bare>http://localhost/</a></code>. По умолчанию отображается веб страница <span class=filename>/usr/local/www/data/index.html</span>.</p></div></div><div class=sect2><h3 id=_виртуальный_хостинг>25.7.4. Виртуальный хостинг<a class=anchor href=#_виртуальный_хостинг></a></h3><div class=paragraph><p>Apache поддерживает два различных типа виртуального хостинга (Virtual Hosting). Первый метод основан на именах (Name-based Virtual Hosting). Он использует полученные от клиента заголовки HTTP/1.1 для определения имени хоста. Это позволяет многим различным доменам использовать один и тот же IP адрес.</p></div><div class=paragraph><p>Для настройки Apache на использование этого типа хостинга добавьте в <span class=filename>httpd.conf</span> запись подобную следующей:</p></div><div class="literalblock programlisting"><div class=content><pre>NameVirtualHost *</pre></div></div><div class=paragraph><p>Если веб сервер назывался <code>www.domain.tld</code> и вы хотите настроить виртуальный домен для <code>www.someotherdomain.tld</code>, необходимо добавить в <span class=filename>httpd.conf</span> следующие записи:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>&lt;VirtualHost <span class=k>*</span><span class=o>&gt;</span>
ServerName www.domain.tld
DocumentRoot /www/domain.tld
&lt;/VirtualHost&gt;

&lt;VirtualHost <span class=k>*</span><span class=o>&gt;</span>
ServerName www.someotherdomain.tld
DocumentRoot /www/someotherdomain.tld
&lt;/VirtualHost&gt;</code></pre></div></div><div class=paragraph><p>Замените адреса и пути к документам на те, что вы будете использовать.</p></div><div class=paragraph><p>За дополнительной информацией по настройке виртуальных хостов обращайтесь к официальной документации Apache: <a href=http://httpd.apache.org/docs/vhosts/>http://httpd.apache.org/docs/vhosts/</a>.</p></div></div><div class=sect2><h3 id=_модули_apache>25.7.5. Модули Apache<a class=anchor href=#_модули_apache></a></h3><div class=paragraph><p>Существуют множество различных модулей Apache, которые добавляют функциональность к основному серверу. Коллекция портов FreeBSD предоставляет простой способ установки Apache с некоторыми наиболее популярными дополнительными модулями.</p></div><div class=sect3><h4 id=_mod_ssl>25.7.5.1. mod_ssl<a class=anchor href=#_mod_ssl></a></h4><div class=paragraph><p>Модуль mod_ssl использует библиотеку OpenSSL для сильной криптографии через протоколы Secure Sockets Layer (SSL v2/v3) и Transport Layer Security (TLS v1). Этот модуль содержит все необходимое для запроса подписанного сертификата из центра сертификации для защищенного веб сервера на FreeBSD.</p></div><div class=paragraph><p>Если вы еще не установили Apache, версия Apache 1.3.X с mod_ssl может быть установлена через порт <a class=package href=https://cgit.freebsd.org/ports/tree/www/apache13-modssl/>www/apache13-modssl</a>. Поддержка SSL также доступна для Apache 2.X через порт <a class=package href=https://cgit.freebsd.org/ports/tree/www/apache22/>www/apache22</a>, где она включена по умолчанию.</p></div></div><div class=sect3><h4 id=_apache_и_скриптовые_языки>25.7.5.2. Apache и скриптовые языки<a class=anchor href=#_apache_и_скриптовые_языки></a></h4><div class=paragraph><p>Для большинства скриптовых языков созданы модули Apache. На базе таких модулей возможно создание других модулей Apache, написанных полностью на скриптовом языке. Они также часто используются как встроенные в сервер интерпретаторы, что исключает накладные расходы на запуск внешнего интерпретатора и сокращает время построения динамических страниц.</p></div></div></div><div class=sect2><h3 id=_построение_динамических_сайтов>25.7.6. Построение динамических сайтов<a class=anchor href=#_построение_динамических_сайтов></a></h3><div class=paragraph><p>В последнее десятилетие все большее число компаний обращает внимание на Интернет как площадку для ведения и расширения бизнеса. Среди прочего, этот процесс подчеркивает потребность в интерактивном содержимом сайтов. Некоторые компании, такие как Microsoft®, представляют свои закрытые решения; сообщество разработчиков открытых программ отвечает на вызов. Среди современных решений для предоставления динамического контента следует отметить Django, Ruby on Rails, mod_perl и mod_php.</p></div><div class=sect3><h4 id=_django>25.7.6.1. Django<a class=anchor href=#_django></a></h4><div class=paragraph><p>Django - это распространяемая под лицензией BSD инфраструктура, позволяющая разработчикам быстро создавать элегантные, высокопроизводительные веб-приложения. Она предоставляет в распоряжение разработчика объектно-реляционное отображение (object-relational mapper), таким образом типы данных разрабатываются как объекты Python. Для этих объектов предоставляется богатый интерфейс доступа к базам данных, при этом у разработчика не возникает необходимости написания SQL-запросов. Django также предоставляет расширяемую систему шаблонов, так что логика приложения отделена от его HTML-представления.</p></div><div class=paragraph><p>Для Django требуются следующие компоненты: mod_python, Apache и одна из нескольких возможных SQL СУБД. Укажите соответствующие опции сборки, и порт установит всё необходимое.</p></div><div id=network-www-django-install class=exampleblock><div class=title>Пример 3. Установка Django совместно с Apache2, mod_python3 и PostgreSQL</div><div class=content><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># cd /usr/ports/www/py-django; make all install clean -DWITH_MOD_PYTHON3 -DWITH_POSTGRESQL</span></code></pre></div></div></div></div><div class=paragraph><p>После установки Django и всех необходимых ему компонентов вам потребуется создать каталог для проекта Django. Далее потребуется настроить Apache для определенных URL адресов на вашем сайте выполнять ваше приложение встроенным интерпретатором Python.</p></div><div id=network-www-django-apache-config class=exampleblock><div class=title>Пример 4. Конфигурация Apache для Django/mod_python</div><div class=content><div class=paragraph><p>Чтобы настроить Apache отправлять запросы для определенных URL адресов вашему веб-приложению, вам потребуется внести несколько строк в конфигурационный файл <span class=filename>httpd.conf</span>:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>&lt;Location <span class=s2>&#34;/&#34;</span><span class=o>&gt;</span>
    SetHandler python-program
    PythonPath <span class=s2>&#34;[&#39;/dir/to/your/django/packages/&#39;] + sys.path&#34;</span>
    PythonHandler django.core.handlers.modpython
    SetEnv DJANGO_SETTINGS_MODULE mysite.settings
    PythonAutoReload On
    PythonDebug On
&lt;/Location&gt;</code></pre></div></div></div></div></div><div class=sect3><h4 id=_ruby_on_rails>25.7.6.2. Ruby on Rails<a class=anchor href=#_ruby_on_rails></a></h4><div class=paragraph><p>Ruby on Rails это еще одна веб инфраструктура с открытым исходным кодом, которая предоставляет полный стек разработки и которая оптимизированa для продуктивного и быстрого создания мощных веб-приложений. Ruby on Rails может быть легко установлена из коллекции портов.</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># cd /usr/ports/www/rubygem-rails; make all install clean</span></code></pre></div></div></div><div class=sect3><h4 id=_mod_perl>25.7.6.3. mod_perl<a class=anchor href=#_mod_perl></a></h4><div class=paragraph><p>Проект интеграции Apache/Perl объединяет мощь языка программирования Perl и HTTP сервера Apache. С модулем mod_perl возможно написание модулей Apache полностью на Perl. Кроме того, постоянно запущенный встроенный в сервер интерпретатор позволяет не тратить ресурсы на запуск внешнего интерпретатора и время на запуск Perl.</p></div><div class=paragraph><p>mod_perl можно использовать различными способами. Помните, что mod_perl 1.0 работает только с Apache 1.3, тогда как mod_perl 2.0 совместим только с Apache 2.X. mod_perl 1.0 доступен как порт <a class=package href=https://cgit.freebsd.org/ports/tree/www/mod_perl/>www/mod_perl</a>, а также в виде статически скомпилированной версии в <a class=package href=https://cgit.freebsd.org/ports/tree/www/apache13-modperl/>www/apache13-modperl</a>. mod_perl 2.0 доступен как <a class=package href=https://cgit.freebsd.org/ports/tree/www/mod_perl2/>www/mod_perl2</a>.</p></div></div><div class=sect3><h4 id=_mod_php>25.7.6.4. mod_php<a class=anchor href=#_mod_php></a></h4><div class=paragraph><p>PHP, также известный как "Препроцессор гипертекста" ("Hypertext Preprocessor"), - это скриптовый язык общего назначения, в основном предназначенный для веб разработки. Этот язык может быть встроен в HTML, его синтаксис заимствован из C, Java™ и Perl, и он позволяет веб разработчикам быстро писать динамически генерируемые страницы.</p></div><div class=paragraph><p>Добавление поддержки PHP5 к веб серверу Apache производится путем установки порта <a class=package href=https://cgit.freebsd.org/ports/tree/lang/mod_php5/>lang/mod_php5</a>.</p></div><div class=paragraph><p>Если порт <a class=package href=https://cgit.freebsd.org/ports/tree/lang/php5/>lang/php5</a> устанавливается впервые, то автоматически отобразятся все доступные опции (<code>OPTIONS</code>). Если меню не отображается, так как порт <a class=package href=https://cgit.freebsd.org/ports/tree/lang/php5/>lang/php5</a> устанавливался ранее, всегда можно повторно вызвать диалог меню выполнив следующую команду в каталоге порта:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># make config</span></code></pre></div></div><div class=paragraph><p>Выберите в меню опцию <code>APACHE</code>, тем самым вы построите загружаемый модуль mod_php5 для веб сервера Apache.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Множество сайтов по разным причинам (например, из-за проблем совместимости или из-за наличия уже развёрнутых веб приложений) всё еще используют PHP4. Если требуется mod_php4 вместо mod_php5, то воспользуйтесь портом <a class=package href=https://cgit.freebsd.org/ports/tree/lang/php4/>lang/php4</a>. Порт <a class=package href=https://cgit.freebsd.org/ports/tree/lang/php4/>lang/php4</a> поддерживает многие из конфигурационных и установочных опций порта <a class=package href=https://cgit.freebsd.org/ports/tree/lang/php5/>lang/php5</a>.</p></div></td></tr></tbody></table></div><div class=paragraph><p>Этот порт устанавливает и настраивает модули, необходимые для поддержки динамических PHP веб страниц. Убедитесь, что в файл <span class=filename>/usr/local/etc/apache/httpd.conf</span> были добавлены следующие секции:</p></div><div class="literalblock programlisting"><div class=content><pre>LoadModule php5_module        libexec/apache/libphp5.so</pre></div></div><div class="literalblock programlisting"><div class=content><pre>AddModule mod_php5.c
    &lt;IfModule mod_php5.c&gt;
        DirectoryIndex index.php index.html
    &lt;/IfModule&gt;
    &lt;IfModule mod_php5.c&gt;
        AddType application/x-httpd-php .php
        AddType application/x-httpd-php-source .phps
    &lt;/IfModule&gt;</pre></div></div><div class=paragraph><p>Для загрузки модуля PHP после этого просто вызовите команду <code>apachectl</code> с параметром graceful:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># apachectl graceful</span></code></pre></div></div><div class=paragraph><p>При дальнейших обновлениях PHP команда <code>make config</code> больше не потребуется; выбранные опции сохраняются автоматически инфраструктурой портов FreeBSD</p></div><div class=paragraph><p>Поддержка PHP в FreeBSD построена по модульному принципу, поэтому базовая установка обладает очень ограниченной функциональностью. Дополнительная функциональность может быть легко добавлена при помощи порта <a class=package href=https://cgit.freebsd.org/ports/tree/lang/php5-extensions/>lang/php5-extensions</a>, управляющего набором расширений PHP через меню, либо просто путем установки дополнительных портов.</p></div><div class=paragraph><p>Например, для добавления поддержки MySQL к PHP5, просто установите порт <span class=filename>databases/php5-mysql</span>.</p></div><div class=paragraph><p>После установки новых расширений сервер Apache должен быть рестартован, чтобы изменения в конфигурации вступили в силу:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># apachectl graceful</span></code></pre></div></div></div></div></div></div><div class=sect1><h2 id=network-samba>25.8. Файл сервер и печать для Microsoft® Windows® клиентов (Samba)<a class=anchor href=#network-samba></a></h2><div class=sectionbody><div class=sect2><h3 id=_обзор_3>25.8.1. Обзор<a class=anchor href=#_обзор_3></a></h3><div class=paragraph><p>Samba это популярный пакет программ с открытыми исходными текстами, которая предоставляет файловые и принт-сервисы Microsoft® Windows® клиентам. Эти клиенты могут подключаться и использовать файловое пространство FreeBSD, как если бы это был локальный диск, или принтеры FreeBSD, как если бы это были локальные принтеры.</p></div><div class=paragraph><p>Пакет Samba должен быть включен в поставку FreeBSD. Если вы не установили Samba при первой установке системы, ее можно установить из порта или пакета <a class=package href=https://cgit.freebsd.org/ports/tree/net/samba34/>net/samba34</a>.</p></div></div><div class=sect2><h3 id=_настройка_2>25.8.2. Настройка<a class=anchor href=#_настройка_2></a></h3><div class=paragraph><p>Файл настройки Samba по умолчанию устанавливается в <span class=filename>/usr/local/shared/examples/samba34/smb.conf.default</span>. Этот файл необходимо скопировать в <span class=filename>/usr/local/etc/smb.conf</span> и отредактировать перед использованием Samba.</p></div><div class=paragraph><p>В файле <span class=filename>smb.conf</span> находится информация, необходимая для работы Samba, например определение принтеров и "общих каталогов", которые будут использоваться совместно с Windows® клиентами. В пакет Samba входит программа с веб интерфейсом, называемая swat, которая дает простой способ редактирования файла <span class=filename>smb.conf</span>.</p></div><div class=sect3><h4 id=_использование_samba_web_administration_tool_swat>25.8.2.1. Использование Samba Web Administration Tool (SWAT)<a class=anchor href=#_использование_samba_web_administration_tool_swat></a></h4><div class=paragraph><p>Программа веб администрирования Samba (Samba Web Administration Tool, SWAT) запускается как даемон из inetd. Следовательно, в <span class=filename>/etc/inetd.conf</span> необходимо снять комментарий перед тем, как использовать swat для настройки Samba:</p></div><div class="literalblock programlisting"><div class=content><pre>swat   stream  tcp     nowait/400      root    /usr/local/sbin/swat    swat</pre></div></div><div class=paragraph><p>Как описано в <a href=#network-inetd-reread>Перезагрузка конфигурационного файла inetd</a>, после изменения настроек inetd необходимо перечитать конфигурацию.</p></div><div class=paragraph><p>Как только swat был включен <span class=filename>inetd.conf</span>, вы можете использовать браузер для подключения к <a href=http://localhost:901>http://localhost:901</a>. Сначала необходимо зарегистрироваться с системной учетной записью <code>root</code>.</p></div><div class=paragraph><p>После успешного входа на основную страницу настройки Samba, вы можете просмотреть документацию или начать настройку, нажав на кнопку <b class=menuref>Globals</b>. Раздел <b class=menuref>Globals</b> соответствует переменным, установленным в разделе <code>[global]</code> файла <span class=filename>/usr/local/etc/smb.conf</span>.</p></div></div><div class=sect3><h4 id=_глобальные_настройки>25.8.2.2. Глобальные настройки<a class=anchor href=#_глобальные_настройки></a></h4><div class=paragraph><p>Независимо от того, используете ли вы swat, или редактируете <span class=filename>/usr/local/etc/smb.conf</span> непосредственно, первые директивы, которые вы скорее всего встретите при настройке Samba, будут следующими:</p></div><div class=dlist><dl><dt class=hdlist1><code>workgroup</code></dt><dd><p>Имя домена или рабочей группы NT для компьютеров, которые будут получать доступ к этому серверу.</p></dd><dt class=hdlist1><code>netbios name</code></dt><dd><p>Устанавливает имя NetBIOS, под которым будет работать Samba сервер. По умолчанию оно устанавливается равным первому компоненту DNS имени хоста.</p></dd><dt class=hdlist1><code>server string</code></dt><dd><p>Устанавливает строку, которая будет показана командой <code>net view</code> и некоторыми другими сетевыми инструментами, которые отображают строку описания сервера.</p></dd></dl></div></div><div class=sect3><h4 id=_настройки_безопасности>25.8.2.3. Настройки безопасности<a class=anchor href=#_настройки_безопасности></a></h4><div class=paragraph><p>Две из наиболее важных настроек в <span class=filename>/usr/local/etc/smb.conf</span> отвечают за выбор модели безопасности и за формат паролей для клиентов. Эти параметры контролируются следующими директивами:</p></div><div class=dlist><dl><dt class=hdlist1><code>security</code></dt><dd><p>Два наиболее часто используемых параметра это <code>security = share</code> и <code>security = user</code>. Если имена пользователей для клиентов совпадают с их именами на компьютере FreeBSD, вы возможно захотите включить безопасность уровня пользователя (user). Это политика безопасности по умолчанию, она требует, чтобы клиент авторизовался перед доступом к совместно используемым ресурсам.</p><div class=paragraph><p>На уровне безопасности share клиенту не требуется входить на сервер перед подключением к ресурсу. Эта модель безопасности использовалась по умолчанию в старых версиях Samba.</p></div></dd><dt class=hdlist1><code>passdb backend</code></dt><dd><p>Samba поддерживает несколько различных подсистем аутентификации. Вы можете аутентифицировать клиентов с помощью LDAP, NIS+, базы данных SQL, или через модифицированный файл паролей. Метод аутентификации по умолчанию <code>smbpasswd</code>, и здесь рассматривается только он.</p></dd></dl></div><div class=paragraph><p>Предполагая, что используется подсистема по умолчанию <code>smbpasswd</code>, необходимо создать файл <span class=filename>/usr/local/etc/samba/smbpasswd</span>, чтобы Samba могла аутентифицировать клиентов. Если вы хотите разрешить к учетным записям UNIX® доступ с Windows® клиентов, используйте следующую команду:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># smbpasswd -a username</span></code></pre></div></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Ныне рекомендуемой подсистемой аутентификации является <code>tdbsam</code>, поэтому для добавления пользователей используйте следующую команду:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># pdbedit -a -u username</span></code></pre></div></div></td></tr></tbody></table></div><div class=paragraph><p>Пожалуйста, обратитесь к <a href=http://www.samba.org/samba/docs/man/Samba-HOWTO-Collection/>Official Samba HOWTO</a> за дополнительной информацией о параметрах настройки. Основные настройки, рассмотренные здесь, достаточны для первого запуска Samba.</p></div></div></div><div class=sect2><h3 id=_запуск_samba>25.8.3. Запуск Samba<a class=anchor href=#_запуск_samba></a></h3><div class=paragraph><p>Порт <a class=package href=https://cgit.freebsd.org/ports/tree/net/samba34/>net/samba34</a> добавляет новый стартовый сценарий, который может быть использован для контроля Samba. Для того, чтобы им можно было запускать, останавливать или перезапускать сервер Samba, добавьте следующую запись в файл <span class=filename>/etc/rc.conf</span>:</p></div><div class="literalblock programlisting"><div class=content><pre>samba_enable=&#34;YES&#34;</pre></div></div><div class=paragraph><p>Или, для более тонкого контроля:</p></div><div class="literalblock programlisting"><div class=content><pre>nmbd_enable=&#34;YES&#34;</pre></div></div><div class="literalblock programlisting"><div class=content><pre>smbd_enable=&#34;YES&#34;</pre></div></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Внесение этих записей в <span class=filename>/etc/rc.conf</span> также обеспечит автоматический запуск сервера Samba во время старта системы.</p></div></td></tr></tbody></table></div><div class=paragraph><p>Теперь становится возможным запустить сервер Samba, для чего наберите следующую команду:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># /usr/local/etc/rc.d/samba start</span>
Starting SAMBA: removing stale tdbs :
Starting nmbd.
Starting smbd.</code></pre></div></div><div class=paragraph><p>За дальнейшей информацией об использовании rc скриптов обратитесь к <a href=../config/#configtuning-rcd>Использование rc во FreeBSD 5.X и последующих версиях</a>.</p></div><div class=paragraph><p>Samba состоит из трех отдельных даемонов. Вы можете видеть, что nmbd и smbd запускаются скриптом <span class=filename>samba</span>. Если вы включили сервис разрешения имен winbind в <span class=filename>smb.conf</span>, то увидите также запуск даемона winbindd.</p></div><div class=paragraph><p>Вы можете остановить Samba в любой момент, набрав:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># /usr/local/etc/rc.d/samba stop</span></code></pre></div></div><div class=paragraph><p>Samba это сложный программный набор с функциональностью, позволяющей полную интеграцию в сети Microsoft® Windows®. За дальнейшей информацией о функциях, выходящих за рамки описанной здесь базовой установки, обращайтесь к <a href=http://www.samba.org>http://www.samba.org</a>.</p></div></div></div></div><div class=sect1><h2 id=network-ftp>25.9. Протокол передачи файлов (FTP)<a class=anchor href=#network-ftp></a></h2><div class=sectionbody><div class=sect2><h3 id=_обзор_4>25.9.1. Обзор<a class=anchor href=#_обзор_4></a></h3><div class=paragraph><p>Протокол передачи файлов (File Transfer Protocol, FTP) дает пользователям простой путь передачи файлов на и с FTP сервера. В FreeBSD серверная программа FTP, ftpd, включена в базовую систему. Это упрощает настройку и администрирование FTP сервера в FreeBSD.</p></div></div><div class=sect2><h3 id=_настройка_3>25.9.2. Настройка<a class=anchor href=#_настройка_3></a></h3><div class=paragraph><p>Наиболее важный шаг заключается в определении того, каким учетным записям будет позволено получать доступ к FTP серверу. В обычной системе FreeBSD есть множество системных учетных записей, используемых различными даемонами, но пользователям должно быть запрещен вход с использованием этих учетных записей. В файле <span class=filename>/etc/ftpusers</span> находится список пользователей, которым запрещен доступ по FTP. По умолчанию он включает упомянутые системные учетные записи, но в него можно добавить и определенных пользователей, которым будет запрещен доступ по FTP.</p></div><div class=paragraph><p>Вам может понадобиться ограничить доступ определенных пользователей без полного запрета использования FTP. Это можно сделать через файл <span class=filename>/etc/ftpchroot</span>. В нем находится список пользователей и групп, к которым применяется ограничение доступа. На странице справочника <a href="https://man.freebsd.org/cgi/man.cgi?query=ftpchroot&amp;sektion=5&amp;format=html">ftpchroot(5)</a> дана подробная информация, и она не будет дублироваться здесь.</p></div><div class=paragraph><p>Если вы захотите разрешить анонимный FTP доступ на сервер, в системе FreeBSD необходимо создать пользователя <code>ftp</code>. Этот пользователь сможет входить на FTP сервер с именем пользователя <code>ftp</code> или <code>anonymous</code>, с любым паролем (существует соглашение об использовании почтового адреса пользователя в качестве пароля). FTP сервер выполнит <a href="https://man.freebsd.org/cgi/man.cgi?query=chroot&amp;sektion=2&amp;format=html">chroot(2)</a> при входе пользователя anonymous для ограничения доступа только домашним каталогом пользователя <code>ftp</code>.</p></div><div class=paragraph><p>Существуют два текстовых файла, определяющих сообщение, отправляемое FTP клиентам. Содержимое файла <span class=filename>/etc/ftpwelcome</span> будет выведено пользователям перед приглашением на вход. После успешного входа будет выведено содержимое файла <span class=filename>/etc/ftpmotd</span>. Обратите внимание, что путь к этому файлу задается относительно домашнего каталога пользователя, так что анонимным пользователям будет отправляться <span class=filename>~ftp/etc/ftpmotd</span>.</p></div><div class=paragraph><p>Как только FTP сервер был правильно настроен, он должен быть включен в <span class=filename>/etc/inetd.conf</span>. Все, что необходимо, это удалить символ комментария "#" из начала существующей строки ftpd:</p></div><div class="literalblock programlisting"><div class=content><pre>ftp	stream	tcp	nowait	root	/usr/libexec/ftpd	ftpd -l</pre></div></div><div class=paragraph><p>Как описано в <a href=#network-inetd-reread>Перезагрузка конфигурационного файла inetd</a>, inetd должен перечитать конфигурацию после того, как этот файл настройки был изменен. Пожалуйста обратитесь к <a href=#network-inetd-settings>Настройки</a> за деталями по запуску inetd на вашей системе.</p></div><div class=paragraph><p>В качестве альтернативы, демон ftpd может быть запущен как самостоятельный сервер. В этом случае достаточно установить соответствующую переменную в файле <span class=filename>/etc/rc.conf</span>:</p></div><div class="literalblock programlisting"><div class=content><pre>ftpd_enable=&#34;YES&#34;</pre></div></div><div class=paragraph><p>Демон будет запущен автоматически при следующей загрузке системы. Также демон можно запустить вручную, для чего выполните следующую команду как пользователь <code>root</code>:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># /etc/rc.d/ftpd start</span></code></pre></div></div><div class=paragraph><p>Теперь вы можете войти на FTP сервер, введя:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>% ftp localhost</code></pre></div></div></div><div class=sect2><h3 id=_поддержка>25.9.3. Поддержка<a class=anchor href=#_поддержка></a></h3><div class=paragraph><p>Для протоколирования даемон ftpd использует сообщения <a href="https://man.freebsd.org/cgi/man.cgi?query=syslog&amp;sektion=3&amp;format=html">syslog(3)</a>. По умолчанию, <a href="https://man.freebsd.org/cgi/man.cgi?query=syslog&amp;sektion=3&amp;format=html">syslog(3)</a> поместит сообщения, относящиеся к FTP, в файл <span class=filename>/var/log/xferlog</span>. Местоположение лог файла FTP может быть изменено путем изменения следующей строки в файле <span class=filename>/etc/syslog.conf</span>:</p></div><div class="literalblock programlisting"><div class=content><pre>ftp.info      /var/log/xferlog</pre></div></div><div class=paragraph><p>Учитывайте потенциальные проблемы, возникающие с анонимным FTP сервером. В частности, вы должны дважды подумать, прежде чем позволить анонимным пользователям загружать файлы на сервер. Вы можете обнаружить, что FTP сайт стал форумом, на котором происходит обмен нелицензионным коммерческим программным обеспечением или чем-то еще хуже. Если вам необходимо разрешить анонимную выгрузку файлов на FTP, права должны быть настроены таким образом, чтобы эти файлы не могли прочитать другие анонимные пользователи до их рассмотрения администратором.</p></div></div></div></div><div class=sect1><h2 id=network-ntp>25.10. Синхронизация часов через NTP<a class=anchor href=#network-ntp></a></h2><div class=sectionbody><div class=sect2><h3 id=_обзор_5>25.10.1. Обзор<a class=anchor href=#_обзор_5></a></h3><div class=paragraph><p>С течением времени часы компьютера имеют тенденцию отставать. Network Time Protocol - Сетевой Протокол Времени (NTP) является одним из способов вести точное время.</p></div><div class=paragraph><p>Многие сервисы Интернет опираются или сильно зависят от точности часов компьютеров. К примеру, веб-сервер может получать запрос на посылку файла, который был недавно модифицирован. В локальной сети необходимо, чтобы часы компьютеров, совместно использующих файлы, были синхронизированы, чтобы время модификации файлов устанавливалось правильно. Такие службы, как <a href="https://man.freebsd.org/cgi/man.cgi?query=cron&amp;sektion=8&amp;format=html">cron(8)</a>, также зависят от правильности установки системных часов, поскольку запускают команды в определенное время.</p></div><div class=paragraph><p>FreeBSD поставляется с сервером NTP <a href="https://man.freebsd.org/cgi/man.cgi?query=ntpd&amp;sektion=8&amp;format=html">ntpd(8)</a>, который можно использовать для опроса других серверов NTP для установки часов на вашей машине или предоставления услуг точного времени.</p></div></div><div class=sect2><h3 id=_выбор_подходящих_серверов_ntp>25.10.2. Выбор подходящих серверов NTP<a class=anchor href=#_выбор_подходящих_серверов_ntp></a></h3><div class=paragraph><p>Для синхронизации ваших часов вам нужно найти для использования один или большее количество серверов NTP. Ваш сетевой администратор или провайдер могут иметь сервер NTP для этой цели-обратитесь к ним, так ли это в вашем случае. Существует <a href=http://support.ntp.org/bin/view/Servers/WebHome>онлайн список общедоступных серверов NTP</a>, которым можно воспользоваться для поиска ближайшего к вам сервера NTP. Не забудьте выяснить политику выбранного вами сервера и спросить разрешения, если это требуется.</p></div><div class=paragraph><p>Выбор нескольких несвязанных серверов NTP является хорошей идеей в том случае, если один из используемых вами серверов станет недоступным или его часы неточны. <a href="https://man.freebsd.org/cgi/man.cgi?query=ntpd&amp;sektion=8&amp;format=html">ntpd(8)</a> использует ответы, которые он получает от других серверов с умом-он делает предпочтение надежным серверам.</p></div></div><div class=sect2><h3 id=_настройка_вашей_машины>25.10.3. Настройка вашей машины<a class=anchor href=#_настройка_вашей_машины></a></h3><div class=sect3><h4 id=_базовая_конфигурация>25.10.3.1. Базовая конфигурация<a class=anchor href=#_базовая_конфигурация></a></h4><div class=paragraph><p>Если вам нужно только синхронизировать ваши часы при загрузке машины, вы можете воспользоваться утилитой <a href="https://man.freebsd.org/cgi/man.cgi?query=ntpdate&amp;sektion=8&amp;format=html">ntpdate(8)</a>. Это может подойти для некоторых настольных машин, которые часто перезагружаются и только требуют изредка синхронизироваться, но на большинстве машин должен работать <a href="https://man.freebsd.org/cgi/man.cgi?query=ntpd&amp;sektion=8&amp;format=html">ntpd(8)</a>.</p></div><div class=paragraph><p>Использование <a href="https://man.freebsd.org/cgi/man.cgi?query=ntpdate&amp;sektion=8&amp;format=html">ntpdate(8)</a> при загрузке также хорошо для машин, на которых запущен даемон <a href="https://man.freebsd.org/cgi/man.cgi?query=ntpd&amp;sektion=8&amp;format=html">ntpd(8)</a>. Программа <a href="https://man.freebsd.org/cgi/man.cgi?query=ntpd&amp;sektion=8&amp;format=html">ntpd(8)</a> изменяет время постепенно, тогда как <a href="https://man.freebsd.org/cgi/man.cgi?query=ntpdate&amp;sektion=8&amp;format=html">ntpdate(8)</a> устанавливает время вне зависимости от того, насколько велика разница между текущим временем машины и точным временем.</p></div><div class=paragraph><p>Для включения <a href="https://man.freebsd.org/cgi/man.cgi?query=ntpdate&amp;sektion=8&amp;format=html">ntpdate(8)</a> во время загрузки, добавьте строчку <code>ntpdate_enable="YES"</code> в файл <span class=filename>/etc/rc.conf</span>. Вам также потребуется указать все серверы, с которыми вы хотите синхронизироваться, и все параметры, которые передаются в <a href="https://man.freebsd.org/cgi/man.cgi?query=ntpdate&amp;sektion=8&amp;format=html">ntpdate(8)</a>, в <code>ntpdate_flags</code>.</p></div></div><div class=sect3><h4 id=_общие_настройки>25.10.3.2. Общие настройки<a class=anchor href=#_общие_настройки></a></h4><div class=paragraph><p>NTP настраивается в файле <span class=filename>/etc/ntp.conf</span>, формат которого описан в <a href="https://man.freebsd.org/cgi/man.cgi?query=ntp.conf&amp;sektion=5&amp;format=html">ntp.conf(5)</a>. Вот простой пример:</p></div><div class="literalblock programlisting"><div class=content><pre>server ntplocal.example.com prefer
server timeserver.example.org
server ntp2a.example.net

driftfile /var/db/ntp.drift</pre></div></div><div class=paragraph><p>Параметр <code>server</code> задает, какие серверы будут использоваться, по одному в каждой строке. Если сервер задан с аргументом <code>prefer</code>, как <code>ntplocal.example.com</code>, то этому серверу отдается предпочтение перед остальными. Ответ от предпочтительного сервера будет отброшен, если он значительно отличается от ответов других серверов, в противном случае он будет использоваться безотносительно к другим ответам. Аргумент <code>prefer</code> обычно используется для серверов NTP, о которых известно, что они очень точны, такими, на которых используется специальное оборудование точного времени.</p></div><div class=paragraph><p>Параметр <code>driftfile</code> задает файл, который используется для хранения смещения частоты системных часов. Программа <a href="https://man.freebsd.org/cgi/man.cgi?query=ntpd&amp;sektion=8&amp;format=html">ntpd(8)</a> использует его для автоматической компенсации естественного смещения часов, позволяя ему поддерживать достаточно правильную настройку, даже если он на некоторый период отключается от внешнего источника информации о времени.</p></div><div class=paragraph><p>Параметр <code>driftfile</code> задает, какой файл используется для сохранения информации о предыдущих ответах от серверов NTP, которые вы используете. Этот файл содержит внутреннюю информацию для NTP. Он не должен изменяться никакими другими процессами.</p></div></div><div class=sect3><h4 id=_управление_доступом_к_вашему_серверу>25.10.3.3. Управление доступом к вашему серверу<a class=anchor href=#_управление_доступом_к_вашему_серверу></a></h4><div class=paragraph><p>По умолчанию ваш сервер NTP будет доступен всем хостам в Интернет. Параметр <code>restrict</code> в файле <span class=filename>/etc/ntp.conf</span> позволяет вам контролировать, какие машины могут обращаться к вашему серверу.</p></div><div class=paragraph><p>Если вы хотите запретить всем машинам обращаться к вашему серверу NTP, добавьте следующую строку в файл <span class=filename>/etc/ntp.conf</span>:</p></div><div class="literalblock programlisting"><div class=content><pre>restrict default ignore</pre></div></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Эта строка конфигурации также предотвратит доступ вашего сервера к другим серверам, перечисленным в вашей локальной конфигурации. Если вам необходимо синхронизировать ваш сервер с внешним сервером NTP, вам необходимо будет изменить настройки относительно этого конкретного сервера. За более детальной информацией обратитесь к странице руководства <a href="https://man.freebsd.org/cgi/man.cgi?query=ntp.conf&amp;sektion=5&amp;format=html">ntp.conf(5)</a>.</p></div></td></tr></tbody></table></div><div class=paragraph><p>Если вы хотите разрешить синхронизировать свои часы с вашим сервером только машинам в вашей сети, но запретить им настраивать сервер или быть равноправными участниками синхронизации времени, то вместо указанной добавьте строчку</p></div><div class="literalblock programlisting"><div class=content><pre>restrict 192.168.1.0 mask 255.255.255.0 nomodify notrap</pre></div></div><div class=paragraph><p>где <code>192.168.1.0</code> является адресом IP вашей сети, а <code>255.255.255.0</code> её сетевой маской.</p></div><div class=paragraph><p><span class=filename>/etc/ntp.conf</span> может содержать несколько директив <code>restrict</code>. Для получения подробной информации обратитесь к подразделу <code>Access Control Support</code> (Поддержка Управления Доступом) в <a href="https://man.freebsd.org/cgi/man.cgi?query=ntp.conf&amp;sektion=5&amp;format=html">ntp.conf(5)</a>.</p></div></div></div><div class=sect2><h3 id=_запуск_сервера_ntp>25.10.4. Запуск сервера NTP<a class=anchor href=#_запуск_сервера_ntp></a></h3><div class=paragraph><p>Для того, чтобы сервер NTP запускался при загрузке, добавьте строку <code>ntpd_enable="YES"</code> в файл <span class=filename>/etc/rc.conf</span>. Если вы хотите передать дополнительные опции в <a href="https://man.freebsd.org/cgi/man.cgi?query=ntpd&amp;sektion=8&amp;format=html">ntpd(8)</a>, то отредактируйте параметр <code>ntpd_flags</code> в файле <span class=filename>/etc/rc.conf</span>.</p></div><div class=paragraph><p>Для запуска сервера без перезагрузки вашей машины, выполните команду <code>ntpd</code>, не забыв задать дополнительные параметры из переменной <code>ntpd_flags</code> в файле <span class=filename>/etc/rc.conf</span>. К примеру:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># ntpd -p /var/run/ntpd.pid</span></code></pre></div></div></div><div class=sect2><h3 id=_использование_ntpd_с_временным_подключением_к_интернет>25.10.5. Использование ntpd с временным подключением к Интернет<a class=anchor href=#_использование_ntpd_с_временным_подключением_к_интернет></a></h3><div class=paragraph><p>Для нормальной работы программе <a href="https://man.freebsd.org/cgi/man.cgi?query=ntpd&amp;sektion=8&amp;format=html">ntpd(8)</a> не требуется постоянное подключение к Интернет. Однако если ваше временное подключение к Интернет настроено для дозвона по требованию, хорошо бы запретить трафику NTP вызывать дозвон или поддерживать соединение постоянно. Если вы используете пользовательский PPP, то можете воспользоваться директивами <code>filter</code> в файле <span class=filename>/etc/ppp/ppp.conf</span>. К примеру:</p></div><div class="literalblock programlisting"><div class=content><pre> set filter dial 0 deny udp src eq 123
 # Prevent NTP traffic from initiating dial out
 set filter dial 1 permit 0 0
 set filter alive 0 deny udp src eq 123
 # Prevent incoming NTP traffic from keeping the connection open
 set filter alive 1 deny udp dst eq 123
 # Prevent outgoing NTP traffic from keeping the connection open
 set filter alive 2 permit 0/0 0/0</pre></div></div><div class=paragraph><p>Более подробную информацию можно найти в разделе <code>PACKET FILTERING</code> (ФИЛЬТРАЦИЯ ПАКЕТОВ) в <a href="https://man.freebsd.org/cgi/man.cgi?query=ppp&amp;sektion=8&amp;format=html">ppp(8)</a>, а примеры в <span class=filename>/usr/shared/examples/ppp/</span>.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Некоторые провайдеры Интернет блокируют трафик по портам с маленькими номерами, что приводит к неработоспособности NTP, так как ответы никогда не достигают вашей машины.</p></div></td></tr></tbody></table></div></div><div class=sect2><h3 id=_дополнительная_литература_2>25.10.6. Дополнительная литература<a class=anchor href=#_дополнительная_литература_2></a></h3><div class=paragraph><p>Документация по серверу NTP может быть найдена в каталоге <span class=filename>/usr/shared/doc/ntp/</span> в формате HTML.</p></div></div></div></div><div class=sect1><h2 id=network-syslogd>25.11. * Remote Host Logging with <code>syslogd</code><a class=anchor href=#network-syslogd></a></h2><div class=sectionbody><div class=paragraph><p>Этот раздел не переведен.</p></div></div></div></div><hr><div class=last-modified><p><strong>Изменено</strong>: 9 марта 2024 г. by <a href="https://cgit.freebsd.org/doc/commit/?id=6199af92e7" target=_blank>Danilo G. Baio</a></p></div><div class=buttons><div class=prev><i class="fa fa-angle-left" aria-hidden=true title=Назад></i><div class=container><a href=http://172.16.201.134:1313/ru/books/handbook/mail class=direction>Назад</a></div></div><div class=home><i class="fa fa-home" aria-hidden=true title=Главная></i><div class=container><a href=../ class=direction>Главная</a></div></div><div class=next><div class=container><a href=http://172.16.201.134:1313/ru/books/handbook/firewalls class=direction>Далее</a></div><i class="fa fa-angle-right" aria-hidden=true title=Далее></i></div></div><label class="hidden book-menu-overlay" for=menu-control></label></div><aside class=toc><div class=toc-content><h3>Содержание</h3><nav id=TableOfContents><ul><li><a href=#network-servers-synopsis>25.1. Краткий обзор</a></li><li><a href=#network-inetd>25.2. "Супер-сервер"inetd</a></li><li><a href=#network-nfs>25.3. Network File System (NFS)</a></li><li><a href=#network-nis>25.4. Network Information System (NIS/YP)</a></li><li><a href=#network-dhcp>25.5. Автоматическая настройка сети (DHCP)</a></li><li><a href=#network-dns>25.6. Domain Name System (DNS)</a></li><li><a href=#network-apache>25.7. Apache HTTP сервер</a></li><li><a href=#network-samba>25.8. Файл сервер и печать для Microsoft® Windows® клиентов (Samba)</a></li><li><a href=#network-ftp>25.9. Протокол передачи файлов (FTP)</a></li><li><a href=#network-ntp>25.10. Синхронизация часов через NTP</a></li><li><a href=#network-syslogd>25.11. * Remote Host Logging with <code>syslogd</code></a></li></ul></nav><hr><div class=resources><h3>Материалы</h3><ul class=contents><li><i class="fa fa-file-pdf-o" aria-hidden=true title="Скачать PDF"></i><a href=https://download.freebsd.org/doc/ru/books/handbook/handbook_ru.pdf>Скачать PDF</a></li><li><i class="fa fa-pencil-square-o" aria-hidden=true title="Редактировать эту страницу"></i><a href=https://github.com/freebsd/freebsd-doc/blob/main/documentation/content/ru/_index target=_blank>Редактировать эту страницу</a></li></ul></div></div></aside><a class=to-top href=#top><i class="fa fa-arrow-circle-up" aria-hidden=true></i></a></main><footer><div class=footer-container><section class=logo-column><img src=http://172.16.201.134:1313/images/FreeBSD-colors.svg width=160 height=50 alt="FreeBSD logo"><div class=options-container><div class=language-container><a id=languages href=http://172.16.201.134:1313/ru/languages><img src=http://172.16.201.134:1313/images/language.png class=language-image alt="Выберите язык">
<span>Русский</span></a></div><div class=theme-container><select id=theme-chooser><option value=theme-system>Система</option><option value=theme-light>Светлый</option><option value=theme-dark>Тёмный</option><option value=theme-high-contrast>Высокая контрастность</option></select></div></div></section><section class=about-column><h3 class=column-title>О нас</h3><ul class=column-elements-container><li><a href=https://www.freebsd.org/about/ target=_blank class=column-element>FreeBSD</a></li><li><a href=https://freebsdfoundation.org/ target=_blank class=column-element>Фонд FreeBSD</a></li><li><a href=https://www.freebsd.org/where/ target=_blank class=column-element>Получить FreeBSD</a></li><li><a href=https://www.freebsd.org/internal/code-of-conduct target=_blank class=column-element>Кодекс Этики</a></li><li><a href=https://www.freebsd.org/security/ target=_blank class=column-element>Бюллетени Безопасности</a></li></ul></section><section class=documentation-column><h3 class=column-title>Документация</h3><ul class=column-elements-container><li><a href=/ru class=column-element>Портал документации</a></li><li><a href=https://man.FreeBSD.org target=_blank class=column-element>Страницы Справочника</a></li><li><a href=https://papers.FreeBSD.org target=_blank class=column-element>Презентации и публикации</a></li><li><a href=https://docs-archive.freebsd.org/doc/ target=_blank class=column-element>Предыдущие версии</a></li><li><a href=https://docs-archive.freebsd.org/44doc/ target=_blank class=column-element>Документы 4.4BSD</a></li><li><a href=https://wiki.freebsd.org/ target=_blank class=column-element>Wiki</a></li></ul></section><section class=community-column><h3 class=column-title>Сообщество</h3><ul class=column-elements-container><li><a href=http://172.16.201.134:1313/ru/articles/contributing class=column-element>Принять участие</a></li><li><a href=https://forums.freebsd.org/ target=_blank class=column-element>Форум Сообщества</a></li><li><a href=https://lists.freebsd.org/ target=_blank class=column-element>Списки рассылки</a></li><li><a href=https://wiki.freebsd.org/IRC/Channels target=_blank class=column-element>Каналы IRC</a></li><li><a href=https://bugs.freebsd.org/bugzilla/ target=_blank class=column-element>Трекер ошибок</a></li></ul></section><section class=legal-column><h3 class=column-title>Юридическая информация</h3><ul class=column-elements-container><li><a href=https://freebsdfoundation.org/donate/ target=_blank class=column-element>Пожертвования</a></li><li><a href=https://www.freebsd.org/copyright/freebsd-license/ target=_blank class=column-element>Лицензирование</a></li><li><a href=https://www.freebsd.org/privacy/ target=_blank class=column-element>Политика Конфиденциальности</a></li><li><a href=https://www.freebsd.org/copyright/ target=_blank class=column-element>Юридические оговорки</a></li></ul></section><section class=copyright-column><p>&copy; 1994-2024 Проект FreeBSD. Все права защищены</p><span>Сделано с помощью <span class=heart>♥</span> Сообществом FreeBSD</span></section></div></footer></body></html>