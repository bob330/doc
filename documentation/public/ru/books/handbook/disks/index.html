<!doctype html><html class=theme-light lang=ru><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content><meta name=keywords content><meta name=copyright content="1995-2024 The FreeBSD Foundation"><link rel=canonical href=https://docs.freebsd.org/ru/books/handbook/disks/><title>Глава 17. Устройства хранения | FreeBSD Documentation Portal</title>
<meta name=theme-color content="#790000"><meta name=color-scheme content="system light dark high-contrast"><link rel="shortcut icon" href=https://docs.freebsd.org/favicon.ico><link rel=stylesheet href=https://docs.freebsd.org/styles/main.min.css><link rel=stylesheet href=https://docs.freebsd.org/css/font-awesome-min.css><script defer src=/js/theme-chooser.min.js></script><script defer src=/js/copy-clipboard.min.js></script><script defer src=/js/search.min.js></script><meta name=twitter:card content="summary"><meta name=twitter:domain content="docs.FreeBSD.org"><meta name=twitter:site content="@freebsd"><meta name=twitter:url content="https://twitter.com/freebsd"><meta property="og:title" content="Глава 17. Устройства хранения"><meta property="og:description" content><meta property="og:type" content="website"><meta property="og:image" content="https://docs.freebsd.org/favicon.ico"><meta property="og:image:alt" content="FreeBSD Logo"><meta property="og:locale" content="ru"><meta property="og:url" content="https://docs.freebsd.org/ru/books/handbook/disks/"><meta property="og:site_name" content="FreeBSD Documentation Portal"><script type=application/ld+json>{"@context":"http://schema.org","@type":"Article","url":"https:\/\/docs.freebsd.org\/ru\/books\/handbook\/disks\/","name":"FreeBSD Documentation Portal","headline":"FreeBSD Documentation Portal","description":"FreeBSD Documentation Portal"}</script></head><body><header><div class=header-container><div class=logo-menu-bars-container><a href=https://www.FreeBSD.org class=logo><img src=https://docs.freebsd.org/images/FreeBSD-monochromatic.svg width=160 height=50 alt="FreeBSD logo">
</a><label class=menu-bars for=menu-bars><i class="fa fa-bars" aria-hidden=true></i></label></div><input id=menu-bars type=checkbox><nav><ul class=menu><li class=menu-item><input id=about type=checkbox>
<a href=# aria-label="Navigate to About section"><label class=menu-item-description for=about>О нас
<i class="fa fa-angle-down fa-lg" aria-hidden=true></i></label></a><ul class=sub-menu><li class=title><a href=https://www.freebsd.org/about/ target=_blank>О нас</a></li><li><a href=https://www.freebsd.org/about/ target=_blank>FreeBSD</a></li><li><a href=https://freebsdfoundation.org/about-us/about-the-foundation/ target=_blank>Фонд FreeBSD</a></li><li><a href=https://www.freebsd.org/internal/code-of-conduct/ target=_blank>Кодекс Этики</a></li></ul></li><li class=menu-item><input id=download type=checkbox>
<a href=# aria-label="Navigate to get FreeBSD section"><label class=menu-item-description for=download>Получить FreeBSD
<i class="fa fa-angle-down fa-lg" aria-hidden=true></i></label></a><ul class=sub-menu><li class=title><a href=https://www.freebsd.org/where/ target=_blank>Получить FreeBSD</a></li><li><a href=https://www.freebsd.org/releases/ target=_blank>Информация о релизах</a></li><li><a href=https://www.freebsd.org/releng/ target=_blank>Подготовка релизов</a></li><li><a href=https://www.freebsd.org/security/ target=_blank>Бюллетени Безопасности</a></li></ul></li><li class=menu-item><input id=documentation type=checkbox>
<a href=# aria-label="Navigate to get Documentation section"><label class=menu-item-description for=documentation>Документация
<i class="fa fa-angle-down fa-lg" aria-hidden=true></i></label></a><ul class=sub-menu><li class=title><a href=/ru>Портал документации</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook>Руководство</a></li><li><a href=https://docs.freebsd.org/ru/books/porters-handbook>Руководство по созданию портов</a></li><li><a href=https://docs.FreeBSD.org/en/books/fdp-primer>Учебник Проекта Документирования</a></li><li><a href=https://man.FreeBSD.org target=_blank>Страницы Справочника</a></li><li><a href=https://papers.FreeBSD.org target=_blank>Презентации и публикации</a></li><li><a href=https://wiki.FreeBSD.org target=_blank>Wiki</a></li><li><a href=https://docs.freebsd.org/ru/books>Книги</a></li><li><a href=https://docs.freebsd.org/ru/articles>Статьи</a></li></ul></li><li class=menu-item><input id=community type=checkbox>
<a href=# aria-label="Navigate to get Community section"><label class=menu-item-description for=community>Сообщество
<i class="fa fa-angle-down fa-lg" aria-hidden=true></i></label></a><ul class=sub-menu><li class=title><a href=https://www.freebsd.org/community/>Сообщество</a></li><li><a href=https://docs.freebsd.org/ru/articles/contributing>Стать участником</a></li><li><a href=https://forums.freebsd.org/ target=_blank>Форум</a></li><li><a href=https://lists.freebsd.org/ target=_blank>Списки рассылки</a></li><li><a href=https://wiki.freebsd.org/IRC/Channels target=_blank>Каналы IRC</a></li><li><a href=https://bugs.freebsd.org/bugzilla/ target=_blank>Трекер ошибок</a></li><li><a href=https://www.freebsd.org/support/ target=_blank>Поддержка</a></li></ul></li></ul></nav><div class=search-donate-container><form class=search method=get id=search-header-form action=https://docs.freebsd.org/search name=search-header-form><input type=hidden name=DB value=ru>
<input id=words name=P type=text size=20 maxlength=255>
<button>
<i class="fa fa-search" aria-hidden=true></i></button></form><div class=donate><a href=https://freebsdfoundation.org/donate/ target=_blank><span class=heart>♥</span>
Пожертвования</a></div></div></div></header><input type=checkbox class="hidden toggle" id=menu-control><main class=main-wrapper-book><a id=top></a><aside class=book-menu><div class=book-menu-content><input id=search-book type=text placeholder=Поиск aria-label=Поиск maxlength=128><nav id=MenuContents><ul><li><input type=checkbox id=chapter-eb2a98ce203d8afd517726e6d8776be3 class=toggle>
<label class="icon cursor" for=chapter-eb2a98ce203d8afd517726e6d8776be3><a role=button></a></label><a href=https://docs.freebsd.org/ru/books/handbook/preface/>Предисловие</a><ul><li><a href=https://docs.freebsd.org/ru/books/handbook/preface/#preface-audience>Целевая аудитория</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/preface/#preface-changes-from4>Четвёртое издание</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/preface/#preface-changes-from3>Третье издание</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/preface/#preface-changes-from2>Второе издание (2004)</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/preface/#preface-changes>Первое издание (2001)</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/preface/#preface-overview>Структура этой книги</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/preface/#preface-conv>Договоренности, используемые в этой книге</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/preface/#preface-acknowledgements>Благодарности</a></li></ul></li><li><input type=checkbox id=chapter-14a525fce014b90b8a458a894818255a class=toggle>
<label for=chapter-14a525fce014b90b8a458a894818255a><a role=button></a></label><a href=https://docs.freebsd.org/ru/books/handbook/parti/>Часть I. В начале</a></li><li><input type=checkbox id=chapter-f9c9f3451644df30d224350da97d5da6 class=toggle>
<label class="icon cursor" for=chapter-f9c9f3451644df30d224350da97d5da6><a role=button></a></label><a href=https://docs.freebsd.org/ru/books/handbook/introduction/>Глава 1. Введение</a><ul><li><a href=https://docs.freebsd.org/ru/books/handbook/introduction/#introduction-synopsis>1.1. Краткий обзор</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/introduction/#nutshell>1.2. Добро пожаловать во FreeBSD!</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/introduction/#history>1.3. О Проекте FreeBSD</a></li></ul></li><li><input type=checkbox id=chapter-6aaec170775233b7c45f6cdcfb70d466 class=toggle>
<label class="icon cursor" for=chapter-6aaec170775233b7c45f6cdcfb70d466><a role=button></a></label><a href=https://docs.freebsd.org/ru/books/handbook/install/>Глава 2. Установка FreeBSD версий 8.X и более ранних</a><ul><li><a href=https://docs.freebsd.org/ru/books/handbook/install/#install-synopsis>2.1. Краткий обзор</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/install/#install-hardware>2.2. Аппаратные требования</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/install/#install-pre>2.3. Перед установкой</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/install/#install-start>2.4. Начало установки</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/install/#using-sysinstall>2.5. Введение в Sysinstall</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/install/#install-steps>2.6. Выделение дискового пространства</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/install/#install-choosing>2.7. Выбор устанавливаемых компонентов</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/install/#install-media>2.8. Выбор источника для установки</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/install/#install-final-warning>2.9. Подтверждение установки</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/install/#install-post>2.10. После установки</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/install/#install-trouble>2.11. Решение проблем</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/install/#install-advanced>2.12. Расширенное руководство по установке</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/install/#install-diff-media>2.13. Подготовка собственного источника установки</a></li></ul></li><li><input type=checkbox id=chapter-f693a3fa687a72d63ec8129ee302d664 class=toggle>
<label class="icon cursor" for=chapter-f693a3fa687a72d63ec8129ee302d664><a role=button></a></label><a href=https://docs.freebsd.org/ru/books/handbook/bsdinstall/>Глава 3. Установка FreeBSD версий 9.X и более поздних</a><ul><li><a href=https://docs.freebsd.org/ru/books/handbook/bsdinstall/#bsdinstall-synopsis>3.1. Краткий обзор</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/bsdinstall/#bsdinstall-hardware>3.2. Аппаратные требования</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/bsdinstall/#bsdinstall-pre>3.3. Перед установкой</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/bsdinstall/#bsdinstall-start>3.4. Начало установки</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/bsdinstall/#using-bsdinstall>3.5. Введение в bsdinstall</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/bsdinstall/#bsdinstall-netinstall>3.6. Установка по сети</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/bsdinstall/#bsdinstall-partitioning>3.7. Выделение дискового пространства</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/bsdinstall/#bsdinstall-final-warning>3.8. Завершение установки</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/bsdinstall/#bsdinstall-post>3.9. После установки</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/bsdinstall/#bsdinstall-install-trouble>3.10. Решение проблем</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/bsdinstall/#using-live-cd>3.11. Использование Live CD</a></li></ul></li><li><input type=checkbox id=chapter-9f6db261075f578742036fcc6000eecd class=toggle>
<label class="icon cursor" for=chapter-9f6db261075f578742036fcc6000eecd><a role=button></a></label><a href=https://docs.freebsd.org/ru/books/handbook/basics/>Глава 4. Основы UNIX</a><ul><li><a href=https://docs.freebsd.org/ru/books/handbook/basics/#basics-synopsis>4.1. Краткий обзор</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/basics/#consoles>4.2. Виртуальные консоли и терминалы</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/basics/#users-synopsis>4.3. Пользователи и основы управления учетными записями</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/basics/#permissions>4.4. Права доступа</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/basics/#dirstructure>4.5. Структура каталогов</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/basics/#disk-organization>4.6. Организация дисков</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/basics/#mount-unmount>4.7. Монтирование и размонтирование файловых систем</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/basics/#basics-processes>4.8. Процессы</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/basics/#basics-daemons>4.9. Даемоны, сигналы, уничтожение процессов</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/basics/#shells>4.10. Интерпретатор команд</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/basics/#editors>4.11. Текстовые редакторы</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/basics/#basics-devices>4.12. Устройства и файлы устройств</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/basics/#binary-formats>4.13. Бинарные форматы</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/basics/#basics-more-information>4.14. Дополнительная информация</a></li></ul></li><li><input type=checkbox id=chapter-01c5707e95d14c0ff84bf62600c958d1 class=toggle>
<label class="icon cursor" for=chapter-01c5707e95d14c0ff84bf62600c958d1><a role=button></a></label><a href=https://docs.freebsd.org/ru/books/handbook/ports/>Глава 5. Установка приложений: порты и пакеты</a><ul><li><a href=https://docs.freebsd.org/ru/books/handbook/ports/#ports-synopsis>5.1. Обзор</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/ports/#ports-overview>5.2. Обзор установки программного обеспечения</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/ports/#ports-finding-applications>5.3. Поиск программного обеспечения</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/ports/#packages-using>5.4. Использование бинарных пакетов</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/ports/#pkgng-intro>5.5. Использование pkgng для управления бинарными пакетами</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/ports/#ports-using>5.6. Использование Коллекции Портов</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/ports/#ports-nextsteps>5.7. Действия после установки</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/ports/#ports-broken>5.8. Обработка нерабочих портов</a></li></ul></li><li><input type=checkbox id=chapter-f56428b9e0d0b77cc8e863910f96bbde class=toggle>
<label class="icon cursor" for=chapter-f56428b9e0d0b77cc8e863910f96bbde><a role=button></a></label><a href=https://docs.freebsd.org/ru/books/handbook/wayland/>Глава 6. Wayland</a><ul><li><a href=https://docs.freebsd.org/ru/books/handbook/wayland/#wayland-synopsis>6.1. Общие сведения о Wayland</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/wayland/#wayland-wayfire>6.2. Композитный менеджер Wayfire</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/wayland/#wayland-hikari>6.3. Композитный менеджер Hikari</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/wayland/#wayland-sway>6.4. Композитный менеджер Sway</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/wayland/#wayland-xwayland>6.5. Использование Xwayland</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/wayland/#wayland-remotedesktop>6.6. Организация Удалённого Рабочего Стола при помощи VNC</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/wayland/#wayland-ly>6.7. Менеджер регистраций Wayland</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/wayland/#wayland-utilities>6.8. Полезные Инструменты</a></li></ul></li><li><input type=checkbox id=chapter-3405c00581365a8b5d16af70fe4d1b72 class=toggle>
<label class="icon cursor" for=chapter-3405c00581365a8b5d16af70fe4d1b72><a role=button></a></label><a href=https://docs.freebsd.org/ru/books/handbook/x11/>Глава 6. X Window System</a><ul><li><a href=https://docs.freebsd.org/ru/books/handbook/x11/#x11-synopsis>6.1. Обзор</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/x11/#x-understanding>6.2. Основы X</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/x11/#x-install>6.3. Установка X11</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/x11/#x-config>6.4. Конфигурация X11</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/x11/#x-fonts>6.5. Использование шрифтов в X11</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/x11/#x-xdm>6.6. Менеджеры экранов (Display Managers) X</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/x11/#x11-wm>6.7. Графические оболочки</a></li></ul></li><li><input type=checkbox id=chapter-0eab3565e8f59f5a8a896dfba7eb3680 class=toggle>
<label for=chapter-0eab3565e8f59f5a8a896dfba7eb3680><a role=button></a></label><a href=https://docs.freebsd.org/ru/books/handbook/partii/>Часть II. Общие задачи</a></li><li><input type=checkbox id=chapter-b33cf28993f3f7bf5baf036e79da0f39 class=toggle>
<label class="icon cursor" for=chapter-b33cf28993f3f7bf5baf036e79da0f39><a role=button></a></label><a href=https://docs.freebsd.org/ru/books/handbook/desktop/>Глава 7. Приложения для настольного компьютера</a><ul><li><a href=https://docs.freebsd.org/ru/books/handbook/desktop/#desktop-synopsis>7.1. Краткий обзор</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/desktop/#desktop-browsers>7.2. Браузеры</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/desktop/#desktop-productivity>7.3. Бизнес приложения</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/desktop/#desktop-viewers>7.4. Программы просмотра документов</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/desktop/#desktop-finance>7.5. Финансовые программы</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/desktop/#desktop-summary>7.6. Итоги</a></li></ul></li><li><input type=checkbox id=chapter-152f694a19312ad72ec7bb4e1c3c33b2 class=toggle>
<label class="icon cursor" for=chapter-152f694a19312ad72ec7bb4e1c3c33b2><a role=button></a></label><a href=https://docs.freebsd.org/ru/books/handbook/multimedia/>Глава 8. Мультимедиа</a><ul><li><a href=https://docs.freebsd.org/ru/books/handbook/multimedia/#multimedia-synopsis>8.1. Краткий обзор</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/multimedia/#sound-setup>8.2. Настройка звуковой карты</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/multimedia/#sound-mp3>8.3. Звук MP3</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/multimedia/#video-playback>8.4. Воспроизведение видео</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/multimedia/#tvcard>8.5. Настройка ТВ тюнеров</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/multimedia/#scanners>8.6. Сканеры</a></li></ul></li><li><input type=checkbox id=chapter-80888b4ee02e3e409e5f71cf97a36450 class=toggle>
<label class="icon cursor" for=chapter-80888b4ee02e3e409e5f71cf97a36450><a role=button></a></label><a href=https://docs.freebsd.org/ru/books/handbook/kernelconfig/>Глава 9. Настройка ядра FreeBSD</a><ul><li><a href=https://docs.freebsd.org/ru/books/handbook/kernelconfig/#kernelconfig-synopsis>9.1. Краткий обзор</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/kernelconfig/#kernelconfig-custom-kernel>9.2. Зачем собирать собственное ядро?</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/kernelconfig/#kernelconfig-devices>9.3. Определение аппаратного обеспечения</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/kernelconfig/#kernelconfig-modules>9.4. Драйвера, подсистемы и модули ядра</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/kernelconfig/#kernelconfig-building>9.5. Сборка и установка собственного ядра</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/kernelconfig/#kernelconfig-config>9.6. Конфигурационный файл</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/kernelconfig/#kernelconfig-trouble>9.7. Решение проблем</a></li></ul></li><li><input type=checkbox id=chapter-cb174c55879b17ab955f2f16989a79e0 class=toggle>
<label class="icon cursor" for=chapter-cb174c55879b17ab955f2f16989a79e0><a role=button></a></label><a href=https://docs.freebsd.org/ru/books/handbook/printing/>Глава 10. Печать</a><ul><li><a href=https://docs.freebsd.org/ru/books/handbook/printing/#printing-synopsis>10.1. Краткий обзор</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/printing/#printing-intro-spooler>10.2. Введение</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/printing/#printing-intro-setup>10.3. Основная настройка</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/printing/#printing-advanced>10.4. Расширенная настройка принтера</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/printing/#printing-using>10.5. Использование принтеров</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/printing/#printing-lpd-alternatives>10.6. Альтернативы стандартному спулеру</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/printing/#printing-troubleshooting>10.7. Выявление проблем</a></li></ul></li><li><input type=checkbox id=chapter-c12b8c3f2a8fcefce87087241f695c83 class=toggle>
<label class="icon cursor" for=chapter-c12b8c3f2a8fcefce87087241f695c83><a role=button></a></label><a href=https://docs.freebsd.org/ru/books/handbook/linuxemu/>Глава 11. Двоичная совместимость с Linux</a><ul><li><a href=https://docs.freebsd.org/ru/books/handbook/linuxemu/#linuxemu-synopsis>11.1. Краткий обзор</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/linuxemu/#linuxemu-lbc-install>11.2. Установка</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/linuxemu/#linuxemu-mathematica>11.3. Установка Mathematica®</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/linuxemu/#linuxemu-maple>11.4. Установка Maple™</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/linuxemu/#linuxemu-matlab>11.5. Установка MATLAB®</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/linuxemu/#linuxemu-oracle>11.6. Установка Oracle®</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/linuxemu/#sapr3>11.7. Установка SAP® R/3®</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/linuxemu/#linuxemu-advanced>11.8. Дополнительные сведения</a></li></ul></li><li><input type=checkbox id=chapter-03b11ba627b9a0c85b247f5641bde272 class=toggle>
<label for=chapter-03b11ba627b9a0c85b247f5641bde272><a role=button></a></label><a href=https://docs.freebsd.org/ru/books/handbook/partiii/>Часть III. Системное администрирование</a></li><li><input type=checkbox id=chapter-6c31587f8d736319f099cd4dc1961301 class=toggle>
<label class="icon cursor" for=chapter-6c31587f8d736319f099cd4dc1961301><a role=button></a></label><a href=https://docs.freebsd.org/ru/books/handbook/config/>Глава 12. Настройка и оптимизация</a><ul><li><a href=https://docs.freebsd.org/ru/books/handbook/config/#config-synopsis>12.1. Введение</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/config/#configtuning-initial>12.2. Начальное конфигурирование</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/config/#configtuning-core-configuration>12.3. Основные настройки</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/config/#configtuning-appconfig>12.4. Настройка приложений</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/config/#configtuning-starting-services>12.5. Запуск сервисов</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/config/#configtuning-cron>12.6. Настройка утилиты <code>cron</code></a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/config/#configtuning-rcd>12.7. Использование rc во FreeBSD 5.X и последующих версиях</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/config/#config-network-setup>12.8. Настройка карт сетевых интерфейсов</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/config/#configtuning-virtual-hosts>12.9. Настройка виртуальных серверов</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/config/#configtuning-configfiles>12.10. Файлы настройки</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/config/#configtuning-sysctl>12.11. Настройка с помощью sysctl</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/config/#configtuning-disk>12.12. Оптимизация дисков</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/config/#configtuning-kernel-limits>12.13. Изменение ограничений, накладываемых ядром</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/config/#adding-swap-space>12.14. Увеличение объема подкачки</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/config/#acpi-overview>12.15. Управление питанием и ресурсами</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/config/#ACPI-debug>12.16. Использование и отладка FreeBSD ACPI</a></li></ul></li><li><input type=checkbox id=chapter-459f0012b3b4f0b6b123010f029da5e4 class=toggle>
<label class="icon cursor" for=chapter-459f0012b3b4f0b6b123010f029da5e4><a role=button></a></label><a href=https://docs.freebsd.org/ru/books/handbook/boot/>Глава 13. Процесс загрузки FreeBSD</a><ul><li><a href=https://docs.freebsd.org/ru/books/handbook/boot/#boot-synopsis>13.1. Описание</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/boot/#boot-introduction>13.2. Проблема загрузки</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/boot/#boot-blocks>13.3. Менеджер загрузки и этапы загрузки</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/boot/#boot-kernel>13.4. Взаимодействие с ядром во время загрузки</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/boot/#device-hints>13.5. Хинты устройств</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/boot/#boot-init>13.6. Init: инициализация управления процессами</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/boot/#boot-shutdown>13.7. Процесс остановки системы</a></li></ul></li><li><input type=checkbox id=chapter-917c75fcffbb14d48ed6d0a48e7028f2 class=toggle>
<label class="icon cursor" for=chapter-917c75fcffbb14d48ed6d0a48e7028f2><a role=button></a></label><a href=https://docs.freebsd.org/ru/books/handbook/security/>Глава 14. Безопасность</a><ul><li><a href=https://docs.freebsd.org/ru/books/handbook/security/#security-synopsis>14.1. Краткое описание</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/security/#security-intro>14.2. Введение</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/security/#securing-freebsd>14.3. Защита FreeBSD</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/security/#crypt>14.4. DES, MD5, и шифрование</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/security/#one-time-passwords>14.5. Одноразовые пароли</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/security/#tcpwrappers>14.6. TCP Wrappers</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/security/#kerberosIV>14.7. KerberosIV</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/security/#kerberos5>14.8. Kerberos5</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/security/#openssl>14.9. OpenSSL</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/security/#ipsec>14.10. VPN через IPsec</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/security/#openssh>14.11. OpenSSH</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/security/#fs-acl>14.12. Списки контроля доступа файловой системы (ACL)</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/security/#security-portaudit>14.13. Мониторинг вопросов безопасности в ПО сторонних разработчиков</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/security/#security-advisories>14.14. Сообщения безопасности FreeBSD</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/security/#security-accounting>14.15. Учёт используемых ресурсов</a></li></ul></li><li><input type=checkbox id=chapter-8f4620c77e572cbb58917911a33c73cf class=toggle>
<label class="icon cursor" for=chapter-8f4620c77e572cbb58917911a33c73cf><a role=button></a></label><a href=https://docs.freebsd.org/ru/books/handbook/mac/>Глава 15. Принудительный контроль доступа (MAC)</a><ul><li><a href=https://docs.freebsd.org/ru/books/handbook/mac/#mac-synopsis>15.1. Краткий обзор</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/mac/#mac-inline-glossary>15.2. Ключевые термины этой главы</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/mac/#mac-initial>15.3. Описание MAC</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/mac/#mac-understandlabel>15.4. Метки MAC</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/mac/#mac-modules>15.5. Настройка модулей</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/mac/#mac-bsdextended>15.6. Модуль MAC bsdextended</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/mac/#mac-ifoff>15.7. Модуль MAC ifoff</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/mac/#mac-portacl>15.8. Модуль MAC portacl</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/mac/#mac-labelingpolicies>15.9. Политики MAC, использующие метки</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/mac/#mac-partition>15.10. Модуль MAC partition</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/mac/#mac-mls>15.11. Модуль многоуровневой безопасности MAC (MLS)</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/mac/#mac-biba>15.12. Модуль MAC Biba</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/mac/#mac-lomac>15.13. Модуль MAC LOMAC</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/mac/#mac-implementing>15.14. Реализация защищенной среды с MAC</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/mac/#MAC-examplehttpd>15.15. Другой пример: Использование MAC для защиты веб сервера</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/mac/#mac-troubleshoot>15.16. Решение проблем с инфраструктурой MAC</a></li></ul></li><li><input type=checkbox id=chapter-9598d66a76cb3182057b6bcd775149a0 class=toggle>
<label class="icon cursor" for=chapter-9598d66a76cb3182057b6bcd775149a0><a role=button></a></label><a href=https://docs.freebsd.org/ru/books/handbook/audit/>Глава 16. Аудит событий безопасности</a><ul><li><a href=https://docs.freebsd.org/ru/books/handbook/audit/#audit-synopsis>16.1. Краткий обзор</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/audit/#audit-inline-glossary>16.2. Ключевые понятия</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/audit/#audit-config>16.3. Настройка системы аудита</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/audit/#audit-administration>16.4. Работа с журналами аудита</a></li></ul></li><li><input type=checkbox id=chapter-e1edcad13d9db6e8e4cb645d378ecfaf class=toggle checked>
<label class="icon cursor" for=chapter-e1edcad13d9db6e8e4cb645d378ecfaf><a role=button></a></label><a href=https://docs.freebsd.org/ru/books/handbook/disks/>Глава 17. Устройства хранения</a><ul><li><a href=https://docs.freebsd.org/ru/books/handbook/disks/#disks-synopsis>17.1. Краткий обзор</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/disks/#disks-naming>17.2. Имена устройств</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/disks/#disks-adding>17.3. Добавление дисков</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/disks/#raid>17.4. RAID</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/disks/#usb-disks>17.5. USB устройства хранения</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/disks/#creating-cds>17.6. Запись и использование оптических носителей (CD)</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/disks/#creating-dvds>17.7. Создание и использование оптических носителей (DVD)</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/disks/#floppies>17.8. Дискеты</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/disks/#backups-tapebackups>17.9. Создание и использование архивных копий на магнитной ленте</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/disks/#backups-floppybackups>17.10. Создание резервных копий на дискетах</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/disks/#backup-strategies>17.11. Стратегии резервного копирования</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/disks/#backup-basics>17.12. Основы технологии резервного копирования</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/disks/#disks-virtual>17.13. Сетевые файловые системы, файловые системы в памяти и с отображением в файл</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/disks/#snapshots>17.14. Мгновенные копии файловых систем</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/disks/#quotas>17.15. Квотирование файловых систем</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/disks/#disks-encrypting>17.16. Шифрование дисковых разделов</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/disks/#swap-encrypting>17.17. Шифрование области подкачки</a></li></ul></li><li><input type=checkbox id=chapter-dde37901a0e0ea32745b67607854900f class=toggle>
<label class="icon cursor" for=chapter-dde37901a0e0ea32745b67607854900f><a role=button></a></label><a href=https://docs.freebsd.org/ru/books/handbook/geom/>Глава 18. GEOM: Модульная инфраструктура преобразования дисковых запросов</a><ul><li><a href=https://docs.freebsd.org/ru/books/handbook/geom/#GEOM-synopsis>18.1. Краткий обзор</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/geom/#GEOM-intro>18.2. Введение в GEOM</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/geom/#GEOM-striping>18.3. RAID0 - Создание дисковой последовательности (Striping)</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/geom/#GEOM-mirror>18.4. RAID1 - Зеркалирование (Mirroring)</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/geom/#geom-ggate>18.5. Сетевые устройства GEOM Gate</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/geom/#geom-glabel>18.6. Метки дисковых устройств</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/geom/#geom-gjournal>18.7. Журналирование UFS средствами GEOM</a></li></ul></li><li><input type=checkbox id=chapter-7af71270807eb7b70cd3eedc6577b254 class=toggle>
<label class="icon cursor" for=chapter-7af71270807eb7b70cd3eedc6577b254><a role=button></a></label><a href=https://docs.freebsd.org/ru/books/handbook/filesystems/>Глава 19. Поддержка файловых систем</a><ul><li><a href=https://docs.freebsd.org/ru/books/handbook/filesystems/#filesystems-synopsis>19.1. Краткий обзор</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/filesystems/#filesystems-zfs>19.2. Файловая система ZFS</a></li></ul></li><li><input type=checkbox id=chapter-49f1e96591c090304ea532012257f4ef class=toggle>
<label class="icon cursor" for=chapter-49f1e96591c090304ea532012257f4ef><a role=button></a></label><a href=https://docs.freebsd.org/ru/books/handbook/l10n/>Глава 20. Локализация - использование и настройка i18n/L10n</a><ul><li><a href=https://docs.freebsd.org/ru/books/handbook/l10n/#l10n-synopsis>20.1. Краткий обзор</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/l10n/#using-localization>20.2. Использование локализации</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/l10n/#l10n-compiling>20.3. Поиск приложений i18n</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/l10n/#lang-setup>20.4. Настройка локализации для некоторых языков</a></li></ul></li><li><input type=checkbox id=chapter-dead2b4c5ea325dd390a9b0dccd8f763 class=toggle>
<label class="icon cursor" for=chapter-dead2b4c5ea325dd390a9b0dccd8f763><a role=button></a></label><a href=https://docs.freebsd.org/ru/books/handbook/cutting-edge/>Глава 21. Обновление системы и смена версии FreeBSD</a><ul><li><a href=https://docs.freebsd.org/ru/books/handbook/cutting-edge/#updating-upgrading-synopsis>21.1. Краткий обзор</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/cutting-edge/#updating-upgrading-freebsdupdate>21.2. Обновление FreeBSD</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/cutting-edge/#updating-upgrading-documentation>21.3. Обновление документации</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/cutting-edge/#current-stable>21.4. Использование ветви разработки</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/cutting-edge/#synching>21.5. Синхронизация исходных текстов</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/cutting-edge/#makeworld>21.6. Пересборка мира</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/cutting-edge/#small-lan>21.7. Отслеживание исходных текстов для нескольких машин</a></li></ul></li><li><input type=checkbox id=chapter-bbd25f9a194f9c39ca2d658c75767db5 class=toggle>
<label for=chapter-bbd25f9a194f9c39ca2d658c75767db5><a role=button></a></label><a href=https://docs.freebsd.org/ru/books/handbook/partiv/>Часть IV. Сетевые коммуникации</a></li><li><input type=checkbox id=chapter-499dab596afd7ddac77e80295314e0dd class=toggle>
<label class="icon cursor" for=chapter-499dab596afd7ddac77e80295314e0dd><a role=button></a></label><a href=https://docs.freebsd.org/ru/books/handbook/serialcomms/>Глава 22. Последовательные соединения</a><ul><li><a href=https://docs.freebsd.org/ru/books/handbook/serialcomms/#serial-synopsis>22.1. Краткое описание</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/serialcomms/#serial>22.2. Введение</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/serialcomms/#term>22.3. Терминалы</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/serialcomms/#dialup>22.4. Входящие соединения по модему</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/serialcomms/#dialout>22.5. Исходящие соединения по модему</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/serialcomms/#serialconsole-setup>22.6. Настройка последовательной консоли</a></li></ul></li><li><input type=checkbox id=chapter-95e4571c48bee1cced5e84a538d302e3 class=toggle>
<label class="icon cursor" for=chapter-95e4571c48bee1cced5e84a538d302e3><a role=button></a></label><a href=https://docs.freebsd.org/ru/books/handbook/ppp-and-slip/>Глава 23. PPP и SLIP</a><ul><li><a href=https://docs.freebsd.org/ru/books/handbook/ppp-and-slip/#ppp-and-slip-synopsis>23.1. Краткий обзор</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/ppp-and-slip/#userppp>23.2. PPP уровня пользователя</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/ppp-and-slip/#ppp>23.3. PPP уровня ядра</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/ppp-and-slip/#ppp-troubleshoot>23.4. Решение проблем с соединениями PPP</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/ppp-and-slip/#pppoe>23.5. Использование PPP через Ethernet (PPPoE)</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/ppp-and-slip/#pppoa>23.6. Использование PPP через ATM (PPPoA)</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/ppp-and-slip/#slip>23.7. Использование SLIP</a></li></ul></li><li><input type=checkbox id=chapter-f089ac726c401c9b4bd5c34a295e11bb class=toggle>
<label class="icon cursor" for=chapter-f089ac726c401c9b4bd5c34a295e11bb><a role=button></a></label><a href=https://docs.freebsd.org/ru/books/handbook/mail/>Глава 24. Электронная почта</a><ul><li><a href=https://docs.freebsd.org/ru/books/handbook/mail/#mail-synopsis>24.1. Краткий обзор</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/mail/#mail-using>24.2. Использование электронной почты</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/mail/#sendmail>24.3. Настройка sendmail</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/mail/#mail-changingmta>24.4. Установка другой почтовой программы</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/mail/#mail-trouble>24.5. Поиск и устранение неисправностей</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/mail/#mail-advanced>24.6. Расширенное руководство</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/mail/#outgoing-only>24.7. Настройка почты только для отправки</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/mail/#SMTP-dialup>24.8. Использование почты с коммутируемым соединением</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/mail/#SMTP-Auth>24.9. SMTP аутентификация</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/mail/#mail-agents>24.10. Почтовые программы пользователей</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/mail/#mail-fetchmail>24.11. Использование fetchmail</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/mail/#mail-procmail>24.12. Использование procmail</a></li></ul></li><li><input type=checkbox id=chapter-6de4de3fe925639d4175ce4b6f8c1829 class=toggle>
<label class="icon cursor" for=chapter-6de4de3fe925639d4175ce4b6f8c1829><a role=button></a></label><a href=https://docs.freebsd.org/ru/books/handbook/network-servers/>Глава 25. Сетевые серверы</a><ul><li><a href=https://docs.freebsd.org/ru/books/handbook/network-servers/#network-servers-synopsis>25.1. Краткий обзор</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/network-servers/#network-inetd>25.2. "Супер-сервер"inetd</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/network-servers/#network-nfs>25.3. Network File System (NFS)</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/network-servers/#network-nis>25.4. Network Information System (NIS/YP)</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/network-servers/#network-dhcp>25.5. Автоматическая настройка сети (DHCP)</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/network-servers/#network-dns>25.6. Domain Name System (DNS)</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/network-servers/#network-apache>25.7. Apache HTTP сервер</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/network-servers/#network-samba>25.8. Файл сервер и печать для Microsoft® Windows® клиентов (Samba)</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/network-servers/#network-ftp>25.9. Протокол передачи файлов (FTP)</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/network-servers/#network-ntp>25.10. Синхронизация часов через NTP</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/network-servers/#network-syslogd>25.11. * Remote Host Logging with <code>syslogd</code></a></li></ul></li><li><input type=checkbox id=chapter-776d855c7b75e048f90b5c2c9b35ffe0 class=toggle>
<label class="icon cursor" for=chapter-776d855c7b75e048f90b5c2c9b35ffe0><a role=button></a></label><a href=https://docs.freebsd.org/ru/books/handbook/firewalls/>Глава 26. Межсетевые экраны</a><ul><li><a href=https://docs.freebsd.org/ru/books/handbook/firewalls/#firewalls-intro>26.1. Введение</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/firewalls/#firewalls-concepts>26.2. Принципы работы межсетевых экранов</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/firewalls/#firewalls-apps>26.3. Пакеты межсетевых экранов</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/firewalls/#firewalls-pf>26.4. Packet Filter (PF, межсетевой экран OpenBSD) и ALTQ</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/firewalls/#firewalls-ipf>26.5. * IPFILTER (IPF)</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/firewalls/#firewalls-ipfw>26.6. IPFW</a></li></ul></li><li><input type=checkbox id=chapter-5b07f776a0e6155c1c89aa0d15610380 class=toggle>
<label class="icon cursor" for=chapter-5b07f776a0e6155c1c89aa0d15610380><a role=button></a></label><a href=https://docs.freebsd.org/ru/books/handbook/advanced-networking/>Глава 27. Сложные вопросы работы в сети</a><ul><li><a href=https://docs.freebsd.org/ru/books/handbook/advanced-networking/#advanced-networking-synopsis>27.1. Краткий обзор</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/advanced-networking/#network-routing>27.2. Сетевые шлюзы и маршруты</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/advanced-networking/#network-wireless>27.3. Беспроводные сети</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/advanced-networking/#network-bluetooth>27.4. Bluetooth</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/advanced-networking/#network-bridging>27.5. Мосты</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/advanced-networking/#network-diskless>27.6. Работа с бездисковыми станциями</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/advanced-networking/#network-isdn>27.7. ISDN</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/advanced-networking/#network-natd>27.8. Даемон преобразования сетевых адресов (natd)</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/advanced-networking/#network-plip>27.9. IP по параллельному порту (PLIP)</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/advanced-networking/#network-ipv6>27.10. IPv6</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/advanced-networking/#network-atm>27.11. Асинхронный режим передачи (ATM)</a></li></ul></li><li><input type=checkbox id=chapter-171a77aa9d067a1024f849470e1f33e8 class=toggle>
<label for=chapter-171a77aa9d067a1024f849470e1f33e8><a role=button></a></label><a href=https://docs.freebsd.org/ru/books/handbook/partv/>Часть V. Приложения</a></li><li><input type=checkbox id=chapter-8050f436a0a7986a4aaded93d8e49469 class=toggle>
<label class="icon cursor" for=chapter-8050f436a0a7986a4aaded93d8e49469><a role=button></a></label><a href=https://docs.freebsd.org/ru/books/handbook/mirrors/>Приложение A. Получение FreeBSD</a><ul><li><a href=https://docs.freebsd.org/ru/books/handbook/mirrors/#mirrors-cdrom>A.1. Наборы CD и DVD</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/mirrors/#mirrors-ftp>A.2. FTP сайты</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/mirrors/#ctm>A.3. Использование CTM</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/mirrors/#svn>A.4. Использование Subversion</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/mirrors/#mirrors-rsync>A.5. Использование rsync</a></li></ul></li><li><input type=checkbox id=chapter-128b630a8f88f158e7027fe6c2184d21 class=toggle>
<label class="icon cursor" for=chapter-128b630a8f88f158e7027fe6c2184d21><a role=button></a></label><a href=https://docs.freebsd.org/ru/books/handbook/bibliography/>Приложение B. Библиография</a><ul><li><a href=https://docs.freebsd.org/ru/books/handbook/bibliography/#bibliography-freebsd>B.1. Книги и журналы, специализирующиеся на FreeBSD</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/bibliography/#bibliography-userguides>B.2. Руководства для пользователей</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/bibliography/#bibliography-adminguides>B.3. Руководства для администраторов</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/bibliography/#bibliography-programmers>B.4. Руководства для программистов</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/bibliography/#bibliography-osinternals>B.5. Внутренности операционной системы</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/bibliography/#bibliography-security>B.6. Безопасность</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/bibliography/#bibliography-hardware>B.7. Оборудование</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/bibliography/#bibliography-history>B.8. История UNIX®</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/bibliography/#bibliography-journals>B.9. Прочие издания</a></li></ul></li><li><input type=checkbox id=chapter-8bbb8867c46dac315e2253945d8c18a8 class=toggle>
<label class="icon cursor" for=chapter-8bbb8867c46dac315e2253945d8c18a8><a role=button></a></label><a href=https://docs.freebsd.org/ru/books/handbook/eresources/>Приложение C. Ресурсы в интернет</a><ul><li><a href=https://docs.freebsd.org/ru/books/handbook/eresources/#eresources-mail>C.1. Списки рассылки</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/eresources/#eresources-news>C.2. Новостные группы Usenet</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/eresources/#eresources-web>C.3. Серверы World Wide Web</a></li><li><a href=https://docs.freebsd.org/ru/books/handbook/eresources/#eresources-email>C.4. Адреса Email</a></li></ul></li><li><input type=checkbox id=chapter-a80ea4f5a4480b8725422710f954ef36 class=toggle>
<label class="icon cursor" for=chapter-a80ea4f5a4480b8725422710f954ef36><a role=button></a></label><a href=https://docs.freebsd.org/ru/books/handbook/pgpkeys/>Приложение D. PGP ключи</a><ul><li><a href=https://docs.freebsd.org/ru/books/handbook/pgpkeys/#pgpkeys-officers>D.1. Офицеры</a></li></ul></li><li></li></ul></nav></div></aside><div class=book><div class=book-menu-mobile><label for=menu-control><span class=menu-control-button><i class="fa fa-list" aria-hidden=true title="Меню книг"></i>
Меню книг</span></label></div><h1 class=title>Глава 17. Устройства хранения</h1><div class="admonitionblock note"><p><i class="fa fa-exclamation-circle" aria-hidden=true></i>
Этот перевод может быть устаревшим. Для того, чтобы помочь с переводом, пожалуйста, обратитесь к <a href=https://translate-dev.freebsd.org/ target=_blank>Сервер переводов FreeBSD</a>.</p></div><div class=toc-mobile><h3>Содержание</h3><nav id=TableOfContents><ul><li><a href=#disks-synopsis>17.1. Краткий обзор</a></li><li><a href=#disks-naming>17.2. Имена устройств</a></li><li><a href=#disks-adding>17.3. Добавление дисков</a></li><li><a href=#raid>17.4. RAID</a></li><li><a href=#usb-disks>17.5. USB устройства хранения</a></li><li><a href=#creating-cds>17.6. Запись и использование оптических носителей (CD)</a></li><li><a href=#creating-dvds>17.7. Создание и использование оптических носителей (DVD)</a></li><li><a href=#floppies>17.8. Дискеты</a></li><li><a href=#backups-tapebackups>17.9. Создание и использование архивных копий на магнитной ленте</a></li><li><a href=#backups-floppybackups>17.10. Создание резервных копий на дискетах</a></li><li><a href=#backup-strategies>17.11. Стратегии резервного копирования</a></li><li><a href=#backup-basics>17.12. Основы технологии резервного копирования</a></li><li><a href=#disks-virtual>17.13. Сетевые файловые системы, файловые системы в памяти и с отображением в файл</a></li><li><a href=#snapshots>17.14. Мгновенные копии файловых систем</a></li><li><a href=#quotas>17.15. Квотирование файловых систем</a></li><li><a href=#disks-encrypting>17.16. Шифрование дисковых разделов</a></li><li><a href=#swap-encrypting>17.17. Шифрование области подкачки</a></li></ul></nav></div><div class=book-content><div id=preamble><div class=sectionbody></div></div><div class=sect1><h2 id=disks-synopsis>17.1. Краткий обзор<a class=anchor href=#disks-synopsis></a></h2><div class=sectionbody><div class=paragraph><p>В этой главе описывается использование дисков во FreeBSD. К ним относятся диски в памяти, диски, подключенные по сети, обычные устройства хранения SCSI/IDE и устройства, использующие интерфейс USB.</p></div><div class=paragraph><p>После чтения этой главы вы будете знать:</p></div><div class=ulist><ul><li><p>Терминологию, используемую во FreeBSD для описания организации данных на физическом диске (разделы и слайсы).</p></li><li><p>Как добавить дополнительные винчестеры к вашей системе.</p></li><li><p>Как настроить FreeBSD для использования дисковых устройств USB.</p></li><li><p>Как настроить виртуальные файловые системы, такие, как диски в оперативной памяти.</p></li><li><p>Как использовать квоты для ограничения использования дискового пространства.</p></li><li><p>Как зашифровать диски, чтобы защитить их от взлома.</p></li><li><p>Как создавать и записывать CD и DVD во FreeBSD.</p></li><li><p>Различные варианты использования устройств хранения для резервных копий.</p></li><li><p>Как использовать программы резервного копирования, имеющиеся для FreeBSD.</p></li><li><p>Как выполнять резервное копирование на дискеты.</p></li><li><p>Что такое мгновенные копии файловых систем и как их эффективно использовать</p></li></ul></div><div class=paragraph><p>Перед прочтением этой главы вам потребуется:</p></div><div class=ulist><ul><li><p>Узнать как настраивать и устанавливать новое ядро FreeBSD (<a href=../kernelconfig/#kernelconfig>Настройка ядра FreeBSD</a>).</p></li></ul></div></div></div><div class=sect1><h2 id=disks-naming>17.2. Имена устройств<a class=anchor href=#disks-naming></a></h2><div class=sectionbody><div class=paragraph><p>Далее приводится список физических устройств хранения информации, которые поддерживаются во FreeBSD, и имена устройств, которые им соответствуют.</p></div><table id=disk-naming-physical-table class="tableblock frame-none grid-all stretch"><caption class=title>Таблица 1. Соглашения по именованию физических дисков</caption><col style=width:50%><col style=width:50%><thead><tr><th class="tableblock halign-left valign-top">Тип диска</th><th class="tableblock halign-left valign-top">Имя дискового устройства</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class=tableblock>Винчестеры IDE</p></td><td class="tableblock halign-left valign-top"><p class=tableblock><code>ad</code></p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>Приводы IDE CDROM</p></td><td class="tableblock halign-left valign-top"><p class=tableblock><code>acd</code></p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>Винчестеры SCSI и дисковые устройства USB</p></td><td class="tableblock halign-left valign-top"><p class=tableblock><code>da</code></p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>Приводы SCSI CDROM</p></td><td class="tableblock halign-left valign-top"><p class=tableblock><code>cd</code></p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>Различные нестандартные приводы CDROM</p></td><td class="tableblock halign-left valign-top"><p class=tableblock><code>mcd</code> для Mitsumi CD-ROM, <code>scd</code> для Sony CD-ROM</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>Дискеты</p></td><td class="tableblock halign-left valign-top"><p class=tableblock><code>fd</code></p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>Ленточные приводы SCSI</p></td><td class="tableblock halign-left valign-top"><p class=tableblock><code>sa</code></p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>Ленточные приводы IDE</p></td><td class="tableblock halign-left valign-top"><p class=tableblock><code>ast</code></p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>Флэш-диски</p></td><td class="tableblock halign-left valign-top"><p class=tableblock><code>fla</code> для флэш-устройств DiskOnChip®</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>Диски RAID</p></td><td class="tableblock halign-left valign-top"><p class=tableblock><code>aacd</code> для Adaptec® AdvancedRAID, <code>mlxd</code> и <code>mlyd</code> для Mylex®, <code>amrd</code> для AMI MegaRAID®, <code>idad</code> для Compaq Smart RAID, <code>twed</code> для 3ware® RAID.</p></td></tr></tbody></table></div></div><div class=sect1><h2 id=disks-adding>17.3. Добавление дисков<a class=anchor href=#disks-adding></a></h2><div class=sectionbody><div class=paragraph><p>В этом разделе будет описан процесс добавления нового SCSI диска на машину, имеющую в данный момент только один диск. Сначала выключим компьютер и установим диск в компьютер согласно инструкциям к компьютеру, контроллеру и от производителя диска. Из-за большого разнообразия этих процедур их рассмотрение выходит за рамки этого документа..</p></div><div class=paragraph><p>Войдите в систему как пользователь <code>root</code>. После того, как вы установили диск, просмотрите файл <span class=filename>/var/run/dmesg.boot</span>, чтобы убедиться, что новый диск был найден. Продолжая наш пример, только что добавленный диск будет называться <span class=filename>da1</span> и мы хотим смонтировать его в каталог <span class=filename>/1</span> (если вы добавляете диск IDE, то устройство будет называться <span class=filename>ad1</span>).</p></div><div class=paragraph><p>FreeBSD работает на IBM-PC совместимых компьютерах, поэтому она должна уметь работать с разделами PC BIOS. Однако они отличаются от традиционных разделов BSD. Диск ПК может иметь до четырёх записей разделов BIOS. Если диск на самом деле будет использоваться исключительно под FreeBSD, вы можете использовать режим <em>dedicated</em>. В противном случае FreeBSD будет располагаться в одном из разделов PC BIOS. Во FreeBSD разделы PC BIOS называются <em>слайсами</em>, чтобы не путать их с традиционными разделами BSD. Вы также можете использовать слайсы и с диском, предназначенным исключительно для FreeBSD, однако используемым в компьютере, на котором имеется дополнительная операционная система. Это является хорошим способом избежать путаницы в утилите <code>fdisk</code> других операционных систем, не связанных с FreeBSD.</p></div><div class=paragraph><p>В случае слайсов диск будет добавлен как <span class=filename>/dev/da1s1e</span>. Это интерпретируется следующим образом: диск SCSI, устройство номер 1 (второй диск SCSI), слайс 1 (раздел PC BIOS 1), и раздел BSD <span class=filename>e</span>. В случае использования в выделенном режиме диск будет добавлен просто как <span class=filename>/dev/da1e</span>.</p></div><div class=paragraph><p>Вследствие использования 32-разрядных целых чисел для адресации секторов, <a href="https://man.freebsd.org/cgi/man.cgi?query=bsdlabel&amp;sektion=8&amp;format=html">bsdlabel(8)</a> ограничен 2^32-1 секторами на диск, или 2TB в большинстве случаев. Формат <a href="https://man.freebsd.org/cgi/man.cgi?query=fdisk&amp;sektion=8&amp;format=html">fdisk(8)</a> позволяет наличие первого сектора со смещением не более 2^32-1 и длину не более 2^32-1, что ограничивает размер раздела до 2TB, а размер диска до 4TB в большинстве случаев. Формат <a href="https://man.freebsd.org/cgi/man.cgi?query=sunlabel&amp;sektion=8&amp;format=html">sunlabel(8)</a> ограничен 2^32-1 секторами на раздел и 8 разделами, что составляет 16TB. Для дисков большего раздела могут быть использованы разделы <a href="https://man.freebsd.org/cgi/man.cgi?query=gpt&amp;sektion=8&amp;format=html">gpt(8)</a>.</p></div><div class=sect2><h3 id=_использование_утилиты_sysinstall8>17.3.1. Использование утилиты <a href="https://man.freebsd.org/cgi/man.cgi?query=sysinstall&amp;sektion=8&amp;format=html">sysinstall(8)</a><a class=anchor href=#_использование_утилиты_sysinstall8></a></h3><div class="exampleblock procedure"><div class=content><div class="olist arabic"><ol class=arabic><li><p>Использование Sysinstall</p><div class=paragraph><p>Вы можете использовать простые меню утилиты <code>sysinstall</code> для разбиения на разделы и разметки нового диска. Войдите как пользователь <code>root</code> или воспользуйтесь командой <code>su</code>. Запустите команду <code>sysinstall</code> и войдите в меню <code>Configure</code>. Внутри <code>FreeBSD Configuration Menu</code>, пролистайте и выберите пункт <code>Fdisk</code>.</p></div></li><li><p>Редактор разделов fdisk</p><div class=paragraph><p>При работе с утилитой fdisk нажатие <kbd>A</kbd> используется для выделения под FreeBSD полностью всего диска. Когда будет задан вопрос о том, хотите ли вы "сохранить совместимость с другими возможными операционными системами в будущем", ответьте <code>YES</code>. Запишите изменения на диск при помощи команды <kbd>W</kbd>. А теперь выйдите из редактора FDISK, нажав <kbd>Q</kbd>. В этот момент вам будет задан вопрос о "Master Boot Record" (главной загрузочной записи). Так как вы добавляете диск к уже работающей системе, выберите <code>None</code>.</p></div></li><li><p>Редактор метки диска</p><div class=paragraph><p>Теперь вам нужно выйти из sysinstall и запустить эту утилиту снова. Следуйте указаниям выше, но на этот раз выберите пункт <code>Label</code>. Вы перейдёте к меню <code>Disk Label Editor</code>. Здесь вы создадите традиционные разделы BSD. На диске может быть до восьми разделов, имеющих метки <code>a-h</code>. Некоторые из меток разделов имеют особый смысл. Раздел <code>a</code> используется для размещения корневого раздела (<span class=filename>/</span>). По этой причине только ваш системный диск (например, тот, с которого происходит загрузка), должен иметь раздел <code>a</code>. Раздел <code>b</code> используется под раздел подкачки, и вы можете иметь много дисков с разделами подкачки. Раздел <code>c</code> используется для доступа ко всему диску в режиме эксклюзивного использования или ко всему слайсу FreeBSD при работе в режиме с использованием слайсов. Остальные разделы имеют обычное предназначение.</p></div><div class=paragraph><p>Редактор метки диска программы sysinstall использует раздел <code>e</code> для некорневого раздела и не для раздела подкачки. Внутри редактора метки диска создайте отдельную файловую систему, нажав <kbd>C</kbd>. Когда будет задан вопрос о том, будет ли это раздел с файловой системой (FS) или это будет раздел подкачки, выберите <code>FS</code> и наберите точку монтирования (например, <span class=filename>/mnt</span>). При добавлении диска после установки системы, программа sysinstall не будет автоматически создавать записи в файле <span class=filename>/etc/fstab</span>, поэтому точка монтирования не так уж и важна.</p></div><div class=paragraph><p>Теперь вы готовы записать новую метку на диск и создать на нем файловую систему. Сделайте это, нажав <kbd>W</kbd>. Проигнорируйте сообщения об ошибках от sysinstall о невозможности смонтировать новый раздел. Полностью выйдите из редактора метки диска и из программы sysinstall.</p></div></li><li><p>Завершение</p><div class=paragraph><p>Последний шаг заключается в редактировании файла <span class=filename>/etc/fstab</span> и добавлении записи для вашего нового диска.</p></div></li></ol></div></div></div></div><div class=sect2><h3 id=_использовании_утилит_командной_строки>17.3.2. Использовании утилит командной строки<a class=anchor href=#_использовании_утилит_командной_строки></a></h3><div class=sect3><h4 id=_работа_со_слайсами>17.3.2.1. Работа со слайсами<a class=anchor href=#_работа_со_слайсами></a></h4><div class=paragraph><p>Следующая настройка позволит вашему диску корректно работать с другими операционными системами, которые могут быть установлены на вашем компьютере, и не вызовет конфликта с утилитами <code>fdisk</code> других операционных систем. Этот способ рекомендуется использовать для установок новых дисков. Используйте <code>эксклюзивный</code> режим, только если у вас есть реальные причины делать это!</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># dd if=/dev/zero of=/dev/da1 bs=1k count=1</span>
<span class=c># fdisk -BI da1 # Инициализируем новый диск.</span>
<span class=c># bsdlabel -B -w da1s1 auto # Размечаем его.</span>
<span class=c># bsdlabel -e da1s1 # Редактируем только что созданную метку диска и добавляем разделы.</span>
<span class=c># mkdir -p /1</span>
<span class=c># newfs /dev/da1s1e # Повторяем этот шаг для всех созданных разделов.</span>
<span class=c># mount /dev/da1s1e /1 # Монтируем раздел(ы)</span>
<span class=c># vi /etc/fstab # Добавляем соответствующую запись/записи в файл /etc/fstab.</span></code></pre></div></div><div class=paragraph><p>Если у вас установлен диск IDE, подставьте <span class=filename>ad</span> вместо <span class=filename>da</span>.</p></div></div><div class=sect3><h4 id=_эксклюзивный_режим>17.3.2.2. Эксклюзивный режим<a class=anchor href=#_эксклюзивный_режим></a></h4><div class=paragraph><p>Если вы не будете использовать новый диск совместно с другой операционной системой, то вы можете использовать режим <code>эксклюзивного</code> использования. Отметьте, что этот режим может ввести в заблуждение операционные системы от Microsoft; однако информацию они не разрушат. А вот OS/2® компании IBM будет "забирать себе" любой раздел, который она найдет и не сможет распознать.</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># dd if=/dev/zero of=/dev/da1 bs=1k count=1</span>
<span class=c># bsdlabel -Bw da1 auto</span>
<span class=c># bsdlabel -e da1                           # create the `e&#39; partition</span>
<span class=c># newfs /dev/da1e</span>
<span class=c># mkdir -p /1</span>
<span class=c># vi /etc/fstab                              # add an entry for /dev/da1e</span>
<span class=c># mount /1</span></code></pre></div></div><div class=paragraph><p>Альтернативный метод заключается в следующем:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># dd if=/dev/zero of=/dev/da1 count=2</span>
<span class=c># bsdlabel /dev/da1 | bsdlabel -BR da1 /dev/stdin</span>
<span class=c># newfs /dev/da1e</span>
<span class=c># mkdir -p /1</span>
<span class=c># vi /etc/fstab                              # add an entry for /dev/da1e</span>
<span class=c># mount /1</span></code></pre></div></div></div></div></div></div><div class=sect1><h2 id=raid>17.4. RAID<a class=anchor href=#raid></a></h2><div class=sectionbody><div class=sect2><h3 id=raid-soft>17.4.1. Программный RAID<a class=anchor href=#raid-soft></a></h3><div class=sect3><h4 id=ccd>17.4.1.1. Конфигурация драйвера объединённого диска (CCD)<a class=anchor href=#ccd></a></h4><div class=paragraph><p>При выборе решения для организации хранилища самыми важными характеристиками являются скорость, надежность и стоимость. Редко все эти характеристики наличествуют одновременно; обычно быстрое и надёжное устройство хранения стоит дорого, а при уменьшении стоимости в жертву приносятся скорость работы или надёжность.</p></div><div class=paragraph><p>При проектировании описываемой далее системы в качестве самого важного фактора была выбрана её стоимость, затем быстродействие и надёжность. Скорость передачи данных для этой системы ограничивалась только пропускной способностью сети. И, хотя надёжность очень важна, CCD-диск, описываемый ниже, обслуживал работу с данными, полные копии которых уже хранились на дисках CD-R, так они могли быть с лёгкостью обновлены.</p></div><div class=paragraph><p>При выборе решения для массового хранения данных первым шагом является определение ваших требований к нему. Если в ваших требованиях главными являются скорость или надёжность, а не стоимость, то ваш выбор будет отличаться от описываемой в этом разделе системы.</p></div><div class=sect4><h5 id=ccd-installhw>17.4.1.1.1. Установка оборудования<a class=anchor href=#ccd-installhw></a></h5><div class=paragraph><p>Кроме системного IDE-диска, основу описываемого далее CCD-диска общим объёмом примерно в 90 Гбайт составили три IDE-диска Western Digital 30GB, 5400 RPM. В идеальном случае каждый диск IDE имеет собственный контроллер и кабель, но для минимизации стоимости дополнительные контроллеры IDE не использовались. Вместо этого диски были настроены при помощи переключателей так, что на каждом IDE-контроллере находилось по одному ведущему и одному ведомому диску.</p></div><div class=paragraph><p>До перезагрузки BIOS системы была настроена на автоматическое распознавание подключенных дисков. Более важно то, что при перезагрузке их распознала FreeBSD:</p></div><div class="literalblock programlisting"><div class=content><pre>ad0: 19574MB &lt;WDC WD205BA&gt; [39770/16/63] at ata0-master UDMA33
ad1: 29333MB &lt;WDC WD307AA&gt; [59598/16/63] at ata0-slave UDMA33
ad2: 29333MB &lt;WDC WD307AA&gt; [59598/16/63] at ata1-master UDMA33
ad3: 29333MB &lt;WDC WD307AA&gt; [59598/16/63] at ata1-slave UDMA33</pre></div></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Если FreeBSD не распознала все диски, проверьте корректность положения переключателей на них. На большинстве IDE-дисков имеется также переключатель "Cable Select". Он <em>не имеет</em> отношения к выбору ведущего и ведомого устройств. Для получения помощи по правильному положению переключателей обратитесь к документации по устройствам.</p></div></td></tr></tbody></table></div></div><div class=sect4><h5 id=ccd-setup>17.4.1.1.2. Настройка CCD<a class=anchor href=#ccd-setup></a></h5><div class=paragraph><p>Драйвер <a href="https://man.freebsd.org/cgi/man.cgi?query=ccd&amp;sektion=4&amp;format=html">ccd(4)</a> позволяет вам взять несколько идентичных дисков и объединить их в одну логическую файловую систему. Для использования <a href="https://man.freebsd.org/cgi/man.cgi?query=ccd&amp;sektion=4&amp;format=html">ccd(4)</a> нужно ядро со встроенной поддержкой <a href="https://man.freebsd.org/cgi/man.cgi?query=ccd&amp;sektion=4&amp;format=html">ccd(4)</a>. Добавьте такую строку в файл конфигурации ядра, перестройте и установите новое ядро:</p></div><div class="literalblock programlisting"><div class=content><pre>device   ccd</pre></div></div><div class=paragraph><p>Поддержка <a href="https://man.freebsd.org/cgi/man.cgi?query=ccd&amp;sektion=4&amp;format=html">ccd(4)</a> также может быть обеспечена загрузкой подгружаемого модуля ядра.</p></div><div class=paragraph><p>Для настройки <a href="https://man.freebsd.org/cgi/man.cgi?query=ccd&amp;sektion=4&amp;format=html">ccd(4)</a> сначала вам нужно воспользоваться утилитой <a href="https://man.freebsd.org/cgi/man.cgi?query=bsdlabel&amp;sektion=8&amp;format=html">bsdlabel(8)</a> для разметки дисков:</p></div><div class="literalblock programlisting"><div class=content><pre>bsdlabel -w ad1 auto
bsdlabel -w ad2 auto
bsdlabel -w ad3 auto</pre></div></div><div class=paragraph><p>При этом создаются метки для <span class=filename>ad1c</span>, <span class=filename>ad2c</span> и <span class=filename>ad3c</span>, которые занимают диск полностью.</p></div><div class=paragraph><p>Следующим шагом является изменение типа метки диска. Для редактирования дисков можно использовать утилиту <a href="https://man.freebsd.org/cgi/man.cgi?query=bsdlabel&amp;sektion=8&amp;format=html">bsdlabel(8)</a>:</p></div><div class="literalblock programlisting"><div class=content><pre>bsdlabel -e ad1
bsdlabel -e ad2
bsdlabel -e ad3</pre></div></div><div class=paragraph><p>При этом в редакторе, задаваемом переменной окружения <code>EDITOR</code> (обычно это <a href="https://man.freebsd.org/cgi/man.cgi?query=vi&amp;sektion=1&amp;format=html">vi(1)</a>), открывается текущая метка каждого диска.</p></div><div class=paragraph><p>Не модифицированная метка диска будет выглядеть примерно следующим образом:</p></div><div class="literalblock programlisting"><div class=content><pre>8 partitions:
#        size   offset    fstype   [fsize bsize bps/cpg]
  c: 60074784        0    unused        0     0     0   # (Cyl.    0 - 59597)</pre></div></div><div class=paragraph><p>Добавьте новый раздел <code>e</code> для использования драйвером <a href="https://man.freebsd.org/cgi/man.cgi?query=ccd&amp;sektion=4&amp;format=html">ccd(4)</a>. Как правило, он может быть скопирован с раздела <code>c</code>, но поле <code>fstype</code> <em>должно</em> иметь значение <code>4.2BSD</code>. Теперь метка диска должна выглядеть примерно так:</p></div><div class="literalblock programlisting"><div class=content><pre>8 partitions:
#        size   offset    fstype   [fsize bsize bps/cpg]
  c: 60074784        0    unused        0     0     0   # (Cyl.    0 - 59597)
  e: 60074784        0    4.2BSD        0     0     0   # (Cyl.    0 - 59597)</pre></div></div></div><div class=sect4><h5 id=ccd-buildingfs>17.4.1.1.3. Построение файловой системы<a class=anchor href=#ccd-buildingfs></a></h5><div class=paragraph><p>Теперь, когда все диски размечены, вы должны построить <a href="https://man.freebsd.org/cgi/man.cgi?query=ccd&amp;sektion=4&amp;format=html">ccd(4)</a>. Для этого используйте утилиту <a href="https://man.freebsd.org/cgi/man.cgi?query=ccdconfig&amp;sektion=8&amp;format=html">ccdconfig(8)</a> с параметрами, подобными следующим:</p></div><div class="literalblock programlisting"><div class=content><pre>ccdconfig ccd0 32 0 /dev/ad1e /dev/ad2e /dev/ad3e</pre></div></div><div class=paragraph><p>Использование и значение каждого параметра описывается ниже:
* Первым аргументом является конфигурируемое устройство, в нашем случае <span class=filename>/dev/ccd0c</span>. Часть <span class=filename>/dev/</span> является необязательной.
* Чередование для файловой системы. Оно определяет размер единицы блока данных в количестве дисковых блоков, каждый из которых обычно имеет объём в 512 байт. Таким образом, при чередовании в 32 это будет составлять 16384 байт.
* Опции для <a href="https://man.freebsd.org/cgi/man.cgi?query=ccdconfig&amp;sektion=8&amp;format=html">ccdconfig(8)</a>. Если вы хотите включить зеркалирование диска, то можете задать это здесь. В нашей конфигурации зеркалирование для <a href="https://man.freebsd.org/cgi/man.cgi?query=ccd&amp;sektion=4&amp;format=html">ccd(4)</a> не предусмотрено, поэтому здесь задан 0 (ноль).
* Последним параметром для <a href="https://man.freebsd.org/cgi/man.cgi?query=ccdconfig&amp;sektion=8&amp;format=html">ccdconfig(8)</a> является список устройств для объединения в массив. Для каждого устройства нужно задавать полное имя.</p></div><div class=paragraph><p>После запуска <a href="https://man.freebsd.org/cgi/man.cgi?query=ccdconfig&amp;sektion=8&amp;format=html">ccdconfig(8)</a> устройство <a href="https://man.freebsd.org/cgi/man.cgi?query=ccd&amp;sektion=4&amp;format=html">ccd(4)</a> будет отконфигурировано. Может будет построить файловую систему. Обратитесь к справке по команде <a href="https://man.freebsd.org/cgi/man.cgi?query=newfs&amp;sektion=8&amp;format=html">newfs(8)</a> для выяснения требуемых параметров, или просто запустите:</p></div><div class="literalblock programlisting"><div class=content><pre>newfs /dev/ccd0c</pre></div></div></div><div class=sect4><h5 id=ccd-auto>17.4.1.1.4. Автоматическое выполнение<a class=anchor href=#ccd-auto></a></h5><div class=paragraph><p>Вообще говоря, вам потребуется монтировать <a href="https://man.freebsd.org/cgi/man.cgi?query=ccd&amp;sektion=4&amp;format=html">ccd(4)</a> при каждой перезагрузке. Для этого сначала вы должны отконфигурировать это устройство. Запишите вашу текущую конфигурацию в файл <span class=filename>/etc/ccd.conf</span> при помощи такой команды:</p></div><div class="literalblock programlisting"><div class=content><pre>ccdconfig -g &gt; /etc/ccd.conf</pre></div></div><div class=paragraph><p>При перезагрузке скрипт <code>/etc/rc</code> запускает команду <code>ccdconfig -C</code>, если существует файл <span class=filename>/etc/ccd.conf</span>. При этом <a href="https://man.freebsd.org/cgi/man.cgi?query=ccd&amp;sektion=4&amp;format=html">ccd(4)</a> автоматически конфигурируется так, чтобы он мог быть смонтирован.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Если при загрузке вы входите в однопользовательский режим, то перед тем, как выполнять монтирование <a href="https://man.freebsd.org/cgi/man.cgi?query=ccd&amp;sektion=4&amp;format=html">ccd(4)</a> по команде <a href="https://man.freebsd.org/cgi/man.cgi?query=mount&amp;sektion=8&amp;format=html">mount(8)</a>, вам нужно для конфигурации массива запустить следующую команду:</p></div><div class="literalblock programlisting"><div class=content><pre>ccdconfig -C</pre></div></div></td></tr></tbody></table></div><div class=paragraph><p>Для автоматического монтирования <a href="https://man.freebsd.org/cgi/man.cgi?query=ccd&amp;sektion=4&amp;format=html">ccd(4)</a> поместите запись о <a href="https://man.freebsd.org/cgi/man.cgi?query=ccd&amp;sektion=4&amp;format=html">ccd(4)</a> в файл <span class=filename>/etc/fstab</span>, чтобы он мог быть смонтирован во время загрузки системы:</p></div><div class="literalblock programlisting"><div class=content><pre>/dev/ccd0c              /media       ufs     rw      2       2</pre></div></div></div></div></div><div class=sect2><h3 id=raid-hard>17.4.2. Аппаратный RAID<a class=anchor href=#raid-hard></a></h3><div class=paragraph><p>FreeBSD поддерживает также целый ряд аппаратных контроллеров RAID. Эти устройства самостоятельно управляют RAID-подсистемой, без необходимости иметь специфичное для FreeBSD программное обеспечения управления массивом.</p></div><div class=paragraph><p>При помощи встроенной в адаптер BIOS, он сам управляет большинством дисковых операций. Далее следует краткое описание установки при помощи контроллера Promise IDERAID. После установки адаптера и запуска системы, выдаётся запрос на ввод. Следуйте указаниям для входа в настройку адаптера. Отсюда вы можете объединить все подключенные диски. После этого во FreeBSD диск(и) будут выглядеть как один диск. Аналогично могут быть настроены и другие уровни RAID.</p></div></div><div class=sect2><h3 id=_перестроение_массивов_ata_raid1>17.4.3. Перестроение массивов ATA RAID1<a class=anchor href=#_перестроение_массивов_ata_raid1></a></h3><div class=paragraph><p>FreeBSD позволяет вам выполнять горячую замену вышедшего из строя диска. При этом требуется, чтобы вы заметили это до перезагрузки.</p></div><div class=paragraph><p>Вероятно, в файле <span class=filename>/var/log/messages</span> или в выдаче команды <a href="https://man.freebsd.org/cgi/man.cgi?query=dmesg&amp;sektion=8&amp;format=html">dmesg(8)</a> вы увидите примерно следующее:</p></div><div class="literalblock programlisting"><div class=content><pre>ad6 on monster1 suffered a hard error.
ad6: READ command timeout tag=0 serv=0 - resetting
ad6: trying fallback to PIO mode
ata3: resetting devices .. done
ad6: hard error reading fsbn 1116119 of 0-7 (ad6 bn 1116119; cn 1107 tn 4 sn 11)\\
status=59 error=40
ar0: WARNING - mirror lost</pre></div></div><div class=paragraph><p>При помощи <a href="https://man.freebsd.org/cgi/man.cgi?query=atacontrol&amp;sektion=8&amp;format=html">atacontrol(8)</a> получите дополнительную информацию:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># atacontrol list</span>
ATA channel 0:
        Master:      no device present
        Slave:       acd0 &lt;HL-DT-ST CD-ROM GCR-8520B/1.00&gt; ATA/ATAPI rev 0

ATA channel 1:
        Master:      no device present
        Slave:       no device present

ATA channel 2:
        Master:      ad4 &lt;MAXTOR 6L080J4/A93.0500&gt; ATA/ATAPI rev 5
        Slave:       no device present

ATA channel 3:
        Master:      ad6 &lt;MAXTOR 6L080J4/A93.0500&gt; ATA/ATAPI rev 5
        Slave:       no device present

<span class=c># atacontrol status ar0</span>
ar0: ATA RAID1 subdisks: ad4 ad6 status: DEGRADED</code></pre></div></div><div class="exampleblock procedure"><div class=content><div class="olist arabic"><ol class=arabic><li><p>Сначала вам нужно отключить канал контроллера ATA, содержащий отказавший диск, чтобы его можно было без последствий извлечь:</p><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># atacontrol detach ata3</span></code></pre></div></div></li><li><p>Замените диск.</p></li><li><p>Повторно подключите канал дискового контроллера:</p><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># atacontrol attach ata3</span>
Master:  ad6 &lt;MAXTOR 6L080J4/A93.0500&gt; ATA/ATAPI rev 5
Slave:   no device present</code></pre></div></div></li><li><p>Добавьте новый диск к массиву в качестве резервного:</p><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># atacontrol addspare ar0 ad6</span></code></pre></div></div></li><li><p>Перестройте массив:</p><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># atacontrol rebuild ar0</span></code></pre></div></div></li><li><p>Проверить состояние дел можно при помощи следующей команды:</p><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># dmesg | tail -10</span>
<span class=o>[</span>выдача удалена]
ad6: removed from configuration
ad6: deleted from ar0 disk1
ad6: inserted into ar0 disk1 as spare

<span class=c># atacontrol status ar0</span>
ar0: ATA RAID1 subdisks: ad4 ad6 status: REBUILDING 0% completed</code></pre></div></div></li><li><p>Дождитесь завершения этой операции.</p></li></ol></div></div></div></div></div></div><div class=sect1><h2 id=usb-disks>17.5. USB устройства хранения<a class=anchor href=#usb-disks></a></h2><div class=sectionbody><div class=paragraph><p>Множество современных устройств хранения используют Universal Serial Bus (USB): жесткие диски, брелоки USB, CD-R приводы, и т.д. FreeBSD предоставляет поддержку этих устройств.</p></div><div class=sect2><h3 id=_настройка>17.5.1. Настройка<a class=anchor href=#_настройка></a></h3><div class=paragraph><p>Драйвер <a href="https://man.freebsd.org/cgi/man.cgi?query=umass&amp;sektion=4&amp;format=html">umass(4)</a> предоставляет поддержку устройств хранения USB. Если вы используете <span class=filename>GENERIC</span> ядро, изменять что-либо в настройках не потребуется. Если вы используете настроенное ядро, убедитесь, что в файле настройки присутствуют следующие строки:</p></div><div class="literalblock programlisting"><div class=content><pre>device scbus
device da
device pass
device uhci
device ohci
device ehci
device usb
device umass</pre></div></div><div class=paragraph><p>Для доступа к устройствам хранения USB драйвер <a href="https://man.freebsd.org/cgi/man.cgi?query=umass&amp;sektion=4&amp;format=html">umass(4)</a> использует подсистему SCSI, ваши устройства USB будут видны системе как SCSI устройства. В зависимости от чипсета USB на материнской плате, для включения поддержки USB 1.X вам потребуется только один из параметров <code>device uhci</code> или <code>device ohci</code>. Однако, наличие обоих этих параметров не помешает. Поддержка контроллеров USB 2.0 предоставляется драйвером <a href="https://man.freebsd.org/cgi/man.cgi?query=ehci&amp;sektion=4&amp;format=html">ehci(4)</a> (строка <code>device ehci</code>). Не забудьте скомпилировать и установить новое ядро после добавления каких-либо строк.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Если ваше USB устройство это пишущий привод CD-R или DVD, необходимо добавить в ядро SCSI CD-ROM драйвер, <a href="https://man.freebsd.org/cgi/man.cgi?query=cd&amp;sektion=4&amp;format=html">cd(4)</a>, следующей строкой:</p></div><div class="literalblock programlisting"><div class=content><pre>device cd</pre></div></div><div class=paragraph><p>Поскольку устройство записи видно как SCSI диск, драйвер <a href="https://man.freebsd.org/cgi/man.cgi?query=atapicam&amp;sektion=4&amp;format=html">atapicam(4)</a> не должен использоваться в файле настройки.</p></div></td></tr></tbody></table></div></div><div class=sect2><h3 id=_тестирование_конфигурации>17.5.2. Тестирование конфигурации<a class=anchor href=#_тестирование_конфигурации></a></h3><div class=paragraph><p>Конфигурация готова к тестированию, подключите устройство USB, и в буфере системных сообщений (<a href="https://man.freebsd.org/cgi/man.cgi?query=dmesg&amp;sektion=8&amp;format=html">dmesg(8)</a>), диск должен отобразиться примерно так:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>umass0: USB Solid state disk, rev 1.10/1.00, addr 2
GEOM: create disk da0 <span class=nv>dp</span><span class=o>=</span>0xc2d74850
da0 at umass-sim0 bus 0 target 0 lun 0
da0: &lt;Generic Traveling Disk 1.11&gt; Removable Direct Access SCSI-2 device
da0: 1.000MB/s transfers
da0: 126MB <span class=o>(</span>258048 512 byte sectors: 64H 32S/T 126C<span class=o>)</span></code></pre></div></div><div class=paragraph><p>Конечно, производитель, имя устройства (<span class=filename>da0</span>) и другие детали могут отличаться в зависимости от конфигурации.</p></div><div class=paragraph><p>Поскольку устройство USB видится как SCSI, команда <code>camcontrol</code> может быть использована для вывода списка устройств хранения USB, подключенных к системе:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># camcontrol devlist</span>
&lt;Generic Traveling Disk 1.11&gt;      at scbus0 target 0 lun 0 <span class=o>(</span>da0,pass0<span class=o>)</span></code></pre></div></div><div class=paragraph><p>Если на диске есть файловая система, у вас должна быть возможность смонтировать ее. <a href=#disks-adding>Добавление дисков</a> поможет вам создать и отформатировать разделы на диске USB если потребуется.</p></div><div class="admonitionblock warning"><table><tbody><tr><td class=icon><i class="fa icon-warning" title=Warning></i></td><td class=content><div class=paragraph><p>Ниже описанный механизм (<code>vfs.usermount</code>), допускающий монтирование случайных носителей пользователями, не являющимися доверенными, считается небезопасным. Большинство файловых систем во FreeBSD никак не ограждено от возможности <em>несанкционированного</em> монтирования устройств.</p></div></td></tr></tbody></table></div><div class=paragraph><p>Чтобы это устройство мог смонтировать обычный пользователь, необходимо выполнить определенные действия. Для начала, необходимо дать обычным пользователям доступ к устройствам, создаваемым при подключении USB устройства. Решение состоит во включении всех пользователей данных устройств в группу <code>operator</code>. Это делается утилитой <a href="https://man.freebsd.org/cgi/man.cgi?query=pw&amp;sektion=8&amp;format=html">pw(8)</a>. Затем, когда устройства созданы, у группы <code>operator</code> должен быть доступ на чтение и запись для этих устройств. Это выполняется путем добавления следующих строк в <span class=filename>/etc/devfs.rules</span>:</p></div><div class="literalblock programlisting"><div class=content><pre>[localrules=5]
add path &#39;da*&#39; mode 0660 group operator</pre></div></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Если к системе подключены SCSI диски, это должно быть сделано немного иначе. Так, если в системе уже есть диски с <span class=filename>da0</span> по <span class=filename>da2</span>, вторая строка должна выглядеть так:</p></div><div class="literalblock programlisting"><div class=content><pre>add path &#39;da[3-9]*&#39; mode 0660 group operator</pre></div></div><div class=paragraph><p>Это исключит уже существующие диски из группы <code>operator</code>.</p></div></td></tr></tbody></table></div><div class=paragraph><p>Вам также потребуется включить набор правил <a href="https://man.freebsd.org/cgi/man.cgi?query=devfs.rules&amp;sektion=5&amp;format=html">devfs.rules(5)</a> в файл <span class=filename>/etc/rc.conf</span>:</p></div><div class="literalblock programlisting"><div class=content><pre>devfs_system_ruleset=&#34;localrules&#34;</pre></div></div><div class=paragraph><p>Затем, ядро необходимо настроить так, чтобы оно позволяло обычным пользователям монтировать файловые системы. Простейший способ сделать это - добавить в файл <span class=filename>/etc/sysctl.conf</span> следующую строку:</p></div><div class="literalblock programlisting"><div class=content><pre>vfs.usermount=1</pre></div></div><div class=paragraph><p>Этот параметр установится только после последующей перезагрузки. Для установки этой переменной можно также использовать <a href="https://man.freebsd.org/cgi/man.cgi?query=sysctl&amp;sektion=8&amp;format=html">sysctl(8)</a>.</p></div><div class=paragraph><p>Последний шаг - создание каталога, куда будет монтироваться файловая система. Каталог должен принадлежать пользователю, монтирующему файловую систему. Один из способов сделать это под пользователем <code>root</code> - создать каталог <span class=filename>/mnt/username</span> (замените <em>username</em> именем пользователя, а <em>usergroup</em> - именем главной группы пользователя):</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># mkdir /mnt/username</span>
<span class=c># chown username:usergroup /mnt/username</span></code></pre></div></div><div class=paragraph><p>Предположим, что USB брелок подключен, и появилось устройство <span class=filename>/dev/da0s1</span>. Поскольку эти устройства обычно поставляются форматированными с файловой системой FAT, их можно смонтировать так:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>% mount <span class=nt>-t</span> msdosfs <span class=nt>-o</span> <span class=nt>-m</span><span class=o>=</span>644,-M<span class=o>=</span>755 /dev/da0s1 /mnt/username</code></pre></div></div><div class=paragraph><p>Если вы отключите устройство (диск должен быть сначала размонтирован), вы должны увидеть в буфере системных сообщений что-то подобное:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>umass0: at uhub0 port 1 <span class=o>(</span>addr 2<span class=o>)</span> disconnected
<span class=o>(</span>da0:umass-sim0:0:0:0<span class=o>)</span>: lost device
<span class=o>(</span>da0:umass-sim0:0:0:0<span class=o>)</span>: removing device entry
GEOM: destroy disk da0 <span class=nv>dp</span><span class=o>=</span>0xc2d74850
umass0: detached</code></pre></div></div></div><div class=sect2><h3 id=_дополнительная_информация>17.5.3. Дополнительная информация<a class=anchor href=#_дополнительная_информация></a></h3><div class=paragraph><p>Помимо разделов <a href=#disks-adding>Добавление дисков</a> и <a href=../basics/#mount-unmount>Монтирование и размонтирование файловых систем</a>, также может быть полезно чтение различных страниц справочника: <a href="https://man.freebsd.org/cgi/man.cgi?query=umass&amp;sektion=4&amp;format=html">umass(4)</a>, <a href="https://man.freebsd.org/cgi/man.cgi?query=camcontrol&amp;sektion=8&amp;format=html">camcontrol(8)</a>, и <a href="https://man.freebsd.org/cgi/man.cgi?query=usbconfig&amp;sektion=8&amp;format=html">usbconfig(8)</a> для FreeBSD 8.X или <a href="https://man.freebsd.org/cgi/man.cgi?query=usbdevs&amp;sektion=8&amp;format=html">usbdevs(8)</a> для более ранних версий FreeBSD.</p></div></div></div></div><div class=sect1><h2 id=creating-cds>17.6. Запись и использование оптических носителей (CD)<a class=anchor href=#creating-cds></a></h2><div class=sectionbody><div class=sect2><h3 id=_введение>17.6.1. Введение<a class=anchor href=#_введение></a></h3><div class=paragraph><p>Компакт-диски (CD) имеют несколько особенностей, отличающих их от обычных дисков. Во-первых, на них невозможно производить запись. Они спроектированы с расчетом на то, что их можно читать последовательно без задержек на перемещение головки между дорожками. К тому же их гораздо проще переносить от системы к системе, чем носители близкого объема.</p></div><div class=paragraph><p>У CD имеются дорожки, но они представляют собой последовательность данных, читаемую последовательно, и не являются физической характеристикой диска. Для записи CD во FreeBSD вы готовите файлы данных, которые будут формировать дорожки на компакт-диске, а затем записываете дорожки на CD.</p></div><div class=paragraph><p>Файловая система ISO 9660 была разработана с учетом этих отличий, К сожалению, она унаследовала ограничения файловых систем, которые были тогда. К счастью, она дает механизм расширений, которые позволяют правильно записанным дискам обходить эти ограничения и при этом продолжать работать с системами, которые не поддерживают эти расширения.</p></div><div class=paragraph><p>Для создания файла данных, содержащего файловую систему ISO 9660, используется программа <a href="https://man.freebsd.org/cgi/man.cgi?query=mkisofs&amp;sektion=8&amp;format=html">mkisofs(8)</a>, которая включена в порт <a class=package href=https://cgit.freebsd.org/ports/tree/sysutils/cdrtools/>sysutils/cdrtools</a>. Она имеет опции, поддерживающие различные расширения, и описана ниже.</p></div><div class=paragraph><p>Какой инструмент использовать для записи CD, зависит от того, является ли ваше устройство для записи CD устройством ATAPI или каким-либо другим. С устройствами для записи стандарта ATAPI используется программа <code>burncd</code>, которая является частью комплекта поставки системы. С устройствами SCSI и USB нужно использовать <code>cdrecord</code> из порта <a class=package href=https://cgit.freebsd.org/ports/tree/sysutils/cdrtools/>sysutils/cdrtools</a>. Утилиту <code>cdrecord</code> и другие инструменты для SCSI-приводов также можно использовать при работе с ATAPI-оборудованием через <a href=#atapicam>модуль ATAPI/CAM</a>.</p></div><div class=paragraph><p>Если для записи CD вам нужна программа с графическим интерфейсом пользователя, взгляните на X-CD-Roast или K3b. Они доступны в виде пакетов или из портов <a class=package href=https://cgit.freebsd.org/ports/tree/sysutils/xcdroast/>sysutils/xcdroast</a> и <a class=package href=https://cgit.freebsd.org/ports/tree/sysutils/k3b/>sysutils/k3b</a>. Программам X-CD-Roast и K3b для работы с оборудованием ATAPI требуется <a href=#atapicam>модуль ATAPI/CAM</a>.</p></div></div><div class=sect2><h3 id=mkisofs>17.6.2. mkisofs<a class=anchor href=#mkisofs></a></h3><div class=paragraph><p>Программа <a href="https://man.freebsd.org/cgi/man.cgi?query=mkisofs&amp;sektion=8&amp;format=html">mkisofs(8)</a>, поставляемая с портом <a class=package href=https://cgit.freebsd.org/ports/tree/sysutils/cdrtools/>sysutils/cdrtools</a> создаёт файловую систему ISO 9660, которая является образом дерева каталогов в пространстве имён файловой системы UNIX®. В самом простом случае она используется так:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># mkisofs -o imagefile.iso /path/to/tree</span></code></pre></div></div><div class=paragraph><p>Эта команда создаст файл <em>imagefile.iso</em>, содержащий файловую систему ISO 9660, которая является копией дерева каталогов <em>/path/to/tree</em>. Во время работы она будет преобразовывать имена файлов в имена, которые удовлетворяют ограничениям файловой системы ISO 9660, и исключит файлы, которые носят имена, неподходящие для файловой системы ISO.</p></div><div class=paragraph><p>Для того, чтобы обойти эти ограничения, имеется несколько опций. В частности, <code>-R</code> включает использование расширений Rock Ridge, распространенных в UNIX®-системах, с <code>-J</code> будут применены расширения Joliet, используемые в системах от Microsoft, а <code>-hfs</code> может использоваться для создания файловых систем HFS, используемых в Mac OS®.</p></div><div class=paragraph><p>Для CD, которые будут использоваться только с системами FreeBSD, может использоваться опция <code>-U</code>, отменяющая все ограничения на имена файлов. При использовании с опцией <code>-R</code> генерируется образ файловой системы, идентичный начальному дереву FreeBSD, хотя при этом стандарт ISO 9660 может нарушаться в нескольких местах.</p></div><div class=paragraph><p>Последней часто используемой опцией является <code>-b</code>. Она используется для указания загрузочного образа для использования при создании загрузочного CD в стандарте "El Torito". Этой опции указывается аргумент, который является маршрутом к загрузочному образу из корня дерева, записываемого на CD. По умолчанию, <a href="https://man.freebsd.org/cgi/man.cgi?query=mkisofs&amp;sektion=8&amp;format=html">mkisofs(8)</a> создает образ ISO в так называемом режиме "эмуляции флоппи-диска", и потому ожидает загрузочный образ размера строго 1200, 1440 или 2880 KB. Некоторые загрузчики, в том числе и тот, что используется на дистрибутивных дисках FreeBSD, не используют режим эмуляции; в этом случае должна использоваться опция <code>-no-emul-boot</code>. Так что, если <span class=filename>/tmp/myboot</span> содержит загрузочную систему FreeBSD с загрузочным образом в <span class=filename>/tmp/myboot/boot/cdboot</span>, вы можете создать образ файловой системы ISO 9660 в <span class=filename>/tmp/bootable.iso</span> следующим образом:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># mkisofs -R -no-emul-boot -b boot/cdboot -o /tmp/bootable.iso /tmp/myboot</span></code></pre></div></div><div class=paragraph><p>Сделав это, и имея в ядре отконфигурированное устройство <span class=filename>md</span>, вы можете смонтировать файловую систему, выполнив:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># mdconfig -a -t vnode -f /tmp/bootable.iso -u 0</span>
<span class=c># mount -t cd9660 /dev/md0 /mnt</span></code></pre></div></div><div class=paragraph><p>В этот момент вы можете проверить, что <span class=filename>/mnt</span> и <span class=filename>/tmp/myboot</span> идентичны.</p></div><div class=paragraph><p>Имеется много других опций, которые можно использовать с программой <a href="https://man.freebsd.org/cgi/man.cgi?query=mkisofs&amp;sektion=8&amp;format=html">mkisofs(8)</a> для тонкой настройки её поведения. В частности: модификации в размещении ISO 9660 и создание дисков в форматах Joliet и HFS. Обратитесь к справочным страницам по <a href="https://man.freebsd.org/cgi/man.cgi?query=mkisofs&amp;sektion=8&amp;format=html">mkisofs(8)</a> для получения более подробной информации.</p></div></div><div class=sect2><h3 id=burncd>17.6.3. burncd<a class=anchor href=#burncd></a></h3><div class=paragraph><p>Если ваше устройство для записи CD соответствует стандарту ATAPI, то для записи ISO-образа на компакт-диск вы можете воспользоваться командой <code>burncd</code>. <code>burncd</code> входит в базовый комплект операционной системы и установлена как <span class=filename>/usr/sbin/burncd</span>. Использовать её очень просто, так как параметров у ней немного:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># burncd -f cddevice data imagefile.iso fixate</span></code></pre></div></div><div class=paragraph><p>По этой команде файл <em>imagefile.iso</em> будет скопирован на <em>cddevice</em>. По умолчанию используется устройство <span class=filename>/dev/acd0</span>. Для получения информации о параметрах, задающих скорость записи, выброс диска после записи и запись звуковых данных, обратитесь к <a href="https://man.freebsd.org/cgi/man.cgi?query=burncd&amp;sektion=8&amp;format=html">burncd(8)</a>.</p></div></div><div class=sect2><h3 id=cdrecord>17.6.4. cdrecord<a class=anchor href=#cdrecord></a></h3><div class=paragraph><p>Если ваше устройство для записи CD не соответствует стандарту ATAPI, то для записи компакт-дисков вам нужно пользоваться программой <code>cdrecord</code>. <code>cdrecord</code> не входит в комплект поставки системы; вы должны установить её из порта <a class=package href=https://cgit.freebsd.org/ports/tree/sysutils/cdrtools/>sysutils/cdrtools</a> или из соответствующего пакета. Изменения в системе могут приводить к тому, что откомпилированные версии этой программы работать не будут, или приводить к порче дисков. Поэтому вы должны при обновлении системы либо обновить порт, либо, если вы <a href=../cutting-edge/#stable>следуете -STABLE</a>, обновить порт при появлении его новой версии.</p></div><div class=paragraph><p>Хотя <code>cdrecord</code> имеет много опций, в основном использовать её ещё проще, чем <code>burncd</code>. Запись образа ISO 9660 делается такой командой:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># cdrecord dev=device imagefile.iso</span></code></pre></div></div><div class=paragraph><p>Тонким моментом при использовании <code>cdrecord</code> является определение правильного устройства <code>dev</code>. Чтобы задать параметр правильно, воспользуйтесь флагом <code>-scanbus</code> команды <code>cdrecord</code>, в результате чего может получиться примерно такой результат:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># cdrecord -scanbus</span>
Cdrecord-Clone 2.01 <span class=o>(</span>i386-unknown-freebsd7.0<span class=o>)</span> Copyright <span class=o>(</span>C<span class=o>)</span> 1995-2004 J<span class=s2>&#34;org Schilling
Using libscg version &#39;schily-0.1&#39;
scsibus0:
	0,0,0     0) &#39;SEAGATE &#39; &#39;ST39236LW       &#39; &#39;0004&#39; Disk
	0,1,0     1) &#39;SEAGATE &#39; &#39;ST39173W        &#39; &#39;5958&#39; Disk
	0,2,0     2) *
	0,3,0     3) &#39;iomega  &#39; &#39;jaz 1GB         &#39; &#39;J.86&#39; Removable Disk
	0,4,0     4) &#39;NEC     &#39; &#39;CD-ROM DRIVE:466&#39; &#39;1.26&#39; Removable CD-ROM
	0,5,0     5) *
	0,6,0     6) *
	0,7,0     7) *
scsibus1:
	1,0,0   100) *
	1,1,0   101) *
	1,2,0   102) *
	1,3,0   103) *
	1,4,0   104) *
	1,5,0   105) &#39;YAMAHA  &#39; &#39;CRW4260         &#39; &#39;1.0q&#39; Removable CD-ROM
	1,6,0   106) &#39;ARTEC   &#39; &#39;AM12S           &#39; &#39;1.06&#39; Scanner
	1,7,0   107) *</span></code></pre></div></div><div class=paragraph><p>Здесь приведены соответствующие значения параметров <code>dev</code> для имеющихся устройств. Найдите здесь ваше устройство для записи CD, а в качестве параметров для <code>dev</code> задавайте три числа через запятые. В нашем случае CRW-устройству соответствуют числа 1,5,0, так что правильным параметром будет <code>dev=1,5,0</code>. Имеется более простой способ задать эти значения; обратитесь к справочной информации о <a href="https://man.freebsd.org/cgi/man.cgi?query=cdrecord&amp;sektion=1&amp;format=html">cdrecord(1)</a> для выяснения подробностей. Там же находится информация о записи звуковых дорожек, управлении скоростью и другим вещам.</p></div></div><div class=sect2><h3 id=duplicating-audiocds>17.6.5. Копирование аудио CD<a class=anchor href=#duplicating-audiocds></a></h3><div class=paragraph><p>Вы можете копировать музыкальные CD, извлекая данные аудио с CD в набор файлов, а затем записывая эти файлы на чистый CD. Процесс несколько различен в случаях использования устройств ATAPI и SCSI.</p></div><div class="exampleblock procedure"><div class=content><div class=paragraph><p><strong>Procedure: Устройства SCSI</strong></p></div><div class="olist arabic"><ol class=arabic><li><p>Используйте <code>cdda2wav</code> для извлечения данных аудио.</p><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>% cdda2wav <span class=nt>-vall</span> <span class=nt>-D2</span>,0 <span class=nt>-B</span> <span class=nt>-Owav</span></code></pre></div></div></li><li><p>Воспользуйтесь <code>cdrecord</code> для записи файлов <span class=filename>.wav</span>.</p><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>% cdrecord <span class=nt>-v</span> <span class=nv>dev</span><span class=o>=</span>2,0 <span class=nt>-dao</span> <span class=nt>-useinfo</span>  <span class=k>*</span>.wav</code></pre></div></div><div class=paragraph><p>Значение, соответствующее <em>2,0</em>, должно быть установлено правильно, как это описано в <a href=#cdrecord>cdrecord</a>.</p></div></li></ol></div></div></div><div class="exampleblock procedure"><div class=content><div class=paragraph><p><strong>Procedure: Устройства ATAPI</strong></p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>На приводах ATAPI также можно использовать утилиту <code>cdda2wav</code>. Для её функционирования потребуется <a href=#atapicam>драйвер ATAPI/CAM</a>. Следует отметить, что данная утилита предназначена для корректного извлечения и обработки аудио данных, в отличие от утилиты, приведенной в нижеследующем примере.</p></div></td></tr></tbody></table></div><div class="olist arabic"><ol class=arabic><li><p>Драйвер устройств ATAPI CD делает каждую дорожку доступной как <span class=filename>/dev/acddtnn</span>, где <em>d</em> является номером привода, а <em>nn</em> соответствует номеру дорожки, который записывается двумя десятичными цифрами с нулём в начале, если это нужно. Таким образом, первая дорожка на первом диске будет носить имя <span class=filename>/dev/acd0t01</span>, вторая будет именоваться <span class=filename>/dev/acd0t02</span>, третья будет носить имя <span class=filename>/dev/acd0t03</span> и так далее.</p><div class=paragraph><p>Удостоверьтесь, что соответствующий файл имеется в каталоге <span class=filename>/dev</span>. При его отсутствии следует принудительно перечитать оглавление диска:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># dd if=/dev/acd0 of=/dev/null count=1</span></code></pre></div></div></li><li><p>Извлеките каждую дорожку при помощи команды <a href="https://man.freebsd.org/cgi/man.cgi?query=dd&amp;sektion=1&amp;format=html">dd(1)</a>. При извлечении файлов вы должны также использовать специфическое значение для размера блока.</p><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># dd if=/dev/acd0t01 of=track1.cdr bs=2352</span>
<span class=c># dd if=/dev/acd0t02 of=track2.cdr bs=2352</span>
...</code></pre></div></div></li><li><p>Запишите извлечённые файлы на диск при помощи утилиты <code>burncd</code>. Вы должны указать, что это файлы с аудио, и что <code>burncd</code> должна зафиксировать диск по окончании работы.</p><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># burncd -f /dev/acd0 audio track1.cdr track2.cdr ... fixate</span></code></pre></div></div></li></ol></div></div></div></div><div class=sect2><h3 id=imaging-cd>17.6.6. Копирование компакт-дисков с данными<a class=anchor href=#imaging-cd></a></h3><div class=paragraph><p>Вы можете скопировать CD с данными в файл образа, который функционально эквивалентен файлу образа, созданному командой <a href="https://man.freebsd.org/cgi/man.cgi?query=mkisofs&amp;sektion=8&amp;format=html">mkisofs(8)</a>, и вы можете использовать его для копирования любого CD с данными. В приводимом здесь примере предполагается, что ваш привод CDROM называется <span class=filename>acd0</span>. Подставьте название вашего привода CDROM.</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># dd if=/dev/acd0 of=file.iso bs=2048</span></code></pre></div></div><div class=paragraph><p>Теперь, когда вы имеете образ, вы можете записать его на CD так, как это описано выше.</p></div></div><div class=sect2><h3 id=mounting-cd>17.6.7. Использование компакт-диски с данными<a class=anchor href=#mounting-cd></a></h3><div class=paragraph><p>Теперь, после того, как вы создали стандартный CDROM с данными, вы, наверное, захотите смонтировать его и считать с него данные. По умолчанию <a href="https://man.freebsd.org/cgi/man.cgi?query=mount&amp;sektion=8&amp;format=html">mount(8)</a> предполагает, что файловая система имеет тип <code>ufs</code>. Если вы попытаетесь выполнить что-то вроде:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># mount /dev/cd0 /mnt</span></code></pre></div></div><div class=paragraph><p>вы получите сообщение <code>Incorrect super block</code>, и диск не смонтируется. CDROM не является файловой системой <code>UFS</code>, поэтому попытки смонтировать его таким образом будут терпеть неудачу. Вам просто нужно указать команде <a href="https://man.freebsd.org/cgi/man.cgi?query=mount&amp;sektion=8&amp;format=html">mount(8)</a>, что файловая система имеет тип <code>ISO9660</code>, и всё должно заработать. Сделайте это, задав параметр <code>-t cd9660</code> при вызове <a href="https://man.freebsd.org/cgi/man.cgi?query=mount&amp;sektion=8&amp;format=html">mount(8)</a>. К примеру, если вы хотите смонтировать устройство CDROM, <span class=filename>/dev/cd0</span>, в каталог <span class=filename>/mnt</span>, вы должны выполнить:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># mount -t cd9660 /dev/cd0 /mnt</span></code></pre></div></div><div class=paragraph><p>Заметьте, что имя вашего устройства (<span class=filename>/dev/cd0</span> в этом примере) может быть другим, в зависимости от интерфейса, используемого в CDROM. Кроме того, параметр <code>-t cd9660</code> всего лишь задаёт выполнение утилиты <a href="https://man.freebsd.org/cgi/man.cgi?query=mount_cd9660&amp;sektion=8&amp;format=html">mount_cd9660(8)</a>. Пример выше может быть упрощён до:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># mount_cd9660 /dev/cd0c /mnt</span></code></pre></div></div><div class=paragraph><p>Таким способом, вообще говоря, вы можете использовать компакт-диски любого производителя. Диски с некоторыми расширениями ISO 9660 могут, однако, работать со странностями. К примеру диски Joliet хранят все имена файлов в виде последовательностей двухбайтовых символов Unicode. Ядро FreeBSD не может работать с Unicode, но CD9660 драйвер способен преобразовывать Unicode символы на лету. Если некоторые символы не английского алфавита выглядят, как знаки вопроса, то вам нужно указать используемую вами кодировку с помощью опции <code>-C</code>. За дополнительной информацией, обращайтесь к странице справочника <a href="https://man.freebsd.org/cgi/man.cgi?query=mount_cd9660&amp;sektion=8&amp;format=html">mount_cd9660(8)</a>.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Чтобы смочь произвести преобразование символов посредством опции <code>-C</code>, ядру понадобится загрузить модуль <span class=filename>cd9660_iconv.ko</span>. Это может быть сделано либо добавлением ниже представленной строчки в <span class=filename>loader.conf</span>:</p></div><div class="literalblock programlisting"><div class=content><pre>cd9660_iconv_load=&#34;YES&#34;</pre></div></div><div class=paragraph><p>с последующей перезагрузкой машины, либо загрузкой модуля вручную с помощью <a href="https://man.freebsd.org/cgi/man.cgi?query=kldload&amp;sektion=8&amp;format=html">kldload(8)</a>.</p></div></td></tr></tbody></table></div><div class=paragraph><p>Время от времени вы можете получать сообщения <code>Device not configured</code> при попытке смонтировать CDROM. Это обычно означает, что привод CDROM полагает, что в нём нет диска, или что привод не виден на шине. Приводу CDROM может понадобиться несколько секунд, чтобы понять, что он был закрыт, так что будьте терпеливы.</p></div><div class=paragraph><p>Иногда SCSI CDROM может потеряться из-за того, что у него не было достаточно времени, чтобы ответить на сброс шины. Если у вас имеется SCSI CDROM, то, пожалуйста, добавьте следующий параметр в конфигурацию вашего ядра и <a href=../kernelconfig/#kernelconfig-building>перестройте его</a>.</p></div><div class="literalblock programlisting"><div class=content><pre>options SCSI_DELAY=15000</pre></div></div><div class=paragraph><p>Это укажет вашей шине SCSI выдерживать 15-секундную паузу во время загрузки, чтобы дать вашему приводу CDROM шанс ответить на сброс шины.</p></div></div><div class=sect2><h3 id=rawdata-cd>17.6.8. Запись необработанных данных на компакт-диски<a class=anchor href=#rawdata-cd></a></h3><div class=paragraph><p>Вы можете предпочесть запись файла непосредственно на CD без создания файловой системы ISO 9660. Некоторые поступают так при создании резервных копий. Это выполняется гораздо быстрее. чем запись стандартного компакт-диска:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># burncd -f /dev/acd1 -s 12 data archive.tar.gz fixate</span></code></pre></div></div><div class=paragraph><p>Для извлечения данных, записанных так на компакт-диск, вы должны считывать данные из файла непосредственного доступа к устройству:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># tar xzvf /dev/acd1</span></code></pre></div></div><div class=paragraph><p>Вы не можете монтировать этот диск как обычный CDROM. Такой компакт-диск не может быть прочитан ни в какой другой операционной системе, кроме FreeBSD. Если вы хотите монтировать CD или обменяться данными с другой операционной системой, то вы должны использовать <a href="https://man.freebsd.org/cgi/man.cgi?query=mkisofs&amp;sektion=8&amp;format=html">mkisofs(8)</a> так, как это было описано выше.</p></div></div><div class=sect2><h3 id=atapicam>17.6.9. Использование драйвера ATAPI/CAM<a class=anchor href=#atapicam></a></h3><div class=paragraph><p>Этот драйвер позволяет работать с ATAPI-устройствами (приводы CD-ROM, CD-RW, DVD и так далее) через подсистему SCSI, таким образом расширяя использование таких приложений, как <a class=package href=https://cgit.freebsd.org/ports/tree/sysutils/cdrdao/>sysutils/cdrdao</a> или <a href="https://man.freebsd.org/cgi/man.cgi?query=cdrecord&amp;sektion=1&amp;format=html">cdrecord(1)</a>.</p></div><div class=paragraph><p>Для использования этого драйвера вам необходимо добавить в файл <span class=filename>/boot/loader.conf</span> следующую строку:</p></div><div class="literalblock programlisting"><div class=content><pre>atapicam_load=&#34;YES&#34;</pre></div></div><div class=paragraph><p>с последующей перезагрузкой машины.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Если для вас предпочтительнее статически скомпилировать поддержку <a href="https://man.freebsd.org/cgi/man.cgi?query=atapicam&amp;sektion=4&amp;format=html">atapicam(4)</a> в ядро, то добавьте эту строчку в файл конфигурации ядра:</p></div><div class="literalblock programlisting"><div class=content><pre>device atapicam</pre></div></div><div class=paragraph><p>Кроме того, в файле конфигурации ядра должны быть следующие строки:</p></div><div class="literalblock programlisting"><div class=content><pre>device ata
device scbus
device cd
device pass</pre></div></div><div class=paragraph><p>которые уже должны там присутствовать. Затем пересоберите, установите новое ядро и перезагрузите компьютер.</p></div></td></tr></tbody></table></div><div class=paragraph><p>В процессе загрузки ваш пишущий привод должен появиться примерно следующим образом:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>acd0: CD-RW &lt;MATSHITA CD-RW/DVD-ROM UJDA740&gt; at ata1-master PIO4
cd0 at ata1 bus 0 target 0 lun 0
cd0: &lt;MATSHITA CDRW/DVD UJDA740 1.00&gt; Removable CD-ROM SCSI-0 device
cd0: 16.000MB/s transfers
cd0: Attempt to query device size failed: NOT READY, Medium not present - tray closed</code></pre></div></div><div class=paragraph><p>Теперь с ним можно работать через устройство <span class=filename>/dev/cd0</span>, например, чтобы смонтировать CD-ROM в каталог <span class=filename>/mnt</span>, просто наберите следующую команду:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># mount -t cd9660 /dev/cd0 /mnt</span></code></pre></div></div><div class=paragraph><p>Для получения SCSI-адреса пишущего привода, вы можете, работая как пользователь <code>root</code>, запустить такую команду:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># camcontrol devlist</span>
&lt;MATSHITA CDRW/DVD UJDA740 1.00&gt;   at scbus1 target 0 lun 0 <span class=o>(</span>pass0,cd0<span class=o>)</span></code></pre></div></div><div class=paragraph><p>Таким образом, <code>1,0,0</code> будет SCSI-адресом для использования с <a href="https://man.freebsd.org/cgi/man.cgi?query=cdrecord&amp;sektion=1&amp;format=html">cdrecord(1)</a> и другими приложениями для работы со SCSI.</p></div><div class=paragraph><p>Для получения дополнительной информации об ATAPI/CAM и системе SCSI, обратитесь к страницам справочной системы по <a href="https://man.freebsd.org/cgi/man.cgi?query=atapicam&amp;sektion=4&amp;format=html">atapicam(4)</a> и <a href="https://man.freebsd.org/cgi/man.cgi?query=cam&amp;sektion=4&amp;format=html">cam(4)</a>.</p></div></div></div></div><div class=sect1><h2 id=creating-dvds>17.7. Создание и использование оптических носителей (DVD)<a class=anchor href=#creating-dvds></a></h2><div class=sectionbody><div class=sect2><h3 id=_введение_2>17.7.1. Введение<a class=anchor href=#_введение_2></a></h3><div class=paragraph><p>DVD это следующее после CD поколение оптических носителей. DVD может вмещать больше данных чем любой CD и является современным стандартом распространения видео.</p></div><div class=paragraph><p>Для записываемых DVD существует пять физических форматов записи:</p></div><div class=ulist><ul><li><p>DVD-R: Был первым форматом записываемых DVD. Стандарт DVD-R был создан <a href=http://www.dvdforum.com/forum.shtml>DVD Forum</a>. Это формат для однократной записи.</p></li><li><p>DVD-RW: Это перезаписываемая версия стандарта DVD-R. Носители DVD-RW могут быть перезаписаны около 1000 раз.</p></li><li><p>DVD-RAM: Это также перезаписываемый формат, поддерживаемый DVD Forum. DVD-RAM может быть виден как съемный жесткий диск. Однако, этот носитель не совместим с большинством приводов DVD-ROM и проигрывателями DVD-Video; лишь некоторые пишущие DVD поддерживают формат DVD-RAM. Более подробно о работе с DVD-RAM можно прочитать в разделе <a href=#creating-dvd-ram>Использование DVD-RAM</a>.</p></li><li><p>DVD+RW: Это перезаписываемый формат, созданный <a href=http://www.dvdrw.com/>DVD+RW Alliance</a>. Носитель DVD+RW может быть перезаписан около 1000 раз.</p></li><li><p>DVD+R: Этот формат - однократно записываемая версия формата DVD+RW.</p></li></ul></div><div class=paragraph><p>Однослойный записываемый DVD может хранить до 4,700,000,000 байт, что равно 4.38 Гбайт, или 4485 Мбайт (1 килобайт это 1024 байт).</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Необходимо различать физический носитель и приложение. Например, DVD-Video это определенная файловая раскладка, которая может быть помещена на записываемый DVD любого физического формата: DVD-R, DVD+R, DVD-RW и т.д. Перед выбором типа носителя вы должны убедиться, что и устройство записи и DVD-Video проигрыватель (отдельный или DVD-ROM привод компьютера) совместимы с данным носителем.</p></div></td></tr></tbody></table></div></div><div class=sect2><h3 id=_настройка_2>17.7.2. Настройка<a class=anchor href=#_настройка_2></a></h3><div class=paragraph><p>Для записи DVD будет использоваться программа <a href="https://man.freebsd.org/cgi/man.cgi?query=growisofs&amp;sektion=1&amp;format=html">growisofs(1)</a>. Эта команда входит в набор утилит dvd+rw-tools (<a class=package href=https://cgit.freebsd.org/ports/tree/sysutils/dvd+rw-tools/>sysutils/dvd+rw-tools</a>), который поддерживает все типы носителей DVD.</p></div><div class=paragraph><p>Эти утилиты используют подсистему SCSI для доступа к устройствам, следовательно необходимо добавить в ядро <a href=#atapicam>поддержку ATAPI/CAM</a>. Если пишущий привод использует USB интерфейс, это добавление бесполезно и необходимо прочесть более подробную информацию по настройке устройств USB в <a href=#usb-disks>USB устройства хранения</a></p></div><div class=paragraph><p>Вам также потребуется включить DMA доступ для устройств ATAPI, это можно сделать добавив в <span class=filename>/boot/loader.conf</span> следующую строку:</p></div><div class="literalblock programlisting"><div class=content><pre>hw.ata.atapi_dma=&#34;1&#34;</pre></div></div><div class=paragraph><p>Перед использованием dvd+rw-tools вы должны свериться со <a href=http://fy.chalmers.se/~appro/linux/DVD+RW/hcn.html>списком совместимого оборудования dvd+rw-tools</a> с информацией по устройствам для записи DVD.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Если вам нужен графический интерфейс пользователя, взгляните на K3b (<a class=package href=https://cgit.freebsd.org/ports/tree/sysutils/k3b/>sysutils/k3b</a>), который предоставляет дружественный пользователю интерфейс к <a href="https://man.freebsd.org/cgi/man.cgi?query=growisofs&amp;sektion=1&amp;format=html">growisofs(1)</a> и многим другим программам записи.</p></div></td></tr></tbody></table></div></div><div class=sect2><h3 id=_запись_dvd_с_данными>17.7.3. Запись DVD с данными<a class=anchor href=#_запись_dvd_с_данными></a></h3><div class=paragraph><p>Команда <a href="https://man.freebsd.org/cgi/man.cgi?query=growisofs&amp;sektion=1&amp;format=html">growisofs(1)</a> является оболочкой для <a href=#mkisofs>mkisofs</a>, она вызовет <a href="https://man.freebsd.org/cgi/man.cgi?query=mkisofs&amp;sektion=8&amp;format=html">mkisofs(8)</a> для создания файловой системы и запишет DVD. Это означает, что вам не потребуется создавать образ с данными перед началом процесса записи.</p></div><div class=paragraph><p>Для записи данных из каталога <span class=filename>/path/to/data</span> на DVD+R или DVD-R, используйте следующую команду:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># growisofs -dvd-compat -Z /dev/cd0 -J -R /path/to/data</span></code></pre></div></div><div class=paragraph><p>Параметры <code>-J -R</code> передаются <a href="https://man.freebsd.org/cgi/man.cgi?query=mkisofs&amp;sektion=8&amp;format=html">mkisofs(8)</a> для создания файловой системы (в данном случае: файловая система ISO 9660 с расширениями Joliet и Rock Ridge), обратитесь к странице справочника <a href="https://man.freebsd.org/cgi/man.cgi?query=mkisofs&amp;sektion=8&amp;format=html">mkisofs(8)</a> за более подробной информацией.</p></div><div class=paragraph><p>Параметр <code>-Z</code> используется для первой сессии записи в любом случае: для одной или нескольких сессий. Устройство DVD, <em>/dev/cd0</em>, должно быть изменено в соответствии с имеющимися настройками. Параметр <code>-dvd-compat</code> закроет диск и дозапись станет невозможна. Это должно улучшить совместимость с приводами DVD-ROM.</p></div><div class=paragraph><p>Возможна также запись предварительного (pre-mastered) образа, например, для записи <em>imagefile.iso</em> запустим:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># growisofs -dvd-compat -Z /dev/cd0=imagefile.iso</span></code></pre></div></div><div class=paragraph><p>Скорость записи должна быть определена и автоматически установлена в соответствии с носителем и приводом. Если вы хотите явно указать скорость записи, используйте параметр <code>-speed=</code>. За дальнейшей информацией обратитесь к странице справочника <a href="https://man.freebsd.org/cgi/man.cgi?query=growisofs&amp;sektion=1&amp;format=html">growisofs(1)</a>.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Если размер файлов внутри набора превышает 4.38Гб, то необходимо будет создать гибридную файловую систему UDF/ISO-9660, для чего потребуется передать параметры <code>-udf -iso-level 3</code> в <a href="https://man.freebsd.org/cgi/man.cgi?query=mkisofs&amp;sektion=8&amp;format=html">mkisofs(8)</a> и в остальные соответствующие программы (например, <a href="https://man.freebsd.org/cgi/man.cgi?query=growisofs&amp;sektion=1&amp;format=html">growisofs(1)</a>). Указание параметров обязательно лишь во время создания файла образа или во время непосредственной записи на диск. Созданный таким способом диск должен монтироваться утилитой <a href="https://man.freebsd.org/cgi/man.cgi?query=mount_udf&amp;sektion=8&amp;format=html">mount_udf(8)</a>. Диск будет доступен лишь тем операционным системам, которые поддерживают UDF; в противном случае носитель будет отображаться как поврежденный.</p></div><div class=paragraph><p>Для того, чтобы создать такой образ, выполните:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>% mkisofs <span class=nt>-R</span> <span class=nt>-J</span> <span class=nt>-udf</span> <span class=nt>-iso-level</span> 3 <span class=nt>-o</span> imagefile.iso /path/to/data</code></pre></div></div><div class=paragraph><p>Для того, чтобы записать файлы прямо на диск, наберите:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># growisofs -dvd-compat -udf -iso-level 3 -Z /dev/cd0 -J -R /path/to/data</span></code></pre></div></div><div class=paragraph><p>Если у вас в распоряжении уже имеется образ, содержащий в себе файлы большого размера, то для записи образа на диск никаких дополнительных опций для <a href="https://man.freebsd.org/cgi/man.cgi?query=growisofs&amp;sektion=1&amp;format=html">growisofs(1)</a> не потребуется.</p></div><div class=paragraph><p>Также удостоверьтесь, что у вас установлена последняя версия <a class=package href=https://cgit.freebsd.org/ports/tree/sysutils/cdrtools/>sysutils/cdrtools</a> (<a href="https://man.freebsd.org/cgi/man.cgi?query=mkisofs&amp;sektion=8&amp;format=html">mkisofs(8)</a> принадлежит к этому порту), поскольку предыдущие версии утилит не поддерживают работу с большими файлами. Если с этим портом возникают проблемы, то установите <a class=package href=https://cgit.freebsd.org/ports/tree/sysutils/cdrtools-devel/>sysutils/cdrtools-devel</a> и прочитайте страницу справочника <a href="https://man.freebsd.org/cgi/man.cgi?query=mkisofs&amp;sektion=8&amp;format=html">mkisofs(8)</a>.</p></div></td></tr></tbody></table></div></div><div class=sect2><h3 id=_запись_dvd_video>17.7.4. Запись DVD-Video<a class=anchor href=#_запись_dvd_video></a></h3><div class=paragraph><p>DVD-Video это особая файловая система, базирующаяся на ISO 9660 и спецификациях micro-UDF (M-UDF). DVD-Video также представляет определенную иерархию структуры данных, поэтому для создания DVD потребуется особая программа, такая как <a class=package href=https://cgit.freebsd.org/ports/tree/multimedia/dvdauthor/>multimedia/dvdauthor</a>.</p></div><div class=paragraph><p>Если у вас уже есть образ файловой системы DVD-Video, просто запишите его как любой другой образ, примеры находятся в предыдущем разделе. Если вы создали DVD и результат находится в каталоге <span class=filename>/path/to/video</span>, для записи DVD-Video должна быть использована следующая команда:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># growisofs -Z /dev/cd0 -dvd-video /path/to/video</span></code></pre></div></div><div class=paragraph><p>Параметр <code>-dvd-video</code> будет передан <a href="https://man.freebsd.org/cgi/man.cgi?query=mkisofs&amp;sektion=8&amp;format=html">mkisofs(8)</a> и укажет создать файловую систему DVD-Video. Помимо этого, параметр <code>-dvd-video</code> подразумевает параметр <a href="https://man.freebsd.org/cgi/man.cgi?query=growisofs&amp;sektion=1&amp;format=html">growisofs(1)</a> <code>-dvd-compat</code>.</p></div></div><div class=sect2><h3 id=_использование_dvdrw>17.7.5. Использование DVD+RW<a class=anchor href=#_использование_dvdrw></a></h3><div class=paragraph><p>В отличие от CD-RW, новый DVD+RW необходимо отформатировать перед первым использованием. Программа <a href="https://man.freebsd.org/cgi/man.cgi?query=growisofs&amp;sektion=1&amp;format=html">growisofs(1)</a> позаботится об этом сама при необходимости, и это <em>рекомендованный</em> способ. Тем не менее, для форматирования DVD+RW вы можете использовать команду <code>dvd+rw-format</code>:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># dvd+rw-format /dev/cd0</span></code></pre></div></div><div class=paragraph><p>Эту операцию необходимо выполнить лишь однажды, помните, что только новые носители DVD+RW необходимо форматировать. Затем запишите DVD+RW тем способом, который описан в предыдущем разделе.</p></div><div class=paragraph><p>Если вы хотите записать новые данные (полностью новую файловую систему, а не дописать данные) на DVD+RW, его не нужно очищать, просто запишите поверх предыдущей записи (создав новую начальную сессию) примерно так :</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># growisofs -Z /dev/cd0 -J -R /path/to/newdata</span></code></pre></div></div><div class=paragraph><p>Формат DVD+RW делает возможным легко дописать данные к предыдущей записи. Операция состоит в присоединении предыдущей сессии к существующей, это не мультисессионная запись, <a href="https://man.freebsd.org/cgi/man.cgi?query=growisofs&amp;sektion=1&amp;format=html">growisofs(1)</a> <em>расширит</em> (grow) файловую систему ISO 9660, существующую на носителе.</p></div><div class=paragraph><p>Например, для дозаписи данных к предыдущей сессии на DVD+RW, используется следующая команда:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># growisofs -M /dev/cd0 -J -R /path/to/nextdata</span></code></pre></div></div><div class=paragraph><p>При последующих записях <a href="https://man.freebsd.org/cgi/man.cgi?query=mkisofs&amp;sektion=8&amp;format=html">mkisofs(8)</a> необходимо передавать те же параметры, что и при первой записи.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Вы можете использовать параметр <code>-dvd-compat</code> для улучшения совместимости с приводами DVD-ROM. В случае DVD+RW это не помешает добавлению данных.</p></div></td></tr></tbody></table></div><div class=paragraph><p>Если по какой-либо причине вам потребуется очистить носитель, используйте следующую команду:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># growisofs -Z /dev/cd0=/dev/zero</span></code></pre></div></div></div><div class=sect2><h3 id=_использование_dvd_rw>17.7.6. Использование DVD-RW<a class=anchor href=#_использование_dvd_rw></a></h3><div class=paragraph><p>Существует два формата дисков DVD-RW: последовательно дополняемый и с ограниченной перезаписью. По умолчанию формат дисков DVD-RW последовательный.</p></div><div class=paragraph><p>Новый DVD-RW может быть записан непосредственно без необходимости форматирования, однако DVD-RW с данными в последовательном формате необходимо очистить перед созданием новой начальной сессии.</p></div><div class=paragraph><p>Для очистки DVD-RW в последовательном формате, запустите:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># dvd+rw-format -blank=full /dev/cd0</span></code></pre></div></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Полная очистка (<code>-blank=full</code>) займет около одного часа на скорости 1x. Быструю очистку можно выполнить с параметром <code>-blank</code>, если DVD-RW будет записан в режиме Disk-At-Once (DAO). Для записи DVD-RW в режиме DAO, используйте команду:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># growisofs -use-the-force-luke=dao -Z /dev/cd0=imagefile.iso</span></code></pre></div></div><div class=paragraph><p>Параметр <code>-use-the-force-luke=dao</code> не должен потребоваться, поскольку <a href="https://man.freebsd.org/cgi/man.cgi?query=growisofs&amp;sektion=1&amp;format=html">growisofs(1)</a> попытается определить был ли носитель быстро очищен и включить DAO запись.</p></div><div class=paragraph><p>Фактически, лучше использовать режим с ограниченной перезаписью с любым DVD-RW, этот формат более гибкий, чем формат по умолчанию с последовательной записью.</p></div></td></tr></tbody></table></div><div class=paragraph><p>Для записи данных на последовательный DVD-RW, используйте ту же команду, что и для других форматов DVD:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># growisofs -Z /dev/cd0 -J -R /path/to/data</span></code></pre></div></div><div class=paragraph><p>Если вы хотите добавить данные к предыдущей записи, используйте параметр <a href="https://man.freebsd.org/cgi/man.cgi?query=growisofs&amp;sektion=1&amp;format=html">growisofs(1)</a> <code>-M</code>. Однако при добавлении данных на DVD-RW в последовательном режиме, на диске будет создана новая сессия и в результате получится мультисессионный диск.</p></div><div class=paragraph><p>В формате DVD-RW с ограниченной перезаписью не требуется очищать носитель перед созданием новой начальной сессии, вам всего лишь нужно переписать диск с параметром <code>-Z</code>, подобно DVD+RW. Возможно также увеличение существующей файловой системы ISO 9660, записанной на диск тем же способом, как для DVD+RW с параметром <code>-M</code>. В результате получится односессионный DVD.</p></div><div class=paragraph><p>Для перевода DVD-RW в формат с ограниченной перезаписью, необходимо использовать следующую команду:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># dvd+rw-format /dev/cd0</span></code></pre></div></div><div class=paragraph><p>Для перевода обратно в последовательный формат, выполните:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># dvd+rw-format -blank=full /dev/cd0</span></code></pre></div></div></div><div class=sect2><h3 id=_мультисессия>17.7.7. Мультисессия<a class=anchor href=#_мультисессия></a></h3><div class=paragraph><p>Лишь несколько DVD-ROM и проигрывателей поддерживают мультисессионные DVD, в основном они в лучшем случае прочтут только первую сессию. DVD+R, DVD-R и DVD-RW в последовательном формате могут работать с несколькими сессиями, и это не относится к форматам DVD+RW и DVD-RW в формате ограниченной перезаписи.</p></div><div class=paragraph><p>Использование следующей команды после первой (не закрытой) сессии для DVD+R, DVD-R, или DVD-RW в последовательном формате, добавит на диск новую сессию:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># growisofs -M /dev/cd0 -J -R /path/to/nextdata</span></code></pre></div></div><div class=paragraph><p>Использование этой командной строки с DVD+RW или DVD-RW в режиме ограниченной перезаписи добавит данные, объединив новую сессию с предыдущей. В результате получится односессионный диск. Такой способ используется для добавления данных после первой записи на эти носители.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Некоторый объем носителя используется между сессиями для завершения и начала сессии. Следовательно, для оптимизации объема хранения сессии должны быть большими. Количество сессий ограничено 154 для DVD+R, около 2000 для DVD-R и 127 для DVD+R Double Layer.</p></div></td></tr></tbody></table></div></div><div class=sect2><h3 id=_дополнительная_информация_2>17.7.8. Дополнительная информация<a class=anchor href=#_дополнительная_информация_2></a></h3><div class=paragraph><p>Для получения дополнительной информации о DVD, можно запустить команду <code>dvd+rw-mediainfo <em>/dev/cd0</em></code>, диск должен находиться в приводе.</p></div><div class=paragraph><p>Дополнительная информация о dvd+rw-tools может быть найдена на странице справочника <a href="https://man.freebsd.org/cgi/man.cgi?query=growisofs&amp;sektion=1&amp;format=html">growisofs(1)</a>, на <a href=http://fy.chalmers.se/~appro/linux/DVD+RW/>Web-сайте dvd+rw-tools</a> и в архивах <a href=http://lists.debian.org/cdwrite/>списка рассылки cdwrite</a>.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Вывод <code>dvd+rw-mediainfo</code> при записи или проблемный носитель необходимы для любого сообщения о проблеме. Без этого вывода будет совершенно невозможно помочь вам.</p></div></td></tr></tbody></table></div></div><div class=sect2><h3 id=creating-dvd-ram>17.7.9. Использование DVD-RAM<a class=anchor href=#creating-dvd-ram></a></h3><div class=sect3><h4 id=_конфигурация>17.7.9.1. Конфигурация<a class=anchor href=#_конфигурация></a></h4><div class=paragraph><p>Записывающие устройства DVD-RAM поставляются с интерфейсами SCSI и ATAPI. В последнем случае вы должны убедиться, что для них включен режим DMA, добавив в файл <span class=filename>/boot/loader.conf</span> строку</p></div><div class="literalblock programlisting"><div class=content><pre>hw.ata.atapi_dma=&#34;1&#34;</pre></div></div></div><div class=sect3><h4 id=_подготовка_носителя>17.7.9.2. Подготовка носителя<a class=anchor href=#_подготовка_носителя></a></h4><div class=paragraph><p>Как указывалось ранее, DVD-RAM представляется съемным жестким диском. Как и другие дисковые устройства, DVD-RAM должен быть "подготовлен" к первому использованию. В нашем примере мы займём все пространство диска одной файловой системой UFS2:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># dd if=/dev/zero of=/dev/acd0 bs=2k count=1</span>
<span class=c># bsdlabel -Bw acd0</span>
<span class=c># newfs /dev/acd0</span></code></pre></div></div><div class=paragraph><p>Имя устройства DVD device, <span class=filename>acd0</span>, должно соответствовать вашей конфигурации.</p></div></div><div class=sect3><h4 id=_использование_носителя>17.7.9.3. Использование носителя<a class=anchor href=#_использование_носителя></a></h4><div class=paragraph><p>После выполнения указанных выше команд, DVD-RAM может быть смонтирован как обычный жесткий диск:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># mount /dev/acd0 /mnt</span></code></pre></div></div><div class=paragraph><p>После этого вы можете читать и писать на DVD-RAM.</p></div></div></div></div></div><div class=sect1><h2 id=floppies>17.8. Дискеты<a class=anchor href=#floppies></a></h2><div class=sectionbody><div class=paragraph><p>Хранение данных на дискетах иногда бывает полезным, например, когда нет других съёмных носителей или когда необходимо перенести небольшой объём данных на другой компьютер.</p></div><div class=paragraph><p>В этом разделе будет описано, как использовать дискеты во FreeBSD. В основном речь пойдёт о форматировании и использовании дискет DOS размером 3.5 дюйма, однако общие принципы применимы и для других форматов гибких дисков.</p></div><div class=sect2><h3 id=_форматирование_дискет>17.8.1. Форматирование дискет<a class=anchor href=#_форматирование_дискет></a></h3><div class=sect3><h4 id=_устройство>17.8.1.1. Устройство<a class=anchor href=#_устройство></a></h4><div class=paragraph><p>Доступ к гибким дискам, как, впрочем, и к остальным устройствам, осуществляется через соответствующие файлы в каталога <span class=filename>/dev</span>. Чтобы обратиться к дискете, просто используйте <span class=filename>/dev/fdN</span>.</p></div></div><div class=sect3><h4 id=_форматирование>17.8.1.2. Форматирование<a class=anchor href=#_форматирование></a></h4><div class=paragraph><p>Перед тем, как дискетой можно будет воспользоваться, её необходимо отформатировать на низком уровне. Обычно это выполняется производителем, однако форматирование является хорошим способом проверить целостность носителя. Большинство гибких дисков предназначены для использования с размером 1440kB, однако возможно задать меньший или больший размер.</p></div><div class=paragraph><p>Для низкоуровневого форматирования дискет вам нужно использовать <a href="https://man.freebsd.org/cgi/man.cgi?query=fdformat&amp;sektion=1&amp;format=html">fdformat(1)</a>. В качестве параметра этой утилите передаётся имя устройства.</p></div><div class=paragraph><p>Обратите внимание на появление сообщений об ошибках, так как они могут помочь определить, хорошая это дискета или плохая.</p></div><div class=sect4><h5 id=_форматирование_гибких_дисков>17.8.1.2.1. Форматирование гибких дисков<a class=anchor href=#_форматирование_гибких_дисков></a></h5><div class=paragraph><p>Для форматирования гибких дисков используйте устройства <span class=filename>/dev/fdN</span>. Вставьте новую 3.5-дюймовую дискету в дисковод и введите команду:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># /usr/sbin/fdformat -f 1440 /dev/fd0</span></code></pre></div></div></div></div></div><div class=sect2><h3 id=_метка_диска>17.8.2. Метка диска<a class=anchor href=#_метка_диска></a></h3><div class=paragraph><p>После низкоуровневого форматирования диска вам нужно поместить на него метку диска. Эта метка будет потом разрушена, но она будет нужна системе для определения размера диска и его характеристик.</p></div><div class=paragraph><p>Новая метка диска будет касаться диска в целом, и будет содержать полную информацию о параметрах дискеты. Значения геометрии для метки диска перечислены в файле <span class=filename>/etc/disktab</span>.</p></div><div class=paragraph><p>Теперь вы можете запустить <a href="https://man.freebsd.org/cgi/man.cgi?query=bsdlabel&amp;sektion=8&amp;format=html">bsdlabel(8)</a> примерно так:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># /sbin/bsdlabel -B -w /dev/fd0 fd1440</span></code></pre></div></div></div><div class=sect2><h3 id=_файловая_система>17.8.3. Файловая система<a class=anchor href=#_файловая_система></a></h3><div class=paragraph><p>Теперь ваша дискета готова к высокоуровневому форматированию. При этом на неё будет помещаться новая файловая система, которая позволит FreeBSD читать и записывать информацию на диск. После создания новой файловой системы метка диска уничтожается, так что если вы захотите переформатировать диск, вам придётся создавать метку диска повторно.</p></div><div class=paragraph><p>Файловой системой для дискеты может служить UFS или FAT. Вообще говоря, FAT для дискет походит лучше.</p></div><div class=paragraph><p>Для размещения на дискете новой файловой системы, выполните:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># /sbin/newfs_msdos /dev/fd0</span></code></pre></div></div><div class=paragraph><p>Теперь диск готов к работе.</p></div></div><div class=sect2><h3 id=_использование_дискет>17.8.4. Использование дискет<a class=anchor href=#_использование_дискет></a></h3><div class=paragraph><p>Для работы с гибким диском смонтируйте его при помощи утилит <a href="https://man.freebsd.org/cgi/man.cgi?query=mount_msdosfs&amp;sektion=8&amp;format=html">mount_msdosfs(8)</a>. Можно также использовать пакет <a class=package href=https://cgit.freebsd.org/ports/tree/emulators/mtools/>emulators/mtools</a> из коллекции портов.</p></div></div></div></div><div class=sect1><h2 id=backups-tapebackups>17.9. Создание и использование архивных копий на магнитной ленте<a class=anchor href=#backups-tapebackups></a></h2><div class=sectionbody><div class=paragraph><p>К наиболее часто используемым носителям на магнитной ленте следует отнести ленты шириной 4мм и 8мм, а также типа QIC, мини-картриджи и DLT.</p></div><div class=sect2><h3 id=backups-tapebackups-4mm>17.9.1. 4мм (DDS: Digital Data Storage)<a class=anchor href=#backups-tapebackups-4mm></a></h3><div class=paragraph><p>Ленты шириной 4мм заменяют QIC в качестве наиболее предпочтительного носителя для создания резервных копий. Эта тенденция значительно усилилась после покупки компанией Conner фирмы Archive, ведущего производителя накопителей QIC и последующего прекращения их выпуска. Накопители 4мм малы по размеру и мало шумят, но у них нет репутации носителя, обладающего надежностью приводов 8мм. Картриджи более дешевы и меньше по размеру (3 x 2 x 0.5 дюймов; 76 x 51 x 12 мм), чем 8мм-картриджи. Накопители для лент шириной 4мм, как и 8мм, имеют сравнительно малый срок службы головок, по причине использования в обоих случаях технологии спирального сканирования (helical scan).</p></div><div class=paragraph><p>Пропускная способность у таких накопителей начинается с цифры ~150 kB/s, пиковая достигает ~500 kB/s. Ёмкость накопителей начинается с 1.3 GB и может достигать 2.0 GB. Аппаратное сжатие, имеющееся на большинстве таких накопителей, даёт увеличение ёмкости примерно вдвое. Блоки многоприводных ленточных библиотек могут иметь до 6 накопителей в одном модуле с автоматической сменой ленты. Ёмкость библиотек может достигать 240 Гбайт.</p></div><div class=paragraph><p>Стандарт DDS-3 в настоящее время поддерживает ёмкости лент вплоть до 12 Гбайт (или 24 Гбайт сжатой информации).</p></div><div class=paragraph><p>В накопителях 4мм, как и в приводах 8мм, используется технология спирального сканирования. Все плюсы и минусы этой технологии относятся как к 4мм, так и 8мм приводам.</p></div><div class=paragraph><p>Не следует использовать ленты после того, как они были подвергнуты 2000 проходов, или были использованы для создания 100 полных копий.</p></div></div><div class=sect2><h3 id=backups-tapebackups-8mm>17.9.2. 8мм (Exabyte)<a class=anchor href=#backups-tapebackups-8mm></a></h3><div class=paragraph><p>Ленты шириной 8мм являются самым распространённым типом для ленточных SCSI-накопителей; они же являются наиболее удачным выбором при выборе типа носителей для обмена лентами. Наверное, каждый сервер имеет привод Exabyte шириной 8мм и объёмом 2 Гбайт. Эти приводы удобны, они работают надёжно и тихо. Картриджи дешевы и малы по размеру (4.8 x 3.3 x 0.6 дюймов; 122 x 84 x 15 мм). Одним минусом лент шириной 8мм является сравнительно малое время службы головок и лент из-за высокой скорости движения ленты вдоль головок.</p></div><div class=paragraph><p>Скорость передачи данных варьируется от ~250 kB/s до ~500 kB/s. Объём хранимых данных начинается с 300 Мбайт и может достигать 7 Гбайт. Аппаратное сжатие, имеющееся практически на всех таких приводах, увеличивает емкость примерно вдвое. Эти приводы существуют как в виде отдельных модулей, так и в виде многоприводных ленточных библиотек с 6 приводами и 120 лентами в одном отсеке. Ленты сменяются автоматически модулем. Емкости библиотек достигают величин, превышающих 840 Гбайт.</p></div><div class=paragraph><p>Модель Exabyte "Mammoth" поддерживает ёмкость ленты в 12 Гбайт (24 Гбайт со сжатием) и стоит примерно вдвое больше, чем обычный ленточный накопитель.</p></div><div class=paragraph><p>Данные на ленту записываются по технологии спирального сканирования, головки позиционируются под углом к носителю (примерно в 6 градусов). Лента оборачивается на 270 градусов вокруг шпульки, которая держит головки. Во время скольжения ленты вокруг шпульки последняя вращается. В результате достигается высокая плотность записи данных с очень близко лежащими дорожками, расположенными под наклоном по всей ленте.</p></div></div><div class=sect2><h3 id=backups-tapebackups-qic>17.9.3. QIC<a class=anchor href=#backups-tapebackups-qic></a></h3><div class=paragraph><p>Ленты и накопители формата QIC-150, наверное, являются наиболее распространенным типом носителей. Приводы лент формата QIC являются самыми дешёвыми "серьёзными" накопителями для резервного копирования. Минусом является стоимость носителей. Ленты формата QIC по сравнению с лентами шириной 8мм или 4мм являются дорогими, превосходя их по стоимости хранения одного гигабайта в пять раз. Однако если вам будут достаточно половины ленты, QIC может оказаться правильным выбором. QIC является <em>самым</em> распространенным типом привода. Каждый сайт имеет привод QIC какой-либо емкости. QIC имеет большое количество плотностей на физически похожих (иногда даже идентичных) лентах. Приводы QIC работают вовсе не тихо. Эти накопители громко осуществляют поиск перед тем, как начать запись данных и достаточно шумны в процессе чтения, записи или поиска. Ленты QIC имеют размеры (6 x 4 x 0.7 дюймов; 152 x 102 x 17 мм).</p></div><div class=paragraph><p>Скорость обмена данными лежит в границах от ~150 kB/s до ~500 kB/s. Ёмкость накопителей варьируется от 40 Мбайт до 15 Гбайт. Аппаратное сжатие присутствует во многих современных накопителях QIC. Приводы QIC устанавливаются менее часто; они вытесняются накопителями DAT.</p></div><div class=paragraph><p>На ленту данные записываются в виде дорожек. Дорожки располагаются в длину вдоль всей ленты. Количество дорожек, и, в свою очередь, их ширина, меняется вместе с емкостью ленты. Большинство, если не все современные накопители обеспечивают обратную совместимость по крайней мере для чтения (однако зачастую и для режима записи). Формат QIC имеет хорошую репутацию в области надежности хранения данных (механика устроена проще и более надежна, чем в случае накопителей, построенных по технологии спирального сканирования).</p></div><div class=paragraph><p>Ленты не следует больше использовать после создания 5,000 резервных копий.</p></div></div><div class=sect2><h3 id=backups-tapebackups-dlt>17.9.4. DLT<a class=anchor href=#backups-tapebackups-dlt></a></h3><div class=paragraph><p>Формат DLT обладает самой высокой скоростью передачи данных среди всех перечисленных здесь накопителей. Лента шириной 1/2" (12.5мм) помещена в один картридж с катушкой (4 x 4 x 1 дюймов; 100 x 100 x 25 мм). Вдоль одной из сторон картриджа расположена сдвигающаяся крышечка. Механизм накопителя открывает эту крышку, чтобы вытащить конец ленты. На этом конце имеется овальное отверстие, которое используется для "захвата" ленты. Принимающая катушка размещена внутри накопителя. Все другие типы картриджей, перечисленные здесь (за исключением 9-дорожечных лент), имеют как подающий, так и принимающий барабаны внутри самого картриджа.</p></div><div class=paragraph><p>Скорость передачи данных равна примерно 1.5 MB/s, что в три раза больше скорости передачи данных для накопителей 4мм, 8мм или QIC. Ёмкость картриджей варьируется от 10 Гбайт до 20 Гбайт для одного накопителя. Приводы могут компоноваться как многоленточные роботизированные, так и многоленточные, многоприводные библиотеки лент, вмещающие от 5 до 900 лент и от 1 до 20 приводов, что даёт ёмкость хранилища от 50 Гбайт до 9 Тбайт.</p></div><div class=paragraph><p>Формат DLT Type IV поддерживает емкость до 70 Гбайт со сжатием.</p></div><div class=paragraph><p>Данные на ленту записываются в виде дорожек, параллельных направлению движения (точно также, как и для лент QIC). Одновременно записываются две дорожки. Срок жизни головок чтения/записи сравнительно велик; как только лента перестает двигаться, одновременно прекращается трение между головками и лентой.</p></div></div><div class=sect2><h3 id=_ait>17.9.5. AIT<a class=anchor href=#_ait></a></h3><div class=paragraph><p>AIT - это новый формат фирмы Sony, который позволяет хранить до 50 Гбайт (со сжатием) информации на одной ленте. Ленты содержат микросхемы памяти, на которых размещается каталог содержимого ленты. Этот каталог может быть быстро считан накопителем для определения расположения файлов на ленте, вместо того, чтобы тратить несколько минут на поиск, как это происходит с другими форматами. Такое программное обеспечение, как SAMS:Alexandria, может управлять сорока или большим количеством ленточных библиотек AIT, связываясь непосредственно с памятью лент для вывода их содержимого, определения того, какие файлы были скопированы на какую ленту, выбора нужной ленты, её загрузки и восстановления данных с ленты.</p></div><div class=paragraph><p>Библиотеки с такими функциями стоят в районе $20,000, выводя их из ниши любительского рынка.</p></div></div><div class=sect2><h3 id=_использование_новой_ленты_первый_раз>17.9.6. Использование новой ленты первый раз<a class=anchor href=#_использование_новой_ленты_первый_раз></a></h3><div class=paragraph><p>Если вы попытаетесь прочитать или записать новую, абсолютно чистую ленту, в первый раз, то вам это не удастся. Выводимые на консоль сообщения будут выглядеть примерно так:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>sa0<span class=o>(</span>ncr1:4:0<span class=o>)</span>: NOT READY asc:4,1
sa0<span class=o>(</span>ncr1:4:0<span class=o>)</span>:	Logical unit is <span class=k>in </span>process of becoming ready</code></pre></div></div><div class=paragraph><p>На ленте отсутствует идентификационный блок (блок номер 0). Со времен принятия стандарта QIC-525 все накопители формата QIC записывают на ленту идентификационный блок (Identifier Block). Здесь имеется два решения:</p></div><div class=ulist><ul><li><p>По команде <code>mt fsf 1</code> ленточный накопитель записывает идентификационный блок на ленту.</p></li><li><p>Воспользуйтесь кнопкой на передней панели для выброса ленты.</p><div class=paragraph><p>Вставьте ленту повторно и по команде <code>dump</code> сбросьте данные на ленту.</p></div><div class=paragraph><p>Программа <code>dump</code> выдаст <code>DUMP: End of tape detected</code>, а на консоли будет выведено: <code>HARDWARE FAILURE info:280 asc:80,96</code>.</p></div><div class=paragraph><p>перемотайте ленту такой командой: <code>mt rewind</code>.</p></div><div class=paragraph><p>Последующие операции с лентой будут успешными.</p></div></li></ul></div></div></div></div><div class=sect1><h2 id=backups-floppybackups>17.10. Создание резервных копий на дискетах<a class=anchor href=#backups-floppybackups></a></h2><div class=sectionbody><div class=sect2><h3 id=floppies-using>17.10.1. Можно ли использовать дискеты для создания резервных копий моих данных?<a class=anchor href=#floppies-using></a></h3><div class=paragraph><p>На самом деле дискеты не подходят для создания резервных копий, потому что:</p></div><div class=ulist><ul><li><p>Носитель ненадёжен, особенно если речь идет о больших сроках хранения.</p></li><li><p>Создание резервных копий и восстановление данных происходит очень медленно.</p></li><li><p>Дискеты имеют весьма ограниченную емкость (дни, когда весь винчестер копировался на десяток или около того дискет, давно прошли).</p></li></ul></div><div class=paragraph><p>Несмотря на все это, если у вас нет другого способа сделать резервную копию ваших данных, то дискеты все же лучше, чем ничего.</p></div><div class=paragraph><p>Если вы используете дискеты, то проверьте, что они должны быть хорошего качества. Дискеты, которые валялись по всему офису в течении нескольких лет, не подойдут. Идеально использовать новые от известного производителя.</p></div></div><div class=sect2><h3 id=floppies-creating>17.10.2. Итак, как же сделать резервную копию данных на дискетах?<a class=anchor href=#floppies-creating></a></h3><div class=paragraph><p>Самым лучшим методом создания резервной копии на дискете является использование утилиты <a href="https://man.freebsd.org/cgi/man.cgi?query=tar&amp;sektion=1&amp;format=html">tar(1)</a> с опцией <code>-M</code> (многотомные архивы), которая позволяет размещать архивы на нескольких дискетах.</p></div><div class=paragraph><p>Для копирования всех файлов в текущем каталоге и подкаталогах выполните следующее (работая как пользователь <code>root</code>):</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># tar Mcvf /dev/fd0 *</span></code></pre></div></div><div class=paragraph><p>Когда первая дискета окажется полностью заполненной, программа <a href="https://man.freebsd.org/cgi/man.cgi?query=tar&amp;sektion=1&amp;format=html">tar(1)</a> выдаст запрос на следующий том (так как работа утилиты <a href="https://man.freebsd.org/cgi/man.cgi?query=tar&amp;sektion=1&amp;format=html">tar(1)</a> не зависит от носителя, она имеет дело с томами; здесь это означает дискету).</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>Prepare volume 2 <span class=k>for</span> /dev/fd0 and hit <span class=k>return</span>:</code></pre></div></div><div class=paragraph><p>Это сообщение будет повторяться (со все увеличивающимся номером тома) до тех пор, пока все указанные файлы не будут заархивированы.</p></div></div><div class=sect2><h3 id=floppies-compress>17.10.3. Можно ли резервные копии подвергнуть компрессии?<a class=anchor href=#floppies-compress></a></h3><div class=paragraph><p>К сожалению, <a href="https://man.freebsd.org/cgi/man.cgi?query=tar&amp;sektion=1&amp;format=html">tar(1)</a> при создании многотомных архивов не позволяет использовать опцию <code>-z</code>. Вы конечно же, можете скомпрессировать все файлы утилитой <a href="https://man.freebsd.org/cgi/man.cgi?query=gzip&amp;sektion=1&amp;format=html">gzip(1)</a>, программой <a href="https://man.freebsd.org/cgi/man.cgi?query=gzip&amp;sektion=1&amp;format=html">gzip(1)</a> скопировать их на дискеты, а затем распаковать файлы снова утилитой <a href="https://man.freebsd.org/cgi/man.cgi?query=gunzip&amp;sektion=1&amp;format=html">gunzip(1)</a>!</p></div></div><div class=sect2><h3 id=floppies-restoring>17.10.4. Как восстановить данные из моих резервных копий?<a class=anchor href=#floppies-restoring></a></h3><div class=paragraph><p>Для полного восстановления архива воспользуйтесь такой командой:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># tar Mxvf /dev/fd0</span></code></pre></div></div><div class=paragraph><p>Есть два подхода к восстановлению только нужных вам файлов. В первом вы можете начать с первой дискеты и выдать такую команду:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># tar Mxvf /dev/fd0 filename</span></code></pre></div></div><div class=paragraph><p>Программа <a href="https://man.freebsd.org/cgi/man.cgi?query=tar&amp;sektion=1&amp;format=html">tar(1)</a> будет выдавать запрос на подачу последующих дискет до тех пор, пока не найдет требуемый файл.</p></div><div class=paragraph><p>Как альтернатива, если вы знаете, на какой дискете расположен файл, то вы можете просто подать ее и дать ту же самую команду, что и выше. Заметьте, что если первый файл на дискете является продолжением предыдущего, то <a href="https://man.freebsd.org/cgi/man.cgi?query=tar&amp;sektion=1&amp;format=html">tar(1)</a> выдаст предупреждение о том, что не может его восстановить, хотя вы этого и не просили делать!</p></div></div></div></div><div class=sect1><h2 id=backup-strategies>17.11. Стратегии резервного копирования<a class=anchor href=#backup-strategies></a></h2><div class=sectionbody><div class=paragraph><p>При разработке плана резервного копирования первым делом надо продумать методы защиты от следующих проблем:</p></div><div class=ulist><ul><li><p>Отказ жесткого диска</p></li><li><p>Случайное удаление файлов</p></li><li><p>Повреждение содержимого файлов</p></li><li><p>Полное уничтожение компьютера (например, при пожаре), при котором погибнут также резервные копии, физически находящиеся рядом.</p></li></ul></div><div class=paragraph><p>Вполне возможно, что для ваших нужд нет единой стратегии, наилучшим образом покрывающей все описанные проблемы; более того, скорее всего, ее и не может быть (разве что для персональных систем, где ценность данных очень низка).</p></div><div class=paragraph><p>Вот несколько наиболее распространенных технологий, применяемых для резервного копирования:</p></div><div class=ulist><ul><li><p>Архивация системы целиком с копированием на какой-либо надежный внешний носитель и размещение его вдалеке от основной системы. При этом вы защищены от всех перечисленных проблемы, однако этот метод требует много времени и неудобен в процессе восстановления. Вы можете хранить резервные копии рядом или даже смонтированными, однако все равно столкнетесь с неудобствами при восстановлении, в особенности для непривилегированных пользователей.</p></li><li><p>Снэпшоты файловых систем. Помогают только от случайного удаления файлов, но как раз в этом случае <em>очень</em> полезны и эффективны.</p></li><li><p>Полные копии файловых систем или дисков (например, периодический запуск программы <a href="https://man.freebsd.org/cgi/man.cgi?query=rsync&amp;sektion=1&amp;format=html">rsync(1)</a> для машины целиком). Для защиты от отказа жестких дисков этот способ обычно несколько уступает RAID; для восстановления случайно удаленных файлов может быть сравним по удобству со снэпшотами UFS, в зависимости от вашей ситуации.</p></li><li><p>RAID. Минимизирует или исключает вовсе простои при отказе жестких дисков. При этом средняя частота таких отказов увеличивается (поскольку количество дисков больше), но разбираться с ними становится много спокойнее.</p></li><li><p>Проверка отпечатков файлов (fingerprints). Для этого весьма полезна утилита <a href="https://man.freebsd.org/cgi/man.cgi?query=mtree&amp;sektion=8&amp;format=html">mtree(8)</a>. Не являясь собственно технологией резервного копирования, этот метод помогает выяснять, когда вам пока обращаться к резервным копиям. В особенности это важно для "оффлайновых" резервных копий.</p></li></ul></div><div class=paragraph><p>Довольно легко придумать и другие стратегии резервного копирования; многие из них будут композициями уже упомянутых. Наличие специальных требований, как правило, приводит к специализированным же технологиям (например, резервное копирование базы данных, как правило, требует использования методов, специфичных для соответствующей СУБД). Главным остается знание опасностей потери данных, от которых вы хотите себя оградить, и методов защиты от них.</p></div></div></div><div class=sect1><h2 id=backup-basics>17.12. Основы технологии резервного копирования<a class=anchor href=#backup-basics></a></h2><div class=sectionbody><div class=paragraph><p>Тремя основными программами резервного копирования являются <a href="https://man.freebsd.org/cgi/man.cgi?query=dump&amp;sektion=8&amp;format=html">dump(8)</a>, <a href="https://man.freebsd.org/cgi/man.cgi?query=tar&amp;sektion=1&amp;format=html">tar(1)</a> и <a href="https://man.freebsd.org/cgi/man.cgi?query=cpio&amp;sektion=1&amp;format=html">cpio(1)</a>.</p></div><div class=sect2><h3 id=_dump_и_restore>17.12.1. Dump и Restore<a class=anchor href=#_dump_и_restore></a></h3><div class=paragraph><p>Для UNIX® традиционными программами резервного копирования являются <code>dump</code> и <code>restore</code>. Они работают с приводом как с набором дисковых блоков, которые расположены ниже понятий файлов, связей и каталогов, создаваемых файловыми системами. В отличие от других программ для резервного копирования, программа <code>dump</code> выполняет резервное копирование всей файловой системы, располагающейся на устройстве. Невозможно выполнить резервное копирование части файловой системы или дерева каталогов, которые располагаются более чем в одной файловой системе. Утилита <code>dump</code> не записывает на ленту файлы и каталоги, она записывает блоки данных, из которых строятся файлы и каталоги. Утилита <code>restore</code> по умолчанию настроена так, что в процессе своей работы она сохраняет временные файлы в каталог <span class=filename>/tmp/</span>. В некоторых ситуациях доступного в <span class=filename>/tmp/</span> места бывает недостаточно: например, если вы работаете с диска восстановления (recovery disk). В таких случаях для успешной работы утилиты необходимо указать в переменной окружения <code>TMPDIR</code> путь к каталогу на менее заполненной файловой системе.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Если вы используете программу <code>dump</code> для работы с корневым каталогом, при этом не будет выполняться резервное копирование <span class=filename>/home</span>, <span class=filename>/usr</span> и многих других каталогов, так как они обычно являются точками монтирования других файловых систем или символическими ссылками на эти файловые системы.</p></div></td></tr></tbody></table></div><div class=paragraph><p>В программе <code>dump</code> имеются некоторые неудобства, оставшиеся от её ранних дней в составе Version 6 операционной системы AT&amp;T UNIX (примерно 1975). Параметры, используемые по умолчанию, подходят для 9-дорожечных лент (6250 bpi), но не для современных носителей с высокой плотностью записи информации (до 62,182 ftpi). Для использования ёмкостей нынешних накопителей на магнитной ленте эти параметры могут быть заданы в командной строке.</p></div><div class=paragraph><p>При помощи <code>rdump</code> и <code>rrestore</code> возможно резервное копирование данных по сети на накопитель, подключенный к другому компьютеру. Обе программы используют в работе <a href="https://man.freebsd.org/cgi/man.cgi?query=rcmd&amp;sektion=3&amp;format=html">rcmd(3)</a> и <a href="https://man.freebsd.org/cgi/man.cgi?query=ruserok&amp;sektion=3&amp;format=html">ruserok(3)</a> для доступа к накопителю на магнитной ленте на удалённом компьютере. Поэтому пользователь, выполняющий резервное копирование, должен быть указан в файле <span class=filename>.rhosts</span> на удалённом компьютере. Аргументы для <code>rdump</code> и <code>rrestore</code> должны подходить для использования на другом компьютере. При выполнении копирования по команде <code>rdump</code> на компьютере с FreeBSD на накопитель Exabyte, подключенный к машине Sun по имени <code>komodo</code>, используйте такую команду:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># /sbin/rdump 0dsbfu 54000 13000 126 komodo:/dev/nsa8 /dev/da0a 2&gt;&amp;1</span></code></pre></div></div><div class=paragraph><p>Будьте осторожны: есть проблемы с обеспечением безопасности при аутентификации посредством <span class=filename>.rhosts</span>. Внимательно рассмотрите вашу ситуацию.</p></div><div class=paragraph><p>Программы <code>dump</code> и <code>restore</code> можно использовать в более защищённом режиме посредством <code>ssh</code>.</p></div><div class=exampleblock><div class=title>Пример 1. Использование <code>dump</code> через ssh</div><div class=content><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># /sbin/dump -0uan -f - /usr | gzip -2 | ssh -c blowfish \</span>
targetuser@targetmachine.example.com <span class=nb>dd </span><span class=nv>of</span><span class=o>=</span>/mybigfiles/dump-usr-l0.gz</code></pre></div></div></div></div><div class=paragraph><p>Либо воспользуйтесь встроенной в <code>dump</code> возможностью, задав переменную окружения <code>RSH</code>:</p></div><div class=exampleblock><div class=title>Пример 2. Использование <code>dump</code> при работе через ssh с заданием <code>RSH</code></div><div class=content><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># RSH=/usr/bin/ssh /sbin/dump -0uan -f targetuser@targetmachine.example.com:/dev/sa0 /usr</span></code></pre></div></div></div></div></div><div class=sect2><h3 id=_tar>17.12.2. <code>tar</code><a class=anchor href=#_tar></a></h3><div class=paragraph><p>Утилита <a href="https://man.freebsd.org/cgi/man.cgi?query=tar&amp;sektion=1&amp;format=html">tar(1)</a> также восходит корнями к Version 6 системы AT&amp;T UNIX (около 1975). <code>tar</code> работает с файловой системой, записывая на ленту файлы и каталоги. Эта утилита поддерживает не полный набор опций, имеющихся в <a href="https://man.freebsd.org/cgi/man.cgi?query=cpio&amp;sektion=1&amp;format=html">cpio(1)</a>, однако не требует необычного перенаправления в командной строке, которое используется в утилите <code>cpio</code>.</p></div><div class=paragraph><p>Чтобы скопировать данные на накопитель Exabyte, подключенный к машине Sun по имени <code>komodo</code>, используйте такую команду:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># tar cf - . | rsh komodo dd of=tape-device obs=20b</span></code></pre></div></div><div class=paragraph><p>Если вы беспокоитесь о безопасности создания резервных копий по сети, то вместо <code>rsh</code> вам нужно использовать <code>ssh</code>.</p></div></div><div class=sect2><h3 id=_cpio>17.12.3. <code>cpio</code><a class=anchor href=#_cpio></a></h3><div class=paragraph><p><a href="https://man.freebsd.org/cgi/man.cgi?query=cpio&amp;sektion=1&amp;format=html">cpio(1)</a> является оригинальной программой UNIX® для обмена файлами на магнитных носителях. В утилите <code>cpio</code> имеются опции (кроме всего прочего), позволяющие выполнять изменение порядка следования байтов, поддерживающие различные форматы архивов и выполняющие перенаправление данных другим программам. Последняя возможность делает <code>cpio</code> прекрасным выбором для целей установки. <code>cpio</code> не знает о том, как работать с каталогами, список файлов должен даваться через <span class=filename>stdin</span>.</p></div><div class=paragraph><p><code>cpio</code> не поддерживает создание резервных копий по сети. Вы можете воспользоваться перенаправлением вывода и программой <code>rsh</code> для посылки данных на удалённый накопитель.</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># for f in directory_list; do</span>
find <span class=nv>$f</span> <span class=o>&gt;&gt;</span> backup.list
<span class=k>done</span>
<span class=c># cpio -v -o --format=newc &lt; backup.list | ssh user@host &#34;cat &gt; backup_device&#34;</span></code></pre></div></div><div class=paragraph><p>Где directory_list это список директорий, c которых Вы хотите создать резервные копии, <em>user</em>@<em>host</em> это комбинация пользователь/хост которая описывает того кто занимается резервированием, и <em>backup_device</em> это устройство куда копии должны быть записаны (например, <span class=filename>/dev/nsa0</span>).</p></div></div><div class=sect2><h3 id=_pax>17.12.4. <code>pax</code><a class=anchor href=#_pax></a></h3><div class=paragraph><p><a href="https://man.freebsd.org/cgi/man.cgi?query=pax&amp;sektion=1&amp;format=html">pax(1)</a> является ответом IEEE/POSIX® на утилиты <code>tar</code> и <code>cpio</code>. В течение многих лет различные версии программ <code>tar</code> и <code>cpio</code> получались не совсем совместимыми. Так что вместо того, чтобы попытаться полностью их стандартизировать, POSIX® создал новую утилиту для работы с архивами. <code>pax</code> пытается читать и писать различные форматы <code>cpio</code> и <code>tar</code>, и, кроме того, свои собственные новые форматы. Набор команд этой утилиты больше напоминает <code>cpio</code>, чем <code>tar</code>.</p></div></div><div class=sect2><h3 id=backups-programs-amanda>17.12.5. Amanda<a class=anchor href=#backups-programs-amanda></a></h3><div class=paragraph><p>Amanda (Advanced Maryland Network Disk Archiver) является целой клиент/серверной системой резервного копирования, а не отдельной программой. Сервер Amanda сможет осуществлять резервное копирование на единственный накопитель любого количества компьютеров, на которых имеется клиент Amanda и которые могут связываться по сети с сервером Amanda. Общей проблемой систем с большим количеством больших дисков является то, что время, требуемое для непосредственной записи данных на ленту, превышает лимит времени, выделенный на эту задачу. Amanda решает эту проблему. Amanda может использовать "промежуточный диск" для резервного копирования нескольких файловых систем одновременно. Amanda создаёт "наборы архивов": группа лент, используемых в некоторый период времени для создания полных копий всех файловых систем, перечисленных в конфигурационном файле системы Amanda. "Архивный набор" содержит также создаваемый каждую ночь инкрементальные (или дифференциальные) резервные копии всех файловых систем. Восстановление повреждённой файловой системы требует наличия самой последней полной копии и инкрементальных резервных копий.</p></div><div class=paragraph><p>Конфигурационный файл даёт прекрасный механизм для управления процессом резервного копирования и объёмом трафика, генерируемого системой Amanda. Amanda сможет использовать любую из перечисленных выше программ для записи данных на ленту. Amanda имеется в виде как порта, так и пакета, и по умолчанию она не установлена.</p></div></div><div class=sect2><h3 id=_не_делать_ничего>17.12.6. Не делать ничего<a class=anchor href=#_не_делать_ничего></a></h3><div class=paragraph><p>"Не делать ничего" - это не программа для компьютера, и в то же время это наиболее широко используемая стратегия резервного копирования. Здесь нет никаких первоначальных затрат. Здесь нет расписания, которому нужно следовать. Просто скажите нет. Если что-то случится с вашими данными, улыбнитесь и забудьте о них!</p></div><div class=paragraph><p>Если ваше время и данные практически ничего не стоят, то "не делать ничего" является самой подходящей программой для вашего компьютера. Но будьте осторожны, POSIX® является весьма полезным инструментом, и через полгода вы можете обнаружить, что у вас есть набор файлов, представляющих для вас определенную ценность.</p></div><div class=paragraph><p>"Ничего не делать" является правильным методом резервного копирования для <span class=filename>/usr/obj</span> и других деревьев каталогов, которые могут быть в точности перегенерированы вашим компьютером. Примером являются файлы, представляющие страницы этого Руководства в форматах HTML или PostScript®. Они генерируются из входных файлов в формате SGML. Создавать резервные копии файлов в форматах HTML и PostScript® не нужно. Исходные файлы в формате SGML копируются регулярно.</p></div></div><div class=sect2><h3 id=_какая_программа_резервного_копирования_самая_лучшая>17.12.7. Какая программа резервного копирования самая лучшая?<a class=anchor href=#_какая_программа_резервного_копирования_самая_лучшая></a></h3><div class=paragraph><p><a href="https://man.freebsd.org/cgi/man.cgi?query=dump&amp;sektion=8&amp;format=html">dump(8)</a> <em>Точка.</em> Elizabeth D. Zwicky протестировала все программы резервного копирования, обсуждаемые здесь. Беспроигрышным вариантом для сохранения всех ваших данных и особенностей файловых систем UNIX® является <code>dump</code>. Элизабет создала файловые системы, содержащие большое количество необычных элементов (и некоторых не так уж необычных) и тестировала каждую из программ, выполняя резервное копирование и последующее восстановление этих файловых систем. В число необычных элементов входили: файлы с дырами, файлы с дырами и блоком пустого места, файлы с необычными символами в их именах, нечитаемые и незаписываемые файлы, устройства, меняющие свой размер во время резервного копирования, файлы, создаваемые и удаляемые во время копирования и тому подобное. Она представила результаты на конференции LISA V в октябре 1991 года. Посмотрите ссылку на сайте <a href=http://www.coredumps.de/doc/dump/zwicky/testdump.doc.html>torture-testing Backup and Archive Programs</a>.</p></div></div><div class=sect2><h3 id=_процедура_восстановления_при_сбое>17.12.8. Процедура восстановления при сбое<a class=anchor href=#_процедура_восстановления_при_сбое></a></h3><div class=sect3><h4 id=_до_того_как_случится_катастрофа>17.12.8.1. До того, как случится катастрофа<a class=anchor href=#_до_того_как_случится_катастрофа></a></h4><div class=paragraph><p>Вам нужно выполнить всего лишь четыре шага для того, чтобы быть готовым к любому сбою.</p></div><div class=paragraph><p>Во-первых, распечатайте разметку диска для всех ваших дисков (к примеру, <code>bsdlabel da0 | lpr</code>), таблицу файловых систем (<span class=filename>/etc/fstab</span>) и все сообщения, выводимые при загрузке, каждого по два экземпляра.</p></div><div class=paragraph><p>Во-вторых, запишите CD диск с "livefs". Этот диск позволяет загружаться в режим аварийного восстановления FreeBSD, давая возможность пользователю выполнять ряд утилит, среди которых <a href="https://man.freebsd.org/cgi/man.cgi?query=dump&amp;sektion=8&amp;format=html">dump(8)</a>, <a href="https://man.freebsd.org/cgi/man.cgi?query=restore&amp;sektion=8&amp;format=html">restore(8)</a>, <a href="https://man.freebsd.org/cgi/man.cgi?query=fdisk&amp;sektion=8&amp;format=html">fdisk(8)</a>, <a href="https://man.freebsd.org/cgi/man.cgi?query=bsdlabel&amp;sektion=8&amp;format=html">bsdlabel(8)</a>, <a href="https://man.freebsd.org/cgi/man.cgi?query=newfs&amp;sektion=8&amp;format=html">newfs(8)</a>, <a href="https://man.freebsd.org/cgi/man.cgi?query=mount&amp;sektion=8&amp;format=html">mount(8)</a> и т.д. Образ CD с "livefs" для FreeBSD/i386 12.0-RELEASE находится по адресу <a href=ftp://ftp.FreeBSD.org/pub/FreeBSD/releases/i386/ISO-IMAGES/12.0/FreeBSD-12.0-RELEASE-i386-livefs.iso>ftp://ftp.FreeBSD.org/pub/FreeBSD/releases/i386/ISO-IMAGES/12.0/FreeBSD-12.0-RELEASE-i386-livefs.iso</a>.</p></div><div class=paragraph><p>В-третьих, регулярно создавайте резервные копии на ленте. Любые изменения, которые вы делали после последнего резервного копирования, могут быть безвозвратно потеряны. На лентах включайте защиту от записи.</p></div><div class=paragraph><p>В-четвертых, проверяйте работу CD диска (который вы сделали при выполнении второго шага) и лент с резервными копиями. Ведите журнал выполняемых действий. Храните эти записи вместе с загрузочным CD диском, распечатками и лентами. Вы просто обезумеете при восстановлении данных, если окажется, что записи помогли бы избежать разрушения ваших резервных копий (Каким образом? Вместо команды <code>tar xvf /dev/sa0</code> вы могли случайно набрать <code>tar cvf /dev/sa0</code> и тем самым перезаписать вашу резервную копию).</p></div><div class=paragraph><p>Для дополнительной страховки, каждый раз создавайте загрузочный CD диск с "livefs" и две резервные копии на ленте. Храните одну из копий в каком-то удаленном месте и НЕ в том же здании, где находится ваш офис. Достаточно большое количество компаний во Всемирном Торговом Центре изучило это на своей шкуре. Это удаленное хранилище должно быть физически отделено на большое расстояние от ваших компьютеров и дисковых устройств.</p></div></div><div class=sect3><h4 id=_после_сбоя>17.12.8.2. После сбоя<a class=anchor href=#_после_сбоя></a></h4><div class=paragraph><p>Главный вопрос: выжило ли ваше оборудование? Вы регулярно делали резервные копии, так что нет нужды беспокоиться о программном обеспечении.</p></div><div class=paragraph><p>Если оборудование было повреждено, должны быть заменены неисправные компоненты.</p></div><div class=paragraph><p>Если с оборудованием всё в порядке, вставьте CD диск с "livefs" в привод и загрузите компьютер. На экран будет выведено оригинальное меню установки. Выберите требуемую страну, потом - пункт меню <span class=guimenuitem>Fixit — Repair mode with CDROM/DVD/floppy or start a shell.</span>, а в нём выберите пункт <span class=guimenuitem>CDROM/DVD — Use the live filesystem CDROM/DVD</span>. Утилита <code>restore</code> и другие нужные вам программы находятся в каталоге <span class=filename>/mnt2/rescue</span>.</p></div><div class=paragraph><p>Восстановите по отдельности каждую файловую систему.</p></div><div class=paragraph><p>Попробуйте выполнить команду <code>mount</code> (например, <code>mount /dev/da0a /mnt</code>) по отношению к корневому разделу вашего первого диска. Если метка диска была испорчена, то воспользуйтесь командой <code>bsdlabel</code> для переразбиения на разделы и разметки диска так, чтобы получившаяся метка совпала с той, которая вами была распечатана и сохранена. Для повторного создания файловых систем используйте утилиту <code>newfs</code>. Повторно смонтируйте корневой раздел диска в режиме чтения-записи (<code>mount -u -o rw /mnt</code>). Воспользуйтесь вашей программой резервного копирования и резервными копиями на лентах для восстановления данных для этой файловой системы (например. <code>restore vrf /dev/sa0</code>). Размонтируйте файловую систему (например, <code>umount /mnt</code>). Повторите эту процедуру для каждой файловой системы, которая была повреждена.</p></div><div class=paragraph><p>Как только ваша система заработает, сделайте резервную копию на новые ленты. Что бы ни вызвало сбой или потерю данных, это может случиться снова. Ещё один час, потраченный в этот момент, может спасти вас от неприятностей в будущем.</p></div></div></div></div></div><div class=sect1><h2 id=disks-virtual>17.13. Сетевые файловые системы, файловые системы в памяти и с отображением в файл<a class=anchor href=#disks-virtual></a></h2><div class=sectionbody><div class=paragraph><p>Кроме дисков, которые вы физически устанавливаете в ваш компьютер; дискеты, компакт-диски, винчестеры и так далее, FreeBSD воспринимает и другие типы дисков - <em>виртуальные диски</em>.</p></div><div class=paragraph><p>Сюда могут быть отнесены сетевые файловые системы, такие, как <a href=../network-servers/#network-nfs>Network File System</a> и Coda, а также файловые системы с организацией в памяти и создаваемые в файлах.</p></div><div class=paragraph><p>В зависимости от версии FreeBSD, которую вы используете, для создания и работы с файловыми системами, отображаемыми в оперативную память или файлы, вам нужно будет пользоваться разными инструментами.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Пользователи FreeBSD 4.X для создания требуемых устройств должны использовать <a href="https://man.freebsd.org/cgi/man.cgi?query=MAKEDEV&amp;sektion=8&amp;format=html">MAKEDEV(8)</a>. Во FreeBSD 5.0 и более поздних версиях для создания файлов устройств используется <a href="https://man.freebsd.org/cgi/man.cgi?query=devfs&amp;sektion=5&amp;format=html">devfs(5)</a>, которая выполняет это прозрачно для пользователей.</p></div></td></tr></tbody></table></div><div class=sect2><h3 id=disks-vnconfig>17.13.1. Файловая система в файле во FreeBSD 4.X<a class=anchor href=#disks-vnconfig></a></h3><div class=paragraph><p>Утилита <a href="https://man.freebsd.org/cgi/man.cgi?query=vnconfig&amp;sektion=8&amp;format=html">vnconfig(8)</a> конфигурирует и позволяет использовать дисковые устройства на основе псевдо-устройств vnode. <em>vnode</em> представляет собой файл и отвечает за работу с файлом. Это означает, что <a href="https://man.freebsd.org/cgi/man.cgi?query=vnconfig&amp;sektion=8&amp;format=html">vnconfig(8)</a> использует файлы для создания и работы с файловой системой. Одним из возможных способов использования является монтирование образов дискет или образов компакт-дисков, сброшенных в файлы.</p></div><div class=paragraph><p>Для использования <a href="https://man.freebsd.org/cgi/man.cgi?query=vnconfig&amp;sektion=8&amp;format=html">vnconfig(8)</a> в конфигурационном файле ядра вам нужно включить поддержку <a href="https://man.freebsd.org/cgi/man.cgi?query=vn&amp;sektion=4&amp;format=html">vn(4)</a>:</p></div><div class="literalblock programlisting"><div class=content><pre>pseudo-device vn</pre></div></div><div class=paragraph><p>Чтобы смонтировать имеющийся образ файловой системы:</p></div><div class=exampleblock><div class=title>Пример 3. Использование vnconfig для монтирования имеющегося образа файловой системы во FreeBSD 4.X</div><div class=content><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># vnconfig vn0 diskimage</span>
<span class=c># mount /dev/vn0c /mnt</span></code></pre></div></div></div></div><div class=paragraph><p>Для создания нового образа файловой системы с помощью <a href="https://man.freebsd.org/cgi/man.cgi?query=vnconfig&amp;sektion=8&amp;format=html">vnconfig(8)</a>:</p></div><div class=exampleblock><div class=title>Пример 4. Создание нового диска в файле с помощью <code>vnconfig</code></div><div class=content><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># dd if=/dev/zero of=newimage bs=1k count=5k</span>
5120+0 records <span class=k>in
</span>5120+0 records out
<span class=c># vnconfig -s labels -c vn0 newimage</span>
<span class=c># bsdlabel -r -w vn0 auto</span>
<span class=c># newfs vn0c</span>
Warning: 2048 sector<span class=o>(</span>s<span class=o>)</span> <span class=k>in </span>last cylinder unallocated
/dev/vn0c:	10240 sectors <span class=k>in </span>3 cylinders of 1 tracks, 4096 sectors
	5.0MB <span class=k>in </span>1 cyl <span class=nb>groups</span> <span class=o>(</span>16 c/g, 32.00MB/g, 1280 i/g<span class=o>)</span>
super-block backups <span class=o>(</span><span class=k>for </span>fsck <span class=nt>-b</span> <span class=c>#) at:</span>
 32
<span class=c># mount /dev/vn0c /mnt</span>
<span class=c># df /mnt</span>
Filesystem  1K-blocks	  Used	  Avail Capacity  Mounted on
/dev/vn0c	 4927	     1	   4532     0%	  /mnt</code></pre></div></div></div></div></div><div class=sect2><h3 id=disks-mdconfig>17.13.2. Файловые системы, отображаемые в файлы<a class=anchor href=#disks-mdconfig></a></h3><div class=paragraph><p>Во FreeBSD 5.X и более поздних для конфигурации и подключения дисков <a href="https://man.freebsd.org/cgi/man.cgi?query=md&amp;sektion=4&amp;format=html">md(4)</a>, отображаемых в оперативную память, используется утилита <a href="https://man.freebsd.org/cgi/man.cgi?query=mdconfig&amp;sektion=8&amp;format=html">mdconfig(8)</a>. Для работы с <a href="https://man.freebsd.org/cgi/man.cgi?query=mdconfig&amp;sektion=8&amp;format=html">mdconfig(8)</a> вам нужно подгрузить модуль <a href="https://man.freebsd.org/cgi/man.cgi?query=md&amp;sektion=4&amp;format=html">md(4)</a> или добавить поддержку этих устройств в файл конфигурации ядра:</p></div><div class="literalblock programlisting"><div class=content><pre>device md</pre></div></div><div class=paragraph><p>Утилита <a href="https://man.freebsd.org/cgi/man.cgi?query=mdconfig&amp;sektion=8&amp;format=html">mdconfig(8)</a> поддерживает три типа виртуальных дисков, отображаемых в память: диски в памяти, которая выделяется запросами <a href="https://man.freebsd.org/cgi/man.cgi?query=malloc&amp;sektion=9&amp;format=html">malloc(9)</a> и диски в памяти, использующие в качестве устройств хранения файлы или раздел подкачки. Одним из возможных использований таких дисков является монтирование файлов с образами дискет или CD.</p></div><div class=paragraph><p>Для монтирования образа существующей файловой системы:</p></div><div class=exampleblock><div class=title>Пример 5. Использование <code>mdconfig</code> для монтирования файла с образом существующей файловой системы</div><div class=content><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># mdconfig -a -t vnode -f diskimage -u 0</span>
<span class=c># mount /dev/md0 /mnt</span></code></pre></div></div></div></div><div class=paragraph><p>Для создания образа новой файловой системы при помощи <a href="https://man.freebsd.org/cgi/man.cgi?query=mdconfig&amp;sektion=8&amp;format=html">mdconfig(8)</a>:</p></div><div class=exampleblock><div class=title>Пример 6. Создание нового диска, отображаемого в файл, при помощи <code>mdconfig</code></div><div class=content><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># dd if=/dev/zero of=newimage bs=1k count=5k</span>
5120+0 records <span class=k>in
</span>5120+0 records out
<span class=c># mdconfig -a -t vnode -f newimage -u 0</span>
<span class=c># bsdlabel -w md0 auto</span>
<span class=c># newfs md0a</span>
/dev/md0c: 5.0MB <span class=o>(</span>10224 sectors<span class=o>)</span> block size 16384, fragment size 2048
	using 4 cylinder <span class=nb>groups </span>of 1.25MB, 80 blks, 192 inodes.
super-block backups <span class=o>(</span><span class=k>for </span>fsck <span class=nt>-b</span> <span class=c>#) at:</span>
 160, 2720, 5280, 7840
<span class=c># mount /dev/md0a /mnt</span>
<span class=c># df /mnt</span>
Filesystem 1K-blocks Used Avail Capacity  Mounted on
/dev/md0a       4710    4  4330     0%    /mnt</code></pre></div></div></div></div><div class=paragraph><p>Если в параметре <code>-u</code> вы не задали номер устройства, то <a href="https://man.freebsd.org/cgi/man.cgi?query=mdconfig&amp;sektion=8&amp;format=html">mdconfig(8)</a> для выбора неиспользуемого устройства будет использовать функцию автоматическое выделения в <a href="https://man.freebsd.org/cgi/man.cgi?query=md&amp;sektion=4&amp;format=html">md(4)</a>. Имя выделенного устройства будет выдано на стандартное устройство выводы в виде, например, <span class=filename>md4</span>. Для получения более полной информации о <a href="https://man.freebsd.org/cgi/man.cgi?query=mdconfig&amp;sektion=8&amp;format=html">mdconfig(8)</a>, пожалуйста, обратитесь к соответствующей странице справочной системы.</p></div><div class=paragraph><p>Утилита <a href="https://man.freebsd.org/cgi/man.cgi?query=mdconfig&amp;sektion=8&amp;format=html">mdconfig(8)</a> весьма полезна, однако для создания файла с файловой системой требуется произвести много действий. Вместе с FreeBSD 5.0 поставляется утилита под названием <a href="https://man.freebsd.org/cgi/man.cgi?query=mdmfs&amp;sektion=8&amp;format=html">mdmfs(8)</a>, которая создаёт диск <a href="https://man.freebsd.org/cgi/man.cgi?query=md&amp;sektion=4&amp;format=html">md(4)</a> при помощи <a href="https://man.freebsd.org/cgi/man.cgi?query=mdconfig&amp;sektion=8&amp;format=html">mdconfig(8)</a>, размещает на нём файловую систему UFS при помощи <a href="https://man.freebsd.org/cgi/man.cgi?query=newfs&amp;sektion=8&amp;format=html">newfs(8)</a> и монтирует её командой <a href="https://man.freebsd.org/cgi/man.cgi?query=mount&amp;sektion=8&amp;format=html">mount(8)</a>. Например, если вы хотите создать и смонтировать такой же образ файловой системе, как выше, просто наберите такую команду:</p></div><div class=exampleblock><div class=title>Пример 7. Настройка и монтирование диска, отображаемого в файл, при помощи команды <code>mdmfs</code></div><div class=content><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># dd if=/dev/zero of=newimage bs=1k count=5k</span>
5120+0 records <span class=k>in
</span>5120+0 records out
<span class=c># mdmfs -F newimage -s 5m md0 /mnt</span>
<span class=c># df /mnt</span>
Filesystem 1K-blocks Used Avail Capacity  Mounted on
/dev/md0        4718    4  4338     0%    /mnt</code></pre></div></div></div></div><div class=paragraph><p>Если вы используете параметр <code>md</code> без номера устройства, то <a href="https://man.freebsd.org/cgi/man.cgi?query=mdmfs&amp;sektion=8&amp;format=html">mdmfs(8)</a> будет использовать автоматическую нумерацию <a href="https://man.freebsd.org/cgi/man.cgi?query=md&amp;sektion=4&amp;format=html">md(4)</a> для автоматического выбора неиспользуемого устройства. Более полную информацию о <a href="https://man.freebsd.org/cgi/man.cgi?query=mdmfs&amp;sektion=8&amp;format=html">mdmfs(8)</a> можно найти на страницах справочной системы.</p></div></div><div class=sect2><h3 id=disks-md-freebsd4>17.13.3. Файловая система в памяти во FreeBSD 4.X<a class=anchor href=#disks-md-freebsd4></a></h3><div class=paragraph><p>Драйвер <a href="https://man.freebsd.org/cgi/man.cgi?query=md&amp;sektion=4&amp;format=html">md(4)</a> является простым и эффективным способом создания файловых систем в памяти во FreeBSD 4.X. Для выделения памяти используется <a href="https://man.freebsd.org/cgi/man.cgi?query=malloc&amp;sektion=9&amp;format=html">malloc(9)</a>.</p></div><div class=paragraph><p>Просто возьмите файловую систему, которую вы приготовили при помощи, скажем, <a href="https://man.freebsd.org/cgi/man.cgi?query=vnconfig&amp;sektion=8&amp;format=html">vnconfig(8)</a> и:</p></div><div class=exampleblock><div class=title>Пример 8. Диск md в памяти во FreeBSD 4.X</div><div class=content><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># dd if=newimage of=/dev/md0</span>
5120+0 records <span class=k>in
</span>5120+0 records out
<span class=c># mount /dev/md0c /mnt</span>
<span class=c># df /mnt</span>
Filesystem  1K-blocks	  Used	  Avail Capacity  Mounted on
/dev/md0c	 4927	     1	   4532     0%	  /mnt</code></pre></div></div></div></div><div class=paragraph><p>Для получения более полной информации, пожалуйста, обратитесь к страницам справочной системы по <a href="https://man.freebsd.org/cgi/man.cgi?query=md&amp;sektion=4&amp;format=html">md(4)</a>.</p></div></div><div class=sect2><h3 id=disks-md-freebsd5>17.13.4. Файловые системы с отображением в память<a class=anchor href=#disks-md-freebsd5></a></h3><div class=paragraph><p>При работе с файловыми системами, отображаемыми в файл или память, используются одни и те же утилиты: <a href="https://man.freebsd.org/cgi/man.cgi?query=mdconfig&amp;sektion=8&amp;format=html">mdconfig(8)</a> или <a href="https://man.freebsd.org/cgi/man.cgi?query=mdmfs&amp;sektion=8&amp;format=html">mdmfs(8)</a>. Обычно для отображаемых в память файловых систем следует использовать опцию "хранение на области подкачки". Это не означает, что такая файловая система будет сразу сброшена на диск: место под нее будет выделено из общего пула памяти, и при необходимости может перемещаться в область подкачки. Также, возможно выделение места под файловую систему в основной памяти (через <a href="https://man.freebsd.org/cgi/man.cgi?query=malloc&amp;sektion=9&amp;format=html">malloc(9)</a>); однако, следует помнить, что использование таких файловых систем, в особенности большого размера, может привести к панике системы от исчерпания ядерной памяти.</p></div><div class=exampleblock><div class=title>Пример 9. Создание нового диска с отображением в память при помощи <code>mdconfig</code></div><div class=content><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># mdconfig -a -t swap -s 5m -u 1</span>
<span class=c># newfs -U md1</span>
/dev/md1: 5.0MB <span class=o>(</span>10240 sectors<span class=o>)</span> block size 16384, fragment size 2048
	using 4 cylinder <span class=nb>groups </span>of 1.27MB, 81 blks, 192 inodes.
	with soft updates
super-block backups <span class=o>(</span><span class=k>for </span>fsck <span class=nt>-b</span> <span class=c>#) at:</span>
 160, 2752, 5344, 7936
<span class=c># mount /dev/md1 /mnt</span>
<span class=c># df /mnt</span>
Filesystem 1K-blocks Used Avail Capacity  Mounted on
/dev/md1        4718    4  4338     0%    /mnt</code></pre></div></div></div></div><div class=exampleblock><div class=title>Пример 10. Создание нового диска с отображением в память при помощи <code>mdmfs</code></div><div class=content><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># mdmfs -s 5m md2 /mnt</span>
<span class=c># df /mnt</span>
Filesystem 1K-blocks Used Avail Capacity  Mounted on
/dev/md2        4846    2  4458     0%    /mnt</code></pre></div></div></div></div></div><div class=sect2><h3 id=_отключение_диска_отображаемого_в_память_от_системы>17.13.5. Отключение диска, отображаемого в память, от системы<a class=anchor href=#_отключение_диска_отображаемого_в_память_от_системы></a></h3><div class=paragraph><p>Если файловые системы, отображаемые в память или файл, больше не используются, вам нужно высвободить все ресурсы для системы. Первым делом нужно размонтировать файловую систему, затем воспользоваться <a href="https://man.freebsd.org/cgi/man.cgi?query=mdconfig&amp;sektion=8&amp;format=html">mdconfig(8)</a> для отключения диска от системы и освободить ресурсы.</p></div><div class=paragraph><p>К примеру, чтобы отключить и освободить все ресурсы, используемые <span class=filename>/dev/md4</span>:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># mdconfig -d -u 4</span></code></pre></div></div><div class=paragraph><p>Для выдачи информации об отконфигурированных устройствах <a href="https://man.freebsd.org/cgi/man.cgi?query=md&amp;sektion=4&amp;format=html">md(4)</a> используется команда <code>mdconfig -l</code>.</p></div><div class=paragraph><p>Во FreeBSD 4.X для отключения устройства используется команда <a href="https://man.freebsd.org/cgi/man.cgi?query=vnconfig&amp;sektion=8&amp;format=html">vnconfig(8)</a>. Например, для отключения и освобождения всех ресурсов, используемых <span class=filename>/dev/vn4</span>:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># vnconfig -u vn4</span></code></pre></div></div></div></div></div><div class=sect1><h2 id=snapshots>17.14. Мгновенные копии файловых систем<a class=anchor href=#snapshots></a></h2><div class=sectionbody><div class=paragraph><p>Во FreeBSD 5.0 вместе с технологией <a href=../cutting-edge/#soft-updates>Отложенных обновлений</a> представлена новая возможность: генерация мгновенных копий файловых систем.</p></div><div class=paragraph><p>Мгновенные копии позволяют пользователю создавать образы заданных файловых систем и работать с ними как с файлами. Файлы мгновенных копий должны создаваться в той файловой системе, над которой производится действие, и пользователь может создавать не более 20 мгновенных копий для каждой файловой системы. Активные копии записываются в суперблок, так что они остаются в силе между операциями монтирования и размонтирования в процессе системных перезагрузок. Если мгновенная копия больше не нужна, она может быть удалена стандартной командой <a href="https://man.freebsd.org/cgi/man.cgi?query=rm&amp;sektion=1&amp;format=html">rm(1)</a>. Мгновенные копии могут удаляться в любом порядке, однако всё использованное пространство не может быть использовано, так как другая мгновенная копия может претендовать на некоторые блоки из освобождённых.</p></div><div class=paragraph><p>Неизменяемый флаг <code>snapshot</code> устанавливается на файл при помощи <a href="https://man.freebsd.org/cgi/man.cgi?query=mksnap_ffs&amp;sektion=8&amp;format=html">mksnap_ffs(8)</a> после первоначального создания файла мгновенной копии. Команда <a href="https://man.freebsd.org/cgi/man.cgi?query=unlink&amp;sektion=1&amp;format=html">unlink(1)</a> делает исключение для файлов мгновенных копий, позволяя их удалять.</p></div><div class=paragraph><p>Мгновенные копии создаются при помощи утилиты <a href="https://man.freebsd.org/cgi/man.cgi?query=mount&amp;sektion=8&amp;format=html">mount(8)</a>. Чтобы создать мгновенную копию <span class=filename>/var</span> в файле <span class=filename>/var/snapshot/snap</span>, воспользуйтесь такой командой:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># mount -u -o snapshot /var/snapshot/snap /var</span></code></pre></div></div><div class=paragraph><p>В качестве альтернативного средства создания мгновенных копий вы можете использовать утилиту <a href="https://man.freebsd.org/cgi/man.cgi?query=mksnap_ffs&amp;sektion=8&amp;format=html">mksnap_ffs(8)</a>:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># mksnap_ffs /var /var/snapshot/snap</span></code></pre></div></div><div class=paragraph><p>Файлы мгновенных копий файловых систем (к примеру, <span class=filename>/var</span>) можно найти при помощи команды <a href="https://man.freebsd.org/cgi/man.cgi?query=find&amp;sektion=1&amp;format=html">find(1)</a>:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># find /var -flags snapshot</span></code></pre></div></div><div class=paragraph><p>После создания мгновенной копии есть несколько способов её использования:</p></div><div class=ulist><ul><li><p>Некоторые администраторы будут использовать файл мгновенной копии для целей создания резервной копии, так как мгновенная копия может быть перенесена на CD или магнитную ленту.</p></li><li><p>Утилита проверка целостности файловой системы, <a href="https://man.freebsd.org/cgi/man.cgi?query=fsck&amp;sektion=8&amp;format=html">fsck(8)</a>, может быть запущена над мгновенной копией. Полагая, что файловая система была в порядке, когда она была смонтирована, вы всегда должны получать нормальный (и неизменный) результат. Это именно то, что выполняет фоновый процесс <a href="https://man.freebsd.org/cgi/man.cgi?query=fsck&amp;sektion=8&amp;format=html">fsck(8)</a>.</p></li><li><p>Запустить утилиту <a href="https://man.freebsd.org/cgi/man.cgi?query=dump&amp;sektion=8&amp;format=html">dump(8)</a> с мгновенной копией. Будет создаваться дамп, соответствующий файловой системе на момент создания мгновенной копии. Утилита <a href="https://man.freebsd.org/cgi/man.cgi?query=dump&amp;sektion=8&amp;format=html">dump(8)</a> при использовании опции <code>-L</code> тоже может работать с мгновенными копиями, создавать их дампы, а затем удалять за один проход.</p></li><li><p>Смонтировать командой <a href="https://man.freebsd.org/cgi/man.cgi?query=mount&amp;sektion=8&amp;format=html">mount(8)</a> мгновенную копию как замороженный образ файловой системы. Чтобы смонтировать командой <a href="https://man.freebsd.org/cgi/man.cgi?query=mount&amp;sektion=8&amp;format=html">mount(8)</a> мгновенную копию <span class=filename>/var/snapshot/snap</span>, запустите:</p><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># mdconfig -a -t vnode -f /var/snapshot/snap -u 4</span>
<span class=c># mount -r /dev/md4 /mnt</span></code></pre></div></div></li></ul></div><div class=paragraph><p>Теперь вы можете пройтись по иерархии вашей зафиксированной файловой системы <span class=filename>/var</span>, смонтированной в каталог <span class=filename>/mnt</span>. Первоначально всё будет в том же самом состоянии, в каком это было во время создания мгновенной копии. Единственным исключением будет то, что любые ранее сделанные мгновенные копии будут видны как файлы нулевой длины. Когда использование мгновенной копии закончено, она может быть удалена командой:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># umount /mnt</span>
<span class=c># mdconfig -d -u 4</span></code></pre></div></div><div class=paragraph><p>Для получения более полной информации о <code>softupdates</code> и мгновенных копиях файловых систем, включая технической описание, вы можете посетить сайт Маршалла Кёрка МакКузика (Marshall Kirk McKusick) по адресу <a href=http://www.mckusick.com/>http://www.mckusick.com/</a>.</p></div></div></div><div class=sect1><h2 id=quotas>17.15. Квотирование файловых систем<a class=anchor href=#quotas></a></h2><div class=sectionbody><div class=paragraph><p>Квоты - это опциональная возможность операционной системы, которая позволяет ограничивать объем дискового пространства и/или количество файлов для конкретного пользователя или членов определенной группы в рамках одной файловой системы. Чаще всего эта возможность используется в системах разделения времени, когда желательно ограничить количество ресурсов, которые может использовать один пользователь или группа пользователей. Это позволит не допустить ситуации, когда один пользователь или группа пользователей заполняют всё доступное дисковое пространство.</p></div><div class=sect2><h3 id=_настройка_вашей_системы_на_использование_дисковых_квот>17.15.1. Настройка вашей системы на использование дисковых квот<a class=anchor href=#_настройка_вашей_системы_на_использование_дисковых_квот></a></h3><div class=paragraph><p>Перед тем, как попытаться использовать дисковые квоты, необходимо убедиться, что квоты включены в вашем ядре. Это делается добавлением следующей строки в конфигурационный файл вашего ядра:</p></div><div class="literalblock programlisting"><div class=content><pre>options QUOTA</pre></div></div><div class=paragraph><p>В стандартном ядре <span class=filename>GENERIC</span> это по умолчанию не включено, так что для использования дисковых квот вам нужно будет настроить, откомпилировать и установить собственное ядро. Пожалуйста, обратитесь к <a href=../kernelconfig/#kernelconfig>Настройка ядра FreeBSD</a> за дополнительной информацией о настройке ядра.</p></div><div class=paragraph><p>Затем вам потребуется включить квотирование дисков в файле <span class=filename>/etc/rc.conf</span>. Это делается добавление такой строчки:</p></div><div class="literalblock programlisting"><div class=content><pre>enable_quotas=&#34;YES&#34;</pre></div></div><div class=paragraph><p>Для более полного контроля над запуском квотирования имеется дополнительная переменная для настройки. Как правило, при загрузке целостность квот каждой файловой системы проверяется программой <a href="https://man.freebsd.org/cgi/man.cgi?query=quotacheck&amp;sektion=8&amp;format=html">quotacheck(8)</a>. При работе программы <a href="https://man.freebsd.org/cgi/man.cgi?query=quotacheck&amp;sektion=8&amp;format=html">quotacheck(8)</a> проверяется точное соответствие данных в базе данных квот данным в файловой системе. Это весьма долгий процесс, что отражается на времени загрузки системы. Если вам захочется пропустить этот шаг, то для этого предназначена специальная переменная в файле <span class=filename>/etc/rc.conf</span>:</p></div><div class="literalblock programlisting"><div class=content><pre>check_quotas=&#34;NO&#34;</pre></div></div><div class=paragraph><p>Наконец, вам потребуется отредактировать файл <span class=filename>/etc/fstab</span> для включения дисковых квот на уровне файловых систем. Это то место, где вы можете включить квоты для пользователей, для групп или для обеих этих категорий для всех ваших файловых систем.</p></div><div class=paragraph><p>Для включения пользовательских квот для файловой системы, добавьте параметр <code>userquota</code> в поле параметров файловой системы, на которой вы хотите включить квотирование, в файле <span class=filename>/etc/fstab</span>. Например:</p></div><div class="literalblock programlisting"><div class=content><pre>/dev/da1s2g   /home    ufs rw,userquota 1 2</pre></div></div><div class=paragraph><p>Подобным же образом для включения квотирования на уровне групп, воспользуйтесь параметром <code>groupquota</code> вместо <code>userquota</code>. Чтобы включить квотирование как для пользователей, так и для групп, измените строчку следующим образом:</p></div><div class="literalblock programlisting"><div class=content><pre>/dev/da1s2g   /home    ufs rw,userquota,groupquota 2 2</pre></div></div><div class=paragraph><p>По умолчанию файлы квот хранятся в корневом каталоге файловой системы в файлах с именами <span class=filename>quota.user</span> и <span class=filename>quota.group</span> соответственно для пользовательских и групповых квот. Для получения подробной информации обратитесь к команде <a href="https://man.freebsd.org/cgi/man.cgi?query=fstab&amp;sektion=5&amp;format=html">fstab(5)</a>. Хотя справочная страница по <a href="https://man.freebsd.org/cgi/man.cgi?query=fstab&amp;sektion=5&amp;format=html">fstab(5)</a> утверждает, что вы можете указать другое местоположение файлов с квотами, этого делать не рекомендуется, потому что различные утилиты для работы с квотами не могут нормально работать в такой ситуации.</p></div><div class=paragraph><p>На этом этапе вы должны перезагрузить вашу систему с новым ядром. Скрипт <span class=filename>/etc/rc</span> автоматически запустит соответствующие команды для создания начальных файлов для всех квот, которые вы создали в файле <span class=filename>/etc/fstab</span>, так что нет нужды вручную создавать никаких файлов квот нулевой длины.</p></div><div class=paragraph><p>При нормальной работе вам не потребуется вручную запускать программы <a href="https://man.freebsd.org/cgi/man.cgi?query=quotacheck&amp;sektion=8&amp;format=html">quotacheck(8)</a>, <a href="https://man.freebsd.org/cgi/man.cgi?query=quotaon&amp;sektion=8&amp;format=html">quotaon(8)</a> или <a href="https://man.freebsd.org/cgi/man.cgi?query=quotaoff&amp;sektion=8&amp;format=html">quotaoff(8)</a>. Однако вам нужно хотя бы прочесть страницы справочника по этим командам, просто чтобы ознакомиться с их функциями.</p></div></div><div class=sect2><h3 id=_установка_квот>17.15.2. Установка квот<a class=anchor href=#_установка_квот></a></h3><div class=paragraph><p>Как только вы настроили вашу систему на использование квот, проверьте, что они действительно были задействованы. Простым способом сделать это является запуск такой команды:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># quota -v</span></code></pre></div></div><div class=paragraph><p>Вы должны увидеть однострочную информацию, отражающую использование диска и текущие ограничения для каждой файловой системы, на которой включено квотирование.</p></div><div class=paragraph><p>Теперь вы действительно готовы задавать ограничения при помощи команды <a href="https://man.freebsd.org/cgi/man.cgi?query=edquota&amp;sektion=8&amp;format=html">edquota(8)</a>.</p></div><div class=paragraph><p>У вас есть несколько вариантов того, как приводить в действие ограничения по объему дискового пространства, который могут занимать пользователь или группа, а также по количеству файлов, которые они могут создать. Вы можете ограничивать размещение ресурсов на основе объема дискового пространства (квотирование блоков), количества файлов (квотирование inode) или их комбинации. Каждое из этих ограничений, в свою очередь, делится на две категории: мягкие и жёсткие ограничения.</p></div><div class=paragraph><p>Жёсткое ограничение не может быть превышено. Как только пользователь достиг своих ограничений, ресурсы соответствующей файловой системы ему больше выделяться не будут. Например, если пользователь имеет жесткое ограничение в 500 Кбайт на файловой системе и в текущий момент использует 490 Кбайт, то пользователь может получить дополнительно ещё 10 Кбайт. Попытка занять ещё 11 Кбайт окончится неудачно.</p></div><div class=paragraph><p>С другой стороны, мягкие ограничения могут быть превышены в течении некоторого периода времени. Этот период времени также называют периодом отсрочки, который по умолчанию равен одной неделе. Если пользователь превышает своё мягкое ограничение в течение периода времени, превышающего отсрочку, то это мягкое ограничение становится жестким и последующее выделение ресурсов будет запрещено. Когда пользователь вернётся обратно к отметке, меньшей, чем мягкое ограничение, то период отсрочки будет сброшен.</p></div><div class=paragraph><p>Далее приводится пример того, что вы можете наблюдать при запуске команды <a href="https://man.freebsd.org/cgi/man.cgi?query=edquota&amp;sektion=8&amp;format=html">edquota(8)</a>. Когда вызывается команда <a href="https://man.freebsd.org/cgi/man.cgi?query=edquota&amp;sektion=8&amp;format=html">edquota(8)</a>, вы оказываетесь в редакторе, заданном переменной переменной окружения <code>EDITOR</code>, или в редакторе vi, если переменная <code>EDITOR</code> не задана, и можете редактировать квоты.</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># edquota -u test</span></code></pre></div></div><div class="literalblock programlisting"><div class=content><pre>Quotas for user test:
/usr: kbytes in use: 65, limits (soft = 50, hard = 75)
	inodes in use: 7, limits (soft = 50, hard = 60)
/usr/var: kbytes in use: 0, limits (soft = 50, hard = 75)
	inodes in use: 0, limits (soft = 50, hard = 60)</pre></div></div><div class=paragraph><p>Для каждой файловой системы, на которой включено квотирование, вы должны увидеть две строки. В одной строке приведены ограничения на блоки, а в другой на количество inode. Например, чтобы увеличить ограничения на количество блоков для пользователя с мягкого ограничения в 50 и жёсткого ограничения в 75, на мягкое ограничение в 500 и жёсткое ограничение в 600, измените:</p></div><div class="literalblock programlisting"><div class=content><pre>/usr: kbytes in use: 65, limits (soft = 50, hard = 75)</pre></div></div><div class=paragraph><p>на:</p></div><div class="literalblock programlisting"><div class=content><pre>/usr: kbytes in use: 65, limits (soft = 500, hard = 600)</pre></div></div><div class=paragraph><p>Новые ограничения вступят в силу после выхода из редактора.</p></div><div class=paragraph><p>Иногда желательно установить ограничения квот на некоторый диапазон UID (идентификаторов пользователей). Это можно сделать при помощи параметра <code>-p</code> в команде <a href="https://man.freebsd.org/cgi/man.cgi?query=edquota&amp;sektion=8&amp;format=html">edquota(8)</a>. Во-первых, установите желаемое ограничение для пользователя, а затем запустите команду <code>edquota -p protouser startuid-enduid</code>. Например, если пользователь <code>test</code> имеет желаемые ограничения, то для дублирования этих ограничений на пользователей с UID от 10000 до 19999 может быть использована такая команда:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># edquota -p test 10000-19999</span></code></pre></div></div><div class=paragraph><p>Дополнительную информацию можно получить из справочной страницы по команде <a href="https://man.freebsd.org/cgi/man.cgi?query=edquota&amp;sektion=8&amp;format=html">edquota(8)</a>.</p></div></div><div class=sect2><h3 id=_проверка_ограничений_и_использования_диска>17.15.3. Проверка ограничений и использования диска<a class=anchor href=#_проверка_ограничений_и_использования_диска></a></h3><div class=paragraph><p>Для проверки квот и использования дисков вы можете использовать команды <a href="https://man.freebsd.org/cgi/man.cgi?query=quota&amp;sektion=1&amp;format=html">quota(1)</a> или <a href="https://man.freebsd.org/cgi/man.cgi?query=repquota&amp;sektion=8&amp;format=html">repquota(8)</a>. Команда <a href="https://man.freebsd.org/cgi/man.cgi?query=quota&amp;sektion=1&amp;format=html">quota(1)</a> может быть использована для проверки квот отдельных пользователей, групп, а также использования дисков. Пользователь может только проверить собственную квоту и квоту той группы, к которой он принадлежит. Только администратор системы может проверить квоты всех пользователей и групп. Команду <a href="https://man.freebsd.org/cgi/man.cgi?query=repquota&amp;sektion=8&amp;format=html">repquota(8)</a> можно использовать для получения суммарной статистики всех квот и использования дисков для файловых систем с включенными квотами.</p></div><div class=paragraph><p>Далее приведен пример вывода команды <code>quota -v</code> для пользователя, который имеет ограничения на двух файловых системах.</p></div><div class="literalblock programlisting"><div class=content><pre>Disk quotas for user test (uid 1002):
     Filesystem  usage    quota   limit   grace   files   quota   limit   grace
           /usr      65*     50      75   5days       7      50      60
       /usr/var       0      50      75 	      0      50      60</pre></div></div><div class=paragraph><p>В этом примере для файловой системы <span class=filename>/usr</span> пользователь превысил свое мягкое ограничение в 50 Кбайт на 15 Кбайт и имеет 5 дней до истечения отсрочки. Отметьте знак звездочки <code>*</code>, который указывает на превышение пользователем своего ограничения.</p></div><div class=paragraph><p>Как правило, файловые системы, на которых пользователь не занимает дискового пространства, не показываются в выводе команды <a href="https://man.freebsd.org/cgi/man.cgi?query=quota&amp;sektion=1&amp;format=html">quota(1)</a>, даже если ему выделена квота на этой файловой системе. При использовании параметра <code>-v</code> эти файловые системы выводятся, как, например, файловая система <span class=filename>/usr/var</span> в примере выше.</p></div></div><div class=sect2><h3 id=_квоты_в_nfs>17.15.4. Квоты в NFS<a class=anchor href=#_квоты_в_nfs></a></h3><div class=paragraph><p>Квоты определяются подсистемой квот на сервере NFS. Даемон <a href="https://man.freebsd.org/cgi/man.cgi?query=rpc.rquotad&amp;sektion=8&amp;format=html">rpc.rquotad(8)</a> предоставляет информацию о квотах для программы <a href="https://man.freebsd.org/cgi/man.cgi?query=quota&amp;sektion=1&amp;format=html">quota(1)</a> на клиентах NFS, позволяя пользователям на этих машинах смотреть свою статистику о квотах.</p></div><div class=paragraph><p>Включите <code>rpc.rquotad</code> в файле <span class=filename>/etc/inetd.conf</span> следующим образом:</p></div><div class="literalblock programlisting"><div class=content><pre>rquotad/1      dgram rpc/udp wait root /usr/libexec/rpc.rquotad rpc.rquotad</pre></div></div><div class=paragraph><p>Теперь перезапустите <code>inetd</code>:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># /etc/rc.d/inetd restart</span></code></pre></div></div></div></div></div><div class=sect1><h2 id=disks-encrypting>17.16. Шифрование дисковых разделов<a class=anchor href=#disks-encrypting></a></h2><div class=sectionbody><div class=paragraph><p>FreeBSD предоставляет прекрасную возможность по защите от несанкционированного доступа к данным. Права на доступ к файлам и технология принудительного контроля доступа MAC (Mandatory Access Control) (смотрите see <a href=../mac/#mac>Принудительный контроль доступа (MAC)</a>) помогают предотвратить несанкционированный доступ посторонних лиц к данным, при условии работы операционной системы и компьютера. Однако права доступа, контролируемые операционной системой, не имеют значения, если нападающий получает физический доступ к компьютеру и может просто перенести жёсткий диск на другую машину для копирования и дальнейшего анализа важных данных.</p></div><div class=paragraph><p>Вне зависимости от того, как атакующий завладел жёстким диском или выключенным компьютером, технологии gbde (GEOM Based Disk Encryption - шифрование диска на уровне GEOM) и криптографическая подсистема <code>geli</code> FreeBSD могут защитить данные файловой системы компьютера даже против очень заинтересованной атакующей стороны с достаточными ресурсами. В отличие от громоздких систем шифрования, которые шифруют отдельные файлы, <code>gbde</code> и <code>geli</code> шифруют в прозрачном режиме файловую систему в целом, при этом данные в открытом виде на диск никогда не записываются.</p></div><div class=sect2><h3 id=_шифрование_диска_при_помощи_gbde>17.16.1. Шифрование диска при помощи gbde<a class=anchor href=#_шифрование_диска_при_помощи_gbde></a></h3><div class="exampleblock procedure"><div class=content><div class="olist arabic"><ol class=arabic><li><p>Получите права пользователя <code>root</code></p><div class=paragraph><p>Настройка gbde требует права доступа администратора системы.</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>% su -
Password:</code></pre></div></div></li><li><p>Включите поддержку <a href="https://man.freebsd.org/cgi/man.cgi?query=gbde&amp;sektion=4&amp;format=html">gbde(4)</a> в конфигурационный файл ядра</p><div class=paragraph><p>Добавьте следующую строку в файл конфигурации вашего ядра:</p></div><div class=paragraph><p><code>options GEOM_BDE</code></p></div><div class=paragraph><p>Перестройте ядро FreeBSD. Этот процесс описан в <a href=../kernelconfig/#kernelconfig>Настройка ядра FreeBSD</a>.</p></div><div class=paragraph><p>Перезагрузитесь, запустив новое ядро.</p></div></li><li><p>Альтернативой пересборке ядра является использование <code>kldload</code> для загрузки модуля <a href="https://man.freebsd.org/cgi/man.cgi?query=gbde&amp;sektion=4&amp;format=html">gbde(4)</a>:</p><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># kldload geom_bde</span></code></pre></div></div></li></ol></div></div></div><div class=sect3><h4 id=_подготовка_зашифрованного_жёсткого_диска>17.16.1.1. Подготовка зашифрованного жёсткого диска<a class=anchor href=#_подготовка_зашифрованного_жёсткого_диска></a></h4><div class=paragraph><p>В следующем примере предполагается, что в вашу систему вы добавляете новый винчестер, на котором будет располагаться единственный раздел с зашифрованными данными. Этот раздел будет монтироваться в каталог <span class=filename>/private</span>. gbde может также использоваться для шифрования <span class=filename>/home</span> и <span class=filename>/var/mail</span>, но это требует более сложной последовательности действий, что выходит за рамки этого вводного материала.</p></div><div class="exampleblock procedure"><div class=content><div class="olist arabic"><ol class=arabic><li><p>Подключите новый жёсткий диск</p><div class=paragraph><p>Установите новый диск в систему, как это описано в <a href=#disks-adding>Добавление дисков</a>. В рамках этого примера раздел, соответствующий новому жёсткому диску, будет называться <span class=filename>/dev/ad4s1c</span>. Устройства <span class=filename>/dev/ad0s1*</span> представляют существующие стандартные разделы FreeBSD нашей тестовой системы.</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># ls /dev/ad*</span>
/dev/ad0        /dev/ad0s1b     /dev/ad0s1e     /dev/ad4s1
/dev/ad0s1      /dev/ad0s1c     /dev/ad0s1f     /dev/ad4s1c
/dev/ad0s1a     /dev/ad0s1d     /dev/ad4</code></pre></div></div></li><li><p>Создайте каталог для размещения файлов блокировок GBDE</p><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># mkdir /etc/gbde</span></code></pre></div></div><div class=paragraph><p>Файл блокировки gbde содержит информацию, которая нужна gbde для доступа к зашифрованному разделу. Не имея доступа к файлу блокировки, gbde не сможет расшифровать данные, хранимые в зашифрованном разделе, без значительного ручного вмешательства, что программно не поддерживается. Каждый зашифрованный раздел использует отдельный файл блокировки.</p></div></li><li><p>Инициализируйте раздел gbde</p><div class=paragraph><p>Перед началом работы с разделом gbde его необходимо проинициализировать. Эта инициализация производится только один раз:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># gbde init /dev/ad4s1c -i -L /etc/gbde/ad4s1c.lock</span></code></pre></div></div><div class=paragraph><p><a href="https://man.freebsd.org/cgi/man.cgi?query=gbde&amp;sektion=8&amp;format=html">gbde(8)</a> запустит редактор, что позволит вам задать в шаблоне различные конфигурационные параметры. При работе с файловыми системами UFS1 и UFS2 задайте значение sector_size равным 2048:</p></div><div class="literalblock programlisting"><div class=content><pre>$FreeBSD: src/sbin/gbde/template.txt,v 1.1 2002/10/20 11:16:13 phk Exp $
#
# Sector size is the smallest unit of data which can be read or written.
# Making it too small decreases performance and decreases available space.
# Making it too large may prevent filesystems from working.  512 is the
# minimum and always safe.  For UFS, use the fragment size
#
sector_size     =       2048
[...]</pre></div></div><div class=paragraph><p><a href="https://man.freebsd.org/cgi/man.cgi?query=gbde&amp;sektion=8&amp;format=html">gbde(8)</a> дважды запросит ввод пароля, который будет использоваться для защиты данных. Пароль в обоих случаях должен вводиться одинаковый. Возможности gbde по защите ваших данных полностью зависят от качества выбранной вами ключевой фразы.</p></div><div class=paragraph><p>По команде <code>gbde init</code> создаётся файл блокировок для вашего раздела gbde, который в нашем случае будет иметь имя <span class=filename>/etc/gbde/ad4s1c.lock</span>. Для того, чтобы файлы блокировок корректно распознавались стартовым скриптом <span class=filename>/etc/rc.d/gbde</span>, их имена должны заканчиваться на ".lock".</p></div><div class="admonitionblock caution"><table><tbody><tr><td class=icon><i class="fa icon-caution" title=Caution></i></td><td class=content><div class=paragraph><p>Резервные копии файлов блокировок gbde <em>должны</em> храниться вместе с содержимым шифруемых разделов. Хотя удаление только блокировочного файла не сможет противостоять дешифрации атакующим раздела gbde, без этого файла даже легитимный пользователь не сможет получить доступ к данным без определённых и значительных усилий, что не поддерживается <a href="https://man.freebsd.org/cgi/man.cgi?query=gbde&amp;sektion=8&amp;format=html">gbde(8)</a> и его разработчиком.</p></div></td></tr></tbody></table></div></li><li><p>Подключите зашифрованный раздел к системе</p><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># gbde attach /dev/ad4s1c -l /etc/gbde/ad4s1c.lock</span></code></pre></div></div><div class=paragraph><p>Будет выдан запрос на ввод ключевой фразы, которую вы выбирали во время инициализации зашифрованного раздела. Новое защищённое устройство будет видно в каталоге <span class=filename>/dev</span> под названием <span class=filename>/dev/device_name.bde</span>:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># ls /dev/ad*</span>
/dev/ad0        /dev/ad0s1b     /dev/ad0s1e     /dev/ad4s1
/dev/ad0s1      /dev/ad0s1c     /dev/ad0s1f     /dev/ad4s1c
/dev/ad0s1a     /dev/ad0s1d     /dev/ad4        /dev/ad4s1c.bde</code></pre></div></div></li><li><p>Создайте файловую систему на зашифрованном устройстве</p><div class=paragraph><p>Как только защищённое устройство будет подключено к системе, вы сможете создать на нём файловую систему. Для этого используется утилита <a href="https://man.freebsd.org/cgi/man.cgi?query=newfs&amp;sektion=8&amp;format=html">newfs(8)</a>. Так как инициализация новой файловой системы UFS2 происходит быстрее, чем инициализация файловой системы старого формата UFS1, то рекомендуется использовать <a href="https://man.freebsd.org/cgi/man.cgi?query=newfs&amp;sektion=8&amp;format=html">newfs(8)</a> с параметром <code>-O2</code>.</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># newfs -U -O2 /dev/ad4s1c.bde</span></code></pre></div></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Запуск команды <a href="https://man.freebsd.org/cgi/man.cgi?query=newfs&amp;sektion=8&amp;format=html">newfs(8)</a> должен выполняться над подключенном разделе gbde, который идентифицируется по расширению <span class=filename>*.bde</span> в имени устройства.</p></div></td></tr></tbody></table></div></li><li><p>Смонтируйте зашифрованный раздел</p><div class=paragraph><p>Создайте точку монтирования для зашифрованной файловой системы.</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># mkdir /private</span></code></pre></div></div><div class=paragraph><p>Смонтируйте защищённую файловую систему.</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># mount /dev/ad4s1c.bde /private</span></code></pre></div></div></li><li><p>Проверьте доступность зашифрованной файловой системы</p><div class=paragraph><p>Защищённая файловая система теперь должна быть доступна утилите <a href="https://man.freebsd.org/cgi/man.cgi?query=df&amp;sektion=1&amp;format=html">df(1)</a> и доступной для использования.</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>% <span class=nb>df</span> <span class=nt>-H</span>
Filesystem        Size   Used  Avail Capacity  Mounted on
/dev/ad0s1a      1037M    72M   883M     8%
/devfs            1.0K   1.0K     0B   100%    /dev
/dev/ad0s1f       8.1G    55K   7.5G     0%    /home
/dev/ad0s1e      1037M   1.1M   953M     0%    /tmp
/dev/ad0s1d       6.1G   1.9G   3.7G    35%    /usr
/dev/ad4s1c.bde   150G   4.1K   138G     0%    /private</code></pre></div></div></li></ol></div></div></div></div><div class=sect3><h4 id=_монтирование_имеющихся_зашифрованных_файловых_систем>17.16.1.2. Монтирование имеющихся зашифрованных файловых систем<a class=anchor href=#_монтирование_имеющихся_зашифрованных_файловых_систем></a></h4><div class=paragraph><p>После каждой загрузки для каждой защищённой файловой системы перед их использованием должны выполняться повторное подключение к системе, проверка на наличие ошибок и монтирование. Требуемые для этого команды должны выполняться пользователем <code>root</code>.</p></div><div class="exampleblock procedure"><div class=content><div class="olist arabic"><ol class=arabic><li><p>Подключение gbde-раздела к системе</p><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># gbde attach /dev/ad4s1c -l /etc/gbde/ad4s1c.lock</span></code></pre></div></div><div class=paragraph><p>Будет выдан запрос на ввод ключевой фразы, выбранной на этапе инициализации зашифрованного раздела gbde.</p></div></li><li><p>Проверка файловой системы на наличие ошибок</p><div class=paragraph><p>Так как защищаемая файловая система не может пока быть указана в файле <span class=filename>/etc/fstab</span> для автоматического монтирования, то она должны проверяться на наличие ошибок посредством ручного запуска <a href="https://man.freebsd.org/cgi/man.cgi?query=fsck&amp;sektion=8&amp;format=html">fsck(8)</a> до её монтирования.</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># fsck -p -t ffs /dev/ad4s1c.bde</span></code></pre></div></div></li><li><p>Монтирование зашифрованной файловой системы</p><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># mount /dev/ad4s1c.bde /private</span></code></pre></div></div><div class=paragraph><p>Теперь защищённая файловая система доступна для работы.</p></div></li></ol></div></div></div><div class=sect4><h5 id=_автоматическое_монтирование_зашифрованных_разделов>17.16.1.2.1. Автоматическое монтирование зашифрованных разделов<a class=anchor href=#_автоматическое_монтирование_зашифрованных_разделов></a></h5><div class=paragraph><p>Для автоматического подключения, проверки и монтирования зашифрованного раздела можно создать скрипт, но по соображениям безопасности в этом скрипте пароля для <a href="https://man.freebsd.org/cgi/man.cgi?query=gbde&amp;sektion=8&amp;format=html">gbde(8)</a> быть не должно. Поэтому рекомендуется запускать такие скрипты вручную, а пароль задавать с консоли или сеанса <a href="https://man.freebsd.org/cgi/man.cgi?query=ssh&amp;sektion=1&amp;format=html">ssh(1)</a>.</p></div><div class=paragraph><p>Кроме того, базовая система содержит скрипт <span class=filename>rc.d</span> для автоматического монтирования шифрованных разделов. Его аргументы могут быть указаны в файле <a href="https://man.freebsd.org/cgi/man.cgi?query=rc.conf&amp;sektion=5&amp;format=html">rc.conf(5)</a>:</p></div><div class="literalblock programlisting"><div class=content><pre>gbde_autoattach_all=&#34;YES&#34;
gbde_devices=&#34;ad4s1c&#34;
gbde_lockdir=&#34;/etc/gbde&#34;</pre></div></div><div class=paragraph><p>При этом ключевая фраза для gbde должна быть введена на этапе загрузки. После введения ключевой фразы зашифрованный раздел будет смонтирован автоматически. Такой подход может быть очень удобным для использования gbde на ноутбуках.</p></div></div></div><div class=sect3><h4 id=_криптографическая_защита_применяемая_в_gbde>17.16.1.3. Криптографическая защита, применяемая в gbde<a class=anchor href=#_криптографическая_защита_применяемая_в_gbde></a></h4><div class=paragraph><p><a href="https://man.freebsd.org/cgi/man.cgi?query=gbde&amp;sektion=8&amp;format=html">gbde(8)</a> шифрует содержимое секторов при помощи 128-битного AES в режиме CBC. Каждый сектор диска шифруется различным ключом AES. Более полная информацию о системе шифрования gbde, включая алгоритм генерации ключей для секторов из ключевой фразы, вводимой пользователем, можно найти на страницах справочной системы о <a href="https://man.freebsd.org/cgi/man.cgi?query=gbde&amp;sektion=4&amp;format=html">gbde(4)</a>.</p></div></div><div class=sect3><h4 id=_вопросы_совместимости>17.16.1.4. Вопросы совместимости<a class=anchor href=#_вопросы_совместимости></a></h4><div class=paragraph><p><a href="https://man.freebsd.org/cgi/man.cgi?query=sysinstall&amp;sektion=8&amp;format=html">sysinstall(8)</a> несовместим с устройствами, зашифрованными gbde. Все устройства <span class=filename>*.bde</span> перед запуском <a href="https://man.freebsd.org/cgi/man.cgi?query=sysinstall&amp;sektion=8&amp;format=html">sysinstall(8)</a> должны быть отключены от системы, или эта утилита аварийно завершит работу на этапе обнаружения устройств. Для отключения защищённого устройства, используемого в нашем примере, воспользуйтесь такой командой:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># gbde detach /dev/ad4s1c</span></code></pre></div></div></div></div><div class=sect2><h3 id=_шифрование_дисков_при_помощи_geli>17.16.2. Шифрование дисков при помощи <code>geli</code><a class=anchor href=#_шифрование_дисков_при_помощи_geli></a></h3><div class=paragraph><p>Во FreeBSD имеется альтернативный криптографический класс GEOM - <code>geli</code>. В настоящий момент он поддерживается Paweł Jakub Dawidek &lt;<a href=mailto:pjd@FreeBSD.org>pjd@FreeBSD.org</a>>. Утилита <code>geli</code> отличается от <code>gbde</code>; она предоставляет другой комплекс возможностей и использует иную схему криптования.</p></div><div class=paragraph><p>Наиболее значимыми особенностями <a href="https://man.freebsd.org/cgi/man.cgi?query=geli&amp;sektion=8&amp;format=html">geli(8)</a> являются:</p></div><div class=ulist><ul><li><p>Использование инфраструктуры <a href="https://man.freebsd.org/cgi/man.cgi?query=crypto&amp;sektion=9&amp;format=html">crypto(9)</a>: при наличии аппаратной криптографической поддержки, <code>geli</code> автоматически использует ее.</p></li><li><p>Поддержка разнообразных криптоалгоритмов (в настоящее время AES, Blowfish и 3DES).</p></li><li><p>Поддержка шифрованного корневого раздела. Для загрузки в такой ситуации потребуется ввести ключевую фразу.</p></li><li><p>Поддержка двух независимых ключей шифрования (например, "основного ключа" и "ключа компании").</p></li><li><p>Высокая скорость работы <code>geli</code> за счет простого криптования сектор-сектор.</p></li><li><p>Поддержка архивирования основных ключей. При необходимости текущие ключи могут быть уничтожены, а в дальнейшем доступ к данным восстановлен при помощи архивированных ключей.</p></li><li><p>Поддержка криптования файловых систем случайным одноразовым ключом - например, для разделов подкачки или временных файловых систем.</p></li></ul></div><div class=paragraph><p>Другие возможности класса <code>geli</code> описаны в его странице справочника: <a href="https://man.freebsd.org/cgi/man.cgi?query=geli&amp;sektion=8&amp;format=html">geli(8)</a>.</p></div><div class=paragraph><p>Несколько следующих страниц будут посвящены описанию процесса конфигурации <code>geli</code> в ядре FreeBSD, а также объяснят, как создавать и использовать криптографический провайдер <code>geli</code>.</p></div><div class=paragraph><p>Поскольку в процессе настройки возникнет необходимость внесения изменений в конфигурацию ядра, потребуются также привилегии суперпользователя.</p></div><div class="exampleblock procedure"><div class=content><div class="olist arabic"><ol class=arabic><li><p>Добавление поддержки <code>geli</code> в ядро</p><div class=paragraph><p>Добавьте в конфигурационный файл ядра следующие строки:</p></div><div class="literalblock programlisting"><div class=content><pre>options GEOM_ELI
device crypto</pre></div></div><div class=paragraph><p>Перестройте ядро, как описано в разделе <a href=../kernelconfig/#kernelconfig>Настройка ядра FreeBSD</a>.</p></div><div class=paragraph><p>Помимо этого, поддержка <code>geli</code> может быть активирована модулем ядра на этапе загрузки. Для этого добавьте в файл <span class=filename>/boot/loader.conf</span> строку:</p></div><div class="literalblock programlisting"><div class=content><pre>geom_eli_load=&#34;YES&#34;</pre></div></div><div class=paragraph><p>Теперь ядро должно поддерживать <a href="https://man.freebsd.org/cgi/man.cgi?query=geli&amp;sektion=8&amp;format=html">geli(8)</a>.</p></div></li><li><p>Генерация главного ключа</p><div class=paragraph><p>Предлагаемый пример описывает процесс генерации ключевого файла, который послужит частью главного ключа для шифрованного провайдера, монтируемого в каталог <span class=filename>/private</span>. При помощи содержимого ключевого файла создается набор случайных данных, которым зашифровывается главный ключ. Кроме того, он будет защищен кодовой фразой. Размер сектора провайдера будет составлять 4kB. Наконец, мы обсудим, как присоединиться к провайдеру <code>geli</code>, создать на базе его файловую систему, как ее смонтировать и работать с ней, и, в заключение, как корректно завершить работу.</p></div><div class=paragraph><p>Больший чем обычно размер сектора (как в нашем примере, 4 кБ) рекомендуется для увеличения производительности.</p></div><div class=paragraph><p>Главный ключ будет защищен кодовой фразой; данные для ключевого файла берутся из <span class=filename>/dev/random</span>. Размер сектора создаваемого нами шифрованного провайдера <span class=filename>/dev/da2.eli</span> - 4кБ.</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># dd if=/dev/random of=/root/da2.key bs=64 count=1</span>
<span class=c># geli init -s 4096 -K /root/da2.key /dev/da2</span>
Enter new passphrase:
Reenter new passphrase:</code></pre></div></div><div class=paragraph><p>Использование одновременно кодовой фразы и ключевого файла не обязательно: любой из этих методов защиты главного ключа может применяться независимо.</p></div><div class=paragraph><p>Если в качестве имени ключевого файла указан "-", используется стандартный ввод. Это позволяет использовать более одного ключевого файла:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># cat keyfile1 keyfile2 keyfile3 | geli init -K - /dev/da2</span></code></pre></div></div></li><li><p>Свяжите сгенерированный ключ с провайдером</p><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># geli attach -k /root/da2.key /dev/da2</span>
Enter passphrase:</code></pre></div></div><div class=paragraph><p>Созданный при этом файл дискового устройства будет называться <span class=filename>/dev/da2.eli</span>.</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># ls /dev/da2*</span>
/dev/da2  /dev/da2.eli</code></pre></div></div></li><li><p>Создайте новую файловую систему</p><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># dd if=/dev/random of=/dev/da2.eli bs=1m</span>
<span class=c># newfs /dev/da2.eli</span>
<span class=c># mount /dev/da2.eli /private</span></code></pre></div></div><div class=paragraph><p>Зашифрованная файловая система будет видна в выводе утилиты <a href="https://man.freebsd.org/cgi/man.cgi?query=df&amp;sektion=1&amp;format=html">df(1)</a> и готова к использованию:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># df -H</span>
Filesystem     Size   Used  Avail Capacity  Mounted on
/dev/ad0s1a    248M    89M   139M    38%    /
/devfs         1.0K   1.0K     0B   100%    /dev
/dev/ad0s1f    7.7G   2.3G   4.9G    32%    /usr
/dev/ad0s1d    989M   1.5M   909M     0%    /tmp
/dev/ad0s1e    3.9G   1.3G   2.3G    35%    /var
/dev/da2.eli   150G   4.1K   138G     0%    /private</code></pre></div></div></li><li><p>Размонтирование и деактивация провайдера</p><div class=paragraph><p>После завершения работы с шифрованным разделом, когда содержимое каталога <span class=filename>/private</span> больше не нужно, будет разумным отключить раздел от системы.</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># umount /private</span>
<span class=c># geli detach da2.eli</span></code></pre></div></div></li></ol></div></div></div><div class=paragraph><p>Дополнительную информацию о <a href="https://man.freebsd.org/cgi/man.cgi?query=geli&amp;sektion=8&amp;format=html">geli(8)</a> можно найти на соответствующей странице справочника.</p></div><div class=sect3><h4 id=_использование_стартового_скрипта_rc_d_geli>17.16.2.1. Использование стартового скрипта <span class=filename>rc.d</span> <span class=filename>geli</span><a class=anchor href=#_использование_стартового_скрипта_rc_d_geli></a></h4><div class=paragraph><p>Для удобства использования подсистемы <code>geli</code> в комплект базовой системы FreeBSD входит стартовый скрипт, работой которого можно управлять из <a href="https://man.freebsd.org/cgi/man.cgi?query=rc.conf&amp;sektion=5&amp;format=html">rc.conf(5)</a>:</p></div><div class="literalblock programlisting"><div class=content><pre>geli_devices=&#34;da2&#34;
geli_da2_flags=&#34;-p -k /root/da2.key&#34;</pre></div></div><div class=paragraph><p>При этом дисковый раздел <span class=filename>/dev/da2</span> будет сконфигурирован как провайдер <code>geli</code>, связан с ключевым файлом <span class=filename>/root/da2.key</span>, а кодовая фраза не будет использоваться (отметим, что это возможно только в том случае, если при инициализации <code>geli init</code> был указан ключ <code>-P</code>). Шифрованный провайдер <code>geli</code> будет отсоединен перед выключением системы.</p></div><div class=paragraph><p>Дополнительную информацию о конфигурации скриптов <span class=filename>rc.d</span> можно найти в соответствующей <a href=../config/#configtuning-rcd>главе</a> Руководства.</p></div></div></div></div></div><div class=sect1><h2 id=swap-encrypting>17.17. Шифрование области подкачки<a class=anchor href=#swap-encrypting></a></h2><div class=sectionbody><div class=paragraph><p>Шифрование области подкачки в FreeBSD достаточно легко конфигурируется. Варианты конфигурации слегка различаются в зависимости от версии системы. Для шифрования разделов подкачки можно использовать утилиты <a href="https://man.freebsd.org/cgi/man.cgi?query=gbde&amp;sektion=8&amp;format=html">gbde(8)</a> или <a href="https://man.freebsd.org/cgi/man.cgi?query=geli&amp;sektion=8&amp;format=html">geli(8)</a>;. В обоих случаях используется скрипт <a href=../config/#configtuning-rcd>rc.d</a> <span class=filename>encswap</span>.</p></div><div class=paragraph><p>Предыдущий раздел, <a href=#disks-encrypting>Шифрование дисковых разделов</a>, кратко описывает различные методы криптования.</p></div><div class=sect2><h3 id=_зачем_шифровать_область_подкачки>17.17.1. Зачем шифровать область подкачки?<a class=anchor href=#_зачем_шифровать_область_подкачки></a></h3><div class=paragraph><p>Как и в случае дисковых разделов, шифрование области подкачки применяется для защиты важной информации. Возьмем, к примеру, приложение, которому требуется работать с паролями. До тех пор, пока пароли хранятся в физической памяти, все в порядке. Если же операционная система начинает выгружать отдельные участки памяти в область подкачки, чтобы освободить память для других приложений, пароли могут быть записаны на диск в открытом виде и тем самым оказаться легко доступными злоумышленнику (имеющему физический доступ к диску - прим. пер.). В таких ситуациях решением может стать шифрование раздела подкачки.</p></div></div><div class=sect2><h3 id=_подготовка>17.17.2. Подготовка<a class=anchor href=#_подготовка></a></h3><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>В данном разделе мы будем считать, что разделом подкачки является <span class=filename>ad0s1b</span>.</p></div></td></tr></tbody></table></div><div class=paragraph><p>До настоящего момента раздел подкачки не был зашифрован. Таким образом, на нем могут содержаться пароли или какая-либо иная важная информация в открытом виде. Чтобы избавиться от этого, заполним раздел подкачки случайными данными:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># dd if=/dev/random of=/dev/ad0s1b bs=1m</span></code></pre></div></div></div><div class=sect2><h3 id=_шифрование_раздела_подкачки_при_помощи_gbde8>17.17.3. Шифрование раздела подкачки при помощи <a href="https://man.freebsd.org/cgi/man.cgi?query=gbde&amp;sektion=8&amp;format=html">gbde(8)</a><a class=anchor href=#_шифрование_раздела_подкачки_при_помощи_gbde8></a></h3><div class=paragraph><p>В строку файла <span class=filename>/etc/fstab</span>, описывающую раздел подкачки, необходимо добавить суффикс <code>.bde</code>:</p></div><div class="literalblock programlisting"><div class=content><pre># Device                Mountpoint      FStype  Options         Dump    Pass#
/dev/ad0s1b.bde         none            swap    sw              0       0</pre></div></div></div><div class=sect2><h3 id=_шифрование_раздела_подкачки_при_помощи_geli8>17.17.4. Шифрование раздела подкачки при помощи <a href="https://man.freebsd.org/cgi/man.cgi?query=geli&amp;sektion=8&amp;format=html">geli(8)</a><a class=anchor href=#_шифрование_раздела_подкачки_при_помощи_geli8></a></h3><div class=paragraph><p>Процедура при использовании <a href="https://man.freebsd.org/cgi/man.cgi?query=geli&amp;sektion=8&amp;format=html">geli(8)</a> для шифрования раздела подкачки сходна с использованием <a href="https://man.freebsd.org/cgi/man.cgi?query=gbde&amp;sektion=8&amp;format=html">gbde(8)</a>. В строку файла <span class=filename>/etc/fstab</span>, описывающую раздел подкачки, нужно добавить суффикс <code>.eli</code>:</p></div><div class="literalblock programlisting"><div class=content><pre># Device                Mountpoint      FStype  Options         Dump    Pass#
/dev/ad0s1b.eli         none            swap    sw              0       0</pre></div></div><div class=paragraph><p>По умолчанию, <a href="https://man.freebsd.org/cgi/man.cgi?query=geli&amp;sektion=8&amp;format=html">geli(8)</a> использует алгоритм криптования AES с длиной ключа 256 бит.</p></div><div class=paragraph><p>При необходимости эти параметры могут быть изменены в опции <code>geli_swap_flags</code> файла конфигурации <span class=filename>/etc/rc.conf</span>. Приведенная ниже строка указывает, что скрипт rc.d <span class=filename>encswap</span> должен использовать для криптования алгоритм Blowfish с ключом длиной 128 бит, размером сектора 4 килобайта и включенной опцией "отсоединиться при последнем закрытии":</p></div><div class="literalblock programlisting"><div class=content><pre>geli_swap_flags=&#34;-e blowfish -l 128 -s 4096 -d&#34;</pre></div></div><div class=paragraph><p>За списком возможных опций обращайтесь к описанию команды <code>onetime</code> в странице справочника <a href="https://man.freebsd.org/cgi/man.cgi?query=geli&amp;sektion=8&amp;format=html">geli(8)</a>.</p></div></div><div class=sect2><h3 id=_окончательная_проверка>17.17.5. Окончательная проверка<a class=anchor href=#_окончательная_проверка></a></h3><div class=paragraph><p>После перезагрузки системы правильность работы шифрованного раздела подкачки может быть проверена при помощи команды <code>swapinfo</code>.</p></div><div class=paragraph><p>В случае использования <a href="https://man.freebsd.org/cgi/man.cgi?query=gbde&amp;sektion=8&amp;format=html">gbde(8)</a>:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>% swapinfo
Device          1K-blocks     Used    Avail Capacity
/dev/ad0s1b.bde    542720        0   542720     0%</code></pre></div></div><div class=paragraph><p>При использовании <a href="https://man.freebsd.org/cgi/man.cgi?query=geli&amp;sektion=8&amp;format=html">geli(8)</a>:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>% swapinfo
Device          1K-blocks     Used    Avail Capacity
/dev/ad0s1b.eli    542720        0   542720     0%</code></pre></div></div></div></div></div></div><hr><div class=last-modified><p><strong>Изменено</strong>: 9 марта 2024 г. by <a href="https://cgit.freebsd.org/doc/commit/?id=6199af92e7" target=_blank>Danilo G. Baio</a></p></div><div class=buttons><div class=prev><i class="fa fa-angle-left" aria-hidden=true title=Назад></i><div class=container><a href=https://docs.freebsd.org/ru/books/handbook/audit class=direction>Назад</a></div></div><div class=home><i class="fa fa-home" aria-hidden=true title=Главная></i><div class=container><a href=../ class=direction>Главная</a></div></div><div class=next><div class=container><a href=https://docs.freebsd.org/ru/books/handbook/geom class=direction>Далее</a></div><i class="fa fa-angle-right" aria-hidden=true title=Далее></i></div></div><label class="hidden book-menu-overlay" for=menu-control></label></div><aside class=toc><div class=toc-content><h3>Содержание</h3><nav id=TableOfContents><ul><li><a href=#disks-synopsis>17.1. Краткий обзор</a></li><li><a href=#disks-naming>17.2. Имена устройств</a></li><li><a href=#disks-adding>17.3. Добавление дисков</a></li><li><a href=#raid>17.4. RAID</a></li><li><a href=#usb-disks>17.5. USB устройства хранения</a></li><li><a href=#creating-cds>17.6. Запись и использование оптических носителей (CD)</a></li><li><a href=#creating-dvds>17.7. Создание и использование оптических носителей (DVD)</a></li><li><a href=#floppies>17.8. Дискеты</a></li><li><a href=#backups-tapebackups>17.9. Создание и использование архивных копий на магнитной ленте</a></li><li><a href=#backups-floppybackups>17.10. Создание резервных копий на дискетах</a></li><li><a href=#backup-strategies>17.11. Стратегии резервного копирования</a></li><li><a href=#backup-basics>17.12. Основы технологии резервного копирования</a></li><li><a href=#disks-virtual>17.13. Сетевые файловые системы, файловые системы в памяти и с отображением в файл</a></li><li><a href=#snapshots>17.14. Мгновенные копии файловых систем</a></li><li><a href=#quotas>17.15. Квотирование файловых систем</a></li><li><a href=#disks-encrypting>17.16. Шифрование дисковых разделов</a></li><li><a href=#swap-encrypting>17.17. Шифрование области подкачки</a></li></ul></nav><hr><div class=resources><h3>Материалы</h3><ul class=contents><li><i class="fa fa-file-pdf-o" aria-hidden=true title="Скачать PDF"></i><a href=https://download.freebsd.org/doc/ru/books/handbook/handbook_ru.pdf>Скачать PDF</a></li><li><i class="fa fa-pencil-square-o" aria-hidden=true title="Редактировать эту страницу"></i><a href=https://github.com/freebsd/freebsd-doc/blob/main/documentation/content/ru/_index target=_blank>Редактировать эту страницу</a></li></ul></div></div></aside><a class=to-top href=#top><i class="fa fa-arrow-circle-up" aria-hidden=true></i></a></main><footer><div class=footer-container><section class=logo-column><img src=https://docs.freebsd.org/images/FreeBSD-colors.svg width=160 height=50 alt="FreeBSD logo"><div class=options-container><div class=language-container><a id=languages href=https://docs.freebsd.org/ru/languages><img src=https://docs.freebsd.org/images/language.png class=language-image alt="Выберите язык">
<span>Русский</span></a></div><div class=theme-container><select id=theme-chooser><option value=theme-system>Система</option><option value=theme-light>Светлый</option><option value=theme-dark>Тёмный</option><option value=theme-high-contrast>Высокая контрастность</option></select></div></div></section><section class=about-column><h3 class=column-title>О нас</h3><ul class=column-elements-container><li><a href=https://www.freebsd.org/about/ target=_blank class=column-element>FreeBSD</a></li><li><a href=https://freebsdfoundation.org/ target=_blank class=column-element>Фонд FreeBSD</a></li><li><a href=https://www.freebsd.org/where/ target=_blank class=column-element>Получить FreeBSD</a></li><li><a href=https://www.freebsd.org/internal/code-of-conduct target=_blank class=column-element>Кодекс Этики</a></li><li><a href=https://www.freebsd.org/security/ target=_blank class=column-element>Бюллетени Безопасности</a></li></ul></section><section class=documentation-column><h3 class=column-title>Документация</h3><ul class=column-elements-container><li><a href=/ru class=column-element>Портал документации</a></li><li><a href=https://man.FreeBSD.org target=_blank class=column-element>Страницы Справочника</a></li><li><a href=https://papers.FreeBSD.org target=_blank class=column-element>Презентации и публикации</a></li><li><a href=https://docs-archive.freebsd.org/doc/ target=_blank class=column-element>Предыдущие версии</a></li><li><a href=https://docs-archive.freebsd.org/44doc/ target=_blank class=column-element>Документы 4.4BSD</a></li><li><a href=https://wiki.freebsd.org/ target=_blank class=column-element>Wiki</a></li></ul></section><section class=community-column><h3 class=column-title>Сообщество</h3><ul class=column-elements-container><li><a href=https://docs.freebsd.org/ru/articles/contributing class=column-element>Принять участие</a></li><li><a href=https://forums.freebsd.org/ target=_blank class=column-element>Форум Сообщества</a></li><li><a href=https://lists.freebsd.org/ target=_blank class=column-element>Списки рассылки</a></li><li><a href=https://wiki.freebsd.org/IRC/Channels target=_blank class=column-element>Каналы IRC</a></li><li><a href=https://bugs.freebsd.org/bugzilla/ target=_blank class=column-element>Трекер ошибок</a></li></ul></section><section class=legal-column><h3 class=column-title>Юридическая информация</h3><ul class=column-elements-container><li><a href=https://freebsdfoundation.org/donate/ target=_blank class=column-element>Пожертвования</a></li><li><a href=https://www.freebsd.org/copyright/freebsd-license/ target=_blank class=column-element>Лицензирование</a></li><li><a href=https://www.freebsd.org/privacy/ target=_blank class=column-element>Политика Конфиденциальности</a></li><li><a href=https://www.freebsd.org/copyright/ target=_blank class=column-element>Юридические оговорки</a></li></ul></section><section class=copyright-column><p>&copy; 1994-2024 Проект FreeBSD. Все права защищены</p><span>Сделано с помощью <span class=heart>♥</span> Сообществом FreeBSD</span></section></div></footer></body></html>