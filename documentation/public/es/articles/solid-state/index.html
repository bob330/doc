<!doctype html><html class=theme-light lang=es><head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="El uso de discos de estado sólido en FreeBSD"><meta name=keywords content="Solid State,embedded,FreeBSD"><meta name=copyright content="1995-2024 The FreeBSD Foundation"><link rel=canonical href=http://172.16.201.134:1313/es/articles/solid-state/><title>FreeBSD y los Dispositivos de Estado Sólido (SSD) | Portal de documentación de FreeBSD</title>
<meta name=theme-color content="#790000"><meta name=color-scheme content="system light dark high-contrast"><link rel="shortcut icon" href=http://172.16.201.134:1313/favicon.ico><link rel=stylesheet href=http://172.16.201.134:1313/styles/main.min.css><link rel=stylesheet href=http://172.16.201.134:1313/css/font-awesome-min.css><script defer src=/js/theme-chooser.min.js></script><script defer src=/js/copy-clipboard.min.js></script><script defer src=/js/search.min.js></script><meta name=twitter:card content="summary"><meta name=twitter:domain content="docs.FreeBSD.org"><meta name=twitter:site content="@freebsd"><meta name=twitter:url content="https://twitter.com/freebsd"><meta property="og:title" content="FreeBSD y los Dispositivos de Estado Sólido (SSD)"><meta property="og:description" content="El uso de discos de estado sólido en FreeBSD"><meta property="og:type" content="website"><meta property="og:image" content="http://172.16.201.134:1313/favicon.ico"><meta property="og:image:alt" content="FreeBSD Logo"><meta property="og:locale" content="es"><meta property="og:url" content="http://172.16.201.134:1313/es/articles/solid-state/"><meta property="og:site_name" content="Portal de documentación de FreeBSD"><script type=application/ld+json>{"@context":"http://schema.org","@type":"Article","url":"http:\/\/172.16.201.134:1313\/es\/articles\/solid-state\/","name":"Portal de documentación de FreeBSD","headline":"Portal de documentación de FreeBSD","description":"FreeBSD Documentation Portal"}</script></head><body><header><div class=header-container><div class=logo-menu-bars-container><a href=https://www.FreeBSD.org class=logo><img src=http://172.16.201.134:1313/images/FreeBSD-monochromatic.svg width=160 height=50 alt="FreeBSD logo">
</a><label class=menu-bars for=menu-bars><i class="fa fa-bars" aria-hidden=true></i></label></div><input id=menu-bars type=checkbox><nav><ul class=menu><li class=menu-item><input id=about type=checkbox>
<a href=# aria-label="Navigate to About section"><label class=menu-item-description for=about>About
<i class="fa fa-angle-down fa-lg" aria-hidden=true></i></label></a><ul class=sub-menu><li class=title><a href=https://www.freebsd.org/about/ target=_blank>About</a></li><li><a href=https://www.freebsd.org/about/ target=_blank>FreeBSD</a></li><li><a href=https://freebsdfoundation.org/about-us/about-the-foundation/ target=_blank>FreeBSD Foundation</a></li><li><a href=https://www.freebsd.org/internal/code-of-conduct/ target=_blank>Code of Conduct</a></li></ul></li><li class=menu-item><input id=download type=checkbox>
<a href=# aria-label="Navigate to get FreeBSD section"><label class=menu-item-description for=download>Get FreeBSD
<i class="fa fa-angle-down fa-lg" aria-hidden=true></i></label></a><ul class=sub-menu><li class=title><a href=https://www.freebsd.org/where/ target=_blank>Get FreeBSD</a></li><li><a href=https://www.freebsd.org/releases/ target=_blank>Release Information</a></li><li><a href=https://www.freebsd.org/releng/ target=_blank>Release Engineering</a></li><li><a href=https://www.freebsd.org/security/ target=_blank>Security Advisories</a></li></ul></li><li class=menu-item><input id=documentation type=checkbox>
<a href=# aria-label="Navigate to get Documentation section"><label class=menu-item-description for=documentation>Documentation
<i class="fa fa-angle-down fa-lg" aria-hidden=true></i></label></a><ul class=sub-menu><li class=title><a href=/es>Documentation portal</a></li><li><a href=http://172.16.201.134:1313/es/books/handbook>FreeBSD Handbook</a></li><li><a href=http://172.16.201.134:1313/es/books/porters-handbook>Porter's Handbook</a></li><li><a href=https://docs.FreeBSD.org/en/books/fdp-primer>Documentation Project Handbook</a></li><li><a href=https://man.FreeBSD.org target=_blank>Manual pages</a></li><li><a href=https://papers.FreeBSD.org target=_blank>Presentations and papers</a></li><li><a href=https://wiki.FreeBSD.org target=_blank>Wiki</a></li><li><a href=http://172.16.201.134:1313/es/books>Books</a></li><li><a href=http://172.16.201.134:1313/es/articles>Articles</a></li></ul></li><li class=menu-item><input id=community type=checkbox>
<a href=# aria-label="Navigate to get Community section"><label class=menu-item-description for=community>Community
<i class="fa fa-angle-down fa-lg" aria-hidden=true></i></label></a><ul class=sub-menu><li class=title><a href=https://www.freebsd.org/community/>Community</a></li><li><a href=http://172.16.201.134:1313/es/articles/contributing>Get involved</a></li><li><a href=https://forums.freebsd.org/ target=_blank>Forum</a></li><li><a href=https://lists.freebsd.org/ target=_blank>Mailing lists</a></li><li><a href=https://wiki.freebsd.org/IRC/Channels target=_blank>IRC Channels</a></li><li><a href=https://bugs.freebsd.org/bugzilla/ target=_blank>Bug Tracker</a></li><li><a href=https://www.freebsd.org/support/ target=_blank>Support</a></li></ul></li></ul></nav><div class=search-donate-container><form class=search method=get id=search-header-form action=https://docs.freebsd.org/search name=search-header-form><input type=hidden name=DB value=es>
<input id=words name=P type=text size=20 maxlength=255>
<button>
<i class="fa fa-search" aria-hidden=true></i></button></form><div class=donate><a href=https://freebsdfoundation.org/donate/ target=_blank><span class=heart>♥</span>
Donate</a></div></div></div></header><main class=main-wrapper-article><div class=article><h1 class=title>FreeBSD y los Dispositivos de Estado Sólido (SSD)</h1><div class="admonitionblock note"><p><i class="fa fa-exclamation-circle" aria-hidden=true></i>
This translation may be out of date. To help with the translations please access the <a href=https://translate-dev.freebsd.org/ target=_blank>FreeBSD translations instance</a>.</p></div><div class=copyright>Copyright © 2001 - 2021 The FreeBSD Documentation Project</div><div class=legalnotice><a id=trademarks></a><details><summary>Marcas registradas</summary><p>FreeBSD es una marca registrada de la Fundación FreeBSD</p><p>Muchos de los nombres usados por los fabricantes y vendedores para diferenciar sus productos son designados como marcas comerciales. Allí donde estos nombres aparezcan en este documento y el Proyecto FreeBSD fuera consciente de la alegación de marca comercial, los nombres tienen a continuación el símbolo “™” o “®”.</p></details></div><div class=toc-mobile><h3>Tabla de contenidos</h3><nav id=TableOfContents><ul><li><a href=#intro>1. Dispositivos de Disco de Estado Sólido</a></li><li><a href=#kernel>2. Opciones del Kernel</a></li><li><a href=#ro-fs>3. El Subsistema <code>rc</code> y los Sistemas de ficheros de Solo Lectura</a></li><li><a href=#_construyendo_un_sistema_de_archivos_desde_cero>4. Construyendo un Sistema de Archivos Desde Cero</a></li><li><a href=#strategies>5. Estrategias para Entornos Pequeños y de Solo Lectura</a></li></ul></nav></div><div id=preamble><div class=sectionbody><div class="paragraph abstract-title"><p>Resumen</p></div><div class=paragraph><p>Este artículo trata sobre el uso de discos de estado sólido en FreeBSD para crear sistemas embebidos.</p></div><div class=paragraph><p>Los sistemas embebidos tienen la ventaja de una mayor estabilidad por la falta de partes móviles (discos duros). Sin embargo, se debe tener en cuenta que generalmente el espacio disponible para el sistema y la durabilidad del medio de almacenamiento son menores.</p></div><div class=paragraph><p>Los temas específicos que se abordarán incluyen los tipos y atributos de los dispositivos de estado sólido adecuados para su uso como disco en FreeBSD, las opciones del kernel que son interesantes para dicho entorno, los mecanismos de <span class=filename>rc.initdiskless</span> que automatizan el inicio de dichos sistemas, la necesidad de sistemas de archivos de solo lectura y hacer sistemas de archivos desde cero. El artículo concluirá con algunas estrategias generales para entornos pequeños y de solo lectura de FreeBSD.</p></div><hr></div></div><div class=sect1><h2 id=intro>1. Dispositivos de Disco de Estado Sólido<a class=anchor href=#intro></a></h2><div class=sectionbody><div class=paragraph><p>El alcance de este artículo se limitará a dispositivos de estado sólido basados en memoria flash. La memoria flash es una memoria de estado sólido (sin partes móviles) que no es volátil (la memoria mantiene los datos incluso después de que se hayan desconectado todas las fuentes de alimentación). La memoria flash puede soportar un enorme impacto físico y es bastante rápida (las soluciones de memoria flash que se tratan en este artículo son un poco más lentas que un disco duro EIDE en operaciones de escritura y mucho más rápidos en operaciones de lectura). Un aspecto muy importante de la memoria flash, cuyas repercusiones se tratarán más adelante, es que cada sector tiene una capacidad de reescritura limitada. Solo puede escribir, borrar y volver a escribir en un sector de la memoria flash varias veces antes de que quede permanentemente inutilizable. Aunque muchos productos de memoria flash mapean automáticamente los bloques defectuosos y algunos incluso distribuyen las operaciones de escritura de manera uniforme en toda la unidad, la verdad es que hay un límite en la cantidad de escrituras que se pueden hacer al dispositivo. Las unidades más competitivas tienen entre 1.000.000 y 10.000.000 millones de escrituras por sector en sus especificaciones. Esta cifra varía debido a la temperatura del ambiente.</p></div><div class=paragraph><p>Específicamente, discutiremos las unidades flash compactas compatibles con ATA, las cuales son bastante populares como medios de almacenamiento para cámaras digitales. Es de particular interés el hecho de que se conecten directamente al bus IDE y sean compatibles con el conjunto de comandos ATA. Por lo tanto, con un adaptador muy simple y de bajo coste, estos dispositivos se pueden conectar directamente al bus IDE en un ordenador. Una vez implementado de esta forma, los sistemas operativos como FreeBSD ven el dispositivo como un disco duro normal (aunque sea pequeño).</p></div><div class=paragraph><p>Existen otras soluciones de disco de estado sólido, pero su coste, opacidad y su relativa dificultad de uso los colocan más allá del alcance de este artículo.</p></div></div></div><div class=sect1><h2 id=kernel>2. Opciones del Kernel<a class=anchor href=#kernel></a></h2><div class=sectionbody><div class=paragraph><p>Algunas opciones del kernel son de especial interés para aquellos que crean un sistema FreeBSD embebido.</p></div><div class=paragraph><p>Todos los sistemas FreeBSD embebidos que usen memoria flash como disco del sistema estarán interesados en los discos y sistemas de fichero en memoria. Como resultado del limitado número de escrituras que se pueden hacer a la memoria flash, el disco y los sistemas de fichero del disco se montarán seguramente como solo lectura. En este entornos, sistemas de ficheros como <span class=filename>/tmp</span> y <span class=filename>/var</span> se montan como sistemas de fichero en memoria para permitir que el sistema cree logs y actualice contadores y ficheros temporales. Los sistemas de ficheros en memoria son un componente crítico para una implementación de estado sólido exitosa en FreeBSD.</p></div><div class=paragraph><p>Deberías asegurarte de que las siguientes líneas están en el fichero de configuración de tu kernel:</p></div><div class="literalblock programlisting"><div class=content><pre>options         MFS             # Memory Filesystem
options         MD_ROOT         # md device usable as a potential root device
pseudo-device   md              # memory disk</pre></div></div></div></div><div class=sect1><h2 id=ro-fs>3. El Subsistema <code>rc</code> y los Sistemas de ficheros de Solo Lectura<a class=anchor href=#ro-fs></a></h2><div class=sectionbody><div class=paragraph><p>La inicialización posterior al arranque de un sistema FreeBSD embebido es controlada por <span class=filename>/etc/rc.initdiskless</span>.</p></div><div class=paragraph><p><span class=filename>/etc/rc.d/var</span> monta <span class=filename>/var</span> como un sistema de ficheros en memoria, crea una lista configurable de directorios en <span class=filename>/var</span> con el comando <a href="https://man.freebsd.org/cgi/man.cgi?query=mkdir&amp;sektion=1&amp;format=html">mkdir(1)</a>, y cambia los modos de algunos de esos directorios. En la ejecución de <span class=filename>/etc/rc.d/var</span>, otra variable de <span class=filename>rc.conf</span> entra en juego - <code>varsize</code>. Una partición <span class=filename>/var</span> es creada por <span class=filename>/etc/rc.d/var</span> basándose en el valor de esta variable en <span class=filename>rc.conf</span>:</p></div><div class="literalblock programlisting"><div class=content><pre>varsize=8192</pre></div></div><div class=paragraph><p>Recuerda que por defecto este valor está en sectores.</p></div><div class=paragraph><p>El hecho de que <span class=filename>/var</span> sea un sistema de archivos de lectura y escritura es una distinción importante, ya que la partición <span class=filename>/</span> (y cualquier otra partición que puedas tener en tu medio flash) se debe montar como solo lectura. Recuerda que en <a href=#intro>Dispositivos de Disco de Estado Sólido</a> detallamos las limitaciones de la memoria flash, específicamente, la capacidad de escritura limitada. La importancia de no montar sistemas de archivos en medios flash de lectura-escritura, y la importancia de no usar swap, no es exagerada. Un archivo swap en un sistema concurrido puede deteriorar un medio flash en menos de un año. Un logging intenso o la creación y destrucción de archivos temporales puede hacer lo mismo. Por lo tanto, además de quitar la entrada <code>swap</code> de tu <span class=filename>/etc/fstab</span>, también deberías cambiar el campo Options para cada sistema de archivos a <code>ro</code> de la siguiente forma:</p></div><div class="literalblock programlisting"><div class=content><pre># Device                Mountpoint      FStype  Options         Dump    Pass#
/dev/ad0s1a             /               ufs     ro              1       1</pre></div></div><div class=paragraph><p>Algunas aplicaciones en el sistema comenzarán a fallar inmediatamente como resultado de este cambio. Por ejemplo, cron no se ejecutará correctamente al faltar las cron tabs en <span class=filename>/var</span> creadas por <span class=filename>/etc/rc.d/var</span>, además, syslog y dhcp encontrarán problemas como resultado de montar el sistema de archivos como solo lectura y la falta de elementos en <span class=filename>/var</span> que ha creado <span class=filename>/etc/rc.d/var</span>. Sin embargo, esto son solo problemas temporales y se tratan, junto con las soluciones para la ejecución de otros programas de uso común en <a href=#strategies>Estrategias para Entornos Pequeños y de Solo Lectura</a>.</p></div><div class=paragraph><p>Una cosa importante a recordar es que un sistema de archivos que fue montado como solo lectura con <span class=filename>/etc/fstab</span> puede ser montado como lectura-escrita en cualquier momento ejecutando el comando:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># /sbin/mount -uw partition</span></code></pre></div></div><div class=paragraph><p>y se puede cambiar de nuevo a solo lectura con el comando:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># /sbin/mount -ur partition</span></code></pre></div></div></div></div><div class=sect1><h2 id=_construyendo_un_sistema_de_archivos_desde_cero>4. Construyendo un Sistema de Archivos Desde Cero<a class=anchor href=#_construyendo_un_sistema_de_archivos_desde_cero></a></h2><div class=sectionbody><div class=paragraph><p>Como las tarjetas flash compactas compatibles con ATA son vistas por FreeBSD como discos duros IDE normales, en teoría podrías instalar FreeBSD desde una red usando los disquetes kern y mfsroot o desde un CD.</p></div><div class=paragraph><p>Sin embargo, incluso una instalación pequeña de FreeBSD usando el procedimiento normal de instalación puede producir un sistema de tamaño superior a los 200 megabytes. La mayoría de la gente usará memorias flash menores (128 megabytes se considera bastante grande - 32 o incluso 16 megabytes es bastante común), de forma que una instalación utilizando mecanismos normales no es posible - simplemente no hay suficiente espacio en disco incluso para la más pequeña de las instalaciones convencionales.</p></div><div class=paragraph><p>La forma más fácil de superar esta limitación de espacio es instalar FreeBSD utilizando medios convencionales en un disco duro normal. Una vez finalizada la instalación, reduce el sistema operativo a un tamaño que se ajuste a tu medio flash, y comprime el sistema de archivos completo en un fichero tar. Los siguientes pasos te guiarán en el proceso de preparación de una memoria flash para tu sistema de archivos comprimido en un fichero tar. Recuerda que no estamos ejecutando una instalación normal, luego las operaciones como particionado, etiquetado, creación del sistema de archivos, etc. deben ejecutarse manualmente. Además de los disquetes kern y mfsroot, también necesitarás usar el disquete fixit.</p></div><div class="exampleblock procedure"><div class=content><div class="olist arabic"><ol class=arabic><li><p>Particionando Tu Dispositivo Flash</p><div class=paragraph><p>Después de arrancar con los disquetes kern y mfsroot, selecciona <code>custom</code> en el menú de instalación. En el menú de instalación personalizado, selecciona <code>partition</code>. En el menú de particiones, debe borrar todas las particiones existentes mediante la tecla <kbd>d</kbd>. Después de eliminar todas las particiones existentes, crea una partición utilizando la tecla <kbd>c</kbd> y acepta el valor predeterminado para el tamaño de la partición. Cuando se te pregunte el tipo de partición, asegúrate de que el valor esté establecido en <code>165</code>. Ahora escribe la tabla de particiones en el disco presionando <kbd>w</kbd> (es una opción oculta en esta pantalla). Si estás utilizando una tarjeta compact flash compatible con ATA, debes elegir el FreeBSD Boot Manager. Ahora presiona <kbd>q</kbd> para salir del menú de partición. Verás de nuevo el menú del gestor de arranque - repite la opción hecha anteriormente.</p></div></li><li><p>Creación de Sistemas de Archivos en Tu Dispositivo de Memoria Flash</p><div class=paragraph><p>Sal del menú de instalación personalizada, y desde el menú principal de instalación escoge la opción <code>fixit</code>. Después de entrar en el entorno fixit, introduce el siguiente comando:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># disklabel -e /dev/ad0c</span></code></pre></div></div><div class=paragraph><p>En este punto, habrás accedido al editor vi guiado por el comando disklabel. A continuación, debes agregar una línea <code>a:</code> al final del archivo. La línea <code>a:</code> debería ser similar a la siguiente:</p></div><div class="literalblock programlisting"><div class=content><pre>a:      123456  0       4.2BSD  0       0</pre></div></div><div class=paragraph><p>Donde <em>123456</em> es un número que es exactamente el mismo número en la entrada <code>c:</code> existente para el tamaño. Básicamente estás duplicando la línea <code>c:</code> existente como una línea <code>a:</code>, asegurándote de que el fstype es <code>4.2BSD</code>. Salva el fichero y sal.</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># disklabel -B -r /dev/ad0c</span>
<span class=c># newfs /dev/ad0a</span></code></pre></div></div></li><li><p>Colocando Tu Sistema de Archivos en el Medio Flash</p><div class=paragraph><p>Monta el medio flash recién preparado:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># mount /dev/ad0a /flash</span></code></pre></div></div><div class=paragraph><p>Coloca esta máquina en la red para poder transferir nuestro archivo tar y extraerlo en nuestro sistema de archivos del medio flash. Un ejemplo de cómo hacerlo es:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># ifconfig xl0 192.168.0.10 netmask 255.255.255.0</span>
<span class=c># route add default 192.168.0.1</span></code></pre></div></div><div class=paragraph><p>Ahora que la máquina está en la red, transfiere tu archivo tar. Es posible que te enfrentes a un pequeño dilema en este punto - si tu memoria flash tiene por ejemplo 128 megabytes, y tu archivo tar tiene más de 64 megabytes, no podrás tener el archivo tar en el medio de flash al mismo tiempo que realizas la descompresión - te quedarás sin espacio. Una solución a este problema, si estás utilizando FTP, es descomprimir el archivo mientras se transfiere por FTP. Si realizas la transferencia de esta forma, nunca tendrás el archivo tar y los contenidos en el disco al mismo tiempo:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>ftp&gt; get tarfile.tar <span class=s2>&#34;| tar xvf -&#34;</span></code></pre></div></div><div class=paragraph><p>Si tu archivo tar está comprimido con gzip, puedes hacerlo de esta forma:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>ftp&gt; get tarfile.tar <span class=s2>&#34;| zcat | tar xvf -&#34;</span></code></pre></div></div><div class=paragraph><p>Una vez que el contenido de tu sistema de archivos comprimido por tar está en el sistema de archivos de la memoria flash, puedes desmontar la memoria flash y reiniciar:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># cd /</span>
<span class=c># umount /flash</span>
<span class=c># exit</span></code></pre></div></div><div class=paragraph><p>Suponiendo que configuraste correctamente tu sistema de archivos cuando lo construiste en tu disco duro normal, (con tus sistemas de archivos montados en modo solo lectura, y con las opciones necesarias compiladas en el kernel) ahora se deberías iniciar con éxito tu sistema embebido FreeBSD.</p></div></li></ol></div></div></div></div></div><div class=sect1><h2 id=strategies>5. Estrategias para Entornos Pequeños y de Solo Lectura<a class=anchor href=#strategies></a></h2><div class=sectionbody><div class=paragraph><p>En <a href=#ro-fs>El Subsistema <code>rc</code> y los Sistemas de ficheros de Solo Lectura</a>, se indicó que el sistema de archivos <span class=filename>/var</span> construido por <span class=filename>/etc/rc.d/var</span> y la presencia de un sistema de archivos raíz montado en modo solo lectura causa problemas con muchos paquetes de software utilizados en FreeBSD. En este artículo, se proporcionarán sugerencias para ejecutar con éxito cron, syslog, la instalación de ports y el servidor web Apache.</p></div><div class=sect2><h3 id=_cron>5.1. Cron<a class=anchor href=#_cron></a></h3><div class=paragraph><p>Durante el arranque, <span class=filename>/etc/rc.d/var</span> puebla <span class=filename>/var</span> usando la lista de <span class=filename>/etc/mtree/BSD.var.dist</span>, de forma que se crean <span class=filename>cron</span>, <span class=filename>cron/tabs</span>, <span class=filename>at</span>, y otros pocos directorios estándar.</p></div><div class=paragraph><p>Sin embargo, esto no resuelve el problema de mantener las cron tabs entre los reinicios. Cuando el sistema se reinicie, el sistema de archivos <span class=filename>/var</span> cargado en memoria desaparecerá y todas las cron tabs que tenga también desaparecerán. Por lo tanto, una solución sería crear las cron tabs para los usuarios que las necesiten; monta tu sistema de archivos raíz <span class=filename>/</span> como lectura-escritura y copia las cron tabs a un lugar seguro, como <span class=filename>/etc/tabs</span>, a continuación, añade una entrada al final de <span class=filename>/etc/rc.initdiskless</span> que copie estas crontabs a <span class=filename>/var/cron/tabs</span> después de que el directorio se cree durante el inicio del sistema. Es posible que también debas añadir una entrada que cambie los modos y permisos en los directorios creados y en los archivos copiados con <span class=filename>/etc/rc.initdiskless</span>.</p></div></div><div class=sect2><h3 id=_syslog>5.2. Syslog<a class=anchor href=#_syslog></a></h3><div class=paragraph><p><span class=filename>syslog.conf</span> especifica las ubicaciones de ciertos ficheros de log que hay en <span class=filename>/var/log</span>. Estos archivos no son creados por <span class=filename>/etc/rc.d/var</span> durante la inicialización del sistema. Por lo tanto, en algún lugar de <span class=filename>/etc/rc.d/var</span>, justo después de la sección que crea los directorios en <span class=filename>/var</span>, tendrás que añadir algo como esto:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># touch /var/log/security /var/log/maillog /var/log/cron /var/log/messages</span>
<span class=c># chmod 0644 /var/log/*</span></code></pre></div></div></div><div class=sect2><h3 id=_instalación_de_ports>5.3. Instalación de ports<a class=anchor href=#_instalación_de_ports></a></h3><div class=paragraph><p>Antes de analizar los cambios necesarios para utilizar con éxito el árbol de ports, es necesario recordar que su sistema de archivos en el medio flash es de solo lectura. Dado que es de solo lectura, necesitarás montarlo temporalmente en modo lectura-escritura utilizando la sintaxis que se muestra en <a href=#ro-fs>El Subsistema <code>rc</code> y los Sistemas de ficheros de Solo Lectura</a>. Siempre debes volver a montar estos sistemas de archivos en modo solo lectura cuando hayas terminado cualquier mantenimiento - las escrituras innecesarias en el medio flash podrían acortar considerablemente su vida útil.</p></div><div class=paragraph><p>Para que sea posible entrar en un directorio de ports y ejecutar con éxito <code>make install</code>, debemos crear un directorio de paquetes en un sistema de ficheros que no esté en memoria que seguirá la pista de nuestros paquetes entre reinicios. Como de todos modos es necesario montar tus sistemas de ficheros como lectura-escritura para la instalación de paquetes, parece razonable asumir que se puede usar un área del medio flash para que se escriba información de los paquetes.</p></div><div class=paragraph><p>Primero, crea el directorio para la base de datos de los paquetes. Normalmente se encuentra en <span class=filename>/var/db/pkg</span>, pero no podemos colocarlo allí ya que desaparecerá cada vez que se inicie el sistema.</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># mkdir /etc/pkg</span></code></pre></div></div><div class=paragraph><p>Ahora, añade una línea a <span class=filename>/etc/rc.d/var</span> que enlace el directorio <span class=filename>/etc/pkg</span> a <span class=filename>/var/db/pkg</span>. Un ejemplo:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># ln -s /etc/pkg /var/db/pkg</span></code></pre></div></div><div class=paragraph><p>Ahora, cada vez que montes tus sistemas de ficheros como lectura-escritura e instales un paquete, <code>make install</code> funcionará, se escribirá la información del paquete con éxito en <span class=filename>/etc/pkg</span> (porque el sistema de ficheros se montará, en su momento, como sólo lectura) que estará siempre disponible para el sistema operativo como <span class=filename>/var/db/pkg</span>.</p></div></div><div class=sect2><h3 id=_servidor_web_apache>5.4. Servidor Web Apache<a class=anchor href=#_servidor_web_apache></a></h3><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Los pasos de esta sección solo son necesarios si Apache está configurado para escribir su pid o registro log fuera de <span class=filename>/var</span>. Por defecto, Apache guarda su archivo pid en <span class=filename>/var/run/httpd.pid</span> y sus registros de log en <span class=filename>/var/log</span>.</p></div></td></tr></tbody></table></div><div class=paragraph><p>Ahora se asume que Apache mantiene sus ficheros de log en un directorio <span class=filename>apache_log_dir</span> fuera de <span class=filename>/var</span>. Cuando este directorio vive en un sistema de ficheros de sólo lectura, Apache no será capaz de guardar ningún fichero de log, y podría tener problemas de funcionamiento. Si es así, es necesario añadir un nuevo directorio a la lista de directorios en <span class=filename>/etc/rc.d/var</span> para crear en <span class=filename>/var</span>, y para enlazar <span class=filename>apache_log_dir</span> a <span class=filename>/var/log/apache</span>. También es necesario establecer permisos y el propietario de este nuevo directorio.</p></div><div class=paragraph><p>Primero, añade el directorio <code>log/apache</code> a la lista de directorios para ser creados en <span class=filename>/etc/rc.d/var</span>.</p></div><div class=paragraph><p>En segundo lugar, agrega estos comandos a <span class=filename>/etc/rc.d/var</span> después de la sección de creación del directorio:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># chmod 0774 /var/log/apache</span>
<span class=c># chown nobody:nobody /var/log/apache</span></code></pre></div></div><div class=paragraph><p>Por último, elimina el directorio <span class=filename>apache_log_dir</span> existente, y reemplázalo con un enlace:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># rm -rf apache_log_dir</span>
<span class=c># ln -s /var/log/apache apache_log_dir</span></code></pre></div></div></div></div></div><hr><div class=last-modified><p><strong>Last modified on</strong>: 14 de febrero de 2023 by <a href="https://cgit.freebsd.org/doc/commit/?id=4bd9fb2d9e" target=_blank>Fernando Apesteguía</a></p></div></div><aside class=toc><div class=toc-content><h3>Tabla de contenidos</h3><nav id=TableOfContents><ul><li><a href=#intro>1. Dispositivos de Disco de Estado Sólido</a></li><li><a href=#kernel>2. Opciones del Kernel</a></li><li><a href=#ro-fs>3. El Subsistema <code>rc</code> y los Sistemas de ficheros de Solo Lectura</a></li><li><a href=#_construyendo_un_sistema_de_archivos_desde_cero>4. Construyendo un Sistema de Archivos Desde Cero</a></li><li><a href=#strategies>5. Estrategias para Entornos Pequeños y de Solo Lectura</a></li></ul></nav><hr><div class=resources><h3>Recursos</h3><ul class=contents><li><i class="fa fa-file-pdf-o" aria-hidden=true title="Descargar PDF"></i><a href=https://download.freebsd.org/doc/es/articles/solid-state/solid-state_es.pdf>Descargar PDF</a></li><li><i class="fa fa-pencil-square-o" aria-hidden=true title="Editar esta página"></i><a href=https://github.com/freebsd/freebsd-doc/blob/main/documentation/content/es/_index target=_blank>Editar esta página</a></li></ul></div></div></aside></main><footer><div class=footer-container><section class=logo-column><img src=http://172.16.201.134:1313/images/FreeBSD-colors.svg width=160 height=50 alt="FreeBSD logo"><div class=options-container><div class=language-container><a id=languages href=http://172.16.201.134:1313/es/languages><img src=http://172.16.201.134:1313/images/language.png class=language-image alt="Elegir idioma">
<span>Spanish</span></a></div><div class=theme-container><select id=theme-chooser><option value=theme-system>System</option><option value=theme-light>Claro</option><option value=theme-dark>Oscuro</option><option value=theme-high-contrast>Alto contraste</option></select></div></div></section><section class=about-column><h3 class=column-title>About</h3><ul class=column-elements-container><li><a href=https://www.freebsd.org/about/ target=_blank class=column-element>FreeBSD</a></li><li><a href=https://freebsdfoundation.org/ target=_blank class=column-element>FreeBSD Foundation</a></li><li><a href=https://www.freebsd.org/where/ target=_blank class=column-element>Get FreeBSD</a></li><li><a href=https://www.freebsd.org/internal/code-of-conduct target=_blank class=column-element>Code of Conduct</a></li><li><a href=https://www.freebsd.org/security/ target=_blank class=column-element>Security Advisories</a></li></ul></section><section class=documentation-column><h3 class=column-title>Documentation</h3><ul class=column-elements-container><li><a href=/es class=column-element>Documentation portal</a></li><li><a href=https://man.FreeBSD.org target=_blank class=column-element>Manual pages</a></li><li><a href=https://papers.FreeBSD.org target=_blank class=column-element>Presentations and papers</a></li><li><a href=https://docs-archive.freebsd.org/doc/ target=_blank class=column-element>Previous versions</a></li><li><a href=https://docs-archive.freebsd.org/44doc/ target=_blank class=column-element>4.4BSD Documents</a></li><li><a href=https://wiki.freebsd.org/ target=_blank class=column-element>Wiki</a></li></ul></section><section class=community-column><h3 class=column-title>Community</h3><ul class=column-elements-container><li><a href=http://172.16.201.134:1313/es/articles/contributing class=column-element>Get involved</a></li><li><a href=https://forums.freebsd.org/ target=_blank class=column-element>Community forum</a></li><li><a href=https://lists.freebsd.org/ target=_blank class=column-element>Mailing lists</a></li><li><a href=https://wiki.freebsd.org/IRC/Channels target=_blank class=column-element>IRC Channels</a></li><li><a href=https://bugs.freebsd.org/bugzilla/ target=_blank class=column-element>Bug Tracker</a></li></ul></section><section class=legal-column><h3 class=column-title>Legal</h3><ul class=column-elements-container><li><a href=https://freebsdfoundation.org/donate/ target=_blank class=column-element>Donations</a></li><li><a href=https://www.freebsd.org/copyright/freebsd-license/ target=_blank class=column-element>Licensing</a></li><li><a href=https://www.freebsd.org/privacy/ target=_blank class=column-element>Privacy Policy</a></li><li><a href=https://www.freebsd.org/copyright/ target=_blank class=column-element>Legal notices</a></li></ul></section><section class=copyright-column><p>&copy; 1994-2024 The FreeBSD Project. All rights reserved</p><span>Made with <span class=heart>♥</span> by the FreeBSD Community</span></section></div></footer></body></html>