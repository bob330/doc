<!doctype html><html class=theme-light lang=fr><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content><meta name=keywords content><meta name=copyright content="1995-2024 The FreeBSD Foundation"><link rel=canonical href=https://docs.freebsd.org/fr/books/handbook/disks/><title>Chapitre 18. Stockage des données | FreeBSD Documentation Portal</title>
<meta name=theme-color content="#790000"><meta name=color-scheme content="system light dark high-contrast"><link rel="shortcut icon" href=https://docs.freebsd.org/favicon.ico><link rel=stylesheet href=https://docs.freebsd.org/styles/main.min.css><link rel=stylesheet href=https://docs.freebsd.org/css/font-awesome-min.css><script defer src=/js/theme-chooser.min.js></script><script defer src=/js/copy-clipboard.min.js></script><script defer src=/js/search.min.js></script><meta name=twitter:card content="summary"><meta name=twitter:domain content="docs.FreeBSD.org"><meta name=twitter:site content="@freebsd"><meta name=twitter:url content="https://twitter.com/freebsd"><meta property="og:title" content="Chapitre 18. Stockage des données"><meta property="og:description" content><meta property="og:type" content="website"><meta property="og:image" content="https://docs.freebsd.org/favicon.ico"><meta property="og:image:alt" content="FreeBSD Logo"><meta property="og:locale" content="fr"><meta property="og:url" content="https://docs.freebsd.org/fr/books/handbook/disks/"><meta property="og:site_name" content="FreeBSD Documentation Portal"><script type=application/ld+json>{"@context":"http://schema.org","@type":"Article","url":"https:\/\/docs.freebsd.org\/fr\/books\/handbook\/disks\/","name":"FreeBSD Documentation Portal","headline":"FreeBSD Documentation Portal","description":"FreeBSD Documentation Portal"}</script></head><body><header><div class=header-container><div class=logo-menu-bars-container><a href=https://www.FreeBSD.org class=logo><img src=https://docs.freebsd.org/images/FreeBSD-monochromatic.svg width=160 height=50 alt="FreeBSD logo">
</a><label class=menu-bars for=menu-bars><i class="fa fa-bars" aria-hidden=true></i></label></div><input id=menu-bars type=checkbox><nav><ul class=menu><li class=menu-item><input id=about type=checkbox>
<a href=# aria-label="Navigate to About section"><label class=menu-item-description for=about>About
<i class="fa fa-angle-down fa-lg" aria-hidden=true></i></label></a><ul class=sub-menu><li class=title><a href=https://www.freebsd.org/about/ target=_blank>About</a></li><li><a href=https://www.freebsd.org/about/ target=_blank>FreeBSD</a></li><li><a href=https://freebsdfoundation.org/about-us/about-the-foundation/ target=_blank>FreeBSD Foundation</a></li><li><a href=https://www.freebsd.org/internal/code-of-conduct/ target=_blank>Code of Conduct</a></li></ul></li><li class=menu-item><input id=download type=checkbox>
<a href=# aria-label="Navigate to get FreeBSD section"><label class=menu-item-description for=download>Get FreeBSD
<i class="fa fa-angle-down fa-lg" aria-hidden=true></i></label></a><ul class=sub-menu><li class=title><a href=https://www.freebsd.org/where/ target=_blank>Get FreeBSD</a></li><li><a href=https://www.freebsd.org/releases/ target=_blank>Release Information</a></li><li><a href=https://www.freebsd.org/releng/ target=_blank>Release Engineering</a></li><li><a href=https://www.freebsd.org/security/ target=_blank>Security Advisories</a></li></ul></li><li class=menu-item><input id=documentation type=checkbox>
<a href=# aria-label="Navigate to get Documentation section"><label class=menu-item-description for=documentation>Documentation
<i class="fa fa-angle-down fa-lg" aria-hidden=true></i></label></a><ul class=sub-menu><li class=title><a href=/fr>Documentation portal</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook>FreeBSD Handbook</a></li><li><a href=https://docs.freebsd.org/fr/books/porters-handbook>Porter's Handbook</a></li><li><a href=https://docs.FreeBSD.org/en/books/fdp-primer>Documentation Project Handbook</a></li><li><a href=https://man.FreeBSD.org target=_blank>Manual pages</a></li><li><a href=https://papers.FreeBSD.org target=_blank>Presentations and papers</a></li><li><a href=https://wiki.FreeBSD.org target=_blank>Wiki</a></li><li><a href=https://docs.freebsd.org/fr/books>Books</a></li><li><a href=https://docs.freebsd.org/fr/articles>Articles</a></li></ul></li><li class=menu-item><input id=community type=checkbox>
<a href=# aria-label="Navigate to get Community section"><label class=menu-item-description for=community>Community
<i class="fa fa-angle-down fa-lg" aria-hidden=true></i></label></a><ul class=sub-menu><li class=title><a href=https://www.freebsd.org/community/>Community</a></li><li><a href=https://docs.freebsd.org/fr/articles/contributing>Get involved</a></li><li><a href=https://forums.freebsd.org/ target=_blank>Forum</a></li><li><a href=https://lists.freebsd.org/ target=_blank>Mailing lists</a></li><li><a href=https://wiki.freebsd.org/IRC/Channels target=_blank>IRC Channels</a></li><li><a href=https://bugs.freebsd.org/bugzilla/ target=_blank>Bug Tracker</a></li><li><a href=https://www.freebsd.org/support/ target=_blank>Support</a></li></ul></li></ul></nav><div class=search-donate-container><form class=search method=get id=search-header-form action=https://docs.freebsd.org/search name=search-header-form><input type=hidden name=DB value=fr>
<input id=words name=P type=text size=20 maxlength=255>
<button>
<i class="fa fa-search" aria-hidden=true></i></button></form><div class=donate><a href=https://freebsdfoundation.org/donate/ target=_blank><span class=heart>♥</span>
Donate</a></div></div></div></header><input type=checkbox class="hidden toggle" id=menu-control><main class=main-wrapper-book><a id=top></a><aside class=book-menu><div class=book-menu-content><input id=search-book type=text placeholder=Search aria-label=Search maxlength=128><nav id=MenuContents><ul><li><input type=checkbox id=chapter-eb2a98ce203d8afd517726e6d8776be3 class=toggle>
<label class="icon cursor" for=chapter-eb2a98ce203d8afd517726e6d8776be3><a role=button></a></label><a href=https://docs.freebsd.org/fr/books/handbook/preface/>Préface</a><ul><li><a href=https://docs.freebsd.org/fr/books/handbook/preface/#preface-audience>Public visé</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/preface/#preface-changes-from2>Modifications depuis la Seconde Edition</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/preface/#preface-changes>Modifications depuis la Première Edition</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/preface/#preface-overview>Organisation de cet ouvrage</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/preface/#preface-conv>Conventions utilisées dans ce livre</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/preface/#preface-acknowledgements>Remerciements</a></li></ul></li><li><input type=checkbox id=chapter-14a525fce014b90b8a458a894818255a class=toggle>
<label for=chapter-14a525fce014b90b8a458a894818255a><a role=button></a></label><a href=https://docs.freebsd.org/fr/books/handbook/parti/>Partie I. Pour commencer</a></li><li><input type=checkbox id=chapter-f9c9f3451644df30d224350da97d5da6 class=toggle>
<label class="icon cursor" for=chapter-f9c9f3451644df30d224350da97d5da6><a role=button></a></label><a href=https://docs.freebsd.org/fr/books/handbook/introduction/>Chapitre 1. Introduction</a><ul><li><a href=https://docs.freebsd.org/fr/books/handbook/introduction/#introduction-synopsis>1.1. Synopsis</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/introduction/#nutshell>1.2. Bienvenue à FreeBSD!</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/introduction/#history>1.3. A propos du Projet FreeBSD</a></li></ul></li><li><input type=checkbox id=chapter-f693a3fa687a72d63ec8129ee302d664 class=toggle>
<label class="icon cursor" for=chapter-f693a3fa687a72d63ec8129ee302d664><a role=button></a></label><a href=https://docs.freebsd.org/fr/books/handbook/bsdinstall/>Chapitre 2. Installer FreeBSD</a><ul><li><a href=https://docs.freebsd.org/fr/books/handbook/bsdinstall/#bsdinstall-synopsis>2.1. Synopsis</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/bsdinstall/#bsdinstall-hardware>2.2. Configuration matérielle minimale</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/bsdinstall/#bsdinstall-pre>2.3. Tâches de pré-installation</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/bsdinstall/#bsdinstall-start>2.4. Lancer l’installation</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/bsdinstall/#using-bsdinstall>2.5. Utilisation de bsdinstall</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/bsdinstall/#bsdinstall-partitioning>2.6. Allouer l’espace disque</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/bsdinstall/#bsdinstall-fetching-distribution>2.7. Récupération des fichiers de distribution</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/bsdinstall/#bsdinstall-post>2.8. Comptes utilisateurs, fuseau horaire, services et renforcement de la sécurité</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/bsdinstall/#bsdinstall-network>2.9. Interfaces réseau</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/bsdinstall/#bsdinstall-install-trouble>2.10. Dépannage</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/bsdinstall/#using-live-cd>2.11. Utilisation du CD Live</a></li></ul></li><li><input type=checkbox id=chapter-9f6db261075f578742036fcc6000eecd class=toggle>
<label class="icon cursor" for=chapter-9f6db261075f578742036fcc6000eecd><a role=button></a></label><a href=https://docs.freebsd.org/fr/books/handbook/basics/>Chapitre 3. Quelques bases d'UNIX</a><ul><li><a href=https://docs.freebsd.org/fr/books/handbook/basics/#basics-synopsis>3.1. Synopsis</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/basics/#consoles>3.2. Consoles virtuelles terminaux</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/basics/#permissions>3.3. Permissions</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/basics/#dirstructure>3.4. Organisation de l’arborescence des répertoires</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/basics/#disk-organization>3.5. Organisation des disques</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/basics/#mount-unmount>3.6. Monter et démonter des systèmes de fichiers</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/basics/#basics-processes>3.7. Processus</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/basics/#basics-daemons>3.8. Daemons, signaux, et comment tuer un processus</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/basics/#shells>3.9. Interpréteurs de commandes - "Shells"</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/basics/#editors>3.10. Editeurs de texte</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/basics/#basics-devices>3.11. Périphériques et fichiers spéciaux de périphérique</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/basics/#binary-formats>3.12. Le format des fichiers binaires</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/basics/#basics-more-information>3.13. Pour plus d’information</a></li></ul></li><li><input type=checkbox id=chapter-01c5707e95d14c0ff84bf62600c958d1 class=toggle>
<label class="icon cursor" for=chapter-01c5707e95d14c0ff84bf62600c958d1><a role=button></a></label><a href=https://docs.freebsd.org/fr/books/handbook/ports/>Chapitre 4. Installer des applications: les logiciels pré-compilés et les logiciels portés</a><ul><li><a href=https://docs.freebsd.org/fr/books/handbook/ports/#ports-synopsis>4.1. Synopsis</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/ports/#ports-overview>4.2. Généralités sur l’installation de logiciels</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/ports/#ports-finding-applications>4.3. Trouver votre application</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/ports/#packages-using>4.4. Utiliser le système des logiciels pré-compilés</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/ports/#ports-using>4.5. Utiliser le catalogue des logiciels portés</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/ports/#ports-nextsteps>4.6. Activités de post-installation</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/ports/#ports-broken>4.7. Que faire avec les logiciels portés ne fonctionnant pas?</a></li></ul></li><li><input type=checkbox id=chapter-3405c00581365a8b5d16af70fe4d1b72 class=toggle>
<label class="icon cursor" for=chapter-3405c00581365a8b5d16af70fe4d1b72><a role=button></a></label><a href=https://docs.freebsd.org/fr/books/handbook/x11/>Chapitre 5. Le système X Window</a><ul><li><a href=https://docs.freebsd.org/fr/books/handbook/x11/#x11-synopsis>5.1. Synopsis</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/x11/#x-understanding>5.2. Terminologie</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/x11/#x-install>5.3. Installer X11</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/x11/#x-config>5.4. Configuration d’Xorg</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/x11/#x-fonts>5.5. Utilisation des polices de caractères sous Xorg</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/x11/#x-xdm>5.6. Le gestionnaire de connexion graphique XDM</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/x11/#x11-wm>5.7. Environnements de bureau</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/x11/#x-compiz-fusion>5.8. Installation de Compiz Fusion</a></li></ul></li><li><input type=checkbox id=chapter-0eab3565e8f59f5a8a896dfba7eb3680 class=toggle>
<label for=chapter-0eab3565e8f59f5a8a896dfba7eb3680><a role=button></a></label><a href=https://docs.freebsd.org/fr/books/handbook/partii/>Partie II. Tâches courantes</a></li><li><input type=checkbox id=chapter-b33cf28993f3f7bf5baf036e79da0f39 class=toggle>
<label class="icon cursor" for=chapter-b33cf28993f3f7bf5baf036e79da0f39><a role=button></a></label><a href=https://docs.freebsd.org/fr/books/handbook/desktop/>Chapitre 6. Bureautique</a><ul><li><a href=https://docs.freebsd.org/fr/books/handbook/desktop/#desktop-synopsis>6.1. Synopsis</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/desktop/#desktop-browsers>6.2. Navigateurs</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/desktop/#desktop-productivity>6.3. Productivité</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/desktop/#desktop-viewers>6.4. Lecteurs de document</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/desktop/#desktop-finance>6.5. Finance</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/desktop/#desktop-summary>6.6. Résumé</a></li></ul></li><li><input type=checkbox id=chapter-152f694a19312ad72ec7bb4e1c3c33b2 class=toggle>
<label class="icon cursor" for=chapter-152f694a19312ad72ec7bb4e1c3c33b2><a role=button></a></label><a href=https://docs.freebsd.org/fr/books/handbook/multimedia/>Chapitre 7. Multimédia</a><ul><li><a href=https://docs.freebsd.org/fr/books/handbook/multimedia/#multimedia-synopsis>7.1. Synopsis</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/multimedia/#sound-setup>7.2. Configurer une carte son</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/multimedia/#sound-mp3>7.3. Fichiers MP3</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/multimedia/#video-playback>7.4. Lecture des Vidéos</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/multimedia/#tvcard>7.5. Configuration des cartes TV</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/multimedia/#scanners>7.6. Scanners</a></li></ul></li><li><input type=checkbox id=chapter-80888b4ee02e3e409e5f71cf97a36450 class=toggle>
<label class="icon cursor" for=chapter-80888b4ee02e3e409e5f71cf97a36450><a role=button></a></label><a href=https://docs.freebsd.org/fr/books/handbook/kernelconfig/>Chapitre 8. Configurer le noyau de FreeBSD</a><ul><li><a href=https://docs.freebsd.org/fr/books/handbook/kernelconfig/#kernelconfig-synopsis>8.1. Synopsis</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/kernelconfig/#kernelconfig-custom-kernel>8.2. Pourquoi compiler un noyau sur mesure?</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/kernelconfig/#kernelconfig-building>8.3. Compiler et installer un noyau sur mesure</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/kernelconfig/#kernelconfig-config>8.4. Le fichier de configuration</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/kernelconfig/#kernelconfig-trouble>8.5. Si quelque chose se passe mal</a></li></ul></li><li><input type=checkbox id=chapter-cb174c55879b17ab955f2f16989a79e0 class=toggle>
<label class="icon cursor" for=chapter-cb174c55879b17ab955f2f16989a79e0><a role=button></a></label><a href=https://docs.freebsd.org/fr/books/handbook/printing/>Chapitre 9. Imprimer</a><ul><li><a href=https://docs.freebsd.org/fr/books/handbook/printing/#printing-synopsis>9.1. Synopsis</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/printing/#printing-intro-spooler>9.2. Introduction</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/printing/#printing-intro-setup>9.3. Configuration de base</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/printing/#printing-advanced>9.4. Configuration avancée de l’imprimante</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/printing/#printing-using>9.5. Using Printers <strong>Traduction en Cours</strong></a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/printing/#printing-lpd-alternatives>9.6. Alternatives to the Standard Spooler <strong>Traduction en Cours</strong></a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/printing/#printing-troubleshooting>9.7. Troubleshooting <strong>Traduction en Cours</strong></a></li></ul></li><li><input type=checkbox id=chapter-c12b8c3f2a8fcefce87087241f695c83 class=toggle>
<label class="icon cursor" for=chapter-c12b8c3f2a8fcefce87087241f695c83><a role=button></a></label><a href=https://docs.freebsd.org/fr/books/handbook/linuxemu/>Chapitre 10. Compatibilité binaire avec Linux</a><ul><li><a href=https://docs.freebsd.org/fr/books/handbook/linuxemu/#linuxemu-synopsis>10.1. Synopsis</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/linuxemu/#linuxemu-lbc-install>10.2. Configurer la compatibilité binaire avec Linux</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/linuxemu/#linuxemu-packages>10.3. Système de base CentOS à partir des paquets binaires FreeBSD</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/linuxemu/#linuxemu-debootstrap>10.4. Système de base Debian / Ubuntu avec debootstrap(8)</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/linuxemu/#linuxemu-advanced>10.5. Sujets avancés</a></li></ul></li><li><input type=checkbox id=chapter-54c06b703788dcba4081bec5a0407412 class=toggle>
<label class="icon cursor" for=chapter-54c06b703788dcba4081bec5a0407412><a role=button></a></label><a href=https://docs.freebsd.org/fr/books/handbook/wine/>Chapitre 11. WINE</a><ul><li><a href=https://docs.freebsd.org/fr/books/handbook/wine/#wine-synopsis>11.1. Synopsis</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/wine/#wine-overview-concepts>11.2. WINE généralités et concepts</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/wine/#installing-wine-on-freebsd>11.3. Installer WINE sur FreeBSD</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/wine/#running-first-wine-program>11.4. Lancer un premier programme WINE sous FreeBSD</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/wine/#configuring-wine-installation>11.5. Configurer WINE après installation</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/wine/#wine-management-guis>11.6. Interfaces graphiques de gestion de WINE</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/wine/#wine-in-multi-user-os-installations>11.7. WINE sur un système FreeBSD avec plusieurs utilisateurs</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/wine/#wine-on-os-faq>11.8. WINE sur FreeBSD Foire Aux Questions</a></li></ul></li><li><input type=checkbox id=chapter-03b11ba627b9a0c85b247f5641bde272 class=toggle>
<label for=chapter-03b11ba627b9a0c85b247f5641bde272><a role=button></a></label><a href=https://docs.freebsd.org/fr/books/handbook/partiii/>Partie III. Administration Système</a></li><li><input type=checkbox id=chapter-6c31587f8d736319f099cd4dc1961301 class=toggle>
<label class="icon cursor" for=chapter-6c31587f8d736319f099cd4dc1961301><a role=button></a></label><a href=https://docs.freebsd.org/fr/books/handbook/config/>Chapitre 11. Configuration et optimisation</a><ul><li><a href=https://docs.freebsd.org/fr/books/handbook/config/#config-synopsis>11.1. Synopsis</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/config/#configtuning-core-configuration>11.2. Configuration principale</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/config/#configtuning-appconfig>11.3. Configuration des applications</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/config/#configtuning-starting-services>11.4. Démarrer des services</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/config/#configtuning-cron>11.5. Configuration de l’utilitaire <code>cron</code></a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/config/#configtuning-rcd>11.6. Utilisation du système rc(8) sous FreeBSD</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/config/#config-network-setup>11.7. Configuration des cartes réseaux</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/config/#configtuning-virtual-hosts>11.8. Hôtes virtuels</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/config/#configtuning-configfiles>11.9. Fichiers de configuration</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/config/#configtuning-sysctl>11.10. Optimisation avec sysctl(8)</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/config/#configtuning-disk>11.11. Optimiser les disques</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/config/#configtuning-kernel-limits>11.12. Optimisation des limitations du noyau</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/config/#adding-swap-space>11.13. Ajouter de l’espace de pagination</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/config/#acpi-overview>11.14. Gestion de l’énergie et des ressources</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/config/#ACPI-debug>11.15. Utiliser et déboguer l’ACPI sous FreeBSD</a></li></ul></li><li><input type=checkbox id=chapter-459f0012b3b4f0b6b123010f029da5e4 class=toggle>
<label class="icon cursor" for=chapter-459f0012b3b4f0b6b123010f029da5e4><a role=button></a></label><a href=https://docs.freebsd.org/fr/books/handbook/boot/>Chapitre 12. Processus de démarrage de FreeBSD</a><ul><li><a href=https://docs.freebsd.org/fr/books/handbook/boot/#boot-synopsis>12.1. Synopsis</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/boot/#boot-introduction>12.2. Le problème du démarrage</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/boot/#boot-blocks>12.3. Le gestionnaire de démarrage et les étapes de démarrage</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/boot/#boot-kernel>12.4. Interaction avec le noyau au démarrage</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/boot/#device-hints>12.5. "Device Hints"-Paramétrage des périphériques</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/boot/#boot-init>12.6. Init: Initialisation de la gestion des processus</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/boot/#boot-shutdown>12.7. Séquence d’arrêt du système</a></li></ul></li><li><input type=checkbox id=chapter-d251c21b963b5ab783e5aec225e02b5a class=toggle>
<label class="icon cursor" for=chapter-d251c21b963b5ab783e5aec225e02b5a><a role=button></a></label><a href=https://docs.freebsd.org/fr/books/handbook/users/>Chapitre 13. Gestion des comptes et des utilisateurs</a><ul><li><a href=https://docs.freebsd.org/fr/books/handbook/users/#users-synopsis>13.1. Synopsis</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/users/#users-introduction>13.2. Introduction</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/users/#users-superuser>13.3. Le compte super-utilisateur</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/users/#users-system>13.4. Comptes système</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/users/#users-user>13.5. Comptes utilisateur</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/users/#users-modifying>13.6. Modifier des comptes</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/users/#users-limiting>13.7. Mettre en place des restrictions pour les utilisateurs</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/users/#users-groups>13.8. Groupes</a></li></ul></li><li><input type=checkbox id=chapter-917c75fcffbb14d48ed6d0a48e7028f2 class=toggle>
<label class="icon cursor" for=chapter-917c75fcffbb14d48ed6d0a48e7028f2><a role=button></a></label><a href=https://docs.freebsd.org/fr/books/handbook/security/>Chapitre 14. Sécurité</a><ul><li><a href=https://docs.freebsd.org/fr/books/handbook/security/#security-synopsis>14.1. Synopsis</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/security/#security-intro>14.2. Introduction</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/security/#securing-freebsd>14.3. Securing FreeBSD <strong>Traduction en Cours</strong></a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/security/#crypt>14.4. DES, MD5, et chiffrement</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/security/#one-time-passwords>14.5. Mots de passe non réutilisables</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/security/#tcpwrappers>14.6. L’encapsuleur TCP ("TCP Wrappers")</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/security/#kerberosIV>14.7. Kerberos</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/security/#kerberos5>14.8. Kerberos5 <strong>Traduction en Cours</strong></a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/security/#openssl>14.9. OpenSSL</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/security/#ipsec>14.10. IPsec</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/security/#openssh>14.11. OpenSSH</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/security/#fs-acl>14.12. Listes de contrôle d’accès au système de fichiers</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/security/#security-portaudit>14.13. Surveillance des problèmes de sécurité relatifs aux programmes tierce-partie</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/security/#security-advisories>14.14. Avis de sécurité de FreeBSD</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/security/#security-accounting>14.15. Comptabilité des processus</a></li></ul></li><li><input type=checkbox id=chapter-1a2a8e719703649c2c66d99aa7a25fd4 class=toggle>
<label class="icon cursor" for=chapter-1a2a8e719703649c2c66d99aa7a25fd4><a role=button></a></label><a href=https://docs.freebsd.org/fr/books/handbook/jails/>Chapitre 15. Environnements jail</a><ul><li><a href=https://docs.freebsd.org/fr/books/handbook/jails/#jails-synopsis>15.1. Synopsis</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/jails/#jails-terms>15.2. Termes relatifs aux environnements jail</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/jails/#jails-intro>15.3. Introduction</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/jails/#jails-build>15.4. Création et contrôle de l’environnement jail</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/jails/#jails-tuning>15.5. Optimisation et administration</a></li></ul></li><li><input type=checkbox id=chapter-8f4620c77e572cbb58917911a33c73cf class=toggle>
<label class="icon cursor" for=chapter-8f4620c77e572cbb58917911a33c73cf><a role=button></a></label><a href=https://docs.freebsd.org/fr/books/handbook/mac/>Chapitre 16. Mandatory Access Control ** Traduction en Cours **</a><ul><li><a href=https://docs.freebsd.org/fr/books/handbook/mac/#mac-synopsis>16.1. Synopsis</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/mac/#mac-glossary>16.2. Key Terms in this Chapter</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/mac/#mac-initial>16.3. Explanation of MAC</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/mac/#mac-understandlabel>16.4. Understanding MAC Labels</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/mac/#mac-modules>16.5. Module Configuration</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/mac/#mac-bsdextended>16.6. The MAC bsdextended Module</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/mac/#mac-ifoff>16.7. The MAC ifoff Module</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/mac/#mac-portacl>16.8. The MAC portacl Module</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/mac/#mac-labelingpolicies>16.9. MAC Policies with Labeling Features</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/mac/#mac-partition>16.10. The MAC partition Module</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/mac/#mac-mls>16.11. The MAC Multi-Level Security Module</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/mac/#mac-biba>16.12. The MAC Biba Module</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/mac/#mac-lomac>16.13. The MAC LOMAC Module</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/mac/#mac-implementing>16.14. Implementing a Secure Environment with MAC</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/mac/#MAC-examplehttpd>16.15. Another Example: Using MAC to Constrain a Web Server</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/mac/#mac-troubleshoot>16.16. Troubleshooting the MAC Framework</a></li></ul></li><li><input type=checkbox id=chapter-9598d66a76cb3182057b6bcd775149a0 class=toggle>
<label class="icon cursor" for=chapter-9598d66a76cb3182057b6bcd775149a0><a role=button></a></label><a href=https://docs.freebsd.org/fr/books/handbook/audit/>Chapitre 17. Audit des événements relatifs à la sécurité du système</a><ul><li><a href=https://docs.freebsd.org/fr/books/handbook/audit/#audit-synopsis>17.1. Synopsis</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/audit/#audit-inline-glossary>17.2. Mots-clés</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/audit/#audit-config>17.3. Configuration de l’audit</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/audit/#audit-administration>17.4. Travailler avec les traces d’audit</a></li></ul></li><li><input type=checkbox id=chapter-e1edcad13d9db6e8e4cb645d378ecfaf class=toggle checked>
<label class="icon cursor" for=chapter-e1edcad13d9db6e8e4cb645d378ecfaf><a role=button></a></label><a href=https://docs.freebsd.org/fr/books/handbook/disks/>Chapitre 18. Stockage des données</a><ul><li><a href=https://docs.freebsd.org/fr/books/handbook/disks/#disks-synopsis>18.1. Synopsis</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/disks/#disks-naming>18.2. Noms des périphériques</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/disks/#disks-adding>18.3. Ajouter des disques</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/disks/#raid>18.4. RAID</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/disks/#usb-disks>18.5. Périphériques de stockage USB</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/disks/#creating-cds>18.6. Création et utilisation de supports optiques (CDs)</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/disks/#creating-dvds>18.7. Création et utilisation de supports optiques (DVDs)</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/disks/#floppies>18.8. Création et utilisation de disquettes</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/disks/#backups-tapebackups>18.9. Créer et utiliser les bandes magnétiques</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/disks/#backups-floppybackups>18.10. Sauvegardes sur disquettes</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/disks/#backup-strategies>18.11. Stratégies de sauvegarde</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/disks/#backup-basics>18.12. Sauvegardes</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/disks/#disks-virtual>18.13. Systèmes de fichiers réseaux, en mémoire et sauvegardés sur fichier</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/disks/#snapshots>18.14. Instantané ("Snapshot") d’un système de fichiers</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/disks/#quotas>18.15. Quotas d’utilisation des disques</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/disks/#disks-encrypting>18.16. Chiffrer les partitions d’un disque</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/disks/#swap-encrypting>18.17. Chiffrage de l’espace de pagination</a></li></ul></li><li><input type=checkbox id=chapter-dde37901a0e0ea32745b67607854900f class=toggle>
<label class="icon cursor" for=chapter-dde37901a0e0ea32745b67607854900f><a role=button></a></label><a href=https://docs.freebsd.org/fr/books/handbook/geom/>Chapitre 19. GEOM: architecture modulaire de gestion des disques</a><ul><li><a href=https://docs.freebsd.org/fr/books/handbook/geom/#GEOM-synopsis>19.1. Synopsis</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/geom/#GEOM-intro>19.2. Introduction à GEOM</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/geom/#GEOM-striping>19.3. RAID0 - "Striping"</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/geom/#GEOM-mirror>19.4. RAID1 - "mirroring"</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/geom/#geom-ggate>19.5. Périphériques réseau "GEOM Gate"</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/geom/#geom-glabel>19.6. Ajouter un label à un disque</a></li></ul></li><li><input type=checkbox id=chapter-73e82560fcb7145b7c0e2ec47af8fc04 class=toggle>
<label class="icon cursor" for=chapter-73e82560fcb7145b7c0e2ec47af8fc04><a role=button></a></label><a href=https://docs.freebsd.org/fr/books/handbook/zfs/>Chapitre 20. The Z File System (ZFS) ** Traduction en Cours **</a><ul><li><a href=https://docs.freebsd.org/fr/books/handbook/zfs/#zfs-differences>20.1. What Makes ZFS Different</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/zfs/#zfs-quickstart>20.2. Quick Start Guide</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/zfs/#zfs-zpool>20.3. <code>zpool</code> Administration</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/zfs/#zfs-zfs>20.4. <code>zfs</code> Administration</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/zfs/#zfs-zfs-allow>20.5. Delegated Administration</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/zfs/#zfs-links>20.6. Additional Resources</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/zfs/#zfs-term>20.7. ZFS Features and Terminology</a></li></ul></li><li><input type=checkbox id=chapter-7af71270807eb7b70cd3eedc6577b254 class=toggle>
<label class="icon cursor" for=chapter-7af71270807eb7b70cd3eedc6577b254><a role=button></a></label><a href=https://docs.freebsd.org/fr/books/handbook/filesystems/>Chapitre 21. Autres systèmes de fichiers</a><ul><li><a href=https://docs.freebsd.org/fr/books/handbook/filesystems/#filesystems-synopsis>21.1. Synopsis</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/filesystems/#filesystems-linux>21.2. Systèmes de fichiers Linux®</a></li></ul></li><li><input type=checkbox id=chapter-dcd5a59a66ab6bff19287ccc6a33fd7e class=toggle>
<label class="icon cursor" for=chapter-dcd5a59a66ab6bff19287ccc6a33fd7e><a role=button></a></label><a href=https://docs.freebsd.org/fr/books/handbook/vinum/>Chapitre 22. Le gestionnaire de volume Vinum</a><ul><li><a href=https://docs.freebsd.org/fr/books/handbook/vinum/#vinum-synopsis>22.1. Synopsis</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/vinum/#vinum-intro>22.2. Les disques sont trop petits</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/vinum/#_les_goulots_détranglement_daccès_aux_données>22.3. Les goulots d’étranglement d’accès aux données</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/vinum/#_intégrité_des_données>22.4. Intégrité des données</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/vinum/#vinum-objects>22.5. Objets Vinum</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/vinum/#vinum-examples>22.6. Quelques exemples</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/vinum/#_appellation_des_objets>22.7. Appellation des objets</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/vinum/#vinum-config>22.8. Configuration de Vinum</a></li></ul></li><li><input type=checkbox id=chapter-375257268d95faaf87faf4f7a2e6aa67 class=toggle>
<label class="icon cursor" for=chapter-375257268d95faaf87faf4f7a2e6aa67><a role=button></a></label><a href=https://docs.freebsd.org/fr/books/handbook/virtualization/>Chapitre 23. Virtualisation</a><ul><li><a href=https://docs.freebsd.org/fr/books/handbook/virtualization/#virtualization-synopsis>23.1. Synopsis</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/virtualization/#virtualization-guest>23.2. FreeBSD comme système d’exploitation invité</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/virtualization/#virtualization-host>23.3. FreeBSD comme système d’exploitation hôte</a></li></ul></li><li><input type=checkbox id=chapter-49f1e96591c090304ea532012257f4ef class=toggle>
<label class="icon cursor" for=chapter-49f1e96591c090304ea532012257f4ef><a role=button></a></label><a href=https://docs.freebsd.org/fr/books/handbook/l10n/>Chapitre 24. Localisation - Utilisation et configuration de l'I18N/L10N</a><ul><li><a href=https://docs.freebsd.org/fr/books/handbook/l10n/#l10n-synopsis>24.1. Synopsis</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/l10n/#l10n-basics>24.2. Les bases</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/l10n/#using-localization>24.3. Utiliser la localisation</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/l10n/#l10n-compiling>24.4. Compiler des programmes I18N</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/l10n/#lang-setup>24.5. Localiser FreeBSD pour des langues spécifiques</a></li></ul></li><li><input type=checkbox id=chapter-dead2b4c5ea325dd390a9b0dccd8f763 class=toggle>
<label class="icon cursor" for=chapter-dead2b4c5ea325dd390a9b0dccd8f763><a role=button></a></label><a href=https://docs.freebsd.org/fr/books/handbook/cutting-edge/>Chapitre 25. Mise à jour de FreeBSD</a><ul><li><a href=https://docs.freebsd.org/fr/books/handbook/cutting-edge/#updating-upgrading-synopsis>25.1. Synopsis</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/cutting-edge/#updating-upgrading-freebsdupdate>25.2. Mise à jour de FreeBSD</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/cutting-edge/#updating-upgrading-portsnap>25.3. Portsnap: un outil de mise à jour du catalogue des logiciels portés</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/cutting-edge/#updating-upgrading-documentation>25.4. Updating the Documentation Set <strong>Traduction en Cours</strong></a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/cutting-edge/#current-stable>25.5. Suivre une branche de développement</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/cutting-edge/#synching>25.6. Synchroniser vos sources</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/cutting-edge/#makeworld>25.7. Recompiler le système</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/cutting-edge/#small-lan>25.8. Suivre les mises à jour pour plusieurs machines</a></li></ul></li><li><input type=checkbox id=chapter-29c1eeb0e9dedc487a98399e2737ee8a class=toggle>
<label class="icon cursor" for=chapter-29c1eeb0e9dedc487a98399e2737ee8a><a role=button></a></label><a href=https://docs.freebsd.org/fr/books/handbook/dtrace/>Chapitre 26. DTrace</a><ul><li><a href=https://docs.freebsd.org/fr/books/handbook/dtrace/#dtrace-synopsis>26.1. Synopsis</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/dtrace/#dtrace-implementation>26.2. Des différences de mise en oeuvre</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/dtrace/#dtrace-enable>26.3. Activer la prise en charge de DTrace</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/dtrace/#dtrace-using>26.4. Utiliser DTrace</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/dtrace/#dtrace-language>26.5. Le langage D</a></li></ul></li><li><input type=checkbox id=chapter-bbd25f9a194f9c39ca2d658c75767db5 class=toggle>
<label for=chapter-bbd25f9a194f9c39ca2d658c75767db5><a role=button></a></label><a href=https://docs.freebsd.org/fr/books/handbook/partiv/>Partie IV. Réseau</a></li><li><input type=checkbox id=chapter-499dab596afd7ddac77e80295314e0dd class=toggle>
<label class="icon cursor" for=chapter-499dab596afd7ddac77e80295314e0dd><a role=button></a></label><a href=https://docs.freebsd.org/fr/books/handbook/serialcomms/>Chapitre 27. Serial Communications ** Traduction en Cours **</a><ul><li><a href=https://docs.freebsd.org/fr/books/handbook/serialcomms/#serial-synopsis>27.1. Synopsis</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/serialcomms/#serial>27.2. Introduction</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/serialcomms/#term>27.3. Terminals</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/serialcomms/#dialup>27.4. Dial-in Service</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/serialcomms/#dialout>27.5. Dial-out Service</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/serialcomms/#serialconsole-setup>27.6. Setting Up the Serial Console</a></li></ul></li><li><input type=checkbox id=chapter-95e4571c48bee1cced5e84a538d302e3 class=toggle>
<label class="icon cursor" for=chapter-95e4571c48bee1cced5e84a538d302e3><a role=button></a></label><a href=https://docs.freebsd.org/fr/books/handbook/ppp-and-slip/>Chapitre 28. PPP et SLIP</a><ul><li><a href=https://docs.freebsd.org/fr/books/handbook/ppp-and-slip/#ppp-and-slip-synopsis>28.1. Synopsis</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/ppp-and-slip/#userppp>28.2. Using User PPP <strong>Traduction en Cours</strong></a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/ppp-and-slip/#ppp>28.3. Utiliser PPP intégré au noyau</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/ppp-and-slip/#pppoe>28.4. Utiliser PPP sur Ethernet (PPPoE)</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/ppp-and-slip/#pppoa>28.5. Utiliser PPP sur ATM (PPPoA)</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/ppp-and-slip/#slip>28.6. Utiliser SLIP</a></li></ul></li><li><input type=checkbox id=chapter-f089ac726c401c9b4bd5c34a295e11bb class=toggle>
<label class="icon cursor" for=chapter-f089ac726c401c9b4bd5c34a295e11bb><a role=button></a></label><a href=https://docs.freebsd.org/fr/books/handbook/mail/>Chapitre 29. Courrier électronique</a><ul><li><a href=https://docs.freebsd.org/fr/books/handbook/mail/#mail-synopsis>29.1. Synopsis</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/mail/#mail-using>29.2. Utilisation du courrier électronique</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/mail/#sendmail>29.3. Configuration de sendmail</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/mail/#mail-changingmta>29.4. Changer votre agent de transfert de courrier</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/mail/#mail-trouble>29.5. Dépannage</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/mail/#mail-advanced>29.6. Sujets avancés</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/mail/#SMTP-UUCP>29.7. SMTP avec UUCP</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/mail/#outgoing-only>29.8. Configuration pour l’envoi seul</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/mail/#SMTP-dialup>29.9. Utiliser le courrier électronique avec une connexion temporaire</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/mail/#SMTP-Auth>29.10. Authentification SMTP</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/mail/#mail-agents>29.11. Clients de messagerie</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/mail/#mail-fetchmail>29.12. Utiliser fetchmail</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/mail/#mail-procmail>29.13. Utiliser procmail</a></li></ul></li><li><input type=checkbox id=chapter-6de4de3fe925639d4175ce4b6f8c1829 class=toggle>
<label class="icon cursor" for=chapter-6de4de3fe925639d4175ce4b6f8c1829><a role=button></a></label><a href=https://docs.freebsd.org/fr/books/handbook/network-servers/>Chapitre 30. Serveurs réseau</a><ul><li><a href=https://docs.freebsd.org/fr/books/handbook/network-servers/#network-servers-synopsis>30.1. Synopsis</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/network-servers/#network-inetd>30.2. Le "super-serveur" inetd</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/network-servers/#network-nfs>30.3. Système de fichiers réseau (NFS)</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/network-servers/#network-nis>30.4. Services d’information réseau (NIS/YP)</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/network-servers/#network-dhcp>30.5. Configuration réseau automatique (DHCP)</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/network-servers/#network-dns>30.6. Serveurs de noms (DNS)</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/network-servers/#network-apache>30.7. Serveur HTTP Apache</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/network-servers/#network-ftp>30.8. Protocole de transfert de fichiers (FTP)</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/network-servers/#network-samba>30.9. Serveur de fichiers et d’impression pour clients Microsoft® Windows® (Samba)</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/network-servers/#network-ntp>30.10. Synchronisation de l’horloge avec NTP</a></li></ul></li><li><input type=checkbox id=chapter-776d855c7b75e048f90b5c2c9b35ffe0 class=toggle>
<label class="icon cursor" for=chapter-776d855c7b75e048f90b5c2c9b35ffe0><a role=button></a></label><a href=https://docs.freebsd.org/fr/books/handbook/firewalls/>Chapitre 31. Firewalls ** Traduction en Cours **</a><ul><li><a href=https://docs.freebsd.org/fr/books/handbook/firewalls/#firewalls-intro>31.1. Introduction</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/firewalls/#firewalls-concepts>31.2. Firewall Concepts</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/firewalls/#firewalls-apps>31.3. Firewall Packages</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/firewalls/#firewalls-pf>31.4. The OpenBSD Packet Filter (PF) and ALTQ</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/firewalls/#firewalls-ipf>31.5. The IPFILTER (IPF) Firewall</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/firewalls/#firewalls-ipfw>31.6. IPFW</a></li></ul></li><li><input type=checkbox id=chapter-5b07f776a0e6155c1c89aa0d15610380 class=toggle>
<label class="icon cursor" for=chapter-5b07f776a0e6155c1c89aa0d15610380><a role=button></a></label><a href=https://docs.freebsd.org/fr/books/handbook/advanced-networking/>Chapitre 32. Administration réseau avancée</a><ul><li><a href=https://docs.freebsd.org/fr/books/handbook/advanced-networking/#advanced-networking-synopsis>32.1. Synopsis</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/advanced-networking/#network-routing>32.2. Passerelles et routes</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/advanced-networking/#network-wireless>32.3. Réseau sans fil</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/advanced-networking/#network-bluetooth>32.4. Bluetooth</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/advanced-networking/#network-bridging>32.5. Bridging</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/advanced-networking/#network-diskless>32.6. Système sans disque dur</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/advanced-networking/#network-isdn>32.7. ISDN</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/advanced-networking/#network-natd>32.8. Translation d’adresses</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/advanced-networking/#network-plip>32.9. IP sur liaison parallèle (PLIP)</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/advanced-networking/#network-ipv6>32.10. IPv6</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/advanced-networking/#network-atm>32.11. ATM ("Asynchronous Transfer Mode")</a></li></ul></li><li><input type=checkbox id=chapter-171a77aa9d067a1024f849470e1f33e8 class=toggle>
<label for=chapter-171a77aa9d067a1024f849470e1f33e8><a role=button></a></label><a href=https://docs.freebsd.org/fr/books/handbook/partv/>Partie V. Annexes</a></li><li><input type=checkbox id=chapter-8050f436a0a7986a4aaded93d8e49469 class=toggle>
<label class="icon cursor" for=chapter-8050f436a0a7986a4aaded93d8e49469><a role=button></a></label><a href=https://docs.freebsd.org/fr/books/handbook/mirrors/>Annexe A. Se procurer FreeBSD</a><ul><li><a href=https://docs.freebsd.org/fr/books/handbook/mirrors/#mirrors-cdrom>A.1. Editeurs de CD-ROMs et DVDs</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/mirrors/#mirrors-ftp>A.2. Sites FTP</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/mirrors/#anoncvs>A.3. CVS anonyme</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/mirrors/#ctm>A.4. Utiliser CTM</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/mirrors/#cvsup>A.5. Utiliser CVSup</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/mirrors/#portsnap>A.6. Utiliser Portsnap</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/mirrors/#cvs-tags>A.7. Etiquettes CVS</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/mirrors/#mirrors-afs>A.8. Sites AFS</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/mirrors/#mirrors-rsync>A.9. Sites rsync</a></li></ul></li><li><input type=checkbox id=chapter-128b630a8f88f158e7027fe6c2184d21 class=toggle>
<label class="icon cursor" for=chapter-128b630a8f88f158e7027fe6c2184d21><a role=button></a></label><a href=https://docs.freebsd.org/fr/books/handbook/bibliography/>Annexe B. Bibliographie</a><ul><li><a href=https://docs.freebsd.org/fr/books/handbook/bibliography/#bibliography-freebsd>B.1. Livres magazines consacrés à FreeBSD</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/bibliography/#bibliography-userguides>B.2. Manuels d’utilisation</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/bibliography/#bibliography-adminguides>B.3. Manuels d’administration</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/bibliography/#bibliography-programmers>B.4. Manuels de programmation</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/bibliography/#bibliography-osinternals>B.5. "Internes" du système d’exploitation</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/bibliography/#bibliography-security>B.6. Ouvrages de référence en matière de sécurité</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/bibliography/#bibliography-hardware>B.7. Ouvrages de référence sur le matériel</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/bibliography/#bibliography-history>B.8. Histoire d’UNIX®</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/bibliography/#bibliography-journals>B.9. Revues et journaux</a></li></ul></li><li><input type=checkbox id=chapter-8bbb8867c46dac315e2253945d8c18a8 class=toggle>
<label class="icon cursor" for=chapter-8bbb8867c46dac315e2253945d8c18a8><a role=button></a></label><a href=https://docs.freebsd.org/fr/books/handbook/eresources/>Annexe C. Ressources sur Internet</a><ul><li><a href=https://docs.freebsd.org/fr/books/handbook/eresources/#eresources-mail>C.1. Listes de diffusion</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/eresources/#eresources-news>C.2. Forums de discussion</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/eresources/#eresources-web>C.3. Serveurs World Wide Web</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/eresources/#eresources-email>C.4. Adresses électroniques</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/eresources/#eresources-shell>C.5. Comptes</a></li></ul></li><li><input type=checkbox id=chapter-a80ea4f5a4480b8725422710f954ef36 class=toggle>
<label class="icon cursor" for=chapter-a80ea4f5a4480b8725422710f954ef36><a role=button></a></label><a href=https://docs.freebsd.org/fr/books/handbook/pgpkeys/>Annexe D. Clés OpenPGP</a><ul><li><a href=https://docs.freebsd.org/fr/books/handbook/pgpkeys/#pgpkeys-officers>D.1. Officers</a></li></ul></li><li></li></ul></nav></div></aside><div class=book><div class=book-menu-mobile><label for=menu-control><span class=menu-control-button><i class="fa fa-list" aria-hidden=true title="Book menu"></i>
Book menu</span></label></div><h1 class=title>Chapitre 18. Stockage des données</h1><div class="admonitionblock note"><p><i class="fa fa-exclamation-circle" aria-hidden=true></i>
This translation may be out of date. To help with the translations please access the <a href=https://translate-dev.freebsd.org/ target=_blank>FreeBSD translations instance</a>.</p></div><div class=toc-mobile><h3>Sommaire</h3><nav id=TableOfContents><ul><li><a href=#disks-synopsis>18.1. Synopsis</a></li><li><a href=#disks-naming>18.2. Noms des périphériques</a></li><li><a href=#disks-adding>18.3. Ajouter des disques</a></li><li><a href=#raid>18.4. RAID</a></li><li><a href=#usb-disks>18.5. Périphériques de stockage USB</a></li><li><a href=#creating-cds>18.6. Création et utilisation de supports optiques (CDs)</a></li><li><a href=#creating-dvds>18.7. Création et utilisation de supports optiques (DVDs)</a></li><li><a href=#floppies>18.8. Création et utilisation de disquettes</a></li><li><a href=#backups-tapebackups>18.9. Créer et utiliser les bandes magnétiques</a></li><li><a href=#backups-floppybackups>18.10. Sauvegardes sur disquettes</a></li><li><a href=#backup-strategies>18.11. Stratégies de sauvegarde</a></li><li><a href=#backup-basics>18.12. Sauvegardes</a></li><li><a href=#disks-virtual>18.13. Systèmes de fichiers réseaux, en mémoire et sauvegardés sur fichier</a></li><li><a href=#snapshots>18.14. Instantané ("Snapshot") d’un système de fichiers</a></li><li><a href=#quotas>18.15. Quotas d’utilisation des disques</a></li><li><a href=#disks-encrypting>18.16. Chiffrer les partitions d’un disque</a></li><li><a href=#swap-encrypting>18.17. Chiffrage de l’espace de pagination</a></li></ul></nav></div><div class=book-content><div id=preamble><div class=sectionbody></div></div><div class=sect1><h2 id=disks-synopsis>18.1. Synopsis<a class=anchor href=#disks-synopsis></a></h2><div class=sectionbody><div class=paragraph><p>Ce chapitre couvre l’utilisation des disques sous FreeBSD. Cela comprend les disques mémoire, les disques réseau, les périphériques standards de stockage SCSI/IDE, et les périphériques utilisant l’interface USB.</p></div><div class=paragraph><p>Après la lecture de ce chapitre, vous connaîtrez:</p></div><div class=ulist><ul><li><p>La terminologie qu’utilise FreeBSD pour décrire l’organisation des données sur un disque physique (les partitions et les tranches).</p></li><li><p>Comment ajouter des disques durs supplémentaires sur votre système.</p></li><li><p>Comment configurer FreeBSD pour l’utilisation de périphériques de stockage USB.</p></li><li><p>Comment configurer des systèmes de fichiers virtuels, comme les disques mémoires.</p></li><li><p>Comment utiliser les quotas pour limiter l’usage de l’espace disque.</p></li><li><p>Comment chiffrer des disques pour les sécuriser contre les attaques.</p></li><li><p>Comment créer et graver des CDs et DVDs sous FreeBSD.</p></li><li><p>Les différents supports disponibles pour les sauvegardes.</p></li><li><p>Comment utiliser les programmes de sauvegarde disponibles sous FreeBSD.</p></li><li><p>Comment faire des sauvegardes sur disquettes.</p></li><li><p>Ce que sont les "snapshots" (instantanés) de systèmes de fichiers et comment les utiliser efficacement.</p></li></ul></div><div class=paragraph><p>Avant de lire ce chapitre, vous devrez:</p></div><div class=ulist><ul><li><p>Savoir comment configurer et installer un nouveau noyau FreeBSD (<a href=../kernelconfig/#kernelconfig>Configurer le noyau de FreeBSD</a>).</p></li></ul></div></div></div><div class=sect1><h2 id=disks-naming>18.2. Noms des périphériques<a class=anchor href=#disks-naming></a></h2><div class=sectionbody><div class=paragraph><p>Ce qui suit est une liste des périphériques de stockage physiques, et des noms de périphériques associés.</p></div><table id=disk-naming-physical-table class="tableblock frame-none grid-all stretch"><caption class=title>Tableau 1. Conventions de nom pour les disques physiques</caption><col style=width:50%><col style=width:50%><thead><tr><th class="tableblock halign-left valign-top">Type de disque</th><th class="tableblock halign-left valign-top">Nom du périphérique</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class=tableblock>Disques durs IDE</p></td><td class="tableblock halign-left valign-top"><p class=tableblock><code>ad</code></p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>Lecteurs de CDROMs IDE</p></td><td class="tableblock halign-left valign-top"><p class=tableblock><code>acd</code></p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>Disques durs SCSI et périphériques de stockage USB</p></td><td class="tableblock halign-left valign-top"><p class=tableblock><code>da</code></p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>Lecteurs de CDROMs SCSI</p></td><td class="tableblock halign-left valign-top"><p class=tableblock><code>cd</code></p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>mcd</code> pour les CD-ROMs Mitsumi, <code>scd</code> pour les CD-ROMs Sony</p></td><td class="tableblock halign-left valign-top"></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>Lecteurs de disquette</p></td><td class="tableblock halign-left valign-top"><p class=tableblock><code>fd</code></p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>Lecteurs de bande SCSI</p></td><td class="tableblock halign-left valign-top"><p class=tableblock><code>sa</code></p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>Lecteurs de bande IDE</p></td><td class="tableblock halign-left valign-top"><p class=tableblock><code>ast</code></p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>Disques flash</p></td><td class="tableblock halign-left valign-top"><p class=tableblock><code>fla</code> pour les périphériques Flash DiskOnChip®</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>Disques RAID</p></td><td class="tableblock halign-left valign-top"><p class=tableblock><code>aacd</code> pour l’AdvancedRAID Adaptec®, <code>mlxd</code> et <code>mlyd</code> pour les Mylex®, <code>amrd</code> le MegaRAID® d’AMI, <code>idad</code> pour le Smart RAID de Compaq, <code>twed</code> pour le 3ware® RAID.</p></td></tr></tbody></table></div></div><div class=sect1><h2 id=disks-adding>18.3. Ajouter des disques<a class=anchor href=#disks-adding></a></h2><div class=sectionbody><div class=paragraph><p>Supposons que nous voulions ajouter un second disque SCSI à une machine qui n’a pour l’instant qu’un seul disque. Commençons par arrêter l’ordinateur et installer le disque en suivant les instructions données par le constructeur de l’ordinateur, du contrôleur et du disque. Comme il y a de nombreuses façon de procéder, ces détails dépassent le cadre de ce document.</p></div><div class=paragraph><p>Ouvrons maintenant une session sous le compte <code>root</code>. Après avoir installé le disque, consultez le fichier <span class=filename>/var/run/dmesg.boot</span> pour vérifier que le nouveau disque a été reconnu. Dans notre exemple, le disque que nous venons d’ajouter sera le périphérique <span class=filename>da1</span> et nous le monterons sur le répertoire <span class=filename>/1</span> (si vous ajoutez un disque IDE, le nom de périphérique sera <span class=filename>ad1</span>).</p></div><div class=paragraph><p>FreeBSD tourne sur des ordinateurs compatibles IBM-PC, il doit tenir compte des partitions PC BIOS. Ces dernières sont différentes des partitions BSD traditionnelles. Un disque PC peut avoir jusqu’à quatre partitions. Si le disque va être réservé uniquement à FreeBSD, vous pouvez utiliser le mode <em>dédié</em>. Sinon, FreeBSD devra utiliser une des partitions PC BIOS. FreeBSD appelle les partitions PC BIOS <em>tranches</em> ("slices") pour les distinguer des partitions BSD traditionnelles. Vous pouvez aussi des tranches sur un disque dédié à FreeBSD, mais utilisé sur une machine où un autre système d’exploitation est également installé. C’est une bonne manière pour éviter de perturber l’utilitaire <code>fdisk</code> des autres système d’exploitation différents de FreeBSD.</p></div><div class=paragraph><p>Dans le cas d’une tranche, le disque ajouté deviendra le périphérique <span class=filename>/dev/da1s1e</span>. Ce qui se lit: disque SCSI, numéro d’unité 1 (second disque SCSI), tranche 1 (partition PC BIOS 1), et partition BSD <span class=filename>e</span>. Dans le cas du mode dédié, le disque sera ajouté en tant que <span class=filename>/dev/da1e</span>.</p></div><div class=paragraph><p>En raison de l’utilisation d’entiers codés sur 32 bits pour stocker le nombre de secteurs, <a href="https://man.freebsd.org/cgi/man.cgi?query=bsdlabel&amp;sektion=8&amp;format=html">bsdlabel(8)</a> est limité à 2^32-1 secteurs par disque ou 2TB dans la plupart des cas. Le format <a href="https://man.freebsd.org/cgi/man.cgi?query=fdisk&amp;sektion=8&amp;format=html">fdisk(8)</a> n’autorise pas de secteur au delà de 2^32-1 et une largeur de plus de 2^32-1, limitant donc les partitions à 2TB et les disques à 4TB en général. Le format <a href="https://man.freebsd.org/cgi/man.cgi?query=sunlabel&amp;sektion=8&amp;format=html">sunlabel(8)</a> est limité à 2^32-1 secteur par partition et 8 partitions pour un total de 16TB d’espace. Pour des disques plus importants, les partitions <a href="https://man.freebsd.org/cgi/man.cgi?query=gpt&amp;sektion=8&amp;format=html">gpt(8)</a> peuvent être utilisées.</p></div><div class=sect2><h3 id=_utiliser_sysinstall8>18.3.1. Utiliser <a href="https://man.freebsd.org/cgi/man.cgi?query=sysinstall&amp;sektion=8&amp;format=html">sysinstall(8)</a><a class=anchor href=#_utiliser_sysinstall8></a></h3><div class="exampleblock procedure"><div class=content><div class="olist arabic"><ol class=arabic><li><p>Naviguer dans sysinstall</p><div class=paragraph><p>Vous pouvez utiliser <code>sysinstall</code> et ses menus simples d’emploi pour partitionner et libeller le nouveau disque. Ouvrez une session sous le compte super-utilisateur <code>root</code> ou utilisez la commande <a href="https://man.freebsd.org/cgi/man.cgi?query=su&amp;sektion=1&amp;format=html">su(1)</a>. Lancez <code>sysinstall</code> et sélectionnez <span class=guimenuitem>Configure</span>. A l’intérieur du menu <span class=guimenuitem>FreeBSD Configuration Menu</span>, descendez et sélectionnez l’option <span class=guimenuitem>Fdisk</span>.</p></div></li><li><p>L’éditeur de partition fdisk</p><div class=paragraph><p>Une fois dans l’utilitaire fdisk, nous pouvons taper <kbd>A</kbd> pour utiliser tout le disque pour FreeBSD. Lorsque l’on vous demande si vous voulez garder la possibilité de pouvoir coopérer avec d’autres systèmes d’exploitation ("remain cooperative with any future possible operating systems"), répondez par l’affirmative (<code>YES</code>). Enregistrez les modifications sur le disque avec <kbd>W</kbd>. Quittez maintenant l’éditeur fdisk en tapant <kbd>q</kbd>. La prochaine question concernera le secteur de démarrage ("Master Boot Record"). Comme vous ajoutez un disque à un système déjà opérationnel, choisissez <b class=button>None</b>.</p></div></li><li><p>L’éditeur de label du disque</p><div class=paragraph><p>Ensuite, vous devez quitter puis relancer sysinstall. Suivez les instructions précédentes, en choisissant cette fois l’option <span class=guimenuitem>Label</span>. Vous entrerez dans l’éditeur de label du disque (<code>Disk Label Editor</code>). C’est là que vous allez créer les partitions BSD traditionnelles. Un disque peut avoir jusqu’à huit partitions, libellées de <code>a</code> à <code>h</code>. Certains de ces labels ont des significations particulières. La partition <code>a</code> est la partition racine (<span class=filename>/</span>). Seul votre disque système (e.g., celui à partir duquel vous démarrez) doit avoir une partition <code>a</code>. La partition <code>b</code> est utilisée pour la pagination, vous pouvez avoir plusieurs disques avec des partitions de pagination. La partition <code>c</code> désigne la totalité du disque en mode dédié, ou toute la tranche FreeBSD dans le cas contraire. Les autres partitions sont à usage général.</p></div><div class=paragraph><p>L’éditeur de label de sysinstall définit par défaut la partition <code>e</code> comme première partition qui n’est ni racine, ni de pagination. Dans l’éditeur de label, créez un seul système de fichiers avec l’option <kbd>C</kbd>. Quand on vous demande si ce sera un système de fichiers (FS) ou une partition de pagination, choisissez <code>FS</code> et indiquez un point de montage (e.g., <span class=filename>/mnt</span>). Lorsque vous ajoutez un disque sur un système déjà installé, sysinstall ne créera pas d’entrées dans <span class=filename>/etc/fstab</span>, donc le nom que vous donnez au point de montage n’a pas d’importance.</p></div><div class=paragraph><p>Vous pouvez maintenant écrire le nouveau label sur le disque et y créer un système de fichiers. Faites-le en tapant <kbd>W</kbd>. Ignorez les erreurs de sysinstall disant que la nouvelle partition ne peut être montée. Quittez maintenant l’éditeur de label et sysinstall.</p></div></li><li><p>Dernière étape</p><div class=paragraph><p>La dernière étape consiste à éditer le fichier <span class=filename>/etc/fstab</span> pour y ajouter une entrée pour votre nouveau disque.</p></div></li></ol></div></div></div></div><div class=sect2><h3 id=_utiliser_les_utilitaires_en_ligne_de_commande>18.3.2. Utiliser les utilitaires en ligne de commande<a class=anchor href=#_utiliser_les_utilitaires_en_ligne_de_commande></a></h3><div class=sect3><h4 id=_utiliser_les_tranches_slices>18.3.2.1. Utiliser les tranches - "slices"<a class=anchor href=#_utiliser_les_tranches_slices></a></h4><div class=paragraph><p>Cette configuration permettra de faire fonctionner correctement votre disque dure avec d’autres systèmes d’exploitation qui pourraient être installé sur votre machine, et ne perturbera pas les utilitaires <code>fdisk</code> de ces autres systèmes d’exploitation. C’est la méthode recommandée pour l’installation de nouveau disques. N’utilisez le mode <em>dédié</em> que si vous avez une bonne raison de le faire!</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># dd if=/dev/zero of=/dev/da1 bs=1k count=1</span>
<span class=c># fdisk -BI da1 #Initialize your new disk</span>
<span class=c># bsdlabel -B -w da1s1 auto #Label it.</span>
<span class=c># bsdlabel -e da1s1 # Edit the disklabel just created and add any partitions.</span>
<span class=c># mkdir -p /1</span>
<span class=c># newfs /dev/da1s1e # Repeat this for every partition you created.</span>
<span class=c># mount /dev/da1s1e /1 # Mount the partition(s)</span>
<span class=c># vi /etc/fstab # Add the appropriate entry/entries to your /etc/fstab.</span></code></pre></div></div><div class=paragraph><p>Si vous avez un disque IDE, remplacez <span class=filename>da</span> par <span class=filename>ad</span>.</p></div></div><div class=sect3><h4 id=_mode_dédié>18.3.2.2. Mode dédié<a class=anchor href=#_mode_dédié></a></h4><div class=paragraph><p>Si le nouveau disque n’est pas destiné a être partagé avec un autre système d’exploitation, vous pouvez utiliser le mode <em>dédié</em>. Rappelez-vous que ce mode peut perturber les systèmes d’exploitation Microsoft; cependant, ils ne toucheront pas au disque. OS/2® d’IBM, au contraire, "s’approprie" toute partition qu’il trouve et ne reconnaît pas.</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># dd if=/dev/zero of=/dev/da1 bs=1k count=1</span>
<span class=c># bsdlabel -Bw da1 auto</span>
<span class=c># bsdlabel -e da1				# create the `e&#39; partition</span>
<span class=c># newfs -d0 /dev/da1e</span>
<span class=c># mkdir -p /1</span>
<span class=c># vi /etc/fstab				# add an entry for /dev/da1e</span>
<span class=c># mount /1</span></code></pre></div></div><div class=paragraph><p>Un autre méthode est:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># dd if=/dev/zero of=/dev/da1 count=2</span>
<span class=c># bsdlabel /dev/da1 | bsdlabel -BR da1 /dev/stdin</span>
<span class=c># newfs /dev/da1e</span>
<span class=c># mkdir -p /1</span>
<span class=c># vi /etc/fstab					# add an entry for /dev/da1e</span>
<span class=c># mount /1</span></code></pre></div></div></div></div></div></div><div class=sect1><h2 id=raid>18.4. RAID<a class=anchor href=#raid></a></h2><div class=sectionbody><div class=sect2><h3 id=raid-soft>18.4.1. RAID logiciel<a class=anchor href=#raid-soft></a></h3><div class=sect3><h4 id=ccd>18.4.1.1. Configuration du pilote de disque concaténé (CCD - "Concatenated Disk Driver")<a class=anchor href=#ccd></a></h4><div class=paragraph><p>Quand il est question du choix d’une solution de stockage de masse les critères de choix les plus importants à considérer sont la vitesse, la fiabilité, et le coût. Il est plutôt rare de pouvoir réunir ces trois critères; normalement un périphérique de stockage rapide et fiable est coûteux, et pour diminuer les coûts la vitesse ou la fiabilité doivent être sacrifiées.</p></div><div class=paragraph><p>A la conception du système décrit plus bas, le coût a été choisi comme facteur le plus important, suivi de la vitesse, et enfin la fiabilité. La vitesse de transfert des données est limitée par le réseau. Et tandis que la fiabilité est très importante, le disque CCD décrit ci-dessous est destiné au stockage de données en ligne qui sont déjà complètement sauvegardées sur CD-Rs et qui peuvent être facilement remplacées.</p></div><div class=paragraph><p>Définir vos propres besoins est la première étape dans le choix d’une solution de stockage de masse. Si vos critères de choix privilégient la vitesse ou la fiabilité par rapport au coût, votre solution diférera du système décrit dans cette section.</p></div><div class=sect4><h5 id=ccd-installhw>18.4.1.1.1. Installation du matériel<a class=anchor href=#ccd-installhw></a></h5><div class=paragraph><p>En plus du disque système IDE, trois disques Western Digital de 30Go, 5400 trs/min IDE forment le coeur du disque CCD décrit ci-dessous donnant approximativement 90Go de stockage en ligne. La solution idéale serait d’avoir pour chaque disque IDE son propre câble et contrôleur IDE, mais pour minimiser les coûts, des contrôleur IDE supplémentaires n’ont pas été utilisés. Aussi, les disques ont été configuré de telle façon que chaque contrôleur IDE ait un disque maître et un disque esclave.</p></div><div class=paragraph><p>Au redémarrage, le BIOS a été configuré pour détecter automatiquement les disques attachés. FreeBSD les a d’ailleurs détectés au redémarrage:</p></div><div class="literalblock programlisting"><div class=content><pre>ad0: 19574MB WDC WD205BA [39770/16/63] at ata0-master UDMA33
ad1: 29333MB WDC WD307AA [59598/16/63] at ata0-slave UDMA33
ad2: 29333MB WDC WD307AA [59598/16/63] at ata1-master UDMA33
ad3: 29333MB WDC WD307AA [59598/16/63] at ata1-slave UDMA33</pre></div></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Si FreeBSD ne détecte pas les disques, assurez-vous que vous avez correctement placé les cavaliers. La plupart des disques IDE disposent également d’un cavalier "Cable Select". Ce n’est <em>pas</em> le cavalier de configuration maître/esclave. Consultez la documentation du disque pour identifier le cavalier correct.</p></div></td></tr></tbody></table></div><div class=paragraph><p>Ensuite, réfléchissez sur la manière de les intégrer au système de fichiers. Vous devriez faire des recherches sur <a href="https://man.freebsd.org/cgi/man.cgi?query=vinum&amp;sektion=8&amp;format=html">vinum(8)</a> (<a href=../vinum/#vinum-vinum>Le gestionnaire de volume Vinum</a>) et <a href="https://man.freebsd.org/cgi/man.cgi?query=ccd&amp;sektion=4&amp;format=html">ccd(4)</a>. Dans cette configuration particulière, <a href="https://man.freebsd.org/cgi/man.cgi?query=ccd&amp;sektion=4&amp;format=html">ccd(4)</a> a été choisi.</p></div></div><div class=sect4><h5 id=ccd-setup>18.4.1.1.2. Configuration du CCD<a class=anchor href=#ccd-setup></a></h5><div class=paragraph><p>Le pilote <a href="https://man.freebsd.org/cgi/man.cgi?query=ccd&amp;sektion=4&amp;format=html">ccd(4)</a> vous permet de prendre plusieurs disques identiques et les concaténer en un seul système de fichiers logique. Afin d’utiliser <a href="https://man.freebsd.org/cgi/man.cgi?query=ccd&amp;sektion=4&amp;format=html">ccd(4)</a>, vous avez besoin d’un noyau avec le support <a href="https://man.freebsd.org/cgi/man.cgi?query=ccd&amp;sektion=4&amp;format=html">ccd(4)</a>. Ajoutez la ligne suivante à votre fichier de configuration de noyau, recompilez, et installez le noyau:</p></div><div class="literalblock programlisting"><div class=content><pre>device   ccd</pre></div></div><div class=paragraph><p>Le support <a href="https://man.freebsd.org/cgi/man.cgi?query=ccd&amp;sektion=4&amp;format=html">ccd(4)</a> peut également chargé sous la forme d’un module noyau.</p></div><div class=paragraph><p>Pour configurer <a href="https://man.freebsd.org/cgi/man.cgi?query=ccd&amp;sektion=4&amp;format=html">ccd(4)</a>, vous devez tout d’abord utiliser <a href="https://man.freebsd.org/cgi/man.cgi?query=bsdlabel&amp;sektion=8&amp;format=html">bsdlabel(8)</a> pour labéliser les disques:</p></div><div class="literalblock programlisting"><div class=content><pre>bsdlabel -w ad1 auto
bsdlabel -w ad2 auto
bsdlabel -w ad3 auto</pre></div></div><div class=paragraph><p>Cela a créé un label de disque <span class=filename>ad1c</span>, <span class=filename>ad2c</span> et <span class=filename>ad3c</span> qui s’étend sur l’intégralité du disque.</p></div><div class=paragraph><p>L’étape suivante est de modifier le type de label de disque. Vous pouvez utiliser <a href="https://man.freebsd.org/cgi/man.cgi?query=bsdlabel&amp;sektion=8&amp;format=html">bsdlabel(8)</a> pour éditer les disques:</p></div><div class="literalblock programlisting"><div class=content><pre>bsdlabel -e ad1
bsdlabel -e ad2
bsdlabel -e ad3</pre></div></div><div class=paragraph><p>Cela ouvre le label de disque actuel de chaque disque dans l’éditeur fixé par la variable d’environnement <code>EDITOR</code>, généralement, <a href="https://man.freebsd.org/cgi/man.cgi?query=vi&amp;sektion=1&amp;format=html">vi(1)</a>.</p></div><div class=paragraph><p>Un label de disque non modifié ressemblera à quelque chose comme ceci:</p></div><div class="literalblock programlisting"><div class=content><pre>8 partitions:
#        size   offset    fstype   [fsize bsize bps/cpg]
  c: 60074784        0    unused        0     0     0   # (Cyl.    0 - 59597)</pre></div></div><div class=paragraph><p>Ajoutez une nouvelle partition <code>e</code> pour être utilisé par <a href="https://man.freebsd.org/cgi/man.cgi?query=ccd&amp;sektion=4&amp;format=html">ccd(4)</a>. Cela peut être une copie de la partition <code>c</code> mais le type de système de fichiers (<code>fstype</code>) doit être <code>4.2BSD</code>. Le label de disque devait ressembler à:</p></div><div class="literalblock programlisting"><div class=content><pre>8 partitions:
#        size   offset    fstype   [fsize bsize bps/cpg]
  c: 60074784        0    unused        0     0     0   # (Cyl.    0 - 59597)
  e: 60074784        0    4.2BSD        0     0     0   # (Cyl.    0 - 59597)</pre></div></div></div><div class=sect4><h5 id=ccd-buildingfs>18.4.1.1.3. Création du système de fichiers<a class=anchor href=#ccd-buildingfs></a></h5><div class=paragraph><p>Maintenant que tous les disques sont labélisés, vous devez construire le <a href="https://man.freebsd.org/cgi/man.cgi?query=ccd&amp;sektion=4&amp;format=html">ccd(4)</a>. Pour cela, utilisez <a href="https://man.freebsd.org/cgi/man.cgi?query=ccdconfig&amp;sektion=8&amp;format=html">ccdconfig(8)</a>, avec des options semblables à ce qui suit:</p></div><div class="literalblock programlisting"><div class=content><pre>ccdconfig ccd0. 32. 0. /dev/ad1e. /dev/ad2e /dev/ad3e</pre></div></div><div class=ulist><ul><li><p>L’utilisation et la signification de chaque option est données ci-dessous:</p></li><li><p>Le premier argument est le périphérique à configurer, dans ce cas, <span class=filename>/dev/ccd0c</span>. La partie <span class=filename>/dev/</span> est optionnelle.</p></li><li><p>L’entrelacement ("interleave") du système de fichiers. L’entrelacement définit la taille d’une bande de blocs disque, de 512 octets chacune normalement. Donc un entrelacement de 32 serait d’une largeur de 16384 octets.</p></li><li><p>Paramètres pour <a href="https://man.freebsd.org/cgi/man.cgi?query=ccdconfig&amp;sektion=8&amp;format=html">ccdconfig(8)</a>. Si vous désirez activer les miroirs disque, vous pouvez spécifier un indicateur à cet endroit. Cette configuration ne fournit pas de miroir pour <a href="https://man.freebsd.org/cgi/man.cgi?query=ccd&amp;sektion=4&amp;format=html">ccd(4)</a>, aussi l’indicateur est a 0 (zéro).
Les derniers arguments de <a href="https://man.freebsd.org/cgi/man.cgi?query=ccdconfig&amp;sektion=8&amp;format=html">ccdconfig(8)</a> sont les périphériques à placer dans le disque concaténé. Utilisez le chemin complet pour chaque périphérique.</p></li></ul></div><div class=paragraph><p>Après avoir utilisé <a href="https://man.freebsd.org/cgi/man.cgi?query=ccdconfig&amp;sektion=8&amp;format=html">ccdconfig(8)</a> le <a href="https://man.freebsd.org/cgi/man.cgi?query=ccd&amp;sektion=4&amp;format=html">ccd(4)</a> est configuré. Un système de fichiers peut être créé. Consultez la page de manuel de <a href="https://man.freebsd.org/cgi/man.cgi?query=newfs&amp;sektion=8&amp;format=html">newfs(8)</a> pour les options disponibles, ou lancez simplement:</p></div><div class="literalblock programlisting"><div class=content><pre>newfs /dev/ccd0c</pre></div></div></div><div class=sect4><h5 id=ccd-auto>18.4.1.1.4. Automatiser la procédure<a class=anchor href=#ccd-auto></a></h5><div class=paragraph><p>Généralement, vous voudrez monter le <a href="https://man.freebsd.org/cgi/man.cgi?query=ccd&amp;sektion=4&amp;format=html">ccd(4)</a> à chaque redémarrage. Pour cela, vous devez le configurer avant toute chose. Ecrivez votre configuration actuelle dans <span class=filename>/etc/ccd.conf</span> en utilisant la commande suivante:</p></div><div class="literalblock programlisting"><div class=content><pre>ccdconfig -g  /etc/ccd.conf</pre></div></div><div class=paragraph><p>Lors du démarrage, la procédure <code>/etc/rc</code> exécute <code>ccdconfig -C</code> si <span class=filename>/etc/ccd.conf</span> existe. Cela configure automatiquement le <a href="https://man.freebsd.org/cgi/man.cgi?query=ccd&amp;sektion=4&amp;format=html">ccd(4)</a> de façon à pouvoir être monté.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Si vous démarrez en mode mono-utilisateur, avant que vous ne puissiez monter le <a href="https://man.freebsd.org/cgi/man.cgi?query=ccd&amp;sektion=4&amp;format=html">ccd(4)</a>, vous devez utiliser la commande suivante pour configurer l’unité:</p></div><div class="literalblock programlisting"><div class=content><pre>ccdconfig -C</pre></div></div></td></tr></tbody></table></div><div class=paragraph><p>Pour monter automatiquement le <a href="https://man.freebsd.org/cgi/man.cgi?query=ccd&amp;sektion=4&amp;format=html">ccd(4)</a> placez une entrées pour le <a href="https://man.freebsd.org/cgi/man.cgi?query=ccd&amp;sektion=4&amp;format=html">ccd(4)</a> dans <span class=filename>/etc/fstab</span>, il sera ainsi monté au démarrage:</p></div><div class="literalblock programlisting"><div class=content><pre>/dev/ccd0c              /media       ufs     rw      2       2</pre></div></div></div></div><div class=sect3><h4 id=vinum>18.4.1.2. Le gestionnaire de volume Vinum<a class=anchor href=#vinum></a></h4><div class=paragraph><p>Le gestionnaire de volume Vinum est un pilote de périphérique de gestion de disques virtuels. Il sépare le disque matériel de l’interface de périphérique bloc et organise les données de telle façon qu’il en résulte une amélioration de la flexibilité, des performances et de la fiabilité, comparé à la vision traditionnelle sous forme partitionnée du stockage disque. <a href="https://man.freebsd.org/cgi/man.cgi?query=vinum&amp;sektion=8&amp;format=html">vinum(8)</a> implémente les modèles RAID-0, RAID-1 et RAID-5, individuellement ou combinés.</p></div><div class=paragraph><p>Voir le <a href=../vinum/#vinum-vinum>Le gestionnaire de volume Vinum</a> pour plus d’information au sujet de <a href="https://man.freebsd.org/cgi/man.cgi?query=vinum&amp;sektion=8&amp;format=html">vinum(8)</a>.</p></div></div></div><div class=sect2><h3 id=raid-hard>18.4.2. RAID Matériel<a class=anchor href=#raid-hard></a></h3><div class=paragraph><p>FreeBSD supporte également de nombreux contrôleurs RAID. Ces périphériques peuvent contrôler un système RAID sans nécessiter l’utilisation d’un logiciel spécifique pour FreeBSD pour gérer l’unité.</p></div><div class=paragraph><p>En utilisant son propre BIOS, la carte contrôle la plupart des opérations disque. Ce qui suit est une description rapide d’une configuration utilisant un contrôleur Promise IDERAID. Quand cette carte est installée et le système redémarré, une invite s’affichera posant quelques questions. Suivez les instructions à l’écran pour atteindre l’écran de configuration de la carte. A partir de là, vous avez la possibilité de combiner tous les disques attachés. En faisant cela, les disques apparaîtront sous la forme d’un unique disque sous FreeBSD. D’autres niveaux RAID peuvent être configurés en conséquence.</p></div></div><div class=sect2><h3 id=_reconstruire_une_unité_ata_raid1>18.4.3. Reconstruire une unité ATA RAID1<a class=anchor href=#_reconstruire_une_unité_ata_raid1></a></h3><div class=paragraph><p>FreeBSD vous permet de remplacer à chaud un disque défectueux dans une unité. Cela doit être fait avant redémarrage.</p></div><div class=paragraph><p>Vous verrez probablement dans <span class=filename>/var/log/messages</span> ou dans la sortie de <a href="https://man.freebsd.org/cgi/man.cgi?query=dmesg&amp;sektion=8&amp;format=html">dmesg(8)</a> quelque chose comme:</p></div><div class="literalblock programlisting"><div class=content><pre>ad6 on monster1 suffered a hard error.
ad6: READ command timeout tag=0 serv=0 - resetting
ad6: trying fallback to PIO mode
ata3: resetting devices .. done
ad6: hard error reading fsbn 1116119 of 0-7 (ad6 bn 1116119; cn 1107 tn 4 sn 11)
status=59 error=40
ar0: WARNING - mirror lost</pre></div></div><div class=paragraph><p>En utilisant <a href="https://man.freebsd.org/cgi/man.cgi?query=atacontrol&amp;sektion=8&amp;format=html">atacontrol(8)</a>, recherchez de plus amples informations:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># atacontrol list</span>
ATA channel 0:
	Master:      no device present
	Slave:   acd0 &lt;HL-DT-ST CD-ROM GCR-8520B/1.00&gt; ATA/ATAPI rev 0

ATA channel 1:
	Master:      no device present
	Slave:       no device present

ATA channel 2:
	Master:  ad4 &lt;MAXTOR 6L080J4/A93.0500&gt; ATA/ATAPI rev 5
	Slave:       no device present

ATA channel 3:
	Master:  ad6 &lt;MAXTOR 6L080J4/A93.0500&gt; ATA/ATAPI rev 5
	Slave:       no device present

<span class=c># atacontrol status ar0</span>
ar0: ATA RAID1 subdisks: ad4 ad6 status: DEGRADED</code></pre></div></div><div class="exampleblock procedure"><div class=content><div class="olist arabic"><ol class=arabic><li><p>Vous devrez détacher le canal ATA avec le disque défectueux de façon à pouvoir le retirer sans risque:</p><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># atacontrol detach ata3</span></code></pre></div></div></li><li><p>Remplacer le disque.</p></li><li><p>Rattacher le canal ATA:</p><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># atacontrol attach ata3</span>
Master:  ad6 &lt;MAXTOR 6L080J4/A93.0500&gt; ATA/ATAPI rev 5
Slave:   no device present</code></pre></div></div></li><li><p>Rajouter le disque de rechange à l’unité:</p><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># atacontrol addspare ar0 ad6</span></code></pre></div></div></li><li><p>Recontruire l’unité:</p><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># atacontrol rebuild ar0</span></code></pre></div></div></li><li><p>Il est possible de contrôler l’avancée de la procédure en utilisant la commande suivante:</p><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># dmesg | tail -10</span>
<span class=o>[</span>output removed]
ad6: removed from configuration
ad6: deleted from ar0 disk1
ad6: inserted into ar0 disk1 as spare

<span class=c># atacontrol status ar0</span>
ar0: ATA RAID1 subdisks: ad4 ad6 status: REBUILDING 0% completed</code></pre></div></div></li><li><p>Attendre jusqu’à la fin de cette opération.</p></li></ol></div></div></div></div></div></div><div class=sect1><h2 id=usb-disks>18.5. Périphériques de stockage USB<a class=anchor href=#usb-disks></a></h2><div class=sectionbody><div class=paragraph><p>De nombreuses solutions de stockage externes utilisent, de nos jours, le bus série universel ("Universal Serial Bus"-USB): disques durs, clés USB, graveurs de CDs, etc. FreeBSD fournit un support pour ces périphériques.</p></div><div class=sect2><h3 id=_configuration>18.5.1. Configuration<a class=anchor href=#_configuration></a></h3><div class=paragraph><p>Le pilote de périphériques USB de stockage de masse, <a href="https://man.freebsd.org/cgi/man.cgi?query=umass&amp;sektion=4&amp;format=html">umass(4)</a>, fournit le support pour les périphériques de stockage USB. Si vous utilisez le noyau <span class=filename>GENERIC</span>, vous n’avez rien à modifier à votre configuration. Si vous utilisez un noyau personnalisé, assurez-vous que les lignes suivantes sont présentent dans votre fichier de configuration du noyau:</p></div><div class="literalblock programlisting"><div class=content><pre>device scbus
device da
device pass
device uhci
device ohci
device usb
device umass</pre></div></div><div class=paragraph><p>Le pilote <a href="https://man.freebsd.org/cgi/man.cgi?query=umass&amp;sektion=4&amp;format=html">umass(4)</a> utilise le sous-système SCSI pour accéder aux périphériques de stockage USB, votre périphérique USB sera vu par le système comme étant un périphérique SCSI. En fonction du contrôleur USB présent sur votre carte mère, vous n’avez besoin qu’une des lignes <code>device uhci</code> et <code>device ohci</code>, cependant avoir les deux lignes dans votre configuration du noyau est sans danger. N’oubliez pas de compiler et d’installer le nouveau noyau si vous y avez effectué des modifications.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Si votre périphérique USB est un graveur de CD ou de DVD, le pilote de périphérique SCSI CD-ROM, <a href="https://man.freebsd.org/cgi/man.cgi?query=cd&amp;sektion=4&amp;format=html">cd(4)</a>, doit être ajouté au noyau via la ligne:</p></div><div class="literalblock programlisting"><div class=content><pre>device cd</pre></div></div><div class=paragraph><p>Puisque le graveur est vu comme un disque SCSI, le pilote <a href="https://man.freebsd.org/cgi/man.cgi?query=atapicam&amp;sektion=4&amp;format=html">atapicam(4)</a> ne devrait pas être employé dans la configuration du noyau.</p></div></td></tr></tbody></table></div><div class=paragraph><p>Le support pour les contrôleurs USB 2.0 est fourni avec FreeBSD vous devez cependant ajouter:</p></div><div class="literalblock programlisting"><div class=content><pre>device ehci</pre></div></div><div class=paragraph><p>à votre fichier de configuration pour bénéficier du support USB 2.0. Notez que les pilotes <a href="https://man.freebsd.org/cgi/man.cgi?query=uhci&amp;sektion=4&amp;format=html">uhci(4)</a> et <a href="https://man.freebsd.org/cgi/man.cgi?query=ohci&amp;sektion=4&amp;format=html">ohci(4)</a> sont toujours nécessaires si vous désirez le support de l’USB 1.X.</p></div></div><div class=sect2><h3 id=_test_de_la_configuration>18.5.2. Test de la configuration<a class=anchor href=#_test_de_la_configuration></a></h3><div class=paragraph><p>La configuration est prête à être testée: branchez votre périphérique USB, et dans le tampon des messages du système (<a href="https://man.freebsd.org/cgi/man.cgi?query=dmesg&amp;sektion=8&amp;format=html">dmesg(8)</a>), le disque devrait apparaître de cette manière:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>umass0: USB Solid state disk, rev 1.10/1.00, addr 2
GEOM: create disk da0 <span class=nv>dp</span><span class=o>=</span>0xc2d74850
da0 at umass-sim0 bus 0 target 0 lun 0
da0: &lt;Generic Traveling Disk 1.11&gt; Removable Direct Access SCSI-2 device
da0: 1.000MB/s transfers
da0: 126MB <span class=o>(</span>258048 512 byte sectors: 64H 32S/T 126C<span class=o>)</span></code></pre></div></div><div class=paragraph><p>Bien évidement, le modèle, le fichier spécial de périphérique (<span class=filename>da0</span>) et d’autres détails peuvent être différents en fonction de votre configuration.</p></div><div class=paragraph><p>Comme le périphérique USB est vu comme étant un périphérique SCSI, la commande <code>camcontrol</code> peut être employée pour lister les périphériques de stockage USB attachés au système:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># camcontrol devlist</span>
&lt;Generic Traveling Disk 1.11&gt;      at scbus0 target 0 lun 0 <span class=o>(</span>da0,pass0<span class=o>)</span></code></pre></div></div><div class=paragraph><p>Si le disque dispose d’un système de fichiers, vous devriez pouvoir le monter. La <a href=#disks-adding>Ajouter des disques</a> vous aidera à formater et créer des partitions sur le disque USB si nécessaire.</p></div><div class=paragraph><p>Pour rendre ce périphérique montable par un utilisateur normal, un certain nombre de paramétrages sont nécessaires. Tout d’abord, les entrées de périphériques qui sont créées lors de la connexion d’un périphérique USB doivent être accessibles à l’utilisateur. Une solution est de faire en sorte que tous les utilisateurs de ces périphériques soient membres du groupe <code>operator</code>. Cela se fait à l’aide de <a href="https://man.freebsd.org/cgi/man.cgi?query=pw&amp;sektion=8&amp;format=html">pw(8)</a>. Ensuite, quand ces entrées de périphériques sont créées, le groupe <code>operator</code> doit pouvoir y accéder en lecture et en écriture. Pour cela, les lignes suivantes sont ajoutées à <span class=filename>/etc/devfs.rules</span>:</p></div><div class="literalblock programlisting"><div class=content><pre>[localrules=1]
add path &#39;da*&#39; mode 0660 group operator</pre></div></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>S’il y a déjà des disques SCSI dans le système, on doit procéder légèrement différemment. Par exemple, si le système contient déjà des disques <span class=filename>da0</span> à <span class=filename>da2</span> attachés au système, changez la seconde ligne pour:</p></div><div class="literalblock programlisting"><div class=content><pre>add path &#39;da[3-9]*&#39; mode 0660 group operator</pre></div></div><div class=paragraph><p>Les disques déjà présents n’appartiendront pas au groupe <code>operator</code>.</p></div></td></tr></tbody></table></div><div class=paragraph><p>Vous devez également activer votre ensemble de règles <a href="https://man.freebsd.org/cgi/man.cgi?query=devfs.rules&amp;sektion=5&amp;format=html">devfs.rules(5)</a> dans votre fichier <span class=filename>/etc/rc.conf</span>:</p></div><div class="literalblock programlisting"><div class=content><pre>devfs_system_ruleset=&#34;localrules&#34;</pre></div></div><div class=paragraph><p>Le noyau doit être ensuite configuré pour autoriser les utilisateurs habituels à monter des systèmes de fichiers. La méthode la plus simple est d’ajouter la ligne suivante au fichier <span class=filename>/etc/sysctl.conf</span>:</p></div><div class="literalblock programlisting"><div class=content><pre>vfs.usermount=1</pre></div></div><div class=paragraph><p>Notez que ce paramétrage ne prendra effet qu’au prochain redémarrage. Il est également possible d’utiliser <a href="https://man.freebsd.org/cgi/man.cgi?query=sysctl&amp;sektion=8&amp;format=html">sysctl(8)</a> pour fixer cette variable.</p></div><div class=paragraph><p>La dernière étape est de créer un répertoire où le système de fichiers sera monté. Ce répertoire doit appartenir à l’utilisateur qui montera le système de fichiers. Une méthode adaptée et la création par <code>root</code> d’un sous-répertoire <span class=filename>/mnt/$USER</span> appartenant à l’utilisateur en question (remplacez <em>$USER</em> par le nom d’utilisateur de cet utilisateur):</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># mkdir /mnt/$USER</span>
<span class=c># chown $USER:$USER /mnt/$USER</span></code></pre></div></div><div class=paragraph><p>Supposez qu’une clé USB soit branchée et qu’un périphérique <span class=filename>/dev/da0s1</span> apparaît. Comme ce type de périphériques est en général livré préformaté avec un système de fichiers de type FAT, on pourra le monter de cette manière:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>% mount <span class=nt>-t</span> msdosfs <span class=nt>-m</span> 644 <span class=nt>-M</span> 755 /dev/da0s1 /mnt/<span class=nv>$USER</span></code></pre></div></div><div class=paragraph><p>Si vous débranchez le périphérique (le disque doit être démonté auparavant), vous devriez voir dans les messages du système quelque chose comme:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>umass0: at uhub0 port 1 <span class=o>(</span>addr 2<span class=o>)</span> disconnected
<span class=o>(</span>da0:umass-sim0:0:0:0<span class=o>)</span>: lost device
<span class=o>(</span>da0:umass-sim0:0:0:0<span class=o>)</span>: removing device entry
GEOM: destroy disk da0 <span class=nv>dp</span><span class=o>=</span>0xc2d74850
umass0: detached</code></pre></div></div></div><div class=sect2><h3 id=_lectures_supplémentaires>18.5.3. Lectures supplémentaires<a class=anchor href=#_lectures_supplémentaires></a></h3><div class=paragraph><p>En plus des sections <a href=#disks-adding>Ajouter des disques</a> et <a href=../basics/#mount-unmount>Monter et démonter des systèmes de fichiers</a>, la lecture de différentes pages de manuel peut être également utile: <a href="https://man.freebsd.org/cgi/man.cgi?query=umass&amp;sektion=4&amp;format=html">umass(4)</a>, <a href="https://man.freebsd.org/cgi/man.cgi?query=camcontrol&amp;sektion=8&amp;format=html">camcontrol(8)</a>, et <a href="https://man.freebsd.org/cgi/man.cgi?query=usbdevs&amp;sektion=8&amp;format=html">usbdevs(8)</a>.</p></div></div></div></div><div class=sect1><h2 id=creating-cds>18.6. Création et utilisation de supports optiques (CDs)<a class=anchor href=#creating-cds></a></h2><div class=sectionbody><div class=sect2><h3 id=_introduction>18.6.1. Introduction<a class=anchor href=#_introduction></a></h3><div class=paragraph><p>Les CDs se différencient des disques conventionnels par de nombreuses caractéristiques. Au départ, ils n’étaient pas inscriptible par l’utilisateur. Ils sont conçu pour être lut de façon continue sans délai pour déplacer la tête de lecture entre les pistes. Ils sont également plus facile à déplacer entre systèmes que les supports de même taille à cette époque.</p></div><div class=paragraph><p>Les CDs possèdent des pistes, mais cela fait référence à un ensemble de données qui peuvent être lues de façon continue et non pas à une particularité physique du disque. Pour produire un CD sous FreeBSD, il faut préparer les fichiers de données qui vont constituer les pistes sur le CD, puis écrire les pistes sur le CD.</p></div><div class=paragraph><p>Le système de fichiers ISO 9660 a été conçu pour gérer ces différences. Malheureusement il incorpore des limites du système de fichiers qui semblaient normale alors. Mais heureusement, il fournit un mécanisme d’extension qui permet au CDs proprement gravés de passer outre ces limites tout en restant lisibles par les systèmes qui ne supportent pas ces extensions.</p></div><div class=paragraph><p>Le logiciel <a class=package href=https://cgit.freebsd.org/ports/tree/sysutils/cdrtools/>sysutils/cdrtools</a> comprend <a href="https://man.freebsd.org/cgi/man.cgi?query=mkisofs&amp;sektion=8&amp;format=html">mkisofs(8)</a>, un programme que vous pouvez utiliser pour produire un fichier de données contenant un système de fichiers ISO 9660. Il dispose d’options pour le support de diverses extensions, et est décrit ci-dessous.</p></div><div class=paragraph><p>L’outil a utiliser pour graver un CD varie en fonction du type de graveur de CD: ATAPI ou autre. Les graveurs ATAPI utilisent le programme <code>burncd</code> qui fait partie du système de base. Les graveurs SCSI ou USB devraient utiliser l’utilitaire <code>cdrecord</code> du logiciel porté <a class=package href=https://cgit.freebsd.org/ports/tree/sysutils/cdrtools/>sysutils/cdrtools</a> port. Il est également possible d’utiliser <code>cdrecord</code> et d’autres outils pour lecteurs SCSI sur du matériel ATAPI avec le <a href=#atapicam>module ATAPI/CAM</a>.</p></div><div class=paragraph><p>Si vous voulez un programme de gravure de CD avec une interface graphique, vous devriez jeter un oeil à X-CD-Roast ou K3b. Ces outils sont disponibles sous une version pré-compilée ou à partir des logiciels portés <a class=package href=https://cgit.freebsd.org/ports/tree/sysutils/xcdroast/>sysutils/xcdroast</a> et <a class=package href=https://cgit.freebsd.org/ports/tree/sysutils/k3b/>sysutils/k3b</a>. X-CD-Roast et K3b nécessitent le <a href=#atapicam>module ATAPI/CAM</a> avec des périphériques ATAPI.</p></div></div><div class=sect2><h3 id=mkisofs>18.6.2. mkisofs<a class=anchor href=#mkisofs></a></h3><div class=paragraph><p>L’utilitaire <a href="https://man.freebsd.org/cgi/man.cgi?query=mkisofs&amp;sektion=8&amp;format=html">mkisofs(8)</a>, qui fait partie du logiciel porté <a class=package href=https://cgit.freebsd.org/ports/tree/sysutils/cdrtools/>sysutils/cdrtools</a>, produit un système de fichiers ISO 9660 qui est une image de l’arborescence des répertoires dans un système de fichiers UNIX®. L’utilisation la plus simple est:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># mkisofs -o fichierimage.iso /chemin/vers/arborescence</span></code></pre></div></div><div class=paragraph><p>Cette commande créera un <em>fichierimage.iso</em> contenant un système de fichiers ISO 9660 qui est une copie de l’arborescence <em>/chemin/vers/arborescence</em>. Durant le processus de création, les noms de fichiers seront modifiés de façon à respecter les limitations de la norme ISO 9660, et rejettera les fichiers ayant des noms non acceptables pour un système de fichiers ISO.</p></div><div class=paragraph><p>De nombreuses options sont disponibles pour passer outre ces restrictions. En particulier, <code>-R</code> qui autorise les extensions Rock Ridge communes aux systèmes UNIX®, <code>-J</code> qui active les extensions Joliet utilisées par les systèmes Microsoft, et <code>-hfs</code> peut être utilisé pour créer des systèmes de fichiers HFS utilisés par Mac OS®.</p></div><div class=paragraph><p>Pour des CDs qui sont destinés à n’être utilisé que sur des systèmes FreeBSD, l’option <code>-U</code> peut être utilisée pour désactiver toutes les restrictions au niveau des noms de fichiers. Quand elle est utilisée avec l’option <code>-R</code>, cela produit une image de système de fichiers qui est identique à l’arborescence FreeBSD d’origine, cependant ce système de fichiers pourra violer la norme ISO 9660 de nombreuses façon.</p></div><div class=paragraph><p>La dernière option d’usage général est l’option <code>-b</code>. Elle est utilisée pour indiquer l’emplacement de l’image de démarrage à utiliser dans la création d’un CD démarrable "El Torito". Cette option prend en argument le chemin vers une image de démarrage à partir de la racine de l’arborescence qui va être copiée sur le CD. Par défaut, <a href="https://man.freebsd.org/cgi/man.cgi?query=mkisofs&amp;sektion=8&amp;format=html">mkisofs(8)</a> créé une image ISO dans un mode appelé "émulation de disquette", et s’attend donc à une image de démarrage de 1200, 1440 ou 2880 Ko en taille. Certains chargeurs, comme celui utilisé par les disques d’installation de FreeBSD, n’utilisent pas ce mode d’émulation, dans ce cas l’option <code>-no-emul-boot</code> devrait être utilisée. Aussi, si <span class=filename>/tmp/monboot</span> contient un système FreeBSD avec une image de démarrage dans <span class=filename>/tmp/monboot/boot/cdboot</span>, vous pourrez produire l’image d’un système de fichiers ISO 9660 dans <span class=filename>/tmp/bootable.iso</span> de cette façon:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># mkisofs -R -no-emul-boot -b boot/cdboot -o /tmp/bootable.iso /tmp/monboot</span></code></pre></div></div><div class=paragraph><p>Cela étant fait, si vous avez le pilote <span class=filename>md</span> configuré dans votre noyau, vous pouvez monter le système de fichiers avec:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># mdconfig -a -t vnode -f /tmp/bootable.iso -u 0</span>
<span class=c># mount -t cd9660 /dev/md0 /mnt</span></code></pre></div></div><div class=paragraph><p>A ce moment vous pouvez vérifier que <span class=filename>/mnt</span> et <span class=filename>/tmp/monboot</span> sont identique.</p></div><div class=paragraph><p>Il existe de nombreuses autres options que vous pouvez utiliser avec <a href="https://man.freebsd.org/cgi/man.cgi?query=mkisofs&amp;sektion=8&amp;format=html">mkisofs(8)</a> pour régler finement son comportement. En particulier: les modifications d’une organisation ISO 9660 et la création de disques Joliet et HFS. Voir la page de manuel <a href="https://man.freebsd.org/cgi/man.cgi?query=mkisofs&amp;sektion=8&amp;format=html">mkisofs(8)</a> pour plus de détails.</p></div></div><div class=sect2><h3 id=burncd>18.6.3. burncd<a class=anchor href=#burncd></a></h3><div class=paragraph><p>Si vous disposez d’un graveur de CD ATAPI, vous pouvez utiliser la commande <code>burncd</code> pour graver une image ISO sur un CD. <code>burncd</code> fait partie du système de base, installé sous <span class=filename>/usr/sbin/burncd</span>. Son utilisation est très simple, car il dispose de peu d’options:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># burncd -f cddevice data fichierimage.iso fixate</span></code></pre></div></div><div class=paragraph><p>Gravera une copie de <em>fichierimage.iso</em> sur <em>cddevice</em>. Le périphérique par défaut est <span class=filename>/dev/acd0</span>. Consultez <a href="https://man.freebsd.org/cgi/man.cgi?query=burncd&amp;sektion=8&amp;format=html">burncd(8)</a> pour les options pour fixer la vitesse d’écriture, éjecter le CD après gravure, et graver des données audios.</p></div></div><div class=sect2><h3 id=cdrecord>18.6.4. cdrecord<a class=anchor href=#cdrecord></a></h3><div class=paragraph><p>Si vous n’avez pas de graveur de CD ATAPI, vous devrez utiliser <code>cdrecord</code> pour graver vos CDs. <code>cdrecord</code> ne fait pas partie du système de base; vous devez l’installer soit à partir du logiciel porté <a class=package href=https://cgit.freebsd.org/ports/tree/sysutils/cdrtools/>sysutils/cdrtools</a> ou de la version pré-compilée appropriée. Des modifications du système de base peuvent provoquer le dysfonctionnement des versions binaires de ce programme, et donner lieu à une production de "dessous de bouteille". Vous devrez par conséquent soit mettre à jour le logiciel porté quand vous mettez à jour votre système, soit si vous <a href=../cutting-edge/#stable>suivez la branche -STABLE</a>, mettre à jour le logiciel porté lorsqu’une nouvelle version est disponible.</p></div><div class=paragraph><p>Bien que <code>cdrecord</code> dispose de nombreuses options, l’usage de base est même plus simple qu’avec <code>burncd</code>. La gravure d’une image ISO 9660 se fait avec:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># cdrecord dev=device fichierimage.iso</span></code></pre></div></div><div class=paragraph><p>La partie délicate dans l’utilisation de <code>cdrecord</code> est la recherche de la valeur à utiliser pour l’option <code>dev</code>. Pour déterminer le bon paramètre à utiliser, utilisez l’indicateur <code>-scanbus</code> de <code>cdrecord</code>, qui produira des résultats du type:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># cdrecord -scanbus</span>
Cdrecord-Clone 2.01 <span class=o>(</span>i386-unknown-freebsd7.0<span class=o>)</span> Copyright <span class=o>(</span>C<span class=o>)</span> 1995-2004 Jörg Schilling
Using libscg version <span class=s1>&#39;schily-0.1&#39;</span>
scsibus0:
        0,0,0     0<span class=o>)</span> <span class=s1>&#39;SEAGATE &#39;</span> <span class=s1>&#39;ST39236LW       &#39;</span> <span class=s1>&#39;0004&#39;</span> Disk
        0,1,0     1<span class=o>)</span> <span class=s1>&#39;SEAGATE &#39;</span> <span class=s1>&#39;ST39173W        &#39;</span> <span class=s1>&#39;5958&#39;</span> Disk
        0,2,0     2<span class=o>)</span> <span class=k>*</span>
        0,3,0     3<span class=o>)</span> <span class=s1>&#39;iomega  &#39;</span> <span class=s1>&#39;jaz 1GB         &#39;</span> <span class=s1>&#39;J.86&#39;</span> Removable Disk
        0,4,0     4<span class=o>)</span> <span class=s1>&#39;NEC     &#39;</span> <span class=s1>&#39;CD-ROM DRIVE:466&#39;</span> <span class=s1>&#39;1.26&#39;</span> Removable CD-ROM
        0,5,0     5<span class=o>)</span> <span class=k>*</span>
        0,6,0     6<span class=o>)</span> <span class=k>*</span>
        0,7,0     7<span class=o>)</span> <span class=k>*</span>
scsibus1:
        1,0,0   100<span class=o>)</span> <span class=k>*</span>
        1,1,0   101<span class=o>)</span> <span class=k>*</span>
        1,2,0   102<span class=o>)</span> <span class=k>*</span>
        1,3,0   103<span class=o>)</span> <span class=k>*</span>
        1,4,0   104<span class=o>)</span> <span class=k>*</span>
        1,5,0   105<span class=o>)</span> <span class=s1>&#39;YAMAHA  &#39;</span> <span class=s1>&#39;CRW4260         &#39;</span> <span class=s1>&#39;1.0q&#39;</span> Removable CD-ROM
        1,6,0   106<span class=o>)</span> <span class=s1>&#39;ARTEC   &#39;</span> <span class=s1>&#39;AM12S           &#39;</span> <span class=s1>&#39;1.06&#39;</span> Scanner
        1,7,0   107<span class=o>)</span> <span class=k>*</span></code></pre></div></div><div class=paragraph><p>Cela donne la valeur <code>dev</code> appropriée pour les périphériques listés. Recherchez votre graveur de CD dans la liste, et utilisez les trois chiffres séparés par une virgule comme valeur pour <code>dev</code>. Dans notre cas le périphérique de gravure est 1,5,0, donc l’entrée appropriée serait <code>dev=1,5,0</code>. Il existe des manières plus simple de spécifier cette valeur, consultez la page de manuel <a href="https://man.freebsd.org/cgi/man.cgi?query=cdrecord&amp;sektion=1&amp;format=html">cdrecord(1)</a> pour des détails. C’est également la documentation à consulter pour des informations sur la gravure de pistes audios, le contrôle de la vitesse, et d’autres choses.</p></div></div><div class=sect2><h3 id=duplicating-audiocds>18.6.5. Dupliquer des CDs Audio<a class=anchor href=#duplicating-audiocds></a></h3><div class=paragraph><p>Vous pouvez dupliquer un CD audio en effectuant l’extraction des données audio du CD vers un ensemble de fichiers, puis graver ces fichiers sur un CD vierge. Le processus est légèrement différent entre lecteurs ATAPI et SCSI.</p></div><div class="exampleblock procedure"><div class=content><div class=paragraph><p><strong>Procedure: Lecteurs SCSI</strong></p></div><div class="olist arabic"><ol class=arabic><li><p>Utiliser <code>cdda2wav</code> pour effectuer l’extraction audio.</p><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>% cdda2wav <span class=nt>-v255</span> <span class=nt>-D2</span>,0 <span class=nt>-B</span> <span class=nt>-Owav</span></code></pre></div></div></li><li><p>Utiliser <code>cdrecord</code> pour graver les fichiers <span class=filename>.wav</span>.</p><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>% cdrecord <span class=nt>-v</span> <span class=nv>dev</span><span class=o>=</span>2,0 <span class=nt>-dao</span> <span class=nt>-useinfo</span>  <span class=k>*</span>.wav</code></pre></div></div><div class=paragraph><p>Assurez-vous que <em>2,0</em> est choisi correctement, comme décrit dans <a href=#cdrecord>cdrecord</a>.</p></div></li></ol></div></div></div><div class="exampleblock procedure"><div class=content><div class=paragraph><p><strong>Procedure: Lecteurs ATAPI</strong></p></div><div class="olist arabic"><ol class=arabic><li><p>Le pilote CD ATAPI rend disponible chaque piste sous la forme <span class=filename>/dev/acddtnn</span>, où <em>d</em> est le numéro de lecteur, et <em>nn</em> est le numéro de la piste écrit sur deux digits décimaux. Donc la première piste sur le premier lecteur est <span class=filename>/dev/acd0t01</span>, la seconde est <span class=filename>/dev/acd0t02</span>, la troisième <span class=filename>/dev/acd0t03</span>, et ainsi de suite.</p><div class=paragraph><p>Assurez-vous que les fichiers appropriés existent sous <span class=filename>/dev</span>. Si ces entrées sont absentes, forcez le système à lire le disque à nouveau:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># dd if=/dev/acd0 of=/dev/null count=1</span></code></pre></div></div></li><li><p>Extraire chaque piste en utilisant <a href="https://man.freebsd.org/cgi/man.cgi?query=dd&amp;sektion=1&amp;format=html">dd(1)</a>. Vous devez également préciser une taille de bloc durant l’extraction des fichiers.</p><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># dd if=/dev/acd0t01 of=piste1.cdr bs=2352</span>
<span class=c># dd if=/dev/acd0t02 of=piste2.cdr bs=2352</span>
...</code></pre></div></div></li><li><p>Graver les fichiers récupérés en utilisant <code>burncd</code>. Vous devez spécifier que ce sont des fichiers audio, et que <code>burncd</code> devra fermer le disque une fois terminé.</p><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># burncd -f /dev/acd0 audio piste1.cdr piste2.cdr ... fixate</span></code></pre></div></div></li></ol></div></div></div></div><div class=sect2><h3 id=imaging-cd>18.6.6. Dupliquer des CDs de données<a class=anchor href=#imaging-cd></a></h3><div class=paragraph><p>vous pouvez copier un CD de données vers un fichier image équivalent au fichier créé avec <a href="https://man.freebsd.org/cgi/man.cgi?query=mkisofs&amp;sektion=8&amp;format=html">mkisofs(8)</a>, et vous pouvez l’utiliser pour dupliquer n’importe quel CD de données. L’exemple présenté ici suppose que votre lecteur de CDROM est les périphérique <span class=filename>acd0</span>. Remplacez-le avec le périphérique correct.</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># dd if=/dev/acd0 of=fichier.iso bs=2048</span></code></pre></div></div><div class=paragraph><p>Vous disposez maintenant d’une image, vous pouvez la graver comme décrit plus haut.</p></div></div><div class=sect2><h3 id=mounting-cd>18.6.7. Utiliser des CDs de données<a class=anchor href=#mounting-cd></a></h3><div class=paragraph><p>Maintenant que vous avez créé une CDROM de données standard, vous voulez probablement le monter et lire les données présentes. Par défaut, <a href="https://man.freebsd.org/cgi/man.cgi?query=mount&amp;sektion=8&amp;format=html">mount(8)</a> suppose que le système de fichier à monter est de type <code>UFS</code>. Si vous essayez quelque chose comme:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># mount /dev/cd0 /mnt</span></code></pre></div></div><div class=paragraph><p>vous obtiendrez une erreur du type <code>Incorrect super block</code>, et pas de montage. Le CDROM n’est pas un système de fichiers de type <code>UFS</code>, aussi toute tentative de montage de ce type échouera. Vous devez juste préciser à <a href="https://man.freebsd.org/cgi/man.cgi?query=mount&amp;sektion=8&amp;format=html">mount(8)</a> que le système de fichiers est du type <code>ISO9660</code>, et tout fonctionnera. Cela se fait en spécifiant l’option <code>-t cd9660</code> option à <a href="https://man.freebsd.org/cgi/man.cgi?query=mount&amp;sektion=8&amp;format=html">mount(8)</a>. Par exemple, si vous désirez monter un CDROM, contenu dans le lecteur <span class=filename>/dev/cd0</span>, sous <span class=filename>/mnt</span>, vous devrez exécuter:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># mount -t cd9660 /dev/cd0 /mnt</span></code></pre></div></div><div class=paragraph><p>Notez que votre nom de lecteur (<span class=filename>/dev/cd0</span> dans cet exemple) pourra être différent, en fonction de l’interface utilisée par votre lecteur de CDROM. De plus l’option <code>-t cd9660</code> ne fait qu’exécuter la commande <a href="https://man.freebsd.org/cgi/man.cgi?query=mount_cd9660&amp;sektion=8&amp;format=html">mount_cd9660(8)</a>. L’exemple précédent pourrait être réduit à:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># mount_cd9660 /dev/cd0 /mnt</span></code></pre></div></div><div class=paragraph><p>Vous pouvez généralement utiliser des CDROMs de données de n’importe quelle provenance de cette façon. Les disques avec certaines extensions ISO 9660 pourront se comporter de façon étrange, cependant. Par exemple, les disques Joliet conservent tous les noms de fichiers en utilisant des caractères Unicodes sur 2 octets. Le noyau FreeBSD ne comprend pas l’Unicode, mais le pilote CD9660 de FreeBSD est en mesure de convertir au vol les caractères Unicode. Si des caractères non-anglais apparaissent sous la forme de points d’interrogation, vous devrez préciser la table de caractères locale que vous utilisez avec l’option <code>-C</code>. Pour plus d’information, consultez la page de manuel <a href="https://man.freebsd.org/cgi/man.cgi?query=mount_cd9660&amp;sektion=8&amp;format=html">mount_cd9660(8)</a>.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Pour pouvoir effectuer cette conversion de caractères à l’aide de l’option <code>-C</code>, le module <span class=filename>cd9660_iconv.ko</span> devra être chargé. Cela peut être fait soit en ajoutant au fichier <span class=filename>loader.conf</span> la ligne:</p></div><div class="literalblock programlisting"><div class=content><pre>cd9660_iconv_load=&#34;YES&#34;</pre></div></div><div class=paragraph><p>puis en redémarrant la machine, soit en chargeant directement le module avec <a href="https://man.freebsd.org/cgi/man.cgi?query=kldload&amp;sektion=8&amp;format=html">kldload(8)</a>.</p></div></td></tr></tbody></table></div><div class=paragraph><p>Occasionnellement, vous pourrez obtenir le message <code>Device not configured</code> (périphérique non configuré) lors d’une tentative de montage d’un CDROM. Cela veut généralement dire que le lecteur de CDROM pense qu’il n’y a pas de disque dans le lecteur, ou que le lecteur n’est pas visible sur le bus. Cela peut demander plusieurs secondes à un lecteur de CDROM de s’apercevoir qu’il a été chargé, soyez donc patient.</p></div><div class=paragraph><p>Parfois, un lecteur de CDROM SCSI peut être manquant parce qu’il n’a pas eu suffisamment de temps pour répondre à la réinitialisation du bus. Si vous avez un lecteur de CDROM SCSI, veuillez ajouter l’option suivante à la configuration de votre noyau et <a href=../kernelconfig/#kernelconfig-building>recompiler votre noyau</a>.</p></div><div class="literalblock programlisting"><div class=content><pre>options SCSI_DELAY=15000</pre></div></div><div class=paragraph><p>Ceci demande à votre bus SCSI une pause de 15 seconds au démarrage, pour donner à votre lecteur de CDROM une chance de répondre la réinitialisation du bus.</p></div></div><div class=sect2><h3 id=rawdata-cd>18.6.8. Graver des CDs de données brutes<a class=anchor href=#rawdata-cd></a></h3><div class=paragraph><p>Il est possible de graver directement un fichier sur CD, sans créer de système de fichiers ISO 9660. Certaines personnes le font dans le cas de sauvegardes. Cela est beaucoup plus rapide que de graver un CD standard:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># burncd -f /dev/acd1 -s 12 data archive.tar.gz fixate</span></code></pre></div></div><div class=paragraph><p>Afin de récupérer les données gravées sur un tel CD, vous devez lire les données à partir du fichier spécial de périphériques en mode caractère:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># tar xzvf /dev/acd1</span></code></pre></div></div><div class=paragraph><p>Vous ne pouvez monter ce disque comme vous le feriez avec un CDROM classique. Un tel CDROM ne pourra être lu sous un autre système d’exploitation en dehors de FreeBSD. Si vous voulez être en mesure de monter le CD, ou d’en partager les données avec un autre système d’exploitation, vous devez utiliser <a href="https://man.freebsd.org/cgi/man.cgi?query=mkisofs&amp;sektion=8&amp;format=html">mkisofs(8)</a> comme décrit plus haut.</p></div></div><div class=sect2><h3 id=atapicam>18.6.9. Utilisation du pilote de périphérique ATAPI/CAM<a class=anchor href=#atapicam></a></h3><div class=paragraph><p>Ce pilote permet d’accéder aux périphériques ATAPI (lecteurs de CD-ROM, graveurs CD-RW, lecteur de DVD etc…​) par l’intermédiaire du sous-système SCSI, et autorise l’utilisation d’applications comme <a class=package href=https://cgit.freebsd.org/ports/tree/sysutils/cdrdao/>sysutils/cdrdao</a> ou <a href="https://man.freebsd.org/cgi/man.cgi?query=cdrecord&amp;sektion=1&amp;format=html">cdrecord(1)</a>.</p></div><div class=paragraph><p>Pour utiliser ce pilote, vous devrez ajouter la ligne suivante au fichier <span class=filename>/boot/loader.conf</span>:</p></div><div class="literalblock programlisting"><div class=content><pre>atapicam_load=&#34;YES&#34;</pre></div></div><div class=paragraph><p>puis redémarrez votre machine.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Si vous préférez compiler en statique dans le noyau le support <a href="https://man.freebsd.org/cgi/man.cgi?query=atapicam&amp;sektion=4&amp;format=html">atapicam(4)</a>, vous devrez ajouter au fichier de configuration du noyau la ligne:</p></div><div class="literalblock programlisting"><div class=content><pre>device atapicam</pre></div></div><div class=paragraph><p>Vous avez également besoin des lignes suivantes dans votre fichier de configuration:</p></div><div class="literalblock programlisting"><div class=content><pre>device ata
device scbus
device cd
device pass</pre></div></div><div class=paragraph><p>qui devraient être déjà présentes. Puis recompilez, installez votre nouveau noyau, et enfin redémarrez votre machine.</p></div></td></tr></tbody></table></div><div class=paragraph><p>Lors du démarrage, votre graveur devrait apparaître, comme suit:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>acd0: CD-RW &lt;MATSHITA CD-RW/DVD-ROM UJDA740&gt; at ata1-master PIO4
cd0 at ata1 bus 0 target 0 lun 0
cd0: &lt;MATSHITA CDRW/DVD UJDA740 1.00&gt; Removable CD-ROM SCSI-0 device
cd0: 16.000MB/s transfers
cd0: Attempt to query device size failed: NOT READY, Medium not present - tray closed</code></pre></div></div><div class=paragraph><p>Le lecteur doit être accessible via le nom de périphérique <span class=filename>/dev/cd0</span>, par exemple pour monter un CD-ROM sous <span class=filename>/mnt</span>, tapez juste ce qui suit:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># mount -t cd9660 /dev/cd0 /mnt</span></code></pre></div></div><div class=paragraph><p>En tant que <code>root</code>, vous pouvez exécuter la commande suivante pour obtenir l’adresse SCSI du graveur:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># camcontrol devlist</span>
&lt;MATSHITA CDRW/DVD UJDA740 1.00&gt;   at scbus1 target 0 lun 0 <span class=o>(</span>pass0,cd0<span class=o>)</span></code></pre></div></div><div class=paragraph><p>Donc <code>1,0,0</code> sera l’adresse SCSI à utiliser avec <a href="https://man.freebsd.org/cgi/man.cgi?query=cdrecord&amp;sektion=1&amp;format=html">cdrecord(1)</a> et tout autre application SCSI.</p></div><div class=paragraph><p>Pour plus d’information concernant ATAPI/CAM et le système SCSI, consultez les pages de manuel <a href="https://man.freebsd.org/cgi/man.cgi?query=atapicam&amp;sektion=4&amp;format=html">atapicam(4)</a> et <a href="https://man.freebsd.org/cgi/man.cgi?query=cam&amp;sektion=4&amp;format=html">cam(4)</a>.</p></div></div></div></div><div class=sect1><h2 id=creating-dvds>18.7. Création et utilisation de supports optiques (DVDs)<a class=anchor href=#creating-dvds></a></h2><div class=sectionbody><div class=sect2><h3 id=_introduction_2>18.7.1. Introduction<a class=anchor href=#_introduction_2></a></h3><div class=paragraph><p>Comparé au CD, le DVD est la génération technologique suivante de support optique de stockage de données. Un DVD peut contenir plus de données qu’un CD et est de nos jour le standard pour la publication de vidéos.</p></div><div class=paragraph><p>Cinq formats physiques enregistrables peuvent être définis pour ce que nous appellerons un DVD enregistrable:</p></div><div class=ulist><ul><li><p>DVD-R: Ce fut le premier format DVD enregistrable disponible. La norme DVD-R est définie par le <a href=http://www.dvdforum.com/forum.shtml>Forum DVD</a>. Ce format n’est pas réinscriptible.</p></li><li><p>DVD-RW: C’est la version réinscriptible du standard DVD-R. Un DVD-RW peut supporter environ 1000 réécritures.</p></li><li><p>DVD-RAM: C’est également un format réinscriptible supporté par le Forum DVD. Un DVD-RAM peut être vu comme un disque dur extractible. Cependant, ce support n’est pas compatible avec la plupart des lecteurs DVD-ROM et DVD-Vidéo; seuls quelques graveurs de DVDs supportent le DVD-RAM. Consultez la <a href=#creating-dvd-ram>Utiliser un disque DVD-RAM</a> pour plus d’information sur l’utilisation d’un DVD-RAM.</p></li><li><p>DVD+RW: C’est un format réinscriptible défini par l' <a href=http://www.dvdrw.com/>Alliance DVD+RW</a>. Un DVD+RW supporte environ 1000 réécritures.</p></li><li><p>DVD+R: Ce format est la version non-réinscriptible du format DVD+RW.</p></li></ul></div><div class=paragraph><p>Un DVD enregistrable simple couche peut contenir jusqu’à 4 700 000 000 octets ce qui équivaut en fait à 4.38 Go ou 4485 Mo (1 kilo-octet représente 1024 octets).</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Une différence doit être faite entre un support physique et son application. Par exemple un DVD-Vidéo est une organisation de fichiers particulière qui peut être écrite sur n’importe quel type de DVD enregistrable: DVD-R, DVD+R, DVD-RW etc. Avant de choisir le type de support, vous devez vous assurer que le graveur et le lecteur de DVD-Vidéo (lecteur de salon ou un lecteur de DVD-ROM sur un micro-ordinateur) sont compatibles avec le support.</p></div></td></tr></tbody></table></div></div><div class=sect2><h3 id=_configuration_2>18.7.2. Configuration<a class=anchor href=#_configuration_2></a></h3><div class=paragraph><p>Le programme <a href="https://man.freebsd.org/cgi/man.cgi?query=growisofs&amp;sektion=1&amp;format=html">growisofs(1)</a> sera utilisé pour effectuer la gravure des DVDs. Cette commande fait partie des utilitaires dvd+rw-tools (<a class=package href=https://cgit.freebsd.org/ports/tree/sysutils/dvd+rw-tools/>sysutils/dvd+rw-tools</a>). Les outils dvd+rw-tools supportent l’ensemble des supports DVD.</p></div><div class=paragraph><p>Ces utilitaires utilisent le sous-système SCSI pour accéder aux périphériques, par conséquent le <a href=#atapicam>support ATAPI/CAM</a> doit être ajouté à votre noyau. Si votre graveur utilise l’interface USB, cet ajout est inutile et vous devriez lire la <a href=#usb-disks>Périphériques de stockage USB</a> sur la configuration de périphériques USB.</p></div><div class=paragraph><p>Vous devez également activer l’accès aux périphériques ATAPI par DMA, cela peut être fait en ajoutant la ligne suivante au fichier <span class=filename>/boot/loader.conf</span>:</p></div><div class="literalblock programlisting"><div class=content><pre>hw.ata.atapi_dma=&#34;1&#34;</pre></div></div><div class=paragraph><p>Avant de tenter d’utiliser les utilitaires dvd+rw-tools vous devriez consulter les <a href=http://fy.chalmers.se/~appro/linux/DVD+RW/hcn.html>notes de compatibilité matérielle des dvd+rw-tools</a> pour des informations concernant votre graveur de DVDs.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Si vous désirez une interface graphique, vous devriez jeter un oeil à K3b (<a class=package href=https://cgit.freebsd.org/ports/tree/sysutils/k3b/>sysutils/k3b</a>) qui offre une interface conviviale à <a href="https://man.freebsd.org/cgi/man.cgi?query=growisofs&amp;sektion=1&amp;format=html">growisofs(1)</a> et à d’autres outils de gravure.</p></div></td></tr></tbody></table></div></div><div class=sect2><h3 id=_graver_des_dvds_de_données>18.7.3. Graver des DVDs de données<a class=anchor href=#_graver_des_dvds_de_données></a></h3><div class=paragraph><p>La commande <a href="https://man.freebsd.org/cgi/man.cgi?query=growisofs&amp;sektion=1&amp;format=html">growisofs(1)</a> est une interface à <a href=#mkisofs>mkisofs</a>, elle invoquera <a href="https://man.freebsd.org/cgi/man.cgi?query=mkisofs&amp;sektion=8&amp;format=html">mkisofs(8)</a> pour la création du système de fichiers et effectuera la gravure des données sur le DVD. Cela signifie que vous n’avez pas besoin de créer une image des données avant le processus de gravure.</p></div><div class=paragraph><p>Pour écrire les données du répertoire <span class=filename>/path/to/data</span>, utilisez la commande suivante:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># growisofs -dvd-compat -Z /dev/cd0 -J -R /path/to/data</span></code></pre></div></div><div class=paragraph><p>Les options <code>-J -R</code> sont passées à <a href="https://man.freebsd.org/cgi/man.cgi?query=mkisofs&amp;sektion=8&amp;format=html">mkisofs(8)</a> pour la création du système de fichiers (dans le cas présent: un système de fichiers ISO 9660 avec les extensions Joliet et Rock Ridge), consultez la page de manuel de <a href="https://man.freebsd.org/cgi/man.cgi?query=mkisofs&amp;sektion=8&amp;format=html">mkisofs(8)</a> pour plus de détails.</p></div><div class=paragraph><p>L’option <code>-Z</code> est utilisée pour la session d’écriture initiale dans tous les cas: multi-sessions ou pas. Le périphérique correspondant au graveur, <em>/dev/cd0</em>, doit être adapté en fonction de votre configuration. Le paramètre <code>-dvd-compat</code> provoquera la fermeture du disque, rien ne pourra être écrit à la suite de l’enregistrement. En retour cela devrait donner lieu à une plus grande compatibilité avec les lecteurs de DVD-ROMs.</p></div><div class=paragraph><p>Il est également possible de graver une image de système de fichiers, par exemple pour graver l’image <em>imagefile.iso</em>, nous lancerons:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># growisofs -dvd-compat -Z /dev/cd0=imagefile.iso</span></code></pre></div></div><div class=paragraph><p>La vitesse d’écriture devrait être détectée et positionnée automatiquement en fonction du support et du graveur utilisé. Si vous voulez forcer la vitesse de gravure, utilisez le paramètre <code>-speed=</code>. Pour plus d’informations, lisez la page de manuel de <a href="https://man.freebsd.org/cgi/man.cgi?query=growisofs&amp;sektion=1&amp;format=html">growisofs(1)</a>.</p></div></div><div class=sect2><h3 id=_graver_un_dvd_vidéo>18.7.4. Graver un DVD-Vidéo<a class=anchor href=#_graver_un_dvd_vidéo></a></h3><div class=paragraph><p>Un DVD-Vidéo est un système de fichiers particulier basé sur les spécifications IS0 9660 et micro-UDF (M-UDF). Le DVD-Vidéo présente également une arborescence de données spécifique, c’est la raison pour laquelle vous devez utiliser un programme particulier tel que <a class=package href=https://cgit.freebsd.org/ports/tree/multimedia/dvdauthor/>multimedia/dvdauthor</a> pour créer le DVD.</p></div><div class=paragraph><p>Si vous disposez déjà d’une image du système de fichiers du DVD-Vidéo, gravez-la de la même façon que pour une autre image, reportez-vous aux sections précédentes pour un exemple. Si vous avez réalisé vous-même l’arborescence du DVD et que le résultat est dans, par exemple, le répertoire <span class=filename>/path/to/video</span>, la commande suivante devrait être utilisée pour graver le DVD-Vidéo:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># growisofs -Z /dev/cd0 -dvd-video /path/to/video</span></code></pre></div></div><div class=paragraph><p>L’option <code>-dvd-video</code> sera passée à <a href="https://man.freebsd.org/cgi/man.cgi?query=mkisofs&amp;sektion=8&amp;format=html">mkisofs(8)</a> et lui demandera de créer un système de fichiers de DVD-Vidéo. De plus, l’option <code>-dvd-video</code> implique l’option <code>-dvd-compat</code> de <a href="https://man.freebsd.org/cgi/man.cgi?query=growisofs&amp;sektion=1&amp;format=html">growisofs(1)</a>.</p></div></div><div class=sect2><h3 id=_utiliser_un_dvdrw>18.7.5. Utiliser un DVD+RW<a class=anchor href=#_utiliser_un_dvdrw></a></h3><div class=paragraph><p>Contrairement à un CD-RW, un DVD+RW vierge doit être formaté avant la première utilisation. Le programme <a href="https://man.freebsd.org/cgi/man.cgi?query=growisofs&amp;sektion=1&amp;format=html">growisofs(1)</a> s’en chargera automatiquement quand cela sera nécessaire, ce qui est la méthode <em>recommandée</em>. Cependant vous pouvez utiliser la commande <code>dvd+rw-format</code> pour formater le DVD+RW:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># dvd+rw-format /dev/cd0</span></code></pre></div></div><div class=paragraph><p>Vous devez effectuer cette opération qu’une seule fois, gardez à l’esprit que seuls des DVD+RW vierges doivent être formatés. Ensuite vous pouvez graver le DVD+RW de la manière vue dans les sections précédentes.</p></div><div class=paragraph><p>Si vous voulez graver de nouvelles données (graver un système de fichiers totalement nouveau et pas juste ajouter des données) sur un DVD+RW, vous n’avez pas besoin de l’effacer, vous avez juste à récrire sur l’enregistrement précédent (en effectuant une nouvelle session initiale), comme ceci:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># growisofs -Z /dev/cd0 -J -R /path/to/newdata</span></code></pre></div></div><div class=paragraph><p>Le format DVD+RW offre la possibilité d’ajouter facilement des données à un enregistrement précédent. L’opération consiste à fusionner une nouvelle session avec la session existante, ceci n’est pas une gravure multisession, <a href="https://man.freebsd.org/cgi/man.cgi?query=growisofs&amp;sektion=1&amp;format=html">growisofs(1)</a> <em>augmentera</em> le système de fichiers ISO 9660 présent sur le disque.</p></div><div class=paragraph><p>Par exemple, si nous voulons ajouter des données à notre DVD+RW précédent, nous devons utiliser cela:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># growisofs -M /dev/cd0 -J -R /path/to/nextdata</span></code></pre></div></div><div class=paragraph><p>Les mêmes options de <a href="https://man.freebsd.org/cgi/man.cgi?query=mkisofs&amp;sektion=8&amp;format=html">mkisofs(8)</a> utilisées lors de la gravure de la session initiale doivent être à nouveau utilisées lors des écritures ultérieures.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Vous pouvez ajouter l’option <code>-dvd-compat</code> si vous désirez une meilleure compatibilité avec les lecteurs de DVD-ROM. Dans le cas d’un DVD+RW cela ne vous empêchera pas de rajouter des données par la suite.</p></div></td></tr></tbody></table></div><div class=paragraph><p>Si pour une quelconque raison vous voulez vraiment effacer le disque, faites ce qui suit:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># growisofs -Z /dev/cd0=/dev/zero</span></code></pre></div></div></div><div class=sect2><h3 id=_utiliser_un_dvd_rw>18.7.6. Utiliser un DVD-RW<a class=anchor href=#_utiliser_un_dvd_rw></a></h3><div class=paragraph><p>Un DVD-RW accepte deux formats de disque: le format séquentiel incrémental et le format "restricted overwrite". Par défaut les disques DVD-RW sont fournis sous le format séquentiel.</p></div><div class=paragraph><p>Un DVD-RW vierge peut être directement gravé sans le besoin d’une opération de formatage préalable, cependant un DVD-RW non-vierge au format séquentiel doit être effacé avant de pouvoir y écrire une nouvelle session initiale.</p></div><div class=paragraph><p>Pour effacer un DVD-RW en mode séquentiel, exécutez:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># dvd+rw-format -blank=full /dev/cd0</span></code></pre></div></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Une opération d’effacement complète (<code>-blank=full</code>) prendra environ une heure avec un support 1x. Un effacement rapide peut être effectué en utilisant l’option <code>-blank</code> si le DVD-RW est destiné à être enregistré suivant le mode d’écriture Disk-At-Once (DAO). Pour écrire le DVD-RW suivant le mode DAO, utilisez la commande:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># growisofs -use-the-force-luke=dao -Z /dev/cd0=imagefile.iso</span></code></pre></div></div><div class=paragraph><p>L’option <code>-use-the-force-luke=dao</code> ne devrait pas être nécessaire puisque <a href="https://man.freebsd.org/cgi/man.cgi?query=growisofs&amp;sektion=1&amp;format=html">growisofs(1)</a> tente de détecter les supports effacés rapidement et engage une écriture DAO.</p></div><div class=paragraph><p>En fait le mode "restricted overwrite" devrait être utilisé avec tout DVD-RW, ce format est plus flexible que le format séquentiel incrémental par défaut.</p></div></td></tr></tbody></table></div><div class=paragraph><p>Pour écrire des données sur un DVD-RW en mode séquentiel, utilisez les mêmes instructions que pour tout autre format de DVD:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># growisofs -Z /dev/cd0 -J -R /path/to/data</span></code></pre></div></div><div class=paragraph><p>Si vous voulez ajouter des données à votre enregistrement précédent, vous devrez utiliser la commande <code>-M</code> de <a href="https://man.freebsd.org/cgi/man.cgi?query=growisofs&amp;sektion=1&amp;format=html">growisofs(1)</a>. Cependant, si vous effectuez un ajout de données sur un DVD-RW en mode séquentiel, une nouvelle session sera créée sur le disque avec pour résultat de donner naissance à un disque multi-sessions.</p></div><div class=paragraph><p>Un DVD-RW dans le format "restricted overwrite" n’a pas besoin d’être effacé avant une nouvelle session initiale, vous avez juste à récrire sur le disque avec l’option <code>-Z</code>, ceci est similaire à un DVD+RW. Il est également possible d’augmenter un système de fichiers ISO 9660 existant écrit sur le disque de la même manière que pour un DVD+RW en utilisant l’option <code>-M</code>. Le résultat sera un DVD avec une seule session.</p></div><div class=paragraph><p>Pour faire passer un DVD-RW dans le format "restricted overwrite", la commande suivante doit être utilisée:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># dvd+rw-format /dev/cd0</span></code></pre></div></div><div class=paragraph><p>Pour revenir au format séquentiel, utilisez:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># dvd+rw-format -blank=full /dev/cd0</span></code></pre></div></div></div><div class=sect2><h3 id=_multi_sessions>18.7.7. Multi-sessions<a class=anchor href=#_multi_sessions></a></h3><div class=paragraph><p>Très peu de lecteurs de DVD-ROMs supportent les DVDs multi-sessions, ils ne liront, dans le meilleur des cas, que la première session. Les DVD+R, DVD-R et DVD-RW en mode séquentiel peuvent accepter de multiples sessions, la notion de multiples sessions n’existe pas pour les formats DVD+RW et DVD-RW en mode "restricted overwrite".</p></div><div class=paragraph><p>Utiliser la commande suivante après une session initiale (non fermée) sur un DVD+R, DVD-R, ou DVD-RW en mode séquentiel, ajoutera une nouvelle session sur le disque:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># growisofs -M /dev/cd0 -J -R /path/to/nextdata</span></code></pre></div></div><div class=paragraph><p>L’utilisation de cette ligne de commande avec un DVD+RW ou un DVD-RW en mode "restricted overwrite" aura pour effet d’ajouter les données en fusionnant la nouvelle session avec celle déjà présente. Le résultat sera un disque mono-session. C’est la méthode utilisée pour ajouter des données sur ces médias après une écriture initiale.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>De l’espace sur le médium est utilisé entre chaque session pour la fin et le début des sessions. Par conséquent, tout ajout de données devrait se faire suivant une quantité importante de données pour optimiser l’espace sur le disque. Le nombre de sessions est limité à 154 pour un DVD+R, environ 2000 pour un DVD-R, et 127 pour un DVD+R double couche.</p></div></td></tr></tbody></table></div></div><div class=sect2><h3 id=_pour_plus_dinformations>18.7.8. Pour plus d’informations<a class=anchor href=#_pour_plus_dinformations></a></h3><div class=paragraph><p>Pour obtenir plus d’informations sur un DVD, la commande <code>dvd+rw-mediainfo /dev/cd0</code> peut être exécutée avec le disque dans le lecteur.</p></div><div class=paragraph><p>Plus d’informations sur les utilitaires dvd+rw-tools peuvent être trouvées dans la page de manuel de <a href="https://man.freebsd.org/cgi/man.cgi?query=growisofs&amp;sektion=1&amp;format=html">growisofs(1)</a>, sur le <a href=http://fy.chalmers.se/~appro/linux/DVD+RW/>site Web de dvd+rw-tools</a> et dans les archives de la <a href=http://lists.debian.org/cdwrite/>liste de diffusion cdwrite</a>.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>La sortie de la commande <code>dvd+rw-mediainfo</code> sur le résultat de la gravure ou le disque posant problème est obligatoire avec tout rapport de problème. Sans cette sortie, il sera quasiment impossible de vous aider.</p></div></td></tr></tbody></table></div></div><div class=sect2><h3 id=creating-dvd-ram>18.7.9. Utiliser un disque DVD-RAM<a class=anchor href=#creating-dvd-ram></a></h3><div class=sect3><h4 id=_configuration_3>18.7.9.1. Configuration<a class=anchor href=#_configuration_3></a></h4><div class=paragraph><p>Les graveurs de DVD-RAM sont fournis soit avec une interface SCSI soit une interface ATAPI. Dans le cas des périphériques ATAPI, l’accès DMA doit être activé, cela peut être fait en ajoutant la ligne suivante au fichier <span class=filename>/boot/loader.conf</span>:</p></div><div class="literalblock programlisting"><div class=content><pre>hw.ata.atapi_dma=&#34;1&#34;</pre></div></div></div><div class=sect3><h4 id=_préparer_le_disque>18.7.9.2. Préparer le disque<a class=anchor href=#_préparer_le_disque></a></h4><div class=paragraph><p>Comme précisé dans l’introduction de cette section, un DVD-RAM peut être vu comme un disque dur extractible. Comme tout autre disque dur le DVD-RAM doit être "préparé" avant la première utilisation. Dans l’exemple, l’intégralité de l’espace sur le disque sera utilisé par un système de fichiers UFS2 standard:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># dd if=/dev/zero of=/dev/acd0 count=2</span>
<span class=c># bsdlabel -Bw acd0</span>
<span class=c># newfs /dev/acd0</span></code></pre></div></div><div class=paragraph><p>Le périphérique DVD <span class=filename>acd0</span> doit être modifié en fonction de la configuration.</p></div></div><div class=sect3><h4 id=_utiliser_le_disque>18.7.9.3. Utiliser le disque<a class=anchor href=#_utiliser_le_disque></a></h4><div class=paragraph><p>Une fois les opérations précédentes effectuées sur le DVD-RAM, il peut être monté comme un disque dur classique:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># mount /dev/acd0 /mnt</span></code></pre></div></div><div class=paragraph><p>Après cela, on pourra lire et écrire sur le DVD-RAM.</p></div></div></div></div></div><div class=sect1><h2 id=floppies>18.8. Création et utilisation de disquettes<a class=anchor href=#floppies></a></h2><div class=sectionbody><div class=paragraph><p>Sauvegarder des données sur disquette est parfois utile, par exemple quand on a pas d’autre support de stockage amovible de disponible ou quand on doit transférer de petites quantités de données sur un autre ordinateur.</p></div><div class=paragraph><p>Cette section expliquera comment utiliser des disquettes sous FreeBSD. Elle couvrira principalement le formatage et l’utilisation de disquettes DOS de 3.5pouces, mais les concepts exposés sont identiques pour d’autres formats de disquettes.</p></div><div class=sect2><h3 id=_formater_des_disquettes>18.8.1. Formater des disquettes<a class=anchor href=#_formater_des_disquettes></a></h3><div class=sect3><h4 id=_le_périphérique>18.8.1.1. Le périphérique<a class=anchor href=#_le_périphérique></a></h4><div class=paragraph><p>On accède aux disquettes par l’intermédiaire d’entrées dans <span class=filename>/dev</span>, comme pour tout autre périphérique. Pour accéder directement à la disquette, utilisez simplement <span class=filename>/dev/fdN</span>.</p></div></div><div class=sect3><h4 id=_le_formatage>18.8.1.2. Le formatage<a class=anchor href=#_le_formatage></a></h4><div class=paragraph><p>Une disquette doit subir un formatage bas niveau avant d’être utilisable. Il est généralement réalisé par le constructeur, mais le formatage est une bonne manière de contrôler l’intégrité du support. Bien qu’il soit possible de forcer une plus grande (ou plus petite) capacité, 1440Ko est celle pour laquelle sont conçues la plupart des disquettes.</p></div><div class=paragraph><p>Pour effectuer un formatage bas niveau d’une disquette vous devez utiliser <a href="https://man.freebsd.org/cgi/man.cgi?query=fdformat&amp;sektion=1&amp;format=html">fdformat(1)</a>. L’utilitaire attend le nom du périphérique en argument.</p></div><div class=paragraph><p>Notez tout message d’erreur, sachant que cela peut aider à déterminer si la disquette est bonne ou défectueuse.</p></div><div class=sect4><h5 id=_formatage_des_disquettes>18.8.1.2.1. Formatage des disquettes<a class=anchor href=#_formatage_des_disquettes></a></h5><div class=paragraph><p>Utilisez un des périphériques <span class=filename>/dev/fdN.size</span>, pour formater la disquette. Insérez une disquette 3.5pouces dans votre lecteur et tapez:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># /usr/sbin/fdformat -f 1440 /dev/fd0</span></code></pre></div></div></div></div></div><div class=sect2><h3 id=_le_label_de_disque>18.8.2. Le label de disque<a class=anchor href=#_le_label_de_disque></a></h3><div class=paragraph><p>Après le formatage bas niveau du disque, vous devrez y placer un label de disque. Ce label sera détruit plus tard, mais il est nécessaire au système pour déterminer par la suite la taille et la géométrie du disque.</p></div><div class=paragraph><p>Le nouveau label de disque prendra l’intégralité du disque, et contiendra l’information correcte sur la géométrie de la disquette. Les différentes géométries possibles pour le label sont listées dans <span class=filename>/etc/disktab</span>.</p></div><div class=paragraph><p>Vous pouvez maintenant exécuter <a href="https://man.freebsd.org/cgi/man.cgi?query=bsdlabel&amp;sektion=8&amp;format=html">bsdlabel(8)</a> de la façon suivante:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># /sbin/bsdlabel -B -w /dev/fd0 fd1440</span></code></pre></div></div></div><div class=sect2><h3 id=_le_système_de_fichiers>18.8.3. Le système de fichiers<a class=anchor href=#_le_système_de_fichiers></a></h3><div class=paragraph><p>La disquette est maintenant fin prête pour un formatage haut niveau. Cette opération placera un nouveau système de fichiers sur la disquette, qui permettra à FreeBSD d’écrire et de lire sur le disque. Après la création du nouveau système de fichiers, le label disque est détruit, aussi si vous désirez reformater le disque, vous devrez recréer le label de disque à nouveau.</p></div><div class=paragraph><p>Le système de fichiers de la disquette peut soit être de l’UFS soit utiliser le système FAT. Le système FAT est généralement un meilleur choix pour les disquettes.</p></div><div class=paragraph><p>Pour placer un nouveau système de fichier sur la disquette faites ceci:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># /sbin/newfs_msdos /dev/fd0</span></code></pre></div></div><div class=paragraph><p>La disquette est maintenant prête à être utilisée.</p></div></div><div class=sect2><h3 id=_utilisation_de_la_disquette>18.8.4. Utilisation de la disquette<a class=anchor href=#_utilisation_de_la_disquette></a></h3><div class=paragraph><p>Pour utiliser la disquette, montez-la avec <a href="https://man.freebsd.org/cgi/man.cgi?query=mount_msdosfs&amp;sektion=8&amp;format=html">mount_msdosfs(8)</a>. On peut également utiliser <a class=package href=https://cgit.freebsd.org/ports/tree/emulators/mtools/>emulators/mtools</a> du catalogue des logiciels portés.</p></div></div></div></div><div class=sect1><h2 id=backups-tapebackups>18.9. Créer et utiliser les bandes magnétiques<a class=anchor href=#backups-tapebackups></a></h2><div class=sectionbody><div class=paragraph><p>Les principaux types de bandes sont les 4mm, 8mm, QIC, les mini-cartouches et les DLTs.</p></div><div class=sect2><h3 id=backups-tapebackups-4mm>18.9.1. Bandes 4mm (DDS: "Digital Data Storage")<a class=anchor href=#backups-tapebackups-4mm></a></h3><div class=paragraph><p>Les bandes 4mm sont en train de remplacer les bandes QIC comme le format usuel de sauvegarde pour les stations de travail. Cette tendance s’est accélérée quand Conner a racheté Archive, un des leaders de la fabrication des lecteurs QIC, et a arrêté la production de ces derniers. Les lecteurs 4mm sont petits et silencieux mais n’ont pas la réputation de fiabilité des lecteurs 8mm. Les cartouches sont moins coûteuse et plus petites (3 x 2 x 0.5 pouces, 76 x 51 x 12 mm) que les cartouches 8mm. Les cartouches 4mm, tout comme les 8mm, ont une durée de vie faible car elles utilisent un procédé de lecture/écriture en hélice.</p></div><div class=paragraph><p>Le débit de ces lecteurs va de ~150 Ko/s à ~500 Ko/s au maximum. Leur capacité de varie de 1.3 Go à 2.0 Go. La compression matérielle, disponible sur la plupart des lecteurs, double approximativement leur capacité. Les unités multi-lecteurs peuvent avoir jusqu’à 6 lecteurs dans une seule tour avec changement automatique de bande. La capacité totale atteint 240 Go.</p></div><div class=paragraph><p>Le standard DDS-3 supporte maintenant des capacités de bande jusqu’à 12 Go (ou 24 Go compressés).</p></div><div class=paragraph><p>Les lecteurs 4mm, comme les lecteurs 8mm, utilisent un procédé de lecture/écriture en hélice. Tous les avantages et les inconvénients de ce procédé s’appliquent aux deux types de lecteurs.</p></div><div class=paragraph><p>Les bandes doivent être changées après 2000 utilisations ou 100 sauvegardes complètes.</p></div></div><div class=sect2><h3 id=backups-tapebackups-8mm>18.9.2. Bandes 8mm (Exabyte)<a class=anchor href=#backups-tapebackups-8mm></a></h3><div class=paragraph><p>Les unités de bandes 8mm sont les lecteurs de bandes SCSI les plus courant; c’est le meilleur choix de bandes amovibles. Presque chaque site dispose d’une unité Exabyte 2 Go 8mm. Les lecteurs 8mm sont fiables, pratiques et silencieux. Les cartouches sont bon marché et d’encombrement faible (4.8 x 3.3 x 0.6 pouces; 122 x 84 x 15 mm). Un des inconvénients de la bande 8mm est la durée de vie relativement courte des bandes et des têtes de lectures en raison de la grande vitesse de défilement de la bande devant les têtes.</p></div><div class=paragraph><p>Leur débit va de ~250 Ko/s à ~500 Ko/s. Leur capacité commence à 300 Mo jusqu’à 7 Go. La compression matérielle, disponible sur la plupart des lecteurs, double approximativement la capacité. Ces lecteurs sont disponibles sous forme d’unité simple ou multiple accueillant 6 lecteurs et 120 bandes. Les bandes sont changées automatiquement par l’unité. Ils peuvent gérer une capacité de stockage de plus de 840 Go.</p></div><div class=paragraph><p>Le lecteur Exabyte "Mammoth" supporte 12 Go sur une seule bande (24 Go compressé) et coûte approximativement le double d’un lecteur classique.</p></div><div class=paragraph><p>L’enregistrement des données sur la bande utilise un procédé en hélice, les têtes sont positionnées en biais par rapport à la bande (environ 6 degrés). La bande fait un angle de 270 degrés avec le cylindre sur lequel se trouvent les têtes. Ce cylindre tourne en même temps que la bande défile. Il en résulte donc une grande densité de données et des pistes très serrées qui vont de biais d’un bord à l’autre de la bande.</p></div></div><div class=sect2><h3 id=backups-tapebackups-qic>18.9.3. QIC<a class=anchor href=#backups-tapebackups-qic></a></h3><div class=paragraph><p>Les bandes et les lecteurs QIC-150 sont, peut-être, le format le plus courant. Les lecteurs QIC sont les moins chers des supports de sauvegarde "sérieux". Leur inconvénient par contre est le coût des bandes. Les bandes QIC sont chères comparées aux bandes 8mm ou 4mm, jusqu’à 5 fois le coût au Go. Mais, si une demi-douzaine de bandes vous suffit, le format QIC peut être le bon choix. QIC est le format le <em>plus</em> répandu. Chaque site dispose d’un lecteur QIC d’une densité ou d’une autre. C’est là la difficulté, il existe de nombreuses densités pour des bandes physiquement semblables (parfois même identiques). Les lecteurs QIC ne sont pas silencieux. Ces lecteurs se positionnent bruyamment avant d’enregistrer des données et ont les entend clairement lors de lecture, écriture ou recherche. Les bandes QIC sont volumineuses: 6 x 4 x 0.7 pouces (152 x 102 x 17 mm).</p></div><div class=paragraph><p>Leur débit va de ~150 Ko/s à ~500 Ko/s. Leur capacité varie de 40 Mo à 15 Go. La compression matérielle est disponible sur de nombreux lecteurs récents. Les lecteurs QIC sont de moins en moins utilisés, ils sont supplantés par les lecteurs DAT.</p></div><div class=paragraph><p>Les données sont enregistrées sur des pistes sur la bande. Les pistes sont parallèles à la bande et vont d’une extrémité à l’autre. Le nombre de piste, et par conséquent la largeur des pistes, varie avec la capacité de la bande. La plupart des nouveaux lecteurs fournissent au moins une compatibilité descendante en lecture (mais aussi en écriture). Le format QIC a une bonne réputation de sécurité des données (la mécanique est plus simple et plus robuste que les lecteurs à système en hélice).</p></div><div class=paragraph><p>Les bandes devraient être changée après 5000 sauvegardes.</p></div></div><div class=sect2><h3 id=backups-tapebackups-dlt>18.9.4. DLT<a class=anchor href=#backups-tapebackups-dlt></a></h3><div class=paragraph><p>Les DLT ont le taux de transfert le plus élevé de tous les types de lecteurs décrits ici. La bande d'1/2" (12.5mm) est contenue dans une seule cartouche (4 x 4 x 1 pouces; 100 x 100 x 25 mm). La cartouche est munie d’une trappe basculante le long d’un côté de la cartouche. Le lecteur ouvre cette trappe pour saisir l’amorce de la bande. Cette amorce comporte une découpe ovale que le lecteur utilise pour "crocheter" la bande. La bobine d’entraînement est située dans le lecteur. Tous les autres types de cartouches décrits ici (les bandes 9 pistes sont la seule exception) ont les bobines de stockage et d’entraînement dans la cartouche elle-même.</p></div><div class=paragraph><p>Leur débit est d’environ 1.5 Mo/s, trois fois celui des lecteurs 4mm, 8mm, ou QIC. La capacité d’une bande varie de 10 Go à 20 Go pour une unité simple. Les lecteurs sont disponibles en unités multi-bandes avec changeurs et multi-lecteurs contenant de 5 à 900 bandes et 1 à 20 lecteurs, fournissant une capacité de stockage allant de 50 Go à 9 TO.</p></div><div class=paragraph><p>Avec la compression, le format DLT type IV supporte jusqu’à une capacité de 70 Go.</p></div><div class=paragraph><p>Les données sont enregistrées sur la bande sur des pistes parallèles à la direction de défilement (comme pour les bandes QIC). Deux pistes sont écrites à la fois. La durée de vie des têtes de lecture/écriture est relativement longue; une fois que la bande s’arrête, il n’y a pas de déplacement des têtes par rapport à la bande.</p></div></div><div class=sect2><h3 id=_ait>18.9.5. AIT<a class=anchor href=#_ait></a></h3><div class=paragraph><p>AIT est le nouveau format de Sony, il peut supporter jusqu’à 50 Go par bande (avec compression). Les bandes contiennent un circuit mémoire qui contient un index du contenu de la bande. Cet index peut être lu rapidement par le lecteur pour déterminer l’emplacement de fichiers sur la bande, au lieu des nombreuses minutes nécessaires aux autres types de bande. Des programmes comme SAMS:Alexandria peuvent contrôler quarante ou plus ensemble de bandes AIT, communiquant directement avec le circuit mémoire de la bande pour en afficher le contenu à l’écran, déterminer quels fichiers ont été sauvegardé sur quelle bande, localiser la bonne bande, la charger, et en restaurer les données.</p></div><div class=paragraph><p>Les ensembles de ce type reviennent aux alentour des 20000 dollars, les rendant inaccessibles à l’amateur éclairé.</p></div></div><div class=sect2><h3 id=_utiliser_une_bande_neuve_pour_la_première_fois>18.9.6. Utiliser une bande neuve pour la première fois<a class=anchor href=#_utiliser_une_bande_neuve_pour_la_première_fois></a></h3><div class=paragraph><p>La première fois que vous essayez de lire ou d’écrire sur une bande vierge, l’opération échoue. Les messages affichés par la console devraient être du type:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>sa0<span class=o>(</span>ncr1:4:0<span class=o>)</span>: NOT READY asc:4,1
sa0<span class=o>(</span>ncr1:4:0<span class=o>)</span>:  Logical unit is <span class=k>in </span>process of becoming ready</code></pre></div></div><div class=paragraph><p>La bande ne contient pas de bloc d’identification (bloc numéro 0). Tous les lecteurs QIC depuis l’adoption du standard QIC-525 écrivent un bloc d’identification sur la bande. Il y a alors deux solutions:</p></div><div class=ulist><ul><li><p><code>mt fsf 1</code> fait écrire au lecteur un bloc d’identification sur la bande.</p></li><li><p>Utiliser le bouton en face avant pour éjecter la bande.</p><div class=paragraph><p>Ré-insérer la bande et utiliser <a href="https://man.freebsd.org/cgi/man.cgi?query=dump&amp;sektion=8&amp;format=html">dump(8)</a> pour écrire dessus.</p></div><div class=paragraph><p><a href="https://man.freebsd.org/cgi/man.cgi?query=dump&amp;sektion=8&amp;format=html">dump(8)</a> produira l’erreur <code>DUMP: End of tape detected</code> et la console affichera: <code>HARDWARE FAILURE info:280 asc:80,96</code>.</p></div><div class=paragraph><p>Rembobiner la bande avec: <code>mt rewind</code>.</p></div><div class=paragraph><p>Les manipulations ultérieures sur la bande fonctionneront.</p></div></li></ul></div></div></div></div><div class=sect1><h2 id=backups-floppybackups>18.10. Sauvegardes sur disquettes<a class=anchor href=#backups-floppybackups></a></h2><div class=sectionbody><div class=sect2><h3 id=floppies-using>18.10.1. Puis-je utiliser des disquettes pour la sauvegarde des mes données?<a class=anchor href=#floppies-using></a></h3><div class=paragraph><p>Les disquettes ne sont pas des supports adaptés à la réalisation de sauvegardes étant donné que:</p></div><div class=ulist><ul><li><p>Le support n’est pas fiable, spécialement sur de longues périodes de temps.</p></li><li><p>Les opérations de sauvegarde et de restauration sont très lentes.</p></li><li><p>Elles ont une capacité très limitée (le jour où l’on pourra sauvegarder l’intégralité d’un disque dur sur une douzaine de disquette n’est pas encore arrivé).</p></li></ul></div><div class=paragraph><p>Cependant, si vous n’avez pas d’autres méthodes pour sauvegarder vos données alors les disquettes sont mieux que pas de sauvegardes du tout.</p></div><div class=paragraph><p>Si vous devez utiliser les disquettes, alors assurez-vous que vous en utiliser des disquettes de bonne qualité. Les disquettes qui traînent sur le bureau depuis quelques années sont un mauvais choix. Idéalement utilisez de des disquettes neuves en provenance d’un fabricant renommé.</p></div></div><div class=sect2><h3 id=floppies-creating>18.10.2. Alors, comment je sauvegarde mes données sur disquettes?<a class=anchor href=#floppies-creating></a></h3><div class=paragraph><p>La meilleur façon de sauvegarder sur disquette est d’utiliser la commande <a href="https://man.freebsd.org/cgi/man.cgi?query=tar&amp;sektion=1&amp;format=html">tar(1)</a> avec l’option <code>-M</code> (volume multiple), qui autorise la répartition des sauvegardes sur plusieurs disquettes.</p></div><div class=paragraph><p>Pour sauvegarder tous les fichiers du répertoire courant et des sous-répertoires (en tant que <code>root</code>):</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># tar Mcvf /dev/fd0 *</span></code></pre></div></div><div class=paragraph><p>Quand la première disquette est pleine <a href="https://man.freebsd.org/cgi/man.cgi?query=tar&amp;sektion=1&amp;format=html">tar(1)</a> vous réclamera d’introduire le volume suivant (parce que <a href="https://man.freebsd.org/cgi/man.cgi?query=tar&amp;sektion=1&amp;format=html">tar(1)</a> est indépendant du support il parle en terme de volume; dans notre contexte cela signifie disquette).</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>Prepare volume 2 <span class=k>for</span> /dev/fd0 and hit <span class=k>return</span>:</code></pre></div></div><div class=paragraph><p>Cette opération est répétée (avec incrémentation du numéro de volume) jusqu’à ce que les fichiers spécifiés soient sauvegardés.</p></div></div><div class=sect2><h3 id=floppies-compress>18.10.3. Puis-je sauvegarder mes sauvegardes?<a class=anchor href=#floppies-compress></a></h3><div class=paragraph><p>Malheureusement, <a href="https://man.freebsd.org/cgi/man.cgi?query=tar&amp;sektion=1&amp;format=html">tar(1)</a> ne permettra pas l’utilisation de l’option <code>-z</code> pour les archives multi-volumes. Vous pourrez, bien sûr, utiliser <a href="https://man.freebsd.org/cgi/man.cgi?query=gzip&amp;sektion=1&amp;format=html">gzip(1)</a> sur tous les fichiers, les archiver avec <a href="https://man.freebsd.org/cgi/man.cgi?query=tar&amp;sektion=1&amp;format=html">tar(1)</a> sur disquettes, puis décompresser les fichiers avec <a href="https://man.freebsd.org/cgi/man.cgi?query=gunzip&amp;sektion=1&amp;format=html">gunzip(1)</a>!</p></div></div><div class=sect2><h3 id=floppies-restoring>18.10.4. Comment puis-je restaurer mes sauvegardes?<a class=anchor href=#floppies-restoring></a></h3><div class=paragraph><p>Pour restaurer une archive complète utiliser:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># tar Mxvf /dev/fd0</span></code></pre></div></div><div class=paragraph><p>Vous pouvez utiliser deux manières pour restaurer uniquement certains fichiers. Tout d’abord, vous pouvez commencer avec la première disquette et utiliser:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># tar Mxvf /dev/fd0 nomdufichier</span></code></pre></div></div><div class=paragraph><p><a href="https://man.freebsd.org/cgi/man.cgi?query=tar&amp;sektion=1&amp;format=html">tar(1)</a> vous demandera d’insérer les disquettes suivantes jusqu’à trouver le fichier recherché.</p></div><div class=paragraph><p>Alternativement, si vous savez sur quelle disquette le fichier se trouve alors vous pouvez simplement insérer cette disquette et utiliser la commande précédente. Notez que si le premier fichier sur la disquette est la suite d’un fichier de la précédente disquette alors <a href="https://man.freebsd.org/cgi/man.cgi?query=tar&amp;sektion=1&amp;format=html">tar(1)</a> vous avertira qu’il ne peut le restaurer, même si vous ne le voulez pas!</p></div></div></div></div><div class=sect1><h2 id=backup-strategies>18.11. Stratégies de sauvegarde<a class=anchor href=#backup-strategies></a></h2><div class=sectionbody><div class=paragraph><p>La première chose a faire lors de la mise en place d’un plan de sauvegarde est de s’assurer que l’ensemble des problèmes suivants sera couvert:</p></div><div class=ulist><ul><li><p>Panne d’un disque</p></li><li><p>Suppression accidentelle de fichiers</p></li><li><p>Corruption aléatoire de fichiers</p></li><li><p>Destruction complète de la machine (par exemple suite à un incendie), avec destruction des sauvegardes stockées sur le même site.</p></li></ul></div><div class=paragraph><p>Il est parfaitement possible que certains systèmes utilisent une technique différente pour chacun des problèmes évoqués ci-dessus. En dehors des systèmes personnels avec des données peu importantes, il est peu probable qu’une seule technique puisse répondre à l’ensemble de ces risques.</p></div><div class=paragraph><p>Quelques-unes des techniques à notre disposition sont:</p></div><div class=ulist><ul><li><p>Des archives de tout le système, sauvegardées sur un support fiable et à l’extérieur du site. C’est une protection réelle contre tous les problèmes précédemment cités, mais cette méthode est lente et peu pratique lors des restaurations. Vous pouvez conserver des copies de ces sauvegardes sur site et/ou en ligne, mais il y aura toujours des difficultés lors de la restauration des fichiers, en particulier pour les utilisateurs sans droits.</p></li><li><p>Instantané de systèmes de fichiers. Cet outil n’est vraiment utile que dans le cas d’une suppression accidentelle de fichiers, mais il l’est <em>vraiment</em> dans ce cas; de plus cette méthode est rapide et simple à employer.</p></li><li><p>Copies de l’intégralité des systèmes de fichiers et/ou des disques (par une utilisation régulière de <a href="https://man.freebsd.org/cgi/man.cgi?query=rsync&amp;sektion=1&amp;format=html">rsync(1)</a> sur l’intégralité de la machine par exemple). C’est le procédé en général le plus utile dans le cas des réseaux avec des besoins spécifiques. Dans le cas d’une protection contre les pannes disques, cette méthode est normalement inférieure à un système RAID. Pour la restauration de fichiers supprimés accidentellement, c’est comparable aux instantanés UFS, c’est plus une question de préférence.</p></li><li><p>RAID. Réduit ou évite les périodes où le système est inutilisable quand un disque tombe en panne. Avec l’inconvénient d’avoir à faire face à des pannes disques plus fréquentes (parce que vous utilisez plus de disques), mais avec cependant une moindre urgence.</p></li><li><p>Le contrôle des empreintes de fichiers. L’utilitaire <a href="https://man.freebsd.org/cgi/man.cgi?query=mtree&amp;sektion=8&amp;format=html">mtree(8)</a> est très utile dans ce cas. Bien que cela ne soit pas une technique de sauvegarde des données, ce contrôle aidera à garantir que vous serez averti quand vous devrez ressortir vos sauvegardes. C’est tout particulièrement important dans le cas de sauvegardes hors site, et ces empreintes devraient être vérifiées régulièrement.</p></li></ul></div><div class=paragraph><p>Il est relativement simple de trouver d’autres solutions, nombreuses sont celles qui sont des variations des techniques présentées ci-dessus. Des besoins spécifiques conduiront généralement à des solutions spécifiques (par exemple sauvegarder une base de données durant son utilisation demande une étape intermédiaire spécifique au logiciel de base de données). L’important est de connaître les dangers contre lesquels vous désirez vous protéger, et comment vous ferez face à chacun d’entre eux.</p></div></div></div><div class=sect1><h2 id=backup-basics>18.12. Sauvegardes<a class=anchor href=#backup-basics></a></h2><div class=sectionbody><div class=paragraph><p>Les trois principaux programmes de sauvegarde sont: <a href="https://man.freebsd.org/cgi/man.cgi?query=dump&amp;sektion=8&amp;format=html">dump(8)</a>, <a href="https://man.freebsd.org/cgi/man.cgi?query=tar&amp;sektion=1&amp;format=html">tar(1)</a>, et <a href="https://man.freebsd.org/cgi/man.cgi?query=cpio&amp;sektion=1&amp;format=html">cpio(1)</a>.</p></div><div class=sect2><h3 id=_dump_et_restore>18.12.1. Dump et Restore<a class=anchor href=#_dump_et_restore></a></h3><div class=paragraph><p><a href="https://man.freebsd.org/cgi/man.cgi?query=dump&amp;sektion=8&amp;format=html">dump(8)</a> et <a href="https://man.freebsd.org/cgi/man.cgi?query=restore&amp;sektion=8&amp;format=html">restore(8)</a> sont les programmes de sauvegarde traditionnels d’UNIX®. Ils opèrent sur le disque comme sur une suite de blocs disque, en dessous du niveau d’abstraction que constituent les fichiers, liens et répertoires créés par les systèmes de fichiers. Le programme <a href="https://man.freebsd.org/cgi/man.cgi?query=dump&amp;sektion=8&amp;format=html">dump(8)</a> sauvegarde l’intégralité d’un système de fichiers d’un périphérique. Il est incapable de sauvegarder seulement une partie d’un système de fichiers ou une arborescence de répertoires s’étalant sur plus d’un système de fichiers. Le programme <a href="https://man.freebsd.org/cgi/man.cgi?query=dump&amp;sektion=8&amp;format=html">dump(8)</a> n’écrit pas de fichiers ou des répertoires sur la bande, mais écrit plutôt les blocs de données brutes dont sont constitués les fichiers et les répertoires.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Si vous utilisez <a href="https://man.freebsd.org/cgi/man.cgi?query=dump&amp;sektion=8&amp;format=html">dump(8)</a> sur votre répertoire racine, vous ne sauvegarderez pas <span class=filename>/home</span>, <span class=filename>/usr</span> ou beaucoup d’autres répertoires puisque que ces derniers sont généralement des points de montages pour d’autres systèmes de fichiers ou des liens symboliques vers ces systèmes de fichiers.</p></div></td></tr></tbody></table></div><div class=paragraph><p>L’utilitaire <a href="https://man.freebsd.org/cgi/man.cgi?query=dump&amp;sektion=8&amp;format=html">dump(8)</a> a quelques particularités datant de ses débuts sous la version 6 d’ATT UNIX (circa 1975). Les paramètres par défaut conviennent aux bandes 9 pistes (6250 bpi), et non aux supports à haute densité d’aujourd’hui (jusqu’à 62182 ftpi). Il faut surcharger ces valeurs par défaut sur la ligne de commande pour utiliser la capacité des bandes actuelles.</p></div><div class=paragraph><p>Il est également possible de sauvegarder les données par l’intermédiaire d’un réseau sur un lecteur de bande se trouvant sur une autre ordinateur à l’aide des commandes <code>rdump</code> et <code>rrestore</code>. Ces deux programmes utilisent <a href="https://man.freebsd.org/cgi/man.cgi?query=rcmd&amp;sektion=3&amp;format=html">rcmd(3)</a> et <a href="https://man.freebsd.org/cgi/man.cgi?query=ruserok&amp;sektion=3&amp;format=html">ruserok(3)</a> pour accéder à l’unité de bandes distante. Cependant, l’utilisateur effectuant une sauvegarde doit être présent dans le fichier <span class=filename>.rhosts</span> sur la machine distante. Les arguments de <a href="https://man.freebsd.org/cgi/man.cgi?query=rdump&amp;sektion=8&amp;format=html">rdump(8)</a> et <a href="https://man.freebsd.org/cgi/man.cgi?query=rrestore&amp;sektion=8&amp;format=html">rrestore(8)</a> doivent être compatibles avec une utilisation sur la machine distante. Quand on sauvegarde une machine FreeBSD sur un lecteur Exabyte installé sur un ordinateur Sun appelé <code>komodo</code>, utilisez:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># /sbin/rdump 0dsbfu 54000 13000 126 komodo:/dev/nsa8 /dev/da0a 2&gt;&amp;1</span></code></pre></div></div><div class=paragraph><p>Attention: il y a des conséquences pour la sécurité à utiliser l’authentification <span class=filename>.rhosts</span>. Evaluez soigneusement votre situation.</p></div><div class=paragraph><p>Il est également possible d’utiliser <a href="https://man.freebsd.org/cgi/man.cgi?query=dump&amp;sektion=8&amp;format=html">dump(8)</a> et <a href="https://man.freebsd.org/cgi/man.cgi?query=restore&amp;sektion=8&amp;format=html">restore(8)</a> d’une façon plus sécurisée sur <a href="https://man.freebsd.org/cgi/man.cgi?query=ssh&amp;sektion=1&amp;format=html">ssh(1)</a>.</p></div><div class=exampleblock><div class=title>Exemple 1. Utiliser <a href="https://man.freebsd.org/cgi/man.cgi?query=dump&amp;sektion=8&amp;format=html">dump(8)</a> sur ssh</div><div class=content><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># /sbin/dump -0uan -f - /usr | gzip -2 | ssh -c blowfish \</span>
          targetuser@targetmachine.example.com <span class=nb>dd </span><span class=nv>of</span><span class=o>=</span>/mybigfiles/dump-usr-l0.gz</code></pre></div></div></div></div><div class=paragraph><p>Ou en utilisant une fonction interne de <code>dump</code>, positionner la variable d’environnement <code>RSH</code>:</p></div><div class=exampleblock><div class=title>Exemple 2. Utiliser <code>dump</code> sur ssh avec la variable <code>RSH</code> positionnée</div><div class=content><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># RSH=/usr/bin/ssh /sbin/dump -0uan -f targetuser@targetmachine.example.com:/dev/sa0 /usr</span></code></pre></div></div></div></div></div><div class=sect2><h3 id=_tar>18.12.2. <code>tar</code><a class=anchor href=#_tar></a></h3><div class=paragraph><p>Le programme <a href="https://man.freebsd.org/cgi/man.cgi?query=tar&amp;sektion=1&amp;format=html">tar(1)</a> date aussi de la Version 6 d’ATT UNIX (circa 1975). <a href="https://man.freebsd.org/cgi/man.cgi?query=tar&amp;sektion=1&amp;format=html">tar(1)</a> travaille en coopération avec le système de fichiers; il permet d’écrire des fichiers et des répertoires sur bandes. <a href="https://man.freebsd.org/cgi/man.cgi?query=tar&amp;sektion=1&amp;format=html">tar(1)</a> ne supporte pas toutes les options permises par <a href="https://man.freebsd.org/cgi/man.cgi?query=cpio&amp;sektion=1&amp;format=html">cpio(1)</a>, mais ne demande pas l’inhabituelle concaténation de commandes qu’utilise <a href="https://man.freebsd.org/cgi/man.cgi?query=cpio&amp;sektion=1&amp;format=html">cpio(1)</a></p></div><div class=paragraph><p>Sous FreeBSD 5.3 et versions suivantes, GNU <code>tar</code> et la version par défaut <code>bsdtar</code> sont disponibles. La version GNU peut être invoquée avec la commande <code>gtar</code>. Elle supporte les sauvegardes sur des périphériques distants et cela avec la même syntaxe que <a href="https://man.freebsd.org/cgi/man.cgi?query=rdump&amp;sektion=8&amp;format=html">rdump(8)</a>. Pour sauvegarder avec <a href="https://man.freebsd.org/cgi/man.cgi?query=tar&amp;sektion=1&amp;format=html">tar(1)</a> sur une unité Exabyte connectée sur une machine Sun appelée <code>komodo</code>, utilisez:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># /usr/bin/gtar cf komodo:/dev/nsa8 . 2&gt;&amp;1</span></code></pre></div></div><div class=paragraph><p>La même opération peut être effectuée avec <code>bsdtar</code> en utilisant un tuyau et <a href="https://man.freebsd.org/cgi/man.cgi?query=rsh&amp;sektion=1&amp;format=html">rsh(1)</a> pour envoyer les données sur un lecteur de bande distant:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># tar cf - . | rsh hostname dd of=tape-device obs=20b</span></code></pre></div></div><div class=paragraph><p>Si vous êtes inquiet au sujet de la sécurité de sauvegardes par réseau, vous devriez utiliser la commande <a href="https://man.freebsd.org/cgi/man.cgi?query=ssh&amp;sektion=1&amp;format=html">ssh(1)</a> à la place de <a href="https://man.freebsd.org/cgi/man.cgi?query=rsh&amp;sektion=1&amp;format=html">rsh(1)</a>.</p></div></div><div class=sect2><h3 id=_cpio>18.12.3. <code>cpio</code><a class=anchor href=#_cpio></a></h3><div class=paragraph><p><a href="https://man.freebsd.org/cgi/man.cgi?query=cpio&amp;sektion=1&amp;format=html">cpio(1)</a> est le programme UNIX® original pour l’échange de fichiers par bandes magnétiques. <a href="https://man.freebsd.org/cgi/man.cgi?query=cpio&amp;sektion=1&amp;format=html">cpio(1)</a> dispose d’options (parmi beaucoup d’autres) pour intervertir les octets, utiliser de nombreux différents formats, et envoyer les données à d’autres programmes. Cette dernière caractéristique fait de <a href="https://man.freebsd.org/cgi/man.cgi?query=cpio&amp;sektion=1&amp;format=html">cpio(1)</a> un excellent choix pour les supports d’installation. <a href="https://man.freebsd.org/cgi/man.cgi?query=cpio&amp;sektion=1&amp;format=html">cpio(1)</a> ne sait pas parcourir une arborescence de répertoires et il faut lui passer la liste des fichiers via <span class=filename>stdin</span>.</p></div><div class=paragraph><p><a href="https://man.freebsd.org/cgi/man.cgi?query=cpio&amp;sektion=1&amp;format=html">cpio(1)</a> ne supporte pas les sauvegardes par le réseau. Vous pouvez utiliser un tuyau et <a href="https://man.freebsd.org/cgi/man.cgi?query=rsh&amp;sektion=1&amp;format=html">rsh(1)</a> pour envoyer les données sur un lecteur de bande distant:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># for f in directory_list; do</span>
find <span class=nv>$f</span> <span class=o>&gt;&gt;</span> backup.list
<span class=k>done</span>
<span class=c># cpio -v -o --format=newc &lt; backup.list | ssh user@host &#34;cat &gt; backup_device&#34;</span></code></pre></div></div><div class=paragraph><p>Où <em>directory_list</em> est la liste des répertoires que vous désirez sauvegarder, <em>user</em>@<em>host</em> est l’ensemble utilisateur/nom de machine qui effectuera les sauvegardes, et <em>backup_device</em> représente l’unité où seront écrites les sauvegardes (e.g., <span class=filename>/dev/nsa0</span>).</p></div></div><div class=sect2><h3 id=_pax>18.12.4. <code>pax</code><a class=anchor href=#_pax></a></h3><div class=paragraph><p><a href="https://man.freebsd.org/cgi/man.cgi?query=pax&amp;sektion=1&amp;format=html">pax(1)</a> est la réponse IEEE/POSIX® à <a href="https://man.freebsd.org/cgi/man.cgi?query=tar&amp;sektion=1&amp;format=html">tar(1)</a> et <a href="https://man.freebsd.org/cgi/man.cgi?query=cpio&amp;sektion=1&amp;format=html">cpio(1)</a>. Au fil des ans les différentes versions de <a href="https://man.freebsd.org/cgi/man.cgi?query=tar&amp;sektion=1&amp;format=html">tar(1)</a> et <a href="https://man.freebsd.org/cgi/man.cgi?query=cpio&amp;sektion=1&amp;format=html">cpio(1)</a> sont devenues légèrement incompatibles. Aussi, plutôt que de batailler pour les standardiser entièrement, POSIX® a défini un nouvel utilitaire d’archivage. <a href="https://man.freebsd.org/cgi/man.cgi?query=pax&amp;sektion=1&amp;format=html">pax(1)</a> tente de lire et d’écrire nombre des divers formats <a href="https://man.freebsd.org/cgi/man.cgi?query=tar&amp;sektion=1&amp;format=html">tar(1)</a> et <a href="https://man.freebsd.org/cgi/man.cgi?query=cpio&amp;sektion=1&amp;format=html">cpio(1)</a>, en plus de ses propres nouveaux formats. Son ensemble de commandes ressemble plus à celui de <a href="https://man.freebsd.org/cgi/man.cgi?query=cpio&amp;sektion=1&amp;format=html">cpio(1)</a> qu’à celui de <a href="https://man.freebsd.org/cgi/man.cgi?query=tar&amp;sektion=1&amp;format=html">tar(1)</a>.</p></div></div><div class=sect2><h3 id=backups-programs-amanda>18.12.5. Amanda<a class=anchor href=#backups-programs-amanda></a></h3><div class=paragraph><p>Amanda (Advanced Maryland Network Disk Archiver-Système Avancé d’Archivage de Disques en Réseau du Maryland) est un système d’archivage client/serveur plutôt qu’un simple programme. Un serveur Amanda archivera sur une seule unité de bandes un nombre quelconque d’ordinateurs disposant de clients Amanda et un accès réseau au serveur Amanda. Un problème classique sur les sites qui ont de nombreux disques volumineux est que le temps nécessaire pour sauvegarder directement les données sur la bande dépasse le temps alloué à cette tâche. Amanda résout ce problème. Amanda peut utiliser un "disque intermédiaire" pour sauvegarder plusieurs systèmes de fichiers à la fois. Amanda des "jeux d’archive": un ensemble de bandes utilisé pour une période donnée pour créer une sauvegarde complète de tous les systèmes de fichiers listé dans le fichier de configuration d’Amanda. Le "jeu d’archive" contient également les sauvegardes nocturnes incrémentales (ou différentielles) de tous les systèmes de fichiers. Pour restaurer une système de fichiers endommagé, il faut la sauvegarde complète la plus récente et les sauvegardes incrémentales.</p></div><div class=paragraph><p>Le fichier de configuration permet un contrôle en finesse des sauvegardes et du trafic réseau qu’Amanda génère. Amanda utilisera n’importe quel des programmes de sauvegarde décrits plus haut pour écrire les données sur bande. Amanda est disponible sous forme de logiciel porté ou de logiciel pré-compilé, il n’est pas installé par défaut.</p></div></div><div class=sect2><h3 id=_ne_rien_faire>18.12.6. Ne rien faire<a class=anchor href=#_ne_rien_faire></a></h3><div class=paragraph><p>"Ne rien faire" n’est pas un logiciel, mais c’est la stratégie de sauvegarde la plus utilisée. Il n’y a aucun investissement initial. Il n’y a pas de de planification des sauvegardes à suivre. Juste dire non. Si quelque chose arrive à vos données, souriez et débrouillez-vous!</p></div><div class=paragraph><p>Si votre temps et vos données ne valent pas grand chose, alors "Ne rien faire" est le programme de sauvegarde le mieux adapté à votre ordinateur. Mais prenez garde, UNIX® est un outil utile, et vous pouvez vous rendre compte au bout de six mois que vous disposez d’une collection de fichiers qui vous sont utiles.</p></div><div class=paragraph><p>"Ne rien faire" est la bonne méthode de sauvegarde pour <span class=filename>/usr/obj</span> et les autres répertoires qui peuvent facilement être recréés par votre ordinateur. Un exemple est les fichiers qui constituent la version HTML ou PostScript® de ce manuel. Ces fichiers ont été générés à partir de fichiers SGML. Faire des sauvegardes des fichiers HTML ou PostScript® n’est pas nécessaire. Les fichiers source SGML sont sauvegardés régulièrement.</p></div></div><div class=sect2><h3 id=_quel_est_le_meilleur_programme_de_sauvegarde>18.12.7. Quel est le meilleur programme de sauvegarde?<a class=anchor href=#_quel_est_le_meilleur_programme_de_sauvegarde></a></h3><div class=paragraph><p><a href="https://man.freebsd.org/cgi/man.cgi?query=dump&amp;sektion=8&amp;format=html">dump(8)</a> <em>Point.</em> Elizabeth D. Zwicky a soumis à rude épreuve tous les programmes de sauvegarde dont nous avons parlé. Le choix de <a href="https://man.freebsd.org/cgi/man.cgi?query=dump&amp;sektion=8&amp;format=html">dump(8)</a> s’impose pour préserver toutes vos données et les particularités des systèmes de fichiers UNIX®. Elizabeth a créé des systèmes de fichiers avec une grande variété de particularités inhabituelles (et quelques unes pas tellement inhabituelles) et a testé chacun des programmes en faisant une sauvegarde et une restauration de ces systèmes de fichiers. Parmi les spécificités testées: fichiers avec des trous, fichiers avec des trous et des blocs de caractères "null", fichiers dont les noms comportent des caractères inhabituels, les fichiers illisibles ou impossible à modifier, les périphériques, fichiers dont la taille change pendant la sauvegarde, fichiers créés ou détruits en cours de sauvegarde et bien plus. Elle a présenté les résultats de ces tests au LISA V en Octobre 1991. Voir les <a href=http://berdmann.dyndns.org/zwicky/testdump.doc.html>tests d’endurance des programmes de sauvegarde et d’archivage</a>.</p></div></div><div class=sect2><h3 id=_procédure_de_restauration_durgence>18.12.8. Procédure de restauration d’urgence<a class=anchor href=#_procédure_de_restauration_durgence></a></h3><div class=sect3><h4 id=_avant_le_désastre>18.12.8.1. Avant le désastre<a class=anchor href=#_avant_le_désastre></a></h4><div class=paragraph><p>Il y a quatre étapes à mettre en oeuvre en prévision d’un désastre éventuel.</p></div><div class=paragraph><p>Tout d’abord, imprimez le label de chacun de vos disques (par exemple <code>bsdlabel da0 | lpr</code>), votre table des systèmes de fichiers (<span class=filename>/etc/fstab</span>) et tous les messages de démarrage, en deux exemplaires.</p></div><div class=paragraph><p>Deuxièmement, vérifiez que vos disquettes de démarrage et de reprise d’urgence (<span class=filename>boot.flp</span> et <span class=filename>fixit.flp</span>) incluent tous vos périphériques. La méthode la plus simple pour vérifier est de redémarrer avec la disquette de démarrage dans le lecteur et contrôler les messages de démarrage. Si tous vos périphériques sont listés et opérationnels, passez à la troisième étape.</p></div><div class=paragraph><p>Sinon, vous devez créer deux disquettes de démarrage sur-mesure avec un noyau qui puisse monter tous vos disques et accéder à votre unité de bandes. Ces disquettes doivent contenir: <a href="https://man.freebsd.org/cgi/man.cgi?query=fdisk&amp;sektion=8&amp;format=html">fdisk(8)</a>, <a href="https://man.freebsd.org/cgi/man.cgi?query=bsdlabel&amp;sektion=8&amp;format=html">bsdlabel(8)</a>, <a href="https://man.freebsd.org/cgi/man.cgi?query=newfs&amp;sektion=8&amp;format=html">newfs(8)</a>, <a href="https://man.freebsd.org/cgi/man.cgi?query=mount&amp;sektion=8&amp;format=html">mount(8)</a>, et le programme de sauvegarde que vous utilisez. L’édition de liens de ces programmes doit être statique. Si vous utilisez <a href="https://man.freebsd.org/cgi/man.cgi?query=dump&amp;sektion=8&amp;format=html">dump(8)</a>, la disquette doit contenir <a href="https://man.freebsd.org/cgi/man.cgi?query=restore&amp;sektion=8&amp;format=html">restore(8)</a>.</p></div><div class=paragraph><p>Troisièmement, faites régulièrement des sauvegardes sur bandes. Toutes les modifications effectuées après votre dernière sauvegarde peuvent irrémédiablement perdues. Protégez vos bandes de sauvegarde en écriture.</p></div><div class=paragraph><p>Quatrièmement, testez les disquettes (soit <span class=filename>boot.flp</span> et <span class=filename>fixit.flp</span> soit les deux disquettes sur-mesure que vous avez créées à la seconde étape) et vos bandes de sauvegarde. Prenez note de la procédure. Conservez ces notes avec la disquette de démarrage, les impressions et les bandes de sauvegarde. Vous serez si préoccupé quand vous devrez restaurer que ces notes peuvent vous éviter de détruire vos bandes de sauvegarde (Comment? Au lieu de <code>tar xvf /dev/sa0</code>, vous pourriez taper accidentellement <code>tar cvf /dev/sa0</code>, ce qui écraserait votre bande de sauvegarde).</p></div><div class=paragraph><p>Par mesure de sécurité, créez une disquette de démarrage et deux bandes de sauvegarde à chaque fois. Conservez-les dans un lieu éloigné. Un endroit éloigné n’est PAS le sous-sol du même bâtiment. Un certain nombre de compagnies du World Trade Center l’ont appris à leurs dépends. Un endroit éloigné doit être physiquement séparé de vos ordinateurs et de vos disques par une distance significative.</p></div><div class=exampleblock><div class=title>Exemple 3. Procédure de création d’une disquette de démarrage</div><div class=content><div class="literalblock programlisting"><div class=content><pre>#!/bin/sh
#
# create a restore floppy
#
# format the floppy
#
PATH=/bin:/sbin:/usr/sbin:/usr/bin

fdformat -q fd0
if [ $? -ne 0 ]
then
	 echo &#34;Bad floppy, please use a new one&#34;
	 exit 1
fi

# place boot blocks on the floppy
#
bsdlabel -w -B /dev/fd0c fd1440

#
# newfs the one and only partition
#
newfs -t 2 -u 18 -l 1 -c 40 -i 5120 -m 5 -o space /dev/fd0a

#
# mount the new floppy
#
mount /dev/fd0a /mnt

#
# create required directories
#
mkdir /mnt/dev
mkdir /mnt/bin
mkdir /mnt/sbin
mkdir /mnt/etc
mkdir /mnt/root
mkdir /mnt/mnt			# for the root partition
mkdir /mnt/tmp
mkdir /mnt/var

#
# populate the directories
#
if [ ! -x /sys/compile/MINI/kernel ]
then
	 cat &amp;lt;&amp;lt; EOM
The MINI kernel does not exist, please create one.
Here is an example config file:
#
# MINI - A kernel to get FreeBSD onto a disk.
#
machine         &#34;i386&#34;
cpu             &#34;I486_CPU&#34;
ident           MINI
maxusers        5

options         INET                    # needed for _tcp _icmpstat _ipstat
                                        #            _udpstat _tcpstat _udb
options         FFS                     #Berkeley Fast File System
options         FAT_CURSOR              #block cursor in syscons or pccons
options         SCSI_DELAY=15           #Be pessimistic about Joe SCSI device
options         NCONS=2                 #1 virtual consoles
options         USERCONFIG              #Allow user configuration with -c XXX

config          kernel	root on da0 swap on da0 and da1 dumps on da0

device          isa0
device          pci0

device          fdc0	at isa? port &#34;IO_FD1&#34; bio irq 6 drq 2 vector fdintr
device          fd0	at fdc0 drive 0

device          ncr0

device          scbus0

device          sc0	at isa? port &#34;IO_KBD&#34; tty irq 1 vector scintr
device          npx0	at isa? port &#34;IO_NPX&#34; irq 13 vector npxintr

device          da0
device          da1
device          da2

device          sa0

pseudo-device   loop            # required by INET
pseudo-device   gzip            # Exec gzipped a.out&#39;s
EOM
	 exit 1
fi

cp -f /sys/compile/MINI/kernel /mnt

gzip -c -best /sbin/init &gt; /mnt/sbin/init
gzip -c -best /sbin/fsck &gt; /mnt/sbin/fsck
gzip -c -best /sbin/mount &gt; /mnt/sbin/mount
gzip -c -best /sbin/halt &gt; /mnt/sbin/halt
gzip -c -best /sbin/restore &gt; /mnt/sbin/restore

gzip -c -best /bin/sh &gt; /mnt/bin/sh
gzip -c -best /bin/sync &gt; /mnt/bin/sync

cp /root/.profile /mnt/root

cp -f /dev/MAKEDEV /mnt/dev
chmod 755 /mnt/dev/MAKEDEV

chmod 500 /mnt/sbin/init
chmod 555 /mnt/sbin/fsck /mnt/sbin/mount /mnt/sbin/halt
chmod 555 /mnt/bin/sh /mnt/bin/sync
chmod 6555 /mnt/sbin/restore

#
# create the devices nodes
#
cd /mnt/dev
./MAKEDEV std
./MAKEDEV da0
./MAKEDEV da1
./MAKEDEV da2
./MAKEDEV sa0
./MAKEDEV pty0
cd /

#
# create minimum file system table
#
cat &amp;lt; /mnt/etc/fstab &amp;lt;&amp;lt;EOM
/dev/fd0a    /    ufs    rw  1  1
EOM

#
# create minimum passwd file
#
cat &amp;lt; /mnt/etc/passwd &amp;lt;&amp;lt;EOM
root:*:0:0:Charlie &amp;amp;:/root:/bin/sh
EOM

cat &amp;lt; /mnt/etc/master.passwd &amp;lt;&amp;lt;EOM
root::0:0::0:0:Charlie &amp;amp;:/root:/bin/sh
EOM

chmod 600 /mnt/etc/master.passwd
chmod 644 /mnt/etc/passwd
/usr/sbin/pwd_mkdb -d/mnt/etc /mnt/etc/master.passwd

#
# umount the floppy and inform the user
#
/sbin/umount /mnt
echo &#34;The floppy has been unmounted and is now ready.&#34;</pre></div></div></div></div></div><div class=sect3><h4 id=_après_le_désastre>18.12.8.2. Après le désastre<a class=anchor href=#_après_le_désastre></a></h4><div class=paragraph><p>La question cruciale est: votre matériel a-t-il survécu? Vous avez régulièrement fait des sauvegardes, vous n’avez donc pas besoin de vous inquiéter pour les fichiers et les programmes.</p></div><div class=paragraph><p>Si le matériel a subi des dégâts, remplacez tout d’abord ce qui a été endommagé avant de tenter d’utiliser l’ordinateur.</p></div><div class=paragraph><p>Si votre matériel est en état, contrôlez vos disquettes. Si vous utilisez une disquette de démarrage personnalisée, démarrez en mode mono-utilisateur (tapez <code>-s</code> à l’invite <code>boot:</code>). Sautez le paragraphe suivant.</p></div><div class=paragraph><p>Si vous utilisez les disquettes <span class=filename>boot.flp</span> et <span class=filename>fixit.flp</span>, continuez à lire. Mettre la disquette <span class=filename>boot.flp</span> dans le premier lecteur et démarrez l’ordinateur. Le menu d’installation d’origine s’affiche à l’écran. Choisissez l’option <span class=guimenuitem>Fixit—​Repair mode with CDROM or floppy.</span>. Insérez la disquette <span class=filename>fixit.flp</span> quand on vous la demande. <a href="https://man.freebsd.org/cgi/man.cgi?query=restore&amp;sektion=8&amp;format=html">restore(8)</a> et les autres programmes dont vous avez besoin sont situés dans le répertoire <span class=filename>/mnt2/rescue</span> (<span class=filename>/mnt2/stand</span> pour les versions de FreeBSD antérieures à la 5.2).</p></div><div class=paragraph><p>Restaurez chaque système de fichiers séparément.</p></div><div class=paragraph><p>Essayez <a href="https://man.freebsd.org/cgi/man.cgi?query=mount&amp;sektion=8&amp;format=html">mount(8)</a> (e.g. <code>mount /dev/da0a /mnt</code>) sur la partition racine de votre premier disque. Si le label du disque est endommagé, utilisez <a href="https://man.freebsd.org/cgi/man.cgi?query=bsdlabel&amp;sektion=8&amp;format=html">bsdlabel(8)</a> pour repartitionner et libeller le disque conformément au label que vous avez imprimé et mis de côté. Utilisez <a href="https://man.freebsd.org/cgi/man.cgi?query=newfs&amp;sektion=8&amp;format=html">newfs(8)</a> pour recréer les systèmes de fichiers. Remontez la partition racine de la disquette en lecture/écriture (<code>mount -u -o rw /mnt</code>). Utilisez votre programme de restauration et vos bandes de sauvegardes pour restaurer les données de ce système de fichiers (e.g. <code>restore vrf /dev/sa0</code>). Démontez le système de fichiers (e.g. <code>umount /mnt</code>). Répétez l’opération pour chacun des systèmes de fichiers endommagés.</p></div><div class=paragraph><p>Une fois que le système fonctionne à nouveau, faites une sauvegarde sur de nouvelles bandes. Ce qui a causé la panne ou la perte de données peut se reproduire. Une heure de perdue maintenant peut vous épargner d’autres ennuis plus tard.</p></div></div></div></div></div><div class=sect1><h2 id=disks-virtual>18.13. Systèmes de fichiers réseaux, en mémoire et sauvegardés sur fichier<a class=anchor href=#disks-virtual></a></h2><div class=sectionbody><div class=paragraph><p>En plus des disques que vous introduisez physiquement dans votre ordinateur: disquettes, CD, disques durs, et ainsi de suite; d’autres formes de disques sont gérées par FreeBSD - les <em>disques virtuels</em>.</p></div><div class=paragraph><p>Ceux-ci comprennent les systèmes de fichiers réseaux comme le <a href=../network-servers/#network-nfs>NFS</a> et Coda, les systèmes de fichiers en mémoire et les systèmes de fichiers sauvegardé dans un fichier.</p></div><div class=paragraph><p>En fonction de la version de FreeBSD que vous utilisez, vous devrez utiliser des outils différents pour la création et l’utilisation de systèmes de fichiers en mémoire ou sauvegardé dans un fichier.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Utilisez <a href="https://man.freebsd.org/cgi/man.cgi?query=devfs&amp;sektion=5&amp;format=html">devfs(5)</a> pour allouer de façon transparente pour l’utilisateur les fichiers spéciaux de périphériques.</p></div></td></tr></tbody></table></div><div class=sect2><h3 id=disks-mdconfig>18.13.1. Système de fichiers sauvegardé dans un fichier<a class=anchor href=#disks-mdconfig></a></h3><div class=paragraph><p>L’utilitaire <a href="https://man.freebsd.org/cgi/man.cgi?query=mdconfig&amp;sektion=8&amp;format=html">mdconfig(8)</a> est utilisé pour configurer et activer les disques mémoires, <a href="https://man.freebsd.org/cgi/man.cgi?query=md&amp;sektion=4&amp;format=html">md(4)</a>, sous FreeBSD. Pour utiliser <a href="https://man.freebsd.org/cgi/man.cgi?query=mdconfig&amp;sektion=8&amp;format=html">mdconfig(8)</a>, vous devez charger le module <a href="https://man.freebsd.org/cgi/man.cgi?query=md&amp;sektion=4&amp;format=html">md(4)</a> ou en ajouter le support dans votre fichier de configuration du noyau:</p></div><div class="literalblock programlisting"><div class=content><pre>device md</pre></div></div><div class=paragraph><p>La commande <a href="https://man.freebsd.org/cgi/man.cgi?query=mdconfig&amp;sektion=8&amp;format=html">mdconfig(8)</a> supporte trois sortes de disques virtuels en mémoire: les disques mémoire alloués avec <a href="https://man.freebsd.org/cgi/man.cgi?query=malloc&amp;sektion=9&amp;format=html">malloc(9)</a>, les disques mémoires utilisant un fichier ou l’espace de pagination comme espace disque. Une des utilisations possibles est le montage d’images de disquettes ou de CDs conservées sous forme de fichier.</p></div><div class=paragraph><p>Pour monter l’image d’un système de fichiers:</p></div><div class=exampleblock><div class=title>Exemple 4. Utilisation de <code>mdconfig</code> pour monter une image d’un système de fichiers</div><div class=content><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># mdconfig -a -t vnode -f diskimage -u 0</span>
<span class=c># mount /dev/md0 /mnt</span></code></pre></div></div></div></div><div class=paragraph><p>Pour créer l’image d’un nouveau système de fichiers avec <a href="https://man.freebsd.org/cgi/man.cgi?query=mdconfig&amp;sektion=8&amp;format=html">mdconfig(8)</a>:</p></div><div class=exampleblock><div class=title>Exemple 5. Création d’un nouveau disque sauvegardé sur fichier avec <code>mdconfig</code></div><div class=content><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># dd if=/dev/zero of=newimage bs=1k count=5k</span>
5120+0 records <span class=k>in
</span>5120+0 records out
<span class=c># mdconfig -a -t vnode -f newimage -u 0</span>
<span class=c># bsdlabel -w md0 auto</span>
<span class=c># newfs md0a</span>
/dev/md0a: 5.0MB <span class=o>(</span>10224 sectors<span class=o>)</span> block size 16384, fragment size 2048
        using 4 cylinder <span class=nb>groups </span>of 1.25MB, 80 blks, 192 inodes.
super-block backups <span class=o>(</span><span class=k>for </span>fsck <span class=nt>-b</span> <span class=c>#) at:</span>
 160, 2720, 5280, 7840
<span class=c># mount /dev/md0a /mnt</span>
<span class=c># df /mnt</span>
Filesystem 1K-blocks Used Avail Capacity  Mounted on
/dev/md0a       4710    4  4330     0%    /mnt</code></pre></div></div></div></div><div class=paragraph><p>Si vous ne préciser pas de numéro d’unité avec l’option <code>-u</code>, <a href="https://man.freebsd.org/cgi/man.cgi?query=mdconfig&amp;sektion=8&amp;format=html">mdconfig(8)</a> utilisera le mécanisme d’allocation automatique de <a href="https://man.freebsd.org/cgi/man.cgi?query=md&amp;sektion=4&amp;format=html">md(4)</a> pour sélectionner un périphérique libre. Le nom de l’unité allouée s’affichera sur la sortie standard comme par exemple <span class=filename>md4</span>. Pour plus de détails concernant <a href="https://man.freebsd.org/cgi/man.cgi?query=mdconfig&amp;sektion=8&amp;format=html">mdconfig(8)</a>, référez-vous à la page de manuel.</p></div><div class=paragraph><p>L’outil <a href="https://man.freebsd.org/cgi/man.cgi?query=mdconfig&amp;sektion=8&amp;format=html">mdconfig(8)</a> est très utile, cependant son utilisation demande de nombreuses lignes de commandes pour créer un système de fichiers sauvegardé sur fichier. FreeBSD vient avec un outil appelé <a href="https://man.freebsd.org/cgi/man.cgi?query=mdmfs&amp;sektion=8&amp;format=html">mdmfs(8)</a>, ce programme configure un disque <a href="https://man.freebsd.org/cgi/man.cgi?query=md&amp;sektion=4&amp;format=html">md(4)</a> en utilisant <a href="https://man.freebsd.org/cgi/man.cgi?query=mdconfig&amp;sektion=8&amp;format=html">mdconfig(8)</a>, y ajoute dessus un système de fichiers UFS en utilisant <a href="https://man.freebsd.org/cgi/man.cgi?query=newfs&amp;sektion=8&amp;format=html">newfs(8)</a>, et le monte avec <a href="https://man.freebsd.org/cgi/man.cgi?query=mount&amp;sektion=8&amp;format=html">mount(8)</a>. Par exemple, si vous désirez créer et monter la même image de système de fichiers que précédemment, tapez simplement ce qui suit:</p></div><div class=exampleblock><div class=title>Exemple 6. Création et montage d’un disque sauvegardé sur fichier avec <code>mdmfs</code></div><div class=content><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># dd if=/dev/zero of=newimage bs=1k count=5k</span>
5120+0 records <span class=k>in
</span>5120+0 records out
<span class=c># mdmfs -F newimage -s 5m md0 /mnt</span>
<span class=c># df /mnt</span>
Filesystem 1K-blocks Used Avail Capacity  Mounted on
/dev/md0        4718    4  4338     0%    /mnt</code></pre></div></div></div></div><div class=paragraph><p>Si vous utilisez l’option <code>md</code> sans numéro d’unité, <a href="https://man.freebsd.org/cgi/man.cgi?query=mdmfs&amp;sektion=8&amp;format=html">mdmfs(8)</a> utilisera la fonction automatique de sélection d’unité de <a href="https://man.freebsd.org/cgi/man.cgi?query=md&amp;sektion=4&amp;format=html">md(4)</a> pour choisir un périphérique non utilisé. Pour plus de détails au sujet de <a href="https://man.freebsd.org/cgi/man.cgi?query=mdmfs&amp;sektion=8&amp;format=html">mdmfs(8)</a>, référez-vous à la page de manuel.</p></div></div><div class=sect2><h3 id=disks-md-freebsd5>18.13.2. Système de fichiers en mémoire<a class=anchor href=#disks-md-freebsd5></a></h3><div class=paragraph><p>Pour un système de fichiers en mémoire la "sauvegarde sur l’espace de pagination" devrait être normalement utilisée. Utiliser l’espace de pagination ne signifie pas que le disque en mémoire sera par défaut sur l’espace de pagination, mais plutôt que le disque mémoire sera alloué sur une zone de mémoire qui pourra être sauvegardée sur l’espace de pagination si nécessaire. Il est également possible de créer un disque en mémoire dont la mémoire est allouée à l’aide de <a href="https://man.freebsd.org/cgi/man.cgi?query=malloc&amp;sektion=9&amp;format=html">malloc(9)</a>, mais ce type de configuration, tout particulièrement dans le cas de disques de grande taille, peut donner lieu à une panique du système si le noyau se trouve à cours de mémoire.</p></div><div class=exampleblock><div class=title>Exemple 7. Création d’un disque mémoire avec <code>mdconfig</code></div><div class=content><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># mdconfig -a -t swap -s 5m -u 1</span>
<span class=c># newfs -U md1</span>
/dev/md1: 5.0MB <span class=o>(</span>10240 sectors<span class=o>)</span> block size 16384, fragment size 2048
        using 4 cylinder <span class=nb>groups </span>of 1.27MB, 81 blks, 192 inodes.
        with soft updates
super-block backups <span class=o>(</span><span class=k>for </span>fsck <span class=nt>-b</span> <span class=c>#) at:</span>
 160, 2752, 5344, 7936
<span class=c># mount /dev/md1 /mnt</span>
<span class=c># df /mnt</span>
Filesystem 1K-blocks Used Avail Capacity  Mounted on
/dev/md1        4718    4  4338     0%    /mnt</code></pre></div></div></div></div><div class=exampleblock><div class=title>Exemple 8. Création d’un disque mémoire avec <code>mdmfs</code></div><div class=content><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># mdmfs -s 5m md2 /mnt</span>
<span class=c># df /mnt</span>
Filesystem 1K-blocks Used Avail Capacity  Mounted on
/dev/md2        4846    2  4458     0%    /mnt</code></pre></div></div></div></div></div><div class=sect2><h3 id=_détacher_un_disque_mémoire_du_système>18.13.3. Détacher un disque mémoire du système<a class=anchor href=#_détacher_un_disque_mémoire_du_système></a></h3><div class=paragraph><p>Quand un système de fichiers en mémoire ou sauvegardé dans un fichier n’est pas utilisé, vous devriez rendre au système toutes les ressources. La première chose à faire est de démonter le système de fichiers, ensuite utiliser <a href="https://man.freebsd.org/cgi/man.cgi?query=mdconfig&amp;sektion=8&amp;format=html">mdconfig(8)</a> pour détacher le disque du système et rendre les ressources.</p></div><div class=paragraph><p>Par exemple pour détacher et libérer toutes les ressources utilisées par <span class=filename>/dev/md4</span>:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># mdconfig -d -u 4</span></code></pre></div></div><div class=paragraph><p>Il est possible d’afficher des informations sur les périphériques <a href="https://man.freebsd.org/cgi/man.cgi?query=md&amp;sektion=4&amp;format=html">md(4)</a> configurés en utilisant la commande <code>mdconfig -l</code>.</p></div></div></div></div><div class=sect1><h2 id=snapshots>18.14. Instantané ("Snapshot") d’un système de fichiers<a class=anchor href=#snapshots></a></h2><div class=sectionbody><div class=paragraph><p>FreeBSD en association avec les <a href=../config/#soft-updates>Soft Updates</a> offre une nouvelle caractéristique: les instantanés de systèmes de fichiers ("file system snapshots").</p></div><div class=paragraph><p>Les instantanés permettent à un utilisateur de créer des images d’un système de fichiers précis, et de les traiter comme un fichier. Les instantanés doivent être créés dans le système de fichiers sur lequel on veut effectuer l’opération, et un utilisateur ne pourra pas créer plus de 20 instantanés par système de fichiers. Les instantanés actifs sont enregistrés dans le superbloc, ils sont donc conservés durant les opérations de démontage et de remontage lors des redémarrages du système. Quand un instantané n’est plus requis, il peut être supprimé avec la commande standard <a href="https://man.freebsd.org/cgi/man.cgi?query=rm&amp;sektion=1&amp;format=html">rm(1)</a>. Les instantanés peuvent être supprimés dans n’importe quel ordre, cependant tout l’espace utilisé pourra ne pas être à nouveau disponible car un autre instantané réclamera éventuellement les blocs libérés.</p></div><div class=paragraph><p>L’indicateur inaltérable <code>snapshot</code> est positionné lors de la création initiale de l’instantané. La commande <a href="https://man.freebsd.org/cgi/man.cgi?query=unlink&amp;sektion=1&amp;format=html">unlink(1)</a> fait une exception pour les fichiers d’instantanés puisqu’elle autorise leur suppression.</p></div><div class=paragraph><p>Les instantanés sont créés avec la commande <a href="https://man.freebsd.org/cgi/man.cgi?query=mount&amp;sektion=8&amp;format=html">mount(8)</a>. Pour placer un instantané de <span class=filename>/var</span> dans le fichier <span class=filename>/var/snapshot/snap</span> utilisez la commande suivante:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># mount -u -o snapshot /var/snapshot/snap /var</span></code></pre></div></div><div class=paragraph><p>Alternativement, vous pouvez utiliser <a href="https://man.freebsd.org/cgi/man.cgi?query=mksnap_ffs&amp;sektion=8&amp;format=html">mksnap_ffs(8)</a> pour créer un instantané:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># mksnap_ffs /var /var/snapshot/snap</span></code></pre></div></div><div class=paragraph><p>Les fichiers d’instantanés peuvent être localisés sur un système de fichiers (e.g. <span class=filename>/var</span>) en utilisant la commande <a href="https://man.freebsd.org/cgi/man.cgi?query=find&amp;sektion=1&amp;format=html">find(1)</a>:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># find /var -flags snapshot</span></code></pre></div></div><div class=paragraph><p>Une fois un instantané créé, ce dernier pourra avoir de nombreux usages:</p></div><div class=ulist><ul><li><p>Certains administrateurs utiliseront un instantané pour des besoins de sauvegarde, car l’instantané peut être transféré sur CD ou bande.</p></li><li><p>Un contrôle d’intégrité du système fichiers, <a href="https://man.freebsd.org/cgi/man.cgi?query=fsck&amp;sektion=8&amp;format=html">fsck(8)</a>, pourra être effectué sur l’instantané. En supposant que le système de fichiers était propre quand il a été monté, vous devriez toujours obtenir un résultat positif (et non différent). C’est essentiellement que effectue le processus de <a href="https://man.freebsd.org/cgi/man.cgi?query=fsck&amp;sektion=8&amp;format=html">fsck(8)</a> en tâche de fond ("background <a href="https://man.freebsd.org/cgi/man.cgi?query=fsck&amp;sektion=8&amp;format=html">fsck(8)</a>").</p></li><li><p>Lancer l’utilitaire <a href="https://man.freebsd.org/cgi/man.cgi?query=dump&amp;sektion=8&amp;format=html">dump(8)</a> sur l’instantané. Une image cohérente du système de fichiers avec les paramètres temporels de l’instantané sera produite. <a href="https://man.freebsd.org/cgi/man.cgi?query=dump&amp;sektion=8&amp;format=html">dump(8)</a> peut également à partir d’un instantané, créer une image et puis supprimer l’instantané en une seule fois en utilisant l’indicateur <code>-L</code> dans la ligne de commande.</p></li><li><p>Monter l’instantané comme une image figée du système de fichiers. Pour monter l’instantané <span class=filename>/var/snapshot/snap</span> lancer:</p><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># mdconfig -a -t vnode -f /var/snapshot/snap -u 4</span>
<span class=c># mount -r /dev/md4 /mnt</span></code></pre></div></div></li></ul></div><div class=paragraph><p>Vous pouvez maintenant parcourir l’arborescence de votre système de fichiers <span class=filename>/var</span> figé monter sous <span class=filename>/mnt</span>. Tout sera au départ dans le même état que lors de la création de l’instantané. La seule exception est que les instantanés antérieurs apparaîtront sous la forme de fichiers vides. Quand l’utilisation d’un instantané est terminée, il peut être démonté avec:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># umount /mnt</span>
<span class=c># mdconfig -d -u 4</span></code></pre></div></div><div class=paragraph><p>Pour plus d’informations sur les <code>softupdates</code> et les instantanés de systèmes de fichiers, et également de la documentation technique, vous pouvez consulter le site Web de Marshall Kirk McKusick à l’adresse <a href=http://www.mckusick.com/>http://www.mckusick.com/</a></p></div></div></div><div class=sect1><h2 id=quotas>18.15. Quotas d’utilisation des disques<a class=anchor href=#quotas></a></h2><div class=sectionbody><div class=paragraph><p>Les quotas sont une option du système d’exploitation qui vous permet de limiter la quantité d’espace disque et/ou le nombre de fichiers auxquels ont droit un utilisateur ou tous les utilisateurs d’un même groupe, sur un système de fichiers donné. On les utilise la plupart du temps sur les systèmes en temps partagé où il est souhaitable de limiter la quantité de ressources allouée à un utilisateur ou à un groupe. Cela évitera qu’un utilisateur ou un groupe d’utilisateur consomme tout l’espace disque.</p></div><div class=sect2><h3 id=_configurer_votre_système_pour_pouvoir_utiliser_les_quotas_dutilisation_des_disques>18.15.1. Configurer votre système pour pouvoir utiliser les quotas d’utilisation des disques<a class=anchor href=#_configurer_votre_système_pour_pouvoir_utiliser_les_quotas_dutilisation_des_disques></a></h3><div class=paragraph><p>Avant d’essayer de mettre en place des quotas disque, il est nécessaire de s’assurer que le noyau est configuré pour les quotas. Cela se fait en ajoutant la ligne suivante dans votre fichier de configuration du noyau:</p></div><div class="literalblock programlisting"><div class=content><pre>options QUOTA</pre></div></div><div class=paragraph><p>Cette option n’est pas activée par défaut dans le noyau <span class=filename>GENERIC</span> de base, vous devrez donc configurer, compiler et installer un noyau sur-mesure pour utiliser les quotas disque. Reportez-vous au chapitre <a href=../kernelconfig/#kernelconfig>Configurer le noyau de FreeBSD</a> pour plus d’informations sur la configuration du noyau.</p></div><div class=paragraph><p>Ensuite vous devrez activer les quotas disques dans le fichier <span class=filename>/etc/rc.conf</span>. Pour cela, ajoutez la ligne:</p></div><div class="literalblock programlisting"><div class=content><pre>enable_quotas=&#34;YES&#34;</pre></div></div><div class=paragraph><p>Pour un contrôle plus fin des quotas au démarrage du système, il existe une variable supplémentaire de configuration. Normalement au démarrage, l’intégrité des quotas sur chaque système de fichiers est vérifiée par le programme <a href="https://man.freebsd.org/cgi/man.cgi?query=quotacheck&amp;sektion=8&amp;format=html">quotacheck(8)</a>. Ce programme s’assure que les données de la base de données des quotas correspondent bien aux données présentes sur le système de fichiers. C’est un processus consommateur en temps qui affectera considérablement la durée de démarrage du système. Si vous désirez passer cette étape, une variable dans <span class=filename>/etc/rc.conf</span> est prévue à cet effet:</p></div><div class="literalblock programlisting"><div class=content><pre>check_quotas=&#34;NO&#34;</pre></div></div><div class=paragraph><p>Vous devez enfin éditer le fichier <span class=filename>/etc/fstab</span> pour activer les quotas système de fichiers par système de fichiers. C’est là que vous pouvez soit activer les quotas par utilisateur ou par groupe soit les pour les deux sur tous vos systèmes de fichiers.</p></div><div class=paragraph><p>Pour activer les quotas par utilisateur sur un système de fichiers, ajouter l’option <code>userquota</code> dans le champ d’options sur l’entrée de <span class=filename>/etc/fstab</span> pour le système de fichiers sur lequel vous voulez activer les quotas. Par exemple:</p></div><div class="literalblock programlisting"><div class=content><pre>/dev/da1s2g   /home    ufs rw,userquota 1 2</pre></div></div><div class=paragraph><p>De même, pour activer les quotas par groupe, utilisez l’option <code>groupquota</code> à la place de <code>userquota</code>. Pour activer à la fois les quotas par utilisateur et par groupe, modifiez l’entrée de la façon suivante:</p></div><div class="literalblock programlisting"><div class=content><pre>/dev/da1s2g    /home    ufs rw,userquota,groupquota 1 2</pre></div></div><div class=paragraph><p>Par défaut, les fichiers où sont définis les quotas dans le répertoire racine du système de fichiers sous les noms <span class=filename>quota.user</span> et <span class=filename>quota.group</span>, respectivement pour les quotas utilisateur et les quotas par groupe. Consultez la page de manuel <a href="https://man.freebsd.org/cgi/man.cgi?query=fstab&amp;sektion=5&amp;format=html">fstab(5)</a> pour plus d’information. Bien que la page de manuel <a href="https://man.freebsd.org/cgi/man.cgi?query=fstab&amp;sektion=5&amp;format=html">fstab(5)</a> indique que vous pouvez spécifier un autre emplacement pour ces fichiers, cela n’est pas recommandé parce que les divers utilitaires qui gèrent les quotas ne semblent pas les prendre correctement en compte.</p></div><div class=paragraph><p>A ce point vous devriez redémarrer votre système avec votre nouveau noyau. La procédure <span class=filename>/etc/rc</span> exécutera automatiquement les commandes nécessaires pour créer les fichiers de quotas initiaux pour tous les quotas que vous avez définis dans <span class=filename>/etc/fstab</span>, vous n’avez donc pas besoin de créer à la main de fichiers de quotas vides.</p></div><div class=paragraph><p>Vous ne devriez pas avoir à exécuter les commandes <a href="https://man.freebsd.org/cgi/man.cgi?query=quotacheck&amp;sektion=8&amp;format=html">quotacheck(8)</a>, <a href="https://man.freebsd.org/cgi/man.cgi?query=quotaon&amp;sektion=8&amp;format=html">quotaon(8)</a>, ou <a href="https://man.freebsd.org/cgi/man.cgi?query=quotaoff&amp;sektion=8&amp;format=html">quotaoff(8)</a> manuellement. Cependant, vous pouvez lire leur page de manuel pour vous familiariser avec leur rôle.</p></div></div><div class=sect2><h3 id=_définir_les_quotas>18.15.2. Définir les quotas<a class=anchor href=#_définir_les_quotas></a></h3><div class=paragraph><p>Une fois que vous avez activé les quotas sur votre système, assurez-vous que cela fonctionne correctement. Une manière simple de le faire est d’exécuter:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># quota -v</span></code></pre></div></div><div class=paragraph><p>Vous devriez obtenir une ligne résumant l’utilisation disque avec les quotas actuellement définis pour chaque système de fichiers sur lesquels il y a des quotas.</p></div><div class=paragraph><p>Vous êtes maintenant prêt à définir les quotas avec la commande <a href="https://man.freebsd.org/cgi/man.cgi?query=edquota&amp;sektion=8&amp;format=html">edquota(8)</a>.</p></div><div class=paragraph><p>Vous disposez de différentes options pour instaurer les quotas d’espace disque alloué à un utilisateur ou à un groupe, et le nombre de fichiers qu’ils peuvent créer. Vous pouvez baser les limitations sur l’espace disque alloué (quotas en nombre de blocs) ou sur le nombre de fichiers (quotas en inode) ou les deux. Ces options peuvent être divisées en deux catégories: les limites strictes ou souples.</p></div><div class=paragraph><p>Une limite stricte ne peut être dépassée. Une fois qu’un utilisateur atteint sa limite stricte, il ne pourra plus rien allouer sur le système de fichiers en question. Par exemple, si l’utilisateur a droit à une limite stricte de 500 Ko sur un système de fichiers et en utilise 490 Ko, il ne pourra allouer que 10 Ko supplémentaires. Une tentative d’allouer 11 Ko échouerait.</p></div><div class=paragraph><p>Une limite souple peut être dépassée pour une période de temps restreinte. C’est ce que l’on appelle le délai de grâce, qui est d’une semaine par défaut. Si un utilisateur dépasse cette limite au delà du délai de grâce, cette limite devient stricte, et plus aucune allocation ne sera possible. Quand l’utilisateur redescend en dessous de la limite souple, le délai de grâce est à nouveau réaccordé.</p></div><div class=paragraph><p>Ce qui suit est un exemple de ce que vous pourrez voir en utilisant la commande <a href="https://man.freebsd.org/cgi/man.cgi?query=edquota&amp;sektion=8&amp;format=html">edquota(8)</a>. Quand vous invoquez la commande <a href="https://man.freebsd.org/cgi/man.cgi?query=edquota&amp;sektion=8&amp;format=html">edquota(8)</a>, vous vous retrouvez dans l’éditeur défini par la variable d’environnement <code>EDITOR</code>, ou sous vi si la variable d’environnement <code>EDITOR</code> n’est pas positionnée, ce qui vous permet d’éditer les quotas.</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># edquota -u test</span></code></pre></div></div><div class="literalblock programlisting"><div class=content><pre>Quotas for user test:
/usr: kbytes in use: 65, limits (soft = 50, hard = 75)
        inodes in use: 7, limits (soft = 50, hard = 60)
/usr/var: kbytes in use: 0, limits (soft = 50, hard = 75)
        inodes in use: 0, limits (soft = 50, hard = 60)</pre></div></div><div class=paragraph><p>Vous verrez normalement deux lignes pour chaque système de fichiers sur lequel il y a des quotas. Une ligne pour les quotas de blocs, et une autre pour la limite d’inode. Modifiez simplement les valeurs que vous voulez mettre à jour. Par exemple, pour augmenter la limite de blocs accordée à cet utilisateur de 50 pour la limite souple et de 75 pour la limite stricte à 500 pour la limite souple et 600 pour la limite stricte, modifiez:</p></div><div class="literalblock programlisting"><div class=content><pre>/usr: kbytes in use: 65, limits (soft = 50, hard = 75)</pre></div></div><div class=paragraph><p>en:</p></div><div class="literalblock programlisting"><div class=content><pre>/usr: kbytes in use: 65, limits (soft = 500, hard = 600)</pre></div></div><div class=paragraph><p>Les nouveaux quotas seront en service dès que vous quitterez l’éditeur.</p></div><div class=paragraph><p>Il est parfois souhaitable de définir des quotas pour une plage d’UIDs (identifiants utilisateur). Cela peut être réalisé avec l’option <code>-p</code> de la commande <a href="https://man.freebsd.org/cgi/man.cgi?query=edquota&amp;sektion=8&amp;format=html">edquota(8)</a>. Définissez d’abord les quotas pour un seul utilisateur, et puis exécutez <code>edquota -p protouser startuid-enduid</code>. Par exemple, si l’utilisateur <code>test</code> dispose des quotas désirés, la commande suivante peut être utilisée pour appliquer ces quotas pour les UIDs de 10000 à 19999:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># edquota -p test 10000-19999</span></code></pre></div></div><div class=paragraph><p>Pour plus d’informations consultez la page de manuel <a href="https://man.freebsd.org/cgi/man.cgi?query=edquota&amp;sektion=8&amp;format=html">edquota(8)</a>.</p></div></div><div class=sect2><h3 id=_consulter_les_quotas_et_lutilisation_des_disques>18.15.3. Consulter les quotas et l’utilisation des disques<a class=anchor href=#_consulter_les_quotas_et_lutilisation_des_disques></a></h3><div class=paragraph><p>Vous pouvez soit utiliser la commande <a href="https://man.freebsd.org/cgi/man.cgi?query=quota&amp;sektion=1&amp;format=html">quota(1)</a> soit la commande <a href="https://man.freebsd.org/cgi/man.cgi?query=repquota&amp;sektion=8&amp;format=html">repquota(8)</a> pour consulter les quotas et l’utilisation des disques. La commande <a href="https://man.freebsd.org/cgi/man.cgi?query=quota&amp;sektion=1&amp;format=html">quota(1)</a> peut être employée pour connaître les quotas et l’utilisation des disques pour un utilisateur et un groupe. Un utilisateur ne peut consulter que ses propres quotas et ceux d’un groupe auquel il appartient. Seul le super-utilisateur peut consulter les quotas et l’usage disque de tous les utilisateurs et groupes. La commande <a href="https://man.freebsd.org/cgi/man.cgi?query=repquota&amp;sektion=8&amp;format=html">repquota(8)</a> permet d’obtenir un résumé de tous les quotas et l’utilisation disque pour les systèmes de fichiers sur lesquels il y a des quotas.</p></div><div class=paragraph><p>Ce qui suit est un extrait de la sortie de la commande <code>quota -v</code> pour un utilisateur pour lequel on a défini des quotas sur deux systèmes de fichiers.</p></div><div class="literalblock programlisting"><div class=content><pre>Disk quotas for user test (uid 1002):
     Filesystem  usage   quota   limit   grace   files   quota   limit   grace
           /usr      65*     50      75   5days       7      50      60
       /usr/var       0      50      75               0      50      60</pre></div></div><div class=paragraph><p>Sur le système de fichiers <span class=filename>/usr</span> dans l’exemple ci-dessus, l’utilisateur occupe 15 Ko de plus que la limite de 50 Ko qui lui est allouée et dispose d’un délai de grâce de 5 jours. Notez l’astérisque <code>*</code> qui indique que l’utilisateur dépasse actuellement son quota.</p></div><div class=paragraph><p>Normalement les systèmes de fichiers sur lesquels l’utilisateur n’occupe pas d’espace n’apparaissent pas dans la sortie de la commande <a href="https://man.freebsd.org/cgi/man.cgi?query=quota&amp;sektion=1&amp;format=html">quota(1)</a>, même s’il a des quotas sur ces systèmes de fichiers. L’option <code>-v</code> listera ces systèmes de fichiers, comme <span class=filename>/usr/var</span> dans l’exemple ci-dessus.</p></div></div><div class=sect2><h3 id=_quotas_avec_nfs>18.15.4. Quotas avec NFS<a class=anchor href=#_quotas_avec_nfs></a></h3><div class=paragraph><p>Les quotas sont gérés par le sous-système de gestion des quotas sur le serveur NFS. Le démon <a href="https://man.freebsd.org/cgi/man.cgi?query=rpc.rquotad&amp;sektion=8&amp;format=html">rpc.rquotad(8)</a> fournit les informations sur les quotas à la commande <a href="https://man.freebsd.org/cgi/man.cgi?query=quota&amp;sektion=1&amp;format=html">quota(1)</a> des clients NFS, permettant aux utilisateurs sur ces machines de consulter l’utilisation des quotas qui leur sont alloués.</p></div><div class=paragraph><p>Activez <code>rpc.rquotad</code> dans <span class=filename>/etc/inetd.conf</span> de la façon suivante:</p></div><div class="literalblock programlisting"><div class=content><pre>rquotad/1      dgram rpc/udp wait root /usr/libexec/rpc.rquotad rpc.rquotad</pre></div></div><div class=paragraph><p>Puis redémarrez <code>inetd</code>:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># kill -HUP `cat /var/run/inetd.pid`</span></code></pre></div></div></div></div></div><div class=sect1><h2 id=disks-encrypting>18.16. Chiffrer les partitions d’un disque<a class=anchor href=#disks-encrypting></a></h2><div class=sectionbody><div class=paragraph><p>FreeBSD offre d’excellentes protections contre un accès non autorisé aux données par l’intermédiaire du réseau. Les permissions sur les fichiers et le contrôle d’accès obligatoire - "Mandatory Access Control" (MAC) (voir <a href=../mac/#mac>Mandatory Access Control</a>) empêchent l’accès aux données pour des tiers non autorisés quand le système d’exploitation est actif et l’ordinateur en fonctionnement. Cependant, des permissions renforcés sont inutiles si l’attaquant a un accès physique à un ordinateur et peut simplement déplacer le disque dur sur un autre système pour copier et analyser les données sensibles.</p></div><div class=paragraph><p>Indépendamment de la manière dont une personne malveillante s’est trouvé en possession d’un disque dur ou a arrêté un ordinateur, le chiffrage de disque basé sur GEOM (gbde) ("GEOM Based Disk Encryption") et le système de chiffrage <code>geli</code> de FreeBSD sont en mesure de protéger les données des systèmes de fichiers contre des attaquants très motivés et aux ressources importantes. A la différence des méthodes de chiffrage lourdes qui chiffrent uniquement les fichiers individuels, gbde et <code>geli</code> chiffrent de manière transparente l’intégralité du système de fichiers. Aucun texte en clair ne touche les plateaux du disque.</p></div><div class=sect2><h3 id=_chiffrage_des_disques_avec_gbde>18.16.1. Chiffrage des disques avec gbde<a class=anchor href=#_chiffrage_des_disques_avec_gbde></a></h3><div class="exampleblock procedure"><div class=content><div class="olist arabic"><ol class=arabic><li><p>Devenir <code>root</code></p><div class=paragraph><p>La configuration de gbde requiert les privilèges du super-utilisateur.</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>% su -
Password:</code></pre></div></div></li><li><p>Ajouter le support <a href="https://man.freebsd.org/cgi/man.cgi?query=gbde&amp;sektion=4&amp;format=html">gbde(4)</a> au fichier de configuration du noyau</p><div class=paragraph><p>Ajoutez la ligne suivante à votre fichier de configuration du noyau:</p></div><div class=paragraph><p><code>options GEOM_BDE</code></p></div><div class=paragraph><p>Recompilez le noyau comme décrit dans <a href=../kernelconfig/#kernelconfig>Configurer le noyau de FreeBSD</a>.</p></div><div class=paragraph><p>Redémarrez avec le nouveau noyau.</p></div></li><li><p>Au lieu de recompiler le noyau, on peut utiliser <code>kldload</code> pour charger le support <a href="https://man.freebsd.org/cgi/man.cgi?query=gbde&amp;sektion=4&amp;format=html">gbde(4)</a>:</p><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># kldload geom_bde</span></code></pre></div></div></li></ol></div></div></div><div class=sect3><h4 id=_préparation_du_disque_dur_chiffré>18.16.1.1. Préparation du disque dur chiffré<a class=anchor href=#_préparation_du_disque_dur_chiffré></a></h4><div class=paragraph><p>L’exemple suivant suppose que vous ajoutez un nouveau disque dur à votre système et qui contiendra une seule partition chiffrée. Cette partition sera montée sous <span class=filename>/private</span>. gbde peut également être utilisé pour chiffrer les répertoires <span class=filename>/home</span> et <span class=filename>/var/mail</span>, mais cela demande une configuration plus complexe qui dépasse le cadre de cette introduction.</p></div><div class="exampleblock procedure"><div class=content><div class="olist arabic"><ol class=arabic><li><p>Ajouter le nouveau disque</p><div class=paragraph><p>Installez le nouveau disque comme expliqué dans <a href=#disks-adding>Ajouter des disques</a>. Pour les besoins de cet exemple, une nouvelle partition disque a été ajoutée en tant que <span class=filename>/dev/ad4s1c</span>. Les périphériques du type <span class=filename>/dev/ad0s1*</span> représentent les partitions FreeBSD standards sur le système exemple.</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># ls /dev/ad*</span>
/dev/ad0        /dev/ad0s1b     /dev/ad0s1e     /dev/ad4s1
/dev/ad0s1      /dev/ad0s1c     /dev/ad0s1f     /dev/ad4s1c
/dev/ad0s1a     /dev/ad0s1d     /dev/ad4</code></pre></div></div></li><li><p>Créer un répertoire pour héberger les fichiers de verrouillage de GBDE</p><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># mkdir /etc/gbde</span></code></pre></div></div><div class=paragraph><p>Le fichier de verrouillage de gbde contient l’information nécessaire à gbde pour accéder aux partitions chiffrées. Sans accès au fichier de verrouillage, gbde sera incapable de déchiffrer les données contenues sur la partition chiffrée sans une aide manuelle significative ce qui n’est pas supporté par le logiciel. Chaque partition chiffrée utilise un fichier de verrouillage propre.</p></div></li><li><p>Initialiser la partition gbde</p><div class=paragraph><p>Une partition gbde doit être initialisée avant d’être utilisable. Cette initialisation doit être effectuée une seule fois:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># gbde init /dev/ad4s1c -i -L /etc/gbde/ad4s1c</span></code></pre></div></div><div class=paragraph><p><a href="https://man.freebsd.org/cgi/man.cgi?query=gbde&amp;sektion=8&amp;format=html">gbde(8)</a> lancera votre éditeur, vous permettant de fixer diverses options de configuration dans un gabarit. Pour une utilisation de UFS1 ou UFS2, fixez l’option <code>sector_size</code> à 2048:</p></div><div class="literalblock programlisting"><div class=content><pre>$FreeBSD: src/sbin/gbde/template.txt,v 1.1 2002/10/20 11:16:13 phk Exp $
#
# La taille d&#39;un secteur est la plus petite unité de donnée
# qui peut être lue ou écrite.
# Une valeur trop petite diminue les performances et l&#39;espace
# disponible.
# Une valeur trop grande peut empêcher des systèmes de
# fichiers de fonctionner correctement.  512 est la valeur minimale
# et sans risque.  Pour l&#39;UFS, utiliser la taille d&#39;un fragment
#
sector_size     =       2048
[...]</pre></div></div><div class=paragraph><p><a href="https://man.freebsd.org/cgi/man.cgi?query=gbde&amp;sektion=8&amp;format=html">gbde(8)</a> vous demandera de taper deux fois la phrase d’authentification qui devra être utilisée pour sécuriser les données. La phrase d’authentification doit être la même dans les deux cas. La capacité de gbde à protéger vos données dépend de la qualité de la phrase d’authentification que vous avez choisie.</p></div><div class=paragraph><p>La commande <code>gbde init</code> crée un fichier de verrouillage pour votre partition gbde qui dans cet exemple est stocké sous <span class=filename>/etc/gbde/ad4s1c</span>.</p></div><div class="admonitionblock caution"><table><tbody><tr><td class=icon><i class="fa icon-caution" title=Caution></i></td><td class=content><div class=paragraph><p>Les fichiers de verrouillage de gbde <em>doivent</em> être conservés de pair avec le contenu des partitions chiffrées. Alors que la suppression seule d’un fichier de verrouillage ne peut empêcher une personne déterminée de déchiffrer une partition gbde, sans le fichier de verrouillage, le propriétaire légitime sera incapable d’accéder aux données de la partition chiffrée sans beaucoup de travail ce qui est totalement non supporté par <a href="https://man.freebsd.org/cgi/man.cgi?query=gbde&amp;sektion=8&amp;format=html">gbde(8)</a> et son concepteur.</p></div></td></tr></tbody></table></div></li><li><p>Attacher la partition chiffrée au noyau</p><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># gbde attach /dev/ad4s1c -l /etc/gbde/ad4s1c</span></code></pre></div></div><div class=paragraph><p>On vous demandera de fournir la phrase d’authentification que vous avez choisie lors de l’initialisation de la partition chiffrée. Le nouveau périphérique chiffré apparaîtra dans <span class=filename>/dev</span> en tant que <span class=filename>/dev/nom_périphérique.bde</span>:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># ls /dev/ad*</span>
/dev/ad0        /dev/ad0s1b     /dev/ad0s1e     /dev/ad4s1
/dev/ad0s1      /dev/ad0s1c     /dev/ad0s1f     /dev/ad4s1c
/dev/ad0s1a     /dev/ad0s1d     /dev/ad4        /dev/ad4s1c.bde</code></pre></div></div></li><li><p>Créer un système de fichiers sur le périphérique chiffré</p><div class=paragraph><p>Une fois que le périphérique chiffré a été attaché au noyau, vous pouvez créer un système de fichiers sur le périphérique. Pour créer un système de fichiers sur le périphérique, utilisez <a href="https://man.freebsd.org/cgi/man.cgi?query=newfs&amp;sektion=8&amp;format=html">newfs(8)</a>. Puisqu’il est plus rapide d’initialiser un nouveau système de fichiers UFS2 qu’un nouveau système UFS1, l’utilisation de <a href="https://man.freebsd.org/cgi/man.cgi?query=newfs&amp;sektion=8&amp;format=html">newfs(8)</a> avec l’option <code>-O2</code> est recommandé.</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># newfs -U -O2 /dev/ad4s1c.bde</span></code></pre></div></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>La commande <a href="https://man.freebsd.org/cgi/man.cgi?query=newfs&amp;sektion=8&amp;format=html">newfs(8)</a> peut être effectuée sur une partition gbde attachée qui est identifiée par une extension <span class=filename>*.bde</span> au niveau du nom de périphérique.</p></div></td></tr></tbody></table></div></li><li><p>Monter la partition chiffrée</p><div class=paragraph><p>Créez un point de montage pour le système de fichiers chiffré.</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># mkdir /private</span></code></pre></div></div><div class=paragraph><p>Montez le système de fichiers chiffré.</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># mount /dev/ad4s1c.bde /private</span></code></pre></div></div></li><li><p>Vérifiez que le système de fichiers chiffré est disponible</p><div class=paragraph><p>Le système de fichiers chiffré devrait être visible par <a href="https://man.freebsd.org/cgi/man.cgi?query=df&amp;sektion=1&amp;format=html">df(1)</a> et prêt à être utilisé:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>% <span class=nb>df</span> <span class=nt>-H</span>
Filesystem        Size   Used  Avail Capacity  Mounted on
/dev/ad0s1a      1037M    72M   883M     8%    /
/devfs            1.0K   1.0K     0B   100%    /dev
/dev/ad0s1f       8.1G    55K   7.5G     0%    /home
/dev/ad0s1e      1037M   1.1M   953M     0%    /tmp
/dev/ad0s1d       6.1G   1.9G   3.7G    35%    /usr
/dev/ad4s1c.bde   150G   4.1K   138G     0%    /private</code></pre></div></div></li></ol></div></div></div></div><div class=sect3><h4 id=_montage_des_systèmes_de_fichiers_chiffrés>18.16.1.2. Montage des systèmes de fichiers chiffrés<a class=anchor href=#_montage_des_systèmes_de_fichiers_chiffrés></a></h4><div class=paragraph><p>Après chaque démarrage, tout système de fichiers chiffré doit être rattaché au noyau, contrôlé pour les erreurs, et monté, avant que les systèmes de fichiers ne puissent être utilisés. Les commandes nécessaires doivent être exécutées en tant que <code>root</code>.</p></div><div class="exampleblock procedure"><div class=content><div class="olist arabic"><ol class=arabic><li><p>Attacher la partition gdbe au noyau</p><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># gbde attach /dev/ad4s1c -l /etc/gbde/ad4s1c</span></code></pre></div></div><div class=paragraph><p>On vous demandera de fournir la phrase d’authentification que vous avez choisie lors de l’initialisation de la partition gbde chiffrée.</p></div></li><li><p>Contrôler les erreurs du système de fichiers</p><div class=paragraph><p>Puisque les systèmes de fichiers chiffrés ne peuvent être encore listés dans le fichier <span class=filename>/etc/fstab</span> pour un montage automatique, on doit donc contrôler les systèmes de fichiers pour d’éventuelles erreurs en exécutant manuellement <a href="https://man.freebsd.org/cgi/man.cgi?query=fsck&amp;sektion=8&amp;format=html">fsck(8)</a> avant le montage.</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># fsck -p -t ffs /dev/ad4s1c.bde</span></code></pre></div></div></li><li><p>Monter le système de fichiers chiffré</p><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># mount /dev/ad4s1c.bde /private</span></code></pre></div></div><div class=paragraph><p>Le système de fichiers est maintenant disponible à l’utilisation.</p></div></li></ol></div></div></div><div class=sect4><h5 id=_montage_automatique_de_partitions_chiffrées>18.16.1.2.1. Montage automatique de partitions chiffrées<a class=anchor href=#_montage_automatique_de_partitions_chiffrées></a></h5><div class=paragraph><p>Il est possible de créer une procédure pour automatiquement attacher, contrôler, et monter une partition chiffrée, mais pour des raisons de sécurité la procédure ne devrait pas contenir le mot de passe <a href="https://man.freebsd.org/cgi/man.cgi?query=gbde&amp;sektion=8&amp;format=html">gbde(8)</a>. A la place, il est recommandé que de telles procédures soient exécutées manuellement tout en fournissant le mot de passe via la console ou <a href="https://man.freebsd.org/cgi/man.cgi?query=ssh&amp;sektion=1&amp;format=html">ssh(1)</a>.</p></div><div class=paragraph><p>Comme autre possibilité, une procédure <span class=filename>rc.d</span> est fournie. Des arguments peuvent être passés à cette procédure par l’intermédiaire de <a href="https://man.freebsd.org/cgi/man.cgi?query=rc.conf&amp;sektion=5&amp;format=html">rc.conf(5)</a>,, par exemple:</p></div><div class="literalblock programlisting"><div class=content><pre>gbde_autoattach_all=&#34;YES&#34;
gbde_devices=&#34;ad4s1c&#34;</pre></div></div><div class=paragraph><p>Cela impose la saisie de la phrase d’authentification gbde au démarrage. Après avoir entré la phrase d’authentification correctement, la partition chiffrée gbde sera montée automatiquement. Cela peut être très utile quand gbde est utilisé sur des ordinateurs portables.</p></div></div></div><div class=sect3><h4 id=_les_protections_cryptographiques_utilisées_par_gbde>18.16.1.3. Les protections cryptographiques utilisées par gbde<a class=anchor href=#_les_protections_cryptographiques_utilisées_par_gbde></a></h4><div class=paragraph><p><a href="https://man.freebsd.org/cgi/man.cgi?query=gbde&amp;sektion=8&amp;format=html">gbde(8)</a> chiffre la partie utile des secteurs en utilisant le chiffrage AES 128 bits en mode CBC. Chaque secteur sur le disque est chiffré avec une clé AES différente. Pour plus d’informations sur l’architecture cryptographique de gbde, y compris comment les clés pour chaque secteur sont des dérivés de la phrase d’authentification donnée par l’utilisateur, voir la page de manuel <a href="https://man.freebsd.org/cgi/man.cgi?query=gbde&amp;sektion=4&amp;format=html">gbde(4)</a>.</p></div></div><div class=sect3><h4 id=_problèmes_de_compatibilité>18.16.1.4. Problèmes de compatibilité<a class=anchor href=#_problèmes_de_compatibilité></a></h4><div class=paragraph><p><a href="https://man.freebsd.org/cgi/man.cgi?query=sysinstall&amp;sektion=8&amp;format=html">sysinstall(8)</a> est incompatible avec les périphériques gbde-chiffrés. Tous les périphériques <span class=filename>*.bde</span> doivent être détachés du noyau avant de lancer <a href="https://man.freebsd.org/cgi/man.cgi?query=sysinstall&amp;sektion=8&amp;format=html">sysinstall(8)</a> ou ce dernier plantera durant son processus initial de recherche des périphériques. Pour détacher le périphérique chiffré utilisé dans notre exemple, utilisez la commande suivante:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># gbde detach /dev/ad4s1c</span></code></pre></div></div><div class=paragraph><p>Notez également qu’étant donné que <a href="https://man.freebsd.org/cgi/man.cgi?query=vinum&amp;sektion=4&amp;format=html">vinum(4)</a> n’utilise pas le sous-système <a href="https://man.freebsd.org/cgi/man.cgi?query=geom&amp;sektion=4&amp;format=html">geom(4)</a>, vous ne pouvez utiliser gbde avec des volumes vinum.</p></div></div></div><div class=sect2><h3 id=disks-encrypting-geli>18.16.2. Chiffrage des disques avec <code>geli</code><a class=anchor href=#disks-encrypting-geli></a></h3><div class=paragraph><p>Depuis FreeBSD 6.0, une nouvelle classe GEOM pour le chiffrage des données est disponible: <code>geli</code>. Cette classe est développée par Paweł Jakub Dawidek &lt;<a href=mailto:pjd@FreeBSD.org>pjd@FreeBSD.org</a>>. L’outil <code>geli</code> est différent de <code>gbde</code>; il offre des fonctionnalités différentes et utilise une méthode différente pour chiffrer les données.</p></div><div class=paragraph><p>Les caractéristiques les plus importantes de <a href="https://man.freebsd.org/cgi/man.cgi?query=geli&amp;sektion=8&amp;format=html">geli(8)</a> sont:</p></div><div class=ulist><ul><li><p>Utilisation du système <a href="https://man.freebsd.org/cgi/man.cgi?query=crypto&amp;sektion=9&amp;format=html">crypto(9)</a> - quand du matériel destiné au chiffrement est disponible dans la machine, <code>geli</code> l’utilisera automatiquement.</p></li><li><p>Support de plusieurs algorithmes de chiffrement (actuellement AES, Blowfish, et 3DES).</p></li><li><p>Permettre le chiffrage de la partition racine. La phrase d’authentification utilisée pour accéder à la partition racine chiffrée sera demandée au démarrage du système.</p></li><li><p>Permettre l’emploi de deux clés indépendantes (par exemple une "clé utilisateur" et une "clé entreprise").</p></li><li><p><code>geli</code> est rapide-il effectue un simple chiffrement de secteur à secteur.</p></li><li><p>Permettre la sauvegarde et la restauration des clés principales. Quand un utilisateur doit détruire ses clés, il sera possible d’accéder à nouveau aux données en restaurant les clés à partir de la sauvegarde.</p></li><li><p>Permettre d’attacher un disque avec une clé aléatoire à usage unique - utile pour les partitions de pagination et les systèmes de fichiers temporaires.</p></li></ul></div><div class=paragraph><p>Plus de caractéristiques concernant <code>geli</code> peuvent être trouvées dans la page de manuel de <a href="https://man.freebsd.org/cgi/man.cgi?query=geli&amp;sektion=8&amp;format=html">geli(8)</a>.</p></div><div class=paragraph><p>Les points suivants décriront comment activer le support pour <code>geli</code> dans le noyau FreeBSD et expliqueront comment créer et utiliser un <em>provider</em> (ou partition) chiffré <code>geli</code>.</p></div><div class=paragraph><p>Afin de pouvoir employer <code>geli</code>, vous devez utiliser FreeBSD 6.0-RELEASE ou une version ultérieure. Les privilèges du super-utilisateur seront également nécessaire puisque il faudra effectuer des modifications au niveau du noyau.</p></div><div class="exampleblock procedure"><div class=content><div class="olist arabic"><ol class=arabic><li><p>Ajouter le support <code>geli</code> au noyau</p><div class=paragraph><p>Ajoutez les lignes suivantes au fichier de configuration du noyau:</p></div><div class="literalblock programlisting"><div class=content><pre>options GEOM_ELI
device crypto</pre></div></div><div class=paragraph><p>Recompilez le noyau comme décrit dans la <a href=../kernelconfig/#kernelconfig>Configurer le noyau de FreeBSD</a>.</p></div><div class=paragraph><p>Sinon, le module <code>geli</code> peut être chargé au démarrage. Ajoutez la ligne suivante au fichier <span class=filename>/boot/loader.conf</span>:</p></div><div class="literalblock programlisting"><div class=content><pre>geom_eli_load=&#34;YES&#34;</pre></div></div><div class=paragraph><p>Le système <a href="https://man.freebsd.org/cgi/man.cgi?query=geli&amp;sektion=8&amp;format=html">geli(8)</a> devrait désormais être supporté par le noyau.</p></div></li><li><p>Générer la clé principale</p><div class=paragraph><p>L’exemple suivant décrira la méthode pour générer un fichier clé qui sera utilisé comme partie de la clé principale pour le <em>provider</em> chiffré monté sous le répertoire <span class=filename>/private</span>. Le fichier clé fournira des données aléatoires qui seront employées pour chiffrer la clé principale. La clé principale sera également protégée par une phrase d’authentification. La taille des secteurs du <em>provider</em> sera de 4Ko. De plus, sera décrit comment attacher au système le <em>provider</em> geli, créer un système de fichiers dessus, utiliser ce système de fichiers et enfin comment le détacher.</p></div><div class=paragraph><p>Il est recommandé d’utiliser une taille de secteur plus grande (comme 4Ko) pour de meilleures performances.</p></div><div class=paragraph><p>La clé principale sera protégée avec une phrase d’authentification et la source de données pour le fichier clé sera <span class=filename>/dev/random</span>. La taille des secteurs de <span class=filename>/dev/da2.eli</span>, partition que nous appelons <em>provider</em>, sera de 4Ko.</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># dd if=/dev/random of=/root/da2.key bs=64 count=1</span>
<span class=c># geli init -s 4096 -K /root/da2.key /dev/da2</span>
Enter new passphrase:
Reenter new passphrase:</code></pre></div></div><div class=paragraph><p>Il n’est pas obligatoire d’utiliser la phrase d’authentification et le fichier clé; chacune de ces méthodes de sécurisation de la clé principale peut être utilisée séparément.</p></div><div class=paragraph><p>Si à la place du fichier clé un "-" est passé, l’entrée standard sera utilisée. Cet exemple montre comment on peut utiliser plus d’un fichier clé:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># cat keyfile1 keyfile2 keyfile3 | geli init -K - /dev/da2</span></code></pre></div></div></li><li><p>Attacher le <em>provider</em> avec la clé générée</p><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># geli attach -k /root/da2.key /dev/da2</span>
Enter passphrase:</code></pre></div></div><div class=paragraph><p>Le nouveau périphérique sera appelé <span class=filename>/dev/da2.eli</span>.</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># ls /dev/da2*</span>
/dev/da2  /dev/da2.eli</code></pre></div></div></li><li><p>Créer le nouveau système de fichiers</p><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># dd if=/dev/random of=/dev/da2.eli bs=1m</span>
<span class=c># newfs /dev/da2.eli</span>
<span class=c># mount /dev/da2.eli /private</span></code></pre></div></div><div class=paragraph><p>Le système de fichiers chiffré devrait être maintenant visible par <a href="https://man.freebsd.org/cgi/man.cgi?query=df&amp;sektion=1&amp;format=html">df(1)</a> et disponible à l’utilisation:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># df -H</span>
Filesystem     Size   Used  Avail Capacity  Mounted on
/dev/ad0s1a    248M    89M   139M    38%    /
/devfs         1.0K   1.0K     0B   100%    /dev
/dev/ad0s1f    7.7G   2.3G   4.9G    32%    /usr
/dev/ad0s1d    989M   1.5M   909M     0%    /tmp
/dev/ad0s1e    3.9G   1.3G   2.3G    35%    /var
/dev/da2.eli   150G   4.1K   138G     0%    /private</code></pre></div></div></li><li><p>Démonter et détacher le <em>provider</em></p><div class=paragraph><p>Une fois l’utilisation de la partition chiffrée achevée et que la partition <span class=filename>/private</span> n’est plus nécessaire, il est prudent de penser à démonter et détacher la partition <code>geli</code> chiffrée:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># umount /private</span>
<span class=c># geli detach da2.eli</span></code></pre></div></div></li></ol></div></div></div><div class=paragraph><p>Plus d’information sur l’utilisation de <a href="https://man.freebsd.org/cgi/man.cgi?query=geli&amp;sektion=8&amp;format=html">geli(8)</a> peut être trouvée dans sa page de manuel.</p></div><div class=sect3><h4 id=_utiliser_la_procédure_rc_d_de_geli>18.16.2.1. Utiliser la procédure <span class=filename>rc.d</span> de <span class=filename>geli</span><a class=anchor href=#_utiliser_la_procédure_rc_d_de_geli></a></h4><div class=paragraph><p>La commande <span class=filename>geli</span> est fournie avec une procédure <span class=filename>rc.d</span> qui peut être employée pour simplifier l’utilisation de <code>geli</code>. Un exemple de configuration de <code>geli</code> à l’aide de <a href="https://man.freebsd.org/cgi/man.cgi?query=rc.conf&amp;sektion=5&amp;format=html">rc.conf(5)</a> sera:</p></div><div class="literalblock programlisting"><div class=content><pre>geli_devices=&#34;da2&#34;
geli_da2_flags=&#34;-p -k /root/da2.key&#34;</pre></div></div><div class=paragraph><p>Ces lignes configureront <span class=filename>/dev/da2</span> comme <em>provider</em> <code>geli</code> avec une clé principale <span class=filename>/root/da2.key</span>, de plus <code>geli</code> n’utilisera pas de phrase d’authentification pour attacher le <em>provider</em> (notez que ceci n’est utilisable que si l’option <code>-P</code> a été passée durant la phase <code>geli init</code>). Le système détachera du noyau le <em>provider</em> <code>geli</code> avant l’arrêt du système.</p></div><div class=paragraph><p>Plus d’information sur la configuration du système <span class=filename>rc.d</span> est fournie dans la section <a href=../config/#configtuning-rcd>rc.d</a> de ce Manuel.</p></div></div></div></div></div><div class=sect1><h2 id=swap-encrypting>18.17. Chiffrage de l’espace de pagination<a class=anchor href=#swap-encrypting></a></h2><div class=sectionbody><div class=paragraph><p>Sous FreeBSD, le chiffrement de l’espace de pagination est simple à mettre en place et est possible depuis FreeBSD 5.3-RELEASE. En fonction de la version de FreeBSD utilisée, différentes options sont disponibles et la configuration peut légèrement varier. Depuis FreeBSD 6.0-RELEASE, les systèmes de chiffrage <a href="https://man.freebsd.org/cgi/man.cgi?query=gbde&amp;sektion=8&amp;format=html">gbde(8)</a> ou <a href="https://man.freebsd.org/cgi/man.cgi?query=geli&amp;sektion=8&amp;format=html">geli(8)</a> peuvent être utilisé à cet effet. Avec les versions antérieures, seul <a href="https://man.freebsd.org/cgi/man.cgi?query=gbde&amp;sektion=8&amp;format=html">gbde(8)</a> est disponible. Les deux systèmes utilisent la procédure <a href=../config/#configtuning-rcd>rc.d</a> nommée <span class=filename>encswap</span>.</p></div><div class=paragraph><p>La section précédente, <a href=#disks-encrypting>Chiffrer les partitions d’un disque</a>, contient une courte explication sur les différents systèmes de chiffrage.</p></div><div class=sect2><h3 id=_pourquoi_lespace_de_pagination_devrait_être_chiffré>18.17.1. Pourquoi l’espace de pagination devrait être chiffré?<a class=anchor href=#_pourquoi_lespace_de_pagination_devrait_être_chiffré></a></h3><div class=paragraph><p>Comme pour le chiffrage des partitions d’un disque, chiffrer l’espace de pagination a pour but la protection des informations sensibles. Imaginez une application qui, par exemple, traite des mots de passe. Tant que ces mots de passe résident en mémoire tout va pour le mieux. Cependant, si le système d’exploitation commence à transférer des pages mémoires vers l’espace de pagination en vue de libérer de la mémoire pour d’autres applications, les mots de passe peuvent être écrits en clair sur les plateaux du disque et seront faciles à récupérer par une personne malveillante. Chiffrer l’espace de pagination peut être une solution contre ce scénario.</p></div></div><div class=sect2><h3 id=_préparation>18.17.2. Préparation<a class=anchor href=#_préparation></a></h3><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Pour le reste de cette section, <span class=filename>ad0s1b</span> sera la partition réservée à l’espace de pagination.</p></div></td></tr></tbody></table></div><div class=paragraph><p>Jusqu’ici l’espace de pagination n’a jamais été chiffré. Il est fort possible qu’il y ait déjà des mots de passe ou toute autre donnée sensible de présents en clair sur les plateaux du disque. Afin d’y remédier, les données de la partition de pagination doivent être écrasées avec des données aléatoires:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># dd if=/dev/random of=/dev/ad0s1b bs=1m</span></code></pre></div></div></div><div class=sect2><h3 id=_chiffrer_de_lespace_de_pagination_avec_gbde8>18.17.3. Chiffrer de l’espace de pagination avec <a href="https://man.freebsd.org/cgi/man.cgi?query=gbde&amp;sektion=8&amp;format=html">gbde(8)</a><a class=anchor href=#_chiffrer_de_lespace_de_pagination_avec_gbde8></a></h3><div class=paragraph><p>Si FreeBSD 6.0-RELEASE ou une version plus récente est utilisée, le suffixe <code>.bde</code> doit être ajouté au nom de périphérique sur la ligne du fichier <span class=filename>/etc/fstab</span> correspondant à cet espace de pagination:</p></div><div class="literalblock programlisting"><div class=content><pre># Device                Mountpoint      FStype  Options         Dump    Pass#
/dev/ad0s1b.bde         none            swap    sw              0       0</pre></div></div><div class=paragraph><p>Pour les systèmes antérieurs à FreeBSD 6.0-RELEASE, la ligne suivante doit également être ajoutée à <span class=filename>/etc/rc.conf</span>:</p></div><div class="literalblock programlisting"><div class=content><pre>gbde_swap_enable=&#34;YES&#34;</pre></div></div></div><div class=sect2><h3 id=_chiffrage_de_lespace_de_pagination_avec_geli8>18.17.4. Chiffrage de l’espace de pagination avec <a href="https://man.freebsd.org/cgi/man.cgi?query=geli&amp;sektion=8&amp;format=html">geli(8)</a><a class=anchor href=#_chiffrage_de_lespace_de_pagination_avec_geli8></a></h3><div class=paragraph><p>La procédure pour le chiffrage de l’espace de pagination avec <a href="https://man.freebsd.org/cgi/man.cgi?query=geli&amp;sektion=8&amp;format=html">geli(8)</a> est similaire à celle pour l’utilisation de <a href="https://man.freebsd.org/cgi/man.cgi?query=gbde&amp;sektion=8&amp;format=html">gbde(8)</a>. Le suffixe <code>.eli</code> doit être ajouté au nom de périphérique sur la ligne du fichier <span class=filename>/etc/fstab</span> correspondant à cet espace de pagination:</p></div><div class="literalblock programlisting"><div class=content><pre># Device                Mountpoint      FStype  Options         Dump    Pass#
/dev/ad0s1b.eli         none            swap    sw              0       0</pre></div></div><div class=paragraph><p>Par défaut, <a href="https://man.freebsd.org/cgi/man.cgi?query=geli&amp;sektion=8&amp;format=html">geli(8)</a> utilise l’algorithme AES avec une longueur de clé de 256bits.</p></div><div class=paragraph><p>Les valeurs par défaut peuvent être modifiées en utilisant l’option <code>geli_swap_flags</code> dans le fichier <span class=filename>/etc/rc.conf</span>. La ligne suivante demande à la procédure rc.d <span class=filename>encswap</span> de créer des partitions de pagination en utilisant l’algorithme Blowfish avec une clé de 128 bits de longueur, une taille de secteur de 4 kilo-octets et avec l’option "detach on last close" (détacher après démontage de la partition) activée:</p></div><div class="literalblock programlisting"><div class=content><pre>geli_swap_flags=&#34;-a blowfish -l 128 -s 4096 -d&#34;</pre></div></div><div class=paragraph><p>Veuillez vous référer à la description de la commande <code>onetime</code> dans la page de manuel <a href="https://man.freebsd.org/cgi/man.cgi?query=geli&amp;sektion=8&amp;format=html">geli(8)</a> pour une liste des options possibles.</p></div></div><div class=sect2><h3 id=_vérifier_que_cela_fonctionne>18.17.5. Vérifier que cela fonctionne<a class=anchor href=#_vérifier_que_cela_fonctionne></a></h3><div class=paragraph><p>Une fois que le système a été redémarré, le fonctionnement correct de l’espace de pagination peut être vérifié en utilisant la commande <code>swapinfo</code>.</p></div><div class=paragraph><p>Si <a href="https://man.freebsd.org/cgi/man.cgi?query=gbde&amp;sektion=8&amp;format=html">gbde(8)</a> est utilisé:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>% swapinfo
Device          1K-blocks     Used    Avail Capacity
/dev/ad0s1b.bde    542720        0   542720     0%</code></pre></div></div><div class=paragraph><p>Si <a href="https://man.freebsd.org/cgi/man.cgi?query=geli&amp;sektion=8&amp;format=html">geli(8)</a> est utilisé:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>% swapinfo
Device          1K-blocks     Used    Avail Capacity
/dev/ad0s1b.eli    542720        0   542720     0%</code></pre></div></div></div></div></div></div><hr><div class=last-modified><p><strong>Last modified on</strong>: 20 août 2024 by <a href="https://cgit.freebsd.org/doc/commit/?id=cfa9804b6e" target=_blank>Fernando Apesteguía</a></p></div><div class=buttons><div class=prev><i class="fa fa-angle-left" aria-hidden=true title=Prev></i><div class=container><a href=https://docs.freebsd.org/fr/books/handbook/audit class=direction>Prev</a></div></div><div class=home><i class="fa fa-home" aria-hidden=true title=Home></i><div class=container><a href=../ class=direction>Home</a></div></div><div class=next><div class=container><a href=https://docs.freebsd.org/fr/books/handbook/geom class=direction>Next</a></div><i class="fa fa-angle-right" aria-hidden=true title=Next></i></div></div><label class="hidden book-menu-overlay" for=menu-control></label></div><aside class=toc><div class=toc-content><h3>Sommaire</h3><nav id=TableOfContents><ul><li><a href=#disks-synopsis>18.1. Synopsis</a></li><li><a href=#disks-naming>18.2. Noms des périphériques</a></li><li><a href=#disks-adding>18.3. Ajouter des disques</a></li><li><a href=#raid>18.4. RAID</a></li><li><a href=#usb-disks>18.5. Périphériques de stockage USB</a></li><li><a href=#creating-cds>18.6. Création et utilisation de supports optiques (CDs)</a></li><li><a href=#creating-dvds>18.7. Création et utilisation de supports optiques (DVDs)</a></li><li><a href=#floppies>18.8. Création et utilisation de disquettes</a></li><li><a href=#backups-tapebackups>18.9. Créer et utiliser les bandes magnétiques</a></li><li><a href=#backups-floppybackups>18.10. Sauvegardes sur disquettes</a></li><li><a href=#backup-strategies>18.11. Stratégies de sauvegarde</a></li><li><a href=#backup-basics>18.12. Sauvegardes</a></li><li><a href=#disks-virtual>18.13. Systèmes de fichiers réseaux, en mémoire et sauvegardés sur fichier</a></li><li><a href=#snapshots>18.14. Instantané ("Snapshot") d’un système de fichiers</a></li><li><a href=#quotas>18.15. Quotas d’utilisation des disques</a></li><li><a href=#disks-encrypting>18.16. Chiffrer les partitions d’un disque</a></li><li><a href=#swap-encrypting>18.17. Chiffrage de l’espace de pagination</a></li></ul></nav><hr><div class=resources><h3>Ressources</h3><ul class=contents><li><i class="fa fa-file-pdf-o" aria-hidden=true title="Téléchargement en PDF"></i><a href=https://download.freebsd.org/doc/fr/books/handbook/handbook_fr.pdf>Téléchargement en PDF</a></li><li><i class="fa fa-pencil-square-o" aria-hidden=true title="Éditer cette page"></i><a href=https://github.com/freebsd/freebsd-doc/blob/main/documentation/content/fr/_index target=_blank>Éditer cette page</a></li></ul></div></div></aside><a class=to-top href=#top><i class="fa fa-arrow-circle-up" aria-hidden=true></i></a></main><footer><div class=footer-container><section class=logo-column><img src=https://docs.freebsd.org/images/FreeBSD-colors.svg width=160 height=50 alt="FreeBSD logo"><div class=options-container><div class=language-container><a id=languages href=https://docs.freebsd.org/fr/languages><img src=https://docs.freebsd.org/images/language.png class=language-image alt="Choose language">
<span>French</span></a></div><div class=theme-container><select id=theme-chooser><option value=theme-system>System</option><option value=theme-light>Clair</option><option value=theme-dark>Sombre</option><option value=theme-high-contrast>Contraste élevé</option></select></div></div></section><section class=about-column><h3 class=column-title>About</h3><ul class=column-elements-container><li><a href=https://www.freebsd.org/about/ target=_blank class=column-element>FreeBSD</a></li><li><a href=https://freebsdfoundation.org/ target=_blank class=column-element>FreeBSD Foundation</a></li><li><a href=https://www.freebsd.org/where/ target=_blank class=column-element>Get FreeBSD</a></li><li><a href=https://www.freebsd.org/internal/code-of-conduct target=_blank class=column-element>Code of Conduct</a></li><li><a href=https://www.freebsd.org/security/ target=_blank class=column-element>Security Advisories</a></li></ul></section><section class=documentation-column><h3 class=column-title>Documentation</h3><ul class=column-elements-container><li><a href=/fr class=column-element>Documentation portal</a></li><li><a href=https://man.FreeBSD.org target=_blank class=column-element>Manual pages</a></li><li><a href=https://papers.FreeBSD.org target=_blank class=column-element>Presentations and papers</a></li><li><a href=https://docs-archive.freebsd.org/doc/ target=_blank class=column-element>Previous versions</a></li><li><a href=https://docs-archive.freebsd.org/44doc/ target=_blank class=column-element>4.4BSD Documents</a></li><li><a href=https://wiki.freebsd.org/ target=_blank class=column-element>Wiki</a></li></ul></section><section class=community-column><h3 class=column-title>Community</h3><ul class=column-elements-container><li><a href=https://docs.freebsd.org/fr/articles/contributing class=column-element>Get involved</a></li><li><a href=https://forums.freebsd.org/ target=_blank class=column-element>Community forum</a></li><li><a href=https://lists.freebsd.org/ target=_blank class=column-element>Mailing lists</a></li><li><a href=https://wiki.freebsd.org/IRC/Channels target=_blank class=column-element>IRC Channels</a></li><li><a href=https://bugs.freebsd.org/bugzilla/ target=_blank class=column-element>Bug Tracker</a></li></ul></section><section class=legal-column><h3 class=column-title>Legal</h3><ul class=column-elements-container><li><a href=https://freebsdfoundation.org/donate/ target=_blank class=column-element>Donations</a></li><li><a href=https://www.freebsd.org/copyright/freebsd-license/ target=_blank class=column-element>Licensing</a></li><li><a href=https://www.freebsd.org/privacy/ target=_blank class=column-element>Privacy Policy</a></li><li><a href=https://www.freebsd.org/copyright/ target=_blank class=column-element>Legal notices</a></li></ul></section><section class=copyright-column><p>&copy; 1994-2024 The FreeBSD Project. All rights reserved</p><span>Made with <span class=heart>♥</span> by the FreeBSD Community</span></section></div></footer></body></html>