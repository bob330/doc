<!doctype html><html class=theme-light lang=fr><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content><meta name=keywords content><meta name=copyright content="1995-2024 The FreeBSD Foundation"><link rel=canonical href=https://docs.freebsd.org/fr/books/handbook/printing/><title>Chapitre 9. Imprimer | FreeBSD Documentation Portal</title>
<meta name=theme-color content="#790000"><meta name=color-scheme content="system light dark high-contrast"><link rel="shortcut icon" href=https://docs.freebsd.org/favicon.ico><link rel=stylesheet href=https://docs.freebsd.org/styles/main.min.css><link rel=stylesheet href=https://docs.freebsd.org/css/font-awesome-min.css><script defer src=/js/theme-chooser.min.js></script><script defer src=/js/copy-clipboard.min.js></script><script defer src=/js/search.min.js></script><meta name=twitter:card content="summary"><meta name=twitter:domain content="docs.FreeBSD.org"><meta name=twitter:site content="@freebsd"><meta name=twitter:url content="https://twitter.com/freebsd"><meta property="og:title" content="Chapitre 9. Imprimer"><meta property="og:description" content><meta property="og:type" content="website"><meta property="og:image" content="https://docs.freebsd.org/favicon.ico"><meta property="og:image:alt" content="FreeBSD Logo"><meta property="og:locale" content="fr"><meta property="og:url" content="https://docs.freebsd.org/fr/books/handbook/printing/"><meta property="og:site_name" content="FreeBSD Documentation Portal"><script type=application/ld+json>{"@context":"http://schema.org","@type":"Article","url":"https:\/\/docs.freebsd.org\/fr\/books\/handbook\/printing\/","name":"FreeBSD Documentation Portal","headline":"FreeBSD Documentation Portal","description":"FreeBSD Documentation Portal"}</script></head><body><header><div class=header-container><div class=logo-menu-bars-container><a href=https://www.FreeBSD.org class=logo><img src=https://docs.freebsd.org/images/FreeBSD-monochromatic.svg width=160 height=50 alt="FreeBSD logo">
</a><label class=menu-bars for=menu-bars><i class="fa fa-bars" aria-hidden=true></i></label></div><input id=menu-bars type=checkbox><nav><ul class=menu><li class=menu-item><input id=about type=checkbox>
<a href=# aria-label="Navigate to About section"><label class=menu-item-description for=about>About
<i class="fa fa-angle-down fa-lg" aria-hidden=true></i></label></a><ul class=sub-menu><li class=title><a href=https://www.freebsd.org/about/ target=_blank>About</a></li><li><a href=https://www.freebsd.org/about/ target=_blank>FreeBSD</a></li><li><a href=https://freebsdfoundation.org/about-us/about-the-foundation/ target=_blank>FreeBSD Foundation</a></li><li><a href=https://www.freebsd.org/internal/code-of-conduct/ target=_blank>Code of Conduct</a></li></ul></li><li class=menu-item><input id=download type=checkbox>
<a href=# aria-label="Navigate to get FreeBSD section"><label class=menu-item-description for=download>Get FreeBSD
<i class="fa fa-angle-down fa-lg" aria-hidden=true></i></label></a><ul class=sub-menu><li class=title><a href=https://www.freebsd.org/where/ target=_blank>Get FreeBSD</a></li><li><a href=https://www.freebsd.org/releases/ target=_blank>Release Information</a></li><li><a href=https://www.freebsd.org/releng/ target=_blank>Release Engineering</a></li><li><a href=https://www.freebsd.org/security/ target=_blank>Security Advisories</a></li></ul></li><li class=menu-item><input id=documentation type=checkbox>
<a href=# aria-label="Navigate to get Documentation section"><label class=menu-item-description for=documentation>Documentation
<i class="fa fa-angle-down fa-lg" aria-hidden=true></i></label></a><ul class=sub-menu><li class=title><a href=/fr>Documentation portal</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook>FreeBSD Handbook</a></li><li><a href=https://docs.freebsd.org/fr/books/porters-handbook>Porter's Handbook</a></li><li><a href=https://docs.FreeBSD.org/en/books/fdp-primer>Documentation Project Handbook</a></li><li><a href=https://man.FreeBSD.org target=_blank>Manual pages</a></li><li><a href=https://papers.FreeBSD.org target=_blank>Presentations and papers</a></li><li><a href=https://wiki.FreeBSD.org target=_blank>Wiki</a></li><li><a href=https://docs.freebsd.org/fr/books>Books</a></li><li><a href=https://docs.freebsd.org/fr/articles>Articles</a></li></ul></li><li class=menu-item><input id=community type=checkbox>
<a href=# aria-label="Navigate to get Community section"><label class=menu-item-description for=community>Community
<i class="fa fa-angle-down fa-lg" aria-hidden=true></i></label></a><ul class=sub-menu><li class=title><a href=https://www.freebsd.org/community/>Community</a></li><li><a href=https://docs.freebsd.org/fr/articles/contributing>Get involved</a></li><li><a href=https://forums.freebsd.org/ target=_blank>Forum</a></li><li><a href=https://lists.freebsd.org/ target=_blank>Mailing lists</a></li><li><a href=https://wiki.freebsd.org/IRC/Channels target=_blank>IRC Channels</a></li><li><a href=https://bugs.freebsd.org/bugzilla/ target=_blank>Bug Tracker</a></li><li><a href=https://www.freebsd.org/support/ target=_blank>Support</a></li></ul></li></ul></nav><div class=search-donate-container><form class=search method=get id=search-header-form action=https://docs.freebsd.org/search name=search-header-form><input type=hidden name=DB value=fr>
<input id=words name=P type=text size=20 maxlength=255>
<button>
<i class="fa fa-search" aria-hidden=true></i></button></form><div class=donate><a href=https://freebsdfoundation.org/donate/ target=_blank><span class=heart>♥</span>
Donate</a></div></div></div></header><input type=checkbox class="hidden toggle" id=menu-control><main class=main-wrapper-book><a id=top></a><aside class=book-menu><div class=book-menu-content><input id=search-book type=text placeholder=Search aria-label=Search maxlength=128><nav id=MenuContents><ul><li><input type=checkbox id=chapter-eb2a98ce203d8afd517726e6d8776be3 class=toggle>
<label class="icon cursor" for=chapter-eb2a98ce203d8afd517726e6d8776be3><a role=button></a></label><a href=https://docs.freebsd.org/fr/books/handbook/preface/>Préface</a><ul><li><a href=https://docs.freebsd.org/fr/books/handbook/preface/#preface-audience>Public visé</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/preface/#preface-changes-from2>Modifications depuis la Seconde Edition</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/preface/#preface-changes>Modifications depuis la Première Edition</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/preface/#preface-overview>Organisation de cet ouvrage</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/preface/#preface-conv>Conventions utilisées dans ce livre</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/preface/#preface-acknowledgements>Remerciements</a></li></ul></li><li><input type=checkbox id=chapter-14a525fce014b90b8a458a894818255a class=toggle>
<label for=chapter-14a525fce014b90b8a458a894818255a><a role=button></a></label><a href=https://docs.freebsd.org/fr/books/handbook/parti/>Partie I. Pour commencer</a></li><li><input type=checkbox id=chapter-f9c9f3451644df30d224350da97d5da6 class=toggle>
<label class="icon cursor" for=chapter-f9c9f3451644df30d224350da97d5da6><a role=button></a></label><a href=https://docs.freebsd.org/fr/books/handbook/introduction/>Chapitre 1. Introduction</a><ul><li><a href=https://docs.freebsd.org/fr/books/handbook/introduction/#introduction-synopsis>1.1. Synopsis</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/introduction/#nutshell>1.2. Bienvenue à FreeBSD!</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/introduction/#history>1.3. A propos du Projet FreeBSD</a></li></ul></li><li><input type=checkbox id=chapter-f693a3fa687a72d63ec8129ee302d664 class=toggle>
<label class="icon cursor" for=chapter-f693a3fa687a72d63ec8129ee302d664><a role=button></a></label><a href=https://docs.freebsd.org/fr/books/handbook/bsdinstall/>Chapitre 2. Installer FreeBSD</a><ul><li><a href=https://docs.freebsd.org/fr/books/handbook/bsdinstall/#bsdinstall-synopsis>2.1. Synopsis</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/bsdinstall/#bsdinstall-hardware>2.2. Configuration matérielle minimale</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/bsdinstall/#bsdinstall-pre>2.3. Tâches de pré-installation</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/bsdinstall/#bsdinstall-start>2.4. Lancer l’installation</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/bsdinstall/#using-bsdinstall>2.5. Utilisation de bsdinstall</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/bsdinstall/#bsdinstall-partitioning>2.6. Allouer l’espace disque</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/bsdinstall/#bsdinstall-fetching-distribution>2.7. Récupération des fichiers de distribution</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/bsdinstall/#bsdinstall-post>2.8. Comptes utilisateurs, fuseau horaire, services et renforcement de la sécurité</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/bsdinstall/#bsdinstall-network>2.9. Interfaces réseau</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/bsdinstall/#bsdinstall-install-trouble>2.10. Dépannage</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/bsdinstall/#using-live-cd>2.11. Utilisation du CD Live</a></li></ul></li><li><input type=checkbox id=chapter-9f6db261075f578742036fcc6000eecd class=toggle>
<label class="icon cursor" for=chapter-9f6db261075f578742036fcc6000eecd><a role=button></a></label><a href=https://docs.freebsd.org/fr/books/handbook/basics/>Chapitre 3. Quelques bases d'UNIX</a><ul><li><a href=https://docs.freebsd.org/fr/books/handbook/basics/#basics-synopsis>3.1. Synopsis</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/basics/#consoles>3.2. Consoles virtuelles terminaux</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/basics/#permissions>3.3. Permissions</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/basics/#dirstructure>3.4. Organisation de l’arborescence des répertoires</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/basics/#disk-organization>3.5. Organisation des disques</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/basics/#mount-unmount>3.6. Monter et démonter des systèmes de fichiers</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/basics/#basics-processes>3.7. Processus</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/basics/#basics-daemons>3.8. Daemons, signaux, et comment tuer un processus</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/basics/#shells>3.9. Interpréteurs de commandes - "Shells"</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/basics/#editors>3.10. Editeurs de texte</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/basics/#basics-devices>3.11. Périphériques et fichiers spéciaux de périphérique</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/basics/#binary-formats>3.12. Le format des fichiers binaires</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/basics/#basics-more-information>3.13. Pour plus d’information</a></li></ul></li><li><input type=checkbox id=chapter-01c5707e95d14c0ff84bf62600c958d1 class=toggle>
<label class="icon cursor" for=chapter-01c5707e95d14c0ff84bf62600c958d1><a role=button></a></label><a href=https://docs.freebsd.org/fr/books/handbook/ports/>Chapitre 4. Installer des applications: les logiciels pré-compilés et les logiciels portés</a><ul><li><a href=https://docs.freebsd.org/fr/books/handbook/ports/#ports-synopsis>4.1. Synopsis</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/ports/#ports-overview>4.2. Généralités sur l’installation de logiciels</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/ports/#ports-finding-applications>4.3. Trouver votre application</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/ports/#packages-using>4.4. Utiliser le système des logiciels pré-compilés</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/ports/#ports-using>4.5. Utiliser le catalogue des logiciels portés</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/ports/#ports-nextsteps>4.6. Activités de post-installation</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/ports/#ports-broken>4.7. Que faire avec les logiciels portés ne fonctionnant pas?</a></li></ul></li><li><input type=checkbox id=chapter-3405c00581365a8b5d16af70fe4d1b72 class=toggle>
<label class="icon cursor" for=chapter-3405c00581365a8b5d16af70fe4d1b72><a role=button></a></label><a href=https://docs.freebsd.org/fr/books/handbook/x11/>Chapitre 5. Le système X Window</a><ul><li><a href=https://docs.freebsd.org/fr/books/handbook/x11/#x11-synopsis>5.1. Synopsis</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/x11/#x-understanding>5.2. Terminologie</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/x11/#x-install>5.3. Installer X11</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/x11/#x-config>5.4. Configuration d’Xorg</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/x11/#x-fonts>5.5. Utilisation des polices de caractères sous Xorg</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/x11/#x-xdm>5.6. Le gestionnaire de connexion graphique XDM</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/x11/#x11-wm>5.7. Environnements de bureau</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/x11/#x-compiz-fusion>5.8. Installation de Compiz Fusion</a></li></ul></li><li><input type=checkbox id=chapter-0eab3565e8f59f5a8a896dfba7eb3680 class=toggle>
<label for=chapter-0eab3565e8f59f5a8a896dfba7eb3680><a role=button></a></label><a href=https://docs.freebsd.org/fr/books/handbook/partii/>Partie II. Tâches courantes</a></li><li><input type=checkbox id=chapter-b33cf28993f3f7bf5baf036e79da0f39 class=toggle>
<label class="icon cursor" for=chapter-b33cf28993f3f7bf5baf036e79da0f39><a role=button></a></label><a href=https://docs.freebsd.org/fr/books/handbook/desktop/>Chapitre 6. Bureautique</a><ul><li><a href=https://docs.freebsd.org/fr/books/handbook/desktop/#desktop-synopsis>6.1. Synopsis</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/desktop/#desktop-browsers>6.2. Navigateurs</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/desktop/#desktop-productivity>6.3. Productivité</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/desktop/#desktop-viewers>6.4. Lecteurs de document</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/desktop/#desktop-finance>6.5. Finance</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/desktop/#desktop-summary>6.6. Résumé</a></li></ul></li><li><input type=checkbox id=chapter-152f694a19312ad72ec7bb4e1c3c33b2 class=toggle>
<label class="icon cursor" for=chapter-152f694a19312ad72ec7bb4e1c3c33b2><a role=button></a></label><a href=https://docs.freebsd.org/fr/books/handbook/multimedia/>Chapitre 7. Multimédia</a><ul><li><a href=https://docs.freebsd.org/fr/books/handbook/multimedia/#multimedia-synopsis>7.1. Synopsis</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/multimedia/#sound-setup>7.2. Configurer une carte son</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/multimedia/#sound-mp3>7.3. Fichiers MP3</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/multimedia/#video-playback>7.4. Lecture des Vidéos</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/multimedia/#tvcard>7.5. Configuration des cartes TV</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/multimedia/#scanners>7.6. Scanners</a></li></ul></li><li><input type=checkbox id=chapter-80888b4ee02e3e409e5f71cf97a36450 class=toggle>
<label class="icon cursor" for=chapter-80888b4ee02e3e409e5f71cf97a36450><a role=button></a></label><a href=https://docs.freebsd.org/fr/books/handbook/kernelconfig/>Chapitre 8. Configurer le noyau de FreeBSD</a><ul><li><a href=https://docs.freebsd.org/fr/books/handbook/kernelconfig/#kernelconfig-synopsis>8.1. Synopsis</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/kernelconfig/#kernelconfig-custom-kernel>8.2. Pourquoi compiler un noyau sur mesure?</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/kernelconfig/#kernelconfig-building>8.3. Compiler et installer un noyau sur mesure</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/kernelconfig/#kernelconfig-config>8.4. Le fichier de configuration</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/kernelconfig/#kernelconfig-trouble>8.5. Si quelque chose se passe mal</a></li></ul></li><li><input type=checkbox id=chapter-cb174c55879b17ab955f2f16989a79e0 class=toggle checked>
<label class="icon cursor" for=chapter-cb174c55879b17ab955f2f16989a79e0><a role=button></a></label><a href=https://docs.freebsd.org/fr/books/handbook/printing/>Chapitre 9. Imprimer</a><ul><li><a href=https://docs.freebsd.org/fr/books/handbook/printing/#printing-synopsis>9.1. Synopsis</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/printing/#printing-intro-spooler>9.2. Introduction</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/printing/#printing-intro-setup>9.3. Configuration de base</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/printing/#printing-advanced>9.4. Configuration avancée de l’imprimante</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/printing/#printing-using>9.5. Using Printers <strong>Traduction en Cours</strong></a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/printing/#printing-lpd-alternatives>9.6. Alternatives to the Standard Spooler <strong>Traduction en Cours</strong></a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/printing/#printing-troubleshooting>9.7. Troubleshooting <strong>Traduction en Cours</strong></a></li></ul></li><li><input type=checkbox id=chapter-c12b8c3f2a8fcefce87087241f695c83 class=toggle>
<label class="icon cursor" for=chapter-c12b8c3f2a8fcefce87087241f695c83><a role=button></a></label><a href=https://docs.freebsd.org/fr/books/handbook/linuxemu/>Chapitre 10. Compatibilité binaire avec Linux</a><ul><li><a href=https://docs.freebsd.org/fr/books/handbook/linuxemu/#linuxemu-synopsis>10.1. Synopsis</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/linuxemu/#linuxemu-lbc-install>10.2. Configurer la compatibilité binaire avec Linux</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/linuxemu/#linuxemu-packages>10.3. Système de base CentOS à partir des paquets binaires FreeBSD</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/linuxemu/#linuxemu-debootstrap>10.4. Système de base Debian / Ubuntu avec debootstrap(8)</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/linuxemu/#linuxemu-advanced>10.5. Sujets avancés</a></li></ul></li><li><input type=checkbox id=chapter-54c06b703788dcba4081bec5a0407412 class=toggle>
<label class="icon cursor" for=chapter-54c06b703788dcba4081bec5a0407412><a role=button></a></label><a href=https://docs.freebsd.org/fr/books/handbook/wine/>Chapitre 11. WINE</a><ul><li><a href=https://docs.freebsd.org/fr/books/handbook/wine/#wine-synopsis>11.1. Synopsis</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/wine/#wine-overview-concepts>11.2. WINE généralités et concepts</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/wine/#installing-wine-on-freebsd>11.3. Installer WINE sur FreeBSD</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/wine/#running-first-wine-program>11.4. Lancer un premier programme WINE sous FreeBSD</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/wine/#configuring-wine-installation>11.5. Configurer WINE après installation</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/wine/#wine-management-guis>11.6. Interfaces graphiques de gestion de WINE</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/wine/#wine-in-multi-user-os-installations>11.7. WINE sur un système FreeBSD avec plusieurs utilisateurs</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/wine/#wine-on-os-faq>11.8. WINE sur FreeBSD Foire Aux Questions</a></li></ul></li><li><input type=checkbox id=chapter-03b11ba627b9a0c85b247f5641bde272 class=toggle>
<label for=chapter-03b11ba627b9a0c85b247f5641bde272><a role=button></a></label><a href=https://docs.freebsd.org/fr/books/handbook/partiii/>Partie III. Administration Système</a></li><li><input type=checkbox id=chapter-6c31587f8d736319f099cd4dc1961301 class=toggle>
<label class="icon cursor" for=chapter-6c31587f8d736319f099cd4dc1961301><a role=button></a></label><a href=https://docs.freebsd.org/fr/books/handbook/config/>Chapitre 11. Configuration et optimisation</a><ul><li><a href=https://docs.freebsd.org/fr/books/handbook/config/#config-synopsis>11.1. Synopsis</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/config/#configtuning-core-configuration>11.2. Configuration principale</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/config/#configtuning-appconfig>11.3. Configuration des applications</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/config/#configtuning-starting-services>11.4. Démarrer des services</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/config/#configtuning-cron>11.5. Configuration de l’utilitaire <code>cron</code></a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/config/#configtuning-rcd>11.6. Utilisation du système rc(8) sous FreeBSD</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/config/#config-network-setup>11.7. Configuration des cartes réseaux</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/config/#configtuning-virtual-hosts>11.8. Hôtes virtuels</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/config/#configtuning-configfiles>11.9. Fichiers de configuration</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/config/#configtuning-sysctl>11.10. Optimisation avec sysctl(8)</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/config/#configtuning-disk>11.11. Optimiser les disques</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/config/#configtuning-kernel-limits>11.12. Optimisation des limitations du noyau</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/config/#adding-swap-space>11.13. Ajouter de l’espace de pagination</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/config/#acpi-overview>11.14. Gestion de l’énergie et des ressources</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/config/#ACPI-debug>11.15. Utiliser et déboguer l’ACPI sous FreeBSD</a></li></ul></li><li><input type=checkbox id=chapter-459f0012b3b4f0b6b123010f029da5e4 class=toggle>
<label class="icon cursor" for=chapter-459f0012b3b4f0b6b123010f029da5e4><a role=button></a></label><a href=https://docs.freebsd.org/fr/books/handbook/boot/>Chapitre 12. Processus de démarrage de FreeBSD</a><ul><li><a href=https://docs.freebsd.org/fr/books/handbook/boot/#boot-synopsis>12.1. Synopsis</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/boot/#boot-introduction>12.2. Le problème du démarrage</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/boot/#boot-blocks>12.3. Le gestionnaire de démarrage et les étapes de démarrage</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/boot/#boot-kernel>12.4. Interaction avec le noyau au démarrage</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/boot/#device-hints>12.5. "Device Hints"-Paramétrage des périphériques</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/boot/#boot-init>12.6. Init: Initialisation de la gestion des processus</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/boot/#boot-shutdown>12.7. Séquence d’arrêt du système</a></li></ul></li><li><input type=checkbox id=chapter-d251c21b963b5ab783e5aec225e02b5a class=toggle>
<label class="icon cursor" for=chapter-d251c21b963b5ab783e5aec225e02b5a><a role=button></a></label><a href=https://docs.freebsd.org/fr/books/handbook/users/>Chapitre 13. Gestion des comptes et des utilisateurs</a><ul><li><a href=https://docs.freebsd.org/fr/books/handbook/users/#users-synopsis>13.1. Synopsis</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/users/#users-introduction>13.2. Introduction</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/users/#users-superuser>13.3. Le compte super-utilisateur</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/users/#users-system>13.4. Comptes système</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/users/#users-user>13.5. Comptes utilisateur</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/users/#users-modifying>13.6. Modifier des comptes</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/users/#users-limiting>13.7. Mettre en place des restrictions pour les utilisateurs</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/users/#users-groups>13.8. Groupes</a></li></ul></li><li><input type=checkbox id=chapter-917c75fcffbb14d48ed6d0a48e7028f2 class=toggle>
<label class="icon cursor" for=chapter-917c75fcffbb14d48ed6d0a48e7028f2><a role=button></a></label><a href=https://docs.freebsd.org/fr/books/handbook/security/>Chapitre 14. Sécurité</a><ul><li><a href=https://docs.freebsd.org/fr/books/handbook/security/#security-synopsis>14.1. Synopsis</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/security/#security-intro>14.2. Introduction</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/security/#securing-freebsd>14.3. Securing FreeBSD <strong>Traduction en Cours</strong></a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/security/#crypt>14.4. DES, MD5, et chiffrement</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/security/#one-time-passwords>14.5. Mots de passe non réutilisables</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/security/#tcpwrappers>14.6. L’encapsuleur TCP ("TCP Wrappers")</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/security/#kerberosIV>14.7. Kerberos</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/security/#kerberos5>14.8. Kerberos5 <strong>Traduction en Cours</strong></a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/security/#openssl>14.9. OpenSSL</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/security/#ipsec>14.10. IPsec</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/security/#openssh>14.11. OpenSSH</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/security/#fs-acl>14.12. Listes de contrôle d’accès au système de fichiers</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/security/#security-portaudit>14.13. Surveillance des problèmes de sécurité relatifs aux programmes tierce-partie</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/security/#security-advisories>14.14. Avis de sécurité de FreeBSD</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/security/#security-accounting>14.15. Comptabilité des processus</a></li></ul></li><li><input type=checkbox id=chapter-1a2a8e719703649c2c66d99aa7a25fd4 class=toggle>
<label class="icon cursor" for=chapter-1a2a8e719703649c2c66d99aa7a25fd4><a role=button></a></label><a href=https://docs.freebsd.org/fr/books/handbook/jails/>Chapitre 15. Environnements jail</a><ul><li><a href=https://docs.freebsd.org/fr/books/handbook/jails/#jails-synopsis>15.1. Synopsis</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/jails/#jails-terms>15.2. Termes relatifs aux environnements jail</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/jails/#jails-intro>15.3. Introduction</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/jails/#jails-build>15.4. Création et contrôle de l’environnement jail</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/jails/#jails-tuning>15.5. Optimisation et administration</a></li></ul></li><li><input type=checkbox id=chapter-8f4620c77e572cbb58917911a33c73cf class=toggle>
<label class="icon cursor" for=chapter-8f4620c77e572cbb58917911a33c73cf><a role=button></a></label><a href=https://docs.freebsd.org/fr/books/handbook/mac/>Chapitre 16. Mandatory Access Control ** Traduction en Cours **</a><ul><li><a href=https://docs.freebsd.org/fr/books/handbook/mac/#mac-synopsis>16.1. Synopsis</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/mac/#mac-glossary>16.2. Key Terms in this Chapter</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/mac/#mac-initial>16.3. Explanation of MAC</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/mac/#mac-understandlabel>16.4. Understanding MAC Labels</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/mac/#mac-modules>16.5. Module Configuration</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/mac/#mac-bsdextended>16.6. The MAC bsdextended Module</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/mac/#mac-ifoff>16.7. The MAC ifoff Module</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/mac/#mac-portacl>16.8. The MAC portacl Module</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/mac/#mac-labelingpolicies>16.9. MAC Policies with Labeling Features</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/mac/#mac-partition>16.10. The MAC partition Module</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/mac/#mac-mls>16.11. The MAC Multi-Level Security Module</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/mac/#mac-biba>16.12. The MAC Biba Module</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/mac/#mac-lomac>16.13. The MAC LOMAC Module</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/mac/#mac-implementing>16.14. Implementing a Secure Environment with MAC</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/mac/#MAC-examplehttpd>16.15. Another Example: Using MAC to Constrain a Web Server</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/mac/#mac-troubleshoot>16.16. Troubleshooting the MAC Framework</a></li></ul></li><li><input type=checkbox id=chapter-9598d66a76cb3182057b6bcd775149a0 class=toggle>
<label class="icon cursor" for=chapter-9598d66a76cb3182057b6bcd775149a0><a role=button></a></label><a href=https://docs.freebsd.org/fr/books/handbook/audit/>Chapitre 17. Audit des événements relatifs à la sécurité du système</a><ul><li><a href=https://docs.freebsd.org/fr/books/handbook/audit/#audit-synopsis>17.1. Synopsis</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/audit/#audit-inline-glossary>17.2. Mots-clés</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/audit/#audit-config>17.3. Configuration de l’audit</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/audit/#audit-administration>17.4. Travailler avec les traces d’audit</a></li></ul></li><li><input type=checkbox id=chapter-e1edcad13d9db6e8e4cb645d378ecfaf class=toggle>
<label class="icon cursor" for=chapter-e1edcad13d9db6e8e4cb645d378ecfaf><a role=button></a></label><a href=https://docs.freebsd.org/fr/books/handbook/disks/>Chapitre 18. Stockage des données</a><ul><li><a href=https://docs.freebsd.org/fr/books/handbook/disks/#disks-synopsis>18.1. Synopsis</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/disks/#disks-naming>18.2. Noms des périphériques</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/disks/#disks-adding>18.3. Ajouter des disques</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/disks/#raid>18.4. RAID</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/disks/#usb-disks>18.5. Périphériques de stockage USB</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/disks/#creating-cds>18.6. Création et utilisation de supports optiques (CDs)</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/disks/#creating-dvds>18.7. Création et utilisation de supports optiques (DVDs)</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/disks/#floppies>18.8. Création et utilisation de disquettes</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/disks/#backups-tapebackups>18.9. Créer et utiliser les bandes magnétiques</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/disks/#backups-floppybackups>18.10. Sauvegardes sur disquettes</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/disks/#backup-strategies>18.11. Stratégies de sauvegarde</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/disks/#backup-basics>18.12. Sauvegardes</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/disks/#disks-virtual>18.13. Systèmes de fichiers réseaux, en mémoire et sauvegardés sur fichier</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/disks/#snapshots>18.14. Instantané ("Snapshot") d’un système de fichiers</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/disks/#quotas>18.15. Quotas d’utilisation des disques</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/disks/#disks-encrypting>18.16. Chiffrer les partitions d’un disque</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/disks/#swap-encrypting>18.17. Chiffrage de l’espace de pagination</a></li></ul></li><li><input type=checkbox id=chapter-dde37901a0e0ea32745b67607854900f class=toggle>
<label class="icon cursor" for=chapter-dde37901a0e0ea32745b67607854900f><a role=button></a></label><a href=https://docs.freebsd.org/fr/books/handbook/geom/>Chapitre 19. GEOM: architecture modulaire de gestion des disques</a><ul><li><a href=https://docs.freebsd.org/fr/books/handbook/geom/#GEOM-synopsis>19.1. Synopsis</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/geom/#GEOM-intro>19.2. Introduction à GEOM</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/geom/#GEOM-striping>19.3. RAID0 - "Striping"</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/geom/#GEOM-mirror>19.4. RAID1 - "mirroring"</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/geom/#geom-ggate>19.5. Périphériques réseau "GEOM Gate"</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/geom/#geom-glabel>19.6. Ajouter un label à un disque</a></li></ul></li><li><input type=checkbox id=chapter-73e82560fcb7145b7c0e2ec47af8fc04 class=toggle>
<label class="icon cursor" for=chapter-73e82560fcb7145b7c0e2ec47af8fc04><a role=button></a></label><a href=https://docs.freebsd.org/fr/books/handbook/zfs/>Chapitre 20. The Z File System (ZFS) ** Traduction en Cours **</a><ul><li><a href=https://docs.freebsd.org/fr/books/handbook/zfs/#zfs-differences>20.1. What Makes ZFS Different</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/zfs/#zfs-quickstart>20.2. Quick Start Guide</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/zfs/#zfs-zpool>20.3. <code>zpool</code> Administration</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/zfs/#zfs-zfs>20.4. <code>zfs</code> Administration</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/zfs/#zfs-zfs-allow>20.5. Delegated Administration</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/zfs/#zfs-links>20.6. Additional Resources</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/zfs/#zfs-term>20.7. ZFS Features and Terminology</a></li></ul></li><li><input type=checkbox id=chapter-7af71270807eb7b70cd3eedc6577b254 class=toggle>
<label class="icon cursor" for=chapter-7af71270807eb7b70cd3eedc6577b254><a role=button></a></label><a href=https://docs.freebsd.org/fr/books/handbook/filesystems/>Chapitre 21. Autres systèmes de fichiers</a><ul><li><a href=https://docs.freebsd.org/fr/books/handbook/filesystems/#filesystems-synopsis>21.1. Synopsis</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/filesystems/#filesystems-linux>21.2. Systèmes de fichiers Linux®</a></li></ul></li><li><input type=checkbox id=chapter-dcd5a59a66ab6bff19287ccc6a33fd7e class=toggle>
<label class="icon cursor" for=chapter-dcd5a59a66ab6bff19287ccc6a33fd7e><a role=button></a></label><a href=https://docs.freebsd.org/fr/books/handbook/vinum/>Chapitre 22. Le gestionnaire de volume Vinum</a><ul><li><a href=https://docs.freebsd.org/fr/books/handbook/vinum/#vinum-synopsis>22.1. Synopsis</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/vinum/#vinum-intro>22.2. Les disques sont trop petits</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/vinum/#_les_goulots_détranglement_daccès_aux_données>22.3. Les goulots d’étranglement d’accès aux données</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/vinum/#_intégrité_des_données>22.4. Intégrité des données</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/vinum/#vinum-objects>22.5. Objets Vinum</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/vinum/#vinum-examples>22.6. Quelques exemples</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/vinum/#_appellation_des_objets>22.7. Appellation des objets</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/vinum/#vinum-config>22.8. Configuration de Vinum</a></li></ul></li><li><input type=checkbox id=chapter-375257268d95faaf87faf4f7a2e6aa67 class=toggle>
<label class="icon cursor" for=chapter-375257268d95faaf87faf4f7a2e6aa67><a role=button></a></label><a href=https://docs.freebsd.org/fr/books/handbook/virtualization/>Chapitre 23. Virtualisation</a><ul><li><a href=https://docs.freebsd.org/fr/books/handbook/virtualization/#virtualization-synopsis>23.1. Synopsis</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/virtualization/#virtualization-guest>23.2. FreeBSD comme système d’exploitation invité</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/virtualization/#virtualization-host>23.3. FreeBSD comme système d’exploitation hôte</a></li></ul></li><li><input type=checkbox id=chapter-49f1e96591c090304ea532012257f4ef class=toggle>
<label class="icon cursor" for=chapter-49f1e96591c090304ea532012257f4ef><a role=button></a></label><a href=https://docs.freebsd.org/fr/books/handbook/l10n/>Chapitre 24. Localisation - Utilisation et configuration de l'I18N/L10N</a><ul><li><a href=https://docs.freebsd.org/fr/books/handbook/l10n/#l10n-synopsis>24.1. Synopsis</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/l10n/#l10n-basics>24.2. Les bases</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/l10n/#using-localization>24.3. Utiliser la localisation</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/l10n/#l10n-compiling>24.4. Compiler des programmes I18N</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/l10n/#lang-setup>24.5. Localiser FreeBSD pour des langues spécifiques</a></li></ul></li><li><input type=checkbox id=chapter-dead2b4c5ea325dd390a9b0dccd8f763 class=toggle>
<label class="icon cursor" for=chapter-dead2b4c5ea325dd390a9b0dccd8f763><a role=button></a></label><a href=https://docs.freebsd.org/fr/books/handbook/cutting-edge/>Chapitre 25. Mise à jour de FreeBSD</a><ul><li><a href=https://docs.freebsd.org/fr/books/handbook/cutting-edge/#updating-upgrading-synopsis>25.1. Synopsis</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/cutting-edge/#updating-upgrading-freebsdupdate>25.2. Mise à jour de FreeBSD</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/cutting-edge/#updating-upgrading-portsnap>25.3. Portsnap: un outil de mise à jour du catalogue des logiciels portés</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/cutting-edge/#updating-upgrading-documentation>25.4. Updating the Documentation Set <strong>Traduction en Cours</strong></a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/cutting-edge/#current-stable>25.5. Suivre une branche de développement</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/cutting-edge/#synching>25.6. Synchroniser vos sources</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/cutting-edge/#makeworld>25.7. Recompiler le système</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/cutting-edge/#small-lan>25.8. Suivre les mises à jour pour plusieurs machines</a></li></ul></li><li><input type=checkbox id=chapter-29c1eeb0e9dedc487a98399e2737ee8a class=toggle>
<label class="icon cursor" for=chapter-29c1eeb0e9dedc487a98399e2737ee8a><a role=button></a></label><a href=https://docs.freebsd.org/fr/books/handbook/dtrace/>Chapitre 26. DTrace</a><ul><li><a href=https://docs.freebsd.org/fr/books/handbook/dtrace/#dtrace-synopsis>26.1. Synopsis</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/dtrace/#dtrace-implementation>26.2. Des différences de mise en oeuvre</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/dtrace/#dtrace-enable>26.3. Activer la prise en charge de DTrace</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/dtrace/#dtrace-using>26.4. Utiliser DTrace</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/dtrace/#dtrace-language>26.5. Le langage D</a></li></ul></li><li><input type=checkbox id=chapter-bbd25f9a194f9c39ca2d658c75767db5 class=toggle>
<label for=chapter-bbd25f9a194f9c39ca2d658c75767db5><a role=button></a></label><a href=https://docs.freebsd.org/fr/books/handbook/partiv/>Partie IV. Réseau</a></li><li><input type=checkbox id=chapter-499dab596afd7ddac77e80295314e0dd class=toggle>
<label class="icon cursor" for=chapter-499dab596afd7ddac77e80295314e0dd><a role=button></a></label><a href=https://docs.freebsd.org/fr/books/handbook/serialcomms/>Chapitre 27. Serial Communications ** Traduction en Cours **</a><ul><li><a href=https://docs.freebsd.org/fr/books/handbook/serialcomms/#serial-synopsis>27.1. Synopsis</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/serialcomms/#serial>27.2. Introduction</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/serialcomms/#term>27.3. Terminals</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/serialcomms/#dialup>27.4. Dial-in Service</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/serialcomms/#dialout>27.5. Dial-out Service</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/serialcomms/#serialconsole-setup>27.6. Setting Up the Serial Console</a></li></ul></li><li><input type=checkbox id=chapter-95e4571c48bee1cced5e84a538d302e3 class=toggle>
<label class="icon cursor" for=chapter-95e4571c48bee1cced5e84a538d302e3><a role=button></a></label><a href=https://docs.freebsd.org/fr/books/handbook/ppp-and-slip/>Chapitre 28. PPP et SLIP</a><ul><li><a href=https://docs.freebsd.org/fr/books/handbook/ppp-and-slip/#ppp-and-slip-synopsis>28.1. Synopsis</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/ppp-and-slip/#userppp>28.2. Using User PPP <strong>Traduction en Cours</strong></a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/ppp-and-slip/#ppp>28.3. Utiliser PPP intégré au noyau</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/ppp-and-slip/#pppoe>28.4. Utiliser PPP sur Ethernet (PPPoE)</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/ppp-and-slip/#pppoa>28.5. Utiliser PPP sur ATM (PPPoA)</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/ppp-and-slip/#slip>28.6. Utiliser SLIP</a></li></ul></li><li><input type=checkbox id=chapter-f089ac726c401c9b4bd5c34a295e11bb class=toggle>
<label class="icon cursor" for=chapter-f089ac726c401c9b4bd5c34a295e11bb><a role=button></a></label><a href=https://docs.freebsd.org/fr/books/handbook/mail/>Chapitre 29. Courrier électronique</a><ul><li><a href=https://docs.freebsd.org/fr/books/handbook/mail/#mail-synopsis>29.1. Synopsis</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/mail/#mail-using>29.2. Utilisation du courrier électronique</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/mail/#sendmail>29.3. Configuration de sendmail</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/mail/#mail-changingmta>29.4. Changer votre agent de transfert de courrier</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/mail/#mail-trouble>29.5. Dépannage</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/mail/#mail-advanced>29.6. Sujets avancés</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/mail/#SMTP-UUCP>29.7. SMTP avec UUCP</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/mail/#outgoing-only>29.8. Configuration pour l’envoi seul</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/mail/#SMTP-dialup>29.9. Utiliser le courrier électronique avec une connexion temporaire</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/mail/#SMTP-Auth>29.10. Authentification SMTP</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/mail/#mail-agents>29.11. Clients de messagerie</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/mail/#mail-fetchmail>29.12. Utiliser fetchmail</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/mail/#mail-procmail>29.13. Utiliser procmail</a></li></ul></li><li><input type=checkbox id=chapter-6de4de3fe925639d4175ce4b6f8c1829 class=toggle>
<label class="icon cursor" for=chapter-6de4de3fe925639d4175ce4b6f8c1829><a role=button></a></label><a href=https://docs.freebsd.org/fr/books/handbook/network-servers/>Chapitre 30. Serveurs réseau</a><ul><li><a href=https://docs.freebsd.org/fr/books/handbook/network-servers/#network-servers-synopsis>30.1. Synopsis</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/network-servers/#network-inetd>30.2. Le "super-serveur" inetd</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/network-servers/#network-nfs>30.3. Système de fichiers réseau (NFS)</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/network-servers/#network-nis>30.4. Services d’information réseau (NIS/YP)</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/network-servers/#network-dhcp>30.5. Configuration réseau automatique (DHCP)</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/network-servers/#network-dns>30.6. Serveurs de noms (DNS)</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/network-servers/#network-apache>30.7. Serveur HTTP Apache</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/network-servers/#network-ftp>30.8. Protocole de transfert de fichiers (FTP)</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/network-servers/#network-samba>30.9. Serveur de fichiers et d’impression pour clients Microsoft® Windows® (Samba)</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/network-servers/#network-ntp>30.10. Synchronisation de l’horloge avec NTP</a></li></ul></li><li><input type=checkbox id=chapter-776d855c7b75e048f90b5c2c9b35ffe0 class=toggle>
<label class="icon cursor" for=chapter-776d855c7b75e048f90b5c2c9b35ffe0><a role=button></a></label><a href=https://docs.freebsd.org/fr/books/handbook/firewalls/>Chapitre 31. Firewalls ** Traduction en Cours **</a><ul><li><a href=https://docs.freebsd.org/fr/books/handbook/firewalls/#firewalls-intro>31.1. Introduction</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/firewalls/#firewalls-concepts>31.2. Firewall Concepts</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/firewalls/#firewalls-apps>31.3. Firewall Packages</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/firewalls/#firewalls-pf>31.4. The OpenBSD Packet Filter (PF) and ALTQ</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/firewalls/#firewalls-ipf>31.5. The IPFILTER (IPF) Firewall</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/firewalls/#firewalls-ipfw>31.6. IPFW</a></li></ul></li><li><input type=checkbox id=chapter-5b07f776a0e6155c1c89aa0d15610380 class=toggle>
<label class="icon cursor" for=chapter-5b07f776a0e6155c1c89aa0d15610380><a role=button></a></label><a href=https://docs.freebsd.org/fr/books/handbook/advanced-networking/>Chapitre 32. Administration réseau avancée</a><ul><li><a href=https://docs.freebsd.org/fr/books/handbook/advanced-networking/#advanced-networking-synopsis>32.1. Synopsis</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/advanced-networking/#network-routing>32.2. Passerelles et routes</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/advanced-networking/#network-wireless>32.3. Réseau sans fil</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/advanced-networking/#network-bluetooth>32.4. Bluetooth</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/advanced-networking/#network-bridging>32.5. Bridging</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/advanced-networking/#network-diskless>32.6. Système sans disque dur</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/advanced-networking/#network-isdn>32.7. ISDN</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/advanced-networking/#network-natd>32.8. Translation d’adresses</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/advanced-networking/#network-plip>32.9. IP sur liaison parallèle (PLIP)</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/advanced-networking/#network-ipv6>32.10. IPv6</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/advanced-networking/#network-atm>32.11. ATM ("Asynchronous Transfer Mode")</a></li></ul></li><li><input type=checkbox id=chapter-171a77aa9d067a1024f849470e1f33e8 class=toggle>
<label for=chapter-171a77aa9d067a1024f849470e1f33e8><a role=button></a></label><a href=https://docs.freebsd.org/fr/books/handbook/partv/>Partie V. Annexes</a></li><li><input type=checkbox id=chapter-8050f436a0a7986a4aaded93d8e49469 class=toggle>
<label class="icon cursor" for=chapter-8050f436a0a7986a4aaded93d8e49469><a role=button></a></label><a href=https://docs.freebsd.org/fr/books/handbook/mirrors/>Annexe A. Se procurer FreeBSD</a><ul><li><a href=https://docs.freebsd.org/fr/books/handbook/mirrors/#mirrors-cdrom>A.1. Editeurs de CD-ROMs et DVDs</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/mirrors/#mirrors-ftp>A.2. Sites FTP</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/mirrors/#anoncvs>A.3. CVS anonyme</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/mirrors/#ctm>A.4. Utiliser CTM</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/mirrors/#cvsup>A.5. Utiliser CVSup</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/mirrors/#portsnap>A.6. Utiliser Portsnap</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/mirrors/#cvs-tags>A.7. Etiquettes CVS</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/mirrors/#mirrors-afs>A.8. Sites AFS</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/mirrors/#mirrors-rsync>A.9. Sites rsync</a></li></ul></li><li><input type=checkbox id=chapter-128b630a8f88f158e7027fe6c2184d21 class=toggle>
<label class="icon cursor" for=chapter-128b630a8f88f158e7027fe6c2184d21><a role=button></a></label><a href=https://docs.freebsd.org/fr/books/handbook/bibliography/>Annexe B. Bibliographie</a><ul><li><a href=https://docs.freebsd.org/fr/books/handbook/bibliography/#bibliography-freebsd>B.1. Livres magazines consacrés à FreeBSD</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/bibliography/#bibliography-userguides>B.2. Manuels d’utilisation</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/bibliography/#bibliography-adminguides>B.3. Manuels d’administration</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/bibliography/#bibliography-programmers>B.4. Manuels de programmation</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/bibliography/#bibliography-osinternals>B.5. "Internes" du système d’exploitation</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/bibliography/#bibliography-security>B.6. Ouvrages de référence en matière de sécurité</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/bibliography/#bibliography-hardware>B.7. Ouvrages de référence sur le matériel</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/bibliography/#bibliography-history>B.8. Histoire d’UNIX®</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/bibliography/#bibliography-journals>B.9. Revues et journaux</a></li></ul></li><li><input type=checkbox id=chapter-8bbb8867c46dac315e2253945d8c18a8 class=toggle>
<label class="icon cursor" for=chapter-8bbb8867c46dac315e2253945d8c18a8><a role=button></a></label><a href=https://docs.freebsd.org/fr/books/handbook/eresources/>Annexe C. Ressources sur Internet</a><ul><li><a href=https://docs.freebsd.org/fr/books/handbook/eresources/#eresources-mail>C.1. Listes de diffusion</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/eresources/#eresources-news>C.2. Forums de discussion</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/eresources/#eresources-web>C.3. Serveurs World Wide Web</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/eresources/#eresources-email>C.4. Adresses électroniques</a></li><li><a href=https://docs.freebsd.org/fr/books/handbook/eresources/#eresources-shell>C.5. Comptes</a></li></ul></li><li><input type=checkbox id=chapter-a80ea4f5a4480b8725422710f954ef36 class=toggle>
<label class="icon cursor" for=chapter-a80ea4f5a4480b8725422710f954ef36><a role=button></a></label><a href=https://docs.freebsd.org/fr/books/handbook/pgpkeys/>Annexe D. Clés OpenPGP</a><ul><li><a href=https://docs.freebsd.org/fr/books/handbook/pgpkeys/#pgpkeys-officers>D.1. Officers</a></li></ul></li><li></li></ul></nav></div></aside><div class=book><div class=book-menu-mobile><label for=menu-control><span class=menu-control-button><i class="fa fa-list" aria-hidden=true title="Book menu"></i>
Book menu</span></label></div><h1 class=title>Chapitre 9. Imprimer</h1><div class="admonitionblock note"><p><i class="fa fa-exclamation-circle" aria-hidden=true></i>
This translation may be out of date. To help with the translations please access the <a href=https://translate-dev.freebsd.org/ target=_blank>FreeBSD translations instance</a>.</p></div><div class=toc-mobile><h3>Sommaire</h3><nav id=TableOfContents><ul><li><a href=#printing-synopsis>9.1. Synopsis</a></li><li><a href=#printing-intro-spooler>9.2. Introduction</a></li><li><a href=#printing-intro-setup>9.3. Configuration de base</a></li><li><a href=#printing-advanced>9.4. Configuration avancée de l’imprimante</a></li><li><a href=#printing-using>9.5. Using Printers <strong>Traduction en Cours</strong></a></li><li><a href=#printing-lpd-alternatives>9.6. Alternatives to the Standard Spooler <strong>Traduction en Cours</strong></a></li><li><a href=#printing-troubleshooting>9.7. Troubleshooting <strong>Traduction en Cours</strong></a></li></ul></nav></div><div class=book-content><div id=preamble><div class=sectionbody></div></div><div class=sect1><h2 id=printing-synopsis>9.1. Synopsis<a class=anchor href=#printing-synopsis></a></h2><div class=sectionbody><div class=paragraph><p>FreeBSD peut être utilisé pour imprimer sur une grande variété d’imprimantes, depuis la plus ancienne des imprimantes matricielles jusqu’aux toutes dernières imprimantes laser, en passant par tout ce qui peut exister entre les deux, et vous permet d’obtenir des impressions de haute qualité avec les programmes que vous exécutez.</p></div><div class=paragraph><p>Il est également possible de configurer FreeBSD pour qu’il fasse office de serveur d’impression sur un réseau; de cette manière FreeBSD peut recevoir des travaux d’impression ("jobs") en provenance de différents ordinateurs, comprenant d’autres machines sous FreeBSD et des machines sous Windows® ou Mac OS®. FreeBSD veillera à ce qu’un seul travail d’impression ne soit imprimé à la fois, et pourra tenir des statistiques sur les utilisateurs et les machines lançant le plus d’impressions, produire des pages d'"en-têtes" pour distinguer les impressions de chacun, et plus encore.</p></div><div class=paragraph><p>Après la lecture de ce chapitre, vous saurez:</p></div><div class=ulist><ul><li><p>Comment configurer le gestionnaire d’impression de FreeBSD</p></li><li><p>Comment installer des filtres d’impression, pour gérer des travaux d’impression particuliers de manière différente, ce qui inclut la transformation de documents entrants en un format que vos imprimantes comprennent.</p></li><li><p>Comment inclure des en-têtes ou des pages bannière dans vos impressions.</p></li><li><p>Comment imprimer en utilisant des imprimantes connectées à d’autres ordinateurs.</p></li><li><p>Comment imprimer en utilisant des imprimantes connectées directement au réseau.</p></li><li><p>Comment gérer des restrictions d’impression, notamment comment limiter la taille des travaux d’impression, et empêcher certains utilisateurs d’imprimer.</p></li><li><p>Comment tenir des statistiques d’impression, et rendre compte de l’utilisation de l’imprimante.</p></li><li><p>Comment résoudre les problèmes d’impression.</p></li></ul></div><div class=paragraph><p>Avant de lire ce chapitre, vous devriez:</p></div><div class=ulist><ul><li><p>Savoir comment configurer et installer un nouveau noyau (<a href=../kernelconfig/#kernelconfig>Configurer le noyau de FreeBSD</a>).</p></li></ul></div></div></div><div class=sect1><h2 id=printing-intro-spooler>9.2. Introduction<a class=anchor href=#printing-intro-spooler></a></h2><div class=sectionbody><div class=paragraph><p>Afin d’utiliser des imprimantes avec FreeBSD, vous avez la possibilité de les paramétrer pour qu’elles utilisent le gestionnaire d’impression de Berkeley, également connu sous le nom de gestionnaire d’impression LPD, ou tout simplement LPD. C’est le système contrôle d’imprimante par défaut de FreeBSD. Ce chapitre présente LPD et vous assistera tout au long de sa configuration.</p></div><div class=paragraph><p>Si vous connaissez déjà LPD ou un autre système de gestion des impressions, vous pouvez directement vous rendre à la section <a href=#printing-intro-setup>Paramétrage de base</a>.</p></div><div class=paragraph><p>LPD contrôle tout ce qui relève des imprimantes. Il est responsable de plusieurs tâches:</p></div><div class=ulist><ul><li><p>Il contrôle l’accès aux imprimantes directement connectées au système ainsi qu’à celles connectées à d’autres machines via le réseau.</p></li><li><p>Il permet aux utilisateurs de soumettre des fichiers à imprimer; ces requêtes sont connues sous le nom de <em>travaux</em>.</p></li><li><p>Il empêche l’accès simultané de plusieurs utilisateurs à une même imprimante, en gérant une <em>queue</em> pour chaque imprimante.</p></li><li><p>Il peut produire des <em>pages d’en-tête</em> (également connues sous le nom de <em>pages bannières</em> ou encore <em>cartouches</em>) afin que les utilisateurs puissent facilement retrouver dans une pile d’impressions celles correspondant aux travaux qu’ils ont soumis.</p></li><li><p>Il s’occupe de paramétrer les communications lorsque les imprimantes sont connectées via un port série.</p></li><li><p>Il peut transmettre des travaux par réseau à un gestionnaire d’impression LPD situé sur une autre machine.</p></li><li><p>Il peut appliquer des filtres spéciaux afin d’assurer le formatage des travaux en fonction des différents langages et caractéristiques des imprimantes.</p></li><li><p>Il peut comptabiliser l’utilisation de l’imprimante.</p></li></ul></div><div class=paragraph><p>Vous pouvez, au travers d’un fichier de configuration (<span class=filename>/etc/printcap</span>) et en fournissant les programmes de filtres spéciaux, faire exécuter par LPD tout ou partie des tâches mentionnées ci-dessus sur une grande variété de modèles d’imprimantes.</p></div><div class=sect2><h3 id=printing-intro-why>9.2.1. Pourquoi vous devriez utiliser le gestionnaire d’impression<a class=anchor href=#printing-intro-why></a></h3><div class=paragraph><p>Si vous êtes l’unique utilisateur de votre système, vous vous demandez sans doute pourquoi il vous faudrait vous préoccuper du gestionnaire d’impression, alors que vous n’avez pas besoin de contrôle d’accès, de pages d’en-tête ni de statistiques relatives à l’utilisation de l’imprimante. Quand bien même il est possible de mettre en oeuvre l’accès direct à l’imprimante, vous devriez tout de même utiliser le gestionnaire d’impression, parce que:</p></div><div class=ulist><ul><li><p>LPD imprime les travaux en tâche de fond: vous n’êtes pas obligé d’attendre que les données soient passées à l’imprimante.</p></li><li><p>LPD peut commodément se charger d’appliquer des filtres à un travail pour adjoindre une en-tête contenant la date et l’heure, ou convertir un fichier au format particulier (comme un fichier DVI TeX) en un format que l’imprimante comprenne. Ainsi, vous n’aurez pas à vous charger de ces manipulations à la main.</p></li><li><p>Beaucoup d’applications, tant libres que commerciales, fournissant une fonctionnalité d’impression s’attendent généralement à traiter avec le gestionnaire d’impression. En le mettant en oeuvre, vous vous faciliterez le support des autres applications que vous pourriez ajouter plus tard, ou que vous avez déjà installées.</p></li></ul></div></div></div></div><div class=sect1><h2 id=printing-intro-setup>9.3. Configuration de base<a class=anchor href=#printing-intro-setup></a></h2><div class=sectionbody><div class=paragraph><p>Pour utiliser des imprimantes avec le gestionnaire d’impression, il vous faudra configurer à la fois la partie matérielle (c’est à dire les imprimantes) et la partie logicielle (c’est à dire LPD). Ce document présente deux niveaux de configuration:</p></div><div class=ulist><ul><li><p>La section <a href=#printing-simple>Configuration simple de l’imprimante</a> vous apprendra à connecter une imprimante, à renseigner LPD sur la façon dont il doit communiquer avec elle, et à imprimer de simples fichiers textes.</p></li><li><p>La section <a href=#printing-advanced>Configuration avancée de l’imprimante</a> vous apprendra à imprimer différents formats de fichiers, des pages d’en-tête, par l’intermédiaire d’un réseau, à contrôler l’accès aux imprimantes, et comptabiliser leur utilisation.</p></li></ul></div><div class=sect2><h3 id=printing-simple>9.3.1. Configuration simple de l’imprimante<a class=anchor href=#printing-simple></a></h3><div class=paragraph><p>Cette section vous apprendra à configurer l’imprimante et LPD. Elle présente les bases:</p></div><div class=ulist><ul><li><p>La section <a href=#printing-hardware>Configuration matérielle</a> donne des indications sur la façon de connecter l’imprimante à l’un des ports de votre ordinateur.</p></li><li><p>La section <a href=#printing-software>Configuration logicielle</a> montre comment renseigner le fichier de configuration du gestionnaire d’impression LPD (<span class=filename>/etc/printcap</span>).</p></li></ul></div><div class=paragraph><p>Si vous mettez en oeuvre une imprimante réceptionnant les données à imprimer via un protocole réseau plutôt que par les interfaces locales de l’ordinateur, lisez la section <a href=#printing-advanced-network-net-if>Imprimantes avec des interfaces utilisant des flux réseau</a>.</p></div><div class=paragraph><p>Bien que cette section soit intitulée "Configuration simple de l’imprimante", elle s’avère en réalité plutôt complexe. La partie la plus difficile consiste à faire fonctionner l’imprimante avec votre ordinateur et LPD. Les options avancées telles les pages d’en-tête ou les statistiques sont relativement faciles à mettre en oeuvre une fois que l’imprimante fonctionne.</p></div><div class=sect3><h4 id=printing-hardware>9.3.1.1. Configuration matérielle<a class=anchor href=#printing-hardware></a></h4><div class=paragraph><p>Cette section détaille les différentes manières de connecter une imprimante à votre PC. Elle discute les types de ports et de câbles, et de la configuration noyau dont vous pourriez avoir besoin afin que FreeBSD puisse communiquer avec l’imprimante.</p></div><div class=paragraph><p>Si vous avez déjà connecté votre imprimante et réussi à imprimer sous un autre système d’exploitation, vous pouvez probablement passer à la section <a href=#printing-software>Configuration logicielle</a>.</p></div><div class=sect4><h5 id=printing-ports>9.3.1.1.1. Les ports et les câbles<a class=anchor href=#printing-ports></a></h5><div class=paragraph><p>Les imprimantes pour PC vendues aujourd’hui sont en général pourvues d’une ou plusieurs des trois interfaces suivantes:</p></div><div class=ulist><ul><li><p>Les interfaces <em>série</em>, également connues sous les noms RS-232 ou ports COM, utilisent un port série sur votre ordinateur pour envoyer des données à l’imprimante. Les interfaces série sont courantes, dans l’industrie informatique, et les câbles sont à la fois disponibles et faciles à réaliser. Elles réclament parfois des câbles spéciaux et peuvent nécessiter le paramétrage d’options de communication assez complexes. La plupart des ports série PC ont une vitesse de transmission maximale de 115200 bps, ce qui rend l’impression de travaux comportant beaucoup de graphismes malaisée.</p></li><li><p>Les interfaces <em>parallèles</em> utilisent un port parallèle sur votre ordinateur pour envoyer des données à l’imprimante. Les interfaces parallèles sont courantes dans l’industrie informatique et plus rapides que les interfaces série RS-232. Les câbles sont disponibles mais sont moins faciles à fabriquer à la main. En général, il n’y a aucune option de communication à paramétrer avec ces interfaces, ce qui rend leur configuration particulièrement simple.</p><div class=paragraph><p>Les interfaces parallèles sont parfois appelées "Centronics", nom tiré du type de connecteur de l’imprimante</p></div></li><li><p>Les interfaces USB, tenant leur nom de "Universal Serial Bus", ou "Bus Série Universel", s’avèrent plus véloces encore que les interfaces parallèles ou série RS-232. Les câbles sont simples et peu onéreux. L’USB surpasse les interfaces série RS-232 et parallèles pour l’impression, mais son support par les systèmes UNIX® n’est pas aussi bon. Une façon d’éviter ce problème est d’acheter une imprimante qui dispose à la fois d’une interface USB et d’une interface parallèle, comme beaucoup de modèles.</p></li></ul></div><div class=paragraph><p>En règle générale, les interfaces parallèles n’offrent qu’une communication unidirectionnelle (de l’ordinateur vers l’imprimante) alors que les interfaces série et USB permettent un échange bidirectionnel. Les imprimantes et ports parallèles plus récents (EPP et ECP) peuvent communiquer dans les deux sens sous FreeBSD lorsque l’on a recourt à un câble conforme à la norme IEEE-1284.</p></div><div class=paragraph><p>La communication bidirectionnelle avec l’imprimante en utilisant un port parallèle se fait en général de l’une des deux manières suivantes. La première utilise un pilote d’imprimante compilé pour FreeBSD comprenant le langage propriétaire de l’imprimante. C’est couramment le cas des imprimantes jet d’encre et cela peut être utilisé pour retourner les niveaux d’encre et autres informations d’état. La seconde méthode est employée lorsque l’imprimante supporte PostScript®.</p></div><div class=paragraph><p>Les travaux PostScript® sont en fait des programmes envoyés à l’imprimante. Ils ne génèrent pas nécessairement de sortie papier et peuvent retourner leurs résultats directement à l’ordinateur. PostScript® utilise aussi la communication bidirectionnelle pour avertir l’ordinateur de problèmes, comme des erreurs dans le programme PostScript® ou des bourrages papier. Vos utilisateurs apprécieraient certainement de telles informations. De surcroît, la meilleure façon de tenir des statistiques sérieusement avec une imprimante PostScript® nécessite la communication bidirectionnelle: on demande à l’imprimante quel est son compteur de pages (combien en a-t-elle imprimées depuis sa fabrication), puis on lui envoie le travail de l’utilisateur, enfin on lui redemande son compteur de pages. La différence entre les deux valeurs donne la consommation de papier que vous pouvez attribuer à cet utilisateur.</p></div></div><div class=sect4><h5 id=printing-parallel>9.3.1.1.2. Les ports parallèles<a class=anchor href=#printing-parallel></a></h5><div class=paragraph><p>Pour raccorder une imprimante utilisant une interface parallèle, branchez le câble Centronics sur l’imprimante et sur l’ordinateur. Les instructions accompagnant l’imprimante, l’ordinateur, ou les deux, devraient parfaitement vous renseigner.</p></div><div class=paragraph><p>Souvenez-vous du port parallèle que vous avez utilisé sur l’ordinateur. Pour FreeBSD, le premier se nomme <span class=filename>ppc0</span>; le deuxième, <span class=filename>ppc1</span>, et ainsi de suite. Le nom du fichier spécial de périphérique de l’imprimante suit les mêmes règles: <span class=filename>/dev/lpt0</span> pour celle connectée sur le premier port parallèle, etc.</p></div></div><div class=sect4><h5 id=printing-serial>9.3.1.1.3. Les ports série<a class=anchor href=#printing-serial></a></h5><div class=paragraph><p>Pour raccorder une imprimante utilisant une interface série, branchez le câble série adéquat sur l’imprimante et sur l’ordinateur. Les instructions accompagnant l’imprimante, l’ordinateur, ou les deux, devraient parfaitement vous renseigner.</p></div><div class=paragraph><p>Si vous n’êtes pas sûr de savoir quel est le bon câble, voici ce que vous pouvez essayer:</p></div><div class=ulist><ul><li><p>Un câble <em>modem</em> relie chacune des broches du connecteur depuis l’une des extrémités du câble directement à la broche lui correspondant dans le connecteur de l’autre extrémité. Ce type de câble est également connu sous le nom de câble "DTE-to-DCE".</p></li><li><p>Un câble <em>null-modem</em> relie certaines des broches directement, en intervertit d’autres (par exemple, "émission de données" et "réception de données"), et en court-circuite d’autres en interne sur chacun des sertissages des connecteurs. Ce type de câble est également connu sous le nom de câble "DTE-to-DTE".</p></li><li><p>Un câble <em>série pour imprimante</em>, requis par certaines imprimantes peu conventionnelles, ressemble au câble null-modem, à ceci près qu’il envoie certains signaux à l’autre extrémité au lieu de les court-circuiter en interne.</p></li></ul></div><div class=paragraph><p>Vous devriez également définir les paramètres de communication pour l’imprimante, d’ordinaire en utilisant les contrôles sur la face avant ou les commutateurs sur l’imprimante. Choisissez la valeur la plus élevée de <code>bps</code> (bits par seconde, encore appelés "vitesse de transmission") autorisée conjointement par votre ordinateur et votre imprimante. Choisissez 7 ou 8 bits de données; aucun contrôle de parité ou un bit de parité paire ou impaire; et 1 ou 2 bits d’arrêt. Choisissez également un protocole de contrôle de flux: soit aucun, soit XON/XOFF (également appelé "in-band", ou encore "contrôle logiciel"). Retenez ces paramètres pour la configuration logicielle, dans la section qui suit.</p></div></div></div><div class=sect3><h4 id=printing-software>9.3.1.2. Configuration logicielle<a class=anchor href=#printing-software></a></h4><div class=paragraph><p>Cette section détaille la configuration logicielle nécessaire pour imprimer sous FreeBSD avec le gestionnaire d’impression LPD.</p></div><div class=paragraph><p>Voici un aperçu des étapes à suivre:</p></div><div class="exampleblock procedure"><div class=content><div class="olist arabic"><ol class=arabic><li><p>Configurez le noyau, si nécessaire, pour utiliser le port sur lequel vous raccorderez votre imprimante; la section <a href=#printing-kernel>Configurer le noyau de FreeBSD</a> vous donnera la marche à suivre.</p></li><li><p>Paramétrez le mode de communication du port parallèle si vous utilisez une imprimante de ce type; la section <a href=#printing-parallel-port-mode>Paramétrer le mode de communication du port parallèle</a> vous donnera les détails.</p></li><li><p>Configurez LPD pour qu’il communique avec l’imprimante en renseignant le fichier <span class=filename>/etc/printcap</span>. Vous apprendrez comment faire un peu plus loin dans ce chapitre.</p></li></ol></div></div></div><div class=sect4><h5 id=printing-kernel>9.3.1.2.1. Configuration du noyau<a class=anchor href=#printing-kernel></a></h5><div class=paragraph><p>Le noyau du système d’exploitation est compilé avec le support d’un certain ensemble de périphériques. Les interfaces série ou parallèle de votre imprimante en font partie. De ce fait, vous pourriez avoir à ajouter le support d’un port série ou parallèle supplémentaire si votre noyau n’a pas déjà été configuré en ce sens.</p></div><div class=paragraph><p>Pour savoir si le support d’une interface série est activé dans le noyau que vous êtes en train d’utiliser, entrez:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># # grep sioN /var/run/dmesg.boot</span></code></pre></div></div><div class=paragraph><p>Où <em>N</em> représente le numéro du port série, en commençant à zéro. Si vous obtenez un affichage similaire à:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>sio2 at port 0x3e8-0x3ef irq 5 on isa sio2: <span class=nb>type </span>16550A</code></pre></div></div><div class=paragraph><p>alors le port est activé dans le noyau.</p></div><div class=paragraph><p>Pour savoir si le noyau supporte une interface parallèle, entrez:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># grep ppcN /var/run/dmesg.boot</span></code></pre></div></div><div class=paragraph><p>Où <em>N</em> représente le numéro du port parallèle, en commençant à zéro. Si vous obtenez un affichage similaire à:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>ppc0: &lt;Parallel port&gt; at port 0x378-0x37f irq 7 on isa0
ppc0: SMC-like chipset <span class=o>(</span>ECP/EPP/PS2/NIBBLE<span class=o>)</span> <span class=k>in </span>COMPATIBLE mode
ppc0: FIFO with 16/16/8 bytes threshold</code></pre></div></div><div class=paragraph><p>alors le port est activé dans le noyau.</p></div><div class=paragraph><p>Il se pourrait que vous ayez à reconfigurer le noyau afin que le système détecte et puisse utiliser un port parallèle ou série auquel vous avez connecté votre imprimante.</p></div><div class=paragraph><p>Pour ajouter le support d’un port série, voyez la section sur la configuration du noyau. Pour ajouter le support du port parallèle, voyez cette même section <em>et</em> celle qui suit.</p></div></div></div><div class=sect3><h4 id=printing-parallel-port-mode>9.3.1.3. Paramétrer le mode de communication du port parallèle<a class=anchor href=#printing-parallel-port-mode></a></h4><div class=paragraph><p>Lorsque vous utilisez l’interface parallèle, vous avez le choix entre deux modes de communication avec l’imprimante: par interruption, ou par polling (interrogation régulière ou scrutation). Le pilote d’imprimante générique (<a href="https://man.freebsd.org/cgi/man.cgi?query=lpt&amp;sektion=4&amp;format=html">lpt(4)</a>) de FreeBSD utilise le système <a href="https://man.freebsd.org/cgi/man.cgi?query=ppbus&amp;sektion=4&amp;format=html">ppbus(4)</a>, qui contrôle le chipset du port via le pilote <a href="https://man.freebsd.org/cgi/man.cgi?query=ppc&amp;sektion=4&amp;format=html">ppc(4)</a>.</p></div><div class=ulist><ul><li><p>Le mode par <em>interruption</em> est le mode par défaut avec un noyau GENERIC. De cette manière, le système d’exploitation utilise une ligne d’interruption (IRQ) pour déterminer si l’imprimante est prête à recevoir des données.</p></li><li><p>Le mode <em>par scrutation</em> enjoint au système d’exploitation d’interroger à intervalles réguliers l’imprimante pour savoir si elle est prête à recevoir d’autres données. Lorsqu’elle répond par l’affirmative, le noyau lui en envoie plus.</p></li></ul></div><div class=paragraph><p>Le mode par interruption est en général nettement plus rapide, mais consomme une précieuse ligne d’interruption (IRQ). On rapporte que certaines imprimantes HP récentes ne fonctionneraient pas correctement en mode par interruption, apparemment à cause d’un problème (pas encore très bien identifié) d’horloge. Ces imprimantes nécessitent le recours au mode par scrutation. Utilisez celui des deux qui fonctionne. Certaines imprimantes fonctionnent dans les deux modes, mais s’avèrent désagréablement lentes en mode par interruption.</p></div><div class=paragraph><p>Vous pouvez choisir le mode de communication de deux manières différentes: en configurant le noyau ou en utilisant le programme <a href="https://man.freebsd.org/cgi/man.cgi?query=lptcontrol&amp;sektion=8&amp;format=html">lptcontrol(8)</a>.</p></div><div class=paragraph><p><em>Pour paramétrer le mode de communication en configurant le noyau:</em></p></div><div class="exampleblock procedure"><div class=content><div class="olist arabic"><ol class=arabic><li><p>Editez le fichier de configuration de votre noyau. Cherchez une entrée <code>ppc0</code>. Si vous voulez configurer le deuxième port parallèle, cherchez plutôt <code>ppc1</code>. Ou <code>ppc2</code> pour le troisième, et ainsi de suite.</p><div class=ulist><ul><li><p>Si vous souhaitez activer le mode par interruption, éditez la ligne suivante:</p><div class="literalblock programlisting"><div class=content><pre>hint.ppc.0.irq=&#34;N&#34;</pre></div></div><div class=paragraph><p>dans le fichier <span class=filename>/boot/device.hints</span> et remplacez <em>N</em> par le numéro d’IRQ approprié. Le fichier de configuration du noyau doit également comporter le pilote <a href="https://man.freebsd.org/cgi/man.cgi?query=ppc&amp;sektion=4&amp;format=html">ppc(4)</a>:</p></div><div class="literalblock programlisting"><div class=content><pre>device ppc</pre></div></div></li><li><p>Si vous souhaitez activer le mode par scrutation, ôtez la ligne suivante de votre fichier <span class=filename>/boot/device.hints</span>:</p><div class="literalblock programlisting"><div class=content><pre>hint.ppc.0.irq=&#34;N&#34;</pre></div></div><div class=paragraph><p>Dans certains cas, positionner le port en mode scrutation sous FreeBSD n’est pas suffisant. La plupart du temps cela vient du pilote <a href="https://man.freebsd.org/cgi/man.cgi?query=acpi&amp;sektion=4&amp;format=html">acpi(4)</a>, ce dernier étant capable de sonder et d’attacher des périphériques, et donc de contrôler le mode d’accès au port de l’imprimante. Vous devrez donc vérifier votre configuration <a href="https://man.freebsd.org/cgi/man.cgi?query=acpi&amp;sektion=4&amp;format=html">acpi(4)</a> pour résoudre ce problème.</p></div></li></ul></div></li><li><p>Sauvegardez le fichier, puis configurez, compilez, et installez le noyau avant de redémarrer. Consultez la section <a href=#kernelconfig>configuration du noyau</a> pour plus de détails.</p></li></ol></div></div></div><div class=paragraph><p><em>Pour paramétrer le mode de communication avec</em> <a href="https://man.freebsd.org/cgi/man.cgi?query=lptcontrol&amp;sektion=8&amp;format=html">lptcontrol(8)</a>:</p></div><div class="exampleblock procedure"><div class=content><div class="olist arabic"><ol class=arabic><li><p>Entrez:</p><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># lptcontrol -i -d /dev/lptN</span></code></pre></div></div><div class=paragraph><p>pour sélectionner le mode par interruption pour <code>lptN</code>.</p></div></li><li><p>Entrez:</p><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># lptcontrol -p -d /dev/lptN</span></code></pre></div></div><div class=paragraph><p>pour sélectionner le mode par scrutation pour <code>lptN</code>.</p></div></li></ol></div></div></div><div class=paragraph><p>Vous pouvez placer ces commandes dans votre fichier <span class=filename>/etc/rc.local</span> pour sélectionner le mode à chaque démarrage du système. Consultez <a href="https://man.freebsd.org/cgi/man.cgi?query=lptcontrol&amp;sektion=8&amp;format=html">lptcontrol(8)</a> pour obtenir plus d’informations.</p></div></div><div class=sect3><h4 id=printing-testing>9.3.1.4. Vérifier la communication avec l’imprimante<a class=anchor href=#printing-testing></a></h4><div class=paragraph><p>Avant de passer à la configuration du gestionnaire d’impression, vous devriez vous assurer que le système d’exploitation fait parvenir avec succès des données à l’imprimante. Il est beaucoup plus facile de déboguer séparément la communication avec l’imprimante et la configuration du gestionnaire d’impression.</p></div><div class=paragraph><p>Pour tester l’imprimante, nous allons lui envoyer du texte. Pour les imprimantes qui peuvent immédiatement imprimer les caractères qui leur sont envoyés, le programme <a href="https://man.freebsd.org/cgi/man.cgi?query=lptest&amp;sektion=1&amp;format=html">lptest(1)</a> est parfait: il génère les 96 caractères ASCII imprimables sur 96 lignes.</p></div><div class=paragraph><p>Pour une imprimante PostScript® (ou basée sur un autre langage), il va nous falloir un test plus sophistiqué. Un petit programme PostScript®, tel que celui qui suit, devrait suffire:</p></div><div class="literalblock programlisting"><div class=content><pre>%!PS
100 100 moveto 300 300 lineto stroke
310 310 moveto /Helvetica findfont 12 scalefont setfont
(Is this thing working?) show
showpage</pre></div></div><div class=paragraph><p>Le code PostScript® ci-dessus peut être placé dans un fichier et utilisé comme indiqué dans les exemples qui apparaissent dans les sections suivantes.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Lorsque ce document fait référence à un langage d’imprimante, il suppose un langage comme PostScript®, et pas le PCL de Hewlett-Packard. Quoique PCL dispose de fonctionnalités intéressantes, il est possible de mélanger du texte simple avec des séquences d’échappement. PostScript® ne permet pas d’imprimer du texte clair, c’est le type de langage d’imprimante pour lequel nous devons prendre des mesures particulières.</p></div></td></tr></tbody></table></div><div class=sect4><h5 id=printing-checking-parallel>9.3.1.4.1. Tester une imprimante parallèle<a class=anchor href=#printing-checking-parallel></a></h5><div class=paragraph><p>Cette section vous apprendra à vérifier si FreeBSD peut communiquer avec une imprimante connectée sur un port parallèle.</p></div><div class=paragraph><p><em>Pour tester une imprimante connectée sur un port parallèle:</em></p></div><div class="exampleblock procedure"><div class=content><div class="olist arabic"><ol class=arabic><li><p>Passez en <code>root</code> avec <a href="https://man.freebsd.org/cgi/man.cgi?query=su&amp;sektion=1&amp;format=html">su(1)</a>.</p></li><li><p>Envoyez des données à l’imprimante.</p><div class=ulist><ul><li><p>Si l’imprimante peut sortir du texte simple, alors utilisez <a href="https://man.freebsd.org/cgi/man.cgi?query=lptest&amp;sektion=1&amp;format=html">lptest(1)</a>. Entrez:</p><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># lptest  /dev/lptN</span></code></pre></div></div><div class=paragraph><p>Où <em>N</em> est le numéro du port parallèle, en commençant à zéro.</p></div></li><li><p>Si l’imprimante comprend le PostScript® ou un autre langage d’imprimante, alors envoyez lui un petit programme. Entrez:</p><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># cat  /dev/lptN</span></code></pre></div></div><div class=paragraph><p>Tapez ensuite le programme, ligne à ligne et <em>attentivement</em>, car vous ne pouvez plus éditer une ligne une fois que vous avez appuyé sur la touche <code>Retour Chariot</code> ou <code>Entrée</code>. Une fois terminé, faites <code>CONTROL+D</code>, ou la combinaison correspondant à votre fin de fichier.</p></div><div class=paragraph><p>Une autre manière de procéder est de placer le programme dans un fichier et d’entrer:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># cat fichier  /dev/lptN</span></code></pre></div></div><div class=paragraph><p>Où <em>fichier</em> désigne le nom du fichier que vous désirez envoyer à l’imprimante.</p></div></li></ul></div></li></ol></div></div></div><div class=paragraph><p>Vous devriez voir quelque chose s’imprimer. Ne vous inquiétez pas si l’apparence du texte n’est pas satisfaisante; nous remédierons à ce genre de soucis plus tard.</p></div></div><div class=sect4><h5 id=printing-checking-serial>9.3.1.4.2. Tester une imprimante série<a class=anchor href=#printing-checking-serial></a></h5><div class=paragraph><p>Dans cette section vous apprendrez à vérifier si FreeBSD parvient à communiquer avec une imprimante connectée à un port série.</p></div><div class=paragraph><p><em>Pour tester une imprimante connectée sur un port série:</em></p></div><div class="exampleblock procedure"><div class=content><div class="olist arabic"><ol class=arabic><li><p>Passez en <code>root</code> avec <a href="https://man.freebsd.org/cgi/man.cgi?query=su&amp;sektion=1&amp;format=html">su(1)</a>.</p></li><li><p>Editez le fichier <span class=filename>/etc/remote</span>. Ajoutez l’entrée suivante:</p><div class="literalblock programlisting"><div class=content><pre>printer:dv=/dev/port:br#bps-rate:pa=parity</pre></div></div><div class=paragraph><p>Où <em>port</em> représente le fichier de périphérique du port série (<code>ttyd0</code>, <code>ttyd1</code>, etc.), <em>bps-rate</em> représente la vitesse en bits-par-seconde à laquelle l’imprimante communique, et <em>parity</em> représente la parité réclamée par l’imprimante (<code>even</code> pour paire, <code>odd</code> pour impaire, <code>none</code> pour aucune, ou <code>zero</code> pour zéro).</p></div><div class=paragraph><p>Voici un exemple d’entrée pour une imprimante connectée à 19200 bps, sans parité, sur le troisième port série:</p></div><div class="literalblock programlisting"><div class=content><pre>printer:dv=/dev/ttyd2:br#19200:pa=none</pre></div></div></li><li><p>Connectez-vous à l’imprimante avec <a href="https://man.freebsd.org/cgi/man.cgi?query=tip&amp;sektion=1&amp;format=html">tip(1)</a>. Entrez:</p><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># tip printer</span></code></pre></div></div><div class=paragraph><p>Si cette étape ne fonctionne pas, éditez le fichier <span class=filename>/etc/remote</span> à nouveau et essayez d’utiliser <span class=filename>/dev/cuaaN</span> au lieu de <span class=filename>/dev/ttydN</span>.</p></div></li><li><p>Envoyez des données à l’imprimante.</p><div class=ulist><ul><li><p>Si l’imprimante peut sortir du texte simple, alors utilisez <a href="https://man.freebsd.org/cgi/man.cgi?query=lptest&amp;sektion=1&amp;format=html">lptest(1)</a>. Entrez:</p><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>% <span class=nv>$lptest</span></code></pre></div></div></li><li><p>Si l’imprimante comprend le PostScript® ou tout autre langage d’imprimante, envoyez-lui un petit programme. Entrez-le ligne à ligne et <em>très attentivement</em>, dans la mesure où les touches d’édition, comme retour-arrière, peuvent revêtir une signification particulière pour l’imprimante. Vous pourriez également avoir besoin d’un caractère de fin de fichier ("EOF") particulier pour que l’imprimante sache qu’elle a reçu tout le programme. Pour les imprimantes PostScript®, appuyez sur <code>CONTROL+D</code>.</p><div class=paragraph><p>Une autre manière de procéder est de placer le programme dans un fichier et d’entrer:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>% <span class=o>&gt;</span>fichier</code></pre></div></div><div class=paragraph><p>Où <em>fichier</em> est le nom du fichier contenant le programme. Après avoir envoyé le fichier avec <a href="https://man.freebsd.org/cgi/man.cgi?query=tip&amp;sektion=1&amp;format=html">tip(1)</a>, appuyez sur la touche de fin de fichier appropriée.</p></div></li></ul></div></li></ol></div></div></div><div class=paragraph><p>Vous devriez voir quelque chose s’imprimer. Ne vous inquiétez pas si l’apparence du texte n’est pas satisfaisante; nous remédierons à ce genre de soucis plus tard.</p></div></div></div><div class=sect3><h4 id=printing-printcap>9.3.1.5. Mettre en place le gestionnaire d’impression: le fichier <span class=filename>/etc/printcap</span><a class=anchor href=#printing-printcap></a></h4><div class=paragraph><p>A ce stade, votre imprimante doit être branchée, votre noyau configuré pour communiquer avec elle (si cela est nécessaire); et vous avez réussi à faire parvenir des données simples à l’imprimante. Nous sommes maintenant prêts à paramétrer LPD pour qu’il contrôle l’accès à l’imprimante.</p></div><div class=paragraph><p>LPD se paramètre en éditant le fichier <span class=filename>/etc/printcap</span>. Le gestionnaire d’impression LPD le lit à chaque fois que le gestionnaire est solicité, donc les mises à jour du fichier sont immédiatement prises en compte.</p></div><div class=paragraph><p>Le format du fichier <a href="https://man.freebsd.org/cgi/man.cgi?query=printcap&amp;sektion=5&amp;format=html">printcap(5)</a> est explicite. Utilisez votre éditeur favori pour modifier <span class=filename>/etc/printcap</span>. Le format est identique aux autres fichiers de configuration comme <span class=filename>/usr/shared/misc/termcap</span> et <span class=filename>/etc/remote</span>. Pour obtenir des informations complètes concernant ce format, consultez <a href="https://man.freebsd.org/cgi/man.cgi?query=cgetent&amp;sektion=3&amp;format=html">cgetent(3)</a>.</p></div><div class=paragraph><p>Le paramétrage simple du gestionnaire d’impression s’effectue selon les étapes suivantes:</p></div><div class="exampleblock procedure"><div class=content><div class="olist arabic"><ol class=arabic><li><p>Choisissez un nom (et quelques alias appropriés) pour l’imprimante, et placez-les dans <span class=filename>/etc/printcap</span>; lisez la section <a href=#printing-naming>Nommer l’imprimante</a> pour plus d’informations sur le nommage.</p></li><li><p>Désactivez les pages d’en-tête (elles sont activées par défaut) en insérant le paramètre <code>sh</code>; lisez la section <a href=#printing-no-header-pages>Supprimer les pages d’en-tête</a> pour plus d’informations.</p></li><li><p>Créez un répertoire de file d’attente, et précisez son chemin d’accès avec le paramètre <code>sd</code>; lisez la section <a href=#printing-spooldir>Créer le répertoire de fil d’attente</a> pour obtenir plus d’informations.</p></li><li><p>Sélectionnez l’entrée <span class=filename>dev</span> à utiliser pour l’imprimante, et notez la dans <span class=filename>/etc/printcap</span> avec le paramètre <code>lp</code>; lisez la section <a href=#printing-device>Identifier le périphérique d’imprimante</a> pour obtenir plus d’informations. De plus, si l’imprimante est reliée par un port série, précisez les paramètres de communication avec le paramètre <code>ms#</code>, qui est détaillé dans la section <a href=#printing-commparam>Configurer les paramètres de communication du gestionnaire d’impression</a>.</p></li><li><p>Installez un filtre d’entrée sous forme de fichier texte simple; lisez la section <a href=#printing-textfilter>Installer le filtre texte</a> pour obtenir plus de détails.</p></li><li><p>Testez la configuration en imprimant quelque chose avec la commande <a href="https://man.freebsd.org/cgi/man.cgi?query=lpr&amp;sektion=1&amp;format=html">lpr(1)</a>. Vous trouverez plus de détails dans les sections <a href=#printing-trying>Tester l’impression</a> et <a href=#printing-troubleshooting>Résolution des problèmes</a>.</p></li></ol></div></div></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Les imprimantes basées sur un langage d’impression, telles les imprimantes PostScript®, ne peuvent imprimer du texte simple directement. La configuration simple esquissée ci-dessus et détaillée dans les sections suivantes présuppose que si vous installez ce genre d’imprimante vous n’imprimerez que des fichiers qu’elle peut comprendre.</p></div></td></tr></tbody></table></div><div class=paragraph><p>Les utilisateurs s’attendent souvent à pouvoir imprimer du texte simple sur n’importe laquelle des imprimante installées sur votre système. Les applications qui s’en remettent à LPD pour imprimer s’y attendent en général elles aussi. Si vous installez ce genre d’imprimante et désirez pouvoir imprimer à la fois des travaux dans le langage de l’imprimante <em>et</em> des travaux en texte simple, vous êtes instamment prié d’ajouter une étape supplémentaire à la configuration simple esquissée ci-dessus: installez un programme de conversion automatique texte simple vers PostScript® (ou tout autre langage d’imprimante). La section <a href=#printing-advanced-if-conversion>Prendre en charge des travaux texte sur des imprimantes PostScript®</a> vous apprendra à le faire.</p></div><div class=sect4><h5 id=printing-naming>9.3.1.5.1. Nommer l’imprimante<a class=anchor href=#printing-naming></a></h5><div class=paragraph><p>La première étape (facile) est de choisir un nom pour l’imprimante. Que vous choisissiez un nom fonctionnel ou fantaisiste n’a aucune importance puisque vous pouvez également fournir une série d’alias.</p></div><div class=paragraph><p>Au moins l’une des imprimantes définies dans le fichier <span class=filename>/etc/printcap</span> devrait avoir pour alias <code>lp</code>. C’est le nom de l’imprimante par défaut. Si les utilisateurs n’ont pas positionné la variable d’environnement <code>PRINTER</code> et ne spécifient pas le nom d’une imprimante lorsqu’ils utilisent une ligne de commande relative à LPD, <code>lp</code> sera l’imprimante par défaut utilisée.</p></div><div class=paragraph><p>Par ailleurs, l’usage commun veut que le dernier alias d’une imprimante en soit une description complète, en incluant le fabricant et le modèle.</p></div><div class=paragraph><p>Une fois le nom et des alias communs choisis, placez-les dans le fichier <span class=filename>/etc/printcap</span>. Le nom de l’imprimante devrait commencer dans la colonne la plus à gauche. Séparez chaque alias par une barre verticale et mettez le caractère deux-points après le dernier alias.</p></div><div class=paragraph><p>Dans l’exemple suivant, nous commençons avec le squelette d’un <span class=filename>/etc/printcap</span> qui définit deux imprimantes (une Diablo 630 et une imprimante PostScript® laser Panasonic KX-P4455):</p></div><div class="literalblock programlisting"><div class=content><pre>#
#  /etc/printcap for host rose
#
rattan|line|diablo|lp|Diablo 630 Line Printer:

bamboo|ps|PS|S|panasonic|Panasonic KX-P4455 PostScript v51.4:</pre></div></div><div class=paragraph><p>Dans cet exemple, la première imprimante se nomme <code>rattan</code> et possède les alias suivants: <code>line</code>, <code>diablo</code>, <code>lp</code> et <code>Diablo 630 Line Printer</code>. Puisque l’alias <code>lp</code> lui est attribué, elle est également l’imprimante par défaut. La seconde s’appelle <code>bamboo</code> et possède les alias suivants: <code>ps</code>, <code>PS</code>, <code>S</code>, <code>panasonic</code> et <code>Panasonic KX-P4455 PostScript v51.4</code>.</p></div></div><div class=sect4><h5 id=printing-no-header-pages>9.3.1.5.2. Supprimer les pages d’en-tête<a class=anchor href=#printing-no-header-pages></a></h5><div class=paragraph><p>Par défaut, le gestionnaire d’impression LPD imprime une <em>page d’en-tête</em> pour chaque impression. Celle-ci mentionne le nom de l’utilisateur qui a demandé l’impression, la machine qui l’a envoyé, et le nom de l’impression, en grands et jolis caractères. Malheureusement, tout ce texte supplémentaire parasite le débogage d’une configuration simple de l’imprimante, aussi supprimerons-nous ces pages d’en-têtes.</p></div><div class=paragraph><p>Pour cela, ajoutez le paramètre <code>sh</code> à l’entrée de l’imprimante dans <span class=filename>/etc/printcap</span>. Voici un exemple de <span class=filename>/etc/printcap</span> où <code>sh</code> a été ajouté:</p></div><div class="literalblock programlisting"><div class=content><pre>#
#  /etc/printcap for host rose - no header pages anywhere
#
rattan|line|diablo|lp|Diablo 630 Line Printer:\
        :sh:

bamboo|ps|PS|S|panasonic|Panasonic KX-P4455 PostScript v51.4:\
        :sh:</pre></div></div><div class=paragraph><p>Observez la façon dont nous avons respecté le format correct: la première ligne commence dans la colonne la plus à gauche, et les lignes suivantes sont indentées. Toutes les lignes d’une entrée sauf la dernière se terminent par un antislash.</p></div></div><div class=sect4><h5 id=printing-spooldir>9.3.1.5.3. Créer le répertoire de file d’attente<a class=anchor href=#printing-spooldir></a></h5><div class=paragraph><p>La prochaine étape dans la configuration simple du gestionnaire d’impression consiste à créer un <em>répertoire de file d’attente</em>, c’est à dire un répertoire où les travaux vont demeurer jusqu’à ce qu’ils soient imprimés, et où un certain nombre d’autres fichiers nécessaires au gestionnaire d’impression prennent place.</p></div><div class=paragraph><p>A cause de la nature variable des répertoires de file d’attente, il est d’usage de les placer dans <span class=filename>/var/spool</span>. Il n’est pas non plus nécessaire de sauvegarder leur contenu. Les recréer est aussi simple que de faire un <a href="https://man.freebsd.org/cgi/man.cgi?query=mkdir&amp;sektion=1&amp;format=html">mkdir(1)</a>.</p></div><div class=paragraph><p>Il est également d’usage de créer le répertoire avec un nom identique à celui de l’imprimante, comme dans l’exemple ci-dessous:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># mkdir /var/spool/nom-de-l-imprimante</span></code></pre></div></div><div class=paragraph><p>Toutefois, si votre réseau comporte beaucoup d’imprimantes, vous pouvez préférer placer les répertoires de file d’attente dans un unique répertoire que vous réserverez à l’impression avec LPD. C’est ce que nous allons faire pour les deux imprimantes de notre exemple, <code>rattan</code> et <code>bamboo</code>:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># mkdir /var/spool/lpd</span>
<span class=c># mkdir /var/spool/lpd/rattan</span>
<span class=c># mkdir /var/spool/lpd/bamboo</span></code></pre></div></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Si la confidentialité des travaux imprimés par les utilisateurs vous importe, vous souhaiterez certainement protéger le répertoire de file d’attente afin qu’il ne soit pas accessible par tout le monde. Les répertoires de file d’attente doivent appartenir, être accessibles en lecture et écriture et pouvoir être parcourus par l’utilisateur <code>daemon</code> et le groupe <code>daemon</code>, et personne d’autre. C’est ce que nous allons faire pour les deux imprimantes de notre exemple:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># chown daemon:daemon /var/spool/lpd/rattan</span>
<span class=c># chown daemon:daemon /var/spool/lpd/bamboo</span>
<span class=c># chmod 770 /var/spool/lpd/rattan</span>
<span class=c># chmod 770 /var/spool/lpd/bamboo</span></code></pre></div></div></td></tr></tbody></table></div><div class=paragraph><p>Pour finir, vous devez avertir LPD de l’existence de ces répertoires en utilisant le fichier <span class=filename>/etc/printcap</span>. Vous spécifiez le chemin du répertoire file d’attente avec le paramètre <code>sd</code>:</p></div><div class="literalblock programlisting"><div class=content><pre>#
#  /etc/printcap for host rose - added spooling directories
#
rattan|line|diablo|lp|Diablo 630 Line Printer:\
        :sh:sd=/var/spool/lpd/rattan:

bamboo|ps|PS|S|panasonic|Panasonic KX-P4455 PostScript v51.4:\
        :sh:sd=/var/spool/lpd/bamboo:</pre></div></div><div class=paragraph><p>Notez que le nom de l’imprimante commence dans la première colonne mais que toutes les autres entrées décrivant l’imprimante doivent être indentées et que chaque fin de ligne doit être protégée par un antislash.</p></div><div class=paragraph><p>Si vous ne précisez pas de répertoire de file d’attente avec <code>sd</code>, le gestionnaire d’impression utilisera <span class=filename>/var/spool/lpd</span> par défaut.</p></div></div><div class=sect4><h5 id=printing-device>9.3.1.5.4. Identifier le périphérique d’imprimante<a class=anchor href=#printing-device></a></h5><div class=paragraph><p>Dans la section Entrées des périphériques nous avons identifié l’entrée du répertoire <span class=filename>/dev</span> que FreeBSD utiliserait pour communiquer avec l’imprimante. Maintenant, nous allons passer cette information à LPD. Quand le gestionnaire d’impression aura une impression à effectuer, il ouvrira le périphérique spécifié au nom du programme de filtre (qui est responsable de la transmission des données à l’imprimante).</p></div><div class=paragraph><p>Positionnez l’entrée pour le chemin d’accès <span class=filename>/dev</span> dans le fichier <span class=filename>/etc/printcap</span> en utilisant le paramètre <code>lp</code>.</p></div><div class=paragraph><p>Dans notre exemple, supposons que <code>rattan</code> est sur le premier port parallèle, et que <code>bamboo</code> est sur un sixième port série; voici les ajouts à apporter à <span class=filename>/etc/printcap</span>:</p></div><div class="literalblock programlisting"><div class=content><pre>#
#  /etc/printcap for host rose - identified what devices to use
#
rattan|line|diablo|lp|Diablo 630 Line Printer:\
        :sh:sd=/var/spool/lpd/rattan:\
        :lp=/dev/lpt0:

bamboo|ps|PS|S|panasonic|Panasonic KX-P4455 PostScript v51.4:\
        :sh:sd=/var/spool/lpd/bamboo:\
        :lp=/dev/ttyd5:</pre></div></div><div class=paragraph><p>Si dans votre <span class=filename>/etc/printcap</span> vous ne précisez pas le paramètre <code>lp</code> pour une imprimante, LPD utilisera <span class=filename>/dev/lp</span> par défaut. A l’heure actuelle, il n’existe pas d’entrée <span class=filename>/dev/lp</span> sous FreeBSD.</p></div><div class=paragraph><p>Si l’imprimante que vous êtes en train d’installer est connectée à un port parallèle, vous pouvez directement vous rendre à la section <a href=#printing-textfilter>Installer le filtre texte</a>. Sinon, assurez-vous de suivre les instructions de la section qui suit.</p></div></div><div class=sect4><h5 id=printing-commparam>9.3.1.5.5. Configurer les paramètres de communication du gestionnaire d’impression<a class=anchor href=#printing-commparam></a></h5><div class=paragraph><p>Pour les imprimantes connectées au port série, LPD peut configurer la vitesse en bps, la parité, et d’autres paramètres de communication série, pour le compte du programme de filtre qui envoie les données à l’imprimante. C’est avantageux dans la mesure où:</p></div><div class=ulist><ul><li><p>Cela vous laisse essayer divers paramètres simplement en éditant le fichier <span class=filename>/etc/printcap</span>; vous n’avez pas besoin de recompiler le programme de filtre.</p></li><li><p>Cela permet au gestionnaire d’impression d’utiliser le même programme pour de multiples imprimantes qui peuvent avoir des paramètres de communication série différents.</p></li></ul></div><div class=paragraph><p>Les paramètres <span class=filename>/etc/printcap</span> suivants contrôlent les options de communication série pour le périphérique spécifié dans le paramètre <code>lp</code>:</p></div><div class=dlist><dl><dt class=hdlist1><code>br#vitesse-bps</code></dt><dd><p>Positionne la vitesse de transmission du périphérique à <em>vitesse-bps</em>, où <em>vitesse-bps</em> peut prendre l’une des valeurs suivantes: 50, 75, 110, 134, 150, 200, 300, 600, 1200, 1800, 2400, 4800, 9600, 19200, 38400, 57600, ou 115200 bits par seconde.</p></dd><dt class=hdlist1><code>ms#stty-mode</code></dt><dd><p>Positionne les options du périphérique de terminal après l’avoir ouvert. <a href="https://man.freebsd.org/cgi/man.cgi?query=stty&amp;sektion=1&amp;format=html">stty(1)</a> présente les options disponibles.</p></dd></dl></div><div class=paragraph><p>Quand LPD ouvre le périphérique spécifié par le paramètre <code>lp</code>, il positionne les caractéristiques de ce périphérique aux valeurs précisées par le paramètre <code>ms#</code>. Les modes suivants, détaillés dans <a href="https://man.freebsd.org/cgi/man.cgi?query=stty&amp;sektion=1&amp;format=html">stty(1)</a> sont particulièrement intéressants: <code>parenb</code>, <code>parodd</code>, <code>cs5</code>, <code>cs6</code>, <code>cs7</code>, <code>cs8</code>, <code>cstopb</code>, <code>crtscts</code>, et <code>ixon</code>.</p></div><div class=paragraph><p>Peaufinons notre exemple pour l’imprimante qui est connectée au sixième port série. Nous allons paramétrer sa vitesse à 38400 bps. Quant au mode, nous allons spécifier aucune parité avec <code>-parenb</code>, des caractères 8 bits avec <code>cs8</code>, aucun contrôle modem avec <code>clocal</code> et un contrôle de flux matériel avec <code>crtscts</code>:</p></div><div class="literalblock programlisting"><div class=content><pre>bamboo|ps|PS|S|panasonic|Panasonic KX-P4455 PostScript v51.4:\
        :sh:sd=/var/spool/lpd/bamboo:\
        :lp=/dev/ttyd5:ms#-parenb cs8 clocal crtscts:</pre></div></div></div><div class=sect4><h5 id=printing-textfilter>9.3.1.5.6. Installer le filtre texte<a class=anchor href=#printing-textfilter></a></h5><div class=paragraph><p>Nous sommes maintenant en mesure de dire à LPD quel filtre texte utiliser pour envoyer les travaux à l’imprimante. Un <em>filtre texte</em>, également connu sous le nom de <em>filtre d’entrée</em>, est un programme que LPD lance lorsqu’il a une impression à effectuer. Lorsque LPD exécute le filtre texte pour une imprimante, il redirige l’entrée standard du filtre sur le travail d’impression, et la sortie standard sur le fichier spécial de périphérique spécifié par le paramètre <code>lp</code>. On attend du filtre qu’il lise le travail d’impression sur son entrée standard, effectue les transformations nécessaires pour l’imprimante, et écrive le résultat sur sa sortie standard, qui sera imprimée. Pour plus d’informations sur les filtres texte, lisez la section <a href=#printing-advanced-filters>Filtres</a>.</p></div><div class=paragraph><p>Pour notre configuration simple de l’imprimante, le filtre texte peut être une petite procédure d’interpréteur de commandes qui ne fera qu’exécuter <code>/bin/cat</code> pour envoyer le travail d’impression à l’imprimante. Un autre filtre est livré avec FreeBSD, nommé <span class=filename>lpf</span>, qui se charge de faire des suppressions arrière et des soulignements pour les imprimantes qui ne sauraient pas gérer correctement ce genre de flux de caractères. Et bien sûr, vous pouvez utiliser un autre filtre, quel qu’il soit. Le filtre <span class=filename>lpf</span> est détaillé dans la section <a href=#printing-advanced-lpf>lpf: un filtre texte</a>.</p></div><div class=paragraph><p>Tout d’abord, composons le filtre <span class=filename>/usr/local/libexec/if-simple</span> qui sera un simple filtre texte. Ecrivez ceci avec votre éditeur de texte favori:</p></div><div class="literalblock programlisting"><div class=content><pre>#!/bin/sh
#
# if-simple - Simple text input filter for lpd
# Installed in /usr/local/libexec/if-simple
#
# Simply copies stdin to stdout.  Ignores all filter arguments.

/bin/cat  exit 0
exit 2</pre></div></div><div class=paragraph><p>Rendez le fichier exécutable:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># chmod 555 /usr/local/libexec/if-simple</span></code></pre></div></div><div class=paragraph><p>Et avertissez LPD qu’il doit l’utiliser, en renseignant le paramètre <code>if</code> dans <span class=filename>/etc/printcap</span>. Nous l’ajouterons aux deux imprimantes utilisées jusqu’ici dans notre <span class=filename>/etc/printcap</span> d’exemple:</p></div><div class="literalblock programlisting"><div class=content><pre>#
#  /etc/printcap for host rose - added text filter
#
rattan|line|diablo|lp|Diablo 630 Line Printer:\
        :sh:sd=/var/spool/lpd/rattan:\ :lp=/dev/lpt0:\
        :if=/usr/local/libexec/if-simple:

bamboo|ps|PS|S|panasonic|Panasonic KX-P4455 PostScript v51.4:\
        :sh:sd=/var/spool/lpd/bamboo:\
        :lp=/dev/ttyd5:ms#-parenb cs8 clocal crtscts:\
        :if=/usr/local/libexec/if-simple:</pre></div></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Vous trouverez une copie du filtre <span class=filename>if-simple</span> dans le répertoire <span class=filename>/usr/shared/examples/printing</span>.</p></div></td></tr></tbody></table></div></div><div class=sect4><h5 id=_lancer_lpd>9.3.1.5.7. Lancer LPD<a class=anchor href=#_lancer_lpd></a></h5><div class=paragraph><p><a href="https://man.freebsd.org/cgi/man.cgi?query=lpd&amp;sektion=8&amp;format=html">lpd(8)</a> se lance depuis <span class=filename>/etc/rc</span>, avec la variable de contrôle <code>lpd_enable</code>. Cette variable a <code>NO</code> pour valeur par défaut. Si vous ne l’avez pas déjà fait, ajoutez la ligne:</p></div><div class="literalblock programlisting"><div class=content><pre>lpd_enable=&#34;YES&#34;</pre></div></div><div class=paragraph><p>à votre <span class=filename>/etc/rc.conf</span>, puis relancez votre machine, ou lancez simplement <a href="https://man.freebsd.org/cgi/man.cgi?query=lpd&amp;sektion=8&amp;format=html">lpd(8)</a>.</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># lpd</span></code></pre></div></div></div><div class=sect4><h5 id=printing-trying>9.3.1.5.8. Tester la configuration<a class=anchor href=#printing-trying></a></h5><div class=paragraph><p>Vous avez achevé la configuration simple de LPD. Malheureusement, les félicitations ne sont pas encore à l’ordre du jour, puisque nous devons encore tester la configuration et résoudre tout problème. Pour tester la configuration, essayez d’imprimer quelque chose. Pour imprimer avec le système LPD, vous devez utiliser la commande <a href="https://man.freebsd.org/cgi/man.cgi?query=lpr&amp;sektion=1&amp;format=html">lpr(1)</a>, qui soumet un travail d’impression.</p></div><div class=paragraph><p>Vous pouvez combiner <a href="https://man.freebsd.org/cgi/man.cgi?query=lpr&amp;sektion=1&amp;format=html">lpr(1)</a> au programme <a href="https://man.freebsd.org/cgi/man.cgi?query=lptest&amp;sektion=1&amp;format=html">lptest(1)</a>, que nous avons présenté à la section <a href=#printing-testing>Vérifier la communication avec l’imprimante</a>, pour produire du texte de test.</p></div><div class=paragraph><p><em>Pour tester la configuration simple de LPD</em></p></div><div class=paragraph><p>Entrez:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># lptest 20 5 | lpr -Pnom-de-l-imprimante</span></code></pre></div></div><div class=paragraph><p>Où <em>nom-de-l-imprimante</em> représente le nom (ou l’alias) d’une imprimante tel que spécifié dans <span class=filename>/etc/printcap</span>. Pour tester l’imprimante par défaut, tapez <a href="https://man.freebsd.org/cgi/man.cgi?query=lpr&amp;sektion=1&amp;format=html">lpr(1)</a> sans aucun argument <code>-P</code>. Encore une fois, si vous faites ce test avec une imprimante qui s’attend à recevoir du PostScript®, envoyez un programme PostScript® au lieu d’employer <a href="https://man.freebsd.org/cgi/man.cgi?query=lptest&amp;sektion=1&amp;format=html">lptest(1)</a>. Vous pouvez le faire en plaçant le programme dans un fichier et en entrant <code>lpr fichier</code>.</p></div><div class=paragraph><p>Pour une imprimante PostScript®, vous devriez obtenir le résultat du programme. Si vous utilisez <a href="https://man.freebsd.org/cgi/man.cgi?query=lptest&amp;sektion=1&amp;format=html">lptest(1)</a>, alors votre sortie devrait ressembler à ça:</p></div><div class="literalblock programlisting"><div class=content><pre>!&#34;#$%&#39;()*+,-./01234
&#34;#$%&#39;()*+,-./012345
#$%&#39;()*+,-./0123456
$%&#39;()*+,-./01234567
%&#39;()*+,-./012345678</pre></div></div><div class=paragraph><p>Pour tester l’imprimante plus encore, téléchargez des programmes (pour les imprimantes basées sur un langage spécifique) plus longs, ou lancez <a href="https://man.freebsd.org/cgi/man.cgi?query=lptest&amp;sektion=1&amp;format=html">lptest(1)</a> avec des arguments différents. Par exemple, <code>lptest 80 60</code> produira 60 lignes de 80 caractères chacune.</p></div><div class=paragraph><p>Si l’impression ne fonctionne pas, lisez la section <a href=#printing-troubleshooting>Résolution des problèmes</a>.</p></div></div></div></div></div></div><div class=sect1><h2 id=printing-advanced>9.4. Configuration avancée de l’imprimante<a class=anchor href=#printing-advanced></a></h2><div class=sectionbody><div class=paragraph><p>Cette section décrit les filtres à utiliser pour imprimer des fichiers au formatage particulier, des pages d’en-tête, pour imprimer en réseau, et pour restreindre et comptabiliser l’utilisation de l’imprimante.</p></div><div class=sect2><h3 id=printing-advanced-filter-intro>9.4.1. Les filtres<a class=anchor href=#printing-advanced-filter-intro></a></h3><div class=paragraph><p>Bien que LPD gère les protocoles réseaux, les files d’attente, le contrôle d’accès et d’autres aspects de l’impression, la plus grande partie du <em>véritable</em> travail intervient dans les <em>filtres</em>. Les filtres sont des programmes qui communiquent avec l’imprimante et gèrent ses dépendances matérielles ainsi que ses besoins particuliers. Dans la configuration simple de l’imprimante, nous avons installé un filtre texte simple- un filtre particulièrement basique qui devrait fonctionner avec la plupart des imprimantes (voir la section <a href=#printing-textfilter>Installer le filtre texte</a>).</p></div><div class=paragraph><p>Toutefois, afin de profiter de la conversion de format, de la comptabilisation de l’utilisation de l’imprimante, de particularités matérielles, et ainsi de suite, il vous faut comprendre le fonctionnement des filtres. En dernier ressort, il incombera au filtre de gérer ces aspects. Et la mauvaise nouvelle, c’est que la plupart du temps, c’est <em>vous</em> qui devrez produire ces filtres vous-même. La bonne nouvelle, c’est que beaucoup existent déjà et que, sinon, ils sont en général assez faciles à écrire.</p></div><div class=paragraph><p>Par ailleurs, il en est un livré avec FreeBSD, <span class=filename>/usr/libexec/lpr/lpf</span>, qui fonctionne avec beaucoup d’imprimantes capables d’imprimer du texte brut. (Il gère les retours arrière et les tabulations dans le fichier, effectue une comptabilisation, mais c’est à peu près tout). Vous trouverez également d’autres filtres et composants de filtres dans le catalogue des logiciels portés de FreeBSD.</p></div><div class=paragraph><p>Voici ce que vous trouverez dans cette section:</p></div><div class=ulist><ul><li><p>La section <a href=#printing-advanced-filters>Fonctionnement des filtres</a> tâche de donner une vue générale du rôle des filtres dans le processus d’impression. Il vous faut lire cette section pour comprendre ce qui se passe "sous le capot" lorsque LPD utilise des filtres. Cette connaissance vous permettra d’anticiper et de résoudre les problèmes que vous pourriez rencontrer quand vous installerez de plus en plus de filtres pour chacune de vos imprimantes.</p></li><li><p>LPD s’attend à ce que toutes les imprimantes sachent imprimer du texte brut par défaut. Cela pose un problème pour les imprimantes PostScript® (ou les imprimantes basées sur un autre langage) qui ne peut pas imprimer du texte brut directement. La section <a href=#printing-advanced-if-conversion>Gérer les travaux d’impression de texte brut sur des imprimantes PostScript®</a> vous indique la marche à suivre pour résoudre ce problème. Vous devrez lire cette section si vous avez une imprimante PostScript®.</p></li><li><p>PostScript® est un format de sortie courant pour beaucoup d’applications. Certaines personnes écrivent même du code PostScript® directement. Malheureusement, les imprimantes PostScript® sont onéreuses. La section <a href=#printing-advanced-ps>Emuler du PostScript® sur les imprimantes non-PostScript®</a> vous indiquera comment modifier un filtre texte pour qu’une imprimante <em>non-PostScript®</em> accepte et imprime du PostScript®. Vous devrez lire cette section si vous ne disposez pas d’une imprimante PostScript®.</p></li><li><p>La section <a href=#printing-advanced-convfilters>Filtres de conversion</a> vous apprendra à automatiser la conversion de formats de fichiers spécifiques, comme des graphiques ou des données de composition, en formats compréhensibles par l’imprimante. Après avoir lu cette section, vous serez en mesure de configurer vos imprimantes de telle sorte que vos utilisateurs pourront entrer la commande <code>lpr -t</code> pour imprimer du troff, ou <code>lpr -d</code> pour imprimer le format DVI produit par TeX, ou <code>lpr -v</code> pour imprimer des images en mode point, etc. Nous recommandons la lecture de cette section.</p></li><li><p>La section <a href=#printing-advanced-of>Filtres de sortie</a> révèle tout d’une fonctionnalité peu utilisée de LPD: les filtres de sortie. A moins que vous n’imprimiez des pages d’en-têtes (voir la section <a href=#printing-advanced-header-pages>Pages d’en-tête</a>), vous pouvez probablement complètement ignorer cette section.</p></li><li><p>La section <a href=#printing-advanced-lpf>lpf: un filtre texte</a> détaille <code>lpf</code>, un filtre texte destiné aux imprimantes en ligne (et aux imprimantes laser se comportant comme telles) plutôt complet malgré sa simplicité, et livré avec FreeBSD. Si vous avez besoin de mettre rapidement en place la comptabilisation de l’utilisation de l’imprimante pour du texte brut, ou si vous avez une imprimante qui fume lorsqu’elle voit passer des caractères de retour arrière, vous devez vraiment penser à <code>lpf</code>.</p></li></ul></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Une copie des différents scripts présentés ci-dessous se trouve dans le répertoire <span class=filename>/usr/shared/examples/printing</span>.</p></div></td></tr></tbody></table></div><div class=sect3><h4 id=printing-advanced-filters>9.4.1.1. Fonctionnement des filtres<a class=anchor href=#printing-advanced-filters></a></h4><div class=paragraph><p>Comme expliqué précédemment, un filtre est un programme exécutable lancé par LPD pour gérer la partie de la communication avec l’imprimante qui est dépendante du périphérique.</p></div><div class=paragraph><p>Lorsque LPD veut imprimer un fichier d’un travail d’impression, il lance un programme de filtre. Il redirige l’entrée standard du filtre sur le fichier à imprimer, sa sortie standard vers l’imprimante, et l’erreur standard vers le fichier journal des erreurs (spécifié dans le paramètre <code>lf</code> du fichier <span class=filename>/etc/printcap</span>, ou <span class=filename>/dev/console</span> par défaut).</p></div><div class=paragraph><p>Le filtre lancé par LPD ainsi que les paramètres qui lui sont donnés dépendent de ce qui est placé dans le fichier <span class=filename>/etc/printcap</span> et des paramètres que l’utilisateur a passé sur la ligne de commande <a href="https://man.freebsd.org/cgi/man.cgi?query=lpr&amp;sektion=1&amp;format=html">lpr(1)</a> pour ce travail d’impression. Par exemple, si l’utilisateur a entré <code>lpr -t</code>, LPD aurait lancé le filtre troff, précisé par la paramètre <code>tf</code> pour l’imprimante de destination. Si l’utilisateur veut imprimer du texte brut, il lancerait le filtre <code>if</code> (c’est vrai la plupart du temps: lisez la section <a href=#printing-advanced-of>Filtres de sortie</a> pour plus de détails).</p></div><div class=paragraph><p>Il existe trois types de filtres que vous pouvez spécifier dans <span class=filename>/etc/printcap</span>:</p></div><div class=ulist><ul><li><p>Le <em>filtre texte</em>, confusément appelé <em>filtre d’entrée</em> dans la documentation LPD, gère l’impression de texte classique. Considérez-le comme le filtre par défaut. LPD s’attend à ce que toutes les imprimantes sachent imprimer du texte brut par défaut, et c’est au filtre texte de s’assurer que les retours arrière, tabulations et autres caractères spéciaux ne trompent pas l’imprimante. Si vous êtes dans un environnement où il vous faut rendre compte de l’utilisation de l’imprimante, le filtre texte doit également comptabiliser les pages imprimées, généralement en comptant le nombre de lignes imprimées et en le comparant avec le nombre de lignes par page supporté par l’imprimante. Le filtre texte est exécuté avec la liste de paramètres suivante:</p><div class=paragraph><p><code>nom_du_filtre</code> [ -c ] -w <em>largeur</em> -l <em>hauteur</em> -i <em>indentation</em> -n <em>utilisateur</em> -h <em>machine</em> <em>fichier_comptabilité</em></p></div><div class=paragraph><p>où</p></div><div class=dlist><dl><dt class=hdlist1><code>-c</code></dt><dd><p>apparaît si le travail d’impression est lancé par la commande <code>lpr -l</code></p></dd><dt class=hdlist1><em>largeur</em></dt><dd><p>est la valeur du paramètre <code>pw</code> ("page width", pour "largeur de page") spécifié dans <span class=filename>/etc/printcap</span>, et possédant la valeur par défaut 132.</p></dd><dt class=hdlist1><em>hauteur</em></dt><dd><p>est la valeur du paramètre <code>pl</code> ("page length", pour "hauteur de page"), par défaut: 66.</p></dd><dt class=hdlist1><em>indentation</em></dt><dd><p>est le nombre d’indentations inséré par <code>lpr -i</code>, par défaut: 0.</p></dd><dt class=hdlist1><em>utilisateur</em></dt><dd><p>est le nom du compte de l’utilisateur imprimant le fichier.</p></dd><dt class=hdlist1><em>machine</em></dt><dd><p>est le nom de la machine depuis laquelle le travail d’impression a été soumis.</p></dd><dt class=hdlist1><em>fichier_comptabilité</em></dt><dd><p>est le nom du fichier de comptabilisation spécifié par le paramètre <code>af</code>.</p></dd></dl></div></li><li><p>Un <em>filtre de conversion</em> convertit un format de fichier spécifique en un autre que l’imprimante saura imprimer sur papier. Par exemple, des données de composition ditroff ne peuvent être imprimées directement, mais il vous est possible d’installer un filtre de conversion ditroff afin de convertir ces données ditroff en une forme que l’imprimante sait ingérer et imprimer. La section <a href=#printing-advanced-convfilters>Filtres de conversion</a> vous dira tout sur ce sujet. Les filtres de conversion doivent également tenir des statistiques, si vous avez besoin de comptabiliser les impressions. Les filtres de conversion sont lancés avec les paramètres suivants:</p><div class=paragraph><p><code>nom-du-filtre</code> -x <em>largeur-en-pixels</em> -y <em>hauteur-en-pixels</em> -n <em>login</em> -h <em>hôte</em> <em>fichier_comptabilité</em></p></div><div class=paragraph><p>où <em>largeur-en-pixels</em> est la valeur du paramètre <code>px</code> (0 par défaut) et <em>hauteur-en-pixels</em> est la valeur du paramètre <code>py</code> (0 par défaut).</p></div></li><li><p>Le <em>filtre de sortie</em> n’est utilisé que s’il n’y a pas de filtre texte, ou si les pages d’en-tête ont été activées. D’après notre expérience, les filtres de sortie sont rarement employés. La section <a href=#printing-advanced-of>Filtres de sortie</a> les détaillera. Un filtre de sortie ne prend que deux paramètres:</p><div class=paragraph><p><code>nom-du-filtre</code> -w <em>largeur</em> -l <em>hauteur</em></p></div><div class=paragraph><p>qui sont identiques aux paramètres <code>-w</code> et <code>-l</code> des filtres textes.</p></div></li></ul></div><div class=paragraph><p>Les filtres doivent également <em>retourner</em> avec le code de retour suivant:</p></div><div class=dlist><dl><dt class=hdlist1>exit 0</dt><dd><p>Si le filtre a imprimé avec succès le fichier.</p></dd><dt class=hdlist1>exit 1</dt><dd><p>Si le filtre n’a pu imprimer le fichier, mais désire que LPD essaie de l’imprimer à nouveau. LPD relancera un filtre s’il retourne avec ce code.</p></dd><dt class=hdlist1>exit 2</dt><dd><p>Si le filtre n’a pu imprimer le fichier et ne veut pas que LPD retente l’impression. LPD rejettera le fichier.</p></dd></dl></div><div class=paragraph><p>Le filtre texte livré avec FreeBSD, <span class=filename>/usr/libexec/lpr/lpf</span>, tire parti des paramètres de largeur et hauteur de page pour savoir quand envoyer une instruction de saut de page et comment comptabiliser l’utilisation de l’imprimante. Il utilise les paramètres nom d’utilisateur, nom de machine, et fichier de comptabilisation pour enregistrer les entrées concernant la consommation.</p></div><div class=paragraph><p>Si vous recherchez des filtres, prenez garde à ce qu’ils soient compatibles avec LPD. Si c’est le cas, ils doivent se conformer à la liste de paramètres décrite ci-dessus. Si vous songez à écrire des filtres à usage général, alors faites en sorte qu’ils se conforment à ces mêmes listes de paramètres et de codes de retour.</p></div></div><div class=sect3><h4 id=printing-advanced-if-conversion>9.4.1.2. Gérer les travaux d’impression de texte brut sur des imprimantes PostScript®<a class=anchor href=#printing-advanced-if-conversion></a></h4><div class=paragraph><p>Si vous êtes l’unique utilisateur de votre ordinateur et de votre imprimante PostScript® (ou basée sur un autre langage), et que vous promettez de ne jamais envoyer de texte brut à votre imprimante et de ne jamais utiliser les fonctionnalités des divers programmes qui voudraient lui en envoyer, alors vous pouvez tout à fait passer cette section l’esprit tranquille.</p></div><div class=paragraph><p>Toutefois, si vous désirez envoyer du PostScript® et du texte brut à l’imprimante, alors vous êtes instamment priés de compléter la configuration de votre imprimante. Pour ce faire, nous chargerons le filtre texte de détecter si le travail d’impression est du texte brut ou du PostScript®. Tous les travaux d’impression PostScript® doivent débuter par <code>%!</code> (en ce qui concerne les autres langages, référez-vous à la documentation de l’imprimante). Si ces deux caractères sont les deux premiers du travail d’impression, il s’agit de PostScript® et le reste du travail d’impression peut être passé directement à l’imprimante. Dans le cas contraire, alors le filtre convertit le texte en PostScript® et imprime le résultat.</p></div><div class=paragraph><p>Comment procéder?</p></div><div class=paragraph><p>Si vous disposez d’une imprimante série, une bonne façon de faire est d’installer <code>lprps</code>. Il s’agit d’un filtre d’impression PostScript® qui assure une communication en duplex avec l’imprimante. Il met à jour le fichier d’état de l’imprimante avec des informations détaillées que cette dernière lui fournit, de sorte que les utilisateurs et les administrateurs puissent connaître précisément l’état de l’imprimante (par exemple <code>niveau de toner bas</code> ou <code>bourrage papier</code>). Mais plus important encore, il inclut un programme nommé <code>psif</code> qui détecte si le travail d’impression qui vient d’arriver est du texte brut et lance <code>textps</code> (un autre programme fourni avec <code>lprps</code>) pour le convertir en PostScript®. Il utilise alors <code>lprps</code> pour envoyer le travail d’impression à l’imprimante.</p></div><div class=paragraph><p><code>lprps</code> fait partie du catalogue des logiciels portés FreeBSD (lisez la section <a href=../ports/#ports>Le catalogue des logiciels portés</a>). Vous pouvez installer un des deux logiciels portés <a class=package href=https://cgit.freebsd.org/ports/tree/print/lprps-a4/>print/lprps-a4</a> et <a class=package href=https://cgit.freebsd.org/ports/tree/print/lprps-letter/>print/lprps-letter</a> en fonction du format de papier utilisé. Après avoir installé <code>lprps</code>, précisez simplement le chemin vers le programme <code>psif</code> qui fait partie de <code>lprps</code>. Si vous avez installé <code>lprps</code> en recourant au catalogue des logiciels portés, placez les valeurs suivantes pour l’entrée de l’imprimante série PostScript® dans <span class=filename>/etc/printcap</span>:</p></div><div class="literalblock programlisting"><div class=content><pre>:if=/usr/local/libexec/psif:</pre></div></div><div class=paragraph><p>Vous devrez également renseigner le paramètre <code>rw</code> qui indique à LPD de requérir l’imprimante en mode lecture/écriture.</p></div><div class=paragraph><p>Si vous disposez d’une imprimante PostScript® parallèle (et ne pouvez donc pas utiliser la communication en duplex avec l’imprimante dont a besoin <code>lprps</code>), vous pouvez recourir à la procédure suivante en tant que filtre texte:</p></div><div class="literalblock programlisting"><div class=content><pre>#!/bin/sh
#
#  psif - Imprime du PostScript ou du texte brut sur une imprimante PostScript
#  Version script; CECI N&#39;EST PAS la version fournie avec lprps
#  Fichier /usr/local/libexec/psif
#

IFS=&#34;&#34; read -r first_line
first_two_chars=`expr &#34;$first_line&#34; : &#39;\(..\)&#39;`

if [ &#34;$first_two_chars&#34; = &#34;%!&#34; ]; then
    #
    #  Travail PostScript, l&#39;imprimer.
    #
    echo &#34;$first_line&#34;  cat  printf &#34;\004&#34;  exit 0
    exit 2
else
    #
    #  Texte brut, le convertir, puis l&#39;imprimer.
    #
    ( echo &#34;$first_line&#34;; cat ) | /usr/local/bin/textps  printf &#34;\004&#34;  exit 0
    exit 2
fi</pre></div></div><div class=paragraph><p>Dans la procédure ci-dessus, <code>textps</code> est un programme que nous avons installé séparément pour convertir du texte en PostScript®. Vous pouvez recourir à n’importe quel programme texte-vers-PostScript®, selon votre désir. Le catalogue des logiciels portés de FreeBSD (voir la section <a href=../ports/#ports>Le catalogue des logiciels portés</a>) comprend un programme de conversion texte-vers-PostScript® complet nommée <code>a2ps</code>, qui pourrait vous intéresser.</p></div></div><div class=sect3><h4 id=printing-advanced-ps>9.4.1.3. Emuler du PostScript® sur les imprimantes non-PostScript®<a class=anchor href=#printing-advanced-ps></a></h4><div class=paragraph><p>PostScript® est le standard <em>de fait</em> pour l’impression et la composition de haute qualité. Cependant, PostScript® est un standard <em>onéreux</em>. Heureusement, Aladdin Enterprises propose un succédané gratuit de PostScript® nommé Ghostscript qui fonctionne sous FreeBSD. Ghostscript peut lire la majorité des fichiers PostScript® et peut produire leurs pages sur une diversité de périphériques, incluant beaucoup de marques d’imprimantes non-PostScript®. En installant Ghostscript et en recourant à un filtre texte spécial, vous pouvez obtenir de votre imprimante non-PostScript® qu’elle se comporte comme une véritable imprimante PostScript®.</p></div><div class=paragraph><p>Ghostscript fait partie du catalogue des logiciels portés, de nombreuses versions sont disponibles, la version la plus couramment utilisée est <a class=package href=https://cgit.freebsd.org/ports/tree/print/ghostscript-gpl/>print/ghostscript-gpl</a>.</p></div><div class=paragraph><p>Pour émuler du PostScript®, il nous faut faire en sorte que le filtre texte détecte s’il imprime un fichier PostScript®. Si ce n’est pas le cas, alors le filtre doit passer le fichier directement à l’imprimante; sinon il recourra à Ghostscript pour tout d’abord le convertir dans un format que l’imprimante saura interpréter.</p></div><div class=paragraph><p>Voici un exemple: la procédure suivante est un filtre texte pour les imprimantes Hewlett Packard Deskjet 500. Pour d’autres modèles, changez le paramètre <code>-sDEVICE</code> de la commande <code>gs</code> (Ghostscript). (Entrez <code>gs -h</code> pour obtenir une liste des périphériques reconnus par l’installation actuelle de Ghostscript).</p></div><div class="literalblock programlisting"><div class=content><pre>#!/bin/sh
#
#  ifhp - Imprime du PostScript émulé par Ghostscript sur une DeskJet 500
#  Fichier /usr/local/libexec/ifhp

#
#  Traite LF comme CR+LF (pour éviter l&#39;&#34;effet d&#39;escalier&#34; sur les
#  imprimantes HP/PCL):
#
printf &#34;\033k2G&#34; || exit 2

#
#  Lit les deux premiers caractères du fichier
#
IFS=&#34;&#34; read -r first_line
first_two_chars=`expr &#34;$first_line&#34; : &#39;\(..\)&#39;`

if [ &#34;$first_two_chars&#34; = &#34;%!&#34; ]; then
    #
    #  Si c&#39;est du PostScript; utiliser Ghostscript pour le convertir et l&#39;imprimer
    #
    /usr/local/bin/gs -dSAFER -dNOPAUSE -q -sDEVICE=djet500 \
      -sOutputFile=- -  exit 0
else
    #
    #  Texte brut ou HP/PCL, donc impression directe; effectuer un
    #  saut de page à la fin pour éjecter la dernière page.
    #
    echo &#34;$first_line&#34;  cat  printf &#34;\033l0H&#34;
exit 0
fi

exit 2</pre></div></div><div class=paragraph><p>Pour finir, vous devez communiquer à LPD le filtre utilisé en positionnant le paramètre <code>if</code>:</p></div><div class="literalblock programlisting"><div class=content><pre>:if=/usr/local/libexec/ifhp:</pre></div></div><div class=paragraph><p>Voilà. Vous pouvez entrer <code>lpr texte.simple</code> et <span class=filename>lpr
peuimporte.ps</span>, et chacune des deux commandes devrait imprimer avec succès.</p></div></div><div class=sect3><h4 id=printing-advanced-convfilters>9.4.1.4. Filtres de conversion<a class=anchor href=#printing-advanced-convfilters></a></h4><div class=paragraph><p>Après avoir mené à bien la configuration basique décrite à la section <a href=#printing-simple>Configuration simple de l’imprimante</a>, la première chose que vous souhaiterez probablement faire sera d’installer des filtres de conversion pour vos formats de fichiers favoris (le simple texte ASCII mis à part).</p></div><div class=sect4><h5 id=_pourquoi_installer_des_filtres_de_conversion>9.4.1.4.1. Pourquoi installer des filtres de conversion?<a class=anchor href=#_pourquoi_installer_des_filtres_de_conversion></a></h5><div class=paragraph><p>Les filtres de conversion facilitent l’impression de différentes sortes de fichiers. Par exemple, supposons que nous travaillions énormément avec le système de composition TeX, et que nous ayons une imprimante PostScript®. Chaque fois que nous générerons un fichier DVI à partir de TeX, nous ne pouvons l’imprimer directement avant d’avoir converti ce fichier DVI en PostScript®. La séquence de commandes serait la suivante:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>% dvips seaweed-analysis.dvi
% lpr seaweed-analysis.ps</code></pre></div></div><div class=paragraph><p>En installant un filtre de conversion pour fichiers DVI, nous pouvons à chaque fois nous passer de l’étape de conversion manuelle en chargeant LPD de le faire à notre place. Maintenant, à chaque fois que nous avons un fichier DVI, nous ne sommes plus qu’à un pas de l’impression:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>% lpr <span class=nt>-d</span> seaweed-analysis.dvi</code></pre></div></div><div class=paragraph><p>Nous faisons en sorte que LPD se charge de la conversion du fichier DVI à notre place en positionnant l’option <code>-d</code>. La section <a href=#printing-lpr-options-format>Options de conversion et de formatage</a> donne la liste des options de conversion.</p></div><div class=paragraph><p>Pour chacune des options de conversion que vous voulez faire accepter par une imprimante, installez un <em>filtre de conversion</em> et indiquez son chemin d’accès dans <span class=filename>/etc/printcap</span>. Un filtre de conversion ressemble au filtre texte de notre configuration de base (voir la section <a href=#printing-textfilter>Installer le filtre texte</a>), à ceci près qu’au lieu d’imprimer du texte brut, le filtre convertit le fichier en un format compréhensible par l’imprimante.</p></div></div><div class=sect4><h5 id=_quels_filtres_de_conversion_dois_je_installer>9.4.1.4.2. Quels filtres de conversion dois-je installer?<a class=anchor href=#_quels_filtres_de_conversion_dois_je_installer></a></h5><div class=paragraph><p>Vous devez installer les filtres de conversion que vous vous attendez à utiliser. Si vous imprimez beaucoup de données DVI, alors un filtre de conversion DVI est dans la logique des choses. Si vous devez imprimer beaucoup de troff, alors vous aurez sûrement besoin d’un filtre troff.</p></div><div class=paragraph><p>Le tableau suivant récapitule les filtres avec lesquels LPD fonctionne, leurs paramètres <span class=filename>/etc/printcap</span>, et comment les invoquer avec la <code>lpr</code>:</p></div><table class="tableblock frame-none grid-all stretch informaltable"><col style=width:33.3333%><col style=width:33.3333%><col style=width:33.3334%><thead><tr><th class="tableblock halign-left valign-top">Type de fichier</th><th class="tableblock halign-left valign-top">paramètre /etc/printcap</th><th class="tableblock halign-left valign-top">option lpr</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class=tableblock>cifplot</p></td><td class="tableblock halign-left valign-top"><p class=tableblock><code>cf</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock><code>-c</code></p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>DVI</p></td><td class="tableblock halign-left valign-top"><p class=tableblock><code>df</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock><code>-d</code></p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>plot</p></td><td class="tableblock halign-left valign-top"><p class=tableblock><code>gf</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock><code>-g</code></p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>ditroff</p></td><td class="tableblock halign-left valign-top"><p class=tableblock><code>nf</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock><code>-n</code></p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>code FORTRAN</p></td><td class="tableblock halign-left valign-top"><p class=tableblock><code>rf</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock><code>-f</code></p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>troff</p></td><td class="tableblock halign-left valign-top"><p class=tableblock><code>tf</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock><code>-f</code></p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>image en mode point</p></td><td class="tableblock halign-left valign-top"><p class=tableblock><code>vf</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock><code>-v</code></p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>texte brut</p></td><td class="tableblock halign-left valign-top"><p class=tableblock><code>if</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>aucune, <code>-p</code>, or <code>-l</code></p></td></tr></tbody></table><div class=paragraph><p>Dans notre exemple, utiliser <code>lpr -d</code> veut dire que l’imprimante a besoin du paramètre <code>df</code> dans l’entrée <span class=filename>/etc/printcap</span> la concernant.</p></div><div class=paragraph><p>Aussi fortement que certains puissent s’en émouvoir, des formats comme le code FORTRAN ou le plot sont probablement obsolètes. Sur votre site, vous pouvez attribuer de nouvelles significations à ces options ou à toute autre option de formatage en installant simplement des filtres personnalisés. Par exemple, supposons que vous aimeriez imprimer des fichiers Printerleaf directement (fichiers issus du programme de publication assistée par ordinateur Interleaf), mais jamais de fichiers plot. Vous pourriez alors installer un filtre de conversion Printerleaf sous le paramètre <code>gf</code> et ensuite informer vos utilisateurs que <code>lpr -g</code> veut dire "imprimer des fichiers Printerleaf".</p></div></div><div class=sect4><h5 id=_installer_des_filtres_de_conversion>9.4.1.4.3. Installer des filtres de conversion<a class=anchor href=#_installer_des_filtres_de_conversion></a></h5><div class=paragraph><p>Etant donné que les filtres de conversion sont des applications qui ne font pas partie du système FreeBSD de base, vous devriez les installer dans <span class=filename>/usr/local</span>. Le répertoire <span class=filename>/usr/local/libexec</span> est une destination de choix, car ce sont des programmes spécialisés que seul LPD lancera; les utilisateurs ordinaires ne devraient jamais avoir à les lancer.</p></div><div class=paragraph><p>Pour activer un filtre de conversion, précisez son chemin d’accès dans le paramètre relatif à l’imprimante de destination dans <span class=filename>/etc/printcap</span>.</p></div><div class=paragraph><p>Dans notre exemple, nous allons ajouter le filtre de conversion DVI pour l’imprimante nommée <code>bamboo</code>. Revoici le fichier <span class=filename>/etc/printcap</span> d’exemple, avec le nouveau paramètre <code>df</code> pour l’imprimante <code>bamboo</code>:</p></div><div class="literalblock programlisting"><div class=content><pre>#
#  /etc/printcap pour la machine rose - ajout du filtre df pour bamboo
#
rattan|line|diablo|lp|Diablo 630 Line Printer:\
        :sh:sd=/var/spool/lpd/rattan:\
        :lp=/dev/lpt0:\
        :if=/usr/local/libexec/if-simple:

bamboo|ps|PS|S|panasonic|Panasonic KX-P4455 PostScript v51.4:\
        :sh:sd=/var/spool/lpd/bamboo:\
        :lp=/dev/ttyd5:ms#-parenb cs8 clocal crtscts:rw:\
        :if=/usr/local/libexec/psif:\
        :df=/usr/local/libexec/psdf:</pre></div></div><div class=paragraph><p>Le filtre DVI est une procédure nommée <span class=filename>/usr/local/libexec/psdf</span>. En voici le contenu:</p></div><div class="literalblock programlisting"><div class=content><pre>#!/bin/sh
#
#  psdf - filtre DVI vers imprimante PostScript
#  Fichier /usr/local/libexec/psdf
#
# Appelé par lpd quand l&#39;utilisateur lance lpr -d
#
exec /usr/local/bin/dvips -f | /usr/local/libexec/lprps &#34;$@&#34;</pre></div></div><div class=paragraph><p>Cette procédure lance <code>dvips</code> en mode filtre (cela correspond au paramètre <code>-f</code>) sur l’entrée standard, qui est le travail d’impression à exécuter. Ensuite, elle lance le filtre pour imprimante PostScript® <code>lprps</code> (voir la section <a href=#printing-advanced-if-conversion>Gérer les travaux d’impression de texte brut sur des imprimantes PostScript®</a>) avec les paramètres que LPD lui a passés. Le programme <code>lprps</code> utilisera ces paramètres pour comptabiliser les pages imprimées.</p></div></div><div class=sect4><h5 id=_exemples_de_filtre_de_conversion_supplémentaires>9.4.1.4.4. Exemples de filtre de conversion supplémentaires<a class=anchor href=#_exemples_de_filtre_de_conversion_supplémentaires></a></h5><div class=paragraph><p>Il n’existe pas de procédure figée pour l’installation des filtres de conversion, des exemples fonctionnels sont présentés dans cette section. Inspirez-vous de ces exemples pour créer vos propres filtres. Utilisez les tels quels s’il s’avèrent adéquats.</p></div><div class=paragraph><p>Cet exemple présente un filtre de conversion d’image en mode point (en fait un fichier GIF) pour une imprimante Hewlett-Packard LaserJet III-Si:</p></div><div class="literalblock programlisting"><div class=content><pre>#!/bin/sh
#
#  hpvf - Convertit des fichiers GIF en HP/PCL, puis les imprime
#  Fichier /usr/local/libexec/hpvf

PATH=/usr/X11R6/bin:$PATH; export PATH
giftopnm | ppmtopgm | pgmtopbm | pbmtolj -resolution 300 \
     exit 0 \
    || exit 2</pre></div></div><div class=paragraph><p>Son fonctionnement est le suivant: il convertit le fichier GIF en un format portable universel, puis en format portable en niveau de gris, et ensuite en bitmap portable, qu’il convertit enfin en données compatibles LaserJet/PCL.</p></div><div class=paragraph><p>Voici le <span class=filename>/etc/printcap</span> comportant une entrée pour une imprimante recourant au filtre ci-dessus:</p></div><div class="literalblock programlisting"><div class=content><pre>#
#  /etc/printcap pour la machine orchid
#
teak|hp|laserjet|Hewlett Packard LaserJet 3Si:\
        :lp=/dev/lpt0:sh:sd=/var/spool/lpd/teak:mx#0:\
        :if=/usr/local/libexec/hpif:\
        :vf=/usr/local/libexec/hpvf:</pre></div></div><div class=paragraph><p>La procédure suivante est un filtre de conversion de données troff du système de composition groff pour l’imprimante PostScript® <code>bamboo</code>:</p></div><div class="literalblock programlisting"><div class=content><pre>#!/bin/sh
#
#  pstf - Convertit des données troff de groff en PS, puis imprime.
#  Fichier /usr/local/libexec/pstf
#
exec grops | /usr/local/libexec/lprps &#34;$@&#34;</pre></div></div><div class=paragraph><p>La procédure ci-dessus emploie de nouveau <code>lprps</code> pour gérer la communication avec l’imprimante. S’il s’agissait d’une imprimante sur port parallèle, nous utiliserions plutôt la procédure suivante:</p></div><div class="literalblock programlisting"><div class=content><pre>#!/bin/sh
#
#  pstf - Convertit des données troff de groff en PS, puis imprime.
#  Fichier /usr/local/libexec/pstf
#
exec grops</pre></div></div><div class=paragraph><p>C’est tout. Voici l’entrée qu’il faut ajouter dans <span class=filename>/etc/printcap</span> pour activer le filtre:</p></div><div class="literalblock programlisting"><div class=content><pre>:tf=/usr/local/libexec/pstf:</pre></div></div><div class=paragraph><p>Voici un exemple qui pourrait faire rougir les vieux briscards de FORTRAN. C’est un filtre de code FORTRAN pour toute imprimante sachant imprimer du texte brut. Nous l’installerons pour l’imprimante <code>teak</code>:</p></div><div class="literalblock programlisting"><div class=content><pre>#!/bin/sh
#
# hprf - filtre texte FORTRAN pour LaserJet 3si:
# Fichier /usr/local/libexec/hprf
#

printf &#34;\033k2G&#34;  fpr  printf &#34;\033l0H&#34;
 exit 0
exit 2</pre></div></div><div class=paragraph><p>Et nous ajouterons cette ligne dans <span class=filename>/etc/printcap</span> pour l’imprimante <code>teak</code> afin d’activer le filtre:</p></div><div class="literalblock programlisting"><div class=content><pre>:rf=/usr/local/libexec/hprf:</pre></div></div><div class=paragraph><p>Voici un dernier exemple, quelque peu complexe. Nous allons ajouter un filtre DVI pour l’imprimante LaserJet <code>teak</code> présentée ci-dessus. Tout d’abord, la partie facile: mettre à jour <span class=filename>/etc/printcap</span> avec l’emplacement du filtre DVI:</p></div><div class="literalblock programlisting"><div class=content><pre>:df=/usr/local/libexec/hpdf:</pre></div></div><div class=paragraph><p>Et maintenant, la partie difficile: écrire le filtre. Pour cela, nous avons besoin d’un programme de conversion DVI-vers-LaserJet/PCL. Le catalogue des logiciels portés (voyez la section <a href=../ports/#ports>Le catalogue des logiciels portés</a>) en possède un: <a class=package href=https://cgit.freebsd.org/ports/tree/print/dvi2xx/>print/dvi2xx</a>. Installer ce logiciel porté nous fournira le programme dont nous avons besoin, <code>dvilj2p</code>, qui convertit le DVI en code compatible LaserJet IIp, LaserJet III et LaserJet 2000.</p></div><div class=paragraph><p>L’utilitaire <code>dvilj2p</code> rend le filtre <code>hpdf</code> assez complexe, parce que <code>dvilj2p</code> ne sait pas lire l’entrée standard. Il lui faut un nom de fichier. Pire encore, le nom du fichier doit se terminer par <span class=filename>.dvi</span>, ce qui rend l’utilisation de <span class=filename>/dev/fd/0</span> pour l’entrée standard problématique. Nous pouvons contourner cette difficulté en créant un lien symbolique temporaire (se terminant par <span class=filename>.dvi</span>) pointant vers <span class=filename>/dev/fd/0</span>, obligeant ainsi <code>dvilj2p</code> à lire l’entrée standard.</p></div><div class=paragraph><p>Le seul petit accroc restant est que nous ne pouvons pas utiliser <span class=filename>/tmp</span> pour le lien temporaire. Les liens symboliques ont pour propriétaire l’utilisateur et le group <code>bin</code>. Le filtre est lancé sous l’utilisateur <code>daemon</code>. Et le bit "sticky" est positionné sur le répertoire <span class=filename>/tmp</span>. Le filtre peut créer le lien, mais il ne pourra pas nettoyer lorsqu’il aura fini et supprimer ce lien puisqu’il appartient à un utilisateur différent.</p></div><div class=paragraph><p>Au lieu de ça, le filtre créera le lien dans le répertoire courant, qui est le répertoire de la file d’attente des travaux d’impression (précisé par le paramètre <code>sd</code> dans <span class=filename>/etc/printcap</span>). C’est l’endroit idéal pour faire travailler les filtres, particulièrement parce qu’il y a (parfois) plus d’espace disque libre dans ce répertoire que sous <span class=filename>/tmp</span>.</p></div><div class=paragraph><p>Voici, enfin, le filtre:</p></div><div class="literalblock programlisting"><div class=content><pre>#!/bin/sh
#
#  hpdf - Imprime des données DVI sur une imprimante HP/PCL
#  Fichier /usr/local/libexec/hpdf

PATH=/usr/local/bin:$PATH; export PATH

#
#  Définit une fonction de nettoyage de nos fichiers temporaires.  Ils prennent place
#  dans le répertoire courant, qui sera le répertoire
#  de file d&#39;attente
#  de l&#39;imprimante.
#
cleanup() {
   rm -f hpdf$$.dvi
}

#
#  Définit une fonction de gestion des erreurs fatales: affiche le message
#  d&#39;erreur et retourne 2.  Ce code d&#39;erreur de 2 indique à LPD
#  de ne pas essayer de réimprimer le travail d&#39;impression
#
fatal() {
    echo &#34;$@&#34; 12
    cleanup
    exit 2
}

#
#  Si l&#39;utilisateur enlève le travail d&#39;impression, LPD envoie SIGINT, donc
#  il faut capturer le signal SIGINT
#  (et quelques autres signaux) pour nettoyer après notre passage.
#
trap cleanup 1 2 15

#
#  Assurons-nous qu&#39;il n&#39;y ait pas conflit ce nom avec des fichiers existants.
#
cleanup

#
#  Lien du fichier DVI vers l&#39;entrée standard (fichier à imprimer).
#
ln -s /dev/fd/0 hpdf$$.dvi || fatal &#34;Cannot symlink /dev/fd/0&#34;

#
#  Conversion LF = CR+LF
#
printf &#34;\033k2G&#34; || fatal &#34;Cannot initialize printer&#34;

#
#  Conversion et impression.  Le code de retour de dvilj2p ne semble
#  pas fiable: ignorons-le.
#
dvilj2p -M1 -q -e- dfhp$$.dvi

#
#  Nettoyage et sortie de la procédure
#
cleanup
exit 0</pre></div></div></div><div class=sect4><h5 id=printing-advanced-autoconv>9.4.1.4.5. Conversion automatique: une alternative aux filtres de conversion<a class=anchor href=#printing-advanced-autoconv></a></h5><div class=paragraph><p>Tous ces filtres de conversion apportent beaucoup à votre environnement d’impression, mais nécessitent que l’utilisateur précise (dans la ligne de commande <a href="https://man.freebsd.org/cgi/man.cgi?query=lpr&amp;sektion=1&amp;format=html">lpr(1)</a>) lequel utiliser. Si vos utilisateurs ne sont pas particulièrement versés en informatique, préciser une option de filtre sera problématique. Mais ce qui s’avère pire encore est qu’une option de filtre mal choisie peut lancer un filtre sur un type de fichier erroné et causer l’impression de centaines de pages.</p></div><div class=paragraph><p>Plutôt que d’installer quelque filtre de conversion que ce soit, vous préférerez sans doute laisser le filtre texte (puisque c’est le filtre par défaut) déterminer le type de fichier qu’on lui a demandé d’imprimer et lancer automatiquement le filtre de conversion approprié. Des outils comme <code>file</code> peuvent s’avérer utiles dans ce cas. Bien entendu, il sera difficile d’établir les différences entre <em>certains</em> types de fichiers-et vous pouvez toujours, bien sûr, fournir des filtres de conversion uniquement pour eux.</p></div><div class=paragraph><p>Le catalogue des logiciels portés FreeBSD contient un filtre texte, nommé <code>apsfilter</code> (<a class=package href=https://cgit.freebsd.org/ports/tree/print/apsfilter/>print/apsfilter</a>), qui sait effectuer la conversion automatique. Il peut reconnaître le texte brut, le PostScript® les fichiers DVI et quasiment n’importe quelle sorte de fichier, effectuer les conversions appropriées et imprimer.</p></div></div></div><div class=sect3><h4 id=printing-advanced-of>9.4.1.5. Filtres de sortie<a class=anchor href=#printing-advanced-of></a></h4><div class=paragraph><p>Le gestionnaire d’impression LPD reconnaît un autre type de filtre dont nous n’avons pas encore discuté: le filtre de sortie. Un filtre de sortie est destiné à l’impression de texte brut seulement, comme le filtre texte, mais avec de nombreuses simplifications. Si vous utilisez un filtre de sortie mais pas de filtre texte, alors:</p></div><div class=ulist><ul><li><p>LPD lance un filtre de sortie une seule fois par travail d’impression, au lieu d’une fois pour chacun des fichiers du travail d’impression.</p></li><li><p>LPD ne fournit rien pour permettre au filtre de sortie de repérer le début ou la fin des fichiers du travail d’impression.</p></li><li><p>LPD ne passe pas le nom de l’utilisateur ou le nom de la machine au filtre, qui n’est donc pas prévu pour effectuer la comptabilisation de l’impression. En fait, il ne reçoit que deux paramètres:</p><div class=paragraph><p><code>nom-du-filtre</code> -w <em>largeur</em> -l <em>hauteur</em></p></div><div class=paragraph><p>Où <em>largeur</em> provient du paramètre <code>pw</code> et <em>hauteur</em> du paramètre <code>pl</code> de l’entrée <span class=filename>/etc/printcap</span> pour l’imprimante en question.</p></div></li></ul></div><div class=paragraph><p>Ne vous laissez pas séduire par la simplicité d’un filtre de sortie. Si vous désirez que chaque fichier d’un travail d’impression commence sur une page différente, un filtre de sortie <em>ne conviendra pas</em>. Utilisez un filtre texte (également appelé filtre d’entrée); voir la section <a href=#printing-textfilter>Installer le filtre texte</a>. De plus, le filtre de sortie se révèle en fait <em>plus complexe</em> en ce sens qu’il doit examiner le flux d’octets qui lui est envoyé pour y rechercher des caractères spéciaux et qu’il doit s’envoyer à lui-même des signaux comme s’ils provenaient de LPD.</p></div><div class=paragraph><p>Toutefois, un filtre de sortie s’avère <em>nécessaire</em> si vous désirez des pages d’en-tête et avez besoin d’envoyer des séquences d’échappement ou d’autres chaînes d’initialisation afin de pouvoir imprimer la page d’en-tête. (Mais il est également <em>futile</em> si vous voulez imputer les pages d’en-tête au compte de l’utilisateur, puisque LPD ne livre pas d’information sur l’utilisateur ou la machine au filtre de sortie).</p></div><div class=paragraph><p>Sur une seule imprimante, LPD permet à la fois un filtre de sortie et des filtres texte ou autres. Dans de tels cas, LPD ne lancera le filtre de sortie que pour imprimer la page d’en-tête (consultez la section <a href=#printing-advanced-header-pages>Pages d’en-tête</a>). LPD attend alors que le filtre de sortie <em>s’arrête par lui-même</em> en envoyant deux octets au filtre: ASCII 031 suivi d’ASCII 001. Lorsqu’un filtre de sortie lit ces deux octets (031,001), il devrait s’arrêter en s’envoyant à lui-même un <code>SIGSTOP</code>. Lorsque LPD a fini d’exécuter les autres filtres, il relance le filtre de sortie en lui envoyant un <code>SIGCONT</code>.</p></div><div class=paragraph><p>S’il y a un filtre de sortie mais <em>aucun</em> filtre texte et que LPD s’occupe d’un travail d’impression concernant du texte brut, alors LPD utilise le filtre de sortie pour réaliser ce travail d’impression. Comme exposé plus haut, le filtre de sortie imprimera chacun des travaux d’impression séquentiellement sans que des sauts de page ou autres formes d’avancement du papier ne surviennent, et ce n’est vraisemblablement <em>pas</em> ce que vous désirez. Dans presque tous les cas, il vous faut un filtre texte.</p></div><div class=paragraph><p>Le programme <code>lpf</code>, que nous avons présenté précédemment comme un filtre texte, peut également fonctionner en tant que filtre de sortie. Si vous avez besoin d’un filtre de sortie vite-fait-bien-fait mais ne voulez pas écrire le code d’examen d’octets et d’envoi de signal, essayez <code>lpf</code>. Vous pouvez également inclure <code>lpf</code> dans une procédure pour prendre en charge tout code d’initialisation qui pourrait être requis par l’imprimante.</p></div></div><div class=sect3><h4 id=printing-advanced-lpf>9.4.1.6. <code>lpf</code>: un filtre texte<a class=anchor href=#printing-advanced-lpf></a></h4><div class=paragraph><p>Le programme <span class=filename>/usr/libexec/lpr/lpf</span> qui est fourni avec la distribution binaire FreeBSD est un filtre texte (un filtre d’entrée) qui sait indenter la sortie (un travail d’impression soumis avec <code>lpr -i</code>), laisse passer les caractères littéraux (travail d’impression soumis avec <code>lpr -l</code>), ajuste la position d’impression des retours arrière et des tabulations dans le travail d’impression, et comptabilise les pages imprimées. Il peut également servir de filtre de sortie.</p></div><div class=paragraph><p>Le filtre <code>lpf</code> convient à de nombreux environnements d’impression. Et bien qu’il ne puisse pas envoyer de séquences d’initialisation à une imprimante, il est aisé d’écrire une procédure pour effectuer l’initialisation nécessaire et ensuite exécuter <code>lpf</code>.</p></div><div class=paragraph><p>Afin que <code>lpf</code> mène à bien la comptabilisation des pages, il faut que des valeurs correctes soient indiquées pour les paramètres <code>pw</code> et <code>pl</code> dans le fichier <span class=filename>/etc/printcap</span>. Il utilise ces valeurs pour déterminer combien de texte peut être imprimé sur une page et combien de pages ont été imprimées dans le travail d’impression d’un utilisateur. Pour plus d’informations sur la comptabilisation de l’impression, lisez la section <a href=#printing-advanced-acct>Comptabiliser l’utilisation de l’imprimante</a>.</p></div></div></div><div class=sect2><h3 id=printing-advanced-header-pages>9.4.2. Pages d’en-tête<a class=anchor href=#printing-advanced-header-pages></a></h3><div class=paragraph><p>Si vous avez <em>beaucoup</em> d’utilisateurs, et que tous utilisent des imprimantes diverses, alors vous allez certainement envisager les <em>pages d’en-tête</em> comme un mal nécessaire.</p></div><div class=paragraph><p>Les pages d’en-tête, également appelées <em>bannières</em> ou <em>burst page</em>, identifient à qui appartiennent les travaux d’impression après qu’ils aient été imprimés. Elles sont en général imprimées en caractères de grande taille et en gras, peuvent comporter des bordures décorées, de sorte qu’elles contrastent dans une pile d’impressions avec les véritables documents formant les travaux d’impression des utilisateurs. Elles leur permettent de retrouver facilement leurs travaux d’impression. L’inconvénient majeur d’une page d’en-tête est qu’elle représente une page supplémentaire à imprimer pour chacun des travaux d’impression, son utilité éphémère ne dépasse pas quelques minutes, et elle termine au recyclage du papier ou dans une corbeille. (Notez que une page d’en-tête est liée à chaque travail d’impression et non à chaque fichier dans un travail d’impression: il se pourrait donc que le gâchis de papier ne soit pas si grand.)</p></div><div class=paragraph><p>Le système LPD peut fournir des pages d’en-tête automatiquement pour vos impressions <em>si</em> votre imprimante sait imprimer directement du texte brut. Si vous disposez d’une imprimante PostScript®, il vous faudra un programme externe pour générer la page d’en-tête; lisez la section <a href=#printing-advanced-header-pages-ps>Les pages d’en-tête sur les imprimantes PostScript®</a>.</p></div><div class=sect3><h4 id=printing-advanced-header-pages-enabling>9.4.2.1. Activer les pages d’en-tête<a class=anchor href=#printing-advanced-header-pages-enabling></a></h4><div class=paragraph><p>Dans la section <a href=#printing-simple>Configuration simple de l’imprimante</a>, nous avons désactivé les pages d’en-tête en positionnant le paramètre <code>sh</code> (ce qui signifie "suppress header", soit "suppression des en-têtes") dans <span class=filename>/etc/printcap</span>. Pour activer les pages d’en-tête sur une imprimante, il suffit d’enlever ce paramètre <code>sh</code>.</p></div><div class=paragraph><p>Cela semble trop facile, n’est-ce pas?</p></div><div class=paragraph><p>C’est vrai. Il se <em>pourrait</em> que vous ayez à fournir un filtre de sortie pour envoyer des chaînes d’initialisation à l’imprimante. Voici un exemple de filtre sortie pour les imprimantes Hewlett-Packard compatibles-PCL:</p></div><div class="literalblock programlisting"><div class=content><pre>#!/bin/sh
#
#  hpof - filtre de sortie pour les imprimantes Hewlett Packard compatibles PCL
#  Fichier /usr/local/libexec/hpof

printf &#34;\033k2G&#34; || exit 2
exec /usr/libexec/lpr/lpf</pre></div></div><div class=paragraph><p>Spécifiez le chemin d’accès au filtre de sortie avec le paramètre <code>of</code>. Lisez la section <a href=#printing-advanced-of>Filtres de sortie</a> pour plus de détails.</p></div><div class=paragraph><p>Voici un fichier <span class=filename>/etc/printcap</span> d’exemple pour l’imprimante <code>teak</code> que nous avons présentée plus haut; nous avons activé les pages d’en-tête et ajouté le fichier de sortie ci-dessus:</p></div><div class="literalblock programlisting"><div class=content><pre>#
#  /etc/printcap pour la machine orchid
#
teak|hp|laserjet|Hewlett Packard LaserJet 3Si:\
        :lp=/dev/lpt0:sd=/var/spool/lpd/teak:mx#0:\
        :if=/usr/local/libexec/hpif:\
        :vf=/usr/local/libexec/hpvf:\
        :of=/usr/local/libexec/hpof:</pre></div></div><div class=paragraph><p>Désormais, lorsque les utilisateurs lancent des travaux d’impression avec <code>teak</code>, ils obtiennent une page d’en-tête avec chaque travail d’impression. Si vos utilisateurs désirent perdre du temps à rechercher leurs impressions, ils peuvent omettre la page d’en-tête en soumettant le travail d’impression avec la commande <code>lpr -h</code>; lisez la section <a href=#printing-lpr-options-misc>Options des pages d’en-tête</a> pour connaître plus d’options <a href="https://man.freebsd.org/cgi/man.cgi?query=lpr&amp;sektion=1&amp;format=html">lpr(1)</a>.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>LPD imprime un caractère de saut de page après une page d’en-tête. Si votre imprimante utilise un autre caractère ou séquence de caractères différente pour éjecter une page, précisez-le avec le paramètre <code>ff</code> dans <span class=filename>/etc/printcap</span>.</p></div></td></tr></tbody></table></div></div><div class=sect3><h4 id=printing-advanced-header-pages-controlling>9.4.2.2. Contrôle des pages d’en-tête<a class=anchor href=#printing-advanced-header-pages-controlling></a></h4><div class=paragraph><p>Une fois les pages d’en-tête activées, LPD produira un <em>en-tête long</em>, c’est à dire une page entière de grands caractères identifiant l’utilisateur, le nom de la machine et le travail d’impression. Voici un exemple (<code>kelly</code> a lancé le travail d’impression nommé "outline" depuis la machine <code>rose</code>):</p></div><div class="literalblock programlisting"><div class=content><pre>      k                   ll       ll
      k                    l        l
      k                    l        l
      k   k     eeee       l        l     y    y
      k  k     e    e      l        l     y    y
      k k      eeeeee      l        l     y    y
      kk k     e           l        l     y    y
      k   k    e    e      l        l     y   yy
      k    k    eeee      lll      lll     yyy y
                                               y
                                          y    y
                                           yyyy

                                   ll
                          t         l        i
                          t         l
       oooo    u    u   ttttt       l       ii     n nnn     eeee
      o    o   u    u     t         l        i     nn   n   e    e
      o    o   u    u     t         l        i     n    n   eeeeee
      o    o   u    u     t         l        i     n    n   e
      o    o   u   uu     t  t      l        i     n    n   e    e
       oooo     uuu u      tt      lll      iii    n    n    eeee

      r rrr     oooo     ssss     eeee
      rr   r   o    o   s    s   e    e
      r        o    o    ss      eeeeee
      r        o    o      ss    e
      r        o    o   s    s   e    e
      r         oooo     ssss     eeee

                                              Job:  outline
                                              Date: Sun Sep 17 11:04:58 1995</pre></div></div><div class=paragraph><p>LPD ajoute un saut de page à ce texte de sorte que le travail d’impression commence sur une nouvelle page (à moins que <code>sf</code> (supprimer les sauts de page) ne soit dans l’entrée correspondant à l’imprimante dans <span class=filename>/etc/printcap</span>).</p></div><div class=paragraph><p>Si vous préférez, LPD peut générer des <em>en-tête courts</em>; ajoutez le paramètre <code>sb</code> (en-tête court) dans le fichier <span class=filename>/etc/printcap</span>. La page d’en-tête ressemblera à ceci:</p></div><div class="literalblock programlisting"><div class=content><pre>rose:kelly  Job: outline  Date: Sun Sep 17 11:07:51 1995</pre></div></div><div class=paragraph><p>Par défaut également, LPD imprime d’abord la page d’en-tête, puis le travail d’impression. Pour inverser ce comportement, placez le paramètre <code>hl</code> (en-tête à la fin) dans <span class=filename>/etc/printcap</span>.</p></div></div><div class=sect3><h4 id=printing-advanced-header-pages-accounting>9.4.2.3. Comptabiliser les pages d’en-tête<a class=anchor href=#printing-advanced-header-pages-accounting></a></h4><div class=paragraph><p>Utiliser les pages d’en-tête fournies par LPD provoque un comportement particulier lorsqu’il s’agit de comptabiliser l’utilisation de l’imprimante: les pages d’en-tête doivent être <em>gratuites</em>.</p></div><div class=paragraph><p>Pourquoi?</p></div><div class=paragraph><p>Parce que le filtre de sortie est le seul programme externe pouvant tenir les comptes qui aura le contrôle lors de l’impression de la page d’en-tête, et qu’aucune information sur <em>l’utilisateur ou le nom de la machine</em> ne lui est donnée ni aucun fichier de comptabilisation, par conséquent il ne sait pas à qui attribuer le coût de l’utilisation de l’imprimante. Il ne suffit pas non plus de simplement "ajouter une page" au filtre texte ou un quelconque filtre de conversion (qui, eux, possèdent des informations sur l’utilisateur et la machine) puisque les utilisateurs peuvent supprimer les pages d’en-tête avec <code>lpr -h</code>. Ils pourraient toujours se voir imputer des pages d’en-tête qu’ils n’auraient pas imprimées. En somme, <code>lpr -h</code> demeurera l’option favorite des utilisateurs soucieux de l’environnement, mais vous ne pouvez aucunement les inciter à l’utiliser.</p></div><div class=paragraph><p>Il ne <em>suffit pas non plus</em> de laisser chacun des filtres générer ses propres pages d’en-tête (ce qui permettrait de savoir à qui imputer les coûts). Si les utilisateurs désiraient omettre les pages d’en-tête avec <code>lpr -h</code>, ils les obtiendraient quand même et le coût leur serait attribué puisque LPD ne donne aucun renseignement sur l’emploi de l’option <code>-h</code> à aucun des filtres.</p></div><div class=paragraph><p>Alors, quelles sont les options à votre disposition?</p></div><div class=paragraph><p>Vous pouvez:</p></div><div class=ulist><ul><li><p>Accepter le comportement de LPD et la gratuité des pages d’en-tête.</p></li><li><p>Installer une alternative à LPD, comme LPRng. La section <a href=#printing-lpd-alternatives>Alternatives au gestionnaire d’impression standard</a> en dit plus au sujet des autres gestionnaires d’impression qui peuvent être substitués à LPD.</p></li><li><p>Ecrire un filtre de sortie <em>intelligent</em>. Normalement, un filtre de sortie n’est pas censé faire plus que d’initialiser une imprimante ou exécuter une conversion simple de caractères. Il convient aux pages d’en-tête et aux travaux d’impression de texte brut (lorsqu’il n’y a aucun filtre (d’entrée) texte). Mais, s’il existe un filtre texte pour les travaux d’impression de texte, alors LPD ne lancera le filtre de sortie que pour les pages d’en-tête. Le filtre de sortie peut également analyser le texte de la page d’en-tête généré par LPD pour déterminer quels sont l’utilisateur et la machine à qui il faut attribuer le coût de cette page d’en-tête. Le seul autre problème avec cette méthode est que le filtre de sortie ne sait toujours pas quel fichier de comptabilisation utiliser (le nom du fichier spécifié par le paramètre <code>af</code> ne lui est pas fourni), mais si vous disposez d’un fichier de comptabilisation bien identifié, vous pouvez le coder en dur dans le filtre de sortie. Afin de faciliter l’étape d’analyse, utilisez le paramètre <code>sh</code> (en-tête courte) dans <span class=filename>/etc/printcap</span>. D’un autre côté, tout cela pourrait bien représenter beaucoup de dérangement, et les utilisateurs apprécieront certainement davantage l’administrateur généreux qui propose la gratuité des pages d’en-tête.</p></li></ul></div></div><div class=sect3><h4 id=printing-advanced-header-pages-ps>9.4.2.4. Les pages d’en-tête sur les imprimantes PostScript®<a class=anchor href=#printing-advanced-header-pages-ps></a></h4><div class=paragraph><p>Comme décrit précédemment, LPD est en mesure de générer des pages d’en-tête texte convenant pour de nombreuses d’imprimantes. Bien entendu, PostScript® ne peut pas imprimer du texte directement, donc la fonctionnalité de page d’en-tête offerte par LPD est inutilisable ou presque.</p></div><div class=paragraph><p>Une solution manifeste est de faire générer la page d’en-tête par tous les filtres de conversion et le filtre texte. Les filtres devraient employer les paramètres utilisateur et nom de machine pour générer une page d’en-tête convenable. L’inconvénient de cette méthode est que les utilisateurs obtiendront toujours une page d’en-tête, même s’ils soumettent leurs travaux d’impression avec <code>lpr -h</code>.</p></div><div class=paragraph><p>Examinons cette méthode. La procédure ci-dessous prend trois paramètres (le nom de l’utilisateur, le nom de la machine et celui du travail d’impression) et réalise une page d’en-tête simple en PostScript®:</p></div><div class="literalblock programlisting"><div class=content><pre>#!/bin/sh
#
#  make-ps-header - génére une page d&#39;en-tête PostScript sur la sortie standard
#  Fichier /usr/local/libexec/make-ps-header
#

#
#  Ce sont des unités PostScript (72 par pouce).  A modifier pour A4 ou
#  tout autre format papier employé:
#
page_width=612
page_height=792
border=72

#
#  Vérification des paramètres
#
if [ $# -ne 3 ]; then
    echo &#34;Usage: `basename $0` user host job&#34; 12
    exit 1
fi

#
#  Mémorisation des paramètres, pour la lisibilité du PostScript, plus bas.
#
user=$1
host=$2
job=$3
date=`date`

#
#  Envoi du code PostScript sur stdout.
#
exec cat EOF
%!PS

%
%  Assurons-nous qu&#39;il n&#39;y a pas d&#39;interférence avec le travail
%  utilisateur qui suivra
%
save

%
%  Applique une grosse bordure désagréable autour
%  du bord de la page.
%
$border $border moveto
$page_width $border 2 mul sub 0 rlineto
0 $page_height $border 2 mul sub rlineto
currentscreen 3 -1 roll pop 100 3 1 roll setscreen
$border 2 mul $page_width sub 0 rlineto closepath
0.8 setgray 10 setlinewidth stroke 0 setgray

%
%  Affiche le nom de l&#39;utilisateur, de façon jolie, grande et proéminente
%
/Helvetica-Bold findfont 64 scalefont setfont
$page_width ($user) stringwidth pop sub 2 div $page_height 200 sub moveto
($user) show

%
%  Maintenant, les détails ennuyant:
%
/Helvetica findfont 14 scalefont setfont
/y 200 def
[ (Job:) (Host:) (Date:) ] {
200 y moveto show /y y 18 sub def }
forall

/Helvetica-Bold findfont 14 scalefont setfont
/y 200 def
[ ($job) ($host) ($date) ] {
        270 y moveto show /y y 18 sub def
} forall

%
% C&#39;est tout
%
restore
showpage
EOF</pre></div></div><div class=paragraph><p>Désormais, chacun des filtres de conversion et le filtre texte peuvent appeler cette procédure pour d’abord générer la page d’en-tête, et ensuite imprimer le travail d’impression de l’utilisateur. Voici le filtre de conversion DVI déjà mentionné plus haut dans ce document, modifié afin de générer une page d’en-tête:</p></div><div class="literalblock programlisting"><div class=content><pre>#!/bin/sh
#
#  psdf - filtre DVI vers imprimante PostScript
#  Fichier /usr/local/libexec/psdf
#
#  Appelé par lpd quand l&#39;utilisateur lance lpr -d
#

orig_args=&#34;$@&#34;

fail() {
    echo &#34;$@&#34; 12
    exit 2
}

while getopts &#34;x:y:n:h:&#34; option; do
    case $option in
        x|y)  ;; # Ignore
        n)    login=$OPTARG ;;
        h)    host=$OPTARG ;;
        *)    echo &#34;LPD started `basename $0` wrong.&#34; 12
              exit 2
              ;;
    esac
done

[ &#34;$login&#34; ] || fail &#34;Pas de nom d&#39;utilisateur&#34;
[ &#34;$host&#34; ] || fail &#34;PAs de nom de machine&#34;

( /usr/local/libexec/make-ps-header $login $host &#34;DVI File&#34;
  /usr/local/bin/dvips -f ) | eval /usr/local/libexec/lprps $orig_args</pre></div></div><div class=paragraph><p>Observez que le filtre doit analyser la liste des paramètres pour déterminer le nom de l’utilisateur et celui de la machine. L’analyse menée par les autres filtres de conversion est identique. Toutefois, le filtre texte réclame un ensemble de paramètres légèrement différent (voyez la section <a href=#printing-advanced-filters>Fonctionnement des filtres</a>).</p></div><div class=paragraph><p>Comme précédemment exposé, cette solution, quoique relativement simple, invalide l’option de "suppression de page d’en-tête" (l’option <code>-h</code>) de <code>lpr</code>. Si les utilisateurs désiraient épargner la vie d’un arbre (ou économiser quelques centimes, si vous faites payer les pages d’en-tête), ils ne seraient pas en mesure de le faire, puisque chaque filtre va imprimer une page d’en-tête avec chaque travail d’impression.</p></div><div class=paragraph><p>Pour permettre aux utilisateurs de désactiver les pages d’en-tête en fonction du travail d’impression, il vous faudra recourir à l’une des astuces de la section <a href=#printing-advanced-header-pages-accounting>Comptabiliser les pages d’en-tête</a>: écrire un filtre de sortie qui analyse la page d’en-tête générée par LPD et produit une version PostScript®. Si l’utilisateur soumet le travail d’impression avec <code>lpr -h</code> alors ni LPD ni votre filtre de sortie ne généreront de page d’en-tête. Sinon, votre filtre de sortie lira le texte en provenance de LPD et enverra la page d’en-tête PostScript® appropriée à l’imprimante.</p></div><div class=paragraph><p>Si vous disposez d’une imprimante PostScript® sur une interface série, vous pouvez utiliser <code>lprps</code>, qui est livré avec un filtre de sortie, <code>psof</code>, qui réalise ce que nous venons d’exposer ci-dessus. Notez que <code>psof</code> n’assume pas la tenue de comptes pour les pages d’en-tête.</p></div></div></div><div class=sect2><h3 id=printing-advanced-network-printers>9.4.3. Imprimer via un réseau<a class=anchor href=#printing-advanced-network-printers></a></h3><div class=paragraph><p>FreeBSD gère l’impression via un réseau: c’est à dire en envoyant les travaux d’impression à des imprimantes distantes. L’impression via un réseau désigne deux choses différentes:</p></div><div class=ulist><ul><li><p>Accéder à une imprimante connectée à une machine distante. Vous installez une imprimante disposant d’une interface conventionnelle, série ou parallèle, sur une machine. Puis vous configurez LPD pour permettre l’accès à l’imprimante depuis d’autres machines du réseau. La section <a href=#printing-advanced-network-rm>Imprimantes installées sur des machines distantes</a> en détaillera la mise en œuvre.</p></li><li><p>Accéder à une imprimante directement connectée au réseau. L’imprimante dispose d’une interface réseau en plus (ou à la place) d’interfaces plus conventionnelles, série ou parallèle. Une imprimante de ce genre peut fonctionner ainsi:</p><div class=ulist><ul><li><p>Elle peut comprendre le protocole LPD et sait même gérer une file d’attente de travaux d’impression provenant de machines distantes. En ce cas, elle se comporte comme une machine normale qui exécuterait LPD. Suivez la même procédure que celle exposée à la section <a href=#printing-advanced-network-rm>Imprimantes installées sur des machines distantes</a> afin de configurer une imprimante de ce genre.</p></li><li><p>Elle peut savoir gérer un flux de données au travers d’une connexion réseau. Dans ce cas, vous pouvez "attacher" l’imprimante à l’une des machines du réseau en la rendant responsable de la gestion de la file d’impression et de l’envoi des travaux d’impression à l’imprimante. La section <a href=#printing-advanced-network-net-if>Imprimantes avec des interfaces utilisant des flux réseau</a> donne quelque indications sur l’installation d’imprimantes de ce type.</p></li></ul></div></li></ul></div><div class=sect3><h4 id=printing-advanced-network-rm>9.4.3.1. Imprimantes installées sur des machines distantes<a class=anchor href=#printing-advanced-network-rm></a></h4><div class=paragraph><p>Le gestionnaire d’impression LPD dispose des fonctions pour gérer l’envoi des travaux d’impression à d’autres machines exécutant également LPD (ou un système qui lui est compatible). Cette fonctionnalité vous permet d’installer une imprimante sur une machine, puis de la rendre accessible depuis les autres machines. Cela fonctionne également avec les imprimantes disposant d’interfaces réseau comprenant le protocole LPD.</p></div><div class=paragraph><p>Pour activer ce type d’impression à distance, installez d’abord une imprimante sur une machine, qui sera <em>la machine d’impression</em>, en suivant les instructions de configuration basique décrites à la section <a href=#printing-simple>Configuration simple de l’imprimante</a>. Réalisez toute étape de la <a href=#printing-advanced>configuration avancée de l’imprimante</a> dont vous pourriez avoir besoin. Veillez à tester l’imprimante et vérifiez qu’elle fonctionne avec les paramètres de LPD que vous avez activés. Assurez-vous également que <em>la machine locale</em> est autorisée à utiliser le service LPD sur <em>la machine distante</em> (lisez la section <a href=#printing-advanced-restricting-remote>Restreindre les impressions à distance</a>).</p></div><div class=paragraph><p>Si vous utilisez une imprimante avec une interface réseau qui est compatible avec LPD, alors <em>la machine d’impression</em> dans le texte ci-dessous est l’imprimante elle-même, et le <em>nom de l’imprimante</em> est le nom que vous avez paramétré pour l’imprimante. Lisez la documentation livrée avec votre imprimante ou l’interface réseau-imprimante.</p></div><div class="admonitionblock tip"><table><tbody><tr><td class=icon><i class="fa icon-tip" title=Tip></i></td><td class=content><div class=paragraph><p>Si vous utilisez une Hewlett Packard Laserjet, alors le nom d’imprimante <code>text</code> réalisera la conversion LF en CRLF automatiquement, de sorte que vous n’aurez pas besoin de la procédure <span class=filename>hpif</span>.</p></div></td></tr></tbody></table></div><div class=paragraph><p>Ensuite, sur les autres machines pour lesquelles vous désirez autoriser l’accès à l’imprimante, créez une ligne dans leur <span class=filename>/etc/printcap</span> avec les paramètres suivants:</p></div><div class="olist arabic"><ol class=arabic><li><p>Nommez cette entrée comme vous le voulez. Par souci de simplicité, cependant, vous préférerez certainement employer les mêmes nom et alias que ceux utilisés sur la machine de d’impression.</p></li><li><p>Laissez le paramètre <code>lp</code> non-renseigné, de manière explicite (<code>:lp=:</code>).</p></li><li><p>Créez un répertoire de file d’impression et indiquez son chemin d’accès dans le paramètre <code>sd</code>. C’est là où LPD entreposera les travaux d’impression avant leur envoi vers la machine d’impression.</p></li><li><p>Indiquez le nom de la machine d’impression avec le paramètre <code>rm</code>.</p></li><li><p>Placez le nom de l’imprimante sur <em>la machine d’impression</em> dans le paramètre <code>rp</code>.</p></li></ol></div><div class=paragraph><p>C’est tout. Il n’est pas nécessaire de préciser la liste des filtres de conversion, les dimensions de la page, ou quoique ce soit d’autre dans le fichier <span class=filename>/etc/printcap</span>.</p></div><div class=paragraph><p>Voici un exemple. La machine <code>rose</code> dispose de deux imprimantes, <code>bamboo</code> et <code>rattan</code>. Nous allons permettre aux utilisateurs de la machine <code>orchid</code> d’imprimer avec ces imprimantes. Voici le fichier <span class=filename>/etc/printcap</span> pour <code>orchid</code> (apparu dans la section <a href=#printing-advanced-header-pages-enabling>Activer les pages d’en-tête</a>). Il contenait déjà une entrée pour l’imprimante <code>teak</code>; nous avons ajouté celles pour les deux imprimantes sur la machine <code>rose</code>:</p></div><div class="literalblock programlisting"><div class=content><pre>#
#  /etc/printcap pour la machine orchid - ajout d&#39;imprimantes (distantes)
#    sur rose
#

#
#  teak est locale; connectée directement à orchid:
#
teak|hp|laserjet|Hewlett Packard LaserJet 3Si:\
        :lp=/dev/lpt0:sd=/var/spool/lpd/teak:mx#0:\
        :if=/usr/local/libexec/ifhp:\
        :vf=/usr/local/libexec/vfhp:\
        :of=/usr/local/libexec/ofhp:

#
#  rattan est connectée à rose; envoie les travaux pour rattan
#    à rose:
#
rattan|line|diablo|lp|Diablo 630 Line Printer:\
        :lp=:rm=rose:rp=rattan:sd=/var/spool/lpd/rattan:

#
#  bamboo est également connectée à rose:
#
bamboo|ps|PS|S|panasonic|Panasonic KX-P4455 PostScript v51.4:\
        :lp=:rm=rose:rp=bamboo:sd=/var/spool/lpd/bamboo:</pre></div></div><div class=paragraph><p>Ensuite, nous n’avons qu’à créer les répertoires de file d’impression sur <code>orchid</code>:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># mkdir -p /var/spool/lpd/rattan /var/spool/lpd/bamboo</span>
<span class=c># chmod 770 /var/spool/lpd/rattan /var/spool/lpd/bamboo</span>
<span class=c># chown daemon:daemon /var/spool/lpd/rattan /var/spool/lpd/bamboo</span></code></pre></div></div><div class=paragraph><p>Maintenant les utilisateurs d'<code>orchid</code> peuvent imprimer sur <code>rattan</code> et <code>bamboo</code>. Par exemple, si un utilisateur sur <code>orchid</code> entrait:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>% lpr <span class=nt>-P</span> bamboo <span class=nt>-d</span> sushi-review.dvi</code></pre></div></div><div class=paragraph><p>le système LPD sur <code>orchid</code> copierait le travail d’impression dans le répertoire de file d’impression <span class=filename>/var/spool/lpd/bamboo</span> et relèverait qu’il s’agit d’un travail d’impression DVI. Dès que la machine <code>rose</code> dispose d’assez de place dans son répertoire de file d’impression, les deux LPD transfèrent le fichier à <code>rose</code>. Le fichier reste en attente dans la file de <code>rose</code> jusqu’à son impression. Il sera converti de DVI en PostScript® (puisque <code>bamboo</code> est une imprimante PostScript®) sur <code>rose</code>.</p></div></div><div class=sect3><h4 id=printing-advanced-network-net-if>9.4.3.2. Imprimantes avec des interfaces utilisant des flux réseau<a class=anchor href=#printing-advanced-network-net-if></a></h4><div class=paragraph><p>Bien souvent, lorsque vous achetez une carte d’interface réseau pour une imprimante, vous avez le choix entre deux versions: l’une qui émule un gestionnaire d’impression (la version la plus onéreuse), ou une autre qui ne vous permet que de lui envoyer des données comme s’il s’agissait d’un port série ou parallèle (c’est la version la moins chère). Cette section vous indique comment utiliser cette seconde version moins onéreuse. Pour la plus chère, lisez la section précédente <a href=#printing-advanced-network-rm>Imprimantes installées sur des machines distantes</a>.</p></div><div class=paragraph><p>Le format du fichier <span class=filename>/etc/printcap</span> vous permet de préciser quelle interface série ou parallèle vous souhaitez utiliser, et (si vous employez une interface série) à quelle vitesse de transmission, s’il faut employer le contrôle de flux, les temporisations pour les tabulations, la conversion des sauts de lignes, et plus encore. Mais il n’existe aucun moyen de préciser une connexion à une imprimante qui écoute sur un port TCP/IP ou un autre port réseau.</p></div><div class=paragraph><p>Pour envoyer des données à une imprimante mise en réseau, il vous faut développer un programme de communication qui puisse être appelé par les filtres textes et de conversion. Voici un exemple: la procédure <code>netprint</code> récupère toutes les données sur l’entrée standard et les envoie à une imprimante connectée au réseau. Nous précisons le nom de machine de l’imprimante dans le premier paramètre et le numéro de port auquel se connecter dans le deuxième paramètre de <code>netprint</code>. Notez qu’il ne gère que la communication unidirectionnelle (dans le sens FreeBSD vers imprimante); de nombreuses imprimantes réseau supporte la communication bidirectionnelle, et vous désirerez certainement en tirer parti (afin de connaître le statut de l’imprimante, de comptabiliser l’utilisation, etc.).</p></div><div class="literalblock programlisting"><div class=content><pre>#!/usr/bin/perl
#
#  netprint - Filtre texte pour imprimante connectée au réseau
#  Fichier /usr/local/libexec/netprint
#
$#ARGV eq 1 || die &#34;Usage: $0 printer-hostname port-number&#34;;

$printer_host = $ARGV[0];
$printer_port = $ARGV[1];

require &#39;sys/socket.ph&#39;;

($ignore, $ignore, $protocol) = getprotobyname(&#39;tcp&#39;);
($ignore, $ignore, $ignore, $ignore, $address)
    = gethostbyname($printer_host);

$sockaddr = pack(&#39;S n a4 x8&#39;, AF_INET, $printer_port, $address);

socket(PRINTER, PF_INET, SOCK_STREAM, $protocol)
    || die &#34;Can&#39;t create TCP/IP stream socket: $!&#34;;
connect(PRINTER, $sockaddr) || die &#34;Can&#39;t contact $printer_host: $!&#34;;
while (STDIN) { print PRINTER; }
exit 0;</pre></div></div><div class=paragraph><p>Nous pouvons maintenant utiliser cette procédure avec différents filtres. Supposons que nous ayons une imprimante Diablo 750-N connectée au réseau. Elle reçoit les données à imprimer sur le port 5100. Le nom de machine de l’imprimante est <code>scrivener</code>. Voici le filtre texte pour cette imprimante:</p></div><div class="literalblock programlisting"><div class=content><pre>#!/bin/sh
#
#  diablo-if-net - Filtre texte pour l&#39;imprimante  Diablo `scrivener&#39; écoutant
#  le port 5100.  Fichier /usr/local/libexec/diablo-if-net
#
exec /usr/libexec/lpr/lpf &#34;$@&#34; | /usr/local/libexec/netprint scrivener 5100</pre></div></div></div></div><div class=sect2><h3 id=printing-advanced-restricting>9.4.4. Restreindre l’utilisation de l’imprimante<a class=anchor href=#printing-advanced-restricting></a></h3><div class=paragraph><p>Cette section fournit des informations sur la restriction de l’utilisation de l’imprimante. Le système LPD vous permet de contrôler quels utilisateurs peuvent accéder à une imprimante, tant localement qu’à distance, s’il leur est autorisé d’imprimer en plusieurs exemplaires, quelles sont les tailles maximales de leurs travaux d’impression et des files d’impression.</p></div><div class=sect3><h4 id=printing-advanced-restricting-copies>9.4.4.1. Restreindre l’impression en plusieurs exemplaires<a class=anchor href=#printing-advanced-restricting-copies></a></h4><div class=paragraph><p>Le système LPD facilite l’impression de plusieurs copies d’un même fichier par les utilisateurs. Ils peuvent imprimer leur travail avec <code>lpr -#5</code> (par exemple) et obtenir cinq exemplaires de chaque fichier du travail d’impression. Le fait de savoir s’il s’agit là d’une bonne idée vous appartient.</p></div><div class=paragraph><p>Si vous estimez que les copies multiples provoquent charge et usure inutiles pour vos imprimantes, vous pouvez désactiver l’option <code>-<mark></mark></code> de <a href="https://man.freebsd.org/cgi/man.cgi?query=lpr&amp;sektion=1&amp;format=html">lpr(1)</a> en ajoutant le paramètre <code>sc</code> au fichier <span class=filename>/etc/printcap</span>. Lorsque des utilisateurs soumettront un travail d’impression avec l’option <code>-</code>, ils obtiendront cet affichage:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>lpr: multiple copies are not allowed</code></pre></div></div><div class=paragraph><p>Notez que si vous avez mis en œuvre l’accès à une imprimante distante (voir la section <a href=#printing-advanced-network-rm>Imprimantes installées sur des machines distantes</a>), il faut que le paramètre <code>sc</code> soit positionné sur les <span class=filename>/etc/printcap</span> distants également, sinon vos utilisateurs auront toujours la possibilité d’imprimer des copies multiples en passant par une autre machine.</p></div><div class=paragraph><p>Voici un exemple. C’est le <span class=filename>/etc/printcap</span> pour la machine <code>rose</code>. L’imprimante <code>rattan</code> est plutôt robuste, et autorisera donc les copies multiples, par contre l’imprimante laser <code>bamboo</code> est quant à elle plus délicate, nous interdiront donc les impressions multiples en ajoutant le paramètre <code>sc</code>:</p></div><div class="literalblock programlisting"><div class=content><pre>#
#  /etc/printcap pour la machine rose - restreint les impressions en plusieurs exemplaires sur bamboo
#
rattan|line|diablo|lp|Diablo 630 Line Printer:\
        :sh:sd=/var/spool/lpd/rattan:\
        :lp=/dev/lpt0:\
        :if=/usr/local/libexec/if-simple:

bamboo|ps|PS|S|panasonic|Panasonic KX-P4455 PostScript v51.4:\
        :sh:sd=/var/spool/lpd/bamboo:sc:\
        :lp=/dev/ttyd5:ms#-parenb cs8 clocal crtscts:rw:\
        :if=/usr/local/libexec/psif:\
        :df=/usr/local/libexec/psdf:</pre></div></div><div class=paragraph><p>Maintenant, il nous faut également ajouter le paramètre <code>sc</code> dans le fichier <span class=filename>/etc/printcap</span> de <code>orchid</code> (et tant que nous y sommes, désactivons les copies multiples pour l’imprimante <code>teak</code>):</p></div><div class="literalblock programlisting"><div class=content><pre>#
#  /etc/printcap pour la machine orchid - pas d&#39;impression en
#  plusieurs exemplaires pour
#  l&#39;imprimante locale teak ou l&#39;imprimante distante bamboo
teak|hp|laserjet|Hewlett Packard LaserJet 3Si:\
        :lp=/dev/lpt0:sd=/var/spool/lpd/teak:mx#0:sc:\
        :if=/usr/local/libexec/ifhp:\
        :vf=/usr/local/libexec/vfhp:\
        :of=/usr/local/libexec/ofhp:

rattan|line|diablo|lp|Diablo 630 Line Printer:\
        :lp=:rm=rose:rp=rattan:sd=/var/spool/lpd/rattan:

bamboo|ps|PS|S|panasonic|Panasonic KX-P4455 PostScript v51.4:\
        :lp=:rm=rose:rp=bamboo:sd=/var/spool/lpd/bamboo:sc:</pre></div></div><div class=paragraph><p>En recourant au paramètre <code>sc</code>, nous empêchons l’utilisation de <code>lpr -#</code>, mais cela n’empêche toujours pas les utilisateurs de lancer <a href="https://man.freebsd.org/cgi/man.cgi?query=lpr&amp;sektion=1&amp;format=html">lpr(1)</a> à plusieurs reprises, ou de soumettre le même fichier plusieurs fois en un seul travail, de cette façon:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>% lpr forsale.sign forsale.sign forsale.sign forsale.sign forsale.sign</code></pre></div></div><div class=paragraph><p>Il existe plusieurs moyens de prévenir ces abus (y compris les ignorer) que vous êtes libres d’essayer.</p></div></div><div class=sect3><h4 id=printing-advanced-restricting-access>9.4.4.2. Restreindre l’accès aux imprimantes<a class=anchor href=#printing-advanced-restricting-access></a></h4><div class=paragraph><p>Vous pouvez contrôler qui a le droit d’imprimer sur quelles imprimantes en utilisant le mécanisme des groupes UNIX® et le paramètre <code>rg</code> dans <span class=filename>/etc/printcap</span>. Placez simplement les utilisateurs à qui vous voulez donner l’accès à une imprimante dans un groupe, et précisez ce groupe avec le paramètre <code>rg</code>.</p></div><div class=paragraph><p>Les utilisateurs n’appartenant pas au groupe (<code>root</code> inclus) se verront gratifiés d’un <code>lpr: Not a member of the restricted group</code> s’ils essaient d’imprimer avec l’imprimante contrôlée.</p></div><div class=paragraph><p>De même que pour le paramètre <code>sc</code> (supprimer les exemplaires multiples), il vous faut activer <code>rg</code> sur les machines distantes qui eux aussi ont accès à vos imprimantes, si vous estimez que c’est approprié (voir la section <a href=#printing-advanced-network-rm>Imprimantes installées sur des machines distantes</a>).</p></div><div class=paragraph><p>Dans notre exemple, nous allons permettre l’accès à <code>rattan</code> à quiconque, mais seuls les membres du groupe <code>artists</code> pourront utiliser <code>bamboo</code>. Voici l’habituel <span class=filename>/etc/printcap</span> pour la machine <code>rose</code>:</p></div><div class="literalblock programlisting"><div class=content><pre>#
#  /etc/printcap pour la machine rose - restreint au groupe pour bamboo
#
rattan|line|diablo|lp|Diablo 630 Line Printer:\
        :sh:sd=/var/spool/lpd/rattan:\
        :lp=/dev/lpt0:\
        :if=/usr/local/libexec/if-simple:

bamboo|ps|PS|S|panasonic|Panasonic KX-P4455 PostScript v51.4:\
        :sh:sd=/var/spool/lpd/bamboo:sc:rg=artists:\
        :lp=/dev/ttyd5:ms#-parenb cs8 clocal crtscts:rw:\
        :if=/usr/local/libexec/psif:\
        :df=/usr/local/libexec/psdf:</pre></div></div><div class=paragraph><p>Ne nous préoccupons pas de l’autre fichier <span class=filename>/etc/printcap</span> (pour la machine <code>orchid</code>). Bien entendu, n’importe qui sur <code>orchid</code> peut imprimer avec <code>bamboo</code>. Selon le cas, nous pourrons autoriser que certains utilisateurs sur <code>orchid</code>, et leur donner accès à l’imprimante. Ou non.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Il ne peut exister qu’un seul groupe de restriction par imprimante.</p></div></td></tr></tbody></table></div></div><div class=sect3><h4 id=printing-advanced-restricting-sizes>9.4.4.3. Contrôler la taille des travaux d’impression<a class=anchor href=#printing-advanced-restricting-sizes></a></h4><div class=paragraph><p>Si beaucoup de vos utilisateurs accèdent aux imprimantes, vous aurez sans doute besoin de fixer une limite supérieure à la taille des fichiers qu’ils peuvent soumettre à l’impression. Après tout, le système de fichiers hébergeant les répertoires de file d’impression ne peut offrir que l’espace libre dont il dispose, et vous devez également vous assurer que de la place existe pour les travaux d’impression des autres utilisateurs.</p></div><div class=paragraph><p>LPD vous permet de fixer la taille maximale en octets qu’un fichier d’un travail d’impression peut atteindre avec le paramètre <code>mx</code>. Les unités sont exprimées en blocs de <code>BUFSIZ</code>, valant 1024 octets. Si vous donnez la valeur 0 à ce paramètre, la taille ne sera pas du tout limitée; en revanche, si aucun paramètre <code>mx</code> n’est défini, alors une limite par défaut de 1000 blocs sera utilisée.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>La limite s’applique aux <em>fichiers</em> dans un travail d’impression, et <em>non pas</em> à la taille totale du travail d’impression.</p></div></td></tr></tbody></table></div><div class=paragraph><p>LPD ne refusera pas un fichier dont la taille excède la limite que vous fixez pour une imprimante. Au lieu de cela, il placera les octets du fichier dans la file jusqu’à ce que la limite soit atteinte, puis imprimera. Les octets supplémentaires seront ignorés. S’il s’agit là d’un comportement approprié est un choix qui vous appartient.</p></div><div class=paragraph><p>Ajoutons des limites pour nos imprimantes d’exemple, <code>rattan</code> et <code>bamboo</code>. Puisque les fichiers PostScript® des utilisateurs du groupe <code>artists</code> ont tendance à être volumineux, nous allons les limiter à cinq mégaoctets. Nous ne fixerons aucune limite pour l’imprimante texte:</p></div><div class="literalblock programlisting"><div class=content><pre>#
#  /etc/printcap pour la machine rose
#

#
#  Pas de limite sur la taille des travaux:
#
rattan|line|diablo|lp|Diablo 630 Line Printer:\
        :sh:mx#0:sd=/var/spool/lpd/rattan:\
        :lp=/dev/lpt0:\
        :if=/usr/local/libexec/if-simple:

#
#  Limite de cinq mégaoctets:
#
bamboo|ps|PS|S|panasonic|Panasonic KX-P4455 PostScript v51.4:\
        :sh:sd=/var/spool/lpd/bamboo:sc:rg=artists:mx#5000:\
        :lp=/dev/ttyd5:ms#-parenb cs8 clocal crtscts:rw:\
        :if=/usr/local/libexec/psif:\
        :df=/usr/local/libexec/psdf:</pre></div></div><div class=paragraph><p>Là encore, les limites ne s’appliquent qu’aux utilisateurs locaux. Si vous avez mis en place un accès distant à vos imprimantes, les utilisateurs distants ne seront pas contraints par ces limites. Il vous faudra positionner le paramètre <code>mx</code> dans les fichiers <span class=filename>/etc/printcap</span> distants également. Lisez la section <a href=#printing-advanced-network-rm>Imprimantes installées sur des machines distantes</a> pour obtenir plus d’informations sur l’impression à distance.</p></div><div class=paragraph><p>Il existe une autre manière spécifique pour limiter la taille des travaux d’impression sur les imprimantes à distance; lisez la section <a href=#printing-advanced-restricting-remote>Restreindre les impressions à distance</a>.</p></div></div><div class=sect3><h4 id=printing-advanced-restricting-remote>9.4.4.4. Restreindre les impressions à distance<a class=anchor href=#printing-advanced-restricting-remote></a></h4><div class=paragraph><p>Le gestionnaire d’impression LPD propose plusieurs moyens de restreindre les travaux d’impression soumis depuis des machines distants:</p></div><div class=dlist><dl><dt class=hdlist1>Restrictions en fonction des machines</dt><dd><p>Vous pouvez contrôler de quelles machines distantes les requêtes seront acceptées par un LPD local avec les fichiers <span class=filename>/etc/hosts.equiv</span> et <span class=filename>/etc/hosts.lpd</span>. LPD vérifie qu’une requête entrante provient d’une machine listée dans l’un de ces deux fichiers. Si ce n’est pas le cas, LPD refuse la requête.</p><div class=paragraph><p>Le format de ces fichiers est simple: un nom de machine par ligne. Notez que <span class=filename>/etc/hosts.equiv</span> est également utilisé par le protocole <a href="https://man.freebsd.org/cgi/man.cgi?query=ruserok&amp;sektion=3&amp;format=html">ruserok(3)</a>, et qu’il a un impact sur des programmes comme <a href="https://man.freebsd.org/cgi/man.cgi?query=rsh&amp;sektion=1&amp;format=html">rsh(1)</a> et <a href="https://man.freebsd.org/cgi/man.cgi?query=rcp&amp;sektion=1&amp;format=html">rcp(1)</a>, aussi soyez prudent.</p></div><div class=paragraph><p>Par exemple, voici le fichier <span class=filename>/etc/hosts.lpd</span> présent sur la machine <code>rose</code>:</p></div><div class="literalblock programlisting"><div class=content><pre>orchid
violet
madrigal.fishbaum.de</pre></div></div><div class=paragraph><p>Cela signifie que <code>rose</code> accepte les requêtes provenant des machines <code>orchid</code>, <code>violet</code> et <code>madrigal.fishbaum.de</code>. Si une quelconque autre machine tente d’accéder au LPD de <code>rose</code>, le travail d’impression sera refusé.</p></div></dd><dt class=hdlist1>Restrictions sur la taille</dt><dd><p>Vous pouvez contrôler combien d’espace doit demeurer libre sur le système de fichiers où se trouve un répertoire de file d’impression. Créez un fichier nommé <span class=filename>minfree</span> dans le répertoire de file d’impression pour l’imprimante locale. Placez dans ce fichier un nombre représentant combien de blocs disques (de 512 octets) d’espace libre il doit rester pour qu’un travail d’impression soit accepté.</p><div class=paragraph><p>Cela vous permet de vous assurer que des utilisateurs distants ne rempliront pas votre système de fichiers. Vous pouvez également vous en servir pour accorder une certaine priorité aux utilisateurs locaux: ils pourront placer des travaux d’impression dans la file bien après que l’espace libre soit tombé sous le seuil indiqué dans le fichier <span class=filename>minfree</span>.</p></div><div class=paragraph><p>Par exemple, ajoutons un fichier <span class=filename>minfree</span> pour l’imprimante <code>bamboo</code>. Nous examinons <span class=filename>/etc/printcap</span> pour trouver le répertoire de file d’impression pour cette imprimante; voici l’entrée concernant <code>bamboo</code>:</p></div><div class="literalblock programlisting"><div class=content><pre>bamboo|ps|PS|S|panasonic|Panasonic KX-P4455 PostScript v51.4:\
        :sh:sd=/var/spool/lpd/bamboo:sc:rg=artists:mx#5000:\
        :lp=/dev/ttyd5:ms#-parenb cs8 clocal crtscts:rw:mx#5000:\
        :if=/usr/local/libexec/psif:\
        :df=/usr/local/libexec/psdf:</pre></div></div><div class=paragraph><p>Le répertoire de file d’impression est précisé par le paramètre <code>sd</code>. Nous placerons à trois méga-octets (soit 6144 blocs disque) la limite d’espace libre devant exister sur le système de fichiers pour que LPD accepte les travaux d’impression distants:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># echo 6144 &gt; /var/spool/lpd/bamboo/minfree</span></code></pre></div></div></dd><dt class=hdlist1>Restrictions sur l’utilisateur</dt><dd><p>Vous pouvez contrôler quels utilisateurs distants ont le droit d’imprimer sur les imprimantes locales en positionnant le paramètre <code>rs</code> dans <span class=filename>/etc/printcap</span>. Lorsque <code>rs</code> est présent dans l’entrée d’une imprimante connectée localement, LPD acceptera les travaux d’impressions de machines distantes <em>si</em> l’utilisateur soumettant le travail possède également un compte sous le même nom sur la machine locale. Sinon, LPD refusera le travail d’impression.</p><div class=paragraph><p>Ce paramètre se révèle particulièrement utile dans un environnement où (par exemple) existent plusieurs services qui partagent un réseau, et que des utilisateurs débordent les frontières de ces services. En leur donnant des comptes sur vos systèmes, vous leur permettez d’utiliser vos imprimantes depuis les systèmes de leur propre service. Si vous préférez les autoriser à n’utiliser <em>que</em> vos imprimantes et pas les autres ressources de l’ordinateur, alors vous pouvez leur attribuer des comptes "bloqués", sans répertoire de connexion et avec un interpréteur de commandes inutilisable comme <span class=filename>/usr/bin/false</span>.</p></div></dd></dl></div></div></div><div class=sect2><h3 id=printing-advanced-acct>9.4.5. Comptabiliser l’utilisation de l’imprimante<a class=anchor href=#printing-advanced-acct></a></h3><div class=paragraph><p>Donc vous voulez faire payer vos impressions. Et pourquoi pas? Le papier et l’encre coûtent de l’argent. Et puis, il y a les coûts de maintenance-les imprimantes sont constituées de pièces mobiles et ont tendance à tomber en panne. Vous avez étudié vos imprimantes, vos modes d’utilisation et factures de maintenance, et avez abouti à un coût par page (ou par pied, par mètre, ou par ce que vous voulez). Maintenant, comment commencer à comptabiliser les impressions, dans les faits?</p></div><div class=paragraph><p>Eh bien, la mauvaise nouvelle est que le gestionnaire d’impression LPD ne vous aide pas beaucoup dans ce domaine. La comptabilisation dépend fortement du type d’imprimante que vous employez, des formats que vous imprimez et de <em>vos</em> besoins pour ce qui est de faire payer l’utilisation de l’imprimante.</p></div><div class=paragraph><p>Pour mettre en œuvre la comptabilisation, il vous faut modifier le filtre texte de l’imprimante (pour faire payer les travaux d’impression de texte brut) et ses filtres de conversion (pour faire payer les autres formats de fichiers), pour compter les pages ou demander à l’imprimante combien elle en a imprimées. Vous ne pouvez pas vous en tirer en utilisant le filtre de sortie simple, puisqu’il ne peut pas gérer la comptabilisation. Voir la section <a href=#printing-advanced-filter-intro>Les filtres</a>.</p></div><div class=paragraph><p>En général, il existe deux façons de procéder à la comptabilisation:</p></div><div class=ulist><ul><li><p>La comptabilisation <em>périodique</em> est la plus habituelle, probablement parce que la plus facile. Chaque fois que quelqu’un imprime un travail, le filtre enregistre l’utilisateur, la machine et le nombre de pages dans un fichier de comptabilisation. Tous les mois, semestres, années ou toute autre échéance que vous désirez, vous récupérez les fichiers de comptabilisation des diverses imprimantes, établissez les pages imprimées par les utilisateurs, et faites payer l’utilisation. Purgez ensuite tous les fichiers de comptabilisation, pour commencer à zéro la nouvelle période.</p></li><li><p>La comptabilisation <em>à la volée</em> est moins répandue, peut-être parce qu’elle s’avère plus difficile. Cette méthode laisse les filtres s’occuper de taxer les utilisateurs pour les impressions dès qu’ils utilisent les imprimantes. Tout comme les quotas disques, la comptabilisation est immédiate. Vous pouvez empêcher les utilisateurs d’imprimer quand leur compte est dans le rouge, et pourriez leur fournir un moyen de vérifier et ajuster leurs "quotas d’impression". Cependant, cette méthode nécessite la mise en oeuvre d’une base de données afin de tracer les utilisateurs et leurs quotas.</p></li></ul></div><div class=paragraph><p>Le gestionnaire d’impression LPD gère les deux méthodes facilement: puisque vous devez fournir les filtres (enfin, la plupart du temps), vous devez également fournir le code de comptabilisation. Mais il y a un bon côté: vous disposez d’une énorme flexibilité dans vos méthodes de comptabilisation. Par exemple, vous avez le choix entre les comptabilisations périodique et à la volée. Vous avez le choix des informations à tracer: noms d’utilisateurs, noms de machines, types des travaux d’impression, pages imprimées, surface de papier utilisée, durée d’impression du travail, etc. Et vous le faites en modifiant les filtres afin d’enregistrer ces informations.</p></div><div class=sect3><h4 id=_comptabilisation_rapide_et_simplifiée_des_impressions>9.4.5.1. Comptabilisation rapide et simplifiée des impressions<a class=anchor href=#_comptabilisation_rapide_et_simplifiée_des_impressions></a></h4><div class=paragraph><p>Deux programmes sont livrés avec FreeBSD qui vous permettent de mettre en place une comptabilisation périodique simple immédiatement. Il s’agit du filtre texte <code>lpf</code>, détaillé dans la section <a href=#printing-advanced-lpf>lpf: un filtre texte</a>, et de <a href="https://man.freebsd.org/cgi/man.cgi?query=pac&amp;sektion=8&amp;format=html">pac(8)</a>, un programme qui rassemble et fait le total des entrées contenues dans des fichiers de comptabilisation d’impressions.</p></div><div class=paragraph><p>Comme indiqué dans la section sur les filtres (<a href=#printing-advanced-filters>Fonctionnement des filtres</a>), LPD lance les filtres texte et de conversion avec le nom du fichier de comptabilisation à employer fourni en argument. Les filtres peuvent utiliser ce paramètre pour savoir où écrire un enregistrement de comptabilisation. Le nom de ce fichier provient du paramètre <code>af</code> dans <span class=filename>/etc/printcap</span>, et si le chemin donné n’est pas absolu, alors c’est un chemin d’accès relatif au répertoire de file d’impression.</p></div><div class=paragraph><p>LPD lance <code>lpf</code> avec les paramètres de largeur et hauteur de page (qui correspondent aux paramètres <code>pw</code> et <code>pl</code>). Le filtre <code>lpf</code> les utilise pour déterminer combien de papier sera consommé. Après avoir envoyé le fichier à l’imprimante, il enregistre ensuite une entrée dans le fichier de comptabilisation. Les entrées ressemblent à ceci:</p></div><div class="literalblock programlisting"><div class=content><pre>2.00 rose:andy
3.00 rose:kelly
3.00 orchid:mary
5.00 orchid:mary
2.00 orchid:zhang</pre></div></div><div class=paragraph><p>Vous devriez utiliser un fichier de comptabilisation séparé pour chaque imprimante, <code>lpf</code> ne disposant pas de mécanisme de verrouillage des fichiers, deux <code>lpf</code> pourraient corrompre leurs entrées respectives s’ils essayaient d’écrire dans le même fichier en même temps. Une manière aisée de s’assurer d’un fichier de comptabilisation séparé pour chaque imprimante est de recourir au paramètre <code>af=acct</code> dans <span class=filename>/etc/printcap</span>. Dès lors, un fichier de comptabilisation, nommé <span class=filename>acct</span>, sera placé dans le répertoire de file d’impression de chaque imprimante.</p></div><div class=paragraph><p>Lorsque vous serez prêts à faire payer les utilisateurs pour leurs impressions, lancez le programme <a href="https://man.freebsd.org/cgi/man.cgi?query=pac&amp;sektion=8&amp;format=html">pac(8)</a>. Placez-vous simplement dans le répertoire de file d’impression de l’imprimante pour laquelle vous voulez collecter les informations, et tapez <code>pac</code>. Vous obtiendrez un récapitulatif en dollars ressemblant à ceci:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell> Login               pages/feet   runs    price
orchid:kelly                5.00    1   <span class=nv>$ </span> 0.10
orchid:mary                31.00    3   <span class=nv>$ </span> 0.62
orchid:zhang                9.00    1   <span class=nv>$ </span> 0.18
rose:andy                   2.00    1   <span class=nv>$ </span> 0.04
rose:kelly                177.00  104   <span class=nv>$ </span> 3.54
rose:mary                  87.00   32   <span class=nv>$ </span> 1.74
rose:root                  26.00   12   <span class=nv>$ </span> 0.52

total                     337.00  154   <span class=nv>$ </span> 6.74</code></pre></div></div><div class=paragraph><p>Voici les arguments attendus par <a href="https://man.freebsd.org/cgi/man.cgi?query=pac&amp;sektion=8&amp;format=html">pac(8)</a>:</p></div><div class=dlist><dl><dt class=hdlist1><code>-P<em>imprimante</em></code></dt><dd><p>Pour quelle <em>imprimante</em> effectuer un récapitulatif. Cette option ne fonctionne que si un chemin d’accès absolu est donné dans le paramètre <code>af</code> de <span class=filename>/etc/printcap</span>.</p></dd><dt class=hdlist1><code>-c</code></dt><dd><p>Trier selon le coût plutôt qu’alphabétiquement par nom d’utilisateur.</p></dd><dt class=hdlist1><code>-m</code></dt><dd><p>Ignorer le nom de la machine dans les fichiers de comptabilisation. Avec cette option, l’utilisateur <code>smith</code> sur la machine <code>alpha</code> est le même que l’utilisateur <code>smith</code> sur la machine <code>gamma</code>. Sans elle, ils représentent des utilisateurs distincts.</p></dd><dt class=hdlist1><code>-p<em>prix</em></code></dt><dd><p>Calculer le coût en comptant un <em>prix</em> en dollars par page ou par pied au lieu du prix indiqué par le paramètre <code>pc</code> dans <span class=filename>/etc/printcap</span>, ou deux cents (la valeur par défaut). Vous pouvez préciser le <em>prix</em> en nombre à virgule flottante.</p></dd><dt class=hdlist1><code>-r</code></dt><dd><p>Inverser l’ordre du tri.</p></dd><dt class=hdlist1><code>-s</code></dt><dd><p>Créer un fichier de rapport et tronquer le fichier de comptabilisation.</p></dd><dt class=hdlist1><em>nom …​</em></dt><dd><p>N’imprimer des statistiques que pour les utilisateurs dont les <em>nom</em>s sont donnés.</p></dd></dl></div><div class=paragraph><p>Dans le récapitulatif produit par défaut par <a href="https://man.freebsd.org/cgi/man.cgi?query=pac&amp;sektion=8&amp;format=html">pac(8)</a>, vous pouvez lire le nombre de pages imprimées par chaque utilisateur depuis les différentes machines. Si, sur votre site, la machine n’a pas d’importance (parce que les utilisateurs peuvent utiliser n’importe quelle machine), lancez <code>pac -m</code>, afin de produire le récapitulatif ci-dessous:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>  Login               pages/feet   runs    price
andy                        2.00    1   <span class=nv>$ </span> 0.04
kelly                     182.00  105   <span class=nv>$ </span> 3.64
mary                      118.00   35   <span class=nv>$ </span> 2.36
root                       26.00   12   <span class=nv>$ </span> 0.52
zhang                       9.00    1   <span class=nv>$ </span> 0.18

total                     337.00  154   <span class=nv>$ </span> 6.74</code></pre></div></div><div class=paragraph><p>Afin de calculer le montant dû en dollars, <a href="https://man.freebsd.org/cgi/man.cgi?query=pac&amp;sektion=8&amp;format=html">pac(8)</a> utilise le paramètre <code>pc</code> de <span class=filename>/etc/printcap</span> (200 par défaut, c’est à dire 2 cents par page). Précisez avec ce paramètre le prix par page ou par pied, exprimé en centièmes de cents, que vous voulez imputer aux impressions. Vous pouvez spécifier cette valeur lorsque vous lancez <a href="https://man.freebsd.org/cgi/man.cgi?query=pac&amp;sektion=8&amp;format=html">pac(8)</a> avec l’option <code>-p</code>. Cependant, avec cette option, les unités sont exprimées en dollars, et non en centièmes de cents. Par exemple,</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># pac -p1.50</span></code></pre></div></div><div class=paragraph><p>fait en sorte que chaque page coûte un dollar et cinquante cents. Vous pouvez vraiment faire des bénéfices en utilisant cette option.</p></div><div class=paragraph><p>Enfin, lancer <code>pac -s</code> enregistrera les informations du récapitulatif dans un fichier, dont le nom sera le même que le fichier de comptabilisation de l’imprimante mais avec le suffixe <code>_sum</code>. Il procède alors à la troncature du fichier de comptabilisation. Lorsque vous exécutez <a href="https://man.freebsd.org/cgi/man.cgi?query=pac&amp;sektion=8&amp;format=html">pac(8)</a> à nouveau, il relit le fichier récapitulatif pour établir les totaux de départ, puis ajoute les informations du fichier de comptabilisation normal.</p></div></div><div class=sect3><h4 id=_comment_compter_les_pages_imprimées>9.4.5.2. Comment compter les pages imprimées?<a class=anchor href=#_comment_compter_les_pages_imprimées></a></h4><div class=paragraph><p>Afin de réaliser une comptabilisation précise et cela même à distance, vous devez pouvoir déterminer combien un travail d’impression consomme de papier. C’est le problème principal de la comptabilisation des impressions.</p></div><div class=paragraph><p>Pour du texte brut, ce problème n’est pas compliqué à résoudre: vous comptez combien un travail d’impression comporte de lignes et comparez avec le nombre de lignes par page que gère votre imprimante. N’oubliez pas de tenir compte des retours arrière dans le fichier, qui superposent les lignes, ou des longues lignes qui s’étendent sur une ou plusieurs lignes physiques supplémentaires.</p></div><div class=paragraph><p>Le filtre texte <code>lpf</code> (présenté à la section <a href=#printing-advanced-lpf>lpf: un filtre texte</a>) prend ces éléments en considération lorsqu’il effectue la comptabilisation. Si vous écrivez un filtre texte qui doit effectuer une comptabilisation, vous pouvez vous inspirer du code source de <code>lpf</code>.</p></div><div class=paragraph><p>Mais comment gérer les autres formats?</p></div><div class=paragraph><p>Eh bien, pour la conversion DVI-vers-LaserJet ou DVI-vers-PostScript®, vous pouvez faire analyser les messages de sortie de <code>dvilj</code> ou <code>dvips</code> par votre filtre et regarder combien de pages ont été converties. Vous devriez pouvoir procéder de manière identique avec d’autres formats de fichiers et programmes de conversion.</p></div><div class=paragraph><p>Mais ces méthodes connaissent un défaut: il se peut que l’imprimante n’imprime pas toutes ces pages. Par exemple, un bourrage peut se produire, l’imprimante peut arriver à cours d’encre, ou exploser - et l’utilisateur serait tout de même débité.</p></div><div class=paragraph><p>Alors, que pouvez-vous faire?</p></div><div class=paragraph><p>Il n’existe qu’une seule méthode <em>sûre</em> pour procéder à une comptabilisation <em>précise</em>. Prenez une imprimante qui sache dire combien de papier elle utilise, et reliez-la par un câble série ou une connection réseau. Presque toutes les imprimantes PostScript® gèrent cela. D’autres types et modèles également (les imprimantes laser réseau Imagen, par exemple). Modifiez les filtres pour ces imprimantes afin d’obtenir la consommation de pages après chaque travail d’impression et faites en sorte qu’elles enregistrent des informations de comptabilisation basées sur cette <em>seule</em> valeur. Nul besoin de compter les lignes ou d’une analyse de fichier susceptible d’être erronée.</p></div><div class=paragraph><p>Bien entendu, vous pouvez toujours être généreux et rendre toutes les impressions gratuites.</p></div></div></div></div></div><div class=sect1><h2 id=printing-using>9.5. Using Printers <strong>Traduction en Cours </strong><a class=anchor href=#printing-using></a></h2><div class=sectionbody><div class=sect2><h3 id=printing-lpr>9.5.1. Printing Jobs<a class=anchor href=#printing-lpr></a></h3></div><div class=sect2><h3 id=printing-lpq>9.5.2. Checking Jobs<a class=anchor href=#printing-lpq></a></h3></div><div class=sect2><h3 id=printing-lprm>9.5.3. Removing Jobs<a class=anchor href=#printing-lprm></a></h3></div><div class=sect2><h3 id=printing-lpr-options>9.5.4. Beyond Plain Text: Printing Options<a class=anchor href=#printing-lpr-options></a></h3><div class=sect3><h4 id=printing-lpr-options-format>9.5.4.1. Formatting and Conversion Options<a class=anchor href=#printing-lpr-options-format></a></h4></div><div class=sect3><h4 id=printing-lpr-options-job-handling>9.5.4.2. Job Handling Options<a class=anchor href=#printing-lpr-options-job-handling></a></h4></div><div class=sect3><h4 id=printing-lpr-options-misc>9.5.4.3. Header Page Options<a class=anchor href=#printing-lpr-options-misc></a></h4></div></div><div class=sect2><h3 id=printing-lpc>9.5.5. Administering Printers<a class=anchor href=#printing-lpc></a></h3></div></div></div><div class=sect1><h2 id=printing-lpd-alternatives>9.6. Alternatives to the Standard Spooler <strong>Traduction en Cours </strong><a class=anchor href=#printing-lpd-alternatives></a></h2><div class=sectionbody></div></div><div class=sect1><h2 id=printing-troubleshooting>9.7. Troubleshooting <strong>Traduction en Cours </strong><a class=anchor href=#printing-troubleshooting></a></h2><div class=sectionbody></div></div></div><hr><div class=last-modified><p><strong>Last modified on</strong>: 9 mars 2024 by <a href="https://cgit.freebsd.org/doc/commit/?id=6199af92e7" target=_blank>Danilo G. Baio</a></p></div><div class=buttons><div class=prev><i class="fa fa-angle-left" aria-hidden=true title=Prev></i><div class=container><a href=https://docs.freebsd.org/fr/books/handbook/kernelconfig class=direction>Prev</a></div></div><div class=home><i class="fa fa-home" aria-hidden=true title=Home></i><div class=container><a href=../ class=direction>Home</a></div></div><div class=next><div class=container><a href=https://docs.freebsd.org/fr/books/handbook/linuxemu class=direction>Next</a></div><i class="fa fa-angle-right" aria-hidden=true title=Next></i></div></div><label class="hidden book-menu-overlay" for=menu-control></label></div><aside class=toc><div class=toc-content><h3>Sommaire</h3><nav id=TableOfContents><ul><li><a href=#printing-synopsis>9.1. Synopsis</a></li><li><a href=#printing-intro-spooler>9.2. Introduction</a></li><li><a href=#printing-intro-setup>9.3. Configuration de base</a></li><li><a href=#printing-advanced>9.4. Configuration avancée de l’imprimante</a></li><li><a href=#printing-using>9.5. Using Printers <strong>Traduction en Cours</strong></a></li><li><a href=#printing-lpd-alternatives>9.6. Alternatives to the Standard Spooler <strong>Traduction en Cours</strong></a></li><li><a href=#printing-troubleshooting>9.7. Troubleshooting <strong>Traduction en Cours</strong></a></li></ul></nav><hr><div class=resources><h3>Ressources</h3><ul class=contents><li><i class="fa fa-file-pdf-o" aria-hidden=true title="Téléchargement en PDF"></i><a href=https://download.freebsd.org/doc/fr/books/handbook/handbook_fr.pdf>Téléchargement en PDF</a></li><li><i class="fa fa-pencil-square-o" aria-hidden=true title="Éditer cette page"></i><a href=https://github.com/freebsd/freebsd-doc/blob/main/documentation/content/fr/_index target=_blank>Éditer cette page</a></li></ul></div></div></aside><a class=to-top href=#top><i class="fa fa-arrow-circle-up" aria-hidden=true></i></a></main><footer><div class=footer-container><section class=logo-column><img src=https://docs.freebsd.org/images/FreeBSD-colors.svg width=160 height=50 alt="FreeBSD logo"><div class=options-container><div class=language-container><a id=languages href=https://docs.freebsd.org/fr/languages><img src=https://docs.freebsd.org/images/language.png class=language-image alt="Choose language">
<span>French</span></a></div><div class=theme-container><select id=theme-chooser><option value=theme-system>System</option><option value=theme-light>Clair</option><option value=theme-dark>Sombre</option><option value=theme-high-contrast>Contraste élevé</option></select></div></div></section><section class=about-column><h3 class=column-title>About</h3><ul class=column-elements-container><li><a href=https://www.freebsd.org/about/ target=_blank class=column-element>FreeBSD</a></li><li><a href=https://freebsdfoundation.org/ target=_blank class=column-element>FreeBSD Foundation</a></li><li><a href=https://www.freebsd.org/where/ target=_blank class=column-element>Get FreeBSD</a></li><li><a href=https://www.freebsd.org/internal/code-of-conduct target=_blank class=column-element>Code of Conduct</a></li><li><a href=https://www.freebsd.org/security/ target=_blank class=column-element>Security Advisories</a></li></ul></section><section class=documentation-column><h3 class=column-title>Documentation</h3><ul class=column-elements-container><li><a href=/fr class=column-element>Documentation portal</a></li><li><a href=https://man.FreeBSD.org target=_blank class=column-element>Manual pages</a></li><li><a href=https://papers.FreeBSD.org target=_blank class=column-element>Presentations and papers</a></li><li><a href=https://docs-archive.freebsd.org/doc/ target=_blank class=column-element>Previous versions</a></li><li><a href=https://docs-archive.freebsd.org/44doc/ target=_blank class=column-element>4.4BSD Documents</a></li><li><a href=https://wiki.freebsd.org/ target=_blank class=column-element>Wiki</a></li></ul></section><section class=community-column><h3 class=column-title>Community</h3><ul class=column-elements-container><li><a href=https://docs.freebsd.org/fr/articles/contributing class=column-element>Get involved</a></li><li><a href=https://forums.freebsd.org/ target=_blank class=column-element>Community forum</a></li><li><a href=https://lists.freebsd.org/ target=_blank class=column-element>Mailing lists</a></li><li><a href=https://wiki.freebsd.org/IRC/Channels target=_blank class=column-element>IRC Channels</a></li><li><a href=https://bugs.freebsd.org/bugzilla/ target=_blank class=column-element>Bug Tracker</a></li></ul></section><section class=legal-column><h3 class=column-title>Legal</h3><ul class=column-elements-container><li><a href=https://freebsdfoundation.org/donate/ target=_blank class=column-element>Donations</a></li><li><a href=https://www.freebsd.org/copyright/freebsd-license/ target=_blank class=column-element>Licensing</a></li><li><a href=https://www.freebsd.org/privacy/ target=_blank class=column-element>Privacy Policy</a></li><li><a href=https://www.freebsd.org/copyright/ target=_blank class=column-element>Legal notices</a></li></ul></section><section class=copyright-column><p>&copy; 1994-2024 The FreeBSD Project. All rights reserved</p><span>Made with <span class=heart>♥</span> by the FreeBSD Community</span></section></div></footer></body></html>