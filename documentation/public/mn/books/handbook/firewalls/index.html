<!doctype html><html class=theme-light lang=mn><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content><meta name=keywords content><meta name=copyright content="1995-2024 The FreeBSD Foundation"><link rel=canonical href=https://docs.freebsd.org/mn/books/handbook/firewalls/><title>Бүлэг 31. Галт хана | FreeBSD Documentation Portal</title>
<meta name=theme-color content="#790000"><meta name=color-scheme content="system light dark high-contrast"><link rel="shortcut icon" href=https://docs.freebsd.org/favicon.ico><link rel=stylesheet href=https://docs.freebsd.org/styles/main.min.css><link rel=stylesheet href=https://docs.freebsd.org/css/font-awesome-min.css><script defer src=/js/theme-chooser.min.js></script><script defer src=/js/copy-clipboard.min.js></script><script defer src=/js/search.min.js></script><meta name=twitter:card content="summary"><meta name=twitter:domain content="docs.FreeBSD.org"><meta name=twitter:site content="@freebsd"><meta name=twitter:url content="https://twitter.com/freebsd"><meta property="og:title" content="Бүлэг 31. Галт хана"><meta property="og:description" content><meta property="og:type" content="website"><meta property="og:image" content="https://docs.freebsd.org/favicon.ico"><meta property="og:image:alt" content="FreeBSD Logo"><meta property="og:locale" content="mn"><meta property="og:url" content="https://docs.freebsd.org/mn/books/handbook/firewalls/"><meta property="og:site_name" content="FreeBSD Documentation Portal"><script type=application/ld+json>{"@context":"http://schema.org","@type":"Article","url":"https:\/\/docs.freebsd.org\/mn\/books\/handbook\/firewalls\/","name":"FreeBSD Documentation Portal","headline":"FreeBSD Documentation Portal","description":"FreeBSD Documentation Portal"}</script></head><body><header><div class=header-container><div class=logo-menu-bars-container><a href=https://www.FreeBSD.org class=logo><img src=https://docs.freebsd.org/images/FreeBSD-monochromatic.svg width=160 height=50 alt="FreeBSD logo">
</a><label class=menu-bars for=menu-bars><i class="fa fa-bars" aria-hidden=true></i></label></div><input id=menu-bars type=checkbox><nav><ul class=menu><li class=menu-item><input id=about type=checkbox>
<a href=# aria-label="Navigate to About section"><label class=menu-item-description for=about>About
<i class="fa fa-angle-down fa-lg" aria-hidden=true></i></label></a><ul class=sub-menu><li class=title><a href=https://www.freebsd.org/about/ target=_blank>About</a></li><li><a href=https://www.freebsd.org/about/ target=_blank>FreeBSD</a></li><li><a href=https://freebsdfoundation.org/about-us/about-the-foundation/ target=_blank>FreeBSD Foundation</a></li><li><a href=https://www.freebsd.org/internal/code-of-conduct/ target=_blank>Code of Conduct</a></li></ul></li><li class=menu-item><input id=download type=checkbox>
<a href=# aria-label="Navigate to get FreeBSD section"><label class=menu-item-description for=download>Get FreeBSD
<i class="fa fa-angle-down fa-lg" aria-hidden=true></i></label></a><ul class=sub-menu><li class=title><a href=https://www.freebsd.org/where/ target=_blank>Get FreeBSD</a></li><li><a href=https://www.freebsd.org/releases/ target=_blank>Release Information</a></li><li><a href=https://www.freebsd.org/releng/ target=_blank>Release Engineering</a></li><li><a href=https://www.freebsd.org/security/ target=_blank>Security Advisories</a></li></ul></li><li class=menu-item><input id=documentation type=checkbox>
<a href=# aria-label="Navigate to get Documentation section"><label class=menu-item-description for=documentation>Documentation
<i class="fa fa-angle-down fa-lg" aria-hidden=true></i></label></a><ul class=sub-menu><li class=title><a href=/mn>Documentation portal</a></li><li><a href=https://docs.freebsd.org/mn/books/handbook>FreeBSD Handbook</a></li><li><a href=https://docs.freebsd.org/mn/books/porters-handbook>Porter's Handbook</a></li><li><a href=https://docs.FreeBSD.org/en/books/fdp-primer>Documentation Project Handbook</a></li><li><a href=https://man.FreeBSD.org target=_blank>Manual pages</a></li><li><a href=https://papers.FreeBSD.org target=_blank>Presentations and papers</a></li><li><a href=https://wiki.FreeBSD.org target=_blank>Wiki</a></li><li><a href=https://docs.freebsd.org/mn/books>Books</a></li><li><a href=https://docs.freebsd.org/mn/articles>Articles</a></li></ul></li><li class=menu-item><input id=community type=checkbox>
<a href=# aria-label="Navigate to get Community section"><label class=menu-item-description for=community>Community
<i class="fa fa-angle-down fa-lg" aria-hidden=true></i></label></a><ul class=sub-menu><li class=title><a href=https://www.freebsd.org/community/>Community</a></li><li><a href=https://docs.freebsd.org/mn/articles/contributing>Get involved</a></li><li><a href=https://forums.freebsd.org/ target=_blank>Forum</a></li><li><a href=https://lists.freebsd.org/ target=_blank>Mailing lists</a></li><li><a href=https://wiki.freebsd.org/IRC/Channels target=_blank>IRC Channels</a></li><li><a href=https://bugs.freebsd.org/bugzilla/ target=_blank>Bug Tracker</a></li><li><a href=https://www.freebsd.org/support/ target=_blank>Support</a></li></ul></li></ul></nav><div class=search-donate-container><form class=search method=get id=search-header-form action=https://docs.freebsd.org/search name=search-header-form><input type=hidden name=DB value=mn>
<input id=words name=P type=text size=20 maxlength=255>
<button>
<i class="fa fa-search" aria-hidden=true></i></button></form><div class=donate><a href=https://freebsdfoundation.org/donate/ target=_blank><span class=heart>♥</span>
Donate</a></div></div></div></header><input type=checkbox class="hidden toggle" id=menu-control><main class=main-wrapper-book><a id=top></a><aside class=book-menu><div class=book-menu-content><input id=search-book type=text placeholder=Search aria-label=Search maxlength=128><nav id=MenuContents><ul><li><input type=checkbox id=chapter-eb2a98ce203d8afd517726e6d8776be3 class=toggle>
<label class="icon cursor" for=chapter-eb2a98ce203d8afd517726e6d8776be3><a role=button></a></label><a href=https://docs.freebsd.org/mn/books/handbook/preface/>Өмнөх үг</a><ul><li><a href=https://docs.freebsd.org/mn/books/handbook/preface/#preface-audience>Энэ номын зориулалт</a></li><li><a href=https://docs.freebsd.org/mn/books/handbook/preface/#preface-changes-from3>Гурав дахь хэвлэлээс хойшх өөрчлөлтүүд</a></li><li><a href=https://docs.freebsd.org/mn/books/handbook/preface/#preface-changes-from2>Хоёр дахь хэвлэлээс (2004) хойшх өөрчлөлтүүд</a></li><li><a href=https://docs.freebsd.org/mn/books/handbook/preface/#preface-changes>Эхний хэвлэлээс (2001) хойшх өөрчлөлтүүд</a></li><li><a href=https://docs.freebsd.org/mn/books/handbook/preface/#preface-overview>Энэ номын зохион байгуулалт</a></li><li><a href=https://docs.freebsd.org/mn/books/handbook/preface/#preface-conv>Энэ номонд ашиглагдсан бичиглэлийн хэлбэрүүд</a></li><li><a href=https://docs.freebsd.org/mn/books/handbook/preface/#preface-acknowledgements>Талархал</a></li></ul></li><li><input type=checkbox id=chapter-14a525fce014b90b8a458a894818255a class=toggle>
<label for=chapter-14a525fce014b90b8a458a894818255a><a role=button></a></label><a href=https://docs.freebsd.org/mn/books/handbook/parti/>хэсэг I. Эхлэл</a></li><li><input type=checkbox id=chapter-f9c9f3451644df30d224350da97d5da6 class=toggle>
<label class="icon cursor" for=chapter-f9c9f3451644df30d224350da97d5da6><a role=button></a></label><a href=https://docs.freebsd.org/mn/books/handbook/introduction/>Бүлэг 1. Танилцуулга</a><ul><li><a href=https://docs.freebsd.org/mn/books/handbook/introduction/#introduction-synopsis>1.1. Ерөнхий агуулга</a></li><li><a href=https://docs.freebsd.org/mn/books/handbook/introduction/#nutshell>1.2. FreeBSD-д тавтай морилно уу!</a></li><li><a href=https://docs.freebsd.org/mn/books/handbook/introduction/#history>1.3. FreeBSD Төслийн тухай</a></li></ul></li><li><input type=checkbox id=chapter-f693a3fa687a72d63ec8129ee302d664 class=toggle>
<label class="icon cursor" for=chapter-f693a3fa687a72d63ec8129ee302d664><a role=button></a></label><a href=https://docs.freebsd.org/mn/books/handbook/bsdinstall/>Бүлэг 2. FreeBSD 9.X болон түүнээс хойшхи хувилбаруудыг суулгах нь</a><ul><li><a href=https://docs.freebsd.org/mn/books/handbook/bsdinstall/#bsdinstall-synopsis>2.1. Ерөнхий агуулга</a></li><li><a href=https://docs.freebsd.org/mn/books/handbook/bsdinstall/#bsdinstall-hardware>2.2. Тоног төхөөрөмжийн шаардлагууд</a></li><li><a href=https://docs.freebsd.org/mn/books/handbook/bsdinstall/#bsdinstall-pre>2.3. Суулгахын өмнөх ажлууд</a></li><li><a href=https://docs.freebsd.org/mn/books/handbook/bsdinstall/#bsdinstall-start>2.4. Суулгалтыг эхлүүлэх нь</a></li><li><a href=https://docs.freebsd.org/mn/books/handbook/bsdinstall/#using-bsdinstall>2.5. bsdinstall-г танилцуулах нь</a></li><li><a href=https://docs.freebsd.org/mn/books/handbook/bsdinstall/#bsdinstall-netinstall>2.6. Сүлжээнээс суулгах нь</a></li><li><a href=https://docs.freebsd.org/mn/books/handbook/bsdinstall/#bsdinstall-partitioning>2.7. Дискний зай авах нь</a></li><li><a href=https://docs.freebsd.org/mn/books/handbook/bsdinstall/#bsdinstall-final-warning>2.8. Суулгалтыг гүйцэтгэх нь</a></li><li><a href=https://docs.freebsd.org/mn/books/handbook/bsdinstall/#bsdinstall-post>2.9. Суулгасны дараах үйлдлүүд</a></li><li><a href=https://docs.freebsd.org/mn/books/handbook/bsdinstall/#bsdinstall-install-trouble>2.10. Асуудлыг олж засварлах</a></li><li><a href=https://docs.freebsd.org/mn/books/handbook/bsdinstall/#using-live-cd>2.11. Амьд CD ашиглах нь</a></li></ul></li><li><input type=checkbox id=chapter-6aaec170775233b7c45f6cdcfb70d466 class=toggle>
<label class="icon cursor" for=chapter-6aaec170775233b7c45f6cdcfb70d466><a role=button></a></label><a href=https://docs.freebsd.org/mn/books/handbook/install/>Бүлэг 3. FreeBSD 8.X болон түүнээс өмнөх хувилбар суулгах нь</a><ul><li><a href=https://docs.freebsd.org/mn/books/handbook/install/#install-synopsis>3.1. Ерөнхий агуулга</a></li><li><a href=https://docs.freebsd.org/mn/books/handbook/install/#install-hardware>3.2. Системд тавигдах төхөөрөмжийн шаардлага</a></li><li><a href=https://docs.freebsd.org/mn/books/handbook/install/#install-pre>3.3. Суулгацын өмнө</a></li><li><a href=https://docs.freebsd.org/mn/books/handbook/install/#install-start>3.4. Суулгацыг эхлүүлэх</a></li><li><a href=https://docs.freebsd.org/mn/books/handbook/install/#using-sysinstall>3.5. Sysinstall-н танилцуулга</a></li><li><a href=https://docs.freebsd.org/mn/books/handbook/install/#install-steps>3.6. Дискний зайг зохицуулах</a></li><li><a href=https://docs.freebsd.org/mn/books/handbook/install/#install-choosing>3.7. Юу суулгахаа сонгох</a></li><li><a href=https://docs.freebsd.org/mn/books/handbook/install/#install-media>3.8. Суулгацын төхөөрөмжөө сонгох</a></li><li><a href=https://docs.freebsd.org/mn/books/handbook/install/#install-final-warning>3.9. Суулгацыг баталж гүйцээх</a></li><li><a href=https://docs.freebsd.org/mn/books/handbook/install/#install-post>3.10. Суулгацын дараах тохиргоо</a></li><li><a href=https://docs.freebsd.org/mn/books/handbook/install/#install-trouble>3.11. Хүндрэл тулгарвал</a></li><li><a href=https://docs.freebsd.org/mn/books/handbook/install/#install-advanced>3.12. Суулгацын нэмэлт гарын авлага</a></li><li><a href=https://docs.freebsd.org/mn/books/handbook/install/#install-diff-media>3.13. Өөртөө зориулж тусгай суулгацын төхөөрөмж бэлдэх нь</a></li></ul></li><li><input type=checkbox id=chapter-9f6db261075f578742036fcc6000eecd class=toggle>
<label class="icon cursor" for=chapter-9f6db261075f578742036fcc6000eecd><a role=button></a></label><a href=https://docs.freebsd.org/mn/books/handbook/basics/>Бүлэг 4. Юниксийн үндэс</a><ul><li><a href=https://docs.freebsd.org/mn/books/handbook/basics/#basics-synopsis>4.1. Ерөнхий агуулга</a></li><li><a href=https://docs.freebsd.org/mn/books/handbook/basics/#consoles>4.2. Виртуал консол болон терминал</a></li><li><a href=https://docs.freebsd.org/mn/books/handbook/basics/#permissions>4.3. Зөвшөөрлүүд</a></li><li><a href=https://docs.freebsd.org/mn/books/handbook/basics/#dirstructure>4.4. Сангийн бүтэц</a></li><li><a href=https://docs.freebsd.org/mn/books/handbook/basics/#disk-organization>4.5. Диск зохион байгуулалт</a></li><li><a href=https://docs.freebsd.org/mn/books/handbook/basics/#mount-unmount>4.6. Файл системийг холбох болон салгах</a></li><li><a href=https://docs.freebsd.org/mn/books/handbook/basics/#basics-processes>4.7. Процесс буюу програмын явц</a></li><li><a href=https://docs.freebsd.org/mn/books/handbook/basics/#basics-daemons>4.8. Далд чөтгөр буюу дэмонууд, дохионууд, мөн процессуудыг зогсоох нь</a></li><li><a href=https://docs.freebsd.org/mn/books/handbook/basics/#shells>4.9. Shell буюу бүрхүүл</a></li><li><a href=https://docs.freebsd.org/mn/books/handbook/basics/#editors>4.10. Текст засварлагчид</a></li><li><a href=https://docs.freebsd.org/mn/books/handbook/basics/#basics-devices>4.11. Төхөөрөмж ба төхөөрөмжийн цэгүүд</a></li><li><a href=https://docs.freebsd.org/mn/books/handbook/basics/#binary-formats>4.12. Хоёртын хэлбэрүүд</a></li><li><a href=https://docs.freebsd.org/mn/books/handbook/basics/#basics-more-information>4.13. Нэмэлт мэдээлэл олж авах нь</a></li></ul></li><li><input type=checkbox id=chapter-01c5707e95d14c0ff84bf62600c958d1 class=toggle>
<label class="icon cursor" for=chapter-01c5707e95d14c0ff84bf62600c958d1><a role=button></a></label><a href=https://docs.freebsd.org/mn/books/handbook/ports/>Бүлэг 5. Програм суулгах: Багцууд болон портууд</a><ul><li><a href=https://docs.freebsd.org/mn/books/handbook/ports/#ports-synopsis>5.1. Ерөнхий агуулга</a></li><li><a href=https://docs.freebsd.org/mn/books/handbook/ports/#ports-overview>5.2. Програм суулгацын ерөнхий ойлголт</a></li><li><a href=https://docs.freebsd.org/mn/books/handbook/ports/#ports-finding-applications>5.3. Програмаа олох нь</a></li><li><a href=https://docs.freebsd.org/mn/books/handbook/ports/#packages-using>5.4. Багцалсан системийг хэрэглэх нь</a></li><li><a href=https://docs.freebsd.org/mn/books/handbook/ports/#pkgng-intro>5.5. pkgng-г бинар багцыг удирдахад ашиглах нь</a></li><li><a href=https://docs.freebsd.org/mn/books/handbook/ports/#ports-using>5.6. Портын цуглуулгыг хэрэглэх нь</a></li><li><a href=https://docs.freebsd.org/mn/books/handbook/ports/#ports-nextsteps>5.7. Порт суулгасны дараах үйлдлүүд</a></li><li><a href=https://docs.freebsd.org/mn/books/handbook/ports/#ports-broken>5.8. Эвдрэлтэй портыг засах нь</a></li></ul></li><li><input type=checkbox id=chapter-3405c00581365a8b5d16af70fe4d1b72 class=toggle>
<label class="icon cursor" for=chapter-3405c00581365a8b5d16af70fe4d1b72><a role=button></a></label><a href=https://docs.freebsd.org/mn/books/handbook/x11/>Бүлэг 6. X Цонхот систем</a><ul><li><a href=https://docs.freebsd.org/mn/books/handbook/x11/#x11-synopsis>6.1. Ерөнхий агуулга</a></li><li><a href=https://docs.freebsd.org/mn/books/handbook/x11/#x-understanding>6.2. X-г таньж мэдэх</a></li><li><a href=https://docs.freebsd.org/mn/books/handbook/x11/#x-install>6.3. X11-г суулгах нь</a></li><li><a href=https://docs.freebsd.org/mn/books/handbook/x11/#x-config>6.4. X11-н тохируулга</a></li><li><a href=https://docs.freebsd.org/mn/books/handbook/x11/#x-fonts>6.5. X11 дээр үсгийн маяг хэрэглэх нь</a></li><li><a href=https://docs.freebsd.org/mn/books/handbook/x11/#x-xdm>6.6. X Display Manager буюу харуулалт зохицуулагч</a></li><li><a href=https://docs.freebsd.org/mn/books/handbook/x11/#x11-wm>6.7. Дэлгэцийн орчин</a></li></ul></li><li><input type=checkbox id=chapter-0eab3565e8f59f5a8a896dfba7eb3680 class=toggle>
<label for=chapter-0eab3565e8f59f5a8a896dfba7eb3680><a role=button></a></label><a href=https://docs.freebsd.org/mn/books/handbook/partii/>хэсэг II. Нийтлэг асуудлууд</a></li><li><input type=checkbox id=chapter-b33cf28993f3f7bf5baf036e79da0f39 class=toggle>
<label class="icon cursor" for=chapter-b33cf28993f3f7bf5baf036e79da0f39><a role=button></a></label><a href=https://docs.freebsd.org/mn/books/handbook/desktop/>Бүлэг 7. Ширээний програмууд</a><ul><li><a href=https://docs.freebsd.org/mn/books/handbook/desktop/#desktop-synopsis>7.1. Ерөнхий агуулга</a></li><li><a href=https://docs.freebsd.org/mn/books/handbook/desktop/#desktop-browsers>7.2. Хөтчүүд</a></li><li><a href=https://docs.freebsd.org/mn/books/handbook/desktop/#desktop-productivity>7.3. Бүтээмж</a></li><li><a href=https://docs.freebsd.org/mn/books/handbook/desktop/#desktop-viewers>7.4. Бичиг баримт үзүүлэгчид</a></li><li><a href=https://docs.freebsd.org/mn/books/handbook/desktop/#desktop-finance>7.5. Санхүү</a></li><li><a href=https://docs.freebsd.org/mn/books/handbook/desktop/#desktop-summary>7.6. Дүгнэлт</a></li></ul></li><li><input type=checkbox id=chapter-152f694a19312ad72ec7bb4e1c3c33b2 class=toggle>
<label class="icon cursor" for=chapter-152f694a19312ad72ec7bb4e1c3c33b2><a role=button></a></label><a href=https://docs.freebsd.org/mn/books/handbook/multimedia/>Бүлэг 8. Мультимедиа</a><ul><li><a href=https://docs.freebsd.org/mn/books/handbook/multimedia/#multimedia-synopsis>8.1. Ерөнхий агуулга</a></li><li><a href=https://docs.freebsd.org/mn/books/handbook/multimedia/#sound-setup>8.2. Дууны картыг тохируулах</a></li><li><a href=https://docs.freebsd.org/mn/books/handbook/multimedia/#sound-mp3>8.3. MP3 аудио</a></li><li><a href=https://docs.freebsd.org/mn/books/handbook/multimedia/#video-playback>8.4. Видео тоглуулах</a></li><li><a href=https://docs.freebsd.org/mn/books/handbook/multimedia/#tvcard>8.5. ТВ картуудыг тохируулах</a></li><li><a href=https://docs.freebsd.org/mn/books/handbook/multimedia/#mythtv>8.6. MythTV</a></li><li><a href=https://docs.freebsd.org/mn/books/handbook/multimedia/#scanners>8.7. Дүрс скан хийгчид</a></li></ul></li><li><input type=checkbox id=chapter-80888b4ee02e3e409e5f71cf97a36450 class=toggle>
<label class="icon cursor" for=chapter-80888b4ee02e3e409e5f71cf97a36450><a role=button></a></label><a href=https://docs.freebsd.org/mn/books/handbook/kernelconfig/>Бүлэг 9. FreeBSD цөмийг тохируулах нь</a><ul><li><a href=https://docs.freebsd.org/mn/books/handbook/kernelconfig/#kernelconfig-synopsis>9.1. Ерөнхий агуулга</a></li><li><a href=https://docs.freebsd.org/mn/books/handbook/kernelconfig/#kernelconfig-custom-kernel>9.2. Яагаад өөрчлөн тохируулсан цөм бүтээх хэрэгтэй вэ?</a></li><li><a href=https://docs.freebsd.org/mn/books/handbook/kernelconfig/#kernelconfig-devices>9.3. Системийн тоног төхөөрөмж хайж олох нь</a></li><li><a href=https://docs.freebsd.org/mn/books/handbook/kernelconfig/#kernelconfig-modules>9.4. Цөмийн драйверууд, дэд системүүд, болон модулиуд</a></li><li><a href=https://docs.freebsd.org/mn/books/handbook/kernelconfig/#kernelconfig-building>9.5. Өөрчлөн тохируулсан цөмийг бүтээх ба суулгах нь</a></li><li><a href=https://docs.freebsd.org/mn/books/handbook/kernelconfig/#kernelconfig-config>9.6. Тохиргооны файл</a></li><li><a href=https://docs.freebsd.org/mn/books/handbook/kernelconfig/#kernelconfig-trouble>9.7. Хэрэв ямар нэг юм буруутвал</a></li></ul></li><li><input type=checkbox id=chapter-cb174c55879b17ab955f2f16989a79e0 class=toggle>
<label class="icon cursor" for=chapter-cb174c55879b17ab955f2f16989a79e0><a role=button></a></label><a href=https://docs.freebsd.org/mn/books/handbook/printing/>Бүлэг 10. Хэвлэлт</a><ul><li><a href=https://docs.freebsd.org/mn/books/handbook/printing/#printing-synopsis>10.1. Ерөнхий агуулга</a></li><li><a href=https://docs.freebsd.org/mn/books/handbook/printing/#printing-intro-spooler>10.2. Танилцуулга</a></li><li><a href=https://docs.freebsd.org/mn/books/handbook/printing/#printing-intro-setup>10.3. Үндсэн тохируулга</a></li><li><a href=https://docs.freebsd.org/mn/books/handbook/printing/#printing-advanced>10.4. Хэвлэгчийн илүү нарийн тохиргоо</a></li><li><a href=https://docs.freebsd.org/mn/books/handbook/printing/#printing-using>10.5. Хэвлэгчдийг ашиглах нь</a></li><li><a href=https://docs.freebsd.org/mn/books/handbook/printing/#printing-lpd-alternatives>10.6. Хэвлэгчийн стандарт түр хадгалагчидтай ижил хадгалагчид</a></li><li><a href=https://docs.freebsd.org/mn/books/handbook/printing/#printing-troubleshooting>10.7. Алдааг олж засварлах</a></li></ul></li><li><input type=checkbox id=chapter-c12b8c3f2a8fcefce87087241f695c83 class=toggle>
<label class="icon cursor" for=chapter-c12b8c3f2a8fcefce87087241f695c83><a role=button></a></label><a href=https://docs.freebsd.org/mn/books/handbook/linuxemu/>Бүлэг 11. Линуксийн Хоёртын Нийлэмж</a><ul><li><a href=https://docs.freebsd.org/mn/books/handbook/linuxemu/#linuxemu-synopsis>11.1. Ерөнхий агуулга</a></li><li><a href=https://docs.freebsd.org/mn/books/handbook/linuxemu/#linuxemu-lbc-install>11.2. Суулгалт</a></li><li><a href=https://docs.freebsd.org/mn/books/handbook/linuxemu/#linuxemu-mathematica>11.3. Mathematica® суулгах нь</a></li><li><a href=https://docs.freebsd.org/mn/books/handbook/linuxemu/#linuxemu-maple>11.4. Maple™ суулгах нь</a></li><li><a href=https://docs.freebsd.org/mn/books/handbook/linuxemu/#linuxemu-matlab>11.5. MATLAB® суулгах нь</a></li><li><a href=https://docs.freebsd.org/mn/books/handbook/linuxemu/#linuxemu-oracle>11.6. Oracle® суулгах нь</a></li><li><a href=https://docs.freebsd.org/mn/books/handbook/linuxemu/#linuxemu-advanced>11.7. Нэмэлт сэдвүүд</a></li></ul></li><li><input type=checkbox id=chapter-03b11ba627b9a0c85b247f5641bde272 class=toggle>
<label for=chapter-03b11ba627b9a0c85b247f5641bde272><a role=button></a></label><a href=https://docs.freebsd.org/mn/books/handbook/partiii/>хэсэг III. Системийн Удирдлага</a></li><li><input type=checkbox id=chapter-6c31587f8d736319f099cd4dc1961301 class=toggle>
<label class="icon cursor" for=chapter-6c31587f8d736319f099cd4dc1961301><a role=button></a></label><a href=https://docs.freebsd.org/mn/books/handbook/config/>Бүлэг 12. Тохиргоо ба Тааруулалт</a><ul><li><a href=https://docs.freebsd.org/mn/books/handbook/config/#config-synopsis>12.1. Ерөнхий агуулга</a></li><li><a href=https://docs.freebsd.org/mn/books/handbook/config/#configtuning-initial>12.2. Эхний Тохиргоо</a></li><li><a href=https://docs.freebsd.org/mn/books/handbook/config/#configtuning-core-configuration>12.3. Гол Тохиргоо</a></li><li><a href=https://docs.freebsd.org/mn/books/handbook/config/#configtuning-appconfig>12.4. Програмын Тохиргоо</a></li><li><a href=https://docs.freebsd.org/mn/books/handbook/config/#configtuning-starting-services>12.5. Үйлчилгээнүүдийг эхлүүлэх нь</a></li><li><a href=https://docs.freebsd.org/mn/books/handbook/config/#configtuning-cron>12.6. <code>cron</code> хэрэгслийг тохируулах нь</a></li><li><a href=https://docs.freebsd.org/mn/books/handbook/config/#configtuning-rcd>12.7. FreeBSD дээр rc(8) ашиглах нь</a></li><li><a href=https://docs.freebsd.org/mn/books/handbook/config/#config-network-setup>12.8. Сүлжээний интерфэйс картууд суулгах нь</a></li><li><a href=https://docs.freebsd.org/mn/books/handbook/config/#configtuning-virtual-hosts>12.9. Виртуал Хостууд</a></li><li><a href=https://docs.freebsd.org/mn/books/handbook/config/#configtuning-syslog>12.10. Системийн лог хийгч syslogd-г тохируулах нь</a></li><li><a href=https://docs.freebsd.org/mn/books/handbook/config/#configtuning-configfiles>12.11. Тохиргооны Файлууд</a></li><li><a href=https://docs.freebsd.org/mn/books/handbook/config/#configtuning-sysctl>12.12. sysctl(8) ашиглан тааруулах нь</a></li><li><a href=https://docs.freebsd.org/mn/books/handbook/config/#configtuning-disk>12.13. Дискнүүдийг тааруулах нь</a></li><li><a href=https://docs.freebsd.org/mn/books/handbook/config/#configtuning-kernel-limits>12.14. Цөмийн хязгаарууд тохируулах нь</a></li><li><a href=https://docs.freebsd.org/mn/books/handbook/config/#adding-swap-space>12.15. Swap зай нэмэх нь</a></li><li><a href=https://docs.freebsd.org/mn/books/handbook/config/#acpi-overview>12.16. Тэжээл болон Эх үүсвэрийн Удирдлага</a></li><li><a href=https://docs.freebsd.org/mn/books/handbook/config/#ACPI-debug>12.17. FreeBSD-ийн ACPI-г ашиглах нь ба дибаг хийх нь</a></li></ul></li><li><input type=checkbox id=chapter-459f0012b3b4f0b6b123010f029da5e4 class=toggle>
<label class="icon cursor" for=chapter-459f0012b3b4f0b6b123010f029da5e4><a role=button></a></label><a href=https://docs.freebsd.org/mn/books/handbook/boot/>Бүлэг 13. FreeBSD-ийн Ачаалах процесс</a><ul><li><a href=https://docs.freebsd.org/mn/books/handbook/boot/#boot-synopsis>13.1. Ерөнхий агуулга</a></li><li><a href=https://docs.freebsd.org/mn/books/handbook/boot/#boot-introduction>13.2. Ачаалалтын асуудал</a></li><li><a href=https://docs.freebsd.org/mn/books/handbook/boot/#boot-blocks>13.3. Ачаалагч Менежер болон Ачаалалтын шатууд</a></li><li><a href=https://docs.freebsd.org/mn/books/handbook/boot/#boot-kernel>13.4. Ачаалах үе дэх цөмийн харилцан үйлдэл</a></li><li><a href=https://docs.freebsd.org/mn/books/handbook/boot/#device-hints>13.5. Төхөөрөмжийн Сануулгууд</a></li><li><a href=https://docs.freebsd.org/mn/books/handbook/boot/#boot-init>13.6. Init: Процесс хяналтын эхлүүлэлт</a></li><li><a href=https://docs.freebsd.org/mn/books/handbook/boot/#boot-shutdown>13.7. Унтраах дараалал</a></li></ul></li><li><input type=checkbox id=chapter-d251c21b963b5ab783e5aec225e02b5a class=toggle>
<label class="icon cursor" for=chapter-d251c21b963b5ab783e5aec225e02b5a><a role=button></a></label><a href=https://docs.freebsd.org/mn/books/handbook/users/>Бүлэг 14. Хэрэглэгчид ба үндсэн бүртгэл зохицуулалт</a><ul><li><a href=https://docs.freebsd.org/mn/books/handbook/users/#users-synopsis>14.1. Ерөнхий агуулга</a></li><li><a href=https://docs.freebsd.org/mn/books/handbook/users/#users-introduction>14.2. Танилцуулга</a></li><li><a href=https://docs.freebsd.org/mn/books/handbook/users/#users-superuser>14.3. Супер хэрэглэгчийн бүртгэл</a></li><li><a href=https://docs.freebsd.org/mn/books/handbook/users/#users-system>14.4. Систем бүртгэл</a></li><li><a href=https://docs.freebsd.org/mn/books/handbook/users/#users-user>14.5. Энгийн хэрэглэгчийн бүртгэл</a></li><li><a href=https://docs.freebsd.org/mn/books/handbook/users/#users-modifying>14.6. Бүртгэлд өөрчлөлт хийх</a></li><li><a href=https://docs.freebsd.org/mn/books/handbook/users/#users-limiting>14.7. Хэрэглэгчдэд хязгаарлалт хийх</a></li><li><a href=https://docs.freebsd.org/mn/books/handbook/users/#users-groups>14.8. Бүлэг</a></li></ul></li><li><input type=checkbox id=chapter-917c75fcffbb14d48ed6d0a48e7028f2 class=toggle>
<label class="icon cursor" for=chapter-917c75fcffbb14d48ed6d0a48e7028f2><a role=button></a></label><a href=https://docs.freebsd.org/mn/books/handbook/security/>Бүлэг 15. Аюулгүй байдал</a><ul><li><a href=https://docs.freebsd.org/mn/books/handbook/security/#security-synopsis>15.1. Ерөнхий агуулга</a></li><li><a href=https://docs.freebsd.org/mn/books/handbook/security/#security-intro>15.2. Танилцуулга</a></li><li><a href=https://docs.freebsd.org/mn/books/handbook/security/#securing-freebsd>15.3. FreeBSD-н аюулгүй байдлыг хангах нь</a></li><li><a href=https://docs.freebsd.org/mn/books/handbook/security/#crypt>15.4. DES, Blowfish, MD5, SHA256, SHA512 болон Crypt</a></li><li><a href=https://docs.freebsd.org/mn/books/handbook/security/#one-time-passwords>15.5. Нэг удаагийн нууц үгүүд</a></li><li><a href=https://docs.freebsd.org/mn/books/handbook/security/#tcpwrappers>15.6. TCP Гүйцэтгэлийг хялбаршуулагчид</a></li><li><a href=https://docs.freebsd.org/mn/books/handbook/security/#kerberos5>15.7. Kerberos5</a></li><li><a href=https://docs.freebsd.org/mn/books/handbook/security/#openssl>15.8. OpenSSL</a></li><li><a href=https://docs.freebsd.org/mn/books/handbook/security/#ipsec>15.9. IPsec дээгүүр VPN хийх</a></li><li><a href=https://docs.freebsd.org/mn/books/handbook/security/#openssh>15.10. OpenSSH</a></li><li><a href=https://docs.freebsd.org/mn/books/handbook/security/#fs-acl>15.11. Файлын системийн хандалт хянах жагсаалтууд(ACL-үүд)</a></li><li><a href=https://docs.freebsd.org/mn/books/handbook/security/#security-portaudit>15.12. Гуравдагч талын аюулгүй байдлын асуудлуудыг монитор хийх нь</a></li><li><a href=https://docs.freebsd.org/mn/books/handbook/security/#security-advisories>15.13. FreeBSD-ийн аюулгүй байдлын зөвлөгөөнүүд</a></li><li><a href=https://docs.freebsd.org/mn/books/handbook/security/#security-accounting>15.14. Процессийн бүртгэл хөтлөх</a></li></ul></li><li><input type=checkbox id=chapter-1a2a8e719703649c2c66d99aa7a25fd4 class=toggle>
<label class="icon cursor" for=chapter-1a2a8e719703649c2c66d99aa7a25fd4><a role=button></a></label><a href=https://docs.freebsd.org/mn/books/handbook/jails/>Бүлэг 16. Jails буюу Шоронгууд</a><ul><li><a href=https://docs.freebsd.org/mn/books/handbook/jails/#jails-synopsis>16.1. Ерөнхий агуулга</a></li><li><a href=https://docs.freebsd.org/mn/books/handbook/jails/#jails-terms>16.2. Шоронгуудтай холбоотой ойлголтууд</a></li><li><a href=https://docs.freebsd.org/mn/books/handbook/jails/#jails-intro>16.3. Танилцуулга</a></li><li><a href=https://docs.freebsd.org/mn/books/handbook/jails/#jails-build>16.4. Шоронг үүсгэж хянах нь</a></li><li><a href=https://docs.freebsd.org/mn/books/handbook/jails/#jails-tuning>16.5. Нарийн тааруулалт болон удирдлага</a></li><li><a href=https://docs.freebsd.org/mn/books/handbook/jails/#jails-application>16.6. Шоронгийн хэрэглээ</a></li></ul></li><li><input type=checkbox id=chapter-8f4620c77e572cbb58917911a33c73cf class=toggle>
<label class="icon cursor" for=chapter-8f4620c77e572cbb58917911a33c73cf><a role=button></a></label><a href=https://docs.freebsd.org/mn/books/handbook/mac/>Бүлэг 17. Mandatory Access Control буюу Албадмал Хандалтын хяналт</a><ul><li><a href=https://docs.freebsd.org/mn/books/handbook/mac/#mac-synopsis>17.1. Ерөнхий агуулга</a></li><li><a href=https://docs.freebsd.org/mn/books/handbook/mac/#mac-inline-glossary>17.2. Энэ бүлэг дэх түлхүүр ухагдахуунууд</a></li><li><a href=https://docs.freebsd.org/mn/books/handbook/mac/#mac-initial>17.3. MAC-ийн тайлбар</a></li><li><a href=https://docs.freebsd.org/mn/books/handbook/mac/#mac-understandlabel>17.4. MAC хаяг/шошгонуудыг ойлгох нь</a></li><li><a href=https://docs.freebsd.org/mn/books/handbook/mac/#mac-planning>17.5. Аюулгүй байдлын тохиргоог төлөвлөх нь</a></li><li><a href=https://docs.freebsd.org/mn/books/handbook/mac/#mac-modules>17.6. Модулийн тохиргоо</a></li><li><a href=https://docs.freebsd.org/mn/books/handbook/mac/#mac-seeotheruids>17.7. MAC seeotheruids модуль</a></li><li><a href=https://docs.freebsd.org/mn/books/handbook/mac/#mac-bsdextended>17.8. MAC bsdextended модуль</a></li><li><a href=https://docs.freebsd.org/mn/books/handbook/mac/#mac-ifoff>17.9. MAC ifoff модуль</a></li><li><a href=https://docs.freebsd.org/mn/books/handbook/mac/#mac-portacl>17.10. MAC portacl модуль</a></li><li><a href=https://docs.freebsd.org/mn/books/handbook/mac/#mac-partition>17.11. MAC хуваалтын модуль</a></li><li><a href=https://docs.freebsd.org/mn/books/handbook/mac/#mac-mls>17.12. MAC олон түвшинт аюулгүй байдлын модуль</a></li><li><a href=https://docs.freebsd.org/mn/books/handbook/mac/#mac-biba>17.13. MAC Biba модуль</a></li><li><a href=https://docs.freebsd.org/mn/books/handbook/mac/#mac-lomac>17.14. MAC LOMAC модуль</a></li><li><a href=https://docs.freebsd.org/mn/books/handbook/mac/#mac-implementing>17.15. MAC Шорон дахь Nagios</a></li><li><a href=https://docs.freebsd.org/mn/books/handbook/mac/#mac-userlocked>17.16. Хэрэглэгчийг түгжих</a></li><li><a href=https://docs.freebsd.org/mn/books/handbook/mac/#mac-troubleshoot>17.17. MAC Тогтолцооны алдааг олж засварлах</a></li></ul></li><li><input type=checkbox id=chapter-9598d66a76cb3182057b6bcd775149a0 class=toggle>
<label class="icon cursor" for=chapter-9598d66a76cb3182057b6bcd775149a0><a role=button></a></label><a href=https://docs.freebsd.org/mn/books/handbook/audit/>Бүлэг 18. Аюулгүй байдлын үйл явцад аудит хийх нь</a><ul><li><a href=https://docs.freebsd.org/mn/books/handbook/audit/#audit-synopsis>18.1. Ерөнхий агуулга</a></li><li><a href=https://docs.freebsd.org/mn/books/handbook/audit/#audit-inline-glossary>18.2. Энэ бүлгийн түлхүүр ухагдахуунууд</a></li><li><a href=https://docs.freebsd.org/mn/books/handbook/audit/#audit-install>18.3. Аудит хийх дэмжлэг суулгах нь</a></li><li><a href=https://docs.freebsd.org/mn/books/handbook/audit/#audit-config>18.4. Аудитийн тохиргоо</a></li><li><a href=https://docs.freebsd.org/mn/books/handbook/audit/#audit-administration>18.5. Аудит дэд системийг удирдах нь</a></li></ul></li><li><input type=checkbox id=chapter-e1edcad13d9db6e8e4cb645d378ecfaf class=toggle>
<label class="icon cursor" for=chapter-e1edcad13d9db6e8e4cb645d378ecfaf><a role=button></a></label><a href=https://docs.freebsd.org/mn/books/handbook/disks/>Бүлэг 19. Хадгалалт</a><ul><li><a href=https://docs.freebsd.org/mn/books/handbook/disks/#disks-synopsis>19.1. Ерөнхий агуулга</a></li><li><a href=https://docs.freebsd.org/mn/books/handbook/disks/#disks-naming>19.2. Төхөөрөмжийн нэрс</a></li><li><a href=https://docs.freebsd.org/mn/books/handbook/disks/#disks-adding>19.3. Диск нэмэх</a></li><li><a href=https://docs.freebsd.org/mn/books/handbook/disks/#raid>19.4. RAID</a></li><li><a href=https://docs.freebsd.org/mn/books/handbook/disks/#usb-disks>19.5. USB хадгалалтын төхөөрөмжүүд</a></li><li><a href=https://docs.freebsd.org/mn/books/handbook/disks/#creating-cds>19.6. Оптик зөөвөрлөгчийг (CD-үүд) үүсгэж ашиглах нь</a></li><li><a href=https://docs.freebsd.org/mn/books/handbook/disks/#creating-dvds>19.7. Оптик зөөвөрлөгчийг (DVD-үүд) үүсгэж ашиглах нь</a></li><li><a href=https://docs.freebsd.org/mn/books/handbook/disks/#floppies>19.8. Уян дискнүүдийг үүсгэж ашиглах нь</a></li><li><a href=https://docs.freebsd.org/mn/books/handbook/disks/#backups-tapebackups>19.9. Өгөгдлийн соронзон хальснууд үүсгэж ашиглах нь</a></li><li><a href=https://docs.freebsd.org/mn/books/handbook/disks/#backups-floppybackups>19.10. Уян диск уруу нөөцлөх</a></li><li><a href=https://docs.freebsd.org/mn/books/handbook/disks/#backup-strategies>19.11. Нөөцлөх стратегууд</a></li><li><a href=https://docs.freebsd.org/mn/books/handbook/disks/#backup-basics>19.12. Нөөцлөлтийн үндсүүд</a></li><li><a href=https://docs.freebsd.org/mn/books/handbook/disks/#disks-virtual>19.13. Сүлжээ, санах ой болон файл дээр тулгуурласан файлын системүүд</a></li><li><a href=https://docs.freebsd.org/mn/books/handbook/disks/#snapshots>19.14. Файлын системийн хормын хувилбарууд</a></li><li><a href=https://docs.freebsd.org/mn/books/handbook/disks/#quotas>19.15. Файлын системийн ноогдлууд</a></li><li><a href=https://docs.freebsd.org/mn/books/handbook/disks/#disks-encrypting>19.16. Дискний хуваалтуудыг шифрлэх нь</a></li><li><a href=https://docs.freebsd.org/mn/books/handbook/disks/#swap-encrypting>19.17. Swap зайг шифрлэх</a></li><li><a href=https://docs.freebsd.org/mn/books/handbook/disks/#disks-hast>19.18. Highly Available Storage (HAST)</a></li></ul></li><li><input type=checkbox id=chapter-dde37901a0e0ea32745b67607854900f class=toggle>
<label class="icon cursor" for=chapter-dde37901a0e0ea32745b67607854900f><a role=button></a></label><a href=https://docs.freebsd.org/mn/books/handbook/geom/>Κεφάλαιο 20. GEOM: Διαχείριση Συστοιχιών Δίσκων</a><ul><li><a href=https://docs.freebsd.org/mn/books/handbook/geom/#GEOM-synopsis>20.1. Ерөнхий агуулга</a></li><li><a href=https://docs.freebsd.org/mn/books/handbook/geom/#GEOM-intro>20.2. GEOM-ийн Танилцуулга</a></li><li><a href=https://docs.freebsd.org/mn/books/handbook/geom/#GEOM-striping>20.3. RAID0 - Судал үүсгэх</a></li><li><a href=https://docs.freebsd.org/mn/books/handbook/geom/#GEOM-mirror>20.4. RAID1 - Толин тусгал үүсгэх</a></li><li><a href=https://docs.freebsd.org/mn/books/handbook/geom/#GEOM-raid3>20.5. RAID3 - Parity бүхий байтын түвшний тусдаа судалжуулалт (Striping)</a></li><li><a href=https://docs.freebsd.org/mn/books/handbook/geom/#geom-ggate>20.6. GEOM Хаалга Сүлжээний Төхөөрөмжүүд</a></li><li><a href=https://docs.freebsd.org/mn/books/handbook/geom/#geom-glabel>20.7. Дискний төхөөрөмжүүдийг хаяглах нь</a></li><li><a href=https://docs.freebsd.org/mn/books/handbook/geom/#geom-gjournal>20.8. GEOM-ийн тусламжтай UFS тэмдэглэл</a></li></ul></li><li><input type=checkbox id=chapter-7af71270807eb7b70cd3eedc6577b254 class=toggle>
<label class="icon cursor" for=chapter-7af71270807eb7b70cd3eedc6577b254><a role=button></a></label><a href=https://docs.freebsd.org/mn/books/handbook/filesystems/>Бүлэг 21. Файлын системийн дэмжлэг</a><ul><li><a href=https://docs.freebsd.org/mn/books/handbook/filesystems/#filesystems-synopsis>21.1. Ерөнхий агуулга</a></li><li><a href=https://docs.freebsd.org/mn/books/handbook/filesystems/#filesystems-zfs>21.2. Z Файлын Систем (ZFS)</a></li><li><a href=https://docs.freebsd.org/mn/books/handbook/filesystems/#filesystems-linux>21.3. Linux® файлын системүүд</a></li></ul></li><li><input type=checkbox id=chapter-dcd5a59a66ab6bff19287ccc6a33fd7e class=toggle>
<label class="icon cursor" for=chapter-dcd5a59a66ab6bff19287ccc6a33fd7e><a role=button></a></label><a href=https://docs.freebsd.org/mn/books/handbook/vinum/>Бүлэг 22. Vinum Эзлэхүүн Менежер</a><ul><li><a href=https://docs.freebsd.org/mn/books/handbook/vinum/#vinum-synopsis>22.1. Ерөнхий агуулга</a></li><li><a href=https://docs.freebsd.org/mn/books/handbook/vinum/#vinum-intro>22.2. Дискнүүд хэтэрхий жижиг</a></li><li><a href=https://docs.freebsd.org/mn/books/handbook/vinum/#vinum-access-bottlenecks>22.3. Хандалтын тагларалтууд</a></li><li><a href=https://docs.freebsd.org/mn/books/handbook/vinum/#vinum-data-integrity>22.4. Өгөгдлийн бүрэн бүтэн байдал</a></li><li><a href=https://docs.freebsd.org/mn/books/handbook/vinum/#vinum-objects>22.5. Vinum обьектууд</a></li><li><a href=https://docs.freebsd.org/mn/books/handbook/vinum/#vinum-examples>22.6. Зарим жишээнүүд</a></li><li><a href=https://docs.freebsd.org/mn/books/handbook/vinum/#vinum-object-naming>22.7. Обьектийн нэрлэлт</a></li><li><a href=https://docs.freebsd.org/mn/books/handbook/vinum/#vinum-config>22.8. Vinum тохируулах нь</a></li><li><a href=https://docs.freebsd.org/mn/books/handbook/vinum/#vinum-root>22.9. Root файлын системийн хувьд Vinum-ийг ашиглах нь</a></li></ul></li><li><input type=checkbox id=chapter-375257268d95faaf87faf4f7a2e6aa67 class=toggle>
<label class="icon cursor" for=chapter-375257268d95faaf87faf4f7a2e6aa67><a role=button></a></label><a href=https://docs.freebsd.org/mn/books/handbook/virtualization/>Бүлэг 23. Виртуалчлал</a><ul><li><a href=https://docs.freebsd.org/mn/books/handbook/virtualization/#virtualization-synopsis>23.1. Ерөнхий агуулга</a></li><li><a href=https://docs.freebsd.org/mn/books/handbook/virtualization/#virtualization-guest>23.2. FreeBSD-г зочин OS маягаар ашиглах</a></li><li><a href=https://docs.freebsd.org/mn/books/handbook/virtualization/#virtualization-host>23.3. FreeBSD-г хост буюу эх маягаар ашиглах</a></li></ul></li><li><input type=checkbox id=chapter-49f1e96591c090304ea532012257f4ef class=toggle>
<label class="icon cursor" for=chapter-49f1e96591c090304ea532012257f4ef><a role=button></a></label><a href=https://docs.freebsd.org/mn/books/handbook/l10n/>Бүлэг 24. Локалчлал - I18N/L10N-ийн хэрэглээ болон тохируулга</a><ul><li><a href=https://docs.freebsd.org/mn/books/handbook/l10n/#l10n-synopsis>24.1. Ерөнхий агуулга</a></li><li><a href=https://docs.freebsd.org/mn/books/handbook/l10n/#l10n-basics>24.2. Үндсүүд</a></li><li><a href=https://docs.freebsd.org/mn/books/handbook/l10n/#using-localization>24.3. Локалчлалыг ашиглах нь</a></li><li><a href=https://docs.freebsd.org/mn/books/handbook/l10n/#l10n-compiling>24.4. I18N програмуудыг эмхэтгэх</a></li><li><a href=https://docs.freebsd.org/mn/books/handbook/l10n/#lang-setup>24.5. FreeBSD-г өөр хэлнүүд уруу локалчлах</a></li></ul></li><li><input type=checkbox id=chapter-dead2b4c5ea325dd390a9b0dccd8f763 class=toggle>
<label class="icon cursor" for=chapter-dead2b4c5ea325dd390a9b0dccd8f763><a role=button></a></label><a href=https://docs.freebsd.org/mn/books/handbook/cutting-edge/>Бүлэг 25. FreeBSD-г шинэчилж сайжруулах нь</a><ul><li><a href=https://docs.freebsd.org/mn/books/handbook/cutting-edge/#updating-upgrading-synopsis>25.1. Ерөнхий агуулга</a></li><li><a href=https://docs.freebsd.org/mn/books/handbook/cutting-edge/#updating-upgrading-freebsdupdate>25.2. FreeBSD-ийн шинэчлэлт</a></li><li><a href=https://docs.freebsd.org/mn/books/handbook/cutting-edge/#updating-upgrading-portsnap>25.3. Portsnap: Портын цуглуулгыг шинэчлэх хэрэгсэл</a></li><li><a href=https://docs.freebsd.org/mn/books/handbook/cutting-edge/#updating-upgrading-documentation>25.4. Баримтын цуглуулгыг шинэчлэх нь</a></li><li><a href=https://docs.freebsd.org/mn/books/handbook/cutting-edge/#current-stable>25.5. Хөгжүүлэлтийн салбарыг дагах нь</a></li><li><a href=https://docs.freebsd.org/mn/books/handbook/cutting-edge/#synching>25.6. Өөрийн эхийг хамгийн сүүлийн хэлбэрт аваачих нь</a></li><li><a href=https://docs.freebsd.org/mn/books/handbook/cutting-edge/#makeworld>25.7. "Ертөнц"ийг дахин бүтээх нь</a></li><li><a href=https://docs.freebsd.org/mn/books/handbook/cutting-edge/#make-delete-old>25.8. Хуучин файлууд, хавтаснууд болон сангуудыг устгах</a></li><li><a href=https://docs.freebsd.org/mn/books/handbook/cutting-edge/#small-lan>25.9. Олон машины хувьд дагах нь</a></li></ul></li><li><input type=checkbox id=chapter-29c1eeb0e9dedc487a98399e2737ee8a class=toggle>
<label class="icon cursor" for=chapter-29c1eeb0e9dedc487a98399e2737ee8a><a role=button></a></label><a href=https://docs.freebsd.org/mn/books/handbook/dtrace/>Бүлэг 26. DTrace</a><ul><li><a href=https://docs.freebsd.org/mn/books/handbook/dtrace/#dtrace-synopsis>26.1. Ерөнхий агуулга</a></li><li><a href=https://docs.freebsd.org/mn/books/handbook/dtrace/#dtrace-implementation>26.2. Шийдлийн ялгаанууд</a></li><li><a href=https://docs.freebsd.org/mn/books/handbook/dtrace/#dtrace-enable>26.3. DTrace дэмжлэгийг идэвхжүүлэх</a></li><li><a href=https://docs.freebsd.org/mn/books/handbook/dtrace/#dtrace-using>26.4. DTrace-г ашиглах</a></li><li><a href=https://docs.freebsd.org/mn/books/handbook/dtrace/#dtrace-language>26.5. D хэл</a></li></ul></li><li><input type=checkbox id=chapter-bbd25f9a194f9c39ca2d658c75767db5 class=toggle>
<label for=chapter-bbd25f9a194f9c39ca2d658c75767db5><a role=button></a></label><a href=https://docs.freebsd.org/mn/books/handbook/partiv/>хэсэг IV. Сүлжээний Холболт</a></li><li><input type=checkbox id=chapter-499dab596afd7ddac77e80295314e0dd class=toggle>
<label class="icon cursor" for=chapter-499dab596afd7ddac77e80295314e0dd><a role=button></a></label><a href=https://docs.freebsd.org/mn/books/handbook/serialcomms/>Бүлэг 27. Цуваа холбоонууд</a><ul><li><a href=https://docs.freebsd.org/mn/books/handbook/serialcomms/#serial-synopsis>27.1. Ерөнхий агуулга</a></li><li><a href=https://docs.freebsd.org/mn/books/handbook/serialcomms/#serial>27.2. Танилцуулга</a></li><li><a href=https://docs.freebsd.org/mn/books/handbook/serialcomms/#term>27.3. Терминалууд</a></li><li><a href=https://docs.freebsd.org/mn/books/handbook/serialcomms/#dialup>27.4. Dial-in буюу гаднаас залгах үйлчилгээ</a></li><li><a href=https://docs.freebsd.org/mn/books/handbook/serialcomms/#dialout>27.5. Dial-out буюу гадагш залгах үйлчилгээ</a></li><li><a href=https://docs.freebsd.org/mn/books/handbook/serialcomms/#serialconsole-setup>27.6. Цуваа консолыг тохируулах нь</a></li></ul></li><li><input type=checkbox id=chapter-95e4571c48bee1cced5e84a538d302e3 class=toggle>
<label class="icon cursor" for=chapter-95e4571c48bee1cced5e84a538d302e3><a role=button></a></label><a href=https://docs.freebsd.org/mn/books/handbook/ppp-and-slip/>Бүлэг 28. PPP болон SLIP</a><ul><li><a href=https://docs.freebsd.org/mn/books/handbook/ppp-and-slip/#ppp-and-slip-synopsis>28.1. Ерөнхий агуулга</a></li><li><a href=https://docs.freebsd.org/mn/books/handbook/ppp-and-slip/#userppp>28.2. Хэрэглэгчийн PPP ашиглах</a></li><li><a href=https://docs.freebsd.org/mn/books/handbook/ppp-and-slip/#ppp>28.3. Цөмийн PPP-г ашиглах</a></li><li><a href=https://docs.freebsd.org/mn/books/handbook/ppp-and-slip/#ppp-troubleshoot>28.4. PPP холболтуудын алдааг олж засварлах</a></li><li><a href=https://docs.freebsd.org/mn/books/handbook/ppp-and-slip/#pppoe>28.5. Ethernet дээгүүр PPP ашиглах нь (PPPoE)</a></li><li><a href=https://docs.freebsd.org/mn/books/handbook/ppp-and-slip/#pppoa>28.6. ATM дээгүүр PPP (PPPoA) ашиглах</a></li><li><a href=https://docs.freebsd.org/mn/books/handbook/ppp-and-slip/#slip>28.7. SLIP ашиглах</a></li></ul></li><li><input type=checkbox id=chapter-f089ac726c401c9b4bd5c34a295e11bb class=toggle>
<label class="icon cursor" for=chapter-f089ac726c401c9b4bd5c34a295e11bb><a role=button></a></label><a href=https://docs.freebsd.org/mn/books/handbook/mail/>Бүлэг 29. Цахим Шуудан</a><ul><li><a href=https://docs.freebsd.org/mn/books/handbook/mail/#mail-synopsis>29.1. Ерөнхий Агуулга</a></li><li><a href=https://docs.freebsd.org/mn/books/handbook/mail/#mail-using>29.2. Цахим Захидлыг Хэрэглэх нь</a></li><li><a href=https://docs.freebsd.org/mn/books/handbook/mail/#sendmail>29.3. sendmail-г Тохируулах нь</a></li><li><a href=https://docs.freebsd.org/mn/books/handbook/mail/#mail-changingmta>29.4. Өөрийн Захидал Дамжуулах Агентийг Солих нь</a></li><li><a href=https://docs.freebsd.org/mn/books/handbook/mail/#mail-trouble>29.5. Гэмтэл саатлыг арилгах нь</a></li><li><a href=https://docs.freebsd.org/mn/books/handbook/mail/#mail-advanced>29.6. Дээд түвшний сэдвүүд</a></li><li><a href=https://docs.freebsd.org/mn/books/handbook/mail/#SMTP-UUCP>29.7. UUCP-тэй SMTP</a></li><li><a href=https://docs.freebsd.org/mn/books/handbook/mail/#outgoing-only>29.8. Зөвхөн илгээхээр тохируулах нь</a></li><li><a href=https://docs.freebsd.org/mn/books/handbook/mail/#SMTP-dialup>29.9. Гадагш залгах холболтоор захидлыг ашиглах нь</a></li><li><a href=https://docs.freebsd.org/mn/books/handbook/mail/#SMTP-Auth>29.10. SMTP нэвтрэлт танилт</a></li><li><a href=https://docs.freebsd.org/mn/books/handbook/mail/#mail-agents>29.11. Хэрэглэгчийн захидал дамжуулагчид</a></li><li><a href=https://docs.freebsd.org/mn/books/handbook/mail/#mail-fetchmail>29.12. fetchmail-г ашиглах нь</a></li><li><a href=https://docs.freebsd.org/mn/books/handbook/mail/#mail-procmail>29.13. procmail-г ашиглах нь</a></li></ul></li><li><input type=checkbox id=chapter-6de4de3fe925639d4175ce4b6f8c1829 class=toggle>
<label class="icon cursor" for=chapter-6de4de3fe925639d4175ce4b6f8c1829><a role=button></a></label><a href=https://docs.freebsd.org/mn/books/handbook/network-servers/>Бүлэг 30. Сүлжээний орчны Серверүүд</a><ul><li><a href=https://docs.freebsd.org/mn/books/handbook/network-servers/#network-servers-synopsis>30.1. Ерөнхий агуулга</a></li><li><a href=https://docs.freebsd.org/mn/books/handbook/network-servers/#network-inetd>30.2. inetd"Супер-Сервер"</a></li><li><a href=https://docs.freebsd.org/mn/books/handbook/network-servers/#network-nfs>30.3. Сүлжээний Файлын Систем (NFS)</a></li><li><a href=https://docs.freebsd.org/mn/books/handbook/network-servers/#network-nis>30.4. Сүлжээний Мэдээллийн Систем (NIS/YP)</a></li><li><a href=https://docs.freebsd.org/mn/books/handbook/network-servers/#network-dhcp>30.5. Автомат Сүлжээний Тохиргоо (DHCP)</a></li><li><a href=https://docs.freebsd.org/mn/books/handbook/network-servers/#network-dns>30.6. Домэйн Нэрийн Систем (DNS)</a></li><li><a href=https://docs.freebsd.org/mn/books/handbook/network-servers/#network-apache>30.7. Apache HTTP Сервер</a></li><li><a href=https://docs.freebsd.org/mn/books/handbook/network-servers/#network-ftp>30.8. Файл Дамжуулах Протокол (FTP)</a></li><li><a href=https://docs.freebsd.org/mn/books/handbook/network-servers/#network-samba>30.9. Microsoft® Windows® харилцагчдад зориулсан Файл болон Хэвлэх Үйлчилгээ (Samba)</a></li><li><a href=https://docs.freebsd.org/mn/books/handbook/network-servers/#network-ntp>30.10. ntpd-р Цаг Тааруулах нь</a></li><li><a href=https://docs.freebsd.org/mn/books/handbook/network-servers/#network-syslogd>30.11. <code>syslogd</code> ашиглан алсын хост руу бүртгэх нь</a></li></ul></li><li><input type=checkbox id=chapter-776d855c7b75e048f90b5c2c9b35ffe0 class=toggle checked>
<label class="icon cursor" for=chapter-776d855c7b75e048f90b5c2c9b35ffe0><a role=button></a></label><a href=https://docs.freebsd.org/mn/books/handbook/firewalls/>Бүлэг 31. Галт хана</a><ul><li><a href=https://docs.freebsd.org/mn/books/handbook/firewalls/#firewalls-intro>31.1. Танилцуулга</a></li><li><a href=https://docs.freebsd.org/mn/books/handbook/firewalls/#firewalls-concepts>31.2. Галт ханын тухай ойлголтууд</a></li><li><a href=https://docs.freebsd.org/mn/books/handbook/firewalls/#firewalls-apps>31.3. Галт ханын багцууд</a></li><li><a href=https://docs.freebsd.org/mn/books/handbook/firewalls/#firewalls-pf>31.4. OpenBSD Пакет шүүгч (PF) ба ALTQ</a></li><li><a href=https://docs.freebsd.org/mn/books/handbook/firewalls/#firewalls-ipf>31.5. IPFILTER (IPF) Галт хана</a></li><li><a href=https://docs.freebsd.org/mn/books/handbook/firewalls/#firewalls-ipfw>31.6. IPFW</a></li></ul></li><li><input type=checkbox id=chapter-5b07f776a0e6155c1c89aa0d15610380 class=toggle>
<label class="icon cursor" for=chapter-5b07f776a0e6155c1c89aa0d15610380><a role=button></a></label><a href=https://docs.freebsd.org/mn/books/handbook/advanced-networking/>Бүлэг 32. Сүлжээний нэмэлт ойлголтууд</a><ul><li><a href=https://docs.freebsd.org/mn/books/handbook/advanced-networking/#advanced-networking-synopsis>32.1. Ерөнхий агуулга</a></li><li><a href=https://docs.freebsd.org/mn/books/handbook/advanced-networking/#network-routing>32.2. Гарцууд болон Чиглүүлэлтүүд</a></li><li><a href=https://docs.freebsd.org/mn/books/handbook/advanced-networking/#network-wireless>32.3. Утасгүй сүлжээ</a></li><li><a href=https://docs.freebsd.org/mn/books/handbook/advanced-networking/#network-bluetooth>32.4. Bluetooth</a></li><li><a href=https://docs.freebsd.org/mn/books/handbook/advanced-networking/#network-bridging>32.5. Гүүр</a></li><li><a href=https://docs.freebsd.org/mn/books/handbook/advanced-networking/#network-aggregation>32.6. Холбоос нэгтгэлт ба ослыг тойрон гарах (Link Aggregation and Failover)</a></li><li><a href=https://docs.freebsd.org/mn/books/handbook/advanced-networking/#network-diskless>32.7. Дискгүй ажиллагаа</a></li><li><a href=https://docs.freebsd.org/mn/books/handbook/advanced-networking/#network-pxe-nfs>32.8. NFS root файлын систем ашиглан PXE ачаалалт хийх</a></li><li><a href=https://docs.freebsd.org/mn/books/handbook/advanced-networking/#network-isdn>32.9. ISDN</a></li><li><a href=https://docs.freebsd.org/mn/books/handbook/advanced-networking/#network-natd>32.10. Network Address Translation буюу Сүлжээний Хаягийн Хөрвүүлэлт</a></li><li><a href=https://docs.freebsd.org/mn/books/handbook/advanced-networking/#network-ipv6>32.11. IPv6</a></li><li><a href=https://docs.freebsd.org/mn/books/handbook/advanced-networking/#network-atm>32.12. Asynchronous Transfer Mode (ATM) буюу Асинхрон Дамжуулах Горим</a></li><li><a href=https://docs.freebsd.org/mn/books/handbook/advanced-networking/#carp>32.13. Common Address Redundancy Protocol (CARP)</a></li></ul></li><li><input type=checkbox id=chapter-171a77aa9d067a1024f849470e1f33e8 class=toggle>
<label for=chapter-171a77aa9d067a1024f849470e1f33e8><a role=button></a></label><a href=https://docs.freebsd.org/mn/books/handbook/partv/>хэсэг V. Хавсралтууд</a></li><li><input type=checkbox id=chapter-8050f436a0a7986a4aaded93d8e49469 class=toggle>
<label class="icon cursor" for=chapter-8050f436a0a7986a4aaded93d8e49469><a role=button></a></label><a href=https://docs.freebsd.org/mn/books/handbook/mirrors/>Хавсралт A. FreeBSD-г олж авах нь</a><ul><li><a href=https://docs.freebsd.org/mn/books/handbook/mirrors/#mirrors-cdrom>A.1. CDROM болон DVD Нийтлэгчид</a></li><li><a href=https://docs.freebsd.org/mn/books/handbook/mirrors/#mirrors-ftp>A.2. FTP сайтууд</a></li><li><a href=https://docs.freebsd.org/mn/books/handbook/mirrors/#anoncvs>A.3. Нэргүй CVS(хуучирсан)</a></li><li><a href=https://docs.freebsd.org/mn/books/handbook/mirrors/#ctm>A.4. CTM-г ашиглах нь</a></li><li><a href=https://docs.freebsd.org/mn/books/handbook/mirrors/#svn>A.5. Subversion ашиглах нь</a></li><li><a href=https://docs.freebsd.org/mn/books/handbook/mirrors/#svn-mirrors>A.6. Subversion толин сайтууд</a></li><li><a href=https://docs.freebsd.org/mn/books/handbook/mirrors/#cvsup>A.7. CVSup-г ашиглах нь (хуучирсан)</a></li><li><a href=https://docs.freebsd.org/mn/books/handbook/mirrors/#cvs-tags>A.8. CVS Tags буюу хаягууд</a></li><li><a href=https://docs.freebsd.org/mn/books/handbook/mirrors/#mirrors-rsync>A.9. rsync сайтууд</a></li></ul></li><li><input type=checkbox id=chapter-128b630a8f88f158e7027fe6c2184d21 class=toggle>
<label class="icon cursor" for=chapter-128b630a8f88f158e7027fe6c2184d21><a role=button></a></label><a href=https://docs.freebsd.org/mn/books/handbook/bibliography/>Хавсралт B. Ном зүй</a><ul><li><a href=https://docs.freebsd.org/mn/books/handbook/bibliography/#bibliography-freebsd>B.1. FreeBSD-ийн талаар тусгайлан бичсэн ном & сэтгүүлүүд</a></li><li><a href=https://docs.freebsd.org/mn/books/handbook/bibliography/#bibliography-userguides>B.2. Хэрэглэгчдийн гарын авлагууд</a></li><li><a href=https://docs.freebsd.org/mn/books/handbook/bibliography/#bibliography-adminguides>B.3. Администраторууд зориулсан зааврууд</a></li><li><a href=https://docs.freebsd.org/mn/books/handbook/bibliography/#bibliography-programmers>B.4. Програм зохиогчдод зориулсан зааврууд</a></li><li><a href=https://docs.freebsd.org/mn/books/handbook/bibliography/#bibliography-osinternals>B.5. Үйлдлийн системийн дотоод бүрэлдэхүүнүүдийн талаар</a></li><li><a href=https://docs.freebsd.org/mn/books/handbook/bibliography/#bibliography-security>B.6. Аюулгүй байдлын тухай номнууд</a></li><li><a href=https://docs.freebsd.org/mn/books/handbook/bibliography/#bibliography-hardware>B.7. Тоног төхөөрөмжийн тухай номнууд</a></li><li><a href=https://docs.freebsd.org/mn/books/handbook/bibliography/#bibliography-history>B.8. UNIX®-ийн түүх</a></li><li><a href=https://docs.freebsd.org/mn/books/handbook/bibliography/#bibliography-journals>B.9. Сонин, сэтгүүлүүд</a></li></ul></li><li><input type=checkbox id=chapter-8bbb8867c46dac315e2253945d8c18a8 class=toggle>
<label class="icon cursor" for=chapter-8bbb8867c46dac315e2253945d8c18a8><a role=button></a></label><a href=https://docs.freebsd.org/mn/books/handbook/eresources/>Хавсралт C. Интернэт дэх эх үүсвэрүүд</a><ul><li><a href=https://docs.freebsd.org/mn/books/handbook/eresources/#eresources-mail>C.1. Захидлын жагсаалтууд</a></li><li><a href=https://docs.freebsd.org/mn/books/handbook/eresources/#eresources-news>C.2. Usenet Newsgroups буюу мэдээний бүлгүүд</a></li><li><a href=https://docs.freebsd.org/mn/books/handbook/eresources/#eresources-web>C.3. Word Wide Web серверүүд</a></li><li><a href=https://docs.freebsd.org/mn/books/handbook/eresources/#eresources-email>C.4. Цахим захидлын хаягууд</a></li></ul></li><li><input type=checkbox id=chapter-a80ea4f5a4480b8725422710f954ef36 class=toggle>
<label class="icon cursor" for=chapter-a80ea4f5a4480b8725422710f954ef36><a role=button></a></label><a href=https://docs.freebsd.org/mn/books/handbook/pgpkeys/>Хавсралт D. PGP түлхүүрүүд</a><ul><li><a href=https://docs.freebsd.org/mn/books/handbook/pgpkeys/#pgpkeys-officers>D.1. Officers</a></li></ul></li><li></li></ul></nav></div></aside><div class=book><div class=book-menu-mobile><label for=menu-control><span class=menu-control-button><i class="fa fa-list" aria-hidden=true title="Book menu"></i>
Book menu</span></label></div><h1 class=title>Бүлэг 31. Галт хана</h1><div class="admonitionblock note"><p><i class="fa fa-exclamation-circle" aria-hidden=true></i>
This translation may be out of date. To help with the translations please access the <a href=https://translate-dev.freebsd.org/ target=_blank>FreeBSD translations instance</a>.</p></div><div class=toc-mobile><h3>Table of Contents</h3><nav id=TableOfContents><ul><li><a href=#firewalls-intro>31.1. Танилцуулга</a></li><li><a href=#firewalls-concepts>31.2. Галт ханын тухай ойлголтууд</a></li><li><a href=#firewalls-apps>31.3. Галт ханын багцууд</a></li><li><a href=#firewalls-pf>31.4. OpenBSD Пакет шүүгч (PF) ба ALTQ</a></li><li><a href=#firewalls-ipf>31.5. IPFILTER (IPF) Галт хана</a></li><li><a href=#firewalls-ipfw>31.6. IPFW</a></li></ul></nav></div><div class=book-content><div id=preamble><div class=sectionbody></div></div><div class=sect1><h2 id=firewalls-intro>31.1. Танилцуулга<a class=anchor href=#firewalls-intro></a></h2><div class=sectionbody><div class=paragraph><p>Галт ханын тусламжтайгаар систем уруу орж байгаа болон түүнээс гарч байгаа өгөгдлийн урсгалыг шүүн нэвтрүүлэх боломжтой болдог. Галт хана нь сүлжээгээр дамжин өнгөрч байгаа пакетуудыг, "дүрмүүдэд" заасны дагуу эсвэл нэвтрүүлэх, эсвэл хаах үүргийг гүйцэтгэдэг. Галт ханын дүрмүүд нь пакетийг протоколын төрөл, эхлэл хост хаяг, очих хост хаяг, эхлэл порт хаяг, очих порт хаяг зэрэг хэд хэдэн шинжээр нь шинжлэх боломжийг олгодог.</p></div><div class=paragraph><p>Галт ханыг ашигласнаар тухайн хостын болон сүлжээний аюулгүй байдлыг нилээд нэмэгдүүлж чадна. Галт ханын тусламжтайгаар дараах зүйлсийг хийх боломжтой :</p></div><div class=ulist><ul><li><p>Дотоод сүлжээнд байрлаж байгаа сервер машин, түүн дээр ажиллаж байгаа програм үйлчилгээг Интернэтээр дамжин орж ирж буй гадны урсгалаас хамгаалах, тусгаарлах.</p></li><li><p>Дотоод сүлжээнд байрлаж байгаа хостоос Интернэт уруу хандах хандалтыг хаах, хязгаарлах.</p></li><li><p>Network address translation буюу Сүлжээний Хаягийн Хөрвүүлэлтийг (NAT) дэмжих. Өөрөөр хэлбэл дотоод сүлжээндээ хувийн IP хаяг хэрэглэж, Интернэтэд гарахдаа дундаа нэг холболтыг (нэг IP хаяг эсвэл автоматаар оноосон бүлэг хаягаар) хуваан хэрэглэх.</p></li></ul></div><div class=paragraph><p>Энэ бүлгийг уншсаны дараа, та дараах зүйлсийг мэдэх болно:</p></div><div class=ulist><ul><li><p>пакетийг шүүн нэвтрүүлэх дүрмүүдийг хэрхэн оновчтойгоор тодорхойлох.</p></li><li><p>FreeBSD-тэй хамт суусан галт ханануудын ялгаа.</p></li><li><p>OpenBSD-н PF галт ханыг хэрхэн тохируулах болон хэрэглэх.</p></li><li><p>IPFILTER-г хэрхэн тохируулах болон хэрэглэх.</p></li><li><p>IPFW-г хэрхэн тохируулах болон хэрэглэх.</p></li></ul></div><div class=paragraph><p>Энэ бүлгийг уншихаасаа өмнө, та дараах зүйлсийг мэдсэн байх шаардлагатай:</p></div><div class=ulist><ul><li><p>FreeBSD болон Интернэтийн тухай үндсэн ойлголт.</p></li></ul></div></div></div><div class=sect1><h2 id=firewalls-concepts>31.2. Галт ханын тухай ойлголтууд<a class=anchor href=#firewalls-concepts></a></h2><div class=sectionbody><div class=paragraph><p>Галт ханын дүрмүүдийг дараах үндсэн хоёр янзаар үүсгэж болно: "inclusive буюу хамааруулсан" эсвэл "exclusive буюу хамааруулаагүй". Хамааруулаагүй галт хана нь дүрмэнд тохирсон урсгалаас бусдыг нэвтрүүлнэ. Харин хамааруулсан галт хана бол эсрэгээр нь, дүрмэнд тохирсон урсгалыг нэвтрүүлж бусдыг хаана.</p></div><div class=paragraph><p>Хамааруулсан галт хана нь Интернэтэд үйлчилгээнүүдийг санал болгодог системүүдийн хувьд илүү сайн сонголт болдог бөгөөд гарч байгаа урсгалыг илүү сайн хянах боломжийг олгодог. Энэ нь Интернэтээс таны хувийн сүлжээ рүү хандах урсгалыг бас хянадаг. Дүрэмд харгалзаж тохирохгүй бүх урсгалыг хааж бүртгэдэг. Болохгүй урсгалыг галт ханаар нэвтрүүлэх эрсдэлийг багасгадаг учраас хамааруулсан галт хана нь хамааруулаагүй галт ханыг бодвол илүүтэйгээр аюулгүй байдлыг хангаж чаддаг.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Зааж хэлээгүй л бол энэ бүлгийн бүх тохиргоо болон дүрмүүд нь хамааруулсан галт ханыг үүсгэдэг.</p></div></td></tr></tbody></table></div><div class=paragraph><p>"Төлөвт галт ханыг" ашиглан аюулгүй байдлыг цааш илүү сайжруулах боломжтой. Энэ төрлийн галт хана нь галт ханаар дамжин тогтсон холболтуудыг бүртгэж, зөвхөн таарч байгаа тогтсон холболтоор эсвэл шинэ холболт үүсгэн урсгалыг нэвтрүүлдэг. Төлөвт галт ханын нэг дутагдалтай тал гэвэл олон шинэ холболтууд нэг дор тогтох үед Denial of Service буюу Үйлчилгээг Зогсоох(DoS) халдлагад өртөмтгий болдог. Иймээс галт ханыг зохион байгуулахдаа төлөвт ба төлөвт-бус байдлыг хослуулан хэрэглэх нь хамгийн оновчтой байдаг.</p></div></div></div><div class=sect1><h2 id=firewalls-apps>31.3. Галт ханын багцууд<a class=anchor href=#firewalls-apps></a></h2><div class=sectionbody><div class=paragraph><p>FreeBSD дээр гурван янзын галт ханын багцууд хамрагдсан байдаг. Нэрлэвэл: <em>IPFILTER</em> (IPF гэж нэрлэх нь элбэг), <em>IPFIREWALL</em> (IPFW гэж нэрлэх нь элбэг), ба <em>OpenBSD-н PacketFilter</em> (PF гэж нэрлэх нь элбэг). FreeBSD нь мөн урсгалыг хязгаарлах(үндсэндээ зурвасын өргөнийг хязгаарлах) хоёр багцын хамт ирдэг: <a href="https://man.freebsd.org/cgi/man.cgi?query=altq&amp;sektion=4&amp;format=html">altq(4)</a> болон <a href="https://man.freebsd.org/cgi/man.cgi?query=dummynet&amp;sektion=4&amp;format=html">dummynet(4)</a>. Dummynet нь анхнаасаа IPFW-тай, харин ALTQ нь PF-тэй нягт холбоотой ажилладаг. IPFILTER-ийн хувьд урсгал хязгаарлалтыг хийхдээ NAT болон шүүлтэд IPFILTER-ийг ба IPFW-ийг <a href="https://man.freebsd.org/cgi/man.cgi?query=dummynet&amp;sektion=4&amp;format=html">dummynet(4)</a>-тэй цуг юм уу <em>эсвэл</em>PF-ийг ALTQ-тай цуг ашиглан хийж болно. IPFW, ба PF нь бүгд систем уруу орж байгаа болон гарч байгаа урсгалыг дүрмүүдийн тусламжтай удирдах боловч синтаксын хувьд ч, арга замын хувьд ч өөр өөр байдаг.</p></div><div class=paragraph><p>FreeBSD дээр олон галт ханын багцууд хамт ирдэг нь өөр өөр хэрэгцээ шаардлагатай хүмүүст хүртээмжтэй байхыг гол зорилгоо болгосонд оршино. Түүнээс аль ч галт хана нь нөгөөгөөсөө илүү, эсвэл дутуу гэсэн үг биш юм.</p></div><div class=paragraph><p>Зохиогч IPFILTER-г сонгон авсан нь түүний төлөвт дүрмүүд нь NAT орчинд хэрэглэхэд төвөг багатай, мөн дотроо ftp proxy агуулсан байдгаас болсон хэрэг. Энэхүү ftp proxy-г ашиглан гадагшаа гарах FTP урсгалыг зөвшөөрсөн дүрмүүдийг бичихэд хялбар байдаг.</p></div><div class=paragraph><p>Бүх галт ханууд пакет удирдах талбарын утгыг шинжлэх зарчмаар ажиллах тул галт ханын дүрмүүдийг бичихийн өмнө TCP/IP протокол хэрхэн ажилладаг талаар болон пакет удирдах талбарын утгууд, энэ утгууд session буюу сесс үүсэхэд хэрхэн хэрэглэгддэг талаар үндсэн ойлголттой байх шаардлагатай болдог. Дээрх ойлголтуудын талаар дараах хаягаар орж уншина уу: <a href=http://www.ipprimer.com/overview.cfm>http://www.ipprimer.com/overview.cfm</a>.</p></div></div></div><div class=sect1><h2 id=firewalls-pf>31.4. OpenBSD Пакет шүүгч (PF) ба ALTQ<a class=anchor href=#firewalls-pf></a></h2><div class=sectionbody><div class=paragraph><p>2003 оны 7 сард OpenBSD-н галт ханын програм болох PF FreeBSD уруу шилжиж, FreeBSD Портын Цуглуулгад орсон. 2004 онд гарсан FreeBSD 5.3 нь PF-г үндсэн системийн багцын нэг хэсэг болгон оруулсан анхны хувилбар юм. PF нь бүрэн хэмжээнд ажиллах чадвартай галт хана бөгөөд ALTQ-тай (Alternate Queuing буюу Ээлжлэн солигдох дараалал) хамтран ажиллах боломжтой. ALTQ нь Quality of Service буюу Үйлчилгээний Чанарын (QoS) боломжоор хангадаг. OpenBSD Төсөл нь <a href=http://www.openbsd.org/faq/pf/>PF FAQ</a>-г хөтлөн явуулдаг. Тиймээс гарын авлагын энэ хэсэг нь FreeBSD-д хамаатай PF дээр илүү анхаарлаа хандуулахахаас гадна хэрэглээний талаар зарим нэг ерөнхий мэдээллийг өгнө. Хэрэглээний мэдээллийн талаар илүү дэлгэрэнгүйг <a href=http://www.openbsd.org/faq/pf/>PF FAQ</a>-с үзнэ үү.</p></div><div class=paragraph><p>FreeBSD-д зориулсан PF-ийн талаар илүү дэлгэрэнгүй мэдээллийг <a href=http://pf4freebsd.love2party.net/>http://pf4freebsd.love2party.net/</a> хаягаас үзэж болно.</p></div><div class=sect2><h3 id=_цөмийн_дуудагдах_pf_модулиудыг_ашиглах_нь>31.4.1. Цөмийн дуудагдах PF модулиудыг ашиглах нь<a class=anchor href=#_цөмийн_дуудагдах_pf_модулиудыг_ашиглах_нь></a></h3><div class=paragraph><p>PF цөмийн модулийг дуудахдаа <span class=filename>/etc/rc.conf</span> файлд дараах мөрийг нэмнэ:</p></div><div class="literalblock programlisting"><div class=content><pre>pf_enable=&#34;YES&#34;</pre></div></div><div class=paragraph><p>Дараа нь модулийг дуудахдаа эхлүүлэх скриптийг ажиллуулна:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># /etc/rc.d/pf start</span></code></pre></div></div><div class=paragraph><p>PF модуль нь дүрмийн тохиргооны файлаа олж чадахгүй бол дуудагдахгүйг санаарай. Анхдагч байрлал нь <span class=filename>/etc/pf.conf</span> байна. Хэрэв PF дүрмийн олонлог өөр хаа нэгтээ байгаа бол <span class=filename>/etc/rc.conf</span> файлд доор дурдсантай адил мөрийг нэмж PF дүрмийн олонлогоо тэр газраас хайхаар зааж өгч болно:</p></div><div class="literalblock programlisting"><div class=content><pre>pf_rules=&#34;/path/to/pf.conf&#34;</pre></div></div><div class=paragraph><p>Жишээ <span class=filename>pf.conf</span> файлыг <span class=filename>/usr/shared/examples/pf/</span> сангаас олж болно.</p></div><div class=paragraph><p>PF модулийг тушаалын мөрөөс бас дуудан ажиллуулж болно:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># kldload pf.ko</span></code></pre></div></div><div class=paragraph><p>PF-д зориулсан бүртгэл хөтлөх дэмжлэгийг <code>pflog.ko</code> хангадаг бөгөөд <span class=filename>/etc/rc.conf</span> файлд дараах мөрийг нэмж дуудаж болно:</p></div><div class="literalblock programlisting"><div class=content><pre>pflog_enable=&#34;YES&#34;</pre></div></div><div class=paragraph><p>Дараа нь модулийг дуудахдаа эхлүүлэх скриптийг ажиллуулна:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># /etc/rc.d/pflog start</span></code></pre></div></div><div class=paragraph><p>Хэрэв танд PF-ийн өөр боломжууд хэрэгтэй бол PF-ийн дэмжлэгийг цөмд оруулан эмхэтгэх хэрэгтэй.</p></div></div><div class=sect2><h3 id=_pf_цөмийн_тохиргоонууд>31.4.2. PF цөмийн тохиргоонууд<a class=anchor href=#_pf_цөмийн_тохиргоонууд></a></h3><div class=paragraph><p>PF дэмжлэгийг FreeBSD цөмд оруулж эмхэтгэх нь шаардлагагүй боловч дуудагдах модульд ороогүй байдаг PF-ийн нэмэлт боломжуудын нэг бөгөөд PF-ийн ашигладаг төлвийн хүснэгтэд зарим өөрчлөлтүүдийг ил гаргадаг псевдо төхөөрөмж болох <a href="https://man.freebsd.org/cgi/man.cgi?query=pfsync&amp;sektion=4&amp;format=html">pfsync(4)</a> гэгддэг боломжийг ашиглахын тулд та тэгж хийж өгч болох юм. Үүнийг <a href="https://man.freebsd.org/cgi/man.cgi?query=carp&amp;sektion=4&amp;format=html">carp(4)</a>-тэй хослуулан ажиллагаа доголдоход тойрон гарах галт ханаыг PF ашиглан бүтээж болно. CARP-ийн талаар дэлгэрэнгүйг гарын авлагын <a href=../advanced-networking/#carp>Common Address Redundancy Protocol (CARP)</a>-с үзэж болно.</p></div><div class=paragraph><p>Цөмийн PF тохиргоонуудыг <span class=filename>/usr/src/sys/conf/NOTES</span>-с олж болох бөгөөд доор үзүүлэв:</p></div><div class="literalblock programlisting"><div class=content><pre>device pf
device pflog
device pfsync</pre></div></div><div class=paragraph><p><code>device pf</code> тохиргоо "Packet Filter" галт ханыг (<a href="https://man.freebsd.org/cgi/man.cgi?query=pf&amp;sektion=4&amp;format=html">pf(4)</a>) дэмждэг болгоно.</p></div><div class=paragraph><p><code>device pflog</code> тохиргоо псевдо буюу хуурамч <a href="https://man.freebsd.org/cgi/man.cgi?query=pflog&amp;sektion=4&amp;format=html">pflog(4)</a> сүлжээний төхөөрөмжийг идэвхжүүлнэ. Энэ хуурамч төхөөрөмжийн тусламжтайгаар <a href="https://man.freebsd.org/cgi/man.cgi?query=bpf&amp;sektion=4&amp;format=html">bpf(4)</a> дескриптор уруу урсгалыг бүртгэх боломжтой. <a href="https://man.freebsd.org/cgi/man.cgi?query=pflogd&amp;sektion=8&amp;format=html">pflogd(8)</a> дэмонг бүртгэлийг дискэн дээр хадгалахад хэрэглэнэ.</p></div><div class=paragraph><p><code>device pfsync</code> тохиргоо псевдо буюу хуурамч <a href="https://man.freebsd.org/cgi/man.cgi?query=pfsync&amp;sektion=4&amp;format=html">pfsync(4)</a> сүлжээний төхөөрөмжийг идэвхжүүлнэ. Энэ хуурамч төхөөрөмжийн тусламжтайгаар "төлвийн өөрчлөлтүүдийг" хянах боломжтой.</p></div></div><div class=sect2><h3 id=_rc_conf_боломжууд>31.4.3. rc.conf боломжууд<a class=anchor href=#_rc_conf_боломжууд></a></h3><div class=paragraph><p>Дараах <a href="https://man.freebsd.org/cgi/man.cgi?query=rc.conf&amp;sektion=5&amp;format=html">rc.conf(5)</a> илэрхийллүүд PF болон <a href="https://man.freebsd.org/cgi/man.cgi?query=pflog&amp;sektion=4&amp;format=html">pflog(4)</a>-ийг ачаалах үед тохируулна:</p></div><div class="literalblock programlisting"><div class=content><pre>pf_enable=&#34;YES&#34;                 # Enable PF (load module if required)
pf_rules=&#34;/etc/pf.conf&#34;         # rules definition file for pf
pf_flags=&#34;&#34;                     # additional flags for pfctl startup
pflog_enable=&#34;YES&#34;              # start pflogd(8)
pflog_logfile=&#34;/var/log/pflog&#34;  # where pflogd should store the logfile
pflog_flags=&#34;&#34;                  # additional flags for pflogd startup</pre></div></div><div class=paragraph><p>Хэрвээ энэ галт ханын цаана LAN байгаа бөгөөд LAN-д байгаа компьютерууд уруу пакет дамжуулах шаардлагатай бол эсвэл NAT ашиглах бодолтой байгаа бол дараах илэрхийлэл танд бас хэрэгтэй:</p></div><div class="literalblock programlisting"><div class=content><pre>gateway_enable=&#34;YES&#34;            # Enable as LAN gateway</pre></div></div></div><div class=sect2><h3 id=_шүүгч_дүрмүүдийг_үүсгэх_нь>31.4.4. Шүүгч дүрмүүдийг үүсгэх нь<a class=anchor href=#_шүүгч_дүрмүүдийг_үүсгэх_нь></a></h3><div class=paragraph><p>PF нь <a href="https://man.freebsd.org/cgi/man.cgi?query=pf.conf&amp;sektion=5&amp;format=html">pf.conf(5)</a>-с (анхдагчаар <span class=filename>/etc/pf.conf</span>) өөрийн тохиргооны дүрмүүдийг унших бөгөөд тэнд заагдсан дүрмүүд буюу тодорхойлолтуудын дагуу пакетуудыг өөрчлөх, орхих буюу эсвэл дамжуулдаг. FreeBSD суулгацад <span class=filename>/usr/shared/examples/pf/</span>-д байрлах хэд хэдэн жишээ файлууд байдаг. PF-ийн дүрмийн олонлогуудын талаар бүрэн мэдээллийг <a href=http://www.openbsd.org/faq/pf/>PF FAQ</a>-с лавлана уу.</p></div><div class="admonitionblock warning"><table><tbody><tr><td class=icon><i class="fa icon-warning" title=Warning></i></td><td class=content><div class=paragraph><p><a href=http://www.openbsd.org/faq/pf/>PF FAQ</a>-г үзэж байхдаа FreeBSD-ийн хувилбар бүр өөр өөр PF хувилбартай байж болохыг анхаарах хэрэгтэй. Одоогоор FreeBSD 8.<em>X</em> болон түүнээс өмнөх хувилбарууд OpenBSD 4.1-ийн нэгэн адил PF-ийн хувилбарыг ашигладаг. FreeBSD 9.<em>X</em> болон түүнээс хойшхи хувилбарууд OpenBSD 4.5-ийн нэгэн адил PF-ийн хувилбарыг ашигладаг.</p></div></td></tr></tbody></table></div><div class=paragraph><p><a href=https://lists.FreeBSD.org/subscription/freebsd-pf>FreeBSD пакет шүүгчийн захидлын жагсаалт</a> нь PF галт ханыг тохируулж ажиллуулах талаар асуухад тохиромжтой газар юм. Асуулт асуухаасаа өмнө захидлын жагсаалтын архиваас шалгахаа мартуузай!</p></div></div><div class=sect2><h3 id=_pf_тэй_ажиллах_нь>31.4.5. PF-тэй ажиллах нь<a class=anchor href=#_pf_тэй_ажиллах_нь></a></h3><div class=paragraph><p>PF-ийг хянахдаа <a href="https://man.freebsd.org/cgi/man.cgi?query=pfctl&amp;sektion=8&amp;format=html">pfctl(8)</a>-г ашиглана. Зарим нэг хэрэгтэй тушаалуудыг доор жагсаав (Бүх боломжит тохиргоонуудын талаар <a href="https://man.freebsd.org/cgi/man.cgi?query=pfctl&amp;sektion=8&amp;format=html">pfctl(8)</a> гарын авлагын хуудаснаас лавлахаа мартуузай):</p></div><table class="tableblock frame-none grid-all stretch informaltable"><col style=width:50%><col style=width:50%><thead><tr><th class="tableblock halign-left valign-top">Тушаал</th><th class="tableblock halign-left valign-top">Зорилго</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>pfctl -e</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>PF-г идэвхжүүлэх</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>pfctl -d</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>PF-г болиулах</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>pfctl -F all -f /etc/pf.conf</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Бүх дүрмүүдийг арилгаж (nat, шүүх, төлөв, хүснэгт, гэх мэт.) <span class=filename>/etc/pf.conf</span> файлаас дахин ачаалах</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>pfctl -s [ rules | nat | state ]</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Шүүх дүрмүүд, nat дүрмүүд, эсвэл төлвийн хүснэгтийн талаар тайлан гаргах</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock><code>pfctl -vnf /etc/pf.conf</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Дүрмийн олонлогийг ачаалалгүйгээр <span class=filename>/etc/pf.conf</span>-д алдаа байгаа эсэхийг шалгах</p></td></tr></tbody></table></div><div class=sect2><h3 id=_altq_г_идэвхжүүлэх>31.4.6. ALTQ-г идэвхжүүлэх<a class=anchor href=#_altq_г_идэвхжүүлэх></a></h3><div class=paragraph><p>ALTQ-г идэвхжүүлэх ганц арга зам бол түүний боломжуудыг FreeBSD цөмтэй хамт хөрвүүлэн эмхэтгэх юм. Мөн сүлжээний картын драйвер болгон ALTQ-г дэмждэггүй тул өөрийн тань хэрэглэж буй FreeBSD хувилбарын хувьд дэмжигддэг драйверуудын жагсаалтыг <a href="https://man.freebsd.org/cgi/man.cgi?query=altq&amp;sektion=4&amp;format=html">altq(4)</a> гарын авлагын хуудаснаас үзнэ үү.</p></div><div class=paragraph><p>Дараах тохируулгууд ALTQ-г идэвхжүүлж нэмэлт үүргүүдийг оруулдаг.</p></div><div class="literalblock programlisting"><div class=content><pre>options         ALTQ
options         ALTQ_CBQ        # Class Bases Queuing (CBQ)
options         ALTQ_RED        # Random Early Detection (RED)
options         ALTQ_RIO        # RED In/Out
options         ALTQ_HFSC       # Hierarchical Packet Scheduler (HFSC)
options         ALTQ_PRIQ       # Priority Queuing (PRIQ)
options         ALTQ_NOPCC      # Required for SMP build</pre></div></div><div class=paragraph><p><code>options ALTQ</code> мөр ALTQ -г бүхэлд нь идэвхжүүлнэ.</p></div><div class=paragraph><p><code>options ALTQ_CBQ</code> мөр <em>Class Based Queuing</em> буюу Ангиллаас Хамаарсан Дараалал Үүсгэх(CBQ) боломжийг идэвхжүүлнэ. CBQ нь шүүгч дүрмүүд дээр үндэслэн урсгалуудад эрэмбэ тогтоох зорилгоор зурвасын өргөнийг өөр өөр ангиллуудад болон дарааллуудад хуваах боломжийг олгоно.</p></div><div class=paragraph><p><code>options ALTQ_RED</code> мөр <em>Random Early Detection</em> буюу Санамсаргүй Эрт Илрүүлэлт(RED)-г идэвхжүүлнэ. RED-г сүлжээний даац хэтрэхээс сэргийлэхэд хэрэглэдэг. RED дарааллын уртыг хэмжиж, түүнийг байх ёстой дээд ба доод хэмжээтэй жиших байдлаар ажилладаг. Хэрэв дараалал дээд хэмжээнээс урт болбол шинэ пакетууд орхигдох болно. Нэртэйгээ адилаар, RED нь холболтуудаас пакетийг санамсаргүйгээр орхигдуулдаг.</p></div><div class=paragraph><p><code>options ALTQ_RIO</code> мөр нь <em>Random Early Detection In and Out</em> буюу Орох ба Гарах Санамсаргүй Эрт Илрүүлэлтийг идэвхжүүлнэ.</p></div><div class=paragraph><p><code>options ALTQ_HFSC</code> мөр нь <em>Hierarchical Fair Service Curve Packet Scheduler</em> буюу Үе давхаргат Зохимжит Үйлчилгээний Муруйн Пакет Хуваарилагчийг идэвхжүүлнэ. HFSC талаар илүү дэлгэрэнгүй мэдээллийг дараах хаягаас үзнэ үү: <a href=http://www-2.cs.cmu.edu/~hzhang/HFSC/main.html>http://www-2.cs.cmu.edu/~hzhang/HFSC/main.html</a>.</p></div><div class=paragraph><p><code>options ALTQ_PRIQ</code> мөр нь <em>Priority Queuing</em> буюу Эрэмбэт Дараалал Үүсгэх (PRIQ)-г идэвхжүүлнэ. PRIQ нь эрэмбэ өндөртэй дараалалд байгаа урсгалыг эхэнд нэвтрүүлэх зарчмаар ажилладаг.</p></div><div class=paragraph><p><code>options ALTQ_NOPCC</code> мөр нь ALTQ-г SMP-тай хамт ажиллах боломжтой болгоно. SMP системийн хувьд энэ боломжийг заавал идэвхжүүлэх хэрэгтэй.</p></div></div></div></div><div class=sect1><h2 id=firewalls-ipf>31.5. IPFILTER (IPF) Галт хана<a class=anchor href=#firewalls-ipf></a></h2><div class=sectionbody><div class=paragraph><p>IPFILTER-г зохиосон хүн бол Даррин Рид билээ. IPFILTER нь үйлдлийн системээс хамааралгүй: нээлттэй эхийн програм бөгөөд FreeBSD, NetBSD, OpenBSD, SunOS™, HP/UX, ба Solaris™ зэрэг олон үйлдлийн систем уруу шилжүүлэгдсэн юм. IPFILTER эрчимтэй дэмжигдэж, сайжруулсан хувилбарууд нь тогтмол гарсаар байгаа.</p></div><div class=paragraph><p>IPFILTER нь цөмийн талд ажиллах галт хана болон NAT механизм дээр суурилсан бөгөөд түүнийг удирдах, хянахын тулд хэрэглэгчийн интерфэйс програмыг ашиглана. Галт ханын дүрмүүдийг нэмэх болон хасахдаа <a href="https://man.freebsd.org/cgi/man.cgi?query=ipf&amp;sektion=8&amp;format=html">ipf(8)</a> хэрэгслийг хэрэглэнэ. NAT дүрмүүдийг нэмэх болон хасахдаа <a href="https://man.freebsd.org/cgi/man.cgi?query=ipnat&amp;sektion=8&amp;format=html">ipnat(8)</a> хэрэгслийг хэрэглэнэ. <a href="https://man.freebsd.org/cgi/man.cgi?query=ipfstat&amp;sektion=8&amp;format=html">ipfstat(8)</a> хэрэгсэл нь IPFILTER-н цөмийн талд ажиллаж байгаа хэсгийн статистикийг хэвлэхэд зориулагдсан. <a href="https://man.freebsd.org/cgi/man.cgi?query=ipmon&amp;sektion=8&amp;format=html">ipmon(8)</a> програм харин IPFILTER-н үйлдлүүдийг системийн бүртгэлийн файлд бүртгэнэ.</p></div><div class=paragraph><p>IPF-г анх зохиохдоо "сүүлд тохирсон дүрэм дийлнэ" гэсэн логикийн дагуу бүтээсэн ба зөвхөн төлөвт-бус дүрмүүдийг ашигладаг байлаа. Цаг хугацаа өнгөрөхөд IPF илүү хөгжиж, "quick" тохируулга болон төлөвт "keep state" тохируулгуудыг агуулах болсон нь орчин үеийн хэрэгцээ шаардлагад илүү нийцэх болжээ. IPF-н албан ёсны баримтжуулалтанд хуучин уламжлалт дүрмүүдийг бичих параметрүүд болон файлтай ажиллах логикууд багтсан байдаг. Харин шинэ функцуудыг нь зөвхөн нэмэлт боломж байдлаар оруулсан нь аюулгүй байдлыг хавьгүй илүү хангасан аюулгүй галт хана бий болгож байгаа тэднийг хэт доогуур тавьсан санагддаг.</p></div><div class=paragraph><p>Энэ бүлэгт байгаа зааврууд нь "quick" болон төлөвт "keep state" тохируулгуудыг агуулсан дүрмүүдээс үндсэндээ бүрдсэн байгаа. Энэ бол хамааруулсан галт ханын дүрмүүдийг бичих үндсэн арга барил юм.</p></div><div class=paragraph><p>Хуучин уламжлалт дүрмүүдтэй ажиллах аргуудын талаар дэлгэрэнгүй тайлбарыг: <a href=http://www.munk.me.uk/ipf/ipf-howto.html>http://www.munk.me.uk/ipf/ipf-howto.html</a> ба <a href=http://coombs.anu.edu.au/~avalon/ip-filter.html>http://coombs.anu.edu.au/~avalon/ip-filter.html</a> хаягаар орж үзнэ үү.</p></div><div class=paragraph><p>IPF FAQ-г <a href=http://www.phildev.net/ipf/index.html>http://www.phildev.net/ipf/index.html</a> хаягаар орж үзнэ үү.</p></div><div class=paragraph><p>Нээлттэй эхийн IPFilter програмын захидлын жагсаалтын архивыг <a href="http://marc.theaimsgroup.com/?l=ipfilter">http://marc.theaimsgroup.com/?l=ipfilter</a> хаягаар орж үзнэ үү.</p></div><div class=sect2><h3 id=_ipf_г_идэвхжүүлэх>31.5.1. IPF-г идэвхжүүлэх<a class=anchor href=#_ipf_г_идэвхжүүлэх></a></h3><div class=paragraph><p>IPF нь FreeBSD үндсэн суулгацтай хамт, ажиллах үеийн ачаалах боломжтой модуль байдлаар ирдэг. <span class=filename>rc.conf</span> тохиргооны файл дотор ipfilter_enable="YES" илэрхийлэл байгаа үед систем IPF цөмийн модулийг динамикаар ачаална. Энэ ачаалах боломжтой модуль нь бүртгэх боломжтойгоор, анхдагч <code>default pass all</code> тохируулгын хамт бүтээгдсэн байдаг. Анхдагч дүрмийг <code>block all</code> болгохын тулд IPF-г цөмд эмхэтгэх шаардлага байхгүй. Зөвхөн дүрмүүдийнхээ төгсгөлд бүгдийг хаах дүрмийг бичиж өгөхөд хангалттай.</p></div></div><div class=sect2><h3 id=_цөмийн_тохируулгууд>31.5.2. Цөмийн тохируулгууд<a class=anchor href=#_цөмийн_тохируулгууд></a></h3><div class=paragraph><p>FreeBSD цөм уруу дараах боломжуудыг эмхэтгэн IPF-г идэвхжүүлэх албагүй боловч, суурь мэдлэг болгон энд үзүүллээ. IPF-г цөм уруу хөрвүүлэн эмхэтгэснээр ачаалах боломжтой модулийг хэрэглэх боломжгүй болдог.</p></div><div class=paragraph><p>Цөмийн тохиргоон дахь жишээ IPF илэрхийллүүд <span class=filename>/usr/src/sys/conf/NOTES</span> гэсэн цөмийн эх файлд байх ба доор сийрүүлбэл:</p></div><div class="literalblock programlisting"><div class=content><pre>options IPFILTER
options IPFILTER_LOG
options IPFILTER_DEFAULT_BLOCK</pre></div></div><div class=paragraph><p><code>options IPFILTER</code> мөр нь "IPFILTER" галт ханыг идэвхжүүлнэ.</p></div><div class=paragraph><p><code>options IPFILTER_LOG</code> мөр нь <code>log</code> гэсэн түлхүүр үг орсон дүрмүүдийн хувьд урсгалыг <span class=filename>ipl</span> пакет бүртгэх хуурамч-төхөөрөмж уруу бүртгэх боломжтой болгоно.</p></div><div class=paragraph><p><code>options IPFILTER_DEFAULT_BLOCK</code> мөр нь галт ханын <code>pass</code> дүрмэнд тохироогүй пакетийг хаах анхдагч чанарыг зааж өгнө.</p></div><div class=paragraph><p>Эдгээр тохируулгууд нь зөвхөн тэдгээрийг тохируулан, тусгайлан цөм бүтээж суулгасны дараа идэвхждэг.</p></div></div><div class=sect2><h3 id=_rc_conf_тохируулгууд>31.5.3. rc.conf тохируулгууд<a class=anchor href=#_rc_conf_тохируулгууд></a></h3><div class=paragraph><p>IPF-г систем ачаалах үед идэвхтэй болгохын тулд /etc/rc.conf дотор дараах илэрхийллүүд байх ёстой:</p></div><div class="literalblock programlisting"><div class=content><pre>ipfilter_enable=&#34;YES&#34;             # Start ipf firewall
ipfilter_rules=&#34;/etc/ipf.rules&#34;   # loads rules definition text file
ipmon_enable=&#34;YES&#34;                # Start IP monitor log
ipmon_flags=&#34;-Ds&#34;                 # D = start as daemon
                                  # s = log to syslog
                                  # v = log tcp window, ack, seq
                                  # n = map IP &amp; port to names</pre></div></div><div class=paragraph><p>Хэрэв энэ галт ханын цаана хувийн IP хаяг хэрэглэдэг LAN байгаа бол NAT функцыг идэвхжүүлэхийн тулд дараах мөрүүдийг нэмэх хэрэгтэй:</p></div><div class="literalblock programlisting"><div class=content><pre>gateway_enable=&#34;YES&#34;              # Enable as LAN gateway
ipnat_enable=&#34;YES&#34;                # Start ipnat function
ipnat_rules=&#34;/etc/ipnat.rules&#34;    # rules definition file for ipnat</pre></div></div></div><div class=sect2><h3 id=_ipf>31.5.4. IPF<a class=anchor href=#_ipf></a></h3><div class=paragraph><p>Таны бичсэн дүрмүүдийг ачаалахад <a href="https://man.freebsd.org/cgi/man.cgi?query=ipf&amp;sektion=8&amp;format=html">ipf(8)</a> тушаалыг хэрэглэнэ. Та өөрийн дүрмүүдээс бүтсэн файлыг үүсгээд, түүнийгээ дээрх тушаалын ашиглан галт ханын одоо ажиллаж байгаа дотоод дүрмүүдтэй сольж тавьна гэсэн үг юм:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># ipf -Fa -f /etc/ipf.rules</span></code></pre></div></div><div class=paragraph><p><code>-Fa</code> нь бүх дотоод дүрмүүдийн хүснэгтийг цэвэрлэ гэсэн үг.</p></div><div class=paragraph><p><code>-f</code> нь ачаалах дүрмүүдээ энэ файлаас унш гэсэн үг.</p></div><div class=paragraph><p>Ийм байдлаар та өөрийн хүссэн дүрмүүдийн файлыг үүсгээд, дээрх IPF тушаалыг ажиллуулан системийг шинээр ачаалахгүйгээр ажиллаж байгаа галт ханын дүрмүүдийг шинээр өөрчлөх боломжтой болж байна. Дээрх аргаар галт ханын дүрмүүдийг хэдэн ч удаа сольж болох тул энэ арга нь шинэ дүрмүүдийг туршихад тохиромжтой арга юм.</p></div><div class=paragraph><p>Энэ тушаалтай ажиллах боломжтой бусад тугуудын талаар дэлгэрэнгүйг <a href="https://man.freebsd.org/cgi/man.cgi?query=ipf&amp;sektion=8&amp;format=html">ipf(8)</a> заавар хуудаснаас үзнэ үү.</p></div><div class=paragraph><p><a href="https://man.freebsd.org/cgi/man.cgi?query=ipf&amp;sektion=8&amp;format=html">ipf(8)</a> тушаал дүрмүүдийн файлыг стандарт текст файл гэж тооцдог. Симбол орлуулалттай скрипт байдлаар бичигдсэн файлыг ойлгохгүй.</p></div><div class=paragraph><p>Гэвч скрипт симбол орлуулалтын хүчийг ашиглан IPF дүрмүүдийг бүтээх арга зам байгаа. Илүү дэлгэрэнгүй мэдээллийг <a href=#firewalls-ipf-rules-script>Симбол орлуулалттай скриптийг үүсгэх нь</a> хэсгээс үзнэ үү.</p></div></div><div class=sect2><h3 id=_ipfstat>31.5.5. IPFSTAT<a class=anchor href=#_ipfstat></a></h3><div class=paragraph><p><a href="https://man.freebsd.org/cgi/man.cgi?query=ipfstat&amp;sektion=8&amp;format=html">ipfstat(8)</a>-н анхдагч чанар бол галт ханыг хамгийн сүүлд асааснаас хойших, эсвэл <code>ipf -Z</code> тушаалыг өгөн хуримтлуулагчийг хамгийн сүүлд тэглэснээс хойших галт ханаар орж байгаа болон гарч байгаа пакетуудыг хэрэглэгчийн тодорхойлж өгсөн дүрмүүдээр шүүсэн үр дүнд бий болсон статистик тоог гаргаж ирэн, дэлгэцэнд харуулах юм.</p></div><div class=paragraph><p>Дэлгэрэнгүйг <a href="https://man.freebsd.org/cgi/man.cgi?query=ipfstat&amp;sektion=8&amp;format=html">ipfstat(8)</a> заавар хуудаснаас үзнэ үү.</p></div><div class=paragraph><p><a href="https://man.freebsd.org/cgi/man.cgi?query=ipfstat&amp;sektion=8&amp;format=html">ipfstat(8)</a> тушаалын анхдагч үр дүн дараах байдалтай байна:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>input packets: blocked 99286 passed 1255609 nomatch 14686 counted 0
 output packets: blocked 4200 passed 1284345 nomatch 14687 counted 0
 input packets logged: blocked 99286 passed 0
 output packets logged: blocked 0 passed 0
 packets logged: input 0 output 0
 log failures: input 3898 output 0
 fragment state<span class=o>(</span><span class=k>in</span><span class=o>)</span>: kept 0 lost 0
 fragment state<span class=o>(</span>out<span class=o>)</span>: kept 0 lost 0
 packet state<span class=o>(</span><span class=k>in</span><span class=o>)</span>: kept 169364 lost 0
 packet state<span class=o>(</span>out<span class=o>)</span>: kept 431395 lost 0
 ICMP replies: 0 TCP RSTs sent: 0
 Result cache hits<span class=o>(</span><span class=k>in</span><span class=o>)</span>: 1215208 <span class=o>(</span>out<span class=o>)</span>: 1098963
 IN Pullups succeeded: 2 failed: 0
 OUT Pullups succeeded: 0 failed: 0
 Fastroute successes: 0 failures: 0
 TCP <span class=nb>cksum </span>fails<span class=o>(</span><span class=k>in</span><span class=o>)</span>: 0 <span class=o>(</span>out<span class=o>)</span>: 0
 Packet log flags <span class=nb>set</span>: <span class=o>(</span>0<span class=o>)</span></code></pre></div></div><div class=paragraph><p>Дотогшоо урсгалын хувьд <code>-i</code>, гадагшаа урсгалын хувьд <code>-o</code> тохируулгыг өгөхөд кернелийн ашиглаж буй дүрмүүдийн жагсаалтыг гаргаж харуулна.</p></div><div class=paragraph><p><code>ipfstat -in</code> нь дотогшоо урсгалын дотоод дүрмүүдийн хүснэгтийг дүрмүүдийн дугаарын хамт харуулна.</p></div><div class=paragraph><p><code>ipfstat -on</code> нь гадагшаа урсгалын дотоод дүрмүүдийн хүснэгтийг дүрмүүдийн дугаарын хамт харуулна.</p></div><div class=paragraph><p>Үр дүн нь дараах байдалтай байна:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>@1 pass out on xl0 from any to any
@2 block out on dc0 from any to any
@3 pass out quick on dc0 proto tcp/udp from any to any keep state</code></pre></div></div><div class=paragraph><p><code>ipfstat -ih</code> нь дотогшоо урсгалын дотоод дүрмүүдийн хүснэгтийг дүрмүүдийн хэдэн удаа тохирсон тооны хамт харуулна.</p></div><div class=paragraph><p><code>ipfstat -oh</code> нь гадагшаа урсгалын дотоод дүрмүүдийн хүснэгтийг дүрмүүдийн хэдэн удаа тохирсон тооны хамт харуулна.</p></div><div class=paragraph><p>Үр дүн нь дараах байдалтай байна:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>2451423 pass out on xl0 from any to any
354727 block out on dc0 from any to any
430918 pass out quick on dc0 proto tcp/udp from any to any keep state</code></pre></div></div><div class=paragraph><p><code>ipfstat</code> тушаалын хамгийн чухал функцуудын нэг бол, FreeBSD-н ажиллаж байгаа процессийн хүснэгтийг <a href="https://man.freebsd.org/cgi/man.cgi?query=top&amp;sektion=1&amp;format=html">top(1)</a> харуулдаг шиг төлвийн хүснэгтийг <code>-t</code> туг харуулдаг явдал юм. Таны галт хана гадны халдлагад өртөх үед энэ функц түүнийг илрүүлэх, шинжлэх, халдлагад оролцож буй пакетуудыг харах боломжийг олгоно. Нэмэлт дэд тугууд нь хяналт хийх эхлэл болон очих IP хаяг, порт, эсвэл протоколыг сонгох боломжийг олгодог. Дэлгэрэнгүйг <a href="https://man.freebsd.org/cgi/man.cgi?query=ipfstat&amp;sektion=8&amp;format=html">ipfstat(8)</a> заавар хуудаснаас үзнэ үү.</p></div></div><div class=sect2><h3 id=_ipmon>31.5.6. IPMON<a class=anchor href=#_ipmon></a></h3><div class=paragraph><p><code>ipmon</code> тушаал зохистой ажиллахын тулд цөмийн <code>IPFILTER_LOG</code> тохируулга идэвхжсэн байх ёстой. Энэ тушаал хоёр өөр горимд ажиллах чадвартай. Төрөлх горим нь энэ тушаалыг тушаал мөрөн дээр <code>-D</code> туггүйгээр оруулахад ажиллах анхдагч горим юм.</p></div><div class=paragraph><p>Демон горим нь болж өнгөрсөн үйл явцын бүртгэлийг эргэж харахын тулд системийн бүртгэлийг тасралтгүй хөтлөн явуулахад тохиромжтой горим юм. FreeBSD болон IPFILTER энэ горимд ажиллахаар тохируулагдсан байдаг. FreeBSD нь системийн бүртгэлийг автоматаар тойруулах чадвартай. Тиймээс бүртгэлийн мэдээллийг <a href="https://man.freebsd.org/cgi/man.cgi?query=syslogd&amp;sektion=8&amp;format=html">syslogd(8)</a> процесс уруу гаргах нь энгийн файл уруу гаргах анхдагч аргаас дээр байдаг. Анхдагч <span class=filename>rc.conf</span> файл дотор <code>ipmon_flags</code> илэрхийлэл <code>-Ds</code> тугуудыг хэрэглэдэг:</p></div><div class="literalblock programlisting"><div class=content><pre>ipmon_flags=&#34;-Ds&#34; # D = start as daemon
                  # s = log to syslog
                  # v = log tcp window, ack, seq
                  # n = map IP &amp; port to names</pre></div></div><div class=paragraph><p>Бүртгэл хөтлөн явуулахын давуу талыг дурдахад илүүц биз. Бүртгэлийн тусламжтай ямар пакетууд орхигдсон, тэдгээр пакетууд хаанаас ирсэн, хаашаа явж байсан зэрэг мэдээллийг эргэн харах боломжтой болдог. Энэ бүх мэдээлэл гадны халдлагыг мөрдөхөд чухал түлхэц болно.</p></div><div class=paragraph><p>Хэдийгээр бүртгэх боломжоор хангагдсан боловч, IPF дангаараа бүртгэлийг үүсгэж чадахгүй. Галт ханын администратор аль дүрмийн бүртгэлийг бичихийг шийдэн, тэдгээр дүрмүүдэд log түлхүүр үгийг нэмж өгнө. Ер нь, зөвхөн deny дүрмүүдийн бүртгэл бичигддэг.</p></div><div class=paragraph><p>Бүгдийг хориглосон анхдагч дүрмийг log түлхүүр үгийн хамт дүрмүүдийнхээ хамгийн төгсгөлд бичиж өгөх нь нилээд өргөн хэрэглэгддэг арга юм. Ингэснээр таны дүрмүүдийн алинтай ч тохироогүй пакетуудыг мэдэх боломжтой болно.</p></div></div><div class=sect2><h3 id=_ipmon_бүртгэл_хөтлөлт>31.5.7. IPMON бүртгэл хөтлөлт<a class=anchor href=#_ipmon_бүртгэл_хөтлөлт></a></h3><div class=paragraph><p>Syslogd нь бүртгэлийн мэдээллийг дотор нь ангилах өөрийн тусгай аргатай. "facility" ба "түвшин" гэсэн тусгай ангилалаар ялгадаг. <code>-Ds</code> горимон дахь IPMON нь анхдагчаар "facility"-аар <code>local0</code>-г хэрэглэдэг. Хэрэв хүсвэл доорх түвшнүүдийг ашиглан бүртгэгдсэн мэдээллийг илүү ангилж болно:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>LOG_INFO - нэвтрүүлэх, хаахаас үл хамааран <span class=s2>&#34;log&#34;</span> түлхүүрийг үйлдэл ашиглан пакетуудыг бүртгэх.
LOG_NOTICE - нэвтэрсэн пакетуудыг бүртгэх.
LOG_WARNING - хаагдсан пакетуудыг бүртгэх.
LOG_ERR - бүртгэсэн пакетууд болон богино гэгдсэн пакетууд</code></pre></div></div><div class=paragraph><p>IPFILTER-н бүх бүртгэлийн мэдээллийг <span class=filename>/var/log/ipfilter.log</span> файл дотор бичихийн тулд, файл эхлээд үүссэн байх хэрэгтэй. Үүний тулд дараах тушаалыг өгөх хэрэгтэй:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># touch /var/log/ipfilter.log</span></code></pre></div></div><div class=paragraph><p><a href="https://man.freebsd.org/cgi/man.cgi?query=syslogd&amp;sektion=8&amp;format=html">syslogd(8)</a>-н функцуудыг <span class=filename>/etc/syslog.conf</span> файл доторх тодорхойлох илэрхийллүүдээр удирдаж болно. <span class=filename>syslog.conf</span> файл нь IPF мэт програмуудын үүсгэсэн системийн мэдэгдлүүдтэй syslog-г ажиллахад уян хатан болгодог.</p></div><div class=paragraph><p>Дараах илэрхийллүүдийг <span class=filename>/etc/syslog.conf</span> файл дотор нэмж бичнэ үү:</p></div><div class="literalblock programlisting"><div class=content><pre>local0.* /var/log/ipfilter.log</pre></div></div><div class=paragraph><p><code>local0.*</code> нь бүх бүртгэгдсэн мэдэгдлүүдийг дурдсан файлд бичихийг хэлж өгч байна.</p></div><div class=paragraph><p><span class=filename>/etc/syslog.conf</span> файлд хийсэн өөрчлөлтүүдийг идэвхжүүлэхийн тулд та системээ дахин ачаалах эсвэл <code>/etc/rc.d/syslogd reload</code> тушаалыг ашиглан <a href="https://man.freebsd.org/cgi/man.cgi?query=syslogd&amp;sektion=8&amp;format=html">syslogd(8)</a> демонд <span class=filename>/etc/syslog.conf</span> файлыг дахин уншуулах хэрэгтэй.</p></div><div class=paragraph><p>Дээр шинээр үүсгэсэн бүртгэлийг тойруулахын тулд <span class=filename>/etc/newsyslog.conf</span> файл дотор өөрчлөлт оруулахаа мартуузай.</p></div></div><div class=sect2><h3 id=_бүртгэгдсэн_мэдэгдлийн_формат>31.5.8. Бүртгэгдсэн мэдэгдлийн формат<a class=anchor href=#_бүртгэгдсэн_мэдэгдлийн_формат></a></h3><div class=paragraph><p><code>ipmon</code>-ы үүсгэсэн мэдэгдэл зайгаар тусгаарлагдсан өгөгдлийн талбаруудаас бүрдэнэ. Бүх мэдэгдэлд байдаг гол талбарууд гэвэл:</p></div><div class="olist arabic"><ol class=arabic><li><p>Пакетийг хүлээж авсан огноо.</p></li><li><p>Пакетийг хүлээж авсан цаг. Цаг, минут, секунд, бутархай секундэд (олон орны нарийвчлалтай) харгалзан HH:MM:SS.F форматтай байна.</p></li><li><p>Пакеттай ажилласан интерфэйсийн нэр, жишээлбэл <span class=filename>dc0</span>.</p></li><li><p>Дүрмийн бүлэг болон дүрмийн дугаар, жишээлбэл <code>@0:17</code>.</p></li></ol></div><div class=paragraph><p>Эдгээрийг <code>ipfstat-in</code> тушаалын тусламжтай үзэж болно.</p></div><div class="olist arabic"><ol class=arabic><li><p>Үйлдэл: нэвтрүүлсэн бол р, хаасан бол b, богино пакет бол S, аль ч дүрмэнд тохироогүй бол n, бүртгэх дүрэм бол L. Эдгээр тугуудыг дараах эрэмбээр харуулна: S, p, b, n, L. Том P эсвэл B үсэг нь тухайн пакет ямар нэг дүрмээс биш, глобал тохиргооноос хамааран бүртгэгдсэн болохыг заана.</p></li><li><p>Хаягууд. Үндсэндээ гурван талбар байна: эхлэл хаяг болон порт (таслалаар тусгаарлагдсан), → тэмдэг, ба очих хаяг болон порт. Жишээ нь <code>209.53.17.22,80 → 198.73.220.17,1722</code>.</p></li><li><p><code>PR</code>-н дараа протоколын нэр болон дугаар, жишээлбэл <code>PR tcp</code>.</p></li><li><p><code>len</code>-ы дараа толгойн урт болон пакетийн нийт урт, жишээлбэл <code>len 20 40</code>.</p></li></ol></div><div class=paragraph><p>Хэрэв TCP пакет бол зураасаар эхэлж тугуудаар удаалсан нэмэлт талбар байна. Үсгүүд болон түүнд харгалзах тугуудын талаар <a href="https://man.freebsd.org/cgi/man.cgi?query=ipf&amp;sektion=5&amp;format=html">ipf(5)</a> заавар хуудаснаас үзнэ үү.</p></div><div class=paragraph><p>Хэрэв ICMP пакет бол, төгсгөлд нь хоёр талбар байна. Эхнийх нь үргэлж "ICMP" утгатай байна, дараагийнх нь налуу зураасаар тусгаарлагдсан ICMP мэдэгдэл болон дэд мэдэгдлийн төрөл, жишээлбэл портод хандаж чадсангүй гэсэн мэдэгдлийн хувьд ICMP 3/3 байна.</p></div></div><div class=sect2><h3 id=firewalls-ipf-rules-script>31.5.9. Симбол орлуулалттай скриптийг үүсгэх нь<a class=anchor href=#firewalls-ipf-rules-script></a></h3><div class=paragraph><p>Зарим туршлагатай IPF хэрэглэгчид дүрмүүдийг агуулсан файл үүсгээд түүнийгээ симбол орлуулалттай скрипт байдлаар ажиллуулах боломжтой болгон бичдэг. Үүний гол давуу тал нь зөвхөн симбол нэрд харгалзах утгыг өөрчлөх хэрэгтэй бөгөөд, скриптийг ажиллуулахад уг симбол орлуулалт орсон дүрэм бүр шинэ утгыг авах болно. Скриптийн хувьд, олон дахин хэрэглэгддэг утгуудыг бичихэд симбол орлуулалтыг ашиглаж, тэдгээрийг олон дүрмэнд орлуулж өгнө гэсэн үг юм. Дараах жишээн дээрээс харна уу.</p></div><div class=paragraph><p>Энд хэрэглэгдсэн скриптийн синтакс нь <a href="https://man.freebsd.org/cgi/man.cgi?query=sh&amp;sektion=1&amp;format=html">sh(1)</a>, <a href="https://man.freebsd.org/cgi/man.cgi?query=csh&amp;sektion=1&amp;format=html">csh(1)</a>, ба <a href="https://man.freebsd.org/cgi/man.cgi?query=tcsh&amp;sektion=1&amp;format=html">tcsh(1)</a> бүрхүүл дээр ажиллах боломжтой.</p></div><div class=paragraph><p>Симбол орлуулалтын талбарууд нь урдаа долларын тэмдэгтэй байна: <code>$</code>.</p></div><div class=paragraph><p>Симбол талбарууд нь $ тэмдэг урдаа байхгүй.</p></div><div class=paragraph><p>Симбол талбарыг орлох утга нь давхар хашилтан(<code>"</code>) дотор байрлана.</p></div><div class=paragraph><p>Дүрмийн файлаа дараах байдалтай үүсгэж эхлэх хэрэгтэй:</p></div><div class="literalblock programlisting"><div class=content><pre>############# Start of IPF rules script ########################

oif=&#34;dc0&#34;            # name of the outbound interface
odns=&#34;192.0.2.11&#34;    # ISP&#39;s DNS server IP address
myip=&#34;192.0.2.7&#34;     # my static IP address from ISP
ks=&#34;keep state&#34;
fks=&#34;flags S keep state&#34;

# You can choose between building /etc/ipf.rules file
# from this script or running this script &#34;as is&#34;.
#
# Uncomment only one line and comment out another.
#
# 1) This can be used for building /etc/ipf.rules:
#cat &gt; /etc/ipf.rules &lt;&lt; EOF
#
# 2) This can be used to run script &#34;as is&#34;:
/sbin/ipf -Fa -f - &lt;&lt; EOF

# Allow out access to my ISP&#39;s Domain name server.
pass out quick on $oif proto tcp from any to $odns port = 53 $fks
pass out quick on $oif proto udp from any to $odns port = 53 $ks

# Allow out non-secure standard www function
pass out quick on $oif proto tcp from $myip to any port = 80 $fks

# Allow out secure www function https over TLS SSL
pass out quick on $oif proto tcp from $myip to any port = 443 $fks
EOF
################## End of IPF rules script ########################</pre></div></div><div class=paragraph><p>Байх ёстой бүх зүйлс бүгд байна. Энэ жишээн дээр дүрмүүд чухал биш, харин симбол орлуулалт хэрхэн ажилладгыг харуулсан байна. Хэрэв дээрх жишээ <span class=filename>/etc/ipf.rules.script</span> нэртэй файл дотор байсан бол, эдгээр дүрмүүдийг дараах тушаалыг өгч дахин ачаалах боломжтой:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># sh /etc/ipf.rules.script</span></code></pre></div></div><div class=paragraph><p>Суулгагдсан симболтой дүрмийн файлыг хэрэглэхэд нэг асуудал тулгардаг: IPF симбол орлуулалтыг ойлгохгүй, ийм скриптийг шууд уншиж чаддаггүй.</p></div><div class=paragraph><p>Дараах скриптийг хоёр аргын нэгээр хэрэглэж болно:</p></div><div class=ulist><ul><li><p><code>cat</code>-р эхэлсэн мөрийг ил гарга, харин <code>/sbin/ipf</code>-р эхэлсэн мөрүүдийг далдал. <code>ipfilter_enable="YES"</code>-г <span class=filename>/etc/rc.conf</span> файл дотор байрлуул, дараа нь өөрчлөлт бүрийн дараа скриптийг ажиллуулан <span class=filename>/etc/ipf.rules</span> файлыг үүсгэ эсвэл өөрчлөлт оруул.</p></li><li><p><span class=filename>/etc/rc.conf</span> файл дотор <code>ipfilter_enable="NO"</code> (энэ анхдагч утга) мөрийг нэмэн системийн эхлэл скриптэд IPFILTER-г идэвхгүй болго.</p><div class=paragraph><p>Дээрхтэй адил скриптийг өөрийн <span class=filename>/usr/local/etc/rc.d/</span> эхлэл хавтаст байрлуул. Энэ скрипт <span class=filename>ipf.loadrules.sh</span> ч юм уу ойлгомжтой нэртэй байх ёстой. <span class=filename>.sh</span> гэсэн өргөтгөлтэй байх ёстой.</p></div><div class="literalblock programlisting"><div class=content><pre>#!/bin/sh
sh /etc/ipf.rules.script</pre></div></div><div class=paragraph><p>Энэ скриптийн эрхүүд эзэмшигч <code>root</code>-н хувьд унших, бичих, ажиллах эрхтэй байх ёстой.</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># chmod 700 /usr/local/etc/rc.d/ipf.loadrules.sh</span></code></pre></div></div></li></ul></div><div class=paragraph><p>Одоо систем ачаалсны дараа таны IPF дүрмүүд ачаалагдсан байх болно.</p></div></div><div class=sect2><h3 id=_ipf_дүрмүүдийн_олонлог>31.5.10. IPF Дүрмүүдийн олонлог<a class=anchor href=#_ipf_дүрмүүдийн_олонлог></a></h3><div class=paragraph><p>Пакет дотор агуулагдаж байгаа утгуудыг үндэслэн тухайн пакетийг нэвтрүүлэх болон хаахыг хэлж байгаа IPF дүрмүүдийг дүрмийн олонлог гэнэ. Хостуудын хоорондох хоёр чиглэлтэй пакет солилцоо нь сесс харилцааг бүрдүүлнэ. Галт ханын дүрмийн олонлог нь Интернэтээс ирж байгаа пакетуудыг болон систем буцааж тэдэнд хариу өгсөн пакетуудыг боловсруулдаг. Бүх TCP/IP үйлчилгээнүүд (жишээ нь: telnet, www, mail, г.м.) өөрийн протокол болон зөвшөөрөгдсөн (сонсож байгаа) портоороо тодорхойлогддог. Тухайн нэг үйлчилгээ рүү зорисон пакетууд нь тусгай зориулалтаар ашиглагддаггүй порт ашиглан эх хаягаас гарч очих хаягийн тухайн үйлчилгээний порт руу чиглэдэг. Дээрх бүх параметрууд (өөрөөр хэлбэл: портууд болон хаягууд) дээр үндэслэн нэвтрүүлэх болох хаах дүрмүүдийг зохиодог.</p></div><div class=paragraph><p>IPF-г анх зохиохдоо "сүүлд тохирсон дүрэм дийлнэ" логикийн дагуу бүтээсэн ба зөвхөн төлөвт-бус дүрмүүдийг ашигладаг байлаа. Цаг хугацаа өнгөрөхөд IPF илүү хөгжиж, "quick" тохируулга болон төлөвт "keep state" тохируулгуудыг агуулах болсон нь орчин үеийн хэрэгцээ шаардлагад илүү нийцэх болжээ.</p></div><div class=paragraph><p>Энэ бүлэгт байгаа зааврууд нь "quick" болон төлөвт "keep state" тохируулгуудыг агуулсан дүрмүүдээс үндсэндээ бүрдсэн байгаа. Энэ бол хамааруулсан галт ханын дүрмүүдийг бичих үндсэн арга барил юм.</p></div><div class="admonitionblock warning"><table><tbody><tr><td class=icon><i class="fa icon-warning" title=Warning></i></td><td class=content><div class=paragraph><p>Галт ханын дүрмүүдтэй ажиллахдаа <em>маш анхааралтай</em> байх хэрэгтэй. Зарим тохиргоо серверээс <em>бүх холбоог тань тасалж</em> мэднэ. Ийм аюулаас хол байхын тулд, галт ханын тохиргоог анхлан хийхдээ ssh зэрэг алсын хандалтаас илүүтэйгээр ойрын удирдлагыг сонгоорой.</p></div></td></tr></tbody></table></div></div><div class=sect2><h3 id=_дүрмийн_синтакс>31.5.11. Дүрмийн синтакс<a class=anchor href=#_дүрмийн_синтакс></a></h3><div class=paragraph><p>Энд дурдах дүрмийн синтакс нь орчин үеийн төлөвт дүрмүүдийн хүрээнд, "сүүлд тохирсон дүрэм дийлнэ" логикоор ажиллахаар хялбаршуулан бичигдсэн байгаа. Хуучин уламжлалт дүрмүүдийн синтаксын бүрэн тайлбарыг <a href="https://man.freebsd.org/cgi/man.cgi?query=ipf&amp;sektion=8&amp;format=html">ipf(8)</a> заавар хуудаснаас үзнэ үү.</p></div><div class=paragraph><p><code>#</code> гэсэн тэмдэгт тайлбарын эхлэлийг заах ба дүрэм бичсэн мөрийн төгсгөлд эсвэл өөрөө бүтэн мөр байдлаар байрлана. Хоосон мөрийг тооцохгүй.</p></div><div class=paragraph><p>Дүрмүүд нь түлхүүр үгүүдийг агуулна. Эдгээр түлхүүр үгүүд нь тухайн мөрөнд зүүнээс баруун тийш тодорхой дэс дараагаар бичигдэнэ. Түлхүүр үгүүд тодоор бичигдэх тул түүгээр нь ялгаж танина. Зарим түлхүүр үгүүд дэд-тохируулгатай байна. Тэр нь өөрөө түлхүүр үг байж болохоос гадна цааш дэд-тохируулгуудыг агуулсан байж болно. Доорх синтаксын үг бүр нь дор байрлах мөрүүдэд задаргааны хамт байгаа.</p></div><div class=paragraph><p><em>ACTION IN-OUT OPTIONS SELECTION STATEFUL PROTO SRC_ADDR,DST_ADDR OBJECT PORT_NUM TCP_FLAG STATEFUL</em></p></div><div class=paragraph><p><em>ACTION</em> = block | pass</p></div><div class=paragraph><p><em>IN-OUT</em> = in | out</p></div><div class=paragraph><p><em>OPTIONS</em> = log | quick | on interface-name</p></div><div class=paragraph><p><em>SELECTION</em> = proto value | source/destination IP | port = number | flags flag-value</p></div><div class=paragraph><p><em>PROTO</em> = tcp/udp | udp | tcp | icmp</p></div><div class=paragraph><p><em>SRC_ADD,DST_ADDR</em> = all | from object to object</p></div><div class=paragraph><p><em>OBJECT</em> = IP address | any</p></div><div class=paragraph><p><em>PORT_NUM</em> = port number</p></div><div class=paragraph><p><em>TCP_FLAG</em> = S</p></div><div class=paragraph><p><em>STATEFUL</em> = keep state</p></div><div class=sect3><h4 id=_action>31.5.11.1. ACTION<a class=anchor href=#_action></a></h4><div class=paragraph><p>Тухайн дүрмэнд тохирч байгаа пакетийг хэрхэхийг action буюу үйлдэл зааж өгнө. Бүх дүрэм үйлдэлтэй <em>байх ёстой</em>. Дараах үйлдлүүдийг хэрэглэж болно:</p></div><div class=paragraph><p><code>block</code> гэдэг нь пакеттай selection буюу сонголтын параметрүүд тохирч байвал тухайн пакетийг орхигдуулахыг зааж өгнө.</p></div><div class=paragraph><p><code>pass</code> гэдэг нь пакеттай selection буюу сонголтын параметрүүд тохирч байвал тухайн пакетийг нэвтрүүлэхийг зааж өгнө.</p></div></div><div class=sect3><h4 id=_in_out>31.5.11.2. IN-OUT<a class=anchor href=#_in_out></a></h4><div class=paragraph><p>Дүрэм нь орох болон гарах урсгалын алинд үйлчлэхийг заавал зааж өгөх ёстой. Энэ нь <code>in</code> эсвэл <code>out</code> түлхүүр үгийн аль нэг нь заавал бичигдсэн байх ёстой гэсэн үг юм. Үгүй бол синтаксын алдаа өгч, танигдахгүй.</p></div><div class=paragraph><p><code>in</code> гэдэг нь Интернэт уруу харж байгаа интерфэйс дээр хүлээж авсан дотогшоо ирж байгаа пакетийн хувьд энэ дүрэм үйлчлэхийг зааж өгнө.</p></div><div class=paragraph><p><code>out</code> гэдэг нь Интернэт уруу харж байгаа интерфэйс уруу чиглэсэн гадагшаа явж байгаа пакетийн хувьд энэ дүрэм үйлчлэхийг зааж өгнө.</p></div></div><div class=sect3><h4 id=_options>31.5.11.3. OPTIONS<a class=anchor href=#_options></a></h4><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Эдгээр options буюу тохируулгуудыг энд үзүүлсэн дэс дарааллын дагуу хэрэглэх ёстой.</p></div></td></tr></tbody></table></div><div class=paragraph><p><code>log</code> гэдэг нь пакеттай selection буюу сонголтын параметрүүд тохирч байвал пакетийн толгой <span class=filename>ipl</span> бүртгэл уруу (дор Бүртгэл Хөтлөх хэсэгт заасны дагуу) бичигдэхийг зааж өгнө.</p></div><div class=paragraph><p><code>quick</code> гэдэг нь пакеттай selection буюу сонголтын параметрүүд тохирч байвал энэ дүрэм нь хамгийн сүүлийн дүрэм болохыг зааж өгнө. Ингэснээр "short-circuit" замыг тухайн пакетийн хувьд дараагийн дүрмүүдийг шалгахыг болиулна. Орчин үеийн дүрэмтэй ажиллах логикийн хувьд энэ тохируулгыг заавал хэрэглэнэ.</p></div><div class=paragraph><p><code>on</code> гэдэг нь selection буюу сонголтын параметрүүдийн ажиллах интерфэйсийг зааж өгнө. Интерфэйсүүдийн нэрийг <a href="https://man.freebsd.org/cgi/man.cgi?query=ifconfig&amp;sektion=8&amp;format=html">ifconfig(8)</a>-н тусламжтай харж болно. Энэ тохируулгыг хэрэглэснээр, тухайн дүрэм зөвхөн энэ интерфэйсээр зохих чиглэлд(in/out) явж байгаа пакетийн хувьд үйлчилнэ. Орчин үеийн дүрэмтэй ажиллах логикийн хувьд энэ тохируулгыг заавал хэрэглэнэ.</p></div><div class=paragraph><p>Пакетийг бүртгэхэд, түүний толгойг IPL пакет бүртгэх хуурамч-төхөөрөмж уруу бичнэ. <code>log</code> түлхүүр үгийн дараа шууд залгаад, дараах тодотгогчдыг(дараах дэс дарааллаар) хэрэглэж болно:</p></div><div class=paragraph><p><code>body</code> гэдэг нь пакетийн толгойн дараа пакетийн агуулгын эхний 128 байтыг бүртгэхийг зааж өгнө.</p></div><div class=paragraph><p><code>first</code> Хэрэв <code>log</code> түлхүүр үг <code>keep state</code> тохируулгын хамт хэрэглэгдсэн бол, түүний араас ирэх "keep state"-д тохирч байгаа бүх пакетийг биш зөвхөн энэ тохируулгыг идэвхжүүлсэн эхний пакетийг бүртгэхийн тулд энэ тохируулгыг хэрэглэнэ.</p></div></div><div class=sect3><h4 id=_selection>31.5.11.4. SELECTION<a class=anchor href=#_selection></a></h4><div class=paragraph><p>Энэ бүлэгт танилцуулж байгаа түлхүүр үгүүд тухайн пакетийг дүрмэнд тохирсон эсэхийг тогтоохын тулд шалгадаг пакетийн онцлогийг тодорхойлоход хэрэглэгддэг. Мөн subject түлхүүр үг байх ба дэд-тохируулга түлхүүр үгийн аль нэгийг сонгон хэрэглэнэ. Дараах ерөнхий онцлогуудыг хэрэглэх боломжтой, гэхдээ доорх дэс дарааллаар хэрэглэх хэрэгтэй:</p></div></div><div class=sect3><h4 id=_proto>31.5.11.5. PROTO<a class=anchor href=#_proto></a></h4><div class=paragraph><p><code>proto</code> гэдэг нь subject түлхүүр үг бөгөөд өөрийн харгалзах дэд-тохируулгын хамт хэрэглэгдэх ёстой. Утга нь ямар протокол дээр ажиллахыг хэлж өгнө. Орчин үеийн дүрэмтэй ажиллах логикийн хувьд энэ тохируулгыг заавал хэрэглэнэ.</p></div><div class=paragraph><p><code>tcp/udp | udp | tcp | icmp</code> эсвэл <span class=filename>/etc/protocols</span> файл дотор байгаа протоколуудыг хэрэглэж болно. Тусгай <code>tcp/udp</code> гэсэн түлхүүр үг TCP эсвэл UDP пакетийг сонгоход хэрэглэгддэг ба, давхар эсвэл төстэй дүрмүүдийг арилгах үүднээс нэмэгдсэн байгаа.</p></div></div><div class=sect3><h4 id=_src_addrdst_addr>31.5.11.6. SRC_ADDR/DST_ADDR<a class=anchor href=#_src_addrdst_addr></a></h4><div class=paragraph><p><code>all</code> гэсэн түлхүүр үг нь өөр ямар ч параметргүй "from any to any" гэдэгтэй адил юм.</p></div><div class=paragraph><p><code>from src to dst</code>: <code>from</code> ба <code>to</code> гэсэн түлхүүр үгүүд IP хаягийг шүүхэд хэрэглэгдэнэ. Дүрэмд хэрэглэхдээ эхлэл ба очих параметрийг <em>хоёуланг</em> зааж өгөх ёстой. <code>any</code> гэсэн тусгай түлхүүр үгийн тусламжтай бүх IP хаягийг зөвшөөрч өгч болно. Хэрэглэх жишээ: <code>from any to any</code> эсвэл <code>from 0.0.0.0/0 to any</code> эсвэл <code>from any to 0.0.0.0/0</code> эсвэл <code>from 0.0.0.0 to any</code> эсвэл <code>from any to 0.0.0.0</code>.</p></div><div class=paragraph><p>Цэгээр тусгаарлагдсан тоо/баг хэлбэрээр хялбархан илэрхийлэх боломжгүй IP хаягуудыг хэрэглэх боломжгүй. <a class=package href=https://cgit.freebsd.org/ports/tree/net-mgmt/ipcalc/>net-mgmt/ipcalc</a> порт ашиглан үүнийг хялбарчилж болох юм. Нэмэлт мэдээллийг дараах вэб хуудсаар орж үзнэ үү: <a href=http://jodies.de/ipcalc>http://jodies.de/ipcalc</a>.</p></div></div><div class=sect3><h4 id=_port>31.5.11.7. PORT<a class=anchor href=#_port></a></h4><div class=paragraph><p>Хэрэв эхлэл эсвэл очих порт, эсвэл хоёулангаар нь тохируулах бол энэ нь зөвхөн TCP ба UDP пакетуудад хамаарна. Порт жишсэн дүрэм бичихдээ <span class=filename>/etc/services</span> файл доторх үйлчилгээний нэр эсвэл бүхэл тоон портын дугаарыг хэрэглэнэ. Портыг <code>from</code> обьекттой хамт хэрэглэх үед энэ нь эхлэл портын дугаарыг, <code>to</code> обьекттой хамт хэрэглэх үед энэ нь очих портын дугаарыг заана. Орчин үеийн дүрэмтэй ажиллах логикийн хувьд port тохиргоог <code>to</code> обьекттой заавал хамт хэрэглэнэ. Хэрэглэх жишээ: <code>from any to any port = 80</code></p></div><div class=paragraph><p>Портын харьцуулалтыг төрөл бүрийн жиших операторуудыг ашиглан хэд хэдэн аргаар хийж болно. Портын зурвасыг бас зааж өгч болно.</p></div><div class=paragraph><p>port "=" | "!=" | "&lt;" | ">" | "⇐" | ">=" | "eq" | "ne" | "lt" | "gt" | "le" | "ge".</p></div><div class=paragraph><p>Порт зурвасыг зааж өгөхдөө, port "&lt;>" | ">&lt;" гэж хэрэглэнэ.</p></div><div class="admonitionblock warning"><table><tbody><tr><td class=icon><i class="fa icon-warning" title=Warning></i></td><td class=content><div class=paragraph><p>Орчин үеийн дүрэмтэй ажиллах логикийн хувьд эхлэл болон очих порт тохируулах параметрүүдийн дараа, дараах хоёр параметрийг заавал хэрэглэнэ.</p></div></td></tr></tbody></table></div></div><div class=sect3><h4 id=_tcp_flag>31.5.11.8. TCP_FLAG<a class=anchor href=#_tcp_flag></a></h4><div class=paragraph><p>Тугуудыг зөвхөн TCP шүүлтийн үед хэрэглэнэ. Үсгүүдээр нь TCP пакетийн толгойтой таарч байгаа эсэхийг шалгах боломжит тугуудыг үзүүлсэн байна.</p></div><div class=paragraph><p>Орчин үеийн дүрэмтэй ажиллах логик нь <code>flags S</code> параметрийг tcp сесс эхлүүлэх хүсэлтийг тэмдэглэхдээ хэрэглэдэг.</p></div></div><div class=sect3><h4 id=_stateful>31.5.11.9. STATEFUL<a class=anchor href=#_stateful></a></h4><div class=paragraph><p><code>keep state</code> гэдэг нь нэвтрүүлэх төрлийн дүрмийн хувьд сонгох параметрүүдтэй тохирсан ямар ч пакет төлөвт шүүх нэмэлт боломжийг идэвхжүүлэх ёстойг зааж өгнө.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Орчин үеийн дүрэмтэй ажиллах логикийн хувьд энэ тохируулгыг заавал хэрэглэнэ.</p></div></td></tr></tbody></table></div></div></div><div class=sect2><h3 id=_төлөвт_шүүлт>31.5.12. Төлөвт шүүлт<a class=anchor href=#_төлөвт_шүүлт></a></h3><div class=paragraph><p>Хостуудын хоорондох хоёр чиглэлтэй пакет солилцоо сесс харилцаанаас бүрддэг. Төлөвт шүүлт нь урсгалыг сесс харилцаанаас бүрдэж буй хоёр чиглэлтэй пакет солилцоо гэж үздэг. keep-state-г идэвхжүүлсэн үед, keep-state нь хоёр чиглэлтэй сесс харилцааны үед солилцсон бүх пакетуудын хувьд дотоод дүрмүүдийг динамик байдлаар үүсгэдэг. Мөн энэ нь сесс эхлүүлсэн болон хүлээн авсан хостуудын хоорондох сесс харилцаа хоёр чиглэлтэй пакет солилцох процедуртай зохицож байгаа эсэхийг магадлах чадвартай байдаг. Сесс харилцааны загварт зохицоогүй пакетийг хуурамч гэж үзэн хүлээж авахгүй.</p></div><div class=paragraph><p>TCP эсвэл UDP сесстэй холбоотой ICMP пакетуудыг keep state нэвтрүүлнэ. Тэгэхээр, keep state дүрмээр зөвшөөрөгдсөн вэбээр хийх аялалын хариуд ICMP type 3 code 4 хариуг хүлээн авбал галт хана үүнийг автоматаар нэвтрүүлнэ гэсэн үг юм. Хэрэв IPF хүлээн авсан пакетийг идэвхтэй байгаа сессийн нэг хэсэг гэж баттай итгэж байвал, өөр протокол дээр байсан ч пакетийг нэвтрүүлнэ.</p></div><div class=paragraph><p>Үүний цаана юу болох вэ гэвэл:</p></div><div class=paragraph><p>Интернэт уруу холбогдсон интерфэйсээр гарч байгаа пакетуудыг хамгийн түрүүнд динамик төлвийн хүснэгтэнд шалгана. Хэрэв тухайн пакет ямар нэг идэвхтэй байгаа сесс харилцаанд оролцож байгаа зөвшөөрөгдсөн дараагийн пакет байх юм бол, галт ханаар нэвтрүүлэх ба динамик төлвийн хүснэгтэн дэх сесс харилцааны төлөв шинэчлэгдэнэ. Идэвхтэй сесс харилцаанд хамааралгүй пакетуудыг гадагшаа урсгалын дүрмээр шалгах болно.</p></div><div class=paragraph><p>Интернэт уруу холбогдсон интерфэйсээс ирж байгаа пакетуудыг хамгийн түрүүнд динамик төлвийн хүснэгтэнд шалгана. Хэрэв тухайн пакет ямар нэг идэвхтэй байгаа сесс харилцаанд оролцож байгаа зөвшөөрөгдсөн дараагийн пакет байх юм бол, галт ханаар нэвтрүүлэх ба динамик төлвийн хүснэгтэн дэх сесс харилцааны төлөв шинэчлэгдэнэ. Идэвхтэй сесс харилцаанд хамааралгүй пакетуудыг дотогшоо урсгалын дүрмээр шалгах болно.</p></div><div class=paragraph><p>Харилцаа дуусахад динамик төлвийн хүснэгтээс зохих бичлэг устгагдана.</p></div><div class=paragraph><p>Төлөвт шүүлтийн тусламжтайгаар та шинэ сесс зөвшөөрөх/хаах үйл ажиллагаан дээр төвлөрч ажиллаж чадна. Хэрэв шинэ сесс зөвшөөрөгдсөн бол түүний дараагийн бүх пакетуудыг автоматаар нэвтрүүлэх ба хуурамч пакетууд автоматаар буцаагдана. Хэрэв шинэ сесс хаагдсан бол түүний дараагийн ямар ч пакет нэвтэрч чадахгүй. Төлөвт шүүлт нь сүүлийн үеийн халдлагуудад ашиглагдаж байгаа аргуудын эсрэг хамгаалах чадвартай, техникийн хувьд өндөр түвшний шүүлт хийх чадвартай юм.</p></div></div><div class=sect2><h3 id=_хамааруулсан_дүрмийн_олонлогийн_жишээ>31.5.13. Хамааруулсан дүрмийн олонлогийн жишээ<a class=anchor href=#_хамааруулсан_дүрмийн_олонлогийн_жишээ></a></h3><div class=paragraph><p>Дараах дүрмийн олонлог нь аюулгүй байдлыг маш сайн хангасан, хамааруулсан галт ханын дүрмүүдийг хэрхэн бичих жишээ юм. Хамааруулсан галт хана нь зөвхөн <code>pass</code> дүрмүүдэд тохирсон үйлчилгээг зөвшөөрч, бусдыг бүгдийг хаана. Бусад машинуудыг хамгаалах ёстой галт хананууд буюу "сүлжээний галт хананууд" нь багаар бодоход хоёр интерфэйстэй байх ёстой бөгөөд ерөнхийдөө нэг талд (LAN) итгэж нөгөөд (Интернэт) итгэхгүй байхаар тохируулагдсан байдаг. Мөн ажиллаж байгаа системээ зөвхөн хамгаалахаар галт хана тохируулагдсан байж болох бөгөөд ийм галт ханыг "хостын галт хана" гэх бөгөөд энэ нь итгэлгүй сүлжээн дэх серверүүдийн хувьд ялангуяа тохиромжтой байдаг.</p></div><div class=paragraph><p>FreeBSD-г оролцуулаад бүх UNIX® төрлийн систем нь үйлдлийн систем дэх дотоод харилцаандаа <span class=filename>lo0</span> интерфэйс болон <code>127.0.0.1</code> гэсэн IP хаягийг хэрэглэхээр бүтээгдсэн байдаг. Галт ханын дүрмүүд нь дотооддоо хэрэглэж байгаа эдгээр пакетуудыг чөлөөтэй нэвтрүүлэх дүрмүүдийг агуулсан байх ёстой.</p></div><div class=paragraph><p>Интернэттэй холбогдож байгаа интерфэйс дээр Интернэт уруу гарч байгаа болон Интернэтээс ирж байгаа хандалтыг удирдах болон хянах дүрмүүдийг байрлуулна. Энэ нь таны PPP <span class=filename>tun0</span> интерфэйс эсвэл таны DSL эсвэл кабель модемд холбогдсон NIC байж болно.</p></div><div class=paragraph><p>Галт ханын цаана байгаа хувийн сүлжээнд нэг болон түүнээс дээш тооны NIC-ууд холбогдсон тохиолдолд, тэдгээр интерфэйсүүдийн хувьд тэдгээр LAN интерфэйсүүдийн нэгээс нөгөө рүү ба/эсвэл гадагш гарсан пакетуудыг чөлөөтэй нэвтрүүлэх дүрмийг агуулсан байх ёстой.</p></div><div class=paragraph><p>Дүрмүүд гурван үндсэн хэсэгт хуваагдан зохион байгуулагдсан байх ёстой: эхлээд итгэлтэй интерфэйсүүд, дараа нь нийтийн гадагшаа интерфэйс, төгсгөлд нь нийтийн итгэлтэй дотогшоо интерфэйс.</p></div><div class=paragraph><p>Нийтийн интерфэйс хэсэгт байгаа дүрмүүд тухайн интерфэйс болон чиглэлийн хувьд хамгийн олон тохиолддог дүрмүүд нь хамгийн түрүүнд, цөөн тохиолддог дүрмүүдээс өмнө байхаар, хаах болох бүртгэх дүрмүүд нь хамгийн сүүлд байхаар бичигдсэн байна.</p></div><div class=paragraph><p>Дараах жишээн дээрх Гадагшаа хэсэг нь Интернэт хандалтыг зөвшөөрч өгөх үйлчилгээг тодорхойлох сонголтын утгуудыг агуулсан зөвхөн <code>pass</code> дүрмүүдээс бүрдэж байна. Бүх дүрмүүд <code>quick</code>, <code>on</code>, <code>proto</code>, <code>port</code>, болон <code>keep state</code> тохируулгуудыг агуулсан байгаа. <code>proto tcp</code> дүрмүүд нь төлөвт байдлыг идэвхжүүлж байгаа пакетийг тодорхойлох байдлаар, сесс эхлүүлэх хүсэлтийг тодорхойлох зорилгоор <code>flag</code> тохируулгыг агуулсан байна.</p></div><div class=paragraph><p>Дотогшоо хэсэгт эхлээд хүсээгүй пакетуудыг хаах дүрмүүдийг бичсэн байна. Энэ нь хоёр өөр шалтгаантай. Эхнийх нь хортой пакетуудын зарим нь зөвшөөрсөн урсгалын хэсэг байж болох юм. <code>allow</code> дүрэмд таарч байгаа тэр хэсэг дээр тулгуурлан эдгээр пакетуудыг зөвшөөрөлгүйгээр хаах ёстой. Хоёр дахь шалтгаан нь тухайн хэсэгт байгаа хамгийн сүүлийн дүрмээр хааж бүртгэхийн оронд тэдгээр мэдэгдэж байгаа сонирхолгүй татгалзалтуудыг чимээгүйгээр хааж болох юм. Хэсэг бүр дэх сүүлийн дүрэм бүх пакетуудыг хааж бүртгэдэг бөгөөд таны систем рүү халдаж байгаа хүмүүсийг шүүхэд шаардагдах баримтыг бий болгоход ашиглагдаж болох юм.</p></div><div class=paragraph><p>Өөр нэг санаа тавин тэмдэглэн хэлэх зүйл бол хүсээгүй урсгалын хариуд ямар ч хариу явуулахгүй байх явдал юм. Буруу пакетуудыг зүгээр орхиж тэд алга болох ёстой юм. Ингэснээр халдлага явуулагч түүний явуулсан пакетууд таны системд хүрсэн эсэх талаар юу ч мэдэхгүй үлдэх болно. Таны системийн талаар хэдий хэр бага мэднэ, тэд ямар нэг муу зүйл хийж чадах хүртэл төдий чинээ урт хугацаа зарцуулна гэсэн үг юм. <code>log first</code> тохируулгыг агуулах дүрмүүд анхны удаа таарахад бүртгэж авдаг. Энэ тохируулга нь жишээ <code>nmap OS fingerprint</code> дүрэмд орсон байдаг. <a class=package href=https://cgit.freebsd.org/ports/tree/security/nmap/>security/nmap</a> хэрэгслийг халдагчид таны серверийн үйлдлийн системийг танихын тулд ихэвчлэн ашигладаг.</p></div><div class=paragraph><p><code>log first</code> дүрмийн хувьд бүртгэлийн мэдээлэл бүртгэгдэх бүрт <code>ipfstat -hio</code> тушаалаар энэ дүрэм хэдэн удаа тохирсон байгааг шалгаж болно. Ихээхэн хэмжээний бүртгэлийн мэдээлэл нь таныг халдлагад өртөж байгааг ихэвчлэн илэрхийлдэг.</p></div><div class=paragraph><p><span class=filename>/etc/services</span> файлыг ашиглан мэдэгдэхгүй портын дугаарыг хайж олж болох юм. Мөн <a href=http://en.wikipedia.org/wiki/List_of_TCP_and_UDP_port_numbers>http://en.wikipedia.org/wiki/List_of_TCP_and_UDP_port_numbers</a> хаягаар тухайн порт ямар зориулалтаар ашиглагддагийг орж шалгаж болох юм.</p></div><div class=paragraph><p>Троянуудын хэрэглэдэг портын дугааруудыг <a href=http://www.sans.org/security-resources/idfaq/oddports.php>http://www.sans.org/security-resources/idfaq/oddports.php</a> хаягаар орж шалгаарай.</p></div><div class=paragraph><p>Дараах дүрмийн олонлог нь ажиллаж байгаа систем дээр шалгагдсан аюулгүй байдлыг бүрэн хангасан хамааруулсан галт ханын дүрмийн олонлог юм. Үүнийг өөрийн системд хялбарханаар тааруулж болох юм. Зөвшөөрөхийг хүсэхгүй байгаа үйлчилгээнүүдийн хувьд харгалзах <code>pass</code> дүрмийг далдлаарай.</p></div><div class=paragraph><p>Хүсээгүй мэдээллийг бүртгэхгүйн тулд дотогшоо хэсэгт <code>block</code> дүрэм нэмж бичээрэй.</p></div><div class=paragraph><p>Дүрэм бүрт байгаа <span class=filename>dc0</span> гэсэн интерфэйсийн нэрийн оронд таны системийг Интернэт уруу холбож байгаа NIC картны интерфэйсийн нэрээр сольж тавиарай. Хэрэглэгчийн PPP-н хувьд, энэ нь <span class=filename>tun0</span> байна.</p></div><div class=paragraph><p>Дараах илэрхийллүүдийг <span class=filename>/etc/ipf.rules</span> дотор бичих хэрэгтэй:</p></div><div class="literalblock programlisting"><div class=content><pre>#################################################################
# No restrictions on Inside LAN Interface for private network
# Not needed unless you have LAN
#################################################################

#pass out quick on xl0 all
#pass in quick on xl0 all

#################################################################
# No restrictions on Loopback Interface
#################################################################
pass in quick on lo0 all
pass out quick on lo0 all

#################################################################
# Interface facing Public Internet (Outbound Section)
# Match session start requests originating from behind the
# firewall on the private network
# or from this gateway server destined for the public Internet.
#################################################################

# Allow out access to my ISP&#39;s Domain name server.
# xxx must be the IP address of your ISP&#39;s DNS.
# Dup these lines if your ISP has more than one DNS server
# Get the IP addresses from /etc/resolv.conf file
pass out quick on dc0 proto tcp from any to xxx port = 53 flags S keep state
pass out quick on dc0 proto udp from any to xxx port = 53 keep state

# Allow out access to my ISP&#39;s DHCP server for cable or DSL networks.
# This rule is not needed for &#39;user ppp&#39; type connection to the
# public Internet, so you can delete this whole group.
# Use the following rule and check log for IP address.
# Then put IP address in commented out rule &amp; delete first rule
pass out log quick on dc0 proto udp from any to any port = 67 keep state
#pass out quick on dc0 proto udp from any to z.z.z.z port = 67 keep state

# Allow out non-secure standard www function
pass out quick on dc0 proto tcp from any to any port = 80 flags S keep state

# Allow out secure www function https over TLS SSL
pass out quick on dc0 proto tcp from any to any port = 443 flags S keep state

# Allow out send &amp; get email function
pass out quick on dc0 proto tcp from any to any port = 110 flags S keep state
pass out quick on dc0 proto tcp from any to any port = 25 flags S keep state

# Allow out Time
pass out quick on dc0 proto tcp from any to any port = 37 flags S keep state

# Allow out nntp news
pass out quick on dc0 proto tcp from any to any port = 119 flags S keep state

# Allow out gateway &amp; LAN users&#39; non-secure FTP ( both passive &amp; active modes)
# This function uses the IPNAT built in FTP proxy function coded in
# the nat rules file to make this single rule function correctly.
# If you want to use the pkg_add command to install application packages
# on your gateway system you need this rule.
pass out quick on dc0 proto tcp from any to any port = 21 flags S keep state

# Allow out ssh/sftp/scp (telnet/rlogin/FTP replacements)
# This function is using SSH (secure shell)
pass out quick on dc0 proto tcp from any to any port = 22 flags S keep state

# Allow out insecure Telnet
pass out quick on dc0 proto tcp from any to any port = 23 flags S keep state

# Allow out FreeBSD CVSup
pass out quick on dc0 proto tcp from any to any port = 5999 flags S keep state

# Allow out ping to public Internet
pass out quick on dc0 proto icmp from any to any icmp-type 8 keep state

# Allow out whois from LAN to public Internet
pass out quick on dc0 proto tcp from any to any port = 43 flags S keep state

# Block and log only the first occurrence of everything
# else that&#39;s trying to get out.
# This rule implements the default block
block out log first quick on dc0 all

#################################################################
# Interface facing Public Internet (Inbound Section)
# Match packets originating from the public Internet
# destined for this gateway server or the private network.
#################################################################

# Block all inbound traffic from non-routable or reserved address spaces
block in quick on dc0 from 192.168.0.0/16 to any    #RFC 1918 private IP
block in quick on dc0 from 172.16.0.0/12 to any     #RFC 1918 private IP
block in quick on dc0 from 10.0.0.0/8 to any        #RFC 1918 private IP
block in quick on dc0 from 127.0.0.0/8 to any       #loopback
block in quick on dc0 from 0.0.0.0/8 to any         #loopback
block in quick on dc0 from 169.254.0.0/16 to any    #DHCP auto-config
block in quick on dc0 from 192.0.2.0/24 to any      #reserved for docs
block in quick on dc0 from 204.152.64.0/23 to any   #Sun cluster interconnect
block in quick on dc0 from 224.0.0.0/3 to any       #Class D &amp; E multicast

##### Block a bunch of different nasty things. ############
# That I do not want to see in the log

# Block frags
block in quick on dc0 all with frags

# Block short tcp packets
block in quick on dc0 proto tcp all with short

# block source routed packets
block in quick on dc0 all with opt lsrr
block in quick on dc0 all with opt ssrr

# Block nmap OS fingerprint attempts
# Log first occurrence of these so I can get their IP address
block in log first quick on dc0 proto tcp from any to any flags FUP

# Block anything with special options
block in quick on dc0 all with ipopts

# Block public pings
block in quick on dc0 proto icmp all icmp-type 8

# Block ident
block in quick on dc0 proto tcp from any to any port = 113

# Block all Netbios service. 137=name, 138=datagram, 139=session
# Netbios is MS/Windows sharing services.
# Block MS/Windows hosts2 name server requests 81
block in log first quick on dc0 proto tcp/udp from any to any port = 137
block in log first quick on dc0 proto tcp/udp from any to any port = 138
block in log first quick on dc0 proto tcp/udp from any to any port = 139
block in log first quick on dc0 proto tcp/udp from any to any port = 81

# Allow traffic in from ISP&#39;s DHCP server. This rule must contain
# the IP address of your ISP&#39;s DHCP server as it&#39;s the only
# authorized source to send this packet type. Only necessary for
# cable or DSL configurations. This rule is not needed for
# &#39;user ppp&#39; type connection to the public Internet.
# This is the same IP address you captured and
# used in the outbound section.
pass in quick on dc0 proto udp from z.z.z.z to any port = 68 keep state

# Allow in standard www function because I have apache server
pass in quick on dc0 proto tcp from any to any port = 80 flags S keep state

# Allow in non-secure Telnet session from public Internet
# labeled non-secure because ID/PW passed over public Internet as clear text.
# Delete this sample group if you do not have telnet server enabled.
#pass in quick on dc0 proto tcp from any to any port = 23 flags S keep state

# Allow in secure FTP, Telnet, and SCP from public Internet
# This function is using SSH (secure shell)
pass in quick on dc0 proto tcp from any to any port = 22 flags S keep state

# Block and log only first occurrence of all remaining traffic
# coming into the firewall. The logging of only the first
# occurrence avoids filling up disk with Denial of Service logs.
# This rule implements the default block.
block in log first quick on dc0 all
################### End of rules file #####################################</pre></div></div></div><div class=sect2><h3 id=_nat>31.5.14. NAT<a class=anchor href=#_nat></a></h3><div class=paragraph><p>NAT нь <em>Network Address Translation</em> буюу Сүлжээний хаягийн Хөрвүүлэлтийн товчлол юм. Linux®-н талаар ойлголттой хүмүүсийн хувьд, энэ ойлголтыг IP маскарад гэж нэрлэдэг; NAT ба IP маскарад нь нэг зүйл юм. IPF NAT-н бидэнд олгож байгаа олон зүйлүүдийн нэг бол галт ханын цаана байгаа Local Area Network буюу Ойрын Зайн Сүлжээ(LAN)-н хувьд ISP-с оноож өгсөн ганц IP хаягийг Интернэтэд хуваан хэрэглэх юм.</p></div><div class=paragraph><p>Ингэх ямар шаардлага байнаа гэж та гайхан асуух байх. ISP-ууд өөрийн ашгийн-бус хэрэглэгчиддээ ихэвчлэн динамик IP хаяг оноодог. Динамик гэдэг нь таныг ISP руу залган нэвтрэн орох болгонд, кабель эсвэл DSL модемтой хэрэглэгчдийн хувьд модемоо асааж унтраах болгонд өөр өөр IP хаяг онооно гэсэн үг юм. Таны системийг Интернэтэд танихад энэ динамик IP хаягийг ашигладаг.</p></div><div class=paragraph><p>Та гэртээ таван PC-тэй бөгөөд бүгд Интернэт уруу гардаг байх хэрэгтэй гэж бодъё. Тэгвэл та PC тус бүрт тусад нь эрх худалдан авч, таван утасны үзүүртэй байх хэрэгтэй болно.</p></div><div class=paragraph><p>NAT-н тусламжтай ISP-гаас зөвхөн ганцхан эрх шаардлагатай. Бусад дөрвөн PC-гээ switch буюу шилжүүлэгч уруу холбож, харин switch-ээ таны LAN-нд гарц байдлаар ажиллах FreeBSD системийн NIC руу залгана. NAT нь LAN-д байгаа бүх PC-ны хувьд хувийн IP хаягийг ганцхан гадаад IP хаяг уруу автоматаар хөрвүүлэх болно. NAT нь эргэж ирж байгаа пакетуудын хувьд эсрэг хөрвүүлэлтийг мөн хийнэ.</p></div><div class=paragraph><p>NAT хийгдсэн хувийн LAN-уудад зориулж бүлэг IP хаягийг тусгайлан гаргасан байдаг. RFC 1918 стандартад зааснаар бол, дараах бүлэг IP-г хувийн сүлжээндээ ашиглах боломжтой, эдгээр IP хэзээ ч гадаад Интернэт уруу гарахгүй болно:</p></div><table class="tableblock frame-none grid-all stretch informaltable"><col style=width:33.3333%><col style=width:33.3333%><col style=width:33.3334%><tbody><tr><td class="tableblock halign-left valign-top"><p class=tableblock>Эхлэх IP <code>10.0.0.0</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>-</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Төгсөх IP <code>10.255.255.255</code></p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>Эхлэх IP <code>172.16.0.0</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>-</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Төгсөх IP <code>172.31.255.255</code></p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>Эхлэх IP <code>192.168.0.0</code></p></td><td class="tableblock halign-left valign-top"><p class=tableblock>-</p></td><td class="tableblock halign-left valign-top"><p class=tableblock>Төгсөх IP <code>192.168.255.255</code></p></td></tr></tbody></table></div><div class=sect2><h3 id=_ipnat>31.5.15. IPNAT<a class=anchor href=#_ipnat></a></h3><div class=paragraph><p>NAT дүрмүүдийг <code>ipnat</code> тушаалын тусламжтай ачаална. Ихэвчлэн NAT дүрмүүд <span class=filename>/etc/ipnat.rules</span> файл дотор байрлана. Дэлгэрэнгүйг <a href="https://man.freebsd.org/cgi/man.cgi?query=ipnat&amp;sektion=8&amp;format=html">ipnat(8)</a> хэсгээс үзнэ үү.</p></div><div class=paragraph><p>NAT ажиллаж эхэлсний дараа NAT дүрмүүдэд өөрчлөлт оруулах шаардлагатай бол NAT дүрмүүд байгаа файл дотор өөрчлөлтийг хийсний дараа, одоо хэрэглэгдэж байгаа NAT дүрмүүдийг устгаж, хөрвүүлэгч хүснэгтийг цэвэрлэхийн тулд <code>ipnat</code> тушаалыг <code>-CF</code> тугийн хамт ажиллуулах хэрэгтэй.</p></div><div class=paragraph><p>Харин NAT дүрмүүдийг дахин ачаалахдаа тушаалыг дараах байдалтай өгөх хэрэгтэй:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># ipnat -CF -f /etc/ipnat.rules</span></code></pre></div></div><div class=paragraph><p>NAT-н талаар зарим статистикийг харъя гэвэл дараах тушаалыг ашиглана:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># ipnat -s</span></code></pre></div></div><div class=paragraph><p>NAT хүснэгтийн одоо ашиглаж байгаа оноолтын жагсаалтыг харахын тулд дараах тушаалыг ашиглана:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># ipnat -l</span></code></pre></div></div><div class=paragraph><p>Вербос буюу хэр зэрэг харуулах горимыг нээхийн тулд, дүрэмтэй ажиллах болон идэвхтэй байгаа дүрмүүдийн хүснэгтийг харахын тулд:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># ipnat -v</span></code></pre></div></div></div><div class=sect2><h3 id=_ipnat_дүрмүүд>31.5.16. IPNAT Дүрмүүд<a class=anchor href=#_ipnat_дүрмүүд></a></h3><div class=paragraph><p>NAT дүрмүүд нь маш уян хатан бөгөөд хэрэглэгчдийн хэрэгцээг хангах олон зүйлүүдийг хийж чадна.</p></div><div class=paragraph><p>Энд үзүүлсэн дүрмийн синтаксыг ашгийн-бус орчинд ихэвчлэн хэрэглэгддэг дүрмүүдэд зориулан хялбаршуулсан байгаа. Дүрмийн синтаксын бүрэн тайлбарыг <a href="https://man.freebsd.org/cgi/man.cgi?query=ipnat&amp;sektion=5&amp;format=html">ipnat(5)</a> заавар хуудаснаас үзнэ үү.</p></div><div class=paragraph><p>NAT дүрмийн синтакс дараах байдалтай байна:</p></div><div class="literalblock programlisting"><div class=content><pre>map IF LAN_IP_RANGE -&gt; PUBLIC_ADDRESS</pre></div></div><div class=paragraph><p>Дүрэм нь <code>map</code> гэсэн түлхүүр үгээр эхэлнэ.</p></div><div class=paragraph><p><em>IF</em>-г гадаад интерфэйсээр сольж тавьна.</p></div><div class=paragraph><p><em>LAN_IP_RANGE</em> нь танай дотоод хэрэглэгчийн хэрэглэж буй IP хаяглалтыг заана, ихэвчлэн <code>192.168.1.0/24</code> гэсэн маягтай байна.</p></div><div class=paragraph><p><em>PUBLIC_ADDRESS</em> нь гадаад IP байж болно эсвэл <em>IF</em>-д оноосон IP хаягийг хэрэглэхийг заасан <code>0/32</code> гэсэн тусгай түлхүүр үг байж болно.</p></div></div><div class=sect2><h3 id=_nat_хэрхэн_ажилладаг_вэ>31.5.17. NAT хэрхэн ажилладаг вэ<a class=anchor href=#_nat_хэрхэн_ажилладаг_вэ></a></h3><div class=paragraph><p>Гадаад очих хаягтай пакет галт хана дээр LAN-с хүрэлцэн ирнэ. Эхлээд гадагшаа шүүлтийн дүрмүүдээр гарна, дараа нь NAT-н ээлж ирэх ба өөрийн дүрмүүдийг дээрээс доош шалгаж эхэлнэ. Хамгийн эхэнд тохирсон нь дийлнэ. NAT өөрийн дүрэм бүрийг пакетийн интерфэйсийн нэр болон эхлэл хаягаар тулгаж шалгана. Пакетийн интерфэйсийн нэр NAT дүрэмтэй тохирвол пакетийн эхлэл IP хаяг (өөрөөр хэлбэл хувийн LAN IP хаяг) NAT дүрмийн сумны зүүн талд зааж өгсөн IP хаягийн зурвас дотор байгаа эсэхийг шалгана. Хэрэв энэ тохирвол пакетийн эхлэл хаягийг <code>0/32</code> түлхүүр үгийн тусламжтай олж авсан гадаад IP хаягаар сольж бичнэ. NAT өөрийн дотоод NAT хүснэгтэнд бичлэг нэмэх ба энэ нь пакет Интернэтээс буцаж ирэхэд түүнийг буцаан хувийн IP хаяг уруу нь хөрвүүлэн, цааш шүүлтийн дүрмүүдээр оруулах боломжийг олгоно.</p></div></div><div class=sect2><h3 id=_ipnat_г_идэвхжүүлэх>31.5.18. IPNAT-г идэвхжүүлэх<a class=anchor href=#_ipnat_г_идэвхжүүлэх></a></h3><div class=paragraph><p>IPNAT-г идэвхжүүлэхийн тулд эдгээр илэрхийллүүдийг <span class=filename>/etc/rc.conf</span> дотор нэмж бичнэ.</p></div><div class=paragraph><p>Өөрийн машиныг интерфэйсүүдийн хооронд пакетуудыг чиглүүлдэг болгохын тулд:</p></div><div class="literalblock programlisting"><div class=content><pre>gateway_enable=&#34;YES&#34;</pre></div></div><div class=paragraph><p>Систем ачаалахад IPNAT-г автоматаар ачаалдаг болгохын тулд:</p></div><div class="literalblock programlisting"><div class=content><pre>ipnat_enable=&#34;YES&#34;</pre></div></div><div class=paragraph><p>IPNAT-н дүрмүүдийг хаанаас ачаалахыг зааж өгөхдөө:</p></div><div class="literalblock programlisting"><div class=content><pre>ipnat_rules=&#34;/etc/ipnat.rules&#34;</pre></div></div></div><div class=sect2><h3 id=_маш_том_lan_д_зориулсан_nat>31.5.19. Маш том LAN-д зориулсан NAT<a class=anchor href=#_маш_том_lan_д_зориулсан_nat></a></h3><div class=paragraph><p>LAN-даа олон тооны PC-тэй сүлжээний хувьд эсвэл нэгээс олон LAN-тай сүлжээний хувьд, энэ олон хувийн IP хаягуудыг нэг гадаад IP хаяг уруу нийлүүлэх үйл явцад NAT хийгдсэн олон LAN PC дээр ижил портын дугаар олон дахин хэрэглэгдсэнээс мөргөлдөөн үүсэх гэх мэт нөөцтэй холбоотой асуудал гардаг. Нөөцтэй холбоотой энэ асуудлаас гарахын тулд дараах хоёр арга зам байдаг.</p></div><div class=sect3><h4 id=_хэрэглэх_портуудыг_оноох>31.5.19.1. Хэрэглэх портуудыг оноох<a class=anchor href=#_хэрэглэх_портуудыг_оноох></a></h4><div class=paragraph><p>Энгийн NAT дүрэм дараах байдалтай байна:</p></div><div class="literalblock programlisting"><div class=content><pre>map dc0 192.168.1.0/24 -&gt; 0/32</pre></div></div><div class=paragraph><p>Дээрх дүрмэнд пакет IPNAT-р дайрч өнгөрөхөд пакетийн эхлэл порт өөрчлөгдөхгүй. <code>portmap</code> гэсэн түлхүүр үгийг нэмсэнээр IPNAT-ийг заасан зурвас дахь зөвхөн эхлэл портуудыг ашиглахаар зааж өгнө. Жишээ нь, дараах дүрэм IPNAT-г эхлэл порт хаягийг тухайн зурвас дотор байхаар өөрчлөхийг зааж өгч байна.</p></div><div class="literalblock programlisting"><div class=content><pre>map dc0 192.168.1.0/24 -&gt; 0/32 portmap tcp/udp 20000:60000</pre></div></div><div class=paragraph><p>Дээр нь бид <code>auto</code> түлхүүр үгийн тусламжтай аль портуудыг ашиглах боломжтой байгааг өөрөө тодорхойлохыг зааж өгч болно:</p></div><div class="literalblock programlisting"><div class=content><pre>map dc0 192.168.1.0/24 -&gt; 0/32 portmap tcp/udp auto</pre></div></div></div><div class=sect3><h4 id=_гадаад_хаягийн_цөөрмийг_хэрэглэх>31.5.19.2. Гадаад хаягийн цөөрмийг хэрэглэх<a class=anchor href=#_гадаад_хаягийн_цөөрмийг_хэрэглэх></a></h4><div class=paragraph><p>Маш том LAN-уудын хувьд дэндүү олон LAN хаягуудыг нэг гадаад хаягт оноох нь боломжгүй болох үе ирдэг. Хэрэв бүлэг гадаад IP сул байгаа бол, эдгээр IP хаягуудыг "цөөрөм" байдлаар ашиглаж болох ба, IPNAT эдгээрээс нэгийг сонгон авч гадагшаа явж байгаа пакетийн хаягт оноох байдлаар хэрэглэх болно.</p></div><div class=paragraph><p>Жишээ нь, доор үзүүлсэн шиг бүх пакетуудыг ганц гадаад IP-д оноохын оронд:</p></div><div class="literalblock programlisting"><div class=content><pre>map dc0 192.168.1.0/24 -&gt; 204.134.75.1</pre></div></div><div class=paragraph><p>гадаад IP хаягийн зурвасыг сүлжээний хуваалтын хамт зааж өгч болно:</p></div><div class="literalblock programlisting"><div class=content><pre>map dc0 192.168.1.0/24 -&gt; 204.134.75.0/255.255.255.0</pre></div></div><div class=paragraph><p>эсвэл CIDR тэмдэглэгээг хэрэглэж болно:</p></div><div class="literalblock programlisting"><div class=content><pre>map dc0 192.168.1.0/24 -&gt; 204.134.75.0/24</pre></div></div></div></div><div class=sect2><h3 id=_портын_дахин_чиглүүлэлт>31.5.20. Портын дахин чиглүүлэлт<a class=anchor href=#_портын_дахин_чиглүүлэлт></a></h3><div class=paragraph><p>LAN дотор вэб сервер, цахим шуудангийн сервер, өгөгдлийн сангийн сервер болон DNS серверийг өөр өөр PC дээр тараан ажиллуулах нь түгээмэл байдаг. Энэ тохиолдолд эдгээр серверээс гарч байгаа урсгал мөн NAT хийгдсэн байх ёстой. Гэхдээ гаднаас ирж буй урсгалыг зөв LAN PC уруу дахин чиглүүлэх арга зам байх хэрэгтэй болно. Энэ асуудлыг шийдэхийн тулд IPNAT нь дахин чиглүүлэлт хийх NAT нэмэлт боломжийг олгодог. Вэб сервер <code>10.0.10.25</code> гэсэн LAN хаягтай бөгөөд <code>20.20.20.5</code> гэсэн ганц гадаад IP-тай байлаа гэж бодъё. Тэгвэл дүрмийг дараах байдалтай:</p></div><div class="literalblock programlisting"><div class=content><pre>rdr dc0 20.20.20.5/32 port 80 -&gt; 10.0.10.25 port 80</pre></div></div><div class=paragraph><p>эсвэл:</p></div><div class="literalblock programlisting"><div class=content><pre>rdr dc0 0.0.0.0/0 port 80 -&gt; 10.0.10.25 port 80</pre></div></div><div class=paragraph><p>эсвэл гаднаас DNS хүсэлтүүд хүлээн авдаг <code>10.0.10.33</code> гэсэн хаягтай LAN DNS Серверийн хувьд:</p></div><div class="literalblock programlisting"><div class=content><pre>rdr dc0 20.20.20.5/32 port 53 -&gt; 10.0.10.33 port 53 udp</pre></div></div><div class=paragraph><p>гэж бичих байсан.</p></div></div><div class=sect2><h3 id=_ftp_ба_nat>31.5.21. FTP ба NAT<a class=anchor href=#_ftp_ба_nat></a></h3><div class=paragraph><p>FTP-г Интернэт одоогийнх шиг байхаас өмнөх үе, их сургуулиуд түрээсийн шугамаар хоорондоо холбогдож, судлаач эрдэмтэд хоорондоо файл солилцохын тулд FTP-г ашигладаг байх үес үлдсэн үлэг гүрвэл гэж хэлж болох юм. Тэр үед өгөгдлийн аюулгүй байдлын талаар огт анхаардаггүй байлаа. Цаг хугацаа өнгөрөхөд FTP протоколыг шинээр гарч ирж байгаа Интернэтийн гол нуруу сүлжээнд хэрэглэх болсон ба түүний хэрэглэгчийн нэр, нууц үгийг цэвэр текст хэлбэрээр дамжуулдаг байдал нь хэзээ ч өөрчлөгдөөгүй бөгөөд орчин үеийн аюулгүй байдлын шаардлагад нийцэхгүй болсон билээ. FTP нь active буюу идэвхтэй, passive буюу идэвхгүй гэсэн хоёр горимд ажилладаг. Өгөгдлийн сувгийг хэрхэн ашиглаж байгаа дээр гол ялгаа нь гардаг. Өгөгдлийн сувгийг эхэлж ftp сесс хүсэгч нь авдаг тул идэвхгүй горимд ажиллах нь аюулгүй байдлыг илүүтэйгээр хангана. FTP-н талаар илүү сайн тайлбарыг болон түүний горимуудын талаар <a href=http://www.slacksite.com/other/ftp.html>http://www.slacksite.com/other/ftp.html</a> хаягаар үзнэ үү.</p></div><div class=sect3><h4 id=_ipnat_дүрмүүд_2>31.5.21.1. IPNAT Дүрмүүд<a class=anchor href=#_ipnat_дүрмүүд_2></a></h4><div class=paragraph><p>IPNAT нь дотроо NAT оноолт дүрэмд тодорхойлж өгөх боломжтой тусгай FTP прокси тохируулгыг агуулсан байдаг. Энэ нь идэвхтэй болон идэвхгүй FTP сесс эхлүүлэх хүсэлтэд оролцож байгаа бүх гадагшаа чиглэлтэй FTP пакетийг хянаж чадна. Мөн өгөгдлийн сувагт үнэхээр хэрэглэгдэж байгаа порт дугаарыг агуулсан түр зуурын шүүлтийн дүрмүүдийг динамикаар үүсгэж чадна. Ийм байдлаар FTP-с болж үүсдэг дээд хэсгийн портуудыг өргөн зурвасаар нээх эрсдэлээс галт ханыг хамгаалж байгаа юм.</p></div><div class=paragraph><p>Доорх дүрэм нь дотоод LAN-н бүх урсгалыг зохицуулна:</p></div><div class="literalblock programlisting"><div class=content><pre>map dc0 10.0.10.0/29 -&gt; 0/32 proxy port 21 ftp/tcp</pre></div></div><div class=paragraph><p>Доорх дүрэм гарцаас ирж буй FTP урсгалыг зохицуулна:</p></div><div class="literalblock programlisting"><div class=content><pre>map dc0 0.0.0.0/0 -&gt; 0/32 proxy port 21 ftp/tcp</pre></div></div><div class=paragraph><p>Доорх дүрэм дотоод LAN-с ирж буй бүх FTP-н биш урсгалыг зохицуулна:</p></div><div class="literalblock programlisting"><div class=content><pre>map dc0 10.0.10.0/29 -&gt; 0/32</pre></div></div><div class=paragraph><p>FTP оноолтын дүрэм нь бидний ердийн оноолтын дүрмүүдийн өмнө бичигдэнэ. Бүх пакетийг хамгийн дээр бичигдсэн дүрмээс эхлэн шалгана. Интерфэйсийн нэр тохирвол дотоод LAN эхлэл IP хаяг, дараа нь FTP пакет эсэхийг шалгана. Хэрэв бүгд тохирвол, тусгай FTP прокси эдгээр FTP сесс пакетуудыг NAT хийхээс гадна гадагш нь болон дотогш нь нэвтрүүлэх түр зуурын шүүлтийн дүрмийг үүсгэнэ. FTP-н биш бусад бүх LAN пакетууд эхний дүрмэнд тохирохгүй тул гуравдугаар дүрэм уруу шилжин дахин шалгагдана. Интерфэйс болон эхлэл IP тохирох тул NAT хийгдэнэ.</p></div></div><div class=sect3><h4 id=_ipnat_ftp_шүүлтийн_дүрмүүд>31.5.21.2. IPNAT FTP Шүүлтийн Дүрмүүд<a class=anchor href=#_ipnat_ftp_шүүлтийн_дүрмүүд></a></h4><div class=paragraph><p>NAT FTP прокси ашиглаж байгаа тохиолдолд FTP-н хувьд ганцхан шүүлтийн дүрэм хэрэгтэй.</p></div><div class=paragraph><p>FTP Прокси байхгүй бол дараах гурван дүрмийг хэрэглэнэ:</p></div><div class="literalblock programlisting"><div class=content><pre># Allow out LAN PC client FTP to public Internet
# Active and passive modes
pass out quick on rl0 proto tcp from any to any port = 21 flags S keep state

# Allow out passive mode data channel high order port numbers
pass out quick on rl0 proto tcp from any to any port &gt; 1024 flags S keep state

# Active mode let data channel in from FTP server
pass in quick on rl0 proto tcp from any to any port = 20 flags S keep state</pre></div></div></div></div></div></div><div class=sect1><h2 id=firewalls-ipfw>31.6. IPFW<a class=anchor href=#firewalls-ipfw></a></h2><div class=sectionbody><div class=paragraph><p>IPFIREWALL (IPFW) нь FreeBSD-ийн хандиваар FreeBSD-ийн сайн дурын гишүүдийн бүтээсэн, тэдний эрх мэдэлд байдаг галт ханын програм юм. Энэ нь хуучин уламжлалт төлөвт дүрмүүдийг хэрэглэдэг бөгөөд Simple Stateful logiс буюу Хялбар Төлөвт логикийг бий болгохын тулд уламжлалт дүрэм бичих техникийг хэрэглэдэг.</p></div><div class=paragraph><p>Стандарт FreeBSD суулгац дахь IPFW-н хялбар дүрмийн олонлог (<span class=filename>/etc/rc.firewall</span> болон <span class=filename>/etc/rc.firewall6</span> файл дотор байрлана) нь нилээд хялбар бөгөөд өөрт тохируулан засварласны дараа хэрэглэхээр бодолцон бичигдсэн байдаг. Жишээн дээр ихэнх суулгацад тохиромжтой төлөвт шүүлтийг хэрэглээгүй байгаа. Тиймээс энэ хэсэгт энэ жишээг хэрэглэхгүй болно.</p></div><div class=paragraph><p>IPFW-н төлөвт дүрмийн синтакс нь галт хана суулгах анхан шатны мэдлэгээс хол давсан техникийн хувьд ярвигтай сонголтын боломжуудаар хүч нэмсэн байдаг. IPFW нь мэргэжлийн түвшний хэрэглэгчид эсвэл өндөр түвшний пакет сонголт шаардлагатай байгаа техникийн өндөр түвшний компьютер сонирхогчид зориулагдсан юм. IPFW-н дүрмүүдийн хүчийг мэдрэхийн өмнө протоколууд өөрийн тусгай пакетийн толгойн мэдээллийг хэрхэн үүсгэдэг болон хэрэглэдэг талаар нилээд дэлгэрэнгүй мэдлэгийг олж авсан байх хэрэгтэй. Тийм түвшний тайлбарыг энд өгөх нь номын энэ бүлгийн мэдлээс халих тул энд оруулах боломжгүй юм.</p></div><div class=paragraph><p>IPFW нь долоон хэсгээс бүрдэнэ, гол хэсэг болох цөмийн галт ханын шүүлтийн дүрмийг боловсруулагч болон түүний бусад хэсэг болох пакет данслах боломж, бүртгэх боломж, NAT боломжийг идэвхжүүлэх <code>divert</code> дүрэм, болон өндөр түвшний тусгай зориулалттай боломжууд, dummynet трафик хязгаарлагч боломжууд, <code>fwd дүрэм</code> дамжуулах боломж, гүүр боломжууд, болон ipstealth боломжуудаас бүрдэнэ. IPFW нь IPv4 болон IPv6-г дэмждэг.</p></div><div class=sect2><h3 id=firewalls-ipfw-enable>31.6.1. IPFW-г идэвхжүүлэх<a class=anchor href=#firewalls-ipfw-enable></a></h3><div class=paragraph><p>IPFW нь FreeBSD үндсэн суулгацтай хамт, ажиллах үеийн ачаалах боломжтой модуль байдлаар ирдэг. <span class=filename>rc.conf</span> тохиргооны файл дотор <code>firewall_enable="YES"</code> илэрхийлэл байгаа үед систем IPFW цөмийн модулийг динамикаар ачаална. IPFW-г цөмд эмхэтгэх шаардлага байхгүй.</p></div><div class=paragraph><p><span class=filename>rc.conf</span> файл дотор <code>firewall_enable="YES"</code> илэрхийллийг нэмээд системийг дахин асаасны дараа ачаалах үйл явцын нэг хэсэг болж дараах мессеж дэлгэцэн дээр гарах болно:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>ipfw2 initialized, divert disabled, rule-based forwarding disabled, default to deny, logging disabled</code></pre></div></div><div class=paragraph><p>Ачаалах боломжтой модульд бүртгэх боломжийг эмхэтгээгүй байгаа. Бүртгэлийг идэвхжүүлж вербос бүртгэлийн хязгаарыг тогтоохын тулд <span class=filename>/etc/sysctl.conf</span> файл дотор тохируулж болох тохиргоо бий. Эдгээр илэрхийллүүдийг нэмсэнээр бүртгэлийн систем дараагийн удаа ачаалахад идэвхжинэ:</p></div><div class="literalblock programlisting"><div class=content><pre>net.inet.ip.fw.verbose=1
net.inet.ip.fw.verbose_limit=5</pre></div></div></div><div class=sect2><h3 id=firewalls-ipfw-kernel>31.6.2. Цөмийн тохируулгууд<a class=anchor href=#firewalls-ipfw-kernel></a></h3><div class=paragraph><p>FreeBSD цөм уруу дараах боломжуудыг эмхэтгэн IPFW-г идэвхжүүлэх албагүй болно. Суурь мэдлэг болгон энд үзүүллээ.</p></div><div class="literalblock programlisting"><div class=content><pre>options    IPFIREWALL</pre></div></div><div class=paragraph><p>Энэ тохируулга IPFW-г цөмийн нэг хэсэг болгон идэвхжүүлнэ</p></div><div class="literalblock programlisting"><div class=content><pre>options    IPFIREWALL_VERBOSE</pre></div></div><div class=paragraph><p>Энэ тохируулга <code>log</code> гэсэн түлхүүр үг орсон дүрмийн хувьд IPFW-р дайран өнгөрөх пакетуудыг бүртгэх боломжтой болгоно.</p></div><div class="literalblock programlisting"><div class=content><pre>options    IPFIREWALL_VERBOSE_LIMIT=5</pre></div></div><div class=paragraph><p>Энэ тохируулга <a href="https://man.freebsd.org/cgi/man.cgi?query=syslogd&amp;sektion=8&amp;format=html">syslogd(8)</a>-р нэгэн зэрэг бүртгэгдэж буй пакетийн тоог хязгаарлана. Галт ханын үйлдлүүдийг бүртгэхийг хүсэж байгаа дайсагнасан орчнуудад энэ тохируулгыг хэрэглэж болно. Энэ тохируулга нь syslog-г живүүлэх замаар явагдах үйлчилгээг зогсоох халдлагыг хааж өгөх болно.</p></div><div class="literalblock programlisting"><div class=content><pre>options    IPFIREWALL_DEFAULT_TO_ACCEPT</pre></div></div><div class=paragraph><p>Энэ тохируулга нь анхдагчаар галт ханыг дамжин өнгөрч байгаа бүх зүйлийг нэвтрүүлэхийг зөвшөөрөх бөгөөд энэ нь галт ханыг анх удаа тохируулж байгаа үед илүү тохиромжтой.</p></div><div class="literalblock programlisting"><div class=content><pre>options    IPDIVERT</pre></div></div><div class=paragraph><p>Энэ тохируулга NAT функцыг идэвхжүүлнэ.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Хэрэв та IPFIREWALL_DEFAULT_TO_ACCEPT-г оруулаагүй эсвэл ирж байгаа пакетуудыг нэвтрүүлэх дүрмүүд бичээгүй бол ирж байгаа болон явж байгаа бүх пакетуудыг галт хана хаах болно.</p></div></td></tr></tbody></table></div></div><div class=sect2><h3 id=firewalls-ipfw-rc>31.6.3. <span class=filename>/etc/rc.conf</span> Тохируулгууд<a class=anchor href=#firewalls-ipfw-rc></a></h3><div class=paragraph><p>Галт ханыг идэвхжүүлэхийн тулд:</p></div><div class="literalblock programlisting"><div class=content><pre>firewall_enable=&#34;YES&#34;</pre></div></div><div class=paragraph><p>FreeBSD-тэй хамт ирдэг анхдагч галт ханын төрлүүдээс нэгийг сонгохын тулд, <span class=filename>/etc/rc.firewall</span> файлыг уншсаны дараа нэгийг сонгоод, түүнийгээ дараах илэрхийлэлд бичиж өгнө:</p></div><div class="literalblock programlisting"><div class=content><pre>firewall_type=&#34;open&#34;</pre></div></div><div class=paragraph><p>Боломжит утгууд нь:</p></div><div class=ulist><ul><li><p><code>open</code> - бүх урсгалыг нэвтрүүлнэ.</p></li><li><p><code>client</code> - зөвхөн энэ машиныг хамгаална.</p></li><li><p><code>simple</code> - бүхэл бүтэн сүлжээг хамгаална.</p></li><li><p><code>closed</code> - loopback интерфэйсээс бусад IP урсгалыг боломжгүй болгоно.</p></li><li><p><code>UNKNOWN</code> - галт ханын дүрмүүдийг ачаалах боломжгүй болгоно.</p></li><li><p><span class=filename>filename</span> - галт ханын дүрмүүдийг агуулсан файлын бүрэн зам.</p></li></ul></div><div class=paragraph><p>ipfw галт хана уруу тусгайлан бэлдсэн дүрмүүдийг хоёр аргаар ачаалж болно. Нэг нь, <code>firewall_type</code> хувьсагчийн утганд <a href="https://man.freebsd.org/cgi/man.cgi?query=ipfw&amp;sektion=8&amp;format=html">ipfw(8)</a>-д зориулсан ямар ч тушаал мөрийн тохируулгагүйгээр бичигдсэн <em>галт ханын дүрмүүд</em>-г агуулсан файлын бүрэн замыг өгөх. Дараах нь орж байгаа болон гарч байгаа урсгалыг хаах дүрмийн энгийн жишээ юм:</p></div><div class="literalblock programlisting"><div class=content><pre>add deny in
add deny out</pre></div></div><div class=paragraph><p>Нөгөө нь, систем ачаалах үед ажиллах <code>ipfw</code> тушаалуудыг агуулсан ажиллах боломжтой скриптийн бүрэн замыг <code>firewall_script</code> хувьсагчид оноох юм. Дээр үзүүлсэн дүрмүүдийн файлтай дүйх дүрмүүдийн скрипт дараах байдалтай байна:</p></div><div class="literalblock programlisting"><div class=content><pre>#!/bin/sh

ipfw -q flush

ipfw add deny in
ipfw add deny out</pre></div></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Хэрэв <code>firewall_type</code> нь <code>client</code> эсвэл <code>simple</code> утгыг авсан бол, <span class=filename>/etc/rc.firewall</span> файл доторх анхдагч дүрмүүдийг тухайн машинд тохируулан өөрчлөх хэрэгтэй. Мөн энэ бүлэгт хэрэглэж байгаа жишээнүүдийн хувьд <code>firewall_script</code>-н утга <span class=filename>/etc/ipfw.rules</span> гэж үзэж байгаа болно.</p></div></td></tr></tbody></table></div><div class=paragraph><p>Бүртгэлийг идэвхжүүлэхийн тулд:</p></div><div class="literalblock programlisting"><div class=content><pre>firewall_logging=&#34;YES&#34;</pre></div></div><div class="admonitionblock warning"><table><tbody><tr><td class=icon><i class="fa icon-warning" title=Warning></i></td><td class=content><div class=paragraph><p><code>firewall_logging</code> хувьсагчийн хийх ганц зүйл гэвэл <code>net.inet.ip.fw.verbose</code> sysctl хувьсагчийн утгыг <code>1</code> болгох юм (<a href=#firewalls-ipfw-enable>IPFW-г идэвхжүүлэх</a> хэсгийг үзнэ үү). <span class=filename>rc.conf</span> дотор бүртгэлийг хязгаарлах хувьсагч байхгүй, харин үүний тулд sysctl хувьсагчаар дамжуулан хийж болно. <span class=filename>/etc/sysctl.conf</span> файл дотор эсвэл гараараа утгыг оноож өгч болно:</p></div><div class="literalblock programlisting"><div class=content><pre>net.inet.ip.fw.verbose_limit=5</pre></div></div></td></tr></tbody></table></div><div class=paragraph><p>Хэрэв таны машин гарц байдлаар ажиллаж байгаа бол, жишээ нь <a href="https://man.freebsd.org/cgi/man.cgi?query=natd&amp;sektion=8&amp;format=html">natd(8)</a>-н тусламжтай Сүлжээний хаягийн Хөрвүүлэлт (NAT) хийж байгаа бол, <span class=filename>/etc/rc.conf</span> файл доторх шаардлагатай тохируулгуудын мэдээллийг <a href=../advanced-networking/#network-natd>Network Address Translation буюу Сүлжээний Хаягийн Хөрвүүлэлт</a> хэсэг уруу хандана уу.</p></div></div><div class=sect2><h3 id=firewalls-ipfw-cmd>31.6.4. IPFW Тушаал<a class=anchor href=#firewalls-ipfw-cmd></a></h3><div class=paragraph><p>Галт ханыг ажиллаж байх явцад түүний идэвхтэй байгаа дотоод дүрмүүдэд шинэ дүрэм нэмэх, дүрэм хасах зэрэг өөрчлөлтүүдийг гараар хийх гол механизм бол <code>ipfw</code> тушаал юм. Энэ аргыг хэрэглэхэд тулгардаг нэг асуудал бол нэгэнт системийг унтраасан эсвэл зогсоосон бол нэмсэн эсвэл хассан эсвэл өөрчилсөн бүх дүрмүүд алга болно. Бүх дүрмүүдээ нэг файлд бичээд систем ачаалах үед энэ файлыг ашиглан дүрмүүдийг ачаалах, эсвэл одоо ажиллаж байгаа галт ханын дүрмүүдийг файл дотор хийсэн өөрчлөлтүүдээр бүхлээр нь сольж тавих нь энд хэрэглэж байгаа, та бүхэнд зөвлөх арга барил юм.</p></div><div class=paragraph><p>Удирдлагын дэлгэцэн дээр ажиллаж байгаа галт ханын дүрмүүдийг харуулахад <code>ipfw</code> тушаалыг одоо хэр нь хэрэглэсээр байна. IPFW-н данс хөтлөх боломж нь дүрэм бүрийн хувьд тухайн дүрэмд тохирсон пакетийг тоолох тоолуурыг үүсгэдэг. Ямар нэг дүрмийг шалгах үйл явцад тухайн дүрэм ажиллаж байгаа эсэхийг тогтоох аргуудын нэг бол дүрмийг тоолуурын хамт жагсаан харах байдаг.</p></div><div class=paragraph><p>Бүх дүрмүүдийг дараагаар нь жагсаан харахын тулд:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># ipfw list</span></code></pre></div></div><div class=paragraph><p>Бүх дүрмүүдийг тухайн дүрэм хамгийн сүүлд тохирсон цагны хамт жагсаан харахын тулд:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># ipfw -t list</span></code></pre></div></div><div class=paragraph><p>Дараагийн жишээ нь данслалтын мэдээлэл буюу дүрмүүдийг тохирсон пакетийн тооны хамт харуулж байна. Эхний багана нь дүрмийн дугаар, дараа нь энэ дүрэмд тохирсон гарч байгаа пакетийн тоо, дараа нь энэ дүрэмд тохирсон орж байгаа пакетийн тоо, тэгээд дүрэм өөрөө байна.</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># ipfw -a list</span></code></pre></div></div><div class=paragraph><p>Статик дүрмүүдээс гадна динамик дүрмүүдийг жагсаан харахын тулд:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># ipfw -d list</span></code></pre></div></div><div class=paragraph><p>Мөн хугацаа нь дууссан динамик дүрмүүдийг харахын тулд:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># ipfw -d -e list</span></code></pre></div></div><div class=paragraph><p>Тоолууруудыг тэглэхийн тулд:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># ipfw zero</span></code></pre></div></div><div class=paragraph><p>Зөвхөн <em>NUM</em> дугаартай тоолуурыг тэглэхийн тулд:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># ipfw zero NUM</span></code></pre></div></div></div><div class=sect2><h3 id=firewalls-ipfw-rules>31.6.5. IPFW Дүрмийн Олонлог<a class=anchor href=#firewalls-ipfw-rules></a></h3><div class=paragraph><p>Пакет дотор агуулагдаж байгаа утгуудыг үндэслэн тухайн пакетийг нэвтрүүлэх болон хаахыг хэлж байгаа дүрмүүдийг IPFW дүрмийн олонлог гэнэ. Хостуудын хоорондох хоёр чиглэлтэй пакет солилцоо нь сесс харилцааг бүрдүүлнэ. Галт ханын дүрмийн олонлог нь Интернэтээс ирж байгаа пакетууд болон тэдгээрт хариу болж системээс явж байгаа пакетуудыг боловсруулдаг. Бүх TCP/IP үйлчилгээнүүдийн хувьд (жишээ нь: telnet, www, mail, г.м.) протокол болон зөвшөөрөгдсөн (сонсох) портыг урьдчилан тодорхойлсон байдаг. Тухайн нэг үйлчилгээ рүү чиглэсэн пакетууд нь зөвшөөрөгдөөгүй (өндөр) портууд ашиглан эх хаягаас гарч очих хаягийн тухайн үйлчилгээний порт руу хүрдэг. Дээрх өгөгдлүүд (өөрөөр хэлбэл портууд ба хаягууд) нь үйлчилгээнүүдийг зөвшөөрөх эсвэл хаах дүрмүүдийг үүсгэхэд шалгуур болон ашиглагдаж болно.</p></div><div class=paragraph><p>Пакетийг галт хана хүлээн аваад дүрмийн олонлогт байгаа хамгийн эхний дүрэмтэй тулгах ба цааш дүрмүүдийн дугаарын өсөх дарааллын дагуу дээрээс доош нэг нэгээр шалгаж эхэлнэ. Пакет аль нэг дүрмийн сонголтын параметртай тохирвол, түүнд харгалзах үйлдлийг хийж, тухайн пакетийн хувьд цааш хайлтыг дуусгана. Энэ аргыг "эхэнд тохирсон нь дийлнэ" хайлтын арга гэнэ. Хэрэв тухайн пакет ямар ч дүрэмд тохирохгүй бол, энэ пакетийг 65535 дугаартай бүх пакетийг хааж, явуулсан хүнд нь ямар ч хариу өгөлгүй орхигдуулна гэсэн IPFW-н анхдагч дүрэмд албаар тохируулна.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p><code>count</code>, <code>skipto</code> ба <code>tee</code> дүрмүүдийн дараа хайлт үргэлжилнэ.</p></div></td></tr></tbody></table></div><div class=paragraph><p>Энд байгаа зааварчилгаанууд нь төлөвт <code>keep state</code>, <code>limit</code>, <code>in</code>, <code>out</code> болон <code>via</code> зэрэг тохируулгуудыг агуулсан дүрмүүд дээр үндэслэгдсэн байгаа. Энэ бол хамааруулсан галт ханын дүрмийн олонлогийг бичих үндсэн арга барил юм.</p></div><div class="admonitionblock warning"><table><tbody><tr><td class=icon><i class="fa icon-warning" title=Warning></i></td><td class=content><div class=paragraph><p>Галт ханын дүрмүүдтэй ажиллахдаа маш анхааралтай байх хэрэгтэй. Зарим тохиргоо серверээс <em>бүх холбоог тань тасалж</em> мэднэ.</p></div></td></tr></tbody></table></div><div class=sect3><h4 id=firewalls-ipfw-rules-syntax>31.6.5.1. Дүрмийн Синтакс<a class=anchor href=#firewalls-ipfw-rules-syntax></a></h4><div class=paragraph><p>Энд үзүүлсэн дүрмийн синтакс нь стандарт хамааруулсан галт хана үүсгэхэд шаардлагатай дүрмийн олонлогийг бичих хэмжээнд тохируулан хялбаршуулсан байгаа. Дүрмийн синтаксын бүрэн тайлбарыг <a href="https://man.freebsd.org/cgi/man.cgi?query=ipfw&amp;sektion=8&amp;format=html">ipfw(8)</a> заавар хуудаснаас үзнэ үү.</p></div><div class=paragraph><p>Дүрмүүд нь түлхүүр үгүүдийг агуулна. Эдгээр түлхүүр үгүүд нь тухайн мөрөнд зүүнээс баруун тийш тодорхой дэс дараагаар бичигдэнэ. Түлхүүр үгүүд тодоор бичигдэх тул түүгээр нь ялгаж танина. Зарим түлхүүр үгүүд дэд-тохируулгатай байна. Тэр нь өөрөө түлхүүр үг байж болохоос гадна цааш дэд-тохируулгуудыг агуулсан байж болно.</p></div><div class=paragraph><p><code>#</code> гэсэн тэмдэгт тайлбарын эхлэлийг заах ба дүрэм бичсэн мөрийн төгсгөлд эсвэл өөрөө бүтэн мөр байдлаар байрлана. Хоосон мөрийг тооцохгүй.</p></div><div class=paragraph><p><em>CMD RULE_NUMBER ACTION LOGGING SELECTION STATEFUL</em></p></div><div class=sect4><h5 id=_cmd>31.6.5.1.1. CMD<a class=anchor href=#_cmd></a></h5><div class=paragraph><p>Шинэ дүрэм бүр дотоод хүснэгтэнд бичигдэхийн тулд <span class=parameter>add</span> гэсэн түлхүүр үгийг өмнөө агуулж байх ёстой.</p></div></div><div class=sect4><h5 id=_rule_number>31.6.5.1.2. RULE_NUMBER<a class=anchor href=#_rule_number></a></h5><div class=paragraph><p>Дүрэм бүр өөрийн дүрмийн дугаартай холбоотой бөгөөд 1..65535-н дотор байдаг.</p></div></div><div class=sect4><h5 id=_action_2>31.6.5.1.3. ACTION<a class=anchor href=#_action_2></a></h5><div class=paragraph><p>Тухайн дүрмийн сонголтын үзүүлэлтэд пакет тохироход заасан action буюу үйлдлийг гүйцэтгэх ба дүрэм нь дараах үйлдлүүдийн аль нэгтэй холбогдсон байна.</p></div><div class=paragraph><p><span class=parameter>allow | accept | pass | permit</span></p></div><div class=paragraph><p>Эдгээр нь бүгд нэг зүйлийг, тухайлбал: дүрэмд тохирсон пакетуудыг нэвтрүүлж, галт ханын дүрэмтэй ажиллах явцаас гарахыг хэлж өгч байна. Эдгээр дүрмүүдийн дараа хайлт дуусна.</p></div><div class=paragraph><p><span class=parameter>check-state</span></p></div><div class=paragraph><p>нь динамик дүрмийн хүснэгттэй пакетуудыг тулгана. Хэрэв тохирвол, энэ динамик дүрмийг үүсгэсэн дүрэмд харгалзах үйлдлийг гүйцэтгэнэ, үгүй бол дараагийн дүрэмд шилжинэ. check-state дүрэмд сонголтын шалгуур байхгүй. Хэрэв дүрмийн олонлогт check-state дүрэм байхгүй бол эхний keep-state эсвэл limit дүрмийг динамик дүрмийн хүснэгттэй тулгана.</p></div><div class=paragraph><p><span class=parameter>deny | drop</span></p></div><div class=paragraph><p>Энэ хоёр үг хоёул дүрэмд тохирсон пакетуудыг хаяхыг заана. Хайлт энд дуусна.</p></div></div><div class=sect4><h5 id=_бүртгэл_хөтлөлт>31.6.5.1.4. Бүртгэл хөтлөлт<a class=anchor href=#_бүртгэл_хөтлөлт></a></h5><div class=paragraph><p><span class=parameter>log</span> эсвэл <span class=parameter>logamount</span></p></div><div class=paragraph><p>Пакет <code>log</code> гэсэн түлхүүр үг орсон дүрэмд тохироход, энэ тухай мессеж <a href="https://man.freebsd.org/cgi/man.cgi?query=syslogd&amp;sektion=8&amp;format=html">syslogd(8)</a> уруу SECURITY гэсэн facility нэртэйгээр бүртгэгдэнэ. Зөвхөн тухайн дүрмийн хувьд бүртгэгдсэн пакетийн тоо <code>logamount</code> параметрийн утгыг даваагүй тохиолдолд бүртгэл явагдана. Хэрэв <code>logamount</code>-н утгыг зааж өгөөгүй бол, sysctl-н <code>net.inet.ip.fw.verbose_limit</code> хувьсагчийн утгыг хязгаарын утга болгон авна. Аль ч тохиолдолд тэг гэсэн утга бүртгэлийн хязгаарыг үгүй болгоно. Хязгаарт тулсан тохиолдолд, бүртгэлийг дахин идэвхжүүлэхийн тулд бүртгэлийн тоолуурыг эсвэл тухайн дүрмийн пакет тоолуурыг дахин эхлүүлнэ. <code>ipfw reset log</code> тушаалыг үзнэ үү.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Бүртгэл нь бусад бүх пакет тохирох нөхцлүүд амжилттай нотлогдсоны дараа, мөн тухайн пакет дээр эцсийн үйлдлийг(зөвшөөрөх, татгалзах) хийхийн өмнө явагдана. Ямар дүрмүүдийн хувьд бүртгэл явуулахыг та шийдэх болно.</p></div></td></tr></tbody></table></div></div><div class=sect4><h5 id=_сонголт>31.6.5.1.5. Сонголт<a class=anchor href=#_сонголт></a></h5><div class=paragraph><p>Энд танилцуулах түлхүүр үгнүүд нь тухайн пакет дүрэмд тохирч байгаа үгүй эсэхийг тодорхойлох үед, шалгагдаж байгаа пакетийн шинжүүдийг тодорхойлно. Дараах байнгын хэрэглээний шинжүүд өгөгдсөн байдаг ба доорх дэс дарааллаар хэрэглэнэ:</p></div><div class=paragraph><p><span class=parameter>udp | tcp | icmp</span></p></div><div class=paragraph><p><span class=filename>/etc/protocols</span> файлд байгаа ямар ч протоколын нэрийг бас хэрэглэж болно. Харин утга нь шалгагдах протоколын нэрийг заана. Энэ бол заавал тавигдах шаардлага юм.</p></div><div class=paragraph><p><span class=parameter>from src to dst</span></p></div><div class=paragraph><p><code>from</code> ба <code>to</code> гэсэн түлхүүр үгүүд IP хаягийг шүүхэд хэрэглэгдэнэ. Дүрмэнд хэрэглэхдээ эхлэл ба очих параметрүүдийг <em>ХОЁУЛАНГ</em> зааж өгөх ёстой. <code>any</code> гэсэн тусгай түлхүүр үгийн тусламжтай бүх IP хаягийг зөвшөөрч өгч болно. <code>me</code> гэсэн тусгай түлхүүр үг нь таны FreeBSD системийн аль нэг интерфэйс дээр тохируулсан IP хаягийг заах ба галт хана ажиллаж байгаа PC-г (өөрөөр хэлбэл энэ машин) <code>from me to any</code> эсвэл <code>from any to me</code> эсвэл <code>from 0.0.0.0/0 to any</code> эсвэл <code>from any to 0.0.0.0/0</code> эсвэл <code>from 0.0.0.0 to any</code> эсвэл <code>from any to 0.0.0.0</code> or <code>from me to 0.0.0.0</code> гэсэн байдлаар төлөөлнө. IP хаягуудыг цэгтэй тоон хэлбэр/багийн-урт байдлаар эсвэл зүгээр цэгтэй тоон хэлбэрээр бичиж болно. Энэ бол заавал тавигдах шаардлага юм. Тооцооллыг хялбар болгохын тулд <a class=package href=https://cgit.freebsd.org/ports/tree/net-mgmt/ipcalc/>net-mgmt/ipcalc</a> портыг ашиглаж болох юм. Нэмэлт мэдээллийг хэрэгслийн вэб хуудаснаас үзэж болно: <a href=http://jodies.de/ipcalc>http://jodies.de/ipcalc</a></p></div><div class=paragraph><p><span class=parameter>port number</span></p></div><div class=paragraph><p>Портын дугаарыг дэмждэг протоколуудын хувьд (TCP ба UDP гэх мэт), тааруулахыг хүсэж байгаа портын дугаарыг заавал бичиж өгөх ёстой байдаг. Портын тоон утгын оронд үйлчилгээний нэрийг(<span class=filename>/etc/services</span> файлаас) хэрэглэж болно.</p></div><div class=paragraph><p><span class=parameter>in | out</span></p></div><div class=paragraph><p>Орж байгаа болон гарч байгаа пакетуудыг харгалзан тааруулна. <code>in</code> ба <code>out</code> нь түлхүүр үгүүд бөгөөд дүрэмд тааруулах шалгуур болгож энэ хоёр үгийн аль нэгийг заавал бичсэн байх ёстой.</p></div><div class=paragraph><p><span class=parameter>via IF</span></p></div><div class=paragraph><p>Нэрээр нь зааж өгсөн интерфэйсээр дайран өнгөрч буй пакетуудыг тааруулна. <code>via</code> гэсэн түлхүүр үг нь тухайн интерфэйсийг тааруулах үйл явцын нэг хэсэг байдлаар байнга шалгаж байхыг зааж өгнө.</p></div><div class=paragraph><p><span class=parameter>setup</span></p></div><div class=paragraph><p>Энэ түлхүүр үг нь TCP пакетуудын хувьд сесс эхлүүлэх хүсэлтийг зааж өгч байгаа заавал хэрэглэх түлхүүр үг юм.</p></div><div class=paragraph><p><span class=parameter>keep-state</span></p></div><div class=paragraph><p>Энэ бол заавал хэрэглэх түлхүүр үг юм. Дүрэм таарахад, галт хана яг тэр протоколыг ашиглан эхлэл болон очих IP/портын хооронд үүсэх хоёр чиглэлтэй урсгалыг тааруулах анхдагч чанартай динамик дүрэм үүсгэнэ.</p></div><div class=paragraph><p><span class=parameter>limit {src-addr | src-port | dst-addr | dst-port}</span></p></div><div class=paragraph><p>Дүрэмд заасантай адил параметрүүдтэй холболтын тоог <em>N</em>-р хязгаарлана. Нэг ба түүнээс дээш тооны эхлэл болон очих хаягууд, портуудыг зааж өгч болно. <code>limit</code> ба <code>keep-state</code>-г нэг дүрэмд хамтад нь хэрэглэж болохгүй. <code>limit</code> тохируулга нь <code>keep-state</code>-тэй адил төлөвт функцуудыг гүйцэтгэхээс гадна өөрийн нэмэлт функцүүлтэй.</p></div></div></div><div class=sect3><h4 id=_төлөвт_дүрмийн_тохируулгууд>31.6.5.2. Төлөвт Дүрмийн Тохируулгууд<a class=anchor href=#_төлөвт_дүрмийн_тохируулгууд></a></h4><div class=paragraph><p>Төлөвт шүүлт нь урсгалыг сесс харилцаанаас бүрдэж буй хоёр чиглэлтэй пакет солилцоо гэж үздэг. Мөн энэ нь сесс эхлүүлсэн болон хүлээн авсан хостуудын хоорондох сесс харилцаа нь хоёр чиглэлтэй пакет солилцох процедуртай зохицож байгаа эсэхийг магадлах чадвартай байдаг. Сесс харилцааны загварт зохицоогүй пакетийг хуурамч гэж үзэн хүлээж авахгүй.</p></div><div class=paragraph><p><code>check-state</code> нь IPFW дүрмийн олонлогийн хаана нь пакетийг динамик дүрмүүдийн боломжоор шалгахыг тогтооно. Таарсан тохиолдолд, пакет галт ханыг нэвтэрч цааш явах ба энэ хоёр чиглэлт сесс харилцааны туршид солилцох пакетуудын хувьд шинэ динамик дүрэм үүснэ. Таараагүй тохиолдолд, пакет дүрмийн олонлогийн дараагийн дүрэмд шалгагдахаар шилжинэ.</p></div><div class=paragraph><p>Динамик дүрмүүдийн боломж нь маш олон тооны динамик дүрмүүдийг нээдэг SYN-живүүлэх халдлагаас үүсэх нөөцийн хомсдолд эмзэг байдаг. Энэ халдлагаас зайлсхийхийн тулд FreeBSD <code>limit</code> гэсэн шинэ тохируулгыг нэмж өгсөн байдаг. Энэ тохируулгын тусламжтай нэгэн зэрэг явагдах сесс харилцааны тоог хязгаарлана. <code>limit</code> тохируулгад зааж өгсөн эхлэл болон очих талбаруудаар пакетийн IP хаягийг асуулга явуулах замаар шалгасны дараа, энэ дүрэмд энэ IP хаягийн хослол хэдэн удаа таарсан тоог харгалзан хэрэв энэ тоо <code>limit</code>-д зааснаас давсан бол тухайн пакетийг гээнэ.</p></div></div><div class=sect3><h4 id=_галт_ханын_мессежийг_бүртгэх>31.6.5.3. Галт ханын мессежийг бүртгэх<a class=anchor href=#_галт_ханын_мессежийг_бүртгэх></a></h4><div class=paragraph><p>Бүртгэл хөтлөлтийн ашиг тус тодорхой юм: Таны бүртгэхээр идэвхжүүлсэн дүрмүүдийн хувьд, ямар пакетууд гээгдсэн, тэдгээр нь ямар хаягаас ирсэн, хаашаа явж байсан зэрэг мэдээллийг эргэн харах боломжийг олгох ба гадны халдлагыг мөрдөхөд танд чухал хувь нэмэр болно.</p></div><div class=paragraph><p>Бүртгэл хөтлөх боломжийг идэвхжүүлсэн хэдий ч, IPFW нь өөрөө ямар ч дүрмийг үүсгэхгүй. Администратор аль дүрмүүдийн хувьд бүртгэл явуулахыг шийдэн, тэдгээр дүрмүүддээ <code>log</code> гэсэн түлхүүр үгийг нэмж бичнэ. Ихэвчлэн зөвхөн татгалзах дүрмүүдийг бүртгэдэг, жишээлбэл ирж буй ICMP ping-г татгалзах гэх мэт. Хамгийн сүүлд байгаа "ipfw default deny everything" дүрмийг хувилан <code>log</code> түлхүүр үгтэйгээр үүсгэх нь элбэг байдаг. Ийм байдлаар дүрмийн олонлогийн аль ч дүрмэнд таараагүй пакетуудыг харах боломжтой болно.</p></div><div class=paragraph><p>Бүртгэл хөтлөлт нь хоёр талдаа иртэй сэлэмтэй адил юм, хэрэв та хайхрамжгүй хандвал, диск дүүрэн бүртгэлийн мэдээлэл дотроо учраа олохгүй суух болно. Дискийг дүүргэх DoS халдлага нь хамгийн эртний халдлагуудын нэг юм. Эдгээр бүртгэлийн мессеж нь syslogd-д бичигдэхээс гадна, root консол дэлгэцэн дээр гарах учир удахгүй ядаргаатай санагдаж эхэлдэг.</p></div><div class=paragraph><p><code>IPFIREWALL_VERBOSE_LIMIT=5</code> гэсэн цөмийн тохируулга нь системийн бүртгэл хөтлөгч болох <a href="https://man.freebsd.org/cgi/man.cgi?query=syslogd&amp;sektion=8&amp;format=html">syslogd(8)</a> уруу шидэгдэж байгаа тухайн дүрэмд тохирсон пакетад харгалзах дараалсан мессежийн тоог хязгаарлана. Энэ тохируулгыг идэвхжүүлсэн үед, тодорхой дүрмийн хувьд дараалсан мессежийн тоог зааж өгсөн тоогоор хязгаарлана. Нэг ижил зүйлийг хэлсэн 200 бүртгэлийн бичлэгээс мэдэж авах зүйл хомс юм. Жишээ нь, тодорхой дүрмийн хувьд дараалсан таван бичлэг syslogd-д бичигдэнэ, үлдсэн дараалсан ижил бичлэгүүд тоологдоод syslogd-д дараах байдалтай бичигдэнэ:</p></div><div class="literalblock programlisting"><div class=content><pre>last message repeated 45 times</pre></div></div><div class=paragraph><p>Бүртгэл хөтлөгдөж байгаа бүх пакетуудын мессежүүд <span class=filename>/etc/syslog.conf</span> файлд анхдагч байдлаар зааж өгсөн <span class=filename>/var/log/security</span> файлд бичигдэнэ.</p></div></div><div class=sect3><h4 id=firewalls-ipfw-rules-script>31.6.5.4. Дүрмийн скриптийг бүтээх<a class=anchor href=#firewalls-ipfw-rules-script></a></h4><div class=paragraph><p>Туршлагатай IPFW хэрэглэгчид дүрмүүдийг агуулсан файл үүсгээд түүнийгээ скрипт байдлаар ажиллуулах боломжтой байхаар бичдэг. Үүний гол давуу тал нь дүрмүүдийг идэвхжүүлэхийн тулд системийг дахин ачаалах шаардлагагүй болно. Энэ аргыг ашиглан хэдэн ч удаа дараалан галт ханын дүрмүүдийг ачаалж болох тул шинэ дүрмүүдийг шалгах үед хэрэглэхэд тохиромжтой байдаг. Скрипт учраас олон дахин бичигдэж байгаа утгын оронд симбол орлуулалтыг ашиглах боломжтой. Энэ талаар дараах жишээн дээрээс харна уу.</p></div><div class=paragraph><p>Энд хэрэглэгдсэн скриптийн синтакс нь <a href="https://man.freebsd.org/cgi/man.cgi?query=sh&amp;sektion=1&amp;format=html">sh(1)</a>, <a href="https://man.freebsd.org/cgi/man.cgi?query=csh&amp;sektion=1&amp;format=html">csh(1)</a>, <a href="https://man.freebsd.org/cgi/man.cgi?query=tcsh&amp;sektion=1&amp;format=html">tcsh(1)</a> бүрхүүл дээр ажиллах боломжтой. Симбол орлуулалттай талбарууд нь урдаа $ буюу долларын тэмдэгтэй байна. Симбол талбарууд нь $ тэмдэг урдаа байхгүй. Симбол талбарыг орлох утга нь давхар хашилтан (<code>"</code>) дотор байрлана.</p></div><div class=paragraph><p>Дүрмийн файлаа дараах байдалтай үүсгэж эхлэх хэрэгтэй:</p></div><div class="literalblock programlisting"><div class=content><pre>############### start of example ipfw rules script #############
#
ipfw -q -f flush       # Delete all rules
# Set defaults
oif=&#34;tun0&#34;             # out interface
odns=&#34;192.0.2.11&#34;      # ISP&#39;s DNS server IP address
cmd=&#34;ipfw -q add &#34;     # build rule prefix
ks=&#34;keep-state&#34;        # just too lazy to key this each time
$cmd 00500 check-state
$cmd 00502 deny all from any to any frag
$cmd 00501 deny tcp from any to any established
$cmd 00600 allow tcp from any to any 80 out via $oif setup $ks
$cmd 00610 allow tcp from any to $odns 53 out via $oif setup $ks
$cmd 00611 allow udp from any to $odns 53 out via $oif $ks
################### End of example ipfw rules script ############</pre></div></div><div class=paragraph><p>Байх ёстой бүх зүйлс бүгд байна. Энэ жишээн дээр дүрмүүд чухал биш, харин симбол орлуулалт хэрхэн ажилладагыг харуулсан байна.</p></div><div class=paragraph><p>Хэрэв дээрх жишээ <span class=filename>/etc/ipfw.rules</span> нэртэй файл дотор байсан бол, эдгээр дүрмүүдийг дараах тушаалыг өгч дахин ачаалах боломжтой:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># sh /etc/ipfw.rules</span></code></pre></div></div><div class=paragraph><p><span class=filename>/etc/ipfw.rules</span> гэсэн файл ямар ч нэртэй байж болох ба таны хүссэн ямар ч газар байж болно.</p></div><div class=paragraph><p>Дараах скриптийг хоёр аргын нэгээр хэрэглэж болно:</p></div><div class=paragraph><p>Дээрхтэй адил зүйлсийг дараах тушаалыг гараар оруулан гүйцэтгэж болно:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># ipfw -q -f flush</span>
<span class=c># ipfw -q add check-state</span>
<span class=c># ipfw -q add deny all from any to any frag</span>
<span class=c># ipfw -q add deny tcp from any to any established</span>
<span class=c># ipfw -q add allow tcp from any to any 80 out via tun0 setup keep-state</span>
<span class=c># ipfw -q add allow tcp from any to 192.0.2.11 53 out via tun0 setup keep-state</span>
<span class=c># ipfw -q add 00611 allow udp from any to 192.0.2.11 53 out via tun0 keep-state</span></code></pre></div></div></div><div class=sect3><h4 id=_төлөвт_дүрмийн_олонлог>31.6.5.5. Төлөвт дүрмийн олонлог<a class=anchor href=#_төлөвт_дүрмийн_олонлог></a></h4><div class=paragraph><p>Дараах NAT хийгдээгүй дүрмийн олонлог нь аюулгүй байдлыг маш сайн хангасан, хамааруулсан галт ханын дүрмүүдийг хэрхэн бичих жишээ юм. Хамааруулсан галт хана нь зөвхөн pass дүрмүүдэд тохирсон үйлчилгээг зөвшөөрч, бусдыг бүгдийг хаана. Сүлжээний бүх сегментийг хамгаалахаар хийгдсэн галт хананууд хамгийн багадаа хоёр интерфэйстэй байх ба галт хана маягаар ажиллахын тулд дүрмүүдийг тусгайлан зааж өгсөн байна.</p></div><div class=paragraph><p>FreeBSD-г оролцуулаад бүх UNIX® төрлийн систем нь үйлдлийн систем дэх дотоод харилцаандаа lo0 интерфэйс болон 127.0.0.1 гэсэн IP хаягийг хэрэглэхээр бүтээгдсэн байдаг. Галт ханын дүрмүүд нь дотооддоо хэрэглэж байгаа эдгээр пакетуудыг чөлөөтэй нэвтрүүлэх дүрмүүдийг агуулсан байх ёстой.</p></div><div class=paragraph><p>Интернэттэй холбогдож байгаа интерфэйс дээр гадагшаа болон дотогшоо холболтуудыг удирдах болон хянах дүрмүүдийг байрлуулна. Энэ нь таны PPP <span class=filename>tun0</span> интерфэйс эсвэл таны DSL эсвэл кабель модемд холбогдсон NIC байж болно.</p></div><div class=paragraph><p>Галт ханын цаана байгаа хувийн LAN-уудад нэг болон түүнээс дээш тооны NIC-ууд холбогдсон тохиолдолд, тэдгээр интерфэйсүүдийн хувьд тэдгээр LAN интерфэйсүүдээс ирсэн пакетуудыг чөлөөтэй нэвтрүүлэх дүрмийг агуулсан байх ёстой.</p></div><div class=paragraph><p>Дүрмүүд эхлээд гурван үндсэн хэсэгт хуваагдан зохион байгуулагдсан байх ёстой: бүх чөлөөт халдашгүй интерфэйсүүд, нийтийн гадагшаа интерфэйс болон нийтийн дотогшоо интерфэйс.</p></div><div class=paragraph><p>Нийтийн интерфэйс бүр дээр байгаа дүрмүүдийн дараалал нь хамгийн олон тохиолддог дүрмүүд нь хамгийн түрүүнд цөөн тохиолддог дүрмүүдээс өмнө байхаар, тухайн интерфэйс болон чиглэлийн хувьд хаах болон бүртгэх дүрмүүд нь хамгийн сүүлд байхаар бичигдсэн байна.</p></div><div class=paragraph><p>Дараах жишээн дээрх гадагшаа хэсэг нь Интернэт хандалтыг зөвшөөрч өгөх үйлчилгээг тодорхойлох сонголтын утгуудыг агуулсан зөвхөн <code>allow</code> дүрмүүдээс бүрдэж байна. Бүх дүрмүүд <code>proto</code>, <code>port</code>, <code>in/out</code>, <code>via</code> ба <code>keep state</code> тохируулгуудыг агуулсан байгаа. <code>proto tcp</code> дүрмүүд нь төлөвт байдлыг идэвхжүүлж байгаа пакетийг keep state төлөвт хүснэгтэд нэмэх байдлаар, сесс эхлүүлэх хүсэлтийг тодорхойлох зорилгоор <code>setup</code> тохируулгыг агуулсан байна.</p></div><div class=paragraph><p>Дотогшоо хэсэгт эхлээд хүсээгүй пакетуудыг хаах дүрмүүдийг бичсэн байна. Энэ нь хоёр өөр шалтгаантай. Эхнийх нь хортой пакетууд нь зөвшөөрөгдсөн пакетийн нэг хэсэг байж болох талтай. Эдгээр пакетуудыг <code>allow</code> дүрэмд таарсан хэсэг дээр тулгуурлан зөвшөөрөлгүйгээр орхих ёстой. Хоёр дахь шалтгаан нь тухайн хэсгийн хамгийн сүүлийн дүрмээр хааж бүртгэхийн оронд мэдэгдэж байгаа, сонирхолгүй пакетуудыг чимээгүйхэн хааж болох юм. Бүх пакетуудыг бүртгээд хаадаг хэсгийн хамгийн сүүлийн дүрмийг өөрийн систем уруу халдаж байгаа хүмүүсийг шүүхэд шаардагдах халдлагын нотолгоог цуглуулахад хэрэглэж болно.</p></div><div class=paragraph><p>Өөр нэг тэмдэглэн хэлэх зүйл бол, хүсээгүй пакетуудын хариуд ямар ч хариу явуулахгүй байх ёстойг санах хэрэгтэй. Буруу пакетууд орхигдож алга болох ёстой. Ингэснээр халдлага явуулагч нь түүний явуулсан пакетууд таны системд хүрсэн эсэх талаар юу ч мэдэхгүй үлдэх болно. Таны системийн талаар хэдий хэр бага мэднэ, төдий чинээ аюулгүй байна гэсэн үг юм. Танигдаагүй портын дугаартай пакетуудын хувьд <span class=filename>/etc/services/</span> файлаас эсвэл <a href=http://en.wikipedia.org/wiki/List_of_TCP_and_UDP_port_numbers>http://en.wikipedia.org/wiki/List_of_TCP_and_UDP_port_numbers</a> хаягаар тухайн порт ямар зориулалтаар ашиглагддагийг орж шалгаарай. Троянуудын хэрэглэдэг портын дугааруудыг <a href=http://www.sans.org/security-resources/idfaq/oddports.php>http://www.sans.org/security-resources/idfaq/oddports.php</a> хаягаар орж шалгаарай.</p></div></div><div class=sect3><h4 id=_хамааруулсан_дүрмийн_олонлогийн_жишээ_2>31.6.5.6. Хамааруулсан дүрмийн олонлогийн жишээ<a class=anchor href=#_хамааруулсан_дүрмийн_олонлогийн_жишээ_2></a></h4><div class=paragraph><p>Дараах NAT хийгдээгүй дүрмийн олонлог нь бүрэн хэмжээний хамааруулсан дүрмийн олонлог байгаа юм. Та энэ дүрмүүдийг өөрийн системдээ ашиглахад буруудах юмгүй. Зөвшөөрөхийг хүсэхгүй байгаа үйлчилгээнүүдийн хувьд харгалзах <code>pass</code> дүрмийг далдлаарай. Хэрэв бүртгэлд байгаа зарим мэдэгдлийг дахин харахыг хүсэхгүй, бүртгэхийг хүсэхгүй байгаа бол дотогшоо хэсэгт <code>deny</code> дүрэм нэмж бичээрэй. Дүрэм бүрт байгаа <span class=filename>dc0</span> гэсэн интерфэйсийн нэрийн оронд таны системийг Интернэт уруу холбож байгаа NIC картны интерфэйсийн нэрээр сольж тавиарай. Хэрэглэгчийн PPP-н хувьд, энэ нь <span class=filename>tun0</span> байна.</p></div><div class=paragraph><p>Эдгээр дүрмүүдийг хэрэглэх явцад хэв маяг олж харах болно.</p></div><div class=ulist><ul><li><p>Интернэт уруу чиглэсэн сесс эхлүүлэх хүсэлтийг төлөөлж байгаа илэрхийллүүд бүгд <code>keep-state</code> хэрэглэж байгаа.</p></li><li><p>Интернэтээс ирж буй бүх зөвшөөрөгдсөн үйлчилгээнүүд живүүлэх халдлагыг зогсоох үүднээс <code>limit</code> гэсэн тохируулгын хамт бичигдсэн байгаа.</p></li><li><p>Бүх дүрмүүд чиглэлийг тодотгохын тулд <code>in</code> эсвэл <code>out</code>-г хэрэглэсэн байгаа.</p></li><li><p>Бүх дүрмүүд пакетийн дайран өнгөрөх <em>interface-name</em> интерфэйсийг тодорхойлж өгөхдөө <code>via</code>-г хэрэглэсэн байгаа.</p></li></ul></div><div class=paragraph><p>Дараах дүрмүүд <span class=filename>/etc/ipfw.rules</span> дотор байрлана.</p></div><div class="literalblock programlisting"><div class=content><pre>################ Start of IPFW rules file ###############################
# Flush out the list before we begin.
ipfw -q -f flush

# Set rules command prefix
cmd=&#34;ipfw -q add&#34;
pif=&#34;dc0&#34;     # public interface name of NIC
              # facing the public Internet

#################################################################
# No restrictions on Inside LAN Interface for private network
# Not needed unless you have LAN.
# Change xl0 to your LAN NIC interface name
#################################################################
#$cmd 00005 allow all from any to any via xl0

#################################################################
# No restrictions on Loopback Interface
#################################################################
$cmd 00010 allow all from any to any via lo0

#################################################################
# Allow the packet through if it has previous been added to the
# the &#34;dynamic&#34; rules table by a allow keep-state statement.
#################################################################
$cmd 00015 check-state

#################################################################
# Interface facing Public Internet (Outbound Section)
# Interrogate session start requests originating from behind the
# firewall on the private network or from this gateway server
# destined for the public Internet.
#################################################################

# Allow out access to my ISP&#39;s Domain name server.
# x.x.x.x must be the IP address of your ISP.s DNS
# Dup these lines if your ISP has more than one DNS server
# Get the IP addresses from /etc/resolv.conf file
$cmd 00110 allow tcp from any to x.x.x.x 53 out via $pif setup keep-state
$cmd 00111 allow udp from any to x.x.x.x 53 out via $pif keep-state

# Allow out access to my ISP&#39;s DHCP server for cable/DSL configurations.
# This rule is not needed for .user ppp. connection to the public Internet.
# so you can delete this whole group.
# Use the following rule and check log for IP address.
# Then put IP address in commented out rule &amp; delete first rule
$cmd 00120 allow log udp from any to any 67 out via $pif keep-state
#$cmd 00120 allow udp from any to x.x.x.x 67 out via $pif keep-state

# Allow out non-secure standard www function
$cmd 00200 allow tcp from any to any 80 out via $pif setup keep-state

# Allow out secure www function https over TLS SSL
$cmd 00220 allow tcp from any to any 443 out via $pif setup keep-state

# Allow out send &amp; get email function
$cmd 00230 allow tcp from any to any 25 out via $pif setup keep-state
$cmd 00231 allow tcp from any to any 110 out via $pif setup keep-state

# Allow out FBSD (make install &amp; CVSUP) functions
# Basically give user root &#34;GOD&#34; privileges.
$cmd 00240 allow tcp from me to any out via $pif setup keep-state uid root

# Allow out ping
$cmd 00250 allow icmp from any to any out via $pif keep-state

# Allow out Time
$cmd 00260 allow tcp from any to any 37 out via $pif setup keep-state

# Allow out nntp news (i.e. news groups)
$cmd 00270 allow tcp from any to any 119 out via $pif setup keep-state

# Allow out secure FTP, Telnet, and SCP
# This function is using SSH (secure shell)
$cmd 00280 allow tcp from any to any 22 out via $pif setup keep-state

# Allow out whois
$cmd 00290 allow tcp from any to any 43 out via $pif setup keep-state

# deny and log everything else that.s trying to get out.
# This rule enforces the block all by default logic.
$cmd 00299 deny log all from any to any out via $pif

#################################################################
# Interface facing Public Internet (Inbound Section)
# Check packets originating from the public Internet
# destined for this gateway server or the private network.
#################################################################

# Deny all inbound traffic from non-routable reserved address spaces
$cmd 00300 deny all from 192.168.0.0/16 to any in via $pif  #RFC 1918 private IP
$cmd 00301 deny all from 172.16.0.0/12 to any in via $pif     #RFC 1918 private IP
$cmd 00302 deny all from 10.0.0.0/8 to any in via $pif          #RFC 1918 private IP
$cmd 00303 deny all from 127.0.0.0/8 to any in via $pif        #loopback
$cmd 00304 deny all from 0.0.0.0/8 to any in via $pif            #loopback
$cmd 00305 deny all from 169.254.0.0/16 to any in via $pif   #DHCP auto-config
$cmd 00306 deny all from 192.0.2.0/24 to any in via $pif       #reserved for docs
$cmd 00307 deny all from 204.152.64.0/23 to any in via $pif  #Sun cluster interconnect
$cmd 00308 deny all from 224.0.0.0/3 to any in via $pif         #Class D &amp; E multicast

# Deny public pings
$cmd 00310 deny icmp from any to any in via $pif

# Deny ident
$cmd 00315 deny tcp from any to any 113 in via $pif

# Deny all Netbios service. 137=name, 138=datagram, 139=session
# Netbios is MS/Windows sharing services.
# Block MS/Windows hosts2 name server requests 81
$cmd 00320 deny tcp from any to any 137 in via $pif
$cmd 00321 deny tcp from any to any 138 in via $pif
$cmd 00322 deny tcp from any to any 139 in via $pif
$cmd 00323 deny tcp from any to any 81 in via $pif

# Deny any late arriving packets
$cmd 00330 deny all from any to any frag in via $pif

# Deny ACK packets that did not match the dynamic rule table
$cmd 00332 deny tcp from any to any established in via $pif

# Allow traffic in from ISP&#39;s DHCP server. This rule must contain
# the IP address of your ISP.s DHCP server as it.s the only
# authorized source to send this packet type.
# Only necessary for cable or DSL configurations.
# This rule is not needed for .user ppp. type connection to
# the public Internet. This is the same IP address you captured
# and used in the outbound section.
#$cmd 00360 allow udp from any to x.x.x.x 67 in via $pif keep-state

# Allow in standard www function because I have apache server
$cmd 00400 allow tcp from any to me 80 in via $pif setup limit src-addr 2

# Allow in secure FTP, Telnet, and SCP from public Internet
$cmd 00410 allow tcp from any to me 22 in via $pif setup limit src-addr 2

# Allow in non-secure Telnet session from public Internet
# labeled non-secure because ID &amp; PW are passed over public
# Internet as clear text.
# Delete this sample group if you do not have telnet server enabled.
$cmd 00420 allow tcp from any to me 23 in via $pif setup limit src-addr 2

# Reject &amp; Log all incoming connections from the outside
$cmd 00499 deny log all from any to any in via $pif

# Everything else is denied by default
# deny and log all packets that fell through to see what they are
$cmd 00999 deny log all from any to any
################ End of IPFW rules file ###############################</pre></div></div></div><div class=sect3><h4 id=_nat_болон_төлөвт_дүрмийн_олонлогийн_жишээ>31.6.5.7. NAT болон Төлөвт дүрмийн олонлогийн жишээ<a class=anchor href=#_nat_болон_төлөвт_дүрмийн_олонлогийн_жишээ></a></h4><div class=paragraph><p>IPFW-н NAT функцыг идэвхжүүлэхийн тулд зарим нэмэлт тохиргооны илэрхийллүүдийг идэвхжүүлэх хэрэгтэй болдог. Цөмийн эх кодын бусад IPFIREWALL илэрхийллүүд дээр <code>option IPDIVERT</code> илэрхийллийг нэмж эмхэтгэн тусгайлан бэлдсэн цөмийг гаргаж авах хэрэгтэй.</p></div><div class=paragraph><p><span class=filename>/etc/rc.conf</span> доторх энгийн IPFW тохируулгууд дээр нэмж дараах тохируулгууд хэрэгтэй болно.</p></div><div class="literalblock programlisting"><div class=content><pre>natd_enable=&#34;YES&#34;                   # Enable NATD function
natd_interface=&#34;rl0&#34;                # interface name of public Internet NIC
natd_flags=&#34;-dynamic -m&#34;            # -m = preserve port numbers if possible</pre></div></div><div class=paragraph><p>Төлөвт дүрмүүдийг <code>divert natd</code> (Сүлжээний хаягийн Хөрвүүлэлт) дүрмийн хамт хэрэглэх нь дүрмийн олонлог бичих логикийг төвөгтэй болгодог. <code>check-state</code> ба <code>divert natd</code> дүрмүүдийн дүрмийн олонлог дахь байрлал нь маш их нөлөөтэй. Энэ нь хялбар дайраад-өнгөрөх логик урсгал биш болно. <code>skipto</code> гэсэн шинэ үйлдлийн төрлийг хэрэглэх болно. <code>skipto</code>-г хэрэглэхдээ <code>skipto</code> дүрмийн дугаар хаашаа үсрэхээ мэдэж байхын тулд бүх дүрмүүдийг дугаарлах хэрэгтэй болно.</p></div><div class=paragraph><p>Дараах тайлбаргүй жишээн дээр пакет дүрмийн олонлогоор дайрч өнгөрөх дарааллыг тайлбарлахаар сонгон авсан дүрэм бичих арга байгаа юм.</p></div><div class=paragraph><p>Дүрэмтэй ажиллах процесс дүрмийн файлд байгаа хамгийн эхний дүрмээр эхлэн цааш дүрмүүдийг нэг нэгээр уншин, файлын төгсгөл хүртэл эсвэл пакет аль нэг дүрмийн сонголтын шалгуурт тохирч галт ханыг орхих хүртэл үргэлжилнэ. 100, 101, 450, 500, ба 510 дугаартай дүрмүүдийн байрлалыг сайн анзаарах хэрэгтэй. Эдгээр дүрмүүд нь гадагшаа болон дотогшоо чиглэлтэй пакетуудын хөрвүүлэлтийг удирдах бөгөөд ингэснээр keep-state динамик хүснэгтэн дэх тэдгээрт харгалзах мөрөнд хувийн LAN IP хаяг бүртгэгдсэн байх нөхцөлийг хангана. Дараа нь, бүх зөвшөөрөх болон татгалзах дүрмүүдэд пакетийн явж буй чиглэл (өөрөөр хэлбэл гадагшаа эсвэл дотогшоо) ба интерфэйсийг зааж өгсөн байгааг анзаараарай. Мөн гадагшаа сесс эхлүүлэх хүсэлтүүд, сүлжээний хаягийн хөрвүүлэлтийн бүх <code>skipto rule 500</code>-с эхэлж байгааг анзаарна уу.</p></div><div class=paragraph><p>Нэгэн LAN хэрэглэгч вэб хуудас үзэхийн тулд вэб хөтчийг хэрэглэж байна гэж бодъё. Веб хуудсууд 80-р портоор дамждаг. Пакет галт хананд ирнэ, гадагшаа чиглэж байгаа тул 100-р дүрмэнд тохирохгүй. 101-р дүрмийг мөн өнгөрнө, яагаад гэвэл энэ нь хамгийн анхны пакет тул keep-state динамик хүснэгтэнд хараахан бичигдэж амжаагүй байгаа. Пакет эцэст нь 125-р дүрэм дээр ирж, дүрэмд таарна. Энэ пакет Интернэт уруу харсан NIC-р гадагшаа гарч байгаа. пакетийн эхлэл IP хаяг нь хувийн LAN IP хаяг хэвээр байгаа. Энэ дүрмэнд таарах үед хоёр үйлдэл хийгдэнэ. <code>keep-state</code> тохируулга энэ дүрмийг keep-state динамик дүрмийн хүснэгтэнд нэмнэ, мөн зааж өгсөн үйлдлийг гүйцэтгэнэ. Үйлдэл нь динамик хүснэгтэд нэмэгдсэн мэдээллийн нэг хэсэг байна. Энэ тохиолдолд <code>skipto rule 500</code> байна. 500-р дүрэм нь пакетийн IP хаягийг NAT хийж, пакетийг гадагш явуулна. Үүнийг бүү мартаарай, энэ бол маш чухал шүү. Энэ пакет өөрийн замаар хүрэх газраа хүрэх бөгөөд хариу пакет үүсч буцаж илгээгдэнэ. Энэ шинэ пакет буцаж ирэхдээ мөн л энэ дүрмийн олонлогийг дайрна. Энэ үед харин 100-р дүрэмд тохирч, очих IP хаяг нь буцаж харгалзах LAN IP хаяг уруу хөрвүүлэгдэнэ. Дараа нь <code>check-state</code> дүрмээр гарах ба хүснэгтэнд явагдаж байгаа сесс харилцаанд оролцож байгаа гэж тэмдэглэгдсэн тул цааш LAN уруу нэвтрэн орно. Тэгээд өөрийг нь анх явуулсан LAN PC уруу очих ба алсын серверээс өөр хэсэг өгөгдлийг авахыг хүссэн шинэ пакетийг явуулна. Энэ удаа энэ пакет <code>check-state</code> дүрмээр шалгагдах ба түүний гадагшаа урсгалд харгалзах мөр олдох тул харгалзах үйлдэл <code>skipto 500</code>-г гүйцэтгэнэ. Пакет 500-р мөр уруу үсэрч NAT хийгдэн цааш өөрийн замаар явах болно.</p></div><div class=paragraph><p>Дотогшоо урсгал дээр, идэвхтэй сесс харилцаанд оролцож байгаа гаднаас ирж байгаа бүх зүйлс автоматаар <code>check-state</code> дүрмээр болон зохих <code>divert natd</code> дүрмүүдээр шийдэгдэнэ. Энд бидний хийх ёстой зүйл бол хэрэггүй пакетуудыг татгалзаж, зөвшөөрөгдсөн үйлчилгээг нэвтрүүлэх юм. Галт ханын байгаа машин дээр апачи сервер ажиллаж байна, тэгээд Интернэтээс хүмүүс энэ дотоод вэб сайт уруу хандаж байна гэж бодъё. Шинэ дотогшоо сесс эхлүүлэх хүсэлтийн пакет 100-р дүрэмд тохирох бөгөөд түүний IP хаяг галт ханын LAN IP хаяг уруу оноолт хийгдэнэ. Дараа нь энэ пакет цааш бүх дүрмүүдээр шалгагдан эцэст нь 425-р дүрэмд тохирно. Энэ дүрэмд таарах үед хоёр үйлдэл хийгдэнэ. Энэ дүрэм keep-state динамик дүрмийн хүснэгтэнд нэмэгдэнэ, мөн зааж өгсөн үйлдлийг гүйцэтгэнэ. Гэвч энэ тохиолдолд энэ эхлэл IP хаягнаас эхэлсэн шинэ сесс эхлүүлэх хүсэлтийн тоо 2-оор хязгаарлагдана. Энэ нь тодорхой порт дээр ажиллаж байгаа үйлчилгээний хувьд DoS халдлагаас хамгаална. Харгалзах үйлдэл нь <code>allow</code> тул пакет LAN уруу нэвтэрнэ. Хариу болон үүсгэгдсэн пакетыг <code>check-state</code> дүрэм идэвхтэй сесс харилцаанд хамаарч байгаа гэж танина. Тэгээд 500-р дүрэм уруу шилжүүлэн, пакет тэнд NAT хийгдээд цааш гадагшаа интерфэйсээр гарна.</p></div><div class=paragraph><p>Жишээ дүрмийн олонлог #1:</p></div><div class="literalblock programlisting"><div class=content><pre>#!/bin/sh
cmd=&#34;ipfw -q add&#34;
skip=&#34;skipto 500&#34;
pif=rl0
ks=&#34;keep-state&#34;
good_tcpo=&#34;22,25,37,43,53,80,443,110,119&#34;

ipfw -q -f flush

$cmd 002 allow all from any to any via xl0  # exclude LAN traffic
$cmd 003 allow all from any to any via lo0  # exclude loopback traffic

$cmd 100 divert natd ip from any to any in via $pif
$cmd 101 check-state

# Authorized outbound packets
$cmd 120 $skip udp from any to xx.168.240.2 53 out via $pif $ks
$cmd 121 $skip udp from any to xx.168.240.5 53 out via $pif $ks
$cmd 125 $skip tcp from any to any $good_tcpo out via $pif setup $ks
$cmd 130 $skip icmp from any to any out via $pif $ks
$cmd 135 $skip udp from any to any 123 out via $pif $ks

# Deny all inbound traffic from non-routable reserved address spaces
$cmd 300 deny all from 192.168.0.0/16  to any in via $pif  #RFC 1918 private IP
$cmd 301 deny all from 172.16.0.0/12   to any in via $pif  #RFC 1918 private IP
$cmd 302 deny all from 10.0.0.0/8      to any in via $pif  #RFC 1918 private IP
$cmd 303 deny all from 127.0.0.0/8     to any in via $pif  #loopback
$cmd 304 deny all from 0.0.0.0/8       to any in via $pif  #loopback
$cmd 305 deny all from 169.254.0.0/16  to any in via $pif  #DHCP auto-config
$cmd 306 deny all from 192.0.2.0/24    to any in via $pif  #reserved for docs
$cmd 307 deny all from 204.152.64.0/23 to any in via $pif  #Sun cluster
$cmd 308 deny all from 224.0.0.0/3     to any in via $pif  #Class D &amp; E multicast

# Authorized inbound packets
$cmd 400 allow udp from xx.70.207.54 to any 68 in $ks
$cmd 420 allow tcp from any to me 80 in via $pif setup limit src-addr 1

$cmd 450 deny log ip from any to any

# This is skipto location for outbound stateful rules
$cmd 500 divert natd ip from any to any out via $pif
$cmd 510 allow ip from any to any

######################## end of rules  ##################</pre></div></div><div class=paragraph><p>Дараах жишээ дээрхтэй нилээд төстэй боловч туршлагагүй IPFW дүрэм бичигчид зориулан дүрмүүд юунд зориулагдсаныг тайлбарласан тайлбартай байгаагаараа онцлог юм.</p></div><div class=paragraph><p>Жишээ дүрмийн олонлог #2:</p></div><div class="literalblock programlisting"><div class=content><pre>#!/bin/sh
################ Start of IPFW rules file ###############################
# Flush out the list before we begin.
ipfw -q -f flush

# Set rules command prefix
cmd=&#34;ipfw -q add&#34;
skip=&#34;skipto 800&#34;
pif=&#34;rl0&#34;     # public interface name of NIC
              # facing the public Internet

#################################################################
# No restrictions on Inside LAN Interface for private network
# Change xl0 to your LAN NIC interface name
#################################################################
$cmd 005 allow all from any to any via xl0

#################################################################
# No restrictions on Loopback Interface
#################################################################
$cmd 010 allow all from any to any via lo0

#################################################################
# check if packet is inbound and nat address if it is
#################################################################
$cmd 014 divert natd ip from any to any in via $pif

#################################################################
# Allow the packet through if it has previous been added to the
# the &#34;dynamic&#34; rules table by a allow keep-state statement.
#################################################################
$cmd 015 check-state

#################################################################
# Interface facing Public Internet (Outbound Section)
# Check session start requests originating from behind the
# firewall on the private network or from this gateway server
# destined for the public Internet.
#################################################################

# Allow out access to my ISP&#39;s Domain name server.
# x.x.x.x must be the IP address of your ISP&#39;s DNS
# Dup these lines if your ISP has more than one DNS server
# Get the IP addresses from /etc/resolv.conf file
$cmd 020 $skip tcp from any to x.x.x.x 53 out via $pif setup keep-state

# Allow out access to my ISP&#39;s DHCP server for cable/DSL configurations.
$cmd 030 $skip udp from any to x.x.x.x 67 out via $pif keep-state

# Allow out non-secure standard www function
$cmd 040 $skip tcp from any to any 80 out via $pif setup keep-state

# Allow out secure www function https over TLS SSL
$cmd 050 $skip tcp from any to any 443 out via $pif setup keep-state

# Allow out send &amp; get email function
$cmd 060 $skip tcp from any to any 25 out via $pif setup keep-state
$cmd 061 $skip tcp from any to any 110 out via $pif setup keep-state

# Allow out FreeBSD (make install &amp; CVSUP) functions
# Basically give user root &#34;GOD&#34; privileges.
$cmd 070 $skip tcp from me to any out via $pif setup keep-state uid root

# Allow out ping
$cmd 080 $skip icmp from any to any out via $pif keep-state

# Allow out Time
$cmd 090 $skip tcp from any to any 37 out via $pif setup keep-state

# Allow out nntp news (i.e. news groups)
$cmd 100 $skip tcp from any to any 119 out via $pif setup keep-state

# Allow out secure FTP, Telnet, and SCP
# This function is using SSH (secure shell)
$cmd 110 $skip tcp from any to any 22 out via $pif setup keep-state

# Allow out whois
$cmd 120 $skip tcp from any to any 43 out via $pif setup keep-state

# Allow ntp time server
$cmd 130 $skip udp from any to any 123 out via $pif keep-state

#################################################################
# Interface facing Public Internet (Inbound Section)
# Check packets originating from the public Internet
# destined for this gateway server or the private network.
#################################################################

# Deny all inbound traffic from non-routable reserved address spaces
$cmd 300 deny all from 192.168.0.0/16  to any in via $pif  #RFC 1918 private IP
$cmd 301 deny all from 172.16.0.0/12   to any in via $pif  #RFC 1918 private IP
$cmd 302 deny all from 10.0.0.0/8      to any in via $pif  #RFC 1918 private IP
$cmd 303 deny all from 127.0.0.0/8     to any in via $pif  #loopback
$cmd 304 deny all from 0.0.0.0/8       to any in via $pif  #loopback
$cmd 305 deny all from 169.254.0.0/16  to any in via $pif  #DHCP auto-config
$cmd 306 deny all from 192.0.2.0/24    to any in via $pif  #reserved for docs
$cmd 307 deny all from 204.152.64.0/23 to any in via $pif  #Sun cluster
$cmd 308 deny all from 224.0.0.0/3     to any in via $pif  #Class D &amp; E multicast

# Deny ident
$cmd 315 deny tcp from any to any 113 in via $pif

# Deny all Netbios service. 137=name, 138=datagram, 139=session
# Netbios is MS/Windows sharing services.
# Block MS/Windows hosts2 name server requests 81
$cmd 320 deny tcp from any to any 137 in via $pif
$cmd 321 deny tcp from any to any 138 in via $pif
$cmd 322 deny tcp from any to any 139 in via $pif
$cmd 323 deny tcp from any to any 81  in via $pif

# Deny any late arriving packets
$cmd 330 deny all from any to any frag in via $pif

# Deny ACK packets that did not match the dynamic rule table
$cmd 332 deny tcp from any to any established in via $pif

# Allow traffic in from ISP&#39;s DHCP server. This rule must contain
# the IP address of your ISP&#39;s DHCP server as it&#39;s the only
# authorized source to send this packet type.
# Only necessary for cable or DSL configurations.
# This rule is not needed for &#39;user ppp&#39; type connection to
# the public Internet. This is the same IP address you captured
# and used in the outbound section.
$cmd 360 allow udp from x.x.x.x to any 68 in via $pif keep-state

# Allow in standard www function because I have Apache server
$cmd 370 allow tcp from any to me 80 in via $pif setup limit src-addr 2

# Allow in secure FTP, Telnet, and SCP from public Internet
$cmd 380 allow tcp from any to me 22 in via $pif setup limit src-addr 2

# Allow in non-secure Telnet session from public Internet
# labeled non-secure because ID &amp; PW are passed over public
# Internet as clear text.
# Delete this sample group if you do not have telnet server enabled.
$cmd 390 allow tcp from any to me 23 in via $pif setup limit src-addr 2

# Reject &amp; Log all unauthorized incoming connections from the public Internet
$cmd 400 deny log all from any to any in via $pif

# Reject &amp; Log all unauthorized out going connections to the public Internet
$cmd 450 deny log all from any to any out via $pif

# This is skipto location for outbound stateful rules
$cmd 800 divert natd ip from any to any out via $pif
$cmd 801 allow ip from any to any

# Everything else is denied by default
# deny and log all packets that fell through to see what they are
$cmd 999 deny log all from any to any
################ End of IPFW rules file ###############################</pre></div></div></div></div></div></div></div><hr><div class=last-modified><p><strong>Last modified on</strong>: 2024 оны гуравдугаар сарын 9 by <a href="https://cgit.freebsd.org/doc/commit/?id=6199af92e7" target=_blank>Danilo G. Baio</a></p></div><div class=buttons><div class=prev><i class="fa fa-angle-left" aria-hidden=true title=Prev></i><div class=container><a href=https://docs.freebsd.org/mn/books/handbook/network-servers class=direction>Prev</a></div></div><div class=home><i class="fa fa-home" aria-hidden=true title=Home></i><div class=container><a href=../ class=direction>Home</a></div></div><div class=next><div class=container><a href=https://docs.freebsd.org/mn/books/handbook/advanced-networking class=direction>Next</a></div><i class="fa fa-angle-right" aria-hidden=true title=Next></i></div></div><label class="hidden book-menu-overlay" for=menu-control></label></div><aside class=toc><div class=toc-content><h3>Table of Contents</h3><nav id=TableOfContents><ul><li><a href=#firewalls-intro>31.1. Танилцуулга</a></li><li><a href=#firewalls-concepts>31.2. Галт ханын тухай ойлголтууд</a></li><li><a href=#firewalls-apps>31.3. Галт ханын багцууд</a></li><li><a href=#firewalls-pf>31.4. OpenBSD Пакет шүүгч (PF) ба ALTQ</a></li><li><a href=#firewalls-ipf>31.5. IPFILTER (IPF) Галт хана</a></li><li><a href=#firewalls-ipfw>31.6. IPFW</a></li></ul></nav><hr><div class=resources><h3>Resources</h3><ul class=contents><li><i class="fa fa-file-pdf-o" aria-hidden=true title="Download PDF"></i><a href=https://download.freebsd.org/doc/mn/books/handbook/handbook_mn.pdf>Download PDF</a></li><li><i class="fa fa-pencil-square-o" aria-hidden=true title="Edit this page"></i><a href=https://github.com/freebsd/freebsd-doc/blob/main/documentation/content/mn/_index target=_blank>Edit this page</a></li></ul></div></div></aside><a class=to-top href=#top><i class="fa fa-arrow-circle-up" aria-hidden=true></i></a></main><footer><div class=footer-container><section class=logo-column><img src=https://docs.freebsd.org/images/FreeBSD-colors.svg width=160 height=50 alt="FreeBSD logo"><div class=options-container><div class=language-container><a id=languages href=https://docs.freebsd.org/mn/languages><img src=https://docs.freebsd.org/images/language.png class=language-image alt="Choose language">
<span>монгол хэл mongol khel</span></a></div><div class=theme-container><select id=theme-chooser><option value=theme-system>System</option><option value=theme-light>Light</option><option value=theme-dark>Dark</option><option value=theme-high-contrast>High contrast</option></select></div></div></section><section class=about-column><h3 class=column-title>About</h3><ul class=column-elements-container><li><a href=https://www.freebsd.org/about/ target=_blank class=column-element>FreeBSD</a></li><li><a href=https://freebsdfoundation.org/ target=_blank class=column-element>FreeBSD Foundation</a></li><li><a href=https://www.freebsd.org/where/ target=_blank class=column-element>Get FreeBSD</a></li><li><a href=https://www.freebsd.org/internal/code-of-conduct target=_blank class=column-element>Code of Conduct</a></li><li><a href=https://www.freebsd.org/security/ target=_blank class=column-element>Security Advisories</a></li></ul></section><section class=documentation-column><h3 class=column-title>Documentation</h3><ul class=column-elements-container><li><a href=/mn class=column-element>Documentation portal</a></li><li><a href=https://man.FreeBSD.org target=_blank class=column-element>Manual pages</a></li><li><a href=https://papers.FreeBSD.org target=_blank class=column-element>Presentations and papers</a></li><li><a href=https://docs-archive.freebsd.org/doc/ target=_blank class=column-element>Previous versions</a></li><li><a href=https://docs-archive.freebsd.org/44doc/ target=_blank class=column-element>4.4BSD Documents</a></li><li><a href=https://wiki.freebsd.org/ target=_blank class=column-element>Wiki</a></li></ul></section><section class=community-column><h3 class=column-title>Community</h3><ul class=column-elements-container><li><a href=https://docs.freebsd.org/mn/articles/contributing class=column-element>Get involved</a></li><li><a href=https://forums.freebsd.org/ target=_blank class=column-element>Community forum</a></li><li><a href=https://lists.freebsd.org/ target=_blank class=column-element>Mailing lists</a></li><li><a href=https://wiki.freebsd.org/IRC/Channels target=_blank class=column-element>IRC Channels</a></li><li><a href=https://bugs.freebsd.org/bugzilla/ target=_blank class=column-element>Bug Tracker</a></li></ul></section><section class=legal-column><h3 class=column-title>Legal</h3><ul class=column-elements-container><li><a href=https://freebsdfoundation.org/donate/ target=_blank class=column-element>Donations</a></li><li><a href=https://www.freebsd.org/copyright/freebsd-license/ target=_blank class=column-element>Licensing</a></li><li><a href=https://www.freebsd.org/privacy/ target=_blank class=column-element>Privacy Policy</a></li><li><a href=https://www.freebsd.org/copyright/ target=_blank class=column-element>Legal notices</a></li></ul></section><section class=copyright-column><p>&copy; 1994-2024 The FreeBSD Project. All rights reserved</p><span>Made with <span class=heart>♥</span> by the FreeBSD Community</span></section></div></footer></body></html>