<!doctype html><html class=theme-light lang=nl><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content><meta name=keywords content><meta name=copyright content="1995-2024 The FreeBSD Foundation"><link rel=canonical href=https://docs.freebsd.org/nl/books/handbook/disks/><title>Hoofdstuk 19. Opslag | FreeBSD Documentation Portal</title>
<meta name=theme-color content="#790000"><meta name=color-scheme content="system light dark high-contrast"><link rel="shortcut icon" href=https://docs.freebsd.org/favicon.ico><link rel=stylesheet href=https://docs.freebsd.org/styles/main.min.css><link rel=stylesheet href=https://docs.freebsd.org/css/font-awesome-min.css><script defer src=/js/theme-chooser.min.js></script><script defer src=/js/copy-clipboard.min.js></script><script defer src=/js/search.min.js></script><meta name=twitter:card content="summary"><meta name=twitter:domain content="docs.FreeBSD.org"><meta name=twitter:site content="@freebsd"><meta name=twitter:url content="https://twitter.com/freebsd"><meta property="og:title" content="Hoofdstuk 19. Opslag"><meta property="og:description" content><meta property="og:type" content="website"><meta property="og:image" content="https://docs.freebsd.org/favicon.ico"><meta property="og:image:alt" content="FreeBSD Logo"><meta property="og:locale" content="nl"><meta property="og:url" content="https://docs.freebsd.org/nl/books/handbook/disks/"><meta property="og:site_name" content="FreeBSD Documentation Portal"><script type=application/ld+json>{"@context":"http://schema.org","@type":"Article","url":"https:\/\/docs.freebsd.org\/nl\/books\/handbook\/disks\/","name":"FreeBSD Documentation Portal","headline":"FreeBSD Documentation Portal","description":"FreeBSD Documentation Portal"}</script></head><body><header><div class=header-container><div class=logo-menu-bars-container><a href=https://www.FreeBSD.org class=logo><img src=https://docs.freebsd.org/images/FreeBSD-monochromatic.svg width=160 height=50 alt="FreeBSD logo">
</a><label class=menu-bars for=menu-bars><i class="fa fa-bars" aria-hidden=true></i></label></div><input id=menu-bars type=checkbox><nav><ul class=menu><li class=menu-item><input id=about type=checkbox>
<a href=# aria-label="Navigate to About section"><label class=menu-item-description for=about>About
<i class="fa fa-angle-down fa-lg" aria-hidden=true></i></label></a><ul class=sub-menu><li class=title><a href=https://www.freebsd.org/about/ target=_blank>About</a></li><li><a href=https://www.freebsd.org/about/ target=_blank>FreeBSD</a></li><li><a href=https://freebsdfoundation.org/about-us/about-the-foundation/ target=_blank>FreeBSD Foundation</a></li><li><a href=https://www.freebsd.org/internal/code-of-conduct/ target=_blank>Code of Conduct</a></li></ul></li><li class=menu-item><input id=download type=checkbox>
<a href=# aria-label="Navigate to get FreeBSD section"><label class=menu-item-description for=download>Get FreeBSD
<i class="fa fa-angle-down fa-lg" aria-hidden=true></i></label></a><ul class=sub-menu><li class=title><a href=https://www.freebsd.org/where/ target=_blank>Get FreeBSD</a></li><li><a href=https://www.freebsd.org/releases/ target=_blank>Release Information</a></li><li><a href=https://www.freebsd.org/releng/ target=_blank>Release Engineering</a></li><li><a href=https://www.freebsd.org/security/ target=_blank>Security Advisories</a></li></ul></li><li class=menu-item><input id=documentation type=checkbox>
<a href=# aria-label="Navigate to get Documentation section"><label class=menu-item-description for=documentation>Documentation
<i class="fa fa-angle-down fa-lg" aria-hidden=true></i></label></a><ul class=sub-menu><li class=title><a href=/nl>Documentation portal</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook>FreeBSD Handbook</a></li><li><a href=https://docs.freebsd.org/nl/books/porters-handbook>Porter's Handbook</a></li><li><a href=https://docs.FreeBSD.org/en/books/fdp-primer>Documentation Project Handbook</a></li><li><a href=https://man.FreeBSD.org target=_blank>Manual pages</a></li><li><a href=https://papers.FreeBSD.org target=_blank>Presentations and papers</a></li><li><a href=https://wiki.FreeBSD.org target=_blank>Wiki</a></li><li><a href=https://docs.freebsd.org/nl/books>Books</a></li><li><a href=https://docs.freebsd.org/nl/articles>Articles</a></li></ul></li><li class=menu-item><input id=community type=checkbox>
<a href=# aria-label="Navigate to get Community section"><label class=menu-item-description for=community>Community
<i class="fa fa-angle-down fa-lg" aria-hidden=true></i></label></a><ul class=sub-menu><li class=title><a href=https://www.freebsd.org/community/>Community</a></li><li><a href=https://docs.freebsd.org/nl/articles/contributing>Get involved</a></li><li><a href=https://forums.freebsd.org/ target=_blank>Forum</a></li><li><a href=https://lists.freebsd.org/ target=_blank>Mailing lists</a></li><li><a href=https://wiki.freebsd.org/IRC/Channels target=_blank>IRC Channels</a></li><li><a href=https://bugs.freebsd.org/bugzilla/ target=_blank>Bug Tracker</a></li><li><a href=https://www.freebsd.org/support/ target=_blank>Support</a></li></ul></li></ul></nav><div class=search-donate-container><form class=search method=get id=search-header-form action=https://docs.freebsd.org/search name=search-header-form><input type=hidden name=DB value=nl>
<input id=words name=P type=text size=20 maxlength=255>
<button>
<i class="fa fa-search" aria-hidden=true></i></button></form><div class=donate><a href=https://freebsdfoundation.org/donate/ target=_blank><span class=heart>â™¥</span>
Donate</a></div></div></div></header><input type=checkbox class="hidden toggle" id=menu-control><main class=main-wrapper-book><a id=top></a><aside class=book-menu><div class=book-menu-content><input id=search-book type=text placeholder=Search aria-label=Search maxlength=128><nav id=MenuContents><ul><li><input type=checkbox id=chapter-eb2a98ce203d8afd517726e6d8776be3 class=toggle>
<label class="icon cursor" for=chapter-eb2a98ce203d8afd517726e6d8776be3><a role=button></a></label><a href=https://docs.freebsd.org/nl/books/handbook/preface/>Voorwoord</a><ul><li><a href=https://docs.freebsd.org/nl/books/handbook/preface/#preface-audience>Bedoeld publiek</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/preface/#preface-changes-from3>Wijzigingen ten opzichte van de derde editie</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/preface/#preface-changes-from2>Wijzigingen ten opzichte van de tweede editie (2004)</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/preface/#preface-changes>Veranderingen ten opzichte van de eerste editie (2001)</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/preface/#preface-overview>De opbouw van dit boek</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/preface/#preface-conv>Overeenkomsten in dit boek</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/preface/#preface-acknowledgements>Dankwoorden</a></li></ul></li><li><input type=checkbox id=chapter-14a525fce014b90b8a458a894818255a class=toggle>
<label for=chapter-14a525fce014b90b8a458a894818255a><a role=button></a></label><a href=https://docs.freebsd.org/nl/books/handbook/parti/>Deel I. Beginnen</a></li><li><input type=checkbox id=chapter-f9c9f3451644df30d224350da97d5da6 class=toggle>
<label class="icon cursor" for=chapter-f9c9f3451644df30d224350da97d5da6><a role=button></a></label><a href=https://docs.freebsd.org/nl/books/handbook/introduction/>Hoofdstuk 1. Introductie</a><ul><li><a href=https://docs.freebsd.org/nl/books/handbook/introduction/#introduction-synopsis>1.1. Overzicht</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/introduction/#nutshell>1.2. Welkom bij FreeBSD!</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/introduction/#history>1.3. Over het FreeBSD Project</a></li></ul></li><li><input type=checkbox id=chapter-6aaec170775233b7c45f6cdcfb70d466 class=toggle>
<label class="icon cursor" for=chapter-6aaec170775233b7c45f6cdcfb70d466><a role=button></a></label><a href=https://docs.freebsd.org/nl/books/handbook/install/>Hoofdstuk 2. FreeBSD installeren op FreeBSD 8.X en eerder</a><ul><li><a href=https://docs.freebsd.org/nl/books/handbook/install/#install-synopsis>2.1. Overzicht</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/install/#install-hardware>2.2. Hardware-eisen</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/install/#install-pre>2.3. Voorbereidende taken</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/install/#install-start>2.4. Beginnen met de installatie</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/install/#using-sysinstall>2.5. Inleiding Sysinstall</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/install/#install-steps>2.6. Schijfruimte toewijzen</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/install/#install-choosing>2.7. Wat installeren</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/install/#install-media>2.8. Installatiemedia kiezen</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/install/#install-final-warning>2.9. De installatie bevestigen</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/install/#install-post>2.10. Instellingen na de installatie</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/install/#install-trouble>2.11. Problemen oplossen</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/install/#install-advanced>2.12. Installeren voor gevorderden</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/install/#install-diff-media>2.13. Aangepaste installatiemedia maken</a></li></ul></li><li><input type=checkbox id=chapter-f693a3fa687a72d63ec8129ee302d664 class=toggle>
<label class="icon cursor" for=chapter-f693a3fa687a72d63ec8129ee302d664><a role=button></a></label><a href=https://docs.freebsd.org/nl/books/handbook/bsdinstall/>Hoofdstuk 3. FreeBSD 9.X en nieuwer installeren</a><ul><li><a href=https://docs.freebsd.org/nl/books/handbook/bsdinstall/#bsdinstall-synopsis>33.1. Overzicht</a></li></ul></li><li><input type=checkbox id=chapter-9f6db261075f578742036fcc6000eecd class=toggle>
<label class="icon cursor" for=chapter-9f6db261075f578742036fcc6000eecd><a role=button></a></label><a href=https://docs.freebsd.org/nl/books/handbook/basics/>Hoofdstuk 4. UNIXÂ® beginselen</a><ul><li><a href=https://docs.freebsd.org/nl/books/handbook/basics/#basics-synopsis>4.1. Overzicht</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/basics/#consoles>4.2. Virtuele consoles en terminals</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/basics/#permissions>4.3. Rechten</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/basics/#dirstructure>4.4. Mappenstructuur</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/basics/#disk-organization>4.5. Organisatie van schijven</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/basics/#mount-unmount>4.6. Het koppelen en ontkoppelen van bestandssystemen</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/basics/#basics-processes>4.7. Processen</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/basics/#basics-daemons>4.8. Daemons, signalen en het stoppen van processen</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/basics/#shells>4.9. Shells</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/basics/#editors>4.10. Teksteditors</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/basics/#basics-devices>4.11. Apparaten en apparaatnodes</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/basics/#binary-formats>4.12. Binaire formaten</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/basics/#basics-more-information>4.13. Meer informatie</a></li></ul></li><li><input type=checkbox id=chapter-01c5707e95d14c0ff84bf62600c958d1 class=toggle>
<label class="icon cursor" for=chapter-01c5707e95d14c0ff84bf62600c958d1><a role=button></a></label><a href=https://docs.freebsd.org/nl/books/handbook/ports/>Hoofdstuk 5. Applicaties installeren: pakketten en ports</a><ul><li><a href=https://docs.freebsd.org/nl/books/handbook/ports/#ports-synopsis>5.1. Overzicht</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/ports/#ports-overview>5.2. Overzicht van softwareinstallatie</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/ports/#ports-finding-applications>5.3. Applicaties zoeken</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/ports/#packages-using>5.4. Het pakkettensysteem gebruiken</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/ports/#ports-using>5.5. De Portscollectie gebruiken</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/ports/#ports-nextsteps>5.6. Activiteiten na het installeren</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/ports/#ports-broken>5.7. Omgaan met kapotte ports</a></li></ul></li><li><input type=checkbox id=chapter-3405c00581365a8b5d16af70fe4d1b72 class=toggle>
<label class="icon cursor" for=chapter-3405c00581365a8b5d16af70fe4d1b72><a role=button></a></label><a href=https://docs.freebsd.org/nl/books/handbook/x11/>Hoofdstuk 6. Het X Window systeem</a><ul><li><a href=https://docs.freebsd.org/nl/books/handbook/x11/#x11-synopsis>6.1. Overzicht</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/x11/#x-understanding>6.2. X begrijpen</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/x11/#x-install>6.3. X11 installeren</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/x11/#x-config>6.4. X11 instellen</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/x11/#x-fonts>6.5. Lettertypen gebruiken in X11</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/x11/#x-xdm>6.6. De X beeldschermmanager</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/x11/#x11-wm>6.7. Bureaubladomgevingen</a></li></ul></li><li><input type=checkbox id=chapter-0eab3565e8f59f5a8a896dfba7eb3680 class=toggle>
<label for=chapter-0eab3565e8f59f5a8a896dfba7eb3680><a role=button></a></label><a href=https://docs.freebsd.org/nl/books/handbook/partii/>Deel II. Algemene taken</a></li><li><input type=checkbox id=chapter-b33cf28993f3f7bf5baf036e79da0f39 class=toggle>
<label class="icon cursor" for=chapter-b33cf28993f3f7bf5baf036e79da0f39><a role=button></a></label><a href=https://docs.freebsd.org/nl/books/handbook/desktop/>Hoofdstuk 7. Bureaubladapplicaties</a><ul><li><a href=https://docs.freebsd.org/nl/books/handbook/desktop/#desktop-synopsis>7.1. Overzicht</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/desktop/#desktop-browsers>7.2. Browsers</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/desktop/#desktop-productivity>7.3. Productiviteit</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/desktop/#desktop-viewers>7.4. Documentviewers</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/desktop/#desktop-finance>7.5. FinanciÃ«n</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/desktop/#desktop-summary>7.6. Samenvatting</a></li></ul></li><li><input type=checkbox id=chapter-152f694a19312ad72ec7bb4e1c3c33b2 class=toggle>
<label class="icon cursor" for=chapter-152f694a19312ad72ec7bb4e1c3c33b2><a role=button></a></label><a href=https://docs.freebsd.org/nl/books/handbook/multimedia/>Hoofdstuk 8. Multimedia</a><ul><li><a href=https://docs.freebsd.org/nl/books/handbook/multimedia/#multimedia-synopsis>8.1. Overzicht</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/multimedia/#sound-setup>8.2. Geluidskaart installeren</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/multimedia/#sound-mp3>8.3. MP3 audio</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/multimedia/#video-playback>8.4. Video afspelen</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/multimedia/#tvcard>8.5. TV-kaarten installeren</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/multimedia/#mythtv>8.6. MythTV</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/multimedia/#scanners>8.7. Scanners</a></li></ul></li><li><input type=checkbox id=chapter-80888b4ee02e3e409e5f71cf97a36450 class=toggle>
<label class="icon cursor" for=chapter-80888b4ee02e3e409e5f71cf97a36450><a role=button></a></label><a href=https://docs.freebsd.org/nl/books/handbook/kernelconfig/>Hoofdstuk 9. De FreeBSD-kernel instellen</a><ul><li><a href=https://docs.freebsd.org/nl/books/handbook/kernelconfig/#kernelconfig-synopsis>9.1. Samenvatting</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/kernelconfig/#kernelconfig-custom-kernel>9.2. Redenen om een aangepaste kernel te bouwen</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/kernelconfig/#kernelconfig-devices>9.3. De systeemhardware vinden</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/kernelconfig/#kernelconfig-modules>9.4. Kernel stuurprogrammaâ€™s, subsystemen, en modules</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/kernelconfig/#kernelconfig-building>9.5. Bouwen en installeren van een aangepaste kernel</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/kernelconfig/#kernelconfig-config>9.6. Het instellingenbestand</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/kernelconfig/#kernelconfig-trouble>9.7. Problemen oplossen</a></li></ul></li><li><input type=checkbox id=chapter-cb174c55879b17ab955f2f16989a79e0 class=toggle>
<label class="icon cursor" for=chapter-cb174c55879b17ab955f2f16989a79e0><a role=button></a></label><a href=https://docs.freebsd.org/nl/books/handbook/printing/>Hoofdstuk 10. Afdrukken</a><ul><li><a href=https://docs.freebsd.org/nl/books/handbook/printing/#printing-synopsis>10.1. Overzicht</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/printing/#printing-intro-spooler>10.2. Inleiding</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/printing/#printing-intro-setup>10.3. Standaardinstallatie</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/printing/#printing-advanced>10.4. Geavanceerde printerinstallatie</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/printing/#printing-using>10.5. Printers gebruiken</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/printing/#printing-lpd-alternatives>10.6. Alternatieven voor het standaard wachtrijsysteem</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/printing/#printing-troubleshooting>10.7. Problemen oplossen</a></li></ul></li><li><input type=checkbox id=chapter-c12b8c3f2a8fcefce87087241f695c83 class=toggle>
<label class="icon cursor" for=chapter-c12b8c3f2a8fcefce87087241f695c83><a role=button></a></label><a href=https://docs.freebsd.org/nl/books/handbook/linuxemu/>Hoofdstuk 11. LinuxÂ® binaire compatibiliteit</a><ul><li><a href=https://docs.freebsd.org/nl/books/handbook/linuxemu/#linuxemu-synopsis>11.1. Overzicht</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/linuxemu/#linuxemu-lbc-install>11.2. Installatie</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/linuxemu/#linuxemu-mathematica>11.3. MathematicaÂ® installeren</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/linuxemu/#linuxemu-maple>11.4. Mapleâ„¢ installeren</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/linuxemu/#linuxemu-matlab>11.5. MATLABÂ® installeren</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/linuxemu/#linuxemu-oracle>11.6. OracleÂ® installeren</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/linuxemu/#linuxemu-advanced>11.7. Gevorderde onderwerpen</a></li></ul></li><li><input type=checkbox id=chapter-03b11ba627b9a0c85b247f5641bde272 class=toggle>
<label for=chapter-03b11ba627b9a0c85b247f5641bde272><a role=button></a></label><a href=https://docs.freebsd.org/nl/books/handbook/partiii/>Deel III. Systeembeheer</a></li><li><input type=checkbox id=chapter-6c31587f8d736319f099cd4dc1961301 class=toggle>
<label class="icon cursor" for=chapter-6c31587f8d736319f099cd4dc1961301><a role=button></a></label><a href=https://docs.freebsd.org/nl/books/handbook/config/>Hoofdstuk 12. Instellingen en optimalisatie</a><ul><li><a href=https://docs.freebsd.org/nl/books/handbook/config/#config-synopsis>12.1. Overzicht</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/config/#configtuning-initial>12.2. InitiÃ«le instellingen</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/config/#configtuning-core-configuration>12.3. Hoofdinstellingen</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/config/#configtuning-appconfig>12.4. Toepassingen instellen</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/config/#configtuning-starting-services>12.5. Diensten starten</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/config/#configtuning-cron>12.6. <code>cron</code> instellen</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/config/#configtuning-rcd>12.7. Gebruik van rc met FreeBSD</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/config/#config-network-setup>12.8. Netwerkkaarten instellen</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/config/#configtuning-virtual-hosts>12.9. Virtuele hosts</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/config/#configtuning-syslog>12.10. De systeemlogger syslogd configureren</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/config/#configtuning-configfiles>12.11. Instellingenbestanden</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/config/#configtuning-sysctl>12.12. Optimaliseren met sysctl</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/config/#configtuning-disk>12.13. Harde schijven optimaliseren</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/config/#configtuning-kernel-limits>12.14. Fijnafstemming van kernellimieten</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/config/#adding-swap-space>12.15. Wisselbestandruimte toevoegen</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/config/#acpi-overview>12.16. Energie- en bronnenbeheer</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/config/#ACPI-debug>12.17. FreeBSD ACPI gebruiken en debuggen</a></li></ul></li><li><input type=checkbox id=chapter-459f0012b3b4f0b6b123010f029da5e4 class=toggle>
<label class="icon cursor" for=chapter-459f0012b3b4f0b6b123010f029da5e4><a role=button></a></label><a href=https://docs.freebsd.org/nl/books/handbook/boot/>Hoofdstuk 13. Het FreeBSD opstartproces</a><ul><li><a href=https://docs.freebsd.org/nl/books/handbook/boot/#boot-synopsis>13.1. Overzicht</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/boot/#boot-introduction>13.2. Het bootprobleem</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/boot/#boot-blocks>13.3. De bootmanager en opstartstadia</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/boot/#boot-kernel>13.4. Interactie met de kernel tijdens opstarten</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/boot/#device-hints>13.5. Device hints</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/boot/#boot-init>13.6. Init: start van procesbesturing</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/boot/#boot-shutdown>13.7. Afsluitvolgorde</a></li></ul></li><li><input type=checkbox id=chapter-d251c21b963b5ab783e5aec225e02b5a class=toggle>
<label class="icon cursor" for=chapter-d251c21b963b5ab783e5aec225e02b5a><a role=button></a></label><a href=https://docs.freebsd.org/nl/books/handbook/users/>Hoofdstuk 14. Gebruikers- en basisaccountbeheer</a><ul><li><a href=https://docs.freebsd.org/nl/books/handbook/users/#users-synopsis>14.1. Overzicht</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/users/#users-introduction>14.2. Inleiding</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/users/#users-superuser>14.3. Het superuser-account</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/users/#users-system>14.4. Systeemaccounts</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/users/#users-user>14.5. Gebruikersaccounts</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/users/#users-modifying>14.6. Accounts wijzigen</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/users/#users-limiting>14.7. Gebruikers beperken</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/users/#users-groups>14.8. Groepen</a></li></ul></li><li><input type=checkbox id=chapter-917c75fcffbb14d48ed6d0a48e7028f2 class=toggle>
<label class="icon cursor" for=chapter-917c75fcffbb14d48ed6d0a48e7028f2><a role=button></a></label><a href=https://docs.freebsd.org/nl/books/handbook/security/>Hoofdstuk 15. Beveiliging</a><ul><li><a href=https://docs.freebsd.org/nl/books/handbook/security/#security-synopsis>15.1. Overzicht</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/security/#security-intro>15.2. Introductie</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/security/#securing-freebsd>15.3. FreeBSD beveiligen</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/security/#crypt>15.4. DES, Blowfish, MD5, SHA256, SHA512 en crypt</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/security/#one-time-passwords>15.5. Eenmalige wachtwoorden</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/security/#tcpwrappers>15.6. TCP Wrappers</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/security/#kerberos5>15.7. Kerberos5</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/security/#openssl>15.8. OpenSSL</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/security/#ipsec>15.9. VPN via IPsec</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/security/#openssh>15.10. OpenSSH</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/security/#fs-acl>15.11. Bestandssysteem toegangscontrolelijsten (ACLs)</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/security/#security-portaudit>15.12. Monitoren van beveiligingsproblemen met andere software</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/security/#security-advisories>15.13. FreeBSD beveiligingswaarschuwingen</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/security/#security-accounting>15.14. Procesaccounting</a></li></ul></li><li><input type=checkbox id=chapter-1a2a8e719703649c2c66d99aa7a25fd4 class=toggle>
<label class="icon cursor" for=chapter-1a2a8e719703649c2c66d99aa7a25fd4><a role=button></a></label><a href=https://docs.freebsd.org/nl/books/handbook/jails/>Hoofdstuk 16. Jails</a><ul><li><a href=https://docs.freebsd.org/nl/books/handbook/jails/#jails-synopsis>16.1. Overzicht</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/jails/#jails-terms>16.2. Termen en begrippen van jails</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/jails/#jails-intro>16.3. Introductie</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/jails/#jails-build>16.4. CreeÃ«ren en controleren van jails</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/jails/#jails-tuning>16.5. Optimaliseren en administratie</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/jails/#jails-application>16.6. Toepassing van jails</a></li></ul></li><li><input type=checkbox id=chapter-8f4620c77e572cbb58917911a33c73cf class=toggle>
<label class="icon cursor" for=chapter-8f4620c77e572cbb58917911a33c73cf><a role=button></a></label><a href=https://docs.freebsd.org/nl/books/handbook/mac/>Hoofdstuk 17. Verplichte Toegangscontrole (MAC)</a><ul><li><a href=https://docs.freebsd.org/nl/books/handbook/mac/#mac-synopsis>17.1. Overzicht</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/mac/#mac-inline-glossary>17.2. Sleuteltermen in dit hoofdstuk</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/mac/#mac-initial>17.3. Uitleg over MAC</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/mac/#mac-understandlabel>17.4. MAC-labels begrijpen</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/mac/#mac-planning>17.5. De beveiligingsconfiguratie plannen</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/mac/#mac-modules>17.6. Module-instellingen</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/mac/#mac-seeotheruids>17.7. MAC-module seeotheruids</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/mac/#mac-bsdextended>17.8. MAC-module bsdextended</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/mac/#mac-ifoff>17.9. MAC-module ifoff</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/mac/#mac-portacl>17.10. MAC-module portacl</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/mac/#mac-partition>17.11. MAC-module partition</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/mac/#mac-mls>17.12. MAC-module Multi-Level Security</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/mac/#mac-biba>17.13. MAC-module Biba</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/mac/#mac-lomac>17.14. MAC-module LOMAC</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/mac/#mac-implementing>17.15. Nagios in een MAC-jail</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/mac/#mac-userlocked>17.16. Gebruikers afsluiten</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/mac/#mac-troubleshoot>17.17. Problemen oplossen met het MAC-raamwerk</a></li></ul></li><li><input type=checkbox id=chapter-9598d66a76cb3182057b6bcd775149a0 class=toggle>
<label class="icon cursor" for=chapter-9598d66a76cb3182057b6bcd775149a0><a role=button></a></label><a href=https://docs.freebsd.org/nl/books/handbook/audit/>Hoofdstuk 18. Security Event Auditing</a><ul><li><a href=https://docs.freebsd.org/nl/books/handbook/audit/#audit-synopsis>18.1. Overzicht</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/audit/#audit-inline-glossary>18.2. Sleutelwoorden in dit hoofdstuk</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/audit/#audit-install>18.3. Installeren van audit ondersteuning.</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/audit/#audit-config>18.4. Audit Configuratie</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/audit/#audit-administration>18.5. Het audit subsysteem beheren.</a></li></ul></li><li><input type=checkbox id=chapter-e1edcad13d9db6e8e4cb645d378ecfaf class=toggle checked>
<label class="icon cursor" for=chapter-e1edcad13d9db6e8e4cb645d378ecfaf><a role=button></a></label><a href=https://docs.freebsd.org/nl/books/handbook/disks/>Hoofdstuk 19. Opslag</a><ul><li><a href=https://docs.freebsd.org/nl/books/handbook/disks/#disks-synopsis>19.1. Overzicht</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/disks/#disks-naming>19.2. Apparaatnamen</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/disks/#disks-adding>19.3. Schijven toevoegen</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/disks/#raid>19.4. RAID</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/disks/#usb-disks>19.5. USB-opslagapparaten</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/disks/#creating-cds>19.6. Optische media (CDâ€™s) aanmaken en gebruiken</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/disks/#creating-dvds>19.7. Optische media (DVDâ€™s) aanmaken en gebruiken</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/disks/#floppies>19.8. Diskettes aanmaken en gebruiken</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/disks/#backups-tapebackups>19.9. Gegevensbanden aanmaken en gebruiken</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/disks/#backups-floppybackups>19.10. Naar diskettes back-uppen</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/disks/#backup-strategies>19.11. Back-up strategieÃ«n</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/disks/#backup-basics>19.12. Back-upbeginselen</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/disks/#disks-virtual>19.13. Netwerk-, geheugen-, en bestandsgebaseerde bestandssystemen</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/disks/#snapshots>19.14. Snapshots van bestandssystemen</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/disks/#quotas>19.15. Bestandssysteemquota</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/disks/#disks-encrypting>19.16. Schijfpartities versleutelen</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/disks/#swap-encrypting>19.17. Het versleutelen van de wisselbestand ruimte</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/disks/#disks-hast>19.18. Highly Available Storage (HAST)</a></li></ul></li><li><input type=checkbox id=chapter-dde37901a0e0ea32745b67607854900f class=toggle>
<label class="icon cursor" for=chapter-dde37901a0e0ea32745b67607854900f><a role=button></a></label><a href=https://docs.freebsd.org/nl/books/handbook/geom/>Hoofdstuk 20. GEOM: Modulair schijftransformatie raamwerk</a><ul><li><a href=https://docs.freebsd.org/nl/books/handbook/geom/#geom-synopsis>20.1. Overzicht</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/geom/#GEOM-intro>20.2. GEOM inleiding</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/geom/#GEOM-striping>20.3. RAID0 - aaneengeschakeld</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/geom/#GEOM-mirror>20.4. RAID1 - spiegelen</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/geom/#GEOM-raid3>20.5. RAID3 - Striping op byte-niveau met toegewijde pariteit</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/geom/#geom-ggate>20.6. GEOM Gate netwerk apparaten</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/geom/#geom-glabels>20.7. Het labelen van schijven</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/geom/#geom-gjournal>20.8. UFS logboeken door middel van GEOM</a></li></ul></li><li><input type=checkbox id=chapter-7af71270807eb7b70cd3eedc6577b254 class=toggle>
<label class="icon cursor" for=chapter-7af71270807eb7b70cd3eedc6577b254><a role=button></a></label><a href=https://docs.freebsd.org/nl/books/handbook/filesystems/>Hoofdstuk 21. Ondersteuning van bestandssystemen</a><ul><li><a href=https://docs.freebsd.org/nl/books/handbook/filesystems/#filesystems-synopsis>21.1. Overzicht</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/filesystems/#filesystems-zfs>21.2. Het Z File System (ZFS)</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/filesystems/#filesystems-linux>21.3. LinuxÂ® bestandssystemen</a></li></ul></li><li><input type=checkbox id=chapter-375257268d95faaf87faf4f7a2e6aa67 class=toggle>
<label class="icon cursor" for=chapter-375257268d95faaf87faf4f7a2e6aa67><a role=button></a></label><a href=https://docs.freebsd.org/nl/books/handbook/virtualization/>Hoofdstuk 22. Virtualisatie</a><ul><li><a href=https://docs.freebsd.org/nl/books/handbook/virtualization/#virtualization-synopsis>22.1. Overzicht</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/virtualization/#virtualization-guest>22.2. FreeBSD als een gast-besturingssysteem</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/virtualization/#virtualization-host>22.3. FreeBSD als een gastheer-besturingssysteem</a></li></ul></li><li><input type=checkbox id=chapter-49f1e96591c090304ea532012257f4ef class=toggle>
<label class="icon cursor" for=chapter-49f1e96591c090304ea532012257f4ef><a role=button></a></label><a href=https://docs.freebsd.org/nl/books/handbook/l10n/>Hoofdstuk 23. Lokalisatie - I18N/L10N gebruiken en instellen</a><ul><li><a href=https://docs.freebsd.org/nl/books/handbook/l10n/#l10n-synopsis>23.1. Overzicht</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/l10n/#l10n-basics>23.2. Beginselen</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/l10n/#using-localization>23.3. Lokalisatie gebruiken</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/l10n/#l10n-compiling>23.4. I18N-programmaâ€™s compileren</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/l10n/#lang-setup>23.5. FreeBSD lokaliseren naar talen</a></li></ul></li><li><input type=checkbox id=chapter-dead2b4c5ea325dd390a9b0dccd8f763 class=toggle>
<label class="icon cursor" for=chapter-dead2b4c5ea325dd390a9b0dccd8f763><a role=button></a></label><a href=https://docs.freebsd.org/nl/books/handbook/cutting-edge/>Hoofdstuk 24. FreeBSD updaten en upgraden</a><ul><li><a href=https://docs.freebsd.org/nl/books/handbook/cutting-edge/#updating-upgrading-synopsis>24.1. Overzicht</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/cutting-edge/#updating-upgrading-freebsdupdate>24.2. FreeBSD Update</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/cutting-edge/#updating-upgrading-portsnap>24.3. Portsnap: een updategereedschap voor de Portscollectie</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/cutting-edge/#updating-upgrading-documentation>24.4. De documentatie bijwerken</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/cutting-edge/#current-stable>24.5. Een ontwikkelingstak volgen</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/cutting-edge/#synching>24.6. Broncode synchroniseren</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/cutting-edge/#makeworld>24.7. De "wereld" opnieuw bouwen</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/cutting-edge/#make-delete-old>24.8. Het verwijderen van overbodige bestanden, directories en bibliotheken</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/cutting-edge/#small-lan>24.9. Meerdere machines bijwerken</a></li></ul></li><li><input type=checkbox id=chapter-29c1eeb0e9dedc487a98399e2737ee8a class=toggle>
<label class="icon cursor" for=chapter-29c1eeb0e9dedc487a98399e2737ee8a><a role=button></a></label><a href=https://docs.freebsd.org/nl/books/handbook/dtrace/>Hoofdstuk 25. DTrace</a><ul><li><a href=https://docs.freebsd.org/nl/books/handbook/dtrace/#dtrace-synopsis>25.1. Overzicht</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/dtrace/#dtrace-implementation>25.2. Implementatieverschillen</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/dtrace/#dtrace-enable>25.3. Ondersteuning voor DTrace aanzetten</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/dtrace/#dtrace-using>25.4. DTrace gebruiken</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/dtrace/#dtrace-language>25.5. De taal D</a></li></ul></li><li><input type=checkbox id=chapter-bbd25f9a194f9c39ca2d658c75767db5 class=toggle>
<label for=chapter-bbd25f9a194f9c39ca2d658c75767db5><a role=button></a></label><a href=https://docs.freebsd.org/nl/books/handbook/partiv/>Deel IV. Netwerkcommunicatie</a></li><li><input type=checkbox id=chapter-499dab596afd7ddac77e80295314e0dd class=toggle>
<label class="icon cursor" for=chapter-499dab596afd7ddac77e80295314e0dd><a role=button></a></label><a href=https://docs.freebsd.org/nl/books/handbook/serialcomms/>Hoofdstuk 26. SeriÃ«le communicatie</a><ul><li><a href=https://docs.freebsd.org/nl/books/handbook/serialcomms/#serial-synopsis>26.1. Overzicht</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/serialcomms/#serial>26.2. Inleiding</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/serialcomms/#term>26.3. Terminals</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/serialcomms/#dialup>26.4. Inbeldienst</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/serialcomms/#dialout>26.5. Uitbeldienst</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/serialcomms/#serialconsole-setup>26.6. SeriÃ«le console opzetten</a></li></ul></li><li><input type=checkbox id=chapter-95e4571c48bee1cced5e84a538d302e3 class=toggle>
<label class="icon cursor" for=chapter-95e4571c48bee1cced5e84a538d302e3><a role=button></a></label><a href=https://docs.freebsd.org/nl/books/handbook/ppp-and-slip/>Hoofdstuk 27. PPP en SLIP</a><ul><li><a href=https://docs.freebsd.org/nl/books/handbook/ppp-and-slip/#ppp-and-slip-synopsis>27.1. Overzicht</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/ppp-and-slip/#userppp>27.2. Gebruikmaken van gebruiker-PPP</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/ppp-and-slip/#ppp>27.3. Kernel-PPP gebruiken</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/ppp-and-slip/#ppp-troubleshoot>27.4. Het problemen oplossen van PPP-verbindingen</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/ppp-and-slip/#pppoe>27.5. PPP gebruiken over Ethernet (PPPoE)</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/ppp-and-slip/#pppoa>27.6. Gebruik maken van PPP over ATM (PPPoA)</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/ppp-and-slip/#slip>27.7. Gebruik maken van SLIP</a></li></ul></li><li><input type=checkbox id=chapter-f089ac726c401c9b4bd5c34a295e11bb class=toggle>
<label class="icon cursor" for=chapter-f089ac726c401c9b4bd5c34a295e11bb><a role=button></a></label><a href=https://docs.freebsd.org/nl/books/handbook/mail/>Hoofdstuk 28. Elektronische mail</a><ul><li><a href=https://docs.freebsd.org/nl/books/handbook/mail/#mail-synopsis>28.1. Overzicht</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/mail/#mail-using>28.2. Gebruik maken van elektronische mail</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/mail/#sendmail>28.3. sendmail instellen</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/mail/#mail-changingmta>28.4. De Mail Transfer Agent vervangen</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/mail/#mail-trouble>28.5. Problemen oplossen</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/mail/#mail-advanced>28.6. Geavanceerde onderwerpen</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/mail/#SMTP-UUCP>28.7. SMTP met UUCP</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/mail/#outgoing-only>28.8. Instellen om alleen te versturen</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/mail/#SMTP-dialup>28.9. Mail gebruiken met een inbelverbinding</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/mail/#SMTP-Auth>28.10. SMTP-authenticatie</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/mail/#mail-agents>28.11. Mail User Agents</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/mail/#mail-fetchmail>28.12. fetchmail gebruiken</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/mail/#mail-procmail>28.13. procmail gebruiken</a></li></ul></li><li><input type=checkbox id=chapter-6de4de3fe925639d4175ce4b6f8c1829 class=toggle>
<label class="icon cursor" for=chapter-6de4de3fe925639d4175ce4b6f8c1829><a role=button></a></label><a href=https://docs.freebsd.org/nl/books/handbook/network-servers/>Hoofdstuk 29. Netwerkdiensten</a><ul><li><a href=https://docs.freebsd.org/nl/books/handbook/network-servers/#network-servers-synopsis>29.1. Overzicht</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/network-servers/#network-inetd>29.2. De inetd"Super-Server"</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/network-servers/#network-nfs>29.3. Netwerkbestandssysteem (NFS)</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/network-servers/#network-nis>29.4. Netwerkinformatiesysteem (NIS/YP)</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/network-servers/#network-dhcp>29.5. Automatisch netwerk instellen (DHCP)</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/network-servers/#network-dns>29.6. Domeinnaamsysteem (DNS)</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/network-servers/#network-apache>29.7. Apache HTTP server</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/network-servers/#network-ftp>29.8. File Transfer Protocol (FTP)</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/network-servers/#network-samba>29.9. Bestands- en printdiensten voor MicrosoftÂ® WindowsÂ® cliÃ«nten (Samba)</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/network-servers/#network-ntp>29.10. Tijd synchroniseren met NTP</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/network-servers/#network-syslogd>29.11. Hosts op afstand loggen met <code>syslogd</code></a></li></ul></li><li><input type=checkbox id=chapter-776d855c7b75e048f90b5c2c9b35ffe0 class=toggle>
<label class="icon cursor" for=chapter-776d855c7b75e048f90b5c2c9b35ffe0><a role=button></a></label><a href=https://docs.freebsd.org/nl/books/handbook/firewalls/>Hoofdstuk 30. Firewalls</a><ul><li><a href=https://docs.freebsd.org/nl/books/handbook/firewalls/#firewalls-intro>30.1. Inleiding</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/firewalls/#firewalls-concepts>30.2. Firewallconcepten</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/firewalls/#firewalls-apps>30.3. Firewallsoftware</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/firewalls/#firewalls-pf>30.4. De OpenBSD Packet Filter (PF) en ALTQ</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/firewalls/#firewalls-ipf>30.5. De IPFILTER (IPF) firewall</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/firewalls/#firewalls-ipfw>30.6. IPFW</a></li></ul></li><li><input type=checkbox id=chapter-5b07f776a0e6155c1c89aa0d15610380 class=toggle>
<label class="icon cursor" for=chapter-5b07f776a0e6155c1c89aa0d15610380><a role=button></a></label><a href=https://docs.freebsd.org/nl/books/handbook/advanced-networking/>Hoofdstuk 31. Geavanceerde netwerken</a><ul><li><a href=https://docs.freebsd.org/nl/books/handbook/advanced-networking/#advanced-networking-synopsis>31.1. Samenvatting</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/advanced-networking/#network-routing>31.2. Gateways en routes</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/advanced-networking/#network-wireless>31.3. Draadloze netwerken</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/advanced-networking/#network-bluetooth>31.4. Bluetooth</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/advanced-networking/#network-bridging>31.5. Bridging</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/advanced-networking/#network-aggregation>31.6. Verbindingsaggregatie en failover</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/advanced-networking/#network-diskless>31.7. Schijfloos werken</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/advanced-networking/#network-pxe-nfs>31.8. Met PXE en een NFS-root-bestandssysteem opstarten</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/advanced-networking/#network-isdn>31.9. ISDN</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/advanced-networking/#network-natd>31.10. Network Address Translation</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/advanced-networking/#network-ipv6>31.11. IPv6</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/advanced-networking/#network-atm>31.12. Asynchronous Transfer Mode (ATM)</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/advanced-networking/#carp>31.13. Common Address Redundancy Protocol (CARP)</a></li></ul></li><li><input type=checkbox id=chapter-171a77aa9d067a1024f849470e1f33e8 class=toggle>
<label for=chapter-171a77aa9d067a1024f849470e1f33e8><a role=button></a></label><a href=https://docs.freebsd.org/nl/books/handbook/partv/>Deel V. Appendix</a></li><li><input type=checkbox id=chapter-8050f436a0a7986a4aaded93d8e49469 class=toggle>
<label class="icon cursor" for=chapter-8050f436a0a7986a4aaded93d8e49469><a role=button></a></label><a href=https://docs.freebsd.org/nl/books/handbook/mirrors/>Bijlage A. FreeBSD verkrijgen</a><ul><li><a href=https://docs.freebsd.org/nl/books/handbook/mirrors/#mirrors-cdrom>A.1. CD-ROM en DVD uitgevers</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/mirrors/#mirrors-ftp>A.2. FTP sites</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/mirrors/#mirrors-svn>A.3. Subversion-sites</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/mirrors/#anoncvs>A.4. Anonieme CVS</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/mirrors/#ctm>A.5. CTM gebruiken</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/mirrors/#cvsup>A.6. CVSup gebruiken</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/mirrors/#cvs-tags>A.7. CVS labels</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/mirrors/#mirrors-rsync>A.8. rsync sites</a></li></ul></li><li><input type=checkbox id=chapter-128b630a8f88f158e7027fe6c2184d21 class=toggle>
<label class="icon cursor" for=chapter-128b630a8f88f158e7027fe6c2184d21><a role=button></a></label><a href=https://docs.freebsd.org/nl/books/handbook/bibliography/>Bijlage B. Bibliografie</a><ul><li><a href=https://docs.freebsd.org/nl/books/handbook/bibliography/#bibliography-freebsd>B.1. Boeken & tijdschriften over FreeBSD</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/bibliography/#bibliography-userguides>B.2. Voor gebruikers</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/bibliography/#bibliography-adminguides>B.3. Voor beheerders</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/bibliography/#bibliography-programmers>B.4. Voor programmeurs</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/bibliography/#bibliography-osinternals>B.5. Dieper in het besturingssysteem</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/bibliography/#bibliography-security>B.6. Over beveiliging</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/bibliography/#bibliography-hardware>B.7. Over hardware</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/bibliography/#bibliography-history>B.8. UNIXÂ® geschiedenis</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/bibliography/#bibliography-journals>B.9. Tijdschriften en periodieken</a></li></ul></li><li><input type=checkbox id=chapter-8bbb8867c46dac315e2253945d8c18a8 class=toggle>
<label class="icon cursor" for=chapter-8bbb8867c46dac315e2253945d8c18a8><a role=button></a></label><a href=https://docs.freebsd.org/nl/books/handbook/eresources/>Bijlage C. Bronnen op Internet</a><ul><li><a href=https://docs.freebsd.org/nl/books/handbook/eresources/#eresources-mail>C.1. Mailinglijsten</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/eresources/#eresources-news>C.2. Usenet-nieuwsgroepen</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/eresources/#eresources-web>C.3. World wide webservers</a></li><li><a href=https://docs.freebsd.org/nl/books/handbook/eresources/#eresources-email>C.4. Email-adressen</a></li></ul></li><li><input type=checkbox id=chapter-a80ea4f5a4480b8725422710f954ef36 class=toggle>
<label class="icon cursor" for=chapter-a80ea4f5a4480b8725422710f954ef36><a role=button></a></label><a href=https://docs.freebsd.org/nl/books/handbook/pgpkeys/>Bijlage D. PGP sleutels</a><ul><li><a href=https://docs.freebsd.org/nl/books/handbook/pgpkeys/#pgpkeys-officers>D.1. Beambten</a></li></ul></li><li></li></ul></nav></div></aside><div class=book><div class=book-menu-mobile><label for=menu-control><span class=menu-control-button><i class="fa fa-list" aria-hidden=true title="Book menu"></i>
Book menu</span></label></div><h1 class=title>Hoofdstuk 19. Opslag</h1><div class="admonitionblock note"><p><i class="fa fa-exclamation-circle" aria-hidden=true></i>
This translation may be out of date. To help with the translations please access the <a href=https://translate-dev.freebsd.org/ target=_blank>FreeBSD translations instance</a>.</p></div><div class=toc-mobile><h3>Table of Contents</h3><nav id=TableOfContents><ul><li><a href=#disks-synopsis>19.1. Overzicht</a></li><li><a href=#disks-naming>19.2. Apparaatnamen</a></li><li><a href=#disks-adding>19.3. Schijven toevoegen</a></li><li><a href=#raid>19.4. RAID</a></li><li><a href=#usb-disks>19.5. USB-opslagapparaten</a></li><li><a href=#creating-cds>19.6. Optische media (CDâ€™s) aanmaken en gebruiken</a></li><li><a href=#creating-dvds>19.7. Optische media (DVDâ€™s) aanmaken en gebruiken</a></li><li><a href=#floppies>19.8. Diskettes aanmaken en gebruiken</a></li><li><a href=#backups-tapebackups>19.9. Gegevensbanden aanmaken en gebruiken</a></li><li><a href=#backups-floppybackups>19.10. Naar diskettes back-uppen</a></li><li><a href=#backup-strategies>19.11. Back-up strategieÃ«n</a></li><li><a href=#backup-basics>19.12. Back-upbeginselen</a></li><li><a href=#disks-virtual>19.13. Netwerk-, geheugen-, en bestandsgebaseerde bestandssystemen</a></li><li><a href=#snapshots>19.14. Snapshots van bestandssystemen</a></li><li><a href=#quotas>19.15. Bestandssysteemquota</a></li><li><a href=#disks-encrypting>19.16. Schijfpartities versleutelen</a></li><li><a href=#swap-encrypting>19.17. Het versleutelen van de wisselbestand ruimte</a></li><li><a href=#disks-hast>19.18. Highly Available Storage (HAST)</a></li></ul></nav></div><div class=book-content><div id=preamble><div class=sectionbody></div></div><div class=sect1><h2 id=disks-synopsis>19.1. Overzicht<a class=anchor href=#disks-synopsis></a></h2><div class=sectionbody><div class=paragraph><p>Dit hoofdstuk behandelt het gebruik van schijven in FreeBSD. Dit omvat geheugenschijven, schijven die met het netwerk verbonden zijn, SCSI/IDE-opslagapparaten en apparaten die gebruik maken van de USB-interface.</p></div><div class=paragraph><p>Na het lezen van dit hoofdstuk weet de lezer:</p></div><div class=ulist><ul><li><p>Welke terminologie FreeBSD gebruikt om de gegevensindeling op een fysieke schijf te beschrijven (partities en slices);</p></li><li><p>Hoe aanvullende harde schijven aan een systeem toe te voegen;</p></li><li><p>Hoe FreeBSD in te stellen om het gebruik te laten maken van USB-opslagapparaten;</p></li><li><p>Hoe virtuÃ«le bestandssystemen, zoals geheugenschijven, aan te maken;</p></li><li><p>Hoe quota te gebruiken om het schijfgebruik te beperken;</p></li><li><p>Hoe schijven te versleutelen om ze tegen inbrekers te beschermen;</p></li><li><p>Hoe vanuit FreeBSD CDâ€™s en DVDâ€™s aan te maken en te branden;</p></li><li><p>Wat de verschillende mogelijkheden zijn voor opslagmedia voor back-ups;</p></li><li><p>Hoe back-upprogrammaâ€™s te gebruiken die beschikbaar zijn in FreeBSD;</p></li><li><p>Hoe een back-up naar diskettes te maken;</p></li><li><p>Wat bestandssysteem snapshots zijn en hoe ze efficiÃ«nt te gebruiken.</p></li></ul></div><div class=paragraph><p>Aangeraden voorkennis:</p></div><div class=ulist><ul><li><p>Hoe een nieuwe FreeBSD-kernel in te stellen en te installeren (<a href=../kernelconfig/#kernelconfig>De FreeBSD-kernel instellen</a>).</p></li></ul></div></div></div><div class=sect1><h2 id=disks-naming>19.2. Apparaatnamen<a class=anchor href=#disks-naming></a></h2><div class=sectionbody><div class=paragraph><p>De volgende lijst noemt de fysieke opslagapparaten die in FreeBSD ondersteund worden, samen met de bijhorende namen.</p></div><table id=disk-naming-physical-table class="tableblock frame-none grid-all stretch"><caption class=title>Tabel 1. Naamconventies voor fysieke Schijven</caption><col style=width:50%><col style=width:50%><thead><tr><th class="tableblock halign-left valign-top">Type medium</th><th class="tableblock halign-left valign-top">Apparaatnaam medium</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class=tableblock>IDE harde schijven</p></td><td class="tableblock halign-left valign-top"><p class=tableblock><code>ad</code></p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>IDE CD-ROM-stations</p></td><td class="tableblock halign-left valign-top"><p class=tableblock><code>acd</code></p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>SCSI harde schijven en USB-apparaten voor massa-opslag</p></td><td class="tableblock halign-left valign-top"><p class=tableblock><code>da</code></p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>SCSI CD-ROM-schijven</p></td><td class="tableblock halign-left valign-top"><p class=tableblock><code>cd</code></p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>Overige niet-standaard-CD-ROM-stations</p></td><td class="tableblock halign-left valign-top"><p class=tableblock><code>mcd</code> voor Mitsumi CD-ROM en <code>scd</code> voor Sony CD-ROM apparaten.</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>Diskettestations</p></td><td class="tableblock halign-left valign-top"><p class=tableblock><code>fd</code></p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>SCSI bandstations</p></td><td class="tableblock halign-left valign-top"><p class=tableblock><code>sa</code></p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>IDE bandstations</p></td><td class="tableblock halign-left valign-top"><p class=tableblock><code>ast</code></p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>Flashdrives</p></td><td class="tableblock halign-left valign-top"><p class=tableblock><code>fla</code> voor DiskOnChipÂ® flashapparaten</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class=tableblock>RAID-schijven</p></td><td class="tableblock halign-left valign-top"><p class=tableblock><code>aacd</code> voor AdaptecÂ® AdvancedRAID, <code>mlxd</code> en <code>mlyd</code> voor MylexÂ®, <code>amrd</code> voor AMI MegaRAIDÂ®, <code>idad</code> voor Compaq Smart RAID, <code>twed</code> voor 3wareÂ® RAID.</p></td></tr></tbody></table></div></div><div class=sect1><h2 id=disks-adding>19.3. Schijven toevoegen<a class=anchor href=#disks-adding></a></h2><div class=sectionbody><div class=paragraph><p>De volgende sectie beschrijft hoe een nieuwe SCSI schijf aan een machine toe te voegen die slechts een enkele drive heeft. Ten eerste dient de computer uitgeschakeld te worden en dient de schijf volgens de instructies van de computer, controller en schijffabrikant geÃ¯nstalleerd te worden. Wegens de grote variÃ©teiten om dit soort procedures uit te voeren, vallen de details buiten het bereik van dit document.</p></div><div class=paragraph><p>Er dient als gebruiker <code>root</code> ingelogd te worden. Nadat de schijf is toegevoegd, dient <span class=filename>/var/run/dmesg.boot</span> bekeken te worden om er zeker van te zijn dat de nieuwe schijf is gevonden. Volgens het voorbeeld heet de nieuw toegevoegde schijf <span class=filename>da1</span> en die wordt aangekoppeld op <span class=filename>/1</span> (als er een IDE-schijf wordt toegevoegd, is de apparaatnaam <span class=filename>ad1</span>).</p></div><div class=paragraph><p>FreeBSD draait op IBM-PC-compatibele computers. Daarom moet het rekening houden met de PC-BIOS-partities. Deze wijken af van de traditionele BSD-partities. Een PC-schijf bevat tot vier ingangen voor BIOS-partities. Indien de schijf geheel aan FreeBSD wordt gewijd, kan de <em>toegewijde</em>-modus gebruikt worden. In het andere geval moet FreeBSD binnen Ã©Ã©n van de vier PC-BIOS-partities draaien. De PC-BIOS-partities worden door FreeBSD <em>slices</em> genoemd om ze niet met de traditionele BSD-partities te verwarren. Slices kunnen ook op een schijf worden gebruikt die toegewijd is aan FreeBSD, maar in een computer zit die ook andere besturingssystemen heeft geÃ¯nstalleerd. Dit is een goede manier om verwarring met het programma <code>fdisk</code> van andere, niet-FreeBSD besturingssystemen te voorkomen.</p></div><div class=paragraph><p>Als er met slices gewerkt wordt, wordt de schijf toegevoegd als <span class=filename>/dev/da1s1e</span>. Dit moet worden gelezen als: SCSI-schijf, eenheid 1 (tweede SCSI-schijf), slice 1 (PC-BIOS-partitie 1) en BSD-partitie <span class=filename>e</span>. Als de schijf toegewijd is, wordt deze simpelweg als <span class=filename>/dev/da1e</span> toegevoegd.</p></div><div class=paragraph><p>Omdat 32-bit-integers worden gebruikt om het aantal sectoren op te slaan, is <a href="https://man.freebsd.org/cgi/man.cgi?query=bsdlabel&amp;sektion=8&amp;format=html">bsdlabel(8)</a> beperkt tot 2^32-1 sectoren per schijf, wat meestal neerkomt op 2 TB. Het programma <a href="https://man.freebsd.org/cgi/man.cgi?query=fdisk&amp;sektion=8&amp;format=html">fdisk(8)</a> staat geen hogere startsector toe dan 2^32-1 en geen grotere lengte dan 2^32-1, meestal worden hiermee partities tot 2 TB begrensd en schijven tot 4 TB. Het formaat van <a href="https://man.freebsd.org/cgi/man.cgi?query=sunlabel&amp;sektion=8&amp;format=html">sunlabel(8)</a> is beperkt tot 2^32-1 sectoren per partitie en 8 partities per schijf, in totaal dus 16 TB. Voor grotere schijven kan <a href="https://man.freebsd.org/cgi/man.cgi?query=gpart&amp;sektion=8&amp;format=html">gpart(8)</a> worden gebruikt om GPT-partities aan te maken. GPT heeft het bijkomende voordeel dat het niet tot 4 slices beperkt is.</p></div><div class=sect2><h3 id=_sysinstall8_gebruiken>19.3.1. <a href="https://man.freebsd.org/cgi/man.cgi?query=sysinstall&amp;sektion=8&amp;format=html">sysinstall(8)</a> gebruiken<a class=anchor href=#_sysinstall8_gebruiken></a></h3><div class="exampleblock procedure"><div class=content><div class="olist arabic"><ol class=arabic><li><p>Navigeren door sysinstall</p><div class=paragraph><p><code>sysinstall</code> kan gebruikt worden om een nieuwe schijf te partitioneren en te labelen met eenvoudig te gebruiken menuâ€™s. Hiervoor dient Ã²fwel als gebruiker <code>root</code> ingelogd te zijn, Ã²fwel gebruik te worden gemaakt van <code>su</code>. Draai <code>sysinstall</code> en ga naar het menu <code>Configure</code>. Scroll binnen het <code>FreeBSD Configuration Menu</code> naar beneden en kies de optie <code>Fdisk</code>.</p></div></li><li><p>fdisk partitie-bewerker</p><div class=paragraph><p>Eenmaal binnen fdisk kan op <kbd>A</kbd> gedrukt worden om de gehele schijf voor FreeBSD te gebruiken. Wanneer gevraagd wordt of het systeem compatibel dient te blijven met mogelijk toekomstige besturingssystemen, dient met <code>YES</code> geantwoord te worden. Met <kbd>W</kbd> kunnen de veranderingen naar de schijf worden geschreven. Nu dient de FDISK-bewerker verlaten te worden door op <kbd>Q</kbd> te drukken. Vervolgens wordt er een vraag gesteld over het "Master Boot Record". Omdat er een schijf aan een reeds draaiend systeem wordt toegevoegd, dient hier <code>None</code> gekozen te worden.</p></div></li><li><p>Schijflabelbewerker</p><div class=paragraph><p>Vervolgens dient sysinstall verlaten en opnieuw gestart te worden. Volg bovenstaande aanwijzingen, maar kies deze keer voor de optie <code>Label</code>. Dit geeft toegang tot de <code>Disk Label Editor</code>. Hier worden de traditionele BSD-partities aangemaakt. Een schijf kan tot acht partities bevatten, gelabeld <code>a-h</code>. Enkele partitielabels hebben een speciale functie. De partitie <code>a</code> wordt gebruikt voor de rootpartitie (<span class=filename>/</span>). Alleen de systeemschijf (bijvoorbeeld de schijf van waaruit opgestart wordt) moet een partitie <code>a</code> hebben. De partitie <code>b</code> wordt voor swappartities gebruikt, en het is mogelijk om vele schijven met swappartities te hebben. De partitie <code>c</code> adresseert de gehele schijf in toegewijde modus, of de gehele FreeBSD-slice in slice-modus. De andere partities zijn voor algemeen gebruik.</p></div><div class=paragraph><p>sysinstallâ€™s Labelbewerker heeft een voorkeur voor de partitie <code>e</code> voor niet-root-niet-swap-partities. Binnen de Labelbewerker dient een enkel bestandssysteem te worden aangemaakt door op <kbd>C</kbd> te drukken. Kies <code>FS</code> wanneer gevraagd wordt of dit een FS (file system) of swap wordt, en geef een koppelpunt in (bijvoorbeeld <span class=filename>/mnt</span>). Wanneer een schijf in post-installatie-modus wordt toegevoegd, maakt sysinstall geen ingangen aan in <span class=filename>/etc/fstab</span>, dus dan is het opgegeven koppelpunt niet van belang.</p></div><div class=paragraph><p>Nu kan het nieuwe label naar de schijf worden geschreven en er een bestandssysteem op aangemaakt worden. Dit kan gedaan worden door op <kbd>W</kbd> te drukken. Fouten van sysinstall dat de nieuwe partitie niet aankoppeld kon worden kunnen genegeerd worden. De Labelbewerker en sysinstall kunnen nu volledig verlaten worden.</p></div></li><li><p>Afronden</p><div class=paragraph><p>De laatste stap bestaat uit het bewerken van <span class=filename>/etc/fstab</span> om hier een regel voor de nieuwe schijf aan toe te voegen.</p></div></li></ol></div></div></div></div><div class=sect2><h3 id=_het_gebruik_van_opdrachtregelgereedschappen>19.3.2. Het gebruik van opdrachtregelgereedschappen<a class=anchor href=#_het_gebruik_van_opdrachtregelgereedschappen></a></h3><div class=sect3><h4 id=_het_gebruik_van_slices>19.3.2.1. Het gebruik van slices<a class=anchor href=#_het_gebruik_van_slices></a></h4><div class=paragraph><p>Deze installatie zorgt ervoor dat de schijf correct samenwerkt met andere besturingssystemen die eventueel op de computer zijn geÃ¯nstalleerd en dat de <code>fdisk</code>-gereedschappen van andere besturingssystemen niet verward raken. Het wordt aangeraden om deze methode te gebruiken voor de installatie van nieuwe schijven. Gebruik de <code>toegewijde</code> modus alleen als hier een goede reden voor bestaat!</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># dd if=/dev/zero of/dev/da1 bs=1k count=1</span>
<span class=c># fdisk -BI da1 # Initialiseer de nieuwe schijf.</span>
<span class=c># bsdlabel -B -w da1s1 auto # Label de schijf.</span>
<span class=c># bsdlabel -e da1s1 # Bewerk de zojuist aangemaakte schijflabel en voeg partities toe.</span>
<span class=c># mkdir -p /1</span>
<span class=c># newfs /dev/da1s1e # Herhaal dit voor alle aangemaakte partities.</span>
<span class=c># mount /dev/da1s1e /1 # Mount de partitie(s).</span>
<span class=c># vi /etc/fstab # Voeg de juiste regel(s) aan /etc/fstab toe.</span></code></pre></div></div><div class=paragraph><p>Vervang voor een IDE-schijf <span class=filename>da</span> door <span class=filename>ad</span>.</p></div></div><div class=sect3><h4 id=_toegewijd>19.3.2.2. Toegewijd<a class=anchor href=#_toegewijd></a></h4><div class=paragraph><p>Indien de nieuwe schijf niet met een ander besturingssysteem gedeeld wordt, kan de <code>toegewijde</code> modus gebruikt worden. Denk eraan dat deze modus besturingssystemen van Microsoft kan verwarren. Ze richten echter geen schade aan. IBMâ€™s OS/2Â® "fatsoeneert" echter partities die het niet begrijpt.</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># dd if=/dev/zero of=/dev/da1 bs=1k count=1</span>
<span class=c># bsdlabel -Bw da1 auto</span>
<span class=c># bsdlabel -e da1 # Maak de `e&#39;-partitie aan.</span>
<span class=c># newfs /dev/da1e</span>
<span class=c># mkdir -p /1</span>
<span class=c># vi /etc/fstab # Voeg een regel voor /dev/da1e toe.</span>
<span class=c># mount /1</span></code></pre></div></div><div class=paragraph><p>Een alternatieve methode is:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># dd if=/dev/zero of=/dev/da1 count=2</span>
<span class=c># bsdlabel /dev/da1 | bsdlabel -BR da1 /dev/stdin</span>
<span class=c># newfs /dev/da1e</span>
<span class=c># mkdir -p /1 # Voeg een regel voor /dev/da1e toe.</span>
<span class=c># mount /1</span></code></pre></div></div></div></div></div></div><div class=sect1><h2 id=raid>19.4. RAID<a class=anchor href=#raid></a></h2><div class=sectionbody><div class=sect2><h3 id=raid-soft>19.4.1. Software RAID<a class=anchor href=#raid-soft></a></h3><div class=sect3><h4 id=ccd>19.4.1.1. Concatenated Disk Driver (CCD) instellingen<a class=anchor href=#ccd></a></h4><div class=paragraph><p>Bij het kiezen van een medium voor massa-opslag zijn de belangrijkste afwegingen snelheid, betrouwbaarheid en kosten. Het komt zelden voor dat alle drie in balans zijn. Normaalgesproken is een snel, betrouwbaar apparaat voor massa-opslag duur en kosten sparen gaat ten koste van Ã²fwel snelheid Ã²fwel betrouwbaarheid.</p></div><div class=paragraph><p>Bij het ontwerpen van het onderstaande systeem werd primair op de kosten gelet, gevolgd door snelheid en als laatste betrouwbaarheid. De overdrachtsnelheid van gegevens wordt voor dit systeem uiteindelijk beperkt door het netwerk. En hoewel betrouwbaarheid erg belangrijk is, wordt onderstaande CCD-schijf gebruikt voor het serven van on-line gegevens die reeds volledig op CD-Râ€™s zijn geback-upt en eenvoudig vervangen kunnen worden.</p></div><div class=paragraph><p>De eerste stap in het kiezen van een massa-opslagoplossing is het bepalen van de eigen benodigdheden. Indien snelheid belangrijker is dan betrouwbaarheid of kosten, wijkt de oplossing af van het systeem dat in deze sectie wordt beschreven.</p></div><div class=sect4><h5 id=ccd-installhw>19.4.1.1.1. Hardware installeren<a class=anchor href=#ccd-installhw></a></h5><div class=paragraph><p>Als aanvulling op de IDE systeemschijf zijn drie Western Digital IDE-schijven van 30 GB, 5400 RPM vanuit de kern van de onderstaande CCD-schijf aanwezig, die ongeveer 90 GB aan on-line opslag bieden. Ideaal gezien heeft iedere IDE-schijf een eigen IDE-controller en kabel, maar om de kosten te minimaliseren zijn geen aanvullende IDE-kabels gebruikt. In plaats hiervan zijn de schijven zodanig met jumpers ingesteld dat elke IDE-controller Ã©Ã©n master en Ã©Ã©n slave heeft.</p></div><div class=paragraph><p>Tijdens het opnieuw opstarten werd het systeem-BIOS zodanig ingesteld dat het automatisch de aangekoppelde schijven detecteerde. Het was belangrijker dat FreeBSD ze tijdens het opnieuw opstarten herkende:</p></div><div class="literalblock programlisting"><div class=content><pre>ad0: 19574MB &lt;WDC WD205BA&gt; [39770/16/63] at ata0-master UDMA33
ad1: 29333MB &lt;WDC WD307AA&gt; [59598/16/63] at ata0-slave UDMA33
ad2: 29333MB &lt;WDC WD307AA&gt; [59598/16/63] at ata1-master UDMA33
ad3: 29333MB &lt;WDC WD307AA&gt; [59598/16/63] at ata1-slave UDMA33</pre></div></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Indien FreeBSD niet alle schijven detecteert, moet gecontroleerd worden of de jumpers juist zijn ingesteld. De meeste IDE-schijven hebben ook een jumper voor "Cable Select". Dit is <em>niet</em> de jumper voor de master/slave-instelling. Voor hulp met het identificeren van de juiste jumper dient de documentatie van de schijf geraadpleegd te worden.</p></div></td></tr></tbody></table></div></div><div class=sect4><h5 id=ccd-setup>19.4.1.1.2. CCD installeren<a class=anchor href=#ccd-setup></a></h5><div class=paragraph><p>Het stuurprogramma <a href="https://man.freebsd.org/cgi/man.cgi?query=ccd&amp;sektion=4&amp;format=html">ccd(4)</a> biedt de mogelijkheid om meerdere identieke schijven aaneen te rijgen tot Ã©Ã©n logisch bestandssysteem. Om gebruik te kunnen maken van <a href="https://man.freebsd.org/cgi/man.cgi?query=ccd&amp;sektion=4&amp;format=html">ccd(4)</a> is een kernel met ingebouwde ondersteuning voor <a href="https://man.freebsd.org/cgi/man.cgi?query=ccd&amp;sektion=4&amp;format=html">ccd(4)</a> nodig. De volgende regel dient toegevoegd te worden aan het kernelinstellingenbestand en de kernel dient opnieuw gebouwd en geÃ¯nstalleerd te worden:</p></div><div class="literalblock programlisting"><div class=content><pre>device  ccd</pre></div></div><div class=paragraph><p>Om <a href="https://man.freebsd.org/cgi/man.cgi?query=ccd&amp;sektion=4&amp;format=html">ccd(4)</a> te installeren dient eerst <a href="https://man.freebsd.org/cgi/man.cgi?query=bsdlabel&amp;sektion=8&amp;format=html">bsdlabel(8)</a> gebruikt te worden om de schijven te labelen:</p></div><div class="literalblock programlisting"><div class=content><pre>bsdlabel -w -ad1 auto
bsdlabel -w ad2 auto
bsdlabel -w ad3 auto</pre></div></div><div class=paragraph><p>Bovenstaande maakt een schijflabel aan voor <span class=filename>ad1c</span>, <span class=filename>ad2c</span> en <span class=filename>ad3c</span> die de gehele schijf beslaat.</p></div><div class=paragraph><p>Vervolgens dient het labeltype van de schijf veranderd te worden. Voor het bewerken van de schijven kan <a href="https://man.freebsd.org/cgi/man.cgi?query=bsdlabel&amp;sektion=8&amp;format=html">bsdlabel(8)</a> gebruikt worden:</p></div><div class="literalblock programlisting"><div class=content><pre>bsdlabel -e ad1
bsdlabel -e ad2
bsdlabel -e ad3</pre></div></div><div class=paragraph><p>Dit zorgt ervoor dat het huidige schijflabel van elke schijf met de tekstverwerker wordt geopend die door de omgevingsvariabele <code>EDITOR</code> wordt gespecificeerd, vaak <a href="https://man.freebsd.org/cgi/man.cgi?query=vi&amp;sektion=1&amp;format=html">vi(1)</a>.</p></div><div class=paragraph><p>Een ongewijzigd schijflabel ziet er ongeveer als volgt uit:</p></div><div class="literalblock programlisting"><div class=content><pre>8 partitions:
# size	offset	fstype	[fsize	bsize bps/cpg]
c: 60074784 0 unused  0	0 0 # (Cyl. 0 - 59597)</pre></div></div><div class=paragraph><p>Er dient een nieuwe partitie <code>e</code> toegevoegd te worden die door <a href="https://man.freebsd.org/cgi/man.cgi?query=ccd&amp;sektion=4&amp;format=html">ccd(4)</a> gebruikt kan worden. Deze kan gewoonlijk van partitie <code>c</code> overgenomen worden, maar het <code>fstype <em>moet</em> 4.2BSD</code> zijn. Het schijflabel ziet er nu ongeveer als volgt uit:</p></div><div class="literalblock programlisting"><div class=content><pre>8 partitions:
# size	offset	fstype	[fsize	bsize bps/cpg]
c:  60074784  0	unused	0 0 0 # (Cyl. 0 - 59597)
e:  60074784  0	4.2BSD	0 0 0 #	(Cyl. 0 - 59597)</pre></div></div></div><div class=sect4><h5 id=ccd-buildingfs>19.4.1.1.3. Bestandssysteem aanmaken<a class=anchor href=#ccd-buildingfs></a></h5><div class=paragraph><p>Nu alle schijven gelabeld zijn, moet de <a href="https://man.freebsd.org/cgi/man.cgi?query=ccd&amp;sektion=4&amp;format=html">ccd(4)</a> gebouwd worden. Om dit te doen, dient <a href="https://man.freebsd.org/cgi/man.cgi?query=ccdconfig&amp;sektion=8&amp;format=html">ccdconfig(8)</a> gebruikt te worden met opties die ongeveer gelijk zijn aan de volgende:</p></div><div class="literalblock programlisting"><div class=content><pre>ccdconfig ccd0 32 0 /dev/ad1e /dev/ad2e /dev/ad3e</pre></div></div><div class=paragraph><p>Hieronder staat het gebruik en de betekenis van elke optie:</p></div><div class=ulist><ul><li><p>Het eerste argument is het in te stellen apparaat, in dit geval <span class=filename>/dev/ccd0c</span>. Het gedeelte <span class=filename>/dev/</span> is optioneel.</p></li><li><p>De interleave voor het bestandssysteem. De interleave definiÃ«ert de grootte van een stripe in schijfblokken, elk schijfblok is normaalgesproken 512 bytes groot. Een interleave van 32 is dus 16.384 bytes groot.</p></li><li><p>Vlaggen voor <a href="https://man.freebsd.org/cgi/man.cgi?query=ccdconfig&amp;sektion=8&amp;format=html">ccdconfig(8)</a>. Indien het gewenst is om schijfspiegeling aan te zetten, kan er hier een vlag voor gespecificeerd worden. Deze opstelling biedt geen spiegeling voor <a href="https://man.freebsd.org/cgi/man.cgi?query=ccd&amp;sektion=4&amp;format=html">ccd(4)</a>, dus is die op 0 (nul) ingesteld.</p></li><li><p>De laatste argumenten voor <a href="https://man.freebsd.org/cgi/man.cgi?query=ccdconfig&amp;sektion=8&amp;format=html">ccdconfig(8)</a> zijn de apparaten die in de rij geplaatst dienen te worden. Voor elk apparaat dient de complete padnaam gebruikt te worden.</p></li></ul></div><div class=paragraph><p>Nadat <a href="https://man.freebsd.org/cgi/man.cgi?query=ccdconfig&amp;sektion=8&amp;format=html">ccdconfig(8)</a> gedraaid is, is de <a href="https://man.freebsd.org/cgi/man.cgi?query=ccd&amp;sektion=4&amp;format=html">ccd(4)</a> ingesteld. Er kan een bestandssysteem worden geÃ¯nstalleerd. Er kan in <a href="https://man.freebsd.org/cgi/man.cgi?query=newfs&amp;sektion=8&amp;format=html">newfs(8)</a> worden gekeken voor opties, of het draaien van het onderstaande commando is ook toereikend:</p></div><div class="literalblock programlisting"><div class=content><pre>newfs /dev/ccd0c</pre></div></div></div><div class=sect4><h5 id=ccd-auto>19.4.1.1.4. Alles automatisch maken<a class=anchor href=#ccd-auto></a></h5><div class=paragraph><p>In het algemeen is het wenselijk om de <a href="https://man.freebsd.org/cgi/man.cgi?query=ccd&amp;sektion=4&amp;format=html">ccd(4)</a> telkens te mouten wanneer er opnieuw opgestart wordt. Dit dient eerst ingesteld te worden. Met het volgende commando worden de huidige instellingen naar <span class=filename>/etc/ccd.conf</span> geschreven:</p></div><div class="literalblock programlisting"><div class=content><pre>ccdconfig -g &gt; /etc/ccd.conf</pre></div></div><div class=paragraph><p>Tijdens het opstarten draait het script <code>/etc/rc ccdconfig -C</code> indien <span class=filename>/etc/ccd.conf</span> bestaat. Dit stelt automatisch de <a href="https://man.freebsd.org/cgi/man.cgi?query=ccd&amp;sektion=4&amp;format=html">ccd(4)</a> in, zodat die kan worden aangekoppeld.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Indien er in enkele-gebruiker-modus wordt opgestart, dient het volgende commando te worden uitgevoerd om de rij in te stellen voordat de <a href="https://man.freebsd.org/cgi/man.cgi?query=ccd&amp;sektion=4&amp;format=html">ccd(4)</a> aangekoppeld kan worden:</p></div><div class="literalblock programlisting"><div class=content><pre>ccdconfig -C</pre></div></div></td></tr></tbody></table></div><div class=paragraph><p>Om de <a href="https://man.freebsd.org/cgi/man.cgi?query=ccd&amp;sektion=4&amp;format=html">ccd(4)</a> automatisch aan te koppelen, kan er een regel voor de <a href="https://man.freebsd.org/cgi/man.cgi?query=ccd&amp;sektion=4&amp;format=html">ccd(4)</a> in <span class=filename>/etc/fstab</span> geplaatst worden, zodat die tijdens het opstarten aangekoppeld wordt:</p></div><div class="literalblock programlisting"><div class=content><pre>/dev/ccd0c  /media  ufs rw  2	2</pre></div></div></div></div><div class=sect3><h4 id=vinum>19.4.1.2. Volumebeheerder Vinum<a class=anchor href=#vinum></a></h4><div class=paragraph><p>De volumebeheerder Vinum is een blokstuurprogramma dat virtuele schijven implementeert. Het isoleert schijfhardware van de blokapparaat-interface en projecteert gegevens op een manier die de flexibiliteit, prestatie en betrouwbaarheid verhoogt in vergelijking met de traditionele slice-blik op schijfopslag. <a href="https://man.freebsd.org/cgi/man.cgi?query=vinum&amp;sektion=4&amp;format=html">vinum(4)</a> implementeert de modellen RAID-0, RAID-1 en RAID-5, zowel individueel als als combinatie.</p></div></div></div><div class=sect2><h3 id=raid-hard>19.4.2. Hardwarematige RAID<a class=anchor href=#raid-hard></a></h3><div class=paragraph><p>FreeBSD ondersteunt ook een verscheidenheid aan hardwarematige RAID-stuurprogrammaâ€™s. Deze apparaten besturen een RAID-deelsysteem zonder dat er FreeBSD-specifieke software nodig is om de rij te beheren.</p></div><div class=paragraph><p>Door gebruik te maken van een BIOS die op de kaart aanwezig is, beheert de kaart de meeste schijfbewerkingen zelf. Nu volgt een korte beschrijving van een opzet waarbij een Promise IDE-stuurprogramma is gebruikt. Wanneer deze kaart geÃ¯nstalleerd en het systeem opgestart is, beeldt het een prompt af waarbij om informatie wordt gevraagd. De instructies dienen opgevolgd te worden om bij het instelscherm van de kaart te komen. Van hieruit kunnen alle aangekoppelde schijven gecombineerd worden. Nadat dit gedaan is, zien de schijven er voor FreeBSD als Ã©Ã©n enkele schijf uit. Andere RAID-niveaus kunnen overeenkomstig ingesteld worden.</p></div></div><div class=sect2><h3 id=_ata_raid1_rijen_opnieuw_bouwen>19.4.3. ATA RAID1-rijen opnieuw bouwen<a class=anchor href=#_ata_raid1_rijen_opnieuw_bouwen></a></h3><div class=paragraph><p>Met FreeBSD is het mogelijk om een defecte schijf in een rij te vervangen terwijl de computer aanstaat ("hot replace"). Hiervoor dient de schijf vÃ³Ã³r het opnieuw opstarten vervangen te zijn.</p></div><div class=paragraph><p>Waarschijnlijk is zoiets als het volgende in <span class=filename>/var/log/messages</span> of in de uitvoer van <a href="https://man.freebsd.org/cgi/man.cgi?query=dmesg&amp;sektion=8&amp;format=html">dmesg(8)</a> te zien:</p></div><div class="literalblock programlisting"><div class=content><pre>ad6 on monster1 suffered a hard error.
ad6: READ command timeout tag=0 serv=0 - resetting
ad6: trying fallback to PIO mode
ata3: resetting devices .. done
ad6: hard error reading fsbn 1116119 of 0-7 (ad6 bn 1116119; cn 1107 tn 4 sn 11)\\
status=59 error=40
ar0: WARNING - mirror lost</pre></div></div><div class=paragraph><p>Meer informatie kan met behulp van <a href="https://man.freebsd.org/cgi/man.cgi?query=atacontrol&amp;sektion=8&amp;format=html">atacontrol(8)</a> gezocht worden:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># atacontrol list</span>
ATA channel 0:
	Master:      no device present
	Slave:   acd0 &lt;HL-DT-ST CD-ROM GCR-8520B/1.00&gt; ATA/ATAPI rev 0

ATA channel 1:
	Master:      no device present
	Slave:       no device present

ATA channel 2:
	Master:  ad4 &lt;MAXTOR 6L080J4/A93.0500&gt; ATA/ATAPI rev 5
	Slave:       no device present

ATA channel 3:
	Master:  ad6 &lt;MAXTOR 6L080J4/A93.0500&gt; ATA/ATAPI rev 5
	Slave:       no device present

<span class=c># atacontrol status ar0</span>
ar0: ATA RAID1 subdisks: ad4 ad6 status: DEGRADED</code></pre></div></div><div class="exampleblock procedure"><div class=content><div class="olist arabic"><ol class=arabic><li><p>Ontkoppel eerst het ata kanaal met de falende schijf zodat deze veilig kan worden verwijderd:</p><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># atacontrol detach ata3</span></code></pre></div></div></li><li><p>Vervang de schijf.</p></li><li><p>Koppel het ata kanaal opnieuw aan:</p><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># atacontrol attach ata3</span>
Master:  ad6 &lt;MAXTOR 6L080J4/A93.0500&gt; ATA/ATAPI rev 5
Slave:   no device present</code></pre></div></div></li><li><p>Voeg de nieuwe schijf toe aan de rij als reserve:</p><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># atacontrol addspare ar0 ad6</span></code></pre></div></div></li><li><p>De rij dient nu opnieuw opgebouwd te worden:</p><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># atacontrol rebuild ar0</span></code></pre></div></div></li><li><p>Het is mogelijk de voortgang te volgen met het volgende commando:</p><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># dmesg | tail -10</span>
<span class=o>[</span>uitvoer verwijderd]
ad6: removed from configuration
ad6: deleted from ar0 disk1
ad6: inserted into ar0 disk1 as spare

<span class=c># atacontrol status ar0</span>
ar0: ATA RAID1 subdisks: ad4 ad6 status: REBUILDING 0% completed</code></pre></div></div></li><li><p>Nu moet er gewacht worden tot de bewerking voltooid is.</p></li></ol></div></div></div></div></div></div><div class=sect1><h2 id=usb-disks>19.5. USB-opslagapparaten<a class=anchor href=#usb-disks></a></h2><div class=sectionbody><div class=paragraph><p>Veel externe opslagoplossingen gebruiken tegenwoordig de Universele SeriÃ«le Bus (USB): harde schijven, USB-duimdrives, CD-R-branders, etc. FreeBSD biedt voor al dit soort apparaten ondersteuning.</p></div><div class=sect2><h3 id=_instellen>19.5.1. Instellen<a class=anchor href=#_instellen></a></h3><div class=paragraph><p>Het stuurprogramma <a href="https://man.freebsd.org/cgi/man.cgi?query=umass&amp;sektion=4&amp;format=html">umass(4)</a> biedt de ondersteuning voor USB-opslagapparaten. Indien de kernel <span class=filename>GENERIC</span> wordt gebruikt, hoeft er niets aan de instellingen gewijzigd te worden. Als er een eigen kernel wordt gebruikt, dienen de volgende regels in het kernelinstellingenbestand aanwezig zijn:</p></div><div class="literalblock programlisting"><div class=content><pre>device scbus
device da
device pass
device uhci
device ohci
device ehci
device usb
device umass</pre></div></div><div class=paragraph><p>Het stuurprogramma <a href="https://man.freebsd.org/cgi/man.cgi?query=umass&amp;sektion=4&amp;format=html">umass(4)</a> gebruikt het subsysteem SCSI om toegang te krijgen tot de USB-opslagapparaten. Het USB-apparaat wordt door het systeem als een SCSI-apparaat gezien. Afhankelijk van de chipset op het moederbord is slechts Ã²f <code>device uhci</code> Ã²f <code>device ohci</code> nodig voor ondersteuning van USB 1.X. Het kan echter geen kwaad om ze beiden in het kernelinstellingenbestand te hebben. Ondersteuning voor USB 2.0 wordt geleverd door het stuurprogramma <a href="https://man.freebsd.org/cgi/man.cgi?query=ehci&amp;sektion=4&amp;format=html">ehci(4)</a> (de regel met <code>device ehci</code>). Indien er regels zijn toegevoegd dient de kernel opnieuw gecompileerd en geÃ¯nstalleerd te worden.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Indien het USB-apparaat een CD-R- of DVD-brander is, dient het SCSI CD-ROM-stuurprogramma <a href="https://man.freebsd.org/cgi/man.cgi?query=cd&amp;sektion=4&amp;format=html">cd(4)</a> met de volgende regel aan de kernel toegevoegd te worden:</p></div><div class="literalblock programlisting"><div class=content><pre>device cd</pre></div></div><div class=paragraph><p>Aangezien de brander als een SCSI-schijf gezien wordt, dient het stuurprogramma <a href="https://man.freebsd.org/cgi/man.cgi?query=atapicam&amp;sektion=4&amp;format=html">atapicam(4)</a> niet in de kernelinstellingen gebruikt te worden.</p></div></td></tr></tbody></table></div></div><div class=sect2><h3 id=_instellingen_testen>19.5.2. Instellingen testen<a class=anchor href=#_instellingen_testen></a></h3><div class=paragraph><p>De instellingen zijn klaar om getest te worden: het USB-apparaat dient aangesloten te worden en in de buffer voor systeemmeldingen (<a href="https://man.freebsd.org/cgi/man.cgi?query=dmesg&amp;sektion=8&amp;format=html">dmesg(8)</a>) dient het stuurprogramma ongeveer als volgt te verschijnen:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>umass0: USB Solid state disk, rev 1.10/1.00, addr 2
GEOM: create disk da0 <span class=nv>dp</span><span class=o>=</span>0xc2d74850
da0 at umass-sim0 bus 0 target 0 lun 0
da0: &lt;Generic Traveling Disk 1.11&gt; Removable Direct Access SCSI-2 device
da0: 1.000MB/s transfers
da0: 126MB <span class=o>(</span>258048 512 byte sectors: 64H 32S/T 126C<span class=o>)</span></code></pre></div></div><div class=paragraph><p>Uiteraard kunnen het merk, de apparaatnode (<span class=filename>da0</span>) en andere details verschillen naar gelang de instelling.</p></div><div class=paragraph><p>Aangezien het USB-apparaat als een SCSI-apparaat gezien wordt, kan het commando <code>camcontrol</code> gebruikt worden om de USB-opslagapparaten weer te geven die aan het systeem gekoppeld zijn:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># camcontrol devlist</span>
&lt;Generic Traveling Disk 1.11&gt;      at scbus0 target 0 lun 0 <span class=o>(</span>da0,pass0<span class=o>)</span></code></pre></div></div><div class=paragraph><p>Indien er een bestandssysteem op de schijf aanwezig is, kan dat aangekoppeld worden. <a href=#disks-adding>Schijven toevoegen</a> biedt indien nodig hulp bij het formatteren en aanmaken van partities op de USB-drive.</p></div><div class="admonitionblock warning"><table><tbody><tr><td class=icon><i class="fa icon-warning" title=Warning></i></td><td class=content><div class=paragraph><p>Door het toestaan dat gewone gebruikers verschillende media kunnen koppelen door bijvoorbeeld het aanzetten van <code>vfs.usermount</code> zoals hieronder beschreven, zou niet als veilig beschoud moeten worden uit een beveiligings oogpunt. Veel bestandssystemen in FreeBSD zijn niet geschreven om beveiliging te bieden tegen kwaadaardige apparaten.</p></div></td></tr></tbody></table></div><div class=paragraph><p>Om het apparaat koppelbaar te maken voor de gewone gebruiker moeten er een aantal stappen ondernomen worden. Als eerste moeten de apparaten die gecreeerd worden wanneer het USB opslag- medium wordt toegevoegd toegankelijk zijn voor de gebruiker. Een oplossing is om alle gebruikers die deze rechten nodig hebben toe te voegen aan de <code>operator</code> groep. Dit kan gedaan worden met <a href="https://man.freebsd.org/cgi/man.cgi?query=pw&amp;sektion=8&amp;format=html">pw(8)</a>. Daarna moet het voor de <code>operator</code> groep mogelijk zijn te lezen en te schrijven naar de gecreeerde apparaten. Dit kan bewerkstelligd worden door de volgende regels toe te voegen aan <span class=filename>/etc/devfs.rules</span>:</p></div><div class="literalblock programlisting"><div class=content><pre>[localrules=5]
add path &#39;da*&#39; mode 0660 group operator</pre></div></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Als er SCSI schijven in het systeem aanwezig zijn moet dit anders aangepakt worden. Stel dat het systeem reeds over de volgende schijven beschikt <span class=filename>da0</span> tot en met <span class=filename>da2</span>, verander de regel dan in het volgende:</p></div><div class="literalblock programlisting"><div class=content><pre>add path &#39;da[3-9]*&#39; mode 0660 group operator</pre></div></div><div class=paragraph><p>Dit sluit de reeds bestaande schijven buiten van toegang door de operator groep.</p></div></td></tr></tbody></table></div><div class=paragraph><p>Erna moet ook de nieuwe ruleset voor <a href="https://man.freebsd.org/cgi/man.cgi?query=devfs.rules&amp;sektion=5&amp;format=html">devfs.rules(5)</a> ingeschakeld worden door middel van <span class=filename>/etc/rc.conf</span>:</p></div><div class="literalblock programlisting"><div class=content><pre>devfs_system_ruleset=&#34;localrules&#34;</pre></div></div><div class=paragraph><p>Hierna moet de kernel worden geconfigureerd zodat gewone gebruikers rechten krijgen om bestandssystemen te koppelen. De makkelijkste manier is door de volgende regel toe te voegen aan <span class=filename>/etc/sysctl.conf</span>:</p></div><div class="literalblock programlisting"><div class=content><pre>vfs.usermount=1</pre></div></div><div class=paragraph><p>Let op, deze wijziging wordt pas actief na de volgende start van het systeem. Als alternatief kan ook <a href="https://man.freebsd.org/cgi/man.cgi?query=sysctl&amp;sektion=8&amp;format=html">sysctl(8)</a> gebruikt worden om deze variabele te zetten.</p></div><div class=paragraph><p>De laatste stap is het creÃ«eren van de map waar het bestandssysteem gekoppeld wordt. Deze map moet eigendom zijn van de gebruiker die het bestandssysteem gaat koppelen. Een manier om dat te bewerkstelligen is door met de gebruiker <code>root</code> een submap aan te maken die eigendom is van de gebruiker als <span class=filename>/mntgebruikersnaam</span> (verander <em>gebruikersnaam</em> door de loginnaam van de daadwerkelijke gebruiker en <em>gebruikersgroep</em> door de primaire groep van de gebruiker):</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># mkdir /mnt/gebruikersnaam</span>
<span class=c># chown gebruikersnaam:gebruikersgroep /mnt/gebruikersnaam</span></code></pre></div></div><div class=paragraph><p>Stel dat er vervolgens een USB-stick ingeplugged wordt en er een <span class=filename>/dev/da0s1</span> aangemaakt wordt. Omdat deze apparaten meestal voorgeformatteerd met een FAT-bestandssysteem komen, kan deze als volgende gekoppeld worden:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>% mount <span class=nt>-t</span> msdosfs <span class=nt>-o</span> <span class=nt>-m</span><span class=o>=</span>644,-M<span class=o>=</span>755 /dev/da0s1 /mnt/gebruikersnaam</code></pre></div></div><div class=paragraph><p>Indien het apparaat losgekoppeld wordt (nadat de schijf afgekoppeld is), dient in de buffer voor systeemmeldingen iets als het volgende te zien te zijn:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>umass0: at uhub0 port 1 <span class=o>(</span>addr2<span class=o>)</span> disconnected
<span class=o>(</span>da0:umass-sim0:0:0:0<span class=o>)</span>: lost device
<span class=o>(</span>da0:umass-sim0:0:0:0<span class=o>)</span>: removing device entry
GEOM: destroy disk da0 <span class=nv>dp</span><span class=o>=</span>0xc2d74850
umass0: detached</code></pre></div></div></div><div class=sect2><h3 id=_referenties>19.5.3. Referenties<a class=anchor href=#_referenties></a></h3><div class=paragraph><p>Naast de onderdelen <a href=#disks-adding>Schijven toevoegen</a> en <a href=../basics/#mount-unmount>Bestandssystemen aan- en afkoppelen</a>, kunnen de volgende hulppaginaâ€™s ook nuttig zijn: <a href="https://man.freebsd.org/cgi/man.cgi?query=umass&amp;sektion=4&amp;format=html">umass(4)</a>, <a href="https://man.freebsd.org/cgi/man.cgi?query=camcontrol&amp;sektion=8&amp;format=html">camcontrol(8)</a> en <a href="https://man.freebsd.org/cgi/man.cgi?query=usbconfig&amp;sektion=8&amp;format=html">usbconfig(8)</a> voor FreeBSD 8.X of <a href="https://man.freebsd.org/cgi/man.cgi?query=usbdevs&amp;sektion=8&amp;format=html">usbdevs(8)</a> voor eerdere versies van FreeBSD.</p></div></div></div></div><div class=sect1><h2 id=creating-cds>19.6. Optische media (CDâ€™s) aanmaken en gebruiken<a class=anchor href=#creating-cds></a></h2><div class=sectionbody><div class=sect2><h3 id=_inleiding>19.6.1. Inleiding<a class=anchor href=#_inleiding></a></h3><div class=paragraph><p>CDâ€™s hebben een aantal eigenschappen waardoor ze verschillen van conventionele schijven. Initieel zijn ze door de gebruiker niet beschrijfbaar. Ze zijn zÃ³ ontworpen dat ze continu, zonder vertragingen van het verplaatsen van de kop tussen tracks, gelezen kunnen worden. Ze zijn ook veel gemakkelijker tussen twee systemen te verplaatsen dan gelijksoortige media in hun tijd waren.</p></div><div class=paragraph><p>CDâ€™s hebben tracks, maar die verwijzen naar secties van gegevens die continu gelezen dienen te worden en niet naar fysieke eigenschappen van de schijf. Om een CD op FreeBSD te produceren, dienen de gegevensbestanden waaruit de tracks op de CD gaan bestaan te worden voorbereid, waarna de tracks op de CD worden geschreven.</p></div><div class=paragraph><p>Het bestandssysteem ISO 9660 is ontworpen om met deze verschillen om te gaan. Helaas codeert het bestandssysteemgrenzen die destijds gebruikelijk waren. Gelukkig biedt het een uitbreidingsmechanisme dat correct geschreven CDâ€™s toestaat om deze grenzen te overschrijden en nog steeds te werken met systemen die deze uitbreidingen niet ondersteunen.</p></div><div class=paragraph><p>De port <a class=package href=https://cgit.freebsd.org/ports/tree/sysutils/cdrtools/>sysutils/cdrtools</a> bevat <a href="https://man.freebsd.org/cgi/man.cgi?query=mkisofs&amp;sektion=8&amp;format=html">mkisofs(8)</a>, een programma dat gebruikt kan worden om een gegevensbestand aan te maken dat een ISO 9660-bestandssysteem bevat. Het bevat opties die verschillende uitbreidingen ondersteunen en wordt hieronder beschreven.</p></div><div class=paragraph><p>Het gereedschap om de CD te branden hangt af van het feit of de CD-brander ATAPI of iets anders is. ATAPI CD-branders gebruiken het programma <code>burncd</code> dat deel uitmaakt van het basissysteem. SCSI en USB CD-branders dienen <code>cdrecord</code> van de port <a class=package href=https://cgit.freebsd.org/ports/tree/sysutils/cdrtools/>sysutils/cdrtools</a> te gebruiken. Het is ook mogelijk om <code>cdrecord</code> en andere gereedschappen voor SCSI-drives op ATAPI-hardware te gebruiken door middel van de <a href=#atapicam>module ATAPI/CAM</a>.</p></div><div class=paragraph><p>Indien CD-brandsoftware met een grafische gebruikersinterface gewenst is, is X-CD-Roast of K3b een mogelijkheid. Deze gereedschappen zijn beschikbaar als package of vanuit de ports <a class=package href=https://cgit.freebsd.org/ports/tree/sysutils/xcdroast/>sysutils/xcdroast</a> en <a class=package href=https://cgit.freebsd.org/ports/tree/sysutils/k3b/>sysutils/k3b</a>. X-CD-Roast en K3b hebben de <a href=#atapicam>module ATAPI/CAM</a> met ATAPI-hardware nodig.</p></div></div><div class=sect2><h3 id=mkisofs>19.6.2. mkisofs<a class=anchor href=#mkisofs></a></h3><div class=paragraph><p>Het programma <a href="https://man.freebsd.org/cgi/man.cgi?query=mkisofs&amp;sektion=8&amp;format=html">mkisofs(8)</a>, dat deel uitmaakt van de port <a class=package href=https://cgit.freebsd.org/ports/tree/sysutils/cdrtools/>sysutils/cdrtools</a>, maakt een ISO 9660-bestandssysteem aan dat een beeld is van een boomstructuur in de UNIXÂ® bestandssysteem-namespace. De eenvoudigste gebruiksvorm is:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># mkisofs -o beeldbestand.iso /pad/naar/boomstructuur</span></code></pre></div></div><div class=paragraph><p>Dit commando maakt een <em>beeldbestand.iso</em> aan dat een ISO 9660-bestandssysteem bevat dat een kopie is van de boomstructuur in <em>/pad/naar/boomstructuur</em>. Tijdens het proces beeldt het bestandsnamen af op namen die aan de beperkingen van het standaard ISO 9660-bestandssysteem voldoen en sluit het bestanden uit die namen hebben die niet karakteristiek zijn voor ISO-bestandssystemen.</p></div><div class=paragraph><p>Er is een aantal opties beschikbaar om over deze beperkingen heen te komen. In het bijzonder zet <code>-R</code> de Rock Ridge-uitbreidingen aan die gangbaar zijn voor UNIXÂ® systemen, zet <code>-J</code> de Rock Ridge-uitbreidingen aan die gebruikt worden op Microsoft-systemen en <code>-hfs</code> kan gebruikt worden om HFS-bestandssystemen aan te maken die door Mac OSÂ® gebruikt worden.</p></div><div class=paragraph><p>Voor CDâ€™s die alleen op FreeBSD-systemen gebruikt gaan worden, kan <code>-U</code> gebruikt worden om alle restricties op bestandsnamen uit te zetten. Indien het met <code>-R</code> gebruikt wordt, maakt het een bestandssysteembeeld aan dat identiek is aan de FreeBSD-boomstructuur van waaruit begonnen is, alhoewel het mogelijk is dat het zich op aantal manieren niet aan de ISO 9660-standaard houdt.</p></div><div class=paragraph><p>De laatste optie voor algemeen gebruik is <code>-b</code>. Deze wordt gebruikt om de plaats van het opstartbeeld aan te geven om een "El Torito" opstartbare CD te maken. Deze optie heeft een argument nodig, namelijk het pad naar een opstartbeeld dat het begin van de boomstructuur die naar de CD geschreven wordt voorstelt. Gewoonlijk maakt <a href="https://man.freebsd.org/cgi/man.cgi?query=mkisofs&amp;sektion=8&amp;format=html">mkisofs(8)</a> een ISO-beeld aan in de zogenaamde "diskette-emulatie"-modus en verwacht het dus dat het beeldbestand exact 1200, 1440 of 2880 KB groot is. Sommige bootloaders, zoals degene die door de distributieschijven van FreeBSD wordt gebruikt, gebruiken de emulatiemodus niet. In dat geval dient de optie <code>-no-emul-boot</code> gebruikt te worden. Dus indien <span class=filename>/tmp/myboot</span> een opstartbaar FreeBSD-systeem met het beeldbestand in <span class=filename>/tmp/myboot/boot/cdboot</span> bevat, kan het beeld van een ISO 9660-bestandssysteem als volgt in <span class=filename>/tmp/bootable.iso</span> aangemaakt worden:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># mkisofs -R -no-emul-boot -b boot/cdboot -o /tmp/bootable.iso /tmp/myboot</span></code></pre></div></div><div class=paragraph><p>Als dit gedaan is en <span class=filename>md</span> in de kernel is ingesteld, kan het bestandssysteem gekoppeld worden:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># mdconfig -a -t vnode -f /tmp/bootable.iso -u 0</span>
<span class=c># mount -t cd9660 /dev/md0 /mnt</span></code></pre></div></div><div class=paragraph><p>Nu kan gecontroleerd worden of <span class=filename>/mnt</span> en <span class=filename>/tmp/myboot</span> identiek zijn.</p></div><div class=paragraph><p>Er zijn vele andere opties die met <a href="https://man.freebsd.org/cgi/man.cgi?query=mkisofs&amp;sektion=8&amp;format=html">mkisofs(8)</a> gebruikt kunnen worden om het gedrag af te stemmen. In het bijzonder wijzigingen aan een ISO 9660-structuur en het aanmaken van Joliet- en HFS-schijven. Details staan in <a href="https://man.freebsd.org/cgi/man.cgi?query=mkisofs&amp;sektion=8&amp;format=html">mkisofs(8)</a>.</p></div></div><div class=sect2><h3 id=burncd>19.6.3. burncd<a class=anchor href=#burncd></a></h3><div class=paragraph><p>Indien er een ATAPI CD-brander aanwezig is, kan het commando <code>burncd</code> gebruikt worden om een ISO-beeld naar een CD te branden. <code>burncd</code> maakt deel uit van het basissysteem en is geÃ¯nstalleerd als <span class=filename>/usr/sbin/burncd</span>. Het gebruik is erg eenvoudig, aangezien het weinig opties heeft.</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># burncd -f cd-apparaat gegevens beeldbestand.iso fixate</span></code></pre></div></div><div class=paragraph><p>Het bovenstaande commando brandt een kopie van <em>beeldbestand.iso</em> naar <em>cd-apparaat</em>. Het standaardapparaat is <span class=filename>/dev/acd0</span>. Opties om de schrijfsnelheid in te stellen, de CD na het branden uit te werpen en geluidsgegevens te schrijven staan in <a href="https://man.freebsd.org/cgi/man.cgi?query=burncd&amp;sektion=8&amp;format=html">burncd(8)</a>.</p></div></div><div class=sect2><h3 id=cdrecord>19.6.4. cdrecord<a class=anchor href=#cdrecord></a></h3><div class=paragraph><p>Indien er geen ATAPI CD-brander aanwezig is, dient <code>cdrecord</code> gebruikt te worden om CDâ€™s te branden. <code>cdrecord</code> maakt geen deel uit van het basissysteem. Het dient Ã²fwel vanuit de port in <a class=package href=https://cgit.freebsd.org/ports/tree/sysutils/cdrtools/>sysutils/cdrtools</a> Ã²fwel als package geÃ¯nstalleerd te worden. Veranderingen in het basissysteem kunnen ervoor zorgen dat binaire versies van dit programma falen, wat mogelijk tot een "coaster" leidt. Daarom dient Ã²fwel de port bijgewerkt te worden als het systeem wordt bijgewerkt, Ã²wel, als <a href=../cutting-edge/#stable>-STABLE gevolgd</a> wordt, dient de port bijgewerkt te worden wanneer er een nieuwe versie beschikbaar komt.</p></div><div class=paragraph><p>Hoewel <code>cdrecord</code> vele opties heeft, is het gebruik voor gewone situaties nog eenvoudiger dan dat van <code>burncd</code>. Een ISO 9660-beeld kan gebrand worden met:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># cdrecord dev=device beeldbestand.iso</span></code></pre></div></div><div class=paragraph><p>Het lastige gedeelte in het gebruik van <code>cdrecord</code> is het vinden van de juiste <code>dev</code>. Om de juiste instelling te vinden, kan de vlag <code>-scanbus</code> van <code>cdrecord</code> gebruikt worden, wat resultaten zoals de onderstaande kan geven:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># cdrecord -scanbus</span>
Cdrecord-Clone  2.01 <span class=o>(</span>i386-unknown-freebsd7.0<span class=o>)</span> Copyright <span class=o>(</span>C<span class=o>)</span> 1995-2004 JÃ¶rg Schilling
Using libscg version <span class=s1>&#39;schily-0.1&#39;</span>
scsibus0:
        0,0,0     0<span class=o>)</span> <span class=s1>&#39;SEAGATE &#39;</span> <span class=s1>&#39;ST39236LW       &#39;</span> <span class=s1>&#39;0004&#39;</span> Disk
        0,1,0     1<span class=o>)</span> <span class=s1>&#39;SEAGATE &#39;</span> <span class=s1>&#39;ST39173W        &#39;</span> <span class=s1>&#39;5958&#39;</span> Disk
        0,2,0     2<span class=o>)</span> <span class=k>*</span>
        0,3,0     3<span class=o>)</span> <span class=s1>&#39;iomega  &#39;</span> <span class=s1>&#39;jaz 1GB         &#39;</span> <span class=s1>&#39;J.86&#39;</span> Removable Disk
        0,4,0     4<span class=o>)</span> <span class=s1>&#39;NEC     &#39;</span> <span class=s1>&#39;CD-ROM DRIVE:466&#39;</span> <span class=s1>&#39;1.26&#39;</span> Removable CD-ROM
        0,5,0     5<span class=o>)</span> <span class=k>*</span>
        0,6,0     6<span class=o>)</span> <span class=k>*</span>
        0,7,0     7<span class=o>)</span> <span class=k>*</span>
scsibus1:
        1,0,0   100<span class=o>)</span> <span class=k>*</span>
        1,1,0   101<span class=o>)</span> <span class=k>*</span>
        1,2,0   102<span class=o>)</span> <span class=k>*</span>
        1,3,0   103<span class=o>)</span> <span class=k>*</span>
        1,4,0   104<span class=o>)</span> <span class=k>*</span>
        1,5,0   105<span class=o>)</span> <span class=s1>&#39;YAMAHA  &#39;</span> <span class=s1>&#39;CRW4260         &#39;</span> <span class=s1>&#39;1.0q&#39;</span> Removable CD-ROM
        1,6,0   106<span class=o>)</span> <span class=s1>&#39;ARTEC   &#39;</span> <span class=s1>&#39;AM12S           &#39;</span> <span class=s1>&#39;1.06&#39;</span> Scanner
        1,7,0   107<span class=o>)</span> <span class=k>*</span></code></pre></div></div><div class=paragraph><p>Dit geeft de gepaste <code>dev</code>-waarden voor de apparaten in de lijst. De CD-brander dient gezocht te worden, waarna de drie getallen gescheiden door kommaâ€™s gebruikt kunnen worden als de waarde voor <code>dev</code>. In dit geval is het CD-RW-apparaat 1,5,0, dus is de juiste invoer <code>dev=1,5,0</code>. Er zijn eenvoudigere manieren om deze waarde te specificeren. In <a href="https://man.freebsd.org/cgi/man.cgi?query=cdrecord&amp;sektion=1&amp;format=html">cdrecord(1)</a> staan meer details. Hier staat ook informatie over geluidstracks, de snelheid instellen en meer.</p></div></div><div class=sect2><h3 id=duplicating-audiocds>19.6.5. Audio-CDâ€™s dupliceren<a class=anchor href=#duplicating-audiocds></a></h3><div class=paragraph><p>Een audio-CD kan gedupliceerd worden door de geluidsgegevens van de CD naar een serie bestanden te schrijven en deze bestanden daarna naar een lege CD te schrijven. Het proces verschilt licht tussen ATAPI- en SCSI-drives.</p></div><div class="exampleblock procedure"><div class=content><div class=paragraph><p><strong>Procedure: SCSI-drives</strong></p></div><div class="olist arabic"><ol class=arabic><li><p>Onttrek <code>cdda2wav</code> de audio:</p><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>% cdda2wav <span class=nt>-vall</span> <span class=nt>-D2</span>,0 <span class=nt>-B</span> <span class=nt>-Owav</span></code></pre></div></div></li><li><p>Schrijf met <code>cdrecord</code> de <span class=filename>.wav</span>-bestanden:</p><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>% cdrecord <span class=nt>-v</span> <span class=nv>dev</span><span class=o>=</span>2,0 <span class=nt>-dao</span> <span class=nt>-useinfo</span> <span class=k>*</span>.wav</code></pre></div></div><div class=paragraph><p>Controleer of <em>2,0</em> juist is opgegeven, zoals beschreven in <a href=#cdrecord>cdrecord</a>.</p></div></li></ol></div></div></div><div class="exampleblock procedure"><div class=content><div class=paragraph><p><strong>Procedure: ATAPI-drives</strong></p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Met behulp van de <a href=#atapicam>ATAPI/CAM module</a> kan <code>cdda2wav</code> ook gebruikt worden voor ATAPI-drives. Dit gereedschap is vaak een betere keuze voor de meeste gebruikers (jitter-correctie, endianness-zaken, etc.) dan de methode die hieronder wordt voorgesteld.</p></div></td></tr></tbody></table></div><div class="olist arabic"><ol class=arabic><li><p>Het ATAPI CD-stuurprogramma maakt elke track beschikbaar als <span class=filename>/dev/acddtnn</span>, waarin <em>d</em> het stationsnummer is en <em>nn</em> het tracknummer is in twee decimale cijfers, dat indien nodig vooraf wordt gegaan door een nul. Dus is de eerste track op de eerste schijf <span class=filename>/dev/acd0t01</span>, de tweede <span class=filename>/dev/acd0t02</span>, de derde <span class=filename>/dev/acd0t03</span>, enzovoort.</p><div class=paragraph><p>Controleer of de juiste bestanden in <span class=filename>/dev</span> bestaan. Als de benodigde namen er niet bijstaan, forceer het systeem dan om opnieuw te kijken:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># dd if=/dev/acd0 of=/dev/null count=1</span></code></pre></div></div></li><li><p>De track kan met <a href="https://man.freebsd.org/cgi/man.cgi?query=dd&amp;sektion=1&amp;format=html">dd(1)</a> onttrokken worden. Bij het onttrekken van de bestanden dient een specifieke blokgrootte gebruikt te worden.</p><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># dd if=/dev/acd0t01 of=track1.cdr bs=2352</span>
<span class=c>#dd if=/dev/acd0t02 of=track2.cdr bs=2352</span>
...</code></pre></div></div></li><li><p>Brand de onttrokken bestanden met <code>burncd</code>. Er dient opgegeven te worden dat het geluidsbestanden zijn en dat <code>burncd</code> de schijf moet fixeren wanneer na afronding van het proces.</p><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># burncd -f /dev/acd0 audio track1.cdr track2.cdr ... fixate</span></code></pre></div></div></li></ol></div></div></div></div><div class=sect2><h3 id=imaging-cd>19.6.6. Gegevens-CDâ€™s dupliceren<a class=anchor href=#imaging-cd></a></h3><div class=paragraph><p>Een gegevens-CD kan gekopieerd worden naar een beeldbestand dat functioneel gelijk is aan het beeldbestand dat met <a href="https://man.freebsd.org/cgi/man.cgi?query=mkisofs&amp;sektion=8&amp;format=html">mkisofs(8)</a> gemaakt is en het kan gebruikt worden om elke gegevens-CD te dupliceren. Het hier gegeven voorbeeld neemt aan dat het CD-ROM-apparaat <span class=filename>acd0</span> is.</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># dd if=/dev/acd0 of=bestand.iso bs=2048</span></code></pre></div></div><div class=paragraph><p>Nu het beeld beschikbaar is, kan het naar CD geschreven worden zoals hierboven beschreven.</p></div></div><div class=sect2><h3 id=mounting-cd>19.6.7. Gegevens-CDâ€™s gebruiken<a class=anchor href=#mounting-cd></a></h3><div class=paragraph><p>Nu er een standaard gegevens-CD-ROM is aangemaakt moet deze waarschijnlijk aangekoppeld worden om de gegevens die er op staan te lezen. Normaalgesproken neemt <a href="https://man.freebsd.org/cgi/man.cgi?query=mount&amp;sektion=8&amp;format=html">mount(8)</a> aan dat een bestandssysteem van het soort <code>ufs</code> is. Als zoiets als onderstaande geprobeerd wordt komt er een klacht over <code>Incorrect super block</code> en wordt er niet aangekoppeld:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># mount /dev/cd0 /mnt</span></code></pre></div></div><div class=paragraph><p>De CD-ROM bevat geen <code>UFS</code>-bestandssysteem, dus pogingen om zo aan te koppelen mislukken. Er dient aan <a href="https://man.freebsd.org/cgi/man.cgi?query=mount&amp;sektion=8&amp;format=html">mount(8)</a> verteld te worden dat het bestandssysteem van het soort <code>ISO9660</code> is en dan werkt alles. Dit kan door de optie <code>-t cd9660</code> van <a href="https://man.freebsd.org/cgi/man.cgi?query=mount&amp;sektion=8&amp;format=html">mount(8)</a> op te geven. Het CD-ROM-apparaat <span class=filename>/dev/cd0</span> onder <span class=filename>/mnt</span> aankoppelen kan zo:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># mount -t cd9660 /dev/cd0 /mnt</span></code></pre></div></div><div class=paragraph><p>De apparaatnaam (in dit voorbeeld <span class=filename>/dev/cd0</span>) kan afwijken, afhankelijk van de interface die de CD-ROM gebruikt. Verder voert de optie <code>-t cd9660</code> gewoon <a href="https://man.freebsd.org/cgi/man.cgi?query=mount_cd9660&amp;sektion=8&amp;format=html">mount_cd9660(8)</a> uit. Bovenstaand voorbeeld kan verkort worden tot:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># mount_cd9660 /dev/cd0 /mnt</span></code></pre></div></div><div class=paragraph><p>Het is in het algemeen mogelijk om gegevens-CD-ROMs van elke fabrikant op deze manier te gebruiken. Schijven met bepaalde uitbreidingen op ISO 9660 kunnen zich echter vreemd gedragen. Joliet-schijven bijvoorbeeld, slaan alle bestandsnamen op in twee-byte Unicode-karakters. De FreeBSD-kernel spreekt geen Unicode, maar het FreeBSD CD9660 stuurprogramma is in staat om Unicode karakters direct te converteren. Als er niet-Engelse karakters verschijnen als vraagtekens, moet de lokale karakterset gedefinieerd worden met de <code>-C</code> optie. Zie de <a href="https://man.freebsd.org/cgi/man.cgi?query=mount_cd9660&amp;sektion=8&amp;format=html">mount_cd9660(8)</a> handleiding voor meer informatie.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Om in staat te zijn om de karakter conversie te doen met behulp van de <code>-C</code> optie, heeft de kernel de <span class=filename>cd9660_iconv.ko</span> module nodig. Deze kan ingeladen worden door het volgende toe te voegen aan <span class=filename>/boot/loader.conf</span>:</p></div><div class="literalblock programlisting"><div class=content><pre>cd9660_iconv_load=&#34;YES&#34;</pre></div></div><div class=paragraph><p>en daarna de machine te herstarten of door de module direct in te laden met <a href="https://man.freebsd.org/cgi/man.cgi?query=kldload&amp;sektion=8&amp;format=html">kldload(8)</a>.</p></div></td></tr></tbody></table></div><div class=paragraph><p>Zo nu en dan kan <code>Device not configured</code> verschijnen als geprobeerd wordt om een CD-ROM aan te koppelen. Dit betekent meestal dat het CD-ROM-station denkt dat er geen schijf in de lade ligt of dat het station niet zichtbaar is op de bus. Omdat het enkele seconden kan duren voordat een CD-ROM-station doorheeft dat er een CD-ROM in ligt, is geduld geboden.</p></div><div class=paragraph><p>Soms wordt een SCSI CD-ROM gemist omdat het station niet genoeg tijd had om antwoord te geven op de busreset. Indien er een SCSI CD-ROM aanwezig is, dient de volgende optie aan de kernelinstellingen toegevoegd te worden en de <a href=../kernelconfig/#kernelconfig-building>kernel opnieuw gebouwd</a> te worden.</p></div><div class="literalblock programlisting"><div class=content><pre>options SCSI_DELAY=15000</pre></div></div><div class=paragraph><p>Dit zorgt ervoor dat de SCSI-bus 15 seconden pauzeert tijdens het opstarten opdat het CD-ROM-station elke gelegenheid krijgt om de busreset te beantwoorden.</p></div></div><div class=sect2><h3 id=rawdata-cd>19.6.8. Rauwe gegevens-CDâ€™s branden<a class=anchor href=#rawdata-cd></a></h3><div class=paragraph><p>Een bestand kan direct naar CD geschreven worden zonder een ISO 9660-bestandssysteem aan te maken. Sommige mensen doen dit voor back-updoeleinden. Dit gaat sneller dan een standaard-CD branden:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># burncd -f /dev/acd1 -s 12 gegevens archief.tar.gz fixate</span></code></pre></div></div><div class=paragraph><p>Om de gegevens terug te halen die op zoâ€™n CD gebrand zijn, is het noodzakelijk om gegevens van de rauwe apparaatnode te lezen:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># tar xzvf /dev/acd1</span></code></pre></div></div><div class=paragraph><p>Het is niet mogelijk om deze schijf aan te koppelen zoals dat voor een normale CD-ROM gedaan wordt. Zoâ€™n CD-ROM kan onder geen enkel besturingssysteem, behalve FreeBSD, gelezen worden. Om de CD aan te kunnen koppelen of gegevens te delen met een ander besturingssysteem, dient <a href="https://man.freebsd.org/cgi/man.cgi?query=mkisofs&amp;sektion=8&amp;format=html">mkisofs(8)</a> gebruikt te worden, zoals boven beschreven is.</p></div></div><div class=sect2><h3 id=atapicam>19.6.9. Het ATAPI/CAM-stuurprogramma gebruiken<a class=anchor href=#atapicam></a></h3><div class=paragraph><p>Dit stuurprogramma stelt ATAPI-apparaten (CD-ROM, CD-RW, DVD-stations, enzovoort) in staat om vanuit het SCSI-subsysteem benaderd te worden en maakt daarmee het gebruik van applicaties zoals <a class=package href=https://cgit.freebsd.org/ports/tree/sysutils/cdrdao/>sysutils/cdrdao</a> of <a href="https://man.freebsd.org/cgi/man.cgi?query=cdrecord&amp;sektion=1&amp;format=html">cdrecord(1)</a> mogelijk.</p></div><div class=paragraph><p>Om dit stuurprogramma te gebruiken, is het noodzakelijk om de volgende regel aan het <span class=filename>/boot/loader.conf</span> bestand toe te voegen:</p></div><div class="literalblock programlisting"><div class=content><pre>atapicam_load=&#34;YES&#34;</pre></div></div><div class=paragraph><p>om daarna de machine opnieuw op te starten.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Als het noodzakelijk is om <a href="https://man.freebsd.org/cgi/man.cgi?query=atapicam&amp;sektion=4&amp;format=html">atapicam(4)</a> statisch toe te voegen aan de kernel moet de volgende regel worden toegevoegd aan het kernelinstellingenbestand:</p></div><div class="literalblock programlisting"><div class=content><pre>device atapicam</pre></div></div><div class=paragraph><p>Ook zijn de volgende regels in het kernelinstellingenbestand nodig, die meestal wel aanwezig zijn:</p></div><div class="literalblock programlisting"><div class=content><pre>device ata
device scbus
device cd
device pass</pre></div></div><div class=paragraph><p>Hierna dient de nieuwe kernel opnieuw gebouwd en geÃ¯nstalleerd te worden en dient de machine opnieuw gestart te worden.</p></div></td></tr></tbody></table></div><div class=paragraph><p>Tijdens het opstartproces dient de brander als volgt te verschijnen:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>acd0: CD-RW &lt;MATSHITA CD-RW/DVD-ROM UJDA740&gt; at ata1-master PIO4
cd0 at ata1 bus 0 target 0 lun 0
cd0: &lt;MATSHITA CD-RW/DVD UJDA740 1.00&gt; Removable CD-ROM SCSI-0 device
cd0: 16.000MB/s transfers
cd0: Attempt to query device size failed: NOT READY, Medium not present - tray closed</code></pre></div></div><div class=paragraph><p>Het station is nu toegankelijk via de apparaatnaam <span class=filename>/dev/cd0</span>. Om bijvoorbeeld een CD-ROM op <span class=filename>/mnt</span> aan te koppelen:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># mount -t cd9660 /dev/cd0 /mnt</span></code></pre></div></div><div class=paragraph><p>Als <code>root</code> kan het volgende commando gegeven worden om het SCSI-adres van de brander te verkrijgen:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># camcontrol devlist</span>
&lt;MATSHITA CD-RW/DVD UJDA740 1.00&gt; at scbus1 target 0 lun 0 <span class=o>(</span>pass0,cd0<span class=o>)</span></code></pre></div></div><div class=paragraph><p>Dus <code>1,0,0</code> is het SCSI-adres dat met <a href="https://man.freebsd.org/cgi/man.cgi?query=cdrecord&amp;sektion=1&amp;format=html">cdrecord(1)</a> en andere SCSI-toepassingen gebruikt dient te worden.</p></div><div class=paragraph><p>Meer informatie over het ATAPI/CAM en het SCSI-systeem staat in de hulppaginaâ€™s van <a href="https://man.freebsd.org/cgi/man.cgi?query=atapicam&amp;sektion=4&amp;format=html">atapicam(4)</a> en <a href="https://man.freebsd.org/cgi/man.cgi?query=cam&amp;sektion=4&amp;format=html">cam(4)</a>.</p></div></div></div></div><div class=sect1><h2 id=creating-dvds>19.7. Optische media (DVDâ€™s) aanmaken en gebruiken<a class=anchor href=#creating-dvds></a></h2><div class=sectionbody><div class=sect2><h3 id=_inleiding_2>19.7.1. Inleiding<a class=anchor href=#_inleiding_2></a></h3><div class=paragraph><p>Vergeleken met de CD behoort de DVD de tot de volgende generatie van optische media-opslagtechnologie. De DVD kan meer gegevens bevatten dan enige CD en is tegenwoordig de standaard voor videopublicatie.</p></div><div class=paragraph><p>Er kunnen vijf fysieke opneembare formaten gedefinieerd worden die opneembare DVD heten:</p></div><div class=ulist><ul><li><p>DVD-R: dit was het eerst beschikbare opneembare DVD-formaat. De DVD-R-standaard is gedefinieerd door het <a href=http://www.dvdforum.com/forum.shtml>DVD Forum</a>. Dit formaat is voor eenmalig schrijven.</p></li><li><p>DVD-RW: dit is de herschrijfbare versie van de DVD-R-standaard. Een DVD-RW kan tot ongeveer 1.000 maal herschreven worden.</p></li><li><p>DVD-RAM: dit is ook een herschrijfbaar formaat dat door het DVD Forum ondersteund wordt. Een DVD-RAM kan gezien worden als een verwisselbare harde schijf. Dit medium is echter niet uitwisselbaar met de meeste DVD-ROM-stations en DVD-Video-spelers. Slechts enkele DVD-schrijvers ondersteunen het DVD-RAM-formaat. Lees <a href=#creating-dvd-ram>DVD-RAM gebruiken</a> voor meer informatie over het gebruik van DVD-RAM.</p></li><li><p>DVD+RW: dit is het herschrijfbare formaat dat is gedefinieerd door de <a href=http://www.dvdrw.com/>DVD+RW Alliance</a>. Een DVD+RW kan tot ongeveer 1.000 maal herschreven worden.</p></li><li><p>DVD+R: dit formaat is de eenmalig beschrijfbare versie van het DVD+RW-formaat.</p></li></ul></div><div class=paragraph><p>Een enkellaags opneembare DVD kan maximaal 4.700.000.000 bytes bevatten, wat eigenlijk 4,38 GB of 4.485 MB is (1 kB is 1024 bytes).</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Er dient onderscheid gemaakt te worden tussen het fysieke medium en de toepassing. Een DVD-Video bijvoorbeeld is een specifiek bestandsschema dat op elk fysiek opneembaar DVD-medium geschreven kan worden: DVD-R, DVD+R, DVD-RW, enzovoort. Voordat het mediumtype gekozen wordt, dient het zeker te zijn dat zowel de brander als de DVD-Video-speler (een onafhankelijke speler of een DVD-ROM-station in een computer) overweg kunnen met het overwogen medium.</p></div></td></tr></tbody></table></div></div><div class=sect2><h3 id=_instellingen>19.7.2. Instellingen<a class=anchor href=#_instellingen></a></h3><div class=paragraph><p>Het programma <a href="https://man.freebsd.org/cgi/man.cgi?query=growisofs&amp;sektion=1&amp;format=html">growisofs(1)</a> wordt gebruikt om DVDâ€™s op te nemen. Dit commando is deel van de dvd+rw-tools gereedschappen (<a class=package href=https://cgit.freebsd.org/ports/tree/sysutils/dvd+rw-tools/>sysutils/dvd+rw-tools</a>). dvd+rw-tools ondersteunt alle types DVD-media.</p></div><div class=paragraph><p>Deze gereedschappen gebruiken het SCSI-subsysteem om toegang tot de apparaten te krijgen, daarvoor moet <a href=#atapicam>ondersteuning voor ATAPI/CAM</a> aan de kernel toegevoegd worden. Indien de brander de USB-interface gebruikt, is deze toevoeging nutteloos en dient <a href=#usb-disks>USB-opslagapparaten</a> gelezen te worden voor meer details over het instellen van USB-apparaten.</p></div><div class=paragraph><p>De DMA-toegang voor ATAPI-apparaten dient ook aangezet te worden door de volgende regel aan het bestand <span class=filename>/boot/loader.conf</span> toe te voegen:</p></div><div class="literalblock programlisting"><div class=content><pre>hw.ata.atapi_dma=&#34;1&#34;</pre></div></div><div class=paragraph><p>Voordat de dvd+rw-tools gebruikt kunnen worden, dienen de <a href=http://fy.chalmers.se/~appro/linux/DVD+RW/hcn.html>dvd+rw-tools' hardware compatibility notes</a> geraadpleegd te worden voor enige informatie die betrekking heeft op de DVD-brander.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Indien een grafische gebruikersinterface gewenst is, is K3b (<a class=package href=https://cgit.freebsd.org/ports/tree/sysutils/k3b/>sysutils/k3b</a>), die een gebruikersvriendelijke interface biedt voor <a href="https://man.freebsd.org/cgi/man.cgi?query=growisofs&amp;sektion=1&amp;format=html">growisofs(1)</a> en vele andere brandprogrammaâ€™s, het bekijken waard.</p></div></td></tr></tbody></table></div></div><div class=sect2><h3 id=_gegevens_dvds_branden>19.7.3. Gegevens-DVDâ€™s branden<a class=anchor href=#_gegevens_dvds_branden></a></h3><div class=paragraph><p>Het commando <a href="https://man.freebsd.org/cgi/man.cgi?query=growisofs&amp;sektion=1&amp;format=html">growisofs(1)</a> is een frontend voor <a href=#mkisofs>mkisofs</a>. Het roept <a href="https://man.freebsd.org/cgi/man.cgi?query=mkisofs&amp;sektion=8&amp;format=html">mkisofs(8)</a> aan om het bestandssysteemoverzicht aan te maken en het schrijft naar de DVD. Hierdoor is het niet nodig om een beeld van de gegevens aan te maken voordat met branden begonnen wordt.</p></div><div class=paragraph><p>Om de gegevens uit de map <span class=filename>/pad/naar/gegevens</span> op een DVD+R of een DVD-R te branden:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># growisofs -dvd-compat -Z /dev/cd0 -J -R /pad/naar/gegevens</span></code></pre></div></div><div class=paragraph><p>De opties <code>-J -R</code> worden doorgegeven aan <a href="https://man.freebsd.org/cgi/man.cgi?query=mkisofs&amp;sektion=8&amp;format=html">mkisofs(8)</a> voor het aanmaken van het bestandssysteem (in dit geval een ISO 9660-bestandssysteem met Joliet en Rock Ridge uitbreidingen). Meer details staan in de hulppagina <a href="https://man.freebsd.org/cgi/man.cgi?query=mkisofs&amp;sektion=8&amp;format=html">mkisofs(8)</a>.</p></div><div class=paragraph><p>De optie <code>-Z</code> wordt gebruikt voor het opnemen van de eerste sessie, ook bij meerdere sessies. Het DVD-apparaat, <em>/dev/cd0</em>, dient aan de hand van de instellingen aangepast te worden. De parameter <code>-dvd-compat</code> sluit de schijf zodat er niets aan de opname toegevoegd kan worden. Dit zou als tegenprestatie betere uitwisselbaarheid met DVD-ROM-stations moeten geven.</p></div><div class=paragraph><p>Het is ook mogelijk om een vooraf gemastered beeld te branden, om bijvoorbeeld het beeld <em>beeldbestand.iso</em> te branden:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># growisofs -dvd-compat -Z /dev/cd0=beeldbestand.iso</span></code></pre></div></div><div class=paragraph><p>De schrijfsnelheid moet automatisch gedetecteerd en ingesteld worden, afhankelijk van het medium en het gebruikte station. Om de schrijfsnelheid te forceren, dient de parameter <code>-speed=</code> gebruikt te worden. Meer informatie staat in de hulppagina <a href="https://man.freebsd.org/cgi/man.cgi?query=growisofs&amp;sektion=1&amp;format=html">growisofs(1)</a>.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Om bestanden groter dan 4,38GB in de compilatie op te nemen dient een UDF/ISO-9660 hybride bestandssysteem aangemaakt te worden door de aanvullende parameter <code>-udf -iso-level 3</code> aan <a href="https://man.freebsd.org/cgi/man.cgi?query=mkisofs&amp;sektion=8&amp;format=html">mkisofs(8)</a> en alle gerelateerde programmaâ€™s (i.e., <a href="https://man.freebsd.org/cgi/man.cgi?query=growisofs&amp;sektion=1&amp;format=html">growisofs(1)</a>) door te geven. Dit is alleen nodig als een ISO beeldbestand wordt aangemaakt, of als bestanden direct naar een schijf worden geschreven. Schijven die op deze manier zijn aangemaakt moeten als een UDF-bestandssysteem worden aangekoppeld met het hulpmiddel <a href="https://man.freebsd.org/cgi/man.cgi?query=mount_udf&amp;sektion=8&amp;format=html">mount_udf(8)</a>, zodat het alleen bruikbaar is op een besturingssysteem dat zich van UDF bewust is, anders zal het lijken of er corrupte bestanden op staan.</p></div><div class=paragraph><p>Om zoâ€™n ISO-bestand aan te maken:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>% mkisofs <span class=nt>-R</span> <span class=nt>-J</span> <span class=nt>-udf</span> <span class=nt>-iso-level</span> 3 <span class=nt>-o</span> beeldbestand.iso /pad/naar/gegevens</code></pre></div></div><div class=paragraph><p>Om de bestanden direct naar een schijf te schrijven:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># growisofs -dvd-compat -udf -iso-level 3 -Z /dev/cd0 -J -R /pad/naar/gegevens</span></code></pre></div></div><div class=paragraph><p>Wanneer u een ISO-beeld heeft dat al grote bestanden bevat, zijn er geen extra opties nodig om met <a href="https://man.freebsd.org/cgi/man.cgi?query=growisofs&amp;sektion=1&amp;format=html">growisofs(1)</a> het beeld naar een schijf te schrijven.</p></div><div class=paragraph><p>Zorg er ook voor dat u een actuele versie van <a class=package href=https://cgit.freebsd.org/ports/tree/sysutils/cdrtools/>sysutils/cdrtools</a> heeft (welke <a href="https://man.freebsd.org/cgi/man.cgi?query=mkisofs&amp;sektion=8&amp;format=html">mkisofs(8)</a> bevat), aangezien oudere versies geen ondersteuning voor grote bestanden bieden. Als u problemen tegenkomt, gebruik dan de ontwikkelversie, <a class=package href=https://cgit.freebsd.org/ports/tree/sysutils/cdrtools-devel/>sysutils/cdrtools-devel</a> en lees de handleidingpagina <a href="https://man.freebsd.org/cgi/man.cgi?query=mkisofs&amp;sektion=8&amp;format=html">mkisofs(8)</a>.</p></div></td></tr></tbody></table></div></div><div class=sect2><h3 id=_dvd_video_branden>19.7.4. DVD-Video branden<a class=anchor href=#_dvd_video_branden></a></h3><div class=paragraph><p>Een DVD-Video is een specifiek bestandsschema dat gebaseerd is op de ISO 9660 en de micro-UDF (M-UDF) specificaties. DVD-Video heeft ook een specifieke hiÃ«rarchie voor de gegevensstructuur, de reden waarom een speciaal programma zoals <a class=package href=https://cgit.freebsd.org/ports/tree/multimedia/dvdauthor/>multimedia/dvdauthor</a> nodig is om de DVD te schrijven.</p></div><div class=paragraph><p>Indien er reeds een beeld van het bestandssysteem van de DVD-Video beschikbaar is, kan het zoals elk ander beeld gebrand worden. In de vorige sectie staat een voorbeeld. Als het resultaat voor de inhoud voor de DVD bijvoorbeeld in de map <span class=filename>/pad/naar/video</span> staat, kan de DVD-Video als volgt gebrand worden:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># growisofs -Z /dev/cd0 -dvd-video /pad/naar/video</span></code></pre></div></div><div class=paragraph><p>De optie <code>-dvd-video</code> wordt doorgegeven aan <a href="https://man.freebsd.org/cgi/man.cgi?query=mkisofs&amp;sektion=8&amp;format=html">mkisofs(8)</a> en geeft het opdracht om een bestandssysteemschema voor een DVD-Video aan te maken. Verder impliceert de optie <code>-dvd-video</code> de optie <code>-dvd-compat</code> van <a href="https://man.freebsd.org/cgi/man.cgi?query=growisofs&amp;sektion=1&amp;format=html">growisofs(1)</a>.</p></div></div><div class=sect2><h3 id=_dvdrw_gebruiken>19.7.5. DVD+RW gebruiken<a class=anchor href=#_dvdrw_gebruiken></a></h3><div class=paragraph><p>In tegenstelling tot een CD-RW dient een nieuwe DVD+RW voor het eerste gebruik geformatteerd te worden. Het programma <a href="https://man.freebsd.org/cgi/man.cgi?query=growisofs&amp;sektion=1&amp;format=html">growisofs(1)</a> regelt dit automatisch als nodig. Dit is de <em>aanbevolen</em> manier. Het is ook mogelijk om <code>dvd+rw-format</code> te gebruiken om een DVD+RW te formatteren:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># dvd+rw-format /dev/cd0</span></code></pre></div></div><div class=paragraph><p>Deze operatie hoeft slechts Ã©Ã©n maal uitgevoerd te worden. Onthoud dat alleen nieuwe DVD+RW-media geformatteerd dienen te worden. Daarna is het mogelijk om de DVD+RW op dezelfde manier te branden zoals in bovenstaande secties staat vermeldt.</p></div><div class=paragraph><p>Om nieuwe gegevens op een DVD+RW te branden (een geheel nieuw bestandssysteem branden, niet wat gegevens toevoegen), is het niet nodig om deze te wissen. Het is voldoende om de vorige opname te overschrijven (tijdens het aanmaken van een initiÃ«le sessie), zoals hieronder:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># growisofs -Z /dev/cd0 -J -R /pad/naar/nieuwe gegevens</span></code></pre></div></div><div class=paragraph><p>Het DVD+RW-formaat biedt de mogelijkheid om eenvoudig nieuwe gegevens aan een vorige opname toe te voegen. De operatie bestaat uit het samenvoegen van een nieuwe sessie en de bestaande. Het is geen multisessie-schrijven. <a href="https://man.freebsd.org/cgi/man.cgi?query=growisofs&amp;sektion=1&amp;format=html">growisofs(1)</a> laat het ISO 9660-bestandssysteem dat aanwezig is op het medium <em>groeien</em>.</p></div><div class=paragraph><p>Om gegevens aan de vorige DVD+RW toe te voegen:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># growisofs -M /dev/cd0 -J -R /pad/naar/volgende gegevens</span></code></pre></div></div><div class=paragraph><p>Dezelfde opties van <a href="https://man.freebsd.org/cgi/man.cgi?query=mkisofs&amp;sektion=8&amp;format=html">mkisofs(8)</a> die gebruikt werden om de initiÃ«le sessie te branden, dienen gebruikt te worden tijdens schrijfsessies.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>De optie <code>-dvd-compat</code> kan gebruikt worden als betere uitwisselbaarheid met DVD-ROM-stations gewenst is. In het geval van een DVD+RW verhindert dit het toevoegen van gegevens niet.</p></div></td></tr></tbody></table></div><div class=paragraph><p>Om het medium te wissen:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># growisofs -Z /dev/cd0=/dev/zero</span></code></pre></div></div></div><div class=sect2><h3 id=_dvd_rw_gebruiken>19.7.6. DVD-RW gebruiken<a class=anchor href=#_dvd_rw_gebruiken></a></h3><div class=paragraph><p>Een DVD-RW accepteert twee schijfformaten: de incrementele sequentiÃ«le en beperkt overschrijven. Standaard zijn DVD-RW-schijven in het sequentiÃ«le formaat.</p></div><div class=paragraph><p>Een nieuwe DVD-RW kan direct beschreven worden zonder deze te formatteren. Een gebruikte DVD-RW in sequentieel formaat dient echter gewist te worden voordat het mogelijk is om een nieuwe initiÃ«le sessie te schrijven.</p></div><div class=paragraph><p>Om een DVD-RW in sequentiÃ«le toestand te wissen, dient het volgende gedaan te worden:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># dvd+rw-format -blank=full /dev/cd0</span></code></pre></div></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Volledig wissen (<code>-blank=full</code>) neemt ongeveer Ã©Ã©n uur in beslag op een 1x-medium. Het is mogelijk om snel te wissen door gebruik te maken van de optie <code>blank</code> als de DVD-RW in Disk-At-Once-modus (DAO) wordt opgenomen. Om de DVD-RW in DAO-modus te branden:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># growisofs -use-the-force-luke=dao -Z /dev/cd0=beeldbestand.iso</span></code></pre></div></div><div class=paragraph><p>De optie <code>-use-the-force-luke=dao</code> is niet nodig aangezien <a href="https://man.freebsd.org/cgi/man.cgi?query=growisofs&amp;sektion=1&amp;format=html">growisofs(1)</a> probeert om minimale (snel gewiste) media te detecteren en gebruik te maken van DAO-schrijven.</p></div><div class=paragraph><p>Eigenlijk moet beperkt overschrijven gebruikt worden met elke DVD-RW. Dit formaat is flexibeler dan het standaard incrementeel sequentiÃ«le.</p></div></td></tr></tbody></table></div><div class=paragraph><p>Om gegevens op een sequentiÃ«le DVD-RW te schrijven, worden dezelfde instructies gebruikt als voor de andere DVD-formaten:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># growisofs -Z /dev/cd0 -J -R /pad/naar/gegevens</span></code></pre></div></div><div class=paragraph><p>Om wat gegevens aan de vorige opname toe te voegen, dient de optie <code>-M</code> van <a href="https://man.freebsd.org/cgi/man.cgi?query=growisofs&amp;sektion=1&amp;format=html">growisofs(1)</a> gebruikt te worden. Als echter gegevens aan een DVD-RW in incrementeel sequentiÃ«le modus worden toegevoegd, wordt een nieuwe sessie op de schijf aangemaakt wat resulteert in een multisessie schijf.</p></div><div class=paragraph><p>Een DVD-RW in het beperkt overschrijven formaat hoeft niet gewist te worden vÃ³Ã³r een nieuwe initiÃ«le sessie. Het is voldoende om de schijf te overschrijven met de optie <code>-Z</code>, wat analoog is aan het geval van de DVD+RW. Het is ook mogelijk om een bestaand ISO 9660-bestandssysteem te laten groeien op soortgelijke wijze als voor een DVD+RW met de optie <code>-M</code>. Het resultaat is een enkelsessie DVD.</p></div><div class=paragraph><p>Om een DVD-RW in het beperkt overschrijven-formaat te zetten:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># dvd+rw-format /dev/cd0</span></code></pre></div></div><div class=paragraph><p>Om terug te gaan naar het sequentiÃ«le formaat:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># dvd+rw-format -blank=full /dev/cd0</span></code></pre></div></div></div><div class=sect2><h3 id=_multisessie>19.7.7. Multisessie<a class=anchor href=#_multisessie></a></h3><div class=paragraph><p>Multisessie DVDâ€™s worden door zeer weinig DVD-ROM-stations geaccepteerd en meestal lezen ze hopelijk tenminste de eerste sessie. DVD+R, DVD-R en DVD-RW kunnen in het sequentiÃ«le formaat meerdere sessies accepteren. Het idee van meerdere sessies bestaat niet voor de formaten DVD+RW en DVD-RW in beperkt overschrijven.</p></div><div class=paragraph><p>Om een nieuwe sessie achter een initiÃ«le (niet-gesloten) sessie op een DVD+R, DVD-R of DVD-RW in sequentieel formaat toe te voegen:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># growisofs -M /dev/cd0 -J -R /pad/naar/volgende gegevens</span></code></pre></div></div><div class=paragraph><p>Het gebruik van dit commando met een DVD+RW of een DVD-RW in beperkt overschrijven-formaat voegt gegevens toe door de nieuwe sessie samen te voegen met de bestaande. Dit leidt tot een enkelsessie schijf. Deze manier kan gebruikt worden om gegevens achter een initiÃ«le sessie aan deze media toe te voegen.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Op deze media wordt wat ruimte gebruikt tussen elke sessie om het einde en begin van de sessies aan te geven. Daarom dienen sessies met grote hoeveelheden gegevens toegevoegd te worden om de mediaruimte te optimaliseren. Het aantal sessies is beperkt tot 154 voor een DVD+R, ongeveer 2000 voor een DVD-R en 127 voor een dubbellaags DVD+R.</p></div></td></tr></tbody></table></div></div><div class=sect2><h3 id=_meer_informatie>19.7.8. Meer informatie<a class=anchor href=#_meer_informatie></a></h3><div class=paragraph><p>Om meer informatie over een DVD te verkrijgen kan het commando <code>dvd+rw-mediainfo /dev/cd0</code> met de schijf in het station gebruikt worden.</p></div><div class=paragraph><p>Meer informatie over dvd+rw-tools staat in de hulppagina <a href="https://man.freebsd.org/cgi/man.cgi?query=growisofs&amp;sektion=1&amp;format=html">growisofs(1)</a>, op de <a href=http://fy.chalmers.se/~appro/linux/DVD+RW/>dvd+rw-tools website</a> en in de archieven van de <a href=http://lists.debian.org/cdwrite/>cdwrite mailing list</a>.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>De uitvoer van <code>dvd+rw-mediainfo</code> met betrekking tot de resulterende opname of het medium met problemen is verplicht voor elk probleemrapport. Zonder deze uitvoer volgt geen hulp.</p></div></td></tr></tbody></table></div></div><div class=sect2><h3 id=creating-dvd-ram>19.7.9. DVD-RAM gebruiken<a class=anchor href=#creating-dvd-ram></a></h3><div class=sect3><h4 id=_configuratie>19.7.9.1. Configuratie<a class=anchor href=#_configuratie></a></h4><div class=paragraph><p>DVD-RAM schrijvers komen met of een SCSI of een ATAPI interface. DMA toegang voor ATAPI apparaten moet worden ingeschakeld, wat gedaan kan worden door de volgende regel toe te voegen aan <span class=filename>/boot/loader.conf</span>:</p></div><div class="literalblock programlisting"><div class=content><pre>hw.ata.atapi_dma=&#34;1&#34;</pre></div></div></div><div class=sect3><h4 id=_voorbereiden_van_het_medium>19.7.9.2. Voorbereiden van het medium<a class=anchor href=#_voorbereiden_van_het_medium></a></h4><div class=paragraph><p>Zoals vermeld in de introductie van dit hoofdstuk kan DVD-RAM gezien worden als een verwijderbare harde schijf. Zoals elke andere harde schijf moet de DVD-RAM "voorbereid" worden voor het eerste gebruik. In het voorbeeld wordt alle beschikbare ruimte gebruikt voor een standaard UFS2 bestandssysteem:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># dd if=/dev/zero of=/dev/acd0 bs=2k count=1</span>
<span class=c># bsdlabel -Bw acd0</span>
<span class=c># newfs /dev/acd0</span></code></pre></div></div><div class=paragraph><p>Het DVD apparaat, <span class=filename>acd0</span> moet worden gewijzigd naar gelang de configuratie.</p></div></div><div class=sect3><h4 id=_het_medium_gebruiken>19.7.9.3. Het medium gebruiken<a class=anchor href=#_het_medium_gebruiken></a></h4><div class=paragraph><p>Zodra de voorgaande operaties uitgevoerd zijn op de DVD-RAM kan het gekoppeld worden net als een normale harde schijf:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># mount /dev/acd0 /mnt</span></code></pre></div></div><div class=paragraph><p>Hierna zal de DVD-RAM zowel lees- als beschrijfbaar zijn.</p></div></div></div></div></div><div class=sect1><h2 id=floppies>19.8. Diskettes aanmaken en gebruiken<a class=anchor href=#floppies></a></h2><div class=sectionbody><div class=paragraph><p>Soms is het opslaan van gegevens op een diskette nuttig, bijvoorbeeld als er geen andere verwijderbare opslagmedia beschikbaar zijn of als kleine hoeveelheden gegevens naar een andere computer moeten worden overgedragen.</p></div><div class=paragraph><p>In deze sectie wordt beschreven hoe diskettes in FreeBSD gebruikt dienen te worden. Hier worden hoofdzakelijk het formatteren en gebruik van 3,5 inch DOS-diskettes behandeld, maar de concepten zijn vergelijkbaar voor andere disketteformaten.</p></div><div class=sect2><h3 id=_diskettes_formatteren>19.8.1. Diskettes formatteren<a class=anchor href=#_diskettes_formatteren></a></h3><div class=sect3><h4 id=_het_apparaat>19.8.1.1. Het apparaat<a class=anchor href=#_het_apparaat></a></h4><div class=paragraph><p>Diskettes worden benaderd door ingangen in <span class=filename>/dev</span> net zoals andere apparaten. Om een rauwe floppy te benaderen gebruikt u <span class=filename>/dev/fdN</span>.</p></div></div><div class=sect3><h4 id=_formatteren>19.8.1.2. Formatteren<a class=anchor href=#_formatteren></a></h4><div class=paragraph><p>Een diskette dient op laag niveau geformatteerd te worden voordat deze kan worden gebruikt. Dit wordt meestal door de fabrikant gedaan, maar formatteren is een goede manier om de integriteit van het medium te controleren. Hoewel het mogelijk is om grotere (of kleinere) schijfgroottes te forceren, zijn de meeste diskettes ontworpen voor 1440kB.</p></div><div class=paragraph><p>Een diskette kan op laag niveau geformatteerd worden met <a href="https://man.freebsd.org/cgi/man.cgi?query=fdformat&amp;sektion=1&amp;format=html">fdformat(1)</a>. Dit gereedschap verwacht de apparaatnaam als parameter.</p></div><div class=paragraph><p>Op basis van eventuele foutmeldingen kan bepaald worden of een schijf goed of slecht is.</p></div><div class=sect4><h5 id=_formatteren_van_floppies>19.8.1.2.1. Formatteren van floppies<a class=anchor href=#_formatteren_van_floppies></a></h5><div class=paragraph><p>Voor het formatteren van de diskette dienen de apparaten <span class=filename>/dev/fdN</span> gebruikt te worden. Nadat een 3,5 inch diskette in het station is gestoken:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># /usr/sbin/fdformat -f 1440 /dev/fd0</span></code></pre></div></div></div></div></div><div class=sect2><h3 id=_schijflabels>19.8.2. Schijflabels<a class=anchor href=#_schijflabels></a></h3><div class=paragraph><p>Nadat de diskette op laag niveau is geformatteerd, dient er schijflabel aan gekoppeld te worden. Dit schijflabel wordt later vernietigd, maar het systeem heeft het nodig om later de grootte en de geometrie van de schijf te bepalen.</p></div><div class=paragraph><p>Het nieuwe schijflabel neemt de gehele schijf over en bevat alle benodigde informatie over de geometrie van de diskette. De geometriewaarden van het schijflabel staan vermeld in <span class=filename>/etc/disktab</span>.</p></div><div class=paragraph><p>Nu kan <a href="https://man.freebsd.org/cgi/man.cgi?query=bsdlabel&amp;sektion=8&amp;format=html">bsdlabel(8)</a> als volgt gedraaid worden:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># /sbin/bsdlabel -B -w /dev/fd0 fd1440</span></code></pre></div></div></div><div class=sect2><h3 id=_bestandssystemen>19.8.3. Bestandssystemen<a class=anchor href=#_bestandssystemen></a></h3><div class=paragraph><p>Nu is de diskette klaar om op hoog niveau geformatteerd te worden. Hiermee wordt een nieuw bestandssysteem opgezet, wat FreeBSD in staat stelt om naar de schijf te lezen en te schrijven. Nadat het nieuwe bestandssysteem is aangemaakt, wordt het schijflabel vernietigd, dus om de schijf te herformatteren is het noodzakelijk om het schijflabel opnieuw aan te maken.</p></div><div class=paragraph><p>Het bestandssysteem voor diskettes kan zowel UFS als FAT zijn. FAT is over het algemeen een betere keuze voor diskettes.</p></div><div class=paragraph><p>Om een nieuw bestandssysteem op de diskettes te zetten:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># /sbin/newfs_msdos /dev/fd0</span></code></pre></div></div><div class=paragraph><p>De schijf is nu klaar voor gebruik.</p></div></div><div class=sect2><h3 id=_diskettes_gebruiken>19.8.4. Diskettes gebruiken<a class=anchor href=#_diskettes_gebruiken></a></h3><div class=paragraph><p>Om de diskette te gebruiken kan <a href="https://man.freebsd.org/cgi/man.cgi?query=mount_msdosfs&amp;sektion=8&amp;format=html">mount_msdosfs(8)</a> gebruikt worden om het medium aan te koppelen. Ook kan <a class=package href=https://cgit.freebsd.org/ports/tree/emulators/mtools/>emulators/mtools</a> uit de Portscollectie worden gebruikt.</p></div></div></div></div><div class=sect1><h2 id=backups-tapebackups>19.9. Gegevensbanden aanmaken en gebruiken<a class=anchor href=#backups-tapebackups></a></h2><div class=sectionbody><div class=paragraph><p>Bandtechnologie is zich blijven ontwikkelen maar het is minder waarschijnlijk dat het in moderne systemen wordt gebruikt. Moderne back-upsystemen neigen om offsite gecombineerd met technologieÃ«n voor plaatselijke verwisselbare schijfstations te gebruiken. FreeBSD zal nog steeds elk bandstation dat SCSI gebruikt zoals LTO en oudere apparaten zoals DAT ondersteunen. Er is ook beperkte ondersteuning voor SATA- en USB-bandstations.</p></div><div class=sect2><h3 id=tapes-sa0>19.9.1. SeriÃ«le toegang met <a href="https://man.freebsd.org/cgi/man.cgi?query=sa&amp;sektion=4&amp;format=html">sa(4)</a><a class=anchor href=#tapes-sa0></a></h3><div class=paragraph><p>FreeBSD gebruikt het stuurprogramma <a href="https://man.freebsd.org/cgi/man.cgi?query=sa&amp;sektion=4&amp;format=html">sa(4)</a>, dat <span class=filename>/dev/sa0</span>, <span class=filename>/dev/nsa0</span> en <span class=filename>/dev/esa0</span> aanbiedt. Voor normaal gebruik is alleen <span class=filename>/dev/sa0</span> nodig. <span class=filename>/dev/nsa0</span> is fysiek hetzelfde apparaat als <span class=filename>/dev/sa0</span> maar spoelt de band niet terug nadat een bestand is geschreven. Dit maakt het mogelijk om meer dan Ã©Ã©n bestand naar een band te schrijven. <span class=filename>/dev/esa0</span> werpt, indien van toepassing, de band uit nadat het apparaat is gesloten.</p></div></div><div class=sect2><h3 id=_het_bandstation_met_mt1_beheren>19.9.2. Het bandstation met <a href="https://man.freebsd.org/cgi/man.cgi?query=mt&amp;sektion=1&amp;format=html">mt(1)</a> beheren<a class=anchor href=#_het_bandstation_met_mt1_beheren></a></h3><div class=paragraph><p><a href="https://man.freebsd.org/cgi/man.cgi?query=mt&amp;sektion=1&amp;format=html">mt(1)</a> is het hulpmiddel van FreeBSD om andere bewerkingen op het bandstation uit te voeren, zoals bestanden op een band doorzoeken of controlepunten naar de band schrijven.</p></div><div class=paragraph><p>Als voorbeeld kunnen de eerste drie bestanden op een band bewaard worden door ze over te slaan voordat een nieuw bestand wordt geschreven:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># mt -f /dev/nsa0 fsf 3</span></code></pre></div></div></div><div class=sect2><h3 id=_tar1_gebruiken_om_back_ups_op_banden_te_lezen_en_schrijven>19.9.3. <a href="https://man.freebsd.org/cgi/man.cgi?query=tar&amp;sektion=1&amp;format=html">tar(1)</a> gebruiken om back-ups op banden te lezen en schrijven<a class=anchor href=#_tar1_gebruiken_om_back_ups_op_banden_te_lezen_en_schrijven></a></h3><div class=paragraph><p><a href="https://man.freebsd.org/cgi/man.cgi?query=tar&amp;sektion=1&amp;format=html">tar(1)</a> gebruiken om een enkel bestand naar band te schrijven:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># tar cvf /dev/sa0 bestand</span></code></pre></div></div><div class=paragraph><p>Bestanden vanuit een <a href="https://man.freebsd.org/cgi/man.cgi?query=tar&amp;sektion=1&amp;format=html">tar(1)</a>-archief op band naar de huidige map herstellen:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># tar xvf /dev/sa0</span></code></pre></div></div></div><div class=sect2><h3 id=_dump8_en_restore8_gebruiken_om_back_ups_aan_te_maken_en_te_herstellen>19.9.4. <a href="https://man.freebsd.org/cgi/man.cgi?query=dump&amp;sektion=8&amp;format=html">dump(8)</a> en <a href="https://man.freebsd.org/cgi/man.cgi?query=restore&amp;sektion=8&amp;format=html">restore(8)</a> gebruiken om back-ups aan te maken en te herstellen<a class=anchor href=#_dump8_en_restore8_gebruiken_om_back_ups_aan_te_maken_en_te_herstellen></a></h3><div class=paragraph><p>Een eenvoudige back-up van <span class=filename>/usr</span> maken met <a href="https://man.freebsd.org/cgi/man.cgi?query=dump&amp;sektion=8&amp;format=html">dump(8)</a>:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># dump -0aL -b64 -f /dev/nsa0 /usr</span></code></pre></div></div><div class=paragraph><p>Interactief bestanden van een <a href="https://man.freebsd.org/cgi/man.cgi?query=dump&amp;sektion=8&amp;format=html">dump(8)</a>-bestand vanaf band naar de huidige map herstellen:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># restore -i -f /dev/nsa0</span></code></pre></div></div></div><div class=sect2><h3 id=_andere_bandsoftware>19.9.5. Andere bandsoftware<a class=anchor href=#_andere_bandsoftware></a></h3><div class=paragraph><p>Er zijn programmaâ€™s op hoger niveau beschikbaar om het back-uppen naar banden eenvoudiger te maken. De populairste zijn AMANDA en Bacula. Deze programmaâ€™s hebben als doel om back-uppen eenvoudiger en aangenamer te maken, of om complexe back-ups van meerdere machines te automatiseren. De Portscollectie bevat deze beide en andere toepassingen om met banden te werken.</p></div></div></div></div><div class=sect1><h2 id=backups-floppybackups>19.10. Naar diskettes back-uppen<a class=anchor href=#backups-floppybackups></a></h2><div class=sectionbody><div class=sect2><h3 id=floppies-using>19.10.1. Kunnen diskettes gebruikt worden om gegevens te back-uppen?<a class=anchor href=#floppies-using></a></h3><div class=paragraph><p>Diskettes zijn niet bepaald een geschikt medium om back-ups mee te maken, omdat:</p></div><div class=ulist><ul><li><p>Het medium onbetrouwbaar is, in het bijzonder op de langere termijn;</p></li><li><p>Het back-uppen en terugzetten erg traag is;</p></li><li><p>Diskettes een zeer beperkte capaciteit hebben. De tijden dat een hele harde schijf naar een tiental diskettes kon worden geback-upped zijn allang verstreken.</p></li></ul></div><div class=paragraph><p>Maar als er geen andere manier beschikbaar is om de gegevens te back-uppen, is een back-up naar diskettes beter dan helemaal geen back-up.</p></div><div class=paragraph><p>Gebruikte diskettes moet van goede kwaliteit zijn. Diskettes die al jaren op kantoor rondgeslingerd hebben, zijn een slechte keuze. In het ideale geval dienen nieuwe diskettes van een reputabele fabrikant gebruikt te worden.</p></div></div><div class=sect2><h3 id=floppies-creating>19.10.2. Hoe de gegevens naar diskettes back-uppen?<a class=anchor href=#floppies-creating></a></h3><div class=paragraph><p>Het beste kan naar diskettes worden geback-upped door gebruik te maken van <a href="https://man.freebsd.org/cgi/man.cgi?query=tar&amp;sektion=1&amp;format=html">tar(1)</a> met de optie <code>-M</code> (meerdere volumes), die back-ups over meerdere diskettes ondersteunt.</p></div><div class=paragraph><p>Om alle bestanden in de huidige map en de submappen te back-uppen (als <code>root</code>):</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># tar Mcvf /dev/fd0 *</span></code></pre></div></div><div class=paragraph><p>Als de eerste diskette vol is, vraagt <a href="https://man.freebsd.org/cgi/man.cgi?query=tar&amp;sektion=1&amp;format=html">tar(1)</a> om het volgende volume. Omdat <a href="https://man.freebsd.org/cgi/man.cgi?query=tar&amp;sektion=1&amp;format=html">tar(1)</a> media-onafhankelijk is, refereert het aan volumes, in deze context diskettes.</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>Prepare volume <span class=c>#2 for /dev/fd0 and hit return:</span></code></pre></div></div><div class=paragraph><p>Dit wordt herhaald (met oplopend volumenummer) totdat alle gespecificeerde bestanden zijn geback-upped.</p></div></div><div class=sect2><h3 id=floppies-compress>19.10.3. Kunnen back-ups gecomprimeerd worden?<a class=anchor href=#floppies-compress></a></h3><div class=paragraph><p>Helaas staat <a href="https://man.freebsd.org/cgi/man.cgi?query=tar&amp;sektion=1&amp;format=html">tar(1)</a> het gebruik van de optie <code>-z</code> niet toe voor archieven over meerdere volumes. Het is uiteraard mogelijk om alle bestanden met <a href="https://man.freebsd.org/cgi/man.cgi?query=gzip&amp;sektion=1&amp;format=html">gzip(1)</a> te comprimeren, ze met <a href="https://man.freebsd.org/cgi/man.cgi?query=tar&amp;sektion=1&amp;format=html">tar(1)</a> op diskettes te zetten en ze daarna met <a href="https://man.freebsd.org/cgi/man.cgi?query=gunzip&amp;sektion=1&amp;format=html">gunzip(1)</a> weer te decomprimeren!</p></div></div><div class=sect2><h3 id=floppies-restoring>19.10.4. Hoe worden de back-ups teruggezet?<a class=anchor href=#floppies-restoring></a></h3><div class=paragraph><p>Om een volledige archief terug te zetten:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># tar Mxvf /dev/fd0</span></code></pre></div></div><div class=paragraph><p>Er zijn twee manieren om alleen specifieke bestanden terug te zetten. Ten eerste kan met de eerste diskette begonnen worden:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># tar Mxvf /dev/fd0 bestandsnaam</span></code></pre></div></div><div class=paragraph><p>Het programma <a href="https://man.freebsd.org/cgi/man.cgi?query=tar&amp;sektion=1&amp;format=html">tar(1)</a> vraagt om de vervolgdiskettes totdat het benodigde bestand is gevonden.</p></div><div class=paragraph><p>Als alternatief kan, als bekend is op welke diskette het bestand staat, de betreffende diskette worden ingestoken en bovenstaand commando gebruikt worden. Als het eerste bestand op de diskette een vervolg is van de vorige diskette, waarschuwt <a href="https://man.freebsd.org/cgi/man.cgi?query=tar&amp;sektion=1&amp;format=html">tar(1)</a> dat het bestand niet teruggezet kan worden, zelfs als hier niet om gevraagd is!</p></div></div></div></div><div class=sect1><h2 id=backup-strategies>19.11. Back-up strategieÃ«n<a class=anchor href=#backup-strategies></a></h2><div class=sectionbody><div class=paragraph><p>Het eerste wat nodig is voor het ontwepken van een back-upplan, is er voor te zorgen dat de volgende mogelijke problemen worden ondervangen:</p></div><div class=ulist><ul><li><p>Schijffalen</p></li><li><p>Per ongeluk verwijderde bestanden</p></li><li><p>Willekeurige bestandscorruptie</p></li><li><p>Complete machinevernietiging (door bijvoorbeeld brand), inclusief de vernietiging van lokaal beschikbare back-ups.</p></li></ul></div><div class=paragraph><p>Het is goed mogelijk dat een aantal systemen het best geholpen zijn door voor al deze problemen een andere techniek te gebruiken. Behalve voor volledig persoonlijke systemen met niet echt belangrijke gegevens, is het zelfs onwaarschijnlijk dat Ã©Ã©n techniek alle mogelijke problemen kan afvangen.</p></div><div class=paragraph><p>Een aantal technieken in de gereedschapskist zijn:</p></div><div class=ulist><ul><li><p>Archiveren van een heel systeem op een back-up die niet lokaal wordt bewaard. Dit biedt bescherming tegen alle hierboven beschreven problemen, maar het is langzaam en onhandig om er een restore van te maken. Het is mogelijk om lokaal een kopie aan te houden en/of online, maar dan zijn er nog steeds onhandigheden, in het bijzonder voor restores voor gebruikers met beperkte rechten.</p></li><li><p>Snapshots van bestandssystemen. Dit werkt eigenlijk alleen in het geval bestanden per ongelijk verwijderd worden, maar het kan in dat geval <em>erg</em> handig zijn en het werkt snel en eenvoudig.</p></li><li><p>Een kopie maken van hele bestandssystemen en/of schijven (bijvoorbeeld een periodieke <a href="https://man.freebsd.org/cgi/man.cgi?query=rsync&amp;sektion=1&amp;format=html">rsync(1)</a> van een hele machine). Dit is in het algemeen het meest bruikbaar in netwerken met specifieke eisen. Voor algemene bescherming tegen het falen van een schijf, is het meestal minder geschikt dan RAID. Voor het herstellen van per ongeluk verwijderde bestanden is het vergelijkbaar aan UFS snapshots, maar dat hangt af van persoonlijke voorkeuren.</p></li><li><p>RAID. Minimaliseert of voorkomt downtijd als een schijf faalt. Dit ten koste van het vaker hebben van schijven die falen (omdat er meer van zijn), maar wel met een veel lagere urgentie.</p></li><li><p>Controleren van fingerprints van bestanden. Het hulpprogramma <a href="https://man.freebsd.org/cgi/man.cgi?query=mtree&amp;sektion=8&amp;format=html">mtree(8)</a> kan hier bij helpen. Hoewel dit geen back-uptechniek is, zorgt het er wel voor dat kan worden opgemerkt wanneer back-ups geraadpleegd moeten worden. Dit is in het bijzonder belangrijk voor offline back-ups en de fingerprints horen periodiek gecontroleerd te worden.</p></li></ul></div><div class=paragraph><p>Het is makkelijk om met nog meer technieken op de proppen te komen, waaronder veel variaties op de bovengenoemde. Bijzondere eisen leiden vaak tot bijzondere oplossingen. Het back-uppen van een draaiende database vereist bijvoorbeeld een methode die toegespitst is op de gebruikte database software als tussenstap. Het is van groot belang om te onderkennen tegen welke gevaren er bescherming dient te zijn en hoe daarmee om te gaan.</p></div></div></div><div class=sect1><h2 id=backup-basics>19.12. Back-upbeginselen<a class=anchor href=#backup-basics></a></h2><div class=sectionbody><div class=paragraph><p>De drie grote back-upprogrammaâ€™s zijn <a href="https://man.freebsd.org/cgi/man.cgi?query=dump&amp;sektion=8&amp;format=html">dump(8)</a>, <a href="https://man.freebsd.org/cgi/man.cgi?query=tar&amp;sektion=1&amp;format=html">tar(1)</a> en <a href="https://man.freebsd.org/cgi/man.cgi?query=cpio&amp;sektion=1&amp;format=html">cpio(1)</a>.</p></div><div class=sect2><h3 id=_dump_en_restore>19.12.1. Dump en Restore<a class=anchor href=#_dump_en_restore></a></h3><div class=paragraph><p>De traditionele back-upprogrammaâ€™s voor UNIXÂ® zijn <code>dump</code> en <code>restore</code>. Deze zien het station als een verzameling van schijfblokken, onder de abstracties van bestanden, koppelingen en mappen die door de bestandssystemen worden aangemaakt. In tegenstelling tot andere back-upprogrammaâ€™s, verzorgt <code>dump</code> een back-up van een compleet bestandssysteem op een apparaat. Het is niet in staat om slechts een gedeelte van een bestandssysteem of een mapstructuur die meer dan Ã©Ã©n bestandssysteem in beslag neemt te back-uppen. Het commando <code>dump</code> schrijft geen bestanden en mappen naar band, maar de rauwe gegevensblokken waaruit de bestanden en mappen bestaan. Wanneer het gebruikt wordt om gegevens te extraheren, slaat <code>restore</code> tijdelijke bestanden standaard op in <span class=filename>/tmp/</span> - als u werkt vanaf een herstelschijf met een kleine map <span class=filename>/tmp</span>, moet u wellicht de omgevingsvariabele <code>TMPDIR</code> op een map met meer vrije ruimte instellen zodat de restore kan slagen.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Indien <code>dump</code> op een hoofdmap wordt gebruikt, wordt er geen back-up gemaakt van <span class=filename>/home</span>, <span class=filename>/usr</span> of van de vele andere mappen, aangezien dit typisch koppelpunten voor andere bestandssystemen of symbolische koppelingen binnen deze bestandssystemen zijn.</p></div></td></tr></tbody></table></div><div class=paragraph><p><code>dump</code> bevat eigenaardigheden die uit de begintijd in Versie 6 van AT&amp;T UNIXÂ® (circa 1975) zijn overgebleven. De standaardparameters zijn geschikt voor banden met 9 sporen (6.250 bpi), niet voor de media met hoge dichtheid die vandaag beschikbaar zijn (tot 62.182 ftpi). Deze standaardwaarden dienen op de opdrachtregel overschreven te worden om de capaciteit van de huidige bandstations te benutten.</p></div><div class=paragraph><p>Het is ook mogelijk om gegevens met <code>rdump</code> en <code>rrestore</code> over een netwerk naar een bandstation dat aan een andere computer gekoppeld is te back-uppen. Beide programmaâ€™s maken gebruik van <a href="https://man.freebsd.org/cgi/man.cgi?query=rcmd&amp;sektion=3&amp;format=html">rcmd(3)</a> en <a href="https://man.freebsd.org/cgi/man.cgi?query=ruserok&amp;sektion=3&amp;format=html">ruserok(3)</a> om toegang tot het bandstation op afstand te krijgen. De gebruiker die de back-up uitvoert moet vermeld staat in het bestand <span class=filename>.rhosts</span> op de computer op afstand. De argumenten die aan <code>rdump</code> en <code>rrestore</code> gegeven worden dienen geschikt te zijn voor gebruik op de computer op afstand. Als <code>rdump</code> gebruikt wordt om een dump te maken van een FreeBSD computer naar een Exabyte-bandstation dat met een Sun-computer genaamd <code>komodo</code> verbonden is:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># /sbin/rdump 0dsbfu 54000 13000 126 komodo:/dev/nsa8 /dev/da0a 2&gt;&amp;1</span></code></pre></div></div><div class=paragraph><p>Let op: er kleven veiligheidsbezwaren aan het toestaan van authenticatie met <span class=filename>.rhosts</span>. De situatie dient goed geÃ«valueerd te worden.</p></div><div class=paragraph><p>Het is ook mogelijk om <code>dump</code> en <code>restore</code> op een veiligere manier via <code>ssh</code> te gebruiken.</p></div><div class=exampleblock><div class=title>Voorbeeld 1. Het gebruik van <code>dump</code> via ssh</div><div class=content><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># /sbin/dump -0uan -f - /usr | gzip -2 | ssh -c blowfish \</span>
	  doelgebruiker@doelmachine.example.com <span class=nb>dd </span><span class=nv>of</span><span class=o>=</span>/mijngrotebestanden/dump-usr-10.gz</code></pre></div></div></div></div><div class=paragraph><p>Ook kan de ingebouwde manier van <code>dump</code> gebruikt worden, door de omgevingsvariabele <code>RSH</code> in te stellen:</p></div><div class=exampleblock><div class=title>Voorbeeld 2. Het gebruik van <code>dump</code> via ssh met ingestelde <code>RSH</code></div><div class=content><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># env RSH=/usr/bin/ssh /sbin/dump -0uan -f doelgebruiker@doelmachine.example.com:/dev/sa0 /usr</span></code></pre></div></div></div></div></div><div class=sect2><h3 id=_tar>19.12.2. <code>tar</code><a class=anchor href=#_tar></a></h3><div class=paragraph><p><a href="https://man.freebsd.org/cgi/man.cgi?query=tar&amp;sektion=1&amp;format=html">tar(1)</a> stamt ook uit de tijd van Versie 6 van AT&amp;T UNIXÂ® (circa 1975). Het werkt samen met het bestandssysteem. <code>tar</code> schrijft bestanden en mappen naar band en ondersteunt niet het volledige scala aan opties dat beschikbaar is met <a href="https://man.freebsd.org/cgi/man.cgi?query=cpio&amp;sektion=1&amp;format=html">cpio(1)</a>, maar <code>tar</code> heeft niet de ongebruikelijke opdrachtpijplijn nodig die <code>cpio</code> gebruikt.</p></div><div class=paragraph><p>Om <code>tar</code> toe te passen op een Exabyte-bandstation die met een Sun genaamd <code>komodo</code> verbonden is:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># tar cf - . | rsh komodo dd of=tape-device obs=20b</span></code></pre></div></div><div class=paragraph><p>Indien de veiligheid van back-uppen over een netwerk een punt is, dient gebruik te worden gemaakt van het commando <code>ssh</code> en niet van <code>rsh</code>.</p></div></div><div class=sect2><h3 id=_cpio>19.12.3. <code>cpio</code><a class=anchor href=#_cpio></a></h3><div class=paragraph><p><a href="https://man.freebsd.org/cgi/man.cgi?query=cpio&amp;sektion=1&amp;format=html">cpio(1)</a> is het originele UNIXÂ® bandprogramma voor magnetische media om bestanden uit te wisselen. <code>cpio</code> heeft opties (naast vele anderen) om byte-swapping uit te voeren, een aantal verschillende archiefformaten te schrijven en de gegevens over een pijplijn naar andere programmaâ€™s te voeren. Deze laatste optie maakt <code>cpio</code> een uitstekende keuze voor installatiemedia. <code>cpio</code> weet niet hoe het door een mapstructuur moet lopen. Er dient een lijst met bestanden door <span class=filename>stdin</span> aangeleverd te worden.</p></div><div class=paragraph><p><code>cpio</code> biedt geen ondersteuning voor back-ups over het netwerk. Er kan gebruik worden gemaakt van een pijplijn en <code>rsh</code> om de gegevens naar een banddrive op afstand te sturen.</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># for f in maplijst;  do</span>
find <span class=nv>$f</span> <span class=o>&gt;&gt;</span> back-up.lijst
<span class=k>done</span>
<span class=c># cpio -v -o --format=newc &lt; back-up.lijst | ssh gebruiker@host &#34;cat &gt; back-upapparaat&#34;</span></code></pre></div></div><div class=paragraph><p>Hier is <em>maplijst</em> een lijst van de mappen waarvan een back-up gemaakt dient te worden, <em>gebruiker</em>@<em>host</em> de gebruiker/hostnaam-combinatie die de back-ups uitvoert, en <em>back-upapparaat</em> het apparaat waar de back-ups naar toe geschreven te worden (bijvoorbeeld <span class=filename>/dev/nsa0</span>).</p></div></div><div class=sect2><h3 id=_pax>19.12.4. <code>pax</code><a class=anchor href=#_pax></a></h3><div class=paragraph><p><a href="https://man.freebsd.org/cgi/man.cgi?query=pax&amp;sektion=1&amp;format=html">pax(1)</a> is het antwoord van IEEE en POSIXÂ® op <code>tar</code> en <code>cpio</code>. In de loop der jaren zijn de verscheidene versies van <code>tar</code> en <code>cpio</code> licht incompatibel geworden. Dus in plaats van dit uit te vechten en ze volledig te standaardiseren, heeft POSIXÂ® een nieuw archiveringsprogramma gemaakt. <code>pax</code> poogt om veel van de verscheidene formaten van <code>cpio</code> en <code>tar</code> te lezen en te schrijven, met daarbij nog nieuwe, eigen formaten. De commandoverzameling lijkt meer op die van <code>cpio</code> dan op die van <code>tar</code>.</p></div></div><div class=sect2><h3 id=backups-programs-amanda>19.12.5. Amanda<a class=anchor href=#backups-programs-amanda></a></h3><div class=paragraph><p>Amanda (Advanced Maryland Network Disk Archiver) is een client/server-back-upsysteem, in plaats van een enkel programma. Een Amanda server back-upt elk aantal computers dat een Amanda client en een netwerkverbinding met de Amanda server heeft naar een enkel bandstation. Een veelvoorkomend probleem bij bedrijven met een groot aantal schijven is dat de tijd die nodig is om de gegevens direct naar band te back-uppen langer is dan de tijd die voor de taak gereserveerd is. Amanda lost dit probleem op. Amanda kan gebruik maken van een "tussenschijf" om verschillende bestandssystemen tegelijkertijd te back-uppen. Amanda maakt "archiefverzamelingen" aan, een groep banden die gedurende een tijd gebruikt wordt om volledige back-ups te maken van alle bestandssystemen die in het instellingenbestand van Amanda vermeld staan. De "archiefverzameling" bevat ook incrementele (of differentiÃ«le) back-ups van alle bestandssystemen. Voor het herstellen van een beschadigd bestandssysteem zijn de meest recente volledige back-up en de incrementele back-ups nodig.</p></div><div class=paragraph><p>Het instellingenbestand biedt verfijnde controle over de back-ups en het netwerkverkeer door Amanda. Amanda kan elk bovenstaand back-upprogramma gebruiken om de gegevens naar de band te schijven. Amanda is Ã²f als port Ã²f als package beschikbaar.</p></div></div><div class=sect2><h3 id=_nietsdoen>19.12.6. Nietsdoen<a class=anchor href=#_nietsdoen></a></h3><div class=paragraph><p>"Nietsdoen" is geen computerprogramma, maar de de meest gebruikte back-upstrategie. Er zijn geen initiÃ«le kosten. Er is geen back-upschema om te volgen. Zeg gewoon nee. Als er iets met gegevens gebeurt, lach erom en leef ermee!</p></div><div class=paragraph><p>Als tijd en gegevens weinig tot niets waard zijn, is "Nietsdoen" het meest geschikte back-upprogramma. Maar wees bedacht, UNIXÂ® is een nuttig stuk gereedschap en er is zo maar binnen zes maanden een verzameling bestanden die wÃ¨l van waarde is.</p></div><div class=paragraph><p>"Nietsdoen" is de juiste back-upmethode voor <span class=filename>/usr/obj</span> en andere mapstructuren die zo opnieuw aangemaakt kunnen worden. Een voorbeeld zijn de bestanden waaruit de HTML- of PostScriptÂ® versie van dit Handboek bestaan. Deze documentformaten zijn vanuit XML-invoerbestanden aangemaakt. Het back-uppen van de HTML- of PostScriptÂ® bestanden is niet nodig. Van de XML-bestanden dient regelmatig een back-up gemaakt te worden.</p></div></div><div class=sect2><h3 id=_welk_back_upprogramma_is_het_beste>19.12.7. Welk back-upprogramma is het beste?<a class=anchor href=#_welk_back_upprogramma_is_het_beste></a></h3><div class=paragraph><p><a href="https://man.freebsd.org/cgi/man.cgi?query=dump&amp;sektion=8&amp;format=html">dump(8)</a>. <em>Punt uit.</em>. Elizabeth D. Zwicky heeft stresstesten op alle hierboven besproken back-upprogrammaâ€™s uitgevoerd. De heldere keuze voor het behouden van alle gegevens en alle eigenaardigheden van UNIXÂ® bestandssystemen is <code>dump</code>. Elizabeth heeft bestandssystemen aangemaakt met een grote verscheidenheid aan ongewone omstandigheden (en enkele minder ongebruikelijke) en heeft elk programma getest door een back-up van die bestandssystemen uit te voeren en ze te herstellen. De eigenaardigheden omvatten bestanden met gaten, bestanden met gaten en een blok nullen, bestanden met vreemde tekens in hun namen, onleesbare en onschrijfbare bestanden, apparaten, bestanden waarvan de grootte verandert tijdens het back-uppen, bestanden die aangemaakt/verwijderd worden tijdens het back-uppen en meer. Ze presenteerde de resultaten op LISA V in oktober 1991. Zie <a href=http://www.coredumps.de/doc/dump/zwicky/testdump.doc.html>torture-testing Backup and Archive Programs</a>.</p></div></div><div class=sect2><h3 id=_noodterugzetprocedure>19.12.8. Noodterugzetprocedure<a class=anchor href=#_noodterugzetprocedure></a></h3><div class=sect3><h4 id=_vÃ³Ã³r_de_ramp>19.12.8.1. VÃ³Ã³r de ramp<a class=anchor href=#_vÃ³Ã³r_de_ramp></a></h4><div class=paragraph><p>Er zijn slechts vier stappen om te volgen bij het voorbereiden op elke ramp die voor kan komen.</p></div><div class=paragraph><p>Het schijflabel van elke schijf dient afgedrukt te worden (bijvoorbeeld met <code>bsdlabel da0 | lpr</code>), de bestandssysteemtabel (<span class=filename>/etc/fstab</span>) en alle opstartboodschappen, alles in tweevoud.</p></div><div class=paragraph><p>Ten tweede dient een "livefs" CD-ROM gebrandt te worden. Deze CD-ROM biedt ondersteuning voor het opstarten in een FreeBSD "livefs" reddingsmodus die gebruiker in staat stelt om vele taken uit te voeren zoals het draaien van <a href="https://man.freebsd.org/cgi/man.cgi?query=dump&amp;sektion=8&amp;format=html">dump(8)</a>, <a href="https://man.freebsd.org/cgi/man.cgi?query=restore&amp;sektion=8&amp;format=html">restore(8)</a>, <a href="https://man.freebsd.org/cgi/man.cgi?query=fdisk&amp;sektion=8&amp;format=html">fdisk(8)</a>, <a href="https://man.freebsd.org/cgi/man.cgi?query=bsdlabel&amp;sektion=8&amp;format=html">bsdlabel(8)</a>, <a href="https://man.freebsd.org/cgi/man.cgi?query=newfs&amp;sektion=8&amp;format=html">newfs(8)</a> en meer. Een livefs CD-beeld voor FreeBSD/i386 11.2-RELEASE is beschikbaar op <a href=ftp://ftp.FreeBSD.org/pub/FreeBSD/releases/i386/ISO-IMAGES/11.2/FreeBSD-11.2-RELEASE-i386-livefs.iso>ftp://ftp.FreeBSD.org/pub/FreeBSD/releases/i386/ISO-IMAGES/11.2/FreeBSD-11.2-RELEASE-i386-livefs.iso</a>.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Livefs CD-beelden zijn niet beschikbaar voor FreeBSD 12.0-RELEASE en nieuwer. Naast de beelden voor CDROM-installaties kunnen ook beelden voor flash-drive-installaties gebruikt worden om een systeem te redden. Het "memstick"-beelden voor FreeBSD/i386 12.0-RELEASE is beschikbaar op <a href=ftp://ftp.FreeBSD.org/pub/FreeBSD/releases/i386/i386/ISO-IMAGES/12.0/FreeBSD-12.0-RELEASE-i386-memstick.img>ftp://ftp.FreeBSD.org/pub/FreeBSD/releases/i386/i386/ISO-IMAGES/12.0/FreeBSD-12.0-RELEASE-i386-memstick.img</a>.</p></div></td></tr></tbody></table></div><div class=paragraph><p>Ten derde dienen regelmatig back-upbanden aangemaakt te worden. Alle veranderingen die na de laatste back-up zijn gemaakt kunnen onherroepelijk verloren zijn gegaan. De back-upbanden dienen beveiligd te worden tegen overschrijven.</p></div><div class=paragraph><p>Ten vierde dienen de "livefs" CD-ROM die in stap twee gemaakt is en de back-upbanden getest te worden. Van de handelingen dienen aantekeningen gemaakt te worden. De aantekeningen, de CD-ROM, de afdrukken en de back-upbanden dienen gezamenlijk bewaard te worden. Tijdens het herstellen kunnen de notities ervoor zorgen dat de back-upbanden vernietigd worden. Hoe? In plaats van <code>tar xvf /dev/sa0</code> kan per ongeluk <code>tar cvf /dev/sa0</code> worden ingetypt, waardoor de back-upband overschreven wordt.</p></div><div class=paragraph><p>Als extra veiligheidsmaatregel dienen telkens een "livefs" CD-ROM en twee back-upbanden gemaakt te worden. EÃ©n van deze banden dient op een plaats op afstand bewaard te worden. Zoâ€™n plaats is NIET de kelder van het zelfde kantoorgebouw. Een aantal bedrijven in het World Trade Center heeft deze les op de harde manier geleerd. Zoâ€™n plaats dient fysiek gescheiden te zijn van de computers en de schijven door een significante afstand.</p></div></div><div class=sect3><h4 id=_na_de_ramp>19.12.8.2. Na de ramp<a class=anchor href=#_na_de_ramp></a></h4><div class=paragraph><p>De hamvraag is: heeft de hardware het overleefd? Er zijn regelmatig back-ups gemaakt, dus zorgen over de software zijn niet nodig.</p></div><div class=paragraph><p>Indien hardware beschadigd is, dienen kapotte onderdelen vervangen te worden voordat gepoogd wordt om een computer te gebruiken.</p></div><div class=paragraph><p>Plaats de "livefs" CD-ROM in de CD-ROM drive indien de hardware in orde is en start de computer op. Het originele installatiemenu wordt op het scherm getoond. Kies het land van toepassing en kies daarna <span class=guimenuitem>Fixitâ€‰â€”â€‰Repair mode with CDROM/DVD/floppy</span> en kies het item <span class=guimenuitem>CDROM/DVDâ€‰â€”â€‰Use the live filesystem CDROM/DVD</span>. <code>restore</code> en de andere benodigde programmaâ€™s staan in <span class=filename>/mnt2/rescue</span>.</p></div><div class=paragraph><p>Herstel elk bestandssysteem apart.</p></div><div class=paragraph><p>Probeer de rootpartitie van de eerste schijf aan te koppelen (bijvoorbeeld <code>mount /dev/da0a /mnt</code>). Als het schijflabel beschadigd is, gebruik dan <code>bsdlabel</code> om de schijf opnieuw te partitioneren en te labelen zodat deze overeenkomt met het afgedrukte en bewaarde label. Gebruik voor het opnieuw aanmaken van de bestandssystemen <code>newfs</code>. Koppel de rootpartitie van de schijf opnieuw aan voor lezen en schrijven (<code>mount -u -o rw /mnt</code>). Gebruik voor het herstellen van de gegevens van dit bestandssysteem het back-upprogramma en de back-upbanden (bijvoorbeeld <code>restore vrf /dev/sa0</code>). Koppel nu het bestandssysteem af (bijvoorbeeld <code>umount /mnt</code>). Herhaal dit voor elk beschadigd bestandssysteem.</p></div><div class=paragraph><p>Back-up de gegevens naar nieuwe banden als het systeem weer draait. De omstandigheden die verantwoordelijk waren voor de crash of het gegevensverlies kunnen weer voorkomen. Nu een extra uur investeren, kan later grote zorgen besparen.</p></div></div></div></div></div><div class=sect1><h2 id=disks-virtual>19.13. Netwerk-, geheugen-, en bestandsgebaseerde bestandssystemen<a class=anchor href=#disks-virtual></a></h2><div class=sectionbody><div class=paragraph><p>Naast de schijven die fysiek in de computer zitten, diskettes, CDâ€™s, harde schijven, enzovoort, worden er ook andere vormen van schijven door FreeBSD begrepen: de <em>virtuele schijven</em>.</p></div><div class=paragraph><p>Dit omvat netwerkbestandssystemen zoals het <a href=../network-servers/#network-nfs>Network File System</a> en Coda, geheugengebaseerde bestandssystemen en bestandsgebaseerde bestandssystemen.</p></div><div class=paragraph><p>Nagelang de gebruikte versie van FreeBSD, zijn er andere gereedschappen voor het aanmaken en gebruiken van bestandsgebaseerde en geheugengebaseerde bestandssystemen.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Gebruik <a href="https://man.freebsd.org/cgi/man.cgi?query=devfs&amp;sektion=8&amp;format=html">devfs(8)</a> om de apparaatnodes transparant voor de gebruiker toe te wijzen.</p></div></td></tr></tbody></table></div><div class=sect2><h3 id=disks-mdconfig>19.13.1. Bestandsgebaseerd bestandssysteem<a class=anchor href=#disks-mdconfig></a></h3><div class=paragraph><p>Met <a href="https://man.freebsd.org/cgi/man.cgi?query=mdconfig&amp;sektion=8&amp;format=html">mdconfig(8)</a> kunnen geheugenschijven, <a href="https://man.freebsd.org/cgi/man.cgi?query=md&amp;sektion=4&amp;format=html">md(4)</a>, ingesteld worden en aangezet worden. Om <a href="https://man.freebsd.org/cgi/man.cgi?query=mdconfig&amp;sektion=8&amp;format=html">mdconfig(8)</a> te gebruiken, moet de module <a href="https://man.freebsd.org/cgi/man.cgi?query=md&amp;sektion=4&amp;format=html">md(4)</a> geladen worden of ondersteuning aan het kernelinstellingenbestand toegevoegd worden:</p></div><div class="literalblock programlisting"><div class=content><pre>device md</pre></div></div><div class=paragraph><p>Het commando <a href="https://man.freebsd.org/cgi/man.cgi?query=mdconfig&amp;sektion=8&amp;format=html">mdconfig(8)</a> ondersteunt drie types geheugen-gebaseerde virtuele schijven: geheugenschijven die met <a href="https://man.freebsd.org/cgi/man.cgi?query=malloc&amp;sektion=9&amp;format=html">malloc(9)</a> toegewezen zijn, geheugenschijven die een bestand als basis gebruiken en geheugenschijven die swapruimte als basis gebruiken. Een mogelijk gebruik is het aankoppelen van een beeld van een diskette of CD dat in een bestand bewaard wordt.</p></div><div class=paragraph><p>Om een bestaand beeld van een bestandssysteem aan te koppelen:</p></div><div class=exampleblock><div class=title>Voorbeeld 3. <code>mdconfig</code> gebruiken om een bestaand beeld van een bestandssysteem aan te koppelen</div><div class=content><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># mdconfig -a -t vnode -f schijfbeeld -u 0</span>
<span class=c># mount /dev/md0 /mnt</span></code></pre></div></div></div></div><div class=paragraph><p>Om een nieuw beeld van een bestandssysteem aan te maken met <a href="https://man.freebsd.org/cgi/man.cgi?query=mdconfig&amp;sektion=8&amp;format=html">mdconfig(8)</a>:</p></div><div class=exampleblock><div class=title>Voorbeeld 4. Nieuwe bestandsgebaseerde schijf aanmaken met <code>mdconfig</code></div><div class=content><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># dd if=/dev/zero of=nieuwbeeld bs=1k count=5k</span>
5120+0 records <span class=k>in
</span>5120+0 records out
<span class=c># mdconfig -a -t vnode -f nieuwbeeld -u 0</span>
<span class=c># bsdlabel -w md0 auto</span>
<span class=c># newfs md0a</span>
/dev/md0a: 5.0MB <span class=o>(</span>10240 sectors<span class=o>)</span> block size 16384, fragment size 2048
	using 4 cylinder <span class=nb>groups </span>of 1.25MB, 80 blks, 192 inodes.
super-block backups <span class=o>(</span><span class=k>for </span>fsck <span class=nt>-b</span> <span class=c>#) at:</span>
 160, 2720, 5280, 7840
<span class=c># mount /dev/md0a /mnt</span>
<span class=c># df /mnt</span>
Filesystem 1K-blocks Used Avail Capacity  Mounted on
/dev/md0a       4710    4  4330     0%    /mnt</code></pre></div></div></div></div><div class=paragraph><p>Indien het eenheidsnummer niet met de optie <code>-u</code> gespecificeerd wordt, gebruikt <a href="https://man.freebsd.org/cgi/man.cgi?query=mdconfig&amp;sektion=8&amp;format=html">mdconfig(8)</a> de automatische toewijzing van <a href="https://man.freebsd.org/cgi/man.cgi?query=md&amp;sektion=4&amp;format=html">md(4)</a> om een ongebruikt apparaat te selecteren. De naam van het toegewezen apparaat wordt op stdout weergegeven als <span class=filename>md4</span>. Meer details staan in de hulppagina van <a href="https://man.freebsd.org/cgi/man.cgi?query=mdconfig&amp;sektion=8&amp;format=html">mdconfig(8)</a>.</p></div><div class=paragraph><p>Het commando <a href="https://man.freebsd.org/cgi/man.cgi?query=mdconfig&amp;sektion=8&amp;format=html">mdconfig(8)</a> is erg nuttig, hoewel het veel opdrachten vergt om een bestandsgebaseerd bestandssysteem aan te maken. FreeBSD wordt met <a href="https://man.freebsd.org/cgi/man.cgi?query=mdmfs&amp;sektion=8&amp;format=html">mdmfs(8)</a> geleverd. Dit programma stelt een <a href="https://man.freebsd.org/cgi/man.cgi?query=md&amp;sektion=4&amp;format=html">md(4)</a>-schijf in door gebruik te maken van <a href="https://man.freebsd.org/cgi/man.cgi?query=mdconfig&amp;sektion=8&amp;format=html">mdconfig(8)</a>, zet er een bestandssysteem op door gebruik te maken van <a href="https://man.freebsd.org/cgi/man.cgi?query=newfs&amp;sektion=8&amp;format=html">newfs(8)</a> en koppel het aan door gebruik te maken van <a href="https://man.freebsd.org/cgi/man.cgi?query=mount&amp;sektion=8&amp;format=html">mount(8)</a>. Om hetzelfde bestandssysteembeeld als hierboven aan te maken en aan te koppelen:</p></div><div class=exampleblock><div class=title>Voorbeeld 5. Instellen en aankoppelen van een bestandsgebaseerde schijf met <code>mdmfs</code></div><div class=content><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># dd if=/dev/zero of=nieuwbeeld bs=1k count=5k</span>
5120+0 records <span class=k>in
</span>5120+0 records out
<span class=c># mdmfs -F nieuwbeeld -s 5m md0 /mnt</span>
<span class=c># df /mnt</span>
Filesystem 1K-blocks Used Avail Capacity  Mounted on
/dev/md0        4718    4  4338     0%    /mnt</code></pre></div></div></div></div><div class=paragraph><p>Als de optie <code>md</code> zonder eenheidsnummer gebruikt wordt, gebruikt <a href="https://man.freebsd.org/cgi/man.cgi?query=mdmfs&amp;sektion=8&amp;format=html">mdmfs(8)</a> de automatische toewijzing van <a href="https://man.freebsd.org/cgi/man.cgi?query=md&amp;sektion=4&amp;format=html">md(4)</a> om automatisch een ongebruikt apparaat te selecteren. Meer details staan in de hulppagina van <a href="https://man.freebsd.org/cgi/man.cgi?query=mdmfs&amp;sektion=8&amp;format=html">mdmfs(8)</a>.</p></div></div><div class=sect2><h3 id=disks-md-freebsd5>19.13.2. Geheugengebaseerd bestandssysteem<a class=anchor href=#disks-md-freebsd5></a></h3><div class=paragraph><p>Voor een geheugen gebaseerd bestands systeem moet normaal gesproken "wisselbestand geheugen" gebruikt worden. Gebruik maken van wisselbestand geheugen wil niet perse zeggen dat de geheugen schijf direct in het wisselbestand gezet wordt, maar dat het bestand naar het wisselbestand geschreven kan worden indien nodig. Het is ook mogelijk om <a href="https://man.freebsd.org/cgi/man.cgi?query=malloc&amp;sektion=9&amp;format=html">malloc(9)</a> gebaseerde geheugen schijven te maken, maar door hiervan gebruik te maken kan het gebeuren dat het systeem crashed als de kernel uit het geheugen loopt.</p></div><div class=exampleblock><div class=title>Voorbeeld 6. Nieuwe geheugengebaseerde schijf aanmaken met <code>mdconfig</code></div><div class=content><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># mdconfig -a -t swap -s 5m -u 1</span>
<span class=c># newfs -U md1</span>
/dev/md1: 5.0MB <span class=o>(</span>10240 sectors<span class=o>)</span> block size 16384, fragment size 2048
	using 4 cylinder <span class=nb>groups </span>of 1.27MB, 81 blks, 192 inodes.
	with soft updates
super-block backups <span class=o>(</span><span class=k>for </span>fsck <span class=nt>-b</span> <span class=c>#) at:</span>
 160, 2752, 5344, 7936
<span class=c># mount /dev/md1 /mnt</span>
<span class=c># df /mnt</span>
Filesystem 1K-blocks Used Avail Capacity  Mounted on
/dev/md1        4718    4  4338     0%    /mnt</code></pre></div></div></div></div><div class=exampleblock><div class=title>Voorbeeld 7. Nieuwe geheugengebaseerde schijf aanmaken met <code>mdmfs</code></div><div class=content><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># mdmfs -s 5m md2 /mnt</span>
<span class=c># df /mnt</span>
Filesystem 1K-blocks Used Avail Capacity  Mounted on
/dev/md2        4846    2  4458     0%    /mnt</code></pre></div></div></div></div></div><div class=sect2><h3 id=_geheugenschijf_van_het_systeem_afkoppelen>19.13.3. Geheugenschijf van het systeem afkoppelen<a class=anchor href=#_geheugenschijf_van_het_systeem_afkoppelen></a></h3><div class=paragraph><p>Als een geheugen- of bestandsgebaseerd bestandssysteem niet gebruikt wordt, dienen alle bronnen aan het systeem vrijgegeven te worden. Koppel als eerste het bestandssysteem af, gebruikt daarna <a href="https://man.freebsd.org/cgi/man.cgi?query=mdconfig&amp;sektion=8&amp;format=html">mdconfig(8)</a> om de schijf van een systeem los te koppelen en de bronnen vrij te geven.</p></div><div class=paragraph><p>Om bijvoorbeeld alle bronnen die door <span class=filename>/dev/md4</span> gebruikt worden los te koppelen en vrij te geven:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># mdconfig -d -u 4</span></code></pre></div></div><div class=paragraph><p>Het is mogelijk om de informatie over ingestelde <a href="https://man.freebsd.org/cgi/man.cgi?query=md&amp;sektion=4&amp;format=html">md(4)</a> apparaten weer te geven door gebruik te maken van <code>mdconfig -l</code>.</p></div></div></div></div><div class=sect1><h2 id=snapshots>19.14. Snapshots van bestandssystemen<a class=anchor href=#snapshots></a></h2><div class=sectionbody><div class=paragraph><p>FreeBSD biedt een mogelijkheid om samen met <a href=../cutting-edge/#soft-updates>Soft Updates</a>: snapshots van bestandssystemen.</p></div><div class=paragraph><p>Snapshots bieden de mogelijkheid om beelden van een gespecificeerd bestandssysteem te maken en ze als bestand te behandelen. Snapshotbestanden moeten aangemaakt worden in het bestandssysteem waarop de handeling wordt uitgevoerd en er mogen niet meer dan 20 snapshots per bestandssysteem worden aangemaakt. Actieve snapshots worden opgeslagen in het superblok zodat ze persistent zijn met afkoppel- en heraankoppelbewerkingen en met het opnieuw opstarten van het systeem. Als een snapshot niet langer nodig is, kan het met het standaardcommando <a href="https://man.freebsd.org/cgi/man.cgi?query=rm&amp;sektion=1&amp;format=html">rm(1)</a> worden verwijderd. Snapshots kunnen in elke volgorde verwijderd worden, alhoewel misschien niet alle gebruikte ruimte teruggewonnen wordt omdat sommige vrijgegeven blokken mogelijk door een ander snapshot geclaimd worden.</p></div><div class=paragraph><p>De onveranderlijke bestandsvlag <code>snapshot</code> wordt door <a href="https://man.freebsd.org/cgi/man.cgi?query=mksnap_ffs&amp;sektion=8&amp;format=html">mksnap_ffs(8)</a> ingesteld nadat het snapshotbestand initieel is aangemaakt. Het commando <a href="https://man.freebsd.org/cgi/man.cgi?query=unlink&amp;sektion=1&amp;format=html">unlink(1)</a> maakt een uitzondering voor snapshotbestanden aangezien het toestaat dat ze verwijderd worden.</p></div><div class=paragraph><p>Snapshotbestanden worden aangemaakt met <a href="https://man.freebsd.org/cgi/man.cgi?query=mount&amp;sektion=8&amp;format=html">mount(8)</a>. Om een snapshot van <span class=filename>/var</span> in het bestand <span class=filename>/var/snapshot/snap</span> te plaatsen:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># mount -o -o snapshot /var/snapshot/snap /var</span></code></pre></div></div><div class=paragraph><p>Als alternatief kan <a href="https://man.freebsd.org/cgi/man.cgi?query=mksnap_ffs&amp;sektion=8&amp;format=html">mksnap_ffs(8)</a> gebruikt worden om een snapshot aan te maken:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># mksnap_ffs /var /var/snapshot/snap</span></code></pre></div></div><div class=paragraph><p>Snapshotbestanden kunnen gezocht worden op een bestandssysteem (bijvoorbeeld <span class=filename>/var</span>) door gebruik te maken van het commando <a href="https://man.freebsd.org/cgi/man.cgi?query=find&amp;sektion=1&amp;format=html">find(1)</a>:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># find /var -flags snapshot</span></code></pre></div></div><div class=paragraph><p>Nadat een snapshot is aangemaakt, kan het voor een aantal dingen gebruikt worden:</p></div><div class=ulist><ul><li><p>Sommige systeembeheerders gebruiken een snapshotbestand voor back-updoeleinden, omdat het snapshot naar CDâ€™s of band overgezet kan worden;</p></li><li><p>De bestandssysteem integriteit controle, <a href="https://man.freebsd.org/cgi/man.cgi?query=fsck&amp;sektion=8&amp;format=html">fsck(8)</a> kan gebruikt worden op het snapshot. Ervan uitgaande dat het bestandssysteem schoon was toen het werd aangekoppeld, zou dit altijd een schoon (en onveranderlijk) resultaat moeten opleveren. Dit is in principe wat het <a href="https://man.freebsd.org/cgi/man.cgi?query=fsck&amp;sektion=8&amp;format=html">fsck(8)</a>-achtergrondsproces doet;</p></li><li><p>Het commando <a href="https://man.freebsd.org/cgi/man.cgi?query=dump&amp;sektion=8&amp;format=html">dump(8)</a> draaien op het snapshot. Er wordt een dump teruggegeven die consistent is met het bestandssysteem en tijdsstempel van het snapshot. <a href="https://man.freebsd.org/cgi/man.cgi?query=dump&amp;sektion=8&amp;format=html">dump(8)</a> kan ook in Ã©Ã©n commando een snapshot maken, een dumpbeeld aanmaken en daarna het snapshot verwijderen door gebruik te maken van de vlag <code>-L</code>;</p></li><li><p>Het snapshot kan met <a href="https://man.freebsd.org/cgi/man.cgi?query=mount&amp;sektion=8&amp;format=html">mount(8)</a> als bevroren beeld van het bestandssysteem worden aangekoppeld. Om het snapshot <span class=filename>/var/snapshot/snap</span> aan te koppelen:</p><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># mdconfig -a -t vnode -f /var/snapshot/snap -u 4</span>
<span class=c># mount -r /dev/md4 /mnt</span></code></pre></div></div></li></ul></div><div class=paragraph><p>Het is nu mogelijk om door de structuur van het bevroren bestandssysteem <span class=filename>/var</span> te lopen dat aangekoppeld is op <span class=filename>/mnt</span>. Alles zal initieel in dezelfde toestand verkeren als op het moment dat het snapshot werd aangemaakt. De enige uitzondering hierop is dat eerdere snapshots als bestanden met lengte nul verschijnen. Als een snapshot niet meer nodig is, kan het als volgt afgekoppeld worden:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># umount /mnt</span>
<span class=c># mdconfig -d -u 4</span></code></pre></div></div><div class=paragraph><p>Meer informatie over <code>softupdates</code> en snapshots van bestandssystemen, inclusief technische documenten, staat op de website van Marshall Kirk McKusick op <a href=http://www.mckusick.com/>http://www.mckusick.com/</a>.</p></div></div></div><div class=sect1><h2 id=quotas>19.15. Bestandssysteemquota<a class=anchor href=#quotas></a></h2><div class=sectionbody><div class=paragraph><p>Quota zijn een optionele mogelijkheid van het besturingssysteem om de hoeveelheid schijfruimte en/of het aantal bestanden dat gebruikers of leden van een groep per bestandssysteem mogen gebruiken te beperken. Dit wordt het meeste gebruikt op timesharing-systemen waar het wenselijk is om het aantal bronnen dat elke gebruiker of groep van gebruikers mag gebruiken te beperken. Dit voorkomt dat Ã©Ã©n gebruiker of groep van gebruikers alle beschikbare schijfruimte in beslag neemt.</p></div><div class=sect2><h3 id=_schijfquota_inschakelen>19.15.1. Schijfquota inschakelen<a class=anchor href=#_schijfquota_inschakelen></a></h3><div class=paragraph><p>Controleer alvorens te proberen om schijfquota te gebruiken of quota ingesteld zijn in de kernel. Dit gebeurt door het toevoegen van de volgende regel aan het kernelinstellingenbestand:</p></div><div class="literalblock programlisting"><div class=content><pre>options QUOTA</pre></div></div><div class=paragraph><p>De standaardkernel <span class=filename>GENERIC</span> heeft deze optie niet aanstaan, dus is het nodig om een eigen kernel in te stellen, te bouwen en te installeren om gebruik te kunnen maken van schijfquota. Meer informatie over het instellen van de kernel staat in <a href=../kernelconfig/#kernelconfig>De FreeBSD-kernel instellen</a>.</p></div><div class=paragraph><p>Vervolgens dienen schijfquota aangezet te worden in <span class=filename>/etc/rc.conf</span>. Op FreeBSD 7.X en eerder wordt deze regel toegevoegd:</p></div><div class="literalblock programlisting"><div class=content><pre>enable_quotas=&#34;YES&#34;</pre></div></div><div class=paragraph><p>Voeg op FreeBSD 8.0-RELEASE en nieuwer in plaats daarvan deze regel toe:</p></div><div class="literalblock programlisting"><div class=content><pre>quota_enable=&#34;YES&#34;</pre></div></div><div class=paragraph><p>Voor fijnere controle over de opstartquota zijn extra instellingsvariabelen beschikbaar. Normaalgesproken wordt de integriteit van de quota van elk bestandssysteem tijdens het opstarten door <a href="https://man.freebsd.org/cgi/man.cgi?query=quotacheck&amp;sektion=8&amp;format=html">quotacheck(8)</a> gecontroleerd. <a href="https://man.freebsd.org/cgi/man.cgi?query=quotacheck&amp;sektion=8&amp;format=html">quotacheck(8)</a> verzekert dat de gegevens in de quotadatabase een juiste afspiegeling vormen van de gegevens op het bestandssysteem. Dit proces neemt erg veel tijd in beslag en beÃ¯nvloedt de tijd die een systeem nodig heeft om op te starten significant. Om deze stap over te slaan, bestaat een variabele in <span class=filename>/etc/rc.conf</span>:</p></div><div class="literalblock programlisting"><div class=content><pre>check_quotas=&#34;NO&#34;</pre></div></div><div class=paragraph><p>Als laatste dient <span class=filename>/etc/fstab</span> bewerkt te worden om schijfquota per bestandssysteem aan te zetten. Hier kunnen gebruiker- of groepquota of beide worden aangezet voor alle bestandssystemen.</p></div><div class=paragraph><p>Om quota per gebruiker op een bestandssysteem aan te zetten, dient de optie <code>userquota</code> aan het optieveld toegevoegd te worden aan de regel in <span class=filename>/etc/fstab</span> voor het bestandssysteem waar quota worden aangezet. Bijvoorbeeld:</p></div><div class="literalblock programlisting"><div class=content><pre>/dev/da1s2g   /home    ufs rw,userquota 1 2</pre></div></div><div class=paragraph><p>Analoog, om groepquota aan te zetten, dient de optie <code>groupquota</code> in plaats van <code>userquota</code> gebruikt te worden. Om zowel gebruikers- als groepsquota aan te zetten, dient de regel als volgt veranderd te worden:</p></div><div class="literalblock programlisting"><div class=content><pre>/dev/da1s2g   /home    ufs rw,userquota,groupquota 1 2</pre></div></div><div class=paragraph><p>Standaard worden de quotabestanden opgeslagen in de hoofdmap van het bestandssysteem onder de namen <span class=filename>quota.user</span> en <span class=filename>quota.group</span> voor respectievelijk gebruikers- en groepsquota. Meer informatie staat in <a href="https://man.freebsd.org/cgi/man.cgi?query=fstab&amp;sektion=5&amp;format=html">fstab(5)</a>. Alhoewel de hulppagina <a href="https://man.freebsd.org/cgi/man.cgi?query=fstab&amp;sektion=5&amp;format=html">fstab(5)</a> vermeld dat een alternatieve plaats voor de quotabestanden gespecificeerd kan worden, wordt dit niet aangeraden omdat de verschillende quotagereedschappen dit niet juist schijnen af te handelen.</p></div><div class=paragraph><p>Hier aangekomen dient het systeem opnieuw opgestart te worden met de nieuwe kernel. <span class=filename>/etc/rc</span> voert automatisch de juiste commandoâ€™s uit om de initiÃ«le quotabestanden aan te maken voor alle quota die in <span class=filename>/etc/fstab</span> zijn aangezet. Het is dus niet nodig om handmatig quotabestanden met lengte nul aan te maken.</p></div><div class=paragraph><p>Tijdens normale bewerkingen moet het niet nodig zijn om de commandoâ€™s <a href="https://man.freebsd.org/cgi/man.cgi?query=quotacheck&amp;sektion=8&amp;format=html">quotacheck(8)</a>, <a href="https://man.freebsd.org/cgi/man.cgi?query=quotaon&amp;sektion=8&amp;format=html">quotaon(8)</a> of <a href="https://man.freebsd.org/cgi/man.cgi?query=quotaoff&amp;sektion=8&amp;format=html">quotaoff(8)</a> handmatig te draaien. Lees wel de betreffende hulppaginaâ€™s om bekend te raken met de werking ervan.</p></div></div><div class=sect2><h3 id=_quotalimieten_instellen>19.15.2. Quotalimieten instellen<a class=anchor href=#_quotalimieten_instellen></a></h3><div class=paragraph><p>Indien het systeem ingesteld voor gebruik van quota, controleer dan of ze echt aanstaan. Een eenvoudige manier om dit te doen is de volgende:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># quota -v</span></code></pre></div></div><div class=paragraph><p>Er hoort een eenregelige samenvatting te verschijnen over het schijfgebruik en de huidige quotalimieten voor elk bestandssysteem waarop quota aanstaan.</p></div><div class=paragraph><p>Nu kunnen quotalimieten toegewezen worden met <a href="https://man.freebsd.org/cgi/man.cgi?query=edquota&amp;sektion=8&amp;format=html">edquota(8)</a>.</p></div><div class=paragraph><p>Er zijn verschillende opties om grenzen te stellen aan de hoeveelheid schijfruimte die een gebruiker of groep mag toewijzen en het aantal bestanden dat ze mogen aanmaken. Toewijzingen kunnen begrensd worden met betrekking tot schijfruimte (blokquota) of het aantal bestanden (inode-quota) of een combinatie van beide. Elk van deze limieten is op zijn beurt weer opgesplitst in twee categoriÃ«n: harde en zachte limieten.</p></div><div class=paragraph><p>Een harde limiet mag niet overschreden worden. Indien een gebruiker de harde limiet bereikt, mag deze geen verdere toewijzingen maken op het betreffende bestandssysteem. Indien een gebruiker bijvoorbeeld een harde limiet heeft van 500 kB op een bestandssysteem en er 490 kB van gebruikt, kan deze nog slechts 10 kB toewijzen. Een poging om 11 kB toe te wijzen zal mislukken.</p></div><div class=paragraph><p>Zachte limieten kunnen voor een beperkte tijd overschreden worden. Deze periode staat bekend als de gratieperiode, die standaard een week bedraagt. Als een gebruiker de zachte limiet langer dan de gratieperiode overschrijdt, verandert de zachte limiet in een harde limiet en zijn er geen verdere toewijzingen toegestaan. Als de gebruiker onder de zachte limiet komt, wordt de gratieperiode opnieuw ingesteld.</p></div><div class=paragraph><p>Het volgende is een voorbeeld van een mogelijk gebruik van <a href="https://man.freebsd.org/cgi/man.cgi?query=edquota&amp;sektion=8&amp;format=html">edquota(8)</a>. Als het commando <a href="https://man.freebsd.org/cgi/man.cgi?query=edquota&amp;sektion=8&amp;format=html">edquota(8)</a> gestart wordt, wordt de tekstverwerker opgestart die door de omgevingsvariabele <code>EDITOR</code> gespecificeerd is, of de tekstverwerker vi als de variabele <code>EDITOR</code> niet is ingesteld. Nu kunnen de quotalimieten bewerkt worden.</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># edquota -u test</span></code></pre></div></div><div class="literalblock programlisting"><div class=content><pre>Quotas for user test:
/usr: kbytes in use: 65, limits (soft = 50, hard = 75)
        inodes in use: 7, limits (soft = 50, hard = 60)
/usr/var: kbytes in use: 0, limits (soft = 50, hard = 75)
        inodes in use: 0, limits (soft = 50, hard = 60)</pre></div></div><div class=paragraph><p>Normaalgesproken worden er twee regels weergegeven voor elk bestandssysteem waarvoor quota gelden: Ã©Ã©n regel voor de bloklimieten, en Ã©Ã©n voor de inode-limieten. Om de quotalimieten te veranderen dient de waarde ervan veranderd te worden. Om bijvoorbeeld de bloklimiet van een gebruiker te veranderen van een zachte limiet van 50 en een harde limiet van 75 in een zachte limiet van 500 en een harde limiet van 600, dient het volgende veranderd te worden:</p></div><div class="literalblock programlisting"><div class=content><pre>/usr: kbytes in use: 65, limits (soft = 50, hard = 75)</pre></div></div><div class=paragraph><p>In:</p></div><div class="literalblock programlisting"><div class=content><pre>/usr: kbytes in use: 65, limits (soft = 500, hard = 600)</pre></div></div><div class=paragraph><p>De nieuwe quotalimieten gelden zodra de tekstverwerker verlaten wordt.</p></div><div class=paragraph><p>Soms is het gewenst om quotalimieten in te stellen op een aantal UIDâ€™s. Dit kan gedaan worden door de optie <code>-p</code> van <a href="https://man.freebsd.org/cgi/man.cgi?query=edquota&amp;sektion=8&amp;format=html">edquota(8)</a> te gebruiken. Wijs eerst de gewenste quotalimiet aan een gebruiker toe en draai daarna <code>edquota -p protogebruiker beginuid-einduid</code>. Indien bijvoorbeeld gebruiker <code>test</code> de gewenste quotalimieten heeft, kan het volgende commando gebruikt worden om deze quotalimieten te dupliceren voor UIDâ€™s 10.000 tot en met 19.999:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># edquota -p test 10000-19999</span></code></pre></div></div><div class=paragraph><p>Meer informatie staat in de hulppagina voor <a href="https://man.freebsd.org/cgi/man.cgi?query=edquota&amp;sektion=8&amp;format=html">edquota(8)</a>.</p></div></div><div class=sect2><h3 id=_quotalimieten_en_schijfgebruik_controleren>19.15.3. Quotalimieten en schijfgebruik controleren<a class=anchor href=#_quotalimieten_en_schijfgebruik_controleren></a></h3><div class=paragraph><p>Zowel <a href="https://man.freebsd.org/cgi/man.cgi?query=quota&amp;sektion=1&amp;format=html">quota(1)</a> als <a href="https://man.freebsd.org/cgi/man.cgi?query=repquota&amp;sektion=8&amp;format=html">repquota(8)</a> kunnen gebruikt worden om de quotalimieten en het schijfgebruik te controleren. Het commando <a href="https://man.freebsd.org/cgi/man.cgi?query=quota&amp;sektion=1&amp;format=html">quota(1)</a> kan gebruikt worden om de quota van zowel individuele gebruikers als groepen en het schijfgebruik te controleren. Een gebruiker mag alleen de eigen quota en de quota van een groep waarvan deze lid is controleren. Alleen de beheerder mag alle gebruikers- en groepsquota bekijken. Het commando <a href="https://man.freebsd.org/cgi/man.cgi?query=repquota&amp;sektion=8&amp;format=html">repquota(8)</a> kan gebruikt worden om een overzicht te krijgen van alle quota en gebruik van bestandssystemen waarvan quota aanstaan.</p></div><div class=paragraph><p>Het volgende is een mogelijke uitvoer van het commando <code>quota -v</code> voor een gebruiker die quotalimieten heeft op twee bestandssystemen.</p></div><div class="literalblock programlisting"><div class=content><pre>Disk quotas for user test (uid 1002):
     Filesystem  usage    quota   limit   grace   files   quota   limit   grace
           /usr      65*     50      75   5days       7      50      60
       /usr/var       0      50      75               0      50      60</pre></div></div><div class=paragraph><p>Voor het bestandssysteem <span class=filename>/usr</span> in bovenstaand voorbeeld overschrijdt deze gebruiker de zachte limiet van 50 kB momenteel met 15 kB en heeft deze 5 dagen van de gratieperiode over. De asterisk, <code>*</code> geeft aan dat de gebruiker momenteel de quotalimiet overschrijdt.</p></div><div class=paragraph><p>Normaalgesproken worden bestandssystemen waarvan de gebruiker geen schijfruimte gebruikt niet weergegeven in de uitvoer van <a href="https://man.freebsd.org/cgi/man.cgi?query=quota&amp;sektion=1&amp;format=html">quota(1)</a>, zelfs niet als er de gebruiker een quotalimiet heeft voor dat bestandssysteem. De optie <code>-v</code> geeft deze bestandssystemen weer, zoals het bestandssysteem <span class=filename>/usr/var</span> in bovenstaand voorbeeld.</p></div></div><div class=sect2><h3 id=_quota_over_nfs>19.15.4. Quota over NFS<a class=anchor href=#_quota_over_nfs></a></h3><div class=paragraph><p>Quota worden afgedwongen door het quota-subsysteem op de NFS-server. De daemon <a href="https://man.freebsd.org/cgi/man.cgi?query=rpc.rquotad&amp;sektion=8&amp;format=html">rpc.rquotad(8)</a> stelt quota-informatie beschikbaar aan het commando <a href="https://man.freebsd.org/cgi/man.cgi?query=quota&amp;sektion=1&amp;format=html">quota(1)</a> op de NFS-cliÃ«nts, wat de gebruikers op deze machines in staat stelt hun quota-statistieken in te zien.</p></div><div class=paragraph><p><code>rpc.rquotad</code> dient als volgt in <span class=filename>/etc/inetd.conf</span> aangezet te worden:</p></div><div class="literalblock programlisting"><div class=content><pre>rquotad/1      dgram rpc/udp wait root /usr/libexec/rpc.rquotad rpc.rquotad</pre></div></div><div class=paragraph><p>Vervolgens dient <code>inetd</code> opnieuw gestart te worden:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># service inetd restart</span></code></pre></div></div></div></div></div><div class=sect1><h2 id=disks-encrypting>19.16. Schijfpartities versleutelen<a class=anchor href=#disks-encrypting></a></h2><div class=sectionbody><div class=paragraph><p>FreeBSD biedt uitstekende on-line bescherming tegen onbevoegde gegevenstoegang. Bestandsrechten en Mandatory Access Control (MAC) (zie <a href=../mac/#mac>Verplichte Toegangscontrole (MAC)</a>) helpen voorkomen dat onbevoegde derde partijen toegang tot de gegevens krijgen als het besturingssysteem actief is en de computer aanstaat. De door het besturingssysteem afgedwongen rechten zijn echter niet relevant als een aanvaller fysieke toegang tot een computer heeft en deze de harde schijf van de computer in een ander systeem kan plaatsen om de gevoelige gegevens te kopiÃ«ren en te analyseren.</p></div><div class=paragraph><p>Afgezien van hoe een aanvaller in het bezit van een harde schijf of een uitgezette computer gekomen is, kan GEOM Based Disk Encryption (gbde) de gegevens op het bestandssysteem van de computer zelfs tegen hooggemotiveerde aanvallers met aanzienlijke middelen beschermen. In tegenstelling tot lastige versleutelmethoden die alleen losse bestanden versleutelen, versleutelt gbde gehele bestandssystemen op een transparante manier. De harde schijf komt nooit in aanraking met klare tekst.</p></div><div class=paragraph><p>Los van hoe een aanvaller in het bezit van een harde schijf of een uitgezette computer gekomen is, kunnen de cryptografische subsystemen GEOM Based Disk Encryption (gbde) en <code>geli</code> in FreeBSD gegevens op bestandssystemen van een computer beschermen tegen zelfs de meer gemotiveerde belagers die ook nog eens adequate middelen hebben. Anders dan met lastige versleutelingsmethoden die alleen individuele bestanden versleutelen, versleutelen <code>gbde</code> en <code>geli</code> transparant complete bestandssystemen. Er komt nooit platte tekst op een harde schijf.</p></div><div class=sect2><h3 id=_schijven_versleutelen_met_gbde>19.16.1. Schijven versleutelen met gbde<a class=anchor href=#_schijven_versleutelen_met_gbde></a></h3><div class="exampleblock procedure"><div class=content><div class="olist arabic"><ol class=arabic><li><p>Word <code>root</code></p><div class=paragraph><p>Het instellen van gbde vereist beheerdersrechten.</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>% su -
Password:</code></pre></div></div></li><li><p>Voeg ondersteuning voor <a href="https://man.freebsd.org/cgi/man.cgi?query=gbde&amp;sektion=4&amp;format=html">gbde(4)</a> aan het kernelinstellingenbestand toe</p><div class=paragraph><p>Voeg de volgende regel toe aan het kernelinstellingenbestand:</p></div><div class=paragraph><p><code>options GEOM_BDE</code></p></div><div class=paragraph><p>Herbouw de kernel opnieuw zoals beschreven in <a href=../kernelconfig/#kernelconfig>De FreeBSD-kernel instellen</a>.</p></div><div class=paragraph><p>Start op met de nieuwe kernel.</p></div></li><li><p>Een alternatief voor het hercompileren van de kernel is door gebruik te maken van <a href="https://man.freebsd.org/cgi/man.cgi?query=kldload&amp;sektion=8&amp;format=html">kldload(8)</a> om <a href="https://man.freebsd.org/cgi/man.cgi?query=gbde&amp;sektion=4&amp;format=html">gbde(4)</a> te laden:</p><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># kldload geom_bde</span></code></pre></div></div></li></ol></div></div></div><div class=sect3><h4 id=_versleutelde_harde_schijf_voorbereiden>19.16.1.1. Versleutelde harde schijf voorbereiden<a class=anchor href=#_versleutelde_harde_schijf_voorbereiden></a></h4><div class=paragraph><p>In het volgende voorbeeld wordt aangenomen dat er een nieuwe harde schijf aan het systeem wordt toegevoegd die een enkele versleutelde partitie zal bevatten. Deze partitie wordt aangekoppeld als <span class=filename>/private</span>. gbde kan ook gebruikt worden om <span class=filename>/home</span> en <span class=filename>/var/mail</span> te versleutelen, maar daarvoor zijn complexere instructies nodig die buiten het bereik van deze inleiding vallen.</p></div><div class="exampleblock procedure"><div class=content><div class="olist arabic"><ol class=arabic><li><p>Voeg een nieuwe harde schijf toe</p><div class=paragraph><p>Voeg de nieuwe harde schijf toe zoals beschreven in <a href=#disks-adding>Schijven toevoegen</a>. In dit voorbeeld is een nieuwe harde schijfpartitie toegevoegd als <span class=filename>/dev/ad4s1c</span>. De apparaten <span class=filename>/dev/ad0s1*</span> stellen bestaande standaard FreeBSD partities van het voorbeeldsysteem voor.</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># ls /dev/ad*</span>
/dev/ad0        /dev/ad0s1b     /dev/ad0s1e     /dev/ad4s1
/dev/ad0s1      /dev/ad0s1c     /dev/ad0s1f     /dev/ad4s1c
/dev/ad0s1a     /dev/ad0s1d     /dev/ad4</code></pre></div></div></li><li><p>Maak een map aan voor gbde lockbestanden</p><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># mkdir /etc/gbde</span></code></pre></div></div><div class=paragraph><p>Het lockbestand voor gbde bevat informatie die gbde nodig heeft om toegang te krijgen tot versleutelde partities. Zonder toegang tot de lockbestand is gbde niet in staat om de gegevens die op de versleutelde partitie staan te ontsleutelen zonder aanzienlijke handmatige tussenkomst die niet door de software ondersteund wordt. Elke versleutelde partitie gebruikt een ander lockbestand.</p></div></li><li><p>Initialiseer de gbde-partitie</p><div class=paragraph><p>Een gbde-partitie dient geÃ¯nitialiseerd te worden voordat deze kan worden gebruikt. Deze initialisatie dient slechts eenmalig uitgevoerd te worden:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># gbde init /dev/ad4s1c -i -L /etc/gbde/ad4s1c.lock</span></code></pre></div></div><div class=paragraph><p><a href="https://man.freebsd.org/cgi/man.cgi?query=gbde&amp;sektion=8&amp;format=html">gbde(8)</a> opent een tekstverwerker om verschillende instellingen in een sjabloon te kunnen instellen. Stel de sector_size in op 2048 als UFS of UFS2 wordt gebruikt:</p></div><div class="literalblock programlisting"><div class=content><pre># $FreeBSD: src/sbin/gbde/template.txt,v 1.1 2002/10/20 11:16:13 phk Exp $
#
# Sector size is the smallest unit of data which can be read or written.
# Making it too small decreases performance and decreases available space.
# Making it too large may prevent filesystems from working.  512 is the
# minimum and always safe.  For UFS, use the fragment size
#
sector_size	=	2048
[...]</pre></div></div><div class=paragraph><p><a href="https://man.freebsd.org/cgi/man.cgi?query=gbde&amp;sektion=8&amp;format=html">gbde(8)</a> vraagt twee keer om de wachtwoordzin voor het beveiligen van de gegevens. De wachtwoordzin dient beide keren hetzelfde te zijn. De mogelijkheid van gbde om de gegevens te beveiligen is geheel afhankelijk de gekozen wachtwoordzin.</p></div><div class=paragraph><p>Het commando <code>gbde init</code> maakt een lockbestand aan voor de gbde-partitie die in dit voorbeeld is opgeslagen als <span class=filename>/etc/gbde/ad4s1c.lock</span>. gdbde slotbestanden moeten eindigen op ".lock" om correct door het opstartscript <span class=filename>/etc/rc.d/gbde</span> gedetecteerd te worden.</p></div><div class="admonitionblock caution"><table><tbody><tr><td class=icon><i class="fa icon-caution" title=Caution></i></td><td class=content><div class=paragraph><p>gbde lockbestanden <em>moeten</em> samen met de inhoud van versleutelde partities geback-upped worden. Hoewel het verwijderen van een lockbestand op zich een gedreven aanvaller er niet van weerhoudt een gbde partitie te ontsleutelen, is de wettige eigenaar zonder het lockbestand niet in staat om de gegevens op de versleutelde partitie te benaderen zonder een aanzienlijke hoeveelheid werk die in het geheel niet ondersteund wordt door <a href="https://man.freebsd.org/cgi/man.cgi?query=gbde&amp;sektion=8&amp;format=html">gbde(8)</a> of de ontwerper ervan.</p></div></td></tr></tbody></table></div></li><li><p>Koppel de versleutelde partitie aan de kernel</p><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># gbde attach /dev/ad4s1c -l /etc/gbde/ad4s1c.lock</span></code></pre></div></div><div class=paragraph><p>Er wordt om de wachtwoordzin gevraagd die gekozen is tijdens de initialisatie van de versleutelde partitie. Het nieuwe versleutelde apparaat verschijnt in <span class=filename>/dev</span> als <span class=filename>/dev/apparaatnaam.bde</span>:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># ls /dev/ad*</span>
/dev/ad0        /dev/ad0s1b     /dev/ad0s1e     /dev/ad4s1
/dev/ad0s1      /dev/ad0s1c     /dev/ad0s1f     /dev/ad4s1c
/dev/ad0s1a     /dev/ad0s1d     /dev/ad4        /dev/ad4s1c.bde</code></pre></div></div></li><li><p>Maak een bestandssysteem op het versleutelde apparaat</p><div class=paragraph><p>Nu het versleutelde apparaat aan de kernel gekoppeld is, kan een bestandssysteem op het apparaat aangemaakt worden. Met <a href="https://man.freebsd.org/cgi/man.cgi?query=newfs&amp;sektion=8&amp;format=html">newfs(8)</a> kan een bestandssysteem op het versleutelde apparaat aangemaakt wordne. Aangezien het veel sneller is om een nieuw UFS2 bestandssysteem te initialiseren dan om een oud UFS1 bestandssysteem te initialiseren, is het aan te raden om <a href="https://man.freebsd.org/cgi/man.cgi?query=newfs&amp;sektion=8&amp;format=html">newfs(8)</a> met de optie <code>-O2</code> te gebruiken.</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># newfs -U -O2 /dev/ad4s1c.bde</span></code></pre></div></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Voer <a href="https://man.freebsd.org/cgi/man.cgi?query=newfs&amp;sektion=8&amp;format=html">newfs(8)</a> uit op een aangekoppelde gbde-partitie die geÃ¯ndificeerd wordt door de uitbreiding <span class=filename>*.bde</span> op de apparaatnaam.</p></div></td></tr></tbody></table></div></li><li><p>Mount de versleutelde partitie</p><div class=paragraph><p>Maak een koppelpunt voor het versleutelde bestandssysteem aan:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># mkdir /private</span></code></pre></div></div><div class=paragraph><p>Mount het versleutelde bestandssysteem:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># mount /dev/ad4s1c.bde /private</span></code></pre></div></div></li><li><p>Controleer of het versleutelde bestandssysteem beschikbaar is</p><div class=paragraph><p>Het versleutelde bestandssysteem is nu zichtbaar met <a href="https://man.freebsd.org/cgi/man.cgi?query=df&amp;sektion=1&amp;format=html">df(1)</a> en gebruiksklaar:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>% <span class=nb>df</span> <span class=nt>-H</span>
Filesystem        Size   Used  Avail Capacity  Mounted on
/dev/ad0s1a      1037M    72M   883M     8%    /
/devfs            1.0K   1.0K     0B   100%    /dev
/dev/ad0s1f       8.1G    55K   7.5G     0%    /home
/dev/ad0s1e      1037M   1.1M   953M     0%    /tmp
/dev/ad0s1d       6.1G   1.9G   3.7G    35%    /usr
/dev/ad4s1c.bde   150G   4.1K   138G     0%    /private</code></pre></div></div></li></ol></div></div></div></div><div class=sect3><h4 id=_bestaande_versleutelde_bestandssystemen_aankoppelen>19.16.1.2. Bestaande versleutelde bestandssystemen aankoppelen<a class=anchor href=#_bestaande_versleutelde_bestandssystemen_aankoppelen></a></h4><div class=paragraph><p>Elke keer nadat het systeem is opgestart dient elk versleuteld bestandssysteem opnieuw aan de kernel gekoppeld te worden, op fouten gecontroleerd te worden, en aangekoppeld te worden voordat de bestandssystemen gebruikt kunnen worden. De benodigde commandoâ€™s dienen als de gebruiker <code>root</code> uitgevoerd te worden.</p></div><div class="exampleblock procedure"><div class=content><div class="olist arabic"><ol class=arabic><li><p>Koppel de gbde-partitie aan de kernel</p><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># gbde attach /dev/ad4s1c -l /etc/gbde/ad4s1c.lock</span></code></pre></div></div><div class=paragraph><p>Er wordt om de wachtwoordzin gevraagd die gekozen is tijdens de initialisatie van de versleutelde gbde-partitie.</p></div></li><li><p>Controleer het bestandssysteem op fouten</p><div class=paragraph><p>Aangezien het nog niet mogelijk is om versleutelde bestandssystemen op te nemen in <span class=filename>/etc/fstab</span> voor automatische controle, dienen de bestandssystemen voordat ze aangekoppeld worden handmatig op fouten gecontroleerd te worden door <a href="https://man.freebsd.org/cgi/man.cgi?query=fsck&amp;sektion=8&amp;format=html">fsck(8)</a> uit te voeren:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># fsck -p -t ffs /dev/ad4s1c.bde</span></code></pre></div></div></li><li><p>Mount het versleutelde bestandssysteem</p><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># mount /dev/ad4s1c.bde /private</span></code></pre></div></div><div class=paragraph><p>Het versleutelde bestandssysteem is nu klaar voor gebruik.</p></div></li></ol></div></div></div><div class=sect4><h5 id=_versleutelde_partities_automatisch_aankoppelen>19.16.1.2.1. Versleutelde partities automatisch aankoppelen<a class=anchor href=#_versleutelde_partities_automatisch_aankoppelen></a></h5><div class=paragraph><p>Het is mogelijk om een script aan te maken om automatisch een versleutelde partitie aan te koppelen, op fouten te controleren en aan te koppelen, maar vanwege veiligheidsredenen dient het script niet het wachtwoord voor <a href="https://man.freebsd.org/cgi/man.cgi?query=gbde&amp;sektion=8&amp;format=html">gbde(8)</a> te bevatten. In plaats hiervan wordt het aangeraden om zulke scripts handmatig uit te voeren en het wachtwoord via de console of <a href="https://man.freebsd.org/cgi/man.cgi?query=ssh&amp;sektion=1&amp;format=html">ssh(1)</a> te geven.</p></div><div class=paragraph><p>Als alternatief, wordt er een <span class=filename>rc.d</span> script bijgeleverd. De argumenten kunnen via <a href="https://man.freebsd.org/cgi/man.cgi?query=rc.conf&amp;sektion=5&amp;format=html">rc.conf(5)</a> doorgegeven worden. Bijvoorbeeld:</p></div><div class="literalblock programlisting"><div class=content><pre>gbde_autoattach_all=&#34;YES&#34;
gbde_devices=&#34;ad4s1c&#34;
gbde_lockdir=&#34;/etc/gbde&#34;</pre></div></div><div class=paragraph><p>Hierdoor is het noodzakelijk dat de wachtwoordzin voor gbde bij het starten wordt ingegeven. Na het invoeren van de juiste wachtwoordzin wordt de met gbde versleutelde partitie automatisch aangekoppeld. Dit kan erg handig zijn bij het gebruik van gbde op notebooks.</p></div></div></div><div class=sect3><h4 id=_door_gbde_gebruikte_cryptografische_beschermingen>19.16.1.3. Door gbde gebruikte cryptografische beschermingen<a class=anchor href=#_door_gbde_gebruikte_cryptografische_beschermingen></a></h4><div class=paragraph><p><a href="https://man.freebsd.org/cgi/man.cgi?query=gbde&amp;sektion=8&amp;format=html">gbde(8)</a> versleutelt de sectorlading door gebruik te maken van 128-bit AES in CBC-modus. Elke sector op de schijf wordt met een andere AES-sleutel versleuteld. Meer informatie over het cryptografische ontwerp van gbde, inclusief de methode die gebruikt wordt om de sectorsleutels van de door de gebruiker gegeven wachtwoordzin af te leiden, staan in <a href="https://man.freebsd.org/cgi/man.cgi?query=gbde&amp;sektion=4&amp;format=html">gbde(4)</a>.</p></div></div><div class=sect3><h4 id=_compatibiliteitspunten>19.16.1.4. Compatibiliteitspunten<a class=anchor href=#_compatibiliteitspunten></a></h4><div class=paragraph><p><a href="https://man.freebsd.org/cgi/man.cgi?query=sysinstall&amp;sektion=8&amp;format=html">sysinstall(8)</a> is niet compatibel met apparaten die met gbde versleuteld zijn. Alle <span class=filename>*.bde</span> apparaten moeten van de kernel ontkoppeld worden voordat <a href="https://man.freebsd.org/cgi/man.cgi?query=sysinstall&amp;sektion=8&amp;format=html">sysinstall(8)</a> gebruikt wordt om te voorkomen dat het crasht tijdens het initiÃ«le zoeken naar apparaten. Om het versleutelde apparaat dat in dit voorbeeld gebruikt wordt te ontkoppelen:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># gbde detach /dev/ad4s1c</span></code></pre></div></div></div></div><div class=sect2><h3 id=_schijfversleuteling_met_geli>19.16.2. Schijfversleuteling met <code>geli</code><a class=anchor href=#_schijfversleuteling_met_geli></a></h3><div class=paragraph><p>Een alternatieve cryptografische GEOM klassie is beschikbaar - <code>geli</code>. Deze wordt op het moment ontwikkeld door PaweÅ‚ Jakub Dawidek &lt;<a href=mailto:pjd@FreeBSD.org>pjd@FreeBSD.org</a>>. <code>geli</code> verschilt van <code>gbde</code> in de mogelijkheden en in het gebruik van een andere methode voor het versleutelen.</p></div><div class=paragraph><p>De meest belangrijke mogelijkheden van <a href="https://man.freebsd.org/cgi/man.cgi?query=geli&amp;sektion=8&amp;format=html">geli(8)</a> zijn:</p></div><div class=ulist><ul><li><p>Gebruikt het <a href="https://man.freebsd.org/cgi/man.cgi?query=crypto&amp;sektion=9&amp;format=html">crypto(9)</a> framework; als cryptografische hardware aanwezig is, gebruikt <code>geli</code> die automatisch;</p></li><li><p>Ondersteunt meedere cryptografische algoritmen. Op dit moment AES, Blowfish en 3DES;</p></li><li><p>Staat toe dat de root-partitie wordt versleuteld. De wachtwoordzin die wordt gebruikt om de root-partitie te versleutelen wordt opgevraagd tijdens het starten van een systeem;</p></li><li><p>Staat het gebruik van twee onafhankelijke sleutels toe, bijvoorbeeld een "sleutel" en een "bedrijfssleutel");</p></li><li><p><code>geli</code> is snel; het werkt met sector-naar-sector versleuteling;</p></li><li><p>Ondersteunt back-up en restore van Master Keys. Als een gebruiker sleutels moet vernietigen, is het mogelijk weer toegang te krijgen tot de gegevens door sleutels uit een back-up te halen;</p></li><li><p>Ondersteunt het koppelen van een schijf met een willekeurige, eenmalige sleutel. Handig voor swap-partities en tijdelijke bestandssystemen.</p></li></ul></div><div class=paragraph><p>Meer mogelijkheden van <code>geli</code> staan beschreven in de handleiding van <a href="https://man.freebsd.org/cgi/man.cgi?query=geli&amp;sektion=8&amp;format=html">geli(8)</a>.</p></div><div class=paragraph><p>De volgende stappen beschrijven hoe ondersteuning voor <code>geli</code> in de FreeBSD-kernel ingeschakeld kan worden en hoe een nieuwe <code>geli</code> versleutelingsvoorziening gemaakt kan worden.</p></div><div class=paragraph><p>Het is noodzakelijk super-user rechten te hebben omdat de kernel wordt aangepast.</p></div><div class="exampleblock procedure"><div class=content><div class="olist arabic"><ol class=arabic><li><p>Toevoegen van <code>geli</code>-ondersteuning</p><div class=paragraph><p>Voeg de volgende regels toe aan het bestand met kernelinstellingen:</p></div><div class="literalblock programlisting"><div class=content><pre>options GEOM_ELI
device crypto</pre></div></div><div class=paragraph><p>Herbouw de kernel zoals beschreven is in <a href=../kernelconfig/#kernelconfig>De FreeBSD-kernel instellen</a>.</p></div><div class=paragraph><p>De <code>geli</code>-module kan ook bij het opstarten geladen worden. Voeg de volgende regel toe aan <span class=filename>/boot/loader.conf</span>:</p></div><div class="literalblock programlisting"><div class=content><pre>geom_eli_load=&#34;YES&#34;</pre></div></div><div class=paragraph><p>Nu hoort <a href="https://man.freebsd.org/cgi/man.cgi?query=geli&amp;sektion=8&amp;format=html">geli(8)</a> door de kernel ondersteund te worden.</p></div></li><li><p>Een Master Key genereren</p><div class=paragraph><p>Het volgende voorbeeld beschrijft hoe een sleutelbestand te maken, dat wordt gebruikt als onderdeel van de Master Key voor de versleutelde dienst die wordt aangekoppeld onder <span class=filename>/private</span>. Het sleutelbestand zorgt voor wat willekeurige gegevens die worden gebruikt om de Master Key te versleutelen. De Master Key wordt ook door een wachtwoordzin beschermd. De sectorgrootte van de dienst wordt 4 kB. Ook wordt beschreven hoe de <code>geli</code>-dienst te koppelen, er een bestandsysteem op te maken, dat aan te koppelen, hoe ermee te werken en tenslotte hoe te ontkoppelen.</p></div><div class=paragraph><p>Het wordt aangeraden een grotere sectorgrootte in te stellen (zoals 4 kB) voor betere prestaties.</p></div><div class=paragraph><p>De Master Key wordt beschermd door een wachtwoordzin en de gegevensbron voor het sleutelbestand wordt <span class=filename>/dev/random</span>. De sectorgrootte van <span class=filename>/dev/da2.eli</span>, die als dienst wordt aangeduid, wordt 4 kB.</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># dd if=/dev/random of=/root/da2.key bs=64 count=1</span>
<span class=c># geli init -s 4096 -K /root/da2.key /dev/da2</span>
Enter new passphrase:
Reenter new passphrase:</code></pre></div></div><div class=paragraph><p>Het is niet verplicht om zowel een wachtwoordzijn als een sleutelbestand te gebruiken. De methodes kunnen onafhankelijk van elkaar gebruikt worden.</p></div><div class=paragraph><p>Als een sleutelbestand wordt opgegeven als "-", wordt de standaardinvoer gebruikt. In het onderstaande voorbeeld wordt aangegeven hoe meer dan een sleutelbestand kan worden gebruikt.</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># cat sleutelbestand1 sleutelbestand2 sleutelbestand3 | geli init -K - /dev/da2</span></code></pre></div></div></li><li><p>De dienst koppelen met de gemaakte sleutel</p><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># geli attach -k /root/da2.key /dev/da2</span>
Enter passphrase:</code></pre></div></div><div class=paragraph><p>Het nieuwe platte tekst-apparaat wordt <span class=filename>/dev/da2.eli</span> genoemd.</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># ls /dev/da2*</span>
/dev/da2  /dev/da2.eli</code></pre></div></div></li><li><p>Het nieuwe bestandssysteem maken</p><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># dd if=/dev/random of=/dev/da2.eli bs=1m</span>
<span class=c># newfs /dev/da2.eli</span>
<span class=c># mount /dev/da2.eli /private</span></code></pre></div></div><div class=paragraph><p>Het versleutelde bestandssysteem moet nu zichtbaar zijn voor <a href="https://man.freebsd.org/cgi/man.cgi?query=df&amp;sektion=1&amp;format=html">df(1)</a> en beschikbaar zijn voor gebruik:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># df -H</span>
Filesystem     Size   Used  Avail Capacity  Mounted on
/dev/ad0s1a    248M    89M   139M    38%    /
/devfs         1.0K   1.0K     0B   100%    /dev
/dev/ad0s1f    7.7G   2.3G   4.9G    32%    /usr
/dev/ad0s1d    989M   1.5M   909M     0%    /tmp
/dev/ad0s1e    3.9G   1.3G   2.3G    35%    /var
/dev/da2.eli   150G   4.1K   138G     0%    /private</code></pre></div></div></li><li><p>De dienst afkoppelen</p><div class=paragraph><p>Als het werk met de versleutelde partitie is afgehandeld en de <span class=filename>/private</span>-partitie niet langer nodig is, dan is het verstandig te overwegen de met <code>geli</code> versleutelde partitie af te koppelen van het bestandssysteem en de kernel.</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># umount /private</span>
<span class=c># geli detach da2.eli</span></code></pre></div></div></li></ol></div></div></div><div class=paragraph><p>Meer informatie over <a href="https://man.freebsd.org/cgi/man.cgi?query=geli&amp;sektion=8&amp;format=html">geli(8)</a> staat in de handleiding.</p></div><div class=sect3><h4 id=_gebruik_maken_van_het_geli_rc_d_script>19.16.2.1. Gebruik maken van het <span class=filename>geli</span> <span class=filename>rc.d</span> script.<a class=anchor href=#_gebruik_maken_van_het_geli_rc_d_script></a></h4><div class=paragraph><p>Bij <code>geli</code> hoort een <span class=filename>rc.d</span> script dat gebruikt kan worden om het gebruik van <code>geli</code> te vereenvoudigen. Een voorbeeld van hoe <code>geli</code> met <a href="https://man.freebsd.org/cgi/man.cgi?query=rc.conf&amp;sektion=5&amp;format=html">rc.conf(5)</a> ingesteld kan worden volgt:</p></div><div class="literalblock programlisting"><div class=content><pre>geli_devices=&#34;da2&#34;
geli_da2_flags=&#34;-p -k /root/da2.key&#34;</pre></div></div><div class=paragraph><p>Hiermee wordt <span class=filename>/dev/da2</span> ingesteld als <code>geli</code>-dienst met Master Key-bestand <span class=filename>/root/da2.key</span> en <code>geli</code> gebruikt geen wachtwoordzin als de dienst wordt gekoppeld (dit kan alleen gebruikt worden als <code>-P</code> is meegegeven tijdens de <code>geli init</code> fase van <code>geli</code>). Een systeem ontkoppelt de <code>geli</code>-dienst van de kernel voordat het afsluit.</p></div><div class=paragraph><p>Meer informatie over het instellen van rc.d staat in het onderdeel over <a href=../config/#configtuning-rcd>rc.d</a>.</p></div></div></div></div></div><div class=sect1><h2 id=swap-encrypting>19.17. Het versleutelen van de wisselbestand ruimte<a class=anchor href=#swap-encrypting></a></h2><div class=sectionbody><div class=paragraph><p>Het versleutelen van de wisselbestand ruimte is gemakkelijk met FreeBSD te configureren. Afhankelijk van welke versie er gebruikt wordt zijn er verschillende configuratie opties en instellingen mogelijk. De <a href="https://man.freebsd.org/cgi/man.cgi?query=gbde&amp;sektion=8&amp;format=html">gbde(8)</a> en <a href="https://man.freebsd.org/cgi/man.cgi?query=geli&amp;sektion=8&amp;format=html">geli(8)</a> programmaâ€™s kunnen gebruikt worden voor het versleutelen van het wisselbestand. Beide systemen maken gebruik van het <span class=filename>encswap</span> <a href=../config/#configtuning-rcd>rc.d</a> script.</p></div><div class=paragraph><p>De vorige sectie, <a href=#disks-encrypting>Schijfpartities versleutelen</a>, biedt een korte discussie over de verschillende versleutel systemen.</p></div><div class=sect2><h3 id=_waarom_moet_het_wisselbestand_versleuteld_worden>19.17.1. Waarom moet het wisselbestand versleuteld worden?<a class=anchor href=#_waarom_moet_het_wisselbestand_versleuteld_worden></a></h3><div class=paragraph><p>Net als met het versleutelen van harde schijven, wordt het versleutelen van het wisselbestand gebruikt om gevoelige data te beschermen. Stelt u eens een applicatie voor dat omgaat het wachtwoorden. Zolang deze wachtwoorden in het fysieke geheugen blijven is er niets aan de hand. Echter zodra deze verplaatst worden naar het wisselbestand om ruimte te maken voor andere applicaties, kan het gebeuren dat de wachtwoorden onbeschermd op de harde schijf geschreven worden, waardoor het makkelijk te achterhalen is voor iemand die kwaad wilt. Het versleutelen van het wisselbestand biedt hierin een mogelijke uitkomst.</p></div></div><div class=sect2><h3 id=_voorbereiding>19.17.2. Voorbereiding<a class=anchor href=#_voorbereiding></a></h3><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Tot het einde van deze sectie zal <span class=filename>ad0s1b</span> het wisselbestand bevatten.</p></div></td></tr></tbody></table></div><div class=paragraph><p>Tot op dit moment is het wisselbestand niet versleuteld. Het is mogelijk dat er reeds wachtwoorden of andere gevoelige data onbeschermd op de harde schijf geschreven zijn. Om dit te corrigeren, moet de data op de swap partitie overschreven worden met willekeurige data:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># dd if=/dev/random of=/dev/ad0s1b bs=1m</span></code></pre></div></div></div><div class=sect2><h3 id=_versleutelen_van_het_wisselbestand_met_gbde8>19.17.3. Versleutelen van het wisselbestand met <a href="https://man.freebsd.org/cgi/man.cgi?query=gbde&amp;sektion=8&amp;format=html">gbde(8)</a><a class=anchor href=#_versleutelen_van_het_wisselbestand_met_gbde8></a></h3><div class=paragraph><p>Er moet gebruik gemaakt worden van het <code>.bde</code> achtervoegsel aan het apparaat in de respectievelijke <span class=filename>/etc/fstab</span>-regel betreffende het wisselbestand:</p></div><div class="literalblock programlisting"><div class=content><pre># Device		Mountpoint	FStype	Options		Dump	Pass#
/dev/ad0s1b.bde		none		swap	sw		0	0</pre></div></div></div><div class=sect2><h3 id=_versleutelen_van_het_wisselbestand_met_geli8>19.17.4. Versleutelen van het wisselbestand met <a href="https://man.freebsd.org/cgi/man.cgi?query=geli&amp;sektion=8&amp;format=html">geli(8)</a><a class=anchor href=#_versleutelen_van_het_wisselbestand_met_geli8></a></h3><div class=paragraph><p>Het opzetten van <a href="https://man.freebsd.org/cgi/man.cgi?query=geli&amp;sektion=8&amp;format=html">geli(8)</a> voor het versleutelen van het wisselbestand is hetzelfde als dat van <a href="https://man.freebsd.org/cgi/man.cgi?query=gbde&amp;sektion=8&amp;format=html">gbde(8)</a>. Hier moet echter gebruik gemaakt worden van het <code>.eli</code> achtervoegsel aan het apparaat in de respectievelijke <span class=filename>/etc/fstab</span> wisselbestand regel:</p></div><div class="literalblock programlisting"><div class=content><pre># Device		Mountpoint	FStype	Options		Dump	Pass#
/dev/ad0s1b.eli		none		swap	sw		0	0</pre></div></div><div class=paragraph><p><a href="https://man.freebsd.org/cgi/man.cgi?query=geli&amp;sektion=8&amp;format=html">geli(8)</a> maakt standaard gebruik van het AES algoritme met een sleutellengte van 128 bits.</p></div><div class=paragraph><p>Optioneel kunnen deze standaardwaarden worden aangepast door gebruik te maken van de <code>geli_swap_flags</code> optie in <span class=filename>/etc/rc.conf</span>. De volgende regel verteld het <span class=filename>encswap</span> rc.d bestand om een <a href="https://man.freebsd.org/cgi/man.cgi?query=geli&amp;sektion=8&amp;format=html">geli(8)</a> wisselbestand te maken met het Blowfish algoritme met een sleutel lengte van 128 bit, een sectorgrootte van 4 kilobytes en met de optie "ontkoppelen nadat de laatste afsluiting" gezet:</p></div><div class="literalblock programlisting"><div class=content><pre>geli_swap_flags=&#34;-e blowfish -l 128 -s 4096 -d&#34;</pre></div></div><div class=paragraph><p>Zie de uitleg over het <code>onetime</code> commando in de <a href="https://man.freebsd.org/cgi/man.cgi?query=geli&amp;sektion=8&amp;format=html">geli(8)</a> handleiding voor een lijst van mogelijke opties.</p></div></div><div class=sect2><h3 id=_controleren_of_het_werkt>19.17.5. Controleren of het werkt<a class=anchor href=#_controleren_of_het_werkt></a></h3><div class=paragraph><p>Zodra het systeem opnieuw opgestart is kan gekeken worden of alles nog goed werkt door gebruik te maken van het <code>swapinfo</code> commando.</p></div><div class=paragraph><p>Als gebruik gemaakt wordt van <a href="https://man.freebsd.org/cgi/man.cgi?query=gbde&amp;sektion=8&amp;format=html">gbde(8)</a>:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>% swapinfo
Device          1K-blocks     Used    Avail Capacity
/dev/ad0s1b.bde    542720        0   542720     0%</code></pre></div></div><div class=paragraph><p>Als gebruik gemaakt wordt van <a href="https://man.freebsd.org/cgi/man.cgi?query=geli&amp;sektion=8&amp;format=html">geli(8)</a>:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell>% swapinfo
Device          1K-blocks     Used    Avail Capacity
/dev/ad0s1b.eli    542720        0   542720     0%</code></pre></div></div></div></div></div><div class=sect1><h2 id=disks-hast>19.18. Highly Available Storage (HAST)<a class=anchor href=#disks-hast></a></h2><div class=sectionbody><div class=sect2><h3 id=_overzicht>19.18.1. Overzicht<a class=anchor href=#_overzicht></a></h3><div class=paragraph><p>Hoge beschikbaarheid is een van de hoofdzaken in serieuze zakelijke toepassingen en hoog beschikbare opslag is een sleutelonderdeel in zulke omgevingen. Hoog beschikbare opslag, of HAST, werd ontwikkeld door PaweÅ‚ Jakub Dawidek &lt;<a href=mailto:pjd@FreeBSD.org>pjd@FreeBSD.org</a>> als een raamwerk dat transparante opslag van dezelfde gegevens toestaat over fysiek gescheiden machines die verbonden zijn door een TCP/IP-netwerk. HAST kan gezien worden als een netwerkgebaseerde RAID1 (spiegel) en is vergelijkbaar met het DRBDÂ® opslagsysteem bekend van het GNU/LinuxÂ® platform. In combinatie met andere eigenschappen voor hoge beschikbaarheid van FreeBSD zoals CARP maakt HAST het mogelijk om een opslagcluster met hoge beschikbaarheid te bouwen dat resistent is tegen falende hardware.</p></div><div class=paragraph><p>Na het lezen van deze sectie weet u:</p></div><div class=ulist><ul><li><p>Wat HAST is, hoe het werkt en welke mogelijkheden het biedt.</p></li><li><p>Hoe HAST op FreeBSD te op te zetten en te gebruiken.</p></li><li><p>Hoe CARP en <a href="https://man.freebsd.org/cgi/man.cgi?query=devd&amp;sektion=8&amp;format=html">devd(8)</a> te integreren om een robuust opslagsysteem te bouwen.</p></li></ul></div><div class=paragraph><p>Voor het lezen van deze sectie dient u:</p></div><div class=ulist><ul><li><p>De beginselen van UNIXÂ® en FreeBSD te begrijpen (<a href=../basics/#basics>UNIXÂ® beginselen</a>).</p></li><li><p>Te weten hoe de netwerkinterfaces en andere kerndeelsystemen van FreeBSD in te stellen (<a href=../config/#config-tuning>Instellingen en optimalisatie</a>).</p></li><li><p>Netwerken op FreeBSD goed te begrijpen (<a href=../partiv/#network-communication>Netwerkcommunicatie</a>).</p></li><li><p>FreeBSD 8.1-RELEASE of nieuwer te gebruiken.</p></li></ul></div><div class=paragraph><p>Het HAST-project werd gesponsord door The FreeBSD Foundation met ondersteuning van <a href=http://www.omc.net/>OMCnet Internet Service GmbH</a> en <a href=http://www.transip.nl/>TransIP BV</a>.</p></div></div><div class=sect2><h3 id=_eigenschappen_van_hast>19.18.2. Eigenschappen van HAST<a class=anchor href=#_eigenschappen_van_hast></a></h3><div class=paragraph><p>De belangrijkste eigenschappen van HAST zijn:</p></div><div class=ulist><ul><li><p>Het kan gebruikt worden om I/O-fouten op lokale harde schijven te maskeren.</p></li><li><p>Agnostisch qua bestandssysteem, dus het werkt met elk bestandssysteem dat door FreeBSD wordt ondersteund.</p></li><li><p>EfficiÃ«nte en snelle hersynchronisatie, alleen de blokken die zijn veranderd toen een knooppunt uitstond worden gesynchroniseerd.</p></li><li><p>Het kan gebruikt worden in reeds uitgerolde omgevingen om aanvullende redundantie toe te voegen.</p></li><li><p>Samen met CARP, Heartbeat of andere gereedschappen kan het worden gebruikt om een robuust en duurzaam opslagsysteem te bouwen.</p></li></ul></div></div><div class=sect2><h3 id=_werking_van_hast>19.18.3. Werking van HAST<a class=anchor href=#_werking_van_hast></a></h3><div class=paragraph><p>Omdat HAST synchrone replicatie op blokniveau van elk opslagmedium naar verscheidene machines biedt, heeft het tenminste twee knooppunten (fysieke machines) nodig - het <code>primaire</code> (ook bekend als <code>meester</code>) knooppunt en het <code>secundaire</code> (<code>slaaf</code>) knooppunt. Tezamen worden deze twee machines een cluster genoemd.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>HAST is momenteel beperkt tot een totaal van twee clusterknooppunten.</p></div></td></tr></tbody></table></div><div class=paragraph><p>Aangezien HAST in een primaire-secundaire configuratie werkt, kan er op elk moment slechts Ã©Ã©n van de clusterknooppunten actief zijn. Het <code>primaire</code> knooppunt, ookwel <code>actief</code>, is degene die alle I/O-verzoeken aan apparaten die door HAST worden beheerd afhandelt. Het <code>secundaire</code> knooppunt wordt dan automatisch gesynchroniseerd vanuit het <code>primaire</code> knooppunt.</p></div><div class=paragraph><p>De fysieke componenten van het HAST-systeem zijn:</p></div><div class=ulist><ul><li><p>lokale schijf (op primair knooppunt)</p></li><li><p>schijf op verre machine (secundair knooppunt)</p></li></ul></div><div class=paragraph><p>HAST werkt synchroon op blokniveau, wat het transparant maakt voor bestandssystemen en toepassingen. HAST biedt reguliere GEOM-aanbieders aan in <span class=filename>/dev/hast/</span> voor zowel andere gereedschappen als toepassingen, er is dus geen verschil tussen het gebruik van apparaten die door HAST worden geleverd en rauwe schijven, partities, etc.</p></div><div class=paragraph><p>Elke bewerking met betrekking tot schrijven, verwijderen of spoelen wordt naar de plaatselijke schijf en over TCP/IP naar de verre schijf gestuurd. Elke leesbewerking wordt gedaan door de plaatselijke schijf, tenzij de plaatselijke schijf niet actueel is of er een I/O-fout optreed. In zulke gevallen wordt de leesbewerking naar het secundaire knooppunt gestuurd.</p></div><div class=sect3><h4 id=_synchronisatie_en_replicatiemodi>19.18.3.1. Synchronisatie- en replicatiemodi<a class=anchor href=#_synchronisatie_en_replicatiemodi></a></h4><div class=paragraph><p>HAST probeert om een snel herstel van fouten te leveren. Om deze reden is het heel belangrijk om de synchronisatietijd te verkorten nadat een knooppunt is hersteld van een uitval. Om een snelle synchronisatie te leveren, beheert HAST op de schijf een bitmap van gebruikte extents en synchroniseert het die alleen tijdens een reguliere synchronisatie (met uitzondering van de initiÃ«e synchronisatie).</p></div><div class=paragraph><p>Er zijn vele manieren om synchronisatie af te handelen. HAST implementeert meerdere replicatiemodi om verschillende synchronisatiemethodes af te handelen:</p></div><div class=ulist><ul><li><p><em>memsync</em>: rapporteer een schrijfbewerking als voltooid wanneer de plaatselijke schrijfbewerking klaar is en wanneer het verre knooppunt de gegevensaankomst bevestigt, maar voordat het de gegevens daadwerkelijk heeft opgeslagen. De gegevens op het verre knooppunt zullen meteen na het versturen van de bevestiging worden opgeslagen. Deze modus is bedoeld om latency te verminderen en nog steeds een zeer goede betrouwbaarheid te bieden. De replicatiemodus <em>memsync</em> is momenteel niet geÃ¯mplementeerd.</p></li><li><p><em>fullsync</em>: rapporteer een schrijfbewerking als voltooid wanneer zowel de plaatselijke en de verre schrijfbewerking voltooid zijn. Dit is de veiligste en traagste replicatiemodus. Dit is de standaardmodus.</p></li><li><p><em>async</em>: rapporteer de schrijfbewerking als voltooid wanneer de plaatselijke schrijfbewerking klaar is. Dit is de snelste en gevaarlijkste replicatiemodus. Het dient gebruikt te worden wanneer er naar een ver knooppunt wordt gerepliceerd en de latency te hoog is voor andere modi. De replicatiemodus <em>async</em> is momenteel niet geÃ¯mplementeerd.</p></li></ul></div><div class="admonitionblock warning"><table><tbody><tr><td class=icon><i class="fa icon-warning" title=Warning></i></td><td class=content><div class=paragraph><p>Momenteel wordt alleen de replicatiemodus <em>fullsync</em> ondersteund.</p></div></td></tr></tbody></table></div></div></div><div class=sect2><h3 id=_hast_configuratie>19.18.4. HAST-configuratie<a class=anchor href=#_hast_configuratie></a></h3><div class=paragraph><p>HAST heeft ondersteuning voor <code>GEOM_GATE</code> nodig om te kunnen functioneren. De kernel <code>GENERIC</code> bevat standaard <em>geen</em> <code>GEOM_GATE</code>, de laadbare module <span class=filename>geom_gate.ko</span> is echter beschikbaar in de standaardinstallatie van FreeBSD. Zorg ervoor dat deze module beschikbaar is voor afgeslankte systemen. Het is ook mogelijk om ondersteuning voor <code>GEOM_GATE</code> statisch in de kernel te bouwen, door deze regel aan het kernelconfiguratiebestand toe te voegen:</p></div><div class="literalblock programlisting"><div class=content><pre>options	GEOM_GATE</pre></div></div><div class=paragraph><p>Het HAST-raamwerk bestaat vanuit het besturingssysteem gezien uit verschillende delen:</p></div><div class=ulist><ul><li><p>het daemon <a href="https://man.freebsd.org/cgi/man.cgi?query=hastd&amp;sektion=8&amp;format=html">hastd(8)</a> dat verantwoordelijk is voor de gegevenssynchronisatie,</p></li><li><p>het beheerprogramma <a href="https://man.freebsd.org/cgi/man.cgi?query=hastctl&amp;sektion=8&amp;format=html">hastctl(8)</a> voor de gebruikers,</p></li><li><p>het configuratiebestand <a href="https://man.freebsd.org/cgi/man.cgi?query=hast.conf&amp;sektion=5&amp;format=html">hast.conf(5)</a>.</p></li></ul></div><div class=paragraph><p>Het volgende voorbeeld beschrijft hoe twee knooppunten in een <code>meester</code>-<code>slaaf</code> / <code>primaire</code>-<code>secundaire</code> opstelling te configureren door HAST te gebruiken om de gegevens tussen de twee te repliceren. De knooppunten worden <code>hasta</code> met IP-adres <em>172.16.0.1</em> en <code>hastb</code> met IP-adres <em>172.16.0.2</em> genoemd. Beide knooppunten hebben een toegewijde harde schijf <span class=filename>/dev/ad6</span> van dezelfde grootte om met HAST te werken. De HAST-pool (soms ook een hulpbron genoemd, i.e., de GEOM-aanbieder in <span class=filename>/dev/hast/</span>) wordt <span class=filename>test</span> genoemd.</p></div><div class=paragraph><p>Het bestand <span class=filename>/etc/hast.conf</span> regelt de configuratie van HAST. Dit bestand dient hetzelfde te zijn op beide knooppunten. Het volgende is de eenvoudigste configuratie die mogelijk is:</p></div><div class="literalblock programlisting"><div class=content><pre>resource test {
	on hasta {
		local /dev/ad6
		remote 172.16.0.2
	}
	on hastb {
		local /dev/ad6
		remote 172.16.0.1
	}
}</pre></div></div><div class=paragraph><p>Raadpleeg voor geavanceerdere configuraties de handleidingpagina <a href="https://man.freebsd.org/cgi/man.cgi?query=hast.conf&amp;sektion=5&amp;format=html">hast.conf(5)</a>.</p></div><div class="admonitionblock tip"><table><tbody><tr><td class=icon><i class="fa icon-tip" title=Tip></i></td><td class=content><div class=paragraph><p>Het is ook mogelijk om hostnamen in de regels met <code>remote</code> te gebruiken. Zorg er in dat geval voor dat deze hosts vindbaar zijn, bijvoorbeeld doordat ze zijn gedefinieerd in het bestand <span class=filename>/etc/hosts</span> of anders in het plaatselijke DNS.</p></div></td></tr></tbody></table></div><div class=paragraph><p>Nu de configuratie op beide knooppunten aanwezig is, kan de HAST-pool aangemaakt worden . Voer deze commandoâ€™s op beide knooppunten uit om de initiÃ«le metagegevens op de plaatselijke schijf te plaatsen en het <a href="https://man.freebsd.org/cgi/man.cgi?query=hastd&amp;sektion=8&amp;format=html">hastd(8)</a>-daemon te starten:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># hastctl create test</span>
<span class=c># service hastd onestart</span></code></pre></div></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content><div class=paragraph><p>Het is <em>niet</em> mogelijk om GEOM-aanbieders met een bestaand bestandssysteem te gebruiken (i.e., een bestaande opslag omzetten naar een door HAST beheerde pool), omdat deze procedure wat metagegevens op de aanbieder moet opslaan en er daarvoor niet genoeg beschikbare ruimte is.</p></div></td></tr></tbody></table></div><div class=paragraph><p>De rol van een HAST-knooppunt (<code>primair</code> of <code>secundair</code>) wordt uitgekozen door een beheerder of software zoals Heartbeat dat het gereedschap <a href="https://man.freebsd.org/cgi/man.cgi?query=hastctl&amp;sektion=8&amp;format=html">hastctl(8)</a> gebruikt. Voer het volgende commando uit op het primaire knooppunt ( <code>hasta</code>):</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># hastctl role primary test</span></code></pre></div></div><div class=paragraph><p>Voer dit soortgelijke commando uit op het secundaire knooppunt ( <code>hastb</code>):</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># hastctl role secondary test</span></code></pre></div></div><div class="admonitionblock caution"><table><tbody><tr><td class=icon><i class="fa icon-caution" title=Caution></i></td><td class=content><div class=paragraph><p>De situatie dat de knooppunten niet met elkaar kunnen communiceren en beide geconfigureerd zijn als primaire knooppunten; wordt <code>split-brain</code> genoemd. Volg de stappen zoals beschreven in <a href=#disks-hast-sb>Herstellen van de Split-brain-conditie</a> om deze situatie op te lossen.</p></div></td></tr></tbody></table></div><div class=paragraph><p>Verifieer met het gereedschap <a href="https://man.freebsd.org/cgi/man.cgi?query=hastctl&amp;sektion=8&amp;format=html">hastctl(8)</a> het resultaat op elk knooppunt:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># hastctl status test</span></code></pre></div></div><div class=paragraph><p>De belangrijke tekst is de regel met <code>status</code> dat voor alle knooppunten <code>complete</code> dient te bevatten. Als het <code>degraded</code> bevat, is er iets verkeerd gegaan. Op dat moment is de synchronisatie tussen de knooppunten al begonnen. De synchronisatie is compleet wanneer <code>hastctl status</code> 0 bytes aan <code>dirty</code> extents rapporteert.</p></div><div class=paragraph><p>De volgende stap is het aanmaken van een bestandssysteem op de GEOM-aanbieder <span class=filename>/dev/hast/test</span> en het aan te koppelen. Dit moet op het <code>primaire</code> knooppunt gebeuren, aangezien <span class=filename>/dev/hast/test</span> alleen op het <code>primaire</code> knooppunt verschijnt. Het aanmaken van het bestandssysteem kan afhankelijk van de grootte van de harde schijf enkele minuten duren:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># newfs -U /dev/hast/test</span>
<span class=c># mkdir /hast/test</span>
<span class=c># mount /dev/hast/test /hast/test</span></code></pre></div></div><div class=paragraph><p>Wanneer het HAST-raamwerk correct is geconfigureerd, betreft de laatste stap het ervoor zorgen dat HAST automatisch tijdens het opstarten wordt gestart. Voeg deze regel toe aan het bestand <span class=filename>/etc/rc.conf</span>:</p></div><div class="literalblock programlisting"><div class=content><pre>hastd_enable=&#34;YES&#34;</pre></div></div><div class=sect3><h4 id=_failover_configuratie>19.18.4.1. Failover-configuratie<a class=anchor href=#_failover_configuratie></a></h4><div class=paragraph><p>Het doel van dit voorbeeld is om een robuust opslagsysteem te bouwen dat resistent is tegen het falen van alle knooppunten. Het scenario is dat een <code>primair</code> knooppunt van het cluster faalt. Als dit gebeurt, dan neemt het <code>secundaire</code> knooppunt het feilloos over, controleert het het bestandssysteem en koppelt het het bestandssysteem aan, en gaat het verder zonder dat er een bit aan gegevens ontbreekt.</p></div><div class=paragraph><p>Om dit voor elkaar te krijgen, is er een andere eigenschap die beschikbaar is op FreeBSD dat voorziet in automatische failover van de IP-laag - CARP. CARP (Common Address Redundancy Protocol) maakt het mogelijk dat meerdere hosts in hetzelfde netwerksegment een IP-adres delen. Stel CARP in op beide knooppunten van het cluster volgens de documentatie die beschikbaar is in <a href=../advanced-networking/#carp>Common Address Redundancy Protocol (CARP)</a>. Nadat de opzet voltooid is, heeft elk knooppunt een eigen interface <span class=filename>carp0</span> met een gedeeld IP-adres <em>172.16.0.254</em>. Het primaire HAST-knooppunt van het cluster moet het meester-CARP-knooppunt zijn.</p></div><div class=paragraph><p>De HAST-pool die in de vorige sectie is gemaakt is nu klaar om geÃ«xporteerd te worden naar de andere hosts op het netwerk. Dit kan gedaan worden door het te exporteren over NFS, Samba, etc., door gebruik te maken van het gedeelde IP-adres <em>172.16.0.254</em>. Het enige overgebleven probleem is een automatische failover in het geval dat het primaire knooppunt het begeeft.</p></div><div class=paragraph><p>Als een CARP-interface aan- of uitgaat, genereert FreeBSD een <a href="https://man.freebsd.org/cgi/man.cgi?query=devd&amp;sektion=8&amp;format=html">devd(8)</a>-gebeurtenis, wat het mogelijk maakt om toestandsveranderingen op de CARP-interfaces in de gaten te houden. Een toestandsverandering op het CARP-interface geeft aan dat een van de knooppunten het begaf of weer online kwam. Deze toestandsveranderingen maken het mogelijk om een script te draaien dat automatisch de HAST-failover afhandelt.</p></div><div class=paragraph><p>Voeg, om toestandsverandering op de CARP-interfaces af te vangen, het volgende toe aan het bestand <span class=filename>/etc/devd.conf</span> op elk knooppunt:</p></div><div class="literalblock programlisting"><div class=content><pre>notify 30 {
	match &#34;system&#34; &#34;IFNET&#34;;
	match &#34;subsystem&#34; &#34;carp0&#34;;
	match &#34;type&#34; &#34;LINK_UP&#34;;
	action &#34;/usr/local/sbin/carp-hast-switch master&#34;;
};

notify 30 {
	match &#34;system&#34; &#34;IFNET&#34;;
	match &#34;subsystem&#34; &#34;carp0&#34;;
	match &#34;type&#34; &#34;LINK_DOWN&#34;;
	action &#34;/usr/local/sbin/carp-hast-switch slave&#34;;
};</pre></div></div><div class=paragraph><p>Herstart <a href="https://man.freebsd.org/cgi/man.cgi?query=devd&amp;sektion=8&amp;format=html">devd(8)</a> op beide knooppunten om de nieuwe configuratie te laten gelden:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># service devd restart</span></code></pre></div></div><div class=paragraph><p>Als het interface <span class=filename>carp0</span> aan of uit gaat (i.e., de toestand van het interface verandert), genereert het systeem een notificatie wat het subsysteem <a href="https://man.freebsd.org/cgi/man.cgi?query=devd&amp;sektion=8&amp;format=html">devd(8)</a> in staat stelt om een willekeurig script te draaien, in dit geval <span class=filename>/usr/local/sbin/carp-hast-switch</span>. Dit is het script dat de automatische failover afhandelt. Raadpleeg de handleidingpagina <a href="https://man.freebsd.org/cgi/man.cgi?query=devd.conf&amp;sektion=5&amp;format=html">devd.conf(5)</a> voor verdere uitleg over de bovenstaande configuratie van <a href="https://man.freebsd.org/cgi/man.cgi?query=devd&amp;sektion=8&amp;format=html">devd(8)</a>.</p></div><div class=paragraph><p>Dit zou een voorbeeld van zoâ€™n script kunnen zijn:</p></div><div class="literalblock programlisting"><div class=content><pre>#!/bin/sh
# Origineel script door Freddie Cash &lt;fjwcash@gmail.com&gt;
# Gewijzigd door Michael W. Lucas &lt;mwlucas@BlackHelicopters.org&gt;
# en Viktor Petersson &lt;vpetersson@wireload.net&gt;

# De namen van de HAST-hulpbronnen, zoals vermeld in /etc/hast.conf
resources=&#34;test&#34;

# vertraging voor het aankoppelen van de HAST-hulpbron na het worden van meester
# doe een gok
delay=3

# logging
log=&#34;local0.debug&#34;
name=&#34;carp-hast&#34;

# einde van gebruiker-instelbare dingen

case &#34;$1&#34; in
	master)
		logger -p $log -t $name &#34;Omschakelen naar primaire aanbieder voor ${resources}.&#34;
		sleep ${delay}

		# Wacht totdat de &#34;hastd secondary&#34; processen zijn gestopt
		for disk in ${resources}; do
			while $( pgrep -lf &#34;hastd: ${disk} \(secondary\)&#34; &gt; /dev/null 2&gt;&amp;1 ); do
				sleep 1
			done

			# Verwissel de rol voor elke schijf
			hastctl role primary ${disk}
			if [ $? -ne 0 ]; then
				logger -p $log -t $name &#34;Omschakelen van rol naar primair voor hulpbron ${disk} mislukt.&#34;
				exit 1
			fi
		done

		# Wacht totdat de apparaten /dev/hast/* verschijnen
		for disk in ${resources}; do
			for I in $( jot 60 ); do
				[ -c &#34;/dev/hast/${disk}&#34; ] &amp;&amp; break
				sleep 0.5
			done

			if [ ! -c &#34;/dev/hast/${disk}&#34; ]; then
				logger -p $log -t $name &#34;GEOM-aanbieder /dev/hast/${disk} is niet verschenen.&#34;
				exit 1
			fi
		done

		logger -p $log -t $name &#34;Rollen van HAST-hulpbronnen ${resources} omgeschakeld naar primair.&#34;

		logger -p $log -t $name &#34;Schijven aankoppelen.&#34;
		for disk in ${resources}; do
			mkdir -p /hast/${disk}
			fsck -p -y -t ufs /dev/hast/${disk}
			mount /dev/hast/${disk} /hast/${disk}
		done

	;;

	slave)
		logger -p $log -t $name &#34;Omschakelen naar secundaire aanbieder voor ${resources}.&#34;

		# Schakel de rollen van de HAST-hulpbronnen om
		for disk in ${resources}; do
			if ! mount | grep -q &#34;^/dev/hast/${disk} on &#34;
			then
			else
				umount -f /hast/${disk}
			fi
			sleep $delay
			hastctl role secondary ${disk} 2&gt;&amp;1
			if [ $? -ne 0 ]; then
				logger -p $log -t $name &#34;Omschakelen van rol naar secundair voor hulpbron ${disk} mislukt.&#34;
				exit 1
			fi
			logger -p $log -t $name &#34;Rol van hulpbron ${disk} omgeschakeld naar secundair.&#34;
		done
	;;
esac</pre></div></div><div class=paragraph><p>In een notendop neemt het script deze acties wanneer een knooppunt <code>meester</code> / <code>primair</code> wordt:</p></div><div class=ulist><ul><li><p>De HAST-pools opwaarderen naar primair op een gegeven knooppunt.</p></li><li><p>Het bestandssysteem onder de HAST-pool controleren.</p></li><li><p>De pools op een juiste plaats aankoppelen.</p></li></ul></div><div class=paragraph><p>Wanneer een knooppunt <code>back-up</code> / <code>secundair</code> wordt:</p></div><div class=ulist><ul><li><p>De HAST-pools afkoppelen.</p></li><li><p>De HAST-pools degraderen naar secundair.</p></li></ul></div><div class="admonitionblock caution"><table><tbody><tr><td class=icon><i class="fa icon-caution" title=Caution></i></td><td class=content><div class=paragraph><p>Houd in gedachte dat dit slechts een voorbeeldscript is om aan te tonen dat alles werkt. Het behandeld niet alle mogelijke situaties en kan op elke manier worden uitgebreid of veranderd, het kan bijvoorbeeld benodigde diensten starten en stoppen.</p></div></td></tr></tbody></table></div><div class="admonitionblock tip"><table><tbody><tr><td class=icon><i class="fa icon-tip" title=Tip></i></td><td class=content><div class=paragraph><p>Voor dit voorbeeld hebben we een standaard UFS-bestandssysteem gebruikt. Om de tijd die nodig is voor herstel te verkorten, kan een bestandssysteem met UFS-journalling of ZFS worden gebruikt.</p></div></td></tr></tbody></table></div><div class=paragraph><p>Meer gedetailleerde informatie met aanvullende voorbeelden kunnen gevonden worden op de <a href=http://wiki.FreeBSD.org/HAST>HAST Wiki</a>-pagina.</p></div></div></div><div class=sect2><h3 id=_problemen_oplossen>19.18.5. Problemen oplossen<a class=anchor href=#_problemen_oplossen></a></h3><div class=sect3><h4 id=_algemene_tips_om_problemen_op_te_lossen>19.18.5.1. Algemene tips om problemen op te lossen<a class=anchor href=#_algemene_tips_om_problemen_op_te_lossen></a></h4><div class=paragraph><p>HAST zou over het algemeen zonder problemen moeten werken. Net als met elk ander software-product zijn er momenten waarop het anders werkt dan het zou moeten. De oorzaken van de problemen kunnen verschillen, maar de vuistregel is om ervoor te zorgen dat de klokken zijn gesynchroniseerd op alle knooppunten in het cluster.</p></div><div class=paragraph><p>Wanneer problemen met HAST worden verholpen, dient het debug-niveau van <a href="https://man.freebsd.org/cgi/man.cgi?query=hastd&amp;sektion=8&amp;format=html">hastd(8)</a> verhoogd te worden door het daemon <a href="https://man.freebsd.org/cgi/man.cgi?query=hastd&amp;sektion=8&amp;format=html">hastd(8)</a> met het argument <code>-d</code> op te starten. Merk op dat dit argument meerdere malen kan worden opgegeven om het debug-niveau nog verder op te hogen. Op deze manier kan veel nuttige informatie worden vergaard. Overweeg ook om het argument <code>-F</code> te gebruiken, dat het daemon <a href="https://man.freebsd.org/cgi/man.cgi?query=hastd&amp;sektion=8&amp;format=html">hastd(8)</a> in de voorgrond zal starten.</p></div></div><div class=sect3><h4 id=disks-hast-sb>19.18.5.2. Herstellen van de Split-brain-conditie<a class=anchor href=#disks-hast-sb></a></h4><div class=paragraph><p><code>Split-brain</code> treedt op waneer de knooppunten van het cluster niet met elkaar kunnen communiceren, en beide als primair zijn geconfigureerd. Dit is een gevaarlijke situatie omdat het beide knooppunten in staat stelt om incompatibele veranderingen aan de gegevens te maken. Dit probleem dient handmatig door de systeembeheerder te worden gecorrigeerd.</p></div><div class=paragraph><p>De beheerder moet besluiten welk knooppunt de belangrijkere veranderingen bevat (of ze handmatig samenvoegen) en HAST een volledige synchronisatie op het knooppunt dat de kapotte gegevens heeft laten uitvoeren. Voer hiervoor deze commandoâ€™s uit op het knooppunt dat opnieuw gesynchroniseerd moet worden:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=shell><span class=c># hastctl role init &lt;resource&gt;</span>
<span class=c># hastctl create &lt;resource&gt;</span>
<span class=c># hastctl role secondary &lt;resource&gt;</span></code></pre></div></div></div></div></div></div></div><hr><div class=last-modified><p><strong>Last modified on</strong>: 9 maart 2024 by <a href="https://cgit.freebsd.org/doc/commit/?id=6199af92e7" target=_blank>Danilo G. Baio</a></p></div><div class=buttons><div class=prev><i class="fa fa-angle-left" aria-hidden=true title=Prev></i><div class=container><a href=https://docs.freebsd.org/nl/books/handbook/audit class=direction>Prev</a></div></div><div class=home><i class="fa fa-home" aria-hidden=true title=Home></i><div class=container><a href=../ class=direction>Home</a></div></div><div class=next><div class=container><a href=https://docs.freebsd.org/nl/books/handbook/geom class=direction>Next</a></div><i class="fa fa-angle-right" aria-hidden=true title=Next></i></div></div><label class="hidden book-menu-overlay" for=menu-control></label></div><aside class=toc><div class=toc-content><h3>Table of Contents</h3><nav id=TableOfContents><ul><li><a href=#disks-synopsis>19.1. Overzicht</a></li><li><a href=#disks-naming>19.2. Apparaatnamen</a></li><li><a href=#disks-adding>19.3. Schijven toevoegen</a></li><li><a href=#raid>19.4. RAID</a></li><li><a href=#usb-disks>19.5. USB-opslagapparaten</a></li><li><a href=#creating-cds>19.6. Optische media (CDâ€™s) aanmaken en gebruiken</a></li><li><a href=#creating-dvds>19.7. Optische media (DVDâ€™s) aanmaken en gebruiken</a></li><li><a href=#floppies>19.8. Diskettes aanmaken en gebruiken</a></li><li><a href=#backups-tapebackups>19.9. Gegevensbanden aanmaken en gebruiken</a></li><li><a href=#backups-floppybackups>19.10. Naar diskettes back-uppen</a></li><li><a href=#backup-strategies>19.11. Back-up strategieÃ«n</a></li><li><a href=#backup-basics>19.12. Back-upbeginselen</a></li><li><a href=#disks-virtual>19.13. Netwerk-, geheugen-, en bestandsgebaseerde bestandssystemen</a></li><li><a href=#snapshots>19.14. Snapshots van bestandssystemen</a></li><li><a href=#quotas>19.15. Bestandssysteemquota</a></li><li><a href=#disks-encrypting>19.16. Schijfpartities versleutelen</a></li><li><a href=#swap-encrypting>19.17. Het versleutelen van de wisselbestand ruimte</a></li><li><a href=#disks-hast>19.18. Highly Available Storage (HAST)</a></li></ul></nav><hr><div class=resources><h3>Resources</h3><ul class=contents><li><i class="fa fa-file-pdf-o" aria-hidden=true title="Download PDF"></i><a href=https://download.freebsd.org/doc/nl/books/handbook/handbook_nl.pdf>Download PDF</a></li><li><i class="fa fa-pencil-square-o" aria-hidden=true title="Edit this page"></i><a href=https://github.com/freebsd/freebsd-doc/blob/main/documentation/content/nl/_index target=_blank>Edit this page</a></li></ul></div></div></aside><a class=to-top href=#top><i class="fa fa-arrow-circle-up" aria-hidden=true></i></a></main><footer><div class=footer-container><section class=logo-column><img src=https://docs.freebsd.org/images/FreeBSD-colors.svg width=160 height=50 alt="FreeBSD logo"><div class=options-container><div class=language-container><a id=languages href=https://docs.freebsd.org/nl/languages><img src=https://docs.freebsd.org/images/language.png class=language-image alt="Choose language">
<span>Dutch</span></a></div><div class=theme-container><select id=theme-chooser><option value=theme-system>System</option><option value=theme-light>Light</option><option value=theme-dark>Dark</option><option value=theme-high-contrast>High contrast</option></select></div></div></section><section class=about-column><h3 class=column-title>About</h3><ul class=column-elements-container><li><a href=https://www.freebsd.org/about/ target=_blank class=column-element>FreeBSD</a></li><li><a href=https://freebsdfoundation.org/ target=_blank class=column-element>FreeBSD Foundation</a></li><li><a href=https://www.freebsd.org/where/ target=_blank class=column-element>Get FreeBSD</a></li><li><a href=https://www.freebsd.org/internal/code-of-conduct target=_blank class=column-element>Code of Conduct</a></li><li><a href=https://www.freebsd.org/security/ target=_blank class=column-element>Security Advisories</a></li></ul></section><section class=documentation-column><h3 class=column-title>Documentation</h3><ul class=column-elements-container><li><a href=/nl class=column-element>Documentation portal</a></li><li><a href=https://man.FreeBSD.org target=_blank class=column-element>Manual pages</a></li><li><a href=https://papers.FreeBSD.org target=_blank class=column-element>Presentations and papers</a></li><li><a href=https://docs-archive.freebsd.org/doc/ target=_blank class=column-element>Previous versions</a></li><li><a href=https://docs-archive.freebsd.org/44doc/ target=_blank class=column-element>4.4BSD Documents</a></li><li><a href=https://wiki.freebsd.org/ target=_blank class=column-element>Wiki</a></li></ul></section><section class=community-column><h3 class=column-title>Community</h3><ul class=column-elements-container><li><a href=https://docs.freebsd.org/nl/articles/contributing class=column-element>Get involved</a></li><li><a href=https://forums.freebsd.org/ target=_blank class=column-element>Community forum</a></li><li><a href=https://lists.freebsd.org/ target=_blank class=column-element>Mailing lists</a></li><li><a href=https://wiki.freebsd.org/IRC/Channels target=_blank class=column-element>IRC Channels</a></li><li><a href=https://bugs.freebsd.org/bugzilla/ target=_blank class=column-element>Bug Tracker</a></li></ul></section><section class=legal-column><h3 class=column-title>Legal</h3><ul class=column-elements-container><li><a href=https://freebsdfoundation.org/donate/ target=_blank class=column-element>Donations</a></li><li><a href=https://www.freebsd.org/copyright/freebsd-license/ target=_blank class=column-element>Licensing</a></li><li><a href=https://www.freebsd.org/privacy/ target=_blank class=column-element>Privacy Policy</a></li><li><a href=https://www.freebsd.org/copyright/ target=_blank class=column-element>Legal notices</a></li></ul></section><section class=copyright-column><p>&copy; 1994-2024 The FreeBSD Project. All rights reserved</p><span>Made with <span class=heart>â™¥</span> by the FreeBSD Community</span></section></div></footer></body></html>